         TITLE '************** IDCRS01: IDCAMS RESETCAT ROUTINE ********
               *********'
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCRS01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRS01   77.115'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         LA    @07,4095(,@08)                                      0002
         USING @DATD,@08                                           0002
         USING @DATD+4095,@07                                      0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*        REG2 = ADDR(RSLAST);          /* RSWORK START ADDR  @ZM43016*/
         LA    REG2,RSLAST                                         0262
*        REG4 = 0;                     /* ZERO SECOND OPER   @ZM43016*/
         SLR   REG4,REG4                                           0263
*        REG5 = 0;                     /* ZERO SECOND LENGTH @ZM43016*/
         SLR   REG5,REG5                                           0264
*        REG3 = LENGTH(RSWORK);        /* LENGTH OF CORE     @ZM43016*/
         LA    REG3,2160                                           0265
*        MVCL(REG2,REG4);              /* MVCL CLEAR REWORK  @ZM43016*/
         MVCL  REG2,REG4                                           0266
*        RESPECIFY (REG2,REG3,REG4) UNRSTD; /* FREE WRK REGS @ZM43016*/
*                                                                  0267
*        /************************************************************/
*        /*                                                          */
*        /* SET UP THE ADDRESSES OF THE GDT AND RSWORK               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0268
*        REG6 = ADDR(RSLAST);          /*ADDRESS OF RSWORK           */
         LA    REG6,RSLAST                                         0268
*        REG5 = ADDR(GDTTBLX);         /*ADDRESS OF THE GDT          */
*                                                                  0269
         L     REG5,@PC00001                                       0269
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE RSWORK - THE PRIMARY WORK AREA FOR            */
*        /* RESETCAT.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0270
*        RSLASTCC = ADDR(ALASTCC);     /*ADDR OF AMS LAST CC         */
         L     @04,@PC00001+8                                      0270
         ST    @04,RSLASTCC(,REG6)                                 0270
*        RSFDT = ADDR(FDTTBL);         /*ADDR OF THE FDT             */
         L     @04,@PC00001+4                                      0271
         ST    @04,RSFDT(,REG6)                                    0271
*        RSGDT = REG5;                 /*ADDRESS OF THE GDT          */
*                                                                  0272
         ST    REG5,RSGDT(,REG6)                                   0272
*        /************************************************************/
*        /*                                                          */
*        /*      INITIALIZE ADDRESSES OF SECONDARY STORAGE ELEMENTS  */
*        /*      GOTTEN.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0273
*        RSA = 'RSWA';                 /*RSWORK I.D.                 */
         MVC   RSA(4,REG6),@CC03474                                0273
*        DDSTRU = ADDR(RS2);           /*PTR TO DARGLIST             */
         LA    @04,RS2                                             0274
         ST    @04,DDSTRU(,REG6)                                   0274
*        ERCNVADR = ADDR(RS3);         /*ADDR OF ERCNVTAB            */
         LA    @04,RS3                                             0275
         ST    @04,ERCNVADR(,REG6)                                 0275
*        DMPINDEX = ADDR(RS5);         /*ADDRESS OF DUMP ELEMENT     */
*                                                                  0276
         LA    @04,RS5                                             0276
         ST    @04,DMPINDEX(,REG6)                                 0276
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE FIRST REGISTER SAVE AREA                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0277
*        REG13->RSREGMOD = MODID;      /*RS01 DUMMY SAVE AREA        */
         MVC   RSREGMOD(4,REG13),MODID                             0277
*        REG13->RSREGF = ADDR(RSREGS(1)); /*FORWARD CHAIN RS01 TO US */
         LA    @04,RSREGS                                          0278
         ST    @04,RSREGF(,REG13)                                  0278
*        ADDR(RSREGS(1))->RSREGB = REG13; /*BACK CHAIN US TO RS01    */
         ST    REG13,RSREGB(,@04)                                  0279
*        REG13 = ADDR(RSREGS(1));      /*GET OUR REGISTER SAVE AREA  */
*                                                                  0280
         LR    REG13,@04                                           0280
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE REGISTER LINKAGE WITH OTHER MODULES.          */
*        /* ALSO GET THE AUTOMATIC STORAGE FOR THOSE MODULES.        */
*        /* STANDARD REGISTER IN ALL MODULES MUST BE:                */
*        /*     REG 08 - DATA REGISTER                               */
*        /*     REG 09 - BASE REGISTER                               */
*        /*     REG 10 - BASE REGISTER                               */
*        /*     REG 11 - BASE REGISTER                               */
*        /*     REG 12 - BASE REGISTER                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0281
*        REG13 = ADDR(RSREGS(1));      /*IDCRS01 REGISTER SAVE AREA  */
*                                                                  0281
         LR    REG13,@04                                           0281
*        /************************************************************/
*        /*                                                          */
*        /*   ESTABLISH BASE AND DATA REGISTERS FOR EACH             */
*        /*   MODULE. ALSO GET AUTOMATIC STORAGE FOR EACH            */
*        /*   MODULE.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0282
*        /************************************************************/
*        /*                                                          */
*        /*     REGISTERS FOR IDCRS01                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0282
*        RS01RG08 = REG8;              /*SAVE AUTO DATA REG          */
         ST    REG8,RS01RG08(,REG6)                                0282
*        GENERATE REFS(RS01RG09,REG6);                             0283
*                                                                  0283
          STM   9,12,RS01RG09(REG6) SAVE BASE REGISTERS
*        /************************************************************/
*        /*                                                          */
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */
*        /*     FOR IDCRS02                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0284
*        CALL IDCRS02;                 /*EXECUTE THE PROLOGUE        */
         L     @15,@CV03434                                        0284
         BALR  @14,@15                                             0284
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */
         ST    REG15,RSUGLEN(,REG6)                                0285
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */
         L     @04,RSUGLEN(,REG6)                                  0286
         LTR   @04,@04                                             0286
         BNP   @RF00286                                            0286
*          DO;                                                     0287
*                                                                  0287
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS02RG08,POOL1,SETZERO); 0288
*                                                                  0288
         ST    REG5,@AL00001                                       0288
         LA    @04,RSUGLEN(,REG6)                                  0288
         ST    @04,@AL00001+4                                      0288
         LA    @04,RS02RG08(,REG6)                                 0288
         ST    @04,@AL00001+8                                      0288
         LA    @04,@CC00900                                        0288
         ST    @04,@AL00001+12                                     0288
         LA    @04,SETZERO                                         0288
         ST    @04,@AL00001+16                                     0288
         MVI   @AL00001+16,X'80'                                   0288
         L     @15,GDTGPL(,REG5)                                   0288
         LA    @01,@AL00001                                        0288
         BALR  @14,@15                                             0288
*            RESPECIFY RTNREG RSTD;                                0289
*            TESTRC = RTNREG;                                      0290
         STH   RTNREG,TESTRC(,REG6)                                0290
*            RESPECIFY RTNREG UNRSTD;                              0291
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */
         LH    @04,TESTRC(,REG6)                                   0292
         LTR   @04,@04                                             0292
         BZ    @RF00292                                            0292
*              CALL AERROR;                                        0293
*                                                                  0293
         BAL   @14,AERROR                                          0293
*          END;                                                    0294
*                                                                  0294
@RF00292 DS    0H                                                  0295
*        /************************************************************/
*        /*                                                          */
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */
*        /*     FOR IDCRS03                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0295
*        CALL IDCRS03;                 /*EXECUTE THE PROLOGUE        */
@RF00286 L     @15,@CV03435                                        0295
         BALR  @14,@15                                             0295
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */
         ST    REG15,RSUGLEN(,REG6)                                0296
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */
         L     @04,RSUGLEN(,REG6)                                  0297
         LTR   @04,@04                                             0297
         BNP   @RF00297                                            0297
*          DO;                                                     0298
*                                                                  0298
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS03RG08,POOL1,SETZERO); 0299
*                                                                  0299
         ST    REG5,@AL00001                                       0299
         LA    @04,RSUGLEN(,REG6)                                  0299
         ST    @04,@AL00001+4                                      0299
         LA    @04,RS03RG08(,REG6)                                 0299
         ST    @04,@AL00001+8                                      0299
         LA    @04,@CC00900                                        0299
         ST    @04,@AL00001+12                                     0299
         LA    @04,SETZERO                                         0299
         ST    @04,@AL00001+16                                     0299
         MVI   @AL00001+16,X'80'                                   0299
         L     @15,GDTGPL(,REG5)                                   0299
         LA    @01,@AL00001                                        0299
         BALR  @14,@15                                             0299
*            RESPECIFY RTNREG RSTD;                                0300
*            TESTRC = RTNREG;                                      0301
         STH   RTNREG,TESTRC(,REG6)                                0301
*            RESPECIFY RTNREG UNRSTD;                              0302
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */
         LH    @04,TESTRC(,REG6)                                   0303
         LTR   @04,@04                                             0303
         BZ    @RF00303                                            0303
*              CALL AERROR;                                        0304
*                                                                  0304
         BAL   @14,AERROR                                          0304
*          END;                                                    0305
*                                                                  0305
@RF00303 DS    0H                                                  0306
*        /************************************************************/
*        /*                                                          */
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */
*        /*     FOR IDCRS04                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0306
*        CALL IDCRS04;                 /*EXECUTE THE PROLOGUE        */
@RF00297 L     @15,@CV03436                                        0306
         BALR  @14,@15                                             0306
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */
         ST    REG15,RSUGLEN(,REG6)                                0307
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */
         L     @04,RSUGLEN(,REG6)                                  0308
         LTR   @04,@04                                             0308
         BNP   @RF00308                                            0308
*          DO;                                                     0309
*                                                                  0309
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS04RG08,POOL1,SETZERO); 0310
*                                                                  0310
         ST    REG5,@AL00001                                       0310
         LA    @04,RSUGLEN(,REG6)                                  0310
         ST    @04,@AL00001+4                                      0310
         LA    @04,RS04RG08(,REG6)                                 0310
         ST    @04,@AL00001+8                                      0310
         LA    @04,@CC00900                                        0310
         ST    @04,@AL00001+12                                     0310
         LA    @04,SETZERO                                         0310
         ST    @04,@AL00001+16                                     0310
         MVI   @AL00001+16,X'80'                                   0310
         L     @15,GDTGPL(,REG5)                                   0310
         LA    @01,@AL00001                                        0310
         BALR  @14,@15                                             0310
*            RESPECIFY RTNREG RSTD;                                0311
*            TESTRC = RTNREG;                                      0312
         STH   RTNREG,TESTRC(,REG6)                                0312
*            RESPECIFY RTNREG UNRSTD;                              0313
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */
         LH    @04,TESTRC(,REG6)                                   0314
         LTR   @04,@04                                             0314
         BZ    @RF00314                                            0314
*              CALL AERROR;                                        0315
*                                                                  0315
         BAL   @14,AERROR                                          0315
*          END;                                                    0316
*                                                                  0316
@RF00314 DS    0H                                                  0317
*        /************************************************************/
*        /*                                                          */
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */
*        /*     FOR IDCRS05                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0317
*        CALL IDCRS05;                 /*EXECUTE THE PROLOGUE        */
@RF00308 L     @15,@CV03437                                        0317
         BALR  @14,@15                                             0317
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */
         ST    REG15,RSUGLEN(,REG6)                                0318
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */
         L     @04,RSUGLEN(,REG6)                                  0319
         LTR   @04,@04                                             0319
         BNP   @RF00319                                            0319
*          DO;                                                     0320
*                                                                  0320
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS05RG08,POOL1,SETZERO); 0321
*                                                                  0321
         ST    REG5,@AL00001                                       0321
         LA    @04,RSUGLEN(,REG6)                                  0321
         ST    @04,@AL00001+4                                      0321
         LA    @04,RS05RG08(,REG6)                                 0321
         ST    @04,@AL00001+8                                      0321
         LA    @04,@CC00900                                        0321
         ST    @04,@AL00001+12                                     0321
         LA    @04,SETZERO                                         0321
         ST    @04,@AL00001+16                                     0321
         MVI   @AL00001+16,X'80'                                   0321
         L     @15,GDTGPL(,REG5)                                   0321
         LA    @01,@AL00001                                        0321
         BALR  @14,@15                                             0321
*            RESPECIFY RTNREG RSTD;                                0322
*            TESTRC = RTNREG;                                      0323
         STH   RTNREG,TESTRC(,REG6)                                0323
*            RESPECIFY RTNREG UNRSTD;                              0324
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */
         LH    @04,TESTRC(,REG6)                                   0325
         LTR   @04,@04                                             0325
         BZ    @RF00325                                            0325
*              CALL AERROR;                                        0326
*                                                                  0326
         BAL   @14,AERROR                                          0326
*          END;                                                    0327
*                                                                  0327
@RF00325 DS    0H                                                  0328
*        /************************************************************/
*        /*                                                          */
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */
*        /*     FOR IDCRS06                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0328
*        CALL IDCRS06;                 /*EXECUTE THE PROLOGUE        */
@RF00319 L     @15,@CV03438                                        0328
         BALR  @14,@15                                             0328
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */
         ST    REG15,RSUGLEN(,REG6)                                0329
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */
         L     @04,RSUGLEN(,REG6)                                  0330
         LTR   @04,@04                                             0330
         BNP   @RF00330                                            0330
*          DO;                                                     0331
*                                                                  0331
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS06RG08,POOL1,SETZERO); 0332
*                                                                  0332
         ST    REG5,@AL00001                                       0332
         LA    @04,RSUGLEN(,REG6)                                  0332
         ST    @04,@AL00001+4                                      0332
         LA    @04,RS06RG08(,REG6)                                 0332
         ST    @04,@AL00001+8                                      0332
         LA    @04,@CC00900                                        0332
         ST    @04,@AL00001+12                                     0332
         LA    @04,SETZERO                                         0332
         ST    @04,@AL00001+16                                     0332
         MVI   @AL00001+16,X'80'                                   0332
         L     @15,GDTGPL(,REG5)                                   0332
         LA    @01,@AL00001                                        0332
         BALR  @14,@15                                             0332
*            RESPECIFY RTNREG RSTD;                                0333
*            TESTRC = RTNREG;                                      0334
         STH   RTNREG,TESTRC(,REG6)                                0334
*            RESPECIFY RTNREG UNRSTD;                              0335
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */
         LH    @04,TESTRC(,REG6)                                   0336
         LTR   @04,@04                                             0336
         BZ    @RF00336                                            0336
*              CALL AERROR;                                        0337
*                                                                  0337
         BAL   @14,AERROR                                          0337
*          END;                                                    0338
*                                                                  0338
@RF00336 DS    0H                                                  0339
*        /************************************************************/
*        /*                                                          */
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */
*        /*     FOR IDCRS07                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0339
*        CALL IDCRS07;                 /*EXECUTE THE PROLOGUE        */
@RF00330 L     @15,@CV03439                                        0339
         BALR  @14,@15                                             0339
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */
         ST    REG15,RSUGLEN(,REG6)                                0340
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */
         L     @04,RSUGLEN(,REG6)                                  0341
         LTR   @04,@04                                             0341
         BNP   @RF00341                                            0341
*          DO;                                                     0342
*                                                                  0342
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS07RG08,POOL1,SETZERO); 0343
*                                                                  0343
         ST    REG5,@AL00001                                       0343
         LA    @04,RSUGLEN(,REG6)                                  0343
         ST    @04,@AL00001+4                                      0343
         LA    @04,RS07RG08(,REG6)                                 0343
         ST    @04,@AL00001+8                                      0343
         LA    @04,@CC00900                                        0343
         ST    @04,@AL00001+12                                     0343
         LA    @04,SETZERO                                         0343
         ST    @04,@AL00001+16                                     0343
         MVI   @AL00001+16,X'80'                                   0343
         L     @15,GDTGPL(,REG5)                                   0343
         LA    @01,@AL00001                                        0343
         BALR  @14,@15                                             0343
*            RESPECIFY RTNREG RSTD;                                0344
*            TESTRC = RTNREG;                                      0345
         STH   RTNREG,TESTRC(,REG6)                                0345
*            RESPECIFY RTNREG UNRSTD;                              0346
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */
         LH    @04,TESTRC(,REG6)                                   0347
         LTR   @04,@04                                             0347
         BZ    @RF00347                                            0347
*              CALL AERROR;                                        0348
*                                                                  0348
         BAL   @14,AERROR                                          0348
*          END;                                                    0349
@RF00347 DS    0H                                                  0350
*        /************************************************************/
*        /*                                                          */
*        /* THIS IS THE START OF THE FUNCTIONAL SEGMENT              */
*        /* FOR RESETCAT.                                            */
*        /*                                                          */
*        /************************************************************/
*RS01TOP:                                                          0350
*                                                                  0350
*        OLDERID2 = NEWERID2;                                      0350
@RF00341 DS    0H                                                  0350
RS01TOP  L     @04,GDTTR2(,REG5)                                   0350
         MVC   @TS00001(95),NEWERID2(@04)                          0350
         MVC   OLDERID2(95,@04),@TS00001                           0350
*        NEWID2 = 'RS01' ;                                         0351
*                                                                  0351
         MVC   NEWID2(4,@04),@CC00900                              0351
*         CALL INIT;                                               0352
         BAL   @14,INIT                                            0352
*                                      /*OPEN CATALOG AND WORKFILE   */
*                                                                  0353
*        DO UNTIL RSENUFCI = ON;       /*REDO IF CAT MUST BE EXTD    */
*                                                                  0353
@DL00353 DS    0H                                                  0354
*           CALL COPYCAT;                                          0354
         BAL   @14,COPYCAT                                         0354
*                                      /*COPY CATALOG TO WORKFILE    */
*           CALL MERGECRA;                                         0355
         BAL   @14,MERGECRA                                        0355
*                                      /*COPY CRA(S) TO WORKFILE     */
*           /* CALL TO MODULE IDCRS07 FOR PROCEDURE ENSURECI         */
*           CALL ENSURECI;                                         0356
         L     @15,@CV03481                                        0356
         BALR  @14,@15                                             0356
*                                      /*ENSURE ENOUGH CIS           */
*                                                                  0357
*        END;                                                      0357
*                                                                  0357
@DE00353 TM    RSENUFCI(REG6),B'10000000'                          0357
         BNO   @DL00353                                            0357
*         CALL REASSIGN;                                           0358
         BAL   @14,REASSIGN                                        0358
*                                      /*REASSIGN CI NUMS AS NEEDED  */
*         /* CALL TO MODULE IDCRS02 FOR PROCEDURE ASSOC              */
*         CALL ASSOC;                                              0359
         L     @15,@CV03483                                        0359
         BALR  @14,@15                                             0359
*                                      /*CHECK ASSOCIATION AND SPACE */
*         CALL UPDCAT;                                             0360
         BAL   @14,UPDCAT                                          0360
*                                      /*UPDATE CATALOG              */
*         CALL UPDCRA;                                             0361
         BAL   @14,UPDCRA                                          0361
*                                      /*UPDATE CRA(S)               */
*         CALL WRAPUP;                                             0362
         BAL   @14,WRAPUP                                          0362
*                                      /*CLOSE CATALOG AND WORKFILE  */
*                                                                  0363
*                                                                  0363
*                                                                  0363
*        IF GDTDBG = NULLPTR                                       0363
*          THEN;                                                   0363
         L     @04,GDTDBG(,REG5)                                   0363
         LTR   @04,@04                                             0363
         BZ    @RT00363                                            0363
*          ELSE                                                    0365
*            CALL IDCDB010 (GDTTBL,'RS00');                        0365
         ST    REG5,@AL00001                                       0365
         LA    @04,@CC03487                                        0365
         ST    @04,@AL00001+4                                      0365
         MVI   @AL00001+4,X'80'                                    0365
         L     @15,GDTDBG(,REG5)                                   0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - AERROR                                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*    AERROR IS CALLED PRIOR TO LINKAGE BEING ESTABLISHED           */
*/*    TO CKERR. AERROR WILL PRINT 'STORAGE UNAVAILABLE' AND         */
*/*    TERMINATE.                                                    */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT - NONE                                                    */
*/*                                                                  */
*/* EXIT - TERMINATE VIA UEPIL                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0366
*      GENERATE;                                                   0366
@RT00363 DS    0H                                                  0366
         DS    0F
NAME0011 DC    CL8'AERROR'
*AERROR: PROCEDURE                                                 0367
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0367
*                                                                  0367
         B     @PB00002                                            0367
AERROR   DS    0H                                                  0368
*      GENERATE REFS(RS01RG08, REG6);                              0368
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0011  PROCNAME TO REGSAVE
*        /************************************************************/
*        /*                                                          */
*        /*  SET UP DARGLIST AND CALL UPRINT TO PRINT INSUFFICIENT   */
*        /*   STORAGE MSG                                            */
*        /*                                                          */
*        /************************************************************/
*        DARGLIST = DARGLIST && DARGLIST;                          0369
         L     @04,DDSTRU(,REG6)                                   0369
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0369
*        DARGSTID = INSUFSTG;                                      0370
         MVC   DARGSTID(4,@04),@CF00734                            0370
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0371
         ST    REG5,@AL00001                                       0371
         LA    @04,@CF00119                                        0371
         ST    @04,@AL00001+4                                      0371
         LA    @04,DDSTRU(,REG6)                                   0371
         ST    @04,@AL00001+8                                      0371
         MVI   @AL00001+8,X'80'                                    0371
         L     @15,GDTPRT(,REG5)                                   0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*        /************************************************************/
*        /*                                                          */
*        /*  HANDLE TERMINATION MESSAGE SEQUENCE. THE MESSAGE        */
*        /*   PRINTED DIFFERS BETWEEN A BATCH ENVIROMENT AND A       */
*        /*   TSO ENVIROMENT                                         */
*        /*                                                          */
*        /************************************************************/
*        LASTCC = LASTCC12;                                        0372
         L     @04,RSLASTCC(,REG6)                                 0372
         MVC   LASTCC(2,@04),@CH00037                              0372
*        DARGLIST = DARGLIST && DARGLIST;                          0373
         L     @15,DDSTRU(,REG6)                                   0373
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0373
*        DARGDBP = ADDR(LASTCC);                                   0374
         ST    @04,DARGDBP(,@15)                                   0374
*        DARGILP = LENGTH(LASTCC);                                 0375
         MVC   DARGILP(2,@15),@CH00157                             0375
*        IF GDTECT = NULLPTR           /*BATCH ENVIROMENT            */
*          THEN                                                    0376
         L     @04,GDTECT(,REG5)                                   0376
         LTR   @04,@04                                             0376
         BNZ   @RF00376                                            0376
*            DARGSTID = ERRTRM;        /*IDC003I                     */
         MVC   DARGSTID(4,@15),@CF00736                            0377
*          ELSE                                                    0378
*            DARGSTID = TSOERROR;      /*IDC0014I                    */
         B     @RC00376                                            0378
@RF00376 L     @04,DDSTRU(,REG6)                                   0378
         MVC   DARGSTID(4,@04),@CF00738                            0378
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0379
@RC00376 ST    REG5,@AL00001                                       0379
         LA    @04,@CF00119                                        0379
         ST    @04,@AL00001+4                                      0379
         LA    @04,DDSTRU(,REG6)                                   0379
         ST    @04,@AL00001+8                                      0379
         MVI   @AL00001+8,X'80'                                    0379
         L     @15,GDTPRT(,REG5)                                   0379
         LA    @01,@AL00001                                        0379
         BALR  @14,@15                                             0379
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO SYSTEM VIA UEPIL. REG 13 MUST POINT TO FIRST  */
*        /*    BYTE OF DYANMIC STORAGE FOR THIS MODULE FOR UEPIL     */
*        /*                                                          */
*        /************************************************************/
*        REG13 = REG8;                                             0380
         LR    REG13,REG8                                          0380
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0381
*                                                                  0381
         ST    REG5,@AL00001                                       0381
         LA    @04,MODID                                           0381
         ST    @04,@AL00001+4                                      0381
         L     @04,RSLASTCC(,REG6)                                 0381
         ST    @04,@AL00001+8                                      0381
         MVI   @AL00001+8,X'80'                                    0381
         L     @15,GDTEPL(,REG5)                                   0381
         LA    @01,@AL00001                                        0381
         BALR  @14,@15                                             0381
* CALL EXIT;  /*TERMINATE*/                                        0382
         BAL   @14,EXIT                                            0382
* END AERROR; /*END OF PROCEDURE*/                                 0383
@EL00002 DS    0H                                                  0383
@EF00002 DS    0H                                                  0383
@ER00002 BR    @14                                                 0383
@PB00002 DS    0H                                                  0384
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - CATINIT                                         */
*/*                                                                  */
*/* FUNCTION - BUILD THE CONTROL INTERVAL (CI) TO RELATIVE RECORD    */
*/*            NUMBER (RRN) TRANSLATION TABLE (CIXLT)                */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   FORMATS CIXLT TABLE                                   */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0384
         DS    0F
NAME0014 DC    CL8'CATINIT'
*CATINIT: PROCEDURE                                                0385
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0385
*                                                                  0385
         B     @PB00003                                            0385
CATINIT  DS    0H                                                  0386
*      GENERATE REFS(RS01RG08, REG6);                              0386
*                                                                  0386
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY CATINIT  ENTRY POINT
         LM    @08,@12,RS01RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0014  PROCNAME TO REGSAVE
*         OLDERID2 = NEWERID2;                                     0387
         L     @04,GDTTR2(,REG5)                                   0387
         MVC   @TS00001(95),NEWERID2(@04)                          0387
         MVC   OLDERID2(95,@04),@TS00001                           0387
*         NEWID2 = 'RSCI';                                         0388
*                                                                  0388
         MVC   NEWID2(4,@04),@CC03496                              0388
*         /***********************************************************/
*         /*                                                         */
*         /*  GET CATALOG CCR RECORD VIA RECMGMT.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0389
*         RSGRABCU = ADDR(GRABSCA);                                0389
         L     @04,RSIOTBL(,REG6)                                  0389
         LA    @04,GRABSCA(,@04)                                   0389
         ST    @04,RSGRABCU(,REG6)                                 0389
*         GRABCURR = GRABRAB1;                                     0390
         L     @15,GRABRAB1(,@04)                                  0390
         ST    @15,GRABCURR(,@04)                                  0390
*         RABRCDA = CCRCI;                                         0391
*                                                                  0391
*                                                                  0391
         MVC   RABRCDA(4,@15),@CF00166                             0391
*         DO;                                                      0392
*           RSRTYPE = ''B;                                         0393
         MVI   RSRTYPE(REG6),X'00'                                 0393
*           RSRGET = ON;      /* GETRCD  */                        0394
         OI    RSRGET(REG6),B'10000000'                            0394
*           RSRUPD = OFF;     /* NO UPDATE  */                     0395
         NI    RSRUPD(REG6),B'11110111'                            0395
*           RSRDS = ''B;                                           0396
         NI    RSRDS(REG6),B'00011111'                             0396
*           RSRCAT = ON;      /* CATALOG  */                       0397
*           RSRDIR = ON;      /* DIRECT  */                        0398
*           RSRKEY = OFF;     /* CNV  */                           0399
*                                                                  0399
         OI    RSRCAT(REG6),B'01000100'                            0399
         NI    RSRKEY(REG6),B'11101111'                            0399
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            0400
         L     @15,@CV03498                                        0400
         BALR  @14,@15                                             0400
*           RFY RTNREG RSTD;                                       0401
*           TESTRC = RTNREG;                                       0402
         STH   RTNREG,TESTRC(,REG6)                                0402
*           RFY RTNREG UNRSTD;                                     0403
*         END;                                                     0404
*                                                                  0404
*                                                                  0404
*         /***********************************************************/
*         /*                                                         */
*         /*  SAVE NEXT UNFORMATTED FREE CI IN MAIN WORKAREA         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0405
*         RSCANFCI = CCRNFCI;                                      0405
*                                                                  0405
         L     @04,RSGRABCU(,REG6)                                 0405
         L     @04,GRABCURR(,@04)                                  0405
         LA    @15,8                                               0405
         ALR   @15,@04                                             0405
         SLR   @14,@14                                             0405
         ICM   @14,7,CCRNFCI(@15)                                  0405
         ST    @14,RSCANFCI(,REG6)                                 0405
*         /***********************************************************/
*         /*                                                         */
*         /*  SAVE HIGH ALLOCATED LOW KEY RANGE CI IN MAIN           */
*         /*  WORKAREA                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0406
*         RSCAHALC = CCRHACI;                                      0406
*                                                                  0406
         SLR   @14,@14                                             0406
         ICM   @14,7,CCRHACI(@15)                                  0406
         ST    @14,RSCAHALC(,REG6)                                 0406
*         /***********************************************************/
*         /*                                                         */
*         /*  GET CATALOG DATA RECORD VIA RECMGMT.                   */
*         /*  COMPUTE HIGH ALLOCATED DATA CI AND SAVE IN             */
*         /*  MAIN WORKAREA.                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0407
*         RABRCDA = DATACI;                                        0407
*                                                                  0407
*                                                                  0407
         SLR   @15,@15                                             0407
         ST    @15,RABRCDA(,@04)                                   0407
*         DO;                                                      0408
*           RSRTYPE = ''B;                                         0409
         MVI   RSRTYPE(REG6),X'00'                                 0409
*           RSRGET = ON;      /* GETRCD  */                        0410
         OI    RSRGET(REG6),B'10000000'                            0410
*           RSRUPD = OFF;     /* NO UPDATE  */                     0411
         NI    RSRUPD(REG6),B'11110111'                            0411
*           RSRDS = ''B;                                           0412
         NI    RSRDS(REG6),B'00011111'                             0412
*           RSRCAT = ON;      /* CATALOG  */                       0413
*           RSRDIR = ON;      /* DIRECT  */                        0414
*           RSRKEY = OFF;     /* CNV  */                           0415
*                                                                  0415
         OI    RSRCAT(REG6),B'01000100'                            0415
         NI    RSRKEY(REG6),B'11101111'                            0415
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            0416
         L     @15,@CV03498                                        0416
         BALR  @14,@15                                             0416
*           RFY RTNREG RSTD;                                       0417
*           TESTRC = RTNREG;                                       0418
         STH   RTNREG,TESTRC(,REG6)                                0418
*           RFY RTNREG UNRSTD;                                     0419
*         END;                                                     0420
*                                                                  0420
*         RSCAHACI = CHIA/CILEN;                                   0421
*                                                                  0421
         L     @04,RSGRABCU(,REG6)                                 0421
         L     @04,GRABCURR(,@04)                                  0421
         ICM   @15,15,CHIA+8(@04)                                  0421
         SRL   @15,9                                               0421
         ST    @15,RSCAHACI(,REG6)                                 0421
*         /***********************************************************/
*         /*                                                         */
*         /*  COMPUTE FIRST WORKFILE RRN AVAILABLE FOR ALLOCATION    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0422
*         RSWFNEXT = RSCAHALC + 2;                                 0422
*                                                                  0422
         LA    @04,2                                               0422
         AL    @04,RSCAHALC(,REG6)                                 0422
         ST    @04,RSWFNEXT(,REG6)                                 0422
*         /***********************************************************/
*         /*                                                         */
*         /*  FREE EOV STORAGE POOL                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0423
*         CALL IDCSAFP0 (GDTTBL,POOL2);                            0423
*                                                                  0423
         ST    REG5,@AL00001                                       0423
         LA    @04,@CC00902                                        0423
         ST    @04,@AL00001+4                                      0423
         MVI   @AL00001+4,X'80'                                    0423
         L     @15,GDTFPL(,REG5)                                   0423
         LA    @01,@AL00001                                        0423
         BALR  @14,@15                                             0423
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE MAIN WORKAREA POINTERS,COUNTERS AND FLAGS   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0424
*         RSVOLLST = 0;                                            0424
         SLR   @04,@04                                             0424
         ST    @04,RSVOLLST(,REG6)                                 0424
*         RSAVAIL  = 0;                                            0425
         ST    @04,RSAVAIL(,REG6)                                  0425
*         RSREASS  = 0;                                            0426
         ST    @04,RSREASS(,REG6)                                  0426
*         RSF1RNAM = 0;                                    /*@ZA18274*/
         ST    @04,RSF1RNAM(,REG6)                                 0427
*         RSCHCRAN = 0;                                    /*@ZA18274*/
         ST    @04,RSCHCRAN(,REG6)                                 0428
*         RSAVAILN = 0;                                            0429
         ST    @04,RSAVAILN(,REG6)                                 0429
*         RSREASSN = 0;                                            0430
         ST    @04,RSREASSN(,REG6)                                 0430
*         RSFLAGSI = ''B;                                          0431
*                                                                  0431
         XC    RSFLAGSI(3,REG6),RSFLAGSI(REG6)                     0431
*         /***********************************************************/
*         /*                                                 @ZA18272*/
*         /*  CLEAN UP WORKFILE RECMGMT CONTROL BLOCKS       @ZA18272*/
*         /*                                                 @ZA18272*/
*         /***********************************************************/
*                                                                  0432
*                                                                  0432
*         DO;                                                      0432
*           RSRECREQ = ''B;                                        0433
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0433
*           RSRTERM = ON;     /* TERMRCD */                        0434
         OI    RSRTERM(REG6),B'00000010'                           0434
*           RSRWF = ON;       /* WORKFILE */                       0435
*                                                                  0435
         OI    RSRWF(REG6),B'10000000'                             0435
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            0436
         L     @15,@CV03498                                        0436
         BALR  @14,@15                                             0436
*           RFY RTNREG RSTD;                                       0437
*           TESTRC = RTNREG;                                       0438
         STH   RTNREG,TESTRC(,REG6)                                0438
*           RFY RTNREG UNRSTD;                                     0439
*         END;                                  /*@ZA18272*/       0440
*                                                                  0440
*         /***********************************************************/
*         /*                                                         */
*         /*  BUILD CIXLT TABLE.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0441
*         RSCIDFCI = 0;                                            0441
         SLR   @04,@04                                             0441
         ST    @04,RSCIDFCI(,REG6)                                 0441
*         RSCIEXPT = ADDR(RSCIEXT);                                0442
*                                                                  0442
         LA    @04,RSCIEXT(,REG6)                                  0442
         ST    @04,RSCIEXPT(,REG6)                                 0442
*         /***********************************************************/
*         /*                                                         */
*         /*  GET CATALOG LKR DATA RECORD VIA RECMGMT.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0443
*         RABRCDA = LKRDATCI;                                      0443
*                                                                  0443
*                                                                  0443
         L     @04,RSGRABCU(,REG6)                                 0443
         L     @04,GRABCURR(,@04)                                  0443
         MVC   RABRCDA(4,@04),@CF00287                             0443
*         DO;                                                      0444
*           RSRTYPE = ''B;                                         0445
         MVI   RSRTYPE(REG6),X'00'                                 0445
*           RSRGET = ON;      /* GETRCD  */                        0446
         OI    RSRGET(REG6),B'10000000'                            0446
*           RSRUPD = OFF;     /* NO UPDATE  */                     0447
         NI    RSRUPD(REG6),B'11110111'                            0447
*           RSRDS = ''B;                                           0448
         NI    RSRDS(REG6),B'00011111'                             0448
*           RSRCAT = ON;      /* CATALOG  */                       0449
*           RSRDIR = ON;      /* DIRECT  */                        0450
*           RSRKEY = OFF;     /* CNV  */                           0451
*                                                                  0451
         OI    RSRCAT(REG6),B'01000100'                            0451
         NI    RSRKEY(REG6),B'11101111'                            0451
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            0452
         L     @15,@CV03498                                        0452
         BALR  @14,@15                                             0452
*           RFY RTNREG RSTD;                                       0453
*           TESTRC = RTNREG;                                       0454
         STH   RTNREG,TESTRC(,REG6)                                0454
*           RFY RTNREG UNRSTD;                                     0455
*         END;                                                     0456
*                                                                  0456
*         /***********************************************************/
*         /*                                                         */
*         /*    POINT TO FIRST EXTENT DESCRIPTOR IN CATALOG          */
*         /*    LOW KEY RANGE DATA RECORD. FIND CONTROL INFORMATION  */
*         /*    VIA CATRCDSU.                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0457
*         /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU           */
*         CALL CATRCDSU;                                           0457
*                                                                  0457
         L     @15,@CV03499                                        0457
         BALR  @14,@15                                             0457
*         RSCPE6 = RSCPE3;                                         0458
*                                                                  0458
         L     @04,RSCPE3(,REG6)                                   0458
         ST    @04,RSCPE6(,REG6)                                   0458
*         /***********************************************************/
*         /*                                                         */
*         /*    POINT TO FIRST VARIABLE FIELD.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0459
*         RSCPE7 = RSCPE6 + LENFIX;                                0459
*                                                                  0459
         SLR   @15,@15                                             0459
         IC    @15,LENFIX(,@04)                                    0459
         ALR   @15,@04                                             0459
         ST    @15,RSCPE7(,REG6)                                   0459
*         /***********************************************************/
*         /*                                                         */
*         /*    THE EXTENT DESCRIPTOR FIELD IS THE THIRD VARIABLE    */
*         /*    FIELD. SKIP THE FIRST TWO VARIABLE FIELDS TO GET     */
*         /*    TO IT.                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0460
*CATILP1: DO RSIDX = 1 TO 2;                                       0460
*                                                                  0460
CATILP1  LA    @04,1                                               0460
         STH   @04,RSIDX(,REG6)                                    0460
@DL00460 DS    0H                                                  0461
*           RSCPE7 = RSCPE7 + VARLEN + LENGTH(VARLEN);             0461
*                                                                  0461
         L     @04,RSCPE7(,REG6)                                   0461
         ICM   @15,12,VARLEN(@04)                                  0461
         SRA   @15,16                                              0461
         ALR   @15,@04                                             0461
         AL    @15,@CF00157                                        0461
         ST    @15,RSCPE7(,REG6)                                   0461
*         END CATILP1;                                             0462
*                                                                  0462
         LA    @04,1                                               0462
         AH    @04,RSIDX(,REG6)                                    0462
         STH   @04,RSIDX(,REG6)                                    0462
         C     @04,@CF00157                                        0462
         BNH   @DL00460                                            0462
*         /***********************************************************/
*         /*                                                         */
*         /*    MOVE FIRST EXTENT TO SAVE AREA. SET NEXT CI TO 0.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0463
*         RSCIEXCU = RSCPE7 + LENGTH(VARLEN);                      0463
         LA    @04,2                                               0463
         AL    @04,RSCPE7(,REG6)                                   0463
         ST    @04,RSCIEXCU(,REG6)                                 0463
*         RSCIEXT = RSCIEXCU -> CATIEXT;                           0464
         MVC   RSCIEXT(20,REG6),CATIEXT(@04)                       0464
*         RSCINXCI = 0;                                            0465
*                                                                  0465
         SLR   @04,@04                                             0465
         ST    @04,RSCINXCI(,REG6)                                 0465
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS EACH CIXLT ENTRY.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0466
*CATILP2: DO RSIDX = 1 TO DIM(RSXCIENT);                           0466
*                                                                  0466
CATILP2  LA    @04,1                                               0466
         STH   @04,RSIDX(,REG6)                                    0466
@DL00466 DS    0H                                                  0467
*         /***********************************************************/
*         /*                                                         */
*         /*    CLEAR THE ENTRY.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0467
*           RSXCIENT(RSIDX) = ''B;                                 0467
*                                                                  0467
         LH    @04,RSIDX(,REG6)                                    0467
         SLA   @04,4                                               0467
         L     @01,RSCIXLTA(,REG6)                                 0467
         ALR   @01,@04                                             0467
         AL    @01,@CF03776                                        0467
         XC    RSXCIENT-8(16,@01),RSXCIENT-8(@01)                  0467
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS ANOTHER EXTENT DESCRIPTOR.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0468
*           IF VARLEN ^= 0                                         0468
*             THEN                                                 0468
         L     @04,RSCPE7(,REG6)                                   0468
         ICM   @15,3,VARLEN(@04)                                   0468
         BZ    @RF00468                                            0468
*CATIEX:        DO;                                                0469
*                                                                  0469
CATIEX   DS    0H                                                  0470
*         /***********************************************************/
*         /*                                                         */
*         /*    HIGH KEY RANGE EXTENT.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0470
*                 RSCILCI = CATILRBA/CILEN;                        0470
         L     @04,RSCIEXPT(,REG6)                                 0470
         L     @00,CATILRBA(,@04)                                  0470
         SRDA  @00,32                                              0470
         D     @00,@CF00745                                        0470
         ST    @01,RSCILCI(,REG6)                                  0470
*                 IF RSCILCI ^= RSCINXCI                           0471
*                   THEN                                           0471
         C     @01,RSCINXCI(,REG6)                                 0471
         BE    @RF00471                                            0471
*CATIHKR:             DO;                                          0472
*                                                                  0472
CATIHKR  DS    0H                                                  0473
*         /***********************************************************/
*         /*                                                         */
*         /*    SET HKR FLAG, STARTING CI, COUNT OF CIS AND          */
*         /*    TRANSLATION FACTOR OF 1 IN CIXLT ENTRY.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0473
*                       RSXCIRNG(RSIDX) = ON;                      0473
         LH    @04,RSIDX(,REG6)                                    0473
         SLA   @04,4                                               0473
         L     @15,RSCIXLTA(,REG6)                                 0473
         ST    @04,@TF00001                                        0473
         ALR   @04,@15                                             0473
         OI    RSXCIRNG-16(@04),B'10000000'                        0473
*                       RSXCIBEG(RSIDX) = RSCINXCI;                0474
         L     @04,RSCINXCI(,REG6)                                 0474
         L     @14,@TF00001                                        0474
         AL    @14,@CF03776                                        0474
         ST    @04,RSXCIBEG-8(@14,@15)                             0474
*                       RSCINXCI = RSCILCI;                        0475
         L     @14,RSCILCI(,REG6)                                  0475
         ST    @14,RSCINXCI(,REG6)                                 0475
*                       RSXCILN(RSIDX) = RSCINXCI - RSXCIBEG(RSIDX);
         SLR   @14,@04                                             0476
         L     @04,@TF00001                                        0476
         AL    @04,@CF03777                                        0476
         ST    @14,RSXCILN-12(@04,@15)                             0476
*                       RSXCIREL(RSIDX) = 1;                       0477
*                                                                  0477
         LA    @04,1                                               0477
         L     @14,@TF00001                                        0477
         ST    @04,RSXCIREL-16(@14,@15)                            0477
*                     END CATIHKR;                                 0478
*                                                                  0478
*         /***********************************************************/
*         /*                                                         */
*         /*    LOW KEY RANGE EXTENT.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0479
*                   ELSE                                           0479
*CATILKR:             DO;                                          0479
*                                                                  0479
         B     @RC00471                                            0479
@RF00471 DS    0H                                                  0479
CATILKR  DS    0H                                                  0480
*         /***********************************************************/
*         /*                                                         */
*         /*    SET LKR FLAG, STARTING CI, COUNT OF CIS AND          */
*         /*    TRANSLATION FACTOR OF 1 IN CIXLT ENTRY.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0480
*                       RSXCIRNG(RSIDX) = OFF;                     0480
         LH    @04,RSIDX(,REG6)                                    0480
         LR    @15,@04                                             0480
         SLA   @15,4                                               0480
         L     @14,RSCIXLTA(,REG6)                                 0480
         ST    @15,@TF00001                                        0480
         ALR   @15,@14                                             0480
         NI    RSXCIRNG-16(@15),B'01111111'                        0480
*                       RSCISVLK = RSIDX;                          0481
         STC   @04,RSCISVLK(,REG6)                                 0481
*                       RSXCIBEG(RSIDX) = RSCINXCI;                0482
         L     @04,RSCINXCI(,REG6)                                 0482
         L     @15,@TF00001                                        0482
         AL    @15,@CF03776                                        0482
         ST    @04,RSXCIBEG-8(@15,@14)                             0482
*                       RSCINXCI = CATIHRBA/CILEN + 1;             0483
         LA    @15,1                                               0483
         L     @01,RSCIEXPT(,REG6)                                 0483
         L     @00,CATIHRBA(,@01)                                  0483
         SRDA  @00,32                                              0483
         D     @00,@CF00745                                        0483
         ALR   @01,@15                                             0483
         ST    @01,RSCINXCI(,REG6)                                 0483
*                       RSXCILN(RSIDX) = RSCINXCI - RSXCIBEG(RSIDX);
         SLR   @01,@04                                             0484
         L     @04,@TF00001                                        0484
         AL    @04,@CF03777                                        0484
         ST    @01,RSXCILN-12(@04,@14)                             0484
*                       RSXCIREL(RSIDX) = 1;                       0485
*                                                                  0485
         L     @04,@TF00001                                        0485
         ST    @15,RSXCIREL-16(@04,@14)                            0485
*         /***********************************************************/
*         /*                                                         */
*         /*    DECREMENT VARIABLE LENGTH BY LENGTH OF THIS EXTENT.  */
*         /*    IF THERE IS ANOTHER EXTENT, MOVE IT TO THE SAVE AREA.*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0486
*                       VARLEN = VARLEN - LENGTH(CATIEXT);         0486
         L     @04,RSCPE7(,REG6)                                   0486
         LA    @15,20                                              0486
         ICM   @14,12,VARLEN(@04)                                  0486
         SRA   @14,16                                              0486
         SLR   @14,@15                                             0486
         STCM  @14,3,VARLEN(@04)                                   0486
*                       IF VARLEN ^= 0                             0487
*                         THEN                                     0487
         LTR   @14,@14                                             0487
         BZ    @RF00487                                            0487
*                           DO;                                    0488
*                             RSCIEXCU = RSCIEXCU + LENGTH(CATIEXT);
         AL    @15,RSCIEXCU(,REG6)                                 0489
         ST    @15,RSCIEXCU(,REG6)                                 0489
*                             RSCIEXT = RSCIEXCU -> CATIEXT;       0490
         MVC   RSCIEXT(20,REG6),CATIEXT(@15)                       0490
*                           END;                                   0491
*                                                                  0491
*                     END CATILKR;                                 0492
*                                                                  0492
*               END CATIEX;                                        0493
*                                                                  0493
*         /***********************************************************/
*         /*                                                         */
*         /*  NO MORE EXTENT DESCRIPTORS TO PROCESS.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0494
*             ELSE                                                 0494
*CATINOEX:      DO;                                                0494
*                                                                  0494
         B     @RC00468                                            0494
@RF00468 DS    0H                                                  0494
CATINOEX DS    0H                                                  0495
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS LAST HKR EXTENT.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0495
*                 IF RSCINXCI <= RSCAHACI                          0495
*                   THEN                                           0495
         L     @04,RSCINXCI(,REG6)                                 0495
         C     @04,RSCAHACI(,REG6)                                 0495
         BH    @RF00495                                            0495
*CATILH:              DO;                                          0496
*                                                                  0496
CATILH   DS    0H                                                  0497
*         /***********************************************************/
*         /*                                                         */
*         /*    SET HKR FLAG, STARTING CI, COUNT OF CIS AND          */
*         /*    TRANSLATION FACTOR OF 0 (NOT ACTIVE) IN ENTRY.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0497
*                       RSXCIRNG(RSIDX) = ON;                      0497
         LH    @04,RSIDX(,REG6)                                    0497
         LR    @15,@04                                             0497
         SLA   @15,4                                               0497
         L     @14,RSCIXLTA(,REG6)                                 0497
         ST    @15,@TF00001                                        0497
         ALR   @15,@14                                             0497
         OI    RSXCIRNG-16(@15),B'10000000'                        0497
*                       RSXCIBEG(RSIDX) = RSCINXCI;                0498
         L     @15,RSCINXCI(,REG6)                                 0498
         L     @01,@TF00001                                        0498
         AL    @01,@CF03776                                        0498
         ST    @15,RSXCIBEG-8(@01,@14)                             0498
*                       RSCINXCI = RSCAHACI + 1;                   0499
         LA    @03,1                                               0499
         L     @02,RSCAHACI(,REG6)                                 0499
         ALR   @02,@03                                             0499
         ST    @02,RSCINXCI(,REG6)                                 0499
*                       RSXCILN(RSIDX) = RSCINXCI - RSXCIBEG(RSIDX);
         SLR   @02,@15                                             0500
         L     @15,@TF00001                                        0500
         AL    @15,@CF03777                                        0500
         ST    @02,RSXCILN-12(@15,@14)                             0500
*                       RSIDX = RSIDX + 1;                         0501
         ALR   @04,@03                                             0501
         STH   @04,RSIDX(,REG6)                                    0501
*                       RSXCIENT(RSIDX) = ''B;                     0502
*                                                                  0502
         SLA   @04,4                                               0502
         ALR   @14,@04                                             0502
         AL    @14,@CF03776                                        0502
         XC    RSXCIENT-8(16,@14),RSXCIENT-8(@14)                  0502
*                     END CATILH;                                  0503
*                                                                  0503
*         /***********************************************************/
*         /*                                                         */
*         /*    SET UP REMAINING ENTRIES IN CIXLT TABLE.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0504
*                                                                  0504
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPUTE DEFAULT COUNT OF CIS FOR REMAINING ENTRIES.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0504
*                 IF RSCIDFCI = 0                                  0504
*                   THEN                                           0504
@RF00495 SLR   @04,@04                                             0504
         C     @04,RSCIDFCI(,REG6)                                 0504
         BNE   @RF00504                                            0504
*                     DO;                                          0505
*                       IF RSCATSCN ^= 0 THEN /*CAT HAS SCNDY SPC    */
         L     @15,RSCATSCN(,REG6)                                 0506
         CR    @15,@04                                             0506
         BE    @RF00506                                            0506
*                         DO;                                      0507
*                           RSCIRMEN = DIM(RSXCIENT) - MAXEXTNT;   0508
         MVC   RSCIRMEN(4,REG6),@CF03733                           0508
*                           RSCIREMC = RSCINXCI +                  0509
*                                      (MAXEXTNT + 1 - RSIDX)*RSCATSCN;
         LA    @01,17                                              0509
         SH    @01,RSIDX(,REG6)                                    0509
         MR    @00,@15                                             0509
         AL    @01,RSCINXCI(,REG6)                                 0509
         ST    @01,RSCIREMC(,REG6)                                 0509
*                         END;                                     0510
*                       ELSE           /*CAT HAS NO SECONDARY SPACE  */
*                         DO;                                      0511
         B     @RC00506                                            0511
@RF00506 DS    0H                                                  0512
*                           RSCIRMEN = DIM(RSXCIENT) - (RSIDX - 1);
         LA    @04,1                                               0512
         SH    @04,RSIDX(,REG6)                                    0512
         AL    @04,@CF01850                                        0512
         ST    @04,RSCIRMEN(,REG6)                                 0512
*                           RSCIREMC = RSCINXCI;                   0513
         L     @04,RSCINXCI(,REG6)                                 0513
         ST    @04,RSCIREMC(,REG6)                                 0513
*                         END;                                     0514
*                       RSCIDFCI = (MAXCINO - RSCIREMC             0515
*                                  + RSCIRMEN)/RSCIRMEN;           0515
@RC00506 L     @04,MAXCINO                                         0515
         SL    @04,RSCIREMC(,REG6)                                 0515
         L     @15,RSCIRMEN(,REG6)                                 0515
         ALR   @04,@15                                             0515
         LR    @00,@04                                             0515
         SRDA  @00,32                                              0515
         DR    @00,@15                                             0515
         ST    @01,RSCIDFCI(,REG6)                                 0515
*                     END;                                         0516
*                                                                  0516
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPUTE DEFAULT COUNT OF CIS FOR LAST ENTRY.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0517
*                 IF RSIDX = DIM(RSXCIENT)                         0517
*                   THEN                                           0517
@RF00504 CLC   RSIDX(2,REG6),@CH01850                              0517
         BNE   @RF00517                                            0517
*                     RSCIDFCI = MAXCINO + 1 - RSCINXCI;           0518
*                                                                  0518
         LA    @04,1                                               0518
         AL    @04,MAXCINO                                         0518
         SL    @04,RSCINXCI(,REG6)                                 0518
         ST    @04,RSCIDFCI(,REG6)                                 0518
*         /***********************************************************/
*         /*                                                         */
*         /*    SET LKR FLAG, STARTING CI, COUNT OF CIS AND          */
*         /*    TRANSLATION FACTOR OF 0 (NOT ACTIVE) IN ENTRY.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0519
*                 RSXCIRNG(RSIDX) = OFF;                           0519
@RF00517 LH    @04,RSIDX(,REG6)                                    0519
         LR    @15,@04                                             0519
         SLA   @15,4                                               0519
         L     @14,RSCIXLTA(,REG6)                                 0519
         ST    @15,@TF00001                                        0519
         ALR   @15,@14                                             0519
         NI    RSXCIRNG-16(@15),B'01111111'                        0519
*                 RSXCIBEG(RSIDX) = RSCINXCI;                      0520
         L     @15,RSCINXCI(,REG6)                                 0520
         L     @01,@TF00001                                        0520
         AL    @01,@CF03776                                        0520
         ST    @15,RSXCIBEG-8(@01,@14)                             0520
*                 IF RSIDX =< MAXEXTNT & RSCATSCN ^= 0             0521
*                   THEN                                           0521
         C     @04,@CF00478                                        0521
         BH    @RF00521                                            0521
         L     @04,RSCATSCN(,REG6)                                 0521
         LTR   @04,@04                                             0521
         BZ    @RF00521                                            0521
*                     DO;                                          0522
*                       RSCINXCI = RSXCIBEG(RSIDX) + RSCATSCN;     0523
         ALR   @15,@04                                             0523
         ST    @15,RSCINXCI(,REG6)                                 0523
*                       RSXCILN(RSIDX) = RSCATSCN;                 0524
         L     @15,@TF00001                                        0524
         AL    @14,@CF03777                                        0524
         ST    @04,RSXCILN-12(@15,@14)                             0524
*                     END;                                         0525
*                   ELSE                                           0526
*                     DO;                                          0526
         B     @RC00521                                            0526
@RF00521 DS    0H                                                  0527
*                       RSCINXCI = RSXCIBEG(RSIDX) + RSCIDFCI;     0527
         LH    @04,RSIDX(,REG6)                                    0527
         SLA   @04,4                                               0527
         L     @15,RSCIXLTA(,REG6)                                 0527
         L     @14,RSCIDFCI(,REG6)                                 0527
         LA    @01,0(@04,@15)                                      0527
         AL    @01,@CF03776                                        0527
         L     @03,RSXCIBEG-8(,@01)                                0527
         ALR   @03,@14                                             0527
         ST    @03,RSCINXCI(,REG6)                                 0527
*                       RSXCILN(RSIDX) = RSCIDFCI;                 0528
         AL    @15,@CF03777                                        0528
         ST    @14,RSXCILN-12(@04,@15)                             0528
*                     END;                                         0529
*                                                                  0529
*               END CATINOEX;                                      0530
*                                                                  0530
@RC00521 DS    0H                                                  0531
*         END CATILP2;                                             0531
*                                                                  0531
@RC00468 LA    @04,1                                               0531
         AH    @04,RSIDX(,REG6)                                    0531
         STH   @04,RSIDX(,REG6)                                    0531
         C     @04,@CF01850                                        0531
         BNH   @DL00466                                            0531
*         /***********************************************************/
*         /*                                                         */
*         /*  PRESERVE UNFORMATTED FREE RECORDS FOR EOV.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0532
*         RSCAHALC = RSXCIBEG(RSCISVLK) + RSXCILN(RSCISVLK) - 1;   0532
         SLR   @04,@04                                             0532
         IC    @04,RSCISVLK(,REG6)                                 0532
         SLA   @04,4                                               0532
         L     @15,RSCIXLTA(,REG6)                                 0532
         LA    @01,0(@04,@15)                                      0532
         AL    @01,@CF03776                                        0532
         L     @14,RSXCIBEG-8(,@01)                                0532
         AL    @15,@CF03777                                        0532
         AL    @14,RSXCILN-12(@04,@15)                             0532
         BCTR  @14,0                                               0532
         ST    @14,RSCAHALC(,REG6)                                 0532
*         RSCANFCN = RSCAHALC + 1 - RSCANFCI;                      0533
*                                                                  0533
         AL    @14,@CF00219                                        0533
         SL    @14,RSCANFCI(,REG6)                                 0533
         ST    @14,RSCANFCN(,REG6)                                 0533
*         IF RSCANFCN > 4                                          0534
*           THEN                                                   0534
         LA    @04,4                                               0534
         CR    @14,@04                                             0534
         BNH   @RF00534                                            0534
*             RSCANFCN = 4;                                        0535
*                                                                  0535
         ST    @04,RSCANFCN(,REG6)                                 0535
*         IF RSCANFCN < 0                                          0536
*           THEN                                                   0536
@RF00534 SLR   @04,@04                                             0536
         C     @04,RSCANFCN(,REG6)                                 0536
         BNH   @RF00536                                            0536
*             RSCANFCN = 0;                                        0537
*                                                                  0537
         ST    @04,RSCANFCN(,REG6)                                 0537
*         RSCAFUCI = RSCAHALC + 1 - RSCANFCN;                      0538
*                                                                  0538
@RF00536 LA    @04,1                                               0538
         AL    @04,RSCAHALC(,REG6)                                 0538
         SL    @04,RSCANFCN(,REG6)                                 0538
         ST    @04,RSCAFUCI(,REG6)                                 0538
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0539
*         IF GDTDBG = NULLPTR                                      0539
*           THEN;                                                  0539
         L     @04,GDTDBG(,REG5)                                   0539
         LTR   @04,@04                                             0539
         BZ    @RT00539                                            0539
*           ELSE                                                   0541
*             CALL IDCDB010 (GDTTBL,'RSC1');                       0541
*                                                                  0541
         ST    REG5,@AL00001                                       0541
         LA    @04,@CC03515                                        0541
         ST    @04,@AL00001+4                                      0541
         MVI   @AL00001+4,X'80'                                    0541
         L     @15,GDTDBG(,REG5)                                   0541
         LA    @01,@AL00001                                        0541
         BALR  @14,@15                                             0541
* CALL EXIT;  /*TERMINATE*/                                        0542
@RT00539 BAL   @14,EXIT                                            0542
* END CATINIT; /*END OF PROCEDURE*/                                0543
*                                                                  0543
@EL00003 DS    0H                                                  0543
@EF00003 DS    0H                                                  0543
@ER00003 BR    @14                                                 0543
@PB00003 DS    0H                                                  0544
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - COPYCAT                                         */
*/*                                                                  */
*/* FUNCTION - THIS SEGMENT PERFORMS THE INITIAL LOAD OF THE         */
*/*            WORKFILE FROM THE CATALOG TO BE RESET.                */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0544
         DS    0F
NAME0025 DC    CL8'COPYCAT'
*COPYCAT: PROCEDURE                                                0545
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0545
*                                                                  0545
         B     @PB00004                                            0545
COPYCAT  DS    0H                                                  0546
*      GENERATE REFS(RS01RG08, REG6);                              0546
*                                                                  0546
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0025  PROCNAME TO REGSAVE
*         RFY RESVOL BASED(RSENTPT);                               0547
*         RFY VOLSERTB BASED(RSENTPT);                             0548
*                                                                  0548
*         OLDERID2 = NEWERID2;                                     0549
         L     @04,GDTTR2(,REG5)                                   0549
         MVC   @TS00001(95),NEWERID2(@04)                          0549
         MVC   OLDERID2(95,@04),@TS00001                           0549
*         NEWID2 = 'RSCO';                                         0550
*                                                                  0550
         MVC   NEWID2(4,@04),@CC03521                              0550
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZATION.                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0551
*         /***********************************************************/
*         /*                                                         */
*         /*    SET VOLSERTB ANCHOR TO 0. SET AVAILABLE COUNT AND    */
*         /*    AVAILABLE CHAIN ANCHOR TO 0. SET CURRENT             */
*         /*    RELATIVE RECORD NUMBER TO 1.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0551
*         RSVOLLST = 0;                                            0551
         SLR   @04,@04                                             0551
         ST    @04,RSVOLLST(,REG6)                                 0551
*         RSAVAIL  = 0;                                            0552
         ST    @04,RSAVAIL(,REG6)                                  0552
*         RSAVAILN = 0;                                            0553
         ST    @04,RSAVAILN(,REG6)                                 0553
*         RSCURRN  = 1;                                            0554
*                                                                  0554
         LA    @04,1                                               0554
         ST    @04,RSCURRN(,REG6)                                  0554
*         /***********************************************************/
*         /*                                                         */
*         /*    SET GRAB, RAB AND BUFFER POINTERS FOR WORKFILE       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0555
*         RSGRABCU = ADDR(GRABSWF);                                0555
         L     @15,RSIOTBL(,REG6)                                  0555
         ST    @15,RSGRABCU(,REG6)                                 0555
*         GRABCURR = GRABRAB1;                                     0556
         L     @14,GRABRAB1(,@15)                                  0556
         ST    @14,GRABCURR(,@15)                                  0556
*         RSWFBP1 = ADDR(RABBUF);                                  0557
*                                                                  0557
         LA    @15,RABBUF(,@14)                                    0557
         ST    @15,RSWFBP1(,REG6)                                  0557
*         /***********************************************************/
*         /*                                                         */
*         /*    WORKFILE WAS PREVIOUSLY LOADED. MUST POSITION        */
*         /*    TO THE END OF THE DATA SET IN CASE RECORDS MUST      */
*         /*    BE ADDED AT THE END                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0558
*         IF RSWFCREA = ON                                         0558
*           THEN                                                   0558
         TM    RSWFCREA(REG6),B'00100000'                          0558
         BNO   @RF00558                                            0558
*             DO;                                                  0559
*               RABRCDA = RSWFHURR + 1;                            0560
         AL    @04,RSWFHURR(,REG6)                                 0560
         ST    @04,RABRCDA(,@14)                                   0560
*               RABRRN = ON;                                       0561
*                                                                  0561
*                                                                  0561
         OI    RABRRN(@14),B'00010000'                             0561
*               DO;                                                0562
*                 RSRTYPE = ''B;                                   0563
         MVI   RSRTYPE(REG6),X'00'                                 0563
*                 RSRPOS = ON;      /* POSRCD  */                  0564
         OI    RSRPOS(REG6),B'00010000'                            0564
*                 RSRDS = ''B;                                     0565
         NI    RSRDS(REG6),B'00011111'                             0565
*                 RSRWF = ON;       /* WORKFILE  */                0566
*                 RSRDIR = OFF;     /* SEQUENTIAL  */              0567
*                 RSRKEY = ON;      /* KEY  */                     0568
*                                                                  0568
         OI    RSRWF(REG6),B'10010000'                             0568
         NI    RSRDIR(REG6),B'11111011'                            0568
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */
*               CALL RECMGMT;                                      0569
         L     @15,@CV03498                                        0569
         BALR  @14,@15                                             0569
*                 RFY RTNREG RSTD;                                 0570
*                 TESTRC = RTNREG;                                 0571
         STH   RTNREG,TESTRC(,REG6)                                0571
*                 RFY RTNREG UNRSTD;                               0572
*               END;                                               0573
*                                                                  0573
*               RABRRN = OFF;                                      0574
         L     @04,RSGRABCU(,REG6)                                 0574
         L     @04,GRABCURR(,@04)                                  0574
         NI    RABRRN(@04),B'11101111'                             0574
*             END;                                                 0575
*                                                                  0575
*         /***********************************************************/
*         /*                                                         */
*         /*    SET GRAB, RAB AND BUFFER POINTERS FOR CATALOG        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0576
*         RSGRABCU = ADDR(GRABSCA);                                0576
@RF00558 L     @04,RSIOTBL(,REG6)                                  0576
         LA    @04,GRABSCA(,@04)                                   0576
         ST    @04,RSGRABCU(,REG6)                                 0576
*         GRABCURR = GRABRAB1;                                     0577
         L     @15,GRABRAB1(,@04)                                  0577
         ST    @15,GRABCURR(,@04)                                  0577
*         RSCABLP1 = ADDR(RABBUF);                                 0578
*                                                                  0578
         LA    @15,RABBUF(,@15)                                    0578
         ST    @15,RSCABLP1(,REG6)                                 0578
*         /***********************************************************/
*         /*                                                         */
*         /*  SET CATALOG GRABS FLAGS FOR SPECIAL I/O ERROR          */
*         /*  HANDLING.                                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0579
*         GRABAFLS = ''B;                                          0579
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0579
*         GRABSIOI = ON;                                           0580
*         GRABSIOF = ON;                                           0581
*                                                                  0581
         OI    GRABSIOI(@04),B'00011000'                           0581
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS CURRENT CATALOG EXTENTS VIA CIXLT TABLE.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0582
*COPYLP1: DO RSIDX = 1 TO DIM(RSXCIENT)                            0582
*             WHILE (RSXCIBEG(RSIDX) <= RSCAHALC);                 0582
*                                                                  0582
COPYLP1  LA    @04,1                                               0582
         STH   @04,RSIDX(,REG6)                                    0582
@DL00582 LH    @04,RSIDX(,REG6)                                    0582
         SLA   @04,4                                               0582
         L     @15,RSCIXLTA(,REG6)                                 0582
         LA    @01,0(@04,@15)                                      0582
         AL    @01,@CF03776                                        0582
         L     @14,RSXCIBEG-8(,@01)                                0582
         C     @14,RSCAHALC(,REG6)                                 0582
         BH    @DC00582                                            0582
*         /***********************************************************/
*         /*                                                         */
*         /*  COMPUTE LAST CONTROL INTERVAL NUMBER (CI) IN THIS      */
*         /*  CIXLT ENTRY.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0583
*           RSXCIEND = RSXCIBEG(RSIDX) + RSXCILN(RSIDX) - 1;       0583
*                                                                  0583
         LA    @01,0(@04,@15)                                      0583
         AL    @01,@CF03777                                        0583
         AL    @14,RSXCILN-12(,@01)                                0583
         BCTR  @14,0                                               0583
         ST    @14,RSXCIEND(,REG6)                                 0583
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS HIGH KEY RANGE EXTENT RECORDS.                 */
*         /*  THESE RECORDS WILL BE REPRESENTED IN THE WORKFILE      */
*         /*  AS DUMMY INVALID RECORDS.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0584
*           IF RSXCIRNG(RSIDX) = ON                                0584
*             THEN                                                 0584
         ALR   @15,@04                                             0584
         TM    RSXCIRNG-16(@15),B'10000000'                        0584
         BNO   @RF00584                                            0584
*COPYHKR:       DO;                                                0585
*                                                                  0585
COPYHKR  DS    0H                                                  0586
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CURRENT GRAB POINTER FOR WORKFILE GRABS.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0586
*                 RSGRABCU = ADDR(GRABSWF);                        0586
*                                                                  0586
         L     @04,RSIOTBL(,REG6)                                  0586
         ST    @04,RSGRABCU(,REG6)                                 0586
*         /***********************************************************/
*         /*                                                         */
*         /*    SET INVALID FLAG IN WORKFILE PROCESSING AREA AND     */
*         /*    CLEAR WORKFILE BUFFER.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0587
*                 RSWFLD = ''B;                                    0587
         L     @04,GRABCURR(,@04)                                  0587
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0587
*                 RSWINVCI = ON;                                   0588
         OI    RSWINVCI(@04),B'10000000'                           0588
*                 WFBUF1(1:256) = ''B;                             0589
         L     @04,RSWFBP1(,REG6)                                  0589
         XC    WFBUF1(256,@04),WFBUF1(@04)                         0589
*                 WFBUF1(257:CELEN) = ''B;                         0590
*                                                                  0590
         XC    WFBUF1+256(249,@04),WFBUF1+256(@04)                 0590
*         /***********************************************************/
*         /*                                                         */
*         /*    WRITE A DUMMY RECORD TO THE WORKFILE FOR EACH RECORD */
*         /*    IN THIS EXTENT.                                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0591
*COPYLP2:         DO RSCURCI = RSXCIBEG(RSIDX) TO RSXCIEND;        0591
*                                                                  0591
COPYLP2  LH    @04,RSIDX(,REG6)                                    0591
         SLA   @04,4                                               0591
         L     @01,RSCIXLTA(,REG6)                                 0591
         AL    @01,@CF03776                                        0591
         L     @04,RSXCIBEG-8(@04,@01)                             0591
         B     @DE00591                                            0591
@DL00591 DS    0H                                                  0592
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CONTROL INTERVAL NUMBER IN RECORD TO CURRENT CI. */
*         /*    WRITE THE RECORD TO THE WORKFILE VIA COPYADD.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0592
*                   RCDCINO = RSCURCI;                             0592
*                                                                  0592
         L     @04,RSGRABCU(,REG6)                                 0592
         L     @04,GRABCURR(,@04)                                  0592
         MVC   RCDCINO+8(3,@04),RSCURCI+1(REG6)                    0592
*                   CALL COPYADD;                                  0593
*                                                                  0593
         BAL   @14,COPYADD                                         0593
*                 END COPYLP2;                                     0594
*                                                                  0594
         LA    @04,1                                               0594
         AL    @04,RSCURCI(,REG6)                                  0594
@DE00591 ST    @04,RSCURCI(,REG6)                                  0594
         C     @04,RSXCIEND(,REG6)                                 0594
         BNH   @DL00591                                            0594
*               END COPYHKR;                                       0595
*                                                                  0595
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS LOW KEY RANGE EXTENT RECORDS.                  */
*         /*  COPY FORMATTED RECORDS FROM CATALOG TO WORKFILE.       */
*         /*  REPRESENT UNFORMATTED RECORDS AS DUMMY RECORDS IN      */
*         /*  THE WORKFILE.                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0596
*           IF RSXCIRNG(RSIDX) = OFF                               0596
*             THEN                                                 0596
@RF00584 LH    @04,RSIDX(,REG6)                                    0596
         SLA   @04,4                                               0596
         L     @01,RSCIXLTA(,REG6)                                 0596
         ALR   @01,@04                                             0596
         TM    RSXCIRNG-16(@01),B'10000000'                        0596
         BNZ   @RF00596                                            0596
*COPYLKR:       DO;                                                0597
*                                                                  0597
COPYLKR  DS    0H                                                  0598
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS EACH RECORD IN THIS EXTENT.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0598
*COPYLP3:         DO RSCURCI = RSXCIBEG(RSIDX) TO RSXCIEND;        0598
*                                                                  0598
COPYLP3  LH    @04,RSIDX(,REG6)                                    0598
         SLA   @04,4                                               0598
         L     @01,RSCIXLTA(,REG6)                                 0598
         AL    @01,@CF03776                                        0598
         L     @04,RSXCIBEG-8(@04,@01)                             0598
         B     @DE00598                                            0598
@DL00598 DS    0H                                                  0599
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS FORMATTED RECORDS.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0599
*                   IF RSCURCI < RSCANFCI                          0599
*                     THEN                                         0599
         L     @04,RSCURCI(,REG6)                                  0599
         C     @04,RSCANFCI(,REG6)                                 0599
         BNL   @RF00599                                            0599
*COPYFMT:               DO;                                        0600
*                                                                  0600
COPYFMT  DS    0H                                                  0601
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CURRENT GRAB POINTER FOR THE CATALOG GRAB.       */
*         /*    SET ARGUMENT TO CURRENT CI.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0601
*                         RSGRABCU = ADDR(GRABSCA);                0601
         L     @04,RSIOTBL(,REG6)                                  0601
         LA    @04,GRABSCA(,@04)                                   0601
         ST    @04,RSGRABCU(,REG6)                                 0601
*                         RABRCDA = RSCURCI;                       0602
*                                                                  0602
         L     @04,GRABCURR(,@04)                                  0602
         L     @15,RSCURCI(,REG6)                                  0602
         ST    @15,RABRCDA(,@04)                                   0602
*         /***********************************************************/
*         /*                                                         */
*         /*    RETRIEVE THE CATALOG RECORD VIA RECMGMT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0603
*                                                                  0603
*                         DO;                                      0603
*                           RSRTYPE = ''B;                         0604
         MVI   RSRTYPE(REG6),X'00'                                 0604
*                           RSRGET = ON;      /* GETRCD  */        0605
         OI    RSRGET(REG6),B'10000000'                            0605
*                           RSRUPD = OFF;     /* NO UPDATE  */     0606
         NI    RSRUPD(REG6),B'11110111'                            0606
*                           RSRDS = ''B;                           0607
         NI    RSRDS(REG6),B'00011111'                             0607
*                           RSRCAT = ON;      /* CATALOG  */       0608
*                           RSRDIR = ON;      /* DIRECT  */        0609
*                           RSRKEY = OFF;     /* CNV  */           0610
*                                                                  0610
         OI    RSRCAT(REG6),B'01000100'                            0610
         NI    RSRKEY(REG6),B'11101111'                            0610
*                         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMG
*T                                                                   */
*                         CALL RECMGMT;                            0611
         L     @15,@CV03498                                        0611
         BALR  @14,@15                                             0611
*                           RFY RTNREG RSTD;                       0612
*                           TESTRC = RTNREG;                       0613
         STH   RTNREG,TESTRC(,REG6)                                0613
*                           RFY RTNREG UNRSTD;                     0614
*                         END;                                     0615
*                                                                  0615
*         /***********************************************************/
*         /*                                                         */
*         /*    MOVE THE CATALOG RECORD TO THE WORKFILE RECORD BUFFER*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0616
*                         WFBUF1(1:256) = CABUFL1(1:256);          0616
         L     @04,RSWFBP1(,REG6)                                  0616
         L     @15,RSCABLP1(,REG6)                                 0616
         MVC   WFBUF1(256,@04),CABUFL1(@15)                        0616
*                         WFBUF1(257:CELEN) = CABUFL1(257:CELEN);  0617
*                                                                  0617
         MVC   WFBUF1+256(249,@04),CABUFL1+256(@15)                0617
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CURRENT GRAB POINTER FOR WORKFILE GRABS.         */
*         /*    CLEAR WORKFILE PROCESSING FIELD.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0618
*                         RSGRABCU = ADDR(GRABSWF);                0618
         L     @04,RSIOTBL(,REG6)                                  0618
         ST    @04,RSGRABCU(,REG6)                                 0618
*                         RSWFLD = ''B;                            0619
*                                                                  0619
         L     @15,GRABCURR(,@04)                                  0619
         XC    RSWFLD(10,@15),RSWFLD(@15)                          0619
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG RECORD NOT RETRIEVED DUE TO AN I/O ERROR     */
*         /*    ON GET. A DUMMY RECORD HAS BEEN FORMATTED IN THE     */
*         /*    BUFFER. INDICATE THE RECORD IS INVALID.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0620
*                         IF ADDR(GRABSCA) -> GRABCURR ->          0620
*                              RABIOIGN = ON                       0620
*                           THEN                                   0620
         L     @04,GRABCURR+40(,@04)                               0620
         TM    RABIOIGN(@04),B'00000100'                           0620
         BNO   @RF00620                                            0620
*                             DO;                                  0621
*                               ADDR(GRABSCA) -> GRABCURR ->       0622
*                                   RABIOIGN = OFF;                0622
         NI    RABIOIGN(@04),B'11111011'                           0622
*                               RSWINVCI = ON;                     0623
         OI    RSWINVCI(@15),B'10000000'                           0623
*                             END;                                 0624
*                                                                  0624
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG RECORD WAS RETRIEVED SUCCESSFULLY.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0625
*                           ELSE                                   0625
*COPYGOK:                     DO;                                  0625
*                                                                  0625
         B     @RC00620                                            0625
@RF00620 DS    0H                                                  0625
COPYGOK  DS    0H                                                  0626
*         /***********************************************************/
*         /*                                                         */
*         /*    VOLUME RECORD. ADD AN ENTRY TO VOLSERTB              */
*         /*    VIA BLDVLST.                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0626
*                               IF RCDID = VOLID                   0626
*                                 THEN                             0626
         L     @04,RSGRABCU(,REG6)                                 0626
         L     @04,GRABCURR(,@04)                                  0626
         LA    @15,8                                               0626
         ALR   @15,@04                                             0626
         CLI   RCDID(@15),C'V'                                     0626
         BNE   @RF00626                                            0626
*                                   DO;                            0627
*                                     RSENTPT = ADDR(RSVUENT);     0628
         L     @01,RSIOTBL(,REG6)                                  0628
         LA    @14,RSVUENT(,@01)                                   0628
         ST    @14,RSENTPT(,REG6)                                  0628
*                                     VOLSERTB = ''B;              0629
         XC    VOLSERTB(28,@14),VOLSERTB(@14)                      0629
*                                     VOLSRSER = CNAME(1:6);       0630
         MVC   VOLSRSER(6,@14),CNAME(@15)                          0630
*                                     VOLSRCI = RCDCINO;           0631
         L     @15,RCDCINO-1(,@15)                                 0631
         LA    @15,0(,@15)                                         0631
         ST    @15,VOLSRCI(,@14)                                   0631
*                                     VOLSRNTK = RTNOTRKS;         0632
*                                                                  0632
         MVC   VOLSRNTK(2,@14),RTNOTRKS(@04)                       0632
*                                     /* CALL TO MODULE IDCRS05 FOR PRO
*EDURE BLDVLST                                                       */
*                                     CALL IDCRS5BV(RSENTPT);      0633
*                                                                  0633
         LA    @04,RSENTPT(,REG6)                                  0633
         ST    @04,@AL00001                                        0633
         L     @15,@CV03538                                        0633
         LA    @01,@AL00001                                        0633
         BALR  @14,@15                                             0633
*                                   END;                           0634
*                                                                  0634
*         /***********************************************************/
*         /*                                                         */
*         /*    FREE RECORD. PLACE IT ON THE AVAILABLE CHAIN.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0635
*                               IF RCDID = FREEID                  0635
*                                 THEN                             0635
@RF00626 L     @04,RSGRABCU(,REG6)                                 0635
         L     @04,GRABCURR(,@04)                                  0635
         LA    @15,8                                               0635
         ALR   @15,@04                                             0635
         CLI   RCDID(@15),C'F'                                     0635
         BNE   @RF00635                                            0635
*                                   DO;                            0636
*                                     RSAVAILN = RSAVAILN + 1;     0637
         LA    @14,1                                               0637
         AL    @14,RSAVAILN(,REG6)                                 0637
         ST    @14,RSAVAILN(,REG6)                                 0637
*                                     RSWCHPTR = RSAVAIL;          0638
         L     @14,RSAVAIL(,REG6)                                  0638
         ST    @14,RSWCHPTR(,@04)                                  0638
*                                     RSAVAIL = RCDCINO;           0639
         L     @04,RCDCINO-1(,@15)                                 0639
         LA    @04,0(,@04)                                         0639
         ST    @04,RSAVAIL(,REG6)                                  0639
*                                   END;                           0640
*                                                                  0640
*         /***********************************************************/
*         /*                                                         */
*         /*    RECORD IS NOT FREE.                                  */
*         /*    CALL SCNRLST TO SCAN THE ALL PORTION OF RESVOL FOR   */
*         /*    IT'S CRA VOLSER TO DETERMINE IF THIS RECORD          */
*         /*    BELONGS TO A CRA SPECIFIED FOR RESET.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0641
*                                 ELSE                             0641
*                                   DO;                            0641
         B     @RC00635                                            0641
@RF00635 DS    0H                                                  0642
*                                     RSCRVL = ADDR(RCDCRAVL);     0642
*                                                                  0642
         L     @04,RSGRABCU(,REG6)                                 0642
         L     @04,GRABCURR(,@04)                                  0642
         LA    @04,RCDCRAVL+8(,@04)                                0642
         ST    @04,RSCRVL(,REG6)                                   0642
*                                     /* CALL TO MODULE IDCRS05 FOR PRO
*EDURE SCNRLST                                                       */
*                                     CALL IDCRS5SR('V','A',RSENTPT,RSC
*VL);                                                              0643
*                                                                  0643
         LA    @04,@CC00833                                        0643
         ST    @04,@AL00001                                        0643
         LA    @04,@CC00813                                        0643
         ST    @04,@AL00001+4                                      0643
         LA    @04,RSENTPT(,REG6)                                  0643
         ST    @04,@AL00001+8                                      0643
         LA    @04,RSCRVL(,REG6)                                   0643
         ST    @04,@AL00001+12                                     0643
         L     @15,@CV03539                                        0643
         LA    @01,@AL00001                                        0643
         BALR  @14,@15                                             0643
*         /***********************************************************/
*         /*                                                         */
*         /*    IF RECORD BELONGS TO A RESET CRA, MARK IT AS         */
*         /*    AVAILABLE AND PLACE IT ON THE AVAILABLE CHAIN.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0644
*                                     IF RSENTPT ^= 0              0644
*                                       THEN                       0644
         L     @04,RSENTPT(,REG6)                                  0644
         LTR   @04,@04                                             0644
         BZ    @RF00644                                            0644
*                                         DO;                      0645
*                                           RSWDLCAT = ON;         0646
         L     @04,RSGRABCU(,REG6)                                 0646
         L     @04,GRABCURR(,@04)                                  0646
         OI    RSWDLCAT(@04),B'01000000'                           0646
*                                           RSAVAILN = RSAVAILN + 1;
         LA    @15,1                                               0647
         AL    @15,RSAVAILN(,REG6)                                 0647
         ST    @15,RSAVAILN(,REG6)                                 0647
*                                           RSWCHPTR = RSAVAIL;    0648
         L     @15,RSAVAIL(,REG6)                                  0648
         ST    @15,RSWCHPTR(,@04)                                  0648
*                                           RSAVAIL = RSCURCI;     0649
         L     @04,RSCURCI(,REG6)                                  0649
         ST    @04,RSAVAIL(,REG6)                                  0649
*                                         END;                     0650
*                                                                  0650
*                                   END;                           0651
*                                                                  0651
@RF00644 DS    0H                                                  0652
*                             END COPYGOK;                         0652
*                                                                  0652
@RC00635 DS    0H                                                  0653
*         /***********************************************************/
*         /*                                                         */
*         /*    RECORD IS NOW FORMATTED IN WORKFILE BUFFER. WRITE    */
*         /*    RECORD TO WORKFILE VIA COPYADD.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0653
*                         CALL COPYADD;                            0653
*                                                                  0653
@RC00620 BAL   @14,COPYADD                                         0653
*                       END COPYFMT;                               0654
*                                                                  0654
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS UNFORMATTED RECORDS.                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0655
*                     ELSE                                         0655
*COPYUFMT:              DO;                                        0655
*                                                                  0655
         B     @RC00599                                            0655
@RF00599 DS    0H                                                  0655
COPYUFMT DS    0H                                                  0656
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CURRENT GRAB POINTER TO WORKFILE GRABS.          */
*         /*    SET UP DUMMY FREE RECORD IN WORKFILE BUFFER.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0656
*                         RSGRABCU = ADDR(GRABSWF);                0656
         L     @04,RSIOTBL(,REG6)                                  0656
         ST    @04,RSGRABCU(,REG6)                                 0656
*                         WFBUF1(1:256) = ''B;                     0657
         L     @15,RSWFBP1(,REG6)                                  0657
         XC    WFBUF1(256,@15),WFBUF1(@15)                         0657
*                         WFBUF1(257:CELEN) = ''B;                 0658
         XC    WFBUF1+256(249,@15),WFBUF1+256(@15)                 0658
*                         RCDID = FREEID;                          0659
*                                                                  0659
         L     @04,GRABCURR(,@04)                                  0659
         LA    @15,8                                               0659
         ALR   @15,@04                                             0659
         MVI   RCDID(@15),C'F'                                     0659
*         /***********************************************************/
*         /*                                                         */
*         /*    WRITE A DUMMY FREE RECORD TO THE WORKFILE FOR        */
*         /*    EACH UNFORMATTED CATALOG RECORD.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0660
*                                                                  0660
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CONTROL INTERVAL NUMBER OF RECORD TO CURRENT CI. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0660
*                         RCDCINO = RSCURCI;                       0660
*                                                                  0660
         L     @14,RSCURCI(,REG6)                                  0660
         STCM  @14,7,RCDCINO(@15)                                  0660
*         /***********************************************************/
*         /*                                                         */
*         /*    MUST SAVE SEVERAL RECORDS AT THE END OF THE EXTENT   */
*         /*    FOR USE BY CATALOG EOV. MARK THESE DUMMY RECORDS     */
*         /*    AS INVALID.                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0661
*                         IF RSCURCI => RSCAFUCI                   0661
*                           THEN                                   0661
         C     @14,RSCAFUCI(,REG6)                                 0661
         BL    @RF00661                                            0661
*                             DO;                                  0662
*                               RSWFLD = ''B;                      0663
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0663
*                               RSWINVCI = ON;                     0664
         OI    RSWINVCI(@04),B'10000000'                           0664
*                             END;                                 0665
*                                                                  0665
*         /***********************************************************/
*         /*                                                         */
*         /*    MARK NON-EOV RECORDS FOR UPDATE CATALOG AND PLACE    */
*         /*    ON THE AVAILABLE CHAIN.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0666
*                           ELSE                                   0666
*                             DO;                                  0666
         B     @RC00661                                            0666
@RF00661 DS    0H                                                  0667
*                               RSWFLD = ''B;                      0667
         L     @04,RSGRABCU(,REG6)                                 0667
         L     @04,GRABCURR(,@04)                                  0667
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0667
*                               RSWUPCAT = ON;                     0668
         OI    RSWUPCAT(@04),B'00100000'                           0668
*                               RSWCHPTR = RSAVAIL;                0669
         L     @15,RSAVAIL(,REG6)                                  0669
         ST    @15,RSWCHPTR(,@04)                                  0669
*                               RSAVAIL = RSCURCI;                 0670
         L     @04,RSCURCI(,REG6)                                  0670
         ST    @04,RSAVAIL(,REG6)                                  0670
*                               RSAVAILN = RSAVAILN + 1;           0671
         LA    @04,1                                               0671
         AL    @04,RSAVAILN(,REG6)                                 0671
         ST    @04,RSAVAILN(,REG6)                                 0671
*                             END;                                 0672
*                                                                  0672
*         /***********************************************************/
*         /*                                                         */
*         /*    RECORD IS NOW FORMATTED IN WORKFILE BUFFER. WRITE    */
*         /*    RECORD TO WORKFILE VIA COPYADD.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0673
*                         CALL COPYADD;                            0673
*                                                                  0673
@RC00661 BAL   @14,COPYADD                                         0673
*                       END COPYUFMT;                              0674
*                                                                  0674
*               END COPYLP3;                                       0675
*                                                                  0675
@RC00599 LA    @04,1                                               0675
         AL    @04,RSCURCI(,REG6)                                  0675
@DE00598 ST    @04,RSCURCI(,REG6)                                  0675
         C     @04,RSXCIEND(,REG6)                                 0675
         BNH   @DL00598                                            0675
*           END COPYLKR;                                           0676
*                                                                  0676
*         END COPYLP1;                                             0677
*                                                                  0677
@RF00596 LA    @04,1                                               0677
         AH    @04,RSIDX(,REG6)                                    0677
         STH   @04,RSIDX(,REG6)                                    0677
         C     @04,@CF01850                                        0677
         BNH   @DL00582                                            0677
@DC00582 DS    0H                                                  0678
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIAL LOAD OF WORKFILE COMPLETE. IF WORKFILE IS      */
*         /*  OPEN FOR CREATE MODE, THEN CLOSE IT AND SET WORKFILE   */
*         /*  CREATED FLAG, OTHERWISE LEAVE IT OPEN                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0678
*         IF RSWFCREA = OFF                                        0678
*           THEN                                                   0678
         TM    RSWFCREA(REG6),B'00100000'                          0678
         BNZ   @RF00678                                            0678
*             DO;                                                  0679
*                                                                  0679
*         /***********************************************************/
*         /*                                                         */
*         /*    CLOSE THE WORKFILE VIA DSCLOSE.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0680
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE      */
*               CALL IDCRS6DC('W');                                0680
*                                                                  0680
         L     @15,@CV03542                                        0680
         LA    @01,@AL00680                                        0680
         BALR  @14,@15                                             0680
*               RESPECIFY RTNREG RSTD;                             0681
*               TESTRC = RTNREG;                                   0682
         STH   RTNREG,TESTRC(,REG6)                                0682
*               RESPECIFY RTNREG UNRSTD;                           0683
*                                                                  0683
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CLOSE FAILED, CALL CKERR TO TERMINATE. OTHERWISE  */
*         /*    SET WORKFILE CREATED FLAG ON.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0684
*               IF TESTRC ^= 0                                     0684
*                 THEN                                             0684
*                                                                  0684
*                                                                  0684
         LH    @04,TESTRC(,REG6)                                   0684
         LTR   @04,@04                                             0684
         BZ    @RF00684                                            0684
*                   DO;                                            0685
*                   /*CALL CKERR*/                                 0686
*                     RSCKERR = RSCKERR && RSCKERR;                0686
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0686
*                     RSCKERN = RSE079;                            0687
         MVC   RSCKERN(2,REG6),@CH01046                            0687
*                     RSCKTERM = 'TERM';                           0688
*                                                                  0688
         MVC   RSCKTERM(4,REG6),@CC03543                           0688
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */
*                   CALL CKERR;                                    0689
         L     @15,@CV03544                                        0689
         BALR  @14,@15                                             0689
*                   END;                                           0690
*                                                                  0690
*                 ELSE                                             0691
*                   RSWFCREA = ON;                                 0691
*                                                                  0691
         B     @RC00684                                            0691
@RF00684 OI    RSWFCREA(REG6),B'00100000'                          0691
*             END;                                                 0692
*                                                                  0692
*         /***********************************************************/
*         /*                                                         */
*         /*  WORKFILE WAS PREVIOUSLY LOADED. MARK ALL RECORDS       */
*         /*  WHICH WERE MERGED FROM CRAS IN FIRST PASS AND NOT      */
*         /*  RELOADED FROM CATALOG IN SECOND PASS AS INVALID.       */
*         /*  POSITION TO THE NEXT RELATIVE RECORD AND READ          */
*         /*  AND UPDATE SEQUENTIALLY.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0693
*           ELSE                                                   0693
*             DO;                                                  0693
         B     @RC00678                                            0693
@RF00678 DS    0H                                                  0694
*               RSGRABCU = ADDR(GRABSWF);                          0694
         L     @04,RSIOTBL(,REG6)                                  0694
         ST    @04,RSGRABCU(,REG6)                                 0694
*               GRABAFLS = ''B;                                    0695
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0695
*               RABRCDA = RSCURRN;                                 0696
         L     @04,GRABCURR(,@04)                                  0696
         L     @15,RSCURRN(,REG6)                                  0696
         ST    @15,RABRCDA(,@04)                                   0696
*               RABRRN = ON;                                       0697
*                                                                  0697
*                                                                  0697
         OI    RABRRN(@04),B'00010000'                             0697
*               DO;                                                0698
*                 RSRTYPE = ''B;                                   0699
         MVI   RSRTYPE(REG6),X'00'                                 0699
*                 RSRPOS = ON;      /* POSRCD  */                  0700
         OI    RSRPOS(REG6),B'00010000'                            0700
*                 RSRDS = ''B;                                     0701
         NI    RSRDS(REG6),B'00011111'                             0701
*                 RSRWF = ON;       /* WORKFILE  */                0702
*                 RSRDIR = OFF;     /* SEQUENTIAL  */              0703
*                 RSRKEY = ON;      /* KEY  */                     0704
*                                                                  0704
         OI    RSRWF(REG6),B'10010000'                             0704
         NI    RSRDIR(REG6),B'11111011'                            0704
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */
*               CALL RECMGMT;                                      0705
         L     @15,@CV03498                                        0705
         BALR  @14,@15                                             0705
*                 RFY RTNREG RSTD;                                 0706
*                 TESTRC = RTNREG;                                 0707
         STH   RTNREG,TESTRC(,REG6)                                0707
*                 RFY RTNREG UNRSTD;                               0708
*               END;                                               0709
*                                                                  0709
*COPYLP4:       DO WHILE(TESTRC ^= RCEOF);                         0710
*                                                                  0710
*                                                                  0710
COPYLP4  B     @DE00710                                            0710
@DL00710 DS    0H                                                  0711
*                 DO;                                              0711
*                   RSRTYPE = ''B;                                 0712
         MVI   RSRTYPE(REG6),X'00'                                 0712
*                   RSRGET = ON;      /* GETRCD  */                0713
         OI    RSRGET(REG6),B'10000000'                            0713
*                   RSRUPD = ON;      /* UPDATE  */                0714
         OI    RSRUPD(REG6),B'00001000'                            0714
*                   RSRDS = ''B;                                   0715
         NI    RSRDS(REG6),B'00011111'                             0715
*                   RSRWF = ON;       /* WORKFILE  */              0716
*                   RSRDIR = OFF;     /* SEQUENTIAL  */            0717
*                   RSRKEY = ON;      /* KEY  */                   0718
*                                                                  0718
         OI    RSRWF(REG6),B'10010000'                             0718
         NI    RSRDIR(REG6),B'11111011'                            0718
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT    */
*                 CALL RECMGMT;                                    0719
         L     @15,@CV03498                                        0719
         BALR  @14,@15                                             0719
*                   RFY RTNREG RSTD;                               0720
*                   TESTRC = RTNREG;                               0721
         STH   RTNREG,TESTRC(,REG6)                                0721
*                   RFY RTNREG UNRSTD;                             0722
*                 END;                                             0723
*                                                                  0723
*                 IF TESTRC ^= RCEOF                               0724
*                   THEN                                           0724
         LH    @04,TESTRC(,REG6)                                   0724
         C     @04,@CF00478                                        0724
         BE    @RF00724                                            0724
*                     DO;                                          0725
*                       RSWFLD = ''B;                              0726
         L     @04,RSGRABCU(,REG6)                                 0726
         L     @04,GRABCURR(,@04)                                  0726
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0726
*                       RSWINVCI = ON;                             0727
*                                                                  0727
*                                                                  0727
         OI    RSWINVCI(@04),B'10000000'                           0727
*                       DO;                                        0728
*                         RSRTYPE = ''B;                           0729
         MVI   RSRTYPE(REG6),X'00'                                 0729
*                         RSRUPDT = ON;     /* UPDRCD  */          0730
         OI    RSRUPDT(REG6),B'00100000'                           0730
*                         RSRUPD = ON;      /* UPDATE  */          0731
         OI    RSRUPD(REG6),B'00001000'                            0731
*                         RSRDS = ''B;                             0732
         NI    RSRDS(REG6),B'00011111'                             0732
*                         RSRWF = ON;       /* WORKFILE  */        0733
*                         RSRDIR = OFF;     /* SEQUENTIAL  */      0734
*                         RSRKEY = ON;      /* KEY  */             0735
*                                                                  0735
         OI    RSRWF(REG6),B'10010000'                             0735
         NI    RSRDIR(REG6),B'11111011'                            0735
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                       CALL RECMGMT;                              0736
         L     @15,@CV03498                                        0736
         BALR  @14,@15                                             0736
*                         RFY RTNREG RSTD;                         0737
*                         TESTRC = RTNREG;                         0738
         STH   RTNREG,TESTRC(,REG6)                                0738
*                         RFY RTNREG UNRSTD;                       0739
*                       END;                                       0740
*                                                                  0740
*                     END;                                         0741
*                                                                  0741
*               END COPYLP4;                                       0742
*                                                                  0742
@RF00724 DS    0H                                                  0742
@DE00710 CLC   TESTRC(2,REG6),@CH00478                             0742
         BNE   @DL00710                                            0742
*         /***********************************************************/
*         /*                                                         */
*         /*  FORCE A PHYSICAL WRITE OF THE LAST RECORD              */
*         /*  PUT SEQUENTIALLY TO THE WORKFILE, VIA RECMGMT.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0743
*                                                                  0743
*               DO;                                                0743
*                 RSRECREQ = ''B;                                  0744
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0744
*                 RSREND = ON;      /* ENDRCD */                   0745
*                                                                  0745
         OI    RSREND(REG6),B'00000010'                            0745
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */
*               CALL RECMGMT;                                      0746
         L     @15,@CV03498                                        0746
         BALR  @14,@15                                             0746
*                 RFY RTNREG RSTD;                                 0747
*                 TESTRC = RTNREG;                                 0748
         STH   RTNREG,TESTRC(,REG6)                                0748
*                 RFY RTNREG UNRSTD;                               0749
*               END;                                               0750
*                                                                  0750
*               RABRRN = OFF;                                      0751
*                                                                  0751
*                                                                  0751
         L     @04,RSGRABCU(,REG6)                                 0751
         L     @04,GRABCURR(,@04)                                  0751
         NI    RABRRN(@04),B'11101111'                             0751
*             END;                                                 0752
*                                                                  0752
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0753
*                                                                  0753
*                                                                  0753
*         IF GDTDBG = NULLPTR                                      0753
*           THEN;                                                  0753
@RC00678 L     @04,GDTDBG(,REG5)                                   0753
         LTR   @04,@04                                             0753
         BZ    @RT00753                                            0753
*           ELSE                                                   0755
*             CALL IDCDB010 (GDTTBL,'RSC2');                       0755
         ST    REG5,@AL00001                                       0755
         LA    @04,@CC03547                                        0755
         ST    @04,@AL00001+4                                      0755
         MVI   @AL00001+4,X'80'                                    0755
         L     @15,GDTDBG(,REG5)                                   0755
         LA    @01,@AL00001                                        0755
         BALR  @14,@15                                             0755
*      GENERATE;                                                   0756
@RT00753 DS    0H                                                  0756
         B     NAME0047+8  BR AROUND NAME
         DS    0F
NAME0047 DC    CL8'COPYADD'
*COPYADD: PROCEDURE                                                0757
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0757
*                                                                  0757
         B     @PB00005                                            0757
COPYADD  DS    0H                                                  0758
*      GENERATE REFS(RS01RG08, REG6);                              0758
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0047  PROCNAME TO REGSAVE
*/********************************************************************/
*/*                                                                  */
*/*  WRITE WORKFILE RECORD VIA RECMGMT. IF WORKFILE RECORD TO BE     */
*/*  WRITTEN ALREADY EXISTS,     UPDATE THE RECORD, OTHERWISE ADD    */
*/*  THE RECORD. SET GRABS FLAG TO ADD RECORD IF NO RECORD FOUND     */
*/*  ERROR ENCOUNTERED TRYING TO GET THE RECORD FOR UPDATE.          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0759
*                                                                  0759
*         /***********************************************************/
*         /*                                                         */
*         /*  CLEAR GRABS FLAGS.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0759
*         GRABAFLS = ''B;                                          0759
*                                                                  0759
         L     @04,RSGRABCU(,REG6)                                 0759
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0759
*         /***********************************************************/
*         /*                                                         */
*         /*  WORKFILE RECORD DOES NOT EXIST. ADD IT.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0760
*         IF RSCURRN > RSWFHURR                                    0760
*           THEN                                                   0760
*                                                                  0760
*                                                                  0760
         L     @04,RSCURRN(,REG6)                                  0760
         C     @04,RSWFHURR(,REG6)                                 0760
         BNH   @RF00760                                            0760
*             DO;                                                  0761
*               RSRTYPE = ''B;                                     0762
         MVI   RSRTYPE(REG6),X'00'                                 0762
*               RSRADD = ON;      /* ADDRCD  */                    0763
         OI    RSRADD(REG6),B'01000000'                            0763
*               RSRUPD = OFF;     /* NO UPDATE  */                 0764
         NI    RSRUPD(REG6),B'11110111'                            0764
*               RSRDS = ''B;                                       0765
         NI    RSRDS(REG6),B'00011111'                             0765
*               RSRWF = ON;       /* WORKFILE  */                  0766
*               RSRDIR = OFF;     /* SEQUENTIAL  */                0767
*               RSRKEY = ON;      /* KEY  */                       0768
*                                                                  0768
         OI    RSRWF(REG6),B'10010000'                             0768
         NI    RSRDIR(REG6),B'11111011'                            0768
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT        */
*             CALL RECMGMT;                                        0769
         L     @15,@CV03498                                        0769
         BALR  @14,@15                                             0769
*               RFY RTNREG RSTD;                                   0770
*               TESTRC = RTNREG;                                   0771
         STH   RTNREG,TESTRC(,REG6)                                0771
*               RFY RTNREG UNRSTD;                                 0772
*             END;                                                 0773
*                                                                  0773
*         /***********************************************************/
*         /*                                                         */
*         /*  WORKFILE RECORD MAY ALREADY EXIST. UPDATE IT OR        */
*         /*  ADD IT IF NO RECORD FOUND.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0774
*           ELSE                                                   0774
*             DO;                                                  0774
         B     @RC00760                                            0774
@RF00760 DS    0H                                                  0775
*               GRABSNRA = ON;                                     0775
*               GRABSEFN = ON;                                     0776
         L     @04,RSGRABCU(,REG6)                                 0776
         OI    GRABSNRA(@04),B'01100000'                           0776
*               RABRCDA = RSCURRN;                                 0777
         L     @04,GRABCURR(,@04)                                  0777
         L     @15,RSCURRN(,REG6)                                  0777
         ST    @15,RABRCDA(,@04)                                   0777
*               RABRRN = ON;                                       0778
*                                                                  0778
*                                                                  0778
         OI    RABRRN(@04),B'00010000'                             0778
*               DO;                                                0779
*                 RSRTYPE = ''B;                                   0780
         MVI   RSRTYPE(REG6),X'00'                                 0780
*                 RSRUPDT = ON;     /* UPDRCD  */                  0781
         OI    RSRUPDT(REG6),B'00100000'                           0781
*                 RSRUPD = ON;      /* UPDATE  */                  0782
         OI    RSRUPD(REG6),B'00001000'                            0782
*                 RSRDS = ''B;                                     0783
         NI    RSRDS(REG6),B'00011111'                             0783
*                 RSRWF = ON;       /* WORKFILE  */                0784
*                 RSRDIR = ON;      /* DIRECT  */                  0785
*                 RSRKEY = ON;      /* KEY  */                     0786
*                                                                  0786
         OI    RSRWF(REG6),B'10010100'                             0786
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */
*               CALL RECMGMT;                                      0787
         L     @15,@CV03498                                        0787
         BALR  @14,@15                                             0787
*                 RFY RTNREG RSTD;                                 0788
*                 TESTRC = RTNREG;                                 0789
         STH   RTNREG,TESTRC(,REG6)                                0789
*                 RFY RTNREG UNRSTD;                               0790
*               END;                                               0791
*                                                                  0791
*               GRABAFLS = ''B;                                    0792
         L     @04,RSGRABCU(,REG6)                                 0792
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0792
*               RABRRN = OFF;                                      0793
         L     @04,GRABCURR(,@04)                                  0793
         NI    RABRRN(@04),B'11101111'                             0793
*             END;                                                 0794
*                                                                  0794
*         /***********************************************************/
*         /*                                                         */
*         /*  INCREMENT CURRENT RELATIVE RECORD NUMBER               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0795
*         RSCURRN = RSCURRN + 1;                                   0795
*                                                                  0795
@RC00760 LA    @04,1                                               0795
         AL    @04,RSCURRN(,REG6)                                  0795
         ST    @04,RSCURRN(,REG6)                                  0795
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0796
* CALL EXIT;  /*TERMINATE*/                                        0796
         BAL   @14,EXIT                                            0796
* END COPYADD; /*END OF PROCEDURE*/                                0797
*                                                                  0797
@EL00005 DS    0H                                                  0797
@EF00005 DS    0H                                                  0797
@ER00005 BR    @14                                                 0797
@PB00005 DS    0H                                                  0798
* CALL EXIT;  /*TERMINATE*/                                        0798
         BAL   @14,EXIT                                            0798
* END COPYCAT; /*END OF PROCEDURE*/                                0799
@EL00004 DS    0H                                                  0799
@EF00004 DS    0H                                                  0799
@ER00004 BR    @14                                                 0799
@PB00004 DS    0H                                                  0800
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - INIT                                            */
*/*                                                                  */
*/* FUNCTION - INITIALIZE WORKAREAS AND TABLES.                      */
*/*            OPEN, VALIDITY CHECK, RESERVE AND VERIFY THE CATALOG. */
*/*            DEFINE AND OPEN THE WORKFILE.                         */
*/*            ALLOCATE ALL CRA VOLUMES SPECIFIED FOR RESET.         */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   0800
         DS    0F
NAME0054 DC    CL8'INIT'
*INIT: PROCEDURE                                                   0801
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0801
*                                                                  0801
         B     @PB00006                                            0801
INIT     DS    0H                                                  0802
*      GENERATE REFS(RS01RG08, REG6);                              0802
*                                                                  0802
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0054  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  UCATLG DATA DECLARATIONS.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0803
*         DCL INITDSN   CHAR(*) BASED(CTGFLPT(1));                 0803
*                                      /*CATALOG DATA SET NAME       */
*         DCL INITVLSR  CHAR(*) BASED(CTGFLPT(1));                 0804
*                                      /*CATALOG VOLSER              */
*         DCL INITTS    CHAR(*) BASED(CTGFLPT(1));                 0805
*                                      /*CATALOG TIMESTAMP           */
*         DCL INITACB   PTR(31) BASED(CTGFLPT(1));                 0806
*                                      /*CATALOG ACB                 */
*         DCL INITATR1  CHAR(1) BASED(CTGFLPT(1));                 0807
*                                      /*DATA ATTRIBUTES             */
*         DCL INITWACB  PTR(31) BASED(CTGFLPT(1));                 0808
*                                      /*WORKFILE CATALOG ACB PTR    */
*         DCL RCCAT     FIXED(15) CONSTANT(4);                     0809
*                                      /*UCATLG RC - CATLG NOT ACCESS*/
*                                                                  0810
*         /***********************************************************/
*         /*                                                         */
*         /*  UIOINFO RETURN AREA HEADER                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0810
*         DCL 1 UINFHDR BASED(RSUIRPT) BDY(HWORD),                 0810
*               2 UINFTLN FIXED(15),  /*LENGTH OF RETURN AREA        */
*               2 UINFRLN FIXED(15);  /*LENGTH OF DATA RETURNED      */
*                                                                  0810
*         RFY IFGACB BASED(RSCATACB);                              0811
*         RFY RESVOL BASED(RSENTPT);                               0812
*         RFY CRAVL BASED(RSINCVPT);                               0813
*         RFY CRADV BASED(RSINDVPT);                               0814
*         RFY CRADN BASED(RSINDNPT);                               0815
*         OLDERID2 = NEWERID2;                                     0816
         L     @04,GDTTR2(,REG5)                                   0816
         MVC   @TS00001(95),NEWERID2(@04)                          0816
         MVC   OLDERID2(95,@04),@TS00001                           0816
*         NEWID2 = 'RSIN';                                         0817
*                                                                  0817
         MVC   NEWID2(4,@04),@CC03569                              0817
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN STORAGE FOR THE RECORD ACCESS BLOCKS (RABS)     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0818
*         RSUGLEN = DIM(RABS) * LENGTH(RABS);                      0818
*                                                                  0818
         MVC   RSUGLEN(4,REG6),@CF03735                            0818
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSRABWA,POOL1,SETZERO);    0819
*                                                                  0819
         ST    REG5,@AL00001                                       0819
         LA    @04,RSUGLEN(,REG6)                                  0819
         ST    @04,@AL00001+4                                      0819
         LA    @04,RSRABWA(,REG6)                                  0819
         ST    @04,@AL00001+8                                      0819
         LA    @04,@CC00900                                        0819
         ST    @04,@AL00001+12                                     0819
         LA    @04,SETZERO                                         0819
         ST    @04,@AL00001+16                                     0819
         MVI   @AL00001+16,X'80'                                   0819
         L     @15,GDTGPL(,REG5)                                   0819
         LA    @01,@AL00001                                        0819
         BALR  @14,@15                                             0819
*         RESPECIFY RTNREG RSTD;                                   0820
*         TESTRC = RTNREG;                                         0821
         STH   RTNREG,TESTRC(,REG6)                                0821
*         RESPECIFY RTNREG UNRSTD;                                 0822
*                                                                  0822
*         /***********************************************************/
*         /*                                                         */
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */
*         /*    TERMINATE.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0823
*         IF TESTRC ^= 0                                           0823
*           THEN                                                   0823
*                                                                  0823
*                                                                  0823
         LH    @04,TESTRC(,REG6)                                   0823
         LTR   @04,@04                                             0823
         BZ    @RF00823                                            0823
*             DO;                                                  0824
*             /*CALL CKERR*/                                       0825
*               RSCKERR = RSCKERR && RSCKERR;                      0825
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0825
*               RSCKERN = RSE099;                                  0826
         MVC   RSCKERN(2,REG6),@CH01083                            0826
*               RSCKTERM = 'TERM';                                 0827
*                                                                  0827
         MVC   RSCKTERM(4,REG6),@CC03543                           0827
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          0828
         L     @15,@CV03544                                        0828
         BALR  @14,@15                                             0828
*             END;                                                 0829
*                                                                  0829
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN STORAGE FOR RECORD MANAGEMENT AND U-MACRO       */
*         /*  WORKAREA                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0830
*         RSUGLEN = LENGTH(RECIOWA);                               0830
*                                                                  0830
@RF00823 MVC   RSUGLEN(4,REG6),@CF03736                            0830
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSIOTBL,POOL1,SETZERO);    0831
*                                                                  0831
         ST    REG5,@AL00001                                       0831
         LA    @04,RSUGLEN(,REG6)                                  0831
         ST    @04,@AL00001+4                                      0831
         LA    @04,RSIOTBL(,REG6)                                  0831
         ST    @04,@AL00001+8                                      0831
         LA    @04,@CC00900                                        0831
         ST    @04,@AL00001+12                                     0831
         LA    @04,SETZERO                                         0831
         ST    @04,@AL00001+16                                     0831
         MVI   @AL00001+16,X'80'                                   0831
         L     @15,GDTGPL(,REG5)                                   0831
         LA    @01,@AL00001                                        0831
         BALR  @14,@15                                             0831
*         RESPECIFY RTNREG RSTD;                                   0832
*         TESTRC = RTNREG;                                         0833
         STH   RTNREG,TESTRC(,REG6)                                0833
*         RESPECIFY RTNREG UNRSTD;                                 0834
*                                                                  0834
*         /***********************************************************/
*         /*                                                         */
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */
*         /*    TERMINATE.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0835
*         IF TESTRC ^= 0                                           0835
*           THEN                                                   0835
*                                                                  0835
*                                                                  0835
         LH    @04,TESTRC(,REG6)                                   0835
         LTR   @04,@04                                             0835
         BZ    @RF00835                                            0835
*             DO;                                                  0836
*             /*CALL CKERR*/                                       0837
*               RSCKERR = RSCKERR && RSCKERR;                      0837
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0837
*               RSCKERN = RSE099;                                  0838
         MVC   RSCKERN(2,REG6),@CH01083                            0838
*               RSCKTERM = 'TERM';                                 0839
*                                                                  0839
         MVC   RSCKTERM(4,REG6),@CC03543                           0839
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          0840
         L     @15,@CV03544                                        0840
         BALR  @14,@15                                             0840
*             END;                                                 0841
*                                                                  0841
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN STORAGE FOR THE CATALOG MANAGEMENT WORKAREA     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0842
*         RSUGLEN = LENGTH(CTGPL) + DIM(RSFPL) * LENGTH(CTGFIELD)  0842
*               + DIM(RSFPL) * (LENGTH(CTGFL) + LENGTH(CTGFLDAT)); 0842
*                                                                  0842
@RF00835 MVC   RSUGLEN(4,REG6),@CF03738                            0842
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,CTGPLPTR,POOL1,SETZERO);   0843
*                                                                  0843
         ST    REG5,@AL00001                                       0843
         LA    @04,RSUGLEN(,REG6)                                  0843
         ST    @04,@AL00001+4                                      0843
         LA    @04,CTGPLPTR(,REG6)                                 0843
         ST    @04,@AL00001+8                                      0843
         LA    @04,@CC00900                                        0843
         ST    @04,@AL00001+12                                     0843
         LA    @04,SETZERO                                         0843
         ST    @04,@AL00001+16                                     0843
         MVI   @AL00001+16,X'80'                                   0843
         L     @15,GDTGPL(,REG5)                                   0843
         LA    @01,@AL00001                                        0843
         BALR  @14,@15                                             0843
*         RESPECIFY RTNREG RSTD;                                   0844
*         TESTRC = RTNREG;                                         0845
         STH   RTNREG,TESTRC(,REG6)                                0845
*         RESPECIFY RTNREG UNRSTD;                                 0846
*                                                                  0846
*         /***********************************************************/
*         /*                                                         */
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */
*         /*    TERMINATE.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0847
*         IF TESTRC ^= 0                                           0847
*           THEN                                                   0847
*                                                                  0847
*                                                                  0847
         LH    @04,TESTRC(,REG6)                                   0847
         LTR   @04,@04                                             0847
         BZ    @RF00847                                            0847
*             DO;                                                  0848
*             /*CALL CKERR*/                                       0849
*               RSCKERR = RSCKERR && RSCKERR;                      0849
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0849
*               RSCKERN = RSE099;                                  0850
         MVC   RSCKERN(2,REG6),@CH01083                            0850
*               RSCKTERM = 'TERM';                                 0851
*                                                                  0851
         MVC   RSCKTERM(4,REG6),@CC03543                           0851
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          0852
         L     @15,@CV03544                                        0852
         BALR  @14,@15                                             0852
*             END;                                                 0853
*                                                                  0853
*         /***********************************************************/
*         /*                                                         */
*         /*  SET UP FPL POINTERS.                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0854
*         RSFPL(1) = CTGPLPTR + LENGTH(CTGPL)                      0854
*                 + DIM(RSFPL) * LENGTH(CTGFIELD);                 0854
*                                                                  0854
@RF00847 LA    @04,48                                              0854
         AL    @04,CTGPLPTR(,REG6)                                 0854
         ST    @04,RSFPL(,REG6)                                    0854
*INITLP1:                                                          0855
*         DO RSIDX = 2 TO DIM(RSFPL);                              0855
*                                                                  0855
INITLP1  LA    @04,2                                               0855
         STH   @04,RSIDX(,REG6)                                    0855
@DL00855 DS    0H                                                  0856
*           RSFPL(RSIDX) = RSFPL(RSIDX -1) + LENGTH(CTGFL)         0856
*                        + LENGTH(CTGFLDAT);                       0856
*                                                                  0856
         LH    @04,RSIDX(,REG6)                                    0856
         SLA   @04,2                                               0856
         LA    @15,24                                              0856
         AL    @15,RSFPL-8(@04,REG6)                               0856
         ST    @15,RSFPL-4(@04,REG6)                               0856
*         END INITLP1;                                             0857
*                                                                  0857
         LA    @04,1                                               0857
         AH    @04,RSIDX(,REG6)                                    0857
         STH   @04,RSIDX(,REG6)                                    0857
         C     @04,@CF00287                                        0857
         BNH   @DL00855                                            0857
*         /***********************************************************/
*         /*                                                         */
*         /*  SAVE FDT INFORMATION IN THE MAIN WORKAREA.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0858
*                                                                  0858
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE CATALOG DSNAME,DDNAME AND PASSWORD.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0858
*         RSCATDSN = CATNMVAL(1:CATNMLEN);                         0858
         MVI   RSCATDSN+1(REG6),C' '                               0858
         MVC   RSCATDSN+2(42,REG6),RSCATDSN+1(REG6)                0858
         L     @04,@PC00001+4                                      0858
         L     @04,FDTPTR+4(,@04)                                  0858
         SLR   @15,@15                                             0858
         IC    @15,CATNMLEN(,@04)                                  0858
         BCTR  @15,0                                               0858
         EX    @15,@SM03785                                        0858
*         RSCADS = ADDR(RSCATDSN);                                 0859
*                                                                  0859
         LA    @15,RSCATDSN(,REG6)                                 0859
         ST    @15,RSCADS(,REG6)                                   0859
*         IF CATNMPLN ^= 0                                         0860
*           THEN                                                   0860
         CLI   CATNMPLN(@04),0                                     0860
         BE    @RF00860                                            0860
*             DO;                                                  0861
*               RSCATPS = CATNMPAS(1:CATNMPLN);                    0862
         MVI   RSCATPS+1(REG6),C' '                                0862
         MVC   RSCATPS+2(6,REG6),RSCATPS+1(REG6)                   0862
         SLR   @15,@15                                             0862
         IC    @15,CATNMPLN(,@04)                                  0862
         BCTR  @15,0                                               0862
         EX    @15,@SM03787                                        0862
*               RSCAPAS = ADDR(RSCATPS);                           0863
         LA    @04,RSCATPS(,REG6)                                  0863
         ST    @04,RSCAPAS(,REG6)                                  0863
*             END;                                                 0864
*                                                                  0864
*         RSCADD = ADDR(RSCATDDN);                                 0865
@RF00860 LA    @04,RSCATDDN(,REG6)                                 0865
         ST    @04,RSCADD(,REG6)                                   0865
*         IF ADDR(CATDN) ^= 0                                      0866
*           THEN                                                   0866
         L     @04,@PC00001+4                                      0866
         L     @04,FDTPTR+8(,@04)                                  0866
         LTR   @04,@04                                             0866
         BZ    @RF00866                                            0866
*             RSCATDDN = CATDNVAL(1:CATDNLEN);                     0867
*                                                                  0867
         MVI   RSCATDDN+1(REG6),C' '                               0867
         MVC   RSCATDDN+2(6,REG6),RSCATDDN+1(REG6)                 0867
         SLR   @15,@15                                             0867
         IC    @15,CATDNLEN(,@04)                                  0867
         BCTR  @15,0                                               0867
         EX    @15,@SM03789                                        0867
*         /***********************************************************/
*         /*                                                         */
*         /*    IF THE MASTER PASSWORD WAS SPECIFIED, SAVE IT.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0868
*         IF ADDR(MRPW) ^= 0                                       0868
*           THEN                                                   0868
@RF00866 L     @04,@PC00001+4                                      0868
         L     @04,FDTPTR+12(,@04)                                 0868
         LTR   @04,@04                                             0868
         BZ    @RF00868                                            0868
*             DO;                                                  0869
*               RSMRPS = MRPWVAL(1:MRPWLEN);                       0870
         MVI   RSMRPS+1(REG6),C' '                                 0870
         MVC   RSMRPS+2(6,REG6),RSMRPS+1(REG6)                     0870
         SLR   @15,@15                                             0870
         IC    @15,MRPWLEN(,@04)                                   0870
         BCTR  @15,0                                               0870
         EX    @15,@SM03791                                        0870
*               RSMRPAS = ADDR(RSMRPS);                            0871
         LA    @04,RSMRPS(,REG6)                                   0871
         ST    @04,RSMRPAS(,REG6)                                  0871
*             END;                                                 0872
*                                                                  0872
*         /***********************************************************/
*         /*                                                         */
*         /*    IF WORKFILE PARAMETER SPECIFIED, SAVE DDNAME AND     */
*         /*    PASSWORD.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0873
*         IF ADDR(WFDN) ^= 0                                       0873
*           THEN                                                   0873
@RF00868 L     @04,@PC00001+4                                      0873
         L     @15,FDTPTR+16(,@04)                                 0873
         LTR   @15,@15                                             0873
         BZ    @RF00873                                            0873
*             DO;                                                  0874
*               RSWFDDNM = WFILEVAL(1:WFILELEN);                   0875
         MVI   RSWFDDNM+1(REG6),C' '                               0875
         MVC   RSWFDDNM+2(6,REG6),RSWFDDNM+1(REG6)                 0875
         L     @04,FDTPTR+60(,@04)                                 0875
         SLR   @15,@15                                             0875
         IC    @15,WFILELEN(,@04)                                  0875
         BCTR  @15,0                                               0875
         EX    @15,@SM03793                                        0875
*               IF WFILEPLN ^= 0                                   0876
*                 THEN                                             0876
         CLI   WFILEPLN(@04),0                                     0876
         BE    @RF00876                                            0876
*                   DO;                                            0877
*                     RSWFPS = WFILEPAS(1:WFILEPLN);               0878
         MVI   RSWFPS+1(REG6),C' '                                 0878
         MVC   RSWFPS+2(6,REG6),RSWFPS+1(REG6)                     0878
         SLR   @15,@15                                             0878
         IC    @15,WFILEPLN(,@04)                                  0878
         BCTR  @15,0                                               0878
         EX    @15,@SM03795                                        0878
*                     RSWFPAS = ADDR(RSWFPS);                      0879
         LA    @04,RSWFPS(,REG6)                                   0879
         ST    @04,RSWFPAS(,REG6)                                  0879
*                   END;                                           0880
*                                                                  0880
*             END;                                                 0881
*                                                                  0881
*         /***********************************************************/
*         /*                                                         */
*         /*    IF WORKFILE PARAMETER NOT SPECIFIED, USE DEFAULT     */
*         /*    DDNAME OF IDCUT1                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0882
*           ELSE                                                   0882
*             RSWFDDNM = IDCUT1;                                   0882
*                                                                  0882
         B     @RC00873                                            0882
@RF00873 MVC   RSWFDDNM(8,REG6),@CC00777                           0882
*         RSWFDD = ADDR(RSWFDDNM);                                 0883
*                                                                  0883
@RC00873 LA    @04,RSWFDDNM(,REG6)                                 0883
         ST    @04,RSWFDD(,REG6)                                   0883
*         /***********************************************************/
*         /*                                                         */
*         /*    IF WORKCAT PARAMETER SPECIFIED, SAVE DSNAME AND      */
*         /*    PASSWORD.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0884
*         IF ADDR(WCAT) ^= 0                                       0884
*           THEN                                                   0884
         L     @04,@PC00001+4                                      0884
         L     @04,FDTPTR+20(,@04)                                 0884
         LTR   @04,@04                                             0884
         BZ    @RF00884                                            0884
*             DO;                                                  0885
*               RSWCATNM = WCATVAL(1:WCATLEN);                     0886
         MVI   RSWCATNM+1(REG6),C' '                               0886
         MVC   RSWCATNM+2(42,REG6),RSWCATNM+1(REG6)                0886
         SLR   @15,@15                                             0886
         IC    @15,WCATLEN(,@04)                                   0886
         BCTR  @15,0                                               0886
         EX    @15,@SM03797                                        0886
*               RSWCDS = ADDR(RSWCATNM);                           0887
         LA    @15,RSWCATNM(,REG6)                                 0887
         ST    @15,RSWCDS(,REG6)                                   0887
*               IF WCATPLN ^= 0                                    0888
*                 THEN                                             0888
         CLI   WCATPLN(@04),0                                      0888
         BE    @RF00888                                            0888
*                   DO;                                            0889
*                     RSWCATPS = WCATPAS(1:WCATPLN);               0890
         MVI   RSWCATPS+1(REG6),C' '                               0890
         MVC   RSWCATPS+2(6,REG6),RSWCATPS+1(REG6)                 0890
         SLR   @15,@15                                             0890
         IC    @15,WCATPLN(,@04)                                   0890
         BCTR  @15,0                                               0890
         EX    @15,@SM03799                                        0890
*                     RSWCPAS = ADDR(RSWCATPS);                    0891
         LA    @04,RSWCATPS(,REG6)                                 0891
         ST    @04,RSWCPAS(,REG6)                                  0891
*                   END;                                           0892
*                                                                  0892
*             END;                                                 0893
*                                                                  0893
@RF00888 DS    0H                                                  0894
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE IGNORE OR NOIGNORE OPTION.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0894
*         IF ADDR(IGN) ^= 0                                        0894
*           THEN                                                   0894
@RF00884 L     @04,@PC00001+4                                      0894
         L     @04,FDTPTR+24(,@04)                                 0894
         LTR   @04,@04                                             0894
         BZ    @RF00894                                            0894
*             RSIGNR = ON;                                         0895
*                                                                  0895
         OI    RSIGNR(REG6),B'00000001'                            0895
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE GRAB CONTROL BLOCKS.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0896
*         RSIDX = 1;                                               0896
*                                                                  0896
@RF00894 MVC   RSIDX(2,REG6),@CH00219                              0896
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG GRABS                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0897
*         RSGRABCU = ADDR(GRABSCA);                                0897
         L     @04,RSIOTBL(,REG6)                                  0897
         LA    @04,GRABSCA(,@04)                                   0897
         ST    @04,RSGRABCU(,REG6)                                 0897
*         GRABSN = 2;                                              0898
*                                                                  0898
         MVI   GRABSN(@04),X'02'                                   0898
*INITLP2: DO RSIDX1 = 1 TO GRABSN;                                 0899
*                                                                  0899
INITLP2  LA    @04,1                                               0899
         B     @DE00899                                            0899
@DL00899 DS    0H                                                  0900
*           RABARRAY(RSIDX1) = ADDR(RABS(RSIDX));                  0900
         LH    @04,RSIDX1(,REG6)                                   0900
         SLA   @04,2                                               0900
         L     @01,RSGRABCU(,REG6)                                 0900
         LH    @15,RSIDX(,REG6)                                    0900
         LR    @14,@15                                             0900
         MH    @14,@CH03734                                        0900
         L     @03,RSRABWA(,REG6)                                  0900
         AL    @03,@CF03802                                        0900
         LA    @00,RABS(@14,@03)                                   0900
         ST    @00,RABARRAY-4(@04,@01)                             0900
*           RSIDX = RSIDX + 1;                                     0901
*                                                                  0901
         AL    @15,@CF00219                                        0901
         STH   @15,RSIDX(,REG6)                                    0901
*         END INITLP2;                                             0902
         LA    @04,1                                               0902
         AH    @04,RSIDX1(,REG6)                                   0902
@DE00899 STH   @04,RSIDX1(,REG6)                                   0902
         L     @01,RSGRABCU(,REG6)                                 0902
         SLR   @00,@00                                             0902
         IC    @00,GRABSN(,@01)                                    0902
         CR    @04,@00                                             0902
         BNH   @DL00899                                            0902
*         GRABRABE = GRABRAB1;         /*EXT/MODIFY BUFFER           */
*                                                                  0903
         L     @04,RSGRABCU(,REG6)                                 0903
         L     @15,GRABRAB1(,@04)                                  0903
         ST    @15,GRABRABE(,@04)                                  0903
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG RECOVERY AREA GRABS                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0904
*         RSGRABCU = ADDR(GRABSCR);                                0904
         L     @04,RSIOTBL(,REG6)                                  0904
         LA    @04,GRABSCR(,@04)                                   0904
         ST    @04,RSGRABCU(,REG6)                                 0904
*         GRABSN = 2;                                              0905
*                                                                  0905
         MVI   GRABSN(@04),X'02'                                   0905
*INITLP3: DO RSIDX1 = 1 TO GRABSN;                                 0906
*                                                                  0906
INITLP3  LA    @04,1                                               0906
         B     @DE00906                                            0906
@DL00906 DS    0H                                                  0907
*           RABARRAY(RSIDX1) = ADDR(RABS(RSIDX));                  0907
         LH    @04,RSIDX1(,REG6)                                   0907
         SLA   @04,2                                               0907
         L     @01,RSGRABCU(,REG6)                                 0907
         LH    @15,RSIDX(,REG6)                                    0907
         LR    @14,@15                                             0907
         MH    @14,@CH03734                                        0907
         L     @03,RSRABWA(,REG6)                                  0907
         AL    @03,@CF03802                                        0907
         LA    @00,RABS(@14,@03)                                   0907
         ST    @00,RABARRAY-4(@04,@01)                             0907
*           RSIDX = RSIDX + 1;                                     0908
*                                                                  0908
         AL    @15,@CF00219                                        0908
         STH   @15,RSIDX(,REG6)                                    0908
*         END INITLP3;                                             0909
         LA    @04,1                                               0909
         AH    @04,RSIDX1(,REG6)                                   0909
@DE00906 STH   @04,RSIDX1(,REG6)                                   0909
         L     @01,RSGRABCU(,REG6)                                 0909
         SLR   @00,@00                                             0909
         IC    @00,GRABSN(,@01)                                    0909
         CR    @04,@00                                             0909
         BNH   @DL00906                                            0909
*         GRABRABE = GRABRAB1;         /*EXTRACT/MODIFY BUFFER       */
*                                                                  0910
         L     @04,RSGRABCU(,REG6)                                 0910
         L     @15,GRABRAB1(,@04)                                  0910
         ST    @15,GRABRABE(,@04)                                  0910
*         /***********************************************************/
*         /*                                                         */
*         /*    WORKFILE GRABS                                        *
*         /*                                                         */
*         /***********************************************************/
*                                                                  0911
*         RSGRABCU = ADDR(GRABSWF);                                0911
         L     @04,RSIOTBL(,REG6)                                  0911
         ST    @04,RSGRABCU(,REG6)                                 0911
*         GRABSN = 6;                                              0912
*                                                                  0912
         MVI   GRABSN(@04),X'06'                                   0912
*INITLP4: DO RSIDX1 = 1 TO GRABSN;                                 0913
*                                                                  0913
INITLP4  LA    @04,1                                               0913
         B     @DE00913                                            0913
@DL00913 DS    0H                                                  0914
*           RABARRAY(RSIDX1) = ADDR(RABS(RSIDX));                  0914
         LH    @04,RSIDX1(,REG6)                                   0914
         SLA   @04,2                                               0914
         L     @01,RSGRABCU(,REG6)                                 0914
         LH    @15,RSIDX(,REG6)                                    0914
         LR    @14,@15                                             0914
         MH    @14,@CH03734                                        0914
         L     @03,RSRABWA(,REG6)                                  0914
         AL    @03,@CF03802                                        0914
         LA    @00,RABS(@14,@03)                                   0914
         ST    @00,RABARRAY-4(@04,@01)                             0914
*           RSIDX = RSIDX + 1;                                     0915
*                                                                  0915
         AL    @15,@CF00219                                        0915
         STH   @15,RSIDX(,REG6)                                    0915
*         END INITLP4;                                             0916
         LA    @04,1                                               0916
         AH    @04,RSIDX1(,REG6)                                   0916
@DE00913 STH   @04,RSIDX1(,REG6)                                   0916
         L     @01,RSGRABCU(,REG6)                                 0916
         SLR   @00,@00                                             0916
         IC    @00,GRABSN(,@01)                                    0916
         CR    @04,@00                                             0916
         BNH   @DL00913                                            0916
*         GRABRABE = RABARRAY(GRABSN); /*EXT/MOD BUFFER              */
*                                                                  0917
         L     @04,RSGRABCU(,REG6)                                 0917
         SLR   @15,@15                                             0917
         IC    @15,GRABSN(,@04)                                    0917
         SLA   @15,2                                               0917
         L     @15,RABARRAY-4(@15,@04)                             0917
         ST    @15,GRABRABE(,@04)                                  0917
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE CPL-FPLS FOR UCATLG LOCATE REQUESTS         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0918
*         CTGFUNC = CTGLOC;                                        0918
         L     @04,CTGPLPTR(,REG6)                                 0918
         NI    CTGFUNC(@04),B'00111111'                            0918
         OI    CTGFUNC(@04),B'00100000'                            0918
*         CTGAM0 = ON;                                             0919
         OI    CTGAM0(@04),B'00000001'                             0919
*         CTGNAME = OFF;                                           0920
*         CTGCNAME = ON;                                           0921
         OI    CTGCNAME(@04),B'00000010'                           0921
         NI    CTGNAME(@04),B'11111011'                            0921
*         CTGWKA = ADDR(UCATWA);                                   0922
         L     @15,RSIOTBL(,REG6)                                  0922
         LA    @14,UCATWA(,@15)                                    0922
         ST    @14,CTGWKA(,@04)                                    0922
*         UCATWTLN = LENGTH(UCATWA);                               0923
         MVC   UCATWTLN(2,@15),@CH03739                            0923
*         CTGPSWD = RSMRPAS;                                       0924
         L     @15,RSMRPAS(,REG6)                                  0924
         ST    @15,CTGPSWD(,@04)                                   0924
*         CTGENT = ADDR(RSUCCINO);                                 0925
*                                                                  0925
         LA    @15,RSUCCINO(,REG6)                                 0925
         ST    @15,CTGENT(,@04)                                    0925
*INITLP5: DO RSIDX = 1 TO DIM(RSFPL);                              0926
*                                                                  0926
INITLP5  LA    @04,1                                               0926
         STH   @04,RSIDX(,REG6)                                    0926
@DL00926 DS    0H                                                  0927
*           CTGFLPTR = RSFPL(RSIDX);                               0927
         LH    @04,RSIDX(,REG6)                                    0927
         SLA   @04,2                                               0927
         L     @15,RSFPL-4(@04,REG6)                               0927
         ST    @15,CTGFLPTR(,REG6)                                 0927
*           CTGFLDNO = 1;                                          0928
         MVI   CTGFLDNO(@15),X'01'                                 0928
*           CTGFIELD(RSIDX) = CTGFLPTR;                            0929
*                                                                  0929
         L     @01,CTGPLPTR(,REG6)                                 0929
         ST    @15,CTGFIELD-4(@04,@01)                             0929
*         END INITLP5;                                             0930
*                                                                  0930
         LA    @04,1                                               0930
         AH    @04,RSIDX(,REG6)                                    0930
         STH   @04,RSIDX(,REG6)                                    0930
         C     @04,@CF00287                                        0930
         BNH   @DL00926                                            0930
*         /***********************************************************/
*         /*                                                         */
*         /*  OPEN THE CATALOG VIA DSOPEN. IF THE CATALOG DDNAME     */
*         /*  WAS SUPPLIED IN THE FDT, USE IT TO OPEN THE DATA SET,  */
*         /*  OTHERWISE, DYNAMICALLY ALLOCATE THE DATA SET VIA       */
*         /*  THE DSNAME.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0931
*         IF ADDR(CATDN) ^= 0                                      0931
*           THEN                                                   0931
         SLR   @04,@04                                             0931
         L     @15,@PC00001+4                                      0931
         C     @04,FDTPTR+8(,@15)                                  0931
         BE    @RF00931                                            0931
*             RSCADS = NULLPTR;                                    0932
*                                                                  0932
         ST    @04,RSCADS(,REG6)                                   0932
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN             */
*         CALL IDCRS6DO('O','C','U',RSCADD,RSCADS,RSCAPAS);        0933
*                                                                  0933
@RF00931 LA    @04,@CC03581                                        0933
         ST    @04,@AL00001                                        0933
         LA    @04,@CC00805                                        0933
         ST    @04,@AL00001+4                                      0933
         LA    @04,@CC00817                                        0933
         ST    @04,@AL00001+8                                      0933
         LA    @04,RSCADD(,REG6)                                   0933
         ST    @04,@AL00001+12                                     0933
         LA    @04,RSCADS(,REG6)                                   0933
         ST    @04,@AL00001+16                                     0933
         LA    @04,RSCAPAS(,REG6)                                  0933
         ST    @04,@AL00001+20                                     0933
         L     @15,@CV03580                                        0933
         LA    @01,@AL00001                                        0933
         BALR  @14,@15                                             0933
*         RESPECIFY RTNREG RSTD;                                   0934
*         TESTRC = RTNREG;                                         0935
         STH   RTNREG,TESTRC(,REG6)                                0935
*         RESPECIFY RTNREG UNRSTD;                                 0936
*                                                                  0936
*         /***********************************************************/
*         /*                                                         */
*         /*    IF OPEN FAILED, CALL CKERR TO TERMINATE              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0937
*         IF TESTRC ^= 0                                           0937
*           THEN                                                   0937
*                                                                  0937
*                                                                  0937
         LH    @04,TESTRC(,REG6)                                   0937
         LTR   @04,@04                                             0937
         BZ    @RF00937                                            0937
*             DO;                                                  0938
*             /*CALL CKERR*/                                       0939
*               RSCKERR = RSCKERR && RSCKERR;                      0939
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0939
*               RSCKERN = RSE001;                                  0940
         MVC   RSCKERN(2,REG6),@CH00219                            0940
*               RSCKTERM = 'TERM';                                 0941
*                                                                  0941
         MVC   RSCKTERM(4,REG6),@CC03543                           0941
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          0942
         L     @15,@CV03544                                        0942
         BALR  @14,@15                                             0942
*             END;                                                 0943
*                                                                  0943
*         /***********************************************************/
*         /*                                                         */
*         /*  GET CATALOG DATA SET NAME VIA UIOINFO.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0944
*         IOINFOPT = ''B;                                          0944
@RF00937 LA    @04,700                                             0944
         ALR   @04,REG6                                            0944
         MVI   IOINFOPT(@04),X'00'                                 0944
*         IOINFDSN = ON;                                           0945
         OI    IOINFDSN(@04),B'00100000'                           0945
*         RSUIRPT = 0;                                             0946
*                                                                  0946
         SLR   @15,@15                                             0946
         ST    @15,RSUIRPT(,REG6)                                  0946
*         CALL IDCIOSI0 (GDTTBL,IOINFOPT,RSUIRPT,RSCATDDN,POOL3);  0947
*                                                                  0947
         ST    REG5,@AL00001                                       0947
         ST    @04,@AL00001+4                                      0947
         LA    @04,RSUIRPT(,REG6)                                  0947
         ST    @04,@AL00001+8                                      0947
         LA    @04,RSCATDDN(,REG6)                                 0947
         ST    @04,@AL00001+12                                     0947
         LA    @04,@CC00904                                        0947
         ST    @04,@AL00001+16                                     0947
         MVI   @AL00001+16,X'80'                                   0947
         L     @15,GDTIFO(,REG5)                                   0947
         LA    @01,@AL00001                                        0947
         BALR  @14,@15                                             0947
*         RESPECIFY RTNREG RSTD;                                   0948
*         TESTRC = RTNREG;                                         0949
         STH   RTNREG,TESTRC(,REG6)                                0949
*         RESPECIFY RTNREG UNRSTD;                                 0950
*                                                                  0950
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UIOINFO FAILED, CALL CKERR TO TERMINATE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0951
*         IF TESTRC ^= 0                                           0951
*           THEN                                                   0951
*                                                                  0951
*                                                                  0951
         LH    @04,TESTRC(,REG6)                                   0951
         LTR   @04,@04                                             0951
         BZ    @RF00951                                            0951
*             DO;                                                  0952
*             /*CALL CKERR*/                                       0953
*               RSCKERR = RSCKERR && RSCKERR;                      0953
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0953
*               RSCKERN = RSE002;                                  0954
         MVC   RSCKERN(2,REG6),@CH00157                            0954
*               RSCKTERM = 'TERM';                                 0955
*                                                                  0955
         MVC   RSCKTERM(4,REG6),@CC03543                           0955
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          0956
         L     @15,@CV03544                                        0956
         BALR  @14,@15                                             0956
*             END;                                                 0957
*                                                                  0957
*                                                                  0957
*         /***********************************************************/
*         /*                                                         */
*         /*    EXTRACT CATALOG DATA SET NAME RETURNED BY            */
*         /*    UIOINFO AND SAVE IN MAIN WORKAREA.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0958
*         RSUIRPT = RSUIRPT + UIOHDR;                              0958
@RF00951 LA    @04,4                                               0958
         AL    @04,RSUIRPT(,REG6)                                  0958
         ST    @04,RSUIRPT(,REG6)                                  0958
*         RSCATDSN = UIODNM;                                       0959
         MVC   RSCATDSN(44,REG6),UIODNM(@04)                       0959
*         RSCADS = ADDR(RSCATDSN);                                 0960
*                                                                  0960
         LA    @04,RSCATDSN(,REG6)                                 0960
         ST    @04,RSCADS(,REG6)                                   0960
*         /***********************************************************/
*         /*                                                         */
*         /*    FREE UIOINFO STORAGE.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0961
*         CALL IDCSAFP0 (GDTTBL,POOL3);                            0961
*                                                                  0961
         ST    REG5,@AL00001                                       0961
         LA    @04,@CC00904                                        0961
         ST    @04,@AL00001+4                                      0961
         MVI   @AL00001+4,X'80'                                    0961
         L     @15,GDTFPL(,REG5)                                   0961
         LA    @01,@AL00001                                        0961
         BALR  @14,@15                                             0961
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN REAL CATALOG DATA SET NAME VIA UCATLG LOCATE.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0962
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPLETE CPL-FPL FOR UCATLG CALL.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0962
*         CTGCAT = RSCADS;                                         0962
         L     @04,CTGPLPTR(,REG6)                                 0962
         L     @15,RSCADS(,REG6)                                   0962
         ST    @15,CTGCAT(,@04)                                    0962
*         RSUCCINO = CLUSCI;                                       0963
         MVC   RSUCCINO(3,REG6),@CF00157+1                         0963
*         CTGTYPE = CTGTCL;                                        0964
         MVI   CTGTYPE(@04),C'C'                                   0964
*         CTGNOFLD = 1;                                            0965
*                                                                  0965
         MVI   CTGNOFLD(@04),X'01'                                 0965
*         CTGFLPTR = CTGFIELD(1);                                  0966
         L     @04,CTGFIELD(,@04)                                  0966
         ST    @04,CTGFLPTR(,REG6)                                 0966
*         CTGFLDNM = ADDR(ENTNAME);                                0967
*                                                                  0967
         LA    @15,@CC01088                                        0967
         ST    @15,CTGFLDNM(,@04)                                  0967
*         /***********************************************************/
*         /*                                                         */
*         /*    ISSUE LOCATE REQUEST VIA UCATLG.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0968
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         0968
*                                                                  0968
         ST    REG5,@AL00001                                       0968
         LA    @04,CTGPLPTR(,REG6)                                 0968
         ST    @04,@AL00001+4                                      0968
         L     @15,GDTCAT(,REG5)                                   0968
         LA    @01,@AL00001                                        0968
         BALR  @14,@15                                             0968
*         RESPECIFY RTNREG RSTD;                                   0969
*         TESTRC = RTNREG;                                         0970
         STH   RTNREG,TESTRC(,REG6)                                0970
*         RESPECIFY RTNREG UNRSTD;                                 0971
*                                                                  0971
*         /***********************************************************/
*         /*                                                         */
*         /*    FIRST UCATLG SUCCESSFUL.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0972
*         IF TESTRC = 0                                            0972
*           THEN                                                   0972
*                                                                  0972
         LH    @04,TESTRC(,REG6)                                   0972
         LTR   @04,@04                                             0972
         BNZ   @RF00972                                            0972
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE CATALOG DSNAME IN MAIN WORKAREA.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0973
*             RSCATDSN = INITDSN(1:CTGFLNG(1));                    0973
*                                                                  0973
         MVI   RSCATDSN+1(REG6),C' '                               0973
         MVC   RSCATDSN+2(42,REG6),RSCATDSN+1(REG6)                0973
         L     @04,CTGFLPTR(,REG6)                                 0973
         L     @15,CTGFLNG(,@04)                                   0973
         BCTR  @15,0                                               0973
         L     @04,CTGFLPT(,@04)                                   0973
         EX    @15,@SM03804                                        0973
*         /***********************************************************/
*         /*                                                         */
*         /*  GET CATALOG VOLSER AND TIMESTAMP VIA UCATLG LOCATE.    */
*         /*                                                         */
*         /***********************************************************/
*         IF TESTRC = 0                                            0974
*           THEN                                                   0974
@RF00972 LH    @04,TESTRC(,REG6)                                   0974
         LTR   @04,@04                                             0974
         BNZ   @RF00974                                            0974
*INUC2:       DO;                                                  0975
*                                                                  0975
INUC2    DS    0H                                                  0976
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPLETE CPL-FPLS FOR UCATLG CALL.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0976
*               RSUCCINO = VOLCI;                                  0976
         MVC   RSUCCINO(3,REG6),@CF00040+1                         0976
*               CTGTYPE = CTGTVOL;                                 0977
         L     @04,CTGPLPTR(,REG6)                                 0977
         MVI   CTGTYPE(@04),C'V'                                   0977
*               CTGNOFLD = 2;                                      0978
*                                                                  0978
         MVI   CTGNOFLD(@04),X'02'                                 0978
*               CTGFLPTR = CTGFIELD(1);                            0979
         L     @15,CTGFIELD(,@04)                                  0979
         ST    @15,CTGFLPTR(,REG6)                                 0979
*               CTGFLDNM = ADDR(ENTNAME);                          0980
*                                                                  0980
         LA    @14,@CC01088                                        0980
         ST    @14,CTGFLDNM(,@15)                                  0980
*               CTGFLPTR = CTGFIELD(2);                            0981
         L     @04,CTGFIELD+4(,@04)                                0981
         ST    @04,CTGFLPTR(,REG6)                                 0981
*               CTGFLDNM = ADDR(VOLTSTMP);                         0982
*                                                                  0982
         LA    @15,@CC01092                                        0982
         ST    @15,CTGFLDNM(,@04)                                  0982
*         /***********************************************************/
*         /*                                                         */
*         /*    ISSUE LOCATE REQUEST VIA UCATLG.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0983
*               CALL IDCSACA0 (GDTTBL,CTGPLPTR);                   0983
*                                                                  0983
         ST    REG5,@AL00001                                       0983
         LA    @04,CTGPLPTR(,REG6)                                 0983
         ST    @04,@AL00001+4                                      0983
         L     @15,GDTCAT(,REG5)                                   0983
         LA    @01,@AL00001                                        0983
         BALR  @14,@15                                             0983
*               RESPECIFY RTNREG RSTD;                             0984
*               TESTRC = RTNREG;                                   0985
         STH   RTNREG,TESTRC(,REG6)                                0985
*               RESPECIFY RTNREG UNRSTD;                           0986
*                                                                  0986
*         /***********************************************************/
*         /*                                                         */
*         /*    SECOND UCATLG SUCCESSFUL.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0987
*               IF TESTRC = 0                                      0987
*                 THEN                                             0987
         LH    @04,TESTRC(,REG6)                                   0987
         LTR   @04,@04                                             0987
         BNZ   @RF00987                                            0987
*                   DO;                                            0988
*                     CTGFLPTR = CTGFIELD(1);                      0989
*                                                                  0989
         L     @04,CTGPLPTR(,REG6)                                 0989
         L     @15,CTGFIELD(,@04)                                  0989
         ST    @15,CTGFLPTR(,REG6)                                 0989
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE CATALOG VOLSER IN LOCAL WORKAREA.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0990
*                     RSINVLSR = INITVLSR(1:CTGFLNG(1));           0990
*                                                                  0990
         MVI   RSINVLSR+1(REG6),C' '                               0990
         MVC   RSINVLSR+2(4,REG6),RSINVLSR+1(REG6)                 0990
         L     @14,CTGFLNG(,@15)                                   0990
         BCTR  @14,0                                               0990
         L     @01,CTGFLPT(,@15)                                   0990
         EX    @14,@SM03806                                        0990
*                     CTGFLPTR = CTGFIELD(2);                      0991
*                                                                  0991
         L     @04,CTGFIELD+4(,@04)                                0991
         ST    @04,CTGFLPTR(,REG6)                                 0991
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE TIMESTAMP IN LOCAL WORKAREA.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0992
*                     RSINTS = INITTS(1:CTGFLNG(1));               0992
*                                                                  0992
         MVI   RSINTS+1(REG6),C' '                                 0992
         MVC   RSINTS+2(6,REG6),RSINTS+1(REG6)                     0992
         L     @15,CTGFLNG(,@04)                                   0992
         BCTR  @15,0                                               0992
         L     @04,CTGFLPT(,@04)                                   0992
         EX    @15,@SM03808                                        0992
*                 END;                                             0993
*                                                                  0993
*             END INUC2;                                           0994
*                                                                  0994
@RF00987 DS    0H                                                  0995
*         /***********************************************************/
*         /*                                                         */
*         /*     IF EITHER UCATLG FAILED WITH A RETURN CODE          */
*         /*     OF 4, THE CATALOG IS INACCESSIBLE AND, HENCE, NOT A */
*         /*     CATALOG. ISSUE MESSAGE STATING THAT THE CATALOG     */
*         /*     TO BE RESET IS NOT A RECOVERABLE CATALOG.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0995
*         IF TESTRC = RCCAT                                        0995
*           THEN                                                   0995
*                                                                  0995
@RF00974 CLC   TESTRC(2,REG6),@CH00046                             0995
         BNE   @RF00995                                            0995
*             DO;                                                  0996
*             /*CALL CKERR*/                                       0997
*               RSCKERR = RSCKERR && RSCKERR;                      0997
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0997
*               RSCKERN = RSE003;                                  0998
         MVC   RSCKERN(2,REG6),@CH00166                            0998
*               RSCKTERM = 'TERM';                                 0999
*                                                                  0999
         MVC   RSCKTERM(4,REG6),@CC03543                           0999
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1000
         L     @15,@CV03544                                        1000
         BALR  @14,@15                                             1000
*             END;                                                 1001
*                                                                  1001
*         /***********************************************************/
*         /*                                                         */
*         /*    IF EITHER UCATLG FAILED, CALL CKERR TO TERMINATE.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1002
*         IF TESTRC ^= 0                                           1002
*           THEN                                                   1002
@RF00995 LH    @04,TESTRC(,REG6)                                   1002
         LTR   @04,@04                                             1002
         BZ    @RF01002                                            1002
*             DO;                                                  1003
*               RSCATRC = TESTRC;                                  1004
*                                                                  1004
*                                                                  1004
         STH   @04,RSCATRC(,REG6)                                  1004
*               DO;                                                1005
*               /*CALL CKERR*/                                     1006
*                 RSCKERR = RSCKERR && RSCKERR;                    1006
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1006
*                 RSCKERN = RSE035;                                1007
         MVC   RSCKERN(2,REG6),@CH00853                            1007
*                 RSCKTERM = 'RETURN';                             1008
*                                                                  1008
         MVC   RSCKTERM(4,REG6),@CC03584                           1008
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1009
         L     @15,@CV03544                                        1009
         BALR  @14,@15                                             1009
*               END;                                               1010
*                                                                  1010
*                                                                  1010
*               DO;                                                1011
*               /*CALL CKERR*/                                     1012
*                 RSCKERR = RSCKERR && RSCKERR;                    1012
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1012
*                 RSCKERN = RSE017;                                1013
         MVC   RSCKERN(2,REG6),@CH00930                            1013
*                 RSCKTERM = 'TERM';                               1014
*                                                                  1014
         MVC   RSCKTERM(4,REG6),@CC03543                           1014
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1015
         L     @15,@CV03544                                        1015
         BALR  @14,@15                                             1015
*               END;                                               1016
*                                                                  1016
*             END;                                                 1017
*                                                                  1017
*         /***********************************************************/
*         /*                                                         */
*         /*    BOTH UCATLG CALLS WERE SUCCESSFUL. CALL CKERR TO     */
*         /*    PRINT INFORMATIONAL MESSAGE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1018
*                                                                  1018
*         DO;                                                      1018
@RF01002 DS    0H                                                  1019
*         /*CALL CKERR*/                                           1019
*           RSCKERR = RSCKERR && RSCKERR;                          1019
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1019
*           RSCKERN = RSE009;                                      1020
         MVC   RSCKERN(2,REG6),@CH00040                            1020
*           RSCKTERM = 'RETU';                                     1021
         MVC   RSCKTERM(4,REG6),@CC03585                           1021
*           RSCKMVAR(1) = ADDR(RSCATDSN);                          1022
         LA    @04,RSCATDSN(,REG6)                                 1022
         ST    @04,RSCKMVAR(,REG6)                                 1022
*           RSCKMVAR(2) = ADDR(RSINVLSR);                          1023
         LA    @04,RSINVLSR(,REG6)                                 1023
         ST    @04,RSCKMVAR+4(,REG6)                               1023
*           RSCKMVAR(3) = ADDR(RSINTS);                            1024
*                                                                  1024
         LA    @04,RSINTS(,REG6)                                   1024
         ST    @04,RSCKMVAR+8(,REG6)                               1024
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR              */
*         CALL CKERR;                                              1025
         L     @15,@CV03544                                        1025
         BALR  @14,@15                                             1025
*         END;                                                     1026
*                                                                  1026
*         /***********************************************************/
*         /*                                                         */
*         /*  GET CATALOG ACB AND DATA ATTRIBUTES VIA UCATLG LOCATE  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1027
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPLETE CPL-FPLS FOR UCATLG REQUEST.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1027
*         RSUCCINO = DATACI;                                       1027
         SLR   @04,@04                                             1027
         STCM  @04,7,RSUCCINO(REG6)                                1027
*         CTGTYPE = CTGTDATA;                                      1028
         L     @04,CTGPLPTR(,REG6)                                 1028
         MVI   CTGTYPE(@04),C'D'                                   1028
*         CTGNOFLD = 2;                                            1029
*                                                                  1029
         MVI   CTGNOFLD(@04),X'02'                                 1029
*         CTGFLPTR = CTGFIELD(1);                                  1030
         L     @15,CTGFIELD(,@04)                                  1030
         ST    @15,CTGFLPTR(,REG6)                                 1030
*         CTGFLDNM = ADDR(CATACB);                                 1031
*                                                                  1031
         LA    @14,@CC01094                                        1031
         ST    @14,CTGFLDNM(,@15)                                  1031
*         CTGFLPTR = CTGFIELD(2);                                  1032
         L     @04,CTGFIELD+4(,@04)                                1032
         ST    @04,CTGFLPTR(,REG6)                                 1032
*         CTGFLDNM = ADDR(ATTR1);                                  1033
*                                                                  1033
         LA    @15,@CC01096                                        1033
         ST    @15,CTGFLDNM(,@04)                                  1033
*         /***********************************************************/
*         /*                                                         */
*         /*    ISSUE UCATLG LOCATE REQUEST.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1034
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         1034
*                                                                  1034
         ST    REG5,@AL00001                                       1034
         LA    @04,CTGPLPTR(,REG6)                                 1034
         ST    @04,@AL00001+4                                      1034
         L     @15,GDTCAT(,REG5)                                   1034
         LA    @01,@AL00001                                        1034
         BALR  @14,@15                                             1034
*         RESPECIFY RTNREG RSTD;                                   1035
*         TESTRC = RTNREG;                                         1036
         STH   RTNREG,TESTRC(,REG6)                                1036
*         RESPECIFY RTNREG UNRSTD;                                 1037
*                                                                  1037
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UCATLG FAILED, CALL CKERR TO TERMINATE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1038
*         IF TESTRC ^= 0                                           1038
*           THEN                                                   1038
*                                                                  1038
*                                                                  1038
         LH    @04,TESTRC(,REG6)                                   1038
         LTR   @04,@04                                             1038
         BZ    @RF01038                                            1038
*             DO;                                                  1039
*             /*CALL CKERR*/                                       1040
*               RSCKERR = RSCKERR && RSCKERR;                      1040
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1040
*               RSCKERN = RSE017;                                  1041
         MVC   RSCKERN(2,REG6),@CH00930                            1041
*               RSCKTERM = 'TERM';                                 1042
*                                                                  1042
         MVC   RSCKTERM(4,REG6),@CC03543                           1042
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1043
         L     @15,@CV03544                                        1043
         BALR  @14,@15                                             1043
*             END;                                                 1044
*                                                                  1044
*         /***********************************************************/
*         /*                                                         */
*         /*  UCATLG SUCCESSFUL.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1045
*         CTGFLPTR = CTGFIELD(1);                                  1045
*                                                                  1045
@RF01038 L     @04,CTGPLPTR(,REG6)                                 1045
         L     @15,CTGFIELD(,@04)                                  1045
         ST    @15,CTGFLPTR(,REG6)                                 1045
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE CATALOG ACB IN MAIN WORKAREA.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1046
*         RSCATACB = INITACB;                                      1046
*                                                                  1046
         L     @01,CTGFLPT(,@15)                                   1046
         L     @15,INITACB(,@01)                                   1046
         ST    @15,RSCATACB(,REG6)                                 1046
*         CTGFLPTR = CTGFIELD(2);                                  1047
*                                                                  1047
         L     @04,CTGFIELD+4(,@04)                                1047
         ST    @04,CTGFLPTR(,REG6)                                 1047
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE DATA SET ATTRIBUTES IN LOCAL WORKAREA.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1048
*         RSINATR1 = INITATR1;                                     1048
*                                                                  1048
         L     @04,CTGFLPT(,@04)                                   1048
         MVC   RSINATR1(1,REG6),INITATR1(@04)                      1048
*         /***********************************************************/
*         /*                                                         */
*         /*  IF CATALOG IS NOT RECOVERABLE, CALL CKERR TO           */
*         /*  TERMINATE.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1049
*         IF RSINRCV = OFF                                         1049
*           THEN                                                   1049
*                                                                  1049
*                                                                  1049
         TM    RSINRCV(REG6),B'00001000'                           1049
         BNZ   @RF01049                                            1049
*             DO;                                                  1050
*             /*CALL CKERR*/                                       1051
*               RSCKERR = RSCKERR && RSCKERR;                      1051
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1051
*               RSCKERN = RSE003;                                  1052
         MVC   RSCKERN(2,REG6),@CH00166                            1052
*               RSCKTERM = 'TERM';                                 1053
*                                                                  1053
         MVC   RSCKTERM(4,REG6),@CC03543                           1053
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1054
         L     @15,@CV03544                                        1054
         BALR  @14,@15                                             1054
*             END;                                                 1055
*                                                                  1055
*         /***********************************************************/
*         /*                                                         */
*         /*  IF CATALOG IS THE SYSTEM MASTER CATALOG, CALL CKERR    */
*         /*  TO TERMINATE.                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1056
*         CBSPTR = CVTCBSP;                                        1056
*                                                                  1056
@RF01049 L     @04,CVTPTR                                          1056
         L     @04,CVTCBSP(,@04)                                   1056
         ST    @04,CBSPTR(,REG6)                                   1056
*         IF CBSACB = RSCATACB                                     1057
*           THEN                                                   1057
*                                                                  1057
*                                                                  1057
         CLC   CBSACB(4,@04),RSCATACB(REG6)                        1057
         BNE   @RF01057                                            1057
*             DO;                                                  1058
*             /*CALL CKERR*/                                       1059
*               RSCKERR = RSCKERR && RSCKERR;                      1059
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1059
*               RSCKERN = RSE004;                                  1060
         MVC   RSCKERN(2,REG6),@CH00046                            1060
*               RSCKTERM = 'TERM';                                 1061
*                                                                  1061
         MVC   RSCKTERM(4,REG6),@CC03543                           1061
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1062
         L     @15,@CV03544                                        1062
         BALR  @14,@15                                             1062
*             END;                                                 1063
*                                                                  1063
*         /***********************************************************/
*         /*                                                         */
*         /*  ENSURE EXCLUSIVE USE OF THE CATALOG                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1064
*                                                                  1064
*         /***********************************************************/
*         /*                                                         */
*         /*    OBTAIN CATALOG UCB ADDRESS VIA USYSINFO              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1064
*         RSINUAP = ADDR(UCBAREA);                                 1064
*                                                                  1064
@RF01057 L     @04,RSIOTBL(,REG6)                                  1064
         LA    @04,UCBAREA(,@04)                                   1064
         ST    @04,RSINUAP(,REG6)                                  1064
*         CALL IDCSASI0 (GDTTBL,UNIT,RSINUAP,RSCATDDN);            1065
*                                                                  1065
         ST    REG5,@AL00001                                       1065
         LA    @04,UNIT                                            1065
         ST    @04,@AL00001+4                                      1065
         LA    @04,RSINUAP(,REG6)                                  1065
         ST    @04,@AL00001+8                                      1065
         LA    @04,RSCATDDN(,REG6)                                 1065
         ST    @04,@AL00001+12                                     1065
         MVI   @AL00001+12,X'80'                                   1065
         L     @15,GDTSFO(,REG5)                                   1065
         LA    @01,@AL00001                                        1065
         BALR  @14,@15                                             1065
*         RESPECIFY RTNREG RSTD;                                   1066
*         TESTRC = RTNREG;                                         1067
         STH   RTNREG,TESTRC(,REG6)                                1067
*         RESPECIFY RTNREG UNRSTD;                                 1068
*                                                                  1068
*         /***********************************************************/
*         /*                                                         */
*         /*    IF USYSINFO FAILED, CALL CKERR TO TERMINATE.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1069
*         IF TESTRC ^= 0                                           1069
*           THEN                                                   1069
*                                                                  1069
*                                                                  1069
         LH    @04,TESTRC(,REG6)                                   1069
         LTR   @04,@04                                             1069
         BZ    @RF01069                                            1069
*             DO;                                                  1070
*             /*CALL CKERR*/                                       1071
*               RSCKERR = RSCKERR && RSCKERR;                      1071
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1071
*               RSCKERN = RSE006;                                  1072
         MVC   RSCKERN(2,REG6),@CH00160                            1072
*               RSCKTERM = 'TERM';                                 1073
*                                                                  1073
         MVC   RSCKTERM(4,REG6),@CC03543                           1073
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1074
         L     @15,@CV03544                                        1074
         BALR  @14,@15                                             1074
*             END;                                                 1075
*                                                                  1075
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE CATALOG UCB ADDRESS RETURNED BY USYSINFO        */
*         /*    IN MAIN WORKAREA                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1076
*         RSCATUCB = RSINUAP -> UNITUCB;                           1076
*                                                                  1076
@RF01069 L     @04,RSINUAP(,REG6)                                  1076
         L     @04,UNITUCB(,@04)                                   1076
         ST    @04,RSCATUCB(,REG6)                                 1076
*         /***********************************************************/
*         /*                                                         */
*         /*    RESERVE CATALOG VIA URESERVE.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1077
*         RSCAMAJN = SYSTEM;                                       1077
         L     @04,RSIOTBL(,REG6)                                  1077
         MVC   RSCAMAJN(8,@04),@CC00781                            1077
*         RSCAMIND = RSCATDSN;                                     1078
         MVC   RSCAMIND(44,@04),RSCATDSN(REG6)                     1078
*         IF RSCAMIND (21) = ' '                                   1079
*           THEN                                                   1079
         CLI   RSCAMIND+20(@04),C' '                               1079
         BNE   @RF01079                                            1079
*             RSCAMINL = 20;                                       1080
         MVI   RSCAMINL(@04),X'14'                                 1080
*           ELSE                                                   1081
*             RSCAMINL = LENGTH(RSCAMIND);                         1081
*                                                                  1081
         B     @RC01079                                            1081
@RF01079 L     @04,RSIOTBL(,REG6)                                  1081
         MVI   RSCAMINL(@04),X'2C'                                 1081
*         CALL IDCSARV0 (GDTTBL,EXCL,WAIT,RSCATUCB,RSCAMAJN,RSCAMINN);
*                                                                  1082
@RC01079 ST    REG5,@AL00001                                       1082
         LA    @04,EXCL                                            1082
         ST    @04,@AL00001+4                                      1082
         LA    @04,WAIT                                            1082
         ST    @04,@AL00001+8                                      1082
         LA    @04,RSCATUCB(,REG6)                                 1082
         ST    @04,@AL00001+12                                     1082
         L     @04,RSIOTBL(,REG6)                                  1082
         LA    @15,RSCAMAJN(,@04)                                  1082
         ST    @15,@AL00001+16                                     1082
         LA    @04,RSCAMINN(,@04)                                  1082
         ST    @04,@AL00001+20                                     1082
         MVI   @AL00001+20,X'80'                                   1082
         L     @15,GDTRSV(,REG5)                                   1082
         LA    @01,@AL00001                                        1082
         BALR  @14,@15                                             1082
*         RESPECIFY RTNREG RSTD;                                   1083
*         TESTRC = RTNREG;                                         1084
         STH   RTNREG,TESTRC(,REG6)                                1084
*         RESPECIFY RTNREG UNRSTD;                                 1085
*                                                                  1085
*         /***********************************************************/
*         /*                                                         */
*         /*    IF RESERVE FAILED, CALL CKERR TO TERMINATE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1086
*         IF TESTRC ^= 0                                           1086
*           THEN                                                   1086
*                                                                  1086
*                                                                  1086
         LH    @04,TESTRC(,REG6)                                   1086
         LTR   @04,@04                                             1086
         BZ    @RF01086                                            1086
*             DO;                                                  1087
*             /*CALL CKERR*/                                       1088
*               RSCKERR = RSCKERR && RSCKERR;                      1088
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1088
*               RSCKERN = RSE007;                                  1089
         MVC   RSCKERN(2,REG6),@CH00036                            1089
*               RSCKTERM = 'TERM';                                 1090
*                                                                  1090
         MVC   RSCKTERM(4,REG6),@CC03543                           1090
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1091
         L     @15,@CV03544                                        1091
         BALR  @14,@15                                             1091
*             END;                                                 1092
*                                                                  1092
*         /***********************************************************/
*         /*                                                         */
*         /*  SET CATALOG RESERVED AUDIT FLAG ON.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1093
*         RSCARES = ON;                                            1093
*                                                                  1093
@RF01086 OI    RSCARES(REG6),B'00000010'                           1093
*         /***********************************************************/
*         /*                                                         */
*         /*  IF CATALOG IN USE BY ANOTHER TASK, CALL CKERR          */
*         /*  TO TERMINATE.                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1094
*         CAXWAPTR = ACBUAPTR;                                     1094
*                                                                  1094
         L     @04,RSCATACB(,REG6)                                 1094
         L     @04,ACBUAPTR(,@04)                                  1094
         ST    @04,CAXWAPTR(,REG6)                                 1094
*         IF CAXACT ^= 1                                           1095
*           THEN                                                   1095
*                                                                  1095
*                                                                  1095
         CLI   CAXACT(@04),1                                       1095
         BE    @RF01095                                            1095
*             DO;                                                  1096
*             /*CALL CKERR*/                                       1097
*               RSCKERR = RSCKERR && RSCKERR;                      1097
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1097
*               RSCKERN = RSE008;                                  1098
         MVC   RSCKERN(2,REG6),@CH00035                            1098
*               RSCKTERM = 'TERM';                                 1099
*                                                                  1099
         MVC   RSCKTERM(4,REG6),@CC03543                           1099
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1100
         L     @15,@CV03544                                        1100
         BALR  @14,@15                                             1100
*             END;                                                 1101
*                                                                  1101
*         /***********************************************************/
*         /*                                                         */
*         /*  VERIFY THE CATALOG VIA DSOPEN                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1102
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN             */
*         CALL IDCRS6DO('V','C');                                  1102
*                                                                  1102
@RF01095 L     @15,@CV03580                                        1102
         LA    @01,@AL01102                                        1102
         BALR  @14,@15                                             1102
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN STORAGE FOR CIXLT TABLE.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1103
*         RSUGLEN = LENGTH(RSXCIXLT);                              1103
*                                                                  1103
         MVC   RSUGLEN(4,REG6),@CF03741                            1103
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSCIXLTA,POOL1,SETZERO);   1104
*                                                                  1104
         ST    REG5,@AL00001                                       1104
         LA    @04,RSUGLEN(,REG6)                                  1104
         ST    @04,@AL00001+4                                      1104
         LA    @04,RSCIXLTA(,REG6)                                 1104
         ST    @04,@AL00001+8                                      1104
         LA    @04,@CC00900                                        1104
         ST    @04,@AL00001+12                                     1104
         LA    @04,SETZERO                                         1104
         ST    @04,@AL00001+16                                     1104
         MVI   @AL00001+16,X'80'                                   1104
         L     @15,GDTGPL(,REG5)                                   1104
         LA    @01,@AL00001                                        1104
         BALR  @14,@15                                             1104
*         RESPECIFY RTNREG RSTD;                                   1105
*         TESTRC = RTNREG;                                         1106
         STH   RTNREG,TESTRC(,REG6)                                1106
*         RESPECIFY RTNREG UNRSTD;                                 1107
*                                                                  1107
*         /***********************************************************/
*         /*                                                         */
*         /*    IF STORAGE NOT AVAILABLE, CALL CKERR TO TERMINATE.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1108
*         IF TESTRC ^= 0                                           1108
*           THEN                                                   1108
*                                                                  1108
*                                                                  1108
         LH    @04,TESTRC(,REG6)                                   1108
         LTR   @04,@04                                             1108
         BZ    @RF01108                                            1108
*             DO;                                                  1109
*             /*CALL CKERR*/                                       1110
*               RSCKERR = RSCKERR && RSCKERR;                      1110
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1110
*               RSCKERN = RSE099;                                  1111
         MVC   RSCKERN(2,REG6),@CH01083                            1111
*               RSCKTERM = 'TERM';                                 1112
*                                                                  1112
         MVC   RSCKTERM(4,REG6),@CC03543                           1112
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1113
         L     @15,@CV03544                                        1113
         BALR  @14,@15                                             1113
*             END;                                                 1114
*                                                                  1114
*          RSXCIID = 'CIXL';             /*CIXLT TABLE ID            */
*                                                                  1115
@RF01108 L     @04,RSCIXLTA(,REG6)                                 1115
         MVC   RSXCIID(4,@04),@CC03587                             1115
*         /***********************************************************/
*         /*                                                         */
*         /*  DEFINE THE WORKFILE.                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1116
*                                                                  1116
*         /***********************************************************/
*         /*                                                         */
*         /*   GET THE CATALOG DATA LKR VGO                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1116
*         RSGRABCU = ADDR(GRABSCA);                                1116
         L     @04,RSIOTBL(,REG6)                                  1116
         LA    @04,GRABSCA(,@04)                                   1116
         ST    @04,RSGRABCU(,REG6)                                 1116
*         GRABCURR = GRABRAB1;                                     1117
         L     @15,GRABRAB1(,@04)                                  1117
         ST    @15,GRABCURR(,@04)                                  1117
*         RABRCDA = LKRDATCI;                                      1118
*                                                                  1118
         MVC   RABRCDA(4,@15),@CF00287                             1118
*         DO;                                                      1119
*           RSRTYPE = ''B;                                         1120
         MVI   RSRTYPE(REG6),X'00'                                 1120
*           RSRGET = ON;      /* GETRCD  */                        1121
         OI    RSRGET(REG6),B'10000000'                            1121
*           RSRUPD = OFF;     /* NO UPDATE  */                     1122
         NI    RSRUPD(REG6),B'11110111'                            1122
*           RSRDS = ''B;                                           1123
         NI    RSRDS(REG6),B'00011111'                             1123
*           RSRCAT = ON;      /* CATALOG  */                       1124
*           RSRDIR = ON;      /* DIRECT  */                        1125
*           RSRKEY = OFF;     /* CNV  */                           1126
*                                                                  1126
         OI    RSRCAT(REG6),B'01000100'                            1126
         NI    RSRKEY(REG6),B'11101111'                            1126
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            1127
         L     @15,@CV03498                                        1127
         BALR  @14,@15                                             1127
*           RFY RTNREG RSTD;                                       1128
*           TESTRC = RTNREG;                                       1129
         STH   RTNREG,TESTRC(,REG6)                                1129
*           RFY RTNREG UNRSTD;                                     1130
*         END;                                                     1131
*                                                                  1131
*         /***********************************************************/
*         /*                                                         */
*         /*   GET THE NUMBER OF RECORDS PER TRACK FOR THE CATALOG   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1132
*         /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU           */
*         CALL CATRCDSU;                                           1132
         L     @15,@CV03499                                        1132
         BALR  @14,@15                                             1132
*         RSCPE6 = RSCPE3;             /*VGO IS FIRST GO             */
         L     @04,RSCPE3(,REG6)                                   1133
         ST    @04,RSCPE6(,REG6)                                   1133
*         RSNOBLKT = NOBLKTRK;                                     1134
*                                                                  1134
         MVC   RSNOBLKT(2,REG6),NOBLKTRK(@04)                      1134
*         /***********************************************************/
*         /*                                                         */
*         /*    GET THE CATALOG DATA RECORD VIA RECMGMT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1135
*         RSGRABCU = ADDR(GRABSCA);                                1135
         L     @04,RSIOTBL(,REG6)                                  1135
         LA    @04,GRABSCA(,@04)                                   1135
         ST    @04,RSGRABCU(,REG6)                                 1135
*         GRABCURR = GRABRAB1;                                     1136
         L     @15,GRABRAB1(,@04)                                  1136
         ST    @15,GRABCURR(,@04)                                  1136
*         RABRCDA = DATACI;                                        1137
*                                                                  1137
*                                                                  1137
         SLR   @04,@04                                             1137
         ST    @04,RABRCDA(,@15)                                   1137
*         DO;                                                      1138
*           RSRTYPE = ''B;                                         1139
         MVI   RSRTYPE(REG6),X'00'                                 1139
*           RSRGET = ON;      /* GETRCD  */                        1140
         OI    RSRGET(REG6),B'10000000'                            1140
*           RSRUPD = OFF;     /* NO UPDATE  */                     1141
         NI    RSRUPD(REG6),B'11110111'                            1141
*           RSRDS = ''B;                                           1142
         NI    RSRDS(REG6),B'00011111'                             1142
*           RSRCAT = ON;      /* CATALOG  */                       1143
*           RSRDIR = ON;      /* DIRECT  */                        1144
*           RSRKEY = OFF;     /* CNV  */                           1145
*                                                                  1145
         OI    RSRCAT(REG6),B'01000100'                            1145
         NI    RSRKEY(REG6),B'11101111'                            1145
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            1146
         L     @15,@CV03498                                        1146
         BALR  @14,@15                                             1146
*           RFY RTNREG RSTD;                                       1147
*           TESTRC = RTNREG;                                       1148
         STH   RTNREG,TESTRC(,REG6)                                1148
*           RFY RTNREG UNRSTD;                                     1149
*         END;                                                     1150
*                                                                  1150
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE THE HIGH ALLOCATED DATA CI                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1151
*         RSCAHALC = CHIA/CILEN;                                   1151
*                                                                  1151
         L     @04,RSGRABCU(,REG6)                                 1151
         LA    @15,8                                               1151
         AL    @15,GRABCURR(,@04)                                  1151
         ICM   @04,15,CHIA(@15)                                    1151
         LR    @14,@04                                             1151
         SRL   @14,9                                               1151
         ST    @14,RSCAHALC(,REG6)                                 1151
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPUTE THE PRIMARY AND SECONDARY ALLOCATION UNITS   */
*         /*    FOR THE WORKFILE.                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1152
*         RSCATSCN = CSEC * RSNOBLKT;                              1152
         SLR   @14,@14                                             1152
         ICM   @14,7,CSEC(@15)                                     1152
         MH    @14,RSNOBLKT(,REG6)                                 1152
         ST    @14,RSCATSCN(,REG6)                                 1152
*         RSWFPRIM = CHIA/CILEN + RSCATSCN;                        1153
         SRL   @04,9                                               1153
         ALR   @04,@14                                             1153
         ST    @04,RSWFPRIM(,REG6)                                 1153
*         RSWFSCND = (MAXCINO * 2 - RSWFPRIM + 125)/126;           1154
*                                                                  1154
         L     @00,MAXCINO                                         1154
         ALR   @00,@00                                             1154
         SLR   @00,@04                                             1154
         AL    @00,@CF03588                                        1154
         SRDA  @00,32                                              1154
         D     @00,@CF03589                                        1154
         ST    @01,RSWFSCND(,REG6)                                 1154
*         /***********************************************************/
*         /*                                                         */
*         /*    DEFINE THE WORKFILE VIA WFDEF.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1155
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE WFDEF              */
*         CALL WFDEF;                                              1155
*                                                                  1155
         L     @15,@CV03590                                        1155
         BALR  @14,@15                                             1155
*         /***********************************************************/
*         /*                                                         */
*         /*  OBTAIN THE ACB ADDRESS OF THE CATALOG IN WHICH THE     */
*         /*  WORKFILE WAS DEFINED VIA UCATLG LOCATE.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1156
*                                                                  1156
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPLETE CPL-FPL FOR UCATLG REQUEST.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1156
*         CTGNAME = ON;                                            1156
*         CTGCNAME = ON;                                           1157
         L     @04,CTGPLPTR(,REG6)                                 1157
         OI    CTGNAME(@04),B'00000110'                            1157
*         CTGENT = RSWFDS;                                         1158
         L     @15,RSWFDS(,REG6)                                   1158
         ST    @15,CTGENT(,@04)                                    1158
*         CTGCAT = 0;                                              1159
*                                                                  1159
         SLR   @15,@15                                             1159
         ST    @15,CTGCAT(,@04)                                    1159
*         CTGFLPTR = CTGFIELD(1);                                  1160
         L     @04,CTGFIELD(,@04)                                  1160
         ST    @04,CTGFLPTR(,REG6)                                 1160
*         CTGFLDNM = ADDR(CATACB);                                 1161
*                                                                  1161
         LA    @15,@CC01094                                        1161
         ST    @15,CTGFLDNM(,@04)                                  1161
*         /***********************************************************/
*         /*                                                         */
*         /*    ISSUE UCATLG                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1162
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         1162
*                                                                  1162
         ST    REG5,@AL00001                                       1162
         LA    @04,CTGPLPTR(,REG6)                                 1162
         ST    @04,@AL00001+4                                      1162
         L     @15,GDTCAT(,REG5)                                   1162
         LA    @01,@AL00001                                        1162
         BALR  @14,@15                                             1162
*         RESPECIFY RTNREG RSTD;                                   1163
*         TESTRC = RTNREG;                                         1164
         STH   RTNREG,TESTRC(,REG6)                                1164
*         RESPECIFY RTNREG UNRSTD;                                 1165
*                                                                  1165
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UCATLG FAILED, CALL CKERR TO TERMINATE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1166
*         IF TESTRC ^= 0                                           1166
*           THEN                                                   1166
         LH    @04,TESTRC(,REG6)                                   1166
         LTR   @04,@04                                             1166
         BZ    @RF01166                                            1166
*             DO;                                                  1167
*               RSCATRC = TESTRC;                                  1168
*                                                                  1168
*                                                                  1168
         STH   @04,RSCATRC(,REG6)                                  1168
*               DO;                                                1169
*               /*CALL CKERR*/                                     1170
*                 RSCKERR = RSCKERR && RSCKERR;                    1170
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1170
*                 RSCKERN = RSE035;                                1171
         MVC   RSCKERN(2,REG6),@CH00853                            1171
*                 RSCKTERM = 'RETU';                               1172
*                                                                  1172
         MVC   RSCKTERM(4,REG6),@CC03585                           1172
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1173
         L     @15,@CV03544                                        1173
         BALR  @14,@15                                             1173
*               END;                                               1174
*                                                                  1174
*                                                                  1174
*               DO;                                                1175
*               /*CALL CKERR*/                                     1176
*                 RSCKERR = RSCKERR && RSCKERR;                    1176
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1176
*                 RSCKERN = RSE017;                                1177
         MVC   RSCKERN(2,REG6),@CH00930                            1177
*                 RSCKTERM = 'TERM';                               1178
*                                                                  1178
         MVC   RSCKTERM(4,REG6),@CC03543                           1178
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */
*               CALL CKERR;                                        1179
         L     @15,@CV03544                                        1179
         BALR  @14,@15                                             1179
*               END;                                               1180
*                                                                  1180
*             END;                                                 1181
*                                                                  1181
*         /***********************************************************/
*         /*                                                         */
*         /*    UCATLG SUCCESSFUL.                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1182
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE WORKFILE CATALOG ACB ADDRESS IN LOCAL           */
*         /*    WORKAREA.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1182
*         RSINWACB = INITWACB;                                     1182
*                                                                  1182
@RF01166 L     @04,CTGFLPTR(,REG6)                                 1182
         L     @04,CTGFLPT(,@04)                                   1182
         L     @04,INITWACB(,@04)                                  1182
         ST    @04,RSINWACB(,REG6)                                 1182
*         /***********************************************************/
*         /*                                                         */
*         /*  IF WORKFILE WAS DEFINED IN THE RESET CATALOG,          */
*         /*  CALL CKERR TO TERMINATE.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1183
*         IF RSINWACB = RSCATACB                                   1183
*           THEN                                                   1183
*                                                                  1183
*                                                                  1183
         C     @04,RSCATACB(,REG6)                                 1183
         BNE   @RF01183                                            1183
*             DO;                                                  1184
*             /*CALL CKERR*/                                       1185
*               RSCKERR = RSCKERR && RSCKERR;                      1185
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1185
*               RSCKERN = RSE013;                                  1186
         MVC   RSCKERN(2,REG6),@CH00633                            1186
*               RSCKTERM = 'TERM';                                 1187
*                                                                  1187
         MVC   RSCKTERM(4,REG6),@CC03543                           1187
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1188
         L     @15,@CV03544                                        1188
         BALR  @14,@15                                             1188
*             END;                                                 1189
*                                                                  1189
*         /***********************************************************/
*         /*                                                         */
*         /*  SET HIGHEST FORMATTED RELATIVE RECORD NUMBER IN        */
*         /*  WORKFILE TO 0.                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1190
*         RSWFHURR = 0;                                            1190
*                                                                  1190
@RF01183 SLR   @04,@04                                             1190
         ST    @04,RSWFHURR(,REG6)                                 1190
*         /***********************************************************/
*         /*                                                         */
*         /*  OPEN THE WORKFILE VIA DSOPEN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1191
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN             */
*         CALL IDCRS6DO('O','W','O',RSWFDD,NULLPTR,RSWFPAS);       1191
*                                                                  1191
         MVC   @AL00001(20),@AL01191                               1191
         LA    @04,RSWFDD(,REG6)                                   1191
         ST    @04,@AL00001+12                                     1191
         LA    @04,RSWFPAS(,REG6)                                  1191
         ST    @04,@AL00001+20                                     1191
         L     @15,@CV03580                                        1191
         LA    @01,@AL00001                                        1191
         BALR  @14,@15                                             1191
*         RESPECIFY RTNREG RSTD;                                   1192
*         TESTRC = RTNREG;                                         1193
         STH   RTNREG,TESTRC(,REG6)                                1193
*         RESPECIFY RTNREG UNRSTD;                                 1194
*                                                                  1194
*         /***********************************************************/
*         /*                                                         */
*         /*    IF OPEN FAILED, CALL CKERR TO TERMINATE.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1195
*         IF TESTRC ^= 0                                           1195
*           THEN                                                   1195
*                                                                  1195
*                                                                  1195
         LH    @04,TESTRC(,REG6)                                   1195
         LTR   @04,@04                                             1195
         BZ    @RF01195                                            1195
*             DO;                                                  1196
*             /*CALL CKERR*/                                       1197
*               RSCKERR = RSCKERR && RSCKERR;                      1197
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1197
*               RSCKERN = RSE015;                                  1198
         MVC   RSCKERN(2,REG6),@CH00229                            1198
*               RSCKTERM = 'TERM';                                 1199
*                                                                  1199
         MVC   RSCKTERM(4,REG6),@CC03543                           1199
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1200
         L     @15,@CV03544                                        1200
         BALR  @14,@15                                             1200
*             END;                                                 1201
*                                                                  1201
*         /***********************************************************/
*         /*                                                         */
*         /*  BUILD RESET VOLSER LIST (RESVOL) FROM FDT INPUT.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1202
*         RSVOLALL = 0;                                            1202
@RF01195 SLR   @04,@04                                             1202
         ST    @04,RSVOLALL(,REG6)                                 1202
*         RSENTPT = ADDR(RSVOLENT);                                1203
         L     @01,RSIOTBL(,REG6)                                  1203
         LA    @15,RSVOLENT(,@01)                                  1203
         ST    @15,RSENTPT(,REG6)                                  1203
*         RSINDDPT = ADDR(RESVLDDN);                               1204
*                                                                  1204
         LA    @15,RESVLDDN(,@15)                                  1204
         ST    @15,RSINDDPT(,REG6)                                 1204
*         /***********************************************************/
*         /*                                                         */
*         /*  CRAVOLS PARAMETER SPECIFIED. BUILD RESVOL ALL ENTRIES. */
*         /*  DYNAMICALLY ALLOCATE EACH CRA VOLUME.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1205
*         IF CVOLCNT ^= 0                                          1205
*           THEN                                                   1205
         L     @15,@PC00001+4                                      1205
         LA    @15,FDTPTR+48(,@15)                                 1205
         C     @04,CVOLCNT(,@15)                                   1205
         BE    @RF01205                                            1205
*INITCV:      DO;                                                  1206
*                                                                  1206
INITCV   DS    0H                                                  1207
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE SYSALLDA DEVTYPE LIST.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1207
*               RSINDVLL = LENGTH(SYSALLDA);                       1207
         MVI   RSINDVLL(REG6),X'08'                                1207
*               RSINDVLV = SYSALLDA;                               1208
*                                                                  1208
         MVC   RSINDVLV(8,REG6),@CC00779                           1208
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS CRAVOL LIST ENTRIES.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1209
*INITLP6:       DO RSIDX = 1 TO CVOLCNT;                           1209
*                                                                  1209
INITLP6  LA    @04,1                                               1209
         B     @DE01209                                            1209
@DL01209 DS    0H                                                  1210
*                 RESVOL = ''B;                                    1210
         L     @04,RSENTPT(,REG6)                                  1210
         XC    RESVOL(92,@04),RESVOL(@04)                          1210
*                 RSINCVPT = CRAVLPTR(RSIDX);                      1211
         LH    @15,RSIDX(,REG6)                                    1211
         SLA   @15,2                                               1211
         L     @14,@PC00001+4                                      1211
         L     @01,FDTPTR+52(,@14)                                 1211
         AL    @01,@CF03777                                        1211
         L     @03,CRAVLPTR(@15,@01)                               1211
         ST    @03,RSINCVPT(,REG6)                                 1211
*                 RSINDVPT = CRADVPTR(RSIDX);                      1212
*                                                                  1212
         L     @01,FDTPTR+56(,@14)                                 1212
         AL    @01,@CF03777                                        1212
         L     @02,CRADVPTR(@15,@01)                               1212
         ST    @02,RSINDVPT(,REG6)                                 1212
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE VOLSER IN RESVOL ENTRY.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1213
*                 RESVLSER = CRAVLVAL(1:CRAVLLEN);                 1213
*                                                                  1213
         MVI   RESVLSER+1(@04),C' '                                1213
         MVC   RESVLSER+2(4,@04),RESVLSER+1(@04)                   1213
         SLR   @02,@02                                             1213
         IC    @02,CRAVLLEN(,@03)                                  1213
         BCTR  @02,0                                               1213
         EX    @02,@SM03810                                        1213
*         /***********************************************************/
*         /*                                                         */
*         /*    SEARCH RESVOL FOR THIS CRA VOLSER VIA SCNRLST. IF    */
*         /*    IT WAS SPECIFIED TWICE, THAN CALL CKERR TO TERMINATE.*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1214
*                 RSCRVL = ADDR(RESVLSER);                         1214
*                                                                  1214
         LA    @04,RESVLSER(,@04)                                  1214
         ST    @04,RSCRVL(,REG6)                                   1214
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST    */
*                 CALL IDCRS5SR('V','B',RSVTBENT,RSCRVL);          1215
*                                                                  1215
         LA    @04,@CC00833                                        1215
         ST    @04,@AL00001                                        1215
         LA    @04,@CC00815                                        1215
         ST    @04,@AL00001+4                                      1215
         LA    @04,RSVTBENT(,REG6)                                 1215
         ST    @04,@AL00001+8                                      1215
         LA    @04,RSCRVL(,REG6)                                   1215
         ST    @04,@AL00001+12                                     1215
         L     @15,@CV03539                                        1215
         LA    @01,@AL00001                                        1215
         BALR  @14,@15                                             1215
*                 RESPECIFY RTNREG RSTD;                           1216
*                 TESTRC = RTNREG;                                 1217
         STH   RTNREG,TESTRC(,REG6)                                1217
*                 RESPECIFY RTNREG UNRSTD;                         1218
*                                                                  1218
*                 IF RSVTBENT ^= 0                                 1219
*                   THEN                                           1219
*                                                                  1219
*                                                                  1219
         L     @04,RSVTBENT(,REG6)                                 1219
         LTR   @04,@04                                             1219
         BZ    @RF01219                                            1219
*                     DO;                                          1220
*                     /*CALL CKERR*/                               1221
*                       RSCKERR = RSCKERR && RSCKERR;              1221
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1221
*                       RSCKERN = RSE040;                          1222
         MVC   RSCKERN(2,REG6),@CH00972                            1222
*                       RSCKTERM = 'TERM';                         1223
         MVC   RSCKTERM(4,REG6),@CC03543                           1223
*                       RSCKMVAR(1) = ADDR(RESVLSER);              1224
*                                                                  1224
         L     @04,RSENTPT(,REG6)                                  1224
         LA    @04,RESVLSER(,@04)                                  1224
         ST    @04,RSCKMVAR(,REG6)                                 1224
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */
*                     CALL CKERR;                                  1225
         L     @15,@CV03544                                        1225
         BALR  @14,@15                                             1225
*                     END;                                         1226
*                                                                  1226
*         /***********************************************************/
*         /*                                                         */
*         /*    IF DEVTYPE SPECIFIED, USE IT FOR ALLOCATION.         */
*         /*    OTHERWISE, USE SYSALLDA FOR DEVTYPE.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1227
*                 IF RSINDVPT = 0                                  1227
*                   THEN                                           1227
@RF01219 L     @04,RSINDVPT(,REG6)                                 1227
         LTR   @04,@04                                             1227
         BNZ   @RF01227                                            1227
*                     RSINDVPT = ADDR(RSINDVL);                    1228
*                                                                  1228
         LA    @04,RSINDVL(,REG6)                                  1228
         ST    @04,RSINDVPT(,REG6)                                 1228
*         /***********************************************************/
*         /*                                                         */
*         /*    DYNAMICALLY ALLOCATE CRA VOLUME VIA CRAMNT.          */
*         /*    DDNAME WILL BE RETURNED IN RESVOL ENTRY.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1229
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE CRAMNT     */
*                 CALL IDCRS6CM(RSINCVPT,RSINDVPT,RSINDDPT);       1229
*                                                                  1229
@RF01227 LA    @04,RSINCVPT(,REG6)                                 1229
         ST    @04,@AL00001                                        1229
         LA    @04,RSINDVPT(,REG6)                                 1229
         ST    @04,@AL00001+4                                      1229
         LA    @04,RSINDDPT(,REG6)                                 1229
         ST    @04,@AL00001+8                                      1229
         L     @15,@CV03595                                        1229
         LA    @01,@AL00001                                        1229
         BALR  @14,@15                                             1229
*                 RESPECIFY RTNREG RSTD;                           1230
*                 TESTRC = RTNREG;                                 1231
         STH   RTNREG,TESTRC(,REG6)                                1231
*                 RESPECIFY RTNREG UNRSTD;                         1232
*                                                                  1232
*         /***********************************************************/
*         /*                                                         */
*         /*    IF DYNAMIC ALLOCATION FAILED, CALL CKERR TO          */
*         /*    TERMINATE.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1233
*                 IF TESTRC ^= 0                                   1233
*                   THEN                                           1233
*                                                                  1233
*                                                                  1233
         LH    @04,TESTRC(,REG6)                                   1233
         LTR   @04,@04                                             1233
         BZ    @RF01233                                            1233
*                     DO;                                          1234
*                     /*CALL CKERR*/                               1235
*                       RSCKERR = RSCKERR && RSCKERR;              1235
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1235
*                       RSCKERN = RSE016;                          1236
         MVC   RSCKERN(2,REG6),@CH00478                            1236
*                       RSCKTERM = 'TERM';                         1237
*                                                                  1237
         MVC   RSCKTERM(4,REG6),@CC03543                           1237
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */
*                     CALL CKERR;                                  1238
         L     @15,@CV03544                                        1238
         BALR  @14,@15                                             1238
*                     END;                                         1239
*                                                                  1239
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CRA VOLUME ALLOCATED FLAG IN RESVOL ENTRY.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1240
*                 RESVLMNT = ON;                                   1240
*                                                                  1240
@RF01233 L     @04,RSENTPT(,REG6)                                  1240
         OI    RESVLMNT(@04),B'10000000'                           1240
*         /***********************************************************/
*         /*                                                         */
*         /*    IF THIS IS THE LAST VOLUME IN THE LIST, SET          */
*         /*    LAST ALL FLAG IN RESVOL ENTRY.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1241
*                 IF RSIDX = CVOLCNT                               1241
*                   THEN                                           1241
         L     @15,@PC00001+4                                      1241
         LA    @15,FDTPTR+48(,@15)                                 1241
         LH    @14,RSIDX(,REG6)                                    1241
         C     @14,CVOLCNT(,@15)                                   1241
         BNE   @RF01241                                            1241
*                     RESVLALE = ON;                               1242
*                                                                  1242
         OI    RESVLALE(@04),B'01000000'                           1242
*         /***********************************************************/
*         /*                                                         */
*         /*    ADD ENTRY TO RESVOL VIA BLDRLST.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1243
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE BLDRLST    */
*                 CALL IDCRS5BR(RSENTPT);                          1243
*                                                                  1243
@RF01241 LA    @04,RSENTPT(,REG6)                                  1243
         ST    @04,@AL00001                                        1243
         L     @15,@CV03596                                        1243
         LA    @01,@AL00001                                        1243
         BALR  @14,@15                                             1243
*               END INITLP6;                                       1244
*                                                                  1244
         LA    @04,1                                               1244
         AH    @04,RSIDX(,REG6)                                    1244
@DE01209 STH   @04,RSIDX(,REG6)                                    1244
         L     @15,@PC00001+4                                      1244
         LA    @15,FDTPTR+48(,@15)                                 1244
         C     @04,CVOLCNT(,@15)                                   1244
         BNH   @DL01209                                            1244
*             END INITCV;                                          1245
*                                                                  1245
*         /***********************************************************/
*         /*                                                         */
*         /*  CRAFILES PARAMETER SPECIFIED. BUILD RESVOL ALL ENTRIES */
*         /*  THEN RESVOL NONE ENTRIES.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1246
*         IF CFILECNT ^= 0                                         1246
*           THEN                                                   1246
@RF01205 L     @04,@PC00001+4                                      1246
         LA    @04,FDTPTR+32(,@04)                                 1246
         L     @04,CFILECNT(,@04)                                  1246
         LTR   @04,@04                                             1246
         BZ    @RF01246                                            1246
*INITCF:      DO;                                                  1247
*                                                                  1247
INITCF   DS    0H                                                  1248
*         /***********************************************************/
*         /*                                                         */
*         /*  SET UP FOR UIOINFO VOLUME REQUESTS.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1248
*               IOINFOPT = ''B;                                    1248
         LA    @04,700                                             1248
         ALR   @04,REG6                                            1248
         MVI   IOINFOPT(@04),X'00'                                 1248
*               IOINFVOL = ON;                                     1249
         OI    IOINFVOL(@04),B'01000000'                           1249
*               RSINSVVL = ''B;                                    1250
*                                                                  1250
         XC    RSINSVVL(6,REG6),RSINSVVL(REG6)                     1250
*         /***********************************************************/
*         /*                                                         */
*         /*    OBTAIN STORAGE FOR UIOINFO RETURN AREA.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1251
*               RSUGLEN = LENGTH(UIOVOL) + UIOHDR;                 1251
*                                                                  1251
         MVC   RSUGLEN(4,REG6),@CF00968                            1251
*               CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSUIRPT,POOL3);      1252
*                                                                  1252
         ST    REG5,@AL00001                                       1252
         LA    @04,RSUGLEN(,REG6)                                  1252
         ST    @04,@AL00001+4                                      1252
         LA    @04,RSUIRPT(,REG6)                                  1252
         ST    @04,@AL00001+8                                      1252
         LA    @04,@CC00904                                        1252
         ST    @04,@AL00001+12                                     1252
         MVI   @AL00001+12,X'80'                                   1252
         L     @15,GDTGPL(,REG5)                                   1252
         LA    @01,@AL00001                                        1252
         BALR  @14,@15                                             1252
*               RESPECIFY RTNREG RSTD;                             1253
*               TESTRC = RTNREG;                                   1254
         STH   RTNREG,TESTRC(,REG6)                                1254
*               RESPECIFY RTNREG UNRSTD;                           1255
*                                                                  1255
*         /***********************************************************/
*         /*                                                         */
*         /*    IF STORAGE NOT AVAILABLE, CALL CKERR TO TERMINATE.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1256
*               IF TESTRC ^= 0                                     1256
*                 THEN                                             1256
*                                                                  1256
*                                                                  1256
         LH    @04,TESTRC(,REG6)                                   1256
         LTR   @04,@04                                             1256
         BZ    @RF01256                                            1256
*                   DO;                                            1257
*                   /*CALL CKERR*/                                 1258
*                     RSCKERR = RSCKERR && RSCKERR;                1258
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1258
*                     RSCKERN = RSE099;                            1259
         MVC   RSCKERN(2,REG6),@CH01083                            1259
*                     RSCKTERM = 'TERM';                           1260
*                                                                  1260
         MVC   RSCKTERM(4,REG6),@CC03543                           1260
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */
*                   CALL CKERR;                                    1261
         L     @15,@CV03544                                        1261
         BALR  @14,@15                                             1261
*                   END;                                           1262
*                                                                  1262
*         /***********************************************************/
*         /*                                                         */
*         /*    SET LENGTH OF RETURN AREA IN RETURN AREA HEADER      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1263
*         UINFTLN = RSUGLEN;                                       1263
*                                                                  1263
@RF01256 L     @04,RSUIRPT(,REG6)                                  1263
         L     @15,RSUGLEN(,REG6)                                  1263
         STH   @15,UINFTLN(,@04)                                   1263
*         /***********************************************************/
*         /*                                                         */
*         /*    SCAN FOR ALL ENTRIES, THEN NONE ENTRIES.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1264
*               RSINALL = ON;                                      1264
*                                                                  1264
         OI    RSINALL(REG6),B'10000000'                           1264
*INITLP7:       DO RSIDX = 1 TO 2;                                 1265
*                                                                  1265
INITLP7  LA    @04,1                                               1265
         STH   @04,RSIDX(,REG6)                                    1265
@DL01265 DS    0H                                                  1266
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS CRAFILES LIST ENTRIES.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1266
*INITLP8:         DO RSIDX1 = 1 TO CFILECNT;                       1266
INITLP8  LA    @04,1                                               1266
         B     @DE01266                                            1266
@DL01266 DS    0H                                                  1267
*                   IF (NONEPTR(RSIDX1) ^= NULLPTR & RSINALL = OFF)
*                      (NONEPTR(RSIDX1) = NULLPTR & RSINALL = ON) 1267
*                     THEN                                         1267
         LH    @04,RSIDX1(,REG6)                                   1267
         SLA   @04,2                                               1267
         L     @15,@PC00001+4                                      1267
         L     @01,FDTPTR+44(,@15)                                 1267
         AL    @01,@CF03777                                        1267
         L     @04,NONEPTR(@04,@01)                                1267
         LTR   @04,@04                                             1267
         BZ    @GL00002                                            1267
         TM    RSINALL(REG6),B'10000000'                           1267
         BZ    @RT01267                                            1267
@GL00002 LH    @04,RSIDX1(,REG6)                                   1267
         SLA   @04,2                                               1267
         L     @15,@PC00001+4                                      1267
         L     @01,FDTPTR+44(,@15)                                 1267
         AL    @01,@CF03777                                        1267
         L     @04,NONEPTR(@04,@01)                                1267
         LTR   @04,@04                                             1267
         BNZ   @RF01267                                            1267
         TM    RSINALL(REG6),B'10000000'                           1267
         BNO   @RF01267                                            1267
@RT01267 DS    0H                                                  1268
*                       DO;                                        1268
*                                                                  1268
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE DDNAME IN RESVOL ENTRY.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1269
*                         RSINDNPT = CRADNPTR(RSIDX1);             1269
         LH    @04,RSIDX1(,REG6)                                   1269
         SLA   @04,2                                               1269
         L     @15,@PC00001+4                                      1269
         L     @01,FDTPTR+36(,@15)                                 1269
         AL    @01,@CF03777                                        1269
         L     @04,CRADNPTR(@04,@01)                               1269
         ST    @04,RSINDNPT(,REG6)                                 1269
*                         RESVOL = ''B;                            1270
         L     @15,RSENTPT(,REG6)                                  1270
         XC    RESVOL(92,@15),RESVOL(@15)                          1270
*                         RESVLDDN = CRADNVAL(1:CRADNLEN);         1271
*                                                                  1271
         MVI   RESVLDDN+1(@15),C' '                                1271
         MVC   RESVLDDN+2(6,@15),RESVLDDN+1(@15)                   1271
         SLR   @14,@14                                             1271
         IC    @14,CRADNLEN(,@04)                                  1271
         BCTR  @14,0                                               1271
         EX    @14,@SM03812                                        1271
*         /***********************************************************/
*         /*                                                         */
*         /*    GET VOLSER VIA UIOINFO.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1272
*                         CALL IDCIOSI0 (GDTTBL,IOINFOPT,RSUIRPT,  1272
*                                  RESVLDDN);                      1272
*                                                                  1272
         ST    REG5,@AL00001                                       1272
         LA    @04,IOINFOPT+700(,REG6)                             1272
         ST    @04,@AL00001+4                                      1272
         LA    @04,RSUIRPT(,REG6)                                  1272
         ST    @04,@AL00001+8                                      1272
         LA    @04,RESVLDDN(,@15)                                  1272
         ST    @04,@AL00001+12                                     1272
         MVI   @AL00001+12,X'80'                                   1272
         L     @15,GDTIFO(,REG5)                                   1272
         LA    @01,@AL00001                                        1272
         BALR  @14,@15                                             1272
*                         RESPECIFY RTNREG RSTD;                   1273
*                         TESTRC = RTNREG;                         1274
         STH   RTNREG,TESTRC(,REG6)                                1274
*                         RESPECIFY RTNREG UNRSTD;                 1275
*                                                                  1275
*         /***********************************************************/
*         /*                                                         */
*         /*    IF UIOINFO FAILED, CALL CKERR TO TERMINATE.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1276
*                         IF TESTRC ^= 0                           1276
*                           THEN                                   1276
*                                                                  1276
*                                                                  1276
         LH    @04,TESTRC(,REG6)                                   1276
         LTR   @04,@04                                             1276
         BZ    @RF01276                                            1276
*                             DO;                                  1277
*                             /*CALL CKERR*/                       1278
*                               RSCKERR = RSCKERR && RSCKERR;      1278
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1278
*                               RSCKERN = RSE002;                  1279
         MVC   RSCKERN(2,REG6),@CH00157                            1279
*                               RSCKTERM = 'TERM';                 1280
*                                                                  1280
         MVC   RSCKTERM(4,REG6),@CC03543                           1280
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE C
*ERR                                                                 */
*                             CALL CKERR;                          1281
         L     @15,@CV03544                                        1281
         BALR  @14,@15                                             1281
*                             END;                                 1282
*                                                                  1282
*         /***********************************************************/
*         /*                                                         */
*         /*    EXTRACT VOLSER AND SAVE IN RESVOL ENTRY.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1283
*                         RSUIRPT = RSUIRPT + UIOHDR;              1283
@RF01276 LA    @04,4                                               1283
         AL    @04,RSUIRPT(,REG6)                                  1283
         ST    @04,RSUIRPT(,REG6)                                  1283
*                         RESVLSER = UIOVLS(1:LENGTH(RESVLSER));   1284
*                                                                  1284
         L     @15,RSENTPT(,REG6)                                  1284
         MVC   RESVLSER(6,@15),UIOVLS(@04)                         1284
*         /***********************************************************/
*         /*                                                         */
*         /*    SEARCH RESVOL FOR THIS CRA VOLSER VIA SCNRLST. IF    */
*         /*    IT WAS SPECIFIED TWICE, THAN CALL CKERR TO TERMINATE.*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1285
*                         RSCRVL = ADDR(RESVLSER);                 1285
*                                                                  1285
         LA    @04,RESVLSER(,@15)                                  1285
         ST    @04,RSCRVL(,REG6)                                   1285
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRL
*T                                                                   */
*                         CALL IDCRS5SR('V','B',RSVTBENT,RSCRVL);  1286
*                                                                  1286
         LA    @04,@CC00833                                        1286
         ST    @04,@AL00001                                        1286
         LA    @04,@CC00815                                        1286
         ST    @04,@AL00001+4                                      1286
         LA    @04,RSVTBENT(,REG6)                                 1286
         ST    @04,@AL00001+8                                      1286
         LA    @04,RSCRVL(,REG6)                                   1286
         ST    @04,@AL00001+12                                     1286
         L     @15,@CV03539                                        1286
         LA    @01,@AL00001                                        1286
         BALR  @14,@15                                             1286
*                         RESPECIFY RTNREG RSTD;                   1287
*                         TESTRC = RTNREG;                         1288
         STH   RTNREG,TESTRC(,REG6)                                1288
*                         RESPECIFY RTNREG UNRSTD;                 1289
*                                                                  1289
*                         IF RSVTBENT ^= 0                         1290
*                           THEN                                   1290
*                                                                  1290
*                                                                  1290
         L     @04,RSVTBENT(,REG6)                                 1290
         LTR   @04,@04                                             1290
         BZ    @RF01290                                            1290
*                             DO;                                  1291
*                             /*CALL CKERR*/                       1292
*                               RSCKERR = RSCKERR && RSCKERR;      1292
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1292
*                               RSCKERN = RSE040;                  1293
         MVC   RSCKERN(2,REG6),@CH00972                            1293
*                               RSCKTERM = 'TERM';                 1294
         MVC   RSCKTERM(4,REG6),@CC03543                           1294
*                               RSCKMVAR(1) = ADDR(RESVLSER);      1295
*                                                                  1295
         L     @04,RSENTPT(,REG6)                                  1295
         LA    @04,RESVLSER(,@04)                                  1295
         ST    @04,RSCKMVAR(,REG6)                                 1295
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE C
*ERR                                                                 */
*                             CALL CKERR;                          1296
         L     @15,@CV03544                                        1296
         BALR  @14,@15                                             1296
*                             END;                                 1297
*                                                                  1297
*         /***********************************************************/
*         /*                                                         */
*         /*    ADD ENTRY TO RESVOL VIA BLDRLST.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1298
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE BLDRL
*T                                                                   */
*                         CALL IDCRS5BR(RSENTPT);                  1298
*                                                                  1298
@RF01290 LA    @04,RSENTPT(,REG6)                                  1298
         ST    @04,@AL00001                                        1298
         L     @15,@CV03596                                        1298
         LA    @01,@AL00001                                        1298
         BALR  @14,@15                                             1298
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE VOLSER IN CASE IT IS LAST ALL                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1299
*                         IF RSINALL = ON                          1299
*                           THEN                                   1299
         TM    RSINALL(REG6),B'10000000'                           1299
         BNO   @RF01299                                            1299
*                             RSINSVVL = RESVLSER;                 1300
*                                                                  1300
         L     @04,RSENTPT(,REG6)                                  1300
         MVC   RSINSVVL(6,REG6),RESVLSER(@04)                      1300
*         /***********************************************************/
*         /*                                                         */
*         /*    POINT TO BEGINNING OF UIOINFO WORKAREA               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1301
*                         RSUIRPT = RSUIRPT - UIOHDR;              1301
*                                                                  1301
@RF01299 L     @04,RSUIRPT(,REG6)                                  1301
         SL    @04,@CF00046                                        1301
         ST    @04,RSUIRPT(,REG6)                                  1301
*                       END;                                       1302
*                                                                  1302
*                     END INITLP8;                                 1303
*                                                                  1303
@RF01267 LA    @04,1                                               1303
         AH    @04,RSIDX1(,REG6)                                   1303
@DE01266 STH   @04,RSIDX1(,REG6)                                   1303
         L     @15,@PC00001+4                                      1303
         LA    @15,FDTPTR+32(,@15)                                 1303
         C     @04,CFILECNT(,@15)                                  1303
         BNH   @DL01266                                            1303
*         /***********************************************************/
*         /*                                                         */
*         /*    ALL SCAN DONE. SET LAST ALL INDICATOR AND            */
*         /*    PREPARE FOR NONE SCAN.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1304
*                     IF RSINALL = ON                              1304
*                       THEN                                       1304
         TM    RSINALL(REG6),B'10000000'                           1304
         BNO   @RF01304                                            1304
*                         DO;                                      1305
*                           RSINALL = OFF;                         1306
*                                                                  1306
         NI    RSINALL(REG6),B'01111111'                           1306
*         /***********************************************************/
*         /*                                                         */
*         /*    FIND LAST ALL VOLSER ENTRY VIA SCNRLST.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1307
*                           RSCRVL = ADDR(RSINSVVL);               1307
*                                                                  1307
         LA    @04,RSINSVVL(,REG6)                                 1307
         ST    @04,RSCRVL(,REG6)                                   1307
*                           /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCN
*LST                                                                 */
*                           CALL IDCRS5SR('V','B',RSVTBENT,RSCRVL);
*                                                                  1308
         LA    @04,@CC00833                                        1308
         ST    @04,@AL00001                                        1308
         LA    @04,@CC00815                                        1308
         ST    @04,@AL00001+4                                      1308
         LA    @04,RSVTBENT(,REG6)                                 1308
         ST    @04,@AL00001+8                                      1308
         LA    @04,RSCRVL(,REG6)                                   1308
         ST    @04,@AL00001+12                                     1308
         L     @15,@CV03539                                        1308
         LA    @01,@AL00001                                        1308
         BALR  @14,@15                                             1308
*         /***********************************************************/
*         /*                                                         */
*         /*    IF NONE OF THE CRA FILES WAS SPECIFIED FOR           */
*         /*    RESET (ALL), THEN CALL CKERR TO TERMINATE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1309
*                           IF RSVTBENT = 0                        1309
*                             THEN                                 1309
*                                                                  1309
*                                                                  1309
         L     @04,RSVTBENT(,REG6)                                 1309
         LTR   @04,@04                                             1309
         BNZ   @RF01309                                            1309
*                               DO;                                1310
*                               /*CALL CKERR*/                     1311
*                                 RSCKERR = RSCKERR && RSCKERR;    1311
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1311
*                                 RSCKERN = RSE024;                1312
         MVC   RSCKERN(2,REG6),@CH00309                            1312
*                                 RSCKTERM = 'TERM';               1313
*                                                                  1313
         MVC   RSCKTERM(4,REG6),@CC03543                           1313
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*CKERR                                                               */
*                               CALL CKERR;                        1314
         L     @15,@CV03544                                        1314
         BALR  @14,@15                                             1314
*                               END;                               1315
*                                                                  1315
*                           RSVTBENT -> RESVLALE = ON;             1316
*                                                                  1316
@RF01309 L     @04,RSVTBENT(,REG6)                                 1316
         OI    RESVLALE(@04),B'01000000'                           1316
*                         END;                                     1317
*                                                                  1317
*               END INITLP7;                                       1318
*                                                                  1318
@RF01304 LA    @04,1                                               1318
         AH    @04,RSIDX(,REG6)                                    1318
         STH   @04,RSIDX(,REG6)                                    1318
         C     @04,@CF00157                                        1318
         BNH   @DL01265                                            1318
*         /***********************************************************/
*         /*                                                         */
*         /*    FREE STORAGE OBTAINED FOR UIOINFO.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1319
*               CALL IDCSAFP0 (GDTTBL,POOL3);                      1319
*                                                                  1319
         ST    REG5,@AL00001                                       1319
         LA    @04,@CC00904                                        1319
         ST    @04,@AL00001+4                                      1319
         MVI   @AL00001+4,X'80'                                    1319
         L     @15,GDTFPL(,REG5)                                   1319
         LA    @01,@AL00001                                        1319
         BALR  @14,@15                                             1319
*             END INITCF;                                          1320
*                                                                  1320
*         /***********************************************************/
*         /*                                                         */
*         /*  IF THE CRA FOR THE RESET CATALOG VOLUME WAS SPECIFIED  */
*         /*  AS ONE OF THE RESET CRAS, REORDER IT AS FIRST ENTRY    */
*         /*  IN RESVOL. IF IT IS ALREADY FIRST, NO REORDERING IS    */
*         /*  NECESSARY.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1321
*         RSENTPT = RSVOLALL;                                      1321
@RF01246 L     @04,RSVOLALL(,REG6)                                 1321
         ST    @04,RSENTPT(,REG6)                                  1321
*         IF RESVLSER ^= RSINVLSR                                  1322
*           THEN                                                   1322
         CLC   RESVLSER(6,@04),RSINVLSR(REG6)                      1322
         BE    @RF01322                                            1322
*             DO;                                                  1323
*                                                                  1323
*         /***********************************************************/
*         /*                                                         */
*         /*    SCAN RESVOL FOR CATALOG VOLSER ENTRY VIA SCNRLST.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1324
*               RSCRVL = ADDR(RSINVLSR);                           1324
*                                                                  1324
         LA    @04,RSINVLSR(,REG6)                                 1324
         ST    @04,RSCRVL(,REG6)                                   1324
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST      */
*               CALL IDCRS5SR('V','A',RSENTPT,RSCRVL);             1325
*                                                                  1325
         LA    @04,@CC00833                                        1325
         ST    @04,@AL00001                                        1325
         LA    @04,@CC00813                                        1325
         ST    @04,@AL00001+4                                      1325
         LA    @04,RSENTPT(,REG6)                                  1325
         ST    @04,@AL00001+8                                      1325
         LA    @04,RSCRVL(,REG6)                                   1325
         ST    @04,@AL00001+12                                     1325
         L     @15,@CV03539                                        1325
         LA    @01,@AL00001                                        1325
         BALR  @14,@15                                             1325
*         /***********************************************************/
*         /*                                                         */
*         /*    IF ENTRY FOUND, REORDER IT AS FIRST ENTRY.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1326
*               IF RSENTPT ^= 0                                    1326
*                 THEN                                             1326
         L     @04,RSENTPT(,REG6)                                  1326
         LTR   @04,@04                                             1326
         BZ    @RF01326                                            1326
*                   DO;                                            1327
*                     RSSVENT(5:LENGTH(RESVOL)) =                  1328
*                         RSVOLALL -> RESVOL(5:LENGTH(RESVOL));    1328
         L     @15,RSVOLALL(,REG6)                                 1328
         MVC   RSSVENT+4(88,REG6),RESVOL+4(@15)                    1328
*                     RSVOLALL -> RESVOL(5:LENGTH(RESVOL)) =       1329
*                         RESVOL(5:LENGTH(RESVOL));                1329
         MVC   RESVOL+4(88,@15),RESVOL+4(@04)                      1329
*                     RESVOL(5:LENGTH(RESVOL)) =                   1330
*                         RSSVENT(5:LENGTH(RESVOL));               1330
*                                                                  1330
         MVC   RESVOL+4(88,@04),RSSVENT+4(REG6)                    1330
*         /***********************************************************/
*         /*                                                         */
*         /*    TRANSFER LAST ENTRY AND LAST ALL ENTRY FLAGS         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1331
*                     IF RSVOLALL -> RESVLLAS = ON                 1331
*                       THEN                                       1331
         TM    RESVLLAS(@15),B'00100000'                           1331
         BNO   @RF01331                                            1331
*                         DO;                                      1332
*                           RSVOLALL -> RESVLLAS = OFF;            1333
         NI    RESVLLAS(@15),B'11011111'                           1333
*                           RESVLLAS = ON;                         1334
         OI    RESVLLAS(@04),B'00100000'                           1334
*                         END;                                     1335
*                                                                  1335
*                     IF RSVOLALL -> RESVLALE = ON                 1336
*                       THEN                                       1336
@RF01331 L     @04,RSVOLALL(,REG6)                                 1336
         TM    RESVLALE(@04),B'01000000'                           1336
         BNO   @RF01336                                            1336
*                         DO;                                      1337
*                           RSVOLALL -> RESVLALE = OFF;            1338
         NI    RESVLALE(@04),B'10111111'                           1338
*                           RESVLALE = ON;                         1339
         L     @04,RSENTPT(,REG6)                                  1339
         OI    RESVLALE(@04),B'01000000'                           1339
*                         END;                                     1340
*                                                                  1340
*                   END;                                           1341
*                                                                  1341
@RF01336 DS    0H                                                  1342
*             END;                                                 1342
*                                                                  1342
@RF01326 DS    0H                                                  1343
*         /***********************************************************/
*         /*                                                         */
*         /*  BUILD CIXLT TABLE VIA CATINIT.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1343
*         CALL CATINIT;                                            1343
*                                                                  1343
@RF01322 BAL   @14,CATINIT                                         1343
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1344
*                                                                  1344
*                                                                  1344
*         IF GDTDBG = NULLPTR                                      1344
*           THEN;                                                  1344
         L     @04,GDTDBG(,REG5)                                   1344
         LTR   @04,@04                                             1344
         BZ    @RT01344                                            1344
*           ELSE                                                   1346
*             CALL IDCDB010 (GDTTBL,'RSI1');                       1346
*                                                                  1346
         ST    REG5,@AL00001                                       1346
         LA    @04,@CC03603                                        1346
         ST    @04,@AL00001+4                                      1346
         MVI   @AL00001+4,X'80'                                    1346
         L     @15,GDTDBG(,REG5)                                   1346
         LA    @01,@AL00001                                        1346
         BALR  @14,@15                                             1346
* CALL EXIT;  /*TERMINATE*/                                        1347
@RT01344 BAL   @14,EXIT                                            1347
* END INIT; /*END OF PROCEDURE*/                                   1348
@EL00006 DS    0H                                                  1348
@EF00006 DS    0H                                                  1348
@ER00006 BR    @14                                                 1348
@PB00006 DS    0H                                                  1349
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - MERGECRA                                        */
*/*                                                                  */
*/* FUNCTION - MERGE EACH RESET CRA INTO THE WORKFILE.               */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1349
         DS    0F
NAME0126 DC    CL8'MERGECRA'
*MERGECRA: PROCEDURE                                               1350
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1350
*                                                                  1350
         B     @PB00007                                            1350
MERGECRA DS    0H                                                  1351
*      GENERATE REFS(RS01RG08, REG6);                              1351
*                                                                  1351
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0126  PROCNAME TO REGSAVE
*         RFY RESVOL BASED(RSENTPT);                               1352
*                                                                  1352
*         OLDERID2 = NEWERID2;                                     1353
         L     @04,GDTTR2(,REG5)                                   1353
         MVC   @TS00001(95),NEWERID2(@04)                          1353
         MVC   OLDERID2(95,@04),@TS00001                           1353
*         NEWID2 = 'RSME';                                         1354
*                                                                  1354
         MVC   NEWID2(4,@04),@CC03608                              1354
*         /***********************************************************/
*         /*                                                         */
*         /*  OPEN THE WORKFILE VIA DSOPEN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1355
*         IF RSWFOPN = OFF                                         1355
*           THEN                                                   1355
         TM    RSWFOPN(REG6),B'01000000'                           1355
         BNZ   @RF01355                                            1355
*             DO;                                                  1356
*                                                                  1356
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN       */
*               CALL IDCRS6DO('O','W','U',RSWFDD,NULLPTR,RSWFPAS); 1357
*                                                                  1357
         MVC   @AL00001(20),@AL01357                               1357
         LA    @04,RSWFDD(,REG6)                                   1357
         ST    @04,@AL00001+12                                     1357
         LA    @04,RSWFPAS(,REG6)                                  1357
         ST    @04,@AL00001+20                                     1357
         L     @15,@CV03580                                        1357
         LA    @01,@AL00001                                        1357
         BALR  @14,@15                                             1357
*               RESPECIFY RTNREG RSTD;                             1358
*               TESTRC = RTNREG;                                   1359
         STH   RTNREG,TESTRC(,REG6)                                1359
*               RESPECIFY RTNREG UNRSTD;                           1360
*                                                                  1360
*                                                                  1360
*         /***********************************************************/
*         /*                                                         */
*         /*    IF OPEN FAILED, CALL CKERR TO TERMINATE.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1361
*               IF TESTRC ^= 0                                     1361
*                 THEN                                             1361
*                                                                  1361
*                                                                  1361
         LH    @04,TESTRC(,REG6)                                   1361
         LTR   @04,@04                                             1361
         BZ    @RF01361                                            1361
*                   DO;                                            1362
*                   /*CALL CKERR*/                                 1363
*                     RSCKERR = RSCKERR && RSCKERR;                1363
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1363
*                     RSCKERN = RSE015;                            1364
         MVC   RSCKERN(2,REG6),@CH00229                            1364
*                     RSCKTERM = 'TERM';                           1365
*                                                                  1365
         MVC   RSCKTERM(4,REG6),@CC03543                           1365
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */
*                   CALL CKERR;                                    1366
         L     @15,@CV03544                                        1366
         BALR  @14,@15                                             1366
*                   END;                                           1367
*                                                                  1367
*             END;                                                 1368
*                                                                  1368
@RF01361 DS    0H                                                  1369
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE REASSIGN COUNT AND TERMINATE AT END FLAG.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1369
*         RSREASSN = 0;                                            1369
@RF01355 SLR   @04,@04                                             1369
         ST    @04,RSREASSN(,REG6)                                 1369
*         RSMETRM  = OFF;                                          1370
*                                                                  1370
         NI    RSMETRM(REG6),B'10111111'                           1370
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS RESET CRAS VIA ALL PORTION OF RESVOL.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1371
*         RSENTPT = ADDR(RSVOLENT);                                1371
*                                                                  1371
         L     @04,RSIOTBL(,REG6)                                  1371
         LA    @04,RSVOLENT(,@04)                                  1371
         ST    @04,RSENTPT(,REG6)                                  1371
*MERGLP1: DO UNTIL (RSENTPT = 0);                                  1372
*                                                                  1372
MERGLP1  DS    0H                                                  1372
@DL01372 DS    0H                                                  1373
*         /***********************************************************/
*         /*                                                         */
*         /*    CALL SCNRLST TO RETURN NEXT RESVOL ALL ENTRY.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1373
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST          */
*           CALL IDCRS5SR('N','A',RSENTPT,NULLPTR);                1373
*                                                                  1373
         MVC   @AL00001(16),@AL01373                               1373
         LA    @04,RSENTPT(,REG6)                                  1373
         ST    @04,@AL00001+8                                      1373
         L     @15,@CV03539                                        1373
         LA    @01,@AL00001                                        1373
         BALR  @14,@15                                             1373
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS THIS CRA.                                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1374
*           IF RSENTPT ^= 0                                        1374
*             THEN                                                 1374
         L     @04,RSENTPT(,REG6)                                  1374
         LTR   @04,@04                                             1374
         BZ    @RF01374                                            1374
*MERGIT:        DO;                                                1375
*                                                                  1375
MERGIT   DS    0H                                                  1376
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE OPEN AND BYPASS FLAGS.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1376
*                 RSMEOP = OFF;                                    1376
*                 RSMEBYV = OFF;                                   1377
*                                                                  1377
         NI    RSMEOP(REG6),B'11001111'                            1377
*         /***********************************************************/
*         /*                                                         */
*         /*    OPEN AND VERIFY THE CRA VIA DSOPEN.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1378
*                 RSCRADD = ADDR(RESVLDDN);                        1378
*                                                                  1378
         L     @04,RSENTPT(,REG6)                                  1378
         LA    @04,RESVLDDN(,@04)                                  1378
         ST    @04,RSCRADD(,REG6)                                  1378
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN     */
*                 CALL IDCRS6DO('B','R','U',RSCRADD,NULLPTR,RSMRPAS);
*                                                                  1379
         MVC   @AL00001(20),@AL01379                               1379
         LA    @04,RSCRADD(,REG6)                                  1379
         ST    @04,@AL00001+12                                     1379
         LA    @04,RSMRPAS(,REG6)                                  1379
         ST    @04,@AL00001+20                                     1379
         L     @15,@CV03580                                        1379
         LA    @01,@AL00001                                        1379
         BALR  @14,@15                                             1379
*                 RESPECIFY RTNREG RSTD;                           1380
*                 TESTRC = RTNREG;                                 1381
         STH   RTNREG,TESTRC(,REG6)                                1381
*                 RESPECIFY RTNREG UNRSTD;                         1382
*                                                                  1382
*         /***********************************************************/
*         /*                                                         */
*         /*    IF OPEN FAILED, SET TERMINATE AT END FLAG            */
*         /*    AND BYPASS VOLCHK FLAG, AND DO NOT MERGE THIS CRA.   */
*         /*    IF OPEN SUCCESSFUL, SET CRA OPEN FLAG.               */
*         /*    IGNORE VERIFY FAILURE.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1383
*                 IF TESTRC = RCUERR1                              1383
*                   THEN                                           1383
         LH    @04,TESTRC(,REG6)                                   1383
         C     @04,@CF00046                                        1383
         BNE   @RF01383                                            1383
*                     DO;                                          1384
*                       RSMETRM = ON;                              1385
*                       RSMEBYV = ON;                              1386
         OI    RSMETRM(REG6),B'01010000'                           1386
*                     END;                                         1387
*                                                                  1387
*         /***********************************************************/
*         /*                                                         */
*         /*    OPEN OF CRA WAS SUCCESSFUL.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1388
*                   ELSE                                           1388
*MERGCOP:             DO;                                          1388
*                                                                  1388
         B     @RC01383                                            1388
@RF01383 DS    0H                                                  1388
MERGCOP  DS    0H                                                  1389
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CRA OPENED FLAG.                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1389
*                       RSMEOP = ON;                               1389
*                                                                  1389
         OI    RSMEOP(REG6),B'00100000'                            1389
*         /***********************************************************/
*         /*                                                         */
*         /*    READ THE CRA CLUSTER RECORD VIA RECMGMT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1390
*                       RSGRABCU = ADDR(GRABSCR);                  1390
         L     @04,RSIOTBL(,REG6)                                  1390
         LA    @04,GRABSCR(,@04)                                   1390
         ST    @04,RSGRABCU(,REG6)                                 1390
*                       GRABCURR = GRABRAB1;                       1391
         L     @15,GRABRAB1(,@04)                                  1391
         ST    @15,GRABCURR(,@04)                                  1391
*                       GRABAFLS = ''B;                            1392
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1392
*                       GRABSIOT = ON;                             1393
         OI    GRABSIOT(@04),B'00000100'                           1393
*                       RABRCDA = CLUSCI;                          1394
*                                                                  1394
*                                                                  1394
         MVC   RABRCDA(4,@15),@CF00157                             1394
*                       DO;                                        1395
*                         RSRTYPE = ''B;                           1396
         MVI   RSRTYPE(REG6),X'00'                                 1396
*                         RSRGET = ON;      /* GETRCD  */          1397
         OI    RSRGET(REG6),B'10000000'                            1397
*                         RSRUPD = OFF;     /* NO UPDATE  */       1398
         NI    RSRUPD(REG6),B'11110111'                            1398
*                         RSRDS = ''B;                             1399
         NI    RSRDS(REG6),B'00011111'                             1399
*                         RSRCRA = ON;      /* CRA  */             1400
*                         RSRDIR = ON;      /* DIRECT  */          1401
*                         RSRKEY = OFF;     /* CNV  */             1402
*                                                                  1402
         OI    RSRCRA(REG6),B'00100100'                            1402
         NI    RSRKEY(REG6),B'11101111'                            1402
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                       CALL RECMGMT;                              1403
         L     @15,@CV03498                                        1403
         BALR  @14,@15                                             1403
*                         RFY RTNREG RSTD;                         1404
*                         TESTRC = RTNREG;                         1405
         STH   RTNREG,TESTRC(,REG6)                                1405
*                         RFY RTNREG UNRSTD;                       1406
*                       END;                                       1407
*                                                                  1407
*         /***********************************************************/
*         /*                                                         */
*         /*    IF THE ENTRY NAME IN THE CLUSTER RECORD DOES NOT     */
*         /*    MATCH THE RESET CATALOG NAME, THEN CALL CKERR TO     */
*         /*    PRINT A MESSAGE. SET TERMINATE AT END FLAG AND       */
*         /*    BYPASS VOLCHK FLAG, AND DO NOT MERGE THIS CRA.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1408
*                       IF CNAME ^= RSCATDSN                       1408
*                         THEN                                     1408
         L     @04,RSGRABCU(,REG6)                                 1408
         L     @04,GRABCURR(,@04)                                  1408
         CLC   CNAME+8(44,@04),RSCATDSN(REG6)                      1408
         BE    @RF01408                                            1408
*                           DO;                                    1409
*                                                                  1409
*                                                                  1409
*                             DO;                                  1410
*                             /*CALL CKERR*/                       1411
*                               RSCKERR = RSCKERR && RSCKERR;      1411
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1411
*                               RSCKERN = RSE078;                  1412
         MVC   RSCKERN(2,REG6),@CH01044                            1412
*                               RSCKTERM = 'RETU';                 1413
         MVC   RSCKTERM(4,REG6),@CC03585                           1413
*                               RSCKMVAR(1) = ADDR(RESVLSER);      1414
*                                                                  1414
         L     @04,RSENTPT(,REG6)                                  1414
         LA    @04,RESVLSER(,@04)                                  1414
         ST    @04,RSCKMVAR(,REG6)                                 1414
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE C
*ERR                                                                 */
*                             CALL CKERR;                          1415
         L     @15,@CV03544                                        1415
         BALR  @14,@15                                             1415
*                             END;                                 1416
*                                                                  1416
*                             RSMETRM = ON;                        1417
*                             RSMEBYV = ON;                        1418
         OI    RSMETRM(REG6),B'01010000'                           1418
*                           END;                                   1419
*                                                                  1419
*         /***********************************************************/
*         /*                                                         */
*         /*  MERGE CRA RECORDS TO WORKFILE VIA PROCCRA.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1420
*                         ELSE                                     1420
*                                                                  1420
*                           CALL PROCCRA;                          1420
*                                                                  1420
         B     @RC01408                                            1420
@RF01408 BAL   @14,PROCCRA                                         1420
*                     END MERGCOP;                                 1421
*                                                                  1421
@RC01408 DS    0H                                                  1422
*         /***********************************************************/
*         /*                                                         */
*         /*  CLOSE THE CRA VIA DSCLOSE.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1422
*               IF RSMEOP = ON                                     1422
*                 THEN                                             1422
@RC01383 TM    RSMEOP(REG6),B'00100000'                            1422
         BNO   @RF01422                                            1422
*MERGCCL:           DO;                                            1423
MERGCCL  DS    0H                                                  1424
*                     RSMEOP = OFF;                                1424
*                                                                  1424
         NI    RSMEOP(REG6),B'11011111'                            1424
*                     /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE*/
*                     CALL IDCRS6DC('R');                          1425
*                                                                  1425
         L     @15,@CV03542                                        1425
         LA    @01,@AL01425                                        1425
         BALR  @14,@15                                             1425
*                     RESPECIFY RTNREG RSTD;                       1426
*                     TESTRC = RTNREG;                             1427
         STH   RTNREG,TESTRC(,REG6)                                1427
*                     RESPECIFY RTNREG UNRSTD;                     1428
*                                                                  1428
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CLOSE FAILED, SET TERMINATE AT END FLAG AND       */
*         /*    BYPASS VOLCHK FLAG.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1429
*                     IF TESTRC ^= 0                               1429
*                       THEN                                       1429
         LH    @04,TESTRC(,REG6)                                   1429
         LTR   @04,@04                                             1429
         BZ    @RF01429                                            1429
*                         DO;                                      1430
*                           RSMETRM = ON;                          1431
*                           RSMEBYV = ON;                          1432
         OI    RSMETRM(REG6),B'01010000'                           1432
*                         END;                                     1433
*                                                                  1433
*                   END MERGCCL;                                   1434
*                                                                  1434
@RF01429 DS    0H                                                  1435
*         /***********************************************************/
*         /*                                                         */
*         /*  IF CRA WAS PROCESSED SUCCESSFULLY, PERFORM VOLUME      */
*         /*  CONSISTENCY CHECK VIA VOLCHK.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1435
*               IF RSMEBYV = OFF                                   1435
*                 THEN                                             1435
*                                                                  1435
@RF01422 TM    RSMEBYV(REG6),B'00010000'                           1435
         BNZ   @RF01435                                            1435
*                   /* CALL TO MODULE IDCRS03 FOR PROCEDURE VOLCHK   */
*                   CALL VOLCHK;                                   1436
*                                                                  1436
         L     @15,@CV03619                                        1436
         BALR  @14,@15                                             1436
*                 ELSE                                             1437
*                   RSMEBYV = OFF;                                 1437
*                                                                  1437
         B     @RC01435                                            1437
@RF01435 NI    RSMEBYV(REG6),B'11101111'                           1437
*               END MERGIT;                                        1438
*                                                                  1438
@RC01435 DS    0H                                                  1439
*         END MERGLP1;                                             1439
*                                                                  1439
@RF01374 DS    0H                                                  1439
@DE01372 L     @04,RSENTPT(,REG6)                                  1439
         LTR   @04,@04                                             1439
         BNZ   @DL01372                                            1439
*         /***********************************************************/
*         /*                                                         */
*         /*  ALL RESET CRAS HAVE BEEN PROCESSED.                    */
*         /*  IF TERMINATE AT END FLAG WAS SET DUE TO AN ERROR IN    */
*         /*  PROCESSING ONE OR MORE CRAS, THEN CALL CKERR TO        */
*         /*  TERMINATE.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1440
*         IF RSMETRM = ON                                          1440
*           THEN                                                   1440
*                                                                  1440
*                                                                  1440
         TM    RSMETRM(REG6),B'01000000'                           1440
         BNO   @RF01440                                            1440
*             DO;                                                  1441
*             /*CALL CKERR*/                                       1442
*               RSCKERR = RSCKERR && RSCKERR;                      1442
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1442
*               RSCKERN = RSE076;                                  1443
         MVC   RSCKERN(2,REG6),@CH01040                            1443
*               RSCKTERM = 'TERM';                                 1444
*                                                                  1444
         MVC   RSCKTERM(4,REG6),@CC03543                           1444
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1445
         L     @15,@CV03544                                        1445
         BALR  @14,@15                                             1445
*             END;                                                 1446
*                                                                  1446
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1447
*                                                                  1447
*                                                                  1447
*         IF GDTDBG = NULLPTR                                      1447
*           THEN;                                                  1447
@RF01440 L     @04,GDTDBG(,REG5)                                   1447
         LTR   @04,@04                                             1447
         BZ    @RT01447                                            1447
*           ELSE                                                   1449
*             CALL IDCDB010 (GDTTBL,'RSM1');                       1449
*                                                                  1449
         ST    REG5,@AL00001                                       1449
         LA    @04,@CC03620                                        1449
         ST    @04,@AL00001+4                                      1449
         MVI   @AL00001+4,X'80'                                    1449
         L     @15,GDTDBG(,REG5)                                   1449
         LA    @01,@AL00001                                        1449
         BALR  @14,@15                                             1449
* CALL EXIT;  /*TERMINATE*/                                        1450
@RT01447 BAL   @14,EXIT                                            1450
* END MERGECRA; /*END OF PROCEDURE*/                               1451
@EL00007 DS    0H                                                  1451
@EF00007 DS    0H                                                  1451
@ER00007 BR    @14                                                 1451
@PB00007 DS    0H                                                  1452
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - PROCCRA                                         */
*/*                                                                  */
*/* FUNCTION - MERGE THE RECORDS OF A RESET CRA INTO THE WORKFILE.   */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   VOLSERTB IS UPDATED.                                  */
*/*            AVAILABLE COUNT IS UPDATED.                           */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1452
         DS    0F
NAME0143 DC    CL8'PROCCRA'
*PROCCRA: PROCEDURE                                                1453
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1453
*                                                                  1453
         B     @PB00008                                            1453
PROCCRA  DS    0H                                                  1454
*      GENERATE REFS(RS01RG08, REG6);                              1454
*                                                                  1454
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0143  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  EXTENTS RETURNED BY FINDALL                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1455
*         DCL FNDEXTS CHAR(*) BASED(RSFATTNN);                     1455
*                                                                  1455
*         RFY RESVOL BASED(RSENTPT);                               1456
*         RFY CCR BASED(RSCRBP1);                                  1457
*         RFY VOLSERTB BASED(RSVTBENT);                            1458
*                                                                  1458
*         OLDERID2 = NEWERID2;                                     1459
         L     @04,GDTTR2(,REG5)                                   1459
         MVC   @TS00001(95),NEWERID2(@04)                          1459
         MVC   OLDERID2(95,@04),@TS00001                           1459
*         NEWID2 = 'RSPR';                                         1460
*                                                                  1460
         MVC   NEWID2(4,@04),@CC03628                              1460
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZATION. SET RAB AND BUFFER POINTERS FOR        */
*         /*  WORKFILE AND CATALOG RECOVERY AREA.                    */
*         /*  SET CATALOG GRAB FLAG TO TERMINATE ON I/O ERROR.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1461
*         RSGRABCU = ADDR(GRABSWF);                                1461
         L     @04,RSIOTBL(,REG6)                                  1461
         ST    @04,RSGRABCU(,REG6)                                 1461
*         GRABCURR = GRABRAB1;                                     1462
         L     @15,GRABRAB1(,@04)                                  1462
         ST    @15,GRABCURR(,@04)                                  1462
*         GRABAFLS = ''B;                                          1463
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1463
*         GRABSIOT = ON;                                           1464
         OI    GRABSIOT(@04),B'00000100'                           1464
*         RSWFBP1 = ADDR(RABBUF);                                  1465
*                                                                  1465
         LA    @15,RABBUF(,@15)                                    1465
         ST    @15,RSWFBP1(,REG6)                                  1465
*         GRABCURR = GRABRAB2;                                     1466
         L     @15,GRABRAB2(,@04)                                  1466
         ST    @15,GRABCURR(,@04)                                  1466
*         RSWFBP2 = ADDR(RABBUF);                                  1467
*                                                                  1467
         LA    @15,RABBUF(,@15)                                    1467
         ST    @15,RSWFBP2(,REG6)                                  1467
*         RSGRABCU = ADDR(GRABSCR);                                1468
         LA    @04,GRABSCR(,@04)                                   1468
         ST    @04,RSGRABCU(,REG6)                                 1468
*         GRABCURR = GRABRAB1;                                     1469
         L     @15,GRABRAB1(,@04)                                  1469
         ST    @15,GRABCURR(,@04)                                  1469
*         RSCRBP1 = ADDR(RABBUF);                                  1470
*                                                                  1470
         LA    @04,RABBUF(,@15)                                    1470
         ST    @04,RSCRBP1(,REG6)                                  1470
*         /***********************************************************/
*         /*                                                         */
*         /*  EXTRACT LAST CONTROL INTERVAL IN THE CRA FROM THE      */
*         /*  CCR RECORD.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1471
*         /***********************************************************/
*         /*                                                         */
*         /*    READ CCR RECORD VIA RECMGMT.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1471
*         RABRCDA = CCRCI;                                         1471
*                                                                  1471
*                                                                  1471
         MVC   RABRCDA(4,@15),@CF00166                             1471
*         DO;                                                      1472
*           RSRTYPE = ''B;                                         1473
         MVI   RSRTYPE(REG6),X'00'                                 1473
*           RSRGET = ON;      /* GETRCD  */                        1474
         OI    RSRGET(REG6),B'10000000'                            1474
*           RSRUPD = OFF;     /* NO UPDATE  */                     1475
         NI    RSRUPD(REG6),B'11110111'                            1475
*           RSRDS = ''B;                                           1476
         NI    RSRDS(REG6),B'00011111'                             1476
*           RSRCRA = ON;      /* CRA  */                           1477
*           RSRDIR = ON;      /* DIRECT  */                        1478
*           RSRKEY = OFF;     /* CNV  */                           1479
*                                                                  1479
         OI    RSRCRA(REG6),B'00100100'                            1479
         NI    RSRKEY(REG6),B'11101111'                            1479
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            1480
         L     @15,@CV03498                                        1480
         BALR  @14,@15                                             1480
*           RFY RTNREG RSTD;                                       1481
*           TESTRC = RTNREG;                                       1482
         STH   RTNREG,TESTRC(,REG6)                                1482
*           RFY RTNREG UNRSTD;                                     1483
*         END;                                                     1484
*                                                                  1484
*         /***********************************************************/
*         /*                                                         */
*         /*    IF NEXT UNFORMATTED CI IS 0, THEN SET LAST CI AS     */
*         /*    HIGH ALLOCATED CI, OTHERWISE SET LAST CI AS NEXT     */
*         /*    UNFORMATTED FREE CI MINUS ONE.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1485
*         IF CCRNFCI = 0                                           1485
*           THEN                                                   1485
         L     @04,RSCRBP1(,REG6)                                  1485
         ICM   @15,7,CCRNFCI(@04)                                  1485
         BNZ   @RF01485                                            1485
*             RSCREND = CCRHACI;                                   1486
         SLR   @15,@15                                             1486
         ICM   @15,7,CCRHACI(@04)                                  1486
         ST    @15,RSCREND(,REG6)                                  1486
*           ELSE                                                   1487
*             RSCREND = CCRNFCI - 1;                               1487
*                                                                  1487
*                                                                  1487
         B     @RC01485                                            1487
@RF01485 L     @04,RSCRBP1(,REG6)                                  1487
         SLR   @15,@15                                             1487
         ICM   @15,7,CCRNFCI(@04)                                  1487
         BCTR  @15,0                                               1487
         ST    @15,RSCREND(,REG6)                                  1487
*         /***********************************************************/
*         /*                                                         */
*         /*  SET CRA GRAB FLAGS FOR SPECIAL I/O ERROR HANDLING.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1488
*         GRABAFLS = ''B;                                          1488
@RC01485 L     @04,RSGRABCU(,REG6)                                 1488
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1488
*         GRABSIOI = ON;                                           1489
*                                                                  1489
         OI    GRABSIOI(@04),B'00010000'                           1489
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS EACH CRA RECORD FROM VOLUME RECORD TO LAST CI. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1490
*PROLP1:  DO RSCURCI = VOLCI TO RSCREND;                           1490
*                                                                  1490
PROLP1   LA    @04,9                                               1490
         B     @DE01490                                            1490
@DL01490 DS    0H                                                  1491
*         /***********************************************************/
*         /*                                                         */
*         /*    READ THE CRA RECORD VIA RECMGMT.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1491
*           RSGRABCU = ADDR(GRABSCR);                              1491
         L     @04,RSIOTBL(,REG6)                                  1491
         LA    @04,GRABSCR(,@04)                                   1491
         ST    @04,RSGRABCU(,REG6)                                 1491
*           RABRCDA = RSCURCI;                                     1492
*                                                                  1492
*                                                                  1492
         L     @04,GRABCURR(,@04)                                  1492
         L     @15,RSCURCI(,REG6)                                  1492
         ST    @15,RABRCDA(,@04)                                   1492
*           DO;                                                    1493
*             RSRTYPE = ''B;                                       1494
         MVI   RSRTYPE(REG6),X'00'                                 1494
*             RSRGET = ON;      /* GETRCD  */                      1495
         OI    RSRGET(REG6),B'10000000'                            1495
*             RSRUPD = OFF;     /* NO UPDATE  */                   1496
         NI    RSRUPD(REG6),B'11110111'                            1496
*             RSRDS = ''B;                                         1497
         NI    RSRDS(REG6),B'00011111'                             1497
*             RSRCRA = ON;      /* CRA  */                         1498
*             RSRDIR = ON;      /* DIRECT  */                      1499
*             RSRKEY = OFF;     /* CNV  */                         1500
*                                                                  1500
         OI    RSRCRA(REG6),B'00100100'                            1500
         NI    RSRKEY(REG6),B'11101111'                            1500
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */
*           CALL RECMGMT;                                          1501
         L     @15,@CV03498                                        1501
         BALR  @14,@15                                             1501
*             RFY RTNREG RSTD;                                     1502
*             TESTRC = RTNREG;                                     1503
         STH   RTNREG,TESTRC(,REG6)                                1503
*             RFY RTNREG UNRSTD;                                   1504
*           END;                                                   1505
*                                                                  1505
*         /***********************************************************/
*         /*                                                         */
*         /*    VOLUME RECORD (CI 9). ADD/UPDATE VOLSERTB ENTRY.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1506
*           IF RSCURCI = VOLCI                                     1506
*             THEN                                                 1506
         CLC   RSCURCI(4,REG6),@CF00040                            1506
         BNE   @RF01506                                            1506
*PROVOL:        DO;                                                1507
*                                                                  1507
PROVOL   DS    0H                                                  1508
*         /***********************************************************/
*         /*                                                         */
*         /*    SCAN VOLSERTB FOR CRA VOLSER VIA SCNVLST.            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1508
*                 RSCRVL = ADDR(RESVLSER);                         1508
*                                                                  1508
         L     @04,RSENTPT(,REG6)                                  1508
         LA    @04,RESVLSER(,@04)                                  1508
         ST    @04,RSCRVL(,REG6)                                   1508
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNVLST    */
*                 CALL IDCRS5SV(RSVTBENT,RSCRVL);                  1509
*                                                                  1509
         LA    @04,RSVTBENT(,REG6)                                 1509
         ST    @04,@AL00001                                        1509
         LA    @04,RSCRVL(,REG6)                                   1509
         ST    @04,@AL00001+4                                      1509
         L     @15,@CV03633                                        1509
         LA    @01,@AL00001                                        1509
         BALR  @14,@15                                             1509
*         /***********************************************************/
*         /*                                                         */
*         /*    NOT A VALID VOLUME RECORD. SET INVALID VOLUME RECORD */
*         /*    FLAGS. SET BYPASS VOLCHK FLAG.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1510
*                 IF RCDID ^= VOLID  RABIOIGN = ON                1510
*                   THEN                                           1510
         L     @04,RSGRABCU(,REG6)                                 1510
         L     @04,GRABCURR(,@04)                                  1510
         CLI   RCDID+8(@04),C'V'                                   1510
         BNE   @RT01510                                            1510
         TM    RABIOIGN(@04),B'00000100'                           1510
         BNO   @RF01510                                            1510
@RT01510 DS    0H                                                  1511
*                     DO;                                          1511
*                       RSBADVOL = ON;                             1512
         OI    RSBADVOL(REG6),B'00000010'                          1512
*                       RESVLBAD = ON;                             1513
         L     @04,RSENTPT(,REG6)                                  1513
         OI    RESVLBAD(@04),B'00010000'                           1513
*                       RSMEBYV = ON;                              1514
         OI    RSMEBYV(REG6),B'00010000'                           1514
*                     END;                                         1515
*                                                                  1515
*         /***********************************************************/
*         /*                                                         */
*         /*    VOLSERTB ENTRY FOUND. UPDATE IT FROM CRA VOLUME      */
*         /*    RECORD INFORMATION.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1516
*                 IF RSVTBENT ^= 0                                 1516
*                   THEN                                           1516
@RF01510 L     @04,RSVTBENT(,REG6)                                 1516
         LTR   @04,@04                                             1516
         BZ    @RF01516                                            1516
*                     DO;                                          1517
*                                                                  1517
*         /***********************************************************/
*         /*                                                         */
*         /*    INVALID VOLUME RECORD. INVALIDATE VOLSERTB ENTRY.    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1518
*                       IF RESVLBAD = ON                           1518
*                         THEN                                     1518
         L     @01,RSENTPT(,REG6)                                  1518
         TM    RESVLBAD(@01),B'00010000'                           1518
         BNO   @RF01518                                            1518
*                           DO;                                    1519
*                             VOLSRSER = ''B;                      1520
         XC    VOLSRSER(6,@04),VOLSRSER(@04)                       1520
*                             VOLSRTS = ''B;                       1521
         XC    VOLSRTS(8,@04),VOLSRTS(@04)                         1521
*                           END;                                   1522
*                                                                  1522
*         /***********************************************************/
*         /*                                                         */
*         /*    VALID VOLUME RECORD. UPDATE VOLSERTB ENTRY.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1523
*                         ELSE                                     1523
*                           DO;                                    1523
         B     @RC01518                                            1523
@RF01518 DS    0H                                                  1524
*                             VOLSRCI = RCDCINO;                   1524
         L     @04,RSVTBENT(,REG6)                                 1524
         L     @01,RSGRABCU(,REG6)                                 1524
         L     @15,GRABCURR(,@01)                                  1524
         LA    @14,8                                               1524
         ALR   @14,@15                                             1524
         L     @03,RCDCINO-1(,@14)                                 1524
         LA    @03,0(,@03)                                         1524
         ST    @03,VOLSRCI(,@04)                                   1524
*                             VOLSRTS = COWNID;                    1525
         MVC   VOLSRTS(8,@04),COWNID(@14)                          1525
*                             VOLSRNTK = RTNOTRKS;                 1526
         MVC   VOLSRNTK(2,@04),RTNOTRKS(@15)                       1526
*                           END;                                   1527
*                                                                  1527
*                     END;                                         1528
*                                                                  1528
@RC01518 DS    0H                                                  1529
*         /***********************************************************/
*         /*                                                         */
*         /*    VOLSERTB ENTRY NOT FOUND.                            */
*         /*    IF VOLUME RECORD IS VALID, BUILD AN ENTRY FOR        */
*         /*    THIS CRA VOLUME RECORD AND ADD IT TO VOLSERTB        */
*         /*    VIA BLDVLST.                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1529
*                 IF RSVTBENT = 0                                  1529
*                   THEN                                           1529
@RF01516 L     @04,RSVTBENT(,REG6)                                 1529
         LTR   @04,@04                                             1529
         BNZ   @RF01529                                            1529
*                     DO;                                          1530
*                       RSVTBENT = ADDR(RSVOLENT);                 1531
         L     @04,RSIOTBL(,REG6)                                  1531
         LA    @04,RSVOLENT(,@04)                                  1531
         ST    @04,RSVTBENT(,REG6)                                 1531
*                       VOLSERTB = ''B;                            1532
         XC    VOLSERTB(28,@04),VOLSERTB(@04)                      1532
*                       IF RESVLBAD = OFF                          1533
*                         THEN                                     1533
         L     @15,RSENTPT(,REG6)                                  1533
         TM    RESVLBAD(@15),B'00010000'                           1533
         BNZ   @RF01533                                            1533
*                           DO;                                    1534
*                             VOLSRCI = RCDCINO;                   1535
         L     @01,RSGRABCU(,REG6)                                 1535
         L     @14,GRABCURR(,@01)                                  1535
         LA    @03,8                                               1535
         ALR   @03,@14                                             1535
         L     @02,RCDCINO-1(,@03)                                 1535
         LA    @02,0(,@02)                                         1535
         ST    @02,VOLSRCI(,@04)                                   1535
*                             VOLSRTS = COWNID;                    1536
         MVC   VOLSRTS(8,@04),COWNID(@03)                          1536
*                             VOLSRSER = RESVLSER;                 1537
         MVC   VOLSRSER(6,@04),RESVLSER(@15)                       1537
*                             VOLSRNTK = RTNOTRKS;                 1538
*                                                                  1538
         MVC   VOLSRNTK(2,@04),RTNOTRKS(@14)                       1538
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE B
*DVLST                                                               */
*                             CALL IDCRS5BV(RSVTBENT);             1539
*                                                                  1539
         LA    @04,RSVTBENT(,REG6)                                 1539
         ST    @04,@AL00001                                        1539
         L     @15,@CV03538                                        1539
         LA    @01,@AL00001                                        1539
         BALR  @14,@15                                             1539
*                           END;                                   1540
*                                                                  1540
*                     END;                                         1541
*                                                                  1541
@RF01533 DS    0H                                                  1542
*         /***********************************************************/
*         /*                                                         */
*         /*    CALL CKERR TO PRINT INFORMATIONAL MESSAGE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1542
*                 IF RSCAEOV = OFF & RSCREOV = OFF         /*@ZA18274*/
*                   THEN                                           1542
*                                                                  1542
@RF01529 TM    RSCAEOV(REG6),B'01000010'                           1542
         BNZ   @RF01542                                            1542
*                     DO;                                          1543
*                     /*CALL CKERR*/                               1544
*                       RSCKERR = RSCKERR && RSCKERR;              1544
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1544
*                       RSCKERN = RSE080;                          1545
         MVC   RSCKERN(2,REG6),@CH01048                            1545
*                       RSCKTERM = 'RETU';                         1546
         MVC   RSCKTERM(4,REG6),@CC03585                           1546
*                       RSCKMVAR(1) = ADDR(RESVLSER);              1547
         L     @04,RSENTPT(,REG6)                                  1547
         LA    @04,RESVLSER(,@04)                                  1547
         ST    @04,RSCKMVAR(,REG6)                                 1547
*                       RSCKMVAR(2) = ADDR(VOLSRTS);               1548
*                                                                  1548
         L     @04,RSVTBENT(,REG6)                                 1548
         LA    @04,VOLSRTS(,@04)                                   1548
         ST    @04,RSCKMVAR+4(,REG6)                               1548
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */
*                     CALL CKERR;                                  1549
         L     @15,@CV03544                                        1549
         BALR  @14,@15                                             1549
*                     END;                                         1550
*                                                                  1550
*                                                                  1550
*               END PROVOL;                                        1551
*                                                                  1551
@RF01542 DS    0H                                                  1552
*         /***********************************************************/
*         /*                                                         */
*         /*    RECORD WAS NOT RETRIEVED DUE TO AN I/O ERROR,        */
*         /*    RECORD HAS A CIN GREATER THAN THE MAXIMUM CIN,       */
*         /*    RECORD IS A FREE RECORD, OR RECORD IS A BAD VOLUME   */
*         /*    RECORD. DO NOT MERGE RECORD TO WORKFILE.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1552
*           IF RABIOIGN = ON  RCDID = FREEID                     1552
*            (RSCURCI = VOLCI & RESVLBAD = ON)  RCDCINO > MAXCINO 1552
*             THEN                                                 1552
@RF01506 L     @04,RSGRABCU(,REG6)                                 1552
         L     @04,GRABCURR(,@04)                                  1552
         TM    RABIOIGN(@04),B'00000100'                           1552
         BO    @RT01552                                            1552
         CLI   RCDID+8(@04),C'F'                                   1552
         BE    @RT01552                                            1552
         CLC   RSCURCI(4,REG6),@CF00040                            1552
         BNE   @GL00006                                            1552
         L     @04,RSENTPT(,REG6)                                  1552
         TM    RESVLBAD(@04),B'00010000'                           1552
         BO    @RT01552                                            1552
@GL00006 L     @04,RSGRABCU(,REG6)                                 1552
         L     @04,GRABCURR(,@04)                                  1552
         L     @04,RCDCINO+7(,@04)                                 1552
         LA    @04,0(,@04)                                         1552
         C     @04,MAXCINO                                         1552
         BNH   @RF01552                                            1552
@RT01552 DS    0H                                                  1553
*               RABIOIGN = OFF;                                    1553
*                                                                  1553
         L     @04,RSGRABCU(,REG6)                                 1553
         L     @04,GRABCURR(,@04)                                  1553
         NI    RABIOIGN(@04),B'11111011'                           1553
*         /***********************************************************/
*         /*                                                         */
*         /*    RECORD WAS RETRIEVED AND IS NOT A FREE RECORD        */
*         /*    OR A BAD VOLUME RECORD. COPY IT TO THE WORKFILE.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1554
*             ELSE                                                 1554
*PROMRG:        DO;                                                1554
*                                                                  1554
         B     @RC01552                                            1554
@RF01552 DS    0H                                                  1554
PROMRG   DS    0H                                                  1555
*         /***********************************************************/
*         /*                                                         */
*         /*  SET CURRENT GRAB POINTER FOR WORKFILE GRABS.           */
*         /*  SET GRAB FLAGS FOR SPECIAL CI TO RRN TRANSLATION       */
*         /*  PROCESSING AND FOR SPECIAL NO RECORD FOUND PROCESSING. */
*         /*  RETRIEVE WORKFILE CATALOG CI RECORD.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1555
*                 RSGRABCU = ADDR(GRABSWF);                        1555
         L     @04,RSIOTBL(,REG6)                                  1555
         ST    @04,RSGRABCU(,REG6)                                 1555
*                 GRABAFLS = ''B;                                  1556
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1556
*                 GRABSFXT = ON;                                   1557
*                 GRABSNRA = ON;                                   1558
*                 GRABSEFN = ON;                                   1559
         OI    GRABSFXT(@04),B'11100000'                           1559
*                 GRABCURR = GRABRAB1;                             1560
         L     @15,GRABRAB1(,@04)                                  1560
         ST    @15,GRABCURR(,@04)                                  1560
*                 RABRCDA =                                        1561
*                   ADDR(ADDR(GRABSCR) -> GRABCURR -> RABBUF)      1561
*                     -> RCDCINO;                                  1561
*                                                                  1561
         L     @04,GRABCURR+80(,@04)                               1561
         L     @04,RCDCINO+7(,@04)                                 1561
         LA    @04,0(,@04)                                         1561
         ST    @04,RABRCDA(,@15)                                   1561
*         /***********************************************************/
*         /*                                                         */
*         /*    READ WORKFILE RECORD VIA RECMGMT.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1562
*                                                                  1562
*                 DO;                                              1562
*                   RSRTYPE = ''B;                                 1563
         MVI   RSRTYPE(REG6),X'00'                                 1563
*                   RSRGET = ON;      /* GETRCD  */                1564
         OI    RSRGET(REG6),B'10000000'                            1564
*                   RSRUPD = ON;      /* UPDATE  */                1565
         OI    RSRUPD(REG6),B'00001000'                            1565
*                   RSRDS = ''B;                                   1566
         NI    RSRDS(REG6),B'00011111'                             1566
*                   RSRWF = ON;       /* WORKFILE  */              1567
*                   RSRDIR = ON;      /* DIRECT  */                1568
*                   RSRKEY = ON;      /* KEY  */                   1569
*                                                                  1569
         OI    RSRWF(REG6),B'10010100'                             1569
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT    */
*                 CALL RECMGMT;                                    1570
         L     @15,@CV03498                                        1570
         BALR  @14,@15                                             1570
*                   RFY RTNREG RSTD;                               1571
*                   TESTRC = RTNREG;                               1572
         STH   RTNREG,TESTRC(,REG6)                                1572
*                   RFY RTNREG UNRSTD;                             1573
*                 END;                                             1574
*                                                                  1574
*         /***********************************************************/
*         /*                                                         */
*         /*    IF RECORD WAS NOT FOUND, MARK IT AS INVALID.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1575
*               IF RABADD = ON                                     1575
*                 THEN                                             1575
         L     @04,RSGRABCU(,REG6)                                 1575
         L     @04,GRABCURR(,@04)                                  1575
         TM    RABADD(@04),B'00100000'                             1575
         BNO   @RF01575                                            1575
*                   RSWINVCI = ON;                                 1576
*                                                                  1576
         OI    RSWINVCI(@04),B'10000000'                           1576
*         /***********************************************************/
*         /*                                                         */
*         /*    ENSURE THAT CRA CI IS CORRECT.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1577
*                 RSGRABCU = ADDR(GRABSCR);                        1577
@RF01575 L     @04,RSIOTBL(,REG6)                                  1577
         LA    @04,GRABSCR(,@04)                                   1577
         ST    @04,RSGRABCU(,REG6)                                 1577
*                 IF RCDCRACI ^= RABRCDA                           1578
*                   THEN                                           1578
         L     @04,GRABCURR(,@04)                                  1578
         LA    @15,8                                               1578
         ALR   @15,@04                                             1578
         L     @04,RABRCDA(,@04)                                   1578
         SLR   @14,@14                                             1578
         ICM   @14,7,RCDCRACI(@15)                                 1578
         CR    @04,@14                                             1578
         BE    @RF01578                                            1578
*                     DO;                                          1579
*                       RCDCRACI = RABRCDA;                        1580
*                                                                  1580
         STCM  @04,7,RCDCRACI(@15)                                 1580
*                       /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR
*                                                                    */
*                       CALL ADDUPCR;                              1581
*                                                                  1581
         L     @15,@CV03636                                        1581
         BALR  @14,@15                                             1581
*                     END;                                         1582
*                                                                  1582
*                                                                  1582
*         /***********************************************************/
*         /*                                                         */
*         /*    WORKFILE CATALOG CI RECORD HAS ALREADY BEEN          */
*         /*    REPLACED FROM A CRA OR IS NOT AVAILABLE FOR          */
*         /*    REPLACEMENT.                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1583
*                 RSGRABCU = ADDR(GRABSWF);                        1583
@RF01578 L     @04,RSIOTBL(,REG6)                                  1583
         ST    @04,RSGRABCU(,REG6)                                 1583
*                 IF RSWFCRA = ON  (RSWINVCI = OFF &              1584
*                    RCDID ^= FREEID & RSWDLCAT = OFF)             1584
*                   THEN                                           1584
         L     @04,GRABCURR(,@04)                                  1584
         TM    RSWFCRA(@04),B'10000000'                            1584
         BO    @RT01584                                            1584
         TM    RSWINVCI(@04),B'10000000'                           1584
         BNZ   @RF01584                                            1584
         CLI   RCDID+8(@04),C'F'                                   1584
         BE    @RF01584                                            1584
         TM    RSWDLCAT(@04),B'01000000'                           1584
         BNZ   @RF01584                                            1584
@RT01584 DS    0H                                                  1585
*PRODUP:              DO;                                          1585
*                                                                  1585
PRODUP   DS    0H                                                  1586
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS DUPLICATE RECORD. SET CURRENT WORKFILE       */
*         /*    RAB POINTER TO OVERFLOW RAB.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1586
*                       GRABCURR = GRABRAB2;                       1586
*                                                                  1586
         L     @04,RSGRABCU(,REG6)                                 1586
         L     @15,GRABRAB2(,@04)                                  1586
         ST    @15,GRABCURR(,@04)                                  1586
*         /***********************************************************/
*         /*                                                         */
*         /*    ASSIGN AN OVERFLOW RELATIVE RECORD NUMBER.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1587
*                       RABRCDA = RSWFNEXT;                        1587
         L     @14,RSWFNEXT(,REG6)                                 1587
         ST    @14,RABRCDA(,@15)                                   1587
*                       RABRRN = ON;                               1588
         OI    RABRRN(@15),B'00010000'                             1588
*                       RSWFNEXT = RSWFNEXT + 1;                   1589
*                                                                  1589
         AL    @14,@CF00219                                        1589
         ST    @14,RSWFNEXT(,REG6)                                 1589
*         /***********************************************************/
*         /*                                                         */
*         /*    MOVE THE CRA RECORD TO THE WORKFILE OVERFLOW         */
*         /*    BUFFER.                                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1590
*                       WFBUF2(1:256) = CRBUF1(1:256);             1590
         L     @14,RSWFBP2(,REG6)                                  1590
         L     @03,RSCRBP1(,REG6)                                  1590
         MVC   WFBUF2(256,@14),CRBUF1(@03)                         1590
*                       WFBUF2(257:CELEN) = CRBUF1(257:CELEN);     1591
*                                                                  1591
         MVC   WFBUF2+256(249,@14),CRBUF1+256(@03)                 1591
*         /***********************************************************/
*         /*                                                         */
*         /*    SET REPLACED FROM CRA FLAG AND SAVE DUPLICATE        */
*         /*    CHAIN POINTER IN WORKFILE OVERFLOW PROCESSING AREA.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1592
*                       RSWFLD = ''B;                              1592
         XC    RSWFLD(10,@15),RSWFLD(@15)                          1592
*                       RSWFCRA = ON;                              1593
         OI    RSWFCRA(@15),B'10000000'                            1593
*                       IF GRABRAB1 -> RSWDUPTR ^= 0               1594
*                         THEN                                     1594
         L     @04,GRABRAB1(,@04)                                  1594
         L     @04,RSWDUPTR(,@04)                                  1594
         LTR   @04,@04                                             1594
         BZ    @RF01594                                            1594
*                           DO;                                    1595
*                             RSWDUPTR = GRABRAB1 -> RSWDUPTR;     1596
         ST    @04,RSWDUPTR(,@15)                                  1596
*                             RSWDUPRR = ON;                       1597
         OI    RSWDUPRR(@15),B'01000000'                           1597
*                           END;                                   1598
*                                                                  1598
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*    IF RECORD SHOULD BE MOVED FROM OLD CATALOG'S @ZA18274*/
*         /*     CRA TO NEW CATALOG'S CRA, THEN SET MOVE TO  @ZA18274*/
*         /*     NEW CRA FLAG AND INCREMENT COUNT OF RECORDS @ZA18274*/
*         /*     TO BE MOVED.                                @ZA18274*/
*         /*                                                 @ZA18274*/
*         /***********************************************************/
*                                                                  1599
*                       RSGRABCU = ADDR(GRABSCR);          /*@ZA18274*/
@RF01594 L     @04,RSIOTBL(,REG6)                                  1599
         LA    @04,GRABSCR(,@04)                                   1599
         ST    @04,RSGRABCU(,REG6)                                 1599
*                       IF (RCDID = NVID  RCDID = GDGID          1600
*                           RCDID = UCATID  RCDID = ALIASID)      1600
*                            & (RCDCRAVL ^= RSINVLSR)              1600
*                         THEN DO;                         /*@ZA18274*/
         LA    @15,8                                               1600
         AL    @15,GRABCURR(,@04)                                  1600
         CLI   RCDID(@15),C'A'                                     1600
         BE    @GL00013                                            1600
         CLI   RCDID(@15),C'B'                                     1600
         BE    @GL00013                                            1600
         CLI   RCDID(@15),C'U'                                     1600
         BE    @GL00013                                            1600
         CLI   RCDID(@15),C'X'                                     1600
         BNE   @RF01600                                            1600
@GL00013 L     @04,RSGRABCU(,REG6)                                 1600
         L     @04,GRABCURR(,@04)                                  1600
         CLC   RCDCRAVL+8(6,@04),RSINVLSR(REG6)                    1600
         BE    @RF01600                                            1600
*                           RSGRABCU = ADDR(GRABSWF);      /*@ZA18274*/
         L     @04,RSIOTBL(,REG6)                                  1602
         ST    @04,RSGRABCU(,REG6)                                 1602
*                           RSWCHRA = ON;                  /*@ZA18274*/
         L     @04,GRABCURR(,@04)                                  1603
         OI    RSWCHRA(@04),B'00000010'                            1603
*                           RSCHCRAN = RSCHCRAN + 1;       /*@ZA18274*/
         LA    @04,1                                               1604
         AL    @04,RSCHCRAN(,REG6)                                 1604
         ST    @04,RSCHCRAN(,REG6)                                 1604
*                         END;                             /*@ZA18274*/
*                       RSGRABCU = ADDR(GRABSWF);          /*@ZA18274*/
*                                                                  1606
@RF01600 L     @04,RSIOTBL(,REG6)                                  1606
         ST    @04,RSGRABCU(,REG6)                                 1606
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE OVERFLOW RECORD ON THE REASSIGN CHAIN.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1607
*                       RSWCHPTR = RSREASS;                        1607
         L     @04,GRABCURR(,@04)                                  1607
         L     @15,RSREASS(,REG6)                                  1607
         ST    @15,RSWCHPTR(,@04)                                  1607
*                       IF RSREARR = ON                            1608
*                         THEN                                     1608
         TM    RSREARR(REG6),B'10000000'                           1608
         BNO   @RF01608                                            1608
*                           RSWCHNRR = ON;                         1609
         OI    RSWCHNRR(@04),B'00000100'                           1609
*                       RSREASS = RABRCDA;                         1610
@RF01608 L     @04,RSGRABCU(,REG6)                                 1610
         L     @01,GRABCURR(,@04)                                  1610
         L     @15,RABRCDA(,@01)                                   1610
         ST    @15,RSREASS(,REG6)                                  1610
*                       RSREASSN = RSREASSN + 1;                   1611
         LA    @15,1                                               1611
         AL    @15,RSREASSN(,REG6)                                 1611
         ST    @15,RSREASSN(,REG6)                                 1611
*                       RSREARR = ON;                              1612
*                                                                  1612
         OI    RSREARR(REG6),B'10000000'                           1612
*         /***********************************************************/
*         /*                                                         */
*         /*    WRITE OVERFLOW RECORD TO WORKFILE VIA RECMGMT.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1613
*                       GRABAFLS = ''B;                            1613
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1613
*                       GRABSNRA = ON;                             1614
*                       GRABSEFN = ON;                             1615
*                                                                  1615
*                                                                  1615
         OI    GRABSNRA(@04),B'01100000'                           1615
*                       DO;                                        1616
*                         RSRTYPE = ''B;                           1617
         MVI   RSRTYPE(REG6),X'00'                                 1617
*                         RSRUPDT = ON;     /* UPDRCD  */          1618
         OI    RSRUPDT(REG6),B'00100000'                           1618
*                         RSRUPD = ON;      /* UPDATE  */          1619
         OI    RSRUPD(REG6),B'00001000'                            1619
*                         RSRDS = ''B;                             1620
         NI    RSRDS(REG6),B'00011111'                             1620
*                         RSRWF = ON;       /* WORKFILE  */        1621
*                         RSRDIR = ON;      /* DIRECT  */          1622
*                         RSRKEY = ON;      /* KEY  */             1623
*                                                                  1623
         OI    RSRWF(REG6),B'10010100'                             1623
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                       CALL RECMGMT;                              1624
         L     @15,@CV03498                                        1624
         BALR  @14,@15                                             1624
*                         RFY RTNREG RSTD;                         1625
*                         TESTRC = RTNREG;                         1626
         STH   RTNREG,TESTRC(,REG6)                                1626
*                         RFY RTNREG UNRSTD;                       1627
*                       END;                                       1628
*                                                                  1628
*                       GRABAFLS = ''B;                            1629
         L     @04,RSGRABCU(,REG6)                                 1629
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1629
*                       RABRRN = OFF;                              1630
*                                                                  1630
         L     @01,GRABCURR(,@04)                                  1630
         NI    RABRRN(@01),B'11101111'                             1630
*         /***********************************************************/
*         /*                                                         */
*         /*    SET CURRENT WORKFILE RAB POINTER TO WORKFILE         */
*         /*    CATALOG CI RAB.                                      */
*         /*    SET DUPLICATE EXISTS FLAG AND DUPLICATE CHAIN        */
*         /*    POINTER IN WORKFILE CATALOG CI RECORD.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1631
*                       GRABCURR = GRABRAB1;                       1631
         L     @15,GRABRAB1(,@04)                                  1631
         ST    @15,GRABCURR(,@04)                                  1631
*                       RSWDUPCI = ON;                             1632
         OI    RSWDUPCI(@15),B'00000001'                           1632
*                       RSWDUPRR = ON;                             1633
         OI    RSWDUPRR(@15),B'01000000'                           1633
*                       RSWDUPTR = GRABRAB2 -> RABRCDA;            1634
*                                                                  1634
         L     @04,GRABRAB2(,@04)                                  1634
         L     @04,RABRCDA(,@04)                                   1634
         ST    @04,RSWDUPTR(,@15)                                  1634
*                     END PRODUP;                                  1635
*                                                                  1635
*         /***********************************************************/
*         /*                                                         */
*         /*  WORKFILE CATALOG CI RECORD IS AVAILABLE FOR            */
*         /*  REPLACEMENT.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1636
*                   ELSE                                           1636
*PRONDUP:             DO;                                          1636
*                                                                  1636
         B     @RC01584                                            1636
@RF01584 DS    0H                                                  1636
PRONDUP  DS    0H                                                  1637
*         /***********************************************************/
*         /*                                                         */
*         /*    MOVE CRA RECORD TO WORKFILE CATALOG CI BUFFER.       */
*         /*    SET REPLACED FROM CRA FLAG IN WORKFILE CATALOG CI    */
*         /*    PROCESSING FIELD.                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1637
*                       WFBUF1(1:256) = CRBUF1(1:256);             1637
         L     @04,RSWFBP1(,REG6)                                  1637
         L     @15,RSCRBP1(,REG6)                                  1637
         MVC   WFBUF1(256,@04),CRBUF1(@15)                         1637
*                       WFBUF1(257:CELEN) = CRBUF1(257:CELEN);     1638
         MVC   WFBUF1+256(249,@04),CRBUF1+256(@15)                 1638
*                       RSWFCRA = ON;                              1639
*                       RSWDLCAT = OFF;                            1640
*                                                                  1640
         L     @04,RSGRABCU(,REG6)                                 1640
         L     @04,GRABCURR(,@04)                                  1640
         OI    RSWFCRA(@04),B'10000000'                            1640
         NI    RSWDLCAT(@04),B'10111111'                           1640
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*    IF RECORD SHOULD BE MOVED FROM OLD CATALOG'S @ZA18274*/
*         /*     CRA TO NEW CATALOG'S CRA, THEN SET MOVE TO  @ZA18274*/
*         /*     NEW CRA FLAG AND INCREMENT COUNT OF RECORDS @ZA18274*/
*         /*     TO BE MOVED.                                @ZA18274*/
*         /*                                                 @ZA18274*/
*         /***********************************************************/
*                                                                  1641
*                       RSGRABCU = ADDR(GRABSCR);          /*@ZA18274*/
         L     @04,RSIOTBL(,REG6)                                  1641
         LA    @04,GRABSCR(,@04)                                   1641
         ST    @04,RSGRABCU(,REG6)                                 1641
*                       IF (RCDID = NVID  RCDID = GDGID          1642
*                           RCDID = UCATID  RCDID = ALIASID)      1642
*                            & (RCDCRAVL ^= RSINVLSR)              1642
*                         THEN DO;                         /*@ZA18274*/
         LA    @15,8                                               1642
         AL    @15,GRABCURR(,@04)                                  1642
         CLI   RCDID(@15),C'A'                                     1642
         BE    @GL00017                                            1642
         CLI   RCDID(@15),C'B'                                     1642
         BE    @GL00017                                            1642
         CLI   RCDID(@15),C'U'                                     1642
         BE    @GL00017                                            1642
         CLI   RCDID(@15),C'X'                                     1642
         BNE   @RF01642                                            1642
@GL00017 L     @04,RSGRABCU(,REG6)                                 1642
         L     @04,GRABCURR(,@04)                                  1642
         CLC   RCDCRAVL+8(6,@04),RSINVLSR(REG6)                    1642
         BE    @RF01642                                            1642
*                           RSGRABCU = ADDR(GRABSWF);      /*@ZA18274*/
         L     @04,RSIOTBL(,REG6)                                  1644
         ST    @04,RSGRABCU(,REG6)                                 1644
*                           RSWCHRA = ON;                  /*@ZA18274*/
         L     @04,GRABCURR(,@04)                                  1645
         OI    RSWCHRA(@04),B'00000010'                            1645
*                           RSCHCRAN = RSCHCRAN + 1;       /*@ZA18274*/
         LA    @04,1                                               1646
         AL    @04,RSCHCRAN(,REG6)                                 1646
         ST    @04,RSCHCRAN(,REG6)                                 1646
*                         END;                             /*@ZA18274*/
*                       RSGRABCU = ADDR(GRABSWF);          /*@ZA18274*/
*                                                                  1648
@RF01642 L     @04,RSIOTBL(,REG6)                                  1648
         ST    @04,RSGRABCU(,REG6)                                 1648
*         /***********************************************************/
*         /*                                                         */
*         /*    REPLACE INVALID WORKFILE RECORD.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1649
*                       IF RSWINVCI = ON                           1649
*                         THEN                                     1649
         L     @04,GRABCURR(,@04)                                  1649
         TM    RSWINVCI(@04),B'10000000'                           1649
         BNO   @RF01649                                            1649
*PROINV:                    DO;                                    1650
*                                                                  1650
PROINV   DS    0H                                                  1651
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE RECORD ON REASSIGN CHAIN.                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1651
*                             RSWCHPTR = RSREASS;                  1651
         L     @04,RSGRABCU(,REG6)                                 1651
         L     @04,GRABCURR(,@04)                                  1651
         L     @15,RSREASS(,REG6)                                  1651
         ST    @15,RSWCHPTR(,@04)                                  1651
*                             IF RSREARR = ON                      1652
*                               THEN                               1652
         TM    RSREARR(REG6),B'10000000'                           1652
         BNO   @RF01652                                            1652
*                                 RSWCHNRR = ON;                   1653
         OI    RSWCHNRR(@04),B'00000100'                           1653
*                               ELSE                               1654
*                                 RSWCHNRR = OFF;                  1654
         B     @RC01652                                            1654
@RF01652 L     @04,RSGRABCU(,REG6)                                 1654
         L     @04,GRABCURR(,@04)                                  1654
         NI    RSWCHNRR(@04),B'11111011'                           1654
*                             RSREARR = OFF;                       1655
@RC01652 NI    RSREARR(REG6),B'01111111'                           1655
*                             RSREASS = RCDCINO;                   1656
         L     @04,RSGRABCU(,REG6)                                 1656
         L     @04,GRABCURR(,@04)                                  1656
         L     @04,RCDCINO+7(,@04)                                 1656
         LA    @04,0(,@04)                                         1656
         ST    @04,RSREASS(,REG6)                                  1656
*                             RSREASSN = RSREASSN + 1;             1657
*                                                                  1657
         LA    @04,1                                               1657
         AL    @04,RSREASSN(,REG6)                                 1657
         ST    @04,RSREASSN(,REG6)                                 1657
*                           END PROINV;                            1658
*                                                                  1658
*         /***********************************************************/
*         /*                                                         */
*         /*  REPLACE AVAILABLE WORKFILE RECORD. RECORD IS FREE      */
*         /*  OR BELONGS TO A CRA TO BE RESET.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1659
*                         ELSE                                     1659
*PROAVL:                    DO;                                    1659
*                                                                  1659
         B     @RC01649                                            1659
@RF01649 DS    0H                                                  1659
PROAVL   DS    0H                                                  1660
*         /***********************************************************/
*         /*                                                         */
*         /*    DECREMENT AVAILABLE COUNT AND SET UPDATE CATALOG     */
*         /*    FLAG IN WORKFILE CATALOG CI PROCESSING FIELD.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1660
*                             RSAVAILN = RSAVAILN - 1;             1660
         L     @04,RSAVAILN(,REG6)                                 1660
         BCTR  @04,0                                               1660
         ST    @04,RSAVAILN(,REG6)                                 1660
*                             RSWUPCAT = ON;                       1661
*                                                                  1661
         L     @04,RSGRABCU(,REG6)                                 1661
         L     @04,GRABCURR(,@04)                                  1661
         OI    RSWUPCAT(@04),B'00100000'                           1661
*                           END PROAVL;                            1662
*                                                                  1662
*                     END PRONDUP;                                 1663
*                                                                  1663
@RC01649 DS    0H                                                  1664
*         /***********************************************************/
*         /*                                                         */
*         /*  ADD/UPDATE WORKFILE CATALOG CI RECORD VIA RECMGMT.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1664
*               IF RABADD = ON                                     1664
*                 THEN                                             1664
@RC01584 L     @04,RSGRABCU(,REG6)                                 1664
         L     @04,GRABCURR(,@04)                                  1664
         TM    RABADD(@04),B'00100000'                             1664
         BNO   @RF01664                                            1664
*                   DO;                                            1665
*                     RABADD = OFF;                                1666
*                                                                  1666
*                                                                  1666
         NI    RABADD(@04),B'11011111'                             1666
*                     DO;                                          1667
*                       RSRTYPE = ''B;                             1668
         MVI   RSRTYPE(REG6),X'00'                                 1668
*                       RSRADD = ON;      /* ADDRCD  */            1669
         OI    RSRADD(REG6),B'01000000'                            1669
*                       RSRUPD = OFF;     /* NO UPDATE  */         1670
         NI    RSRUPD(REG6),B'11110111'                            1670
*                       RSRDS = ''B;                               1671
         NI    RSRDS(REG6),B'00011111'                             1671
*                       RSRWF = ON;       /* WORKFILE  */          1672
*                       RSRDIR = ON;      /* DIRECT  */            1673
*                       RSRKEY = ON;      /* KEY  */               1674
*                                                                  1674
         OI    RSRWF(REG6),B'10010100'                             1674
*                     /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT*/
*                     CALL RECMGMT;                                1675
         L     @15,@CV03498                                        1675
         BALR  @14,@15                                             1675
*                       RFY RTNREG RSTD;                           1676
*                       TESTRC = RTNREG;                           1677
         STH   RTNREG,TESTRC(,REG6)                                1677
*                       RFY RTNREG UNRSTD;                         1678
*                     END;                                         1679
*                                                                  1679
*                   END;                                           1680
*                 ELSE                                             1681
*                                                                  1681
*                                                                  1681
*                   DO;                                            1681
         B     @RC01664                                            1681
@RF01664 DS    0H                                                  1682
*                     RSRTYPE = ''B;                               1682
         MVI   RSRTYPE(REG6),X'00'                                 1682
*                     RSRUPDT = ON;     /* UPDRCD  */              1683
         OI    RSRUPDT(REG6),B'00100000'                           1683
*                     RSRUPD = ON;      /* UPDATE  */              1684
         OI    RSRUPD(REG6),B'00001000'                            1684
*                     RSRDS = ''B;                                 1685
         NI    RSRDS(REG6),B'00011111'                             1685
*                     RSRWF = ON;       /* WORKFILE  */            1686
*                     RSRDIR = ON;      /* DIRECT  */              1687
*                     RSRKEY = ON;      /* KEY  */                 1688
*                                                                  1688
         OI    RSRWF(REG6),B'10010100'                             1688
*                   /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  */
*                   CALL RECMGMT;                                  1689
         L     @15,@CV03498                                        1689
         BALR  @14,@15                                             1689
*                     RFY RTNREG RSTD;                             1690
*                     TESTRC = RTNREG;                             1691
         STH   RTNREG,TESTRC(,REG6)                                1691
*                     RFY RTNREG UNRSTD;                           1692
*                   END;                                           1693
*                                                                  1693
*               END PROMRG;                                        1694
*                                                                  1694
@RC01664 DS    0H                                                  1695
*         END PROLP1;                                              1695
*                                                                  1695
@RC01552 LA    @04,1                                               1695
         AL    @04,RSCURCI(,REG6)                                  1695
@DE01490 ST    @04,RSCURCI(,REG6)                                  1695
         C     @04,RSCREND(,REG6)                                  1695
         BNH   @DL01490                                            1695
*         /***********************************************************/
*         /*                                                         */
*         /*  EXTRACT CRA EXTENT INFORMATION.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1696
*         /***********************************************************/
*         /*                                                         */
*         /*    READ CRA DATA RECORD VIA RECMGMT.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1696
*         RSGRABCU = ADDR(GRABSCR);                                1696
         L     @04,RSIOTBL(,REG6)                                  1696
         LA    @04,GRABSCR(,@04)                                   1696
         ST    @04,RSGRABCU(,REG6)                                 1696
*         RABRCDA = DATACI;                                        1697
*                                                                  1697
*                                                                  1697
         L     @04,GRABCURR(,@04)                                  1697
         SLR   @15,@15                                             1697
         ST    @15,RABRCDA(,@04)                                   1697
*         DO;                                                      1698
*           RSRTYPE = ''B;                                         1699
         MVI   RSRTYPE(REG6),X'00'                                 1699
*           RSRGET = ON;      /* GETRCD  */                        1700
         OI    RSRGET(REG6),B'10000000'                            1700
*           RSRUPD = OFF;     /* NO UPDATE  */                     1701
         NI    RSRUPD(REG6),B'11110111'                            1701
*           RSRDS = ''B;                                           1702
         NI    RSRDS(REG6),B'00011111'                             1702
*           RSRCRA = ON;      /* CRA  */                           1703
*           RSRDIR = ON;      /* DIRECT  */                        1704
*           RSRKEY = OFF;     /* CNV  */                           1705
*                                                                  1705
         OI    RSRCRA(REG6),B'00100100'                            1705
         NI    RSRKEY(REG6),B'11101111'                            1705
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            1706
         L     @15,@CV03498                                        1706
         BALR  @14,@15                                             1706
*           RFY RTNREG RSTD;                                       1707
*           TESTRC = RTNREG;                                       1708
         STH   RTNREG,TESTRC(,REG6)                                1708
*           RFY RTNREG UNRSTD;                                     1709
*         END;                                                     1710
*                                                                  1710
*         /***********************************************************/
*         /*                                                         */
*         /*    EXTRACT CRA EXTENTS VIA FINDALL AND SAVE IN RESVOL.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1711
*                                                                  1711
*         DO;                                                      1711
*           GRABBB = GRABCURR;                                     1712
         L     @04,RSGRABCU(,REG6)                                 1712
         L     @15,GRABCURR(,@04)                                  1712
         ST    @15,GRABBB(,@04)                                    1712
*           RSWGCODE = GCVOLGO;        /*SPECIFY GROUP CODE          */
         MVI   RSWGCODE(REG6),X'03'                                1713
*           RSWFONE = OFF;             /*FIND ALL OCCURRENCES        */
         NI    RSWFONE(REG6),B'01111111'                           1714
*           /* CALL THE FIND SUBROUTINE */                         1715
*                                                                  1715
*         /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND               */
*         CALL FIND;                                               1715
         L     @15,@CV03645                                        1715
         BALR  @14,@15                                             1715
*         END;                                                     1716
*                                                                  1716
*         RESVLNEX = RSFCNTTN;                                     1717
         L     @04,RSENTPT(,REG6)                                  1717
         L     @15,RSWASNVT(,REG6)                                 1717
         LH    @14,RSFCNTTN(,@15)                                  1717
         STH   @14,RESVLNEX(,@04)                                  1717
*         RESVLEXT(1:RSFCNTTN*4) = FNDEXTS(1:RSFCNTTN*4);          1718
         SLA   @14,2                                               1718
         BCTR  @14,0                                               1718
         L     @01,RSFATTNN(,@15)                                  1718
         EX    @14,@SM03817                                        1718
*         RSFENTLN = 0;                                            1719
*                                                                  1719
         MVI   RSFENTLN(@15),X'00'                                 1719
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1720
*                                                                  1720
*                                                                  1720
*         IF GDTDBG = NULLPTR                                      1720
*           THEN;                                                  1720
         L     @04,GDTDBG(,REG5)                                   1720
         LTR   @04,@04                                             1720
         BZ    @RT01720                                            1720
*           ELSE                                                   1722
*             CALL IDCDB010 (GDTTBL,'RSP1');                       1722
*                                                                  1722
         ST    REG5,@AL00001                                       1722
         LA    @04,@CC03646                                        1722
         ST    @04,@AL00001+4                                      1722
         MVI   @AL00001+4,X'80'                                    1722
         L     @15,GDTDBG(,REG5)                                   1722
         LA    @01,@AL00001                                        1722
         BALR  @14,@15                                             1722
*         RFY CCR;                                                 1723
*                                                                  1723
@RT01720 DS    0H                                                  1724
* CALL EXIT;  /*TERMINATE*/                                        1724
         BAL   @14,EXIT                                            1724
* END PROCCRA; /*END OF PROCEDURE*/                                1725
@EL00008 DS    0H                                                  1725
@EF00008 DS    0H                                                  1725
@ER00008 BR    @14                                                 1725
@PB00008 DS    0H                                                  1726
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - REASSIGN                                */
*        /*                                                          */
*        /* FUNCTION - THIS PROCEDURE ASSIGNS NEW CI NUMBERS TO THE  */
*        /*            RECORDS ON THE REASSIGN CHAIN. RECORDS ARE    */
*        /*            ON THE REASSIGN CHAIN BECAUSE THEY CONTAIN    */
*        /*            INVALID OR DUPLICATE CI NUMBERS WHEN COMPARED */
*        /*            TO THE WORK FILE(RECOVERABLE CATALOG) AFTER   */
*        /*            COPYCAT AND MERGE CRA. THE NEW CI NUMBERS ARE */
*        /*            THOSE CI(SLOT)NUMBERS IN THE WORKFILE WHICH   */
*        /*            ARE FREE AFTER THE CRA'S HAVE BEEN MERGED AND */
*        /*            ARE FOUND ON THE AVAILABLE CHAIN. SINCE       */
*        /*            DIFFERENT LEVELS OF THE CATALOG AND CRA       */
*        /*            VOLUMES MAY BE RESET, RECORDS FROM THE CRA MAY*/
*        /*            BE TARGETED FOR THE SAME CI AS ONE THAT EXISTS*/
*        /*            IN THE CATALOG AND CONTAINS A RECORD FROM     */
*        /*            A DIFFERENT CRA. THIS CREATES A DUPLICATE     */
*        /*            REQUEST FOR THE SAME CI NUMBER. WHEN THE      */
*        /*            DUPLICATE IS REASSIGNED, THE DUPLICATE CHAIN  */
*        /*            POINTER WHICH ASSOCIATES THIS RECORD WITH     */
*        /*            IT'S ORIGINAL CI NUMBER MUST BE UPDATED TO    */
*        /*            POINT TO THE NEWLY ASSIGNED LOCATION.         */
*        /*                THIS PROCEDURE USES TWO OF THE AVAILABLE  */
*        /*            RAB CONTROL BLOCKS. ASSOCIATED WITH EACH RAB  */
*        /*            IS A BUFFER AREA AND A PROCESSING FIELD.      */
*        /*                                                          */
*        /* INPUT -    MAIN WORKAREA,WORKFILE PROCESSING  FIELD,     */
*        /*            WORKFILE,WORK BUFFERS,GRAB AND RAB CONTROL    */
*        /*            BLOCKS                                        */
*        /*                                                          */
*        /* OUTPUT -   WORKFILE IS UPDATED WITH RESIGNABLE           */
*        /*            RECORDS.                                      */
*        /*                                                          */
*        /************************************************************/
*      GENERATE;                                                   1726
         DS    0F
NAME0167 DC    CL8'REASSIGN'
*REASSIGN: PROCEDURE                                               1727
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1727
*                                                                  1727
         B     @PB00009                                            1727
REASSIGN DS    0H                                                  1728
*      GENERATE REFS(RS01RG08, REG6);                              1728
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0167  PROCNAME TO REGSAVE
*        OLDERID2 = NEWERID2;                                      1729
         L     @04,GDTTR2(,REG5)                                   1729
         MVC   @TS00001(95),NEWERID2(@04)                          1729
         MVC   OLDERID2(95,@04),@TS00001                           1729
*        NEWID2 = 'RSRE';                                          1730
*                                                                  1730
         MVC   NEWID2(4,@04),@CC03650                              1730
*        /************************************************************/
*        /*                                                          */
*        /* ADDRESSABILITY AND INITIALIZATION                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1731
*        RSGRABCU = ADDR(GRABSWF);     /* DEFAULT POINTER TO WF GRAB */
         L     @04,RSIOTBL(,REG6)                                  1731
         ST    @04,RSGRABCU(,REG6)                                 1731
*        GRABAFLS = OFF;               /* SET GRAB I/O ERR FLAGS OFF */
         MVI   GRABAFLS+1(@04),X'00'                               1732
         MVI   GRABAFLS(@04),B'00000000'                           1732
*        RSRENEXT = RSREASS;           /* SET NEXT REASSIGN RECORD   */
         L     @04,RSREASS(,REG6)                                  1733
         ST    @04,RSRENEXT(,REG6)                                 1733
*                                      /* RRN = 1ST RRN              */
*        RSRENRR = OFF;                                            1734
         NI    RSRENRR(REG6),B'10111111'                           1734
*        IF RSREARR = ON THEN          /* IF THE 1ST RECORD HAS RRN  */
         TM    RSREARR(REG6),B'10000000'                           1735
         BNO   @RF01735                                            1735
*          RSRENRR = ON;               /* SET NEXT REC TO RRN/NOT CI */
         OI    RSRENRR(REG6),B'01000000'                           1736
*          RSWFBP1 = ADDR (GRABRAB1 -> RABBUF);                    1737
@RF01735 L     @04,RSGRABCU(,REG6)                                 1737
         L     @01,GRABRAB1(,@04)                                  1737
         LA    @15,RABBUF(,@01)                                    1737
         ST    @15,RSWFBP1(,REG6)                                  1737
*          RSWFBP2 = ADDR (GRABRAB2 -> RABBUF);                    1738
*                                                                  1738
         L     @04,GRABRAB2(,@04)                                  1738
         LA    @04,RABBUF(,@04)                                    1738
         ST    @04,RSWFBP2(,REG6)                                  1738
*        /************************************************************/
*        /*                                                          */
*        /* SEQUENTIALLY READ EACH RECORD ON THE REASSIGN CHAIN      */
*        /* UNTIL ALL RECORDS HAVE BEEN READ AND REASSIGNED.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1739
*REASSNLP:                                                         1739
*        DO  WHILE(RSRENEXT ^=0);                                  1739
REASSNLP B     @DE01739                                            1739
@DL01739 DS    0H                                                  1740
*          GRABCURR = GRABRAB1;        /* DEFAULT BUFFER1            */
         L     @04,RSGRABCU(,REG6)                                 1740
         L     @15,GRABRAB1(,@04)                                  1740
         ST    @15,GRABCURR(,@04)                                  1740
*          RABRRN = OFF;               /* SET RAB1 FLAG TO CI        */
         NI    RABRRN(@15),B'11101111'                             1741
*          GRABRAB2 -> RABRRN = OFF;   /* SET RAB2 FLAG TO CI        */
         L     @04,GRABRAB2(,@04)                                  1742
         NI    RABRRN(@04),B'11101111'                             1742
*          RABRCDA = RSRENEXT;         /* SET THE CIN/RRN            */
         L     @04,RSRENEXT(,REG6)                                 1743
         ST    @04,RABRCDA(,@15)                                   1743
*          IF RSRENRR = ON THEN        /* IF THE RECORD HAS RRN SET  */
         TM    RSRENRR(REG6),B'01000000'                           1744
         BNO   @RF01744                                            1744
*            RABRRN = ON;              /* GRAB FLAG TO RRN/NOT CI    */
*                                                                  1745
         OI    RABRRN(@15),B'00010000'                             1745
*          /**********************************************************/
*          /*                                                        */
*          /* GET THE NEXT RECORD FROM THE REASSIGN CHAIN AND USE    */
*          /* IT'S CHAIN POINTER TO POINT TO THE NEXT RECORD.        */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1746
*                                                                  1746
*          DO;                                                     1746
@RF01744 DS    0H                                                  1747
*            RSRTYPE = ''B;                                        1747
         MVI   RSRTYPE(REG6),X'00'                                 1747
*            RSRGET = ON;      /* GETRCD  */                       1748
         OI    RSRGET(REG6),B'10000000'                            1748
*            RSRUPD = ON;      /* UPDATE  */                       1749
         OI    RSRUPD(REG6),B'00001000'                            1749
*            RSRDS = ''B;                                          1750
         NI    RSRDS(REG6),B'00011111'                             1750
*            RSRWF = ON;       /* WORKFILE  */                     1751
*            RSRDIR = ON;      /* DIRECT  */                       1752
*            RSRKEY = ON;      /* KEY  */                          1753
*                                                                  1753
         OI    RSRWF(REG6),B'10010100'                             1753
*          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT           */
*          CALL RECMGMT;                                           1754
         L     @15,@CV03498                                        1754
         BALR  @14,@15                                             1754
*            RFY RTNREG RSTD;                                      1755
*            TESTRC = RTNREG;                                      1756
         STH   RTNREG,TESTRC(,REG6)                                1756
*            RFY RTNREG UNRSTD;                                    1757
*          END;                                                    1758
*                                                                  1758
*          RSRENEXT = RSWCHPTR;        /* SET NEXT REASSIGN RRN FROM */
         L     @04,RSGRABCU(,REG6)                                 1759
         L     @04,GRABCURR(,@04)                                  1759
         L     @15,RSWCHPTR(,@04)                                  1759
         ST    @15,RSRENEXT(,REG6)                                 1759
*                                      /* THE CHAIN POINTER          */
*          RSRENRR = OFF;                                          1760
         NI    RSRENRR(REG6),B'10111111'                           1760
*          IF RSWCHNRR = ON THEN       /* IF CHAIN POINTER IS RRN    */
         TM    RSWCHNRR(@04),B'00000100'                           1761
         BNO   @RF01761                                            1761
*            RSRENRR = ON;             /* SET THE RAB FLAG TO RRN    */
         OI    RSRENRR(REG6),B'01000000'                           1762
*          REASSW1 = OFF;              /* SET THE AVAILABLE SWITCH   */
@RF01761 NI    REASSW1(REG6),B'01111111'                           1763
*          RSAVNEXT = RSAVAIL;         /* SET NEXT AVAIL CIN=1ST CIN */
         L     @04,RSAVAIL(,REG6)                                  1764
         ST    @04,RSAVNEXT(,REG6)                                 1764
*                                                                  1765
*          /**********************************************************/
*          /*                                                        */
*          /* SEARCH THE VALID SECTION OF THE WORK FILE FOR AN       */
*          /* RRN SLOT(CI NUMBER) THAT IS AVAILABLE.                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1765
*REASAVLP:  DO UNTIL REASSW1 = ON;                                 1765
REASAVLP DS    0H                                                  1765
@DL01765 DS    0H                                                  1766
*            GRABCURR = GRABRAB2;      /* DEFAULT BUFFER2            */
         L     @04,RSGRABCU(,REG6)                                 1766
         L     @15,GRABRAB2(,@04)                                  1766
         ST    @15,GRABCURR(,@04)                                  1766
*            RABRCDA = RSAVNEXT;       /* SET THE CIN/RRN            */
*                                                                  1767
*                                                                  1767
         L     @04,RSAVNEXT(,REG6)                                 1767
         ST    @04,RABRCDA(,@15)                                   1767
*            /********************************************************/
*            /*                                                      */
*            /* GET THE NEXT POSSIBLY AVAILABLE RECORD IN THE VALID  */
*            /* WORK SECTION OF THE FILE AND USE IT'S CHAIN POINTER  */
*            /* TO POINT TO THE NEXT AVAILABLE RECORD.               */
*            /*                                                      */
*            /********************************************************/
*                                                                  1768
*                                                                  1768
*            DO;                                                   1768
*              RSRTYPE = ''B;                                      1769
         MVI   RSRTYPE(REG6),X'00'                                 1769
*              RSRGET = ON;      /* GETRCD  */                     1770
         OI    RSRGET(REG6),B'10000000'                            1770
*              RSRUPD = ON;      /* UPDATE  */                     1771
         OI    RSRUPD(REG6),B'00001000'                            1771
*              RSRDS = ''B;                                        1772
         NI    RSRDS(REG6),B'00011111'                             1772
*              RSRWF = ON;       /* WORKFILE  */                   1773
*              RSRDIR = ON;      /* DIRECT  */                     1774
*              RSRKEY = ON;      /* KEY  */                        1775
*                                                                  1775
         OI    RSRWF(REG6),B'10010100'                             1775
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */
*            CALL RECMGMT;                                         1776
         L     @15,@CV03498                                        1776
         BALR  @14,@15                                             1776
*              RFY RTNREG RSTD;                                    1777
*              TESTRC = RTNREG;                                    1778
         STH   RTNREG,TESTRC(,REG6)                                1778
*              RFY RTNREG UNRSTD;                                  1779
*            END;                                                  1780
*                                                                  1780
*            RSAVNEXT = RSWCHPTR;      /* SET THE NEXT AVAILABLE CIN */
         L     @04,RSGRABCU(,REG6)                                 1781
         L     @04,GRABCURR(,@04)                                  1781
         L     @15,RSWCHPTR(,@04)                                  1781
         ST    @15,RSAVNEXT(,REG6)                                 1781
*                                      /* FROM THE CHAIN POINTER     */
*                                                                  1782
*            /********************************************************/
*            /*                                                      */
*            /* IF THE RECORD IS NOT AVAILABLE FREE THE RECORD       */
*            /* AND GET THE NEXT POSSIBLE AVAILABLE RECORD ON THE    */
*            /* AVAILABLE CHAIN.                                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  1782
*            IF RSWFCRA = OFF THEN     /* IF THE RECORD IS NOT FROM  */
         TM    RSWFCRA(@04),B'10000000'                            1782
         BNZ   @RF01782                                            1782
*              REASSW1 = ON;           /* A CRA THE SLOT IS AVAILABLE*/
         OI    REASSW1(REG6),B'10000000'                           1783
*            ELSE                                                  1784
*                                                                  1784
*                                                                  1784
*              DO;                                                 1784
         B     @RC01782                                            1784
@RF01782 DS    0H                                                  1785
*                RSRTYPE = ''B;                                    1785
         MVI   RSRTYPE(REG6),X'00'                                 1785
*                RSRFREE = ON;     /* FREERCD  */                  1786
         OI    RSRFREE(REG6),B'00000001'                           1786
*                RSRUPD = ON;      /* UPDATE  */                   1787
         OI    RSRUPD(REG6),B'00001000'                            1787
*                RSRDS = ''B;                                      1788
         NI    RSRDS(REG6),B'00011111'                             1788
*                RSRWF = ON;       /* WORKFILE  */                 1789
*                RSRDIR = ON;      /* DIRECT  */                   1790
*                RSRKEY = ON;      /* KEY  */                      1791
*                                                                  1791
         OI    RSRWF(REG6),B'10010100'                             1791
*              /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT       */
*              CALL RECMGMT;                                       1792
         L     @15,@CV03498                                        1792
         BALR  @14,@15                                             1792
*                RFY RTNREG RSTD;                                  1793
*                TESTRC = RTNREG;                                  1794
         STH   RTNREG,TESTRC(,REG6)                                1794
*                RFY RTNREG UNRSTD;                                1795
*              END;                                                1796
*                                                                  1796
*          END REASAVLP;                                           1797
@RC01782 DS    0H                                                  1797
@DE01765 TM    REASSW1(REG6),B'10000000'                           1797
         BNO   @DL01765                                            1797
*          /**********************************************************/
*          /*                                                        */
*          /* SET THE 'DUPLICATE CI POINTER' AND THE 'RRN FLAG'      */
*          /* WHICH ARE IN PROCESSING FIELD ONE TO THE VALUE WHICH   */
*          /* IS IN PROCESSING FIELD TWO. MOVE THE RECORD FROM THE   */
*          /* REASSIGN RECORD BUFFER1 TO THE AVAILABLE RECORD        */
*          /* BUFFER2.                                               */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1798
*          RSWDUPTR = GRABRAB1 -> RSWDUPTR;                        1798
         L     @04,RSGRABCU(,REG6)                                 1798
         L     @15,GRABCURR(,@04)                                  1798
         L     @04,GRABRAB1(,@04)                                  1798
         L     @14,RSWDUPTR(,@04)                                  1798
         ST    @14,RSWDUPTR(,@15)                                  1798
*          RSWDUPRR = OFF;                                 /*@ZA18273*/
         NI    RSWDUPRR(@15),B'10111111'                           1799
*          IF GRABRAB1 -> RSWDUPRR = ON THEN                       1800
         TM    RSWDUPRR(@04),B'01000000'                           1800
         BNO   @RF01800                                            1800
*            RSWDUPRR = ON;      /* TRANSFER DUP INDICATOR   @ZA18273*/
         OI    RSWDUPRR(@15),B'01000000'                           1801
*          WFBUF2(1:256) = WFBUF1(1:256);                          1802
@RF01800 L     @04,RSWFBP2(,REG6)                                  1802
         L     @15,RSWFBP1(,REG6)                                  1802
         MVC   WFBUF2(256,@04),WFBUF1(@15)                         1802
*          WFBUF2(257:CELEN) = WFBUF1(257:CELEN);                  1803
*                                                                  1803
         MVC   WFBUF2+256(249,@04),WFBUF1+256(@15)                 1803
*          /**********************************************************/
*          /*                                                        */
*          /* INDICATE IN THE CRA THAT THE RECORD IS REASSIGNED      */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1804
*          RSWFCRA = ON;               /* SET RECORD FROM CRA FLAG   */
*          RSWUPCAT = ON;              /* SET UPDATE CAT FLAG        */
*          RSWDLCAT = OFF;                                         1806
         L     @04,RSGRABCU(,REG6)                                 1806
         L     @01,GRABCURR(,@04)                                  1806
         OI    RSWFCRA(@01),B'10100000'                            1806
         NI    RSWDLCAT(@01),B'10111111'                           1806
*          GRABCURR = GRABRAB2;                                    1807
*                                                                  1807
         L     @15,GRABRAB2(,@04)                                  1807
         ST    @15,GRABCURR(,@04)                                  1807
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR           */
*          CALL ADDUPCR;                                           1808
*                                                                  1808
         L     @15,@CV03636                                        1808
         BALR  @14,@15                                             1808
*          /**********************************************************/
*          /*                                                        */
*          /* PUT THE REASSIGNED RECORD IN THE AVAILABLE SLOT IN     */
*          /* THE WORK FILE                                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1809
*          IF GRABRAB1 -> RSWCHRA = ON THEN                        1809
         L     @04,RSGRABCU(,REG6)                                 1809
         L     @01,GRABRAB1(,@04)                                  1809
         TM    RSWCHRA(@01),B'00000010'                            1809
         BNO   @RF01809                                            1809
*            RSWCHRA = ON;             /* TRANSFER MOVE FLAG @ZA18274*/
         L     @04,GRABCURR(,@04)                                  1810
         OI    RSWCHRA(@04),B'00000010'                            1810
*          RSWRASCI = ON;              /* SET REASSIGNED CI FLAG     */
*                                                                  1811
*                                                                  1811
@RF01809 L     @04,RSGRABCU(,REG6)                                 1811
         L     @04,GRABCURR(,@04)                                  1811
         OI    RSWRASCI(@04),B'00000100'                           1811
*          DO;                                                     1812
*            RSRTYPE = ''B;                                        1813
         MVI   RSRTYPE(REG6),X'00'                                 1813
*            RSRUPDT = ON;     /* UPDRCD  */                       1814
         OI    RSRUPDT(REG6),B'00100000'                           1814
*            RSRUPD = ON;      /* UPDATE  */                       1815
         OI    RSRUPD(REG6),B'00001000'                            1815
*            RSRDS = ''B;                                          1816
         NI    RSRDS(REG6),B'00011111'                             1816
*            RSRWF = ON;       /* WORKFILE  */                     1817
*            RSRDIR = ON;      /* DIRECT  */                       1818
*            RSRKEY = ON;      /* KEY  */                          1819
*                                                                  1819
         OI    RSRWF(REG6),B'10010100'                             1819
*          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT           */
*          CALL RECMGMT;                                           1820
         L     @15,@CV03498                                        1820
         BALR  @14,@15                                             1820
*            RFY RTNREG RSTD;                                      1821
*            TESTRC = RTNREG;                                      1822
         STH   RTNREG,TESTRC(,REG6)                                1822
*            RFY RTNREG UNRSTD;                                    1823
*          END;                                                    1824
*                                                                  1824
*          /**********************************************************/
*          /*                                                        */
*          /* IF THE RECORD WAS ON THE REASSIGN CHAIN BECAUSE IT     */
*          /* WAS A DUPLICATE, SEARCH THE DUPLICATE CHAIN FOR A      */
*          /* RECORD THAT HAS A POINTER WHICH POINTS TO THE RRN OF   */
*          /* THE RECORD JUST REASSIGNED. THEN SET THE DUPLICATE     */
*          /* POINTER OF THE DUPLICATE RECORD JUST FOUND EQUAL TO    */
*          /* THE CI NUMBER OF THE NEWLY REASSIGNED RECORD. IF THE   */
*          /* RECORD WAS INVALID THERE IS NO NEED TO SEARCH THE      */
*          /* DUPLICATE CHAIN AND THE DUPLICATE POINTER IS UPDATED   */
*          /* DIRECTLY.                                              */
*          /**********************************************************/
*                                                                  1825
*          GRABCURR = GRABRAB1;        /* DEFAULT BUFFER1            */
         L     @04,RSGRABCU(,REG6)                                 1825
         L     @15,GRABRAB1(,@04)                                  1825
         ST    @15,GRABCURR(,@04)                                  1825
*          IF RSWINVCI = OFF THEN      /* IS RECORD INVALID OR DUP   */
*                                                                  1826
         TM    RSWINVCI(@15),B'10000000'                           1826
         BNZ   @RF01826                                            1826
*          /**********************************************************/
*          /*                                                        */
*          /* SETUP TO SEARCH THE DUPLICATE CHAIN                    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1827
*            DO;                                                   1827
*                                                                  1827
*                DO;                                               1828
*                  RSRTYPE = ''B;                                  1829
         MVI   RSRTYPE(REG6),X'00'                                 1829
*                  RSRFREE = ON;     /* FREERCD  */                1830
         OI    RSRFREE(REG6),B'00000001'                           1830
*                  RSRUPD = ON;      /* UPDATE  */                 1831
         OI    RSRUPD(REG6),B'00001000'                            1831
*                  RSRDS = ''B;                                    1832
         NI    RSRDS(REG6),B'00011111'                             1832
*                  RSRWF = ON;       /* WORKFILE  */               1833
*                  RSRDIR = ON;      /* DIRECT  */                 1834
*                  RSRKEY = ON;      /* KEY  */                    1835
*                                                                  1835
         OI    RSRWF(REG6),B'10010100'                             1835
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */
*                CALL RECMGMT;                                     1836
         L     @15,@CV03498                                        1836
         BALR  @14,@15                                             1836
*                  RFY RTNREG RSTD;                                1837
*                  TESTRC = RTNREG;                                1838
         STH   RTNREG,TESTRC(,REG6)                                1838
*                  RFY RTNREG UNRSTD;                              1839
*                END;                                              1840
*              REASSW2 = OFF;          /* SET FOUND SWITCH           */
         NI    REASSW2(REG6),B'10111111'                           1841
*              RSCMRR = RABRCDA;       /* SET RRN OF REASSIGNED REC  */
         L     @04,RSGRABCU(,REG6)                                 1842
         L     @04,GRABCURR(,@04)                                  1842
         L     @15,RABRCDA(,@04)                                   1842
         ST    @15,RSCMRR(,REG6)                                   1842
*              RSDUPNXT = RCDCINO;     /* SET 1ST CI NUMBER          */
         L     @04,RCDCINO+7(,@04)                                 1843
         LA    @04,0(,@04)                                         1843
         ST    @04,RSDUPNXT(,REG6)                                 1843
*              RSDUPNRR = OFF;                                     1844
         NI    RSDUPNRR(REG6),B'11011111'                          1844
*            /********************************************************/
*            /*                                                      */
*            /* SEARCH THE DUPLICATE CHAIN FOR THE RECORD THAT       */
*            /* POINTS TO THE RRN OF THE RECORD WHICH WAS REASSIGNED */
*            /*                                                      */
*            /********************************************************/
*                                                                  1845
*REASDULP:     DO  UNTIL REASSW2 = ON;                             1845
REASDULP DS    0H                                                  1845
@DL01845 DS    0H                                                  1846
*                RABRCDA = RSDUPNXT;   /* SET CIN/RRN                */
         L     @04,RSGRABCU(,REG6)                                 1846
         L     @04,GRABCURR(,@04)                                  1846
         L     @15,RSDUPNXT(,REG6)                                 1846
         ST    @15,RABRCDA(,@04)                                   1846
*                RABRRN = OFF;                                     1847
         NI    RABRRN(@04),B'11101111'                             1847
*                IF RSDUPNRR = ON THEN /* NEXT PTR IS RRN NOT CI     */
         TM    RSDUPNRR(REG6),B'00100000'                          1848
         BNO   @RF01848                                            1848
*                  RABRRN = ON;                                    1849
*                                                                  1849
         OI    RABRRN(@04),B'00010000'                             1849
*                /****************************************************/
*                /*                                                  */
*                /* READ THE RECORD ON THE DUPLICATE CHAIN AND FREE  */
*                /* THE RECORD IF IT DOES NOT HAVE THE CORRECT       */
*                /* POINTER.                                         */
*                /****************************************************/
*                                                                  1850
*                                                                  1850
*                DO;                                               1850
@RF01848 DS    0H                                                  1851
*                  RSRTYPE = ''B;                                  1851
         MVI   RSRTYPE(REG6),X'00'                                 1851
*                  RSRGET = ON;      /* GETRCD  */                 1852
         OI    RSRGET(REG6),B'10000000'                            1852
*                  RSRUPD = ON;      /* UPDATE  */                 1853
         OI    RSRUPD(REG6),B'00001000'                            1853
*                  RSRDS = ''B;                                    1854
         NI    RSRDS(REG6),B'00011111'                             1854
*                  RSRWF = ON;       /* WORKFILE  */               1855
*                  RSRDIR = ON;      /* DIRECT  */                 1856
*                  RSRKEY = ON;      /* KEY  */                    1857
*                                                                  1857
         OI    RSRWF(REG6),B'10010100'                             1857
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */
*                CALL RECMGMT;                                     1858
         L     @15,@CV03498                                        1858
         BALR  @14,@15                                             1858
*                  RFY RTNREG RSTD;                                1859
*                  TESTRC = RTNREG;                                1860
         STH   RTNREG,TESTRC(,REG6)                                1860
*                  RFY RTNREG UNRSTD;                              1861
*                END;                                              1862
*                                                                  1862
*                RSDUPNXT = RSWDUPTR;  /* NEXT DUP FROM CHAIN PTR    */
         L     @04,RSGRABCU(,REG6)                                 1863
         L     @04,GRABCURR(,@04)                                  1863
         L     @15,RSWDUPTR(,@04)                                  1863
         ST    @15,RSDUPNXT(,REG6)                                 1863
*                IF RSWDUPRR = ON THEN /* DUP PTR IS RRN NOT CI      */
         TM    RSWDUPRR(@04),B'01000000'                           1864
         BNO   @RF01864                                            1864
*                  DO;                                             1865
*                    RSDUPNRR = ON;    /* SET FLAG TO RRN            */
         OI    RSDUPNRR(REG6),B'00100000'                          1866
*                    IF RSCMRR = RSWDUPTR THEN                     1867
         C     @15,RSCMRR(,REG6)                                   1867
         BNE   @RF01867                                            1867
*                                      /* RRN OF DUPLICATE EQUALS THE*/
*                                      /* RRN OF THE REASSIGNED REC  */
*                      REASSW2 = ON;                               1868
         OI    REASSW2(REG6),B'01000000'                           1868
*                    ELSE                                          1869
*                                                                  1869
*                                                                  1869
*                      DO;                                         1869
         B     @RC01867                                            1869
@RF01867 DS    0H                                                  1870
*                        RSRTYPE = ''B;                            1870
         MVI   RSRTYPE(REG6),X'00'                                 1870
*                        RSRFREE = ON;     /* FREERCD  */          1871
         OI    RSRFREE(REG6),B'00000001'                           1871
*                        RSRUPD = ON;      /* UPDATE  */           1872
         OI    RSRUPD(REG6),B'00001000'                            1872
*                        RSRDS = ''B;                              1873
         NI    RSRDS(REG6),B'00011111'                             1873
*                        RSRWF = ON;       /* WORKFILE  */         1874
*                        RSRDIR = ON;      /* DIRECT  */           1875
*                        RSRKEY = ON;      /* KEY  */              1876
*                                                                  1876
         OI    RSRWF(REG6),B'10010100'                             1876
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                      CALL RECMGMT;                               1877
         L     @15,@CV03498                                        1877
         BALR  @14,@15                                             1877
*                        RFY RTNREG RSTD;                          1878
*                        TESTRC = RTNREG;                          1879
         STH   RTNREG,TESTRC(,REG6)                                1879
*                        RFY RTNREG UNRSTD;                        1880
*                      END;                                        1881
*                                                                  1881
*                  END;                                            1882
*                ELSE                                              1883
*                                                                  1883
*                                                                  1883
*                  DO;                                             1883
         B     @RC01864                                            1883
@RF01864 DS    0H                                                  1884
*                    RSRTYPE = ''B;                                1884
         MVI   RSRTYPE(REG6),X'00'                                 1884
*                    RSRFREE = ON;     /* FREERCD  */              1885
         OI    RSRFREE(REG6),B'00000001'                           1885
*                    RSRUPD = ON;      /* UPDATE  */               1886
         OI    RSRUPD(REG6),B'00001000'                            1886
*                    RSRDS = ''B;                                  1887
         NI    RSRDS(REG6),B'00011111'                             1887
*                    RSRWF = ON;       /* WORKFILE  */             1888
*                    RSRDIR = ON;      /* DIRECT  */               1889
*                    RSRKEY = ON;      /* KEY  */                  1890
*                                                                  1890
         OI    RSRWF(REG6),B'10010100'                             1890
*                  /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT   */
*                  CALL RECMGMT;                                   1891
         L     @15,@CV03498                                        1891
         BALR  @14,@15                                             1891
*                    RFY RTNREG RSTD;                              1892
*                    TESTRC = RTNREG;                              1893
         STH   RTNREG,TESTRC(,REG6)                                1893
*                    RFY RTNREG UNRSTD;                            1894
*                  END;                                            1895
*                                                                  1895
*              END REASDULP;                                       1896
*                                                                  1896
@RC01864 DS    0H                                                  1896
@DE01845 TM    REASSW2(REG6),B'01000000'                           1896
         BNO   @DL01845                                            1896
*              /******************************************************/
*              /*                                                    */
*              /* UPDATE DUPLICATE POINTER OF THE DUPLICATE RECORD   */
*              /* TO POINT TO THE CI OF THE NEWLY REASSIGN RECORD    */
*              /*                                                    */
*              /******************************************************/
*                                                                  1897
*            END;                                                  1897
*          RSWDUPTR = GRABRAB2 -> RABRCDA;                         1898
@RF01826 L     @04,RSGRABCU(,REG6)                                 1898
         L     @15,GRABCURR(,@04)                                  1898
         L     @04,GRABRAB2(,@04)                                  1898
         L     @04,RABRCDA(,@04)                                   1898
         ST    @04,RSWDUPTR(,@15)                                  1898
*                                      /* SET DUPLICATE CI PTR TO    */
*                                      /* THE CI OF THE REASSIGN     */
*          RSWDUPRR = OFF;             /* PTR IS CI NOT RRN          */
*                                                                  1899
         NI    RSWDUPRR(@15),B'10111111'                           1899
*          /**********************************************************/
*          /*                                                        */
*          /* POINT THE DUPLICATE CHAIN RECORD TO THE                */
*          /* REASSIGNED CI                                          */
*          /**********************************************************/
*                                                                  1900
*                                                                  1900
*          DO;                                                     1900
*            RSRTYPE = ''B;                                        1901
         MVI   RSRTYPE(REG6),X'00'                                 1901
*            RSRUPDT = ON;     /* UPDRCD  */                       1902
         OI    RSRUPDT(REG6),B'00100000'                           1902
*            RSRUPD = ON;      /* UPDATE  */                       1903
         OI    RSRUPD(REG6),B'00001000'                            1903
*            RSRDS = ''B;                                          1904
         NI    RSRDS(REG6),B'00011111'                             1904
*            RSRWF = ON;       /* WORKFILE  */                     1905
*            RSRDIR = ON;      /* DIRECT  */                       1906
*            RSRKEY = ON;      /* KEY  */                          1907
*                                                                  1907
         OI    RSRWF(REG6),B'10010100'                             1907
*          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT           */
*          CALL RECMGMT;                                           1908
         L     @15,@CV03498                                        1908
         BALR  @14,@15                                             1908
*            RFY RTNREG RSTD;                                      1909
*            TESTRC = RTNREG;                                      1910
         STH   RTNREG,TESTRC(,REG6)                                1910
*            RFY RTNREG UNRSTD;                                    1911
*          END;                                                    1912
*        END REASSNLP;                                             1913
*                                                                  1913
@DE01739 SLR   @04,@04                                             1913
         C     @04,RSRENEXT(,REG6)                                 1913
         BNE   @DL01739                                            1913
*          /**********************************************************/
*          /*                                                        */
*          /* PROCESSING DONE. SET REASSIGN DONE FLAG.               */
*          /**********************************************************/
*                                                                  1914
*        RSREASND = ON;                                            1914
*                                                                  1914
*                                                                  1914
*                                                                  1914
         OI    RSREASND(REG6),B'00000100'                          1914
*        IF GDTDBG = NULLPTR                                       1915
*          THEN;                                                   1915
         C     @04,GDTDBG(,REG5)                                   1915
         BE    @RT01915                                            1915
*          ELSE                                                    1917
*            CALL IDCDB010 (GDTTBL,'RSR1');                        1917
*                                                                  1917
         ST    REG5,@AL00001                                       1917
         LA    @04,@CC03657                                        1917
         ST    @04,@AL00001+4                                      1917
         MVI   @AL00001+4,X'80'                                    1917
         L     @15,GDTDBG(,REG5)                                   1917
         LA    @01,@AL00001                                        1917
         BALR  @14,@15                                             1917
*   CALL EXIT;  /*TERMINATE*/                                      1918
@RT01915 BAL   @14,EXIT                                            1918
*   END REASSIGN; /*END OF PROCEDURE*/                             1919
@EL00009 DS    0H                                                  1919
@EF00009 DS    0H                                                  1919
@ER00009 BR    @14                                                 1919
@PB00009 DS    0H                                                  1920
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - UPDCAT                                          */
*/*                                                                  */
*/* FUNCTION - UPDATE THE CATALOG FROM THE WORKFILE                  */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   RECORDS ARE ADDED TO AND DELETED FROM THE CATALOG     */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   1920
         DS    0F
NAME0189 DC    CL8'UPDCAT'
*UPDCAT: PROCEDURE                                                 1921
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1921
*                                                                  1921
         B     @PB00010                                            1921
UPDCAT   DS    0H                                                  1922
*      GENERATE REFS(RS01RG08, REG6);                              1922
*                                                                  1922
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0189  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  CATALOG FREE RECORD NEXT FREE CI                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1923
*         DCL RSUPENTF PTR(24) DEF(RCDSIZ);                        1923
*                                                                  1923
*         RFY RESVOL BASED(RSENTPT);                               1924
*                                                                  1924
*         OLDERID2 = NEWERID2;                                     1925
         L     @04,GDTTR2(,REG5)                                   1925
         MVC   @TS00001(95),NEWERID2(@04)                          1925
         MVC   OLDERID2(95,@04),@TS00001                           1925
*         NEWID2 = 'RSUP';                                         1926
*                                                                  1926
         MVC   NEWID2(4,@04),@CC03663                              1926
*         /***********************************************************/
*         /*                                                         */
*         /*  IF ANY VOLUME RECORDS WERE INVALID, CALL CKERR TO      */
*         /*  PRINT MESSAGE(S)                                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1927
*         IF RSBADVOL = ON                                         1927
*           THEN                                                   1927
         TM    RSBADVOL(REG6),B'00000010'                          1927
         BNO   @RF01927                                            1927
*UPCTBVL:     DO;                                                  1928
*                                                                  1928
UPCTBVL  DS    0H                                                  1929
*         /***********************************************************/
*         /*                                                         */
*         /*    OBTAIN EACH RESVOL ENTRY VIA SCNRLST.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1929
*               RSENTPT = ADDR(RSVOLENT);                          1929
*                                                                  1929
         L     @04,RSIOTBL(,REG6)                                  1929
         LA    @04,RSVOLENT(,@04)                                  1929
         ST    @04,RSENTPT(,REG6)                                  1929
*UPCTLP0:       DO UNTIL(RSENTPT = 0);                             1930
*                                                                  1930
UPCTLP0  DS    0H                                                  1930
@DL01930 DS    0H                                                  1931
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST    */
*                 CALL IDCRS5SR('N','B',RSENTPT,NULLPTR);          1931
*                                                                  1931
*                                                                  1931
         MVC   @AL00001(16),@AL01931                               1931
         LA    @04,RSENTPT(,REG6)                                  1931
         ST    @04,@AL00001+8                                      1931
         L     @15,@CV03539                                        1931
         LA    @01,@AL00001                                        1931
         BALR  @14,@15                                             1931
*         /***********************************************************/
*         /*                                                         */
*         /*    THE VOLUME RECORD FOR THIS CRA VOLUME IS INVALID.    */
*         /*    CALL CKERR TO PRINT MESSAGE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1932
*                 IF RSENTPT ^= 0 & RESVLBAD = ON                  1932
*                   THEN                                           1932
*                                                                  1932
         L     @04,RSENTPT(,REG6)                                  1932
         LTR   @04,@04                                             1932
         BZ    @RF01932                                            1932
         TM    RESVLBAD(@04),B'00010000'                           1932
         BNO   @RF01932                                            1932
*                     DO;                                          1933
*                     /*CALL CKERR*/                               1934
*                       RSCKERR = RSCKERR && RSCKERR;              1934
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1934
*                       RSCKERN = RSE047;                          1935
         MVC   RSCKERN(2,REG6),@CH00752                            1935
*                       RSCKTERM = 'RETU';                         1936
         MVC   RSCKTERM(4,REG6),@CC03585                           1936
*                       RSCKMVAR(1) = ADDR(RESVLSER);              1937
*                                                                  1937
         LA    @04,RESVLSER(,@04)                                  1937
         ST    @04,RSCKMVAR(,REG6)                                 1937
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */
*                     CALL CKERR;                                  1938
         L     @15,@CV03544                                        1938
         BALR  @14,@15                                             1938
*                     END;                                         1939
*                                                                  1939
*               END UPCTLP0;                                       1940
*                                                                  1940
@RF01932 DS    0H                                                  1940
@DE01930 L     @04,RSENTPT(,REG6)                                  1940
         LTR   @04,@04                                             1940
         BNZ   @DL01930                                            1940
*         /***********************************************************/
*         /*                                                         */
*         /*    IF NOIGNORE PARAMETER SPECIFIED, CALL CKERR TO       */
*         /*    TERMINATE.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1941
*               IF RSIGNR = OFF                                    1941
*                 THEN                                             1941
*                                                                  1941
*                                                                  1941
         TM    RSIGNR(REG6),B'00000001'                            1941
         BNZ   @RF01941                                            1941
*                   DO;                                            1942
*                   /*CALL CKERR*/                                 1943
*                     RSCKERR = RSCKERR && RSCKERR;                1943
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1943
*                     RSCKERN = RSE048;                            1944
         MVC   RSCKERN(2,REG6),@CH00986                            1944
*                     RSCKTERM = 'TERM';                           1945
*                                                                  1945
         MVC   RSCKTERM(4,REG6),@CC03543                           1945
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */
*                   CALL CKERR;                                    1946
         L     @15,@CV03544                                        1946
         BALR  @14,@15                                             1946
*                   END;                                           1947
*                                                                  1947
*             END UPCTBVL;                                         1948
*                                                                  1948
@RF01941 DS    0H                                                  1949
*         /***********************************************************/
*         /*                                                         */
*         /*  IF ANY OF THE CRAS REQUIRED FOR UPDATE WAS             */
*         /*  UNAVAILABLE, CALL CKERR TO TERMINATE.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1949
*         IF RSCRAUA = ON                                          1949
*           THEN                                                   1949
*                                                                  1949
*                                                                  1949
@RF01927 TM    RSCRAUA(REG6),B'00010000'                           1949
         BNO   @RF01949                                            1949
*             DO;                                                  1950
*             /*CALL CKERR*/                                       1951
*               RSCKERR = RSCKERR && RSCKERR;                      1951
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1951
*               RSCKERN = RSE039;                                  1952
         MVC   RSCKERN(2,REG6),@CH00970                            1952
*               RSCKTERM = 'TERM';                                 1953
*                                                                  1953
         MVC   RSCKTERM(4,REG6),@CC03543                           1953
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          1954
         L     @15,@CV03544                                        1954
         BALR  @14,@15                                             1954
*             END;                                                 1955
*                                                                  1955
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*  IF RECORDS ARE TO BE MOVED FROM THE OLD        @ZA18274*/
*         /*  CATALOG'S CRA TO THE NEW CATALOG'S CRA, THEN   @ZA18274*/
*         /*  OPEN THE NEW CATALOG'S CRA FOR UPDATE.         @ZA18274*/
*         /*  USE THE DDNAME FROM THE RESVOL ENTRY IF        @ZA18274*/
*         /*  FOUND, OTHERWISE USE THE CATALOG DDNAME.       @ZA18274*/
*         /***********************************************************/
*                                                                  1956
*         IF RSCHCRAN ^= 0 THEN DO;                        /*@ZA18274*/
@RF01949 L     @04,RSCHCRAN(,REG6)                                 1956
         LTR   @04,@04                                             1956
         BZ    @RF01956                                            1956
*           RSCRVL = ADDR(RSINVLSR);                       /*@ZA18274*/
         LA    @04,RSINVLSR(,REG6)                                 1958
         ST    @04,RSCRVL(,REG6)                                   1958
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST          */
*           CALL IDCRS5SR('V','B',RSENTPT,RSCRVL);      /*@ZA18274*/
         LA    @04,@CC00833                                        1959
         ST    @04,@AL00001                                        1959
         LA    @04,@CC00815                                        1959
         ST    @04,@AL00001+4                                      1959
         LA    @04,RSENTPT(,REG6)                                  1959
         ST    @04,@AL00001+8                                      1959
         LA    @04,RSCRVL(,REG6)                                   1959
         ST    @04,@AL00001+12                                     1959
         L     @15,@CV03539                                        1959
         LA    @01,@AL00001                                        1959
         BALR  @14,@15                                             1959
*           IF RSENTPT = 0 THEN RSCRADD = RSCADD;          /*@ZA18274*/
         L     @04,RSENTPT(,REG6)                                  1960
         LTR   @04,@04                                             1960
         BNZ   @RF01960                                            1960
         L     @04,RSCADD(,REG6)                                   1961
         ST    @04,RSCRADD(,REG6)                                  1961
*           ELSE RSCRADD = ADDR(RESVLDDN);                 /*@ZA18274*/
         B     @RC01960                                            1962
@RF01960 L     @04,RSENTPT(,REG6)                                  1962
         LA    @04,RESVLDDN(,@04)                                  1962
         ST    @04,RSCRADD(,REG6)                                  1962
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN           */
*           CALL IDCRS6DO('B','R','U',RSCRADD,NULLPTR,RSMRPAS);    1963
@RC01960 MVC   @AL00001(20),@AL01963                               1963
         LA    @04,RSCRADD(,REG6)                                  1963
         ST    @04,@AL00001+12                                     1963
         LA    @04,RSMRPAS(,REG6)                                  1963
         ST    @04,@AL00001+20                                     1963
         L     @15,@CV03580                                        1963
         LA    @01,@AL00001                                        1963
         BALR  @14,@15                                             1963
*           RESPECIFY RTNREG RSTD;                                 1964
*           TESTRC = RTNREG;                                       1965
         STH   RTNREG,TESTRC(,REG6)                                1965
*           RESPECIFY RTNREG UNRSTD;                       /*@ZA18274*/
*           IF TESTRC = RCUERR1 THEN                               1967
         LH    @04,TESTRC(,REG6)                                   1967
         C     @04,@CF00046                                        1967
         BNE   @RF01967                                            1967
*                                     DO;                          1968
*                                     /*CALL CKERR*/               1969
*                                       RSCKERR = RSCKERR && RSCKERR;
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1969
*                                       RSCKERN = RSE079;          1970
         MVC   RSCKERN(2,REG6),@CH01046                            1970
*                                       RSCKTERM = 'TERM';         1971
*                                                                  1971
         MVC   RSCKTERM(4,REG6),@CC03543                           1971
*                                     /* CALL TO MODULE IDCRS05 FOR PRO
*EDURE CKERR                                                         */
*                                     CALL CKERR;                  1972
         L     @15,@CV03544                                        1972
         BALR  @14,@15                                             1972
*                                     END;                         1973
*                                                                  1973
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*  PRINT MESSAGE INDICATING RECORDS MOVED. READ   @ZA18274*/
*         /*  CCR AND VOLUME RECORDS AND SAVE NEEDED INFO.   @ZA18274*/
*         /*                                                 @ZA18274*/
*         /***********************************************************/
*                                                                  1974
*                                                                  1974
*           DO;                                                    1974
@RF01967 DS    0H                                                  1975
*           /*CALL CKERR*/                                         1975
*             RSCKERR = RSCKERR && RSCKERR;                        1975
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1975
*             RSCKERN = RSE046;                                    1976
         MVC   RSCKERN(2,REG6),@CH00983                            1976
*             RSCKTERM = 'RETURN';                                 1977
*                                                                  1977
         MVC   RSCKTERM(4,REG6),@CC03584                           1977
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR            */
*           CALL CKERR;                                            1978
         L     @15,@CV03544                                        1978
         BALR  @14,@15                                             1978
*           END;                     /*@ZA18274*/                  1979
*           RSGRABCU = ADDR(GRABSCR);                      /*@ZA18274*/
         L     @04,RSIOTBL(,REG6)                                  1980
         LA    @04,GRABSCR(,@04)                                   1980
         ST    @04,RSGRABCU(,REG6)                                 1980
*           GRABCURR = GRABRAB2;                           /*@ZA18274*/
         L     @15,GRABRAB2(,@04)                                  1981
         ST    @15,GRABCURR(,@04)                                  1981
*           GRABAFLS = ''B;                                /*@ZA18274*/
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1982
*           GRABSIOT = ON;                                 /*@ZA18274*/
         OI    GRABSIOT(@04),B'00000100'                           1983
*           RABRCDA = CCRCI;                               /*@ZA18274*/
*                                                                  1984
         MVC   RABRCDA(4,@15),@CF00166                             1984
*           DO;                                                    1985
*             RSRTYPE = ''B;                                       1986
         MVI   RSRTYPE(REG6),X'00'                                 1986
*             RSRGET = ON;      /* GETRCD  */                      1987
         OI    RSRGET(REG6),B'10000000'                            1987
*             RSRUPD = ON;      /* UPDATE  */                      1988
         OI    RSRUPD(REG6),B'00001000'                            1988
*             RSRDS = ''B;                                         1989
         NI    RSRDS(REG6),B'00011111'                             1989
*             RSRCRA = ON;      /* CRA  */                         1990
*             RSRDIR = ON;      /* DIRECT  */                      1991
*             RSRKEY = OFF;     /* CNV  */                         1992
*                                                                  1992
         OI    RSRCRA(REG6),B'00100100'                            1992
         NI    RSRKEY(REG6),B'11101111'                            1992
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */
*           CALL RECMGMT;                                          1993
         L     @15,@CV03498                                        1993
         BALR  @14,@15                                             1993
*             RFY RTNREG RSTD;                                     1994
*             TESTRC = RTNREG;                                     1995
         STH   RTNREG,TESTRC(,REG6)                                1995
*             RFY RTNREG UNRSTD;                                   1996
*           END;              /*@ZA18274*/                         1997
*           GRABCURR = GRABRAB1;                           /*@ZA18274*/
         L     @04,RSGRABCU(,REG6)                                 1998
         L     @15,GRABRAB1(,@04)                                  1998
         ST    @15,GRABCURR(,@04)                                  1998
*           RABRCDA = VOLCI;                               /*@ZA18274*/
*                                                                  1999
         MVC   RABRCDA(4,@15),@CF00040                             1999
*           DO;                                                    2000
*             RSRTYPE = ''B;                                       2001
         MVI   RSRTYPE(REG6),X'00'                                 2001
*             RSRGET = ON;      /* GETRCD  */                      2002
         OI    RSRGET(REG6),B'10000000'                            2002
*             RSRUPD = OFF;     /* NO UPDATE  */                   2003
         NI    RSRUPD(REG6),B'11110111'                            2003
*             RSRDS = ''B;                                         2004
         NI    RSRDS(REG6),B'00011111'                             2004
*             RSRCRA = ON;      /* CRA  */                         2005
*             RSRDIR = ON;      /* DIRECT  */                      2006
*             RSRKEY = OFF;     /* CNV  */                         2007
*                                                                  2007
         OI    RSRCRA(REG6),B'00100100'                            2007
         NI    RSRKEY(REG6),B'11101111'                            2007
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */
*           CALL RECMGMT;                                          2008
         L     @15,@CV03498                                        2008
         BALR  @14,@15                                             2008
*             RFY RTNREG RSTD;                                     2009
*             TESTRC = RTNREG;                                     2010
         STH   RTNREG,TESTRC(,REG6)                                2010
*             RFY RTNREG UNRSTD;                                   2011
*           END;              /*@ZA18274*/                         2012
*           RSNCVLSR = RCDCRAVL;                           /*@ZA18274*/
         L     @04,RSGRABCU(,REG6)                                 2013
         LA    @15,8                                               2013
         AL    @15,GRABCURR(,@04)                                  2013
         MVC   RSNCVLSR(6,REG6),RCDCRAVL(@15)                      2013
*           RSNCDEVT = RCDCRADT;                           /*@ZA18274*/
         MVC   RSNCDEVT(4,REG6),RCDCRADT(@15)                      2014
*           RSNCTS   = RCDRACTS;                           /*@ZA18274*/
         MVC   RSNCTS(4,REG6),RCDRACTS(@15)                        2015
*         END;                                             /*@ZA18274*/
*                                                          /*@ZA18274*/
*                                                                  2017
*         /***********************************************************/
*         /*                                                         */
*         /*  SET RECMGMT BUFFER POINTERS FOR WORKFILE AND           */
*         /*  CATALOG.                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2017
*         RSGRABCU = ADDR(GRABSCA);                                2017
@RF01956 L     @04,RSIOTBL(,REG6)                                  2017
         LA    @15,GRABSCA(,@04)                                   2017
         ST    @15,RSGRABCU(,REG6)                                 2017
*         GRABCURR = GRABRAB1;                                     2018
         L     @14,GRABRAB1(,@15)                                  2018
         ST    @14,GRABCURR(,@15)                                  2018
*         RSCABLP1 = ADDR(RABBUF);                                 2019
*                                                                  2019
         LA    @15,RABBUF(,@14)                                    2019
         ST    @15,RSCABLP1(,REG6)                                 2019
*         RSGRABCU = ADDR(GRABSWF);                                2020
         ST    @04,RSGRABCU(,REG6)                                 2020
*         GRABCURR = GRABRAB1;                                     2021
         L     @15,GRABRAB1(,@04)                                  2021
         ST    @15,GRABCURR(,@04)                                  2021
*         RSWFBP1 = ADDR(RABBUF);                                  2022
         LA    @15,RABBUF(,@15)                                    2022
         ST    @15,RSWFBP1(,REG6)                                  2022
*         GRABAFLS = ''B;                                          2023
*                                                                  2023
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       2023
*         /***********************************************************/
*         /*                                                         */
*         /*    INITIALIZE DELETED FREE COUNT AND FIRST              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2024
*         RSAVAIL = 0;                                             2024
         SLR   @04,@04                                             2024
         ST    @04,RSAVAIL(,REG6)                                  2024
*         RSAVAILN = 0;                                            2025
*                                                                  2025
         ST    @04,RSAVAILN(,REG6)                                 2025
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS CURRENT CATALOG EXTENTS IN WORKFILE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2026
*UPCTLP1: DO RSIDX = 1 TO DIM(RSXCIENT)                            2026
*             WHILE (RSXCIBEG(RSIDX) < RSCAFUCI);                  2026
*                                                                  2026
UPCTLP1  LA    @04,1                                               2026
         STH   @04,RSIDX(,REG6)                                    2026
@DL02026 LH    @04,RSIDX(,REG6)                                    2026
         SLA   @04,4                                               2026
         L     @15,RSCIXLTA(,REG6)                                 2026
         LA    @01,0(@04,@15)                                      2026
         AL    @01,@CF03776                                        2026
         L     @14,RSXCIBEG-8(,@01)                                2026
         C     @14,RSCAFUCI(,REG6)                                 2026
         BNL   @DC02026                                            2026
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS LOW KEY RANGE EXTENTS IN WORKFILE. HIGH KEY    */
*         /*  RANGE EXTENTS ARE IGNORED.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2027
*           IF RSXCIRNG(RSIDX) = OFF                               2027
*             THEN                                                 2027
         ALR   @15,@04                                             2027
         TM    RSXCIRNG-16(@15),B'10000000'                        2027
         BNZ   @RF02027                                            2027
*UPCTLKR:       DO;                                                2028
*                                                                  2028
UPCTLKR  DS    0H                                                  2029
*         /***********************************************************/
*         /*                                                         */
*         /*    COMPUTE ENDING CI AND RRN FOR THIS EXTENT.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2029
*                 RSXCIEND = RSXCIBEG(RSIDX) + RSXCILN(RSIDX) - 1; 2029
*                                                                  2029
         LH    @04,RSIDX(,REG6)                                    2029
         SLA   @04,4                                               2029
         L     @15,RSCIXLTA(,REG6)                                 2029
         LA    @01,0(@04,@15)                                      2029
         AL    @01,@CF03776                                        2029
         L     @14,RSXCIBEG-8(,@01)                                2029
         AL    @15,@CF03777                                        2029
         AL    @14,RSXCILN-12(@04,@15)                             2029
         BCTR  @14,0                                               2029
         ST    @14,RSXCIEND(,REG6)                                 2029
*         /***********************************************************/
*         /*                                                         */
*         /*    IF FIRST UNFORMATTED CI IS IN THIS EXTENT,           */
*         /*    PROCESS UP TO LAST FORMATTED RECORD.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2030
*                 IF RSXCIEND => RSCAFUCI                          2030
*                   THEN                                           2030
         L     @04,RSCAFUCI(,REG6)                                 2030
         CR    @14,@04                                             2030
         BL    @RF02030                                            2030
*                     RSXCIEND = RSCAFUCI - 1;                     2031
*                                                                  2031
         BCTR  @04,0                                               2031
         ST    @04,RSXCIEND(,REG6)                                 2031
*                 RSXRREND = RSXCIEND + RSXCIREL(RSIDX);           2032
*                                                                  2032
@RF02030 LH    @04,RSIDX(,REG6)                                    2032
         SLA   @04,4                                               2032
         L     @15,RSCIXLTA(,REG6)                                 2032
         L     @14,RSXCIREL-16(@04,@15)                            2032
         L     @03,RSXCIEND(,REG6)                                 2032
         ALR   @03,@14                                             2032
         ST    @03,RSXRREND(,REG6)                                 2032
*         /***********************************************************/
*         /*                                                         */
*         /*    POSITION TO FIRST RECORD IN WORKFILE FOR THIS        */
*         /*    EXTENT VIA RECMGMT.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2033
*                 RSGRABCU = ADDR(GRABSWF);                        2033
         L     @03,RSIOTBL(,REG6)                                  2033
         ST    @03,RSGRABCU(,REG6)                                 2033
*                 RABRCDA = RSXCIBEG(RSIDX) + RSXCIREL(RSIDX);     2034
         L     @02,GRABCURR(,@03)                                  2034
         AL    @15,@CF03776                                        2034
         AL    @14,RSXCIBEG-8(@04,@15)                             2034
         ST    @14,RABRCDA(,@02)                                   2034
*                 RABRRN = ON;                                     2035
         OI    RABRRN(@02),B'00010000'                             2035
*                 GRABAFLS = ''B;                                  2036
*                                                                  2036
*                                                                  2036
         XC    GRABAFLS(2,@03),GRABAFLS(@03)                       2036
*                 DO;                                              2037
*                   RSRTYPE = ''B;                                 2038
         MVI   RSRTYPE(REG6),X'00'                                 2038
*                   RSRPOS = ON;      /* POSRCD  */                2039
         OI    RSRPOS(REG6),B'00010000'                            2039
*                   RSRDS = ''B;                                   2040
         NI    RSRDS(REG6),B'00011111'                             2040
*                   RSRWF = ON;       /* WORKFILE  */              2041
*                   RSRDIR = OFF;     /* SEQUENTIAL  */            2042
*                   RSRKEY = ON;      /* KEY  */                   2043
*                                                                  2043
         OI    RSRWF(REG6),B'10010000'                             2043
         NI    RSRDIR(REG6),B'11111011'                            2043
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT    */
*                 CALL RECMGMT;                                    2044
         L     @15,@CV03498                                        2044
         BALR  @14,@15                                             2044
*                   RFY RTNREG RSTD;                               2045
*                   TESTRC = RTNREG;                               2046
         STH   RTNREG,TESTRC(,REG6)                                2046
*                   RFY RTNREG UNRSTD;                             2047
*                 END;                                             2048
*                                                                  2048
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS VALID LOW KEY RANGE RECORDS FROM WORKFILE    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2049
*UPCTLP2:         DO UNTIL (RABRCDA = RSXRREND);                   2049
*                                                                  2049
UPCTLP2  DS    0H                                                  2049
@DL02049 DS    0H                                                  2050
*                 RSUCTWWF = OFF;                                  2050
*                                                                  2050
         NI    RSUCTWWF(REG6),B'11111101'                          2050
*         /***********************************************************/
*         /*                                                         */
*         /*    READ WORKFILE LKR RECORD VIA RECMGMT.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2051
*                   RSGRABCU = ADDR(GRABSWF);                      2051
*                                                                  2051
*                                                                  2051
         L     @04,RSIOTBL(,REG6)                                  2051
         ST    @04,RSGRABCU(,REG6)                                 2051
*                   DO;                                            2052
*                     RSRTYPE = ''B;                               2053
         MVI   RSRTYPE(REG6),X'00'                                 2053
*                     RSRGET = ON;      /* GETRCD  */              2054
         OI    RSRGET(REG6),B'10000000'                            2054
*                     RSRUPD = ON;      /* UPDATE  */              2055
         OI    RSRUPD(REG6),B'00001000'                            2055
*                     RSRDS = ''B;                                 2056
         NI    RSRDS(REG6),B'00011111'                             2056
*                     RSRWF = ON;       /* WORKFILE  */            2057
*                     RSRDIR = OFF;     /* SEQUENTIAL  */          2058
*                     RSRKEY = ON;      /* KEY  */                 2059
*                                                                  2059
         OI    RSRWF(REG6),B'10010000'                             2059
         NI    RSRDIR(REG6),B'11111011'                            2059
*                   /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  */
*                   CALL RECMGMT;                                  2060
         L     @15,@CV03498                                        2060
         BALR  @14,@15                                             2060
*                     RFY RTNREG RSTD;                             2061
*                     TESTRC = RTNREG;                             2062
         STH   RTNREG,TESTRC(,REG6)                                2062
*                     RFY RTNREG UNRSTD;                           2063
*                   END;                                           2064
*                                                                  2064
*                   RESPECIFY RTNREG RSTD;                         2065
*                   TESTRC = RTNREG;                               2066
         STH   RTNREG,TESTRC(,REG6)                                2066
*                   RESPECIFY RTNREG UNRSTD;                       2067
*                                                                  2067
*         /***********************************************************/
*         /*                                                         */
*         /*    IF END OF FILE WAS REACHED IN WORKFILE, CALL         */
*         /*    CKERR TO TERMINATE.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2068
*                   IF TESTRC = RCEOF                              2068
*                     THEN                                         2068
*                                                                  2068
*                                                                  2068
         LH    @04,TESTRC(,REG6)                                   2068
         C     @04,@CF00478                                        2068
         BNE   @RF02068                                            2068
*                       DO;                                        2069
*                       /*CALL CKERR*/                             2070
*                         RSCKERR = RSCKERR && RSCKERR;            2070
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2070
*                         RSCKERN = RSE100;                        2071
         MVC   RSCKERN(2,REG6),@CH00151                            2071
*                         RSCKTERM = 'TERM';                       2072
*                                                                  2072
         MVC   RSCKTERM(4,REG6),@CC03543                           2072
*                       /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR*/
*                       CALL CKERR;                                2073
         L     @15,@CV03544                                        2073
         BALR  @14,@15                                             2073
*                       END;                                       2074
*                                                                  2074
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CI IN WORKFILE RECORD IS NOT CORRECT, UPDATE IT.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2075
*                   RSCURCI = RABRCDA - RSXCIREL(RSIDX);           2075
@RF02068 L     @04,RSGRABCU(,REG6)                                 2075
         L     @04,GRABCURR(,@04)                                  2075
         LH    @15,RSIDX(,REG6)                                    2075
         SLA   @15,4                                               2075
         L     @01,RSCIXLTA(,REG6)                                 2075
         L     @14,RABRCDA(,@04)                                   2075
         SL    @14,RSXCIREL-16(@15,@01)                            2075
         ST    @14,RSCURCI(,REG6)                                  2075
*                   IF RSCURCI ^= RCDCINO                          2076
*                     THEN                                         2076
         AL    @04,@CF00035                                        2076
         L     @15,RCDCINO-1(,@04)                                 2076
         LA    @15,0(,@15)                                         2076
         CR    @14,@15                                             2076
         BE    @RF02076                                            2076
*                       DO;                                        2077
*                         RCDCINO = RSCURCI;                       2078
         STCM  @14,7,RCDCINO(@04)                                  2078
*                         RSUCTWWF = ON;                           2079
         OI    RSUCTWWF(REG6),B'00000010'                          2079
*                       END;                                       2080
*                                                                  2080
*         /***********************************************************/
*         /*                                                         */
*         /*    RECORD MUST BE UPDATED IN THE CATALOG.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2081
*                   IF (RSWUPCAT = ON & RSWINVCI = OFF)           2081
*                       RSWDLCAT = ON                             2081
*                       RCDID = FREEID                             2081
*                     THEN                                         2081
@RF02076 L     @04,RSGRABCU(,REG6)                                 2081
         L     @04,GRABCURR(,@04)                                  2081
         TM    RSWUPCAT(@04),B'00100000'                           2081
         BNO   @GL00023                                            2081
         TM    RSWINVCI(@04),B'10000000'                           2081
         BZ    @RT02081                                            2081
@GL00023 L     @04,RSGRABCU(,REG6)                                 2081
         L     @04,GRABCURR(,@04)                                  2081
         TM    RSWDLCAT(@04),B'01000000'                           2081
         BO    @RT02081                                            2081
         CLI   RCDID+8(@04),C'F'                                   2081
         BNE   @RF02081                                            2081
@RT02081 DS    0H                                                  2082
*UPCTRP:                DO;                                        2082
*                                                                  2082
UPCTRP   DS    0H                                                  2083
*                         RSGRABCU = ADDR(GRABSCA);                2083
         L     @04,RSIOTBL(,REG6)                                  2083
         LA    @15,GRABSCA(,@04)                                   2083
         ST    @15,RSGRABCU(,REG6)                                 2083
*                         GRABCURR = GRABRAB1;                     2084
         L     @14,GRABRAB1(,@15)                                  2084
         ST    @14,GRABCURR(,@15)                                  2084
*                         GRABAFLS = ''B;                          2085
         XC    GRABAFLS(2,@15),GRABAFLS(@15)                       2085
*                         RABRCDA =                                2086
*                            ADDR(ADDR(GRABSWF) -> GRABCURR ->     2086
*                             RABBUF) -> RCDCINO;                  2086
*                                                                  2086
         L     @04,GRABCURR(,@04)                                  2086
         L     @04,RCDCINO+7(,@04)                                 2086
         LA    @04,0(,@04)                                         2086
         ST    @04,RABRCDA(,@14)                                   2086
*         /***********************************************************/
*         /*                                                         */
*         /*    THE CATALOG RECORD DOES NOT EXIST, OR IF IT DOES     */
*         /*    EXIST, IT DOES NOT HAVE A TRUE NAME. THEREFORE DO    */
*         /*    NOT READ THE CATALOG RECORD. SET RABADD ON AND       */
*         /*    CLEAR THE CATALOG BUFFER. SET THE RDF,CIDF FIELDS.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2087
*                         IF RSCURCI => RSCANFCI                   2087
*                           THEN                                   2087
         L     @04,RSCURCI(,REG6)                                  2087
         C     @04,RSCANFCI(,REG6)                                 2087
         BL    @RF02087                                            2087
*                             DO;                                  2088
*                               RABADD = ON;                       2089
         OI    RABADD(@14),B'00100000'                             2089
*                               CABUFL1(1:256) = ''B;              2090
         L     @04,RSCABLP1(,REG6)                                 2090
         XC    CABUFL1(256,@04),CABUFL1(@04)                       2090
*                               CABUFL1(257:505) = ''B;            2091
         XC    CABUFL1+256(249,@04),CABUFL1+256(@04)               2091
*                               CABUFL1(506:CILEN) = RDFCIDF;      2092
         MVC   CABUFL1+505(7,@04),RDFCIDF                          2092
*                             END;                                 2093
*                                                                  2093
*         /***********************************************************/
*         /*                                                         */
*         /*    READ THE CATALOG LKR RECORD VIA RECMGMT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2094
*                           ELSE                                   2094
*                                                                  2094
*                                                                  2094
*                             DO;                                  2094
         B     @RC02087                                            2094
@RF02087 DS    0H                                                  2095
*                               RSRTYPE = ''B;                     2095
         MVI   RSRTYPE(REG6),X'00'                                 2095
*                               RSRGET = ON;      /* GETRCD  */    2096
         OI    RSRGET(REG6),B'10000000'                            2096
*                               RSRUPD = ON;      /* UPDATE  */    2097
         OI    RSRUPD(REG6),B'00001000'                            2097
*                               RSRDS = ''B;                       2098
         NI    RSRDS(REG6),B'00011111'                             2098
*                               RSRCAT = ON;      /* CATALOG  */   2099
*                               RSRDIR = ON;      /* DIRECT  */    2100
*                               RSRKEY = OFF;     /* CNV  */       2101
*                                                                  2101
         OI    RSRCAT(REG6),B'01000100'                            2101
         NI    RSRKEY(REG6),B'11101111'                            2101
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R
*CMGMT                                                               */
*                             CALL RECMGMT;                        2102
         L     @15,@CV03498                                        2102
         BALR  @14,@15                                             2102
*                               RFY RTNREG RSTD;                   2103
*                               TESTRC = RTNREG;                   2104
         STH   RTNREG,TESTRC(,REG6)                                2104
*                               RFY RTNREG UNRSTD;                 2105
*                             END;                                 2106
*                                                                  2106
*         /***********************************************************/
*         /*                                                         */
*         /*    ASSOCIATION NOT CHECKED FOR RECORD.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2107
*                         RSGRABCU = ADDR(GRABSWF);                2107
@RC02087 L     @04,RSIOTBL(,REG6)                                  2107
         ST    @04,RSGRABCU(,REG6)                                 2107
*                         IF (RSWFCRA = ON & RSWASSCK = OFF)      2108
*                            RSWDLCAT = ON                         2108
*                           THEN                                   2108
         L     @04,GRABCURR(,@04)                                  2108
         TM    RSWFCRA(@04),B'10000000'                            2108
         BNO   @GL00025                                            2108
         TM    RSWASSCK(@04),B'00000010'                           2108
         BZ    @RT02108                                            2108
@GL00025 L     @04,RSGRABCU(,REG6)                                 2108
         L     @04,GRABCURR(,@04)                                  2108
         TM    RSWDLCAT(@04),B'01000000'                           2108
         BNO   @RF02108                                            2108
@RT02108 DS    0H                                                  2109
*                             DO;                                  2109
*                                                                  2109
*         /***********************************************************/
*         /*                                                         */
*         /*    PREPARE FOR UPDATE CRA PROCESSING VIA ADDUPCR.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2110
*                               IF RSWFCRA = ON                    2110
*                                 THEN                             2110
*                                                                  2110
         L     @04,RSGRABCU(,REG6)                                 2110
         L     @04,GRABCURR(,@04)                                  2110
         TM    RSWFCRA(@04),B'10000000'                            2110
         BNO   @RF02110                                            2110
*                                   /* CALL TO MODULE IDCRS05 FOR PROCE
*URE ADDUPCR                                                         */
*                                   CALL ADDUPCR;                  2111
*                                                                  2111
         L     @15,@CV03636                                        2111
         BALR  @14,@15                                             2111
*         /***********************************************************/
*         /*                                                         */
*         /*   INDICATE FREE RECORD                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2112
*                               RCDID = FREEID;                    2112
*                                                                  2112
@RF02110 L     @04,RSGRABCU(,REG6)                                 2112
         L     @04,GRABCURR(,@04)                                  2112
         MVI   RCDID+8(@04),C'F'                                   2112
*                             END;                                 2113
*                                                                  2113
*         /***********************************************************/
*         /*                                                         */
*         /*  DETERMINE IF CATALOG RECORD HAS A TRUE NAME VIA        */
*         /*  ENTNMCK.                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2114
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE ENTNM
*K                                                                   */
*                         CALL IDCRS5EN('C');                      2114
*                                                                  2114
@RF02108 L     @15,@CV03677                                        2114
         LA    @01,@AL02114                                        2114
         BALR  @14,@15                                             2114
*                         RESPECIFY RTNREG RSTD;                   2115
*                         TESTRC = RTNREG;                         2116
         STH   RTNREG,TESTRC(,REG6)                                2116
*                         RESPECIFY RTNREG UNRSTD;                 2117
*                                                                  2117
*         /***********************************************************/
*         /*                                                         */
*         /*    SET TRUE NAME OR NO TRUE NAME INDICATOR.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2118
*                         IF TESTRC = 0                            2118
*                           THEN                                   2118
         LH    @04,TESTRC(,REG6)                                   2118
         LTR   @04,@04                                             2118
         BNZ   @RF02118                                            2118
*                             DO;                                  2119
*                                                                  2119
*         /***********************************************************/
*         /*                                                         */
*         /*    SAVE TRUE NAME AND CI                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2120
*                               RSGRABCU = ADDR(GRABSCA);          2120
         L     @04,RSIOTBL(,REG6)                                  2120
         LA    @04,GRABSCA(,@04)                                   2120
         ST    @04,RSGRABCU(,REG6)                                 2120
*                               RSUCCATN = ON;                     2121
         OI    RSUCCATN(REG6),B'00001000'                          2121
*                               RSCATTN = CNAME;                   2122
         LA    @15,8                                               2122
         AL    @15,GRABCURR(,@04)                                  2122
         MVC   RSCATTN(44,REG6),CNAME(@15)                         2122
*                               RSCATNCI = RCDCINO;                2123
         MVC   RSCATNCI(3,REG6),RCDCINO(@15)                       2123
*                             END;                                 2124
*                                                                  2124
*                           ELSE                                   2125
*                             RSUCCATN = OFF;                      2125
*                                                                  2125
         B     @RC02118                                            2125
@RF02118 NI    RSUCCATN(REG6),B'11110111'                          2125
*         /***********************************************************/
*         /*                                                         */
*         /*  DETERMINE IF WORKFILE RECORD HAS A TRUE NAME VIA        *
*         /*  ENTNMCK.                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2126
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE ENTNM
*K                                                                   */
*                         CALL IDCRS5EN('W');                      2126
*                                                                  2126
@RC02118 L     @15,@CV03677                                        2126
         LA    @01,@AL02126                                        2126
         BALR  @14,@15                                             2126
*                         RESPECIFY RTNREG RSTD;                   2127
*                         TESTRC = RTNREG;                         2128
         STH   RTNREG,TESTRC(,REG6)                                2128
*                         RESPECIFY RTNREG UNRSTD;                 2129
*                                                                  2129
*         /***********************************************************/
*         /*                                                         */
*         /*    SET TRUE NAME OR NO TRUE NAME INDICATOR.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2130
*                         IF TESTRC = 0                            2130
*                           THEN                                   2130
         LH    @04,TESTRC(,REG6)                                   2130
         LTR   @04,@04                                             2130
         BNZ   @RF02130                                            2130
*                             RSUCWFTN = ON;                       2131
         OI    RSUCWFTN(REG6),B'00000100'                          2131
*                           ELSE                                   2132
*                             RSUCWFTN = OFF;                      2132
*                                                                  2132
         B     @RC02130                                            2132
@RF02130 NI    RSUCWFTN(REG6),B'11111011'                          2132
*         /***********************************************************/
*         /*                                                         */
*         /*    FORMAT A FREE RECORD IN THE CATALOG LKR BUFFER.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2133
*                         RSGRABCU = ADDR(GRABSWF);                2133
@RC02130 L     @04,RSIOTBL(,REG6)                                  2133
         ST    @04,RSGRABCU(,REG6)                                 2133
*                         IF RCDID = FREEID                        2134
*                           THEN                                   2134
         LA    @15,8                                               2134
         L     @14,GRABCURR(,@04)                                  2134
         ALR   @14,@15                                             2134
         CLI   RCDID(@14),C'F'                                     2134
         BNE   @RF02134                                            2134
*                             DO;                                  2135
*                                                                  2135
*         /***********************************************************/
*         /*                                                         */
*         /*    FORMAT A FREE RECORD                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2136
*                               CABUFL1(1:256) = ''B;              2136
         L     @14,RSCABLP1(,REG6)                                 2136
         XC    CABUFL1(256,@14),CABUFL1(@14)                       2136
*                               CABUFL1(257:CELEN) = ''B;          2137
         XC    CABUFL1+256(249,@14),CABUFL1+256(@14)               2137
*                               RSGRABCU = ADDR(GRABSCA);          2138
         LA    @04,GRABSCA(,@04)                                   2138
         ST    @04,RSGRABCU(,REG6)                                 2138
*                               RCDID = FREEID;                    2139
         AL    @15,GRABCURR(,@04)                                  2139
         MVI   RCDID(@15),C'F'                                     2139
*                               RCDCINO = RSCURCI;                 2140
         L     @04,RSCURCI(,REG6)                                  2140
         STCM  @04,7,RCDCINO(@15)                                  2140
*                               RSUPENTF = RSAVAIL;                2141
*                                                                  2141
         MVC   RSUPENTF(3,@15),RSAVAIL+1(REG6)                     2141
*         /***********************************************************/
*         /*                                                         */
*         /*    UPDATE DELETED FREE COUNT AND FIRST FREE             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2142
*                               RSAVAIL = RSCURCI;                 2142
         ST    @04,RSAVAIL(,REG6)                                  2142
*                               RSAVAILN = RSAVAILN + 1;           2143
         LA    @04,1                                               2143
         AL    @04,RSAVAILN(,REG6)                                 2143
         ST    @04,RSAVAILN(,REG6)                                 2143
*                             END;                                 2144
*                                                                  2144
*         /***********************************************************/
*         /*                                                         */
*         /*    MOVE WORKFILE RECORD TO CATALOG LKR BUFFER           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2145
*                           ELSE                                   2145
*                             DO;                                  2145
         B     @RC02134                                            2145
@RF02134 DS    0H                                                  2146
*                               CABUFL1(1:256) = WFBUF1(1:256);    2146
         L     @04,RSCABLP1(,REG6)                                 2146
         L     @15,RSWFBP1(,REG6)                                  2146
         MVC   CABUFL1(256,@04),WFBUF1(@15)                        2146
*                               CABUFL1(257:CELEN) = WFBUF1(257:CELEN);
         MVC   CABUFL1+256(249,@04),WFBUF1+256(@15)                2147
*                             END;                                 2148
*                                                                  2148
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*    IF THE MOVE TO NEW CRA INDICATOR IS ON,      @ZA18274*/
*         /*    FIND THE NEXT AVAILABLE CI IN THE NEW        @ZA18274*/
*         /*    CATALOG'S CRA AND WRITE THE CRA RECORD WITH  @ZA18274*/
*         /*    UPDATE CRA INFORMATION TO THAT CI IN THE     @ZA18274*/
*         /*    CRA. UPDATE THE CRA INFORMATION IN THE       @ZA18274*/
*         /*    CATALOG BUFFER, ALSO, AND MAKE THE RECORD    @ZA18274*/
*         /*    IN THE WORKFILE A 'FREE' RECORD.             @ZA18274*/
*         /*                                                 @ZA18274*/
*         /***********************************************************/
*                                                                  2149
*                         RSGRABCU = ADDR(GRABSWF);        /*@ZA18274*/
@RC02134 L     @04,RSIOTBL(,REG6)                                  2149
         ST    @04,RSGRABCU(,REG6)                                 2149
*                         IF RSWCHRA = ON & RCDID ^= FREEID        2150
*                           THEN DO;                       /*@ZA18274*/
         L     @15,GRABCURR(,@04)                                  2150
         TM    RSWCHRA(@15),B'00000010'                            2150
         BNO   @RF02150                                            2150
         LA    @14,8                                               2150
         LR    @03,@15                                             2150
         ALR   @03,@14                                             2150
         CLI   RCDID(@03),C'F'                                     2150
         BE    @RF02150                                            2150
*                           RSWUPCRA = ON;                 /*@ZA18274*/
         OI    RSWUPCRA(@15),B'00010000'                           2152
*                           RCDID = FREEID;                /*@ZA18274*/
         MVI   RCDID(@03),C'F'                                     2153
*                           RSGRABCU = ADDR(GRABSCA);      /*@ZA18274*/
         LA    @15,GRABSCA(,@04)                                   2154
         ST    @15,RSGRABCU(,REG6)                                 2154
*                           RCDCRAVL = RSNCVLSR;           /*@ZA18274*/
         L     @15,GRABCURR(,@15)                                  2155
         ALR   @15,@14                                             2155
         MVC   RCDCRAVL(6,@15),RSNCVLSR(REG6)                      2155
*                           RCDCRADT = RSNCDEVT;           /*@ZA18274*/
         MVC   RCDCRADT(4,@15),RSNCDEVT(REG6)                      2156
*                           RCDRACTS = RSNCTS;             /*@ZA18274*/
         MVC   RCDRACTS(4,@15),RSNCTS(REG6)                        2157
*                           RFY CCR BASED(RSCRBP1);        /*@ZA18274*/
*                           RSGRABCU = ADDR(GRABSCR);      /*@ZA18274*/
         LA    @15,GRABSCR(,@04)                                   2159
         ST    @15,RSGRABCU(,REG6)                                 2159
*                           GRABCURR = GRABRAB2;           /*@ZA18274*/
         L     @03,GRABRAB2(,@15)                                  2160
         ST    @03,GRABCURR(,@15)                                  2160
*                           RSCRBP1 = ADDR(RABBUF);        /*@ZA18274*/
         LA    @03,RABBUF(,@03)                                    2161
         ST    @03,RSCRBP1(,REG6)                                  2161
*                           GRABCURR = GRABRAB1;           /*@ZA18274*/
         L     @02,GRABRAB1(,@15)                                  2162
         ST    @02,GRABCURR(,@15)                                  2162
*                           IF CCRCDCI ^= 0 THEN DO;       /*@ZA18274*/
         ICM   @15,7,CCRCDCI(@03)                                  2163
         BZ    @RF02163                                            2163
*                             ADDR(ADDR(GRABSCA) -> GRABCURR -> RABBUF)
*                              -> RCDCRACI = CCRFDCI;      /*@ZA18274*/
         AL    @14,GRABCURR+40(,@04)                               2165
         SLR   @04,@04                                             2165
         ICM   @04,7,CCRFDCI(@03)                                  2165
         STCM  @04,7,RCDCRACI(@14)                                 2165
*                             RABRCDA = CCRFDCI;           /*@ZA18274*/
*                                                                  2166
         ST    @04,RABRCDA(,@02)                                   2166
*                             DO;                                  2167
*                               RSRTYPE = ''B;                     2168
         MVI   RSRTYPE(REG6),X'00'                                 2168
*                               RSRGET = ON;      /* GETRCD  */    2169
         OI    RSRGET(REG6),B'10000000'                            2169
*                               RSRUPD = ON;      /* UPDATE  */    2170
         OI    RSRUPD(REG6),B'00001000'                            2170
*                               RSRDS = ''B;                       2171
         NI    RSRDS(REG6),B'00011111'                             2171
*                               RSRCRA = ON;      /* CRA  */       2172
*                               RSRDIR = ON;      /* DIRECT  */    2173
*                               RSRKEY = OFF;     /* CNV  */       2174
*                                                                  2174
         OI    RSRCRA(REG6),B'00100100'                            2174
         NI    RSRKEY(REG6),B'11101111'                            2174
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R
*CMGMT                                                               */
*                             CALL RECMGMT;                        2175
         L     @15,@CV03498                                        2175
         BALR  @14,@15                                             2175
*                               RFY RTNREG RSTD;                   2176
*                               TESTRC = RTNREG;                   2177
         STH   RTNREG,TESTRC(,REG6)                                2177
*                               RFY RTNREG UNRSTD;                 2178
*                             END;                                 2179
*                             CCRFDCI = RSUPENTF;          /*@ZA18274*/
         L     @04,RSCRBP1(,REG6)                                  2180
         L     @01,RSGRABCU(,REG6)                                 2180
         L     @01,GRABCURR(,@01)                                  2180
         MVC   CCRFDCI(3,@04),RSUPENTF+8(@01)                      2180
*                             CCRCDCI = CCRCDCI - 1;       /*@ZA18274*/
         SLR   @15,@15                                             2181
         ICM   @15,7,CCRCDCI(@04)                                  2181
         BCTR  @15,0                                               2181
         STCM  @15,7,CCRCDCI(@04)                                  2181
*                           END;                           /*@ZA18274*/
*                           ELSE DO;                       /*@ZA18274*/
         B     @RC02163                                            2183
@RF02163 DS    0H                                                  2184
*                             ADDR(ADDR(GRABSCA) -> GRABCURR -> RABBUF)
*                              -> RCDCRACI = CCRNFCI;      /*@ZA18274*/
         L     @04,RSIOTBL(,REG6)                                  2184
         L     @04,GRABCURR+40(,@04)                               2184
         L     @15,RSCRBP1(,REG6)                                  2184
         SLR   @14,@14                                             2184
         ICM   @14,7,CCRNFCI(@15)                                  2184
         STCM  @14,7,RCDCRACI+8(@04)                               2184
*                             RABRCDA = CCRNFCI;           /*@ZA18274*/
         L     @04,RSGRABCU(,REG6)                                 2185
         L     @04,GRABCURR(,@04)                                  2185
         ST    @14,RABRCDA(,@04)                                   2185
*                             CCRNFCI = CCRNFCI + 1;       /*@ZA18274*/
         AL    @14,@CF00219                                        2186
         STCM  @14,7,CCRNFCI(@15)                                  2186
*                             RABADD = ON;                 /*@ZA18274*/
         OI    RABADD(@04),B'00100000'                             2187
*                           END;                           /*@ZA18274*/
*                           RFY CCR;                       /*@ZA18274*/
@RC02163 DS    0H                                                  2190
*                           RSCRBP1 = ADDR(RABBUF);        /*@ZA18274*/
         L     @04,RSGRABCU(,REG6)                                 2190
         L     @04,GRABCURR(,@04)                                  2190
         LA    @15,RABBUF(,@04)                                    2190
         ST    @15,RSCRBP1(,REG6)                                  2190
*                           CRBUF1(1:256) = CABUFL1(1:256);/*@ZA18274*/
         L     @14,RSCABLP1(,REG6)                                 2191
         MVC   CRBUF1(256,@15),CABUFL1(@14)                        2191
*                           CRBUF1(257:CELEN) =                    2192
*                            CABUFL1(257:CELEN);           /*@ZA18274*/
         MVC   CRBUF1+256(249,@15),CABUFL1+256(@14)                2192
*                           IF RABADD = ON THEN DO;                2193
         TM    RABADD(@04),B'00100000'                             2193
         BNO   @RF02193                                            2193
*                             CRBUF1(CELEN+1:CILEN) =              2195
*                               CABUFL1(CELEN+1:CILEN);    /*@ZA18274*/
*                                                                  2195
         MVC   CRBUF1+505(7,@15),CABUFL1+505(@14)                  2195
*                             DO;                                  2196
*                               RSRTYPE = ''B;                     2197
         MVI   RSRTYPE(REG6),X'00'                                 2197
*                               RSRADD = ON;      /* ADDRCD  */    2198
         OI    RSRADD(REG6),B'01000000'                            2198
*                               RSRUPD = OFF;     /* NO UPDATE  */ 2199
         NI    RSRUPD(REG6),B'11110111'                            2199
*                               RSRDS = ''B;                       2200
         NI    RSRDS(REG6),B'00011111'                             2200
*                               RSRCRA = ON;      /* CRA  */       2201
*                               RSRDIR = ON;      /* DIRECT  */    2202
*                               RSRKEY = OFF;     /* CNV  */       2203
*                                                                  2203
         OI    RSRCRA(REG6),B'00100100'                            2203
         NI    RSRKEY(REG6),B'11101111'                            2203
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R
*CMGMT                                                               */
*                             CALL RECMGMT;                        2204
         L     @15,@CV03498                                        2204
         BALR  @14,@15                                             2204
*                               RFY RTNREG RSTD;                   2205
*                               TESTRC = RTNREG;                   2206
         STH   RTNREG,TESTRC(,REG6)                                2206
*                               RFY RTNREG UNRSTD;                 2207
*                             END;     /*@ZA18274*/                2208
*                             RABADD = OFF;                /*@ZA18274*/
         L     @04,RSGRABCU(,REG6)                                 2209
         L     @04,GRABCURR(,@04)                                  2209
         NI    RABADD(@04),B'11011111'                             2209
*                           END;                           /*@ZA18274*/
*                           ELSE                                   2211
*                                                                  2211
*                             DO;                                  2211
         B     @RC02193                                            2211
@RF02193 DS    0H                                                  2212
*                               RSRTYPE = ''B;                     2212
         MVI   RSRTYPE(REG6),X'00'                                 2212
*                               RSRUPDT = ON;     /* UPDRCD  */    2213
         OI    RSRUPDT(REG6),B'00100000'                           2213
*                               RSRUPD = ON;      /* UPDATE  */    2214
         OI    RSRUPD(REG6),B'00001000'                            2214
*                               RSRDS = ''B;                       2215
         NI    RSRDS(REG6),B'00011111'                             2215
*                               RSRCRA = ON;      /* CRA  */       2216
*                               RSRDIR = ON;      /* DIRECT  */    2217
*                               RSRKEY = OFF;     /* CNV  */       2218
*                                                                  2218
         OI    RSRCRA(REG6),B'00100100'                            2218
         NI    RSRKEY(REG6),B'11101111'                            2218
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R
*CMGMT                                                               */
*                             CALL RECMGMT;                        2219
         L     @15,@CV03498                                        2219
         BALR  @14,@15                                             2219
*                               RFY RTNREG RSTD;                   2220
*                               TESTRC = RTNREG;                   2221
         STH   RTNREG,TESTRC(,REG6)                                2221
*                               RFY RTNREG UNRSTD;                 2222
*                             END;     /*@ZA18274*/                2223
*                         END;                             /*@ZA18274*/
*                                                                  2224
@RC02193 DS    0H                                                  2225
*         /***********************************************************/
*         /*                                                         */
*         /*    WRITE CATALOG LKR RECORD VIA RECMGMT.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2225
*                         RSGRABCU = ADDR(GRABSCA);                2225
*                                                                  2225
@RF02150 L     @04,RSIOTBL(,REG6)                                  2225
         LA    @04,GRABSCA(,@04)                                   2225
         ST    @04,RSGRABCU(,REG6)                                 2225
*         /***********************************************************/
*         /*                                                         */
*         /*    ATTEMPT TO ADD RECORD TO CATALOG BY KEY. SET GRABS   */
*         /*    FLAG FOR SPECIAL DUPLICATE KEY PROCESSING.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2226
*                         IF RABADD = ON                           2226
*                           THEN                                   2226
         L     @01,GRABCURR(,@04)                                  2226
         TM    RABADD(@01),B'00100000'                             2226
         BNO   @RF02226                                            2226
*                             DO;                                  2227
*                               GRABSDUP = ON;                     2228
*                                                                  2228
*                                                                  2228
         OI    GRABSDUP(@04),B'00000001'                           2228
*                               DO;                                2229
*                                 RSRTYPE = ''B;                   2230
         MVI   RSRTYPE(REG6),X'00'                                 2230
*                                 RSRADD = ON;      /* ADDRCD  */  2231
         OI    RSRADD(REG6),B'01000000'                            2231
*                                 RSRUPD = OFF;     /* NO UPDATE  */
         NI    RSRUPD(REG6),B'11110111'                            2232
*                                 RSRDS = ''B;                     2233
         NI    RSRDS(REG6),B'00011111'                             2233
*                                 RSRCAT = ON;      /* CATALOG  */ 2234
*                                 RSRDIR = OFF;     /* SEQUENTIAL  */
*                                 RSRKEY = ON;      /* KEY  */     2236
*                                                                  2236
         OI    RSRCAT(REG6),B'01010000'                            2236
         NI    RSRDIR(REG6),B'11111011'                            2236
*                               /* CALL TO MODULE IDCRS06 FOR PROCEDURE
*RECMGMT                                                             */
*                               CALL RECMGMT;                      2237
         L     @15,@CV03498                                        2237
         BALR  @14,@15                                             2237
*                                 RFY RTNREG RSTD;                 2238
*                                 TESTRC = RTNREG;                 2239
         STH   RTNREG,TESTRC(,REG6)                                2239
*                                 RFY RTNREG UNRSTD;               2240
*                               END;                               2241
*                                                                  2241
*         /***********************************************************/
*         /*                                                         */
*         /*    IF RECORD WAS A DUPLICATE, UPDATE IT BY CI           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2242
*                               IF RABDUP = ON                     2242
*                                 THEN                             2242
         L     @04,RSGRABCU(,REG6)                                 2242
         L     @04,GRABCURR(,@04)                                  2242
         TM    RABDUP(@04),B'00000001'                             2242
         BNO   @RF02242                                            2242
*                                   DO;                            2243
*                                     RABDUP = OFF;                2244
*                                     RABADD = OFF;                2245
         NI    RABDUP(@04),B'11011110'                             2245
*                                   END;                           2246
*                               GRABSDUP = OFF;                    2247
@RF02242 L     @04,RSGRABCU(,REG6)                                 2247
         NI    GRABSDUP(@04),B'11111110'                           2247
*                             END;                                 2248
*                                                                  2248
*         /***********************************************************/
*         /*                                                         */
*         /*    UPDATE RECORD IN CATALOG BY CI                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2249
*                         IF RABADD = OFF                          2249
*                           THEN                                   2249
*                                                                  2249
*                                                                  2249
@RF02226 L     @04,RSGRABCU(,REG6)                                 2249
         L     @04,GRABCURR(,@04)                                  2249
         TM    RABADD(@04),B'00100000'                             2249
         BNZ   @RF02249                                            2249
*                             DO;                                  2250
*                               RSRTYPE = ''B;                     2251
         MVI   RSRTYPE(REG6),X'00'                                 2251
*                               RSRUPDT = ON;     /* UPDRCD  */    2252
         OI    RSRUPDT(REG6),B'00100000'                           2252
*                               RSRUPD = ON;      /* UPDATE  */    2253
         OI    RSRUPD(REG6),B'00001000'                            2253
*                               RSRDS = ''B;                       2254
         NI    RSRDS(REG6),B'00011111'                             2254
*                               RSRCAT = ON;      /* CATALOG  */   2255
*                               RSRDIR = ON;      /* DIRECT  */    2256
*                               RSRKEY = OFF;     /* CNV  */       2257
*                                                                  2257
         OI    RSRCAT(REG6),B'01000100'                            2257
         NI    RSRKEY(REG6),B'11101111'                            2257
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R
*CMGMT                                                               */
*                             CALL RECMGMT;                        2258
         L     @15,@CV03498                                        2258
         BALR  @14,@15                                             2258
*                               RFY RTNREG RSTD;                   2259
*                               TESTRC = RTNREG;                   2260
         STH   RTNREG,TESTRC(,REG6)                                2260
*                               RFY RTNREG UNRSTD;                 2261
*                             END;                                 2262
*                                                                  2262
*                         RABADD = OFF;                            2263
*                                                                  2263
@RF02249 L     @04,RSGRABCU(,REG6)                                 2263
         L     @04,GRABCURR(,@04)                                  2263
         NI    RABADD(@04),B'11011111'                             2263
*         /***********************************************************/
*         /*                                                         */
*         /*    CHECK FOR NECESSITY OF DELETING AND/OR ADDING        */
*         /*    A TRUE NAME TO THE CATALOG FOR THIS RECORD.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2264
*                         RSUCATN = OFF;                           2264
*                         RSUCDTN = OFF;                           2265
         NI    RSUCATN(REG6),B'11110011'                           2265
*                         RSGRABCU =ADDR(GRABSWF);                 2266
*                                                                  2266
         L     @04,RSIOTBL(,REG6)                                  2266
         ST    @04,RSGRABCU(,REG6)                                 2266
*         /***********************************************************/
*         /*                                                         */
*         /*    IF WORKFILE RECORD HAS A TRUE NAME AND CATALOG       */
*         /*    RECORD DOES NOT, THEN SET ADD TRUE NAME FLAG.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2267
*                         IF RSUCCATN = OFF & RSUCWFTN = ON        2267
*                           THEN                                   2267
         TM    RSUCWFTN(REG6),B'00000100'                          2267
         BNO   @RF02267                                            2267
         TM    RSUCCATN(REG6),B'00001000'                          2267
         BNZ   @RF02267                                            2267
*                             RSUCATN = ON;                        2268
*                                                                  2268
         OI    RSUCATN(REG6),B'00001000'                           2268
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CATALOG RECORD HAS A TRUE NAME AND WORKFILE       */
*         /*    RECORD DOES NOT, THEN SET DELETE TRUE NAME FLAG.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2269
*                         IF RSUCCATN = ON & RSUCWFTN = OFF        2269
*                           THEN                                   2269
@RF02267 TM    RSUCCATN(REG6),B'00001000'                          2269
         BNO   @RF02269                                            2269
         TM    RSUCWFTN(REG6),B'00000100'                          2269
         BNZ   @RF02269                                            2269
*                             RSUCDTN = ON;                        2270
*                                                                  2270
         OI    RSUCDTN(REG6),B'00000100'                           2270
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CATALOG AND WORKFILE RECORDS HAVE DIFFERENT       */
*         /*    TRUE NAMES, THEN SET DELETE TRUE NAME FLAG AND       */
*         /*    ADD TRUE NAME FLAG.                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2271
*                         IF RSUCCATN = ON & RSUCWFTN = ON &       2271
*                             RSCATTN ^= CNAME                     2271
*                           THEN                                   2271
@RF02269 TM    RSUCCATN(REG6),B'00001100'                          2271
         BNO   @RF02271                                            2271
         L     @04,RSGRABCU(,REG6)                                 2271
         L     @04,GRABCURR(,@04)                                  2271
         CLC   RSCATTN(44,REG6),CNAME+8(@04)                       2271
         BE    @RF02271                                            2271
*                             DO;                                  2272
*                               RSUCDTN = ON;                      2273
*                               RSUCATN = ON;                      2274
         OI    RSUCDTN(REG6),B'00001100'                           2274
*                             END;                                 2275
*                                                                  2275
*         /***********************************************************/
*         /*                                                         */
*         /*    DELETE CATALOG RECORD TRUE NAME FROM CATALOG         */
*         /*    VIA DELTN.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2276
*                         IF RSUCDTN = ON                          2276
*                           THEN                                   2276
*                                                                  2276
@RF02271 TM    RSUCDTN(REG6),B'00000100'                           2276
         BNO   @RF02276                                            2276
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE D
*LTN                                                                 */
*                             CALL DELTN;                          2277
*                                                                  2277
         L     @15,@CV03679                                        2277
         BALR  @14,@15                                             2277
*         /***********************************************************/
*         /*                                                         */
*         /*    ATTEMPT TO ADD WORKFILE RECORD TURE NAME TO          */
*         /*    CATALOG VIA ADDTN.                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2278
*                         IF RSUCATN = ON                          2278
*                           THEN                                   2278
@RF02276 TM    RSUCATN(REG6),B'00001000'                           2278
         BNO   @RF02278                                            2278
*                             DO;                                  2279
*                                                                  2279
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*ADDTN                                                               */
*                               CALL ADDTN;                        2280
*                                                                  2280
         L     @15,@CV03680                                        2280
         BALR  @14,@15                                             2280
*                               RESPECIFY RTNREG RSTD;             2281
*                               TESTRC = RTNREG;                   2282
         STH   RTNREG,TESTRC(,REG6)                                2282
*                               RESPECIFY RTNREG UNRSTD;           2283
*                                                                  2283
*         /***********************************************************/
*         /*                                                         */
*         /*    IF TRUE NAME IS A DUPLICATE, PLACE IT ON THE         */
*         /*    ADD TRUE NAME CHAIN.                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2284
*                               IF TESTRC = RCDUP                  2284
*                                 THEN                             2284
         LH    @04,TESTRC(,REG6)                                   2284
         C     @04,@CF00046                                        2284
         BNE   @RF02284                                            2284
*                                   DO;                            2285
*                                     RSWDUPTR = RSTNCHN;          2286
         L     @04,RSGRABCU(,REG6)                                 2286
         L     @04,GRABCURR(,@04)                                  2286
         L     @15,RSTNCHN(,REG6)                                  2286
         ST    @15,RSWDUPTR(,@04)                                  2286
*                                     RSTNCHN = RCDCINO;           2287
         L     @04,RCDCINO+7(,@04)                                 2287
         LA    @04,0(,@04)                                         2287
         ST    @04,RSTNCHN(,REG6)                                  2287
*                                     RSUCTWWF = ON;               2288
         OI    RSUCTWWF(REG6),B'00000010'                          2288
*                                   END;                           2289
*                                                                  2289
*                             END;                                 2290
*                                                                  2290
@RF02284 DS    0H                                                  2291
*         /***********************************************************/
*         /*                                                         */
*         /*    IF RECORD IS TO BE UPDATED IN ITS CRA, PLACE IT ON   */
*         /*    ITS CRA'S UPDATE CHAIN VIA CRAUPCHN.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2291
*                         IF RSWUPCRA = ON                         2291
*                           THEN                                   2291
@RF02278 L     @04,RSGRABCU(,REG6)                                 2291
         L     @04,GRABCURR(,@04)                                  2291
         TM    RSWUPCRA(@04),B'00010000'                           2291
         BNO   @RF02291                                            2291
*                             DO;                                  2292
*                                                                  2292
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE
*CRAUPCHN                                                            */
*                               CALL CRAUPCHN;                     2293
*                                                                  2293
         L     @15,@CV03681                                        2293
         BALR  @14,@15                                             2293
*                               RSUCTWWF = ON;                     2294
         OI    RSUCTWWF(REG6),B'00000010'                          2294
*                             END;                                 2295
*                                                                  2295
*                       END UPCTRP;                                2296
*                                                                  2296
@RF02291 DS    0H                                                  2297
*         /***********************************************************/
*         /*                                                         */
*         /*  WORKFILE RECORD WAS MODIFIED. WRITE RECORD TO WORKFILE */
*         /*  VIA RECMGMT.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2297
*                   IF RSUCTWWF = ON                               2297
*                     THEN                                         2297
*                                                                  2297
*                                                                  2297
*                                                                  2297
@RF02081 TM    RSUCTWWF(REG6),B'00000010'                          2297
         BNO   @RF02297                                            2297
*                           DO;                                    2298
*                             RSRTYPE = ''B;                       2299
         MVI   RSRTYPE(REG6),X'00'                                 2299
*                             RSRUPDT = ON;     /* UPDRCD  */      2300
         OI    RSRUPDT(REG6),B'00100000'                           2300
*                             RSRUPD = ON;      /* UPDATE  */      2301
         OI    RSRUPD(REG6),B'00001000'                            2301
*                             RSRDS = ''B;                         2302
         NI    RSRDS(REG6),B'00011111'                             2302
*                             RSRWF = ON;       /* WORKFILE  */    2303
*                             RSRDIR = OFF;     /* SEQUENTIAL  */  2304
*                             RSRKEY = ON;      /* KEY  */         2305
*                                                                  2305
         OI    RSRWF(REG6),B'10010000'                             2305
         NI    RSRDIR(REG6),B'11111011'                            2305
*                           /* CALL TO MODULE IDCRS06 FOR PROCEDURE REC
*GMT                                                                 */
*                           CALL RECMGMT;                          2306
         L     @15,@CV03498                                        2306
         BALR  @14,@15                                             2306
*                             RFY RTNREG RSTD;                     2307
*                             TESTRC = RTNREG;                     2308
         STH   RTNREG,TESTRC(,REG6)                                2308
*                             RFY RTNREG UNRSTD;                   2309
*                           END;                                   2310
*                                                                  2310
*                 END UPCTLP2;                                     2311
*                                                                  2311
@RF02297 DS    0H                                                  2311
@DE02049 L     @04,RSGRABCU(,REG6)                                 2311
         L     @04,GRABCURR(,@04)                                  2311
         CLC   RABRCDA(4,@04),RSXRREND(REG6)                       2311
         BNE   @DL02049                                            2311
*               END UPCTLKR;                                       2312
*                                                                  2312
*         END UPCTLP1;                                             2313
*                                                                  2313
@RF02027 LA    @04,1                                               2313
         AH    @04,RSIDX(,REG6)                                    2313
         STH   @04,RSIDX(,REG6)                                    2313
         C     @04,@CF01850                                        2313
         BNH   @DL02026                                            2313
@DC02026 DS    0H                                                  2314
*         /***********************************************************/
*         /*                                                         */
*         /*  FORCE A PHYSICAL WRITE OF THE LAST RECORD              */
*         /*  PUT SEQUENTIALLY TO THE WORKFILE, VIA RECMGMT.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2314
*                                                                  2314
*         DO;                                                      2314
*           RSRECREQ = ''B;                                        2315
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     2315
*           RSREND = ON;      /* ENDRCD */                         2316
*                                                                  2316
         OI    RSREND(REG6),B'00000010'                            2316
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            2317
         L     @15,@CV03498                                        2317
         BALR  @14,@15                                             2317
*           RFY RTNREG RSTD;                                       2318
*           TESTRC = RTNREG;                                       2319
         STH   RTNREG,TESTRC(,REG6)                                2319
*           RFY RTNREG UNRSTD;                                     2320
*         END;                                                     2321
*                                                                  2321
*         /***********************************************************/
*         /*                                                         */
*         /*  CIXLT PROCESSING COMPLETED. ADD WORKFILE RECORD        */
*         /*  TRUE NAMES ON TRUE NAME CHAIN TO CATALOG.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2322
*         RSTNNXT = RSTNCHN;                                       2322
*                                                                  2322
         L     @04,RSTNCHN(,REG6)                                  2322
         ST    @04,RSTNNXT(,REG6)                                  2322
*UPCTLP3: DO WHILE (RSTNNXT ^= 0);                                 2323
*                                                                  2323
UPCTLP3  B     @DE02323                                            2323
@DL02323 DS    0H                                                  2324
*         /***********************************************************/
*         /*                                                         */
*         /*    READ WORKFILE RECORD ON TRUE NAME CHAIN VIA RECMGMT. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2324
*           RSGRABCU = ADDR(GRABSWF);                              2324
         L     @04,RSIOTBL(,REG6)                                  2324
         ST    @04,RSGRABCU(,REG6)                                 2324
*           RABRCDA = RSTNNXT;                                     2325
         L     @04,GRABCURR(,@04)                                  2325
         L     @15,RSTNNXT(,REG6)                                  2325
         ST    @15,RABRCDA(,@04)                                   2325
*           RABRRN = OFF;                                          2326
*                                                                  2326
*                                                                  2326
         NI    RABRRN(@04),B'11101111'                             2326
*           DO;                                                    2327
*             RSRTYPE = ''B;                                       2328
         MVI   RSRTYPE(REG6),X'00'                                 2328
*             RSRGET = ON;      /* GETRCD  */                      2329
         OI    RSRGET(REG6),B'10000000'                            2329
*             RSRUPD = ON;      /* UPDATE  */                      2330
         OI    RSRUPD(REG6),B'00001000'                            2330
*             RSRDS = ''B;                                         2331
         NI    RSRDS(REG6),B'00011111'                             2331
*             RSRWF = ON;       /* WORKFILE  */                    2332
*             RSRDIR = ON;      /* DIRECT  */                      2333
*             RSRKEY = ON;      /* KEY  */                         2334
*                                                                  2334
         OI    RSRWF(REG6),B'10010100'                             2334
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */
*           CALL RECMGMT;                                          2335
         L     @15,@CV03498                                        2335
         BALR  @14,@15                                             2335
*             RFY RTNREG RSTD;                                     2336
*             TESTRC = RTNREG;                                     2337
         STH   RTNREG,TESTRC(,REG6)                                2337
*             RFY RTNREG UNRSTD;                                   2338
*           END;                                                   2339
*                                                                  2339
*           RSTNNXT = RSWDUPTR;                                    2340
*                                                                  2340
         L     @04,RSGRABCU(,REG6)                                 2340
         L     @04,GRABCURR(,@04)                                  2340
         L     @04,RSWDUPTR(,@04)                                  2340
         ST    @04,RSTNNXT(,REG6)                                  2340
*         /***********************************************************/
*         /*                                                         */
*         /*    ATTEMPT TO ADD WORKFILE TRUE NAME TO CATALOG         */
*         /*    VIA ADDTN.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2341
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDTN            */
*           CALL ADDTN;                                            2341
*                                                                  2341
         L     @15,@CV03680                                        2341
         BALR  @14,@15                                             2341
*           RESPECIFY RTNREG RSTD;                                 2342
*           TESTRC = RTNREG;                                       2343
         STH   RTNREG,TESTRC(,REG6)                                2343
*           RESPECIFY RTNREG UNRSTD;                               2344
*                                                                  2344
*         /***********************************************************/
*         /*                                                         */
*         /*    IF TRUE NAME IS A DUPLICATE, RENAME IT VIA RENAMEP.  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2345
*           IF TESTRC = RCDUP                                      2345
*             THEN                                                 2345
*                                                                  2345
         LH    @04,TESTRC(,REG6)                                   2345
         C     @04,@CF00046                                        2345
         BNE   @RF02345                                            2345
*               /* CALL TO MODULE IDCRS07 FOR PROCEDURE RENAMEP      */
*               CALL RENAMEP;                                      2346
*                                                                  2346
         L     @15,@CV03684                                        2346
         BALR  @14,@15                                             2346
*         /***********************************************************/
*         /*                                                         */
*         /*  ORIGINAL TRUE NAME ADDED. WORKFILE RECORD DOES NOT     */
*         /*  HAVE TO BE UPDATED, SO FREE IT.                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2347
*             ELSE                                                 2347
*                                                                  2347
*                                                                  2347
*               DO;                                                2347
         B     @RC02345                                            2347
@RF02345 DS    0H                                                  2348
*                 RSRTYPE = ''B;                                   2348
         MVI   RSRTYPE(REG6),X'00'                                 2348
*                 RSRFREE = ON;     /* FREERCD  */                 2349
         OI    RSRFREE(REG6),B'00000001'                           2349
*                 RSRUPD = ON;      /* UPDATE  */                  2350
         OI    RSRUPD(REG6),B'00001000'                            2350
*                 RSRDS = ''B;                                     2351
         NI    RSRDS(REG6),B'00011111'                             2351
*                 RSRWF = ON;       /* WORKFILE  */                2352
*                 RSRDIR = ON;      /* DIRECT  */                  2353
*                 RSRKEY = ON;      /* KEY  */                     2354
*                                                                  2354
         OI    RSRWF(REG6),B'10010100'                             2354
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */
*               CALL RECMGMT;                                      2355
         L     @15,@CV03498                                        2355
         BALR  @14,@15                                             2355
*                 RFY RTNREG RSTD;                                 2356
*                 TESTRC = RTNREG;                                 2357
         STH   RTNREG,TESTRC(,REG6)                                2357
*                 RFY RTNREG UNRSTD;                               2358
*               END;                                               2359
*                                                                  2359
*         END UPCTLP3;                                             2360
*                                                                  2360
@RC02345 DS    0H                                                  2360
@DE02323 L     @04,RSTNNXT(,REG6)                                  2360
         LTR   @04,@04                                             2360
         BNZ   @DL02323                                            2360
*         /***********************************************************/
*         /*                                                         */
*         /*  UPDATE CATALOG CCR RECORD.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2361
*         RSGRABCU = ADDR(GRABSCA);                                2361
         L     @04,RSIOTBL(,REG6)                                  2361
         LA    @04,GRABSCA(,@04)                                   2361
         ST    @04,RSGRABCU(,REG6)                                 2361
*         GRABCURR = GRABRAB1;                                     2362
*                                                                  2362
         L     @15,GRABRAB1(,@04)                                  2362
         ST    @15,GRABCURR(,@04)                                  2362
*         /***********************************************************/
*         /*                                                         */
*         /*    GET CATALOG CCR RECORD VIA RECMGMT.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2363
*         RABRCDA = CCRCI;                                         2363
*                                                                  2363
*                                                                  2363
         MVC   RABRCDA(4,@15),@CF00166                             2363
*         DO;                                                      2364
*           RSRTYPE = ''B;                                         2365
         MVI   RSRTYPE(REG6),X'00'                                 2365
*           RSRGET = ON;      /* GETRCD  */                        2366
         OI    RSRGET(REG6),B'10000000'                            2366
*           RSRUPD = ON;      /* UPDATE  */                        2367
         OI    RSRUPD(REG6),B'00001000'                            2367
*           RSRDS = ''B;                                           2368
         NI    RSRDS(REG6),B'00011111'                             2368
*           RSRCAT = ON;      /* CATALOG  */                       2369
*           RSRDIR = ON;      /* DIRECT  */                        2370
*           RSRKEY = OFF;     /* CNV  */                           2371
*                                                                  2371
         OI    RSRCAT(REG6),B'01000100'                            2371
         NI    RSRKEY(REG6),B'11101111'                            2371
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            2372
         L     @15,@CV03498                                        2372
         BALR  @14,@15                                             2372
*           RFY RTNREG RSTD;                                       2373
*           TESTRC = RTNREG;                                       2374
         STH   RTNREG,TESTRC(,REG6)                                2374
*           RFY RTNREG UNRSTD;                                     2375
*         END;                                                     2376
*                                                                  2376
*         /***********************************************************/
*         /*                                                         */
*         /*    UPDATE CATALOG CCR RECORD FIELDS                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2377
*         CCRNFCI = RSCAFUCI;                                      2377
         L     @04,RSGRABCU(,REG6)                                 2377
         LA    @15,8                                               2377
         AL    @15,GRABCURR(,@04)                                  2377
         MVC   CCRNFCI(3,@15),RSCAFUCI+1(REG6)                     2377
*         CCRCDCI = RSAVAILN;                                      2378
         MVC   CCRCDCI(3,@15),RSAVAILN+1(REG6)                     2378
*         CCRFDCI = RSAVAIL;                                       2379
*                                                                  2379
         MVC   CCRFDCI(3,@15),RSAVAIL+1(REG6)                      2379
*         /***********************************************************/
*         /*                                                         */
*         /*    UPDATE HIGH RBAS IN CATALOG CCR RECORD VIA UPDCCR.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2380
*         /* CALL TO MODULE IDCRS07 FOR PROCEDURE UPDCCR             */
*         CALL UPDCCR;                                             2380
*                                                                  2380
         L     @15,@CV03685                                        2380
         BALR  @14,@15                                             2380
*         /***********************************************************/
*         /*                                                         */
*         /*    WRITE CCR RECORD TO CATALOG VIA RECMGMT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2381
*                                                                  2381
*         DO;                                                      2381
*           RSRTYPE = ''B;                                         2382
         MVI   RSRTYPE(REG6),X'00'                                 2382
*           RSRUPDT = ON;     /* UPDRCD  */                        2383
         OI    RSRUPDT(REG6),B'00100000'                           2383
*           RSRUPD = ON;      /* UPDATE  */                        2384
         OI    RSRUPD(REG6),B'00001000'                            2384
*           RSRDS = ''B;                                           2385
         NI    RSRDS(REG6),B'00011111'                             2385
*           RSRCAT = ON;      /* CATALOG  */                       2386
*           RSRDIR = ON;      /* DIRECT  */                        2387
*           RSRKEY = OFF;     /* CNV  */                           2388
*                                                                  2388
         OI    RSRCAT(REG6),B'01000100'                            2388
         NI    RSRKEY(REG6),B'11101111'                            2388
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */
*         CALL RECMGMT;                                            2389
         L     @15,@CV03498                                        2389
         BALR  @14,@15                                             2389
*           RFY RTNREG RSTD;                                       2390
*           TESTRC = RTNREG;                                       2391
         STH   RTNREG,TESTRC(,REG6)                                2391
*           RFY RTNREG UNRSTD;                                     2392
*         END;                                                     2393
*                                                                  2393
*         /***********************************************************/
*         /*                                                         */
*         /*  FORCE A READ OF THE CCR RECORD BY CATALOG MANAGEMENT   */
*         /*  VIA FRCRCCR.                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2394
*         /* CALL TO MODULE IDCRS07 FOR PROCEDURE FRCRCCR            */
*         CALL FRCRCCR;                                            2394
*                                                                  2394
         L     @15,@CV03686                                        2394
         BALR  @14,@15                                             2394
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*  IF RECORDS WERE MOVED TO THE NEW CATALOG'S CRA,@ZA18274*/
*         /*  UPDATE THE CCR RECORD AND CLOSE THE CRA.       @ZA18274*/
*         /*                                                 @ZA18274*/
*         /***********************************************************/
*                                                                  2395
*         IF RSCHCRAN ^= 0 THEN DO;                        /*@ZA18274*/
         L     @04,RSCHCRAN(,REG6)                                 2395
         LTR   @04,@04                                             2395
         BZ    @RF02395                                            2395
*           RSGRABCU = ADDR(GRABSCR);                      /*@ZA18274*/
         L     @04,RSIOTBL(,REG6)                                  2397
         LA    @04,GRABSCR(,@04)                                   2397
         ST    @04,RSGRABCU(,REG6)                                 2397
*           GRABCURR = GRABRAB2;                           /*@ZA18274*/
         L     @15,GRABRAB2(,@04)                                  2398
         ST    @15,GRABCURR(,@04)                                  2398
*           RABRCDA = CCRCI;                               /*@ZA18274*/
*                                                                  2399
         MVC   RABRCDA(4,@15),@CF00166                             2399
*           DO;                                                    2400
*             RSRTYPE = ''B;                                       2401
         MVI   RSRTYPE(REG6),X'00'                                 2401
*             RSRUPDT = ON;     /* UPDRCD  */                      2402
         OI    RSRUPDT(REG6),B'00100000'                           2402
*             RSRUPD = ON;      /* UPDATE  */                      2403
         OI    RSRUPD(REG6),B'00001000'                            2403
*             RSRDS = ''B;                                         2404
         NI    RSRDS(REG6),B'00011111'                             2404
*             RSRCRA = ON;      /* CRA  */                         2405
*             RSRDIR = ON;      /* DIRECT  */                      2406
*             RSRKEY = OFF;     /* CNV  */                         2407
*                                                                  2407
         OI    RSRCRA(REG6),B'00100100'                            2407
         NI    RSRKEY(REG6),B'11101111'                            2407
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */
*           CALL RECMGMT;                                          2408
         L     @15,@CV03498                                        2408
         BALR  @14,@15                                             2408
*             RFY RTNREG RSTD;                                     2409
*             TESTRC = RTNREG;                                     2410
         STH   RTNREG,TESTRC(,REG6)                                2410
*             RFY RTNREG UNRSTD;                                   2411
*           END;                       /*@ZA18274*/                2412
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE          */
*           CALL IDCRS6DC('R');                         /*@ZA18274*/
         L     @15,@CV03542                                        2413
         LA    @01,@AL02413                                        2413
         BALR  @14,@15                                             2413
*         END;                                             /*@ZA18274*/
*                                                                  2414
*         /***********************************************************/
*         /*                                                         */
*         /*  CATALOG HAS BEEN RESET. CALL CKERR TO PRINT            */
*         /*  INFORMATIONAL MESSAGE.                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2415
*                                                                  2415
*         DO;                                                      2415
@RF02395 DS    0H                                                  2416
*         /*CALL CKERR*/                                           2416
*           RSCKERR = RSCKERR && RSCKERR;                          2416
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2416
*           RSCKERN = RSE062;                                      2417
         MVC   RSCKERN(2,REG6),@CH01013                            2417
*           RSCKTERM = 'RETU';                                     2418
         MVC   RSCKTERM(4,REG6),@CC03585                           2418
*           RSCKMVAR(1) = ADDR(RSCATDSN);                          2419
*                                                                  2419
         LA    @04,RSCATDSN(,REG6)                                 2419
         ST    @04,RSCKMVAR(,REG6)                                 2419
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR              */
*         CALL CKERR;                                              2420
         L     @15,@CV03544                                        2420
         BALR  @14,@15                                             2420
*         END;                                                     2421
*                                                                  2421
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2422
*                                                                  2422
*                                                                  2422
*         IF GDTDBG = NULLPTR                                      2422
*           THEN;                                                  2422
         L     @04,GDTDBG(,REG5)                                   2422
         LTR   @04,@04                                             2422
         BZ    @RT02422                                            2422
*           ELSE                                                   2424
*             CALL IDCDB010 (GDTTBL,'RSU1');                       2424
*                                                                  2424
         ST    REG5,@AL00001                                       2424
         LA    @04,@CC03687                                        2424
         ST    @04,@AL00001+4                                      2424
         MVI   @AL00001+4,X'80'                                    2424
         L     @15,GDTDBG(,REG5)                                   2424
         LA    @01,@AL00001                                        2424
         BALR  @14,@15                                             2424
* CALL EXIT;  /*TERMINATE*/                                        2425
@RT02422 BAL   @14,EXIT                                            2425
* END UPDCAT; /*END OF PROCEDURE*/                                 2426
@EL00010 DS    0H                                                  2426
@EF00010 DS    0H                                                  2426
@ER00010 BR    @14                                                 2426
@PB00010 DS    0H                                                  2427
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - UPDCRA                                          */
*/*                                                                  */
*/* FUNCTION - UPDATE CATALOG RECOVERY AREAS FROM THE WORKFILE       */
*/*                                                                  */
*/* INPUT    - NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   RECORDS ARE UPDATED IN CRAS                           */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   2427
         DS    0F
NAME0254 DC    CL8'UPDCRA'
*UPDCRA: PROCEDURE                                                 2428
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2428
*                                                                  2428
         B     @PB00011                                            2428
UPDCRA   DS    0H                                                  2429
*      GENERATE REFS(RS01RG08, REG6);                              2429
*                                                                  2429
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0254  PROCNAME TO REGSAVE
*         /***********************************************************/
*         /*                                                         */
*         /*  CRA FREE RECORD NEXT FREE CI                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2430
*         DCL RSUCENTF PTR(24) DEF(RCDSIZ);                        2430
*                                                                  2430
*         RFY RESVOL BASED(RSENTPT);                               2431
*                                                                  2431
*         OLDERID2 = NEWERID2;                                     2432
         L     @04,GDTTR2(,REG5)                                   2432
         MVC   @TS00001(95),NEWERID2(@04)                          2432
         MVC   OLDERID2(95,@04),@TS00001                           2432
*         NEWID2 = 'RSUC';                                         2433
*                                                                  2433
         MVC   NEWID2(4,@04),@CC03693                              2433
*         /***********************************************************/
*         /*                                                         */
*         /*  INITIALIZE RECMGMT BUFFER POINTERS AND CONTROL BLOCKS. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2434
*         RSGRABCU = ADDR(GRABSWF);                                2434
         L     @04,RSIOTBL(,REG6)                                  2434
         ST    @04,RSGRABCU(,REG6)                                 2434
*         GRABCURR = GRABRAB1;                                     2435
         L     @15,GRABRAB1(,@04)                                  2435
         ST    @15,GRABCURR(,@04)                                  2435
*         RSWFBP1 =ADDR(RABBUF);                                   2436
         LA    @14,RABBUF(,@15)                                    2436
         ST    @14,RSWFBP1(,REG6)                                  2436
*         GRABAFLS = ''B;                                          2437
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       2437
*         RABRRN = OFF;                                            2438
*                                                                  2438
         NI    RABRRN(@15),B'11101111'                             2438
*         RSGRABCU = ADDR(GRABSCR);                                2439
         LA    @15,GRABSCR(,@04)                                   2439
         ST    @15,RSGRABCU(,REG6)                                 2439
*         GRABCURR = GRABRAB1;                                     2440
         L     @14,GRABRAB1(,@15)                                  2440
         ST    @14,GRABCURR(,@15)                                  2440
*         RSCRBP1 = ADDR(RABBUF);                                  2441
         LA    @14,RABBUF(,@14)                                    2441
         ST    @14,RSCRBP1(,REG6)                                  2441
*         GRABAFLS = ''B;                                          2442
*                                                                  2442
         XC    GRABAFLS(2,@15),GRABAFLS(@15)                       2442
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESS RESET CRAS VIA RESVOL TABLE.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2443
*         RSMETRM = OFF;                                           2443
         NI    RSMETRM(REG6),B'10111111'                           2443
*         RSENTPT = ADDR(RSVOLENT);                                2444
*                                                                  2444
         LA    @04,RSVOLENT(,@04)                                  2444
         ST    @04,RSENTPT(,REG6)                                  2444
*UPCRLP1: DO UNTIL (RSENTPT = 0);                                  2445
*                                                                  2445
UPCRLP1  DS    0H                                                  2445
@DL02445 DS    0H                                                  2446
*         /***********************************************************/
*         /*                                                         */
*         /*    OBTAIN NEXT ENTRY IN RESVOL VIA SCNRLST.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2446
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST            */
*         CALL IDCRS5SR('N','B',RSENTPT,NULLPTR);                  2446
*                                                                  2446
         MVC   @AL00001(16),@AL02446                               2446
         LA    @04,RSENTPT(,REG6)                                  2446
         ST    @04,@AL00001+8                                      2446
         L     @15,@CV03539                                        2446
         LA    @01,@AL00001                                        2446
         BALR  @14,@15                                             2446
*         /***********************************************************/
*         /*                                                         */
*         /*    THIS CRA IS TO BE UPDATED.                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2447
*           IF RSENTPT ^= 0 & RESVLUPD ^= 0                        2447
*             THEN                                                 2447
         SLR   @04,@04                                             2447
         L     @15,RSENTPT(,REG6)                                  2447
         CR    @15,@04                                             2447
         BE    @RF02447                                            2447
         C     @04,RESVLUPD(,@15)                                  2447
         BE    @RF02447                                            2447
*UPCRUP:        DO;                                                2448
UPCRUP   DS    0H                                                  2449
*                 RSMEOP = OFF;                                    2449
*                 RSUCCCR = OFF;                                   2450
*                                                                  2450
         NI    RSMEOP(REG6),B'11011110'                            2450
*         /***********************************************************/
*         /*                                                         */
*         /*    OPEN AND VERIFY THE CRA VIA DSOPEN                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2451
*                 RSCRADD = ADDR(RESVLDDN);                        2451
*                                                                  2451
         L     @04,RSENTPT(,REG6)                                  2451
         LA    @04,RESVLDDN(,@04)                                  2451
         ST    @04,RSCRADD(,REG6)                                  2451
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN     */
*                 CALL IDCRS6DO('B','R','U',RSCRADD,NULLPTR,RSMRPAS);
*                                                                  2452
         MVC   @AL00001(20),@AL02452                               2452
         LA    @04,RSCRADD(,REG6)                                  2452
         ST    @04,@AL00001+12                                     2452
         LA    @04,RSMRPAS(,REG6)                                  2452
         ST    @04,@AL00001+20                                     2452
         L     @15,@CV03580                                        2452
         LA    @01,@AL00001                                        2452
         BALR  @14,@15                                             2452
*                 RESPECIFY RTNREG RSTD;                           2453
*                 TESTRC = RTNREG;                                 2454
         STH   RTNREG,TESTRC(,REG6)                                2454
*                 RESPECIFY RTNREG UNRSTD;                         2455
*                                                                  2455
*         /***********************************************************/
*         /*                                                         */
*         /*    IF OPEN FAILED, SET TERMINATE AT END FLAG            */
*         /*    AND DO NOT UPDATE THIS CRA. IF OPEN WAS SUCCESSFUL,  */
*         /*    SET CRA OPEN FLAG.                                   */
*         /*    IGNORE VERIFY FAILURE.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2456
*                 IF TESTRC = RCUERR1                              2456
*                   THEN                                           2456
         LH    @04,TESTRC(,REG6)                                   2456
         C     @04,@CF00046                                        2456
         BNE   @RF02456                                            2456
*                     RSMETRM = ON;                                2457
*                                                                  2457
         OI    RSMETRM(REG6),B'01000000'                           2457
*         /***********************************************************/
*         /*                                                         */
*         /*    OPEN OF CRA WAS SUCCESSFUL.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2458
*                   ELSE                                           2458
*UPCROP:              DO;                                          2458
         B     @RC02456                                            2458
@RF02456 DS    0H                                                  2458
UPCROP   DS    0H                                                  2459
*                       RSMEOP = ON;                               2459
*                                                                  2459
         OI    RSMEOP(REG6),B'00100000'                            2459
*         /***********************************************************/
*         /*                                                 @ZA18274*/
*         /*    IF THERE ARE F1DSCBS TO RENAME THEN CALL     @ZA18274*/
*         /*    PROCEDURE TO RENAME F1DSCBS FOR THIS CRA,    @ZA18274*/
*         /*    IF ANY                                       @ZA18274*/
*         /*                                                 @ZA18274*/
*         /***********************************************************/
*                                                                  2460
*                       IF RSF1RNAM ^= 0                           2460
*                         THEN  /* CALL TO MODULE IDCRS07 FOR PROCEDURE
*RENAMEF                                                             */
         L     @04,RSF1RNAM(,REG6)                                 2460
         LTR   @04,@04                                             2460
         BZ    @RF02460                                            2460
*                               CALL RENAMEF;           /*@ZA18274*/
*                                                                  2461
         L     @15,@CV03700                                        2461
         BALR  @14,@15                                             2461
*         /***********************************************************/
*         /*                                                         */
*         /*    READ EACH WORKFILE RECORD ON THE CRA UPDATE CHAIN.   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2462
*                       RSUCNXT = RESVLUPD;                        2462
*                                                                  2462
@RF02460 L     @04,RSENTPT(,REG6)                                  2462
         L     @04,RESVLUPD(,@04)                                  2462
         ST    @04,RSUCNXT(,REG6)                                  2462
*UPCRLP2:               DO WHILE (RSUCNXT ^= 0);                   2463
*                                                                  2463
UPCRLP2  B     @DE02463                                            2463
@DL02463 DS    0H                                                  2464
*         /***********************************************************/
*         /*                                                         */
*         /*    GET WORKFILE RECORD VIA RECMGMT.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2464
*                         RSGRABCU = ADDR(GRABSWF);                2464
         L     @04,RSIOTBL(,REG6)                                  2464
         ST    @04,RSGRABCU(,REG6)                                 2464
*                         RABRCDA = RSUCNXT;                       2465
*                                                                  2465
*                                                                  2465
         L     @04,GRABCURR(,@04)                                  2465
         L     @15,RSUCNXT(,REG6)                                  2465
         ST    @15,RABRCDA(,@04)                                   2465
*                         DO;                                      2466
*                           RSRTYPE = ''B;                         2467
         MVI   RSRTYPE(REG6),X'00'                                 2467
*                           RSRGET = ON;      /* GETRCD  */        2468
         OI    RSRGET(REG6),B'10000000'                            2468
*                           RSRUPD = OFF;     /* NO UPDATE  */     2469
         NI    RSRUPD(REG6),B'11110111'                            2469
*                           RSRDS = ''B;                           2470
         NI    RSRDS(REG6),B'00011111'                             2470
*                           RSRWF = ON;       /* WORKFILE  */      2471
*                           RSRDIR = ON;      /* DIRECT  */        2472
*                           RSRKEY = ON;      /* KEY  */           2473
*                                                                  2473
         OI    RSRWF(REG6),B'10010100'                             2473
*                         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMG
*T                                                                   */
*                         CALL RECMGMT;                            2474
         L     @15,@CV03498                                        2474
         BALR  @14,@15                                             2474
*                           RFY RTNREG RSTD;                       2475
*                           TESTRC = RTNREG;                       2476
         STH   RTNREG,TESTRC(,REG6)                                2476
*                           RFY RTNREG UNRSTD;                     2477
*                         END;                                     2478
*                                                                  2478
*                         RSUCNXT = RSWCHPTR;                      2479
*                                                                  2479
         L     @04,RSGRABCU(,REG6)                                 2479
         L     @04,GRABCURR(,@04)                                  2479
         L     @15,RSWCHPTR(,@04)                                  2479
         ST    @15,RSUCNXT(,REG6)                                  2479
*         /***********************************************************/
*         /*                                                         */
*         /*    FREE RECORD. PLACE ON CCR FREE RECORD CHAIN.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2480
*                         IF RCDID = FREEID                        2480
*                           THEN                                   2480
         CLI   RCDID+8(@04),C'F'                                   2480
         BNE   @RF02480                                            2480
*UPCRFRE:                     DO;                                  2481
*                                                                  2481
UPCRFRE  DS    0H                                                  2482
*                               RSGRABCU = ADDR(GRABSCR);          2482
         L     @04,RSIOTBL(,REG6)                                  2482
         LA    @04,GRABSCR(,@04)                                   2482
         ST    @04,RSGRABCU(,REG6)                                 2482
*                               GRABCURR = GRABRAB2;               2483
*                                                                  2483
         L     @15,GRABRAB2(,@04)                                  2483
         ST    @15,GRABCURR(,@04)                                  2483
*                               RFY CATRCD BASED(ADDR(ADDR(GRABSCR)
*                                   -> GRABRAB1 -> RABBUF));       2484
*                               RFY CCR BASED(ADDR(ADDR(GRABSCR)   2485
*                                   -> GRABRAB2 -> RABBUF));       2485
*                                                                  2485
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CCR RECORD HAS NOT BEEN READ, GET IT VIA RECMGMT. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2486
*                               IF RSUCCCR = OFF                   2486
*                                 THEN                             2486
         TM    RSUCCCR(REG6),B'00000001'                           2486
         BNZ   @RF02486                                            2486
*                                   DO;                            2487
*                                     RABRCDA = CCRCI;             2488
*                                                                  2488
*                                                                  2488
         MVC   RABRCDA(4,@15),@CF00166                             2488
*                                     DO;                          2489
*                                       RSRTYPE = ''B;             2490
         MVI   RSRTYPE(REG6),X'00'                                 2490
*                                       RSRGET = ON;      /* GETRCD  */
         OI    RSRGET(REG6),B'10000000'                            2491
*                                       RSRUPD = ON;      /* UPDATE  */
         OI    RSRUPD(REG6),B'00001000'                            2492
*                                       RSRDS = ''B;               2493
         NI    RSRDS(REG6),B'00011111'                             2493
*                                       RSRCRA = ON;      /* CRA  */
*                                       RSRDIR = ON;      /* DIRECT  */
*                                       RSRKEY = OFF;     /* CNV  */
*                                                                  2496
         OI    RSRCRA(REG6),B'00100100'                            2496
         NI    RSRKEY(REG6),B'11101111'                            2496
*                                     /* CALL TO MODULE IDCRS06 FOR PRO
*EDURE RECMGMT                                                       */
*                                     CALL RECMGMT;                2497
         L     @15,@CV03498                                        2497
         BALR  @14,@15                                             2497
*                                       RFY RTNREG RSTD;           2498
*                                       TESTRC = RTNREG;           2499
         STH   RTNREG,TESTRC(,REG6)                                2499
*                                       RFY RTNREG UNRSTD;         2500
*                                     END;                         2501
*                                                                  2501
*                                   END;                           2502
*                                                                  2502
*         /***********************************************************/
*         /*                                                         */
*         /*    PLACE RECORD ON CRA CCR FREE CHAIN.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2503
*                               CRBUF1(1:256) = ''B;               2503
@RF02486 L     @04,RSCRBP1(,REG6)                                  2503
         XC    CRBUF1(256,@04),CRBUF1(@04)                         2503
*                               CRBUF1(257:CELEN) = ''B;           2504
         XC    CRBUF1+256(249,@04),CRBUF1+256(@04)                 2504
*                               RCDID = FREEID;                    2505
         LA    @04,8                                               2505
         L     @15,RSIOTBL(,REG6)                                  2505
         LA    @14,80                                              2505
         ALR   @14,@15                                             2505
         L     @03,GRABRAB1(,@14)                                  2505
         ALR   @03,@04                                             2505
         MVI   RCDID(@03),C'F'                                     2505
*                               RSUCENTF = CCRFDCI;                2506
         L     @02,GRABRAB2(,@14)                                  2506
         ALR   @02,@04                                             2506
         MVC   RSUCENTF(3,@03),CCRFDCI(@02)                        2506
*                               RCDCINO = ADDR(ADDR(GRABSWF) ->    2507
*                                 GRABCURR -> RABBUF) -> RCDCRACI; 2507
         AL    @04,GRABCURR(,@15)                                  2507
         MVC   RCDCINO(3,@03),RCDCRACI(@04)                        2507
*                               CCRFDCI = RCDCINO;                 2508
         MVC   CCRFDCI(3,@02),RCDCINO(@03)                         2508
*                               CCRCDCI = CCRCDCI + 1;             2509
         LA    @04,1                                               2509
         SLR   @03,@03                                             2509
         ICM   @03,7,CCRCDCI(@02)                                  2509
         ALR   @04,@03                                             2509
         STCM  @04,7,CCRCDCI(@02)                                  2509
*                               RSUCCCR = ON;                      2510
*                                                                  2510
         OI    RSUCCCR(REG6),B'00000001'                           2510
*                             END UPCRFRE;                         2511
*                                                                  2511
*         /***********************************************************/
*         /*                                                         */
*         /*    NOT A FREE RECORD. MOVE RECORD TO CRA BUFFER.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2512
*                           ELSE                                   2512
*                             DO;                                  2512
         B     @RC02480                                            2512
@RF02480 DS    0H                                                  2513
*                               CRBUF1(1:256) = WFBUF1(1:256);     2513
         L     @04,RSCRBP1(,REG6)                                  2513
         L     @15,RSWFBP1(,REG6)                                  2513
         MVC   CRBUF1(256,@04),WFBUF1(@15)                         2513
*                               CRBUF1(257:CELEN) = WFBUF1(257:CELEN);
         MVC   CRBUF1+256(249,@04),WFBUF1+256(@15)                 2514
*                             END;                                 2515
*                                                                  2515
*         /***********************************************************/
*         /*                                                         */
*         /*    UPDATE CRA RECORD VIA RECMGMT.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2516
*                         RSGRABCU = ADDR(GRABSCR);                2516
@RC02480 L     @04,RSIOTBL(,REG6)                                  2516
         LA    @15,GRABSCR(,@04)                                   2516
         ST    @15,RSGRABCU(,REG6)                                 2516
*                         GRABCURR = GRABRAB1;                     2517
         L     @14,GRABRAB1(,@15)                                  2517
         ST    @14,GRABCURR(,@15)                                  2517
*                         IF RCDID = FREEID                        2518
*                           THEN                                   2518
         LA    @15,8                                               2518
         AL    @15,GRABRAB1+80(,@04)                               2518
         CLI   RCDID(@15),C'F'                                     2518
         BNE   @RF02518                                            2518
*                             RABRCDA = RCDCINO;                   2519
         L     @04,RCDCINO-1(,@15)                                 2519
         LA    @04,0(,@04)                                         2519
         ST    @04,RABRCDA(,@14)                                   2519
*                           ELSE                                   2520
*                             RABRCDA = RCDCRACI;                  2520
*                                                                  2520
*                                                                  2520
         B     @RC02518                                            2520
@RF02518 L     @04,RSGRABCU(,REG6)                                 2520
         L     @04,GRABCURR(,@04)                                  2520
         L     @01,RSIOTBL(,REG6)                                  2520
         L     @01,GRABRAB1+80(,@01)                               2520
         SLR   @00,@00                                             2520
         ICM   @00,7,RCDCRACI+8(@01)                               2520
         ST    @00,RABRCDA(,@04)                                   2520
*                         DO;                                      2521
@RC02518 DS    0H                                                  2522
*                           RSRTYPE = ''B;                         2522
         MVI   RSRTYPE(REG6),X'00'                                 2522
*                           RSRUPDT = ON;     /* UPDRCD  */        2523
         OI    RSRUPDT(REG6),B'00100000'                           2523
*                           RSRUPD = ON;      /* UPDATE  */        2524
         OI    RSRUPD(REG6),B'00001000'                            2524
*                           RSRDS = ''B;                           2525
         NI    RSRDS(REG6),B'00011111'                             2525
*                           RSRCRA = ON;      /* CRA  */           2526
*                           RSRDIR = ON;      /* DIRECT  */        2527
*                           RSRKEY = OFF;     /* CNV  */           2528
*                                                                  2528
         OI    RSRCRA(REG6),B'00100100'                            2528
         NI    RSRKEY(REG6),B'11101111'                            2528
*                         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMG
*T                                                                   */
*                         CALL RECMGMT;                            2529
         L     @15,@CV03498                                        2529
         BALR  @14,@15                                             2529
*                           RFY RTNREG RSTD;                       2530
*                           TESTRC = RTNREG;                       2531
         STH   RTNREG,TESTRC(,REG6)                                2531
*                           RFY RTNREG UNRSTD;                     2532
*                         END;                                     2533
*                                                                  2533
*                       END UPCRLP2;                               2534
*                                                                  2534
@DE02463 L     @04,RSUCNXT(,REG6)                                  2534
         LTR   @04,@04                                             2534
         BNZ   @DL02463                                            2534
*                       RFY CCR;                                   2535
*                       RFY CATRCD;                                2536
*                                                                  2536
*         /***********************************************************/
*         /*                                                         */
*         /*  CRA UPDATE CHAIN PROCESSING COMPLETE. UPDATE THE CRA   */
*         /*  CCR RECORD.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2537
*                       RSGRABCU = ADDR(GRABSCR);                  2537
         L     @04,RSIOTBL(,REG6)                                  2537
         LA    @04,GRABSCR(,@04)                                   2537
         ST    @04,RSGRABCU(,REG6)                                 2537
*                       GRABCURR = GRABRAB2;                       2538
         L     @15,GRABRAB2(,@04)                                  2538
         ST    @15,GRABCURR(,@04)                                  2538
*                       RABRCDA = CCRCI;                           2539
*                                                                  2539
         MVC   RABRCDA(4,@15),@CF00166                             2539
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CCR RECORD HAS NOT BEEN READ, GET IT VIA RECMGMT  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2540
*                       IF RSUCCCR = OFF                           2540
*                         THEN                                     2540
*                                                                  2540
*                                                                  2540
         TM    RSUCCCR(REG6),B'00000001'                           2540
         BNZ   @RF02540                                            2540
*                           DO;                                    2541
*                             RSRTYPE = ''B;                       2542
         MVI   RSRTYPE(REG6),X'00'                                 2542
*                             RSRGET = ON;      /* GETRCD  */      2543
         OI    RSRGET(REG6),B'10000000'                            2543
*                             RSRUPD = ON;      /* UPDATE  */      2544
         OI    RSRUPD(REG6),B'00001000'                            2544
*                             RSRDS = ''B;                         2545
         NI    RSRDS(REG6),B'00011111'                             2545
*                             RSRCRA = ON;      /* CRA  */         2546
*                             RSRDIR = ON;      /* DIRECT  */      2547
*                             RSRKEY = OFF;     /* CNV  */         2548
*                                                                  2548
         OI    RSRCRA(REG6),B'00100100'                            2548
         NI    RSRKEY(REG6),B'11101111'                            2548
*                           /* CALL TO MODULE IDCRS06 FOR PROCEDURE REC
*GMT                                                                 */
*                           CALL RECMGMT;                          2549
         L     @15,@CV03498                                        2549
         BALR  @14,@15                                             2549
*                             RFY RTNREG RSTD;                     2550
*                             TESTRC = RTNREG;                     2551
         STH   RTNREG,TESTRC(,REG6)                                2551
*                             RFY RTNREG UNRSTD;                   2552
*                           END;                                   2553
*                                                                  2553
*         /***********************************************************/
*         /*                                                         */
*         /*    WRITE THE CRA CCR RECORD VIA RECMGMT.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2554
*                                                                  2554
*                       DO;                                        2554
@RF02540 DS    0H                                                  2555
*                         RSRTYPE = ''B;                           2555
         MVI   RSRTYPE(REG6),X'00'                                 2555
*                         RSRUPDT = ON;     /* UPDRCD  */          2556
         OI    RSRUPDT(REG6),B'00100000'                           2556
*                         RSRUPD = ON;      /* UPDATE  */          2557
         OI    RSRUPD(REG6),B'00001000'                            2557
*                         RSRDS = ''B;                             2558
         NI    RSRDS(REG6),B'00011111'                             2558
*                         RSRCRA = ON;      /* CRA  */             2559
*                         RSRDIR = ON;      /* DIRECT  */          2560
*                         RSRKEY = OFF;     /* CNV  */             2561
*                                                                  2561
         OI    RSRCRA(REG6),B'00100100'                            2561
         NI    RSRKEY(REG6),B'11101111'                            2561
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT
*                                                                    */
*                       CALL RECMGMT;                              2562
         L     @15,@CV03498                                        2562
         BALR  @14,@15                                             2562
*                         RFY RTNREG RSTD;                         2563
*                         TESTRC = RTNREG;                         2564
         STH   RTNREG,TESTRC(,REG6)                                2564
*                         RFY RTNREG UNRSTD;                       2565
*                       END;                                       2566
*                                                                  2566
*                     END UPCROP;                                  2567
*                                                                  2567
*         /***********************************************************/
*         /*                                                         */
*         /*  CLOSE THE CRA VIA DSCLOSE.                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2568
*                 IF RSMEOP = ON                                   2568
*                   THEN                                           2568
@RC02456 TM    RSMEOP(REG6),B'00100000'                            2568
         BNO   @RF02568                                            2568
*                     DO;                                          2569
*                                                                  2569
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE
*                                                                    */
*                       CALL IDCRS6DC('R');                        2570
*                                                                  2570
         L     @15,@CV03542                                        2570
         LA    @01,@AL02570                                        2570
         BALR  @14,@15                                             2570
*                       RESPECIFY RTNREG RSTD;                     2571
*                       TESTRC = RTNREG;                           2572
         STH   RTNREG,TESTRC(,REG6)                                2572
*                       RESPECIFY RTNREG UNRSTD;                   2573
*                                                                  2573
*         /***********************************************************/
*         /*                                                         */
*         /*    IF CLOSE FAILED, SET TERMINATE AT END FLAG.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2574
*                       IF TESTRC ^= 0                             2574
*                         THEN                                     2574
         LH    @04,TESTRC(,REG6)                                   2574
         LTR   @04,@04                                             2574
         BZ    @RF02574                                            2574
*                           RSMETRM = ON;                          2575
*                                                                  2575
         OI    RSMETRM(REG6),B'01000000'                           2575
*                     END;                                         2576
*                                                                  2576
@RF02574 DS    0H                                                  2577
*               END UPCRUP;                                        2577
*                                                                  2577
@RF02568 DS    0H                                                  2578
*         END UPCRLP1;                                             2578
*                                                                  2578
@RF02447 DS    0H                                                  2578
@DE02445 L     @04,RSENTPT(,REG6)                                  2578
         LTR   @04,@04                                             2578
         BNZ   @DL02445                                            2578
*         /***********************************************************/
*         /*                                                         */
*         /*  ALL CRAS HAVE BEEN PROCESSED. IF TERMINATE AT END      */
*         /*  FLAG WAS SET DUE TO AN ERROR IN PROCESSING ONE OR      */
*         /*  CRAS, THE CALL CKERR TO TERMINATE.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2579
*         IF RSMETRM = ON                                          2579
*           THEN                                                   2579
*                                                                  2579
*                                                                  2579
         TM    RSMETRM(REG6),B'01000000'                           2579
         BNO   @RF02579                                            2579
*             DO;                                                  2580
*             /*CALL CKERR*/                                       2581
*               RSCKERR = RSCKERR && RSCKERR;                      2581
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2581
*               RSCKERN = RSE064;                                  2582
         MVC   RSCKERN(2,REG6),@CH00750                            2582
*               RSCKTERM = 'TERM';                                 2583
*                                                                  2583
         MVC   RSCKTERM(4,REG6),@CC03543                           2583
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */
*             CALL CKERR;                                          2584
         L     @15,@CV03544                                        2584
         BALR  @14,@15                                             2584
*             END;                                                 2585
*                                                                  2585
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2586
*                                                                  2586
*                                                                  2586
*         IF GDTDBG = NULLPTR                                      2586
*           THEN;                                                  2586
@RF02579 L     @04,GDTDBG(,REG5)                                   2586
         LTR   @04,@04                                             2586
         BZ    @RT02586                                            2586
*           ELSE                                                   2588
*             CALL IDCDB010 (GDTTBL,'RSU2');                       2588
*                                                                  2588
         ST    REG5,@AL00001                                       2588
         LA    @04,@CC03711                                        2588
         ST    @04,@AL00001+4                                      2588
         MVI   @AL00001+4,X'80'                                    2588
         L     @15,GDTDBG(,REG5)                                   2588
         LA    @01,@AL00001                                        2588
         BALR  @14,@15                                             2588
* CALL EXIT;  /*TERMINATE*/                                        2589
@RT02586 BAL   @14,EXIT                                            2589
* END UPDCRA; /*END OF PROCEDURE*/                                 2590
@EL00011 DS    0H                                                  2590
@EF00011 DS    0H                                                  2590
@ER00011 BR    @14                                                 2590
@PB00011 DS    0H                                                  2591
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - WRAPUP                                          */
*/*                                                                  */
*/* FUNCTION - COMPLETE NORMAL PROCESSING FOR RESETCAT               */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO SYSTEM                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   2591
         DS    0F
NAME0273 DC    CL8'WRAPUP'
*WRAPUP: PROCEDURE                                                 2592
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2592
*                                                                  2592
         B     @PB00012                                            2592
WRAPUP   DS    0H                                                  2593
*      GENERATE REFS(RS01RG08, REG6);                              2593
*                                                                  2593
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         ENTRY WRAPUP  ENTRY POINT
         LM    @08,@12,RS01RG08(REG6)  PRIME BASE AND DATA REGS
         MVC   0(4,@15),NAME0273  PROCNAME TO REGSAVE
*         OLDERID2 = NEWERID2;                                     2594
         L     @04,GDTTR2(,REG5)                                   2594
         MVC   @TS00001(95),NEWERID2(@04)                          2594
         MVC   OLDERID2(95,@04),@TS00001                           2594
*         NEWID2 = 'RSWR';                                         2595
*                                                                  2595
         MVC   NEWID2(4,@04),@CC03715                              2595
*         /***********************************************************/
*         /*                                                         */
*         /*  FREE RESOURCES VIA CLEANUP IF NOT RECURSIVE TERMINATION*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  2596
*         IF RSTERM = OFF THEN                                     2596
         TM    RSTERM(REG6),B'00000100'                            2596
         BNZ   @RF02596                                            2596
*           CALL CLEANUP;                                          2597
*                                                                  2597
         BAL   @14,CLEANUP                                         2597
*         /***********************************************************/
*         /*                                                         */
*         /*  PRINT PROCESSING COMPLETED MESSAGE VIA CKERR.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2598
*                                                                  2598
*         DO;                                                      2598
@RF02596 DS    0H                                                  2599
*         /*CALL CKERR*/                                           2599
*           RSCKERR = RSCKERR && RSCKERR;                          2599
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2599
*           RSCKERN = RSE084;                                      2600
         MVC   RSCKERN(2,REG6),@CH01056                            2600
*           RSCKTERM = 'RETU';                                     2601
         MVC   RSCKTERM(4,REG6),@CC03585                           2601
*           RSCKMVAR(1) = ADDR(LASTCC);                            2602
*                                                                  2602
         L     @04,RSLASTCC(,REG6)                                 2602
         ST    @04,RSCKMVAR(,REG6)                                 2602
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR              */
*         CALL CKERR;                                              2603
         L     @15,@CV03544                                        2603
         BALR  @14,@15                                             2603
*         END;                                                     2604
*                                                                  2604
*         /***********************************************************/
*         /*                                                         */
*         /*  RETURN TO SYSTEM VIA UEPIL                             */
*         /*     NOTE *** REG 13 MUST POINT TO 1ST BYTE OF DYNAMIC   */
*         /*              STORAGE FOR THIS MODULE FOR UEPIL          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2605
*         REG13 = REG8;                                            2605
         LR    REG13,REG8                                          2605
*         CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                      2606
*                                                                  2606
         ST    REG5,@AL00001                                       2606
         LA    @04,MODID                                           2606
         ST    @04,@AL00001+4                                      2606
         L     @04,RSLASTCC(,REG6)                                 2606
         ST    @04,@AL00001+8                                      2606
         MVI   @AL00001+8,X'80'                                    2606
         L     @15,GDTEPL(,REG5)                                   2606
         LA    @01,@AL00001                                        2606
         BALR  @14,@15                                             2606
* CALL EXIT;  /*TERMINATE*/                                        2607
         BAL   @14,EXIT                                            2607
* END WRAPUP; /*END OF PROCEDURE*/                                 2608
@EL00012 DS    0H                                                  2608
@EF00012 DS    0H                                                  2608
@ER00012 BR    @14                                                 2608
@PB00012 DS    0H                                                  2609
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - CLEANUP                                         */
*/*                                                                  */
*/* FUNCTION - ENSURE THAT ALL RESOURCES OBTAINED BY RESETCAT        */
*/*            ARE FREED BEFORE TERMINATION.                         */
*/*                                                                  */
*/* INPUT -    NONE                                                  */
*/*                                                                  */
*/* OUTPUT -   NONE                                                  */
*/*                                                                  */
*/* EXIT, NORMAL - RETURN TO CALLER                                  */
*/*                                                                  */
*/********************************************************************/
*      GENERATE;                                                   2609
         DS    0F
NAME0279 DC    CL8'CLEANUP'
*CLEANUP: PROCEDURE                                                2610
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2610
*                                                                  2610
         B     @PB00013                                            2610
CLEANUP  DS    0H                                                  2611
*      GENERATE REFS(RS01RG08, REG6);                              2611
*                                                                  2611
         STM   @14,@12,12(@13)  SAVE REGISTERS
         LR    @15,@13  OLD SAVE AREA
         LA    @13,72(@13)  NEW SAVE AREA
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD
         MVC   0(4,@15),NAME0279  PROCNAME TO REGSAVE
*         RFY RESVOL BASED(RSSUBENP);                              2612
*                                                                  2612
*         OLDERID2 = NEWERID2;                                     2613
         L     @04,GDTTR2(,REG5)                                   2613
         MVC   @TS00001(95),NEWERID2(@04)                          2613
         MVC   OLDERID2(95,@04),@TS00001                           2613
*         NEWID2 = 'RSCL';                                         2614
         MVC   NEWID2(4,@04),@CC03721                              2614
*         IF GDTDBG = NULLPTR                                      2615
*           THEN;                                                  2615
         L     @04,GDTDBG(,REG5)                                   2615
         LTR   @04,@04                                             2615
         BZ    @RT02615                                            2615
*           ELSE                                                   2617
*             CALL IDCDB010(GDTTBL,'RSC3');                        2617
*                                                                  2617
         ST    REG5,@AL00001                                       2617
         LA    @04,@CC03722                                        2617
         ST    @04,@AL00001+4                                      2617
         MVI   @AL00001+4,X'80'                                    2617
         L     @15,GDTDBG(,REG5)                                   2617
         LA    @01,@AL00001                                        2617
         BALR  @14,@15                                             2617
*         /***********************************************************/
*         /*                                                         */
*         /*  CLOSE DATA SETS                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2618
*                                                                  2618
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG RECOVERY AREA. CLOSE VIA DSCLOSE.            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2618
*         IF RSCROPN = ON                                          2618
*           THEN                                                   2618
*                                                                  2618
@RT02615 TM    RSCROPN(REG6),B'00100000'                           2618
         BNO   @RF02618                                            2618
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE        */
*             CALL IDCRS6DC('R');                                  2619
*                                                                  2619
         L     @15,@CV03542                                        2619
         LA    @01,@AL02619                                        2619
         BALR  @14,@15                                             2619
*         /***********************************************************/
*         /*                                                         */
*         /*    CATALOG. CLOSE VIA DSCLOSE.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2620
*         IF RSCAOPN = ON                                          2620
*           THEN                                                   2620
*                                                                  2620
@RF02618 TM    RSCAOPN(REG6),B'00010000'                           2620
         BNO   @RF02620                                            2620
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE        */
*             CALL IDCRS6DC('C');                                  2621
*                                                                  2621
         L     @15,@CV03542                                        2621
         LA    @01,@AL02621                                        2621
         BALR  @14,@15                                             2621
*         /***********************************************************/
*         /*                                                         */
*         /*    WORKFILE. CLOSE VIA DSCLOSE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2622
*         IF RSWFOPN = ON                                          2622
*           THEN                                                   2622
*                                                                  2622
@RF02620 TM    RSWFOPN(REG6),B'01000000'                           2622
         BNO   @RF02622                                            2622
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE        */
*             CALL IDCRS6DC('W');                                  2623
*                                                                  2623
         L     @15,@CV03542                                        2623
         LA    @01,@AL02623                                        2623
         BALR  @14,@15                                             2623
*         /***********************************************************/
*         /*                                                         */
*         /*  VTOC. CLOSE VIA UCLOSE.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2624
*         IF RSVTOPN = ON                                          2624
*           THEN                                                   2624
@RF02622 TM    RSVTOPN(REG6),B'00001000'                           2624
         BNO   @RF02624                                            2624
*             DO;                                                  2625
*               IOCSPTR = RSVTIOCS;                                2626
*                                                                  2626
         L     @04,RSVTIOCS(,REG6)                                 2626
         ST    @04,IOCSPTR(,REG6)                                  2626
*               CALL IDCIOCL0 (GDTTBL,IOCSPTR);                    2627
*                                                                  2627
         ST    REG5,@AL00001                                       2627
         LA    @04,IOCSPTR(,REG6)                                  2627
         ST    @04,@AL00001+4                                      2627
         MVI   @AL00001+4,X'80'                                    2627
         L     @15,GDTCLS(,REG5)                                   2627
         LA    @01,@AL00001                                        2627
         BALR  @14,@15                                             2627
*             END;                                                 2628
*                                                                  2628
*         /***********************************************************/
*         /*                                                         */
*         /*  RELEASE CATALOG VIA UDEQ                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2629
*         IF RSCARES = ON                                          2629
*           THEN                                                   2629
*                                                                  2629
@RF02624 TM    RSCARES(REG6),B'00000010'                           2629
         BNO   @RF02629                                            2629
*             CALL IDCSADQ0 (GDTTBL,RSCAMAJN,RSCAMINN);            2630
*                                                                  2630
         ST    REG5,@AL00001                                       2630
         L     @04,RSIOTBL(,REG6)                                  2630
         LA    @15,RSCAMAJN(,@04)                                  2630
         ST    @15,@AL00001+4                                      2630
         LA    @04,RSCAMINN(,@04)                                  2630
         ST    @04,@AL00001+8                                      2630
         MVI   @AL00001+8,X'80'                                    2630
         L     @15,GDTDEQ(,REG5)                                   2630
         LA    @01,@AL00001                                        2630
         BALR  @14,@15                                             2630
*         /***********************************************************/
*         /*                                                         */
*         /*  DELETE THE WORKFILE VIA WFDEL                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2631
*         IF RSWFDEF = ON                                          2631
*           THEN                                                   2631
*                                                                  2631
@RF02629 TM    RSWFDEF(REG6),B'10000000'                           2631
         BNO   @RF02631                                            2631
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE WFDEL          */
*             CALL WFDEL;                                          2632
*                                                                  2632
         L     @15,@CV03723                                        2632
         BALR  @14,@15                                             2632
*         /***********************************************************/
*         /*                                                         */
*         /*  DEALLOCATE THE CRA VOLUMES.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2633
*         IF RSALLC = ON                                           2633
*           THEN                                                   2633
@RF02631 TM    RSALLC(REG6),B'00001000'                            2633
         BNO   @RF02633                                            2633
*CLNDAL:      DO;                                                  2634
*                                                                  2634
CLNDAL   DS    0H                                                  2635
*         /***********************************************************/
*         /*                                                         */
*         /*    PROCESS EACH CRA ENTRY IN RESVOL                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2635
*               RSSRNSCN = OFF;                                    2635
         NI    RSSRNSCN(REG6),B'10111111'                          2635
*               RSSUBENP = ADDR(RSVOLENT);                         2636
*                                                                  2636
         L     @04,RSIOTBL(,REG6)                                  2636
         LA    @04,RSVOLENT(,@04)                                  2636
         ST    @04,RSSUBENP(,REG6)                                 2636
*CLNLP1:        DO UNTIL (RSSUBENP = 0);                           2637
*                                                                  2637
CLNLP1   DS    0H                                                  2637
@DL02637 DS    0H                                                  2638
*         /***********************************************************/
*         /*                                                         */
*         /*    GET CRA RESVOL ENTRY VIA SCNRLST                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2638
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST      */
*               CALL IDCRS5SR('N','B',RSSUBENP,NULLPTR);           2638
*                                                                  2638
         MVC   @AL00001(16),@AL02638                               2638
         LA    @04,RSSUBENP(,REG6)                                 2638
         ST    @04,@AL00001+8                                      2638
         L     @15,@CV03539                                        2638
         LA    @01,@AL00001                                        2638
         BALR  @14,@15                                             2638
*         /***********************************************************/
*         /*                                                         */
*         /*    CRA VOLUME WAS ALLOCATED.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2639
*               IF RSSUBENP ^= 0 & RESVLMNT = ON                   2639
*                 THEN                                             2639
         L     @04,RSSUBENP(,REG6)                                 2639
         LTR   @04,@04                                             2639
         BZ    @RF02639                                            2639
         TM    RESVLMNT(@04),B'10000000'                           2639
         BNO   @RF02639                                            2639
*                   DO;                                            2640
*                                                                  2640
*         /***********************************************************/
*         /*                                                         */
*         /*    DEALLOCATE CRA VOLUME VIA CRADMNT                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2641
*                     RSCRADD = ADDR(RESVLDDN);                    2641
*                                                                  2641
         LA    @04,RESVLDDN(,@04)                                  2641
         ST    @04,RSCRADD(,REG6)                                  2641
*                     /* CALL TO MODULE IDCRS06 FOR PROCEDURE CRADMNT*/
*                     CALL IDCRS6CD(RSCRADD);                      2642
*                                                                  2642
         LA    @04,RSCRADD(,REG6)                                  2642
         ST    @04,@AL00001                                        2642
         L     @15,@CV03728                                        2642
         LA    @01,@AL00001                                        2642
         BALR  @14,@15                                             2642
*                   END;                                           2643
*                                                                  2643
*               END CLNLP1;                                        2644
*                                                                  2644
@RF02639 DS    0H                                                  2644
@DE02637 L     @04,RSSUBENP(,REG6)                                 2644
         LTR   @04,@04                                             2644
         BNZ   @DL02637                                            2644
*             END CLNDAL;                                          2645
*                                                                  2645
*         /***********************************************************/
*         /*                                                         */
*         /*  FREE STORAGE VIA UFPOOL                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2646
*         CALL IDCSAFP0 (GDTTBL,POOL1,ALL);                        2646
*                                                                  2646
@RF02633 MVC   @AL00001+4(8),@AL02646                              2646
         ST    REG5,@AL00001                                       2646
         L     @15,GDTFPL(,REG5)                                   2646
         LA    @01,@AL00001                                        2646
         BALR  @14,@15                                             2646
*         /***********************************************************/
*         /*                                                         */
*         /*  PROCESSING COMPLETED. RETURN.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  2647
*                                                                  2647
* CALL EXIT;  /*TERMINATE*/                                        2647
         BAL   @14,EXIT                                            2647
* END CLEANUP; /*END OF PROCEDURE*/                                2648
*                                                                  2648
@EL00013 DS    0H                                                  2648
@EF00013 DS    0H                                                  2648
@ER00013 BR    @14                                                 2648
@PB00013 DS    0H                                                  2649
*      GENERATE;                                                   2649
         DS    0F
         DC    CL8'EXIT'
*EXIT: PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                       2650
*                                                                  2650
         B     @PB00014                                            2650
EXIT     DS    0H                                                  2651
*        GEN(L     @13,4(,@13)); /*RESTORE CALLER'S REG SAVE*/     2651
         L     @13,4(,@13)
*        GEN(LM    @14,@12,12(@13));  /*RESTORE REGS*/             2652
         LM    @14,@12,12(@13)
*        GEN(MVI   12(@13),255);  /*MARK END OF SAVE LIST*/        2653
         MVI   12(@13),255
*        GEN(BR    14);  /*RETURN*/                                2654
         BR    14
*END EXIT;  /*END OF PROC EXIT*/                                   2655
*                                                                  2655
@EL00014 DS    0H                                                  2655
@EF00014 DS    0H                                                  2655
@ER00014 BR    @14                                                 2655
*END IDCRS01   /*END OF MODULE*/                                   2656
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (IDCDF64 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRS )                                        *
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (AMCBS   )                                        *
*/*%INCLUDE SYSLIB  (IGGCAXWA)                                        *
*/*%INCLUDE SYSLIB  (IFGACB  )                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*;                                                                 2656
@EL00001 L     @13,4(,@13)                                         2656
@EF00001 L     @00,@SIZDATD                                        2656
         LR    @01,@08                                             2656
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     2656
         BR    @14                                                 2656
@DATA    DS    0H
@CH00160 DC    H'6'
@CH00036 DC    H'7'
@CH00037 DC    H'12'
@CH00633 DC    H'13'
@CH00229 DC    H'15'
@CH00930 DC    H'17'
@CH00309 DC    H'24'
@CH00853 DC    H'35'
@CH00970 DC    H'39'
@CH00972 DC    H'40'
@CH00983 DC    H'46'
@CH00752 DC    H'47'
@CH00986 DC    H'48'
@CH01013 DC    H'62'
@CH00750 DC    H'64'
@CH01040 DC    H'76'
@CH01044 DC    H'78'
@CH01046 DC    H'79'
@CH01048 DC    H'80'
@CH01056 DC    H'84'
@CH01083 DC    H'99'
@CH00151 DC    H'100'
@CH03739 DC    H'104'
@CH03734 DC    H'532'
@SM03785 MVC   RSCATDSN(0,REG6),CATNMVAL(@04)
@SM03787 MVC   RSCATPS(0,REG6),CATNMPAS(@04)
@SM03789 MVC   RSCATDDN(0,REG6),CATDNVAL(@04)
@SM03791 MVC   RSMRPS(0,REG6),MRPWVAL(@04)
@SM03793 MVC   RSWFDDNM(0,REG6),WFILEVAL(@04)
@SM03795 MVC   RSWFPS(0,REG6),WFILEPAS(@04)
@SM03797 MVC   RSWCATNM(0,REG6),WCATVAL(@04)
@SM03799 MVC   RSWCATPS(0,REG6),WCATPAS(@04)
@SM03804 MVC   RSCATDSN(0,REG6),INITDSN(@04)
@SM03806 MVC   RSINVLSR(0,REG6),INITVLSR(@01)
@SM03808 MVC   RSINTS(0,REG6),INITTS(@04)
@SM03810 MVC   RESVLSER(0,@04),CRAVLVAL(@03)
@SM03812 MVC   RESVLDDN(0,@15),CRADNVAL(@04)
@SM03817 MVC   RESVLEXT(0,@04),FNDEXTS(@01)
         DS    0F
@AL01102 DC    A(@CC00833)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00805)
@AL01191 DC    A(@CC03581)             LIST WITH   5 ARGUMENT(S)
         DC    A(@CC00831)
         DC    A(@CC03581)
         DC    A(@CC00823)
         DC    A(@CF00119)
@AL01357 DC    A(@CC03581)             LIST WITH   5 ARGUMENT(S)
         DC    A(@CC00831)
         DC    A(@CC00817)
         DC    A(@CC00805)
         DC    A(@CF00119)
@AL01373 DC    A(@CC03611)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CC00813)
         DC    A(@CC00823)
         DC    A(@CF00119)
@AL01379 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL01963 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL02452 DC    A(@CC00815)             LIST WITH   5 ARGUMENT(S)
@AL01425 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL02413 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL02570 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL02619 DC    A(@CC00823)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CC00817)
@AL00680 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL02126 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL02623 DC    A(@CC00831)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00119)
@AL01931 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL02446 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL02638 DC    A(@CC03611)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CC00815)
@AL02114 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL02621 DC    A(@CC00805)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00119)
@AL02646 DC    A(@CC00900)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@AL00001 DS    6A
@TF00001 DS    F
IDCRS01  CSECT
         DS    0F
@CF00119 DC    F'0'
@CF00219 DC    F'1'
@CH00219 EQU   @CF00219+2
@CF00157 DC    F'2'
@CH00157 EQU   @CF00157+2
@CF00166 DC    F'3'
@CH00166 EQU   @CF00166+2
@CF00046 DC    F'4'
@CH00046 EQU   @CF00046+2
@CF00287 DC    F'5'
@CF00035 DC    F'8'
@CH00035 EQU   @CF00035+2
@CF00040 DC    F'9'
@CH00040 EQU   @CF00040+2
@CF00478 DC    F'16'
@CH00478 EQU   @CF00478+2
@CF00968 DC    F'38'
@CF03733 DC    F'111'
@CF03588 DC    F'125'
@CF03589 DC    F'126'
@CF01850 DC    F'127'
@CH01850 EQU   @CF01850+2
@CF03738 DC    F'168'
@CF00745 DC    F'512'
@CF03736 DC    F'1490'
@CF03741 DC    F'2040'
@CF03735 DC    F'5320'
@CF03802 DC    F'-532'
@CF03776 DC    F'-8'
@CF03777 DC    F'-4'
@CF00734 DC    XL4'E4E5F004'
@CF00736 DC    XL4'E4E5F003'
@CF00738 DC    XL4'E4E5F00F'
@DATD    DSECT
         DS    0D
@TS00001 DS    CL95
         DS    CL1
RSREGSAV DS    CL1800
         ORG   RSREGSAV
RSREGS   DS    25CL72
         ORG   RSREGSAV+1800
RS2      DS    CL100
RS3      DS    CL32
RS5      DS    CL16
RSLAST   DS    CL2160
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRS01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV03434 DC    V(IDCRS02)
@CV03435 DC    V(IDCRS03)
@CV03436 DC    V(IDCRS04)
@CV03437 DC    V(IDCRS05)
@CV03438 DC    V(IDCRS06)
@CV03439 DC    V(IDCRS07)
@CV03481 DC    V(ENSURECI)
@CV03483 DC    V(ASSOC)
@CV03498 DC    V(RECMGMT)
@CV03499 DC    V(CATRCDSU)
@CV03538 DC    V(IDCRS5BV)
@CV03539 DC    V(IDCRS5SR)
@CV03542 DC    V(IDCRS6DC)
@CV03544 DC    V(CKERR)
@CV03580 DC    V(IDCRS6DO)
@CV03590 DC    V(WFDEF)
@CV03595 DC    V(IDCRS6CM)
@CV03596 DC    V(IDCRS5BR)
@CV03619 DC    V(VOLCHK)
@CV03633 DC    V(IDCRS5SV)
@CV03636 DC    V(ADDUPCR)
@CV03645 DC    V(FIND)
@CV03677 DC    V(IDCRS5EN)
@CV03679 DC    V(DELTN)
@CV03680 DC    V(ADDTN)
@CV03681 DC    V(CRAUPCHN)
@CV03684 DC    V(RENAMEP)
@CV03685 DC    V(UPDCCR)
@CV03686 DC    V(FRCRCCR)
@CV03700 DC    V(RENAMEF)
@CV03723 DC    V(WFDEL)
@CV03728 DC    V(IDCRS6CD)
         DS    0D
MAXCINO  DC    XL4'3FFFFF'
@CC00777 DC    C'IDCUT1  '
@CC00779 DC    C'SYSALLDA'
@CC00781 DC    C'SYSIGGV2'
@CC01088 DC    C'ENTNAME '
@CC01092 DC    C'VOLTSTMP'
@CC01094 DC    C'CATACB  '
@CC01096 DC    C'ATTR1   '
@CC03584 DC    C'RETURN'
@CC00900 DC    C'RS01'
@CC00902 DC    C'RS02'
@CC00904 DC    C'RS03'
@CC03474 DC    C'RSWA'
@CC03487 DC    C'RS00'
@CC03496 DC    C'RSCI'
@CC03515 DC    C'RSC1'
@CC03521 DC    C'RSCO'
@CC03543 DC    C'TERM'
@CC03547 DC    C'RSC2'
@CC03569 DC    C'RSIN'
@CC03585 EQU   @CC03584
@CC03587 DC    C'CIXL'
@CC03603 DC    C'RSI1'
@CC03608 DC    C'RSME'
@CC03620 DC    C'RSM1'
@CC03628 DC    C'RSPR'
@CC03646 DC    C'RSP1'
@CC03650 DC    C'RSRE'
@CC03657 DC    C'RSR1'
@CC03663 DC    C'RSUP'
@CC03687 DC    C'RSU1'
@CC03693 DC    C'RSUC'
@CC03711 DC    C'RSU2'
@CC03715 DC    C'RSWR'
@CC03721 DC    C'RSCL'
@CC03722 DC    C'RSC3'
@CC00805 EQU   @CC01094
@CC00813 EQU   @CC01096
@CC00815 DC    C'B'
@CC00817 DC    C'U'
@CC00823 EQU   @CC03584
@CC00831 DC    C'W'
@CC00833 EQU   @CC01092
@CC03581 DC    C'O'
@CC03611 DC    C'N'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
TNTYPES  DC    CL11'CDIAXBVUMGR'
MAXEXPDT DC    X'99999F'
DUMMYNM  DC    X'FFFFFFFFFFFFFFFF'
RDFCIDF  DC    X'0001F901F90000'
PACKF    DC    X'0F'
DSCB1ID  DC    X'F1'
VOLUNUSE DC    X'0000'
NULLDIG  DC    X'00'
BADVOLSW DC    X'00'
FMT3NULL DC    X'0000000000'
DS4DSNM  DS    CL44
         ORG   DS4DSNM
@NM00040 DC    44X'04'
         ORG   DS4DSNM+44
MODID    DC    CL4'RS01'
         DS    CL2
PATCH    DS    CL800
         ORG   PATCH
@NM00216 DC    CL32'PATCH 800 BYTES LAST USED 000000'
@NM00217 DC    768X'00'
         ORG   PATCH+800
TRTBLE   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
DEFNMTAB DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'PASSWALL'
         DC    CL8'AMDSBCAT'
         DC    CL8'DSATTR'
         DC    CL8'LRECL'
         DC    CL8'SPACPARM'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG8     EQU   @08
REG13    EQU   @13
REG15    EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG14    EQU   @14
REG7     EQU   @07
REG9     EQU   @09
CVTPTR   EQU   16
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTIOH   EQU   GDTTBL+36
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSACA0 EQU   0
IDCSARV0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITUCB  EQU   UNITABL
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IDCIOSI0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
IOCEXT   EQU   IOCSTR+64
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
IOINFVOL EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGILP  EQU   DARGLIST+12
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CATNM    EQU   0
CATNMPLN EQU   CATNM
CATNMPAS EQU   CATNM+1
CATNMFLG EQU   CATNM+10
CATNMLEN EQU   CATNM+20
CATNMVAL EQU   CATNM+21
CATDN    EQU   0
CATDNLEN EQU   CATDN
CATDNVAL EQU   CATDN+1
MRPW     EQU   0
MRPWLEN  EQU   MRPW
MRPWVAL  EQU   MRPW+1
WFDN     EQU   0
WCAT     EQU   0
WCATPLN  EQU   WCAT
WCATPAS  EQU   WCAT+1
WCATFLG  EQU   WCAT+10
WCATLEN  EQU   WCAT+20
WCATVAL  EQU   WCAT+21
IGN      EQU   0
CFILECNT EQU   0
CRADNPTR EQU   0
CRADN    EQU   0
CRADNLEN EQU   CRADN
CRADNVAL EQU   CRADN+1
NONEPTR  EQU   0
CVOLCNT  EQU   0
CRAVLPTR EQU   0
CRAVL    EQU   0
CRAVLLEN EQU   CRAVL
CRAVLVAL EQU   CRAVL+1
CRADVPTR EQU   0
CRADV    EQU   0
WFILE    EQU   0
WFILEPLN EQU   WFILE
WFILEPAS EQU   WFILE+1
WFILELEN EQU   WFILE+9
WFILEVAL EQU   WFILE+10
IODATA   EQU   0
IODSID   EQU   IODATA+16
IOCSEX   EQU   0
IOCRPL   EQU   IOCSEX+4
IOCXAD   EQU   IOCSEX+16
IOCXPM   EQU   IOCSEX+20
IOCFLG   EQU   IOCSEX+32
IOCDEV   EQU   IOCSEX+33
IOCINF   EQU   IOCSEX+34
IOCMOD   EQU   IOCSEX+35
IOCDLM   EQU   IOCSEX+36
IOCRCV   EQU   IOCSEX+44
CATIEXT  EQU   0
CATILRBA EQU   CATIEXT+12
CATIHRBA EQU   CATIEXT+16
VOLSERTB EQU   0
VOLSRCI  EQU   VOLSERTB+4
VOLSRFLG EQU   VOLSERTB+8
VOLSRNTK EQU   VOLSERTB+12
VOLSRSER EQU   VOLSERTB+14
VOLSRTS  EQU   VOLSERTB+20
RESVOL   EQU   0
RESVLUPD EQU   RESVOL+4
RESVLFLG EQU   RESVOL+8
RESVLMNT EQU   RESVLFLG
RESVLALE EQU   RESVLFLG
RESVLLAS EQU   RESVLFLG
RESVLBAD EQU   RESVLFLG
RESVLNEX EQU   RESVOL+10
RESVLSER EQU   RESVOL+14
RESVLDDN EQU   RESVOL+20
RESVLEXT EQU   RESVOL+28
RSF1RNTB EQU   0
RSWORK   EQU   0
RSA      EQU   RSWORK
RSAVAIL  EQU   RSWORK+8
RSCABHP1 EQU   RSWORK+12
RSCABLP1 EQU   RSWORK+16
RSCADD   EQU   RSWORK+20
RSCADS   EQU   RSWORK+24
RSCAFUCI EQU   RSWORK+28
RSCAHACI EQU   RSWORK+32
RSCAHALC EQU   RSWORK+36
RSCANFCI EQU   RSWORK+44
RSCPE1   EQU   RSWORK+68
RSCPE2   EQU   RSWORK+72
RSCPE3   EQU   RSWORK+76
RSCPE5   EQU   RSWORK+84
RSCPE6   EQU   RSWORK+88
RSCPE7   EQU   RSWORK+92
RSCRVL   EQU   RSWORK+104
RSGCITS  EQU   RSWORK+108
RSGCITC  EQU   RSGCITS+8
@NM00045 EQU   RSGCITS+20
RSGDITS  EQU   RSWORK+136
RSGDITC  EQU   RSGDITS+8
@NM00048 EQU   RSGDITS+20
RSPSTACK EQU   RSWORK+164
RSPTWKC  EQU   RSPSTACK+8
RSTAB    EQU   RSWORK+192
RSTANCHR EQU   RSTAB
@NM00053 EQU   RSTAB+8
@NM00055 EQU   RSTAB+12
RSXXREGS EQU   RSWORK+212
RS01REGS EQU   RSXXREGS
RS01RG08 EQU   RS01REGS
RS01RG09 EQU   RS01REGS+4
RS02REGS EQU   RSXXREGS+20
RS02RG08 EQU   RS02REGS
RS03REGS EQU   RSXXREGS+40
RS03RG08 EQU   RS03REGS
RS04REGS EQU   RSXXREGS+60
RS04RG08 EQU   RS04REGS
RS05REGS EQU   RSXXREGS+80
RS05RG08 EQU   RS05REGS
RS06REGS EQU   RSXXREGS+100
RS06RG08 EQU   RS06REGS
RS07REGS EQU   RSXXREGS+120
RS07RG08 EQU   RS07REGS
RSAVAILN EQU   RSWORK+352
RSAVNEXT EQU   RSWORK+356
RSCMRR   EQU   RSWORK+364
RSCANFCN EQU   RSWORK+368
RSCRBP1  EQU   RSWORK+372
RSCREND  EQU   RSWORK+376
RSCURCI  EQU   RSWORK+380
RSCURRN  EQU   RSWORK+384
RSFDT    EQU   RSWORK+388
RSFPL    EQU   RSWORK+392
RSIOTBL  EQU   RSWORK+412
RSRABWA  EQU   RSWORK+416
RSWFPRIM EQU   RSWORK+420
RSWFSCND EQU   RSWORK+424
RSGRABCU EQU   RSWORK+428
RSRMBP   EQU   RSWORK+432
RSWFBP1  EQU   RSWORK+436
RSWFBP2  EQU   RSWORK+440
RSWFNEXT EQU   RSWORK+444
RSWFHURR EQU   RSWORK+448
RSVOLALL EQU   RSWORK+452
RSVOLLST EQU   RSWORK+460
RSREASSN EQU   RSWORK+468
RSREASS  EQU   RSWORK+472
RSTNCHN  EQU   RSWORK+476
RSENTPT  EQU   RSWORK+484
RSXCIEND EQU   RSWORK+496
RSXRREND EQU   RSWORK+500
RSGDT    EQU   RSWORK+504
RSMRPAS  EQU   RSWORK+508
RSWCDS   EQU   RSWORK+512
RSWCPAS  EQU   RSWORK+516
RSWFDD   EQU   RSWORK+520
RSWFPAS  EQU   RSWORK+524
RSWFDS   EQU   RSWORK+528
RSVTBENT EQU   RSWORK+532
RSVTIOCS EQU   RSWORK+536
RSRENEXT EQU   RSWORK+552
RSDUPNXT EQU   RSWORK+556
RSTNNXT  EQU   RSWORK+560
RSUCNXT  EQU   RSWORK+564
CAXWAPTR EQU   RSWORK+568
CBSPTR   EQU   RSWORK+572
CTGPLPTR EQU   RSWORK+576
CTGFLPTR EQU   RSWORK+580
RSCAPAS  EQU   RSWORK+588
RSCATACB EQU   RSWORK+592
RSCATUCB EQU   RSWORK+596
RSCIXLTA EQU   RSWORK+600
RSCRADD  EQU   RSWORK+608
RSUIRPT  EQU   RSWORK+612
RSUGLEN  EQU   RSWORK+616
RSSUBENP EQU   RSWORK+632
RSCATSCN EQU   RSWORK+644
RSCIREMC EQU   RSWORK+648
RSF1RNAM EQU   RSWORK+652
RSF1RNCU EQU   RSWORK+656
RSCHCRAN EQU   RSWORK+660
RSORVLLS EQU   RSWORK+668
RSIDX    EQU   RSWORK+686
RSIDX1   EQU   RSWORK+688
RSNOBLKT EQU   RSWORK+694
RSUCCINO EQU   RSWORK+697
RSUIOPT  EQU   RSWORK+700
RSCATDDN EQU   RSWORK+701
RSCATDSN EQU   RSWORK+709
RSCATPS  EQU   RSWORK+753
RSCATTN  EQU   RSWORK+761
RSCATNCI EQU   RSWORK+805
RSMRPS   EQU   RSWORK+814
RSWFDDNM EQU   RSWORK+822
RSWCATNM EQU   RSWORK+905
RSWCATPS EQU   RSWORK+949
RSWFPS   EQU   RSWORK+957
RSNEWCAT EQU   RSWORK+965
RSNCVLSR EQU   RSNEWCAT
RSNCDEVT EQU   RSNEWCAT+6
RSNCTS   EQU   RSNEWCAT+10
RSFLAGSN EQU   RSWORK+979
RSFLAGN1 EQU   RSFLAGSN
RSWFDEF  EQU   RSFLAGN1
RSWFOPN  EQU   RSFLAGN1
RSCROPN  EQU   RSFLAGN1
RSCAOPN  EQU   RSFLAGN1
RSVTOPN  EQU   RSFLAGN1
RSREASND EQU   RSFLAGN1
RSCARES  EQU   RSFLAGN1
RSIGNR   EQU   RSFLAGN1
RSFLAGN2 EQU   RSFLAGSN+1
RSENUFCI EQU   RSFLAGN2
RSCAEOV  EQU   RSFLAGN2
RSWFCREA EQU   RSFLAGN2
RSCRAUA  EQU   RSFLAGN2
RSALLC   EQU   RSFLAGN2
RSTERM   EQU   RSFLAGN2
RSCREOV  EQU   RSFLAGN2
RSFLAGSI EQU   RSWORK+981
RSFLAGI1 EQU   RSFLAGSI
RSREARR  EQU   RSFLAGI1
RSRENRR  EQU   RSFLAGI1
RSDUPNRR EQU   RSFLAGI1
RSFLAGI2 EQU   RSFLAGSI+1
RSMETRM  EQU   RSFLAGI2
RSMEOP   EQU   RSFLAGI2
RSMEBYV  EQU   RSFLAGI2
RSUCCATN EQU   RSFLAGI2
RSUCWFTN EQU   RSFLAGI2
RSUCTWWF EQU   RSFLAGI2
RSUCCCR  EQU   RSFLAGI2
RSSRNSCN EQU   RSFLAGI2+1
RSUCATN  EQU   RSFLAGI2+1
RSUCDTN  EQU   RSFLAGI2+1
RSBADVOL EQU   RSFLAGI2+1
RSRECREQ EQU   RSWORK+984
RSRTYPE  EQU   RSRECREQ
RSRGET   EQU   RSRTYPE
RSRADD   EQU   RSRTYPE
RSRUPDT  EQU   RSRTYPE
RSRPOS   EQU   RSRTYPE
RSRTERM  EQU   RSRTYPE
RSRFREE  EQU   RSRTYPE
RSROPT   EQU   RSRECREQ+1
RSRDS    EQU   RSROPT
RSRWF    EQU   RSRDS
RSRCAT   EQU   RSRDS
RSRCRA   EQU   RSRDS
RSRBY    EQU   RSROPT
RSRKEY   EQU   RSRBY
RSRFOR   EQU   RSROPT
RSRUPD   EQU   RSRFOR
RSRUSE   EQU   RSROPT
RSRDIR   EQU   RSRUSE
RSREND   EQU   RSROPT
RSASSOC  EQU   RSWORK+988
RSASSTBL EQU   RSASSOC
RSASSFLG EQU   RSASSOC+16
RSASSFL1 EQU   RSASSFLG
RSGDG    EQU   RSASSOC+20
RSGDGTB  EQU   RSGDG
RSPROCVL EQU   RSWORK+1064
RSMAPS   EQU   RSPROCVL
RSSBMAP  EQU   RSMAPS+8
RSPCBMAP EQU   RSMAPS+12
RSMAPAD  EQU   RSPROCVL+20
RSPVSNT  EQU   RSPROCVL+48
RSPVTTNN EQU   RSPROCVL+68
@NM00062 EQU   RSPROCVL+84
RSPVSETB EQU   @NM00062
RSPVFLG1 EQU   @NM00062+1
RSPVFLG2 EQU   @NM00062+2
RSEOVWA  EQU   RSWORK+1152
@NM00065 EQU   RSEOVWA+8
@NM00067 EQU   RSEOVWA+12
RSEOVFLG EQU   @NM00067+1
RSGETVIA EQU   RSWORK+1168
RSVIACRA EQU   RSGETVIA
@NM00072 EQU   RSGETVIA+12
RSVIAFLG EQU   @NM00072
@NM00074 EQU   RSGETVIA+16
RSREASW  EQU   RSWORK+1188
REASSW1  EQU   RSREASW
REASSW2  EQU   RSREASW
RSCKERR  EQU   RSWORK+1192
RSCKERN  EQU   RSCKERR
RSCKTERM EQU   RSCKERR+4
RSCKMVAR EQU   RSCKERR+8
RSCKERRW EQU   RSWORK+1240
RSLASTCC EQU   RSCKERRW
RSCKTIME EQU   RSCKERRW+8
RSCATRC  EQU   RSCKERRW+42
RSCKFLAG EQU   RSCKERRW+50
RSCIWA   EQU   RSWORK+1292
RSCIEXPT EQU   RSCIWA
RSCIEXCU EQU   RSCIWA+4
RSCINXCI EQU   RSCIWA+8
RSCILCI  EQU   RSCIWA+12
RSCIRMEN EQU   RSCIWA+16
RSCIDFCI EQU   RSCIWA+20
RSCIEXT  EQU   RSCIWA+24
RSCISVLK EQU   RSCIWA+44
RSINWA   EQU   RSWORK+1340
RSINUAP  EQU   RSINWA
RSINWACB EQU   RSINWA+4
RSINCVPT EQU   RSINWA+8
RSINDVPT EQU   RSINWA+12
RSINDNPT EQU   RSINWA+16
RSINDDPT EQU   RSINWA+20
RSINDVL  EQU   RSINWA+24
RSINDVLL EQU   RSINDVL
RSINDVLV EQU   RSINDVL+1
RSINSVVL EQU   RSINWA+33
RSINVLSR EQU   RSINWA+39
RSINTS   EQU   RSINWA+45
RSINATR1 EQU   RSINWA+53
RSINRCV  EQU   RSINATR1
RSINFLGS EQU   RSINWA+54
RSINALL  EQU   RSINFLGS
RSSVENT  EQU   RSINWA+55
RSRNWA   EQU   RSWORK+1488
RSRNPLST EQU   RSRNWA
RSRNFLGS EQU   RSRNWA+46
RSRNVL   EQU   RSRNWA+99
RSRNUL   EQU   RSRNWA+106
RSRWORK  EQU   RSWORK+1604
RSRFLGS  EQU   RSRWORK+64
RSWFWA   EQU   RSWORK+1672
RSADWA   EQU   RSWORK+1724
RSADVL   EQU   RSADWA+32
RSADUL   EQU   RSADWA+39
RSCRWA   EQU   RSWORK+1772
RSGENWRK EQU   RSWORK+1780
RSGENDTE EQU   RSGENWRK+12
RSVOLWA  EQU   RSWORK+1796
RSVF1TS  EQU   RSVOLWA+52
RSVF1EXT EQU   RSVOLWA+75
RSVFLAGS EQU   RSVOLWA+140
RSDF00W  EQU   RSWORK+1940
LISTSCAN EQU   RSDF00W+4
IOCSPTR  EQU   RSDF00W+8
OPNPTR   EQU   RSDF00W+12
DDSTRU   EQU   RSDF00W+16
FSADDR   EQU   RSDF00W+20
ERCNVADR EQU   RSDF00W+24
DMPINDEX EQU   RSDF00W+28
TESTRC   EQU   RSDF00W+34
RSCNVTCC EQU   RSWORK+1980
RSCCHHP  EQU   RSCNVTCC+4
RSTTNN   EQU   RSCNVTCC+8
RSCNVTCF EQU   RSCNVTCC+12
RSCNVTF1 EQU   RSCNVTCF
RSWFNDWA EQU   RSWORK+1996
RSWASNVT EQU   RSWFNDWA+4
RSWSNFLG EQU   RSWFNDWA+8
RSWFONE  EQU   RSWSNFLG
RSWGCODE EQU   RSWFNDWA+9
RSGENMWA EQU   RSWORK+2052
RSGENAM  EQU   RSGENMWA+9
RSGDATE  EQU   RSGENAM+21
RSGTIME  EQU   RSGENAM+26
RSCDSDWA EQU   RSWORK+2108
RSCDSDIN EQU   RSCDSDWA
RSCDSDW  EQU   RSCDSDWA+16
RSMARKUN EQU   RSWORK+2144
RSCSWA   EQU   RSWORK+2152
LASTCC   EQU   0
GRAB     EQU   0
GRABFLGS EQU   GRAB
GRABAFLS EQU   GRABFLGS+1
GRABAFL1 EQU   GRABAFLS
GRABSFXT EQU   GRABAFL1
GRABSNRA EQU   GRABAFL1
GRABSEFN EQU   GRABAFL1
GRABSIOI EQU   GRABAFL1
GRABSIOF EQU   GRABAFL1
GRABSIOT EQU   GRABAFL1
GRABSDUP EQU   GRABAFL1
GRABAFL2 EQU   GRABAFLS+1
GRABSN   EQU   GRAB+3
GRABBB   EQU   GRAB+4
GRABRABE EQU   GRAB+8
GRABCURR EQU   GRAB+12
GRABRABS EQU   GRAB+16
GRABRAB1 EQU   GRABRABS
GRABRAB2 EQU   GRABRABS+4
RSRAB    EQU   0
RABFLGS  EQU   RSRAB
RABFLG1  EQU   RABFLGS
RABADD   EQU   RABFLG1
RABRRN   EQU   RABFLG1
RABIOIGN EQU   RABFLG1
RABDUP   EQU   RABFLG1
RABRCDA  EQU   RSRAB+4
RABBUF   EQU   RSRAB+8
RABPROC  EQU   RSRAB+520
RMB      EQU   0
RMBCTL   EQU   RMB
RMBFLAGS EQU   RMBCTL+8
RSXCIXLT EQU   0
RSXCIID  EQU   RSXCIXLT
RSXCIENT EQU   RSXCIXLT+8
RSXCIBEG EQU   RSXCIENT
RSXCILN  EQU   RSXCIENT+4
RSXCIFLG EQU   RSXCIENT+8
RSXCIFL1 EQU   RSXCIFLG
RSXCIRNG EQU   RSXCIFL1
RSXCIREL EQU   RSXCIENT+12
UIODSN   EQU   0
UIODNM   EQU   UIODSN+4
UIOVOL   EQU   0
UIOVLS   EQU   UIOVOL+4
RECIOWA  EQU   0
GRABSWF  EQU   RECIOWA
GRABSCA  EQU   RECIOWA+40
GRABSCR  EQU   RECIOWA+80
RSVUENT  EQU   RECIOWA+664
RSVOLENT EQU   RECIOWA+692
ALLUL    EQU   RECIOWA+784
ALLVL    EQU   RECIOWA+796
RSCAMAJN EQU   RECIOWA+808
RSCAMINN EQU   RECIOWA+816
RSCAMINL EQU   RSCAMINN
RSCAMIND EQU   RSCAMINN+1
UCBAREA  EQU   RECIOWA+861
UCATWA   EQU   RECIOWA+874
UCATWTLN EQU   UCATWA
RABS     EQU   0
WFBUF1   EQU   0
WFBUF2   EQU   0
CRBUF1   EQU   0
CABUFL1  EQU   0
RSCNCCHH EQU   0
TASSENT  EQU   0
TASSFL1  EQU   TASSENT+1
TASSO    EQU   0
TABANCHR EQU   0
TABC     EQU   TABANCHR+8
@NM00102 EQU   TABANCHR+20
TABHEAD  EQU   0
THEAD    EQU   TABHEAD
PTWORK   EQU   0
PTYPEDTA EQU   PTWORK+12
PTGCIT   EQU   PTYPEDTA
@NM00104 EQU   PTGCIT
@NM00106 EQU   PTGCIT+4
@NM00108 EQU   PTGCIT+8
PTCITCUR EQU   PTGCIT+12
PTGDIT   EQU   PTYPEDTA+24
@NM00110 EQU   PTGDIT
@NM00112 EQU   PTGDIT+4
@NM00114 EQU   PTGDIT+8
PTDITCUR EQU   PTGDIT+12
PTASSO   EQU   PTYPEDTA+48
PTASSCUR EQU   PTASSO+4
PTASSOEA EQU   PTASSO+8
PTASSOE1 EQU   PTASSO+12
PTASSOE  EQU   PTASSOE1
PTASSEXP EQU   PTASSO+52
PTINDX   EQU   PTYPEDTA+104
PTVERDI  EQU   PTYPEDTA+120
PTVALL   EQU   PTVERDI
PTVDI    EQU   PTVALL
PTXALIAS EQU   PTYPEDTA+152
PTXFLAGS EQU   PTXALIAS+30
PTXFLAG1 EQU   PTXFLAGS
PTFLAGS  EQU   PTYPEDTA+190
PTF1     EQU   PTFLAGS
PTF2     EQU   PTFLAGS+1
PTLOC    EQU   PTWORK+204
@NM00120 EQU   PTLOC
@NM00122 EQU   PTLOC+12
PTLDITFB EQU   PTLOC+18
PTASOE   EQU   0
GCITS    EQU   0
CITABE   EQU   0
CITFLA   EQU   CITABE
@NM00127 EQU   CITABE+4
@NM00128 EQU   CITABE+8
@NM00129 EQU   CITABE+12
@NM00131 EQU   CITABE+16
GDITS    EQU   0
DITABE   EQU   0
DITFA    EQU   DITABE
DITFLB   EQU   DITABE+1
@NM00140 EQU   DITABE+4
DITSN    EQU   @NM00140
DITVSN   EQU   DITSN
@NM00143 EQU   DITABE+8
GDGLDS   EQU   0
GDGLHEAD EQU   GDGLDS
GDGFLG   EQU   GDGLHEAD+30
GDGLENTS EQU   GDGLDS+32
GDGENT   EQU   GDGLENTS
RSFSNVT  EQU   0
RSFLAGS  EQU   RSFSNVT+1
RSFENTLN EQU   RSFSNVT+3
RSFAENT  EQU   RSFSNVT+8
RSFCNTTN EQU   RSFSNVT+12
RSFATTNN EQU   RSFSNVT+16
SNTAB    EQU   0
SNFIXED  EQU   SNTAB
SNFLAG   EQU   SNFIXED
SNENTRY  EQU   SNTAB+24
SNVDATA  EQU   SNENTRY
SSPHDFLG EQU   SNVDATA+8
SSPEXTNT EQU   SNVDATA+10
SNASSOC  EQU   0
SNGLEV   EQU   SNASSOC+28
SNVGO    EQU   0
SITYPEXT EQU   SNVGO+34
SNEXTENT EQU   SNVGO+43
SNVSBM   EQU   0
SNDSDIR  EQU   0
SDSIDFLG EQU   SNDSDIR+24
SNTTNN   EQU   0
CATGOPT  EQU   0
CATGOCI  EQU   CATGOPT
CATGOFLG EQU   CATGOCI
CATGOGC1 EQU   CATGOPT+3
CATGOSEQ EQU   CATGOPT+4
CATRCD   EQU   0
RCDCINO  EQU   CATRCD+1
RCDCRAVL EQU   CATRCD+5
RCDCRACI EQU   CATRCD+11
RCDCRADT EQU   CATRCD+14
RCDRACTS EQU   CATRCD+18
RCDID    EQU   CATRCD+44
RCDSIZ   EQU   CATRCD+45
REPCNTRL EQU   0
EXTRCDPT EQU   REPCNTRL
VARFIELD EQU   0
VARLEN   EQU   VARFIELD
CNTRLINF EQU   0
LENFIX   EQU   CNTRLINF+1
CTGRBASE EQU   0
CNAME    EQU   CTGRBASE+49
COWNID   EQU   CTGRBASE+93
CATTR    EQU   CTGRBASE+107
CATTR1   EQU   CATTR
CATTR2   EQU   CATTR+1
COPEN    EQU   CTGRBASE+109
CSPACPRM EQU   CTGRBASE+114
CSEC     EQU   CSPACPRM+3
CHIA     EQU   CTGRBASE+125
CCR      EQU   0
CCRHACI  EQU   CCR+45
CCRNFCI  EQU   CCR+48
CCRCDCI  EQU   CCR+51
CCRFDCI  EQU   CCR+54
ASGO     EQU   0
ASG1     EQU   ASGO+2
ASG2     EQU   ASGO+6
ASGOGDG  EQU   0
DSDIR    EQU   0
SPACEPRM EQU   0
SPCOPTNS EQU   SPACEPRM+6
RGATTRFL EQU   0
RGATTR1  EQU   RGATTRFL
RGATTSG1 EQU   RGATTRFL+1
VOLGO    EQU   0
NOBLKTRK EQU   VOLGO+32
GDGRCD   EQU   0
GENLVLS  EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGGTNXT EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGTYPE  EQU   CTGPL+18
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
CTGFV    EQU   0
CTGFVPRO EQU   CTGFV+1
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVLMT EQU   CTGFV+72
CTGFVGAT EQU   CTGFV+76
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTCBSP  EQU   CVTMAP+256
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
AMCBS    EQU   0
CBSACB   EQU   AMCBS+8
CBSCMP   EQU   AMCBS+16
CBSVSRT  EQU   AMCBS+32
IGGCAXWA EQU   0
CAXFLGS  EQU   IGGCAXWA+8
CAXFLG2  EQU   IGGCAXWA+9
CAXFLG3  EQU   IGGCAXWA+10
CAXACT   EQU   IGGCAXWA+11
CAXCCR   EQU   IGGCAXWA+32
CAXCNAM  EQU   IGGCAXWA+52
CAXOPLST EQU   IGGCAXWA+96
COPTS    EQU   CAXOPLST
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBDVIND EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBVVIC  EQU   ACBINFLG
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
ACBUAPTR EQU   ACBCOMN+64
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
AREGSAVE EQU   0
RSREGMOD EQU   AREGSAVE
RSREGB   EQU   AREGSAVE+4
RSREGF   EQU   AREGSAVE+8
INITDSN  EQU   0
INITVLSR EQU   0
INITTS   EQU   0
INITACB  EQU   0
INITATR1 EQU   0
INITWACB EQU   0
UINFHDR  EQU   0
UINFTLN  EQU   UINFHDR
FNDEXTS  EQU   0
ALLP     EQU   0
ALLPPTR  EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
BMAP     EQU   0
CABUFH1  EQU   0
CAT      EQU   0
CATSN    EQU   0
CFILE    EQU   0
CIN      EQU   0
CVOL     EQU   0
DMPTRM   EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NIGN     EQU   0
NONE     EQU   0
PTASSEX  EQU   0
GDTTBLX  EQU   0
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
ALASTCC  EQU   0
RSWFLD   EQU   RABPROC
RSWCHPTR EQU   RSWFLD
RSWDUPTR EQU   RSWFLD+4
RSWFKG1  EQU   RSWFLD+8
RSWFCRA  EQU   RSWFKG1
RSWDLCAT EQU   RSWFKG1
RSWUPCAT EQU   RSWFKG1
RSWUPCRA EQU   RSWFKG1
RSWRASCI EQU   RSWFKG1
RSWASSCK EQU   RSWFKG1
RSWDUPCI EQU   RSWFKG1
RSWFLG2  EQU   RSWFLD+9
RSWINVCI EQU   RSWFLG2
RSWDUPRR EQU   RSWFLG2
RSWCHNRR EQU   RSWFLG2
RSWCHRA  EQU   RSWFLG2
RABARRAY EQU   GRABRABS
@NM00165 EQU   CATTR1
CCATTR   EQU   @NM00165
@NM00166 EQU   CCATTR
@NM00168 EQU   CATTR1
CRGATTR  EQU   @NM00168
CUPG     EQU   CRGATTR
DEVCHARS EQU   RABBUF+101
@NM00177 EQU   DEVCHARS
RTDEVUCB EQU   @NM00177
RTNOTRKS EQU   @NM00177+10
RTBOKAB  EQU   @NM00177+14
RTDVFLGS EQU   @NM00177+17
@NM00191 EQU   CTGDDNM
CTGPROB  EQU   @NM00191
CTGREASN EQU   CTGPROB+2
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
RSUPENTF EQU   RCDSIZ
RSUCENTF EQU   RCDSIZ
BMAPARRY EQU   RSMAPS
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
RTTOLFCT EQU   @NM00177+18
RTTOLFLG EQU   RTDVFLGS
@NM00180 EQU   RTDVFLGS
RTKABFLG EQU   RTDVFLGS
@NM00179 EQU   RTDVFLGS
RTBONK   EQU   @NM00177+16
RTBOKLB  EQU   RTBOKAB+1
RTBOKNLB EQU   RTBOKAB
RTTRKSIZ EQU   @NM00177+12
RTNOCYLS EQU   @NM00177+8
RTMXDBLK EQU   @NM00177+4
RTCLSTYP EQU   RTDEVUCB+2
@NM00178 EQU   RTDEVUCB
@NM00169 EQU   CRGATTR
CUPD     EQU   CUPG
CPGSP    EQU   @NM00166
@NM00167 EQU   @NM00166
@NM00094 EQU   RSWFLG2
RSWDSDIR EQU   RSWFLG2
RSWUPCCH EQU   RSWFLG2
RSWDICHK EQU   RSWFLG2
@NM00093 EQU   RSWFKG1
FDTVERB  EQU   FDTTBL
UINFRLN  EQU   UINFHDR+2
RSREG12  EQU   AREGSAVE+68
RSREG11  EQU   AREGSAVE+64
RSREG10  EQU   AREGSAVE+60
RSREG09  EQU   AREGSAVE+56
RSREG08  EQU   AREGSAVE+52
RSREG07  EQU   AREGSAVE+48
RSREG06  EQU   AREGSAVE+44
RSREG05  EQU   AREGSAVE+40
RSREG04  EQU   AREGSAVE+36
RSREG03  EQU   AREGSAVE+32
RSREG02  EQU   AREGSAVE+28
RSREG01  EQU   AREGSAVE+24
RSREG00  EQU   AREGSAVE+20
RSREG15  EQU   AREGSAVE+16
RSREG14  EQU   AREGSAVE+12
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00215 EQU   IDAAMDSB+41
@NM00214 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDCINV  EQU   IDAAMDSB+20
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDKEYLN EQU   IDAAMDSB+8
AMDRKP   EQU   IDAAMDSB+6
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00213 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
@NM00212 EQU   ACBINFLG+1
ACBBYPSS EQU   ACBINFLG
ACBSDS   EQU   ACBVVIC
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00211 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00210 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00209 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00208 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00207 EQU   ACBDSORG
ACBOPTJ  EQU   ACBDVIND
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00206 EQU   ACBCCTYP
ACBTRCID EQU   ACBCCTYP
@NM00205 EQU   ACBRECFM
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00204 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00203 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00202 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
CAXCRACB EQU   IGGCAXWA+112
CAXJDE   EQU   IGGCAXWA+108
CAXCCA   EQU   IGGCAXWA+104
CAXOPEWA EQU   IGGCAXWA+100
COPACB   EQU   CAXOPLST+1
@NM00201 EQU   COPTS
CENLST   EQU   COPTS
@NM00200 EQU   CAXCNAM+22
CAXRADDN EQU   CAXCNAM+14
CAXRATEP EQU   CAXCNAM+10
CAXRACTS EQU   CAXCNAM+6
CAXVOLID EQU   CAXCNAM
CAXRPL   EQU   IGGCAXWA+48
CAXRPLCT EQU   IGGCAXWA+46
CAXASID  EQU   IGGCAXWA+44
CAXFDCI  EQU   CAXCCR+9
CAXCDCI  EQU   CAXCCR+6
CAXNFCI  EQU   CAXCCR+3
CAXHACI  EQU   CAXCCR
CAXUCB   EQU   IGGCAXWA+28
CAXACB   EQU   IGGCAXWA+24
CAXDRWP  EQU   IGGCAXWA+20
CAXSCHWA EQU   IGGCAXWA+16
CAXATIOT EQU   IGGCAXWA+12
@NM00199 EQU   CAXFLG3
CAXF3B6  EQU   CAXFLG3
CAXF3B5  EQU   CAXFLG3
@NM00198 EQU   CAXFLG3
CAXF3ANE EQU   CAXFLG3
CAXF3AT  EQU   CAXFLG3
CAXF2VTU EQU   CAXFLG2
CAXF2REC EQU   CAXFLG2
CAXF2CA  EQU   CAXFLG2
CAXF2CLR EQU   CAXFLG2
CAXF2IOE EQU   CAXFLG2
CAXF2NCR EQU   CAXFLG2
CAXF2NDD EQU   CAXFLG2
CAXF2DT  EQU   CAXFLG2
CAXSCR   EQU   CAXFLGS
CAXCMR   EQU   CAXFLGS
CAXMCT   EQU   CAXFLGS
CAXCMP   EQU   CAXFLGS
CAXEOV   EQU   CAXFLGS
CAXCLS   EQU   CAXFLGS
CAXOPN   EQU   CAXFLGS
CAXBLD   EQU   CAXFLGS
CAXCHN   EQU   IGGCAXWA+4
@NM00197 EQU   IGGCAXWA+1
CAXID    EQU   IGGCAXWA
CBSVPTR  EQU   CBSVSRT+4
CBSVUSE  EQU   CBSVSRT
CBSCRTCB EQU   AMCBS+28
CBSCRACA EQU   AMCBS+24
CBSCAXCN EQU   AMCBS+20
CBSMCUCB EQU   CBSCMP
CBSCBP   EQU   AMCBS+12
CBSMCSTA EQU   AMCBS+4
CBSSIZ   EQU   AMCBS+2
CBSID    EQU   AMCBS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00196 EQU   CVTFIX+248
@NM00195 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
CTGFVWKA EQU   CTGFV+88
CTGFVPWD EQU   CTGFV+84
CTGFVNAM EQU   CTGFV+80
CTGFVUPG EQU   CTGFVGAT
CTGFVEXT EQU   CTGFVLMT
CTGFVLRS EQU   CTGFV+68
CTGFVBUF EQU   CTGFV+64
CTGFVATR EQU   CTGFV+60
CTGFVFSN EQU   CTGFVAMD
CTGFVTTR EQU   CTGFVSPC
CTGFVDVT EQU   CTGFV+48
CTGFVRNG EQU   CTGFV+44
CTGFVVLT EQU   CTGFV+40
CTGFVCRE EQU   CTGFV+36
CTGFVEXP EQU   CTGFV+32
CTGFVOWN EQU   CTGFV+28
CTGFVSTY EQU   CTGFV+24
CTGFVENT EQU   CTGFV+20
CTGFVIND EQU   CTGFV+16
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
CTGFVDCH EQU   CTGFV+4
@NM00194 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00193 EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
CTGFVTYP EQU   CTGFV
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00192 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
@NM00190 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
@NM00189 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
@NM00188 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00187 EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00186 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGUCRAX EQU   CTGGTNXT
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
GDGLVL   EQU   GENLVLS+2
@NM00185 EQU   GENLVLS
@NM00184 EQU   GDGRCD+108
GDGLIMIT EQU   GDGRCD+107
@NM00183 EQU   GDGRCD
@NM00182 EQU   VOLGO+34
@NM00181 EQU   VOLGO
@NM00176 EQU   RGATTSG1
RGATSUP1 EQU   RGATTSG1
@NM00175 EQU   RGATTR1
RGATTUPG EQU   RGATTR1
SPCROUND EQU   SPCOPTNS
SPCALXRQ EQU   SPCOPTNS
SPCMXIGR EQU   SPCOPTNS
SPCCNTIG EQU   SPCOPTNS
@NM00174 EQU   SPCOPTNS
SPCRQTYP EQU   SPCOPTNS
SPCSECDQ EQU   SPACEPRM+3
SPCPRIMQ EQU   SPACEPRM
DSSUMTT  EQU   DSDIR+9
DSCRETS  EQU   DSDIR+5
DSIDNO   EQU   DSDIR+2
@NM00173 EQU   DSDIR
ASGDGLVL EQU   ASGOGDG+6
@NM00172 EQU   ASGOGDG+2
@NM00171 EQU   ASGOGDG
ASCI2    EQU   ASG2+1
ASTYPE2  EQU   ASG2
ASCI     EQU   ASG1+1
ASTYPE   EQU   ASG1
@NM00170 EQU   ASGO
CCRRBAS  EQU   CCR+57
CCRID    EQU   CCR+44
CCRKEY   EQU   CCR
CEXT     EQU   CTGRBASE+135
CDOSUINF EQU   CTGRBASE+133
CLRECL   EQU   CTGRBASE+129
CHIU     EQU   CTGRBASE+121
CSORT    EQU   CSPACPRM+6
CPRIM    EQU   CSPACPRM
CBUF     EQU   CTGRBASE+110
@NM00164 EQU   COPEN
COPENDS  EQU   COPEN
CNUS     EQU   CATTR2
@NM00163 EQU   CATTR2
CATTRSSH EQU   CATTR2
CATTRISH EQU   CATTR2
CTRKOV   EQU   CATTR1
CTEMP    EQU   CATTR1
CINHIB   EQU   CATTR1
CRECOV   EQU   CATTR1
CERASE   EQU   CATTR1
CREUSE   EQU   CATTR1
CUNIQ    EQU   CATTR1
CSP      EQU   CATTR1
CEXP     EQU   CTGRBASE+104
CCRE     EQU   CTGRBASE+101
@NM00162 EQU   CTGRBASE
CNTVAR   EQU   CNTRLINF
VARINFO  EQU   VARFIELD+2
REPGOPT  EQU   REPCNTRL+6
REPCNT   EQU   REPCNTRL+5
@NM00161 EQU   EXTRCDPT+3
EXTGOCI  EQU   EXTRCDPT
NREPLF   EQU   CATRCD+48
NREPCV   EQU   CATRCD+47
@NM00160 EQU   CATRCD+26
RCDDICTS EQU   CATRCD+22
RCDRELID EQU   CATRCD+4
RCDKEYTY EQU   CATRCD
CATGOGC  EQU   CATGOGC1
CATGODEL EQU   CATGOGC1
CATGOEXT EQU   CATGOGC1
CATGODSP EQU   CATGOCI+1
@NM00159 EQU   CATGOFLG
SNNN     EQU   SNTTNN+2
SNTT     EQU   SNTTNN
SDSSUMTT EQU   SNDSDIR+32
SDSCRETS EQU   SNDSDIR+28
SDSIDNO  EQU   SNDSDIR+25
@NM00158 EQU   SDSIDFLG
SDSEXT   EQU   SDSIDFLG
@NM00157 EQU   SNDSDIR
SNLBM    EQU   SNVSBM+28
SNABM    EQU   SNVSBM+24
@NM00156 EQU   SNVSBM
@NM00155 EQU   SNEXTENT+16
@NM00154 EQU   SNEXTENT+12
NTR      EQU   SNEXTENT+10
@NM00153 EQU   SNEXTENT+8
@NM00152 EQU   SNEXTENT+6
SHH      EQU   SNEXTENT+4
SCC      EQU   SNEXTENT+2
SS       EQU   SNEXTENT
SNEXTI   EQU   SNVGO+42
SNTTNNMC EQU   SNVGO+41
SNTTNNC  EQU   SNVGO+40
SNTTNNX  EQU   SNVGO+39
SNVGOSS  EQU   SNVGO+37
SDSDIRSN EQU   SNVGO+35
SNSSWD   EQU   SITYPEXT
SNVOLSER EQU   SNVGO+28
SNDEVTYP EQU   SNVGO+24
@NM00151 EQU   SNVGO
SNNAME2  EQU   SNGLEV+1
SNTYPE2  EQU   SNGLEV
SNNAME   EQU   SNASSOC+25
SNTYPE   EQU   SNASSOC+24
@NM00150 EQU   SNASSOC
SSPEXTNN EQU   SSPEXTNT
SNODSPXT EQU   SNVDATA+9
SNVSPCAT EQU   SSPHDFLG
@NM00149 EQU   SSPHDFLG
SNVSPUNQ EQU   SSPHDFLG
SDSCBTS  EQU   SNVDATA
SNVGOEL  EQU   SNFIXED+20
SNEGOP   EQU   SNFIXED+16
SNECI    EQU   SNFIXED+13
SNAGOP   EQU   SNFIXED+11
SNACI    EQU   SNFIXED+8
SNGOP    EQU   SNFIXED+6
SNCI     EQU   SNFIXED+3
SNSN     EQU   SNFIXED+1
@NM00148 EQU   SNFLAG
SNFINC   EQU   SNFLAG
SNFMOD   EQU   SNFLAG
SNFPROC  EQU   SNFLAG
SNFALT   EQU   SNFLAG
SNFDEL   EQU   SNFLAG
SNFUSE   EQU   SNFLAG
RSFCILST EQU   RSFSNVT+28
RSFCADR  EQU   RSFSNVT+24
RSFABMAP EQU   RSFSNVT+20
RSFLENBM EQU   RSFSNVT+14
RSFCNDX  EQU   RSFSNVT+6
RSFHNDX  EQU   RSFSNVT+4
RSFGCODE EQU   RSFSNVT+2
@NM00147 EQU   RSFLAGS
RSFINVTY EQU   RSFLAGS
RSFNRF   EQU   RSFLAGS
@NM00146 EQU   RSFSNVT
GDGLVLT  EQU   GDGENT
@NM00145 EQU   GDGFLG
GDGWRAP  EQU   GDGFLG
GDGPAK   EQU   GDGLHEAD+22
GDGMVL   EQU   GDGLHEAD+20
GDGFRE   EQU   GDGLHEAD+18
GDGFRS   EQU   GDGLHEAD+16
GDGTOE   EQU   GDGLHEAD+14
GDGTOS   EQU   GDGLHEAD+12
GDGPLEV  EQU   GDGLHEAD+10
GDGVALB  EQU   GDGLHEAD+8
GDGCNT   EQU   GDGLHEAD+6
GDGLMT   EQU   GDGLHEAD+4
GDGVAL   EQU   GDGLHEAD
DITDGML  EQU   DITABE+12
DITCITAB EQU   @NM00143+1
@NM00144 EQU   @NM00143
@NM00142 EQU   @NM00140+2
DITOSN   EQU   DITVSN+1
@NM00141 EQU   DITVSN
DITOFS   EQU   DITABE+2
DITFB256 EQU   DITFLB
@NM00139 EQU   DITFLB
DITFBDGO EQU   DITFLB
@NM00138 EQU   DITFLB
DITFBAS2 EQU   DITFLB
DITFBAS1 EQU   DITFLB
DITFBGOE EQU   DITFLB
DITFBHEP EQU   DITFLB
@NM00137 EQU   DITFA
@NM00136 EQU   DITFA
@NM00135 EQU   DITFA
@NM00134 EQU   DITFA
DITFADEL EQU   DITFA
DITFARAS EQU   DITFA
DITFAVER EQU   DITFA
@NM00133 EQU   DITFA
GDIENTRY EQU   GDITS+12
GDITHEAD EQU   GDITS
CITEXTBA EQU   @NM00131+1
@NM00132 EQU   @NM00131
CITEXTCH EQU   @NM00129+1
@NM00130 EQU   @NM00129
CITDITAB EQU   @NM00128+1
CITDICNT EQU   @NM00128
CITRCIN  EQU   @NM00127+1
CITTYPE  EQU   @NM00127
CITCIN   EQU   CITABE+1
CITFADGO EQU   CITFLA
CITFAINV EQU   CITFLA
CITFASCA EQU   CITFLA
CITFAGOE EQU   CITFLA
CITFAHEP EQU   CITFLA
CITFARAS EQU   CITFLA
CITFAVER EQU   CITFLA
@NM00126 EQU   CITFLA
CITABENT EQU   GCITS+12
GCITHEAD EQU   GCITS
PTASCIT1 EQU   PTASOE+4
PTASDIT1 EQU   PTASOE
PTLDITID EQU   PTLOC+19
@NM00125 EQU   PTLDITFB
PTLFBDGO EQU   PTLDITFB
@NM00124 EQU   PTLDITFB
PTLFBAS2 EQU   PTLDITFB
PTLFBAS1 EQU   PTLDITFB
PTLFBGOE EQU   PTLDITFB
PTLFBHEP EQU   PTLDITFB
PTLSN    EQU   PTLOC+16
PTLNDIT  EQU   @NM00122+1
@NM00123 EQU   @NM00122
PTLCDIT  EQU   PTLOC+8
PTLCCIT  EQU   PTLOC+4
PTLBCITX EQU   @NM00120+1
@NM00121 EQU   @NM00120
@NM00119 EQU   PTF2
PTF2KSDS EQU   PTF2
PTF1ENDA EQU   PTF1
PTF1ENDG EQU   PTF1
PTF1END  EQU   PTF1
PTF1CKVL EQU   PTF1
PTF1DELT EQU   PTF1
PTF1OK   EQU   PTF1
PTF1HIT2 EQU   PTF1
PTF1HIT  EQU   PTF1
PTCRAVL  EQU   PTYPEDTA+184
@NM00118 EQU   PTXFLAGS+1
@NM00117 EQU   PTXFLAG1
PTXEXIST EQU   PTXFLAG1
PTXEND   EQU   PTXFLAG1
PTXX2C   EQU   PTXALIAS+28
PTXX1C   EQU   PTXALIAS+26
PTXX0C   EQU   PTXALIAS+24
PTXCITX1 EQU   PTXALIAS+20
PTXX1X0D EQU   PTXALIAS+16
PTXX1X2D EQU   PTXALIAS+12
PTXX1AUD EQU   PTXALIAS+8
PTXX0X1D EQU   PTXALIAS+4
PTXUX1D  EQU   PTXALIAS
PTVDSSNT EQU   PTVERDI+28
@NM00116 EQU   PTVERDI+26
PTVCNT   EQU   PTVERDI+24
PTVDIASS EQU   PTVDI+8
PTVDISNT EQU   PTVDI+4
PTVDICIT EQU   PTVDI
PTBASE   EQU   PTYPEDTA+116
PTINDX5  EQU   PTINDX+10
PTINDX4  EQU   PTINDX+8
PTINDXV  EQU   PTINDX+6
PTINDX3  EQU   PTINDX+4
PTINDX2  EQU   PTINDX+2
PTINDX1  EQU   PTINDX
PTASSCIT EQU   PTASSOE+4
PTASSDIT EQU   PTASSOE
PTASSOC  EQU   PTASSO
PTDITWK  EQU   PTGDIT+20
PTDITF   EQU   PTGDIT+16
PTDITNC  EQU   @NM00114+1
@NM00115 EQU   @NM00114
PTDITL   EQU   @NM00112+1
@NM00113 EQU   @NM00112
PTDITI   EQU   @NM00110+1
@NM00111 EQU   @NM00110
PTCITWK  EQU   PTGCIT+20
PTCITF   EQU   PTGCIT+16
PTCITNC  EQU   @NM00108+1
@NM00109 EQU   @NM00108
PTCITL   EQU   @NM00106+1
@NM00107 EQU   @NM00106
PTCITI   EQU   @NM00104+1
@NM00105 EQU   @NM00104
PTHEAD   EQU   PTWORK
TENTRY   EQU   TABHEAD+12
TABCURR  EQU   THEAD+10
TABMAXT  EQU   THEAD+8
TABFORW  EQU   THEAD+4
TABBACKW EQU   THEAD
TABUG    EQU   TABANCHR+24
TABNU    EQU   @NM00102+1
@NM00103 EQU   @NM00102
TABEN    EQU   TABANCHR+18
@NM00101 EQU   TABANCHR+16
TABSIZ   EQU   TABANCHR+12
TABL     EQU   TABANCHR+4
TABF     EQU   TABANCHR
TASSEN   EQU   TASSO+4
TASSNENT EQU   TASSO+2
@NM00100 EQU   TASSO+1
TASSID   EQU   TASSO
TASSRAB  EQU   TASSENT+2
@NM00099 EQU   TASSFL1
TASSSET  EQU   TASSFL1
TASSIS   EQU   TASSFL1
TASSVER  EQU   TASSFL1
TASSSCAN EQU   TASSFL1
TASSREAD EQU   TASSFL1
TASSTYPE EQU   TASSENT
RSCNHH2  EQU   RSCNCCHH+6
RSCNCC2  EQU   RSCNCCHH+4
RSCNHH1  EQU   RSCNCCHH+2
RSCNCC1  EQU   RSCNCCHH
RECPTRCD EQU   RECIOWA+978
UCATWRET EQU   UCATWA+4
UCATWRLN EQU   UCATWA+2
RSSCRLST EQU   RECIOWA+872
ALLVLSR  EQU   ALLVL+4
ALLVLLN  EQU   ALLVL+2
ALLVLC   EQU   ALLVL
ALLULNM  EQU   ALLUL+4
ALLULLN  EQU   ALLUL+2
ALLULC   EQU   ALLUL
RSALLAGL EQU   RECIOWA+632
RSOPNAGL EQU   RECIOWA+248
CATHRMB  EQU   RECIOWA+192
CATLRMB  EQU   RECIOWA+180
CRARMB   EQU   RECIOWA+168
WFSRMB   EQU   RECIOWA+156
WFDRMB   EQU   RECIOWA+120
UIOVLN   EQU   UIOVOL+2
UIOVID   EQU   UIOVOL
UIODLN   EQU   UIODSN+2
UIODID   EQU   UIODSN
@NM00098 EQU   RSXCIFL1
@NM00097 EQU   RSXCIXLT+4
RMBKEYA  EQU   RMB+12
@NM00096 EQU   RMBFLAGS
RMBGETU  EQU   RMBFLAGS
RMBKEQ   EQU   RMBFLAGS
RMBKEY   EQU   RMBFLAGS
RMBUPD   EQU   RMBFLAGS
RMBDIR   EQU   RMBFLAGS
RMBSEQ   EQU   RMBFLAGS
RMBARG   EQU   RMBCTL+4
RMBRPL   EQU   RMBCTL
@NM00095 EQU   RSRAB+530
RABFLG4  EQU   RABFLGS+3
RABFLG3  EQU   RABFLGS+2
RABFLG2  EQU   RABFLGS+1
RABNRF   EQU   RABFLG1
RABKEY   EQU   RABFLG1
RABUPD   EQU   RABFLG1
RABINUSE EQU   RABFLG1
GRABRAB6 EQU   GRABRABS+20
GRABRAB5 EQU   GRABRABS+16
GRABRAB4 EQU   GRABRABS+12
GRABRAB3 EQU   GRABRABS+8
GRABSNRF EQU   GRABAFL2
GRABSNRN EQU   GRABAFL1
GRABFLG1 EQU   GRABFLGS
@NM00092 EQU   RSCSWA+6
RSCSFCN  EQU   RSCSWA+4
RSCSFAE  EQU   RSCSWA
@NM00091 EQU   RSMARKUN+6
RSMA3FCN EQU   RSMARKUN+4
RSMA3FAE EQU   RSMARKUN
@NM00090 EQU   RSCDSDW+18
RSCDINDX EQU   RSCDSDW+16
RSCDSUMT EQU   RSCDSDW+12
RSCD8FCN EQU   RSCDSDW+10
RSCD3FCN EQU   RSCDSDW+8
RSCD8FAE EQU   RSCDSDW+4
RSCD3FAE EQU   RSCDSDW
RSCDDIR  EQU   RSCDSDIN+12
RSCDVOLR EQU   RSCDSDIN+8
RSCDSNT3 EQU   RSCDSDIN+4
RSCDSNT8 EQU   RSCDSDIN
RSGTMEB  EQU   RSGTIME+11
RSGDELM2 EQU   RSGTIME+9
@NM00089 EQU   RSGTIME+2
RSGDELM1 EQU   RSGTIME
RSGDAY   EQU   RSGDATE+2
RSGYEAR  EQU   RSGDATE
RSGFIXID EQU   RSGENAM+8
RSGTMEA  EQU   RSGENAM+1
RSGDELM  EQU   RSGENAM
RSGUNPK  EQU   RSGENMWA
RSFCPE7  EQU   RSWFNDWA+52
RSFCPE6  EQU   RSWFNDWA+48
RSFCPE5  EQU   RSWFNDWA+44
RSFCPE4  EQU   RSWFNDWA+40
RSFCPE3  EQU   RSWFNDWA+36
RSFCPE2  EQU   RSWFNDWA+32
RSFCPE1  EQU   RSWFNDWA+28
@NM00088 EQU   RSWFNDWA+26
RSWFBMLN EQU   RSWFNDWA+24
RSWFBMAP EQU   RSWFNDWA+20
RSWFBUF  EQU   RSWFNDWA+16
RSWFCIN  EQU   RSWFNDWA+13
RSWFRCSN EQU   RSWFNDWA+12
RSWSEQNR EQU   RSWFNDWA+10
@NM00087 EQU   RSWSNFLG
RSWFIRST EQU   RSWSNFLG
RSWAFINF EQU   RSWFNDWA
@NM00086 EQU   RSCNVTCF+1
@NM00085 EQU   RSCNVTF1
RSCFINN  EQU   RSCNVTF1
RSNN     EQU   RSTTNN+2
RSTT     EQU   RSTTNN
RSCIOCS  EQU   RSCNVTCC
LISTLN   EQU   RSDF00W+36
SETRC    EQU   RSDF00W+32
LISTPTR  EQU   RSDF00W
RSVF4TT  EQU   RSVOLWA+142
@NM00084 EQU   RSVOLWA+141
@NM00083 EQU   RSVFLAGS
RSVWFUPD EQU   RSVFLAGS
RSVREPOS EQU   RSVFLAGS
RSVGTEOF EQU   RSVFLAGS
RSVEXTS  EQU   RSVOLWA+139
RSVF1TTN EQU   RSVF1EXT
RSVF1CTS EQU   RSVOLWA+67
RSVF1PAD EQU   RSVF1TS+14
RSVF1TS2 EQU   RSVF1TS+7
RSVF1TS1 EQU   RSVF1TS
RSVSVTTR EQU   RSVOLWA+48
RSVSCRNM EQU   RSVOLWA+4
RSVSCRPT EQU   RSVOLWA
RSGENDT  EQU   RSGENDTE+1
@NM00082 EQU   RSGENDTE
RSGENTME EQU   RSGENWRK+4
RSGENTPT EQU   RSGENWRK
RSCRGRBP EQU   RSCRWA+4
RSCRENTP EQU   RSCRWA
@NM00081 EQU   RSADUL+10
RSADSTP  EQU   RSADUL+10
RSADFLGS EQU   RSADUL+9
RSADULNM EQU   RSADUL+1
RSADULC  EQU   RSADUL
RSADVLSR EQU   RSADVL+1
RSADVLC  EQU   RSADVL
RSADDDNP EQU   RSADWA+28
RSADULP  EQU   RSADWA+24
RSADVLP  EQU   RSADWA+20
RSADENP  EQU   RSADWA+16
RSADVSRP EQU   RSADWA+12
RSADGRBP EQU   RSADWA+8
RSADDDN  EQU   RSADWA
RSWFAMDP EQU   RSWFWA+48
RSWFLR   EQU   RSWFWA+44
RSWFDFAR EQU   RSWFWA+40
RSWFFPLP EQU   RSWFWA+12
RSWFFVTP EQU   RSWFWA+4
RSWFSVCP EQU   RSWFWA
@NM00080 EQU   RSRWORK+65
RSRSKPSW EQU   RSRFLGS
RSRXSW   EQU   RSRFLGS
RSRXTRY  EQU   RSRFLGS
RSROKSW  EQU   RSRFLGS
RSRX     EQU   RSRWORK+63
RSRIXNO  EQU   RSRWORK+62
RSRU     EQU   RSRWORK+61
RSRI     EQU   RSRWORK+60
RSRLG    EQU   RSRWORK+59
RSRLU    EQU   RSRWORK+58
RSRSVFLG EQU   RSRWORK+48
RSMSGCI  EQU   RSRWORK+45
RSMSGRC  EQU   RSRWORK+42
RSRRLN   EQU   RSRWORK+40
RSRRCPY  EQU   RSRWORK+38
RSRWFRN  EQU   RSRWORK+36
RSRCATRN EQU   RSRWORK+34
RSRCRARN EQU   RSRWORK+32
RSRXLFND EQU   RSRWORK+28
RSRXLSV  EQU   RSRWORK+24
RSRRPL   EQU   RSRWORK+20
RSRSVARG EQU   RSRWORK+16
RSRFAD   EQU   RSRWORK+12
RSRDAD   EQU   RSRWORK+8
RSRRC    EQU   RSRWORK+4
RSRGRBPT EQU   RSRWORK
RSRNULNM EQU   RSRNUL+1
RSRNULC  EQU   RSRNUL
RSRNVLSR EQU   RSRNVL+1
RSRNVLC  EQU   RSRNVL
RSRNDDNM EQU   RSRNWA+91
RSRNOLDN EQU   RSRNWA+47
RSRNNOF1 EQU   RSRNFLGS
RSRNVDUP EQU   RSRNFLGS
RSRNSTP  EQU   RSRNFLGS
RSRNFAIL EQU   RSRNFLGS
RSRNRCRS EQU   RSRNFLGS
RSRNEVC  EQU   RSRNWA+44
RSRNEVP  EQU   RSRNWA+40
RSRNULP  EQU   RSRNWA+36
RSRNVLP  EQU   RSRNWA+32
RSRNVSPT EQU   RSRNWA+28
RSRNDDPT EQU   RSRNWA+24
RSRNVLPT EQU   RSRNWA+20
RSRNGRBP EQU   RSRNWA+16
RSRNPVLS EQU   RSRNPLST+12
RSRNPNDS EQU   RSRNPLST+8
RSRNPODS EQU   RSRNPLST+4
RSRNPFLG EQU   RSRNPLST
@NM00079 EQU   RSINATR1
@NM00078 EQU   RSINATR1
@NM00077 EQU   RSCKFLAG
RSCKTSW  EQU   RSCKFLAG
RSCKIDX3 EQU   RSCKERRW+48
RSCKIDX2 EQU   RSCKERRW+46
RSCKIDX1 EQU   RSCKERRW+44
RSOURCC  EQU   RSCKERRW+40
RSCKMDTB EQU   RSCKTIME+20
RSCKMDY  EQU   RSCKTIME+14
RSCKHMS  EQU   RSCKTIME+8
RSCKPDAY EQU   RSCKTIME+4
RSCKDAYS EQU   RSCKTIME
RSCKTPTR EQU   RSCKERRW+4
RSCKERNO EQU   RSCKERR+2
@NM00076 EQU   RSREASW
@NM00075 EQU   @NM00074+3
RSVIAGRB EQU   @NM00074
RSVIACIN EQU   @NM00072+1
@NM00073 EQU   RSVIAFLG
RSVIARRN EQU   RSVIAFLG
RSVIAUPD EQU   RSVIAFLG
RSVIAIS  EQU   RSVIAFLG
RSVIAFND EQU   RSVIAFLG
RSVIADUP EQU   RSVIAFLG
RSVIAFCR EQU   RSVIAFLG
@NM00071 EQU   RSGETVIA+8
RSVIAIDX EQU   RSGETVIA+6
@NM00070 EQU   RSVIACRA+4
RSVIADSC EQU   RSVIACRA
@NM00069 EQU   @NM00067+3
RSEOVERR EQU   @NM00067+2
@NM00068 EQU   RSEOVFLG
RSEOVPHY EQU   RSEOVFLG
RSEOVLOG EQU   RSEOVFLG
RSEOVEND EQU   RSEOVFLG
RSEOVFND EQU   RSEOVFLG
RSEOVXIO EQU   @NM00067
RSCATARG EQU   @NM00065+1
@NM00066 EQU   @NM00065
RSCATRPL EQU   RSEOVWA+4
RSEOVRAB EQU   RSEOVWA
RSPVFLG3 EQU   @NM00062+3
@NM00064 EQU   RSPVFLG2
RSBDVOLS EQU   RSPVFLG2
RSRETSPC EQU   RSPVFLG2
RSSETERR EQU   RSPVFLG2
RSSERROR EQU   RSPVFLG2
RSPERROR EQU   RSPVFLG2
RSVLCATE EQU   RSPVFLG2
RSMUNUS  EQU   RSPVFLG2
RSCK1TO1 EQU   RSPVFLG1
RSCKBERR EQU   RSPVFLG1
RSPVRSC  EQU   RSPVFLG1
RSPVRPC  EQU   RSPVFLG1
RSPVNRP  EQU   RSPVFLG1
RSPVDELT EQU   RSPVFLG1
RSPVRVOL EQU   RSPVFLG1
RSCHKCON EQU   RSPVFLG1
@NM00063 EQU   RSPVSETB
RSST1TO1 EQU   RSPVSETB
RSPVCLBM EQU   RSPVSETB
RSSETMAP EQU   RSPVSETB
RSSETCRA EQU   RSPVSETB
@NM00061 EQU   RSPVTTNN+15
RSMASK   EQU   RSPVTTNN+14
RSPVKNEX EQU   RSPVTTNN+12
RSPVNN   EQU   RSPVTTNN+10
RSBITPOS EQU   RSPVTTNN+8
RSPVTNEX EQU   RSPVTTNN+6
RSPVNEXT EQU   RSPVTTNN+4
RSSETTT  EQU   RSPVTTNN
RSPVSNT8 EQU   RSPVSNT+16
RSPVSNT6 EQU   RSPVSNT+12
RSPVSNT5 EQU   RSPVSNT+8
RSPVSNT3 EQU   RSPVSNT+4
RSPVSNTC EQU   RSPVSNT
TMPSZ    EQU   RSPROCVL+44
RSMAPSIZ EQU   RSPROCVL+40
RSFROMAP EQU   RSMAPAD+16
RSTOMAP  EQU   RSMAPAD+12
RSSTBMAP EQU   RSMAPAD+8
RSCKBMAP EQU   RSMAPAD+4
RSTGBMAP EQU   RSMAPAD
RSSCBMAP EQU   RSMAPS+16
RSCRBMAP EQU   RSPCBMAP
RSCABMAP EQU   RSSBMAP
RSPBMAP  EQU   RSMAPS+4
RSWKBMAP EQU   RSMAPS
RSGDGNM  EQU   RSGDG+10
RSGDGLN  EQU   RSGDG+8
RSGDGLL  EQU   RSGDG+4
@NM00060 EQU   RSASSFLG+1
@NM00059 EQU   RSASSFL1
RSASDSDI EQU   RSASSFL1
RSASSEPA EQU   RSASSFL1
RSASSPAS EQU   RSASSOC+14
RSASSEXT EQU   RSASSOC+12
RSASSEND EQU   RSASSOC+8
RSASSCIN EQU   RSASSOC+4
RSRCHK   EQU   RSROPT
RSRINIT  EQU   RSRTYPE
RSRDEL   EQU   RSRTYPE
@NM00058 EQU   RSFLAGI2+1
RSHAVECR EQU   RSFLAGI2+1
RSFDELET EQU   RSFLAGI2+1
RSOPDYN  EQU   RSFLAGI2+1
RSCCVFND EQU   RSFLAGI2
@NM00057 EQU   RSFLAGI1
RSCREXC  EQU   RSFLAGN2
RSDFVLSR EQU   RSWORK+875
RSDFVLCT EQU   RSWORK+874
RSWFDSN  EQU   RSWORK+830
RSCATVLS EQU   RSWORK+808
RSIDX3   EQU   RSWORK+692
RSIDX2   EQU   RSWORK+690
RSCAFUCN EQU   RSWORK+684
RSGOPLEN EQU   RSWORK+682
RSORSTAT EQU   RSORVLLS+12
RSORNVOL EQU   RSORVLLS+6
RSORNDEV EQU   RSORVLLS+2
RSORVLCT EQU   RSORVLLS
RSCRAVLN EQU   RSWORK+664
RSSUBSSZ EQU   RSWORK+640
RSSUBSTP EQU   RSWORK+636
RSSUBGRP EQU   RSWORK+628
RSSUBRC  EQU   RSWORK+624
RSPROCRC EQU   RSWORK+620
RSCIXLTB EQU   RSWORK+604
CTGFVPTR EQU   RSWORK+584
RSECPA   EQU   RSWORK+548
RSECBF1  EQU   RSWORK+544
RSWFIOCS EQU   RSWORK+540
RSENTNXT EQU   RSWORK+492
RSENTFBK EQU   RSWORK+488
RSENTST  EQU   RSWORK+480
RSVOLLUS EQU   RSWORK+464
RSRESLUS EQU   RSWORK+456
RSCACDE  EQU   RSWORK+360
RS07RG12 EQU   RS07REGS+16
RS07RG11 EQU   RS07REGS+12
RS07RG10 EQU   RS07REGS+8
RS07RG09 EQU   RS07REGS+4
RS06RG12 EQU   RS06REGS+16
RS06RG11 EQU   RS06REGS+12
RS06RG10 EQU   RS06REGS+8
RS06RG09 EQU   RS06REGS+4
RS05RG12 EQU   RS05REGS+16
RS05RG11 EQU   RS05REGS+12
RS05RG10 EQU   RS05REGS+8
RS05RG09 EQU   RS05REGS+4
RS04RG12 EQU   RS04REGS+16
RS04RG11 EQU   RS04REGS+12
RS04RG10 EQU   RS04REGS+8
RS04RG09 EQU   RS04REGS+4
RS03RG12 EQU   RS03REGS+16
RS03RG11 EQU   RS03REGS+12
RS03RG10 EQU   RS03REGS+8
RS03RG09 EQU   RS03REGS+4
RS02RG12 EQU   RS02REGS+16
RS02RG11 EQU   RS02REGS+12
RS02RG10 EQU   RS02REGS+8
RS02RG09 EQU   RS02REGS+4
RS01RG12 EQU   RS01REGS+16
RS01RG11 EQU   RS01REGS+12
RS01RG10 EQU   RS01REGS+8
RSTABAD  EQU   RSTAB+16
RSTWKIX  EQU   @NM00055+1
@NM00056 EQU   @NM00055
RSTENTIX EQU   @NM00053+1
@NM00054 EQU   @NM00053
RSTENTAD EQU   RSTAB+4
RSPTWKUG EQU   RSPSTACK+24
@NM00052 EQU   RSPSTACK+20
@NM00051 EQU   RSPSTACK+18
@NM00050 EQU   RSPSTACK+16
RSPTWKLN EQU   RSPSTACK+12
RSPTWKL  EQU   RSPSTACK+4
RSPTWKF  EQU   RSPSTACK
RSGDITUG EQU   RSGDITS+24
RSGDITNU EQU   @NM00048+1
@NM00049 EQU   @NM00048
RSGDITEN EQU   RSGDITS+18
@NM00047 EQU   RSGDITS+16
RSGDITLN EQU   RSGDITS+12
RSGDITL  EQU   RSGDITS+4
RSGDITF  EQU   RSGDITS
RSGCITUG EQU   RSGCITS+24
RSGCITNU EQU   @NM00045+1
@NM00046 EQU   @NM00045
RSGCITEN EQU   RSGCITS+18
@NM00044 EQU   RSGCITS+16
RSGCITLN EQU   RSGCITS+12
RSGCITL  EQU   RSGCITS+4
RSGCITF  EQU   RSGCITS
RSCRIOCS EQU   RSWORK+100
RSCPE8   EQU   RSWORK+96
RSCPE4   EQU   RSWORK+80
RSCITDUM EQU   RSWORK+48
RSCAIOCS EQU   RSWORK+40
RSALLAGP EQU   RSWORK+4
RSF1RNNM EQU   RSF1RNTB+14
RSF1RNDV EQU   RSF1RNTB+10
RSF1RNVL EQU   RSF1RNTB+4
RSF1RNNX EQU   RSF1RNTB
@NM00043 EQU   RESVOL+12
@NM00042 EQU   RESVLFLG
RESVLNXT EQU   RESVOL
VOLSRLAS EQU   VOLSRFLG
VOLSRNXT EQU   VOLSERTB
@NM00041 EQU   CATIEXT
@NM00039 EQU   IOCRCV
IOCRCVRA EQU   IOCRCV
IOCRCVXM EQU   IOCRCV
IOCVLN   EQU   IOCSEX+42
IOCDNM   EQU   IOCSEX+40
IOCDDN   EQU   IOCDLM
IOCMODEX EQU   IOCMOD
IOCMODRP EQU   IOCMOD
IOCMODXM EQU   IOCMOD
IOCMODUB EQU   IOCMOD
IOCMODRG EQU   IOCMOD
IOCMODDY EQU   IOCMOD
IOCMODRR EQU   IOCMOD
IOCMODPD EQU   IOCMOD
IOCINFR1 EQU   IOCINF
IOCINFCT EQU   IOCINF
IOCINFDO EQU   IOCINF
IOCINFAC EQU   IOCINF
IOCINFQX EQU   IOCINF
IOCINFND EQU   IOCINF
IOCINFAE EQU   IOCINF
IOCINFPT EQU   IOCINF
@NM00038 EQU   IOCDEV
IOCDEVUR EQU   IOCDEV
IOCDEVMT EQU   IOCDEV
IOCDEVDA EQU   IOCDEV
@NM00037 EQU   IOCFLG
IOCFLGSP EQU   IOCFLG
IOCFLGOE EQU   IOCFLG
IOCFLGOP EQU   IOCFLG
IOCFLGIO EQU   IOCFLG
IOCFLGEF EQU   IOCFLG
IOCFLGDF EQU   IOCFLG
IOCFLGEX EQU   IOCFLG
IOCSID   EQU   IOCSEX+28
IOCNIO   EQU   IOCSEX+24
@NM00036 EQU   IOCXPM+2
IOCEXL   EQU   IOCXPM
IOCEXA   EQU   IOCXAD
IOCWKA   EQU   IOCSEX+12
IOCLRP   EQU   IOCSEX+10
IOCCBL   EQU   IOCSEX+8
IOCDEC   EQU   IOCRPL
IOCCBA   EQU   IOCSEX
@NM00035 EQU   IODATA+64
IODAEI   EQU   IODATA+60
@NM00034 EQU   IODATA+56
IODIOX   EQU   IODATA+52
IODOCS   EQU   IODATA+48
IODICS   EQU   IODATA+44
IODOSO   EQU   IODATA+40
IODOSS   EQU   IODATA+36
IODEOD   EQU   IODATA+32
@NM00033 EQU   IODATA+30
@NM00032 EQU   IODATA+28
IODOEV   EQU   IODATA+24
IODIEV   EQU   IODATA+20
IODINC   EQU   IODSID+2
IODMID   EQU   IODSID
IODXTN   EQU   IODATA+12
IODADD   EQU   IODATA+8
IODMSG   EQU   IODATA+4
IODIOC   EQU   IODATA
CRADVVAL EQU   CRADV+1
CRADVLEN EQU   CRADV
WCATMEM  EQU   WCAT+12
WCATMLN  EQU   WCAT+11
WCATFUQ  EQU   WCATFLG
WCATPOS  EQU   WCAT+9
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00471 EQU   @RC00468
@RF00487 EQU   @RC00468
@RC00684 EQU   @RC00678
@RF00876 EQU   @RC00873
@RC01867 EQU   @RC01864
@PB00014 EQU   @EL00001
@ENDDATA EQU   *
         END   IDCRS01,(C'PLS2300',0701,77115)

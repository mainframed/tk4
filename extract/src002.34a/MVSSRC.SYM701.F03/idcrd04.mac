         TITLE 'IDCRD04: DEBLOCK REPAIRV FUNCTION                      *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRD04  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRD04   77.300'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@11                                    0002
         USING @PSTART+12285,@12                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @06,@01                                             0002
         LA    @07,4095(,@06)                                      0002
         USING @DATD,@06                                           0002
         USING @DATD+4095,@07                                      0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @06,8(,@13)                                         0002
         LR    @13,@06                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE AND DUMP POINT                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0330
*   IF GDTDBG=NULLPTR THEN                                         0330
         L     @15,@PC00001                                        0330
         L     @15,GDTDBG(,@15)                                    0330
         LTR   @15,@15                                             0330
         BZ    @RT00330                                            0330
*     ;                                                            0331
*   ELSE                                                           0332
*     CALL IDCDB010(GDTTBL,'RD40');                                0332
         L     @15,@PC00001                                        0332
         ST    @15,@AL00001                                        0332
         LA    @15,@CC01480                                        0332
         ST    @15,@AL00001+4                                      0332
         MVI   @AL00001+4,X'80'                                    0332
         L     @14,@PC00001                                        0332
         L     @15,GDTDBG(,@14)                                    0332
         LA    @01,@AL00001                                        0332
         BALR  @14,@15                                             0332
*   OLDERID2=NEWERID2;                                             0333
@RT00330 L     @15,@PC00001                                        0333
         L     @01,GDTTR2(,@15)                                    0333
         L     @15,@PC00001                                        0333
         L     @15,GDTTR2(,@15)                                    0333
         MVC   @TS00001(95),NEWERID2(@15)                          0333
         MVC   OLDERID2(95,@01),@TS00001                           0333
*   NEWID2='RD41';                                                 0334
*                                                                  0334
         L     @15,@PC00001                                        0334
         L     @01,GDTTR2(,@15)                                    0334
         MVC   NEWID2(4,@01),@CC01481                              0334
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL DEBLOCK ROUTINE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   CALL IDCRD040;                                                 0335
*                                                                  0335
         BAL   @14,IDCRD040                                        0335
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN CODE FROM DEBLOCK ROUTINE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0336
*   RESPECIFY                                                      0336
*     RTNREG RSTD;                                                 0336
*   TESTRC=RTNREG;                                                 0337
         STH   RTNREG,TESTRC                                       0337
*   RESPECIFY                                                      0338
*     RTNREG UNRSTD;                                               0338
*                                                                  0338
*   /*****************************************************************/
*   /*                                                               */
*   /* SET DEBLOCK RETURN CODE IN LASTCC                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0339
*   LASTCC=TESTRC;                                                 0339
         LH    @15,TESTRC                                          0339
         STH   @15,LASTCC                                          0339
*   IF REPRC=4 THEN                                                0340
         L     @15,@PC00001+8                                      0340
         CLC   REPRC(2,@15),@CH00045                               0340
         BNE   @RF00340                                            0340
*     LASTCC=4;                                                    0341
         MVC   LASTCC(2),@CH00045                                  0341
*   ELSE                                                           0342
*     ;                                                            0342
@RF00340 DS    0H                                                  0343
*   DO;                                                            0343
*     CKREQ=CKREQ&&CKREQ;                                          0344
         L     @15,@PC00001+8                                      0344
         XC    CKREQ(44,@15),CKREQ(@15)                            0344
*     CKRERN=MSG92;                                                0345
         L     @15,@PC00001+8                                      0345
         MVC   CKRERN(2,@15),@CH00864                              0345
*     CKRMVAR(1)=ADDR(REPRCDCT);                                   0346
         L     @15,@PC00001+8                                      0346
         L     @14,@PC00001+8                                      0346
         LA    @14,REPRCDCT(,@14)                                  0346
         ST    @14,CKRMVAR(,@15)                                   0346
*     CALL IDCRDER;                                                0347
         L     @15,@CV01407                                        0347
         BALR  @14,@15                                             0347
*   END;                                                           0348
*                                                                  0348
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UEPIL TO FREE STORAGE AND RETURN TO IDCRD01             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                            0349
         L     @15,@PC00001                                        0349
         ST    @15,@AL00001                                        0349
         LA    @15,MODID                                           0349
         ST    @15,@AL00001+4                                      0349
         LA    @15,LASTCC                                          0349
         ST    @15,@AL00001+8                                      0349
         MVI   @AL00001+8,X'80'                                    0349
         L     @14,@PC00001                                        0349
         L     @15,GDTEPL(,@14)                                    0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*IDCRD040:                                                         0350
*   PROCEDURE;                                                     0350
*                                                                  0350
@EL00001 L     @13,4(,@13)                                         0350
@EF00001 L     @00,@SIZDATD                                        0350
         LR    @01,@06                                             0350
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0350
         BR    @14                                                 0350
IDCRD040 STM   @14,@12,@SA00002                                    0350
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL IDCRDRF TO OPEN THE REPAIR WORKFILE, READ THE HEADER     */
*   /* RECORD AND GET CORE FOR RECORD 0 AND RECORD 1                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   CALL IDCRDRF(OUT);                                             0351
         L     @15,@CV01406                                        0351
         LA    @01,@AL00351                                        0351
         BALR  @14,@15                                             0351
*   RESPECIFY                                                      0352
*     RTNREG RSTD;                                                 0352
*   TESTRC=RTNREG;                                                 0353
         STH   RTNREG,TESTRC                                       0353
*   RESPECIFY                                                      0354
*     RTNREG UNRSTD;                                               0354
*   REPRCDCT=0;                                                    0355
         L     @15,@PC00001+8                                      0355
         SLR   @14,@14                                             0355
         ST    @14,REPRCDCT(,@15)                                  0355
*   REPRC=0;                                                       0356
         L     @15,@PC00001+8                                      0356
         SLR   @14,@14                                             0356
         STH   @14,REPRC(,@15)                                     0356
*   IF TESTRC^=0 THEN                                              0357
*                                                                  0357
         LH    @15,TESTRC                                          0357
         LTR   @15,@15                                             0357
         BZ    @RF00357                                            0357
*     /***************************************************************/
*     /*                                                             */
*     /* NON-ZERO RETURN CODE - MESSAGE ALREADY ISSUED               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0358
*     RETURN CODE(TESTRC);                                         0358
*                                                                  0358
         LH    @15,TESTRC                                          0358
         L     @14,@SA00002                                        0358
         LM    @00,@12,@SA00002+8                                  0358
         BR    @14                                                 0358
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN CODE OK                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*   ELSE                                                           0359
*     ;                                                            0359
*                                                                  0359
@RF00357 DS    0H                                                  0360
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT DBLTBL                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*   DO ICNT1=1 TO DIM(DBLTBL);                                     0360
         LA    @15,1                                               0360
         STH   @15,ICNT1                                           0360
@DL00360 DS    0H                                                  0361
*     DBLTBL(ICNT1)=''B;                                           0361
         LH    @15,ICNT1                                           0361
         SLA   @15,3                                               0361
         LA    @14,DBLTBL-8(@15)                                   0361
         XC    0(8,@14),0(@14)                                     0361
*   END;                                                           0362
*                                                                  0362
         LA    @15,1                                               0362
         AH    @15,ICNT1                                           0362
         STH   @15,ICNT1                                           0362
         C     @15,@CF01269                                        0362
         BNH   @DL00360                                            0362
*   /*****************************************************************/
*   /*                                                               */
*   /* RWF HAS BEEN OPENED, SPACE ACQUIRED AND REPCB PTRS SET SET THE*/
*   /* REPAIR WORKFILE DSNAME IN RWFDANA BUILD THE FIRST KEY IN THE  */
*   /* RANGE FROM FDT IN CRNTKEY KEY CONSISTS OF VOLUME SERIAL       */
*   /* NUMBER, CYLINDER AND AND HEAD ADDRESS AND RECORD NUMBER       */
*   /* RESPECTIVELY SAVE THE BEGINNING TO REPBUFF0 AND REPBUFF1 IN   */
*   /* CASE WE ARE DEBLOCKING MULTIPLE TRACKS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0363
*   RWFPTR1=REPORWIO->IOCDSN;                                      0363
         L     @15,@PC00001+8                                      0363
         L     @01,REPORWIO(,@15)                                  0363
         L     @15,IOCDSN(,@01)                                    0363
         ST    @15,RWFPTR1                                         0363
*   CRNVOLS=DBVOLVAL;                                              0364
         L     @15,@PC00001+4                                      0364
         L     @01,FDTPTR+296(,@15)                                0364
         MVC   CRNVOLS(6),DBVOLVAL(@01)                            0364
*   CRNCCHH=DBCCHVAL;                                              0365
         L     @15,@PC00001+4                                      0365
         L     @01,FDTPTR+300(,@15)                                0365
         MVC   CRNCCHH(4),DBCCHVAL(@01)                            0365
*   CRNR=ZERO;                                                     0366
         MVC   CRNR(1),ZERO+1                                      0366
*   SAVEBF0=REPBUFF0;                                              0367
         L     @15,@PC00001+8                                      0367
         L     @15,REPBUFF0(,@15)                                  0367
         ST    @15,SAVEBF0                                         0367
*   SAVEBF1=REPBUFF1;                                              0368
*                                                                  0368
         L     @15,@PC00001+8                                      0368
         L     @15,REPBUFF1(,@15)                                  0368
         ST    @15,SAVEBF1                                         0368
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF ENDING TRACK ADDRESS HAS BEEN SUPPLIED -- IF  */
*   /* IT IS THEN SET THAT TRACK ADDRESS IN THE LASTKEY IF IT IS     */
*   /* VALID                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0369
*   IF ADDR(DBHHH)^=NULLPTR THEN                                   0369
         L     @15,@PC00001+4                                      0369
         L     @15,FDTPTR+304(,@15)                                0369
         LTR   @15,@15                                             0369
         BZ    @RF00369                                            0369
*     DO;                                                          0370
*                                                                  0370
*       /*************************************************************/
*       /*                                                           */
*       /* ENDING TRACK SUPPLIED - CHECK TO SEE IF VALID             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0371
*       IF DBHHHVAL<CHVAL THEN                                     0371
         L     @15,@PC00001+4                                      0371
         L     @01,FDTPTR+304(,@15)                                0371
         L     @15,@PC00001+4                                      0371
         L     @15,FDTPTR+300(,@15)                                0371
         CLC   DBHHHVAL(2,@01),CHVAL(@15)                          0371
         BNL   @RF00371                                            0371
*         DO;                                                      0372
*                                                                  0372
*           /*********************************************************/
*           /*                                                       */
*           /* ENDING TRACK BEFORE BEGINNING TRACK ISSUE ERROR       */
*           /* MESSAGE, CLOSE REPAIR WORKFILE FREE GOTTEN SPACE, AND */
*           /* RETURN CODE 12                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0373
*           DO;                                                    0373
*             CKREQ=CKREQ&&CKREQ;                                  0374
         L     @15,@PC00001+8                                      0374
         XC    CKREQ(44,@15),CKREQ(@15)                            0374
*             CKRERN=MSG13;                                        0375
         L     @15,@PC00001+8                                      0375
         MVC   CKRERN(2,@15),@CH00611                              0375
*             CKRMVAR(1)=ADDR(CHVAL);                              0376
         L     @15,@PC00001+8                                      0376
         L     @14,@PC00001+4                                      0376
         L     @01,FDTPTR+300(,@14)                                0376
         LA    @14,CHVAL(,@01)                                     0376
         ST    @14,CKRMVAR(,@15)                                   0376
*             CKRMVAR(2)=ADDR(DBHHHVAL);                           0377
         L     @15,@PC00001+8                                      0377
         L     @14,@PC00001+4                                      0377
         L     @01,FDTPTR+304(,@14)                                0377
         LA    @14,DBHHHVAL(,@01)                                  0377
         ST    @14,CKRMVAR+4(,@15)                                 0377
*             CKRMVAR(3)=ADDR(RANGELIT);                           0378
         L     @15,@PC00001+8                                      0378
         LA    @14,RANGELIT                                        0378
         ST    @14,CKRMVAR+8(,@15)                                 0378
*             CKRMVAR(4)=ADDR(RWFDANA);                            0379
         L     @15,@PC00001+8                                      0379
         L     @14,RWFPTR1                                         0379
         ST    @14,CKRMVAR+12(,@15)                                0379
*             CALL IDCRDER;                                        0380
         L     @15,@CV01407                                        0380
         BALR  @14,@15                                             0380
*           END;                                                   0381
*           CALL IDCIOCL0(GDTTBL,REPORWIO);                        0382
         L     @15,@PC00001                                        0382
         ST    @15,@AL00001                                        0382
         L     @15,@PC00001+8                                      0382
         LA    @15,REPORWIO(,@15)                                  0382
         ST    @15,@AL00001+4                                      0382
         MVI   @AL00001+4,X'80'                                    0382
         L     @14,@PC00001                                        0382
         L     @15,GDTCLS(,@14)                                    0382
         LA    @01,@AL00001                                        0382
         BALR  @14,@15                                             0382
*           CALL IDCSAFP0(GDTTBL,POOLRD01,ALL);                    0383
         MVC   @AL00001+4(8),@AL00383                              0383
         L     @15,@PC00001                                        0383
         ST    @15,@AL00001                                        0383
         L     @14,@PC00001                                        0383
         L     @15,GDTFPL(,@14)                                    0383
         LA    @01,@AL00001                                        0383
         BALR  @14,@15                                             0383
*           RETURN CODE(LASTCC12);                                 0384
         LA    @15,12                                              0384
         L     @14,@SA00002                                        0384
         LM    @00,@12,@SA00002+8                                  0384
         BR    @14                                                 0384
*         END;                                                     0385
*                                                                  0385
*       /*************************************************************/
*       /*                                                           */
*       /* END TRACK VALID                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0386
*       ELSE                                                       0386
*         DO;                                                      0386
*                                                                  0386
@RF00371 DS    0H                                                  0387
*           /*********************************************************/
*           /*                                                       */
*           /* SET LAST KEY TO SUPPLIED ENDING TRACK                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0387
*           LASTKEY=CRNTKEY;                                       0387
         MVC   LASTKEY(11),CRNTKEY                                 0387
*           LASTHH=DBHHHVAL;                                       0388
         L     @15,@PC00001+4                                      0388
         L     @01,FDTPTR+304(,@15)                                0388
         MVC   LASTHH(2),DBHHHVAL(@01)                             0388
*         END;                                                     0389
*                                                                  0389
*       /*************************************************************/
*       /*                                                           */
*       /* END OF NON-ZERO ENDING TRACK                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*     END;                                                         0390
*                                                                  0390
*   /*****************************************************************/
*   /*                                                               */
*   /* ONLY ONE TRACK TO PROCESS SET LAST KEY TO SAME AS FIRST KEY   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0391
*   ELSE                                                           0391
*     LASTKEY=CRNTKEY;                                             0391
*                                                                  0391
         B     @RC00369                                            0391
@RF00369 MVC   LASTKEY(11),CRNTKEY                                 0391
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW POSITION FOR FIRST RECORD ZERO                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0392
*   WFIOKYA=ADDR(CRNTKEY);                                         0392
@RC00369 L     @15,@PC00001+8                                      0392
         LA    @14,CRNTKEY                                         0392
         ST    @14,WFIOKYA(,@15)                                   0392
*   DO;                                                            0393
*     WFREQ=''B;                                                   0394
         L     @15,@PC00001+8                                      0394
         XC    WFREQ(2,@15),WFREQ(@15)                             0394
*     WFRPOS=ON;                    /* POSRCD                        */
         L     @15,@PC00001+8                                      0395
         OI    WFRPOS(@15),B'00001000'                             0395
*     CALL IDCRDIO;                                                0396
         L     @15,@CV01408                                        0396
         BALR  @14,@15                                             0396
*     RFY                                                          0397
*       RTNREG RSTD;                                               0397
*     TESTRC=RTNREG;                                               0398
         STH   RTNREG,TESTRC                                       0398
*     RFY                                                          0399
*       RTNREG UNRSTD;                                             0399
*   END;                                                           0400
*                                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RETURN CODE FROM POSITION                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   IF TESTRC^=0 THEN                                              0401
         LH    @15,TESTRC                                          0401
         LTR   @15,@15                                             0401
         BZ    @RF00401                                            0401
*     DO;                                                          0402
*                                                                  0402
*       /*************************************************************/
*       /*                                                           */
*       /* IF RC=8 THEN ISSUE MESSAGE RECORD NOT FOUND               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0403
*       IF TESTRC=8 THEN                                           0403
         CLC   TESTRC(2),@CH00181                                  0403
         BNE   @RF00403                                            0403
*         DO;                                                      0404
*           CKREQ=CKREQ&&CKREQ;                                    0405
         L     @15,@PC00001+8                                      0405
         XC    CKREQ(44,@15),CKREQ(@15)                            0405
*           CKRERN=MSG14;                                          0406
         L     @15,@PC00001+8                                      0406
         MVC   CKRERN(2,@15),@CH00617                              0406
*           CKRMVAR(1)=ADDR(CRNVOLS);                              0407
         L     @15,@PC00001+8                                      0407
         LA    @14,CRNVOLS                                         0407
         ST    @14,CKRMVAR(,@15)                                   0407
*           CKRMVAR(2)=ADDR(CRNCCHH);                              0408
         L     @15,@PC00001+8                                      0408
         LA    @14,CRNCCHH                                         0408
         ST    @14,CKRMVAR+4(,@15)                                 0408
*           CKRMVAR(3)=ADDR(RWFDANA);                              0409
         L     @15,@PC00001+8                                      0409
         L     @14,RWFPTR1                                         0409
         ST    @14,CKRMVAR+8(,@15)                                 0409
*           CALL IDCRDER;                                          0410
         L     @15,@CV01407                                        0410
         BALR  @14,@15                                             0410
*         END;                                                     0411
*                                                                  0411
*       /*************************************************************/
*       /*                                                           */
*       /* MESSAGE ALREADY ISSUED                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0412
*       ELSE                                                       0412
*         ;                                                        0412
*                                                                  0412
@RF00403 DS    0H                                                  0413
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN CODE NOT ZERO - CLOSE REPAIR WORKFILE FREE BUFFER  */
*       /* SPACE AND RETURN CODE 12                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0413
*       CALL IDCIOCL0(GDTTBL,REPORWIO);                            0413
         L     @15,@PC00001                                        0413
         ST    @15,@AL00001                                        0413
         L     @15,@PC00001+8                                      0413
         LA    @15,REPORWIO(,@15)                                  0413
         ST    @15,@AL00001+4                                      0413
         MVI   @AL00001+4,X'80'                                    0413
         L     @14,@PC00001                                        0413
         L     @15,GDTCLS(,@14)                                    0413
         LA    @01,@AL00001                                        0413
         BALR  @14,@15                                             0413
*       CALL IDCSAFP0(GDTTBL,POOLRD01,ALL);                        0414
         MVC   @AL00001+4(8),@AL00414                              0414
         L     @15,@PC00001                                        0414
         ST    @15,@AL00001                                        0414
         L     @14,@PC00001                                        0414
         L     @15,GDTFPL(,@14)                                    0414
         LA    @01,@AL00001                                        0414
         BALR  @14,@15                                             0414
*       RETURN CODE(LASTCC12);                                     0415
         LA    @15,12                                              0415
         L     @14,@SA00002                                        0415
         LM    @00,@12,@SA00002+8                                  0415
         BR    @14                                                 0415
*     END;                                                         0416
*   ELSE                                                           0417
*     ;                                                            0417
*                                                                  0417
@RF00401 DS    0H                                                  0418
*   /*****************************************************************/
*   /*                                                               */
*   /* RECORD ZERO FOR THE FIRST TRACK EXISTS LOOP UNTIL LAST TRACK  */
*   /* HAS BEEN PROCESSED WE ARE POSITIONED TO THE RECORD ZERO RECORD*/
*   /* IN THE TRACK AND WILL PROCESS EACH RECORD ZERO/RECORD ONE PAIR*/
*   /* SEQUENTIALLY UNTIL THE LAST REQUESTED TRACK HAS BEEN PROCESSED*/
*   /* FIRST INITIALIZE RETURN CODE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0418
*   REPRC=0;                                                       0418
         L     @15,@PC00001+8                                      0418
         SLR   @14,@14                                             0418
         STH   @14,REPRC(,@15)                                     0418
*   DO WHILE(LASTKEY>=CRNTKEY);                                    0419
*                                                                  0419
         B     @DE00419                                            0419
@DL00419 DS    0H                                                  0420
*     /***************************************************************/
*     /*                                                             */
*     /* GET RECORD ZERO                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0420
*     DO;                                                          0420
*       WFREQ=''B;                                                 0421
         L     @15,@PC00001+8                                      0421
         XC    WFREQ(2,@15),WFREQ(@15)                             0421
*       WFRGET=ON;                  /* GETRCD                        */
         L     @15,@PC00001+8                                      0422
         OI    WFRGET(@15),B'00100000'                             0422
*       CALL IDCRDIO;                                              0423
         L     @15,@CV01408                                        0423
         BALR  @14,@15                                             0423
*       RFY                                                        0424
*         RTNREG RSTD;                                             0424
*       TESTRC=RTNREG;                                             0425
         STH   RTNREG,TESTRC                                       0425
*       RFY                                                        0426
*         RTNREG UNRSTD;                                           0426
*     END;                                                         0427
*                                                                  0427
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK RETURN CODE FROM GET                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0428
*     IF TESTRC^=0 THEN                                            0428
         LH    @15,TESTRC                                          0428
         LTR   @15,@15                                             0428
         BZ    @RF00428                                            0428
*       DO;                                                        0429
*                                                                  0429
*         /***********************************************************/
*         /*                                                         */
*         /* IF RC ^= 0, THEN BYPASS THIS R0/R1 PAIR IF RC=16 THEN   */
*         /* ISSUE MESSAGE - R0 NOT FOUND IF RC ^= 0 & RC ^= 16, THEN*/
*         /* MESSAGE ALREADY ISSUED                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0430
*         IF TESTRC=16 THEN                                        0430
         CLC   TESTRC(2),@CH00475                                  0430
         BNE   @RF00430                                            0430
*           DO;                                                    0431
*             ZECCHH=CRNHH;                                        0432
         SLR   @15,@15                                             0432
         ICM   @15,3,CRNHH                                         0432
         ST    @15,ZECCHH                                          0432
*             ZERR=0;                                              0433
         MVI   ZERR,X'00'                                          0433
*             DO;                                                  0434
*               CKREQ=CKREQ&&CKREQ;                                0435
         L     @15,@PC00001+8                                      0435
         XC    CKREQ(44,@15),CKREQ(@15)                            0435
*               CKRERN=MSG16;                                      0436
         L     @15,@PC00001+8                                      0436
         MVC   CKRERN(2,@15),@CH00475                              0436
*               CKRMVAR(1)=ADDR(CRNVOLS);                          0437
         L     @15,@PC00001+8                                      0437
         LA    @14,CRNVOLS                                         0437
         ST    @14,CKRMVAR(,@15)                                   0437
*               CKRMVAR(2)=ADDR(ZEROCCHH);                         0438
         L     @15,@PC00001+8                                      0438
         LA    @14,ZEROCCHH                                        0438
         ST    @14,CKRMVAR+4(,@15)                                 0438
*               CKRMVAR(3)=ADDR(RWFDANA);                          0439
         L     @15,@PC00001+8                                      0439
         L     @14,RWFPTR1                                         0439
         ST    @14,CKRMVAR+8(,@15)                                 0439
*               CALL IDCRDER;                                      0440
         L     @15,@CV01407                                        0440
         BALR  @14,@15                                             0440
*             END;                                                 0441
*           END;                                                   0442
*         ELSE                                                     0443
*           ;                                                      0443
@RF00430 DS    0H                                                  0444
*         REPRC=4;                                                 0444
         L     @15,@PC00001+8                                      0444
         MVC   REPRC(2,@15),@CH00045                               0444
*       END;                                                       0445
*     ELSE                                                         0446
*                                                                  0446
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN CODE OK                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0446
*       DO;                                                        0446
*                                                                  0446
         B     @RC00428                                            0446
@RF00428 DS    0H                                                  0447
*         /***********************************************************/
*         /*                                                         */
*         /* RECORD ZERO GOTTEN OK - SAVE R0 IN AREA POINTED TO BY   */
*         /* REPBUFF0                                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0447
*         RFY                                                      0447
*          (REG2,                                                  0447
*           REG3,                                                  0447
*           REG4,                                                  0447
*           REG5) RSTD;                                            0447
*         REG2=REPBUFF0;                                           0448
         L     @15,@PC00001+8                                      0448
         L     REG2,REPBUFF0(,@15)                                 0448
*         REG3=WFIODLN;                                            0449
         L     @15,@PC00001+8                                      0449
         L     REG3,WFIODLN(,@15)                                  0449
*         REG4=WFIODAD;                                            0450
         L     @15,@PC00001+8                                      0450
         L     REG4,WFIODAD(,@15)                                  0450
*         REG5=WFIODLN;                                            0451
         L     @15,@PC00001+8                                      0451
         L     REG5,WFIODLN(,@15)                                  0451
*         MVCL(REG2,REG4);                                         0452
         MVCL  REG2,REG4                                           0452
*         RFY                                                      0453
*          (REG2,                                                  0453
*           REG3,                                                  0453
*           REG4,                                                  0453
*           REG5) UNRSTD;                                          0453
*                                                                  0453
*         /***********************************************************/
*         /*                                                         */
*         /* SAVE RECORD ZERO LENGTH                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0454
*         REPR0LN=WFIODLN;                                         0454
*                                                                  0454
         L     @15,@PC00001+8                                      0454
         L     @14,@PC00001+8                                      0454
         L     @14,WFIODLN(,@14)                                   0454
         STH   @14,REPR0LN(,@15)                                   0454
*         /***********************************************************/
*         /*                                                         */
*         /* NEXT SEQUENTIAL GET WILL GET RECORD ONE                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0455
*         DO;                                                      0455
*           WFREQ=''B;                                             0456
         L     @15,@PC00001+8                                      0456
         XC    WFREQ(2,@15),WFREQ(@15)                             0456
*           WFRGET=ON;              /* GETRCD                        */
         L     @15,@PC00001+8                                      0457
         OI    WFRGET(@15),B'00100000'                             0457
*           CALL IDCRDIO;                                          0458
         L     @15,@CV01408                                        0458
         BALR  @14,@15                                             0458
*           RFY                                                    0459
*             RTNREG RSTD;                                         0459
*           TESTRC=RTNREG;                                         0460
         STH   RTNREG,TESTRC                                       0460
*           RFY                                                    0461
*             RTNREG UNRSTD;                                       0461
*         END;                                                     0462
*                                                                  0462
*         /***********************************************************/
*         /*                                                         */
*         /* TEST RETURN CODE FROM GET                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0463
*         IF TESTRC^=0 THEN                                        0463
         LH    @15,TESTRC                                          0463
         LTR   @15,@15                                             0463
         BZ    @RF00463                                            0463
*           DO;                                                    0464
*                                                                  0464
*             /*******************************************************/
*             /*                                                     */
*             /* IF RC ^= 0, THEN BYPASS THIS R0/R1 RECORD PAIR IF   */
*             /* RC=16 THEN ISSUE MESSAGE IF RC ^=0 & RC ^= 16, THEN */
*             /* MESSAGE ALREADY ISSUED                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0465
*             IF TESTRC=16 THEN                                    0465
         CLC   TESTRC(2),@CH00475                                  0465
         BNE   @RF00465                                            0465
*               DO;                                                0466
*                 ONCCHH=CRNHH;                                    0467
         SLR   @15,@15                                             0467
         ICM   @15,3,CRNHH                                         0467
         ST    @15,ONCCHH                                          0467
*                 ONER=1;                                          0468
         MVI   ONER,X'01'                                          0468
*                 DO;                                              0469
*                   CKREQ=CKREQ&&CKREQ;                            0470
         L     @15,@PC00001+8                                      0470
         XC    CKREQ(44,@15),CKREQ(@15)                            0470
*                   CKRERN=MSG17;                                  0471
         L     @15,@PC00001+8                                      0471
         MVC   CKRERN(2,@15),@CH00630                              0471
*                   CKRMVAR(1)=ADDR(CRNVOLS);                      0472
         L     @15,@PC00001+8                                      0472
         LA    @14,CRNVOLS                                         0472
         ST    @14,CKRMVAR(,@15)                                   0472
*                   CKRMVAR(2)=ADDR(ONECCHH);                      0473
         L     @15,@PC00001+8                                      0473
         LA    @14,ONECCHH                                         0473
         ST    @14,CKRMVAR+4(,@15)                                 0473
*                   CKRMVAR(3)=ADDR(RWFDANA);                      0474
         L     @15,@PC00001+8                                      0474
         L     @14,RWFPTR1                                         0474
         ST    @14,CKRMVAR+8(,@15)                                 0474
*                   CALL IDCRDER;                                  0475
         L     @15,@CV01407                                        0475
         BALR  @14,@15                                             0475
*                 END;                                             0476
*               END;                                               0477
*             ELSE                                                 0478
*               ;                                                  0478
@RF00465 DS    0H                                                  0479
*             REPRC=4;                                             0479
         L     @15,@PC00001+8                                      0479
         MVC   REPRC(2,@15),@CH00045                               0479
*           END;                                                   0480
*         ELSE                                                     0481
*           DO;                                                    0481
*                                                                  0481
         B     @RC00463                                            0481
@RF00463 DS    0H                                                  0482
*             /*******************************************************/
*             /*                                                     */
*             /* RECORD ONE GOTTEN OK SAVE R1 IN AREA POINTED BY     */
*             /* REPBUFF1 USING MVCL FUNCTION                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0482
*             RFY                                                  0482
*              (REG2,                                              0482
*               REG3,                                              0482
*               REG4,                                              0482
*               REG5) RSTD;                                        0482
*             REG2=REPBUFF1;                                       0483
         L     @15,@PC00001+8                                      0483
         L     REG2,REPBUFF1(,@15)                                 0483
*             REG3=WFIODLN;                                        0484
         L     @15,@PC00001+8                                      0484
         L     REG3,WFIODLN(,@15)                                  0484
*             REG4=WFIODAD;                                        0485
         L     @15,@PC00001+8                                      0485
         L     REG4,WFIODAD(,@15)                                  0485
*             REG5=WFIODLN;                                        0486
         L     @15,@PC00001+8                                      0486
         L     REG5,WFIODLN(,@15)                                  0486
*             MVCL(REG2,REG4);                                     0487
         MVCL  REG2,REG4                                           0487
*             RFY                                                  0488
*              (REG2,                                              0488
*               REG3,                                              0488
*               REG4,                                              0488
*               REG5) UNRSTD;                                      0488
*                                                                  0488
*             /*******************************************************/
*             /*                                                     */
*             /* SAVE R1 LENGTH                                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0489
*             REPR1LN=WFIODLN;                                     0489
*                                                                  0489
         L     @15,@PC00001+8                                      0489
         L     @14,@PC00001+8                                      0489
         L     @14,WFIODLN(,@14)                                   0489
         STH   @14,REPR1LN(,@15)                                   0489
*             /*******************************************************/
*             /*                                                     */
*             /* CALL DBLKER TO DO THE DEBLOCKING                    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0490
*             CALL DBLKER;                                         0490
         BAL   @14,DBLKER                                          0490
*             RESPECIFY                                            0491
*               RTNREG RSTD;                                       0491
*             TESTRC=RTNREG;                                       0492
         STH   RTNREG,TESTRC                                       0492
*             RESPECIFY                                            0493
*               RTNREG UNRSTD;                                     0493
*                                                                  0493
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK RETURN CODE FROM DBLKER                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0494
*             IF TESTRC=0 THEN                                     0494
         LH    @15,TESTRC                                          0494
         LTR   @15,@15                                             0494
         BNZ   @RF00494                                            0494
*               DO;                                                0495
*                                                                  0495
*                 /***************************************************/
*                 /*                                                 */
*                 /* RETURNED OK ISSUE MESSAGE OF HOW MANY RECDS     */
*                 /* DEBLOCKED                                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0496
*                 DO;                                              0496
*                   CKREQ=CKREQ&&CKREQ;                            0497
         L     @15,@PC00001+8                                      0497
         XC    CKREQ(44,@15),CKREQ(@15)                            0497
*                   CKRERN=MSG36;                                  0498
         L     @15,@PC00001+8                                      0498
         MVC   CKRERN(2,@15),@CH00711                              0498
*                   CKRMVAR(1)=ADDR(CRNCCHH);                      0499
         L     @15,@PC00001+8                                      0499
         LA    @14,CRNCCHH                                         0499
         ST    @14,CKRMVAR(,@15)                                   0499
*                   CKRMVAR(2)=ADDR(OUTCNT);                       0500
         L     @15,@PC00001+8                                      0500
         LA    @14,OUTCNT                                          0500
         ST    @14,CKRMVAR+4(,@15)                                 0500
*                   CALL IDCRDER;                                  0501
         L     @15,@CV01407                                        0501
         BALR  @14,@15                                             0501
*                 END;                                             0502
*                 REPRCDCT=REPRCDCT+OUTCNT;                        0503
         L     @15,@PC00001+8                                      0503
         L     @14,@PC00001+8                                      0503
         LH    @05,OUTCNT                                          0503
         N     @05,@CF01511                                        0503
         AL    @05,REPRCDCT(,@14)                                  0503
         ST    @05,REPRCDCT(,@15)                                  0503
*               END;                                               0504
*             ELSE                                                 0505
*               IF TESTRC=12 THEN                                  0505
         B     @RC00494                                            0505
@RF00494 CLC   TESTRC(2),@CH00038                                  0505
         BNE   @RF00505                                            0505
*                 DO;                                              0506
*                   CALL IDCIOCL0(GDTTBL,REPORWIO);                0507
         L     @15,@PC00001                                        0507
         ST    @15,@AL00001                                        0507
         L     @15,@PC00001+8                                      0507
         LA    @15,REPORWIO(,@15)                                  0507
         ST    @15,@AL00001+4                                      0507
         MVI   @AL00001+4,X'80'                                    0507
         L     @14,@PC00001                                        0507
         L     @15,GDTCLS(,@14)                                    0507
         LA    @01,@AL00001                                        0507
         BALR  @14,@15                                             0507
*                   CALL IDCSAFP0(GDTTBL,POOLRD01);                0508
         L     @15,@PC00001                                        0508
         ST    @15,@AL00001                                        0508
         LA    @15,POOLRD01                                        0508
         ST    @15,@AL00001+4                                      0508
         MVI   @AL00001+4,X'80'                                    0508
         L     @14,@PC00001                                        0508
         L     @15,GDTFPL(,@14)                                    0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*                   RETURN CODE(LASTCC12);                         0509
         LA    @15,12                                              0509
         L     @14,@SA00002                                        0509
         LM    @00,@12,@SA00002+8                                  0509
         BR    @14                                                 0509
*                 END;                                             0510
*                                                                  0510
*             /*******************************************************/
*             /*                                                     */
*             /* END OF READ RECORD ZERO AND RECORD ONE              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0511
*           END;                                                   0511
*                                                                  0511
@RF00505 DS    0H                                                  0511
@RC00494 DS    0H                                                  0512
*         /***********************************************************/
*         /*                                                         */
*         /* END OF READ RECORD ZERO OK                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0512
*       END;                                                       0512
*                                                                  0512
@RC00463 DS    0H                                                  0513
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT TRACK NUMBER FOR LOOP CONTROL NEXT SEQUENTIAL     */
*     /* RECORD WILL BE NEXT R0 RESET POINTERS TO BEGINNING OF       */
*     /* BUFFERS                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0513
*     CRNHH=CRNHH+1;                                               0513
@RC00428 LA    @15,1                                               0513
         SLR   @14,@14                                             0513
         ICM   @14,3,CRNHH                                         0513
         ALR   @15,@14                                             0513
         STCM  @15,3,CRNHH                                         0513
*     REPBUFF0=SAVEBF0;                                            0514
         L     @15,@PC00001+8                                      0514
         L     @14,SAVEBF0                                         0514
         ST    @14,REPBUFF0(,@15)                                  0514
*     REPBUFF1=SAVEBF1;                                            0515
*                                                                  0515
         L     @15,@PC00001+8                                      0515
         L     @14,SAVEBF1                                         0515
         ST    @14,REPBUFF1(,@15)                                  0515
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING CODE IS USED TO POSITION TO THE NEXT TRACK TO */
*     /* DEBLOCK IF IT EXISTS IF THE NEXT TRACK ISNT THERE-A MESSAGE */
*     /* WILL BE ISSUED REPRC WILL BE SET TO 4 AND THAT TRACK WILL BE*/
*     /* BYPASS                                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0516
*     IF CRNTKEY<=LASTKEY THEN                                     0516
         CLC   CRNTKEY(11),LASTKEY                                 0516
         BH    @RF00516                                            0516
*       DO UNTIL TESTRC=0CRNTKEY>LASTKEY;                         0517
*                                                                  0517
@DL00517 DS    0H                                                  0518
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE A POSRCD TO LOCATE R0 FOR THIS TRACK              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0518
*         WFIOKYA=ADDR(CRNTKEY);                                   0518
         L     @15,@PC00001+8                                      0518
         LA    @14,CRNTKEY                                         0518
         ST    @14,WFIOKYA(,@15)                                   0518
*         DO;                                                      0519
*           WFREQ=''B;                                             0520
         L     @15,@PC00001+8                                      0520
         XC    WFREQ(2,@15),WFREQ(@15)                             0520
*           WFRPOS=ON;              /* POSRCD                        */
         L     @15,@PC00001+8                                      0521
         OI    WFRPOS(@15),B'00001000'                             0521
*           CALL IDCRDIO;                                          0522
         L     @15,@CV01408                                        0522
         BALR  @14,@15                                             0522
*           RFY                                                    0523
*             RTNREG RSTD;                                         0523
*           TESTRC=RTNREG;                                         0524
         STH   RTNREG,TESTRC                                       0524
*           RFY                                                    0525
*             RTNREG UNRSTD;                                       0525
*         END;                                                     0526
*                                                                  0526
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR RETURN CODE FROM POSITION                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0527
*         IF TESTRC^=0 THEN                                        0527
         LH    @15,TESTRC                                          0527
         LTR   @15,@15                                             0527
         BZ    @RF00527                                            0527
*           DO;                                                    0528
*                                                                  0528
*             /*******************************************************/
*             /*                                                     */
*             /* IF RC = 8 ISSUE MESSAGE THAT THIS R0/R1 PAIR NOT    */
*             /* FOUND                                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0529
*             IF TESTRC=8 THEN                                     0529
         CLC   TESTRC(2),@CH00181                                  0529
         BNE   @RF00529                                            0529
*               DO;                                                0530
*                 ZECCHH=CRNHH;                                    0531
         SLR   @15,@15                                             0531
         ICM   @15,3,CRNHH                                         0531
         ST    @15,ZECCHH                                          0531
*                 ZERR=0;                                          0532
         MVI   ZERR,X'00'                                          0532
*                 DO;                                              0533
*                   CKREQ=CKREQ&&CKREQ;                            0534
         L     @15,@PC00001+8                                      0534
         XC    CKREQ(44,@15),CKREQ(@15)                            0534
*                   CKRERN=MSG16;                                  0535
         L     @15,@PC00001+8                                      0535
         MVC   CKRERN(2,@15),@CH00475                              0535
*                   CKRMVAR(1)=ADDR(CRNVOLS);                      0536
         L     @15,@PC00001+8                                      0536
         LA    @14,CRNVOLS                                         0536
         ST    @14,CKRMVAR(,@15)                                   0536
*                   CKRMVAR(2)=ADDR(ZEROCCHH);                     0537
         L     @15,@PC00001+8                                      0537
         LA    @14,ZEROCCHH                                        0537
         ST    @14,CKRMVAR+4(,@15)                                 0537
*                   CKRMVAR(3)=ADDR(RWFDANA);                      0538
         L     @15,@PC00001+8                                      0538
         L     @14,RWFPTR1                                         0538
         ST    @14,CKRMVAR+8(,@15)                                 0538
*                   CALL IDCRDER;                                  0539
         L     @15,@CV01407                                        0539
         BALR  @14,@15                                             0539
*                 END;                                             0540
*               END;                                               0541
*                                                                  0541
*             /*******************************************************/
*             /*                                                     */
*             /* MESSAGE ALREADY ISSUED                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0542
*             ELSE                                                 0542
*               ;                                                  0542
*                                                                  0542
@RF00529 DS    0H                                                  0543
*             /*******************************************************/
*             /*                                                     */
*             /* SET FUTURE RETURN CODE TO 4 AND BYPASS THIS R0/R1   */
*             /* PAIR                                                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0543
*             REPRC=4;                                             0543
         L     @15,@PC00001+8                                      0543
         MVC   REPRC(2,@15),@CH00045                               0543
*             CRNHH=CRNHH+1;                                       0544
         LA    @15,1                                               0544
         SLR   @14,@14                                             0544
         ICM   @14,3,CRNHH                                         0544
         ALR   @15,@14                                             0544
         STCM  @15,3,CRNHH                                         0544
*           END;                                                   0545
*                                                                  0545
*         /***********************************************************/
*         /*                                                         */
*         /* RETURN CODE ZERO FROM POSRCD                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0546
*         ELSE                                                     0546
*           ;                                                      0546
*                                                                  0546
@RF00527 DS    0H                                                  0547
*         /***********************************************************/
*         /*                                                         */
*         /* END DO UNTIL                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0547
*       END;                                                       0547
*                                                                  0547
@DE00517 LH    @15,TESTRC                                          0547
         LTR   @15,@15                                             0547
         BZ    @DC00517                                            0547
         CLC   CRNTKEY(11),LASTKEY                                 0547
         BNH   @DL00517                                            0547
@DC00517 DS    0H                                                  0548
*     /***************************************************************/
*     /*                                                             */
*     /* NO MORE TRACKS TO DEBLOCK                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0548
*     ELSE                                                         0548
*       ;                                                          0548
*                                                                  0548
@RF00516 DS    0H                                                  0549
*     /***************************************************************/
*     /*                                                             */
*     /* END OF DO WHILE                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0549
*   END;                                                           0549
*                                                                  0549
@DE00419 CLC   LASTKEY(11),CRNTKEY                                 0549
         BNL   @DL00419                                            0549
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL RECORDS HAVE BEEN DEBLOCKED CLOSE THE REPAIRWORKFILE, FREE*/
*   /* THE BUFFER SPACE AND RETURN WITH EVERYTHING OK                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0550
*   CALL IDCIOCL0(GDTTBL,REPORWIO);                                0550
         L     @15,@PC00001                                        0550
         ST    @15,@AL00001                                        0550
         L     @15,@PC00001+8                                      0550
         LA    @15,REPORWIO(,@15)                                  0550
         ST    @15,@AL00001+4                                      0550
         MVI   @AL00001+4,X'80'                                    0550
         L     @14,@PC00001                                        0550
         L     @15,GDTCLS(,@14)                                    0550
         LA    @01,@AL00001                                        0550
         BALR  @14,@15                                             0550
*   CALL IDCSAFP0(GDTTBL,POOLRD01);                                0551
         L     @15,@PC00001                                        0551
         ST    @15,@AL00001                                        0551
         LA    @15,POOLRD01                                        0551
         ST    @15,@AL00001+4                                      0551
         MVI   @AL00001+4,X'80'                                    0551
         L     @14,@PC00001                                        0551
         L     @15,GDTFPL(,@14)                                    0551
         LA    @01,@AL00001                                        0551
         BALR  @14,@15                                             0551
*   TESTRC=0;                                                      0552
         SLR   @15,@15                                             0552
         STH   @15,TESTRC                                          0552
*   RETURN CODE(TESTRC);                                           0553
         LH    @15,TESTRC                                          0553
         L     @14,@SA00002                                        0553
         LM    @00,@12,@SA00002+8                                  0553
         BR    @14                                                 0553
*                                                                  0554
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - DBLKER                                         */
*/*                                                                  */
*/*  FUNCTION - TO DEBLOCK AN R'0/R'1 PAIR OF STAGE ERROR            */
*/*      RECORDS INTO THEIR R'0 TO R'N RECORDS                       */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*  MESSAGES - ISSUES THE FOLLOWING ERROR MESSAGES                  */
*/*                                                                  */
*/*     IDC11218I- THE RECORD HAS ALREADY BEEN MODIFIED- OR IF       */
*/*                IT IS NOT A STAGE ERROR RECORD                    */
*/*                                                                  */
*/*     IDC11217I- THE R'1 RECORD WAS NOT FOUND                      */
*/*                                                                  */
*/*                                                                  */
*/*     IDC11219I- THE DEBLOCKED RECORDS WILL NOT FIT ON THE TRACK   */
*/*                                                                  */
*/*     IDC11244I- STAGE ERROR IN A CYLINDER                         */
*/*                                                                  */
*/*     IDC31237I- BAD LENGTH PARAMETER                              */
*/*                                                                  */
*/*  MACROS/SVCS                                                     */
*/*                                                                  */
*/*     ?CALLCKER - TO PRINT A MESSAGE                               */
*/*                                                                  */
*/*     ?UPDRCD = TO WRITE DEBLOCKED RECORDS TO THE REPAIR WORKFILE  */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*         REPTBL - INCLUDING THE REPCB AND THE LENGTHS OF          */
*/*                  R'0 AND R'1                                     */
*/*                                                                  */
*/*                                                                  */
*/*  OUTPUT - DEBLOCKED RECORDS IN THE REPAIR WORK FILE              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0554
*DBLKER:                                                           0554
*   PROC;                                                          0554
*                                                                  0554
DBLKER   STM   @14,@12,@SA00003                                    0554
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0555
*   RFY                                                            0555
*     RB0 BASED(REPBUFF0);                                         0555
*   RFY                                                            0556
*     RB1 BASED(REPBUFF1);                                         0556
*   IF GDTDBG=NULLPTR THEN                                         0557
         L     @15,@PC00001                                        0557
         L     @15,GDTDBG(,@15)                                    0557
         LTR   @15,@15                                             0557
         BZ    @RT00557                                            0557
*     ;                                                            0558
*   ELSE                                                           0559
*     CALL IDCDB010(GDTTBL,'RD42');                                0559
         L     @15,@PC00001                                        0559
         ST    @15,@AL00001                                        0559
         LA    @15,@CC01495                                        0559
         ST    @15,@AL00001+4                                      0559
         MVI   @AL00001+4,X'80'                                    0559
         L     @14,@PC00001                                        0559
         L     @15,GDTDBG(,@14)                                    0559
         LA    @01,@AL00001                                        0559
         BALR  @14,@15                                             0559
*   OLDERID2=NEWERID2;                                             0560
@RT00557 L     @15,@PC00001                                        0560
         L     @01,GDTTR2(,@15)                                    0560
         L     @15,@PC00001                                        0560
         L     @15,GDTTR2(,@15)                                    0560
         MVC   @TS00001(95),NEWERID2(@15)                          0560
         MVC   OLDERID2(95,@01),@TS00001                           0560
*   NEWID2='RD43';                                                 0561
*                                                                  0561
         L     @15,@PC00001                                        0561
         L     @01,GDTTR2(,@15)                                    0561
         MVC   NEWID2(4,@01),@CC01496                              0561
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THAT THE SECOND RECORD READ IS THE R'1 RECORD           */
*   /* CORRESPONDING TO THE R'0 RECORD PREVIOUSLY READ               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   IF RB1KR^=1RB1KVCH^=RB0KVCH THEN                              0562
         L     @15,@PC00001+8                                      0562
         L     @01,REPBUFF1(,@15)                                  0562
         CLI   RB1KR(@01),1                                        0562
         BNE   @RT00562                                            0562
         L     @15,@PC00001+8                                      0562
         L     @01,REPBUFF1(,@15)                                  0562
         L     @15,@PC00001+8                                      0562
         L     @15,REPBUFF0(,@15)                                  0562
         CLC   RB1KVCH(10,@01),RB0KVCH(@15)                        0562
         BE    @RF00562                                            0562
@RT00562 DS    0H                                                  0563
*     DO;                                                          0563
*       ONCCHH=CRNHH;                                              0564
         SLR   @15,@15                                             0564
         ICM   @15,3,CRNHH                                         0564
         ST    @15,ONCCHH                                          0564
*       ONER=1;                                                    0565
         MVI   ONER,X'01'                                          0565
*       DO;                                                        0566
*         CKREQ=CKREQ&&CKREQ;                                      0567
         L     @15,@PC00001+8                                      0567
         XC    CKREQ(44,@15),CKREQ(@15)                            0567
*         CKRERN=MSG17;                                            0568
         L     @15,@PC00001+8                                      0568
         MVC   CKRERN(2,@15),@CH00630                              0568
*         CKRMVAR(1)=ADDR(CRNVOLS);                                0569
         L     @15,@PC00001+8                                      0569
         LA    @14,CRNVOLS                                         0569
         ST    @14,CKRMVAR(,@15)                                   0569
*         CKRMVAR(2)=ADDR(ONECCHH);                                0570
         L     @15,@PC00001+8                                      0570
         LA    @14,ONECCHH                                         0570
         ST    @14,CKRMVAR+4(,@15)                                 0570
*         CKRMVAR(3)=ADDR(RWFDANA);                                0571
         L     @15,@PC00001+8                                      0571
         L     @14,RWFPTR1                                         0571
         ST    @14,CKRMVAR+8(,@15)                                 0571
*         CALL IDCRDER;                                            0572
         L     @15,@CV01407                                        0572
         BALR  @14,@15                                             0572
*       END;                                                       0573
*       REPRC=4;                                                   0574
         L     @15,@PC00001+8                                      0574
         MVC   REPRC(2,@15),@CH00045                               0574
*       RETURN CODE(LASTCC04);                                     0575
         LA    @15,4                                               0575
         L     @14,@SA00003                                        0575
         LM    @00,@12,@SA00003+8                                  0575
         BR    @14                                                 0575
*     END;                                                         0576
*   ELSE                                                           0577
*     ;                                                            0577
*                                                                  0577
@RF00562 DS    0H                                                  0578
*   /*****************************************************************/
*   /*                                                               */
*   /* ENSURE R0 & R1 ARE STAGE ERROR RECORDS                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*   IF RB0FMOD=2RB0FMOD=3RB1FMOD=2RB1FMOD=3RB0FERR^=5(RB1FERR^=9&
*       RB1FERR^=10) THEN                                          0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF0(,@15)                                  0578
         CLI   RB0FMOD(@01),2                                      0578
         BE    @RT00578                                            0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF0(,@15)                                  0578
         CLI   RB0FMOD(@01),3                                      0578
         BE    @RT00578                                            0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF1(,@15)                                  0578
         CLI   RB1FMOD(@01),2                                      0578
         BE    @RT00578                                            0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF1(,@15)                                  0578
         CLI   RB1FMOD(@01),3                                      0578
         BE    @RT00578                                            0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF0(,@15)                                  0578
         CLC   RB0FERR(2,@01),@CH00288                             0578
         BNE   @RT00578                                            0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF1(,@15)                                  0578
         CLC   RB1FERR(2,@01),@CH00035                             0578
         BE    @RF00578                                            0578
         L     @15,@PC00001+8                                      0578
         L     @01,REPBUFF1(,@15)                                  0578
         CLC   RB1FERR(2,@01),@CH00036                             0578
         BE    @RF00578                                            0578
@RT00578 DS    0H                                                  0579
*     DO;                                                          0579
*                                                                  0579
*       /*************************************************************/
*       /*                                                           */
*       /* R'0 AND R'1 ARE NOT STAGE ERROR RECORDS. THIS PAIR IS     */
*       /* BYPASSED ISSUE MESSAGE AND RETURN CODE 04                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0580
*       DO;                                                        0580
*         CKREQ=CKREQ&&CKREQ;                                      0581
         L     @15,@PC00001+8                                      0581
         XC    CKREQ(44,@15),CKREQ(@15)                            0581
*         CKRERN=MSG18;                                            0582
         L     @15,@PC00001+8                                      0582
         MVC   CKRERN(2,@15),@CH00632                              0582
*         CKRMVAR(1)=ADDR(CRNTKEY);                                0583
         L     @15,@PC00001+8                                      0583
         LA    @14,CRNTKEY                                         0583
         ST    @14,CKRMVAR(,@15)                                   0583
*         CKRMVAR(2)=ADDR(CRNCCHH);                                0584
         L     @15,@PC00001+8                                      0584
         LA    @14,CRNCCHH                                         0584
         ST    @14,CKRMVAR+4(,@15)                                 0584
*         CKRMVAR(3)=ADDR(RWFDANA);                                0585
         L     @15,@PC00001+8                                      0585
         L     @14,RWFPTR1                                         0585
         ST    @14,CKRMVAR+8(,@15)                                 0585
*         CALL IDCRDER;                                            0586
         L     @15,@CV01407                                        0586
         BALR  @14,@15                                             0586
*       END;                                                       0587
*       REPRC=4;                                                   0588
         L     @15,@PC00001+8                                      0588
         MVC   REPRC(2,@15),@CH00045                               0588
*       RETURN CODE(LASTCC04);                                     0589
         LA    @15,4                                               0589
         L     @14,@SA00003                                        0589
         LM    @00,@12,@SA00003+8                                  0589
         BR    @14                                                 0589
*     END;                                                         0590
*   ELSE                                                           0591
*     ;                                                            0591
*                                                                  0591
@RF00578 DS    0H                                                  0592
*   /*****************************************************************/
*   /*                                                               */
*   /* CK IF R'1 DATA FIELD LENGTH IS ONE OR IF THE          @ZA25908*/
*   /* ORIGINAL RECORD 1 LENGTH IS ZERO, IF IT IS,           @ZA25908*/
*   /* GET OUT. BAD CYLINDER CREATED BY STAGING PROCESS      @ZA25908*/
*   /* OR THE SA WAS NOT ABLE TO READ THE DATA FROM THE      @ZA25908*/
*   /* DATA SET LEAVING THE DATA RECORD DATA ALL ZEROES.@ZA25908     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0592
*   IF RB1CDL=1RB00DKDL=0 THEN     /*                       @ZA25908*/
         L     @15,@PC00001+8                                      0592
         L     @01,REPBUFF1(,@15)                                  0592
         CLC   RB1CDL(2,@01),@CH00221                              0592
         BE    @RT00592                                            0592
         L     @15,@PC00001+8                                      0592
         L     @01,REPBUFF0(,@15)                                  0592
         ICM   @00,3,RB00DKDL(@01)                                 0592
         BNZ   @RF00592                                            0592
@RT00592 DS    0H                                                  0593
*     DO;                                                          0593
*       DO;                                                        0594
*         CKREQ=CKREQ&&CKREQ;                                      0595
         L     @15,@PC00001+8                                      0595
         XC    CKREQ(44,@15),CKREQ(@15)                            0595
*         CKRERN=MSG44;                                            0596
         L     @15,@PC00001+8                                      0596
         MVC   CKRERN(2,@15),@CH00600                              0596
*         CKRMVAR(1)=ADDR(RB1CCHH);                                0597
         L     @15,@PC00001+8                                      0597
         L     @14,@PC00001+8                                      0597
         L     @01,REPBUFF1(,@14)                                  0597
         LA    @14,RB1CCHH(,@01)                                   0597
         ST    @14,CKRMVAR(,@15)                                   0597
*         CALL IDCRDER;                                            0598
         L     @15,@CV01407                                        0598
         BALR  @14,@15                                             0598
*       END;                                                       0599
*       REPRC=4;                                                   0600
         L     @15,@PC00001+8                                      0600
         MVC   REPRC(2,@15),@CH00045                               0600
*       RETURN CODE(LASTCC04);                                     0601
         LA    @15,4                                               0601
         L     @14,@SA00003                                        0601
         LM    @00,@12,@SA00003+8                                  0601
         BR    @14                                                 0601
*     END;                                                         0602
*   ELSE                                                           0603
*     ;                                                            0603
*                                                                  0603
@RF00592 DS    0H                                                  0604
*   /*****************************************************************/
*   /*                                                               */
*   /* START DEBLOCKING RECORD 1 SAVE VSAM KEY OF RECORD ZERO        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0604
*   SAVEKEY=RB0K;                                                  0604
*                                                                  0604
         L     @15,@PC00001+8                                      0604
         L     @01,REPBUFF0(,@15)                                  0604
         MVC   SAVEKEY(11),RB0K(@01)                               0604
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE LENGTH OF RECORD ONE BUFFER                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0605
*   SAVER1DL=RB1CDL;                                               0605
*                                                                  0605
         L     @15,@PC00001+8                                      0605
         L     @01,REPBUFF1(,@15)                                  0605
         MVC   SAVER1DL(2),RB1CDL(@01)                             0605
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF NEW TRACK DOES NOT BEGIN AT RECORD 1--IF IT DOES NOT */
*   /* BEGIN AT RECORD 1 THEN WRITE A MESSAGE TO             @ZA27389*/
*   /* THE USER NOTIFYING HIM OF THIS PROBLEM.               @ZA27389*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0606
*   IF RB00DKRN^=1 THEN                                            0606
         L     @15,@PC00001+8                                      0606
         L     @01,REPBUFF0(,@15)                                  0606
         CLI   RB00DKRN(@01),1                                     0606
         BE    @RF00606                                            0606
*     DO;                           /*                       @ZA27389*/
*       DO;                                                        0608
*         CKREQ=CKREQ&&CKREQ;                                      0609
         L     @15,@PC00001+8                                      0609
         XC    CKREQ(44,@15),CKREQ(@15)                            0609
*         CKRERN=MSG47;                                            0610
         L     @15,@PC00001+8                                      0610
         MVC   CKRERN(2,@15),@CH00781                              0610
*         CALL IDCRDER;                                            0611
         L     @15,@CV01407                                        0611
         BALR  @14,@15                                             0611
*       END;                        /*                       @ZA27389*/
*       REPRC=4;                    /*                       @ZA27389*/
         L     @15,@PC00001+8                                      0613
         MVC   REPRC(2,@15),@CH00045                               0613
*       RETURN CODE(LASTCC04);      /*                       @ZA27389*/
         LA    @15,4                                               0614
         L     @14,@SA00003                                        0614
         LM    @00,@12,@SA00003+8                                  0614
         BR    @14                                                 0614
*     END;                          /*                       @ZA27389*/
*   ELSE                                                           0616
*     ;                             /*                       @ZA27389*/
*                                                                  0616
@RF00606 DS    0H                                                  0617
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ORIGINAL R1 RECORD NUMBER FROM R0                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0617
*   RB1CR=RB00DKRN;                                                0617
*                                                                  0617
         L     @15,@PC00001+8                                      0617
         L     @01,REPBUFF1(,@15)                                  0617
         L     @15,@PC00001+8                                      0617
         L     @15,REPBUFF0(,@15)                                  0617
         MVC   RB1CR(1,@01),RB00DKRN(@15)                          0617
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ORIGINAL R1 KEY LEN AND DATA LEN FROM R0 AND SET THE      */
*   /* ORIGINAL CCHH IN THE FIRST 4 BYTES OF THE R0 DATA FIELD       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0618
*   RB1CKL=RB00DKKL;                                               0618
         L     @15,@PC00001+8                                      0618
         L     @01,REPBUFF1(,@15)                                  0618
         L     @15,@PC00001+8                                      0618
         L     @15,REPBUFF0(,@15)                                  0618
         MVC   RB1CKL(1,@01),RB00DKKL(@15)                         0618
*   RB1CDL=RB00DKDL;                                               0619
         L     @15,@PC00001+8                                      0619
         L     @01,REPBUFF1(,@15)                                  0619
         L     @15,@PC00001+8                                      0619
         L     @15,REPBUFF0(,@15)                                  0619
         MVC   RB1CDL(2,@01),RB00DKDL(@15)                         0619
*   RB00DK=RB1CCHH;                                                0620
*                                                                  0620
         L     @15,@PC00001+8                                      0620
         L     @01,REPBUFF0(,@15)                                  0620
         L     @15,@PC00001+8                                      0620
         L     @15,REPBUFF1(,@15)                                  0620
         MVC   RB00DK(4,@01),RB1CCHH(@15)                          0620
*   /*****************************************************************/
*   /*                                                               */
*   /* SET "REC HAS BEEN DEBLOCKED INDICATOR" IN R0 AND SAVE R0 FLAG */
*   /* BYTES NOTE THAT IF THE R'0 OR R'1 RECORD HAD BEEN PREVIOUSLY  */
*   /* MODIFIED, THEIR MODIFICATION INDICATOR WILL BE OVERLAID BY THE*/
*   /* DEBLOCK INDICATOR                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0621
*   RB0FMOD=DBLKFLG;                                               0621
         L     @15,@PC00001+8                                      0621
         L     @01,REPBUFF0(,@15)                                  0621
         MVC   RB0FMOD(1,@01),DBLKFLG                              0621
*   RB1FMOD=DBLKFLG;                                               0622
         L     @15,@PC00001+8                                      0622
         L     @01,REPBUFF1(,@15)                                  0622
         MVC   RB1FMOD(1,@01),DBLKFLG                              0622
*   SAVEFL=RB1F;                                                   0623
*                                                                  0623
         L     @15,@PC00001+8                                      0623
         L     @01,REPBUFF1(,@15)                                  0623
         MVC   SAVEFL(5),RB1F(@01)                                 0623
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE HEAD NUMBER OF ORIGINAL TRACK TO COMPARISON LATER        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0624
*   SAVEHH=RB0CHH;                                                 0624
*                                                                  0624
         L     @15,@PC00001+8                                      0624
         L     @01,REPBUFF0(,@15)                                  0624
         MVC   SAVEHH(2),RB0CHH(@01)                               0624
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE ERROR COUNT                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   ERRCNT=ZERO;                                                   0625
*                                                                  0625
         MVC   ERRCNT(1),ZERO+1                                    0625
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INDEX INTO DBLTBL (DEBLOCK TABLE) INDEX WILL ALWAYS*/
*   /* BE ONE GREATER THAN THE RECORD NUMBER TO ALLOW FOR AN ENTRY   */
*   /* FOR RECORD ZERO                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*   OUTCNT=1;                                                      0626
*                                                                  0626
         MVC   OUTCNT(2),@CH00221                                  0626
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE KEY PADDING FACTOR TO ZERO                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0627
*   PK=ZERO;                                                       0627
*                                                                  0627
         MVC   PK(1),ZERO+1                                        0627
*   /*****************************************************************/
*   /*                                                               */
*   /* THE BUFFER POINTED TO BY REPBUFF0 WILL HAVE THE DEBLOCKED     */
*   /* RECORDS SET R0 ENTRY IN DEBLOCK TABLE (DBLTBL) CNT KEYLEN IS  */
*   /* ZERO, DATA LEN IS VSAM KEY LEN + FLAG BYTES + THE SIXTEEN     */
*   /* BYTES OF R0 COUNT AND DATA                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0628
*   DBLTCKLN(1)=ZERO;                                              0628
         LH    @15,ZERO                                            0628
         STH   @15,DBLTCKLN                                        0628
*   DBLTRPTR(1)=REPBUFF0;                                          0629
         L     @15,@PC00001+8                                      0629
         L     @15,REPBUFF0(,@15)                                  0629
         ST    @15,DBLTRPTR                                        0629
*   RB0LEN=LENGTH(RB0K)+LENGTH(RB0F)+R0CDLEN;                      0630
         LA    @15,16                                              0630
         AH    @15,R0CDLEN                                         0630
         STH   @15,RB0LEN                                          0630
*   DBLTRLN(1)=RB0LEN;                                             0631
*                                                                  0631
         LH    @15,RB0LEN                                          0631
         STH   @15,DBLTRLN                                         0631
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE BEGINNING ADDRESS OF R1 BUFFER                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0632
*   SAVER1BF=REPBUFF1;                                             0632
*                                                                  0632
         L     @15,@PC00001+8                                      0632
         L     @15,REPBUFF1(,@15)                                  0632
         ST    @15,SAVER1BF                                        0632
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT REBUILD BUFFER AREA TO NEXT RECORD                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0633
*   REPBUFF0=REPBUFF0+RB0LEN;                                      0633
*                                                                  0633
         L     @15,@PC00001+8                                      0633
         L     @14,@PC00001+8                                      0633
         LH    @05,RB0LEN                                          0633
         AL    @05,REPBUFF0(,@14)                                  0633
         ST    @05,REPBUFF0(,@15)                                  0633
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT RECORD1 BUFFER TO BYPASS THE VSAM KEY               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0634
*   REPBUFF1=REPBUFF1+LENGTH(RB1K)+1;                              0634
*                                                                  0634
         L     @15,@PC00001+8                                      0634
         L     @14,@PC00001+8                                      0634
         LA    @05,12                                              0634
         AL    @05,REPBUFF1(,@14)                                  0634
         ST    @05,REPBUFF1(,@15)                                  0634
*   /*****************************************************************/
*   /*                                                               */
*   /* REPBUFF1 POINTS TO NEXT COUNT MINUS THE FLAG BYTES CK IF      */
*   /* HEADER INDICATES FIXED LENGTH                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*   IF RWFHFT=FIXIND THEN                                          0635
*                                                                  0635
         L     @15,@PC00001+8                                      0635
         L     @01,REPRWHDO(,@15)                                  0635
         CLC   RWFHFT(1,@01),FIXIND                                0635
         BNE   @RF00635                                            0635
*     /***************************************************************/
*     /*                                                             */
*     /* FIXED LEN RECORDS-COMPUTE PADDING FACTOR FOR DATA           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0636
*     PD=BTSPERWD-(RWFHDLN//BTSPERWD);                             0636
         L     @15,@PC00001+8                                      0636
         L     @01,REPRWHDO(,@15)                                  0636
         LH    @01,RWFHDLN(,@01)                                   0636
         N     @01,@CF01511                                        0636
         SLR   @00,@00                                             0636
         LH    @15,BTSPERWD                                        0636
         DR    @00,@15                                             0636
         LCR   @00,@00                                             0636
         AH    @00,BTSPERWD                                        0636
         STC   @00,PD                                              0636
*   ELSE                                                           0637
*     ;                                                            0637
*                                                                  0637
@RF00635 DS    0H                                                  0638
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET ADDRESSABLITY TO RECORD ONE BUFFER AREA VSAM KEY FIELD  */
*   /* NO LONGER PRESENT                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0638
*   RFY                                                            0638
*     RBIN BASED(REPBUFF1);                                        0638
*                                                                  0638
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FORCE INDICATOR                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0639
*   FORCE=ZERO;                                                    0639
*                                                                  0639
         MVC   FORCE(1),ZERO+1                                     0639
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF USER SPECIFIED KEY AND DATA LENGTHS                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0640
*   IF ADDR(DBLST)^=NULLPTR THEN                                   0640
*                                                                  0640
         L     @15,@PC00001+4                                      0640
         L     @15,FDTPTR+292(,@15)                                0640
         LTR   @15,@15                                             0640
         BZ    @RF00640                                            0640
*     /***************************************************************/
*     /*                                                             */
*     /* LENGTHS SUPPLIED-SET THE LENGTHS IN THE R'1 DATA FIELD      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0641
*     DO;                                                          0641
*                                                                  0641
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP FOR NUMBER OF LENGTH FIELDS SUPPLIED                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0642
*       DO ICNT1=1 TO DBLSTCNT;                                    0642
*                                                                  0642
         LA    @15,1                                               0642
         B     @DE00642                                            0642
@DL00642 DS    0H                                                  0643
*         /***********************************************************/
*         /*                                                         */
*         /* SET KEY LENGTH AND DATA LEN IN ORIG RECORD ONE TO KEY   */
*         /* LEN AND DATA LEN SUPPLIED BY USER                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0643
*         RBICKL=DBKEYPTR(ICNT1)->DBKEYVAL;                        0643
         L     @15,@PC00001+8                                      0643
         L     @01,REPBUFF1(,@15)                                  0643
         LH    @15,ICNT1                                           0643
         SLA   @15,2                                               0643
         L     @14,@PC00001+4                                      0643
         L     @14,FDTPTR+312(,@14)                                0643
         AL    @14,@CF01512                                        0643
         L     @15,DBKEYPTR(@15,@14)                               0643
         MVC   RBICKL(1,@01),DBKEYVAL+3(@15)                       0643
*         RBICDL=DBDATPTR(ICNT1)->DBDATVAL;                        0644
*                                                                  0644
         L     @15,@PC00001+8                                      0644
         L     @01,REPBUFF1(,@15)                                  0644
         LH    @15,ICNT1                                           0644
         SLA   @15,2                                               0644
         L     @14,@PC00001+4                                      0644
         L     @14,FDTPTR+316(,@14)                                0644
         AL    @14,@CF01512                                        0644
         L     @15,DBDATPTR(@15,@14)                               0644
         MVC   RBICDL(2,@01),DBDATVAL+2(@15)                       0644
*         /***********************************************************/
*         /*                                                         */
*         /* COMPUTE KEY PADDING                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0645
*         IF RBICKL^=ZERO THEN                                     0645
*                                                                  0645
         L     @15,@PC00001+8                                      0645
         L     @01,REPBUFF1(,@15)                                  0645
         SLR   @00,@00                                             0645
         IC    @00,RBICKL(,@01)                                    0645
         CH    @00,ZERO                                            0645
         BE    @RF00645                                            0645
*           /*********************************************************/
*           /*                                                       */
*           /* KEY EXISTS-COMPUTE PADDING FACTOR                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0646
*           PK=BTSPERWD-(RBICKL//BTSPERWD);                        0646
         L     @15,@PC00001+8                                      0646
         L     @01,REPBUFF1(,@15)                                  0646
         SLR   @02,@02                                             0646
         IC    @02,RBICKL(,@01)                                    0646
         SRDA  @02,32                                              0646
         LH    @15,BTSPERWD                                        0646
         DR    @02,@15                                             0646
         LCR   @02,@02                                             0646
         AH    @02,BTSPERWD                                        0646
         STC   @02,PK                                              0646
*         ELSE                                                     0647
*                                                                  0647
*           /*********************************************************/
*           /*                                                       */
*           /* KEY LEN ZERO-NO KEY PADDING FACTOR REQUIRED           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0647
*           PK=ZERO;                                               0647
*                                                                  0647
         B     @RC00645                                            0647
@RF00645 MVC   PK(1),ZERO+1                                        0647
*         /***********************************************************/
*         /*                                                         */
*         /* COMPUTE DATA PADDING                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0648
*         PD=BTSPERWD-(RBICDL//BTSPERWD);                          0648
*                                                                  0648
@RC00645 L     @15,@PC00001+8                                      0648
         L     @01,REPBUFF1(,@15)                                  0648
         SLR   @03,@03                                             0648
         ICM   @03,3,RBICDL(@01)                                   0648
         SLR   @02,@02                                             0648
         LH    @15,BTSPERWD                                        0648
         DR    @02,@15                                             0648
         LCR   @02,@02                                             0648
         AH    @02,BTSPERWD                                        0648
         STC   @02,PD                                              0648
*         /***********************************************************/
*         /*                                                         */
*         /* INCREMENT TO NEXT COUNT FIELD IN RECORD 1 BUFFER        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0649
*         REPBUFF1=REPBUFF1+PK+PD+RBICKL+RBICDL+LENGTH(RBI4)+COUNTLEN;
*                                                                  0649
         L     @15,@PC00001+8                                      0649
         L     @14,@PC00001+8                                      0649
         SLR   @05,@05                                             0649
         IC    @05,PK                                              0649
         AL    @05,REPBUFF1(,@14)                                  0649
         SLR   @04,@04                                             0649
         IC    @04,PD                                              0649
         ALR   @05,@04                                             0649
         L     @14,@PC00001+8                                      0649
         L     @01,REPBUFF1(,@14)                                  0649
         SLR   @04,@04                                             0649
         IC    @04,RBICKL(,@01)                                    0649
         ALR   @05,@04                                             0649
         L     @14,@PC00001+8                                      0649
         L     @01,REPBUFF1(,@14)                                  0649
         SLR   @04,@04                                             0649
         ICM   @04,3,RBICDL(@01)                                   0649
         ALR   @05,@04                                             0649
         AL    @05,@CF00045                                        0649
         AH    @05,COUNTLEN                                        0649
         ST    @05,REPBUFF1(,@15)                                  0649
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF REPBUFF1 GETS OUTSIDE THE R'1 DATA FIELD AND IF*/
*         /* IT DOES, GET OUT OF LOOP                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0650
*         IF(REPBUFF1-SAVER1BF-24)>SAVER1DL THEN                   0650
         L     @15,@PC00001+8                                      0650
         L     @15,REPBUFF1(,@15)                                  0650
         SL    @15,SAVER1BF                                        0650
         SL    @15,@CF00312                                        0650
         LH    @14,SAVER1DL                                        0650
         N     @14,@CF01511                                        0650
         CR    @15,@14                                             0650
         BNH   @RF00650                                            0650
*           ICNT1=DBLSTCNT;                                        0651
         L     @15,@PC00001+4                                      0651
         LA    @15,FDTPTR+292(,@15)                                0651
         L     @15,DBLSTCNT(,@15)                                  0651
         STH   @15,ICNT1                                           0651
*         ELSE                                                     0652
*           ;                                                      0652
@RF00650 DS    0H                                                  0653
*       END;                                                       0653
*                                                                  0653
         LA    @15,1                                               0653
         AH    @15,ICNT1                                           0653
@DE00642 STH   @15,ICNT1                                           0653
         L     @14,@PC00001+4                                      0653
         LA    @14,FDTPTR+292(,@14)                                0653
         C     @15,DBLSTCNT(,@14)                                  0653
         BNH   @DL00642                                            0653
*       /*************************************************************/
*       /*                                                           */
*       /* OUT OF DO LOOP - ALL COUNT FIELDS NOW HAVE NEW LENGTH CK  */
*       /* IF THE LENGTHS GIVEN GET US TO THE END OF THE BUFF        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0654
*       IF(REPBUFF1-SAVER1BF-24)>SAVER1DL THEN                     0654
*                                                                  0654
         L     @15,@PC00001+8                                      0654
         L     @15,REPBUFF1(,@15)                                  0654
         SL    @15,SAVER1BF                                        0654
         SL    @15,@CF00312                                        0654
         LH    @14,SAVER1DL                                        0654
         N     @14,@CF01511                                        0654
         CR    @15,@14                                             0654
         BNH   @RF00654                                            0654
*         /***********************************************************/
*         /*                                                         */
*         /* TOO MANY BYTES                                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0655
*         DO;                                                      0655
*           DO;                                                    0656
*             CKREQ=CKREQ&&CKREQ;                                  0657
         L     @15,@PC00001+8                                      0657
         XC    CKREQ(44,@15),CKREQ(@15)                            0657
*             CKRERN=MSG37;                                        0658
         L     @15,@PC00001+8                                      0658
         MVC   CKRERN(2,@15),@CH00717                              0658
*             CKRMVAR(1)=ADDR(LARGE);                              0659
         L     @15,@PC00001+8                                      0659
         LA    @14,LARGE                                           0659
         ST    @14,CKRMVAR(,@15)                                   0659
*             CALL IDCRDER;                                        0660
         L     @15,@CV01407                                        0660
         BALR  @14,@15                                             0660
*           END;                                                   0661
*           REPRC=12;                                              0662
         L     @15,@PC00001+8                                      0662
         MVC   REPRC(2,@15),@CH00038                               0662
*           RETURN CODE(LASTCC12);                                 0663
         LA    @15,12                                              0663
         L     @14,@SA00003                                        0663
         LM    @00,@12,@SA00003+8                                  0663
         BR    @14                                                 0663
*         END;                                                     0664
*       ELSE                                                       0665
*         ;                                                        0665
@RF00654 DS    0H                                                  0666
*       IF(REPBUFF1-SAVER1BF-24)<SAVER1DL THEN                     0666
*                                                                  0666
         L     @15,@PC00001+8                                      0666
         L     @15,REPBUFF1(,@15)                                  0666
         SL    @15,SAVER1BF                                        0666
         SL    @15,@CF00312                                        0666
         LH    @14,SAVER1DL                                        0666
         N     @14,@CF01511                                        0666
         CR    @15,@14                                             0666
         BNL   @RF00666                                            0666
*         /***********************************************************/
*         /*                                                         */
*         /* NOT ENOUGH BYTES                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0667
*         DO;                                                      0667
*           DO;                                                    0668
*             CKREQ=CKREQ&&CKREQ;                                  0669
         L     @15,@PC00001+8                                      0669
         XC    CKREQ(44,@15),CKREQ(@15)                            0669
*             CKRERN=MSG37;                                        0670
         L     @15,@PC00001+8                                      0670
         MVC   CKRERN(2,@15),@CH00717                              0670
*             CKRMVAR(1)=ADDR(SMALL);                              0671
         L     @15,@PC00001+8                                      0671
         LA    @14,SMALL                                           0671
         ST    @14,CKRMVAR(,@15)                                   0671
*             CALL IDCRDER;                                        0672
         L     @15,@CV01407                                        0672
         BALR  @14,@15                                             0672
*           END;                                                   0673
*           REPRC=12;                                              0674
         L     @15,@PC00001+8                                      0674
         MVC   REPRC(2,@15),@CH00038                               0674
*           RETURN CODE(LASTCC12);                                 0675
         LA    @15,12                                              0675
         L     @14,@SA00003                                        0675
         LM    @00,@12,@SA00003+8                                  0675
         BR    @14                                                 0675
*         END;                                                     0676
*       ELSE                                                       0677
*         ;                                                        0677
*                                                                  0677
@RF00666 DS    0H                                                  0678
*       /*************************************************************/
*       /*                                                           */
*       /* GOOD LENGTH INFORMATION - FORCE DEBLOCK TO CONT           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0678
*       FORCE=NONZERO;                                             0678
*                                                                  0678
         MVC   FORCE(1),NONZERO                                    0678
*       /*************************************************************/
*       /*                                                           */
*       /* RESET REPBUFF1 TO POINT TO FIRST COUNT AGAIN              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0679
*       REPBUFF1=SAVER1BF+LENGTH(RB1K)+1;                          0679
         L     @15,@PC00001+8                                      0679
         LA    @14,12                                              0679
         AL    @14,SAVER1BF                                        0679
         ST    @14,REPBUFF1(,@15)                                  0679
*     END;                                                         0680
*                                                                  0680
*   /*****************************************************************/
*   /*                                                               */
*   /* LENGTHS NOT SUPPLIED - JUST CONTINUE                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0681
*   ELSE                                                           0681
*     ;                                                            0681
*                                                                  0681
@RF00640 DS    0H                                                  0682
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP FOR SIZE OF BUFFER-REBUILDING RECORDS AND SETTING UP THE */
*   /* DEBLOCK TABLE SET UTRACE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0682
*   OLDERID2=NEWERID2;                                             0682
         L     @15,@PC00001                                        0682
         L     @01,GDTTR2(,@15)                                    0682
         L     @15,@PC00001                                        0682
         L     @15,GDTTR2(,@15)                                    0682
         MVC   @TS00001(95),NEWERID2(@15)                          0682
         MVC   OLDERID2(95,@01),@TS00001                           0682
*   NEWID2='RD44';                                                 0683
         L     @15,@PC00001                                        0683
         L     @01,GDTTR2(,@15)                                    0683
         MVC   NEWID2(4,@01),@CC01499                              0683
*   DO WHILE REPR1LN>(REPBUFF1-SAVER1BF);                          0684
*                                                                  0684
         B     @DE00684                                            0684
@DL00684 DS    0H                                                  0685
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT DBLTBL INDEX                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0685
*     OUTCNT=OUTCNT+1;                                             0685
*                                                                  0685
         LA    @15,1                                               0685
         LH    @14,OUTCNT                                          0685
         N     @14,@CF01511                                        0685
         ALR   @15,@14                                             0685
         STH   @15,OUTCNT                                          0685
*     /***************************************************************/
*     /*                                                             */
*     /* SET RECORD NUMBER BEING DEBLOCKED INTO VSAM KEY             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0686
*     SAVEKEYR=RBICR;                                              0686
*                                                                  0686
         L     @15,@PC00001+8                                      0686
         L     @01,REPBUFF1(,@15)                                  0686
         MVC   SAVEKEYR(1),RBICR(@01)                              0686
*     /***************************************************************/
*     /*                                                             */
*     /* SET VSAM KEY IN DEBLOCKED RECORD                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0687
*     RB0K=SAVEKEY;                                                0687
*                                                                  0687
         L     @15,@PC00001+8                                      0687
         L     @01,REPBUFF0(,@15)                                  0687
         MVC   RB0K(11,@01),SAVEKEY                                0687
*     /***************************************************************/
*     /*                                                             */
*     /* SET FLAG BYTES IN DEBLOCKED RECORD                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0688
*     RB0F=SAVEFL;                                                 0688
*                                                                  0688
         L     @15,@PC00001+8                                      0688
         L     @01,REPBUFF0(,@15)                                  0688
         MVC   RB0F(5,@01),SAVEFL                                  0688
*     /***************************************************************/
*     /*                                                             */
*     /* SET COUNT FIELD IN DEBLOCKED RECORD TO COUNT FIELD OF       */
*     /* ORIGINAL RECORD                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0689
*     RB0C=RBIC;                                                   0689
*                                                                  0689
         L     @15,@PC00001+8                                      0689
         L     @01,REPBUFF0(,@15)                                  0689
         L     @15,@PC00001+8                                      0689
         L     @15,REPBUFF1(,@15)                                  0689
         MVC   RB0C(8,@01),RBIC(@15)                               0689
*     /***************************************************************/
*     /*                                                             */
*     /* CK IF KEY PRESENT                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0690
*     IF RBICKL^=ZERO THEN                                         0690
*                                                                  0690
         L     @15,@PC00001+8                                      0690
         L     @01,REPBUFF1(,@15)                                  0690
         SLR   @00,@00                                             0690
         IC    @00,RBICKL(,@01)                                    0690
         CH    @00,ZERO                                            0690
         BE    @RF00690                                            0690
*       /*************************************************************/
*       /*                                                           */
*       /* KEY EXISTS - SET KEY LEN IN DEBLOCK TABLE                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0691
*       DO;                                                        0691
*         DBLTCKLN(OUTCNT)=RBICKL;                                 0692
*                                                                  0692
         LH    @15,OUTCNT                                          0692
         N     @15,@CF01511                                        0692
         SLA   @15,3                                               0692
         L     @14,@PC00001+8                                      0692
         L     @01,REPBUFF1(,@14)                                  0692
         SLR   @00,@00                                             0692
         IC    @00,RBICKL(,@01)                                    0692
         STH   @00,DBLTCKLN-8(@15)                                 0692
*         /***********************************************************/
*         /*                                                         */
*         /* COMPUTE PADDING FACTOR FOR KEY                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0693
*         PK=BTSPERWD-(RBICKL//BTSPERWD);                          0693
*                                                                  0693
         L     @15,@PC00001+8                                      0693
         L     @01,REPBUFF1(,@15)                                  0693
         SLR   @02,@02                                             0693
         IC    @02,RBICKL(,@01)                                    0693
         SRDA  @02,32                                              0693
         LH    @15,BTSPERWD                                        0693
         DR    @02,@15                                             0693
         LCR   @02,@02                                             0693
         AH    @02,BTSPERWD                                        0693
         STC   @02,PK                                              0693
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF THE KEY LENGTH WILL EXCEED THE R'1 RECORD      */
*         /* LENGTH                                                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0694
*         IF REPR1LN-12<REPBUFF1-SAVER1BF+RBICKL+PK THEN           0694
         L     @15,@PC00001+8                                      0694
         LH    @15,REPR1LN(,@15)                                   0694
         N     @15,@CF01511                                        0694
         SL    @15,@CF00038                                        0694
         L     @14,@PC00001+8                                      0694
         L     @14,REPBUFF1(,@14)                                  0694
         SL    @14,SAVER1BF                                        0694
         L     @05,@PC00001+8                                      0694
         L     @01,REPBUFF1(,@05)                                  0694
         SLR   @00,@00                                             0694
         IC    @00,RBICKL(,@01)                                    0694
         ALR   @14,@00                                             0694
         SLR   @05,@05                                             0694
         IC    @05,PK                                              0694
         ALR   @14,@05                                             0694
         CR    @15,@14                                             0694
         BNL   @RF00694                                            0694
*           SWLENKEY=1;                                            0695
         MVI   SWLENKEY,X'01'                                      0695
*         ELSE                                                     0696
*           DO;                                                    0696
*                                                                  0696
         B     @RC00694                                            0696
@RF00694 DS    0H                                                  0697
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE KEY TO DEBLOCKED REC FROM ORIG REC + PADDING   */
*             /* AND TURN OFF "KEY OUTSIDE R'1 INDICATOR"            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0697
*             RB0DK(1:RBICKL)=RBIDK(PK+1:(PK+RBICKL));             0697
         L     @15,@PC00001+8                                      0697
         L     @01,REPBUFF0(,@15)                                  0697
         L     @15,@PC00001+8                                      0697
         L     @15,REPBUFF1(,@15)                                  0697
         SLR   @14,@14                                             0697
         IC    @14,RBICKL(,@15)                                    0697
         BCTR  @14,0                                               0697
         SLR   @15,@15                                             0697
         IC    @15,PK                                              0697
         L     @05,@PC00001+8                                      0697
         L     @05,REPBUFF1(,@05)                                  0697
         ALR   @05,@15                                             0697
         EX    @14,@SM01513                                        0697
*             SWLENKEY=0;                                          0698
         MVI   SWLENKEY,X'00'                                      0698
*           END;                                                   0699
*       END;                                                       0700
*                                                                  0700
*     /***************************************************************/
*     /*                                                             */
*     /* NO KEY-ENSURE PADDING FACTOR IS ZERO                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0701
*     ELSE                                                         0701
*       PK=ZERO;                                                   0701
*                                                                  0701
         B     @RC00690                                            0701
@RF00690 MVC   PK(1),ZERO+1                                        0701
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR EOF RECORD                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0702
*     IF RBICDL=ZERO THEN                                          0702
@RC00690 L     @15,@PC00001+8                                      0702
         L     @01,REPBUFF1(,@15)                                  0702
         SLR   @00,@00                                             0702
         ICM   @00,3,RBICDL(@01)                                   0702
         CH    @00,ZERO                                            0702
         BNE   @RF00702                                            0702
*       RBICDL=1;                                                  0703
         L     @15,@PC00001+8                                      0703
         L     @01,REPBUFF1(,@15)                                  0703
         MVC   RBICDL(2,@01),@CH00221                              0703
*     ELSE                                                         0704
*       ;                                                          0704
*                                                                  0704
@RF00702 DS    0H                                                  0705
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE ORIGINAL DATA SET HAD FBS (FIXED BLOCKED STANDARD    */
*     /* RECORDS AND THE FORCE FIELD IS ZERO AND THE CURRENT RECORD  */
*     /* BEING DEBLOCKED IS NOT AN EOF RECORD, THEN THE RECORD LENGTH*/
*     /* PROVIDED IN THE RWF HEADER WILL BE USED AND THE PADDING     */
*     /* FACTOR WAS ALREADY COMPUTED NOTE THAT THE LAST RECORD COULD */
*     /* BE LESS THAN FBS LENGTH IN WHICH CASE THE BUFFER WILL GET   */
*     /* OUT OF THE R'1 DATA FIELD AND IT WILL BE FIXED AT A LATER   */
*     /* TIME                                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0705
*     IF RWFHFT=FIXIND&FORCE=ZERO&RB0CDL^=0 THEN                   0705
         L     @15,@PC00001+8                                      0705
         L     @01,REPRWHDO(,@15)                                  0705
         CLC   RWFHFT(1,@01),FIXIND                                0705
         BNE   @RF00705                                            0705
         SLR   @15,@15                                             0705
         IC    @15,FORCE                                           0705
         CH    @15,ZERO                                            0705
         BNE   @RF00705                                            0705
         L     @15,@PC00001+8                                      0705
         L     @01,REPBUFF0(,@15)                                  0705
         ICM   @00,3,RB0CDL(@01)                                   0705
         BZ    @RF00705                                            0705
*       DO;                                                        0706
*         SAVFIXDL=RBICDL;                                         0707
         L     @15,@PC00001+8                                      0707
         L     @01,REPBUFF1(,@15)                                  0707
         MVC   SAVFIXDL(2),RBICDL(@01)                             0707
*         RBICDL=RWFHDLN;                                          0708
         L     @15,@PC00001+8                                      0708
         L     @01,REPBUFF1(,@15)                                  0708
         L     @15,@PC00001+8                                      0708
         L     @15,REPRWHDO(,@15)                                  0708
         MVC   RBICDL(2,@01),RWFHDLN(@15)                          0708
*         RB0CDL=RWFHDLN;                                          0709
         L     @15,@PC00001+8                                      0709
         L     @01,REPBUFF0(,@15)                                  0709
         L     @15,@PC00001+8                                      0709
         L     @15,REPRWHDO(,@15)                                  0709
         MVC   RB0CDL(2,@01),RWFHDLN(@15)                          0709
*         SWFIX=1;                                                 0710
         MVI   SWFIX,X'01'                                         0710
*       END;                                                       0711
*     ELSE                                                         0712
*                                                                  0712
*       /*************************************************************/
*       /*                                                           */
*       /* NOT FBS RECORD - COMPUTE PADDING FACTOR FOR DATA          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0712
*       DO;                                                        0712
         B     @RC00705                                            0712
@RF00705 DS    0H                                                  0713
*         PD=BTSPERWD-(RBICDL//BTSPERWD);                          0713
         L     @15,@PC00001+8                                      0713
         L     @01,REPBUFF1(,@15)                                  0713
         SLR   @03,@03                                             0713
         ICM   @03,3,RBICDL(@01)                                   0713
         SLR   @02,@02                                             0713
         LH    @15,BTSPERWD                                        0713
         DR    @02,@15                                             0713
         LCR   @02,@02                                             0713
         AH    @02,BTSPERWD                                        0713
         STC   @02,PD                                              0713
*         SWFIX=0;                                                 0714
         MVI   SWFIX,X'00'                                         0714
*       END;                                                       0715
*                                                                  0715
*     /***************************************************************/
*     /*                                                             */
*     /* ENSURE THE DATA LENGTH DOES NOT EXCEED R'1 RECORD LENGTH    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0716
*     IF REPR1LN-12<REPBUFF1-SAVER1BF+RBICKL+RBICDL+PD+PK THEN     0716
@RC00705 L     @15,@PC00001+8                                      0716
         LH    @15,REPR1LN(,@15)                                   0716
         N     @15,@CF01511                                        0716
         SL    @15,@CF00038                                        0716
         L     @14,@PC00001+8                                      0716
         L     @14,REPBUFF1(,@14)                                  0716
         SL    @14,SAVER1BF                                        0716
         L     @05,@PC00001+8                                      0716
         L     @01,REPBUFF1(,@05)                                  0716
         SLR   @00,@00                                             0716
         IC    @00,RBICKL(,@01)                                    0716
         ALR   @14,@00                                             0716
         L     @05,@PC00001+8                                      0716
         L     @01,REPBUFF1(,@05)                                  0716
         SLR   @00,@00                                             0716
         ICM   @00,3,RBICDL(@01)                                   0716
         ALR   @14,@00                                             0716
         SLR   @05,@05                                             0716
         IC    @05,PD                                              0716
         ALR   @14,@05                                             0716
         SLR   @05,@05                                             0716
         IC    @05,PK                                              0716
         ALR   @14,@05                                             0716
         CR    @15,@14                                             0716
         BNL   @RF00716                                            0716
*       DO;                                                        0717
*                                                                  0717
*         /***********************************************************/
*         /*                                                         */
*         /* THE CURRENT DATA LENGTH WILL EXCEED THE R'1 RECORD      */
*         /* LENGTH, WHICH IS AN ERROR. THE ONLY EXCEPTION IS THE    */
*         /* LAST RECORD IN A FBS( FIXED BLOCK STANDARD)             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0718
*         IF SWFIX=1 THEN                                          0718
         CLI   SWFIX,1                                             0718
         BNE   @RF00718                                            0718
*           DO;                                                    0719
*                                                                  0719
*             /*******************************************************/
*             /*                                                     */
*             /* THE DEBLOCKING FAILED IN A FBS RECORD - A CHECK WILL*/
*             /* BE MADE USING THE ACTUAL DATA LENGTH OF THE ORIGINAL*/
*             /* RECORD SAVED IN SAVFIXDL - THIS IS DONE BECAUSE THE */
*             /* LAST RECORD MAY BE A SHORT RECORD                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0720
*             RBICDL=SAVFIXDL;                                     0720
         L     @15,@PC00001+8                                      0720
         L     @01,REPBUFF1(,@15)                                  0720
         MVC   RBICDL(2,@01),SAVFIXDL                              0720
*             RB0CDL=SAVFIXDL;                                     0721
         L     @15,@PC00001+8                                      0721
         L     @01,REPBUFF0(,@15)                                  0721
         MVC   RB0CDL(2,@01),SAVFIXDL                              0721
*             PD=BTSPERWD-(RBICDL//BTSPERWD);                      0722
*                                                                  0722
         L     @15,@PC00001+8                                      0722
         L     @01,REPBUFF1(,@15)                                  0722
         SLR   @03,@03                                             0722
         ICM   @03,3,RBICDL(@01)                                   0722
         SLR   @02,@02                                             0722
         LH    @15,BTSPERWD                                        0722
         DR    @02,@15                                             0722
         LCR   @02,@02                                             0722
         AH    @02,BTSPERWD                                        0722
         STC   @02,PD                                              0722
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK THAT THE LAST DEBLOCKED RECORD WILL END       */
*             /* EXACTLY AT THE END OF R'1                           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0723
*             IF REPR1LN-12=REPBUFF1-SAVER1BF+RBICKL+RBICDL+PD+PK THEN
         L     @15,@PC00001+8                                      0723
         LH    @15,REPR1LN(,@15)                                   0723
         N     @15,@CF01511                                        0723
         SL    @15,@CF00038                                        0723
         L     @14,@PC00001+8                                      0723
         L     @14,REPBUFF1(,@14)                                  0723
         SL    @14,SAVER1BF                                        0723
         L     @05,@PC00001+8                                      0723
         L     @01,REPBUFF1(,@05)                                  0723
         SLR   @00,@00                                             0723
         IC    @00,RBICKL(,@01)                                    0723
         ALR   @14,@00                                             0723
         L     @05,@PC00001+8                                      0723
         L     @01,REPBUFF1(,@05)                                  0723
         SLR   @00,@00                                             0723
         ICM   @00,3,RBICDL(@01)                                   0723
         ALR   @14,@00                                             0723
         SLR   @05,@05                                             0723
         IC    @05,PD                                              0723
         ALR   @14,@05                                             0723
         SLR   @05,@05                                             0723
         IC    @05,PK                                              0723
         ALR   @14,@05                                             0723
         CR    @15,@14                                             0723
         BNE   @RF00723                                            0723
*               DO;                                                0724
*                                                                  0724
*                 /***************************************************/
*                 /*                                                 */
*                 /* THE LAST RECORD DATA LENGTH OK MOVE RECORD      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0725
*                 SWLENDAT=0;                                      0725
         MVI   SWLENDAT,X'00'                                      0725
*                 TARPTR=ADDR(RB0DK)+RBICKL;                       0726
         L     @15,@PC00001+8                                      0726
         L     @01,REPBUFF0(,@15)                                  0726
         LA    @15,RB0DK(,@01)                                     0726
         L     @14,@PC00001+8                                      0726
         L     @01,REPBUFF1(,@14)                                  0726
         SLR   @14,@14                                             0726
         IC    @14,RBICKL(,@01)                                    0726
         ALR   @15,@14                                             0726
         ST    @15,TARPTR                                          0726
*                 SOURPTR=ADDR(RBIDK)+RBICKL+PD+PK;                0727
         L     @15,@PC00001+8                                      0727
         L     @01,REPBUFF1(,@15)                                  0727
         LA    @15,RBIDK(,@01)                                     0727
         L     @14,@PC00001+8                                      0727
         L     @01,REPBUFF1(,@14)                                  0727
         SLR   @14,@14                                             0727
         IC    @14,RBICKL(,@01)                                    0727
         ALR   @15,@14                                             0727
         SLR   @14,@14                                             0727
         IC    @14,PD                                              0727
         ALR   @15,@14                                             0727
         SLR   @14,@14                                             0727
         IC    @14,PK                                              0727
         ALR   @15,@14                                             0727
         ST    @15,SOURPTR                                         0727
*                 RFY                                              0728
*                  (REG2,                                          0728
*                   REG3,                                          0728
*                   REG4,                                          0728
*                   REG5) RSTD;                                    0728
*                 REG2=TARPTR;                                     0729
         L     REG2,TARPTR                                         0729
*                 REG3=RBICDL;                                     0730
         L     @15,@PC00001+8                                      0730
         L     @01,REPBUFF1(,@15)                                  0730
         SLR   REG3,REG3                                           0730
         ICM   REG3,3,RBICDL(@01)                                  0730
*                 REG4=SOURPTR;                                    0731
         L     REG4,SOURPTR                                        0731
*                 REG5=RBICDL;                                     0732
         L     @15,@PC00001+8                                      0732
         L     @01,REPBUFF1(,@15)                                  0732
         SLR   REG5,REG5                                           0732
         ICM   REG5,3,RBICDL(@01)                                  0732
*                 MVCL(REG2,REG4);                                 0733
         MVCL  REG2,REG4                                           0733
*                 RFY                                              0734
*                  (REG2,                                          0734
*                   REG3,                                          0734
*                   REG4,                                          0734
*                   REG5) UNRSTD;                                  0734
*               END;                                               0735
*             ELSE                                                 0736
*               SWLENDAT=1;                                        0736
         B     @RC00723                                            0736
@RF00723 MVI   SWLENDAT,X'01'                                      0736
*           END;                                                   0737
*         ELSE                                                     0738
*           SWLENDAT=1;                                            0738
         B     @RC00718                                            0738
@RF00718 MVI   SWLENDAT,X'01'                                      0738
*       END;                                                       0739
*     ELSE                                                         0740
*       DO;                                                        0740
*                                                                  0740
         B     @RC00716                                            0740
@RF00716 DS    0H                                                  0741
*         /***********************************************************/
*         /*                                                         */
*         /* MOVE DATA TO REBUILD AREA DATA STARTS AT END OF KEY AND */
*         /* KEY PADDING AND DATA PAD AND GETS MOVED TO LOCATION PAST*/
*         /* REBUILT KEY                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0741
*         SWLENDAT=0;                                              0741
         MVI   SWLENDAT,X'00'                                      0741
*         TARPTR=ADDR(RB0DK)+RBICKL;                               0742
         L     @15,@PC00001+8                                      0742
         L     @01,REPBUFF0(,@15)                                  0742
         LA    @15,RB0DK(,@01)                                     0742
         L     @14,@PC00001+8                                      0742
         L     @01,REPBUFF1(,@14)                                  0742
         SLR   @14,@14                                             0742
         IC    @14,RBICKL(,@01)                                    0742
         ALR   @15,@14                                             0742
         ST    @15,TARPTR                                          0742
*         SOURPTR=ADDR(RBIDK)+RBICKL+PD+PK;                        0743
         L     @15,@PC00001+8                                      0743
         L     @01,REPBUFF1(,@15)                                  0743
         LA    @15,RBIDK(,@01)                                     0743
         L     @14,@PC00001+8                                      0743
         L     @01,REPBUFF1(,@14)                                  0743
         SLR   @14,@14                                             0743
         IC    @14,RBICKL(,@01)                                    0743
         ALR   @15,@14                                             0743
         SLR   @14,@14                                             0743
         IC    @14,PD                                              0743
         ALR   @15,@14                                             0743
         SLR   @14,@14                                             0743
         IC    @14,PK                                              0743
         ALR   @15,@14                                             0743
         ST    @15,SOURPTR                                         0743
*         RFY                                                      0744
*          (REG2,                                                  0744
*           REG3,                                                  0744
*           REG4,                                                  0744
*           REG5) RSTD;                                            0744
*         REG2=TARPTR;                                             0745
         L     REG2,TARPTR                                         0745
*         REG3=RBICDL;                                             0746
         L     @15,@PC00001+8                                      0746
         L     @01,REPBUFF1(,@15)                                  0746
         SLR   REG3,REG3                                           0746
         ICM   REG3,3,RBICDL(@01)                                  0746
*         REG4=SOURPTR;                                            0747
         L     REG4,SOURPTR                                        0747
*         REG5=RBICDL;                                             0748
         L     @15,@PC00001+8                                      0748
         L     @01,REPBUFF1(,@15)                                  0748
         SLR   REG5,REG5                                           0748
         ICM   REG5,3,RBICDL(@01)                                  0748
*         MVCL(REG2,REG4);                                         0749
         MVCL  REG2,REG4                                           0749
*         RFY                                                      0750
*          (REG2,                                                  0750
*           REG3,                                                  0750
*           REG4,                                                  0750
*           REG5) UNRSTD;                                          0750
*       END;                                                       0751
*                                                                  0751
*     /***************************************************************/
*     /*                                                             */
*     /* SAVE PAD INFO OF ORIG REC IN CASE OF OVERFLW AND SET DBLTBL */
*     /* ENTRIES                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0752
*     SAVE4=RBI4;                                                  0752
@RC00716 L     @15,@PC00001+8                                      0752
         L     @01,REPBUFF1(,@15)                                  0752
         MVC   SAVE4(4),RBI4(@01)                                  0752
*     DBLTRPTR(OUTCNT)=REPBUFF0;                                   0753
         LH    @15,OUTCNT                                          0753
         N     @15,@CF01511                                        0753
         SLA   @15,3                                               0753
         L     @14,@PC00001+8                                      0753
         L     @14,REPBUFF0(,@14)                                  0753
         ST    @14,DBLTRPTR-8(@15)                                 0753
*     DBLTRLN(OUTCNT)=DBLTCKLN(OUTCNT)+RBICDL+LENGTH(RB0F)+LENGTH(RB0K)
*         +COUNTLEN;                                               0754
*                                                                  0754
         LH    @15,OUTCNT                                          0754
         N     @15,@CF01511                                        0754
         SLA   @15,3                                               0754
         LH    @14,OUTCNT                                          0754
         N     @14,@CF01511                                        0754
         SLA   @14,3                                               0754
         L     @05,@PC00001+8                                      0754
         L     @01,REPBUFF1(,@05)                                  0754
         LH    @14,DBLTCKLN-8(@14)                                 0754
         N     @14,@CF01511                                        0754
         SLR   @00,@00                                             0754
         ICM   @00,3,RBICDL(@01)                                   0754
         ALR   @14,@00                                             0754
         AL    @14,@CF00475                                        0754
         AH    @14,COUNTLEN                                        0754
         STH   @14,DBLTRLN-8(@15)                                  0754
*     /***************************************************************/
*     /*                                                             */
*     /* CK IF CURRENT RECORD GOES OUT OF R'1 RECORD                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0755
*     IF SWLENKEY=1SWLENDAT=1 THEN                                0755
*                                                                  0755
         CLI   SWLENKEY,1                                          0755
         BE    @RT00755                                            0755
         CLI   SWLENDAT,1                                          0755
         BNE   @RF00755                                            0755
@RT00755 DS    0H                                                  0756
*       /*************************************************************/
*       /*                                                           */
*       /* CURRENT RECORD GOES OUT OF R'1 ISSUE MESSAGE              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0756
*       DO;                                                        0756
*                                                                  0756
*         /***********************************************************/
*         /*                                                         */
*         /* SET REPBUFF1 TO END OF BUFF TO GET OUT OF DO WHILE      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0757
*         REPBUFF1=SAVER1BF+REPR1LN+1;                             0757
*                                                                  0757
         L     @15,@PC00001+8                                      0757
         L     @14,@PC00001+8                                      0757
         LH    @14,REPR1LN(,@14)                                   0757
         N     @14,@CF01511                                        0757
         AL    @14,SAVER1BF                                        0757
         AL    @14,@CF00221                                        0757
         ST    @14,REPBUFF1(,@15)                                  0757
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MESSAGE AND UPDATE ERROR COUNT TO GET OUT         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0758
*         DO;                                                      0758
*           CKREQ=CKREQ&&CKREQ;                                    0759
         L     @15,@PC00001+8                                      0759
         XC    CKREQ(44,@15),CKREQ(@15)                            0759
*           CKRERN=MSG19;                                          0760
         L     @15,@PC00001+8                                      0760
         MVC   CKRERN(2,@15),@CH00643                              0760
*           CKRMVAR(1)=ADDR(SAVKEY6);                              0761
         L     @15,@PC00001+8                                      0761
         LA    @14,SAVKEY6                                         0761
         ST    @14,CKRMVAR(,@15)                                   0761
*           CKRMVAR(2)=ADDR(SAVEKEY4);                             0762
         L     @15,@PC00001+8                                      0762
         LA    @14,SAVEKEY4                                        0762
         ST    @14,CKRMVAR+4(,@15)                                 0762
*           CKRMVAR(3)=ADDR(RWFDANA);                              0763
         L     @15,@PC00001+8                                      0763
         L     @14,RWFPTR1                                         0763
         ST    @14,CKRMVAR+8(,@15)                                 0763
*           CALL IDCRDER;                                          0764
         L     @15,@CV01407                                        0764
         BALR  @14,@15                                             0764
*         END;                                                     0765
*         ERRCNT=3;                                                0766
         MVI   ERRCNT,X'03'                                        0766
*       END;                                                       0767
*                                                                  0767
*     /***************************************************************/
*     /*                                                             */
*     /* NO MESSAGE NEEDS TO BE ISSUED                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0768
*     ELSE                                                         0768
*                                                                  0768
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF TRACKS DONT AGREE, NO FORCE AND NO ERRORS YET    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0768
*       DO;                                                        0768
         B     @RC00755                                            0768
@RF00755 DS    0H                                                  0769
*         IF SAVEHH^=RBICHH&FORCE=ZERO                             0769
*                                                                  0769
*         /***********************************************************/
*         /*                                                         */
*         /* JUST INCREMENT ERROR COUNTER SO WILL END NEXT TIME      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0769
*           THEN                                                   0769
         L     @15,@PC00001+8                                      0769
         L     @01,REPBUFF1(,@15)                                  0769
         CLC   SAVEHH(2),RBICHH(@01)                               0769
         BE    @RF00769                                            0769
         SLR   @15,@15                                             0769
         IC    @15,FORCE                                           0769
         CH    @15,ZERO                                            0769
         BNE   @RF00769                                            0769
*           ERRCNT=ERRCNT+1;                                       0770
         LA    @15,1                                               0770
         SLR   @14,@14                                             0770
         IC    @14,ERRCNT                                          0770
         ALR   @15,@14                                             0770
         STC   @15,ERRCNT                                          0770
*         ELSE                                                     0771
*           ;                                                      0771
*                                                                  0771
@RF00769 DS    0H                                                  0772
*         /***********************************************************/
*         /*                                                         */
*         /* INCREMNT BUFFERS TO NEXT RECORD DESTINATION AND LOC     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0772
*         REPBUFF0=REPBUFF0+RBICKL+RBICDL+LENGTH(RB0K)+LENGTH(RB0F)+
*             COUNTLEN;                                            0772
         L     @15,@PC00001+8                                      0772
         L     @14,@PC00001+8                                      0772
         L     @05,@PC00001+8                                      0772
         L     @01,REPBUFF1(,@05)                                  0772
         SLR   @00,@00                                             0772
         IC    @00,RBICKL(,@01)                                    0772
         AL    @00,REPBUFF0(,@14)                                  0772
         L     @14,@PC00001+8                                      0772
         L     @01,REPBUFF1(,@14)                                  0772
         SLR   @14,@14                                             0772
         ICM   @14,3,RBICDL(@01)                                   0772
         ALR   @00,@14                                             0772
         AL    @00,@CF00475                                        0772
         AH    @00,COUNTLEN                                        0772
         ST    @00,REPBUFF0(,@15)                                  0772
*         REPBUFF1=REPBUFF1+RBICKL+RBICDL+PK+PD+LENGTH(RBI4)+COUNTLEN;
         L     @15,@PC00001+8                                      0773
         L     @14,@PC00001+8                                      0773
         L     @05,@PC00001+8                                      0773
         L     @01,REPBUFF1(,@05)                                  0773
         SLR   @00,@00                                             0773
         IC    @00,RBICKL(,@01)                                    0773
         AL    @00,REPBUFF1(,@14)                                  0773
         L     @14,@PC00001+8                                      0773
         L     @01,REPBUFF1(,@14)                                  0773
         SLR   @14,@14                                             0773
         ICM   @14,3,RBICDL(@01)                                   0773
         ALR   @00,@14                                             0773
         SLR   @01,@01                                             0773
         IC    @01,PK                                              0773
         ALR   @00,@01                                             0773
         SLR   @01,@01                                             0773
         IC    @01,PD                                              0773
         ALR   @00,@01                                             0773
         AL    @00,@CF00045                                        0773
         AH    @00,COUNTLEN                                        0773
         ST    @00,REPBUFF1(,@15)                                  0773
*       END;                                                       0774
*                                                                  0774
*     /***************************************************************/
*     /*                                                             */
*     /* END OF DO WHILE                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0775
*   END;                                                           0775
*                                                                  0775
@RC00755 DS    0H                                                  0775
@DE00684 L     @15,@PC00001+8                                      0775
         L     @14,@PC00001+8                                      0775
         L     @14,REPBUFF1(,@14)                                  0775
         SL    @14,SAVER1BF                                        0775
         LH    @15,REPR1LN(,@15)                                   0775
         N     @15,@CF01511                                        0775
         CR    @14,@15                                             0775
         BL    @DL00684                                            0775
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UDUMP                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0776
*   IF GDTDBG=NULLPTR THEN                                         0776
         L     @15,@PC00001                                        0776
         L     @15,GDTDBG(,@15)                                    0776
         LTR   @15,@15                                             0776
         BZ    @RT00776                                            0776
*     ;                                                            0777
*   ELSE                                                           0778
*     CALL IDCDB010(GDTTBL,'RD45');                                0778
         L     @15,@PC00001                                        0778
         ST    @15,@AL00001                                        0778
         LA    @15,@CC01500                                        0778
         ST    @15,@AL00001+4                                      0778
         MVI   @AL00001+4,X'80'                                    0778
         L     @14,@PC00001                                        0778
         L     @15,GDTDBG(,@14)                                    0778
         LA    @01,@AL00001                                        0778
         BALR  @14,@15                                             0778
*   IF ERRCNT>1 THEN                                               0779
@RT00776 CLI   ERRCNT,1                                            0779
         BNH   @RF00779                                            0779
*     DO;                                                          0780
*                                                                  0780
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN - DONT ISSUE ANY MESSAGES                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0781
*       REPRC=4;                                                   0781
         L     @15,@PC00001+8                                      0781
         MVC   REPRC(2,@15),@CH00045                               0781
*       RETURN CODE(LASTCC04);                                     0782
         LA    @15,4                                               0782
         L     @14,@SA00003                                        0782
         LM    @00,@12,@SA00003+8                                  0782
         BR    @14                                                 0782
*     END;                                                         0783
*   ELSE                                                           0784
*     ;                                                            0784
*                                                                  0784
@RF00779 DS    0H                                                  0785
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF LAST RECORD WAS AN OVERFLOW RECORD                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0785
*   IF SAVE50VF=ON THEN                                            0785
         TM    SAVE50VF,B'00010000'                                0785
         BNO   @RF00785                                            0785
*     DO;                                                          0786
*                                                                  0786
*       /*************************************************************/
*       /*                                                           */
*       /* LAST REC OVERFLOW - SET OVERFLOW BIT ON AND SET THE NEW   */
*       /* ERROR FLAG TO EITHER 11 OR 12 TO INDICATE THE OVERFLOW    */
*       /* CONDITION                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0787
*       RFY                                                        0787
*         RB0 BASED(DBLTRPTR(OUTCNT));                             0787
*       RB0FOVF=1;                                                 0788
         LH    @15,OUTCNT                                          0788
         N     @15,@CF01511                                        0788
         SLA   @15,3                                               0788
         L     @01,DBLTRPTR-8(@15)                                 0788
         MVI   RB0FOVF(@01),X'01'                                  0788
*       RB0FERR=RB0FERR+2;                                         0789
         LH    @15,OUTCNT                                          0789
         N     @15,@CF01511                                        0789
         SLA   @15,3                                               0789
         L     @01,DBLTRPTR-8(@15)                                 0789
         LH    @15,OUTCNT                                          0789
         N     @15,@CF01511                                        0789
         SLA   @15,3                                               0789
         L     @15,DBLTRPTR-8(@15)                                 0789
         LA    @14,2                                               0789
         SLR   @00,@00                                             0789
         ICM   @00,3,RB0FERR(@15)                                  0789
         ALR   @14,@00                                             0789
         STCM  @14,3,RB0FERR(@01)                                  0789
*     END;                                                         0790
*   ELSE                                                           0791
*     ;                                                            0791
*                                                                  0791
@RF00785 DS    0H                                                  0792
*   /*****************************************************************/
*   /*                                                               */
*   /* REWRITE DEBLOCKED RECORDS                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0792
*   DO ICNT2=1 TO OUTCNT;                                          0792
         LA    @15,1                                               0792
         B     @DE00792                                            0792
@DL00792 DS    0H                                                  0793
*     WFIODAD=DBLTRPTR(ICNT2);                                     0793
         L     @15,@PC00001+8                                      0793
         LH    @14,ICNT2                                           0793
         SLA   @14,3                                               0793
         L     @14,DBLTRPTR-8(@14)                                 0793
         ST    @14,WFIODAD(,@15)                                   0793
*     WFIODLN=DBLTRLN(ICNT2);                                      0794
         L     @15,@PC00001+8                                      0794
         LH    @14,ICNT2                                           0794
         SLA   @14,3                                               0794
         LH    @14,DBLTRLN-8(@14)                                  0794
         N     @14,@CF01511                                        0794
         ST    @14,WFIODLN(,@15)                                   0794
*     DO;                                                          0795
*       WFREQ=''B;                                                 0796
         L     @15,@PC00001+8                                      0796
         XC    WFREQ(2,@15),WFREQ(@15)                             0796
*       WFRUPD=ON;                  /* UPDRCD                        */
         L     @15,@PC00001+8                                      0797
         OI    WFRUPD(@15),B'00010000'                             0797
*       WFRUP=ON;                   /* UPDATE                        */
         L     @15,@PC00001+8                                      0798
         OI    WFRUP(@15),B'01000000'                              0798
*       CALL IDCRDIO;                                              0799
         L     @15,@CV01408                                        0799
         BALR  @14,@15                                             0799
*       RFY                                                        0800
*         RTNREG RSTD;                                             0800
*       TESTRC=RTNREG;                                             0801
         STH   RTNREG,TESTRC                                       0801
*       RFY                                                        0802
*         RTNREG UNRSTD;                                           0802
*     END;                                                         0803
*     IF TESTRC^=0 THEN                                            0804
         LH    @15,TESTRC                                          0804
         LTR   @15,@15                                             0804
         BZ    @RF00804                                            0804
*       DO;                                                        0805
*         DO;                                                      0806
*           CKREQ=CKREQ&&CKREQ;                                    0807
         L     @15,@PC00001+8                                      0807
         XC    CKREQ(44,@15),CKREQ(@15)                            0807
*           CKRERN=MSG19;                                          0808
         L     @15,@PC00001+8                                      0808
         MVC   CKRERN(2,@15),@CH00643                              0808
*           CKRMVAR(1)=ADDR(SAVKEY6);                              0809
         L     @15,@PC00001+8                                      0809
         LA    @14,SAVKEY6                                         0809
         ST    @14,CKRMVAR(,@15)                                   0809
*           CKRMVAR(2)=ADDR(SAVEKEY4);                             0810
         L     @15,@PC00001+8                                      0810
         LA    @14,SAVEKEY4                                        0810
         ST    @14,CKRMVAR+4(,@15)                                 0810
*           CKRMVAR(3)=ADDR(RWFDANA);                              0811
         L     @15,@PC00001+8                                      0811
         L     @14,RWFPTR1                                         0811
         ST    @14,CKRMVAR+8(,@15)                                 0811
*           CALL IDCRDER;                                          0812
         L     @15,@CV01407                                        0812
         BALR  @14,@15                                             0812
*         END;                                                     0813
*         REPRC=12;                                                0814
         L     @15,@PC00001+8                                      0814
         MVC   REPRC(2,@15),@CH00038                               0814
*         RETURN CODE(LASTCC12);                                   0815
         LA    @15,12                                              0815
         L     @14,@SA00003                                        0815
         LM    @00,@12,@SA00003+8                                  0815
         BR    @14                                                 0815
*       END;                                                       0816
*   END;                                                           0817
*                                                                  0817
@RF00804 LA    @15,1                                               0817
         AH    @15,ICNT2                                           0817
@DE00792 STH   @15,ICNT2                                           0817
         LH    @14,OUTCNT                                          0817
         N     @14,@CF01511                                        0817
         CR    @15,@14                                             0817
         BNH   @DL00792                                            0817
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN WITH RC FROM REWRITE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0818
*   RETURN CODE(LASTCC00);                                         0818
         SLR   @15,@15                                             0818
         L     @14,@SA00003                                        0818
         LM    @00,@12,@SA00003+8                                  0818
         BR    @14                                                 0818
*   END DBLKER;                                                    0819
*   END IDCRD040;                                                  0820
*   END IDCRD04                                                    0821
*                                                                  0821
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSRD )                                       */
*/*%INCLUDE SYSLIB  (IDCDF65 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF66 )                                       */
*                                                                  0821
*       ;                                                          0821
@DATA    DS    0H
@CH00288 DC    H'5'
@CH00181 DC    H'8'
@CH00035 DC    H'9'
@CH00036 DC    H'10'
@CH00611 DC    H'13'
@CH00617 DC    H'14'
@CH00630 DC    H'17'
@CH00632 DC    H'18'
@CH00643 DC    H'19'
@CH00711 DC    H'36'
@CH00717 DC    H'37'
@CH00600 DC    H'44'
@CH00781 DC    H'47'
@CH00864 DC    H'92'
@SM01513 MVC   RB0DK(0,@01),RBIDK(@05)
         DS    0F
@AL00351 DC    A(OUT)                  LIST WITH   1 ARGUMENT(S)
@AL00383 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00414 DC    A(POOLRD01)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00003 DS    15F
@AL00001 DS    3A
IDCRD04  CSECT
         DS    0F
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00045 DC    F'4'
@CH00045 EQU   @CF00045+2
@CF00038 DC    F'12'
@CH00038 EQU   @CF00038+2
@CF00475 DC    F'16'
@CH00475 EQU   @CF00475+2
@CF00312 DC    F'24'
@CF01269 DC    F'125'
@CF01512 DC    F'-4'
@CF01511 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
SAVEBF0  DS    A
SAVEBF1  DS    A
SAVER1BF DS    A
TARPTR   DS    A
SOURPTR  DS    A
RWFPTR1  DS    A
LISTPTR  DS    A
TESTRC   DS    H
RB0LEN   DS    H
OUTCNT   DS    H
ICNT1    DS    H
ICNT2    DS    H
LASTCC   DS    H
SAVEHH   DS    H
SAVER1DL DS    H
SETRC    DS    H
ERRCNT   DS    FL1
SWFIX    DS    FL1
SWLENKEY DS    FL1
SWLENDAT DS    FL1
PK       DS    FL1
PD       DS    FL1
FORCE    DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
CRNTKEY  DS    CL11
         ORG   CRNTKEY
CRNVOLS  DS    CL6
CRNCCHH  DS    CL4
         ORG   CRNCCHH
CRNCC    DS    CL2
CRNHH    DS    CL2
         ORG   CRNTKEY+10
CRNR     DS    FL1
         ORG   CRNTKEY+11
LASTKEY  DS    CL11
         ORG   LASTKEY
LASVOLS  DS    CL6
LASCC    DS    CL4
         ORG   LASCC
LASTC    DS    CL2
LASTHH   DS    CL2
         ORG   LASTKEY+10
LASR     DS    FL1
         ORG   LASTKEY+11
SAVFIXDL DS    CL2
SAVEKEY  DS    CL11
         ORG   SAVEKEY
SAVKEY6  DS    CL6
SAVEKEY4 DS    CL4
SAVEKEYR DS    CL1
         ORG   SAVEKEY+11
SAVEFL   DS    CL5
         ORG   SAVEFL
SAVEFLMD DS    FL1
SAVFLER  DS    CL2
SAVFLOV  DS    FL1
@NM00078 DS    CL1
         ORG   SAVEFL+5
SAVE4    DS    CL4
         ORG   SAVE4
@NM00079 DS    CL3
SAVE5CF  DS    CL1
         ORG   SAVE5CF
@NM00080 DS    BL1
SAVE50VF EQU   SAVE5CF+0
@NM00081 EQU   SAVE5CF+0
         ORG   SAVE4+4
         DS    CL3
ZEROCCHH DS    CL5
         ORG   ZEROCCHH
ZECCHH   DS    FL4
ZERR     DS    FL1
         ORG   ZEROCCHH+5
         DS    CL3
ONECCHH  DS    CL5
         ORG   ONECCHH
ONCCHH   DS    FL4
ONER     DS    FL1
         ORG   ONECCHH+5
         DS    CL3
DBLTBL   DS    CL8
         ORG   DBLTBL+0
DBLTCKLN DS    FL2
DBLTRLN  DS    FL2
DBLTRPTR DS    AL4
         ORG   DBLTBL+1000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRD04  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01406 DC    V(IDCRDRF)
@CV01407 DC    V(IDCRDER)
@CV01408 DC    V(IDCRDIO)
         DS    0D
BTSPERWD DC    H'4'
ZERO     DC    H'0'
R0CDLEN  DC    H'16'
COUNTLEN DC    H'8'
DBLKFLG  DC    AL1(2)
NONZERO  DC    AL1(1)
@CC01480 DC    C'RD40'
@CC01481 DC    C'RD41'
@CC01495 DC    C'RD42'
@CC01496 DC    C'RD43'
@CC01499 DC    C'RD44'
@CC01500 DC    C'RD45'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
OUT      DC    CL1'O'
FIXIND   DC    CL1'F'
POOLRD01 DC    CL8'RD01'
LARGE    DC    CL5'LARGE'
SMALL    DC    CL5'SMALL'
MODID    DC    CL4'RD04'
RANGELIT DC    CL13'RANGE        '
UPATCHIT DS    CL1024
         ORG   UPATCHIT
@NM00082 DC    256X'00'
@NM00083 DC    256X'00'
@NM00084 DC    256X'00'
@NM00085 DC    256X'00'
         ORG   UPATCHIT+1024
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG7     EQU   @07
REG8     EQU   @08
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG6     EQU   @06
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
INFIL    EQU   0
INDS     EQU   0
INDSFLG  EQU   INDS+10
DOUTF    EQU   0
DOTDS    EQU   0
DOTDSFLG EQU   DOTDS+10
VOLSR    EQU   0
VOLSRFLG EQU   VOLSR+10
DCCHR    EQU   0
DREC     EQU   0
VOLDS    EQU   0
VOLDSFLG EQU   VOLDS+10
DSCHR    EQU   0
DSCHH    EQU   0
VOLRR    EQU   0
VOLRRFLG EQU   VOLRR+10
RRCHR    EQU   0
RRCHH    EQU   0
DKEYL    EQU   0
DATAL    EQU   0
DVTCS    EQU   0
DVTCSFLG EQU   DVTCS+10
CINFL    EQU   0
CINDS    EQU   0
CINDSFLG EQU   CINDS+10
COFIL    EQU   0
CCATL    EQU   0
CCATLFLG EQU   CCATL+10
CVOLD    EQU   0
CVOLDFLG EQU   CVOLD+10
CDCHR    EQU   0
CDHHR    EQU   0
CVOLS    EQU   0
CVOLSFLG EQU   CVOLS+10
CCCHR    EQU   0
CRECR    EQU   0
CKEYL    EQU   0
CDATL    EQU   0
CVTCS    EQU   0
CVTCSFLG EQU   CVTCS+10
DBFIL    EQU   0
DBDS     EQU   0
DBDSFLG  EQU   DBDS+10
DBLST    EQU   0
DBLSTCNT EQU   0
DBVOL    EQU   0
DBVOLFLG EQU   DBVOL+10
DBVOLVAL EQU   DBVOL+21
DBCCH    EQU   0
DBCCHVAL EQU   DBCCH+1
DBHHH    EQU   0
DBHHHVAL EQU   DBHHH+1
DBKEYPTR EQU   0
DBKEY    EQU   0
DBKEYVAL EQU   DBKEY
DBDATPTR EQU   0
DBDAT    EQU   0
DBDATVAL EQU   DBDAT
MNCNT    EQU   0
MINFL    EQU   0
MINDS    EQU   0
MINDSFLG EQU   MINDS+10
MOUTF    EQU   0
MODS     EQU   0
MODSFLG  EQU   MODS+10
MVTCS    EQU   0
MVTCSFLG EQU   MVTCS+10
MVTCR    EQU   0
MIRVO    EQU   0
MIRVOFLG EQU   MIRVO+10
MIRCH    EQU   0
MIDVO    EQU   0
MIDVOFLG EQU   MIDVO+10
MIDCH    EQU   0
MRRVO    EQU   0
MRRVOFLG EQU   MRRVO+10
MRRCH    EQU   0
MRRHH    EQU   0
MNDOF    EQU   0
MNDST    EQU   0
MNKOF    EQU   0
MNKST    EQU   0
MORVO    EQU   0
MORVOFLG EQU   MORVO+10
MORCH    EQU   0
MODVO    EQU   0
MODVOFLG EQU   MODVO+10
MODCH    EQU   0
RWFHDR   EQU   0
SRPRTARG EQU   0
RWFINFO  EQU   0
RWFKEY1  EQU   RWFINFO+82
RWFKEY2  EQU   RWFINFO+93
RWHDRINF EQU   0
RDARG    EQU   0
RDCHR    EQU   RDARG+26
RDSPACE  EQU   RDARG+36
RDSPKL   EQU   RDARG+47
INFOAREA EQU   0
INFODSN  EQU   0
INFOVOL  EQU   0
DEVAREA  EQU   0
DEVDEVTP EQU   DEVAREA
DEVTBYT2 EQU   DEVDEVTP+1
@NM00054 EQU   DEVAREA+8
DEVWORD3 EQU   DEVAREA+12
DEVBOH   EQU   DEVWORD3+2
DEVWORD4 EQU   DEVAREA+16
DEV4B1   EQU   DEVWORD4+1
XTNTTBL2 EQU   0
XTN2ENT  EQU   XTNTTBL2
XTN2CHR1 EQU   XTN2ENT+44
XTN2CHR2 EQU   XTN2ENT+48
XTNTTBL  EQU   0
XTNTHDR  EQU   XTNTTBL
XTNHCHR1 EQU   XTNTHDR+68
XTNHCHR2 EQU   XTNTHDR+76
XTNTENT  EQU   XTNTTBL+88
XTNTCHR1 EQU   XTNTENT+62
XTNTCHR2 EQU   XTNTENT+70
SPLIST   EQU   0
SPRNAME  EQU   SPLIST+8
RWFR     EQU   0
RWFRCNT  EQU   RWFR+16
LOCTAB   EQU   0
RIOAREA  EQU   0
RIOHDR   EQU   RIOAREA
RPREV    EQU   RIOHDR+2
RKEY     EQU   0
RKEYCHR  EQU   RKEY+6
RKEYFLG  EQU   RKEY+11
RBUF     EQU   0
RBUFCNT  EQU   RBUF
RBCCHHR  EQU   RBUFCNT
WIOAREA  EQU   0
WBUF     EQU   0
WBUFCNT  EQU   WBUF
WBCCHHR  EQU   WBUFCNT
RB0      EQU   0
RB0K     EQU   RB0
RB0KVCH  EQU   RB0K
RB0F     EQU   RB0+11
RB0FMOD  EQU   RB0F
RB0FERR  EQU   RB0F+1
RB0FOVF  EQU   RB0F+3
RB0C     EQU   RB0+16
RB0CHH   EQU   RB0C+2
RB0CDL   EQU   RB0C+6
RB0DK    EQU   RB0+24
RB1      EQU   0
RB1K     EQU   RB1
RB1KVCH  EQU   RB1K
RB1KR    EQU   RB1K+10
RB1F     EQU   RB1+11
RB1FMOD  EQU   RB1F
RB1FERR  EQU   RB1F+1
RB1C     EQU   RB1+16
RB1CCHH  EQU   RB1C
RB1CR    EQU   RB1C+4
RB1CKL   EQU   RB1C+5
RB1CDL   EQU   RB1C+6
RBIN     EQU   0
RBI4     EQU   RBIN
RBIC     EQU   RBIN+4
RBICHH   EQU   RBIC+2
RBICR    EQU   RBIC+4
RBICKL   EQU   RBIC+5
RBICDL   EQU   RBIC+6
RBIDK    EQU   RBIN+12
RWFDANA  EQU   0
ALLA     EQU   0
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CDATLPTR EQU   0
CDSRG    EQU   0
CHARA    EQU   0
CKEYLPTR EQU   0
CLEN     EQU   0
CLENCNT  EQU   0
COPY     EQU   0
CSRNG    EQU   0
CVTOC    EQU   0
DATALPTR EQU   0
DBLOC    EQU   0
DBRNG    EQU   0
DISPL    EQU   0
DKEYLPTR EQU   0
DLENG    EQU   0
DLENGCNT EQU   0
DMPTRM   EQU   0
DPVTC    EQU   0
DRRNG    EQU   0
DSRNG    EQU   0
DUMP     EQU   0
ERROR    EQU   0
FREC     EQU   0
FULLR    EQU   0
HEXA     EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IDONL    EQU   0
LISTTEST EQU   0
MIDSA    EQU   0
MIRK     EQU   0
MIRNG    EQU   0
MNDAT    EQU   0
MNKEY    EQU   0
MODIF    EQU   0
MODSA    EQU   0
MORK     EQU   0
MOVFL    EQU   0
MVTOC    EQU   0
NEWERID1 EQU   5
STAGR    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
REPTBL   EQU   0
REPCB    EQU   REPTBL
REPORWIO EQU   REPCB+20
REPSPRIT EQU   REPCB+40
REPBUFF0 EQU   REPCB+52
REPBUFF1 EQU   REPCB+56
REPRWHDO EQU   REPCB+64
REPRWHAR EQU   REPCB+100
REPRWINA EQU   REPCB+104
REPQRPTR EQU   REPCB+132
REPCBEXT EQU   REPTBL+156
REPR0LN  EQU   REPCBEXT
REPR1LN  EQU   REPCBEXT+2
REPSRPR  EQU   REPCBEXT+4
REPRC    EQU   REPCBEXT+6
REPRCDCT EQU   REPCBEXT+8
CKREQ    EQU   REPCBEXT+16
CKRERN   EQU   CKREQ
CKRMVAR  EQU   CKREQ+4
WFAREA   EQU   REPCBEXT+76
WFIODAD  EQU   WFAREA
WFIODLN  EQU   WFAREA+4
WFIOKYA  EQU   WFAREA+8
WFREQ    EQU   WFAREA+12
WFRTYP   EQU   WFREQ
WFRGET   EQU   WFRTYP
WFRUPD   EQU   WFRTYP
WFRPOS   EQU   WFRTYP
WFROPT   EQU   WFREQ+1
WFRUP    EQU   WFROPT
RWDEF    EQU   RWFHDR
RWFHFT   EQU   RWDEF+89
RWFHDLN  EQU   RWDEF+90
RWFRDE   EQU   RWFR
CCHVAL   EQU   DBCCHVAL
CHVAL    EQU   CCHVAL+2
RB00     EQU   RB0
RB00DK   EQU   RB00+24
RB00DKRN EQU   RB00DK
RB00DKKL EQU   RB00DK+1
RB00DKDL EQU   RB00DK+2
RB1DEF   EQU   RB1
RDSPKLDL EQU   RDSPKL
VOLSER   EQU   DBVOLVAL
*                                      START UNREFERENCED COMPONENTS
@NM00077 EQU   RB1DEF+6
RB1VOLSR EQU   RB1DEF
@NM00075 EQU   RB00DK+4
@NM00074 EQU   RB00
CCVAL    EQU   CCHVAL
@NM00066 EQU   RWFRDE+15
RWFROV   EQU   RWFRDE+14
RWFRF2   EQU   RWFRDE+12
RWFRF1   EQU   RWFRDE+11
@NM00065 EQU   RWFRDE
RWFHKLN  EQU   RWDEF+92
@NM00045 EQU   RWDEF
REPENQSW EQU   REPCBEXT+90
@NM00044 EQU   WFROPT
WFRIN    EQU   WFROPT
@NM00043 EQU   WFRTYP
WFRLD    EQU   WFRTYP
WFRADD   EQU   WFRTYP
@NM00042 EQU   REPCBEXT+75
WFIOGUK  EQU   REPCBEXT+64
RDCATRC  EQU   REPCBEXT+60
@NM00041 EQU   CKREQ+2
@NM00040 EQU   REPCBEXT+15
K        EQU   REPCBEXT+14
J        EQU   REPCBEXT+13
I        EQU   REPCBEXT+12
@NM00039 EQU   REPSRPR+1
@NM00038 EQU   REPSRPR
REPSRPRT EQU   REPSRPR
REPCDSOP EQU   REPCB+152
REPCPPTR EQU   REPCB+148
REPOPAGL EQU   REPCB+144
REPEXOAR EQU   REPCB+140
REPALLAG EQU   REPCB+136
REPODEVA EQU   REPCB+128
REPIDEVA EQU   REPCB+124
REPOLCPT EQU   REPCB+120
REPILCPT EQU   REPCB+116
REPOSYSI EQU   REPCB+112
REPISYSI EQU   REPCB+108
REPOINFO EQU   REPCB+96
REPIINFO EQU   REPCB+92
REPOXTNT EQU   REPCB+88
REPOXTN2 EQU   REPCB+84
REPIXTNT EQU   REPCB+80
REPIXTN2 EQU   REPCB+76
REPOUTCL EQU   REPCB+72
REPINCL  EQU   REPCB+68
REPRWHDI EQU   REPCB+60
REPOBFPT EQU   REPCB+48
REPIBFPT EQU   REPCB+44
REPODSAR EQU   REPCB+36
REPIDSAR EQU   REPCB+32
REPODSOP EQU   REPCB+28
REPIDSOP EQU   REPCB+24
REPIRWIO EQU   REPCB+16
REPARFIO EQU   REPCB+12
REPRESER EQU   REPCB
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
RBICCC   EQU   RBIC
RB1DK    EQU   RB1+24
RB1CHH   EQU   RB1CCHH+2
RB1CCC   EQU   RB1CCHH
@NM00076 EQU   RB1F+4
RB1FOVF  EQU   RB1F+3
RB0CKL   EQU   RB0C+5
RB0CR    EQU   RB0C+4
RB0CCC   EQU   RB0C
@NM00073 EQU   RB0F+4
RB0KR    EQU   RB0K+10
WKEYDAT  EQU   WBUF+8
WBDL     EQU   WBUFCNT+6
WBKL     EQU   WBUFCNT+5
WBREC    EQU   WBCCHHR+4
WBHH     EQU   WBCCHHR+2
WBCC     EQU   WBCCHHR
WBUFF    EQU   WIOAREA+4
WNUMREC  EQU   WIOAREA
RKEYDAT  EQU   RBUF+8
RBDL     EQU   RBUFCNT+6
RBKL     EQU   RBUFCNT+5
RBREC    EQU   RBCCHHR+4
RBHH     EQU   RBCCHHR+2
RBCC     EQU   RBCCHHR
@NM00072 EQU   RKEYFLG+4
RKEYFLG3 EQU   RKEYFLG+3
RKEYFLG2 EQU   RKEYFLG+1
RKEYFLG1 EQU   RKEYFLG
RKEYR    EQU   RKEYCHR+4
RKEYHH   EQU   RKEYCHR+2
RKEYCC   EQU   RKEYCHR
RKEYVOL  EQU   RKEY
RBUFF    EQU   RIOAREA+282
@NM00071 EQU   RIOHDR+26
@NM00070 EQU   RIOHDR+10
RNUMREC  EQU   RIOHDR+8
@NM00069 EQU   RIOHDR+7
RPREVR   EQU   RPREV+4
RPREVHH  EQU   RPREV+2
RPREVCC  EQU   RPREV
@NM00068 EQU   RIOHDR+1
RFIRST   EQU   RIOHDR
LOCDLEN  EQU   LOCTAB+18
LOCKLEN  EQU   LOCTAB+17
@NM00067 EQU   LOCTAB+16
LOCCNTFD EQU   LOCTAB+8
LOCRCKD  EQU   LOCTAB+6
LOCRCNT  EQU   LOCTAB+4
LOCADDR  EQU   LOCTAB
RWFRKD   EQU   RWFR+24
RWFRDLN  EQU   RWFRCNT+6
RWFRKLN  EQU   RWFRCNT+5
RWFRR    EQU   RWFRCNT+4
RWFRHH   EQU   RWFRCNT+2
RWFRCC   EQU   RWFRCNT
RWFRFLG  EQU   RWFR+11
RWFRKEY  EQU   RWFR
SPRVOL   EQU   SPRNAME+1
SPRLEN   EQU   SPRNAME
SPQNAME  EQU   SPLIST
@NM00064 EQU   XTNTENT+75
XTNTR2   EQU   XTNTCHR2+4
XTNTHH2  EQU   XTNTCHR2+2
XTNTCC2  EQU   XTNTCHR2
@NM00063 EQU   XTNTENT+67
XTNTR1   EQU   XTNTCHR1+4
XTNTHH1  EQU   XTNTCHR1+2
XTNTCC1  EQU   XTNTCHR1
@NM00062 EQU   XTNTENT+59
XTNTVOL  EQU   XTNTENT+53
XTNTVOLN EQU   XTNTENT+52
XTNTDSN  EQU   XTNTENT+8
XTNTDDN  EQU   XTNTENT
@NM00061 EQU   XTNTHDR+85
XTNHMODE EQU   XTNTHDR+84
@NM00060 EQU   XTNTHDR+81
XTNHR2   EQU   XTNHCHR2+4
XTNHHH2  EQU   XTNHCHR2+2
XTNHCC2  EQU   XTNHCHR2
@NM00059 EQU   XTNTHDR+73
XTNHR1   EQU   XTNHCHR1+4
XTNHHH1  EQU   XTNHCHR1+2
XTNHCC1  EQU   XTNHCHR1
XTNHPWD  EQU   XTNTHDR+60
@NM00058 EQU   XTNTHDR+59
XTNHVOL  EQU   XTNTHDR+53
XTNHVOLN EQU   XTNTHDR+52
XTNHDSN  EQU   XTNTHDR+8
XTNHDDN  EQU   XTNTHDR
XTN2HH2  EQU   XTN2CHR2+2
XTN2CC2  EQU   XTN2CHR2
XTN2HH1  EQU   XTN2CHR1+2
XTN2CC1  EQU   XTN2CHR1
XTN2DSN  EQU   XTN2ENT
DEVWORD5 EQU   DEVAREA+20
@NM00057 EQU   DEV4B1+1
@NM00056 EQU   DEV4B1
INF4FLG  EQU   DEV4B1
@NM00055 EQU   DEV4B1
DEVKC    EQU   DEVWORD4
DEVBOH2  EQU   DEVBOH+1
DEVBOH1  EQU   DEVBOH
DEVTC    EQU   DEVWORD3
DEVMAXHH EQU   @NM00054+2
DEVMAXCC EQU   @NM00054
DEVMAXBK EQU   DEVAREA+4
DEVTBYT4 EQU   DEVDEVTP+3
DEVTBYT3 EQU   DEVDEVTP+2
@NM00053 EQU   DEVTBYT2
DEVRVDEV EQU   DEVTBYT2
@NM00052 EQU   DEVTBYT2
DEVTBYT1 EQU   DEVDEVTP
INFVOL   EQU   INFOVOL+4
INFVOLLN EQU   INFOVOL+2
INFVOLID EQU   INFOVOL
INFDSN   EQU   INFODSN+4
INFDSNLN EQU   INFODSN+2
INFDSNID EQU   INFODSN
INFAREA  EQU   INFOAREA+4
INFDATAL EQU   INFOAREA+2
INFAREAL EQU   INFOAREA
RDDLEN   EQU   RDARG+56
RDKLEN   EQU   RDARG+52
RDLENTOT EQU   RDARG+50
RDSPDL   EQU   RDARG+48
RDFUNC   EQU   RDARG+46
@NM00051 EQU   RDSPACE+8
@NM00050 EQU   RDSPACE+6
@NM00049 EQU   RDSPACE+4
@NM00048 EQU   RDSPACE+1
@NM00047 EQU   RDSPACE
RDRWPKLN EQU   RDARG+32
RDDS     EQU   RDARG+31
RDRECNUM EQU   RDCHR+4
RDHH     EQU   RDCHR+2
RDCC     EQU   RDCHR
RDCCWCNT EQU   RDARG+24
RDLOCPTR EQU   RDARG+20
RDDARE   EQU   RDARG+16
RDIOAREA EQU   RDARG+12
RDCTLBK  EQU   RDARG+8
RDRES    EQU   RDARG
RWHDRDLN EQU   RWHDRINF+6
RWHDRKLN EQU   RWHDRINF+5
@NM00046 EQU   RWHDRINF+1
RWHDRFIX EQU   RWHDRINF
RWFKCHR2 EQU   RWFKEY2+6
RWFKVOL2 EQU   RWFKEY2
RWFKCHR1 EQU   RWFKEY1+6
RWFKVOL1 EQU   RWFKEY1
RWFVOL   EQU   RWFINFO+52
RWFDSN   EQU   RWFINFO+8
RWFDDN   EQU   RWFINFO
SRCCHHRP EQU   SRPRTARG+40
SRRECPTR EQU   SRPRTARG+36
SRSPRECL EQU   SRPRTARG+32
SRDSNPTR EQU   SRPRTARG+28
SRERCODE EQU   SRPRTARG+24
SRRWFKEY EQU   SRPRTARG+20
SRRWFDSN EQU   SRPRTARG+16
SRVOLPTR EQU   SRPRTARG+12
SRDSNHDR EQU   SRPRTARG+8
SRVREPTR EQU   SRPRTARG+4
SRVRECL  EQU   SRPRTARG
RWFHFM   EQU   RWFHDR+99
RWFHDSNU EQU   RWFHDR+55
RWFHDSNR EQU   RWFHDR+11
RWFHKEY  EQU   RWFHDR
MODCHVAL EQU   MODCH+1
MODCHLEN EQU   MODCH
MODVOVAL EQU   MODVO+21
MODVOLEN EQU   MODVO+20
MODVOMEM EQU   MODVO+12
MODVOMLN EQU   MODVO+11
MODVOFUQ EQU   MODVOFLG
MODVOPOS EQU   MODVO+9
MODVOPAS EQU   MODVO+1
MODVOPLN EQU   MODVO
MORCHVAL EQU   MORCH+1
MORCHLEN EQU   MORCH
MORVOVAL EQU   MORVO+21
MORVOLEN EQU   MORVO+20
MORVOMEM EQU   MORVO+12
MORVOMLN EQU   MORVO+11
MORVOFUQ EQU   MORVOFLG
MORVOPOS EQU   MORVO+9
MORVOPAS EQU   MORVO+1
MORVOPLN EQU   MORVO
MNKSTVAL EQU   MNKST+1
MNKSTLEN EQU   MNKST
MNKOFVAL EQU   MNKOF
MNDSTVAL EQU   MNDST+1
MNDSTLEN EQU   MNDST
MNDOFVAL EQU   MNDOF
MRRHHVAL EQU   MRRHH+1
MRRHHLEN EQU   MRRHH
MRRCHVAL EQU   MRRCH+1
MRRCHLEN EQU   MRRCH
MRRVOVAL EQU   MRRVO+21
MRRVOLEN EQU   MRRVO+20
MRRVOMEM EQU   MRRVO+12
MRRVOMLN EQU   MRRVO+11
MRRVOFUQ EQU   MRRVOFLG
MRRVOPOS EQU   MRRVO+9
MRRVOPAS EQU   MRRVO+1
MRRVOPLN EQU   MRRVO
MIDCHVAL EQU   MIDCH+1
MIDCHLEN EQU   MIDCH
MIDVOVAL EQU   MIDVO+21
MIDVOLEN EQU   MIDVO+20
MIDVOMEM EQU   MIDVO+12
MIDVOMLN EQU   MIDVO+11
MIDVOFUQ EQU   MIDVOFLG
MIDVOPOS EQU   MIDVO+9
MIDVOPAS EQU   MIDVO+1
MIDVOPLN EQU   MIDVO
MIRCHVAL EQU   MIRCH+1
MIRCHLEN EQU   MIRCH
MIRVOVAL EQU   MIRVO+21
MIRVOLEN EQU   MIRVO+20
MIRVOMEM EQU   MIRVO+12
MIRVOMLN EQU   MIRVO+11
MIRVOFUQ EQU   MIRVOFLG
MIRVOPOS EQU   MIRVO+9
MIRVOPAS EQU   MIRVO+1
MIRVOPLN EQU   MIRVO
MVTCRVAL EQU   MVTCR+1
MVTCRLEN EQU   MVTCR
MVTCSVAL EQU   MVTCS+21
MVTCSLEN EQU   MVTCS+20
MVTCSMEM EQU   MVTCS+12
MVTCSMLN EQU   MVTCS+11
MVTCSFUQ EQU   MVTCSFLG
MVTCSPOS EQU   MVTCS+9
MVTCSPAS EQU   MVTCS+1
MVTCSPLN EQU   MVTCS
MODSVAL  EQU   MODS+21
MODSLEN  EQU   MODS+20
MODSMEM  EQU   MODS+12
MODSMLN  EQU   MODS+11
MODSFUQ  EQU   MODSFLG
MODSPOS  EQU   MODS+9
MODSPAS  EQU   MODS+1
MODSPLN  EQU   MODS
MOUTFVAL EQU   MOUTF+10
MOUTFLEN EQU   MOUTF+9
MOUTFPAS EQU   MOUTF+1
MOUTFPLN EQU   MOUTF
MINDSVAL EQU   MINDS+21
MINDSLEN EQU   MINDS+20
MINDSMEM EQU   MINDS+12
MINDSMLN EQU   MINDS+11
MINDSFUQ EQU   MINDSFLG
MINDSPOS EQU   MINDS+9
MINDSPAS EQU   MINDS+1
MINDSPLN EQU   MINDS
MINFLVAL EQU   MINFL+10
MINFLLEN EQU   MINFL+9
MINFLPAS EQU   MINFL+1
MINFLPLN EQU   MINFL
MNCNTVAL EQU   MNCNT+1
MNCNTLEN EQU   MNCNT
DBHHHLEN EQU   DBHHH
DBCCHLEN EQU   DBCCH
DBVOLLEN EQU   DBVOL+20
DBVOLMEM EQU   DBVOL+12
DBVOLMLN EQU   DBVOL+11
DBVOLFUQ EQU   DBVOLFLG
DBVOLPOS EQU   DBVOL+9
DBVOLPAS EQU   DBVOL+1
DBVOLPLN EQU   DBVOL
DBDSVAL  EQU   DBDS+21
DBDSLEN  EQU   DBDS+20
DBDSMEM  EQU   DBDS+12
DBDSMLN  EQU   DBDS+11
DBDSFUQ  EQU   DBDSFLG
DBDSPOS  EQU   DBDS+9
DBDSPAS  EQU   DBDS+1
DBDSPLN  EQU   DBDS
DBFILVAL EQU   DBFIL+10
DBFILLEN EQU   DBFIL+9
DBFILPAS EQU   DBFIL+1
DBFILPLN EQU   DBFIL
CVTCSVAL EQU   CVTCS+21
CVTCSLEN EQU   CVTCS+20
CVTCSMEM EQU   CVTCS+12
CVTCSMLN EQU   CVTCS+11
CVTCSFUQ EQU   CVTCSFLG
CVTCSPOS EQU   CVTCS+9
CVTCSPAS EQU   CVTCS+1
CVTCSPLN EQU   CVTCS
CDATLVAL EQU   CDATL
CKEYLVAL EQU   CKEYL
CRECRVAL EQU   CRECR+1
CRECRLEN EQU   CRECR
CCCHRVAL EQU   CCCHR+1
CCCHRLEN EQU   CCCHR
CVOLSVAL EQU   CVOLS+21
CVOLSLEN EQU   CVOLS+20
CVOLSMEM EQU   CVOLS+12
CVOLSMLN EQU   CVOLS+11
CVOLSFUQ EQU   CVOLSFLG
CVOLSPOS EQU   CVOLS+9
CVOLSPAS EQU   CVOLS+1
CVOLSPLN EQU   CVOLS
CDHHRVAL EQU   CDHHR+1
CDHHRLEN EQU   CDHHR
CDCHRVAL EQU   CDCHR+1
CDCHRLEN EQU   CDCHR
CVOLDVAL EQU   CVOLD+21
CVOLDLEN EQU   CVOLD+20
CVOLDMEM EQU   CVOLD+12
CVOLDMLN EQU   CVOLD+11
CVOLDFUQ EQU   CVOLDFLG
CVOLDPOS EQU   CVOLD+9
CVOLDPAS EQU   CVOLD+1
CVOLDPLN EQU   CVOLD
CCATLVAL EQU   CCATL+21
CCATLLEN EQU   CCATL+20
CCATLMEM EQU   CCATL+12
CCATLMLN EQU   CCATL+11
CCATLFUQ EQU   CCATLFLG
CCATLPOS EQU   CCATL+9
CCATLPAS EQU   CCATL+1
CCATLPLN EQU   CCATL
COFILVAL EQU   COFIL+10
COFILLEN EQU   COFIL+9
COFILPAS EQU   COFIL+1
COFILPLN EQU   COFIL
CINDSVAL EQU   CINDS+21
CINDSLEN EQU   CINDS+20
CINDSMEM EQU   CINDS+12
CINDSMLN EQU   CINDS+11
CINDSFUQ EQU   CINDSFLG
CINDSPOS EQU   CINDS+9
CINDSPAS EQU   CINDS+1
CINDSPLN EQU   CINDS
CINFLVAL EQU   CINFL+10
CINFLLEN EQU   CINFL+9
CINFLPAS EQU   CINFL+1
CINFLPLN EQU   CINFL
DVTCSVAL EQU   DVTCS+21
DVTCSLEN EQU   DVTCS+20
DVTCSMEM EQU   DVTCS+12
DVTCSMLN EQU   DVTCS+11
DVTCSFUQ EQU   DVTCSFLG
DVTCSPOS EQU   DVTCS+9
DVTCSPAS EQU   DVTCS+1
DVTCSPLN EQU   DVTCS
DATALVAL EQU   DATAL
DKEYLVAL EQU   DKEYL
RRCHHVAL EQU   RRCHH+1
RRCHHLEN EQU   RRCHH
RRCHRVAL EQU   RRCHR+1
RRCHRLEN EQU   RRCHR
VOLRRVAL EQU   VOLRR+21
VOLRRLEN EQU   VOLRR+20
VOLRRMEM EQU   VOLRR+12
VOLRRMLN EQU   VOLRR+11
VOLRRFUQ EQU   VOLRRFLG
VOLRRPOS EQU   VOLRR+9
VOLRRPAS EQU   VOLRR+1
VOLRRPLN EQU   VOLRR
DSCHHVAL EQU   DSCHH+1
DSCHHLEN EQU   DSCHH
DSCHRVAL EQU   DSCHR+1
DSCHRLEN EQU   DSCHR
VOLDSVAL EQU   VOLDS+21
VOLDSLEN EQU   VOLDS+20
VOLDSMEM EQU   VOLDS+12
VOLDSMLN EQU   VOLDS+11
VOLDSFUQ EQU   VOLDSFLG
VOLDSPOS EQU   VOLDS+9
VOLDSPAS EQU   VOLDS+1
VOLDSPLN EQU   VOLDS
DRECVAL  EQU   DREC+1
DRECLEN  EQU   DREC
DCCHRVAL EQU   DCCHR+1
DCCHRLEN EQU   DCCHR
VOLSRVAL EQU   VOLSR+21
VOLSRLEN EQU   VOLSR+20
VOLSRMEM EQU   VOLSR+12
VOLSRMLN EQU   VOLSR+11
VOLSRFUQ EQU   VOLSRFLG
VOLSRPOS EQU   VOLSR+9
VOLSRPAS EQU   VOLSR+1
VOLSRPLN EQU   VOLSR
DOTDSVAL EQU   DOTDS+21
DOTDSLEN EQU   DOTDS+20
DOTDSMEM EQU   DOTDS+12
DOTDSMLN EQU   DOTDS+11
DOTDSFUQ EQU   DOTDSFLG
DOTDSPOS EQU   DOTDS+9
DOTDSPAS EQU   DOTDS+1
DOTDSPLN EQU   DOTDS
DOUTFVAL EQU   DOUTF+10
DOUTFLEN EQU   DOUTF+9
DOUTFPAS EQU   DOUTF+1
DOUTFPLN EQU   DOUTF
INDSVAL  EQU   INDS+21
INDSLEN  EQU   INDS+20
INDSMEM  EQU   INDS+12
INDSMLN  EQU   INDS+11
INDSFUQ  EQU   INDSFLG
INDSPOS  EQU   INDS+9
INDSPAS  EQU   INDS+1
INDSPLN  EQU   INDS
INFILVAL EQU   INFIL+10
INFILLEN EQU   INFIL+9
INFILPAS EQU   INFIL+1
INFILPLN EQU   INFIL
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RC00694 EQU   @RC00690
@RC00718 EQU   @RC00716
@PB00002 EQU   @EL00001
@RC00723 EQU   @RC00718
@ENDDATA EQU   *
         END   IDCRD04,(C'PLS1208',0603,77300)

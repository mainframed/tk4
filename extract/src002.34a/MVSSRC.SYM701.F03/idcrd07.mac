         TITLE 'IDCRD07:IDCAMS REPAIRV SERVICE MODULE                  *
                        '
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCRD07  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRD07   77.300'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @06,0                                               0002
@PSTART  LA    @09,4095(,@06)                                      0002
         LA    @10,4095(,@09)                                      0002
         LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@06                                         0002
         USING @PSTART+4095,@09                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@11                                   0002
         USING @PSTART+16380,@12                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @07,@01                                             0002
         USING @DATD,@07                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @07,8(,@13)                                         0002
         LR    @13,@07                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0282
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE AND DUMP POINTS                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*   IF GDTDBG=NULLPTR THEN                                         0283
         L     @15,@PC00001                                        0283
         L     @15,GDTDBG(,@15)                                    0283
         LTR   @15,@15                                             0283
         BZ    @RT00283                                            0283
*     ;                                                            0284
*   ELSE                                                           0285
*     CALL IDCDB010(GDTTBL,'RD71');                                0285
         L     @15,@PC00001                                        0285
         ST    @15,@AL00001                                        0285
         LA    @14,@CC01568                                        0285
         ST    @14,@AL00001+4                                      0285
         MVI   @AL00001+4,X'80'                                    0285
         L     @15,GDTDBG(,@15)                                    0285
         LA    @01,@AL00001                                        0285
         BALR  @14,@15                                             0285
*   OLDERID2=NEWERID2;                                             0286
@RT00283 L     @03,@PC00001                                        0286
         L     @03,GDTTR2(,@03)                                    0286
         MVC   @TS00001(95),NEWERID2(@03)                          0286
         MVC   OLDERID2(95,@03),@TS00001                           0286
*   NEWID2='RD72';                                                 0287
*                                                                  0287
         MVC   NEWID2(4,@03),@CC01569                              0287
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE OPNAGL POINTER                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   OPNPTR=REPOPAGL;                                               0288
*                                                                  0288
         L     @15,@PC00001+8                                      0288
         L     OPNPTR,REPOPAGL(,@15)                               0288
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE AUTOMATIC STORAGE VIA THE PROLOG AND RETURN TO THE */
*   /* CALLER WITHOUT FREEING THE STORAGE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   GEN(ST REG6,SPLITSV1);                                         0289
         ST REG6,SPLITSV1
*   STM(REG9,REG12,SPLITSAV);                                      0290
         STM   REG9,REG12,SPLITSAV                                 0290
*   GEN(L REG13,4(,REG13));                                        0291
         L REG13,4(,REG13)
*   GEN(LM REG14,REG6,12(REG13));                                  0292
         LM REG14,REG6,12(REG13)
*   GEN(LM REG9,REG12,56(REG13));                                  0293
         LM REG9,REG12,56(REG13)
*   GEN(SR REG15,REG15);                                           0294
         SR REG15,REG15
*   GEN(BR REG14);                                                 0295
         BR REG14
         EJECT
*IDCRDDS:                                                          0296
*   PROCEDURE(IOPARM,TOCHRVAL);                                    0296
*                                                                  0296
@EL00001 L     @13,4(,@13)                                         0296
@EF00001 L     @00,@SIZDATD                                        0296
         LR    @01,@07                                             0296
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0296
         BR    @14                                                 0296
IDCRDDS  STM   @14,@12,@SA00002                                    0296
         MVC   @PC00002(8),0(@01)                                  0296
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - IDCRDDS                                        */
*/*                                                                  */
*/*  FUNCTION - THIS PROCEDURE IS CALLED BY MODULE IDCRD02,          */
*/*             IDCRD03, IDCRD04, OR IDCRD05 TO:                     */
*/*             1. OPEN A VTOCHEADER AND IN THE CASE OF A MODIFY     */
*/*                REQUEST (IDCRD05 IS THE CALLING MODULE) RESERVE   */
*/*                THE VTOC, OR OPEN A VTOC AND IN THE CASE OF A     */
*/*                MODIFY REQUEST (IDCRD05 IS THE CALLING MODULE)    */
*/*                RESERVE THE VTOC, OR OPEN A DATA SET, OR RESERVE  */
*/*                AND OPEN THE STAGING PACK WHICH IS MOUNTED        */
*/*                OFFLINE TO THE MSS.                               */
*/*             2. CONSTRUCT AN EXTENT TABLE WHICH WILL CONTAIN:     */
*/*                A. AN ENTRY FOR THE FIRST TRACK OF THE VTOC FOR   */
*/*                   A VTOCHEADER, OR                               */
*/*                B. AN ENTRY FOR THE EXTENT OF THE VTOC WITHIN     */
*/*                   THE SPECIFIED DATASETRANGE, OR                 */
*/*                C. AN ENTRY FOR EACH EXTENT OF A DATA SET         */
*/*                   WITHIN THE SPECIFIED DATASETRANGE, OR          */
*/*                D. AN ENTRY THAT INCLUDES THE ENTIRE STAGING      */
*/*                   PACK                                           */
*/*             3. OBTAIN INPUT/OUTPUT BUFFERS                       */
*/*                                                                  */
*/*  ENTRY POINT - IDCRDDS (ONLY ENTRY POINT FOR THIS PROCEDURE)     */
*/*                                                                  */
*/*            LINKAGE - 'CALL IDCRDDS (IOPARM,TOCHRVAL)'            */
*/*                                                                  */
*/*            INPUT -                                               */
*/*                                                                  */
*/*              GDTTBL (IDCAMS GLOBAL DATA TABLE)                   */
*/*                THIS TABLE CONTAINS THE ADDRESS OF THE IDCAMS     */
*/*                SYSTEM OPTIONS AND THE ENTRY POINTS TO THE        */
*/*                SYSTEM AND I/O ADDRESSES.                         */
*/*                                                                  */
*/*              FDTTBL (IDCAMS FUNCTION DATA TABLE)                 */
*/*                THIS TABLE CONTAINS THE ENCODED INFORMATION FROM  */
*/*                THE IDCAMS COMMAND STATEMENTS                     */
*/*                                                                  */
*/*              REPTBL                                              */
*/*                REPAIRV CONTROL BLOCK AND COMMUNICATION AREA      */
*/*                                                                  */
*/*              VTOC,                                               */
*/*              VTOCHEADER,                                         */
*/*              DATA SET, OR                                        */
*/*              STAGING PACK OFFLINE TO THE MSS                     */
*/*                                                                  */
*/*            OUTPUT -                                              */
*/*                                                                  */
*/*                ERROR MESSAGES: IDC31203I TO IDC31212I            */
*/*                                IDC31233I TO IDC31235I            */
*/*                                IDC31239I TO IDC31240I            */
*/*                                IDC3004I                          */
*/*                                                                  */
*/*                WTOR MESSAGE:   IDC498D                           */
*/*                                                                  */
*/*                UNIVERSAL TEXT MESSAGE: IDC3004I                  */
*/*                                                                  */
*/*                EXTENT TABLE (XTNTTBL) WHICH CONTAINS AN ENTRY    */
*/*                FOR THE USER SUPPLIED INFORMATION VIA SYNTAX      */
*/*                IN THE EXTENT TABLE HEADER, AND AN ENTRY FOR      */
*/*                FOR EACH EXTENT OF THE VTOCHEADER, VTOC,          */
*/*                DATA SET, OR STAGING PACK.                        */
*/*                                                                  */
*/*                FIELDS SET IN THE REPCB:                          */
*/*                                                                  */
*/*                     REPIDSOP = ADDRESS OF IOCTLBK FOR FIRST      */
*/*                                EXTENT IF FOR INPUT REQUEST       */
*/*                                                                  */
*/*                     REPODSOP = ADDRESS OF IOCTLBK FOR FIRST      */
*/*                                EXTENT IF FOR OUTPUT REQUEST      */
*/*                                                                  */
*/*                     REPIBFPT = ADDRESS OF BUFFER AREA OBTAINED   */
*/*                                VIA THE UGPOOL MACRO IF FOR       */
*/*                                INPUT REQUEST                     */
*/*                                                                  */
*/*                     REPOBFPT = ADDRESS OF BUFFER AREA OBTAINED   */
*/*                                VIA THE UGPOOL MACRO IF FOR       */
*/*                                OUTPUT REQUEST                    */
*/*                                                                  */
*/*                BUFFER AREA FOR INPUT/OUTPUT PROCESSING POINTED   */
*/*                TO BY EITHER REPIBFPT IN THE REPCB FOR INPUT      */
*/*                PROCESSING OR REPOBFPT IN THE REPCB FOR OUTPUT    */
*/*                PROCESSING WITH THE FIRST BYTE OF THE BUFFER      */
*/*                SET TO X'FF' TO INDICATE FIRST I/O REQUEST        */
*/*                TO UEXCP.                                         */
*/*                                                                  */
*/*            EXIT NORMAL -                                         */
*/*                                                                  */
*/*              LASTCC = 00    FUNCTION COMPLETED NORMALLY          */
*/*                                                                  */
*/*            EXIT ERROR -                                          */
*/*                                                                  */
*/*              LASTCC = 12    FUNCTION DID NOT COMPLETE            */
*/*                                                                  */
*/* INTERNAL INTERFACES -                                            */
*/*                                                                  */
*/*      MACROS/SVCS                                                 */
*/*                                                                  */
*/*            NONE                                                  */
*/*                                                                  */
*/*      PROCEDURES/SUBROUTINES CALLED                               */
*/*                                                                  */
*/*            IDCRDIN - TO OBTAIN DATA SET NAME FOR THE SPECIFIED   */
*/*                      DDNAME                                      */
*/*                                                                  */
*/*      DATA AREAS                                                  */
*/*                                                                  */
*/*            NONE                                                  */
*/*                                                                  */
*/*  EXTERNAL INTERFACES -                                           */
*/*                                                                  */
*/*       MACROS/SVCS                                                */
*/*                                                                  */
*/*             UDUMP - IDCAMS DUMP POINT ROUTINE                    */
*/*               PRINTS A DUMP AT THE SPECIFIED DUMP POINT          */
*/*               GENERATES A CALL TO MODULE IDCDB01                 */
*/*                                                                  */
*/*             UTRACE - IDCAMS TRACE POINT ROUTINE                  */
*/*               SETS TRACE POINT                                   */
*/*                                                                  */
*/*             ?CALLCKER - REPAIRV MESSAGE WRITER                   */
*/*               WRITES ALL MESSAGES                                */
*/*               GENERATES A CALL TO MODULE IDCRDER                 */
*/*                                                                  */
*/*             UIOINFO - IDCAMS I/O ADAPTER INFORMATION ROUTINE     */
*/*               RETURNS DSNAME AND VOLSER OF REQUESTED DDNAME      */
*/*               GENERATES A CALL TO MODULE IDCIOSI                 */
*/*                                                                  */
*/*             DEVTYPE - OS/VS SYSTEM DEVICE CHARACTERISTICS MACRO  */
*/*               OBTAINS DEVICE CHARACTERISTICS NOT RETURNED BY     */
*/*               UIOINFO                                            */
*/*                                                                  */
*/*             WTOR - OS/VS SYSTEM WRITE TO OPERATOR WITH REPLY     */
*/*                    MACRO                                         */
*/*               PROMPTS OPERATOR FOR AUTHORIZATION TO ACCESS       */
*/*               REQUESTED VOLUME OR VTOC                           */
*/*                                                                  */
*/*             UPRINT - IDCAMS TEXT PROCESSOR PRINT ROUTINE         */
*/*               LOADS OPERATOR AUTHORIZATION PROMT MESSAGE         */
*/*               IDC498D                                            */
*/*               GENERATES A CALL TO MODULE AMSTP011                */
*/*                                                                  */
*/*             USYSINFO - IDCAMS SYSTEM ADAPTER I/O UNITS           */
*/*                        INFORMATION ROUTINE                       */
*/*               USED TO OBTAIN THE UCB ADDRESS                     */
*/*               GENERATES A CALL TO MODULE IDCSASIO                */
*/*                                                                  */
*/*             URESERVE - IDCAMS SYSTEM ADAPTER RESERVE ROUTINE     */
*/*               USED TO RESERVE THE VTOC FOR A MODIFY REQUEST OR   */
*/*               TO RESERVE THE STAGING PACK OFFLINE TO THE MSS     */
*/*               GENERATES A CALL TO MODULE IDCSARV                 */
*/*                                                                  */
*/*             UDEQ - IDCAMS SYSTEM ADAPTER DEQ ROUTINE             */
*/*               USED TO DEQ THE VTOC FOR A MODIFY REQUEST OR       */
*/*               TO DEQ THE STAGING PACK OFFLINE TO THE MSS         */
*/*               GENERATES A CALL TO MODULE IDCSADQ                 */
*/*                                                                  */
*/*             UEXCP - IDCAMS I/O ADAPTER EXCP ROUTINE              */
*/*               OPENS AND CLOSES DATA SETS OR STAGING PACKS        */
*/*               GENERATES A CALL TO MODULE IDCIO05                 */
*/*                                                                  */
*/*             UGPOOL - IDCAMS SYSTEM ADAPTER GET POOL ROUTINE      */
*/*               ACQUIRES DYNAMIC STORAGE FOR CHANNEL PROGRAMS      */
*/*               AND I/O BUFFERS                                    */
*/*               GENERATES A CALL TO MODULE IDCSAGP                 */
*/*                                                                  */
*/*             UFPOOL - IDCAMS SYSTEM ADAPTER FREE POOL ROUTINE     */
*/*               RELEASES DYNAMIC STORAGE ACQUIRED FOR CHANNEL      */
*/*               PROGRAMS AND I/O BUFFERS                           */
*/*               GENERATES A CALL TO MODULE IDCSAFP                 */
*/*                                                                  */
*/*             UALLOC - IDCAMS SYSTEM ADAPTER ALLOCATION ROUTINE    */
*/*               USED TO OBTAIN DDNAME WHEN DSNAME IS SUPPLIED AND  */
*/*               TO DYNAMICALLY ALLOCATE DATA SET (OS/VS2 ONLY)     */
*/*               GENERATES A CALL TO MODULE IDCSAAL                 */
*/*                                                                  */
*/*             UOPEN - IDCAMS I/O ADAPTER OPEN ROUTINE              */
*/*               USED TO OPEN A OPENABLE DATA SET TO EXTRACT        */
*/*               THE DATA SET EXTENTS FROM THE DEB IN ORDER TO      */
*/*               CONSTRUCT THE EXTENT TABLE (XTNTTBL)               */
*/*               GENERATES A CALL TO MODULE IDCIOOP                 */
*/*                                                                  */
*/*             UGET - IDCAMS I/O ADAPTER GET ROUTINE                */
*/*               USED TO GET FIRST RECORD IN THE VTOC, THE          */
*/*               FORMAT4 DSCB TO DETERMINE EXTENTS OF THE VTOC      */
*/*               GENERATES A CALL TO MODULE IDCIOGT                 */
*/*                                                                  */
*/*             UCLOSE - IDCAMS I/O ADAPTER CLOSE ROUTINE            */
*/*               CLOSES THE OPENABLE DATA SET AFTER THE DATA SET    */
*/*               EXTENTS HAVE BEEN EXTRACTED FROM THE DEB           */
*/*               GENERATES A CALL TO MODULE IDCIOCL                 */
*/*                                                                  */
*/*             OBTAIN - OS/VS SYSTEM OBTAIN FORMAT1 DSCB MACRO      */
*/*               USED TO READ FORMAT1 DSCB TO DETERMINE DATA SET    */
*/*               TYPE (VSAM OR NON-VSAM)                            */
*/*                                                                  */
*/*       PROCEDURES/SUBROUTINES CALLED                              */
*/*                                                                  */
*/*            NONE                                                  */
*/*                                                                  */
*/*       DATA AREAS -                                               */
*/*                                                                  */
*/*            XTNTTBL - REPAIRV EXTENT TABLE                        */
*/*              CONTAINS EACH EXTENT WITHIN THE REQUESTED RANGE     */
*/*                                                                  */
*/*            DEVAREA - DEVTYPE SVC RETURN AREA                     */
*/*              COMMUNICATES THE CHARACTERISTICS OF THE I/O DEVICE  */
*/*                                                                  */
*/*            INFOAREA - UIOINFO ROUTINE RETURN AREA                */
*/*              COMMUNICATES THE DATA SET NAME AND VOLSER LIST      */
*/*              OF THE REQUESTED DATA SET                           */
*/*                                                                  */
*/*            SINFAREA - USYSINFO ROUTINE RETURN AREA               */
*/*              COMMUNICATES THE UCB ADDRESS OF THE REQUESTED       */
*/*              DDNAME                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0297
*                                                                  0297
*/*********************************************************  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* MSS GLOBAL DATA AREAS FOR AMS (VS2):        10/13/76     @ZA09521*/
*/*     (1) MSS MESSAGE STRUCTURES                           @Y30LB30*/
*/*     (2) SYSTEM ADAPTER DECLARATIONS                      @Y30LB30*/
*/*         A) DATA STRUCTURES                               @Y30LB30*/
*/*         B) SYMBOLIC RETURN CODES                         @Y30LB30*/
*/*     (3) VOLUME SERVICE DECLARATIONS                      @Y30LB30*/
*/*         A) DATA STRUCTURES                               @Y30LB30*/
*/*         B) SYMBOLIC RETURN CODES                         @Y30LB30*/
*/*     (4) INPUT/OUTPUT ADAPTER DECLARATIONS                @Y30LB30*/
*/*     (5) CONVENTIONALIZED NAMED VALUES DELCARATIONS       @Y30LB30*/
*/*                                                          @Y30LB30*/
*/* CHANGE ACTIVITY -                                        @YD00171*/
*/*       @YD00171                                           @YD00171*/
*/*       @YD00175                                           @YD00175*/
*/* CHANGE 03  3/18/75  NEW COPY CART. MSSC MESSAGE FORMAT   @ZM00741*/
*/* CHANGE 04 11/10/75  NEW STAEPARM FORMAT                  @ZA05112*/
*/* CHANGE 05 03/04/76  MDFORCE IN MDAGL                     @ZA09521*/
*/* CHANGE 06 9/1/76  DCRR - REBUILD A VOLUME LABEL          @ZDR2057*/
*/* CHANGE 07 10/13/76 FIX TO CTMSG CTARRAY MULTIPLE         @ZA14727*/
*/* CHANGE 08 10/20/76 REPAIRV                               @ZA11014*/
*/*                                                          @YD00171*/
*/*********************************************************  @Y30LB30*/
*                                                                  0297
*                                   /*                       @Y30LB30*/
*/*********************************************************  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*  THIS STRUCTURE IS THE FORMAT OF THE COPY CARTRIDGE      @Y30LB33*/
*/*  MESSAGE RETURNED AFTER THE SUCCESSFUL COMPLETION        @Y30LB33*/
*/*  OF THE USSC MACRO.                                      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*********************************************************  @Y30LB33*/
*                                                                  0297
*                                   /*                       @Y30LB33*/
*   DCL                                                            0297
*     CCMSGPTR PTR(31);             /* PTR TO MSG AREA       @Y30LB33
*                                                            @Y30LB33*/
*   DCL                                                            0298
*     1 CCMSG BASED(CCMSGPTR),      /*                       @Y30LB33*/
*      2 CCPSTCDE CHAR(1),          /* POST CODE             @ZM00741*/
*      2 CCEJCODE FIXED(8),         /* EJECT CODE            @ZM00741*/
*      2 * CHAR(2),                 /* RESERVED              @ZM00741*/
*      2 CCVOL CHAR(6),             /* VOLUME                @Y30LB33*/
*      2 * CHAR(2),                 /* RESERVED              @ZM00741*/
*      2 CCNEWCSN CHAR(12),         /* REPLACEMENT CART      @Y30LB33*/
*      2 CCOLDCSN CHAR(12);         /* OLD CARTRIDGE         @Y30LB33
*                                                            @Y30LB33
*                                                            @Y30LB33*/
*/*********************************************************  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*  THIS STRUCTURE IS THE FORMAT OF THE MOVE AND            @Y30LB33*/
*/*  DEFINE MESSAGES RETURNED AFTER THE SUCCESSFUL           @Y30LB33*/
*/*  COMPLETION OF THE USSC MACRO                            @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*********************************************************  @Y30LB33*/
*                                                                  0299
*                                   /*                       @Y30LB33*/
*   DCL                                                            0299
*     CMMSGPTR PTR(31);             /* PTR TO MSG AREA       @Y30LB30
*                                                            @Y30LB33*/
*   DCL                                                            0300
*     1 CMMSG BASED(CMMSGPTR),      /*                       @Y30LB30*/
*      2 CMOLDVOL CHAR(6),          /* OLD VOLID             @Y30LB30*/
*      2 CMVOLFLG CHAR(1),          /* MESSAGE FLAGS         @Y30LB30*/
*       3 CMCECART BIT(1),          /* CE CART               @Y30LB30*/
*       3 CMSCRVOL BIT(1),          /* SCRATCH VOLUME        @Y30LB30*/
*       3 CMDERAS BIT(1),           /* DASD ERASE            @Y30LB30*/
*       3 CMEXCL BIT(1),            /* EXCLUSIVE VOLUME      @Y30LB30*/
*       3 CMSCRCRT BIT(1),          /* SCRATCH CARTRIDGE     @Y30LB30*/
*       3 CMBIND BIT(1),            /* BOUND VOLUME          @Y30LB30*/
*       3 CMRONLY BIT(1),           /* READONLY VOLUME       @Y30LB30*/
*       3 * BIT(1),                 /* UNUSED                @Y30LB33*/
*      2 * CHAR(1),                 /* UNUSED                @Y30LB33*/
*      2 CMNEWVOL CHAR(6),          /* NEW VOLID             @Y30LB30*/
*      2 * CHAR(1),                 /* UNUSED                @Y30LB33*/
*      2 CMNUMCRT CHAR(1),          /* NUMBER OF CARTS       @Y30LB30*/
*      2 CMCSN1 CHAR(12),           /* CART SERIAL 1         @Y30LB30*/
*      2 CMCSN2 CHAR(12);           /* CART SERIAL 2         @Y30LB30
*                                                            @Y30LB33*/
*/*********************************************************  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* THIS STRUCTURE IS THE FORMAT OF THE COPY TABLES          @Y30LB33*/
*/* MESSAGE RETURNED AFTER THE SUCCESSFUL COMPLETION         @Y30LB33*/
*/* OF THE USSC MACRO TO COPY THE MSC TABLES                 @Y30LB30*/
*/*                                                          @Y30LB33*/
*/*********************************************************  @Y30LB33*/
*                                                                  0301
*                                   /*                       @Y30LB33*/
*   DCL                                                            0301
*     CTMSGPTR PTR(31);             /* PTR TO MSG AREA       @Y30LB33
*                                                            @Y30LB33*/
*   DCL                                                            0302
*     1 CTMSG BASED(CTMSGPTR),      /*                       @Y30LB33*/
*      2 * CHAR(1),                 /* UNUSED                @Y30LB33*/
*      2 CTREALCC CHAR(2),          /* CYLINDER IN           @Y30LB33
*                                      TARGET DATA SET       @Y30LB33
*                                      WHERE FIRST           @Y30LB33
*                                      BEGINS                @Y30LB33*/
*      2 CTREALH FIXED(8) UNSIGNED, /*                       @Y30LB33
*                                      TRACK IN TARGET       @Y30LB33
*                                      DATA SET WHERE        @Y30LB33
*                                      FIRST TABLE           @Y30LB33
*                                      BEGINS                @Y30LB33*/
*      2 CTARRAY(14) CHAR(4),       /* TABLE TRACKS          @ZA14727*/
*       3 CTTBLID CHAR(1),          /* TABLE ID              @Y30LB33*/
*       3 CTTBLCC FIXED(8)          /* CYLINDER WHERE        @Y30LB33*/
*             UNSIGNED,             /* TABLE BEGAN ON        @Y30LB33
*                                      TABLE VOLUME          @Y30LB33*/
*       3 CTTBLHH FIXED(8)          /* TRACK WHERE           @Y30LB33*/
*             UNSIGNED,             /* TABLE BEGAN ON        @Y30LB33
*                                      TABLE VOLUME          @Y30LB33*/
*       3 CTTBLRR FIXED(8)          /* RECORD WHERE          @Y30LB33*/
*             UNSIGNED;             /* TABLE BEGAN ON        @Y30LB33
*                                      TABLE VOLUME          @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*********************************************************  @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR MOUNT/DEMOUNT   @Y30LB37*/
*/*  FOR THE UMSSUNIT MACRO CALL.                            @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*********************************************************  @Y30LB37*/
*                                                                  0303
*                                   /*                       @Y30LB37*/
*   DCL                                                            0303
*     1 MDAGL BDY(WORD) BASED,      /*                       @Y30LB37*/
*      2 MDHEAD CHAR(8),            /* MDAGL HEADING         @Y30LB37*/
*      2 MDUCBPTR PTR(31),          /* PTR TO UCB ADDR       @Y30LB37*/
*      2 MDDDNAME CHAR(8),          /* DDNAME                @Y30LB37*/
*      2 MDPUAGL PTR(31),           /* PTR TO PUAGL          @Y30LB37*/
*      2 MDLABEL CHAR(6),           /* VOL SERIAL NUMBER     @Y30LB37*/
*      2 MDFLAGS,                   /* OPTION FLAGS          @Y30LB37*/
*       3 MDNEWVOL BIT(1),          /* NEW VOLUME            @Y30LB37*/
*       3 MDCLEAR BIT(1),           /* CLEAR WITH MOUNT      @Y30LB37*/
*       3 MDPOST BIT(1),            /* POST WITH DEMOUNT     @Y30LB37*/
*       3 MDWAIT BIT(1),            /* WAIT ON DEMOUNT       @Y30LB37*/
*       3 MDENQ BIT(1),             /* INTERNAL ENQ FLAG     @Y30LB37*/
*       3 MDDEQ BIT(1),             /* DEQ WITH DEMOUNT      @YD00175*/
*       3 MDFORCE BIT(1),           /* FORCE DEMOUNT         @ZA09521*/
*       3 MDVTOCTR BIT(1),          /* USE SUPPLIED VTOC     @ZDR2057*/
*      2 * CHAR(1),                 /* RESERVED (UNUSED)     @ZDR2057*/
*      2 MDVTOC CHAR(5) BDY(WORD),  /* VTOC                  @ZDR2057*/
*       3 MDCC FIXED(15),           /* CC (CYLANDER)         @ZDR2057*/
*       3 MDHH FIXED(15),           /* HH (HEAD)             @ZDR2057*/
*       3 MDR CHAR(1);              /* R (RECORD)            @ZDR2057
*                                                            @Y30LB30*/
*/*********************************************************  @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR POST UCB        @Y30LB37*/
*/*  FOR THE UMSSUNIT MACRO CALL.                            @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*********************************************************  @Y30LB37*/
*                                                                  0304
*                                   /*                       @Y30LB37*/
*   DCL                                                            0304
*     1 PUAGL BDY(WORD) BASED,      /*                       @Y30LB37*/
*      2 PUHEAD CHAR(8),            /* PUAGL HEADING         @Y30LB37*/
*      2 PUUCBPTR PTR(31),          /* UCB POINTER           @Y30LB37*/
*      2 PUTTRPTR PTR(31),          /* TTR POINTER           @Y30LB37*/
*      2 PULABELP PTR(31);          /* VOLUME LABEL PTR      @Y30LB37
*                                                            @Y30LB37*/
*/*********************************************************  @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR CHECK UCB       @Y30LB37*/
*/*  FOR THE UMSSUNIT MACRO CALL.                            @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*********************************************************  @Y30LB37*/
*                                                                  0305
*                                   /*                       @Y30LB37*/
*   DCL                                                            0305
*     1 CKAGL BDY(WORD) BASED,      /*                       @Y30LB37*/
*      2 CKHEAD CHAR(8),            /* CKAGL HEADING         @Y30LB37*/
*      2 CKUCBPTR PTR(31),          /* UCB POINTER           @Y30LB37*/
*      2 CKDDNAME CHAR(8),          /* DDNAME                @Y30LB37*/
*      2 CKDATYPE PTR(31),          /* RET ADDR OF TYPE      @Y30LB37*/
*      2 CKLABELP PTR(31),          /* VOLUME LABEL PTR      @Y30LB37*/
*      2 CKFLAGS,                   /* OPTION FLAGS          @Y30LB37*/
*       3 CKTESTVT BIT(1),          /* TEST VIRTUAL          @Y30LB37*/
*       3 CKRETTYP BIT(1),          /* RETURN TYPE           @Y30LB37*/
*       3 CKDMTABL BIT(1),          /* TEST DEMOUNTABLE      @Z40LB35*/
*       3 * BIT(5);                 /* RESERVED              @YD00175
*                                                            @Y30LB37*/
*/*********************************************************  @YD00175*/
*/*                                                          @YD00175*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR EXCLUSIVE       @YD00175*/
*/*  CONTROL FOR THE UMSSUNIT MACRO CALL.                    @YD00175*/
*/*                                                          @YD00175*/
*/*********************************************************  @YD00175*/
*                                                                  0306
*                                   /*                       @YD00175*/
*   DCL                                                            0306
*     1 EXCLAGL BDY(WORD) BASED,    /*                       @YD00175*/
*      2 EXCLHEAD CHAR(8),          /* EXCLAGL HEADING       @YD00175*/
*      2 EXCLUCBP PTR(31),          /* UCB POINTER           @YD00175*/
*      2 EXCLDDP PTR(31),           /* DDNAME POINTER        @YD00175*/
*      2 EXCLVOL CHAR(6),           /* VOLUME SERIAL         @YD00175*/
*      2 EXCLFLAG,                  /* OPTION FLAGS          @YD00175*/
*       3 EXCLMNT BIT(1),           /* VOLUME MOUNTED FLAG   @YD00175*/
*       3 * BIT(7);                 /* RESERVED              @YD00175
*                                                            @YD00175*/
*/*********************************************************  @YD00175*/
*/*                                                          @Y30LB35*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR OPEN            @Y30LB35*/
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*********************************************************  @Y30LB35*/
*                                                                  0307
*                                   /*                       @Y30LB35*/
*   DCL                                                            0307
*     1 EXOARG BDY(WORD) BASED,     /*                       @Y30LB35*/
*      2 EXOHEAD CHAR(8),           /* RESERVED              @Y30LB35*/
*      2 EXODDN PTR(31),            /* POINTER TO DDNAME     @Y30LB35*/
*      2 EXODSN PTR(31),            /* POINTER TO DSNAME     @Y30LB35*/
*      2 EXOVSN PTR(31),            /* POINTER TO VOL SER    @Y30LB35*/
*      2 EXOUCB PTR(31),            /* POINTER TO UCB        @Y30LB35*/
*      2 EXOEXT PTR(31),            /* POINTER RET EXTENTS   @Y30LB30*/
*      2 EXOCTLBK PTR(31),          /* PTR RET IOCTLBK PTR   @Y30LB30*/
*      2 EXOPT,                     /* OPEN OPITIONS         @Y30LB35*/
*       3 EXOTAB BIT(1),            /* OPEN FOR MSC TABLES   @Y30LB30*/
*       3 EXOLAB BIT(1),            /* OPEN VOL LABEL        @Y30LB35*/
*       3 EXOPASS BIT(1),           /* OPEN TEST PASSWD      @Y30LB35*/
*       3 EXONEW BIT(1),            /* OPEN VOL TO INIT      @Y30LB35*/
*       3 EXOVTOC BIT(1),           /* OPEN VOL TO READ      @Z40LB35
*                                      VTOC DSCBS            @Z40LB35*/
*       3 EXOREP BIT(1),            /* REPAIR OPEN           @ZA11014*/
*       3 * BIT(2),                 /* RESERVED              @ZA11014*/
*      2 EXFLG,                     /* OPEN FLAGS            @Y30LB35*/
*       3 EXOREAD BIT(1),           /* INDICATES READ ONLY   @Y30LB35*/
*       3 * BIT(2),                 /* RESERVED              @ZA11014*/
*       3 EXORVS BIT(1),            /* VSAM DATA SET         @ZA11014*/
*       3 EXOSPK BIT(1),            /* STAGING PACK          @ZA11014*/
*       3 EXORDS BIT(1),            /* DATA SET              @ZA11014*/
*       3 EXORVT BIT(1),            /* VTOC                  @ZA11014*/
*       3 EXOVTH BIT(1);            /* VTOC HEADER           @ZA11014
*                                                            @Y30LB30*/
*/*********************************************************  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR GET             @Y30LB35*/
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*********************************************************  @Y30LB35*/
*                                                                  0308
*                                   /*                       @Y30LB35*/
*   DCL                                                            0308
*     1 EXGARG BDY(WORD) BASED,     /*                       @Y30LB35*/
*      2 EXGHEAD CHAR(8),           /* RESERVED              @Y30LB35*/
*      2 EXGCTLBK PTR(31),          /* POINTER TO IOCTLBK    @Y30LB35*/
*      2 EXGCCHH1 PTR(31),          /* PTR TO SEEK CCHHR     @Y30LB35*/
*      2 EXGCCHH2 PTR(31),          /* PTR TO SEARCH CCHHR   @Y30LB35*/
*      2 EXGRECNO FIXED(31),        /* NUM RECORDS TO READ   @Y30LB35*/
*      2 EXGDATAP PTR(31),          /* PTR AREA FOR RECS     @Y30LB35*/
*      2 EXGKEYLN FIXED(8) UNSIGNED,/* LEN OF KEY            @Y30LB35*/
*      2 * FIXED(8),                /* RESERVED              @Y30LB35*/
*      2 EXGDATAL FIXED(15) UNSIGNED;/* LEN OF DATA          @Y30LB35*/
*/*********************************************************  @ZA11014*/
*/*                                                          @ZA11014*/
*/* THIS STRUCTURE IS THE ARGUMENT LIST FOR REPAIRV          @ZA11014*/
*/* I/O CALLS TO THE UEXCP MACRO                             @ZA11014*/
*/*                                                          @ZA11014*/
*/*********************************************************  @ZA11014*/
*                                                                  0309
*                                   /*                       @Y30LB35*/
*   DCL                                                            0309
*     1 EXWRARG BDY(WORD) BASED,    /*                       @ZA11014*/
*      2 EXRWRES CHAR(8),           /* RESERVED              @ZA11014*/
*      2 EXRWCTBL PTR(31),          /* POINTER TO IOCTLBK    @ZA11014*/
*      2 EXRWIOAR PTR(31),          /* PTR TO SEEK CCHHR     @ZA11014*/
*      2 EXRWDARE PTR(31),          /* PTR TO SEARCH CCHHR   @ZA11014*/
*      2 EXLOCPTR PTR(31),          /* NUM RECORDS TO READ   @ZA11014*/
*      2 EXCCWCNT FIXED(15),        /* PTR AREA FOR RECS     @ZA11014*/
*      2 EXRWCHR,                   /*                       @ZA11014*/
*       3 EXCC FIXED(16),           /*                       @ZA11014*/
*       3 EXHH FIXED(16),           /*                       @ZA11014*/
*       3 EXRECNUM FIXED(8),        /*                       @ZA11014*/
*      2 * FIXED(8),                /* RESERVED              @ZA11014*/
*      2 EXRWKDLN PTR(31),          /*                       @ZA11014*/
*      2 EXSPACE,                   /*                       @ZA11014*/
*       3 * FIXED(8),               /*                       @ZA11014*/
*       3 * PTR(24),                /*                       @ZA11014*/
*       3 * FIXED(15),              /*                       @ZA11014*/
*       3 * FIXED(15),              /*                       @ZA11014*/
*       3 * FIXED(15),              /*                       @ZA11014*/
*      2 EXRWFUN FIXED(8);          /*                       @ZA11014*/
*/*********************************************************  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR PUT             @Y30LB35*/
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*********************************************************  @Y30LB35*/
*                                                                  0310
*                                   /*                       @Y30LB35*/
*   DCL                                                            0310
*     1 EXPARG BDY(WORD) BASED,     /*                       @Y30LB35*/
*      2 EXPHEAD CHAR(8),           /* RESERVED              @Y30LB35*/
*      2 EXPCTLBK PTR(31),          /* PTR IOCTLBK PTR       @Y30LB35*/
*      2 EXPDATA PTR(31),           /* PTR DATA-TO-WRITE     @Y30LB35*/
*      2 EXPCCHHR PTR(31);          /* PTR TO SEEK CCHHR     @Y30LB35
*                                                            @Y30LB30*/
*/*********************************************************  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR DATA-TO-WRITE   @Y30LB35*/
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*********************************************************  @Y30LB35*/
*                                                                  0311
*                                   /*                       @Y30LB35*/
*   DCL                                                            0311
*     1 EXPDATAB BDY(WORD) BASED(EXPDATA),/*                 @Y30LB35*/
*      2 EXPRECNO FIXED(31),        /* NUM OF RECORDS        @Y30LB35*/
*      2 EXPARRAY(*),               /* DATA-TO-WRITE ARRAY   @Y30LB35*/
*       3 EXPDATAP PTR(31),         /* PTR TO DATA           @Y30LB30*/
*       3 EXPKEYLN FIXED(8) UNSIGNED,/* LEN OF KEY           @Y30LB35*/
*       3 * FIXED(8),               /* RESERVED              @Y30LB35*/
*       3 EXPDATAL FIXED(15) UNSIGNED;/* LEN DATA            @Y30LB35
*                                                            @Y30LB30*/
*/*********************************************************  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR VOLUME SERVICES @Y30LB35*/
*/*  FOR THE 'INITVOL', 'GETLABEL', AND 'PUTLABEL' REQUEST.  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*********************************************************  @Y30LB35*/
*                                                                  0312
*                                   /*                       @Y30LB35*/
*   DCL                                                            0312
*     1 VS2AGL BDY(WORD) BASED,     /*                       @Y30LB35*/
*      2 VS2HEAD CHAR(8),           /* RESERVED              @Y30LB35*/
*      2 VSUCBPTR PTR(31),          /* PTR TO UCB ADDR       @Y30LB35*/
*      2 VSVTOCSZ FIXED(31),        /* VTOC TRK SIZE         @Y30LB35*/
*      2 VSOWNPTR PTR(31),          /* PTR TO OWNER NAME     @Y30LB30*/
*      2 VSVOLPTR PTR(31),          /* PTR TO VOLUME SER     @Y30LB30*/
*      2 VSIOBKPT PTR(31),          /* PTR TO IOXCTLBK PTR   @Y30LB30*/
*      2 VSLABOPT,                  /* LABEL OPTIONS         @Y30LB35*/
*       3 VSOWNER BIT(1),           /* RETRIEVE OR UPDATE    @Y30LB35
*                                      OWNER FIELD IN LABEL@Y30LB35  */
*       3 VSVOLSER BIT(1),          /* RETRIEVE OR UPDATE    @Y30LB35
*                                      VOL FIELD IN LABEL    @Y30LB35*/
*       3 VSNOVTOC BIT(1),          /* NO DEFAULT VTOC       @ZDR2057*/
*       3 * BIT(5),                 /* RESERVED              @ZDR2057*/
*      2 VSVOLUME CHAR(6),          /* SERIAL NUM FOR OPEN   @Y30LB35*/
*      2 VS2MSG,                    /* MESSAGE OPTION        @Y30LB35*/
*       3 VS2TOV BIT(1),            /* TO VOLUME PLACED IN   @Y30LB35
*                                      MESSAGE               @Y30LB35*/
*       3 * BIT(7),                 /* RESERVED              @Y30LB35*/
*      2 VS2RESOP,                  /* RESERVE OPTION        @Y30LB30*/
*       3 VS2RES BIT(1),            /* RESERVE TO BE         @Y30LB35
*                                      PERFORMED             @Y30LB35*/
*       3 VS2REAL BIT(1),           /* REAL VOLUME           @Y30LB35*/
*       3 * BIT(6),                 /* RESERVED              @Y30LB35*/
*      2 VSDDNAME CHAR(8),          /* DD NAME               @YD00175*/
*      2 * CHAR(3),                 /* RESERVED (UNUSED)     @ZDR2057*/
*      2 VSVTOCPT PTR(31);          /* PTR TO VTOC           @ZDR2057
*                                                            @Y30LB30*/
*/*********************************************************  @Y30LB30*/
*/*                                                          @Y30LB30*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR VOLUME SERVICES @Y30LB30*/
*/*  FOR THE 'SECCHECK', 'SCRVTOC ', 'GETVTOC ', 'PUTVTOC ', @Y30LB30*/
*/*  AND 'RECATLG  ' SERVICE REQUESTS.                       @Y30LB30*/
*/*                                                          @Y30LB30*/
*/*********************************************************  @Y30LB30*/
*                                                                  0313
*                                   /*                       @Y30LB30*/
*   DCL                                                            0313
*     1 VS1AGL BDY(WORD) BASED,     /*                       @Y30LB30*/
*      2 VSHEAD CHAR(8),            /* RESERVED              @Y30LB30*/
*      2 VSUCBP PTR(31),            /* UCB ADDRESS PTR       @Y30LB30*/
*      2 VSVOLP PTR(31),            /* VOLUME SER PTR        @Y30LB30*/
*      2 VSFILEP PTR(31),           /* DD NAME PTR           @Y30LB30*/
*      2 VSIOP PTR(31),             /* VTOC IOCSTR PTR       @Y30LB30*/
*      2 VSNUMATP PTR(31),          /* NO. ALT TRACK PTR     @Y30LB30*/
*      2 VSNXTATP PTR(31),          /* NEXT ALT TRK PTR      @Y30LB30*/
*      2 VSCATP PTR(31),            /* VSAM CAT NAME PTR     @Y30LB30*/
*      2 VSACBP PTR(31),            /* VSAM CAT ACB PTR      @Y30LB30*/
*      2 VSCATDDP PTR(31),          /* VSAM CAT DDNAME PTR   @Y30LB30*/
*      2 VSPSWDP PTR(31),           /* VSAM CAT PSWD PTR     @Y30LB30*/
*      2 VSPFILEP PTR(31),          /* PASSWORD FILE PTR     @Y30LB30*/
*      2 VSSERP PTR(31),            /* NEW SERIAL PTR        @Y30LB30*/
*      2 VSDEVP PTR(31),            /* DEVICE TYPE PTR       @Y30LB30*/
*      2 VSOSERP PTR(31),           /* OLD SERIAL PTR        @Y30LB30*/
*      2 VSODEVP PTR(31),           /* OLD DEVICE PTR        @Y30LB30*/
*      2 VSSECOPT,                  /* SECURITY CHECK OPT    @Y30LB30*/
*       3 VSNOVSAM BIT(1),          /* NO VSAM DATA SETS     @Y30LB30*/
*       3 VSMASTER BIT(1),          /* VSAM MASTER PSWD      @Y30LB30*/
*       3 VSNONONV BIT(1),          /* NO NON-VSAM D.S.      @Y30LB30*/
*       3 VSREAD BIT(1),            /* NON-VSAM READ PSWD    @Y30LB30*/
*       3 VSWRITE BIT(1),           /* NON-VSAM WRITE PSWD   @Y30LB30*/
*       3 VSUCTEST BIT(1),          /* RET USER CAT INFO     @Y30LB30*/
*       3 VSOPCAT BIT(1),           /* OPEN USERCAT VS/2     @Y30LB30*/
*       3 VSUCMAST BIT(1),          /* VSAM USERCAT MASTER   @YD00171*/
*      2 VSVTOPT,                   /* VTOC FIELD OPTIONS    @Y30LB30*/
*       3 VSTIME BIT(1),            /* VSAM TIME STAMP       @Y30LB30*/
*       3 VSALTTRK BIT(1),          /* ALTERNATE TRACKS      @Y30LB30*/
*       3 VSVSFLAG BIT(1),          /* VSAM OWNERSHIP FLAG   @Y30LB30*/
*       3 * BIT(5),                 /* RESERVED              @Y30LB30*/
*      2 VSCATOPT,                  /* RECATALOG OPTIONS     @Y30LB30*/
*       3 VSDEVICE BIT(1),          /* DEVICE TYPE           @Y30LB30*/
*       3 VSSERIAL BIT(1),          /* VOLUME SERIAL         @Y30LB30*/
*       3 VSLIST BIT(1),            /* LIST NAMES            @Y30LB30*/
*       3 * BIT(5),                 /* RESERVED              @Y30LB30*/
*      2 VSRETURN,                  /* INFORMATION RETURN    @Y30LB30*/
*       3 VSVSAM BIT(1),            /* VOL OWNED BY VSAM     @Y30LB30*/
*       3 VSUCAT BIT(1),            /* USER CAT ON VOLUME    @Y30LB30*/
*       3 * BIT(6),                 /* RESERVED              @Y30LB30*/
*      2 VSMSG,                     /* MESSAGE OPTIONS       @Y30LB30*/
*       3 VSFROMV BIT(1),           /* FROM VOLUME           @Y30LB30*/
*       3 VSTOV BIT(1),             /* TO VOLUME             @Y30LB30*/
*       3 * BIT(6),                 /* RESERVED              @Y30LB30*/
*      2 VSRESOPT,                  /* RESERVE OPTIONS       @Y30LB30*/
*       3 VSRES BIT(1),             /* RESERVE VOLUME        @Y30LB30*/
*       3 VSREAL BIT(1),            /* REAL VOLUME           @Y30LB30*/
*       3 * BIT(6);                 /* RESERVED              @Y30LB30
*                                                            @Y30LB30*/
*/*********************************************************  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR URECAT MACRO    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*********************************************************  @Y30LB34*/
*                                                                  0314
*                                   /*                       @Y30LB34*/
*   DCL                                                            0314
*     1 RCTAGL BDY(WORD) BASED,     /*                       @Y30LB34*/
*      2 RCTHEAD CHAR(8),           /* RESERVED              @Y30LB30*/
*      2 RCTOPT CHAR(2),            /* RECAT OPTIONS         @Y30LB30*/
*       3 RCTDEV BIT(1),            /* DEVICE TYPE           @Y30LB30*/
*       3 RCTVOL BIT(1),            /* VOLUME SERIAL         @Y30LB30*/
*       3 * BIT(6),                 /* RESERVED              @Y30LB34*/
*      2 * CHAR(2),                 /* RESERVED              @Y30LB34*/
*      2 RCTODEV FIXED(31),         /* OLD DEV TYPE          @Y30LB30*/
*      2 RCTNDEV FIXED(31),         /* NEW DEV TYPE          @Y30LB30*/
*      2 RCTOVOL CHAR(6),           /* OLD VOL SER           @Y30LB30*/
*      2 RCTNVOL CHAR(6),           /* NEW VOL SER           @Y30LB30*/
*      2 RCTDSET CHAR(44);          /* DATA SET NAME         @Y30LB30
*                                                            @Y30LB34
*                                                            @Y30LB34*/
*/*********************************************************  @Y30LB30*/
*/*                                                          @Y30LB30*/
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR USTAE MACRO     @Y30LB30*/
*/*                                                          @Y30LB30*/
*/*********************************************************  @Y30LB30*/
*                                                                  0315
*                                   /*                       @Y30LB30*/
*   DCL                                                            0315
*     1 STAEPARM BDY(WORD) BASED,   /*                       @Y30LB33*/
*      2 STAHEAD CHAR(8),           /* RESERVED              @Y30LB30*/
*      2 STAVUCB PTR(31),           /* VIRTUAL UCB ADDR      @Y30LB30*/
*      2 STAVVOL CHAR(6),           /* VIRTUAL VOLSER        @Y30LB30*/
*      2 * CHAR(2),                 /* RESERVED              @Y30LB30*/
*      2 STARUCB PTR(31),           /* REAL UCB ADDR         @Y30LB30*/
*      2 STARVOL CHAR(6),           /* REAL VOLSER           @Y30LB30*/
*      2 * CHAR(2),                 /* RESERVED              @Y30LB30*/
*      2 STARTTR CHAR(4),           /* TTR TO THE VTOC       @Y30LB30*/
*      2 STARTSAV PTR(31),          /* PTR TO RETRY SAVAREA  @Y30LB30*/
*      2 STAEXSAV PTR(31),          /* PTR STAEEXIT SAVAREA  @Y30LB35*/
*      2 STARTADD PTR(31),          /* PTR TO RETRY AREA     @Y30LB30*/
*      2 STATCB PTR(31),            /* PTR TO ENQUEUED TCB   @Y30LB35*/
*      2 STARCVY,                   /* TRACKING FLAGS        @Y30LB30*/
*       3 STAVMNT BIT(1),           /* VIRT VOL MOUNTED      @Y30LB30*/
*       3 STAVDMNT BIT(1),          /* VIRT VOL DEMOUNTED    @Y30LB30*/
*       3 STAVENQ BIT(1),           /* VOL ENQUEUED          @Y30LB30*/
*       3 STAVPOST BIT(1),          /* VIRT VOL POSTED       @Y30LB30*/
*       3 STACLEAR BIT(1),          /* REAL UCB CLEARED      @Y30LB30*/
*       3 * BIT(3),                 /* RESERVED              @Y30LB30*/
*      2 STARETRY,                  /* RETRY FLAGS           @Y30LB30*/
*       3 STAIO05 BIT(1),           /* IO5 RETRY IN CONTROL  @Y30LB30*/
*       3 STAOFF BIT(1),            /* STAE CANCELLED (VS1)  @Y30LB35*/
*       3 STAVTOC BIT(1),           /* OPEN VTOC IN-PROCESS  @Z40LB35*/
*       3 * BIT(5),                 /* RESERVED              @ZA05112*/
*      2 STAVTTR CHAR(4);           /* VIRTUAL VTOC TTR      @ZA05112
*                                                            @Y30LB37*/
*/*********************************************************  @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*  THIS STRUCTURE IS THE MAPPING OF THE VOLUME LABEL REC   @Y30LB37*/
*/*                                                          @Y30LB37*/
*/*********************************************************  @Y30LB37*/
*                                                                  0316
*                                   /*                       @Y30LB37*/
*   DCL                                                            0316
*     1 VOLLABEL BASED,                                            0316
*      2 VOLKEY CHAR(4),            /* VOL LABEL KEY         @Y30LB37*/
*      2 VOLLABI CHAR(3),           /* LABEL ID 'VOL'        @Y30LB37*/
*      2 VOLNO CHAR(1),             /* VOL LABEL SEQ NUMBER  @Y30LB37*/
*      2 VOLSERNO CHAR(6),          /* VOLUME SERIAL         @Y30LB37*/
*      2 VOLSECTY CHAR(1),          /* RESERVED              @Y30LB37*/
*      2 VOLVTOC CHAR(5),           /* CCHHR OF THE VTOC     @Y30LB37*/
*      2 VOLRESV1 CHAR(25),         /* RESERVED              @Y30LB37*/
*      2 VOLOWNER CHAR(10),         /* USER NAME AREA        @Y30LB37*/
*      2 VOLRESV3 CHAR(29);         /* RESERVED              @Y30LB37
*                                                            @Y30LB37*/
*/*********************************************************  @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*  THIS STRUCTURE IS THE MAPPING OF THE SVC 82 PARMLIST    @Y30LB35*/
*/*                                                          @Y30LB35*/
*/*********************************************************  @Y30LB35*/
*                                                                  0317
*                                   /*                       @Y30LB35*/
*   DCL                                                            0317
*     1 SV82LIST BDY(WORD) BASED,   /* SVC 82 ARG LIST       @Y30LB35*/
*      2 SV82CODE BIT(8),           /* OPERATION CODE        @Y30LB35*/
*      2 SV82UCBP PTR(24),          /* UCB ADDRESS           @Y30LB35*/
*      2 * PTR(31),                 /* THIRD ARGUMENT        @Y30LB35*/
*       3 SV82DCBP PTR(31),         /* DCB PTR FOR - OPEN    @Y30LB35*/
*        4 SV82VOLP PTR(31),        /* VOL PTR FOR - POST    @Y30LB35*/
*      2 SV82TTRP PTR(31),          /* TTR TO VTOC ADDRESS   @Y30LB35*/
*      2 * PTR(31),                 /* FIFTH ARGUMENT        @Y30LB35*/
*       3 SV82WRKP PTR(31),         /* ADD RET AREA - CLEAR  @Y30LB35*/
*        4 SV82DEBP PTR(31);        /* ADDR DEB - CLOSE      @Y30LB35
*                                                            @Y30LB35*/
*/*********************************************************  @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* SORT ARGUMENT LIST                                       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*                                                                  0318
*   DCL                                                            0318
*     1 SRTAGL BDY(WORD) BASED,     /*                       @Z40LB37*/
*      2 SRTHEAD CHAR(8),           /* SRTAGL HEADING        @Z40LB37*/
*      2 SRTADDR PTR(31),           /* PTR TO FIRST          @Z40LB37
*                                      ELEMENT               @Z40LB37*/
*      2 SRTNUM FIXED(31),          /* NUMBER OF             @Z40LB37
*                                      ELEMENTS              @Z40LB37*/
*      2 SRTLEN FIXED(31),          /* LENGTH OF             @Z40LB37
*                                      ELEMENT               @Z40LB37*/
*      2 SRTPOSIT FIXED(31),        /* SORT FIELD            @Z40LB37
*                                      STARTING POSITION     @Z40LB37*/
*      2 SRTFLDLN FIXED(31),        /* SORT FIELD LENGTH     @Z40LB37*/
*      2 SRTWORKP PTR(31);          /* WORK AREA ADDRESS     @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* ULOCATE DATA SET RETURNED INFORMATION AREA               @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*                                                                  0319
*   DCL                                                            0319
*     1 LCTINFO BDY(WORD) BASED,    /*                       @Z40LB37*/
*      2 LCTHEAD CHAR(8),           /* LCTINFO HEADING       @Z40LB37*/
*      2 LCTMULVC FIXED(31),        /* NUMBER OF VOLUMES     @Z40LB37*/
*      2 LCTACBP PTR(31),           /* PTR TO THE ACB        @Z40LB37*/
*      2 LCTCREAT CHAR(4),          /* VSAM CREATION DATE    @Z40LB37*/
*      2 LCTEXPIR CHAR(4),          /* VSAM EXPIRATION       @Z40LB37
*                                      DATE                  @Z40LB37*/
*      2 LCTOWNER CHAR(8),          /* OWNER NAME            @Z40LB37*/
*      2 LCTFLAGS,                  /* RETURN FLAGS          @Z40LB37*/
*       3 LCTVSCAT BIT(1),          /* VSAM CATALOG ENTRY    @Z40LB37*/
*       3 * BIT(7);                 /* RESERVED              @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* UUNCATLG ARGUMENT LIST                                   @Z40LB63*/
*/*                                                          @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*                                                                  0320
*   DCL                                                            0320
*     1 UCTAGL BDY(WORD) BASED,     /*                       @Z40LB63*/
*      2 UCTHEAD CHAR(8),           /* UCTAGL HEADING        @Z40LB63*/
*      2 UCTDSN CHAR(44),           /* DATA SET NAME         @Z40LB63*/
*      2 UCTACBP PTR(31),           /* PTR TO CAT ACB        @Z40LB63*/
*      2 UCTVOLP PTR(31),           /* PTR TO VOLUME         @Z40LB30
*                                      LIST                  @Z40LB30*/
*      2 UCTDD CHAR(8),             /* DDNAME                @Z40LB63*/
*      2 UCTFLAGS,                  /* OPTION FLAGS          @Z40LB63*/
*       3 UCTVSCAT BIT(1),          /* VSAM CATALOG          @Z40LB63*/
*       3 * BIT(7);                 /* RESERVED              @Z40LB63*/
*/*********************************************************  @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* ARGUMENT LIST FOR SELECTING A DDNAME                     @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*                                                                  0321
*   DCL                                                            0321
*     1 SELAGL BDY(WORD) BASED,     /*                       @Z40LB37*/
*      2 SELHEAD CHAR(8),           /* SELAGL HEADING        @Z40LB37*/
*      2 SELUCBP PTR(31),           /* UCB POINTER           @Z40LB37*/
*      2 SELDDNP PTR(31),           /* DDNAME POINTER        @Z40LB37*/
*      2 SELVOL CHAR(6),            /* VOLUME SERIAL         @Z40LB37*/
*      2 SELFLAGS,                  /* OPTION FLAGS          @Z40LB37*/
*       3 * BIT(8);                 /* RESERVED              @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* ARGUMENT LIST FOR CONVERT DATE PROCEDURE                 @Z40LB35*/
*/*                                                          @Z40LB37*/
*/*********************************************************  @Z40LB37*/
*                                                                  0322
*   DCL                                                            0322
*     1 DATESAGL BDY(WORD) BASED,                                  0322
*      2 DATHEAD CHAR(8),           /* IDENTIFIER HEADER     @Z40LB35*/
*      2 DATDATE FIXED(31),         /* DATE TO CONVERT       @Z40LB35*/
*      2 DATDAYS FIXED(31),         /* DAYS TO ADJUST        @Z40LB35*/
*      2 DATRETRN PTR(31),          /* RETURN PTR OF DATE    @Z40LB35*/
*      2 DATESOPT BIT(8),           /* OPTIONS FLAGS         @Z40LB35*/
*       3 DATADD BIT(1),            /* ADD DAYS TO DATE      @Z40LB35*/
*       3 DATSUB BIT(1),            /* SUBTRACT DAYS         @Z40LB35*/
*       3 DATDTEOP BIT(1),          /* ADJUST DAYS           @Z40LB35*/
*       3 DATDAYOP BIT(1),          /* CONVERT DATE ONLY     @Z40LB35*/
*       3 * BIT(4);                 /* RESERVED              @Z40LB35*/
*/*********************************************************  @Z40LB35*/
*/*                                                          @Z40LB37*/
*/* SELECTDS DATA SET ARGUMENT LIST                          @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*********************************************************  @Z40LB37*/
*                                                                  0323
*   DCL                                                            0323
*     1 VS3AGL BDY(WORD) BASED,                                    0323
*      2 VS3HEAD CHAR(8),           /* RESERVED              @Z40LB35*/
*      2 VS3LISTP PTR(31),          /* PTR LIST ADDR         @Z40LB35*/
*      2 VS3EXDSP PTR(31),          /* PTR EXCLUDE DS        @Z40LB35*/
*      2 VS3LEVP PTR(31),           /* PTR LEVEL QUAL        @Z40LB35*/
*      2 VS3LEVLN FIXED(15),        /* LENGTH OF QUAL        @Z40LB35*/
*      2 VS3AST FIXED(15),          /* OFFSET ASTERISK       @Z40LB35*/
*      2 VS3EXPIR PTR(31),          /* PTR EXPIRATION DATE   @Z40LB35*/
*      2 VS3CREAT PTR(31),          /* PTR CREATION DATE     @Z40LB35*/
*      2 VS3UCBP PTR(31),           /* PTR UCB               @Z40LB35*/
*      2 VS3DEV CHAR(4),            /* DEVICE TYPE           @Z40LB35*/
*      2 VS3POOL CHAR(4),           /* STORAGE POOL ID       @Z40LB35*/
*      2 VS3VOL CHAR(6),            /* SERIAL NUMBER         @Z40LB35*/
*      2 VS3DD CHAR(8),             /* DDNAME FOR OPEN       @Z40LB35*/
*      2 VS3FLAGS,                  /* FLAGS                 @Z40LB35*/
*       3 VS3STAT BIT(1),           /* RETURN VSDSTAT        @Z40LB35*/
*       3 VS3USAGE BIT(1),          /* RETURN VSDUSAGE       @Z40LB35*/
*       3 VS3SCR BIT(1),            /* RETURN VSDSCR         @Z40LB35*/
*       3 VS3UNCAT BIT(1),          /* UNCAT SELECTION       @Z40LB35*/
*       3 VS3SYSNM BIT(1),          /* SYSTEM NAME           @Z40LB35
*                                      SELECTION             @Z40LB35*/
*       3 * BIT(3);                 /* RESERVED              @Z40LB35*/
*/*********************************************************  @YD00175*/
*/*                                                          @YD00175*/
*/*   SELECTED DATA SET ARRAY                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*********************************************************  @Z40LB35*/
*                                                                  0324
*   DCL                                                            0324
*     ELEMENT FIXED(31);            /* ELEMENT COUNTER       @Z40LB35*/
*   DCL                                                            0325
*     1 VSDVTOC BASED(VSDSPACE),    /* LSPACE INFO BLOCK     @Z40LB35*/
*      2 * CHAR(6),                 /* RESERVED              @Z40LB35*/
*      2 VSDFRCYL CHAR(4),          /* TOTAL FREE CYL        @Z40LB35*/
*      2 * CHAR(1),                 /* RESERVED              @Z40LB35*/
*      2 VSDFRTRK CHAR(4),          /* TOTAL FREE TRACKS     @Z40LB35*/
*      2 * CHAR(1),                 /* RESERVED              @Z40LB35*/
*      2 VSDFREXT CHAR(4),          /* TOTAL FREE EXTENTS    @Z40LB35*/
*      2 * CHAR(1),                 /* RESERVED              @Z40LB35*/
*      2 VSDFRCCL CHAR(4);          /* LARGEST CONT CYL      @Z40LB35*/
*   DCL                                                            0326
*     1 VSDSTAT BASED(ADDR(VSDVARY(ELEMENT))) BDY(WORD),           0326
*      2 VSDCREAT FIXED(31),        /* CREATION DATE         @Z40LB35*/
*      2 VSDEXPIR FIXED(31),        /* EXPIRATION DATE       @Z40LB35*/
*      2 VSDOWNER CHAR(8),          /* OWNER OF D. S.        @Z40LB35*/
*      2 VSDSFLG1 BIT(8),           /* FLAG BYTE             @Z40LB35*/
*       3 VSDVTOCC BIT(1),          /* CREATION DATE VTOC    @Z40LB35*/
*       3 VSDVTOCE BIT(1),          /* EXPIRATION DATE       @Z40LB35
*                                      VTOC                  @Z40LB35*/
*       3 VSDVSAMC BIT(1),          /* CREATION DATE VSAM    @Z40LB35*/
*       3 VSDVSAME BIT(1),          /* EXPIRATION DATE       @Z40LB35
*                                      VSAM                  @Z40LB35*/
*       3 VSDCATLG BIT(1),          /* DSN IS CATALOGED      @Z40LB35*/
*       3 VSDCVSAM BIT(1),          /* CATLG IN VSAM         @Z40LB35*/
*       3 * BIT(2),                 /* RESERVED              @Z40LB35*/
*      2 VSDFLG2 BIT(8),            /* FLAG BYTE             @Z40LB35*/
*       3 VSDPWR BIT(1),            /* READ PROTECTED        @Z40LB35*/
*       3 VSDPWW BIT(1),            /* WRITE PROTECTED       @Z40LB35*/
*       3 VSDPROT BIT(1),           /* DSN IS PROTECTED      @Z40LB35*/
*       3 VSDERROR BIT(1),          /* CATALOG ERROR         @Z40LB35*/
*       3 * BIT(4),                 /* RESERVED              @Z40LB35*/
*                                                                  0326
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING PORTION IS THE CALLERS WORK AREA      @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0326
*      2 VSDCRE CHAR(2),            /* CREATION DATE         @Z40LB35*/
*      2 VSDEXP CHAR(2),            /* EXPIRATION DATE       @Z40LB35*/
*      2 VSDCAT CHAR(3),            /* CATALOG INFO          @Z40LB35*/
*      2 VSDPRTC CHAR(3);           /* PROTECTION INFO       @Z40LB35*/
*   DCL                                                            0327
*     1 VSDSCR BASED(ADDR(VSDVARY(ELEMENT))) BDY(WORD),            0327
*      2 VSDACBPT PTR(31),          /* ACB PTR TO VSAM CAT   @Z40LB35*/
*      2 VSDSCRFL BIT(8),           /* FLAG BYTE             @Z40LB35*/
*       3 VSDCATLC BIT(1),          /* DATA SET IN CATLG     @Z40LB35*/
*       3 VSDVSAM BIT(1),           /* DSN IN VSAM CATLG     @Z40LB35*/
*       3 * BIT(6),                 /* RESERVED              @Z40LB35*/
*      2 * CHAR(3);                 /* RESERVED              @Z40LB35*/
*   DCL                                                            0328
*     1 VSDUSAGE BASED(ADDR(VSDVARY(ELEMENT))) BDY(WORD),          0328
*      2 VSDTRKS FIXED(15),         /* TRACKS ALLOCATED      @Z40LB35*/
*      2 VSDFTRK FIXED(15),         /* TRACKS FREE           @Z40LB35*/
*      2 VSDSECAL FIXED(31),        /* SECONDARY ALLOC       @Z40LB35*/
*      2 VSDEXTS FIXED(8),          /* NUMBER EXTENTS        @Z40LB35*/
*      2 VSDDORG BIT(8),            /* FLAG BYTE             @Z40LB35*/
*       3 VSDOPO BIT(1),            /* PARTITIONED ORG       @Z40LB35*/
*       3 VSDOPS BIT(1),            /* PHYSICAL SEQUENTIAL   @Z40LB35*/
*       3 VSDOUN BIT(1),            /* UNKNOWN ORG           @Z40LB35*/
*       3 VSDODA BIT(1),            /* DIRECT ACCESS ORG     @Z40LB35*/
*       3 VSDOIS BIT(1),            /* INDEX SEQ ORG         @Z40LB35*/
*       3 VSDOU BIT(1),             /* UNMOVEABLE            @Z40LB35*/
*       3 * BIT(2),                 /* RESERVED              @Z40LB35*/
*      2 VSDALLOC BIT(8),           /* FLAG BYTE             @Z40LB35*/
*       3 VSDACYL BIT(1),           /* CYLINDER ALLOC        @Z40LB35*/
*       3 VSDATRK BIT(1),           /* TRACK ALLOC           @Z40LB35*/
*       3 VSDABLK BIT(1),           /* BLOCK ALLOC           @Z40LB35*/
*       3 VSDABSTR BIT(1),          /* ABSOLUTE TRACKS       @Z40LB35*/
*       3 * BIT(4),                 /* RESERVED              @Z40LB35*/
*      2 VSDUSEF BIT(8),            /* FLAG BYTE             @Z40LB35*/
*       3 VSDCALFR BIT(1),          /* UNABLE CAL. SPACE     @Z40LB35*/
*       3 * BIT(7),                 /* RESERVED              @Z40LB35*/
*                                                                  0328
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING PORTION IS THE CALLERS WORK AREA      @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0328
*      2 VSDSCAL CHAR(4),           /* SECONDARY ALLOC       @Z40LB35*/
*      2 VSDDSORG CHAR(3),          /* DSORG                 @Z40LB35*/
*       3 * CHAR(2),                /* RESERVED              @Z40LB35*/
*       3 VSDDSOR3 CHAR(1),         /* DSORG INFO            @Z40LB35*/
*      2 VSDALLC CHAR(5),           /* TOTAL TRKS ALLOC      @Z40LB35*/
*      2 VSDFREE CHAR(4);           /* FREE TRACKS           @Z40LB35*/
*   DCL                                                            0329
*     1 VSDBLOCK BDY(WORD) BASED,                                  0329
*      2 VSDELEM FIXED(31),         /* NUMBER DSN'S          @Z40LB35*/
*      2 VSDVTOCS FIXED(31),        /* NUMBER TRKS IN VTOC   @Z40LB35*/
*      2 VSDFMT0 FIXED(31),         /* NUMBER FMT0 IN VTOC   @Z40LB35*/
*      2 VSDSPACE PTR(31),          /* PTR TO LSPACE INFO    @Z40LB35*/
*      2 VSDARRAY(*) BDY(WORD),                                    0329
*       3 VSDVOLCT FIXED(31),       /* VOLUME COUNT          @Z40LB35*/
*       3 VSDDSN CHAR(44),          /* DSN                   @Z40LB35*/
*       3 VSDVARY CHAR(MAX(LENGTH(VSDSTAT),LENGTH(VSDSCR),LENGTH(  0329
*             VSDUSAGE)));          /*                       @Z40LB35*/
*/*********************************************************  @YD00175*/
*/*                                                          @YD00175*/
*/*   KEYWORD ARGUMENT DECLARATIONS FOR ADAPTORS AND         #Y30LB30*/
*/*   VOLUME SERVICES                                        #Y30LB30*/
*/*                                                          #Y30LB30*/
*/*********************************************************  #Y30LB30*/
*                                                                  0330
*                                   /*                       #Y30LB30*/
*   DCL                                                            0330
*     SECCHECK CHAR(8) INIT('SECCHECK');/*                   #Y30LB30
*                                      ARGUMENT FOR SECURITY CHECK   */
*   DCL                                                            0331
*     SCRVTOC CHAR(8) INIT('SCRVTOC ');/*                    #Y30LB30
*                                      ARGUMENT FOR SCRATCH          */
*   DCL                                                            0332
*     GETVTOC CHAR(8) INIT('GETVTOC ');/*                    @Y30LB30
*                                      ARGURMENT FOR GET VTOC        */
*   DCL                                                            0333
*     PUTVTOC CHAR(8) INIT('PUTVTOC ');/*                    @Y30LB30
*                                      ARGUMENT FOR PUT VTOC         */
*   DCL                                                            0334
*     RECATLG CHAR(8) INIT('RECATLG ');/*                    @Y30LB30
*                                      ARGUMENT FOR RECATALOG        */
*   DCL                                                            0335
*     INITVOL CHAR(8) INIT('INITVOL ');/*                    @Y30LB30
*                                      ARGUMENT FOR INIT VOLUME      */
*   DCL                                                            0336
*     CHECK CHAR(8) INIT('CHECK   ');/*                      @Y30LB30
*                                      ARGUMENT FOR CHECK UCB        */
*   DCL                                                            0337
*     POSTUCB CHAR(8) INIT('POSTUCB ');/*                    @Y30LB30
*                                      ARGUMENT FOR POST UCB         */
*   DCL                                                            0338
*     GET CHAR(8) INIT('GET     '); /*                       @Y30LB30
*                                      ARGUMENT FOR GET EXCP RECORD  */
*   DCL                                                            0339
*     PUT CHAR(8) INIT('PUT     '); /*                       @Y30LB30
*                                      ARGUMENT FOR PUT EXCP RECORD  */
*   DCL                                                            0340
*     CLOSE CHAR(8) INIT('CLOSE   ');/*                      @Y30LB30
*                                      ARGUMENT FOR CLOSE EXCP DCB   */
*   DCL                                                            0341
*     OPEN CHAR(8) INIT('OPEN    ');/*                       @Y30LB30
*                                      ARGUMENT FOR OPEN EXCP DCB    */
*   DCL                                                            0342
*     RVOPENR CHAR(8) INIT('OPENR   ');/*                    @ZA11014*/
*   DCL                                                            0343
*     RVRDCNT CHAR(8) INIT('READCNT ');/*                    @ZA11014*/
*   DCL                                                            0344
*     RVREADKD CHAR(8) INIT('READKD  ');/*                   @ZA11014*/
*   DCL                                                            0345
*     RVSPACCR CHAR(8) INIT('SPACCR  ');/*                   @ZA11014*/
*   DCL                                                            0346
*     RVFWRITE CHAR(8) INIT('FWRITE  ');/*                   @ZA11014*/
*   DCL                                                            0347
*     RVWRITER CHAR(8) INIT('WRITEREC');/*                   @ZA11014*/
*   DCL                                                            0348
*     PUTLABEL CHAR(8) INIT('PUTLABEL');/*                   @Y30LB30
*                                      PUTLABEL VS02 REQUEST         */
*   DCL                                                            0349
*     GETLABEL CHAR(8) INIT('GETLABEL');/*                   @Y30LB30
*                                      GETLABEL VS02 REQUEST         */
*   DCL                                                            0350
*     CANCEL CHAR(8) INIT('CANCEL  ');/*                     @Y30LB37
*                                      CANCEL REQUEST FOR USTAE      */
*   DCL                                                            0351
*     SET CHAR(8) INIT('SET     '); /*                       @Y30LB37
*                                      SET REQUEST FOR USTAE         */
*   DCL                                                            0352
*     SELECTX CHAR(8) INIT('SELECTX ');/*                    @YD00175
*                                      SELECT REQUEST FOR UMSSUNIT   */
*   DCL                                                            0353
*     CHANGEX CHAR(8) INIT('CHANGEX ');/*                    @YD00175
*                                      CHANGE REQUEST FOR UMSSUNIT   */
*   DCL                                                            0354
*     SELECTDD CHAR(8) INIT('SELECTDD');/*                   @Z40LB37
*                                      SELECTDD REQUEST      @Z40LB37
*                                      FOR UMSSUNIT          @Z40LB37*/
*   DCL                                                            0355
*     SELECTDS CHAR(8) INIT('SELECTDS');/*                   @Z40LB37
*                                      SELECTDS REQUEST      @Z40LB37
*                                      FOR IDCVS03           @Z40LB37*/
*/*                                                          @Y40LB63*/
*/*********************************************************  @Y40LB63*/
*/*                                                          @Y40LB63*/
*/*   KEYWORD ARGUMENT DECLARATIONS FOR USSC MACRO FOR       @Y40LB63*/
*/*   MSS RECOVERY                                           @Y40LB63*/
*/*                                                          @Y40LB63*/
*/*********************************************************  @Y40LB63*/
*                                                                  0356
*   DCL                                                            0356
*     TBLREST CHAR(8) INIT('TBLREST ');/*                    @Y40LB63
*                                      COPY TABLES FOR       @Y40LB63
*                                      INTERNAL TABLE        @Y40LB63
*                                      RESTORE               @Y40LB63*/
*   DCL                                                            0357
*     NULLIFYC CHAR(8) INIT('NULLIFYC');/*                   @Y40LB63
*                                      NULLIFYC ORDER WHICH        0357
*                                      ELEMINATES ALL TRACE OF ACTIVE
*                                      OR INACTIVE VOLUME OR A     0357
*                                      SCRATCH CART                  */
*   DCL                                                            0358
*     RDMSC CHAR(8) INIT('RDMSC   ');/*                      @Y40LB63
*                                      QUERY ORDER TO READ MSC     0358
*                                      STORAGE               @Y40LB63*/
*   DCL                                                            0359
*     RDMSCTBL CHAR(8) INIT('RDMSCTBL');/*                   @Y40LB63
*                                      QUERY ORDER TO READ MSC TABLES
*                                                            @Y40LB63*/
*   DCL                                                            0360
*     RDCARTLB CHAR(8) INIT('RDCARTLB');/*                   @Y40LB63
*                                      QUERY ORDER TO READ A       0360
*                                      CARTRIDGE LABEL       @Y40LB63*/
*   DCL                                                            0361
*     AUDITCEL CHAR(8) INIT('AUDITCEL');/*                   @Y40LB63
*                                      QUERY ORDER TO DO A CELL AUDIT
*                                      OF THE MSF            @Y40LB63*/
*   DCL                                                            0362
*     RDSTGAD CHAR(8) INIT('RDSTGAD ');/*                    @Y40LB63
*                                      QUERY ORDER TO READ STAG- ING
*                                      ADAPTER STORAGE       @Y40LB63
*                                                            @Y30LB30*/
*                                                                  0363
*/********************************************************************/
*/*                                                                  */
*/*   MACRO NAME = IDAAMDSB                                          */
*/*                                                                  */
*/*   DESCRIPTIVE NAME =DATA SET CHARACTERISTICS                     */
*/*              AND STATISTICS BLOCK                                */
*/*                                                                  */
*/*   FUNCTION = CONTAINS DATA SET CHARACTERISTICS AND STATISTICS    */
*/*                                                                  */
*/*   CONTROL BLOCK STRUCTURE = THE IDAAMDSB IS POINTED TO BY IDAAMB */
*/*                                                                  */
*/*   INCLUDED MACROS = NONE                                         */
*/*                                                                  */
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */
*/*                                                                  */
*/*   CREATED BY = VSAM OPEN                                         */
*/*                                                                  */
*/*   STATUS = VS/1 RELEASE 4  (CHANGE FLAG @X04SVXX)                */
*/*                                                                  */
*/*   DATE OF LAST CHANGE = 8 AUG 74                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0363
*   DCL                                                            0363
*     1 IDAAMDSB BASED,             /* DATA SET CHAR./STATISTICS   0363
*                                      BLOCK                         */
*      2 AMDSBID CHAR(1),           /* CONTROL BLOCK ID              */
*      2 AMDATTR CHAR(1),           /* ATTRIBUTES                    */
*       3 AMDDST BIT(1),            /* KEY, CHRONOLOGIC              */
*       3 AMDWCK BIT(1),            /* WRITE CHECK                   */
*       3 AMDSDT BIT(1),            /* SEQ SET WITH DATA             */
*       3 AMDREPL BIT(1),           /* REPLICATION                   */
*       3 AMDORDER BIT(1),          /* USE VOLS IN LIST ORDER        */
*       3 AMDRANGE BIT(1),          /* KEY RANGE DATA SET            */
*       3 AMDRRDS BIT(1),           /* RELATIVE RECORD DATA SET    0363
*                                                            @X04SVLC*/
*       3 AMDSPAN BIT(1),           /* SPANNED RECORDS ARE ALLOWED 0363
*                                                            @X04SVLC*/
*      2 AMDLEN FIXED(15),          /* LENGTH OF AMDSB               */
*      2 AMDNEST FIXED(15),         /* NO OF ENTRIES IN IDX SECTN    */
*       3 AMDAXRKP FIXED(15),       /* RELATIVE KEY POSITION OF    0363
*                                      ALTERNATE KEY         @X04SVLC*/
*      2 AMDRKP FIXED(15),          /* RELATIVE KEY POSITION         */
*      2 AMDKEYLN FIXED(15),        /* KEY LENGTH                    */
*      2 AMDPCTCA PTR(8),           /* % FREE CI IN CA               */
*      2 AMDPCTCI PTR(8),           /* % FREE BYTES IN CI            */
*      2 AMDCIPCA FIXED(15),        /* TOTAL NO. OF CIS PER CA       */
*      2 AMDFSCA FIXED(15),         /* NO OF FREE CIS PER CA         */
*      2 AMDFSCI FIXED(31),         /* NO OF FREE BYTES PER CI       */
*      2 AMDCINV FIXED(31),         /* CONTROL INTERVAL SIZE         */
*      2 AMDLRECL FIXED(31),        /* MAXIMUM RECORD SIZE           */
*      2 AMDHLRBA FIXED(32),        /* RBA OF HIGH LEVEL IDX REC     */
*       3 AMDNSLOT FIXED(31),       /* NO. OF RECORD SLOTS PER CI  0363
*                                                            @X04SVLC*/
*      2 AMDSSRBA FIXED(32),        /* RBA OF FIRST SEQ SET REC      */
*       3 AMDMAXRR FIXED(31),       /* MAX RELATIVE RECORD NUMBER  0363
*                                                            @X04SVLC*/
*      2 AMDPARDB PTR(31),          /* PTR TO FIRST ARDB             */
*      2 AMDATTR3 BIT(8),           /* ATTRIBUTES            @X04SVLC*/
*       3 AMDUNQ BIT(1),            /* ON=NON-UNIQUE KEYS    @X04SVLC
*                                      OFF=UNIQUE KEYS       @X04SVLC*/
*       3 AMDFAULT BIT(1),          /* ON=CYLINDER FAULT ON SS1    0363
*                                      OFF=STAGE THE DATA SET      0363
*                                      (DEFAULT)             @X04SVLC*/
*       3 AMDBIND BIT(1),           /* ON=BIND THE DATA SET ON SS1 0363
*                                      OFF=DO NOT BIND (DEFAULT)   0363
*                                                            @X04SVLC*/
*       3 AMDWAIT BIT(1),           /* ON=WAIT ON A RELINQUISH OFF=DO
*                                      NOT WAIT (DEFAULT)    @X04SVLC*/
*       3 AMDLM BIT(1),             /* ON=DATA SET LOADED OFF=LOAD 0363
*                                      MODE OR NOT LOADED    @X04SVLC*/
*       3 * BIT(3),                 /* UNUSED                @X04SVLC*/
*      2 * CHAR(7),                 /* UNUSED                @X04SVLC*/
*      2 AMDSTAT BDY(WORD),         /* STATISTICS            @X04SVLC*/
*       3 AMDSTSP CHAR(8),          /* SYSTEM TIME STAMP             */
*       3 AMDNIL FIXED(15),         /* NUMBER INDEX LEVELS           */
*       3 AMDNEXT FIXED(15),        /* NUMBER OF EXTENTS             */
*       3 AMDNLR FIXED(31),         /* NUMBER LOGICAL RECORDS        */
*       3 AMDDELR FIXED(31),        /* NUMBER DELETED RECORDS        */
*       3 AMDIREC FIXED(31),        /* NUMBER INSERTED RECORDS       */
*       3 AMDUPR FIXED(31),         /* NUMBER UPDATED RECORDS        */
*       3 AMDRETR FIXED(31),        /* NUMBER RETRIEVED RECORDS      */
*       3 AMDASPA FIXED(31),        /* BYTES OF FREE SPACE IN DS     */
*       3 AMDNCIS FIXED(31),        /* NUMBER OF CI SPLITS           */
*       3 AMDNCAS FIXED(31),        /* NUMBER OF CA SPLITS           */
*       3 AMDEXCP FIXED(31);        /* NUMBER OF EXCPS               */
*   DCL                                                            0364
*     1 IFGACB BASED,               /* LEVEL ONE DECLARE             */
*      2 ACBCOMN,                   /* ACB COMMON SECTION X03004     */
*       3 ACBID PTR(8),             /* ACB IDENTIFIER                */
*       3 ACBSTYP PTR(8),           /* ACB SUBTYPE                   */
*       3 ACBLENG FIXED(15),        /* ACB LENGTH IN BYTES           */
*        4 ACBLENG2 FIXED(15),      /* ACB LENGTH IN BYTES           */
*         5 ACBLEN2 FIXED(15),      /* ACB LENGTH IN BYTES X03004    */
*       3 ACBAMBL PTR(31),          /* AMB LIST ADDRESS              */
*        4 ACBJWA PTR(31),          /* JES WORKAREA ADDRESS          */
*         5 ACBIBCT PTR(31),        /* IBCT ADDRESS                  */
*       3 ACBINRTN PTR(31),         /* INTERFACE ROUTINE ADDRESS     */
*       3 ACBMACRF BIT(16),         /* MACRF FLAGS                   */
*        4 ACBMACR1 BIT(8),         /* MACRF FIRST BYTE              */
*         5 ACBKEY BIT(1),          /* ACCESS DATA VIA INDEX         */
*         5 ACBADR BIT(1),          /* ACCESS WITHOUT INDEX          */
*          6 ACBADD BIT(1),         /* SAME AS ABOVE                 */
*         5 ACBCNV BIT(1),          /* CONTROL INTERVAL PROCESSING   */
*          6 ACBBLK BIT(1),         /* SAME AS ABOVE                 */
*         5 ACBSEQ BIT(1),          /* SEQUENTIAL PROCESSING         */
*         5 ACBDIR BIT(1),          /* DIRECT PROCESSING             */
*         5 ACBIN BIT(1),           /* GET, READ                     */
*         5 ACBOUT BIT(1),          /* PUT, WRITE                    */
*         5 ACBUBF BIT(1),          /* USER BUFFERS                  */
*        4 ACBMACR2 BIT(8),         /* MACRF SECOND BYTE             */
*         5 * BIT(3),               /* RESERVED              @X04SVHS*/
*         5 ACBSKP BIT(1),          /* SKIP SEQUENTIAL PROCESSING    */
*         5 ACBLOGON BIT(1),        /* LOGON INDICATOR(VTAM) X03004  */
*         5 ACBRST BIT(1),          /* SET DATA SET TO EMPTY STATE 0364
*                                                            @X04SVHS*/
*         5 ACBDSN BIT(1),          /* BASIC SUBTASK SHARED CONTROL
*                                      BLOCK CONNECTION ON COMMON  0364
*                                      DSNAMES               @X04SVHS*/
*         5 ACBAIX BIT(1),          /* ENTITY TO BE PROCESSED IS AIX
*                                      OF THE PATH SPECIFIED IN THE
*                                      GIVEN DDNAME          @X04SVHS*/
*       3 ACBBSTNO PTR(8),          /* NO OF CONCURRENT STRINGS FOR
*                                      AIX PATH              @X04SVHS*/
*       3 ACBSTRNO PTR(8),          /* NUMBER OF STRINGS     @X04SVHS*/
*       3 ACBBUFND FIXED(15),       /* NUMBER OF BUFFERS REQUESTED 0364
*                                      FOR DATA                      */
*       3 ACBBUFNI FIXED(15),       /* NUMBER OF BUFFERS REQUESTED 0364
*                                      FOR INDEX                     */
*       3 ACBBUFPL PTR(31),         /* JES BUFFER POOL ADDR          */
*        4 ACBMACR3 BIT(8),         /* MACRF THIRD BYTE      @X04SVHS*/
*         5 * BIT(1),               /* RESERVED              @X04SVHS*/
*         5 ACBLSR BIT(1),          /* LOCAL SHARED RESOURCE @X04SVHS*/
*         5 ACBGSR BIT(1),          /* GLOBAL SHARED RESOURCE      0364
*                                                            @X04SVHS*/
*         5 ACBICI BIT(1),          /* IMPROVED CONTROL INTERVAL   0364
*                                      PROCESSING            @X04SVHS*/
*         5 ACBDFR BIT(1),          /* DEFER WRITES          @X04SVHS*/
*         5 ACBSIS BIT(1),          /* SEQUENTIAL INSERT STRATEGY  0364
*                                                            @X04SVHS*/
*         5 ACBNCFX BIT(1),         /* NFX=0/CFX=1           @X04SVHS*/
*         5 * BIT(1),               /* RESERVED FOR VSAM             */
*        4 ACBMACR4 BIT(8),         /* RESERVED FOR VSAM             */
*        4 ACBJBUF FIXED(15),       /* NUMBER OF BUFFERS REQUESTED 0364
*                                      FOR JOURNAL                   */
*       3 ACBRECFM BIT(8),          /* RECORD FORMAT                 */
*        4 ACBRECAF BIT(1),         /* JES FORMAT                    */
*       3 ACBCCTYP BIT(8),          /* CONTROL CHARACTER             */
*        4 * BIT(4),                /* RESERVED                      */
*        4 ACBASA BIT(4),           /* CONTROL CHARACTER TYPE        */
*       3 ACBOPT BIT(16),           /* NON-USER OPTIONS              */
*        4 ACBDSORG BIT(16),        /* MATCH ACBDORGA WITH DCBDSORG  */
*         5 ACBCROPS BIT(2),        /* CHECKPOINT/RESTART OPTIONS    */
*          6 ACBCRNCK BIT(1),       /* NO CHECK FOR MODIFY           */
*          6 ACBCRNRE BIT(1),       /* NO DATA ERASE OR REPOSITION   */
*         5 * BIT(10),              /* RESERVED                      */
*         5 ACBDORGA BIT(1),        /* ACB INDICATOR                 */
*         5 * BIT(3),               /* RESERVED                      */
*       3 ACBMSGAR PTR(31),         /* MSG AREA              @X04SVHS*/
*       3 ACBPASSW PTR(31),         /* PASSWORD ADDRESS              */
*       3 ACBEXLST PTR(31),         /* USER EXIT LIST ADDR           */
*        4 ACBUEL PTR(31),          /* SAME AS ABOVE                 */
*/*  BEFORE OPEN                                                     */
*/*  (FOR VTAM, ACBDDNM INITIALIZED TO X'FF000000000000')     X03004 */
*                                                                  0364
*       3 ACBDDNM CHAR(8) BDY(WORD),/* DDNAME                        */
*/*  AFTER OPEN                                                      */
*                                                                  0364
*        4 ACBTIOT FIXED(15),       /* TIOT OFFSET                   */
*        4 ACBINFL PTR(8),          /* INDICATOR FLAGS               */
*        4 ACBAMETH PTR(8),         /* ACCESS METHOD TYPE            */
*         5 ACBAM PTR(8),           /* ACCESS METHOD TYPE X03004     */
*        4 ACBERFL BIT(8),          /* ERROR FLAGS                   */
*        4 ACBDEB PTR(24),          /* DEB ADDRESS                   */
*/*  NOT MOVED BY OPEN                                               */
*                                                                  0364
*       3 ACBOFLGS BIT(8),          /* OPEN / CLOSE FLAGS            */
*        4 * BIT(2),                /* RESERVED                      */
*        4 ACBEOV BIT(1),           /* EOV CONCATENATION             */
*        4 ACBOPEN BIT(1),          /* ACB IS OPEN                   */
*        4 ACBDSERR BIT(1),         /* NO FURTHER REQUESTS POSSIBLE
*                                      AGAINST ACB                   */
*        4 * BIT(1),                /* RESERVED                      */
*        4 ACBEXFG BIT(1),          /* USER EXIT FLAG                */
*         5 ACBLOCK BIT(1),         /* ACB IS LOCKED X03004          */
*        4 ACBIOSFG BIT(1),         /* OPEN/CLOSE IN CONTROL         */
*         5 ACBBUSY BIT(1),         /* ACB IS BUSY X03004            */
*       3 ACBERFLG BIT(8),          /* ERROR FLAGS                   */
*       3 ACBINFLG BIT(16),         /* INDICATOR FLAGS               */
*        4 * BIT(1),                /* RESERVED FOR EXCP             */
*        4 ACBJEPS BIT(1),          /* JEPS PROCESSING               */
*        4 ACBIJRQE BIT(1),         /* RQE BEING HELD BY JAM         */
*        4 ACBCAT BIT(1),           /* ACB FOR VSAM CATALOG          */
*        4 ACBSCRA BIT(1),          /* CATALOG CONTROL BLOCK SYSTEM
*                                      AREA                  @X04SVHS*/
*        4 ACBUCRA BIT(1),          /* CATALOG CONTROL BLOCK USER  0364
*                                      AREA                  @X04SVHS*/
*        4 ACBVVIC BIT(1),          /* DATA SET BEING OPENED IS    0364
*                                      SYS1.VVIC             @X04SVHS*/
*       3 ACBUJFCB PTR(31),         /* USER JFCB ADDRESS             */
*        4 ACBOPTN BIT(8),          /* JAM UCS INDICATOR             */
*        4 * PTR(24),               /* RESERVED                      */
*       3 ACBBUFSP FIXED(31),       /* SIZE AVAILABLE FOR BUFFERS    */
*       3 ACBBLKSZ FIXED(15),       /* BLOCKSIZE                     */
*        4 ACBMSGLN FIXED(15),      /* LENGTH OF MSG AREA    @X04SVHS*/
*       3 ACBLRECL FIXED(15),       /* LOGICAL RECORD LENGTH         */
*       3 ACBUAPTR PTR(31),         /* USER WORKAREA ADDR CAXWA    0364
*                                      ADDRESS FOR CATALOG OPEN      */
*       3 ACBCBMWA PTR(31),         /* CBM WORK AREA ADDRESS         */
*       3 ACBAPID PTR(31);          /* APPLICATION ID ADDRESS X03004 */
*                                                                  0365
*/********************************************************************/
*/*                                                                  */
*/*   MACRO NAME = IDAAMBL                                           */
*/*                                                                  */
*/*   DESCRIPTIVE NAME = ACCESS METHOD BLOCK LIST.                   */
*/*                                                                  */
*/*   FUNCTION = THE AMBL DESCRIBES A VSAM CLUSTER AND POINTS TO THE */
*/*              CLUSTER'S DATA SET AND INDEX AMB'S. WHEN THE CLUSTER*/
*/*              IS OPENED, AN AMBL IS BUILT TO DESCRIBE THE CLUSTER.*/
*/*              IF THE CLUSTER IS SHARED WITH OTHER USERS, THE      */
*/*              EXISTING AMB'S ADDRESSES ARE PUT INTO THE AMBL.     */
*/*                                                                  */
*/*   CONTROL BLOCK STRUCTURE = THE AMBL IS POINTED TO BY AN ACB     */
*/*                             (ACBAMBL).                           */
*/*                                                                  */
*/*   INCLUDED MACROS = NONE                                         */
*/*                                                                  */
*/*   METHOD OF ACCESS = PL/S - RESPECIFY IDAAMBL BASED.             */
*/*                                                                  */
*/*   CREATED BY: VSAM OPEN MODULE IDA0192F.                         */
*/*                                                                  */
*/*   STATUS = VS1 RELEASE 4, VS2 RELEASE 3.  (CHANGE FLAGS @X04SVXX)*/
*/*                                                                  */
*/*   DATE OF LAST CHANGE = 22 JANUARY 75                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0365
*   DCL                                                            0365
*     1 IDAAMBL BASED,                                             0365
*      2 AMBLPCHN PTR(31),          /* PRIMARY CHAIN POINTER         */
*      2 AMBLSCHN PTR(31),          /* SECONDARY CHAIN POINTER       */
*      2 AMBLACB PTR(31),           /* POINTER TO ACB                */
*      2 AMBLEOV FIXED(31),         /* EOV/RM INTERFACE              */
*       3 AMBLEFLG CHAR(1),         /* EOV FLAGS                     */
*        4 AMBLWAIT BIT(1),         /* EOV IS WAITING                */
*        4 AMBLESET BIT(1),         /* EOV RESET CONTROL BLOCKS.     */
*       3 AMBLCOMP CHAR(1),         /* EOV LOCK                      */
*       3 * CHAR(2),                /* NOT USED                      */
*      2 AMBLDDNM CHAR(8),          /* DDNAME FROM ACB               */
*       3 AMBLIDF CHAR(8),          /* CLUSTER ID            @X04SVLC*/
*        4 AMBLCACB PTR(31) BDY(BYTE),/* CAT ACB             @X04SVLC*/
*        4 AMBLDCI FIXED(24) BDY(BYTE),/* CI NBR             @X04SVLC*/
*        4 AMBLQ BIT(8),            /* QUALIFIER             @X04SVLC*/
*         5 AMBLDDC BIT(1),         /* DD CONNECT ONLY       @X04SVLC*/
*         5 AMBLGSR BIT(1),         /* OPENED FOR GSR        @X04SVLC*/
*         5 AMBLLSR BIT(1),         /* OPENED FOR LSR        @X04SVLC*/
*         5 AMBLFSTP BIT(1),        /* OPENED FOR FAST PATH  @X04SVLC*/
*         5 AMBLUBF BIT(1),         /* OPENED FOR USER BFR   @X04SVLC*/
*         5 AMBLKSDS BIT(1),        /* OPENED AS KSDS        @X04SVLC*/
*         5 AMBLESDS BIT(1),        /* OPENED AS ESDS        @X04SVLC*/
*         5 AMBLDFR BIT(1),         /* OPENED WITH DEFER OPTION    0365
*                                                            @X04SVLC*/
*      2 AMBLXPT PTR(31),           /* PTR FR BASE AMBL TO PATH AMBL
*                                      & VICE-VERSA          @X04SVLC*/
*      2 AMBLVC FIXED(15),          /* VALID AMBL TABLE      @X04SVLC*/
*       3 AMBLVRT FIXED(8),         /* RELATIVE VAT          @X04SVLC*/
*       3 AMBLENO FIXED(8),         /* OFFSET WITHIN VAT     @X04SVLC*/
*      2 AMBLTYPE BIT(8),           /* STRUCTURE TYPE        @X04SVLC*/
*       3 AMBLPATH BIT(1),          /* ACB IS FOR PATH       @X04SVLC*/
*       3 AMBLUPGR BIT(1),          /* ACB FOR UPGRADE       @X04SVLC*/
*       3 AMBLAIX BIT(1),           /* ACB FOR AIX END USE-IMPLIES 0365
*                                      AMBLBASE ON           @X04SVLC*/
*       3 AMBLBASE BIT(1),          /* ACB FOR BASE          @X04SVLC*/
*       3 AMBLFIX BIT(1),           /* STRUCTURE FIXED BY OPEN     0365
*                                                            @X04SVLC*/
*       3 * BIT(3),                 /* UNUSED                @X04SVLC*/
*      2 * CHAR(1),                 /* UNUSED                @X04SVLC*/
*      2 AMBLID CHAR(1),            /* AMBL IDENTIFER                */
*      2 AMBLSHAR BIT(8),           /* SHARING INDICATORS            */
*       3 AMBLPRIM BIT(1),          /* P-AMBL INDICATOR              */
*       3 AMBLCATO BIT(1),          /* CATALOG OPEN IND IS ON        */
*       3 AMBLWRIT BIT(1),          /* OUTPUT/UPDATE SPECIFIED       */
*       3 * BIT(5),                 /* RESERVED                      */
*      2 AMBLLEN PTR(8),            /* AMBL LENGTH                   */
*      2 AMBLFLG1 BIT(8),           /* FLAG BYTE ONE                 */
*       3 AMBLFULL BIT(1),          /* FULL ACCESS OK                */
*       3 AMBLCINV BIT(1),          /* CINV ACCESS OK                */
*       3 AMBLUPD BIT(1),           /* UPDATE ACCESS OK              */
*       3 AMBLVVIC BIT(1),          /* AMBL FOR VVIC DATA SET      0365
*                                                            @X04SVRP*/
*       3 AMBLSCRA BIT(1),          /* AMBL FOR SYSTEM CATALOG     0365
*                                      RECOVERY AREA         @X04SVRP*/
*       3 AMBLUCRA BIT(1),          /* AMBL FOR USER CATALOG RECOVERY
*                                      AREA                  @X04SVRP*/
*       3 AMBLCAT BIT(1),           /* IND ACB FOR A CATALOG         */
*       3 AMBLDUMY BIT(1),          /* DD DUMMY SPECIFIED TO SIMPLIFY
*                                      TESTING FOR SPECIAL DATA SETS
*                                      IN EXISTING CODE THE AMBLCAT
*                                      AMBLVVIC AND AMBLSCRA BITS ARE
*                                      SET AS FOLLOWS: VVIC SCRA X 0365
*                                      CAT TYPE OF DATA SET 0 0 X 0
*                                      CATALOG 1 0 X 1 VVIC 0 1 X 1
*                                      SCRA                          */
*      2 AMBLFLG2 BIT(8),           /* FLAG BYTE TWO                 */
*       3 * BIT(3),                 /* RESERVED              @Z30SSDT*/
*       3 AMBLSTAG BIT(1),          /* CLUSTER IS STAGED     @X04ACPS*/
*       3 * BIT(4),                 /* RESERVED              @X04ACPS*/
*      2 AMBLNST CHAR(1),           /* NUMBER OF STRINGS             */
*      2 AMBLNUM FIXED(15),         /* NUMBER OF AMB PTRS IN AMBL    */
*      2 * CHAR(1),                 /* RESERVED                      */
*      2 AMBLNIDS PTR(8),           /* NUMBER IF IDS                 */
*      2 AMBLMIDS(5) CHAR(2),       /* IDS OF MODULES LOADED         */
*      2 AMBLDTA PTR(31),           /* POINTER TO DATA AMB           */
*      2 AMBLIX PTR(31),            /* POINTER TO INDEX AMB          */
*      2 AMBLBIB PTR(31),           /* PTR TO BIB            @X04SVLC*/
*      2 AMBLCMB PTR(31);           /* PTR TO CMB            @X04SVRP*/
*                                                                  0366
*/********************************************************************/
*/*                                                                  */
*/*   MACRO NAME = IDAAMB                                            */
*/*                                                                  */
*/*   DESCRIPTIVE NAME =ACCESS METHOD BLOCK                          */
*/*                                                                  */
*/*   FUNCTION = DESCRIBES DATA SET ATTRIBUTES AND SUPPLIES          */
*/*              IOS COMPATIBLE FIELDS FOR I/O                       */
*/*                                                                  */
*/*   CONTROL BLOCK STRUCTURE = THE IDAAMB IS POINTED TO BY THE      */
*/*              IDAAMBL                                             */
*/*                                                                  */
*/*   INCLUDED MACROS = NONE                                         */
*/*                                                                  */
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */
*/*                                                                  */
*/*   CREATED BY = VSAM OPEN                                         */
*/*                                                                  */
*/*   STATUS = VS/1 RELEASE 4  (CHANGE FLAG @X04SVXX)                */
*/*               VS/2 RELEASE 3  (CHANGE FLAG @Y30SDXX)             */
*/*                                                                  */
*/*   DATE OF LAST CHANGE = 8 AUG 74                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0366
*   DCL                                                            0366
*     1 IDAAMB BASED,               /* AMB                           */
*      2 AMBID BIT(8),              /* AMB IDENTIFIER                */
*      2 AMBRSC BIT(8),             /* RESOURCE TS BYTE              */
*      2 AMBLEN FIXED(15),          /* AMB LENGTH                    */
*      2 AMBLINK PTR(31),           /* NEXT AMB                      */
*      2 AMBBUFC PTR(31),           /* BUFFER CONTROL                */
*      2 AMBPH PTR(31),             /* PLACEHOLDER                   */
*      2 AMBCACB PTR(31),           /* PTR TO ACB OF CATALOG USED TO
*                                      ACCESS OBJECT                 */
*      2 AMBDSB PTR(31),            /* AMDSB POINTER                 */
*      2 AMBEOVR CHAR(1),           /* EOV REQUEST TYPE - NOT USED IN
*                                      MVM                   @Y30DSJH*/
*       3 AMBFLG0 BIT(8),           /* MVM AMB FLAGS         @Y30DSJH*/
*        4 AMBPSDS BIT(1),          /* PAGE SPACE            @Y30DSJH*/
*        4 * BIT(7),                /* UNUSED IN MVM         @Y30DSJH*/
*      2 AMBFLG1 BIT(8),            /* FLAG BYTE ONE                 */
*       3 AMBCREAT BIT(1),          /* ON IF IN CREATE MODE          */
*       3 AMBTYPE BIT(1),           /*                               */
*       3 AMBMCAT BIT(1),           /* MASTER CATL                   */
*       3 AMBPCAT BIT(1),           /* PRIVATE CATL                  */
*       3 AMBSPEED BIT(1),          /* CREATE SPEED OPITON           */
*       3 AMBUBF BIT(1),            /* USER BUFFERING                */
*       3 AMBJRN BIT(1),            /* JOURNAL EXIT PRESENT          */
*       3 AMBINBUF BIT(1),          /* SHARED DS--DIRECT REQ BFR   0366
*                                      INVALIDATION                  */
*      2 AMBDSORG BIT(16),          /* DATA SET ORGANIZ.             */
*       3 * BIT(12),                /* ALWAYS ZERO                   */
*       3 AMBDORGA BIT(1),          /* ACCESS METHOD INDIC           */
*       3 * BIT(3),                 /* ALWAYS ZERO                   */
*      2 AMBIOBAD PTR(31),          /* IOB ADDR                      */
*       3 AMBIOMB PTR(31),          /* IOMB CHAIN IN MVM     @Y30DSJH*/
*      2 AMBCDSN CHAR(3),           /* CATALOG DSN                   */
*      2 AMBDDSN CHAR(3),           /* DATA DSN                      */
*      2 * PTR(16),                 /* RESERVED                      */
*      2 AMBTIOT FIXED(15),         /* OFFSET TO TIOT                */
*      2 AMBINFL PTR(8),            /* INDICATOR FLAGS               */
*       3 * BIT(1),                 /* RESERVED FOR EXCP             */
*       3 * BIT(2),                 /* RESERVED                      */
*       3 AMBCAT BIT(1),            /* AMB FOR VSAM CATLG            */
*       3 AMBSCRA BIT(1),           /* CATALOG CONTROL BLOCK SYSTEM
*                                      AREA                  @X04SVLC*/
*       3 AMBUCRA BIT(1),           /* CATALOG CONTROL BLOCK USER  0366
*                                      AREA                  @X04SVLC*/
*       3 AMBUPX BIT(1),            /* SET ON IF UPGRADE TABLE EXISTS
*                                                            @X04SVLC*/
*      2 AMBAMETH PTR(8),           /* ACCESS METHOD TYPE            */
*      2 AMBDEBPT PTR(31),          /* DEB ADDR                      */
*       3 AMBIFLGS BIT(8),          /* IOS ERROR FLAGS               */
*       3 AMBDEBAD PTR(24),         /* DEB ADDR                      */
*      2 AMBOFLGS BIT(8),           /* OPEN FLAGS                    */
*       3 * BIT(3),                 /* ALWAYS ZERO                   */
*       3 AMBOPEN BIT(1),           /* AMB IS OPEN                   */
*       3 * BIT(2),                 /* ALWAYS ZERO                   */
*       3 AMBEXFG BIT(1),           /* USER EXIT FLAG                */
*       3 AMBBUSY BIT(1),           /* BUSY BIT                      */
*      2 AMBFLG2 PTR(8),            /* FLAG BYTE TWO         @X04SVLC*/
*       3 AMBPUG BIT(1),            /* AMB PARTICIPATES IN UPGRADE 0366
*                                                            @X04SVLC*/
*      2 AMBRPT FIXED(15),          /*                               */
*      2 AMBEDB PTR(31),            /* EDB POINTER                   */
*      2 AMBEOVPT PTR(31),          /* PTR TO KEY OR RBA - NOT USED
*                                      IN MVM                @Y30DSJH*/
*       3 AMBAMBXN PTR(31),         /* PTR TO AMB EXTENSION IN MVM 0366
*                                                            @Y30DSJH*/
*      2 AMBWKA PTR(31),            /* WORK AREA PTR                 */
*      2 AMBIWA PTR(31),            /* INSERT WORK AREA PTR          */
*      2 * PTR(31),                 /* UNUSED                @Z30SSMR*/
*      2 AMBPIXP PTR(31),           /* PTR TO PRIME INDEX AMB        */
*      2 AMBPAMBL PTR(31),          /* PTR TO PRIMARY AMBL   @X04SVLC*/
*      2 AMBUPLH PTR(31),           /* PTR TO UPGRADE PLH    @X04SVLC*/
*      2 AMBCSWD1 FIXED(31) BDY(WORD),/* CS WORD 1           @X04SVLC*/
*       3 AMBAFLG BIT(8),           /* ADDITIONAL FLAGS      @X04SVLC*/
*        4 * BIT(1),                /* UNUSED                @X04SVLC*/
*        4 AMBLSR BIT(1),           /* LSR OPTION            @X04SVLC*/
*        4 AMBGSR BIT(1),           /* GSR OPTION            @Y30SDLP*/
*        4 AMBICI BIT(1),           /* ICIP OPTION           @Y30SDLP*/
*        4 AMBDFR BIT(1),           /* DEFER WRITES          @X04SVLC*/
*        4 AMBSIS BIT(1),           /* SEQ INSERT STRAT      @X04SVLC*/
*        4 AMBCFX BIT(1),           /* FIXED CTRL BLK OPTN   @Y30SDLP*/
*        4 * BIT(1),                /* UNUSED                @X04SVLC*/
*       3 * FIXED(8),               /* UNUSED                @X04SVLC*/
*       3 AMBRDCNT FIXED(15),       /* NBR OF CIS READ FOR THIS AMB -
*                                      VS1 ONLY              @X04SVLC*/
*      2 AMBBM2SH PTR(31),          /* ADDR OF PLH DOING 2ND SEARCH
*                                      OF SUBPOOL - VS1 ONLY @X04SVLC*/
*      2 AMBCPA PTR(31),            /* DB/DC - PTR TO WSHD. NON DB/DC
*                                      & VS1 - UNUSED. NON DB/DC & 0366
*                                      VS2 - PTR TO STATIC CPA'S   0366
*                                                            @Y30DSJH*/
*      2 AMBWSHD PTR(31),           /* PTR TO WORK SPACE HDR @X04SVLC*/
*      2 AMBEXEX CHAR(8),           /* EXCEPTION EXIT NAME   @X04SVLC*/
*      2 AMBSZRD FIXED(15),         /* CP SIZE FOR READ      @X04SVLC*/
*      2 AMBSZWR FIXED(15),         /* CP SIZE FOR WRITE     @X04SVLC*/
*      2 AMBSZFW FIXED(15),         /* CP SIZE FORMAT WRITE  @X04SVLC*/
*      2 AMBSZCP FIXED(15),         /* SIZE FOR CPA BASE     @X04SVLC*/
*      2 AMBVIOT PTR(31);           /* POINTER TO IDAVIOT    @X04SVLC*/
*   DCL                                                            0367
*     AMBINDEX BIT(1) CONSTANT('1'B);/* INDEX TYPE AMB               */
*   DCL                                                            0368
*     AMBDATA BIT(1) CONSTANT('0'B);/* DATA TYPE AMB                 */
*   DCL                                                            0369
*     AMBEOVMK BIT(8) CONSTANT('00000001'B);/* MOUNT BY KEY          */
*   DCL                                                            0370
*     AMBEOVMR BIT(8) CONSTANT('10000001'B);/* MOUNT BY RBA          */
*   DCL                                                            0371
*     AMBEOVAK BIT(8) CONSTANT('00000010'B);/* ALLOCATE BY KEY       */
*   DCL                                                            0372
*     AMBEOVAR BIT(8) CONSTANT('10000010'B);/* ALLOCATE BY RBA       */
*   DCL                                                            0373
*     AMBEOVUC BIT(8) CONSTANT('00000100'B);/* UPDATE CATALOG        */
*   DCL                                                            0374
*     AMBEXOFF BIT(1) CONSTANT('1'B);/* AMB NOT LOCKED               */
*                                                                  0375
*/* **************************************************************** */
*/*                                                                  */
*/*            ***** DATA EXTENT BLOCK *****                         */
*/*                                                                  */
*/*  OS/VS2 RELEASE 4, 12/05/75, LEVEL=10                            */
*/*                                                                  */
*/*  METHOD OF ACCESS                                                */
*/*      PL/S - DCL (DEBPTR,DEBDAPTR,DEBEXPTR,DEBSBPTR) PTR          */
*/*      BAL  - FIVE DSECTS ARE PRODUCED.  USING ON A DSECT NAME     */
*/*             GIVES ADDRESSABILITY FOR ALL SYMBOLS WITHIN THAT     */
*/*             DSECT.  THE DSECT NAMES AND THE SECTIONS WITHIN EACH */
*/*             DSECT ARE                                            */
*/*                                                                  */
*/*             DEB ***  APPENDAGE VECTOR TABLE SECTION              */
*/*                      PREFIX TABLE                                */
*/*                      BASIC SECTION                               */
*/*                      UNIT RECORD, MAGNETIC TAPE AND              */
*/*                        TELECOMMUNICATIONS DEVICES SECTION        */
*/*                      3540 ACCESS METHOD DEPENDENT SECTN  @X04AA9A*/
*/*                      ISAM DEPENDENT SECTION                      */
*/*                      *** POINTERS TO THE DEB IN OTHER CONTROL    */
*/*                          BLOCKS SUCH AS DCB POINT TO THE BASIC   */
*/*                          SECTION.  USING ON DEBBASIC GIVES       */
*/*                          ADDRESSABILITY FOR BASIC SECTION AND    */
*/*                          NEXT TWO SECTIONS.  DEBAPPAD IN BASIC   */
*/*                          SECTION CONTAINS ADDRESS OF APPENDAGE   */
*/*                          VECTOR TABLE (AVT) SECTION.  PREFIX     */
*/*                          FOLLOWS AVT SECTION.                    */
*/*             DEBDASD  DIRECT ACCESS STORAGE DEVICE SECTION        */
*/*             DEBACSMD EXCP, BSAM AND QSAM DEPENDENT SECTION       */
*/*                      BPAM DEPENDENT SECTION                      */
*/*                      BDAM DEPENDENT SECTION                      */
*/*                      BTAM DEPENDENT SECTION                      */
*/*                      GAM DEPENDENT SECTION                       */
*/*                      ISAM LOAD MODE EXTENSION **                 */
*/*                      ISAM SCAN MODE EXTENSION **                 */
*/*                      BISAM MODE EXTENSION **                     */
*/*                      ** FOR THESE 3 EXTENSIONS, LOAD REGISTER    */
*/*                         FROM DEBEXPT IN ISAM DEPENDENT SECTION   */
*/*                         TO SET REGISTER FOR USING.               */
*/*             DEBSUBNM SUBROUTINE NAME SECTION                     */
*/*             DEBXTN   EXTENSION FOR OS/VS2                        */
*/*                                                                  */
*/*             WHEN LISTING IS SUPPRESSED, YOU CAN DETERMINE WHICH  */
*/*             DSECT A SYNBOL IS IN BY USING THE STARTMENT NUMBER   */
*/*             IN THE DEFN COLUMN IN THE CROSS REFERENCE LISTING.   */
*/*             FOR EXAMPLE, ANY SYMBOL DEFINED BETWEEN THE          */
*/*             STATEMENT NUMBERS FOR DEBDASD AND DEBACSMD IS IN     */
*/*             THE DIRECT ACCESS STORAGE DEVICE SECTION.            */
*/*                                                                  */
*/*  F.E.'S                                                          */
*/*      MICROFICHE LISTING - IEZDEB                                 */
*/*                                                                  */
*/*  DEVELOPERS                                                      */
*/*      BAL LISTING  - SPECIFY LIST=YES ON MACRO CALL               */
*/*      PL/S LISTING - SPECIFY %IHALIST='YES' BEFORE INCLUDE        */
*/*                                                                  */
*/*      FOR INTEGRATION, A LISTING SHOULD NOT BE REQUESTED.         */
*/*                                                                  */
*/*  FUNCTION                                                        */
*/*      THE DATA EXTENT BLOCK (DEB) CONTAINS AN EXTENSION OF        */
*/*      INFORMATION IN THE DCB.  EACH DEB IS ASSOCIATED WITH A      */
*/*      DCB, AND THE TWO POINT TO EACH OTHER.  THE DEB CONTAINS     */
*/*      INFORMATION CONCERNING THE PHYSICAL CHARACTERISTICS OF      */
*/*      THE DATA SET AND OTHER INFORMATION THAT IS USED BY THE      */
*/*      CONTROL PROGRAM.                                            */
*/*                                                                  */
*/* **************************************************************** */
*                                                                  0375
*                                                                  0375
*/*  *************************************************************** */
*/*                   DEB BASIC SECTION                              */
*/*  *************************************************************** */
*                                                                  0375
*   DECLARE                                                        0375
*     1 DEBBASIC BASED(DEBPTR) BDY(WORD),                          0375
*       3 DEBTCBAD PTR(31),         /* ADDRESS OF TCB FOR THIS DEB   */
*        4 DEBNMSUB CHAR(1),        /* NUMBER OF SUBROUTINES LOADED
*                                      BY OPEN EXECUTOR ROUTINES     */
*        4 DEBTCBB PTR(24),         /* ADDRESS OF TCB FOR THIS DEB   */
*       3 DEBDEBAD PTR(31),         /* ADDRESS OF THE NEXT DEB IN THE
*                                      SAME TASK                     */
*        4 DEBAMLNG CHAR(1),        /* NUMBER OF BYTES IN THE ACCESS
*                                      METHOD DEPENDENT SECTION. FOR
*                                      BDAM THIS FIELD CONTAINS THE
*                                      LENGTH EXPRESSED IN NUMBER OF
*                                      WORDS                         */
*        4 DEBDEBB PTR(24),         /* *** SAME AS DEBDEBAD ABOVE    */
*       3 DEBIRBAD PTR(31),         /* IRB STORAGE ADDRESS USED FOR
*                                      APPENDAGE ASYNCHRONOUS EXITS  */
*        4 DEBOFLGS CHAR(1),        /* DATA SET STATUS FLAGS         */
*         5 DEBDISP BIT(2),         /* DATA SET DISPOSITION FLAGS    */
*         5 DEBEOF BIT(1),          /* END-OF-FILE (EOF) ENCOUNTERED
*                                      (TAPE INPUT) FORMAT 1 DSCB BIT
*                                      93.0 INDICATES THAT THE     0375
*                                      CURRENT VOLUME IS THE LAST  0375
*                                      VOLUME OF THE DATA SET (DASD
*                                      INPUT)                        */
*         5 DEBRLSE BIT(1),         /* RELEASE UNUSED EXTERNAL     0375
*                                      STORAGE (DASD) EMULATOR TAPE
*                                      WITH SECOND GENERATION FORMAT.
*                                      TAPE MAY CONTAIN BLOCKS     0375
*                                      SHORTER THAN 12 CHARACTERS  0375
*                                      (TAPE)                        */
*         5 DEBDCB BIT(1),          /* DCB MODIFICATION              */
*         5 DEBSPLIT BIT(1),        /* SPLIT CYLINDER (DASD) 7-TRACK
*                                      EMULATOR TAPE WITH POSSIBLE 0375
*                                      MIXED PARITY RECORDS (TAPE)   */
*         5 DEBLABEL BIT(1),        /* NONSTANDARD LABELS            */
*         5 DEBRERR BIT(1),         /* USE REDUCED ERROR RECOVERY  0375
*                                      PROCEDURE (TAPE) CONCATENATED
*                                      PARTITIONED ORGANIZATION DATA
*                                      SETS PROCESSED USING BPAM   0375
*                                      (DASD)                        */
*        4 DEBIRBB PTR(24),         /* *** SAME AS DEBIRBAD ABOVE    */
*       3 DEBOPATB CHAR(1),         /* FLAGS INDICATING BOTH THE   0375
*                                      METHOD OF I/O PROCESSING AND
*                                      THE DISPOSITION THAT IS TO BE
*                                      PERFORMED WHEN AN           0375
*                                      END-OF-VOLUME (EOV) CONDITION
*                                      OCCURS                        */
*        4 DEBABEND BIT(1),         /* SET BY ABEND INDICATING A   0375
*                                      SYSABEND OR SYSUDUMP DATA SET
*                                      (OS/VS2)                      */
*        4 DEBZERO BIT(1),          /* ALWAYS ZERO                   */
*        4 DEBPOSIT BIT(2),         /* DATA SET POSITIONING FLAGS    */
*        4 DEBACCS BIT(4),          /* TYPE OF I/O ACCESSING BEING 0375
*                                      DONE                          */
*       3 DEBQSCNT CHAR(1),         /* PURGE (SVC 16) - QUIESCE    0375
*                                      COUNT. NUMBER OF DEVICES    0375
*                                      EXECUTING USER'S CHANNEL    0375
*                                      PROGRAMS, AS SHOWN BY BITS 5
*                                      AND 6 OF UCBFL1 FIELDS        */
*       3 DEBFLGS1 CHAR(1),         /* FLAG FIELD                    */
*        4 DEBPWCKD BIT(1),         /* PASSWORD WAS SUPPLIED DURING
*                                      OPEN. EOV WILL NOT REQUEST A
*                                      PASSWORD FOR EACH ADDITIONAL
*                                      VOLUME OF A MULTIVOLUME DATA
*                                      SET                           */
*        4 DEBEOFDF BIT(1),         /* SET BY EOV TO INFORM CLOSE  0375
*                                      THAT AN END-OF-FILE HAS BEEN
*                                      ENCOUNTERED AND, THEREFORE, 0375
*                                      DEFERRED LABEL PROCESSING IS
*                                      ALLOWED                       */
*        4 DEBRSIOA BIT(1),         /* SIO APPENDAGE RE-ENTRY      0375
*                                      AUTHORIZATION BIT (OS/VS1)  0375
*                                      (MDC331)              @XM06077*/
*        4 DEBRSV02 BIT(1),         /* RESERVED                      */
*        4 DEBCINDI BIT(1),         /* DCB ASSOCIATED WITH THIS DEB
*                                      IS BEING PROCESSED BY THE   0375
*                                      COMPATIBILITY INTERFACE     0375
*                                      ROUTINES (VSAM) ICB462        */
*        4 DEBF1CEV BIT(1),         /* EOV PROCESSING OCCURRED DURING
*                                      CLOSE PROCESSING. TESTED AND
*                                      SET TO ZERO BY CLOSE, SET TO
*                                      ONE BY EOV. (ICB353) A42228   */
*        4 DEBAPFIN BIT(1),         /* IF ON, AUTHORIZED PROGRAMS CAN
*                                      BE LOADED MDC001              */
*        4 DEBXTNIN BIT(1),         /* IF ONE, DEB EXTENSION EXISTS
*                                      (OS/VS2) MDC007               */
*       3 DEBRSV05 CHAR(1),         /* RESERVED                      */
*       3 DEBUSRPG PTR(31),         /* ADDRESS OF FIRST IOB IN THE 0375
*                                      USER PURGE CHAIN (OS/VS1)   0375
*                                      ADDRESS OF PURGED I/O RESTORE
*                                      LIST (PIRL) (OS/VS2) (MDC029)
*                                                              YM3158*/
*        4 DEBNMEXT CHAR(1),        /* NUMBER OF EXTENTS SPECIFIED IN
*                                      DSCB'S                        */
*        4 DEBUSRPB PTR(24),        /* *** SAME AS DEBUSRPG ABOVE    */
*       3 DEBRRQ PTR(31),           /* POINTER TO RELATED REQUEST  0375
*                                      QUEUE (OS/VS2) MDC026         */
*        4 DEBECBAD PTR(31),        /* ADDRESS OF A PARAMETER LIST 0375
*                                      USED TO LOCATE THE PURGE ECB
*                                      FOR AN SVC PURGE REQUEST    0375
*                                      (OS/VS1) MDC025               */
*         5 DEBPRIOR CHAR(1),       /* PRIORITY OF THE TASK OWNING 0375
*                                      DEB                           */
*         5 DEBECBB PTR(24),        /* *** SAME AS DEBECBAD ABOVE    */
*       3 DEBDCBAD PTR(31),         /* ADDRESS OF DCB ASSOCIATED WITH
*                                      THIS DEB                      */
*        4 DEBPROTG CHAR(1),        /* TASK PROTECTION KEY IN HIGH-
*                                      ORDER 4 BITS                  */
*         5 DEBDEBID CHAR(1),       /* A HEX F IN LOW-ORDER 4 BITS TO
*                                      IDENTIFY THIS BLOCK AS A DEB  */
*        4 DEBDCBB PTR(24),         /* *** SAME AS DEBDCBAD ABOVE    */
*       3 DEBAPPAD PTR(31),         /* ADDRESS OF THE I/O APPENDAGE
*                                      VECTOR TABLE                  */
*        4 DEBEXSCL CHAR(1),        /* EXTENT SCALE- 4 FOR DIRECT  0375
*                                      ACCESS DEVICE AND 3525 CARD 0375
*                                      PUNCH WITH DEVICE-ASSOCIATED
*                                      DATA SET SUPPORT AND 2 FOR  0375
*                                      NONDIRECT ACCESS DEVICE AND 0375
*                                      COMMUNICATION DEVICE. THIS  0375
*                                      FIELD IS USED TO DETERMINE THE
*                                      SIZE OF THE DEVICE DEPENDENT
*                                      SECTION ICB394                */
*        4 DEBAPPB PTR(24),         /* *** SAME AS DEBAPPAD ABOVE    */
*       3 DEBBASND CHAR(0) BDY(WORD);                              0375
*                                                                  0375
*/*  *************************************************************** */
*/*    UNIT RECORD, MAGNETIC TAPE, TELECOMMUNICATIONS DEVICES SECTION*/
*/*                                                                  */
*/*      NOTE  FOR TELECOMMUNICATIONS DEVICES, THE UCB ADDRESS       */
*/*            IS REPEATED FOR EACH LINE ASSIGNED                    */
*/*  *************************************************************** */
*                                                                  0376
*   DECLARE                                                        0376
*     1 DEBBAS02 DEF(DEBBASND) BDY(WORD),                          0376
*       3 DEBDDS1 BDY(WORD),                                       0376
*        4 DEBSUCBA PTR(31),        /* ADDRESS OF UCB ASSOCIATED WITH
*                                      A GIVEN DATA SET              */
*         5 DEBSDVM CHAR(1),        /* DEVICE MODIFIER. FOR MAGNETIC
*                                      TAPE, SET MODE OPERATION CODE.
*                                      FOR UNIT RECORD, NOT USED.    */
*         5 DEBSUCBB PTR(24),       /* *** SAME AS DEBSUCBA ABOVE    */
*        4 DEBDEVED CHAR(0) BDY(WORD),/* END OF COMMON UNIT RECORD 0376
*                                      FIELDS (MDC330)       @X04AA9A*/
*/*      THE FOLLOWING FIELDS ARE PRESENT ONLY FOR THE 3525 WITH     */
*/*      DEVICE-ASSOCIATED DATA SET SUPPORT                          */
*                                                                  0376
*        4 DEBRDCB PTR(31),         /* ADDRESS OF DCB FOR THE READ 0376
*                                      ASSOCIATED DATA SET ICB394    */
*         5 DEBRSV06 CHAR(1),       /* RESERVED ICB394               */
*         5 DEBRDCBA PTR(24),       /* SAME AS DEBRDCB ABOVE ICB394  */
*        4 DEBPDCB PTR(31),         /* ADDRESS OF DCB FOR THE PUNCH
*                                      ASSOCIATED DATA SET ICB394    */
*         5 DEBRSV07 CHAR(1),       /* RESERVED ICB394               */
*         5 DEBPDCBA PTR(24),       /* SAME AS DEBPDCB ABOVE ICB394  */
*        4 DEBWDCB PTR(31),         /* ADDRESS OF DCB FOR THE PRINT
*                                      ASSOCIATED DATA SET ICB394    */
*         5 DEBRSV08 CHAR(1),       /* RESERVED ICB394               */
*         5 DEBWDCBA PTR(24);       /* SAME AS DEBWDCB ABOVE ICB394  */
*/*  *************************************************************** */
*/*                 3540 ACCESS METHOD DEPENDENT SECTION     @X04AA9A*/
*/*                 (OS/VS1 ONLY)                            @X04AA9A*/
*/*                                                                  */
*/*      NOTE  THIS SECTION FOLLOWS DEBSUCBA IN UNIT RECORD,         */
*/*            MAGNETIC TAPE, TELECOMMUNICATIONS DEVICES SECTION     */
*/*            IF DEB IS FOR 3540 DEVICE.                    @X04AA9A*/
*/*  *************************************************************** */
*                                                                  0377
*   DECLARE                                                        0377
*     1 DEBACS09 DEF(DEBDEVED) BDY(WORD),/*                  @X04AA9A*/
*      2 DEBASC09 CHAR(16) BDY(WORD),/* 3540 ACCESS METHOD DEPENDENT
*                                      SECTION (MDC317)      @X04AA9A*/
*       3 DEBVOLAC CHAR(1),         /* VOLUME ACCESSABILITY INDICATOR
*                                      (MDC327)              @X04AA9A*/
*       3 DEBDSSQL CHAR(1),         /* DATA SET SECURITY QUALIFIER 0377
*                                      (MDC328)              @X04AA9A*/
*       3 DEBVSEQU PTR(8),          /* VOLUME SEQUENCE NUMBER      0377
*                                      (MDC318)              @X04AA9A*/
*       3 DEBEAMFG BIT(8),          /* FLAG BYTE (MDC319)    @X04AA9A*/
*        4 DEBMULTI BIT(1),         /* MULTI-VOLUME INDICATOR      0377
*                                      (MDC320)              @X04AA9A*/
*        4 DEBDSOPN BIT(1),         /* DATA SET IS OPEN (MDC321)   0377
*                                                            @X04AA9A*/
*        4 DEBVAMSG BIT(1),         /* VOLUME ACCESSABILITY MESSAGE
*                                      HAS BEEN ISSUED (MDC329)    0377
*                                                            @X04AA9A*/
*        4 DEBSECVL BIT(1),         /* SECURE VOLUME (MDC332)      0377
*                                                            @X04AA9A*/
*        4 DEBRV004 BIT(1),         /* RESERVED              @X04AA9A*/
*        4 DEBRV005 BIT(1),         /* RESERVED              @X04AA9A*/
*        4 DEBRV006 BIT(1),         /* RESERVED              @X04AA9A*/
*        4 DEBRV007 BIT(1),         /* RESERVED              @X04AA9A*/
*       3 DEBDSID CHAR(8),          /* DATA SET IDENTIFIER (DSID)  0377
*                                      (INPUT) (MDC305)      @X04AA9A*/
*        4 DEBEXDTE CHAR(6),        /* EXPIRATION DATE (OUTPUT)    0377
*                                      (MDC333)              @X04AA9A*/
*        4 DEBWTPTI CHAR(1),        /* WRITE PROTECT INDICATOR     0377
*                                      (OUTPUT) (MDC334)     @X04AA9A*/
*        4 DEBRV008 CHAR(1),        /* RESERVED (OUTPUT) (MDC335)  0377
*                                                            @X04AA9A*/
*       3 DEBEOD CHAR(4) BDY(WORD), /* END OF DATA (EOD) ADDRESS   0377
*                                      (INPUT) (MDC306)      @X04AA9A*/
*        4 DEBBOE CHAR(4) BDY(WORD),/* BEGINNING OF EXTENT (BOE)   0377
*                                      ADDRESS (OUTPUT) (MDC322)   0377
*                                                            @X04AA9A*/
*         5 DEBEODRV PTR(8),        /* RESERVED (MDC307)     @X04AA9A*/
*          6 DEBBOERV PTR(8),       /* RESERVED (MDC323)     @X04AA9A*/
*         5 DEBEODTT PTR(8),        /* EOD TRACK NUMBER (MDC308)   0377
*                                                            @X04AA9A*/
*          6 DEBBOETT PTR(8),       /* BOE TRACK NUMBER (MDC324)   0377
*                                                            @X04AA9A*/
*         5 DEBEOD0 PTR(8),         /* MUST BE ZERO (MDC309) @X04AA9A*/
*          6 DEBBOE0 PTR(8),        /* MUST BE ZERO (MDC325) @X04AA9A*/
*         5 DEBEODSS PTR(8),        /* EOD SECTOR NUMBER (MDC310)  0377
*                                                            @X04AA9A*/
*          6 DEBBOESS PTR(8);       /* BOE SECTOR NUMBER (MDC326)  0377
*                                                            @X04AA9A*/
*/*  *************************************************************** */
*/*              DEB ISAM DEPENDENT SECTION                          */
*/*                                                                  */
*/*      NOTE  PRESENT ONLY IF ISAM IS USED.  FOLLOWS THE BASIC      */
*/*            SECTION AND PRECEDES THE DIRECT ACCESS STORAGE        */
*/*            DEVICE SECTION.  COUNTED AS ONE EXTENT IN DEBNMEXT.   */
*/*  *************************************************************** */
*                                                                  0378
*   DECLARE                                                        0378
*     1 DEBBAS01 DEF(DEBBASND) BDY(WORD),                          0378
*      2 DEBISAM BDY(WORD),                                        0378
*       3 DEBFIEAD PTR(31),         /* ADDRESS OF FIRST INDEX EXTENT */
*        4 DEBNIEE CHAR(1),         /* NUMBER OF EXTENTS OF        0378
*                                      INDEPENDENT INDEX AREA        */
*        4 DEBFIEB PTR(24),         /* *** SAME AS DEBFIEAD ABOVE    */
*       3 DEBFPEAD PTR(31),         /* ADDRESS OF THE FIRST PRIME  0378
*                                      DATA EXTENT                   */
*        4 DEBNPEE CHAR(1),         /* NUMBER OF EXTENTS OF PRIME  0378
*                                      DATA AREA (M=0 EXTENT)        */
*        4 DEBFPEB PTR(24),         /* *** SAME AS DEBFPEAD ABOVE    */
*       3 DEBFOEAD PTR(31),         /* ADDRESS OF THE FIRST OVERFLOW
*                                      EXTENT                        */
*        4 DEBNOEE CHAR(1),         /* NUMBER OF EXTENTS OF        0378
*                                      INDEPENDENT OVERFLOW AREA     */
*        4 DEBFOEB PTR(24),         /* *** SAME AS DEBFOEAD ABOVE    */
*       3 DEBEXPT PTR(31),          /* ADDRESS OF ISAM DEB EXTENSION
*                                      ICB379                        */
*        4 DEBRPSID BIT(8),         /* ROTATIONAL POSITION SENSING 0378
*                                      (RPS) DEVICE INDICATORS       */
*         5 DEBRPSP BIT(1),         /* PRIME DATA AREA IS ON RPS   0378
*                                      DEVICE                        */
*         5 DEBRPSI BIT(1),         /* INDEPENDENT INDEX AREA IS ON
*                                      RPS DEVICE                    */
*         5 DEBRPSO BIT(1),         /* INDEPENDENT OVERFLOW AREA IS
*                                      ON RPS DEVICE                 */
*         5 DEBRPSAP BIT(1),        /* RPS SIO APPENDAGE HAS BEEN  0378
*                                      LOADED                        */
*         5 DEBRSV09 BIT(1),        /* RESERVED                      */
*         5 DEBRSV10 BIT(1),        /* RESERVED                      */
*         5 DEBRSV11 BIT(1),        /* RESERVED                      */
*         5 DEBRSV12 BIT(1),        /* RESERVED                      */
*        4 DEBEXPTA PTR(24);        /* SAME AS DEBEXPT ABOVE ICB379  */
*/*  *************************************************************** */
*/*           DIRECT ACCESS STORAGE DEVICE SECTION                   */
*/*                                                                  */
*/*      NOTE  IF ISAM IS BEING USED, THIS SECTION FOLLOWS THE       */
*/*            ISAM DEVICE DEPENDENT SECTION.  OTHERWISE, IT         */
*/*            FOLLOWS THE BASIC SECTION.                            */
*/*                                                                  */
*/*            THERE IS ONE OF THESE SECTIONS FOR EACH EXTENT.       */
*/*  *************************************************************** */
*                                                                  0379
*   DECLARE                                                        0379
*     1 DEBDASD BASED(DEBDAPTR) BDY(WORD),                         0379
*       3 DEBUCBAD PTR(31),         /* ADDRESS OF UCB ASSOCIATED WITH
*                                      THIS DATA EXTENT              */
*        4 DEBDVMOD CHAR(1),        /* DEVICE MODIFIER - FILE MASK   */
*        4 DEBUCBA PTR(24),         /* *** SAME AS DEBUCBAD ABOVE    */
*       3 DEBBINUM CHAR(2),         /* BIN NUMBER                    */
*       3 DEBSTRCC CHAR(2),         /* CYLINDER ADDRESS FOR THE START
*                                      OF AN EXTENT LIMIT            */
*       3 DEBSTRHH CHAR(2),         /* READ/WRITE TRACK ADDRESS FOR
*                                      THE START OF AN EXTENT LIMIT  */
*       3 DEBENDCC CHAR(2),         /* CYLINDER ADDRESS FOR THE END
*                                      OF AN EXTENT LIMIT            */
*       3 DEBENDHH CHAR(2),         /* READ/WRITE TRACK ADDRESS FOR
*                                      THE END OF AN EXTENT LIMIT    */
*       3 DEBNMTRK CHAR(2);         /* NUMBER OF TRACKS ALLOCATED TO
*                                      A GIVEN EXTENT. FOR SPLIT   0379
*                                      CYLINDER DATA SETS, THIS FIELD
*                                      REPRESENTS THE NUMBER OF    0379
*                                      TRACKS BETWEEN THE START    0379
*                                      ADDRESS OF THE EXTENT AND THE
*                                      END ADDRESS OF THE EXTENT.    */
*/*  *************************************************************** */
*/*      EXCP ACCESS METHOD, BSAM AND QSAM DEPENDENT SECTION         */
*/*  *************************************************************** */
*                                                                  0380
*   DECLARE                                                        0380
*     1 DEBACSMD BASED(DEBEXPTR) BDY(WORD),                        0380
*       3 DEBVOLSQ CHAR(2),         /* VOLUME SEQUENCE NUMBER FOR  0380
*                                      MULTIVOLUME SEQUENTIAL DATA 0380
*                                      SETS                          */
*        4 DEBVOLBT BIT(8),         /* FIRST BYTE OF DEBVOLSQ      0380
*                                      (MDC016)               YA00318*/
*         5 DEBEXFUL BIT(1),        /* SET BY EOV WHEN REWRITING AN
*                                      OLD DIRECT ACCESS DATA SET TO
*                                      INDICATE THAT ALL PREVIOUS  0380
*                                      EXISTING EXTENTS HAVE BEEN  0380
*                                      FILLED (MDC017)        YA00318*/
*         5 DEBRSV36 BIT(1),        /* RESERVED MDC018               */
*         5 DEBRSV37 BIT(1),        /* RESERVED MDC018               */
*         5 DEBRSV38 BIT(1),        /* RESERVED MDC018               */
*         5 DEBRSV39 BIT(1),        /* RESERVED MDC018               */
*         5 DEBRSV40 BIT(1),        /* RESERVED MDC018               */
*         5 DEBRSV41 BIT(1),        /* RESERVED MDC018               */
*         5 DEBRSV42 BIT(1),        /* RESERVED MDC018               */
*        4 DEBVLSEQ PTR(8),         /* FOR DIRECT ACCESS, SEQUENCE 0380
*                                      NUMBER OF THE VOLUME OF THE 0380
*                                      DATA SET RELATIVE TO THE FIRST
*                                      VOLUME OF THE DATA SET. FOR 0380
*                                      TAPE, SEQUENCE NUMBER OF THE
*                                      VOLUME OF THE DATA SET      0380
*                                      RELATIVE TO THE FIRST VOLUME
*                                      PROCESSED. (MDC019)    YA00318*/
*       3 DEBVOLNM CHAR(2),         /* TOTAL NUMBER OF VOLUMES IN A
*                                      MULTIVOLUME SEQUENTIAL DATA 0380
*                                      SET.                          */
*       3 DEBDSNM CHAR(8) BDY(WORD),/* MEMBER NAME. THIS FIELD     0380
*                                      APPEARS ONLY WHEN AN OUTPUT 0380
*                                      DATA SET HAS BEEN OPENED FOR A
*                                      MEMBER NAME AND THE DSCB    0380
*                                      SPECIFIES A PARTITIONED DATA
*                                      SET.                          */
*         5 DEBUTSAA PTR(31),       /* ADDRESS OF THE USER TOTALING
*                                      SAVE AREA                     */
*          6 DEBRSV13 CHAR(1),      /* RESERVED                      */
*          6 DEBUTSAB PTR(24),      /* *** SAME AS DEBUTSAA ABOVE    */
*         5 DEBRSV14 CHAR(4) BDY(WORD),/* RESERVED (IF USER TOTALING
*                                      WAS SPECIFIED)                */
*       3 DEBBLKSI FIXED(15),       /* MAXIMUM BLOCK SIZE (MDC346) 0380
*                                                            @ZA03699*/
*       3 DEBLRECL FIXED(15);       /* LOGICAL RECORD LENGTH (MDC347)
*                                                            @ZA03699*/
*/*  *************************************************************** */
*/*                BPAM DEPENDENT SECTION                            */
*/*  *************************************************************** */
*                                                                  0381
*   DECLARE                                                        0381
*     1 DEBACS01 BASED(DEBEXPTR) BDY(WORD),                        0381
*       3 DEBDSNAM CHAR(8) BDY(WORD),/* FOR A PARTITIONED DATA SET 0381
*                                      OPENED FOR OUTPUT FOR A MEMBER
*                                      NAME, THIS FIELD IS THE MEMBER
*                                      NAME.                         */
*        4 DEBEXTNM CHAR(1);        /* FOR A PARTITIONED DATA SET  0381
*                                      OPENED FOR INPUT, EACH ONE- 0381
*                                      BYTE FIELD CONTAINS THE EXTENT
*                                      NUMBER OF THE FIRST EXTENT  0381
*                                      ENTRY FOR EACH DATA SET EXCEPT
*                                      THE FIRST, IF TWO OR MORE DATA
*                                      SETS ARE CONCATENATED. THE  0381
*                                      NUMBER OF BYTES IN THE FIELD
*                                      IS EQUAL TO ONE LESS THAN THE
*                                      NUMBER OF DATA SETS         0381
*                                      CONCATENATED.                 */
*/*  *************************************************************** */
*/*                BDAM DEPENDENT SECTION                            */
*/*  *************************************************************** */
*                                                                  0382
*   DECLARE                                                        0382
*     1 DEBACS02 BASED(DEBEXPTR) BDY(WORD),                        0382
*                                                                  0382
*/*                       *****************************************  */
*/*                       * FOR FIXED LENGTH RECORDS WITH THE     *  */
*/*                       * OPTION OF RELATIVE BLOCK ADDRESSING   *  */
*/*                       * (BUT NOT TRACK OVERFLOW)              *  */
*/*                       *****************************************  */
*                                                                  0382
*       3 DEBDBLK FIXED(31),        /* ONE FOUR-BYTE FIELD FOR EACH
*                                      EXTENT DESCRIBED IN THE DEVICE
*                                      DEPENDENT SECTION.            */
*        4 DEBDBPT PTR(8),          /* NUMBER OF BLOCKS PER TRACK    */
*        4 DEBDBPE CHAR(3);         /* NUMBER OF BLOCKS PER EXTENT   */
*   DECLARE                                                        0383
*     1 DEBACS03 BASED(DEBEXPTR) BDY(WORD),                        0383
*                                                                  0383
*/*                       *****************************************  */
*/*                       * FOR FIXED LENGTH RECORDS WITH THE     *  */
*/*                       * OPTION OF RELATIVE BLOCK ADDRESSING   *  */
*/*                       * AND TRACK OVERFLOW.                   *  */
*/*                       *****************************************  */
*                                                                  0383
*       3 DEBDTPP FIXED(31),        /* NUMBER OF TRACKS PER PERIOD   */
*       3 DEBDBPP FIXED(31),        /* NUMBER OF BLOCKS PER PERIOD   */
*/*                       THE FOLLOWING FIELD OCCURS ONCE FOR        */
*/*                       EACH EXTENT.                               */
*                                                                  0383
*       3 DEBDBPEF FIXED(31);       /* NUMBER OF BLOCKS PER EXTENT   */
*/*  *************************************************************** */
*/*               BTAM DEPENDENT SECTION                             */
*/*                                                                  */
*/*      NOTE  THIS SEGMENT IS ALWAYS PRESENT FOR BTAM.  IT IS       */
*/*            USED WHEN A BUFFER POOL OR DYNAMIC BUFFERING IS       */
*/*            USED.  OTHERWISE, THE FIELDS ARE ZERO.                */
*/*  *************************************************************** */
*                                                                  0384
*   DECLARE                                                        0384
*     1 DEBACS04 BASED(DEBEXPTR) BDY(WORD),                        0384
*       3 DEBTBFRA PTR(31),         /* ADDRESS OF THE BUFFER ROUTINE */
*        4 DEBRSV15 CHAR(1),        /* RESERVED                      */
*        4 DEBTBFRB PTR(24),        /* ADDRESS OF THE BUFFER ROUTINE */
*/*                       THE FOLLOWING FIELD IS REPEATED FOR EACH   */
*/*                       CCW ON THE CHANNEL PROGRAM QUEUE           */
*                                                                  0384
*       3 DEBTCCWA PTR(31),         /* ADDRESS OF THE FIRST (OR    0384
*                                      FOLLOWING) CCW ON THE QUEUE   */
*        4 DEBRSV16 CHAR(1),        /* RESERVED                      */
*        4 DEBTCCWB PTR(24);        /* *** SAME AS DEBCCWA ABOVE     */
*/*  *************************************************************** */
*/*                 GAM DEPENDENT SECTION                            */
*/*  *************************************************************** */
*                                                                  0385
*   DECLARE                                                        0385
*     1 DEBACS05 BASED(DEBEXPTR) BDY(WORD),                        0385
*       3 DEBFUCBA PTR(31),         /* ADDRESS OF FIRST UCB          */
*        4 DEBRSV17 CHAR(1),        /* RESERVED                      */
*        4 DEBFUCBB PTR(24),        /* ADDRESS OF FIRST UCB          */
*       3 DEBLUCBA PTR(31),         /* ADDRESS OF LAST UCB           */
*        4 DEBRSV18 CHAR(1),        /* RESERVED                      */
*        4 DEBLUCBB PTR(24);        /* ADDRESS OF LAST UCB           */
*/*  *************************************************************** */
*/*               ISAM LOAD MODE EXTENSION                           */
*/*  *************************************************************** */
*                                                                  0386
*   DECLARE                                                        0386
*     1 DEBACS06 BASED(DEBEXPT) BDY(WORD),                         0386
*      2 DEBDCBFA PTR(31),          /* ADDRESS OF DCB FIELD AREA   0386
*                                      MDC013                        */
*      2 DEBPUT PTR(31);            /* ADDRESS OF PUT MODULE ICB379  */
*/*  *************************************************************** */
*/*               ISAM SCAN MODE EXTENSION                           */
*/*  *************************************************************** */
*                                                                  0387
*   DECLARE                                                        0387
*     1 DEBACS07 BASED(DEBEXPT) BDY(WORD),                         0387
*      2 * PTR(31),                 /* DEBDCBFA - ADDRESS OF DCB   0387
*                                      FIELD AREA MDC014             */
*      2 DEBGET PTR(31),            /* ADDRESS OF GET OR PUT MODULE -
*                                      THIS FIELD IS ALSO CALLED   0387
*                                      DEBPUT ICB379                 */
*      2 DEBWKPT4 PTR(31),          /* SAME AS DCBWKPT4 - ADDRESS OF
*                                      UCB ICB379                    */
*      2 DEBWKPT5 PTR(31),          /* SAME AS DCBWKPT5 - ADDRESS OF
*                                      GET APPENDAGE MODULE ICB379   */
*      2 DEBCREAD PTR(31),          /* ADDRESS OF CHANNEL-END      0387
*                                      APPENDAGE FOR READ ICB379     */
*      2 DEBCSETL PTR(31),          /* ADDRESS OF CHANNEL-END      0387
*                                      APPENDAGE FOR SETL ICB379     */
*      2 DEBCWRIT PTR(31),          /* ADDRESS OF CHANNEL-END      0387
*                                      APPENDAGE FOR WRITE ICB379    */
*      2 DEBCCHK PTR(31),           /* ADDRESS OF CHANNEL-END      0387
*                                      APPENDAGE FOR WRITE VALIDITY
*                                      CHECK ICB379                  */
*      2 DEBCREWT PTR(31),          /* ADDRESS OF CHANNEL-END      0387
*                                      APPENDAGE FOR RE-WRITE ICB379 */
*      2 DEBCRECK PTR(31),          /* ADDRESS OF CHANNEL-END      0387
*                                      APPENDAGE FOR RE-CHECK ICB379 */
*      2 DEBAREAD PTR(31),          /* ADDRESS OF ABNORMAL-END     0387
*                                      APPENDAGE FOR READ ICB379     */
*      2 DEBASETL PTR(31),          /* ADDRESS OF ABNORMAL-END     0387
*                                      APPENDAGE FOR SETL ICB379     */
*      2 DEBAWRIT PTR(31),          /* ADDRESS OF ABNORMAL-END     0387
*                                      APPENDAGE FOR WRITE ICB379    */
*      2 DEBACHK PTR(31),           /* ADDRESS OF ABNORMAL-END     0387
*                                      APPENDAGE FOR WRITE VALIDITY
*                                      CHECK ICB379                  */
*      2 DEBAREWT PTR(31),          /* ADDRESS OF ABNORMAL-END     0387
*                                      APPENDAGE FOR RE-WRITE ICB379 */
*      2 DEBARECK PTR(31),          /* ADDRESS OF ABNORMAL-END     0387
*                                      APPENDAGE FOR RE-CHECK ICB379 */
*      2 DEBRPSST PTR(31);          /* ADDRESS OF RPS SIO APPENDAGE
*                                      IF ADDRSPC=REAL WAS NOT     0387
*                                      SPECIFIED ICB379              */
*/*  *************************************************************** */
*/*               BISAM MODE EXTENSION                               */
*/*  *************************************************************** */
*                                                                  0388
*   DECLARE                                                        0388
*     1 DEBACS08 BASED(DEBEXPT) BDY(WORD),                         0388
*      2 * PTR(31),                 /* DEBDCBFA - ADDRESS OF DCB   0388
*                                      FIELD AREA MDC015             */
*      2 DEBDISAD PTR(31),          /* ADDRESS OF PRIVILEGED MODULE
*                                      ENTERED WHEN A BISAM MACRO  0388
*                                      INSTRUCTION IS EXECUTED ICB379*/
*      2 * PTR(31),                 /* DEBWKPT4 - SAME AS DCBWKPT4 -
*                                      ADDRESS OF THE PART 1       0388
*                                      APPENDAGE MODULE (ABNORMAL AND
*                                      CHANNEL-END APPANDAGES) ICB379*/
*      2 * PTR(31),                 /* DEBWKPT5 - SAME AS DCBWKPT5 -
*                                      ADDRESS OF THE PART 2       0388
*                                      APPENDAGE MODULE (ABNORMAL AND
*                                      CHANNEL-END APPANDAGES) ICB379*/
*      2 DEBFREED PTR(31),          /* ADDRESS OF DYNAMIC BUFFERING
*                                      MODULE ICB379                 */
*      2 DEBRPSIO PTR(31),          /* ADDRESS OF RPS SIO APPENDAGE
*                                      MODULE IF ADDRSPC=REAL WAS NOT
*                                      SPECIFIED AND IF DYNAMIC    0388
*                                      BUFFERING IS USED ICB379      */
*      2 DEBSIOA2 PTR(31);          /* ADDRESS OF DYNAMIC BUFFERING
*                                      APPENDAGE MODULE DISPLACED BY
*                                      PAGE FIX (PGFX) APPENDAGE IF
*                                      ADDRSPC=REAL WAS NOT SPECIFIED
*                                      ICB379                        */
*/*  *************************************************************** */
*/*               SUBROUTINE NAME SECTION                            */
*/*                                                                  */
*/*      NOTE  FOLLOWS THE ACCESS METHOD DEPENDENT SECTION, OR THE   */
*/*            DEVICE DEPENDENT SECTION IF THERE IS NO ACCESS        */
*/*            METHOD SECTION.                                       */
*/*  *************************************************************** */
*                                                                  0389
*   DECLARE                                                        0389
*     1 DEBSUBNM BASED(DEBSBPTR) BDY(WORD),                        0389
*        4 DEBSUBID CHAR(2);        /* SUBORUTINE IDENTIFICATION.  0389
*                                      EACH ACCESS METHOD SUBROUTINE,
*                                      APPENDAGE SUBROUTINE, AND IRB
*                                      ROUTINE WILL HAVE A UNIQUE  0389
*                                      EIGHT-BYTE NAME. THE LOW-   0389
*                                      ORDER TWO BYTES OF EACH     0389
*                                      ROUTINE NAME WILL BE IN THIS
*                                      FIELD IF THE SUBROUTINE IS  0389
*                                      LOADED BY THE OPEN ROUTINES.  */
*/*  *************************************************************** */
*/*          APPENDAGE VECTOR TABLE SECTION OF THE DEB               */
*/*  *************************************************************** */
*                                                                  0390
*   DECLARE                                                        0390
*     1 DEB BASED(DEBAPPAD) BDY(WORD),                             0390
*      2 DEBAVT BDY(WORD),          /* APPENDAGE VECTOR TABLE        */
*       3 DEBEOEA PTR(31),          /* ADDRESS OF END-OF-EXTENT    0390
*                                      APPENDAGE ROUTINE             */
*        4 DEBEOEAB CHAR(1),        /* FLAG BYTE ICB280              */
*         5 DEBRSV19 BIT(1),        /* RESERVED                      */
*         5 DEBRSV20 BIT(1),        /* RESERVED                      */
*         5 DEBRSV21 BIT(1),        /* RESERVED                      */
*         5 DEBRSV22 BIT(1),        /* RESERVED                      */
*         5 DEBEOENP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED
*                                      FOR THE END-OF-EXTENT       0390
*                                      APPENDAGE ICB280              */
*        4 DEBEOEAD PTR(24),        /* ADDRESS OF END-OF-EXTENT    0390
*                                      APPENDAGE ROUTINE ICB280      */
*       3 DEBSIOA PTR(31),          /* ADDRESS OF START I/O APPENDAGE
*                                      ROUTINE                       */
*        4 DEBSIOAB CHAR(1),        /* FLAG BYTE ICB280              */
*         5 DEBPGFX BIT(1),         /* ADDRESS IN DEBSIOAD CAN BE  0390
*                                      USED TO DETERMINE THE ENTRY 0390
*                                      POINT TO THE PAGE FIX (PGFX)
*                                      APPENDAGE ROUTINE BY ADDING 4
*                                      TO ADDRESS IN DEBSIOAD ICB280 */
*         5 DEBSIOX BIT(1),         /* IF ZERO, DO NOT ENTER SIO   0390
*                                      APPENDAGE WHEN ERP IS ACTIVE.
*                                      IF ONE, ENTER SIO APPENDAGE 0390
*                                      EVEN WHEN ERP IS ACTIVE.    0390
*                                      ICB372                        */
*         5 DEBIOVR BIT(1),         /* IF ONE, EXCPVR REQUEST IS   0390
*                                      VALID. IF ZERO, EXCPVR REQUEST
*                                      IS INVALID AND WILL NOT BE  0390
*                                      EXECUTED. ICB401              */
*         5 DEBFIX BIT(1),          /* INDICATION THAT DEB HAS BEEN
*                                      FIXED (OS/VS2) (MDC032) YM5929*/
*         5 DEBSIONP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED
*                                      FOR THE SIO APPENDAGE ICB280  */
*        4 DEBSIOAD PTR(24),        /* ADDRESS OF START I/O APPENDAGE
*                                      ROUTINE ICB280                */
*       3 DEBPCIA PTR(31),          /* ADDRESS OF PCI APPENDAGE    0390
*                                      ROUTINE                       */
*        4 DEBPCIAB CHAR(1),        /* FLAG BYTE ICB280              */
*         5 DEBRSV24 BIT(1),        /* RESERVED                      */
*         5 DEBRSV25 BIT(1),        /* RESERVED                      */
*         5 DEBRSV26 BIT(1),        /* RESERVED                      */
*         5 DEBRSV27 BIT(1),        /* RESERVED                      */
*         5 DEBPCINP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED
*                                      FOR THE PCI APPENDAGE ROUTINE
*                                      ICB280                        */
*        4 DEBPCIAD PTR(24),        /* ADDRESS OF PROGRAM-         0390
*                                      CONTROLLED-INTERRUPTION (PCI)
*                                      APPENDAGE ROUTINE ICB280      */
*       3 DEBCEA PTR(31),           /* ADDRESS OF CHANNEL-END      0390
*                                      APPENDAGE ROUTINE             */
*        4 DEBCEAB CHAR(1),         /* FLAG BYTE ICB280              */
*         5 DEBRSV28 BIT(1),        /* RESERVED                      */
*         5 DEBRSV29 BIT(1),        /* RESERVED                      */
*         5 DEBRSV30 BIT(1),        /* RESERVED                      */
*         5 DEBRSV31 BIT(1),        /* RESERVED                      */
*         5 DEBCENP BIT(4),         /* NUMBER OF 2K PAGES TO BE FIXED
*                                      FOR THE CHANNEL-END APPENDAGE
*                                      ICB280                        */
*        4 DEBCEAD PTR(24),         /* ADDRESS OF CHANNEL END      0390
*                                      APPENDAGE ROUTINE ICB280      */
*       3 DEBXCEA PTR(31),          /* ADDRESS OF ABNORMAL-END     0390
*                                      APPENDAGE ROUTINE             */
*        4 DEBXCEAB CHAR(1),        /* FLAG BYTE ICB280              */
*         5 DEBRSV32 BIT(1),        /* RESERVED                      */
*         5 DEBRSV33 BIT(1),        /* RESERVED                      */
*         5 DEBRSV34 BIT(1),        /* RESERVED                      */
*         5 DEBRSV35 BIT(1),        /* RESERVED                      */
*         5 DEBXCENP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED
*                                      FOR THE ABNORMAL-END APPENDAGE
*                                      ICB280                        */
*        4 DEBXCEAD PTR(24),        /* ADDRESS OF ABNORMAL-END     0390
*                                      APPENDAGE ROUTINE ICB280      */
*/*  *************************************************************** */
*/*                  DEB PREFIX TABLE                                */
*/*  *************************************************************** */
*                                                                  0390
*      2 DEBPREFX BDY(WORD),        /* DEB PREFIX TABLE              */
*       3 DEBWKARA CHAR(1) BDY(WORD),/* I/O SUPPORT WORK AREA (DIRECT
*                                      ACCESS)                       */
*       3 DEBDSCBA CHAR(7) BDY(WORD,2),/* DSCB ADDRESS (BBCCHHR) USED
*                                      BY I/O SUPPORT (DIRECT ACCESS)*/
*       3 DEBXTNP PTR(31),          /* POINTER TO DEB EXTENSION    0390
*                                      (OS/VS2) MDC008               */
*        4 DEBDCBMK CHAR(4) BDY(WORD),/* DCB MODIFICATION MASK USED
*                                      BY I/O SUPPORT (OS/VS1) MDC009*/
*       3 DEBLNGTH CHAR(1),         /* LENGTH OF DEB IN DOUBLE WORDS */
*       3 DEBAMTYP CHAR(1),         /* ACCESS METHOD TYPE ICB380     */
*       3 DEBTBLOF FIXED(15);       /* OFFSET IN THE DEB TABLE TO THE
*                                      ENTRY FOR THIS DEB ICB380     */
*/*  *************************************************************** */
*/*                  DEB EXTENSION (OS/VS2)                          */
*/*  *************************************************************** */
*                                                                  0391
*   DECLARE                                                        0391
*     1 DEBXTN BASED(DEBXTNP) BDY(WORD),                           0391
*      2 DEBXLNGH FIXED(15),        /* LENGTH OF DEB EXTENSION MDC002*/
*      2 DEBXFLG1 BIT(8),           /* FLAG BYTE (MDC027)      YM1272*/
*       3 DEBXCDCB BIT(1),          /* DEBDCBAD FIELD CONTAINS THE 0391
*                                      ADDRESS OF A COPIED DCB. USED
*                                      BY END-OF-VOLUME, TCLOSE AND
*                                      TASK CLOSE. (MDC028)    YM1272*/
*       3 DEBXTSKC BIT(1),          /* TASK CLOSE IS CLOSING THE   0391
*                                      RELATED DCB. SET BY TASK CLOSE
*                                      AND INTERROGATED BY         0391
*                                      END-OF-VOLUME, FEOV AND TCLOSE
*                                      FOR DEB'S NOT ON THE CURRENT
*                                      TCB DEB CHAIN. (MDC031) YM2869*/
*       3 DEBXDSSI BIT(1),          /* DATA SET SECURITY INDICATOR.
*                                      SET BY OPEN AND CHECKPOINT. 0391
*                                      INTERROGATED BY EOV. (MDC348)
*                                                            @Z40RP9A*/
*       3 DEBXRV43 BIT(1),          /* RESERVED                      */
*       3 DEBXRV44 BIT(1),          /* RESERVED                      */
*       3 DEBXRV45 BIT(1),          /* RESERVED                      */
*       3 DEBXRV46 BIT(1),          /* RESERVED                      */
*       3 DEBXRV47 BIT(1),          /* RESERVED                      */
*      2 DEBXRV48 CHAR(1),          /* RESERVED                      */
*      2 DEBXDSAB PTR(31),          /* POINTER TO DSAB MDC004        */
*      2 DEBXDCBM CHAR(4) BDY(WORD),/* DCB MODIFICATION MASK USED BY
*                                      I/O SUPPORT MDC005            */
*      2 DEBXDBPR PTR(31),          /* POINTER TO DEB MDC006         */
*      2 DEBXDSO1 BIT(8),           /* SAME AS DCBDSORG BYTE 1 MDC020*/
*      2 DEBXDSO2 BIT(8),           /* SAME AS DCBDSORG BYTE 2 MDC021*/
*      2 DEBXMCF1 BIT(8),           /* SAME AS DCBMACRF BYTE 1 MDC022*/
*      2 DEBXMCF2 BIT(8),           /* SAME AS DCBMACRF BYTE 2 MDC023*/
*      2 DEBXXARG PTR(31),          /* ADDRESS OF BDAM READ EXCLUSIVE
*                                      LIST MDC024                   */
*      2 DEBXOPNJ PTR(31),          /* POINTER TO DSAB (SEPARATE FROM
*                                      DEBXDSAB) DYNAMICALLY       0391
*                                      ALLOCATED BY OPEN TYPE=J. THIS
*                                      POINTER WILL EXIST FOR      0391
*                                      NON-AUTHORIZED CALLERS OF OPEN
*                                      TYPE=J FOR A DIRECT ACCESS  0391
*                                      DATA SET WHERE THE DATA SET 0391
*                                      BEING OPENED IS DIFFERENT FROM
*                                      THE DATA SET DESCRIBED BY THE
*                                      DDNAME IN DCB AND THE JFCNWRIT
*                                      BIT IS ON IN THE JFCB. THE  0391
*                                      POINTER WILL BE USED BY CLOSE
*                                      TO DYNAMICALLY UNALLOCATE THE
*                                      DATA SET. (MDC352)    @ZA02193*/
*      2 DEBXRV40 PTR(31);          /* RESERVED                      */
*   DCL                                                            0392
*    (F1PTR,                                                       0392
*     F3PTR,                                                       0392
*     F4PTR) PTR(31);                                              0392
*                                                                  0392
*/*      %INCLUDE SYSLIB(IECSDSL1)                                   */
*                                                                  0393
*   DCL                                                            0393
*     1 IECSDSF1 BASED(F1PTR),      /* FORMAT 1 DSCB - DESCRIBED     */
*      2 * CHAR(140);               /* IN THE FOLLOWING STRUCTURE    */
*   DCL                                                            0394
*     1 IECSDSL1 BASED(ADDR(IECSDSF1)),/* START OF THE FORMAT 1 DSCB */
*      2 DS1DSNAM CHAR(44),         /* DATA SET NAME                 */
*      2 DS1FMTID CHAR(1),          /* FORMAT IDENTIFIER             */
*      2 DS1DSSN CHAR(6),           /* DATA SET SERIAL NUMBER        */
*      2 DS1VOLSQ CHAR(2),          /* VOLUME SEQUENCE NUMBER        */
*      2 DS1CREDT CHAR(3),          /* CREATION DATE                 */
*      2 DS1EXPDT CHAR(3),          /* EXPIRATION DATE               */
*      2 DS1NOEPV CHAR(1),          /* NUMBER OF EXTENTS ON VOLUME   */
*      2 DS1NOBDB CHAR(1),          /* NUMBER OF BYTES USED IN LAST
*                                      DIRECTORY BLOCK               */
*      2 * CHAR(1),                 /* RESERVED                      */
*      2 DS1SYSCD CHAR(13),         /* SYSTEM CODE                   */
*      2 * CHAR(7),                 /* RESERVED                      */
*      2 DS1DSORG CHAR(2),          /* DATA SET ORGANIZATION         */
*      2 DS1RECFM CHAR(1),          /* RECORD FORMAT                 */
*      2 DS1OPTCD CHAR(1),          /* OPTION CODE                   */
*      2 DS1BLKL CHAR(2),           /* BLOCK LENGTH                  */
*      2 DS1LRECL CHAR(2),          /* RECORD LENGTH                 */
*      2 DS1KEYL CHAR(1),           /* KEY LENGTH                    */
*      2 DS1RKP CHAR(2),            /* RELATIVE KEY POSITION         */
*      2 DS1DSIND CHAR(1),          /* DATA SET INDICATORS           */
*      2 DS1SCALO CHAR(4),          /* SECONDARY ALLOCATION          */
*      2 DS1LSTAR CHAR(3),          /* LAST USED TRACK AND LAST BLOCK
*                                      ON TRACK                      */
*      2 DS1TRBAL CHAR(2),          /* BYTES REMAINING ON LAST TRACK
*                                      USED                          */
*      2 * CHAR(2),                 /* RESERVED                      */
*      2 DS1EXT1 CHAR(10),          /* FIRST EXTENT DESCRIPTION FIRST
*                                      BYTE EXTENT TYPE INDICATOR  0394
*                                      SECOND BYTE EXTENT SEQUENCE 0394
*                                      NUMBER THIRD - SIXTH BYTES  0394
*                                      LOWER LIMIT SEVENTH - TENTH 0394
*                                      BYTES UPPER LIMIT             */
*      2 DS1EXT2 CHAR(10),          /* SECOND EXTENT DESCRIPTION     */
*      2 DS1EXT3 CHAR(10),          /* THIRD EXTENT DESCRIPTION      */
*      2 DS1PTRDS CHAR(5),          /* POSSIBLE PTR TO A FORMAT 2 OR
*                                      3 DSCB                        */
*      2 DS1END CHAR(0);            /* END OF THE FORMAT 1 DSCB      */
*   DCL                                                            0395
*     1 IECSDSF3 BASED(F3PTR),      /* FORMAT 3 DSCB - DESCRIBED     */
*      2 * CHAR(140);               /* IN THE FOLLOWING STRUCTURE    */
*   DCL                                                            0396
*     1 IECSDSL3 BASED(ADDR(IECSDSF3)),/* START OF THE FORMAT 3 DSCB */
*      2 * CHAR(4),                 /* KEY IDENTIFIER                */
*      2 DS3EXTNT CHAR(40),         /* FOUR EXTENT DESCRIPTIONS FIRST
*                                      BYTE EXTENT TYPE INDICATOR  0396
*                                      SECOND BYTE EXTENT SEQUENCE 0396
*                                      NUMBER THIRD - SIXTH BYTES  0396
*                                      LOWER LIMIT SEVENTH - TENTH 0396
*                                      BYTES UPPER LIMIT             */
*      2 DS3FMTID CHAR(1),          /* FORMAT IDENTIFIER             */
*      2 DS3ADEXT CHAR(90),         /* NINE ADDITIONAL EXTENT      0396
*                                      DESCRIPTIONS                  */
*      2 DS3PTRDS CHAR(5),          /* RESERVED                      */
*      2 DS3END CHAR(0);            /* END OF THE FORMAT 3 DSCB      */
*   DCL                                                            0397
*     1 IECSDSF4 BASED(F4PTR),      /* FORMAT 4 DSCB - DESCRIBED     */
*      2 * CHAR(96);                /* IN THE FOLLOWING STRUCTURE    */
*   DCL                                                            0398
*     1 IECSDSL4 BASED(ADDR(IECSDSF4)),/* START OF THE FORMAT 4 DSCB */
*      2 DS4IDFMT CHAR(1),          /* FORMAT IDENTIFIER             */
*      2 DS4HPCHR CHAR(5),          /* HIGHEST ADDRESS OF A FORMAT 1
*                                      DSCB                          */
*      2 DS4DSREC CHAR(2),          /* NUMBER OF AVAILABLE DSCB'S    */
*      2 DS4HCCHH CHAR(4),          /* CCHH OF NEXT AVAILABLE      0398
*                                      ALTERNATE TRACK               */
*      2 DS4NOATK CHAR(2),          /* NUMBER OF REMAINING ALTERNATE
*                                      TRACKS                        */
*      2 DS4VTOCI CHAR(1),          /* VTOC INDICATORS               */
*      2 DS4NOEXT CHAR(1),          /* NUMBER OF EXTENTS IN VTOC     */
*      2 * CHAR(2),                 /* RESERVED                      */
*      2 DS4DEVCT CHAR(14),         /* DEVICE CONSTANTS              */
*       3 DS4DEVSZ CHAR(4),         /* DEVICE SIZE                   */
*       3 DS4DEVTK CHAR(2),         /* DEVICE TRACK LENGTH           */
*       3 DS4DEVOV CHAR(2),         /* KEYED RECORD OVERHEAD         */
*        4 DS4DEVI CHAR(1),         /* - NON-LAST KEYED RECORD     0398
*                                      OVERHEAD                      */
*        4 DS4DEVL CHAR(1),         /* - LAST KEYED RECORD OVERHEAD  */
*       3 DS4DEVK CHAR(1),          /* NON-KEYED RECORD OVERHEAD   0398
*                                      DIFFERENTIAL                  */
*       3 DS4DEVFG CHAR(1),         /* FLAG BYTE                     */
*       3 DS4DEVTL CHAR(2),         /* DEVICE TOLERANCE              */
*       3 DS4DEVDT CHAR(1),         /* NUMBER OF DSCB'S PER TRACK    */
*       3 DS4DEVDB CHAR(1),         /* NUMBER OF DIRECTORY BLOCKS PER
*                                      TRACK                         */
*      2 DS4AMTIM CHAR(8),          /* VSAM TIME STAMP               */
*      2 DS4AMCAT CHAR(3),          /* VSAM CATALOG INDICATOR        */
*       3 DS4VSIND BIT(8),          /* VSAM INDICATORS               */
*        4 DS4VSREF BIT(1),         /* A VSAM CATALOG REFERENCES THIS
*                                      VOLUME                        */
*        4 DS4VSBAD BIT(1),         /* VSAM DATA SETS ON VOLUME ARE
*                                      UNUSABLE                      */
*        4 * BIT(6),                /* RESERVED                      */
*       3 DS4VSCRA PTR(16) BDY(BYTE),/* RELATIVE TRACK LOCATION OF 0398
*                                      THE CRA                       */
*      2 DS4R2TIM CHAR(8),          /* VSAM VOLUME/CATALOG MATCH TIME
*                                      STAMP                         */
*      2 * CHAR(5),                 /* RESERVED                      */
*      2 DS4F6PTR CHAR(5),          /* POINTER TO FIRST FORMAT 6 DSCB*/
*      2 DS4VTOCE CHAR(10),         /* VTOC EXTENT DESCRIPTION       */
*      2 * CHAR(25),                /* RESERVED                      */
*      2 DS4END CHAR(0);            /* END OF THE FORMAT 4 DSCB      */
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* INPUT PARAMETERS PASSED TO IDCRDDS                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   DCL                                                            0399
*                                                                  0399
*     /***************************************************************/
*     /*                                                             */
*     /* 'INPUT' OR 'OUTPUT' PROCESSING KEYWORD                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0399
*     IOPARM CHAR(1),                                              0399
*                                                                  0399
*     /***************************************************************/
*     /*                                                             */
*     /* ENDING ADDRESS (CCHHR) OF RANGE PASSED BY IDCRD05           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0399
*     TOCHRVAL CHAR(5);                                            0399
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* IDCRDDS DYNAMIC STORAGE AREAS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   DCL                                                            0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* STORAGE SIZE OF I/O BUFFER REQUESTED                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     REQBYTES FIXED(31),                                          0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* POINTER TO BUFFER POOL STORAGE ADDRESS                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     REQADDR PTR(31),                                             0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* POINTER TO DEVTYPE SVC RETURN AREA                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     DEVAREAP PTR(31),                                            0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* POINTER TO DDNAME                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     DEVDD PTR(31),                                               0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* POINTER TO UIOINFO RETURN AREA                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     INFOPTR PTR(31),                                             0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* POINTER TO USYSINFO RETURN AREA                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     SINFPTR PTR(31),                                             0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* POINTER TO THE UCB IN USYSINFO RETURN AREA                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     SINFAREA PTR(31) BASED(SINFPTR),                             0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* WTOR ECB                                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     WTORECB CHAR(4) BDY(WORD),                                   0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* WORKING POINTER TO XTNTTBL                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     XTNTPTR PTR(31),                                             0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* WORKING POINTER TO XTNTTBL2                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     XTNTPTR2 PTR(31),                                            0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* WTOR REPLY AREA                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     WTOREPLY CHAR(1),                                            0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* UIOINFO OPTION BYTE                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     INFOBYT CHAR(1),                                             0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* EXTENT TABLE ENTRY SAVE AREA                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     XTNTHOLD CHAR(LENGTH(XTNTENT)),                              0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT 1 ADDRESS (CCHHR) SAVE AREA                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     FMT1ADDR CHAR(5),                                            0400
*                                                                  0400
*     /***************************************************************/
*     /*                                                             */
*     /* DDNAME SAVE AREA                                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0400
*     INFODD CHAR(8);                                              0400
*                                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* WTOR LIST FORM AND CAMLST NOTE THAT ADDRESSES IN CAMLST ARE   */
*   /* PLACE HOLDERS ONLY ONLY AND WILL BE FILLED IN LATER           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   GEN DATA;                                                      0401
*                                                                  0401
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES OF AREAS GENED FOR WTOR AND OBTAIN SVC'S             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   DCL                                                            0402
*     LWTORLST GEND CHAR(LENGTH(WTORLIST));                        0402
*   DCL                                                            0403
*     CAMLIST GEND CHAR(16);                                       0403
*                                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* OVERLAY STRUCTURES FOR WTORLIST AND CAMLST                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0404
*   DCL                                                            0404
*     WTORLIST CHAR(84) BDY(WORD);                                 0404
*   DCL                                                            0405
*     1 CAM1 BDY(WORD),                                            0405
*      2 * CHAR(4),                                                0405
*      2 CAMDSN FIXED(31),                                         0405
*      2 CAMVOL FIXED(31),                                         0405
*      2 CAMWA FIXED(31);                                          0405
*                                                                  0405
*   /*****************************************************************/
*   /*                                                               */
*   /* OBTAIN WORK AREA                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0406
*   DCL                                                            0406
*     OBTAINWA CHAR(148) BDY(DWORD);                               0406
*                                                                  0406
*   /*****************************************************************/
*   /*                                                               */
*   /* IDCRDDS CONSTANTS                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   DCL                                                            0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* QNAME FOR URESERVE                                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     SYSVTOC CHAR(8) CONSTANT('SYSVTOC '),                        0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* FIXED BLOCK STANDARD RECORD FORMAT                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     FBS BIT(8) CONSTANT('88'X),                                  0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* FBS INDICATOR FOR REPAIR WORKFILE                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     FXBLKSTD CHAR(1) CONSTANT('F'),                              0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* VTOCHEADER DSNAME                                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     VHDRDSN CHAR(LENGTH(RWFHDSNU)) INIT('VTOCHEADER'),           0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* VTOC DSNAME                                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     FMT4DSCB CHAR(LENGTH(RWFHDSNU)) INIT('FORMAT4.DSCB'),        0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* UGPOOL/UFPOOL STORAGE ID                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     RD01 CHAR(4) CONSTANT('RD01'),                               0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* INPUT PARAMETER PASSED TO IDCRDDS BY IDCRD05                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     INPUT CHAR(1) CONSTANT('I'),                                 0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* OUTPUT PARAMETER PASSED TO IDCRDDS BY IDCRD05               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     OUTPUT CHAR(1) CONSTANT('O'),                                0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* OPERATOR REPLY OF 'Y' (YES)                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     Y CHAR(1) CONSTANT('Y'),                                     0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* OPERATOR REPLY OF 'N' (NO)                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     N CHAR(1) CONSTANT('N'),                                     0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* VSAM FORMAT INDICATOR                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     VSAMFMT BIT(8) CONSTANT('08'X),                              0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* VTOC RECORD LENGTH                                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     VTOCRECL FIXED(31) CONSTANT(96),                             0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* VTOC KEY LENGTH                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     VTOCKEYL FIXED(31) CONSTANT(44),                             0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT1 DSCB IDENTIFIER                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     FMT1ID BIT(8) CONSTANT('F1'X),                               0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT3 DSCB IDENTIFIER                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     FMT3ID BIT(8) CONSTANT('F3'X),                               0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* MODIFY ENQ INDICATOR                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     MODENQ BIT(8) CONSTANT('80'X),                               0407
*                                                                  0407
*     /***************************************************************/
*     /*                                                             */
*     /* REPAIRV OPEN KEYWORD PASSED TO UEXCP                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0407
*     OPENR CHAR(8) CONSTANT('OPENR   ');                          0407
*                                                                  0407
*   /*****************************************************************/
*   /*                                                               */
*   /* FIELDS OF ZEROS                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*   DCL                                                            0408
*     ZERO FIXED(15) CONSTANT(0);   /*                       @ZA17169*/
*   DCL                                                            0409
*     1 ZEROS STATIC LOCAL,                                        0409
*      2 *(8) BIT(8) INIT((8)'00'X);                               0409
*                                                                  0409
*   /*****************************************************************/
*   /*                                                               */
*   /* LAST XTNTTBL ENTRY INDICATOR                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*   DCL                                                            0410
*     1 LASTENT STATIC LOCAL,                                      0410
*      2 *(LENGTH(XTNTENT)) CHAR(1) INIT((LENGTH(XTNTENT))'FF'X);  0410
*                                                                  0410
*   /*****************************************************************/
*   /*                                                               */
*   /* IDCRDRD RETURN CODES                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   DCL                                                            0411
*                                                                  0411
*     /***************************************************************/
*     /*                                                             */
*     /* NORMAL RETURN                                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0411
*     RC01 FIXED(31) CONSTANT(1),                                  0411
*                                                                  0411
*     /***************************************************************/
*     /*                                                             */
*     /* END-OF-FILE                                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0411
*     RC29 FIXED(31) CONSTANT(29),                                 0411
*                                                                  0411
*     /***************************************************************/
*     /*                                                             */
*     /* END-OF-TRACK                                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0411
*     RC30 FIXED(31) CONSTANT(31);                                 0411
*                                                                  0411
*   /*****************************************************************/
*   /*                                                               */
*   /* MESSAGE INDICES USED BY IDCRDER TO INDEX TO THE REQUESTED     */
*   /* MESSAGE                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   DCL                                                            0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31203I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG03 FIXED(8) CONSTANT(3),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31204I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG04 FIXED(8) CONSTANT(4),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31205I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG05 FIXED(8) CONSTANT(5),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31206I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG06 FIXED(8) CONSTANT(6),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31207I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG07 FIXED(8) CONSTANT(7),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31208I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG08 FIXED(8) CONSTANT(8),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31209I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG09 FIXED(8) CONSTANT(9),                                  0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31210I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG10 FIXED(8) CONSTANT(10),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31211I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG11 FIXED(8) CONSTANT(11),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31212I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG12 FIXED(8) CONSTANT(12),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31221I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG21 FIXED(8) CONSTANT(21),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31223I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG23 FIXED(8) CONSTANT(23),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31233I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG33 FIXED(8) CONSTANT(33),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31234I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG34 FIXED(8) CONSTANT(34),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31235I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG35 FIXED(8) CONSTANT(35),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31239I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG39 FIXED(8) CONSTANT(39),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31240I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG40 FIXED(8) CONSTANT(40),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* ERROR MESSAGE IDC31246I                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG46 FIXED(8) CONSTANT(46),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* WTOR MESSAGE IDC498D - ACCESS TO STAGING PACK               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG77 FIXED(8) CONSTANT(77),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* WTOR MESSAGE IDC498D - ACCESS TO VTOCHEADER                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG78 FIXED(8) CONSTANT(78),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* WTOR MESSAGE IDC498D - ACCESS TO VTOC                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG79 FIXED(8) CONSTANT(79),                                 0412
*                                                                  0412
*     /***************************************************************/
*     /*                                                             */
*     /* UNIVERSAL TEXT MESSAGE IDC3004I                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0412
*     MSG93 FIXED(8) CONSTANT(93);                                 0412
*                                                                  0412
*   /*****************************************************************/
*   /*                                                               */
*   /* WTOR REQUIRED AREAS AND CONSTANTS                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0413
*   DCL                                                            0413
*     DARGL CHAR(LENGTH(DARGLIST)) BDY(WORD);                      0413
*   DCL                                                            0414
*     WTORID CHAR(3) CONSTANT('RD0');                              0414
*                                                                  0414
*   /*****************************************************************/
*   /*                                                               */
*   /* VTOC DATA SET NAME                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0415
*   DCL                                                            0415
*     1 FMT4DSN STATIC LOCAL,                                      0415
*      2 *(LENGTH(XTNHDSN)) CHAR(1) INIT((LENGTH(XTNHDSN))'04'X);  0415
*                                                                  0415
*   /*****************************************************************/
*   /*                                                               */
*   /* BLANK DSNAME                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   DCL                                                            0416
*     1 BLANKS STATIC LOCAL,                                       0416
*      2 *(LENGTH(XTNHDSN)) CHAR(1) INIT((LENGTH(XTNHDSN))'40'X);  0416
*                                                                  0416
*   /*****************************************************************/
*   /*                                                               */
*   /* UIOINFO RETURN AREA SCAN STRUCTURE                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0417
*   DCL                                                            0417
*     1 INFOSCAN BASED,                                            0417
*      2 INFSCNID CHAR(2),                                         0417
*      2 INFSCNLN FIXED(16),                                       0417
*      2 INFSCNAR CHAR(*);                                         0417
*                                                                  0417
*   /*****************************************************************/
*   /*                                                               */
*   /* UIOINFO RETURN AREA POINTERS                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0418
*   DCL                                                            0418
*                                                                  0418
*     /***************************************************************/
*     /*                                                             */
*     /* UIOINFO RETURN AREA SCAN POINTER                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0418
*     INFSCNPT PTR(31),                                            0418
*                                                                  0418
*     /***************************************************************/
*     /*                                                             */
*     /* DATA SET NAME POINTER                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0418
*     INFDSNPT PTR(31),                                            0418
*                                                                  0418
*     /***************************************************************/
*     /*                                                             */
*     /* VOLUME SERIAL LIST POINTER.                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0418
*     INFVOLPT PTR(31);                                            0418
*                                                                  0418
*   /*****************************************************************/
*   /*                                                               */
*   /* VOLUME SERIAL LIST IDENTIFIER                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0419
*   DCL                                                            0419
*     VOLIDENT FIXED(16) CONSTANT(2);                              0419
*                                                                  0419
*   /*****************************************************************/
*   /*                                                               */
*   /* DATA SET NAME IDENTIFIER                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0420
*   DCL                                                            0420
*     DSNIDENT FIXED(16) CONSTANT(1);                              0420
*                                                                  0420
*   /*****************************************************************/
*   /*                                                               */
*   /* PARAMETER CONSTANTS                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*   DCL                                                            0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* OBTAIN PARAMTER                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     OBTAIN CHAR(8) CONSTANT('OBTAIN  '),                         0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* DATASETRANGE PARAMETER                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     DSRANGE CHAR(17) CONSTANT('DATASETRANGE     '),              0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* INDATASETADDRESS PARAMETER                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     INDSADD CHAR(17) CONSTANT('INDATASETADDRESS '),              0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* OUTDATASETADDRESS PARAMETER                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     OUTDSADD CHAR(17) CONSTANT('OUTDATASETADDRESS'),             0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* VTOCHEADERADDRESS PARAMETER                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     VHDRADD CHAR(17) CONSTANT('VTOCHEADERADDRESS'),              0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* STAGINGRANGE PARAMETER                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     SRRANGE CHAR(17) CONSTANT('STAGINGRANGE     '),              0421
*                                                                  0421
*     /***************************************************************/
*     /*                                                             */
*     /* PARAMETER HOLD AREA FOR MESSAGE                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0421
*     PARMHOLD CHAR(17);                                           0421
*                                                                  0421
*   /*****************************************************************/
*   /*                                                               */
*   /* VTOC ADDRESS STRUCTURE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*   DCL                                                            0422
*     1 VTOCADDR,                                                  0422
*      2 VTOCCC FIXED(15),                                         0422
*      2 VTOCHH FIXED(15),                                         0422
*      2 VTOCR FIXED(8);                                           0422
*                                                                  0422
*   /*****************************************************************/
*   /*                                                               */
*   /* DCSB STRUCTURE                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   DCL                                                            0423
*     1 DSCBAREA BASED(IOCDAD),                                    0423
*      2 * CHAR(44),                                               0423
*      2 DSCBID FIXED(8);                                          0423
*                                                                  0424
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY POINT FOR PROCEDURE IDCRDDS                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0424
*   GEN(ENTRY IDCRDDS);                                            0424
         ENTRY IDCRDDS
*   GEN(L REG6,SPLITSV1);                                          0425
         L REG6,SPLITSV1
*   LM(REG9,REG12,SPLITSAV);                                       0426
*                                                                  0426
         LM    REG9,REG12,SPLITSAV                                 0426
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE AND DUMP POINTS                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   IF GDTDBG=NULLPTR THEN                                         0427
         L     @04,@PC00001                                        0427
         L     @04,GDTDBG(,@04)                                    0427
         LTR   @04,@04                                             0427
         BZ    @RT00427                                            0427
*     ;                                                            0428
*   ELSE                                                           0429
*     CALL IDCDB010(GDTTBL,'RD6H');                                0429
         L     @04,@PC00001                                        0429
         ST    @04,@AL00001                                        0429
         LA    @15,@CC02856                                        0429
         ST    @15,@AL00001+4                                      0429
         MVI   @AL00001+4,X'80'                                    0429
         L     @15,GDTDBG(,@04)                                    0429
         LA    @01,@AL00001                                        0429
         BALR  @14,@15                                             0429
*   OLDERID2=NEWERID2;                                             0430
@RT00427 L     @04,@PC00001                                        0430
         L     @04,GDTTR2(,@04)                                    0430
         MVC   @TS00001(95),NEWERID2(@04)                          0430
         MVC   OLDERID2(95,@04),@TS00001                           0430
*   NEWID2='RD6I';                                                 0431
*                                                                  0431
         MVC   NEWID2(4,@04),@CC02857                              0431
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP ADDRESSABILITY FOR REFERENCED STRUCTURES                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0432
*   RESPECIFY                                                      0432
*     IOINFOPT BASED(ADDR(INFOBYT));                               0432
*   RESPECIFY                                                      0433
*     INFOAREA BASED(INFOPTR);                                     0433
*   RESPECIFY                                                      0434
*     XTNTTBL BASED(XTNTPTR);                                      0434
*   RESPECIFY                                                      0435
*     XTNTTBL2 BASED(XTNTPTR2);                                    0435
*   RESPECIFY                                                      0436
*     EXOARG BASED(REPEXOAR);                                      0436
*                                                                  0437
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A VTOCHEADER                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0437
*   IF ADDR(DPVTC)^=NULLPTRADDR(CVTOC)^=NULLPTRADDR(MVTOC)^=NULLPTR
*     THEN                                                         0437
         SLR   @04,@04                                             0437
         L     @15,@PC00001+4                                      0437
         C     @04,FDTPTR+116(,@15)                                0437
         BNE   @RT00437                                            0437
         C     @04,FDTPTR+204(,@15)                                0437
         BNE   @RT00437                                            0437
         C     @04,FDTPTR+424(,@15)                                0437
         BE    @RF00437                                            0437
@RT00437 DS    0H                                                  0438
*DSVHDR:                                                           0438
*     DO;                                                          0438
*                                                                  0438
DSVHDR   DS    0H                                                  0439
*       /*************************************************************/
*       /*                                                           */
*       /* FOR MODIFY VALIDATE THE CCHHR LENGTH                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0439
*       IF ADDR(MVTOC)^=NULLPTR THEN                               0439
         SLR   @15,@15                                             0439
         L     @14,@PC00001+4                                      0439
         C     @15,FDTPTR+424(,@14)                                0439
         BE    @RF00439                                            0439
*         DO;                                                      0440
*                                                                  0440
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE VTOCHEADERADDRESS PARAMETER MUST BE */
*           /* 5 BYTES. IF NOT, PREPARE TO RETURN TO IDCRD05 WITH RC */
*           /* = 12                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0441
*           IF ADDR(MVTCR)^=NULLPTR&MVTCRLEN^=LENGTH(MVTCRVAL) THEN
         L     @14,FDTPTR+432(,@14)                                0441
         CR    @14,@15                                             0441
         BE    @RF00441                                            0441
         CLI   MVTCRLEN(@14),5                                     0441
         BE    @RF00441                                            0441
*             DO;                                                  0442
*                                                                  0442
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31233I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0443
*               DO;                                                0443
*                 CKREQ=CKREQ&&CKREQ;                              0444
         L     @15,@PC00001+8                                      0444
         XC    CKREQ(44,@15),CKREQ(@15)                            0444
*                 CKRERN=MSG33;                                    0445
         MVC   CKRERN(2,@15),@CH02800                              0445
*                 CKRMVAR(1)=ADDR(VHDRADD);                        0446
         LA    @05,@CC02842                                        0446
         ST    @05,CKRMVAR(,@15)                                   0446
*                 CKRMVAR(2)=ADDR(MVTCRVAL);                       0447
         LA    @05,MVTCRVAL(,@14)                                  0447
         ST    @05,CKRMVAR+4(,@15)                                 0447
*                 CKRMVAR(3)=ADDR(VHDRDSN);                        0448
         LA    @05,VHDRDSN                                         0448
         ST    @05,CKRMVAR+8(,@15)                                 0448
*                 CKRMVAR(4)=ADDR(MVTCRLEN);                       0449
         ST    @14,CKRMVAR+12(,@15)                                0449
*                 CALL IDCRDER;                                    0450
         L     @15,@CV01553                                        0450
         BALR  @14,@15                                             0450
*               END;                                               0451
*                                                                  0451
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO IDCRD05 WITH RC = 12                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0452
*               RETURN CODE(LASTCC12);                             0452
         LA    @15,12                                              0452
         L     @14,@SA00002                                        0452
         LM    @00,@12,@SA00002+8                                  0452
         BR    @14                                                 0452
*             END;                                                 0453
*         END;                                                     0454
*                                                                  0454
@RF00441 DS    0H                                                  0455
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE COMMON FIELDS AND POINTERS                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0455
*       IF ADDR(DISPL)^=NULLPTR THEN                               0455
@RF00439 L     @15,@PC00001+4                                      0455
         L     @14,FDTPTR(,@15)                                    0455
         LTR   @14,@14                                             0455
         BZ    @RF00455                                            0455
*         DO;                                                      0456
*           INFODD=INFILVAL;                                       0457
         L     @04,FDTPTR+12(,@15)                                 0457
         MVC   INFODD(8),INFILVAL(@04)                             0457
*           INFOPTR=REPIINFO;                                      0458
         L     @04,@PC00001+8                                      0458
         L     @15,REPIINFO(,@04)                                  0458
         ST    @15,INFOPTR                                         0458
*           XTNTPTR=REPIXTNT;                                      0459
         L     XTNTPTR,REPIXTNT(,@04)                              0459
*         END;                                                     0460
*       ELSE                                                       0461
*         IF ADDR(COPY)^=NULLPTR THEN                              0461
         B     @RC00455                                            0461
@RF00455 L     @15,@PC00001+4                                      0461
         L     @14,FDTPTR+136(,@15)                                0461
         LTR   @14,@14                                             0461
         BZ    @RF00461                                            0461
*           DO;                                                    0462
*             INFODD=CINFLVAL;                                     0463
         L     @04,FDTPTR+140(,@15)                                0463
         MVC   INFODD(8),CINFLVAL(@04)                             0463
*             INFOPTR=REPIINFO;                                    0464
         L     @04,@PC00001+8                                      0464
         L     @15,REPIINFO(,@04)                                  0464
         ST    @15,INFOPTR                                         0464
*             XTNTPTR=REPIXTNT;                                    0465
         L     XTNTPTR,REPIXTNT(,@04)                              0465
*           END;                                                   0466
*         ELSE                                                     0467
*           DO;                                                    0467
         B     @RC00461                                            0467
@RF00461 DS    0H                                                  0468
*             INFODD=MOUTFVAL;                                     0468
         L     @04,@PC00001+4                                      0468
         L     @04,FDTPTR+412(,@04)                                0468
         MVC   INFODD(8),MOUTFVAL(@04)                             0468
*             INFOPTR=REPOINFO;                                    0469
         L     @04,@PC00001+8                                      0469
         L     @15,REPOINFO(,@04)                                  0469
         ST    @15,INFOPTR                                         0469
*             XTNTPTR=REPOXTNT;                                    0470
         L     XTNTPTR,REPOXTNT(,@04)                              0470
*           END;                                                   0471
*                                                                  0471
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT UIOINFO OPTION BYTE                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0472
*       IOINFOPT=''B;                                              0472
@RC00461 DS    0H                                                  0472
@RC00455 LA    @04,INFOBYT                                         0472
         MVI   IOINFOPT(@04),X'00'                                 0472
*       IOINFVOL=ON;                                               0473
*                                                                  0473
         OI    IOINFVOL(@04),B'01000000'                           0473
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UIOINFO FOR A LIST OF VOLUME SERIAL NUMBERS.        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0474
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,INFODD);             0474
*                                                                  0474
         L     @15,@PC00001                                        0474
         ST    @15,@AL00001                                        0474
         ST    @04,@AL00001+4                                      0474
         LA    @04,INFOPTR                                         0474
         ST    @04,@AL00001+8                                      0474
         LA    @04,INFODD                                          0474
         ST    @04,@AL00001+12                                     0474
         MVI   @AL00001+12,X'80'                                   0474
         L     @15,GDTIFO(,@15)                                    0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UIOINFO                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0475
*       RESPECIFY                                                  0475
*         RTNREG RSTD;                                             0475
*       TESTRC=RTNREG;                                             0476
         STH   RTNREG,TESTRC                                       0476
*       RESPECIFY                                                  0477
*         RTNREG UNRSTD;                                           0477
*                                                                  0477
*       /*************************************************************/
*       /*                                                           */
*       /* IF UIOINFO FAILS, RETURN TO CALLER WITH RC = 12           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0478
*       IF TESTRC^=0 THEN                                          0478
         LH    @04,TESTRC                                          0478
         LTR   @04,@04                                             0478
         BZ    @RF00478                                            0478
*         RETURN CODE(LASTCC12);                                   0479
*                                                                  0479
         LA    @15,12                                              0479
         L     @14,@SA00002                                        0479
         LM    @00,@12,@SA00002+8                                  0479
         BR    @14                                                 0479
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP UIOINFO RETURN AREA ADDRESSABILITY                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0480
*       RESPECIFY                                                  0480
*         INFOSCAN BASED(INFSCNPT);                                0480
@RF00478 DS    0H                                                  0481
*       INFSCNPT=ADDR(INFAREA);                                    0481
*                                                                  0481
         L     INFSCNPT,INFOPTR                                    0481
         LA    INFSCNPT,INFAREA(,INFSCNPT)                         0481
*       /*************************************************************/
*       /*                                                           */
*       /* LOCATE VOLUME SERIAL LIST INFORMATION RETURNED BY UIOINFO */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0482
*       IF INFSCNID=VOLIDENT THEN                                  0482
         CLC   INFSCNID(2,INFSCNPT),@CH00156                       0482
         BNE   @RF00482                                            0482
*         DO;                                                      0483
*           INFVOLPT=INFSCNPT;                                     0484
         ST    INFSCNPT,INFVOLPT                                   0484
*           RESPECIFY                                              0485
*             INFOVOL BASED(INFVOLPT);                             0485
*         END;                                                     0486
*       ELSE                                                       0487
*                                                                  0487
*         /***********************************************************/
*         /*                                                         */
*         /* VOLSER LIST CANNOT BE FOUND RETURN TO THE CALLER WITH RC*/
*         /* = 12                                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0487
*         RETURN CODE(LASTCC12);                                   0487
*                                                                  0487
         B     @RC00482                                            0487
@RF00482 LA    @15,12                                              0487
         L     @14,@SA00002                                        0487
         LM    @00,@12,@SA00002+8                                  0487
         BR    @14                                                 0487
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP DEVTYPE RETURN AREA ADDRESSABILITY                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0488
*       IF ADDR(MODIF)^=NULLPTR THEN                               0488
@RC00482 L     @04,@PC00001+4                                      0488
         L     @04,FDTPTR+356(,@04)                                0488
         LTR   @04,@04                                             0488
         BZ    @RF00488                                            0488
*         DEVAREAP=REPODEVA;                                       0489
         L     @04,@PC00001+8                                      0489
         L     @04,REPODEVA(,@04)                                  0489
         ST    @04,DEVAREAP                                        0489
*       ELSE                                                       0490
*         DEVAREAP=REPIDEVA;                                       0490
         B     @RC00488                                            0490
@RF00488 L     @04,@PC00001+8                                      0490
         L     @04,REPIDEVA(,@04)                                  0490
         ST    @04,DEVAREAP                                        0490
*       RESPECIFY                                                  0491
*         DEVAREA BASED(DEVAREAP);                                 0491
*                                                                  0491
@RC00488 DS    0H                                                  0492
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE DEVTYPE TO OBTAIN DEVICE CHARACTERISTICS            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0492
*       RESPECIFY                                                  0492
*        (REG3,                                                    0492
*         REG4) RESTRICTED;                                        0492
*       REG3=ADDR(INFODD);                                         0493
         LA    REG3,INFODD                                         0493
*       REG4=DEVAREAP;                                             0494
         L     REG4,DEVAREAP                                       0494
*LDEVTYP1:                                                         0495
*       GEN;                                                       0495
LDEVTYP1 DS    0H                                                  0495
         DEVTYPE (3),(4),DEVTAB
*       RESPECIFY                                                  0496
*        (REG3,                                                    0496
*         REG4) UNRESTRICTED;                                      0496
*                                                                  0496
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM DEVTYPE                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0497
*       RESPECIFY                                                  0497
*         RTNREG RSTD;                                             0497
*       TESTRC=RTNREG;                                             0498
         STH   RTNREG,TESTRC                                       0498
*       RESPECIFY                                                  0499
*         RTNREG UNRSTD;                                           0499
*                                                                  0499
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVTYPE FAILS, RETURN TO THE CALLER WITH RC = 12       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0500
*       IF TESTRC^=0 THEN                                          0500
         LH    @04,TESTRC                                          0500
         LTR   @04,@04                                             0500
         BZ    @RF00500                                            0500
*         RETURN CODE(LASTCC12);                                   0501
*                                                                  0501
         LA    @15,12                                              0501
         L     @14,@SA00002                                        0501
         LM    @00,@12,@SA00002+8                                  0501
         BR    @14                                                 0501
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT EXTENT TABLE HEADER FOR VTOCHEADER KEYWORD      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0502
*       XTNHDDN=INFODD;                                            0502
@RF00500 MVC   XTNHDDN(8,XTNTPTR),INFODD                           0502
*       XTNHDSN=FMT4DSN;                                           0503
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         0503
*       XTNHVOL=INFVOL(1);                                         0504
         L     @04,INFVOLPT                                        0504
         MVC   XTNHVOL(6,XTNTPTR),INFVOL(@04)                      0504
*       XTNHVOLN=1;                                                0505
*                                                                  0505
         MVI   XTNHVOLN(XTNTPTR),X'01'                             0505
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERIAL NUMBER FROM UIOINFO DOES NOT MATCH VOLUME*/
*       /* SERIAL NUMBER IN VTOCHEADER PARAMETER, PREPARE TO RETURN  */
*       /* TO THE CALLER WITH RC = 12                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0506
*       IF(ADDR(DISPL)^=NULLPTR&DVTCSVAL(1:6)^=XTNHVOL)(ADDR(COPY)^=
*           NULLPTR&CVTCSVAL(1:6)^=XTNHVOL)(ADDR(MODIF)^=NULLPTR& 0506
*           MVTCSVAL(1:6)^=XTNHVOL) THEN                           0506
         L     @04,@PC00001+4                                      0506
         L     @15,FDTPTR(,@04)                                    0506
         LTR   @15,@15                                             0506
         BZ    @GL00005                                            0506
         L     @04,FDTPTR+120(,@04)                                0506
         CLC   DVTCSVAL(6,@04),XTNHVOL(XTNTPTR)                    0506
         BNE   @RT00506                                            0506
@GL00005 L     @04,@PC00001+4                                      0506
         L     @15,FDTPTR+136(,@04)                                0506
         LTR   @15,@15                                             0506
         BZ    @GL00004                                            0506
         L     @04,FDTPTR+208(,@04)                                0506
         CLC   CVTCSVAL(6,@04),XTNHVOL(XTNTPTR)                    0506
         BNE   @RT00506                                            0506
@GL00004 L     @04,@PC00001+4                                      0506
         L     @15,FDTPTR+356(,@04)                                0506
         LTR   @15,@15                                             0506
         BZ    @RF00506                                            0506
         L     @04,FDTPTR+428(,@04)                                0506
         CLC   MVTCSVAL(6,@04),XTNHVOL(XTNTPTR)                    0506
         BE    @RF00506                                            0506
@RT00506 DS    0H                                                  0507
*         DO;                                                      0507
*                                                                  0507
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31210I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0508
*           DO;                                                    0508
*             CKREQ=CKREQ&&CKREQ;                                  0509
         L     @04,@PC00001+8                                      0509
         XC    CKREQ(44,@04),CKREQ(@04)                            0509
*             CKRERN=MSG10;                                        0510
         MVC   CKRERN(2,@04),@CH00037                              0510
*             CKRMVAR(1)=ADDR(XTNHVOL);                            0511
         LA    @15,XTNHVOL(,XTNTPTR)                               0511
         ST    @15,CKRMVAR(,@04)                                   0511
*             CKRMVAR(2)=ADDR(VHDRADD);                            0512
         LA    @15,@CC02842                                        0512
         ST    @15,CKRMVAR+4(,@04)                                 0512
*             CKRMVAR(3)=ADDR(XTNHDDN);                            0513
         ST    XTNTPTR,CKRMVAR+8(,@04)                             0513
*             CALL IDCRDER;                                        0514
         L     @15,@CV01553                                        0514
         BALR  @14,@15                                             0514
*           END;                                                   0515
*                                                                  0515
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0516
*           RETURN CODE(LASTCC12);                                 0516
         LA    @15,12                                              0516
         L     @14,@SA00002                                        0516
         LM    @00,@12,@SA00002+8                                  0516
         BR    @14                                                 0516
*         END;                                                     0517
*       IF ADDR(MODIF)^=NULLPTR THEN                               0518
@RF00506 L     @04,@PC00001+4                                      0518
         L     @04,FDTPTR+356(,@04)                                0518
         LTR   @04,@04                                             0518
         BZ    @RF00518                                            0518
*         DO;                                                      0519
*           SINFPTR=REPOSYSI;                                      0520
*                                                                  0520
         L     @04,@PC00001+8                                      0520
         L     @04,REPOSYSI(,@04)                                  0520
         ST    @04,SINFPTR                                         0520
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE WTOR LIST FORM                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0521
*           WTORLIST=LWTORLST;                                     0521
*                                                                  0521
         MVC   WTORLIST(84),LWTORLST                               0521
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP DARGLIST TO LOAD IDC498D MESSAGE IF REQUEST IS  */
*           /* FOR MODIFY                                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0522
*           DARGL=''B;                                             0522
         XC    DARGL(20),DARGL                                     0522
*           DDSTRU=ADDR(DARGL);                                    0523
         LA    @04,DARGL                                           0523
         ST    @04,DDSTRU                                          0523
*           DARGRETP=ADDR(WTORLIST)+12;                            0524
         LA    @15,WTORLIST                                        0524
         AL    @15,@CF00039                                        0524
         ST    @15,DARGRETP(,@04)                                  0524
*           DARGSENT=MSG78;                                        0525
         MVI   DARGSENT(@04),X'4E'                                 0525
*           DARGSMOD=WTORID;                                       0526
         MVC   DARGSMOD(3,@04),@CC02814                            0526
*           DARGRETL=LENGTH(WTORLIST)-12;                          0527
*                                                                  0527
         MVC   DARGRETL(2,@04),@CH00818                            0527
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UPRINT TO LOAD IDC498D MESSAGE                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0528
*           CALL AMSTP011(GDTTBL,0,DDSTRU);                        0528
*                                                                  0528
         L     @04,@PC00001                                        0528
         ST    @04,@AL00001                                        0528
         LA    @15,@CF00118                                        0528
         ST    @15,@AL00001+4                                      0528
         LA    @15,DDSTRU                                          0528
         ST    @15,@AL00001+8                                      0528
         MVI   @AL00001+8,X'80'                                    0528
         L     @15,GDTPRT(,@04)                                    0528
         LA    @01,@AL00001                                        0528
         BALR  @14,@15                                             0528
*           /*********************************************************/
*           /*                                                       */
*           /* SAVE RETURN CODE FROM UPRINT                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0529
*           RESPECIFY                                              0529
*             RTNREG RSTD;                                         0529
*           TESTRC=RTNREG;                                         0530
         STH   RTNREG,TESTRC                                       0530
*           RESPECIFY                                              0531
*             RTNREG UNRSTD;                                       0531
*                                                                  0531
*           /*********************************************************/
*           /*                                                       */
*           /* IF UPRINT FAILS, RETURN TO THE CALLER WITH RC = 12    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0532
*           IF TESTRC^=0 THEN                                      0532
         LH    @04,TESTRC                                          0532
         LTR   @04,@04                                             0532
         BZ    @RF00532                                            0532
*             RETURN CODE(LASTCC12);                               0533
*                                                                  0533
         LA    @15,12                                              0533
         L     @14,@SA00002                                        0533
         LM    @00,@12,@SA00002+8                                  0533
         BR    @14                                                 0533
*           /*********************************************************/
*           /*                                                       */
*           /* INSERT VOLSER OF VTOCHEADER IN MESSAGE                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0534
*           WTORLIST(62:67)=XTNHVOL;                               0534
*                                                                  0534
@RF00532 MVC   WTORLIST+61(6),XTNHVOL(XTNTPTR)                     0534
*           /*********************************************************/
*           /*                                                       */
*           /* PROMPT CONSOLE OPERATOR FOR AUTHORIZATION TO ACCESS   */
*           /* VOLUME                                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0535
*           DO UNTIL(WTOREPLY=Y)(WTOREPLY=N);                     0535
@DL00535 DS    0H                                                  0536
*             WTOREPLY=''B;                                        0536
         MVI   WTOREPLY,X'00'                                      0536
*             WTORECB=''B;                                         0537
         XC    WTORECB(4),WTORECB                                  0537
*             RESPECIFY                                            0538
*               REG3 RESTRICTED;                                   0538
*             REG3=ADDR(WTORLIST);                                 0539
         LA    REG3,WTORLIST                                       0539
*LWTOR1:                                                           0540
*             GEN;                                                 0540
LWTOR1   DS    0H                                                  0540
         WTOR  ,WTOREPLY,1,WTORECB,MF=(E,(3))
         WAIT ECB=WTORECB
         DOM   MSG=(1)
*             RESPECIFY                                            0541
*               REG3 UNRESTRICTED;                                 0541
*           END;                                                   0542
*                                                                  0542
@DE00535 CLI   WTOREPLY,C'Y'                                       0542
         BE    @DC00535                                            0542
         CLI   WTOREPLY,C'N'                                       0542
         BNE   @DL00535                                            0542
@DC00535 DS    0H                                                  0543
*           /*********************************************************/
*           /*                                                       */
*           /* IF REPLY IS 'N', PREPARE TO RETURN TO THE CALLER WITH */
*           /* RC = 12                                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0543
*           IF WTOREPLY=N THEN                                     0543
         CLI   WTOREPLY,C'N'                                       0543
         BNE   @RF00543                                            0543
*             DO;                                                  0544
*                                                                  0544
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ACCESS DENIAL MESSAGE IDC31206I             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0545
*               DO;                                                0545
*                 CKREQ=CKREQ&&CKREQ;                              0546
         L     @04,@PC00001+8                                      0546
         XC    CKREQ(44,@04),CKREQ(@04)                            0546
*                 CKRERN=MSG06;                                    0547
         MVC   CKRERN(2,@04),@CH00035                              0547
*                 CKRMVAR(1)=ADDR(XTNHVOL);                        0548
         LA    @15,XTNHVOL(,XTNTPTR)                               0548
         ST    @15,CKRMVAR(,@04)                                   0548
*                 CALL IDCRDER;                                    0549
         L     @15,@CV01553                                        0549
         BALR  @14,@15                                             0549
*               END;                                               0550
*                                                                  0550
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0551
*               RETURN CODE(LASTCC12);                             0551
         LA    @15,12                                              0551
         L     @14,@SA00002                                        0551
         LM    @00,@12,@SA00002+8                                  0551
         BR    @14                                                 0551
*             END;                                                 0552
*         END;                                                     0553
*                                                                  0553
*       /*************************************************************/
*       /*                                                           */
*       /* GET ADDRESS OF USYSINFO RETURN AREA FOR NON-MODIFY REQUEST*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0554
*       ELSE                                                       0554
*         SINFPTR=REPISYSI;                                        0554
*                                                                  0554
         B     @RC00518                                            0554
@RF00518 L     @04,@PC00001+8                                      0554
         L     @04,REPISYSI(,@04)                                  0554
         ST    @04,SINFPTR                                         0554
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USYSINFO TO OBTAIN THE UCB ADDRESS                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0555
*       CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);                0555
*                                                                  0555
@RC00518 L     @04,@PC00001                                        0555
         ST    @04,@AL00001                                        0555
         LA    @15,UNIT                                            0555
         ST    @15,@AL00001+4                                      0555
         LA    @15,SINFPTR                                         0555
         ST    @15,@AL00001+8                                      0555
         ST    XTNTPTR,@AL00001+12                                 0555
         MVI   @AL00001+12,X'80'                                   0555
         L     @15,GDTSFO(,@04)                                    0555
         LA    @01,@AL00001                                        0555
         BALR  @14,@15                                             0555
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM USYSINFO                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0556
*       RESPECIFY                                                  0556
*         RTNREG RSTD;                                             0556
*       TESTRC=RTNREG;                                             0557
         STH   RTNREG,TESTRC                                       0557
*       RESPECIFY                                                  0558
*         RTNREG UNRSTD;                                           0558
*                                                                  0558
*       /*************************************************************/
*       /*                                                           */
*       /* IF USYSINFO FAILS, RETURN TO THE CALLER WITH RC = 12      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0559
*       IF TESTRC^=0 THEN                                          0559
         LH    @04,TESTRC                                          0559
         LTR   @04,@04                                             0559
         BZ    @RF00559                                            0559
*         RETURN CODE(LASTCC12);                                   0560
*                                                                  0560
         LA    @15,12                                              0560
         L     @14,@SA00002                                        0560
         LM    @00,@12,@SA00002+8                                  0560
         BR    @14                                                 0560
*       /*************************************************************/
*       /*                                                           */
*       /* IF REQUESTED FUNCTION IS MODIFY, RESERVE THE VOLUME       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0561
*       IF ADDR(MODIF)^=NULLPTR THEN                               0561
@RF00559 L     @04,@PC00001+4                                      0561
         L     @04,FDTPTR+356(,@04)                                0561
         LTR   @04,@04                                             0561
         BZ    @RF00561                                            0561
*         DO;                                                      0562
*                                                                  0562
*           /*********************************************************/
*           /*                                                       */
*           /* CONSTRUCT QNAME, RNAME LENGTH, AND RNAME              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0563
*           SPQNAME=SYSVTOC;                                       0563
         L     @04,@PC00001+8                                      0563
         L     @04,REPQRPTR(,@04)                                  0563
         MVC   SPQNAME(8,@04),@CC02747                             0563
*           SPRLEN=LENGTH(SPRVOL);                                 0564
         MVI   SPRLEN(@04),X'06'                                   0564
*           SPRVOL=XTNHVOL;                                        0565
*                                                                  0565
         MVC   SPRVOL(6,@04),XTNHVOL(XTNTPTR)                      0565
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE URESERVE TO RESERVE THE VTOC                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0566
*           CALL IDCSARV0(GDTTBL,EXCL,WAIT,SINFAREA,SPQNAME,SPRNAME);
*                                                                  0566
         L     @15,@PC00001                                        0566
         ST    @15,@AL00001                                        0566
         LA    @14,EXCL                                            0566
         ST    @14,@AL00001+4                                      0566
         LA    @14,WAIT                                            0566
         ST    @14,@AL00001+8                                      0566
         L     @01,SINFPTR                                         0566
         ST    @01,@AL00001+12                                     0566
         ST    @04,@AL00001+16                                     0566
         LA    @04,SPRNAME(,@04)                                   0566
         ST    @04,@AL00001+20                                     0566
         MVI   @AL00001+20,X'80'                                   0566
         L     @15,GDTRSV(,@15)                                    0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*           /*********************************************************/
*           /*                                                       */
*           /* SAVE THE RETURN CODE FROM URESERVE                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0567
*           RESPECIFY                                              0567
*             RTNREG RSTD;                                         0567
*           TESTRC=RTNREG;                                         0568
         STH   RTNREG,TESTRC                                       0568
*           RESPECIFY                                              0569
*             RTNREG UNRSTD;                                       0569
*                                                                  0569
*           /*********************************************************/
*           /*                                                       */
*           /* IF URESERVE FAILS, RETURN TO IDCRD05 WITH RC = 12     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0570
*           IF TESTRC^=0 THEN                                      0570
         LH    @04,TESTRC                                          0570
         LTR   @04,@04                                             0570
         BZ    @RF00570                                            0570
*             RETURN CODE(LASTCC12);                               0571
*                                                                  0571
         LA    @15,12                                              0571
         L     @14,@SA00002                                        0571
         LM    @00,@12,@SA00002+8                                  0571
         BR    @14                                                 0571
*           /*********************************************************/
*           /*                                                       */
*           /* SET MODIFY ENQ INDICATOR                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0572
*           REPENQSW=MODENQ;                                       0572
@RF00570 L     @04,@PC00001+8                                      0572
         MVI   REPENQSW(@04),X'80'                                 0572
*         END;                                                     0573
*                                                                  0573
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE EXOARG                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0574
*       EXOARG=''B;                                                0574
@RF00561 L     @04,@PC00001+8                                      0574
         L     @15,REPEXOAR(,@04)                                  0574
         XC    EXOARG(34,@15),EXOARG(@15)                          0574
*       EXOUCB=SINFAREA;                                           0575
         L     @01,SINFPTR                                         0575
         L     @14,SINFAREA(,@01)                                  0575
         ST    @14,EXOUCB(,@15)                                    0575
*       EXODDN=ADDR(XTNHDDN);                                      0576
         ST    XTNTPTR,EXODDN(,@15)                                0576
*       EXODSN=ADDR(XTNHDSN);                                      0577
         LA    @14,XTNHDSN(,XTNTPTR)                               0577
         ST    @14,EXODSN(,@15)                                    0577
*       IF ADDR(MODIF)^=NULLPTR THEN                               0578
         L     @14,@PC00001+4                                      0578
         L     @14,FDTPTR+356(,@14)                                0578
         LTR   @14,@14                                             0578
         BZ    @RF00578                                            0578
*         DO;                                                      0579
*           EXOREAD=OFF;                                           0580
         NI    EXOREAD(@15),B'01111111'                            0580
*           EXOCTLBK=ADDR(REPODSOP);                               0581
         LA    @04,REPODSOP(,@04)                                  0581
         ST    @04,EXOCTLBK(,@15)                                  0581
*         END;                                                     0582
*       ELSE                                                       0583
*         DO;                                                      0583
         B     @RC00578                                            0583
@RF00578 DS    0H                                                  0584
*           EXOCTLBK=ADDR(REPIDSOP);                               0584
         L     @04,@PC00001+8                                      0584
         L     @15,REPEXOAR(,@04)                                  0584
         LA    @04,REPIDSOP(,@04)                                  0584
         ST    @04,EXOCTLBK(,@15)                                  0584
*           EXOREAD=ON;                                            0585
         OI    EXOREAD(@15),B'10000000'                            0585
*         END;                                                     0586
*       EXOREP=ON;                                                 0587
@RC00578 L     @04,@PC00001+8                                      0587
         L     @04,REPEXOAR(,@04)                                  0587
         OI    EXOREP(@04),B'00000100'                             0587
*       EXOVTH=ON;                                                 0588
         OI    EXOVTH(@04),B'00000001'                             0588
*       EXOEXT=ADDR(XTNHCHR1);                                     0589
         LA    @15,XTNHCHR1(,XTNTPTR)                              0589
         ST    @15,EXOEXT(,@04)                                    0589
*       XTNHCHR1(1:2)=DEVMAXCC;                                    0590
         L     @15,DEVAREAP                                        0590
         MVC   XTNHCHR1(2,XTNTPTR),DEVMAXCC(@15)                   0590
*       XTNHCHR1(3:4)=DEVMAXHH;                                    0591
         MVC   XTNHCHR1+2(2,XTNTPTR),DEVMAXHH(@15)                 0591
*       XTNHCHR1(5:5)='00'X;                                       0592
*                                                                  0592
         MVI   XTNHCHR1+4(XTNTPTR),X'00'                           0592
*       /*************************************************************/
*       /*                                                           */
*       /* OPEN THE VTOC. UEXCP WILL RETURN BEGINNING CCHHR OF THE   */
*       /* VTOC IN XTNHCHR1 POINTED TO BY EXOEXT                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0593
*       CALL IDCIO050(GDTTBL,OPENR,EXOARG);                        0593
*                                                                  0593
         L     @15,@PC00001                                        0593
         ST    @15,@AL00001                                        0593
         LA    @14,@CC02024                                        0593
         ST    @14,@AL00001+4                                      0593
         ST    @04,@AL00001+8                                      0593
         MVI   @AL00001+8,X'80'                                    0593
         L     @15,GDTEXP(,@15)                                    0593
         LA    @01,@AL00001                                        0593
         BALR  @14,@15                                             0593
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE RETURN CODE FROM UEXCP                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0594
*       RESPECIFY                                                  0594
*         RTNREG RSTD;                                             0594
*       TESTRC=RTNREG;                                             0595
         STH   RTNREG,TESTRC                                       0595
*       RESPECIFY                                                  0596
*         RTNREG UNRSTD;                                           0596
*                                                                  0596
*       /*************************************************************/
*       /*                                                           */
*       /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0597
*       IF TESTRC^=0 THEN                                          0597
         LH    @04,TESTRC                                          0597
         SLR   @15,@15                                             0597
         CR    @04,@15                                             0597
         BE    @RF00597                                            0597
*         DO;                                                      0598
*                                                                  0598
*           /*********************************************************/
*           /*                                                       */
*           /* IF MODIFY FUNCTION, DEQ THE VOLUME                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0599
*           IF ADDR(MODIF)^=NULLPTR THEN                           0599
         L     @14,@PC00001+4                                      0599
         C     @15,FDTPTR+356(,@14)                                0599
         BE    @RF00599                                            0599
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               0600
*                                                                  0600
         L     @15,@PC00001                                        0600
         ST    @15,@AL00001                                        0600
         L     @14,@PC00001+8                                      0600
         L     @14,REPQRPTR(,@14)                                  0600
         ST    @14,@AL00001+4                                      0600
         LA    @14,SPRNAME(,@14)                                   0600
         ST    @14,@AL00001+8                                      0600
         MVI   @AL00001+8,X'80'                                    0600
         L     @15,GDTDEQ(,@15)                                    0600
         LA    @01,@AL00001                                        0600
         BALR  @14,@15                                             0600
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0601
*           RETURN CODE(LASTCC12);                                 0601
@RF00599 LA    @15,12                                              0601
         L     @14,@SA00002                                        0601
         LM    @00,@12,@SA00002+8                                  0601
         BR    @14                                                 0601
*         END;                                                     0602
*                                                                  0602
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE MODIFY FUNCTION IS REQUESTED, THE BEGINNING CCHH OF*/
*       /* THE VTOC RETURNED BY UEXCP OPENR IN XTNHCHR1 MUST EQUAL   */
*       /* THE CCHH VALUE IN THE VTOCHEADERADDRESS CCHHR PARAMETER.  */
*       /* IF NOT, PREPARE TO RETURN TO IDCRD05 WITH RC = 12         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0603
*       IF ADDR(MODIF)^=NULLPTR&ADDR(MVTCR)^=NULLPTR THEN          0603
@RF00597 SLR   @04,@04                                             0603
         L     @15,@PC00001+4                                      0603
         C     @04,FDTPTR+356(,@15)                                0603
         BE    @RF00603                                            0603
         L     @15,FDTPTR+432(,@15)                                0603
         CR    @15,@04                                             0603
         BE    @RF00603                                            0603
*         DO;                                                      0604
*                                                                  0604
*           /*********************************************************/
*           /*                                                       */
*           /* VALIDATE VTOCHEADERADDRESS CCHHR PARAMETER            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0605
*           IF XTNHCHR1(1:4)^=MVTCRVAL(1:4) THEN                   0605
         CLC   XTNHCHR1(4,XTNTPTR),MVTCRVAL(@15)                   0605
         BE    @RF00605                                            0605
*             DO;                                                  0606
*                                                                  0606
*               /*****************************************************/
*               /*                                                   */
*               /* CLOSE THE VTOC                                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0607
*               CALL IDCIO050(GDTTBL,CLOSE,REPODSOP);              0607
*                                                                  0607
         L     @15,@PC00001                                        0607
         ST    @15,@AL00001                                        0607
         LA    @14,CLOSE                                           0607
         ST    @14,@AL00001+4                                      0607
         L     @14,@PC00001+8                                      0607
         LA    @14,REPODSOP(,@14)                                  0607
         ST    @14,@AL00001+8                                      0607
         MVI   @AL00001+8,X'80'                                    0607
         L     @15,GDTEXP(,@15)                                    0607
         LA    @01,@AL00001                                        0607
         BALR  @14,@15                                             0607
*               /*****************************************************/
*               /*                                                   */
*               /* DEQ THE VOLUME                                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0608
*               CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);             0608
*                                                                  0608
         L     @15,@PC00001                                        0608
         ST    @15,@AL00001                                        0608
         L     @14,@PC00001+8                                      0608
         L     @14,REPQRPTR(,@14)                                  0608
         ST    @14,@AL00001+4                                      0608
         LA    @14,SPRNAME(,@14)                                   0608
         ST    @14,@AL00001+8                                      0608
         MVI   @AL00001+8,X'80'                                    0608
         L     @15,GDTDEQ(,@15)                                    0608
         LA    @01,@AL00001                                        0608
         BALR  @14,@15                                             0608
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31239I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0609
*               DO;                                                0609
*                 CKREQ=CKREQ&&CKREQ;                              0610
         L     @15,@PC00001+8                                      0610
         XC    CKREQ(44,@15),CKREQ(@15)                            0610
*                 CKRERN=MSG39;                                    0611
         MVC   CKRERN(2,@15),@CH00730                              0611
*                 CKRMVAR(1)=ADDR(MVTCRVAL);                       0612
         L     @14,@PC00001+4                                      0612
         L     @01,FDTPTR+432(,@14)                                0612
         LA    @14,MVTCRVAL(,@01)                                  0612
         ST    @14,CKRMVAR(,@15)                                   0612
*                 CALL IDCRDER;                                    0613
         L     @15,@CV01553                                        0613
         BALR  @14,@15                                             0613
*               END;                                               0614
*                                                                  0614
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO IDCRD05 WITH RC = 12                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0615
*               RETURN CODE(LASTCC12);                             0615
         LA    @15,12                                              0615
         L     @14,@SA00002                                        0615
         LM    @00,@12,@SA00002+8                                  0615
         BR    @14                                                 0615
*             END;                                                 0616
*         END;                                                     0617
*                                                                  0617
@RF00605 DS    0H                                                  0618
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE ENDING CCHH EQUAL TO BEGINNING CCHH AND ENDING R  */
*       /* EQUAL TO X'FF'                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0618
*       XTNHCHR2(1:4)=XTNHCHR1(1:4);                               0618
@RF00603 MVC   XTNHCHR2(4,XTNTPTR),XTNHCHR1(XTNTPTR)               0618
*       XTNHCHR2(5:5)='FF'X;                                       0619
*                                                                  0619
         MVI   XTNHCHR2+4(XTNTPTR),X'FF'                           0619
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE FIRST AND ONLY EXTENT TABLE ENTRY           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0620
*       I=1;                                                       0620
         L     @04,@PC00001+8                                      0620
         LA    @15,1                                               0620
         STC   @15,I(,@04)                                         0620
*       XTNTDDN(I)=XTNHDDN;                                        0621
         LA    @14,78                                              0621
         LR    @01,@15                                             0621
         MR    @00,@14                                             0621
         ST    @01,@TF00001                                        0621
         ALR   @01,XTNTPTR                                         0621
         MVC   XTNTDDN-78(8,@01),XTNHDDN(XTNTPTR)                  0621
*       XTNTDSN(I)=XTNHDSN;                                        0622
         LR    @01,XTNTPTR                                         0622
         AL    @01,@TF00001                                        0622
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 0622
*       XTNTVOLN(I)=XTNHVOLN;                                      0623
         LR    @01,XTNTPTR                                         0623
         AL    @01,@TF00001                                        0623
         MVC   XTNTVOLN-78(1,@01),XTNHVOLN(XTNTPTR)                0623
*       XTNTVOL(I)=XTNHVOL;                                        0624
         LR    @01,XTNTPTR                                         0624
         AL    @01,@TF00001                                        0624
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  0624
*       XTNTCHR1(I)=XTNHCHR1;                                      0625
         LR    @01,XTNTPTR                                         0625
         AL    @01,@TF00001                                        0625
         MVC   XTNTCHR1-78(5,@01),XTNHCHR1(XTNTPTR)                0625
*       XTNTCHR2(I)=XTNHCHR2;                                      0626
*                                                                  0626
         LR    @01,XTNTPTR                                         0626
         AL    @01,@TF00001                                        0626
         MVC   XTNTCHR2-78(5,@01),XTNHCHR2(XTNTPTR)                0626
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE NEXT EXTENT TABLE ENTRY TO X'FF' TO INDICATE THE  */
*       /* LAST ENTRY.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0627
*       I=I+1;                                                     0627
         AL    @15,@CF00221                                        0627
         STC   @15,I(,@04)                                         0627
*       XTNTENT(I)=LASTENT;                                        0628
*                                                                  0628
         MR    @14,@14                                             0628
         ALR   @15,XTNTPTR                                         0628
         MVC   XTNTENT-78(78,@15),LASTENT                          0628
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE REQUIRED BYTES FOR THE I/O BUFFER               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0629
*       REQBYTES=DEVTC+LENGTH(RIOHDR);                             0629
*                                                                  0629
         LA    @15,282                                             0629
         L     @14,DEVAREAP                                        0629
         LH    @14,DEVTC(,@14)                                     0629
         N     @14,@CF03043                                        0629
         ALR   @15,@14                                             0629
         ST    @15,REQBYTES                                        0629
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UGPOOL FOR SPACE FOR AN I/O BUFFER.                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0630
*       CALL IDCSAGP0(GDTTBL,REQBYTES,REQADDR,RD01,SETZERO);       0630
*                                                                  0630
         L     @15,@PC00001                                        0630
         ST    @15,@AL00001                                        0630
         LA    @14,REQBYTES                                        0630
         ST    @14,@AL00001+4                                      0630
         LA    @14,REQADDR                                         0630
         ST    @14,@AL00001+8                                      0630
         LA    @14,@CC02759                                        0630
         ST    @14,@AL00001+12                                     0630
         LA    @14,SETZERO                                         0630
         ST    @14,@AL00001+16                                     0630
         MVI   @AL00001+16,X'80'                                   0630
         L     @15,GDTGPL(,@15)                                    0630
         LA    @01,@AL00001                                        0630
         BALR  @14,@15                                             0630
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE RETURN CODE FROM UGPOOL                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0631
*       RESPECIFY                                                  0631
*         RTNREG RSTD;                                             0631
*       TESTRC=RTNREG;                                             0632
         STH   RTNREG,TESTRC                                       0632
*       RESPECIFY                                                  0633
*         RTNREG UNRSTD;                                           0633
*                                                                  0633
*       /*************************************************************/
*       /*                                                           */
*       /* IF UGPOOL FAILS, PREPARE TO RETURN TO THE CALLER WITH RC =*/
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0634
*       IF TESTRC^=0 THEN                                          0634
         LH    @15,TESTRC                                          0634
         SLR   @14,@14                                             0634
         CR    @15,@14                                             0634
         BE    @RF00634                                            0634
*         DO;                                                      0635
*                                                                  0635
*           /*********************************************************/
*           /*                                                       */
*           /* CLOSE THE CURRENT EXTENT TABLE ENTRY                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0636
*           IF ADDR(MODIF)^=NULLPTR THEN                           0636
         L     @15,@PC00001+4                                      0636
         C     @14,FDTPTR+356(,@15)                                0636
         BE    @RF00636                                            0636
*             CALL IDCIO050(GDTTBL,CLOSE,REPODSOP);                0637
         L     @15,@PC00001                                        0637
         ST    @15,@AL00001                                        0637
         LA    @14,CLOSE                                           0637
         ST    @14,@AL00001+4                                      0637
         L     @14,@PC00001+8                                      0637
         LA    @14,REPODSOP(,@14)                                  0637
         ST    @14,@AL00001+8                                      0637
         MVI   @AL00001+8,X'80'                                    0637
         L     @15,GDTEXP(,@15)                                    0637
         LA    @01,@AL00001                                        0637
         BALR  @14,@15                                             0637
*           ELSE                                                   0638
*             CALL IDCIO050(GDTTBL,CLOSE,REPIDSOP);                0638
*                                                                  0638
         B     @RC00636                                            0638
@RF00636 L     @15,@PC00001                                        0638
         ST    @15,@AL00001                                        0638
         LA    @14,CLOSE                                           0638
         ST    @14,@AL00001+4                                      0638
         L     @14,@PC00001+8                                      0638
         LA    @14,REPIDSOP(,@14)                                  0638
         ST    @14,@AL00001+8                                      0638
         MVI   @AL00001+8,X'80'                                    0638
         L     @15,GDTEXP(,@15)                                    0638
         LA    @01,@AL00001                                        0638
         BALR  @14,@15                                             0638
*           /*********************************************************/
*           /*                                                       */
*           /* IF MODIFY FUNCTION, DEQ THE VOLUME                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0639
*           IF ADDR(MODIF)^=NULLPTR THEN                           0639
@RC00636 L     @15,@PC00001+4                                      0639
         L     @15,FDTPTR+356(,@15)                                0639
         LTR   @15,@15                                             0639
         BZ    @RF00639                                            0639
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               0640
*                                                                  0640
         L     @15,@PC00001                                        0640
         ST    @15,@AL00001                                        0640
         L     @14,@PC00001+8                                      0640
         L     @14,REPQRPTR(,@14)                                  0640
         ST    @14,@AL00001+4                                      0640
         LA    @14,SPRNAME(,@14)                                   0640
         ST    @14,@AL00001+8                                      0640
         MVI   @AL00001+8,X'80'                                    0640
         L     @15,GDTDEQ(,@15)                                    0640
         LA    @01,@AL00001                                        0640
         BALR  @14,@15                                             0640
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE UNIVERSAL TEXT MESSAGE IDC3004I                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0641
*           DO;                                                    0641
@RF00639 DS    0H                                                  0642
*             CKREQ=CKREQ&&CKREQ;                                  0642
         L     @15,@PC00001+8                                      0642
         XC    CKREQ(44,@15),CKREQ(@15)                            0642
*             CKRERN=MSG93;                                        0643
         MVC   CKRERN(2,@15),@CH00866                              0643
*             CALL IDCRDER;                                        0644
         L     @15,@CV01553                                        0644
         BALR  @14,@15                                             0644
*           END;                                                   0645
*                                                                  0645
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0646
*           RETURN CODE(LASTCC12);                                 0646
         LA    @15,12                                              0646
         L     @14,@SA00002                                        0646
         LM    @00,@12,@SA00002+8                                  0646
         BR    @14                                                 0646
*         END;                                                     0647
*                                                                  0647
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE FIRST BYTE OF THE BUFFER AREA TO X'FF' TO INDICATE*/
*       /* TO UEXCP THAT THE AREA HAS NOT PREVIOUSLY BEEN USED.      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0648
*       IF ADDR(MODIF)^=NULLPTR THEN                               0648
@RF00634 L     @15,@PC00001+4                                      0648
         L     @15,FDTPTR+356(,@15)                                0648
         LTR   @15,@15                                             0648
         BZ    @RF00648                                            0648
*         REPOBFPT=REQADDR;                                        0649
         L     @15,@PC00001+8                                      0649
         L     @14,REQADDR                                         0649
         ST    @14,REPOBFPT(,@15)                                  0649
*       ELSE                                                       0650
*         REPIBFPT=REQADDR;                                        0650
         B     @RC00648                                            0650
@RF00648 L     @15,@PC00001+8                                      0650
         L     @14,REQADDR                                         0650
         ST    @14,REPIBFPT(,@15)                                  0650
*       RESPECIFY                                                  0651
*         RIOAREA BASED(REQADDR);                                  0651
@RC00648 DS    0H                                                  0652
*       RFIRST='FF'X;                                              0652
*                                                                  0652
         L     @01,REQADDR                                         0652
         MVI   RFIRST(@01),X'FF'                                   0652
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO CALLER WITH RC = 00                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0653
*       RETURN CODE(LASTCC00);                                     0653
         SLR   @15,@15                                             0653
         L     @14,@SA00002                                        0653
         LM    @00,@12,@SA00002+8                                  0653
         BR    @14                                                 0653
*     END DSVHDR;                                                  0654
*                                                                  0655
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A STAGING PACK                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0655
*   IF ADDR(STAGR)^=NULLPTRADDR(CSRNG)^=NULLPTR THEN              0655
@RF00437 SLR   @04,@04                                             0655
         L     @15,@PC00001+4                                      0655
         C     @04,FDTPTR+32(,@15)                                 0655
         BNE   @RT00655                                            0655
         C     @04,FDTPTR+148(,@15)                                0655
         BE    @RF00655                                            0655
@RT00655 DS    0H                                                  0656
*DSSTGPK:                                                          0656
*     DO;                                                          0656
*                                                                  0656
DSSTGPK  DS    0H                                                  0657
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE COMMON FIELDS AND POINTERS                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0657
*       IF ADDR(DISPL)^=NULLPTR THEN                               0657
         L     @15,@PC00001+4                                      0657
         L     @14,FDTPTR(,@15)                                    0657
         LTR   @14,@14                                             0657
         BZ    @RF00657                                            0657
*         INFODD=INFILVAL;                                         0658
         L     @01,FDTPTR+12(,@15)                                 0658
         MVC   INFODD(8),INFILVAL(@01)                             0658
*       ELSE                                                       0659
*         INFODD=CINFLVAL;                                         0659
         B     @RC00657                                            0659
@RF00657 L     @15,@PC00001+4                                      0659
         L     @01,FDTPTR+140(,@15)                                0659
         MVC   INFODD(8),CINFLVAL(@01)                             0659
*       INFOPTR=REPIINFO;                                          0660
@RC00657 L     @04,@PC00001+8                                      0660
         L     @15,REPIINFO(,@04)                                  0660
         ST    @15,INFOPTR                                         0660
*       XTNTPTR=REPIXTNT;                                          0661
*                                                                  0661
         L     XTNTPTR,REPIXTNT(,@04)                              0661
*       /*************************************************************/
*       /*                                                           */
*       /* SET TRACE POINT                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0662
*       OLDERID2=NEWERID2;                                         0662
         L     @15,@PC00001                                        0662
         L     @15,GDTTR2(,@15)                                    0662
         MVC   @TS00001(95),NEWERID2(@15)                          0662
         MVC   OLDERID2(95,@15),@TS00001                           0662
*       NEWID2='RD6J';                                             0663
*                                                                  0663
         MVC   NEWID2(4,@15),@CC02879                              0663
*       /*************************************************************/
*       /*                                                           */
*       /* FOR DISPLAY, VALIDATE THE CCHHR AND HHR LENGTHS AND BUILD */
*       /* THE EXTENT TABLE HEADER.                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0664
*       IF ADDR(DISPL)^=NULLPTR THEN                               0664
         L     @15,@PC00001+4                                      0664
         L     @14,FDTPTR(,@15)                                    0664
         LTR   @14,@14                                             0664
         BZ    @RF00664                                            0664
*         DO;                                                      0665
*                                                                  0665
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE STAGINGINGRANGE PARAMETER (FROM     */
*           /* CCHHR) MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO  */
*           /* THE CALLER WITH RC = 12                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0666
*           IF DCCHRLEN^=LENGTH(DCCHRVAL) THEN                     0666
         L     @15,FDTPTR+72(,@15)                                 0666
         CLI   DCCHRLEN(@15),5                                     0666
         BE    @RF00666                                            0666
*             DO;                                                  0667
*                                                                  0667
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31207I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0668
*               DO;                                                0668
*                 CKREQ=CKREQ&&CKREQ;                              0669
         XC    CKREQ(44,@04),CKREQ(@04)                            0669
*                 CKRERN=MSG07;                                    0670
         MVC   CKRERN(2,@04),@CH00040                              0670
*                 CKRMVAR(1)=ADDR(DCCHRVAL);                       0671
         LA    @05,DCCHRVAL(,@15)                                  0671
         ST    @05,CKRMVAR(,@04)                                   0671
*                 CKRMVAR(2)=ADDR(DCCHRLEN);                       0672
         ST    @15,CKRMVAR+4(,@04)                                 0672
*                 CALL IDCRDER;                                    0673
         L     @15,@CV01553                                        0673
         BALR  @14,@15                                             0673
*               END;                                               0674
*                                                                  0674
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0675
*               RETURN CODE(LASTCC12);                             0675
         LA    @15,12                                              0675
         L     @14,@SA00002                                        0675
         LM    @00,@12,@SA00002+8                                  0675
         BR    @14                                                 0675
*             END;                                                 0676
*                                                                  0676
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE STAGINGRANGE PARAMETER (TO HHR) MUST*/
*           /* BE 0 OR 3. IF NOT, PREPARE TO RETURN TO THE CALLER    */
*           /* WITH RC = 12                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0677
*           IF ADDR(DREC)^=NULLPTR&DRECLEN^=LENGTH(DRECVAL) THEN   0677
@RF00666 L     @04,@PC00001+4                                      0677
         L     @04,FDTPTR+76(,@04)                                 0677
         LTR   @04,@04                                             0677
         BZ    @RF00677                                            0677
         CLI   DRECLEN(@04),3                                      0677
         BE    @RF00677                                            0677
*             DO;                                                  0678
*                                                                  0678
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31207I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0679
*               DO;                                                0679
*                 CKREQ=CKREQ&&CKREQ;                              0680
         L     @05,@PC00001+8                                      0680
         XC    CKREQ(44,@05),CKREQ(@05)                            0680
*                 CKRERN=MSG07;                                    0681
         MVC   CKRERN(2,@05),@CH00040                              0681
*                 CKRMVAR(1)=ADDR(DRECVAL);                        0682
         LA    @15,DRECVAL(,@04)                                   0682
         ST    @15,CKRMVAR(,@05)                                   0682
*                 CKRMVAR(2)=ADDR(DRECLEN);                        0683
         ST    @04,CKRMVAR+4(,@05)                                 0683
*                 CALL IDCRDER;                                    0684
         L     @15,@CV01553                                        0684
         BALR  @14,@15                                             0684
*               END;                                               0685
*                                                                  0685
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0686
*               RETURN CODE(LASTCC12);                             0686
         LA    @15,12                                              0686
         L     @14,@SA00002                                        0686
         LM    @00,@12,@SA00002+8                                  0686
         BR    @14                                                 0686
*             END;                                                 0687
*                                                                  0687
*           /*********************************************************/
*           /*                                                       */
*           /* CONSTRUCT THE EXTENT TABLE HEADER FOR DISPLAY         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0688
*           IF ADDR(DREC)=NULLPTR THEN                             0688
@RF00677 L     @04,@PC00001+4                                      0688
         L     @15,FDTPTR+76(,@04)                                 0688
         LTR   @15,@15                                             0688
         BNZ   @RF00688                                            0688
*             XTNHCHR2=DCCHRVAL;                                   0689
         L     @04,FDTPTR+72(,@04)                                 0689
         MVC   XTNHCHR2(5,XTNTPTR),DCCHRVAL(@04)                   0689
*           ELSE                                                   0690
*             DO;                                                  0690
         B     @RC00688                                            0690
@RF00688 DS    0H                                                  0691
*               XTNHCHR2(1:2)=DCCHRVAL;                            0691
         L     @04,@PC00001+4                                      0691
         L     @01,FDTPTR+72(,@04)                                 0691
         MVC   XTNHCHR2(2,XTNTPTR),DCCHRVAL(@01)                   0691
*               XTNHCHR2(3:5)=DRECVAL;                             0692
         L     @04,FDTPTR+76(,@04)                                 0692
         MVC   XTNHCHR2+2(3,XTNTPTR),DRECVAL(@04)                  0692
*             END;                                                 0693
*           XTNHCHR1=DCCHRVAL;                                     0694
@RC00688 L     @04,@PC00001+4                                      0694
         L     @01,FDTPTR+72(,@04)                                 0694
         MVC   XTNHCHR1(5,XTNTPTR),DCCHRVAL(@01)                   0694
*           XTNHDSN=FMT4DSN;                                       0695
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         0695
*           XTNHDDN=INFILVAL;                                      0696
         L     @01,FDTPTR+12(,@04)                                 0696
         MVC   XTNHDDN(8,XTNTPTR),INFILVAL(@01)                    0696
*           XTNHVOLN=1;                                            0697
         MVI   XTNHVOLN(XTNTPTR),X'01'                             0697
*           XTNHVOL=VOLSRVAL;                                      0698
         L     @04,FDTPTR+68(,@04)                                 0698
         MVC   XTNHVOL(6,XTNTPTR),VOLSRVAL(@04)                    0698
*           XTNHMODE=INPUT;                                        0699
         MVI   XTNHMODE(XTNTPTR),C'I'                              0699
*         END;                                                     0700
*                                                                  0700
*       /*************************************************************/
*       /*                                                           */
*       /* FOR COPY, VALIDATE THE CCHHR AND R LENGTHS AND BUILD THE  */
*       /* EXTENT TABLE HEADER.                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0701
*       IF ADDR(COPY)^=NULLPTR THEN                                0701
@RF00664 L     @04,@PC00001+4                                      0701
         L     @15,FDTPTR+136(,@04)                                0701
         LTR   @15,@15                                             0701
         BZ    @RF00701                                            0701
*         DO;                                                      0702
*                                                                  0702
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE STAGINGRANGE PARAMETER (FROM CCHHR) */
*           /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE     */
*           /* CALLER WITH RC = 12                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0703
*           IF CCCHRLEN^=LENGTH(CCCHRVAL) THEN                     0703
         L     @04,FDTPTR+184(,@04)                                0703
         CLI   CCCHRLEN(@04),5                                     0703
         BE    @RF00703                                            0703
*             DO;                                                  0704
*                                                                  0704
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31207I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0705
*               DO;                                                0705
*                 CKREQ=CKREQ&&CKREQ;                              0706
         L     @05,@PC00001+8                                      0706
         XC    CKREQ(44,@05),CKREQ(@05)                            0706
*                 CKRERN=MSG07;                                    0707
         MVC   CKRERN(2,@05),@CH00040                              0707
*                 CKRMVAR(1)=ADDR(CCCHRVAL);                       0708
         LA    @15,CCCHRVAL(,@04)                                  0708
         ST    @15,CKRMVAR(,@05)                                   0708
*                 CKRMVAR(2)=ADDR(CCCHRLEN);                       0709
         ST    @04,CKRMVAR+4(,@05)                                 0709
*                 CALL IDCRDER;                                    0710
         L     @15,@CV01553                                        0710
         BALR  @14,@15                                             0710
*               END;                                               0711
*                                                                  0711
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0712
*               RETURN CODE(LASTCC12);                             0712
         LA    @15,12                                              0712
         L     @14,@SA00002                                        0712
         LM    @00,@12,@SA00002+8                                  0712
         BR    @14                                                 0712
*             END;                                                 0713
*                                                                  0713
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE STAGINGRANGE PARAMETER (TO R) MUST  */
*           /* BE 1 BYTE. IF NOT, PREPARE TO RETURN TO THE CALLER    */
*           /* WITH RC = 12                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0714
*           IF ADDR(CRECR)^=NULLPTR&CRECRLEN^=LENGTH(CRECRVAL) THEN
@RF00703 L     @04,@PC00001+4                                      0714
         L     @04,FDTPTR+188(,@04)                                0714
         LTR   @04,@04                                             0714
         BZ    @RF00714                                            0714
         CLI   CRECRLEN(@04),1                                     0714
         BE    @RF00714                                            0714
*             DO;                                                  0715
*                                                                  0715
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31207I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0716
*               DO;                                                0716
*                 CKREQ=CKREQ&&CKREQ;                              0717
         L     @05,@PC00001+8                                      0717
         XC    CKREQ(44,@05),CKREQ(@05)                            0717
*                 CKRERN=MSG07;                                    0718
         MVC   CKRERN(2,@05),@CH00040                              0718
*                 CKRMVAR(1)=ADDR(CRECRVAL);                       0719
         LA    @15,CRECRVAL(,@04)                                  0719
         ST    @15,CKRMVAR(,@05)                                   0719
*                 CKRMVAR(2)=ADDR(CRECRLEN);                       0720
         ST    @04,CKRMVAR+4(,@05)                                 0720
*                 CALL IDCRDER;                                    0721
         L     @15,@CV01553                                        0721
         BALR  @14,@15                                             0721
*               END;                                               0722
*                                                                  0722
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0723
*               RETURN CODE(LASTCC12);                             0723
         LA    @15,12                                              0723
         L     @14,@SA00002                                        0723
         LM    @00,@12,@SA00002+8                                  0723
         BR    @14                                                 0723
*             END;                                                 0724
*                                                                  0724
*           /*********************************************************/
*           /*                                                       */
*           /* CONSTRUCT THE EXTENT TABLE HEADER FOR COPY            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0725
*           IF ADDR(CRECR)=NULLPTR THEN                            0725
@RF00714 L     @04,@PC00001+4                                      0725
         L     @15,FDTPTR+188(,@04)                                0725
         LTR   @15,@15                                             0725
         BNZ   @RF00725                                            0725
*             XTNHCHR2=CCCHRVAL;                                   0726
         L     @04,FDTPTR+184(,@04)                                0726
         MVC   XTNHCHR2(5,XTNTPTR),CCCHRVAL(@04)                   0726
*           ELSE                                                   0727
*             DO;                                                  0727
         B     @RC00725                                            0727
@RF00725 DS    0H                                                  0728
*               XTNHCHR2(1:4)=CCCHRVAL;                            0728
         L     @04,@PC00001+4                                      0728
         L     @01,FDTPTR+184(,@04)                                0728
         MVC   XTNHCHR2(4,XTNTPTR),CCCHRVAL(@01)                   0728
*               XTNHCHR2(5:5)=CRECRVAL;                            0729
         L     @04,FDTPTR+188(,@04)                                0729
         MVC   XTNHCHR2+4(1,XTNTPTR),CRECRVAL(@04)                 0729
*             END;                                                 0730
*           XTNHCHR1=CCCHRVAL;                                     0731
@RC00725 L     @04,@PC00001+4                                      0731
         L     @01,FDTPTR+184(,@04)                                0731
         MVC   XTNHCHR1(5,XTNTPTR),CCCHRVAL(@01)                   0731
*           XTNHDSN=FMT4DSN;                                       0732
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         0732
*           XTNHDDN=CINFLVAL;                                      0733
         L     @01,FDTPTR+140(,@04)                                0733
         MVC   XTNHDDN(8,XTNTPTR),CINFLVAL(@01)                    0733
*           XTNHVOLN=1;                                            0734
         MVI   XTNHVOLN(XTNTPTR),X'01'                             0734
*           XTNHVOL=CVOLSVAL;                                      0735
         L     @04,FDTPTR+180(,@04)                                0735
         MVC   XTNHVOL(6,XTNTPTR),CVOLSVAL(@04)                    0735
*           XTNHMODE=INPUT;                                        0736
         MVI   XTNHMODE(XTNTPTR),C'I'                              0736
*         END;                                                     0737
*                                                                  0737
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT UIOINFO OPTION BYTE                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0738
*       IOINFOPT=''B;                                              0738
@RF00701 LA    @04,INFOBYT                                         0738
         MVI   IOINFOPT(@04),X'00'                                 0738
*       IOINFVOL=ON;                                               0739
*                                                                  0739
         OI    IOINFVOL(@04),B'01000000'                           0739
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UIOINFO FOR DEVICE CHARACTERISTICS AND A LIST OF    */
*       /* VOLUME SERIAL NUMBERS.                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0740
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,INFODD);             0740
*                                                                  0740
         L     @15,@PC00001                                        0740
         ST    @15,@AL00001                                        0740
         ST    @04,@AL00001+4                                      0740
         LA    @04,INFOPTR                                         0740
         ST    @04,@AL00001+8                                      0740
         LA    @04,INFODD                                          0740
         ST    @04,@AL00001+12                                     0740
         MVI   @AL00001+12,X'80'                                   0740
         L     @15,GDTIFO(,@15)                                    0740
         LA    @01,@AL00001                                        0740
         BALR  @14,@15                                             0740
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UIOINFO                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0741
*       RESPECIFY                                                  0741
*         RTNREG RSTD;                                             0741
*       TESTRC=RTNREG;                                             0742
         STH   RTNREG,TESTRC                                       0742
*       RESPECIFY                                                  0743
*         RTNREG UNRSTD;                                           0743
*                                                                  0743
*       /*************************************************************/
*       /*                                                           */
*       /* IF UIOINFO FAILS, RETURN TO THE CALLER WITH RC = 12       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0744
*       IF TESTRC^=0 THEN                                          0744
         LH    @04,TESTRC                                          0744
         LTR   @04,@04                                             0744
         BZ    @RF00744                                            0744
*         RETURN CODE(LASTCC12);                                   0745
*                                                                  0745
         LA    @15,12                                              0745
         L     @14,@SA00002                                        0745
         LM    @00,@12,@SA00002+8                                  0745
         BR    @14                                                 0745
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP UIOINFO RETURN AREA ADDRESSABILITY                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0746
*       RESPECIFY                                                  0746
*         INFOSCAN BASED(INFSCNPT);                                0746
@RF00744 DS    0H                                                  0747
*       INFSCNPT=INFOPTR+LENGTH(INFAREAL)+LENGTH(INFDATAL);        0747
         LA    INFSCNPT,4                                          0747
         AL    INFSCNPT,INFOPTR                                    0747
*       IF INFSCNID=VOLIDENT THEN                                  0748
         CLC   INFSCNID(2,INFSCNPT),@CH00156                       0748
         BNE   @RF00748                                            0748
*         DO;                                                      0749
*           INFVOLPT=INFSCNPT;                                     0750
         ST    INFSCNPT,INFVOLPT                                   0750
*           RESPECIFY                                              0751
*             INFOVOL BASED(INFVOLPT);                             0751
*         END;                                                     0752
*       ELSE                                                       0753
*                                                                  0753
*         /***********************************************************/
*         /*                                                         */
*         /* RETURN TO THE CALLER WITH RC = 12                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0753
*         RETURN CODE(LASTCC12);                                   0753
*                                                                  0753
         B     @RC00748                                            0753
@RF00748 LA    @15,12                                              0753
         L     @14,@SA00002                                        0753
         LM    @00,@12,@SA00002+8                                  0753
         BR    @14                                                 0753
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME SERIAL NUMBER IN EXTENT TABLE HEADER (FROM      */
*       /* STAGINGRANGE PARAMETER) DOES NOT MATCH VOLSER IN DD       */
*       /* STATEMENT, PREPARE TO RETURN TO CALLER WITH RC = 12       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0754
*       IF XTNHVOL^=INFVOL(1) THEN                                 0754
@RC00748 L     @04,INFVOLPT                                        0754
         CLC   XTNHVOL(6,XTNTPTR),INFVOL(@04)                      0754
         BE    @RF00754                                            0754
*         DO;                                                      0755
*                                                                  0755
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31204I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0756
*           DO;                                                    0756
*             CKREQ=CKREQ&&CKREQ;                                  0757
         L     @05,@PC00001+8                                      0757
         XC    CKREQ(44,@05),CKREQ(@05)                            0757
*             CKRERN=MSG04;                                        0758
         MVC   CKRERN(2,@05),@CH00045                              0758
*             CKRMVAR(1)=ADDR(INFVOL(1));                          0759
         LA    @04,INFVOL(,@04)                                    0759
         ST    @04,CKRMVAR(,@05)                                   0759
*             CALL IDCRDER;                                        0760
         L     @15,@CV01553                                        0760
         BALR  @14,@15                                             0760
*           END;                                                   0761
*                                                                  0761
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0762
*           RETURN CODE(LASTCC12);                                 0762
         LA    @15,12                                              0762
         L     @14,@SA00002                                        0762
         LM    @00,@12,@SA00002+8                                  0762
         BR    @14                                                 0762
*         END;                                                     0763
*                                                                  0763
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE STARTING ADDRESS IS GREATER THAN THE ENDING        */
*       /* ADDRESS, PREPARE TO RETURN TO THE CALLER WITH RC = 12     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0764
*       IF XTNHCHR1>XTNHCHR2 THEN                                  0764
@RF00754 CLC   XTNHCHR1(5,XTNTPTR),XTNHCHR2(XTNTPTR)               0764
         BNH   @RF00764                                            0764
*         DO;                                                      0765
*                                                                  0765
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31208I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0766
*           DO;                                                    0766
*             CKREQ=CKREQ&&CKREQ;                                  0767
         L     @04,@PC00001+8                                      0767
         XC    CKREQ(44,@04),CKREQ(@04)                            0767
*             CKRERN=MSG08;                                        0768
         MVC   CKRERN(2,@04),@CH00181                              0768
*             CKRMVAR(1)=ADDR(XTNHCHR1);                           0769
         LA    @15,XTNHCHR1(,XTNTPTR)                              0769
         ST    @15,CKRMVAR(,@04)                                   0769
*             CKRMVAR(2)=ADDR(XTNHCHR2);                           0770
         LA    @15,XTNHCHR2(,XTNTPTR)                              0770
         ST    @15,CKRMVAR+4(,@04)                                 0770
*             CKRMVAR(3)=ADDR(XTNHVOL);                            0771
         LA    @15,XTNHVOL(,XTNTPTR)                               0771
         ST    @15,CKRMVAR+8(,@04)                                 0771
*             CALL IDCRDER;                                        0772
         L     @15,@CV01553                                        0772
         BALR  @14,@15                                             0772
*           END;                                                   0773
*                                                                  0773
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0774
*           RETURN CODE(LASTCC12);                                 0774
         LA    @15,12                                              0774
         L     @14,@SA00002                                        0774
         LM    @00,@12,@SA00002+8                                  0774
         BR    @14                                                 0774
*         END;                                                     0775
*                                                                  0775
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE DEVTYPE MACRO                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0776
*       RESPECIFY                                                  0776
*        (REG3,                                                    0776
*         REG4) RESTRICTED;                                        0776
@RF00764 DS    0H                                                  0777
*       REG3=ADDR(XTNHDDN);                                        0777
         LR    REG3,XTNTPTR                                        0777
*       DEVAREAP=REPIDEVA;                                         0778
         L     @02,@PC00001+8                                      0778
         L     @02,REPIDEVA(,@02)                                  0778
         ST    @02,DEVAREAP                                        0778
*       REG4=DEVAREAP;                                             0779
         LR    REG4,@02                                            0779
*LDEVTYP2:                                                         0780
*       GEN;                                                       0780
LDEVTYP2 DS    0H                                                  0780
         DEVTYPE (3),(4),DEVTAB
*       RESPECIFY                                                  0781
*        (REG3,                                                    0781
*         REG4) UNRESTRICTED;                                      0781
*       RESPECIFY                                                  0782
*         DEVAREA BASED(DEVAREAP);                                 0782
*                                                                  0782
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM DEVTYPE                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0783
*       RESPECIFY                                                  0783
*         RTNREG RSTD;                                             0783
*       TESTRC=RTNREG;                                             0784
         STH   RTNREG,TESTRC                                       0784
*       RESPECIFY                                                  0785
*         RTNREG UNRSTD;                                           0785
*                                                                  0785
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVTYPE FAILS, RETURN TO THE CALLER WITH RC = 12       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0786
*       IF TESTRC^=0 THEN                                          0786
         LH    @04,TESTRC                                          0786
         LTR   @04,@04                                             0786
         BZ    @RF00786                                            0786
*         RETURN CODE(LASTCC12);                                   0787
*                                                                  0787
         LA    @15,12                                              0787
         L     @14,@SA00002                                        0787
         LM    @00,@12,@SA00002+8                                  0787
         BR    @14                                                 0787
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE STAGING PACK IS MOUNTED ON A VIRTUAL UNIT, PREPARE */
*       /* TO RETURN TO THE CALLER WITH RC = 12                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0788
*       IF DEVRVDEV=ON THEN                                        0788
@RF00786 L     @04,DEVAREAP                                        0788
         TM    DEVRVDEV(@04),B'00001000'                           0788
         BNO   @RF00788                                            0788
*         DO;                                                      0789
*                                                                  0789
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31203I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0790
*           DO;                                                    0790
*             CKREQ=CKREQ&&CKREQ;                                  0791
         L     @15,@PC00001+8                                      0791
         XC    CKREQ(44,@15),CKREQ(@15)                            0791
*             CKRERN=MSG03;                                        0792
         MVC   CKRERN(2,@15),@CH00164                              0792
*             CALL IDCRDER;                                        0793
         L     @15,@CV01553                                        0793
         BALR  @14,@15                                             0793
*           END;                                                   0794
*                                                                  0794
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0795
*           RETURN CODE(LASTCC12);                                 0795
         LA    @15,12                                              0795
         L     @14,@SA00002                                        0795
         LM    @00,@12,@SA00002+8                                  0795
         BR    @14                                                 0795
*         END;                                                     0796
*                                                                  0796
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE STARTING ADDRESS CC AND HH AGAINST MAXIMUM        */
*       /* CYLINDER AND TRACK NUMBERS FOR THE DEVICE AS RETURNED BY  */
*       /* DEVTYPE. IF ANY USER-SUPPLIED VALUE IS LARGER THAN THE    */
*       /* CORRESPONDING MAXIMUM FOR THE DEVICE, PREPARE TO RETURN TO*/
*       /* THE CALLER WITH RC = 12                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0797
*       IF XTNHCHR1(1:2)>DEVMAXCCXTNHCHR1(3:4)>DEVMAXHH THEN      0797
@RF00788 L     @04,DEVAREAP                                        0797
         CLC   XTNHCHR1(2,XTNTPTR),DEVMAXCC(@04)                   0797
         BH    @RT00797                                            0797
         CLC   XTNHCHR1+2(2,XTNTPTR),DEVMAXHH(@04)                 0797
         BNH   @RF00797                                            0797
@RT00797 DS    0H                                                  0798
*         DO;                                                      0798
*                                                                  0798
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31205I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0799
*           DO;                                                    0799
*             CKREQ=CKREQ&&CKREQ;                                  0800
         L     @04,@PC00001+8                                      0800
         XC    CKREQ(44,@04),CKREQ(@04)                            0800
*             CKRERN=MSG05;                                        0801
         MVC   CKRERN(2,@04),@CH00288                              0801
*             CKRMVAR(1)=ADDR(XTNHCHR1);                           0802
         LA    @15,XTNHCHR1(,XTNTPTR)                              0802
         ST    @15,CKRMVAR(,@04)                                   0802
*             CALL IDCRDER;                                        0803
         L     @15,@CV01553                                        0803
         BALR  @14,@15                                             0803
*           END;                                                   0804
*                                                                  0804
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0805
*           RETURN CODE(LASTCC12);                                 0805
         LA    @15,12                                              0805
         L     @14,@SA00002                                        0805
         LM    @00,@12,@SA00002+8                                  0805
         BR    @14                                                 0805
*         END;                                                     0806
*                                                                  0806
*       /*************************************************************/
*       /*                                                           */
*       /* IF ENDING ADDRESS IS NOT EQUAL TO STARTING ADDRESS,       */
*       /* COMPARE ENDING ADDRESS CC AND HH AGAINST MAXIMUM CYLINDER */
*       /* AND TRACK NUMBERS FOR THE DEVICE AS RETURNED BY DEVTYPE.  */
*       /* IF ANY USER-SUPPLIED VALUE IS LARGER THAN THE             */
*       /* CORRESPONDING MAXIMUM FOR THE DEVICE, PREPARE TO RETURN TO*/
*       /* THE CALLER WITH RC = 12                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0807
*       IF XTNHCHR1(1:4)^=XTNHCHR2(1:4) THEN                       0807
@RF00797 CLC   XTNHCHR1(4,XTNTPTR),XTNHCHR2(XTNTPTR)               0807
         BE    @RF00807                                            0807
*         DO;                                                      0808
*           IF XTNHCHR2(1:2)>DEVMAXCCXTNHCHR2(3:4)>DEVMAXHH THEN  0809
         L     @04,DEVAREAP                                        0809
         CLC   XTNHCHR2(2,XTNTPTR),DEVMAXCC(@04)                   0809
         BH    @RT00809                                            0809
         CLC   XTNHCHR2+2(2,XTNTPTR),DEVMAXHH(@04)                 0809
         BNH   @RF00809                                            0809
@RT00809 DS    0H                                                  0810
*             DO;                                                  0810
*                                                                  0810
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31205I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0811
*               DO;                                                0811
*                 CKREQ=CKREQ&&CKREQ;                              0812
         L     @04,@PC00001+8                                      0812
         XC    CKREQ(44,@04),CKREQ(@04)                            0812
*                 CKRERN=MSG05;                                    0813
         MVC   CKRERN(2,@04),@CH00288                              0813
*                 CKRMVAR(1)=ADDR(XTNHCHR2);                       0814
         LA    @15,XTNHCHR2(,XTNTPTR)                              0814
         ST    @15,CKRMVAR(,@04)                                   0814
*                 CALL IDCRDER;                                    0815
         L     @15,@CV01553                                        0815
         BALR  @14,@15                                             0815
*               END;                                               0816
*                                                                  0816
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0817
*               RETURN CODE(LASTCC12);                             0817
         LA    @15,12                                              0817
         L     @14,@SA00002                                        0817
         LM    @00,@12,@SA00002+8                                  0817
         BR    @14                                                 0817
*             END;                                                 0818
*         END;                                                     0819
*                                                                  0819
@RF00809 DS    0H                                                  0820
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE WTOR LIST FORM                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0820
*       WTORLIST=LWTORLST;                                         0820
*                                                                  0820
@RF00807 MVC   WTORLIST(84),LWTORLST                               0820
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP DARGLIST TO LOAD IDC498D MESSAGE                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0821
*       DARGL=''B;                                                 0821
         XC    DARGL(20),DARGL                                     0821
*       DDSTRU=ADDR(DARGL);                                        0822
         LA    @04,DARGL                                           0822
         ST    @04,DDSTRU                                          0822
*       DARGRETP=ADDR(WTORLIST)+12;                                0823
         LA    @15,WTORLIST                                        0823
         AL    @15,@CF00039                                        0823
         ST    @15,DARGRETP(,@04)                                  0823
*       DARGSENT=MSG77;                                            0824
         MVI   DARGSENT(@04),X'4D'                                 0824
*       DARGSMOD=WTORID;                                           0825
         MVC   DARGSMOD(3,@04),@CC02814                            0825
*       DARGRETL=LENGTH(WTORLIST)-12;                              0826
*                                                                  0826
         MVC   DARGRETL(2,@04),@CH00818                            0826
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT TO LOAD MESSAGE IDC498D                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0827
*       CALL AMSTP011(GDTTBL,0,DDSTRU);                            0827
*                                                                  0827
         L     @04,@PC00001                                        0827
         ST    @04,@AL00001                                        0827
         LA    @15,@CF00118                                        0827
         ST    @15,@AL00001+4                                      0827
         LA    @15,DDSTRU                                          0827
         ST    @15,@AL00001+8                                      0827
         MVI   @AL00001+8,X'80'                                    0827
         L     @15,GDTPRT(,@04)                                    0827
         LA    @01,@AL00001                                        0827
         BALR  @14,@15                                             0827
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UPRINT                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0828
*       RESPECIFY                                                  0828
*         RTNREG RSTD;                                             0828
*       TESTRC=RTNREG;                                             0829
         STH   RTNREG,TESTRC                                       0829
*       RESPECIFY                                                  0830
*         RTNREG UNRSTD;                                           0830
*                                                                  0830
*       /*************************************************************/
*       /*                                                           */
*       /* IF UPRINT FAILS, RETURN TO THE CALLER WITH RC = 12        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0831
*       IF TESTRC^=0 THEN                                          0831
         LH    @04,TESTRC                                          0831
         LTR   @04,@04                                             0831
         BZ    @RF00831                                            0831
*         RETURN CODE(LASTCC12);                                   0832
*                                                                  0832
         LA    @15,12                                              0832
         L     @14,@SA00002                                        0832
         LM    @00,@12,@SA00002+8                                  0832
         BR    @14                                                 0832
*       /*************************************************************/
*       /*                                                           */
*       /* INSERT VOLSER OF STAGING PACK IN MESSAGE                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0833
*       WTORLIST(64:69)=XTNHVOL;                                   0833
*                                                                  0833
@RF00831 MVC   WTORLIST+63(6),XTNHVOL(XTNTPTR)                     0833
*       /*************************************************************/
*       /*                                                           */
*       /* PROMPT CONSOLE OPERATOR FOR AUTHORIZATION TO ACCESS VOLUME*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0834
*       DO UNTIL(WTOREPLY=Y)(WTOREPLY=N);                         0834
@DL00834 DS    0H                                                  0835
*         WTOREPLY=''B;                                            0835
         MVI   WTOREPLY,X'00'                                      0835
*         WTORECB=''B;                                             0836
         XC    WTORECB(4),WTORECB                                  0836
*         RESPECIFY                                                0837
*           REG3 RESTRICTED;                                       0837
*         REG3=ADDR(WTORLIST);                                     0838
         LA    REG3,WTORLIST                                       0838
*LWTOR2:                                                           0839
*         GEN;                                                     0839
LWTOR2   DS    0H                                                  0839
         WTOR  ,WTOREPLY,1,WTORECB,MF=(E,(3))
         WAIT ECB=WTORECB
         DOM   MSG=(1)
*         RESPECIFY                                                0840
*           REG3 UNRESTRICTED;                                     0840
*       END;                                                       0841
*                                                                  0841
@DE00834 CLI   WTOREPLY,C'Y'                                       0841
         BE    @DC00834                                            0841
         CLI   WTOREPLY,C'N'                                       0841
         BNE   @DL00834                                            0841
@DC00834 DS    0H                                                  0842
*       /*************************************************************/
*       /*                                                           */
*       /* IF REPLY IS 'N', PREPARE TO RETURN TO THE CALLER WITH RC =*/
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0842
*       IF WTOREPLY=N THEN                                         0842
         CLI   WTOREPLY,C'N'                                       0842
         BNE   @RF00842                                            0842
*         DO;                                                      0843
*                                                                  0843
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31206I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0844
*           DO;                                                    0844
*             CKREQ=CKREQ&&CKREQ;                                  0845
         L     @04,@PC00001+8                                      0845
         XC    CKREQ(44,@04),CKREQ(@04)                            0845
*             CKRERN=MSG06;                                        0846
         MVC   CKRERN(2,@04),@CH00035                              0846
*             CKRMVAR(1)=ADDR(XTNHVOL);                            0847
         LA    @15,XTNHVOL(,XTNTPTR)                               0847
         ST    @15,CKRMVAR(,@04)                                   0847
*             CALL IDCRDER;                                        0848
         L     @15,@CV01553                                        0848
         BALR  @14,@15                                             0848
*           END;                                                   0849
*                                                                  0849
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0850
*           RETURN CODE(LASTCC12);                                 0850
         LA    @15,12                                              0850
         L     @14,@SA00002                                        0850
         LM    @00,@12,@SA00002+8                                  0850
         BR    @14                                                 0850
*         END;                                                     0851
*                                                                  0851
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USYSINFO TO OBTAIN THE UCB ADDRESS                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0852
*       SINFPTR=REPISYSI;                                          0852
@RF00842 L     @04,@PC00001+8                                      0852
         L     @04,REPISYSI(,@04)                                  0852
         ST    @04,SINFPTR                                         0852
*       CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);                0853
*                                                                  0853
         L     @04,@PC00001                                        0853
         ST    @04,@AL00001                                        0853
         LA    @15,UNIT                                            0853
         ST    @15,@AL00001+4                                      0853
         LA    @15,SINFPTR                                         0853
         ST    @15,@AL00001+8                                      0853
         ST    XTNTPTR,@AL00001+12                                 0853
         MVI   @AL00001+12,X'80'                                   0853
         L     @15,GDTSFO(,@04)                                    0853
         LA    @01,@AL00001                                        0853
         BALR  @14,@15                                             0853
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM USYSINFO                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0854
*       RESPECIFY                                                  0854
*         RTNREG RSTD;                                             0854
*       TESTRC=RTNREG;                                             0855
         STH   RTNREG,TESTRC                                       0855
*       RESPECIFY                                                  0856
*         RTNREG UNRSTD;                                           0856
*                                                                  0856
*       /*************************************************************/
*       /*                                                           */
*       /* IF USYSINFO FAILS, RETURN TO THE CALLER WITH RC = 12      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0857
*       IF TESTRC^=0 THEN                                          0857
         LH    @04,TESTRC                                          0857
         LTR   @04,@04                                             0857
         BZ    @RF00857                                            0857
*         RETURN CODE(LASTCC12);                                   0858
*                                                                  0858
         LA    @15,12                                              0858
         L     @14,@SA00002                                        0858
         LM    @00,@12,@SA00002+8                                  0858
         BR    @14                                                 0858
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT QNAME, RNAME LENGTH, RNAME                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0859
*       SPQNAME=SYSVTOC;                                           0859
@RF00857 L     @04,@PC00001+8                                      0859
         L     @04,REPQRPTR(,@04)                                  0859
         MVC   SPQNAME(8,@04),@CC02747                             0859
*       SPRLEN=LENGTH(SPRVOL);                                     0860
         MVI   SPRLEN(@04),X'06'                                   0860
*       SPRVOL=XTNHVOL;                                            0861
*                                                                  0861
         MVC   SPRVOL(6,@04),XTNHVOL(XTNTPTR)                      0861
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE URESERVE TO RESERVE THE VOLUME                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0862
*       CALL IDCSARV0(GDTTBL,EXCL,WAIT,SINFAREA,SPQNAME,SPRNAME);  0862
*                                                                  0862
         L     @15,@PC00001                                        0862
         ST    @15,@AL00001                                        0862
         LA    @14,EXCL                                            0862
         ST    @14,@AL00001+4                                      0862
         LA    @14,WAIT                                            0862
         ST    @14,@AL00001+8                                      0862
         L     @01,SINFPTR                                         0862
         ST    @01,@AL00001+12                                     0862
         ST    @04,@AL00001+16                                     0862
         LA    @04,SPRNAME(,@04)                                   0862
         ST    @04,@AL00001+20                                     0862
         MVI   @AL00001+20,X'80'                                   0862
         L     @15,GDTRSV(,@15)                                    0862
         LA    @01,@AL00001                                        0862
         BALR  @14,@15                                             0862
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE RETURN CODE FROM URESERVE                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0863
*       RESPECIFY                                                  0863
*         RTNREG RSTD;                                             0863
*       TESTRC=RTNREG;                                             0864
         STH   RTNREG,TESTRC                                       0864
*       RESPECIFY                                                  0865
*         RTNREG UNRSTD;                                           0865
*                                                                  0865
*       /*************************************************************/
*       /*                                                           */
*       /* IF URESERVE FAILS, PREPARE TO RETURN TO THE CALLER WITH RC*/
*       /* = 12                                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0866
*       IF TESTRC^=0 THEN                                          0866
         LH    @04,TESTRC                                          0866
         LTR   @04,@04                                             0866
         BZ    @RF00866                                            0866
*         RETURN CODE(LASTCC12);                                   0867
*                                                                  0867
         LA    @15,12                                              0867
         L     @14,@SA00002                                        0867
         LM    @00,@12,@SA00002+8                                  0867
         BR    @14                                                 0867
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (EXOARG)                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0868
*       EXOARG=''B;                                                0868
@RF00866 L     @04,@PC00001+8                                      0868
         L     @15,REPEXOAR(,@04)                                  0868
         XC    EXOARG(34,@15),EXOARG(@15)                          0868
*       EXODDN=ADDR(XTNHDDN);                                      0869
         ST    XTNTPTR,EXODDN(,@15)                                0869
*       EXODSN=ADDR(XTNHDSN);                                      0870
         LA    @14,XTNHDSN(,XTNTPTR)                               0870
         ST    @14,EXODSN(,@15)                                    0870
*       EXOCTLBK=ADDR(REPIDSOP);                                   0871
         LA    @04,REPIDSOP(,@04)                                  0871
         ST    @04,EXOCTLBK(,@15)                                  0871
*       EXOREAD=ON;                                                0872
         OI    EXOREAD(@15),B'10000000'                            0872
*       EXOREP=ON;                                                 0873
         OI    EXOREP(@15),B'00000100'                             0873
*       EXOSPK=ON;                                                 0874
         OI    EXOSPK(@15),B'00001000'                             0874
*       EXOEXT=ADDR(XTNHCHR1);                                     0875
*                                                                  0875
         LA    @04,XTNHCHR1(,XTNTPTR)                              0875
         ST    @04,EXOEXT(,@15)                                    0875
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UEXCP OPENR                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0876
*       CALL IDCIO050(GDTTBL,OPENR,EXOARG);                        0876
*                                                                  0876
         L     @04,@PC00001                                        0876
         ST    @04,@AL00001                                        0876
         LA    @14,@CC02024                                        0876
         ST    @14,@AL00001+4                                      0876
         ST    @15,@AL00001+8                                      0876
         MVI   @AL00001+8,X'80'                                    0876
         L     @15,GDTEXP(,@04)                                    0876
         LA    @01,@AL00001                                        0876
         BALR  @14,@15                                             0876
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UEXCP                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0877
*       RESPECIFY                                                  0877
*         RTNREG RSTD;                                             0877
*       TESTRC=RTNREG;                                             0878
         STH   RTNREG,TESTRC                                       0878
*       RESPECIFY                                                  0879
*         RTNREG UNRSTD;                                           0879
*                                                                  0879
*       /*************************************************************/
*       /*                                                           */
*       /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0880
*       IF TESTRC^=0 THEN                                          0880
         LH    @04,TESTRC                                          0880
         LTR   @04,@04                                             0880
         BZ    @RF00880                                            0880
*         DO;                                                      0881
*                                                                  0881
*           /*********************************************************/
*           /*                                                       */
*           /* DEQ THE STAGING PACK                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0882
*           CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);                 0882
*                                                                  0882
         L     @15,@PC00001                                        0882
         ST    @15,@AL00001                                        0882
         L     @14,@PC00001+8                                      0882
         L     @14,REPQRPTR(,@14)                                  0882
         ST    @14,@AL00001+4                                      0882
         LA    @14,SPRNAME(,@14)                                   0882
         ST    @14,@AL00001+8                                      0882
         MVI   @AL00001+8,X'80'                                    0882
         L     @15,GDTDEQ(,@15)                                    0882
         LA    @01,@AL00001                                        0882
         BALR  @14,@15                                             0882
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0883
*           RETURN CODE(LASTCC12);                                 0883
         LA    @15,12                                              0883
         L     @14,@SA00002                                        0883
         LM    @00,@12,@SA00002+8                                  0883
         BR    @14                                                 0883
*         END;                                                     0884
*                                                                  0884
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE REQUIRED BYTES FOR THE I/O BUFFER               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0885
*       REQBYTES=DEVTC+LENGTH(RIOHDR);                             0885
*                                                                  0885
@RF00880 LA    @04,282                                             0885
         L     @01,DEVAREAP                                        0885
         LH    @15,DEVTC(,@01)                                     0885
         N     @15,@CF03043                                        0885
         ALR   @04,@15                                             0885
         ST    @04,REQBYTES                                        0885
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UGPOOL FOR SPACE FOR AN I/O BUFFER.                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0886
*       CALL IDCSAGP0(GDTTBL,REQBYTES,REPIBFPT,RD01,SETZERO);      0886
*                                                                  0886
         L     @04,@PC00001                                        0886
         ST    @04,@AL00001                                        0886
         LA    @15,REQBYTES                                        0886
         ST    @15,@AL00001+4                                      0886
         L     @15,@PC00001+8                                      0886
         LA    @15,REPIBFPT(,@15)                                  0886
         ST    @15,@AL00001+8                                      0886
         LA    @15,@CC02759                                        0886
         ST    @15,@AL00001+12                                     0886
         LA    @15,SETZERO                                         0886
         ST    @15,@AL00001+16                                     0886
         MVI   @AL00001+16,X'80'                                   0886
         L     @15,GDTGPL(,@04)                                    0886
         LA    @01,@AL00001                                        0886
         BALR  @14,@15                                             0886
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UGPOOL                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0887
*       RESPECIFY                                                  0887
*         RTNREG RSTD;                                             0887
*       TESTRC=RTNREG;                                             0888
         STH   RTNREG,TESTRC                                       0888
*       RESPECIFY                                                  0889
*         RTNREG UNRSTD;                                           0889
*                                                                  0889
*       /*************************************************************/
*       /*                                                           */
*       /* IF UGPOOL FAILS, PREPARE TO RETURN TO THE CALLER WITH RC =*/
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0890
*       IF TESTRC^=0 THEN                                          0890
         LH    @04,TESTRC                                          0890
         LTR   @04,@04                                             0890
         BZ    @RF00890                                            0890
*         DO;                                                      0891
*                                                                  0891
*           /*********************************************************/
*           /*                                                       */
*           /* CLOSE THE STAGING PACK                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0892
*           CALL IDCIO050(GDTTBL,CLOSE,REPIDSOP);                  0892
*                                                                  0892
         L     @15,@PC00001                                        0892
         ST    @15,@AL00001                                        0892
         LA    @14,CLOSE                                           0892
         ST    @14,@AL00001+4                                      0892
         L     @14,@PC00001+8                                      0892
         LA    @14,REPIDSOP(,@14)                                  0892
         ST    @14,@AL00001+8                                      0892
         MVI   @AL00001+8,X'80'                                    0892
         L     @15,GDTEXP(,@15)                                    0892
         LA    @01,@AL00001                                        0892
         BALR  @14,@15                                             0892
*           /*********************************************************/
*           /*                                                       */
*           /* DEQ THE STAGING PACK                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0893
*           CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);                 0893
*                                                                  0893
         L     @15,@PC00001                                        0893
         ST    @15,@AL00001                                        0893
         L     @14,@PC00001+8                                      0893
         L     @14,REPQRPTR(,@14)                                  0893
         ST    @14,@AL00001+4                                      0893
         LA    @14,SPRNAME(,@14)                                   0893
         ST    @14,@AL00001+8                                      0893
         MVI   @AL00001+8,X'80'                                    0893
         L     @15,GDTDEQ(,@15)                                    0893
         LA    @01,@AL00001                                        0893
         BALR  @14,@15                                             0893
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE UNIVERSAL TEXT MESSAGE IDC3004I                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0894
*           DO;                                                    0894
*             CKREQ=CKREQ&&CKREQ;                                  0895
         L     @15,@PC00001+8                                      0895
         XC    CKREQ(44,@15),CKREQ(@15)                            0895
*             CKRERN=MSG93;                                        0896
         MVC   CKRERN(2,@15),@CH00866                              0896
*             CALL IDCRDER;                                        0897
         L     @15,@CV01553                                        0897
         BALR  @14,@15                                             0897
*           END;                                                   0898
*                                                                  0898
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0899
*           RETURN CODE(LASTCC12);                                 0899
         LA    @15,12                                              0899
         L     @14,@SA00002                                        0899
         LM    @00,@12,@SA00002+8                                  0899
         BR    @14                                                 0899
*         END;                                                     0900
*                                                                  0900
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE FIRST AND ONLY EXTENT TABLE ENTRY           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0901
*       I=1;                                                       0901
@RF00890 L     @04,@PC00001+8                                      0901
         LA    @15,1                                               0901
         STC   @15,I(,@04)                                         0901
*       XTNTDDN(I)=XTNHDDN;                                        0902
         LA    @14,78                                              0902
         LR    @01,@15                                             0902
         MR    @00,@14                                             0902
         ST    @01,@TF00001                                        0902
         ALR   @01,XTNTPTR                                         0902
         MVC   XTNTDDN-78(8,@01),XTNHDDN(XTNTPTR)                  0902
*       XTNTDSN(I)=XTNHDSN;                                        0903
         LR    @01,XTNTPTR                                         0903
         AL    @01,@TF00001                                        0903
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 0903
*       XTNTCHR1(I)=XTNHCHR1;                                      0904
         LR    @01,XTNTPTR                                         0904
         AL    @01,@TF00001                                        0904
         MVC   XTNTCHR1-78(5,@01),XTNHCHR1(XTNTPTR)                0904
*       XTNTCHR2(I)=XTNHCHR2;                                      0905
         LR    @01,XTNTPTR                                         0905
         AL    @01,@TF00001                                        0905
         MVC   XTNTCHR2-78(5,@01),XTNHCHR2(XTNTPTR)                0905
*       XTNTVOLN(I)=XTNHVOLN;                                      0906
         LR    @01,XTNTPTR                                         0906
         AL    @01,@TF00001                                        0906
         MVC   XTNTVOLN-78(1,@01),XTNHVOLN(XTNTPTR)                0906
*       XTNTVOL(I)=XTNHVOL;                                        0907
*                                                                  0907
         LR    @01,XTNTPTR                                         0907
         AL    @01,@TF00001                                        0907
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  0907
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE NEXT EXTENT TABLE ENTRY TO X'FF' TO INDICATE THE  */
*       /* LAST ENTRY.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0908
*       I=I+1;                                                     0908
         AL    @15,@CF00221                                        0908
         STC   @15,I(,@04)                                         0908
*       XTNTENT(I)=LASTENT;                                        0909
*                                                                  0909
         MR    @14,@14                                             0909
         ALR   @15,XTNTPTR                                         0909
         MVC   XTNTENT-78(78,@15),LASTENT                          0909
*       /*************************************************************/
*       /*                                                           */
*       /* SET FIRST BYTE OF BUFFER AREA TO X'FF' TO INDICATE TO     */
*       /* UEXCP THE AREA HAS NOT BEEN USED BEFORE                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0910
*       RESPECIFY                                                  0910
*         RIOAREA BASED(REPIBFPT);                                 0910
*       RFIRST='FF'X;                                              0911
*                                                                  0911
         L     @01,REPIBFPT(,@04)                                  0911
         MVI   RFIRST(@01),X'FF'                                   0911
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 00                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0912
*       RETURN CODE(LASTCC00);                                     0912
         SLR   @15,@15                                             0912
         L     @14,@SA00002                                        0912
         LM    @00,@12,@SA00002+8                                  0912
         BR    @14                                                 0912
*     END DSSTGPK;                                                 0913
*                                                                  0914
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A DATA SET                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0914
*   IF ADDR(DSRNG)^=NULLPTRADDR(CDSRG)^=NULLPTRADDR(MIDSA)^=NULLPTR
*       ADDR(MODSA)^=NULLPTR THEN                                  0914
@RF00655 SLR   @04,@04                                             0914
         L     @15,@PC00001+4                                      0914
         C     @04,FDTPTR+24(,@15)                                 0914
         BNE   @RT00914                                            0914
         C     @04,FDTPTR+152(,@15)                                0914
         BNE   @RT00914                                            0914
         C     @04,FDTPTR+384(,@15)                                0914
         BNE   @RT00914                                            0914
         C     @04,FDTPTR+408(,@15)                                0914
         BE    @RF00914                                            0914
@RT00914 DS    0H                                                  0915
*     DO;                                                          0915
*                                                                  0915
*       /*************************************************************/
*       /*                                                           */
*       /* GET DDNAME, ADDRESS OF UIOINFO RETURN AREA, AND ADDRESS OF*/
*       /* EXTENT TABLE BUILD AREA INTO A COMMON FIELD AND POINTERS  */
*       /* FOR EACH TYPE OF REQUEST                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0916
*       IF ADDR(DISPL)^=NULLPTR THEN                               0916
         SLR   @15,@15                                             0916
         L     @14,@PC00001+4                                      0916
         C     @15,FDTPTR(,@14)                                    0916
         BE    @RF00916                                            0916
*         DO;                                                      0917
*           IF ADDR(INFIL)^=NULLPTR THEN                           0918
         L     @14,FDTPTR+12(,@14)                                 0918
         CR    @14,@15                                             0918
         BE    @RF00918                                            0918
*             INFODD=INFILVAL;                                     0919
         MVC   INFODD(8),INFILVAL(@14)                             0919
*           INFOPTR=REPIINFO;                                      0920
@RF00918 L     @04,@PC00001+8                                      0920
         L     @15,REPIINFO(,@04)                                  0920
         ST    @15,INFOPTR                                         0920
*           XTNTPTR=REPIXTNT;                                      0921
         L     XTNTPTR,REPIXTNT(,@04)                              0921
*         END;                                                     0922
*       ELSE                                                       0923
*         IF ADDR(COPY)^=NULLPTR THEN                              0923
         B     @RC00916                                            0923
@RF00916 SLR   @15,@15                                             0923
         L     @14,@PC00001+4                                      0923
         C     @15,FDTPTR+136(,@14)                                0923
         BE    @RF00923                                            0923
*           DO;                                                    0924
*             IF ADDR(CINFL)^=NULLPTR THEN                         0925
         L     @14,FDTPTR+140(,@14)                                0925
         CR    @14,@15                                             0925
         BE    @RF00925                                            0925
*               INFODD=CINFLVAL;                                   0926
         MVC   INFODD(8),CINFLVAL(@14)                             0926
*             INFOPTR=REPIINFO;                                    0927
@RF00925 L     @04,@PC00001+8                                      0927
         L     @15,REPIINFO(,@04)                                  0927
         ST    @15,INFOPTR                                         0927
*             XTNTPTR=REPIXTNT;                                    0928
         L     XTNTPTR,REPIXTNT(,@04)                              0928
*           END;                                                   0929
*         ELSE                                                     0930
*           IF ADDR(MODIF)^=NULLPTR&IOPARM=INPUT THEN              0930
         B     @RC00923                                            0930
@RF00923 SLR   @15,@15                                             0930
         L     @14,@PC00001+4                                      0930
         C     @15,FDTPTR+356(,@14)                                0930
         BE    @RF00930                                            0930
         L     @05,@PC00002                                        0930
         CLI   IOPARM(@05),C'I'                                    0930
         BNE   @RF00930                                            0930
*             DO;                                                  0931
*               IF ADDR(MINFL)^=NULLPTR THEN                       0932
         L     @14,FDTPTR+372(,@14)                                0932
         CR    @14,@15                                             0932
         BE    @RF00932                                            0932
*                 INFODD=MINFLVAL;                                 0933
         MVC   INFODD(8),MINFLVAL(@14)                             0933
*               INFOPTR=REPIINFO;                                  0934
@RF00932 L     @04,@PC00001+8                                      0934
         L     @15,REPIINFO(,@04)                                  0934
         ST    @15,INFOPTR                                         0934
*               XTNTPTR=REPIXTNT;                                  0935
         L     XTNTPTR,REPIXTNT(,@04)                              0935
*             END;                                                 0936
*           ELSE                                                   0937
*             DO;                                                  0937
         B     @RC00930                                            0937
@RF00930 DS    0H                                                  0938
*               IF ADDR(MOUTF)^=NULLPTR THEN                       0938
         L     @15,@PC00001+4                                      0938
         L     @15,FDTPTR+412(,@15)                                0938
         LTR   @15,@15                                             0938
         BZ    @RF00938                                            0938
*                 INFODD=MOUTFVAL;                                 0939
         MVC   INFODD(8),MOUTFVAL(@15)                             0939
*               INFOPTR=REPOINFO;                                  0940
@RF00938 L     @04,@PC00001+8                                      0940
         L     @15,REPOINFO(,@04)                                  0940
         ST    @15,INFOPTR                                         0940
*               XTNTPTR=REPOXTNT;                                  0941
         L     XTNTPTR,REPOXTNT(,@04)                              0941
*             END;                                                 0942
*     END;                                                         0943
*                                                                  0943
@RC00930 DS    0H                                                  0943
@RC00923 DS    0H                                                  0943
@RC00916 DS    0H                                                  0944
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR DISPLAY, VALIDATE THE CCHHR AND CCHHR LENGTHS AND BUILD   */
*   /* THE EXTENT TABLE HEADER                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0944
*   IF ADDR(DISPL)^=NULLPTR THEN                                   0944
@RF00914 L     @04,@PC00001+4                                      0944
         L     @04,FDTPTR(,@04)                                    0944
         LTR   @04,@04                                             0944
         BZ    @RF00944                                            0944
*DSETDISP:                                                         0945
*     DO;                                                          0945
*                                                                  0945
DSETDISP DS    0H                                                  0946
*       /*************************************************************/
*       /*                                                           */
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (FROM CCHHR) MUST*/
*       /* BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE CALLER WITH  */
*       /* RC = 12                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0946
*       IF DSCHRLEN^=LENGTH(DSCHRVAL) THEN                         0946
         L     @04,@PC00001+4                                      0946
         L     @01,FDTPTR+84(,@04)                                 0946
         CLI   DSCHRLEN(@01),5                                     0946
         BE    @RF00946                                            0946
*         DO;                                                      0947
*                                                                  0947
*           /*********************************************************/
*           /*                                                       */
*           /* IF DATA SET NAME SPECIFIED (OS/VS2 ONLY), GET DSNAME  */
*           /* FROM FDT                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0948
*           IF ADDR(INDS)^=NULLPTR THEN                            0948
         L     @04,FDTPTR+16(,@04)                                 0948
         LTR   @04,@04                                             0948
         BZ    @RF00948                                            0948
*             XTNHDSN=INDSVAL;                                     0949
*                                                                  0949
         MVC   XTNHDSN(44,XTNTPTR),INDSVAL(@04)                    0949
*           /*********************************************************/
*           /*                                                       */
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS.               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0950
*           ELSE                                                   0950
*             CALL IDCRDIN;                                        0950
*                                                                  0950
         B     @RC00948                                            0950
@RF00948 BAL   @14,IDCRDIN                                         0950
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31233I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0951
*           DO;                                                    0951
@RC00948 DS    0H                                                  0952
*             CKREQ=CKREQ&&CKREQ;                                  0952
         L     @04,@PC00001+8                                      0952
         XC    CKREQ(44,@04),CKREQ(@04)                            0952
*             CKRERN=MSG33;                                        0953
         MVC   CKRERN(2,@04),@CH02800                              0953
*             CKRMVAR(1)=ADDR(DSRANGE);                            0954
         LA    @15,@CC02833                                        0954
         ST    @15,CKRMVAR(,@04)                                   0954
*             CKRMVAR(2)=ADDR(DSCHRVAL);                           0955
         L     @15,@PC00001+4                                      0955
         L     @15,FDTPTR+84(,@15)                                 0955
         LA    @14,DSCHRVAL(,@15)                                  0955
         ST    @14,CKRMVAR+4(,@04)                                 0955
*             CKRMVAR(3)=ADDR(XTNHDSN);                            0956
         LA    @14,XTNHDSN(,XTNTPTR)                               0956
         ST    @14,CKRMVAR+8(,@04)                                 0956
*             CKRMVAR(4)=ADDR(DSCHRLEN);                           0957
         ST    @15,CKRMVAR+12(,@04)                                0957
*             CALL IDCRDER;                                        0958
         L     @15,@CV01553                                        0958
         BALR  @14,@15                                             0958
*           END;                                                   0959
*                                                                  0959
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0960
*           RETURN CODE(LASTCC12);                                 0960
         LA    @15,12                                              0960
         L     @14,@SA00002                                        0960
         LM    @00,@12,@SA00002+8                                  0960
         BR    @14                                                 0960
*         END;                                                     0961
*                                                                  0961
*       /*************************************************************/
*       /*                                                           */
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (TO CCHHR) MUST  */
*       /* BE 0 OR 5 BYTES, IF NOT, PREPARE TO RETURN TO THE CALLER  */
*       /* WITH RC = 12                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0962
*       IF ADDR(DSCHH)^=NULLPTR&DSCHHLEN^=LENGTH(DSCHHVAL) THEN    0962
@RF00946 SLR   @04,@04                                             0962
         L     @15,@PC00001+4                                      0962
         L     @14,FDTPTR+88(,@15)                                 0962
         CR    @14,@04                                             0962
         BE    @RF00962                                            0962
         CLI   DSCHHLEN(@14),5                                     0962
         BE    @RF00962                                            0962
*         DO;                                                      0963
*                                                                  0963
*           /*********************************************************/
*           /*                                                       */
*           /* IF DATA SET NAME SPECIFIED (OS/VS2 ONLY), GET DSNAME  */
*           /* FROM FDT                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0964
*           IF ADDR(INDS)^=NULLPTR THEN                            0964
         L     @15,FDTPTR+16(,@15)                                 0964
         CR    @15,@04                                             0964
         BE    @RF00964                                            0964
*             XTNHDSN=INDSVAL;                                     0965
*                                                                  0965
         MVC   XTNHDSN(44,XTNTPTR),INDSVAL(@15)                    0965
*           /*********************************************************/
*           /*                                                       */
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS.               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0966
*           ELSE                                                   0966
*             CALL IDCRDIN;                                        0966
*                                                                  0966
         B     @RC00964                                            0966
@RF00964 BAL   @14,IDCRDIN                                         0966
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC3233I                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0967
*           DO;                                                    0967
@RC00964 DS    0H                                                  0968
*             CKREQ=CKREQ&&CKREQ;                                  0968
         L     @04,@PC00001+8                                      0968
         XC    CKREQ(44,@04),CKREQ(@04)                            0968
*             CKRERN=MSG33;                                        0969
         MVC   CKRERN(2,@04),@CH02800                              0969
*             CKRMVAR(1)=ADDR(DSRANGE);                            0970
         LA    @15,@CC02833                                        0970
         ST    @15,CKRMVAR(,@04)                                   0970
*             CKRMVAR(2)=ADDR(DSCHHVAL);                           0971
         L     @15,@PC00001+4                                      0971
         L     @15,FDTPTR+88(,@15)                                 0971
         LA    @14,DSCHHVAL(,@15)                                  0971
         ST    @14,CKRMVAR+4(,@04)                                 0971
*             CKRMVAR(3)=ADDR(XTNHDSN);                            0972
         LA    @14,XTNHDSN(,XTNTPTR)                               0972
         ST    @14,CKRMVAR+8(,@04)                                 0972
*             CKRMVAR(4)=ADDR(DSCHHLEN);                           0973
         ST    @15,CKRMVAR+12(,@04)                                0973
*             CALL IDCRDER;                                        0974
         L     @15,@CV01553                                        0974
         BALR  @14,@15                                             0974
*           END;                                                   0975
*                                                                  0975
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0976
*           RETURN CODE(LASTCC12);                                 0976
         LA    @15,12                                              0976
         L     @14,@SA00002                                        0976
         LM    @00,@12,@SA00002+8                                  0976
         BR    @14                                                 0976
*         END;                                                     0977
*                                                                  0977
*       /*************************************************************/
*       /*                                                           */
*       /* THE DATASETRANGE PARAMETER IS VALIDATED, CONSTRUCT THE    */
*       /* EXTENT TABLE HEADER SETUP USER SUPPLIED RANGE IN XTNTTBL  */
*       /* HEADER                                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0978
*       IF ADDR(DSCHH)=NULLPTR THEN                                0978
@RF00962 L     @04,@PC00001+4                                      0978
         L     @15,FDTPTR+88(,@04)                                 0978
         LTR   @15,@15                                             0978
         BNZ   @RF00978                                            0978
*         XTNHCHR2=DSCHRVAL;                                       0979
         L     @04,FDTPTR+84(,@04)                                 0979
         MVC   XTNHCHR2(5,XTNTPTR),DSCHRVAL(@04)                   0979
*       ELSE                                                       0980
*         XTNHCHR2=DSCHHVAL;                                       0980
         B     @RC00978                                            0980
@RF00978 L     @04,@PC00001+4                                      0980
         L     @04,FDTPTR+88(,@04)                                 0980
         MVC   XTNHCHR2(5,XTNTPTR),DSCHHVAL(@04)                   0980
*       XTNHCHR1=DSCHRVAL;                                         0981
*                                                                  0981
@RC00978 L     @04,@PC00001+4                                      0981
         L     @01,FDTPTR+84(,@04)                                 0981
         MVC   XTNHCHR1(5,XTNTPTR),DSCHRVAL(@01)                   0981
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN      */
*       /* XTNTTBL HEADER                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0982
*       IF ADDR(INDS)^=NULLPTR THEN                                0982
         L     @04,FDTPTR+16(,@04)                                 0982
         LTR   @04,@04                                             0982
         BZ    @RF00982                                            0982
*         DO;                                                      0983
*           XTNHDSN=INDSVAL;                                       0984
         MVC   XTNHDSN(44,XTNTPTR),INDSVAL(@04)                    0984
*           XTNHDDN=BLANKS;                                        0985
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           0985
*           XTNHPWD=INDSPAS;                                       0986
         MVC   XTNHPWD(8,XTNTPTR),INDSPAS(@04)                     0986
*         END;                                                     0987
*       ELSE                                                       0988
*         DO;                                                      0988
         B     @RC00982                                            0988
@RF00982 DS    0H                                                  0989
*           XTNHDSN=BLANKS;                                        0989
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          0989
*           XTNHDDN=INFILVAL;                                      0990
         L     @04,@PC00001+4                                      0990
         L     @04,FDTPTR+12(,@04)                                 0990
         MVC   XTNHDDN(8,XTNTPTR),INFILVAL(@04)                    0990
*           XTNHPWD=INFILPAS;                                      0991
         MVC   XTNHPWD(8,XTNTPTR),INFILPAS(@04)                    0991
*         END;                                                     0992
*                                                                  0992
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET      */
*       /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO INPUT IN   */
*       /* XTNTTBL HEADER                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0993
*       XTNHVOLN=1;                                                0993
@RC00982 MVI   XTNHVOLN(XTNTPTR),X'01'                             0993
*       XTNHVOL=VOLDSVAL;                                          0994
         L     @04,@PC00001+4                                      0994
         L     @04,FDTPTR+80(,@04)                                 0994
         MVC   XTNHVOL(6,XTNTPTR),VOLDSVAL(@04)                    0994
*       XTNHMODE=INPUT;                                            0995
         MVI   XTNHMODE(XTNTPTR),C'I'                              0995
*     END DSETDISP;                                                0996
*                                                                  0997
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR COPY, VALIDATE THE CCHHR AND HHR LENGTHS AND BUILD THE    */
*   /* EXTENT TABLE HEADER                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0997
*   IF ADDR(COPY)^=NULLPTR THEN                                    0997
@RF00944 L     @04,@PC00001+4                                      0997
         L     @04,FDTPTR+136(,@04)                                0997
         LTR   @04,@04                                             0997
         BZ    @RF00997                                            0997
*DSETCOPY:                                                         0998
*     DO;                                                          0998
*                                                                  0998
DSETCOPY DS    0H                                                  0999
*       /*************************************************************/
*       /*                                                           */
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (FROM CCHHR),    */
*       /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE CALLER  */
*       /* WITH RC = 12                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0999
*       IF CDCHRLEN^=LENGTH(CDCHRVAL) THEN                         0999
         L     @04,@PC00001+4                                      0999
         L     @01,FDTPTR+172(,@04)                                0999
         CLI   CDCHRLEN(@01),5                                     0999
         BE    @RF00999                                            0999
*         DO;                                                      1000
*                                                                  1000
*           /*********************************************************/
*           /*                                                       */
*           /* IF DATA SET NAME SPECIFIED (OS/VS2 ONLY), GET DSNAME  */
*           /* FROM FDT                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1001
*           IF ADDR(CINDS)^=NULLPTR THEN                           1001
         L     @04,FDTPTR+144(,@04)                                1001
         LTR   @04,@04                                             1001
         BZ    @RF01001                                            1001
*             XTNHDSN=CINDSVAL;                                    1002
*                                                                  1002
         MVC   XTNHDSN(44,XTNTPTR),CINDSVAL(@04)                   1002
*           /*********************************************************/
*           /*                                                       */
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS.               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1003
*           ELSE                                                   1003
*             CALL IDCRDIN;                                        1003
*                                                                  1003
         B     @RC01001                                            1003
@RF01001 BAL   @14,IDCRDIN                                         1003
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC3233I                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1004
*           DO;                                                    1004
@RC01001 DS    0H                                                  1005
*             CKREQ=CKREQ&&CKREQ;                                  1005
         L     @04,@PC00001+8                                      1005
         XC    CKREQ(44,@04),CKREQ(@04)                            1005
*             CKRERN=MSG33;                                        1006
         MVC   CKRERN(2,@04),@CH02800                              1006
*             CKRMVAR(1)=ADDR(DSRANGE);                            1007
         LA    @15,@CC02833                                        1007
         ST    @15,CKRMVAR(,@04)                                   1007
*             CKRMVAR(2)=ADDR(CDCHRVAL);                           1008
         L     @15,@PC00001+4                                      1008
         L     @15,FDTPTR+172(,@15)                                1008
         LA    @14,CDCHRVAL(,@15)                                  1008
         ST    @14,CKRMVAR+4(,@04)                                 1008
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1009
         LA    @14,XTNHDSN(,XTNTPTR)                               1009
         ST    @14,CKRMVAR+8(,@04)                                 1009
*             CKRMVAR(4)=ADDR(CDCHRLEN);                           1010
         ST    @15,CKRMVAR+12(,@04)                                1010
*             CALL IDCRDER;                                        1011
         L     @15,@CV01553                                        1011
         BALR  @14,@15                                             1011
*           END;                                                   1012
*                                                                  1012
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1013
*           RETURN CODE(LASTCC12);                                 1013
         LA    @15,12                                              1013
         L     @14,@SA00002                                        1013
         LM    @00,@12,@SA00002+8                                  1013
         BR    @14                                                 1013
*         END;                                                     1014
*                                                                  1014
*       /*************************************************************/
*       /*                                                           */
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (TO HHR) MUST BE */
*       /* EQUAL TO 0 OR 3 BYTES. IF NOT, PREPARE TO RETURN TO THE   */
*       /* CALLER WITH RC = 12                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1015
*       IF ADDR(CDHHR)^=NULLPTR&CDHHRLEN^=LENGTH(CDHHRVAL) THEN    1015
@RF00999 SLR   @04,@04                                             1015
         L     @15,@PC00001+4                                      1015
         L     @14,FDTPTR+176(,@15)                                1015
         CR    @14,@04                                             1015
         BE    @RF01015                                            1015
         CLI   CDHHRLEN(@14),3                                     1015
         BE    @RF01015                                            1015
*         DO;                                                      1016
*                                                                  1016
*           /*********************************************************/
*           /*                                                       */
*           /* IF DATA SET NAME IS SPECIFIED (OS/VS2 ONLY), GET      */
*           /* DSNAME FROM THE FDT                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1017
*           IF ADDR(CINDS)^=NULLPTR THEN                           1017
         L     @15,FDTPTR+144(,@15)                                1017
         CR    @15,@04                                             1017
         BE    @RF01017                                            1017
*             XTNHDSN=CINDSVAL;                                    1018
*                                                                  1018
         MVC   XTNHDSN(44,XTNTPTR),CINDSVAL(@15)                   1018
*           /*********************************************************/
*           /*                                                       */
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1019
*           ELSE                                                   1019
*             CALL IDCRDIN;                                        1019
*                                                                  1019
         B     @RC01017                                            1019
@RF01017 BAL   @14,IDCRDIN                                         1019
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC3233I                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1020
*           DO;                                                    1020
@RC01017 DS    0H                                                  1021
*             CKREQ=CKREQ&&CKREQ;                                  1021
         L     @04,@PC00001+8                                      1021
         XC    CKREQ(44,@04),CKREQ(@04)                            1021
*             CKRERN=MSG33;                                        1022
         MVC   CKRERN(2,@04),@CH02800                              1022
*             CKRMVAR(1)=ADDR(DSRANGE);                            1023
         LA    @15,@CC02833                                        1023
         ST    @15,CKRMVAR(,@04)                                   1023
*             CKRMVAR(2)=ADDR(CDHHRVAL);                           1024
         L     @15,@PC00001+4                                      1024
         L     @15,FDTPTR+176(,@15)                                1024
         LA    @14,CDHHRVAL(,@15)                                  1024
         ST    @14,CKRMVAR+4(,@04)                                 1024
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1025
         LA    @14,XTNHDSN(,XTNTPTR)                               1025
         ST    @14,CKRMVAR+8(,@04)                                 1025
*             CKRMVAR(4)=ADDR(CDHHRLEN);                           1026
         ST    @15,CKRMVAR+12(,@04)                                1026
*             CALL IDCRDER;                                        1027
         L     @15,@CV01553                                        1027
         BALR  @14,@15                                             1027
*           END;                                                   1028
*                                                                  1028
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1029
*           RETURN CODE(LASTCC12);                                 1029
         LA    @15,12                                              1029
         L     @14,@SA00002                                        1029
         LM    @00,@12,@SA00002+8                                  1029
         BR    @14                                                 1029
*         END;                                                     1030
*                                                                  1030
*       /*************************************************************/
*       /*                                                           */
*       /* THE DATASETRANGE PARAMETER IS VALIDATED, CONSTRUCT THE    */
*       /* EXTENT TABLE HEADER SETUP USER SUPPLIED RANGE IN XTNTTBL  */
*       /* HEADER                                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1031
*       IF ADDR(CDHHR)=NULLPTR THEN                                1031
@RF01015 L     @04,@PC00001+4                                      1031
         L     @15,FDTPTR+176(,@04)                                1031
         LTR   @15,@15                                             1031
         BNZ   @RF01031                                            1031
*         XTNHCHR2=CDCHRVAL;                                       1032
         L     @04,FDTPTR+172(,@04)                                1032
         MVC   XTNHCHR2(5,XTNTPTR),CDCHRVAL(@04)                   1032
*       ELSE                                                       1033
*         DO;                                                      1033
         B     @RC01031                                            1033
@RF01031 DS    0H                                                  1034
*           XTNHCHR2(1:2)=CDCHRVAL;                                1034
         L     @04,@PC00001+4                                      1034
         L     @01,FDTPTR+172(,@04)                                1034
         MVC   XTNHCHR2(2,XTNTPTR),CDCHRVAL(@01)                   1034
*           XTNHCHR2(3:5)=CDHHRVAL;                                1035
         L     @04,FDTPTR+176(,@04)                                1035
         MVC   XTNHCHR2+2(3,XTNTPTR),CDHHRVAL(@04)                 1035
*         END;                                                     1036
*       XTNHCHR1=CDCHRVAL;                                         1037
*                                                                  1037
@RC01031 L     @04,@PC00001+4                                      1037
         L     @01,FDTPTR+172(,@04)                                1037
         MVC   XTNHCHR1(5,XTNTPTR),CDCHRVAL(@01)                   1037
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN      */
*       /* XTNTTBL HEADER                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1038
*       IF ADDR(CINDS)^=NULLPTR THEN                               1038
         L     @04,FDTPTR+144(,@04)                                1038
         LTR   @04,@04                                             1038
         BZ    @RF01038                                            1038
*         DO;                                                      1039
*           XTNHDSN=CINDSVAL;                                      1040
         MVC   XTNHDSN(44,XTNTPTR),CINDSVAL(@04)                   1040
*           XTNHDDN=BLANKS;                                        1041
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           1041
*           XTNHPWD=CINDSPAS;                                      1042
         MVC   XTNHPWD(8,XTNTPTR),CINDSPAS(@04)                    1042
*         END;                                                     1043
*       ELSE                                                       1044
*         DO;                                                      1044
         B     @RC01038                                            1044
@RF01038 DS    0H                                                  1045
*           XTNHDSN=BLANKS;                                        1045
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1045
*           XTNHDDN=CINFLVAL;                                      1046
         L     @04,@PC00001+4                                      1046
         L     @04,FDTPTR+140(,@04)                                1046
         MVC   XTNHDDN(8,XTNTPTR),CINFLVAL(@04)                    1046
*           XTNHPWD=CINFLPAS;                                      1047
         MVC   XTNHPWD(8,XTNTPTR),CINFLPAS(@04)                    1047
*         END;                                                     1048
*                                                                  1048
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET      */
*       /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO INPUT IN   */
*       /* XTNTTBL HEADER                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1049
*       XTNHVOLN=1;                                                1049
@RC01038 MVI   XTNHVOLN(XTNTPTR),X'01'                             1049
*       XTNHVOL=CVOLDVAL;                                          1050
         L     @04,@PC00001+4                                      1050
         L     @04,FDTPTR+168(,@04)                                1050
         MVC   XTNHVOL(6,XTNTPTR),CVOLDVAL(@04)                    1050
*       XTNHMODE=INPUT;                                            1051
         MVI   XTNHMODE(XTNTPTR),C'I'                              1051
*     END DSETCOPY;                                                1052
*                                                                  1053
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR MODIFY INPUT, VALIDATE THE CCHHR LENGTH AND CONSTRUCT THE */
*   /* EXTENT TABLE HEADER                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1053
*   IF ADDR(MODIF)^=NULLPTR THEN                                   1053
@RF00997 L     @04,@PC00001+4                                      1053
         L     @04,FDTPTR+356(,@04)                                1053
         LTR   @04,@04                                             1053
         BZ    @RF01053                                            1053
*     DO;                                                          1054
*       IF IOPARM=INPUT THEN                                       1055
         L     @04,@PC00002                                        1055
         CLI   IOPARM(@04),C'I'                                    1055
         BNE   @RF01055                                            1055
*DSETMODI:                                                         1056
*         DO;                                                      1056
*                                                                  1056
DSETMODI DS    0H                                                  1057
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE INDATASETADDRESS PARAMETER (CCHHR)  */
*           /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE     */
*           /* CALLER WITH RC = 12                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1057
*           IF MIDCHLEN^=LENGTH(MIDCHVAL) THEN                     1057
         L     @04,@PC00001+4                                      1057
         L     @01,FDTPTR+448(,@04)                                1057
         CLI   MIDCHLEN(@01),5                                     1057
         BE    @RF01057                                            1057
*             DO;                                                  1058
*                                                                  1058
*               /*****************************************************/
*               /*                                                   */
*               /* IF DATA SET NAME IS SPECIFIED (OS/VS2 ONLY), GET  */
*               /* DSNAME FROM FDT                                   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1059
*               IF ADDR(MINDS)^=NULLPTR THEN                       1059
         L     @04,FDTPTR+376(,@04)                                1059
         LTR   @04,@04                                             1059
         BZ    @RF01059                                            1059
*                 XTNHDSN=MINDSVAL;                                1060
*                                                                  1060
         MVC   XTNHDSN(44,XTNTPTR),MINDSVAL(@04)                   1060
*               /*****************************************************/
*               /*                                                   */
*               /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA  */
*               /* SET NAME AND MOVE IT INTO FIELD XTNHDSN IN        */
*               /* XTNTTBL. IF UIOINFO FAILS OR IF THE DATA SET NAME */
*               /* CANNOT BE LOCATED, XTNHDSN WILL BE SET TO BLANKS. */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1061
*               ELSE                                               1061
*                 CALL IDCRDIN;                                    1061
*                                                                  1061
         B     @RC01059                                            1061
@RF01059 BAL   @14,IDCRDIN                                         1061
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31233I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1062
*               DO;                                                1062
@RC01059 DS    0H                                                  1063
*                 CKREQ=CKREQ&&CKREQ;                              1063
         L     @04,@PC00001+8                                      1063
         XC    CKREQ(44,@04),CKREQ(@04)                            1063
*                 CKRERN=MSG33;                                    1064
         MVC   CKRERN(2,@04),@CH02800                              1064
*                 CKRMVAR(1)=ADDR(INDSADD);                        1065
         LA    @15,@CC02836                                        1065
         ST    @15,CKRMVAR(,@04)                                   1065
*                 CKRMVAR(2)=ADDR(MIDCHVAL);                       1066
         L     @15,@PC00001+4                                      1066
         L     @15,FDTPTR+448(,@15)                                1066
         LA    @14,MIDCHVAL(,@15)                                  1066
         ST    @14,CKRMVAR+4(,@04)                                 1066
*                 CKRMVAR(3)=ADDR(XTNHDSN);                        1067
         LA    @14,XTNHDSN(,XTNTPTR)                               1067
         ST    @14,CKRMVAR+8(,@04)                                 1067
*                 CKRMVAR(4)=ADDR(MIDCHLEN);                       1068
         ST    @15,CKRMVAR+12(,@04)                                1068
*                 CALL IDCRDER;                                    1069
         L     @15,@CV01553                                        1069
         BALR  @14,@15                                             1069
*               END;                                               1070
*                                                                  1070
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1071
*               RETURN CODE(LASTCC12);                             1071
         LA    @15,12                                              1071
         L     @14,@SA00002                                        1071
         LM    @00,@12,@SA00002+8                                  1071
         BR    @14                                                 1071
*             END;                                                 1072
*                                                                  1072
*           /*********************************************************/
*           /*                                                       */
*           /* THE INDATASETADDRESS PARAMETER IS VALIDATED, CONSTRUCT*/
*           /* THE EXTENT TABLE HEADER SETUP USER SUPPLIED RANGE IN  */
*           /* XTNTTBL HEADER                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1073
*           XTNHCHR1=MIDCHVAL;                                     1073
@RF01057 L     @04,@PC00001+4                                      1073
         L     @15,FDTPTR+448(,@04)                                1073
         MVC   XTNHCHR1(5,XTNTPTR),MIDCHVAL(@15)                   1073
*           XTNHCHR2=MIDCHVAL;                                     1074
*                                                                  1074
         MVC   XTNHCHR2(5,XTNTPTR),MIDCHVAL(@15)                   1074
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN  */
*           /* XTNTTBL HEADER                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1075
*           IF ADDR(MINDS)^=NULLPTR THEN                           1075
         L     @04,FDTPTR+376(,@04)                                1075
         LTR   @04,@04                                             1075
         BZ    @RF01075                                            1075
*             DO;                                                  1076
*               XTNHDSN=MINDSVAL;                                  1077
         MVC   XTNHDSN(44,XTNTPTR),MINDSVAL(@04)                   1077
*               XTNHDDN=BLANKS;                                    1078
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           1078
*               XTNHPWD=MINDSPAS;                                  1079
         MVC   XTNHPWD(8,XTNTPTR),MINDSPAS(@04)                    1079
*             END;                                                 1080
*           ELSE                                                   1081
*             DO;                                                  1081
         B     @RC01075                                            1081
@RF01075 DS    0H                                                  1082
*               XTNHDSN=BLANKS;                                    1082
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1082
*               XTNHDDN=MINFLVAL;                                  1083
         L     @04,@PC00001+4                                      1083
         L     @04,FDTPTR+372(,@04)                                1083
         MVC   XTNHDDN(8,XTNTPTR),MINFLVAL(@04)                    1083
*               XTNHPWD=MINFLPAS;                                  1084
         MVC   XTNHPWD(8,XTNTPTR),MINFLPAS(@04)                    1084
*             END;                                                 1085
*                                                                  1085
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET  */
*           /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO INPUT  */
*           /* IN XTNTTBL HEADER                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1086
*           XTNHVOLN=1;                                            1086
@RC01075 MVI   XTNHVOLN(XTNTPTR),X'01'                             1086
*           XTNHVOL=MIDVOVAL;                                      1087
         L     @04,@PC00001+4                                      1087
         L     @04,FDTPTR+444(,@04)                                1087
         MVC   XTNHVOL(6,XTNTPTR),MIDVOVAL(@04)                    1087
*           XTNHMODE=INPUT;                                        1088
         MVI   XTNHMODE(XTNTPTR),C'I'                              1088
*         END DSETMODI;                                            1089
*                                                                  1089
*       /*************************************************************/
*       /*                                                           */
*       /* FOR MODIFY OUTPUT, VALIDATE THE OUTDATASETADDRESS         */
*       /* PARAMETER AND CONSTRUCT THE EXTENT TABLE HEADER           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1090
*       IF IOPARM=OUTPUT THEN                                      1090
@RF01055 L     @04,@PC00002                                        1090
         CLI   IOPARM(@04),C'O'                                    1090
         BNE   @RF01090                                            1090
*DSETMODO:                                                         1091
*         DO;                                                      1091
*                                                                  1091
DSETMODO DS    0H                                                  1092
*           /*********************************************************/
*           /*                                                       */
*           /* THE LENGTH OF THE OUTDATASETADDRESS PARAMETER (CCHHR) */
*           /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE     */
*           /* CALLER WITH RC = 12                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1092
*           IF ADDR(MODSA)^=NULLPTR&MODCHLEN^=LENGTH(MODCHVAL) THEN
         SLR   @04,@04                                             1092
         L     @15,@PC00001+4                                      1092
         C     @04,FDTPTR+408(,@15)                                1092
         BE    @RF01092                                            1092
         L     @01,FDTPTR+492(,@15)                                1092
         CLI   MODCHLEN(@01),5                                     1092
         BE    @RF01092                                            1092
*             DO;                                                  1093
*                                                                  1093
*               /*****************************************************/
*               /*                                                   */
*               /* IF DATA SET NAME IS SPECIFIED (OS/VS2 ONLY), GET  */
*               /* DSNAME FROM FDT                                   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1094
*               IF ADDR(MODS)^=NULLPTR THEN                        1094
         L     @15,FDTPTR+416(,@15)                                1094
         CR    @15,@04                                             1094
         BE    @RF01094                                            1094
*                 XTNHDSN=MODSVAL;                                 1095
*                                                                  1095
         MVC   XTNHDSN(44,XTNTPTR),MODSVAL(@15)                    1095
*               /*****************************************************/
*               /*                                                   */
*               /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA  */
*               /* SET NAME AND MOVE IT INTO FIELD XTNHDSN IN        */
*               /* XTNTTBL. IF UIOINFO FAILS OR IF THE DATA SET NAME */
*               /* CANNOT BE LOCATED, XTNHDSN WILL BE SET TO BLANKS  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1096
*               ELSE                                               1096
*                 CALL IDCRDIN;                                    1096
*                                                                  1096
         B     @RC01094                                            1096
@RF01094 BAL   @14,IDCRDIN                                         1096
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC3233I                      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1097
*               DO;                                                1097
@RC01094 DS    0H                                                  1098
*                 CKREQ=CKREQ&&CKREQ;                              1098
         L     @04,@PC00001+8                                      1098
         XC    CKREQ(44,@04),CKREQ(@04)                            1098
*                 CKRERN=MSG33;                                    1099
         MVC   CKRERN(2,@04),@CH02800                              1099
*                 CKRMVAR(1)=ADDR(OUTDSADD);                       1100
         LA    @15,@CC02839                                        1100
         ST    @15,CKRMVAR(,@04)                                   1100
*                 CKRMVAR(2)=ADDR(MODCHVAL);                       1101
         L     @15,@PC00001+4                                      1101
         L     @15,FDTPTR+492(,@15)                                1101
         LA    @14,MODCHVAL(,@15)                                  1101
         ST    @14,CKRMVAR+4(,@04)                                 1101
*                 CKRMVAR(3)=ADDR(XTNHDSN);                        1102
         LA    @14,XTNHDSN(,XTNTPTR)                               1102
         ST    @14,CKRMVAR+8(,@04)                                 1102
*                 CKRMVAR(4)=ADDR(MODCHLEN);                       1103
         ST    @15,CKRMVAR+12(,@04)                                1103
*                 CALL IDCRDER;                                    1104
         L     @15,@CV01553                                        1104
         BALR  @14,@15                                             1104
*               END;                                               1105
*                                                                  1105
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1106
*               RETURN CODE(LASTCC12);                             1106
         LA    @15,12                                              1106
         L     @14,@SA00002                                        1106
         LM    @00,@12,@SA00002+8                                  1106
         BR    @14                                                 1106
*             END;                                                 1107
*                                                                  1107
*           /*********************************************************/
*           /*                                                       */
*           /* THE OUTDATASETADDRESS PARAMETER IS VALIDATED,         */
*           /* CONSTRUCT THE EXTENT TABLE HEADER SETUP USER SUPPLIED */
*           /* RANGE IN XTNTTBL HEADER                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1108
*           XTNHCHR1=MODCHVAL;                                     1108
@RF01092 L     @04,@PC00001+4                                      1108
         L     @04,FDTPTR+492(,@04)                                1108
         MVC   XTNHCHR1(5,XTNTPTR),MODCHVAL(@04)                   1108
*           IF TOCHRVAL=ZEROS(1:LENGTH(TOCHRVAL)) THEN             1109
         L     @15,@PC00002+4                                      1109
         CLC   TOCHRVAL(5,@15),ZEROS                               1109
         BNE   @RF01109                                            1109
*             XTNHCHR2=MODCHVAL;                                   1110
         MVC   XTNHCHR2(5,XTNTPTR),MODCHVAL(@04)                   1110
*           ELSE                                                   1111
*             XTNHCHR2=TOCHRVAL;                                   1111
*                                                                  1111
         B     @RC01109                                            1111
@RF01109 L     @04,@PC00002+4                                      1111
         MVC   XTNHCHR2(5,XTNTPTR),TOCHRVAL(@04)                   1111
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN  */
*           /* XTNTTBL HEADER                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1112
*           IF ADDR(MODS)^=NULLPTR THEN                            1112
@RC01109 L     @04,@PC00001+4                                      1112
         L     @04,FDTPTR+416(,@04)                                1112
         LTR   @04,@04                                             1112
         BZ    @RF01112                                            1112
*             DO;                                                  1113
*               XTNHDSN=MODSVAL;                                   1114
         MVC   XTNHDSN(44,XTNTPTR),MODSVAL(@04)                    1114
*               XTNHDDN=BLANKS;                                    1115
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           1115
*               XTNHPWD=MODSPAS;                                   1116
         MVC   XTNHPWD(8,XTNTPTR),MODSPAS(@04)                     1116
*             END;                                                 1117
*           ELSE                                                   1118
*             DO;                                                  1118
         B     @RC01112                                            1118
@RF01112 DS    0H                                                  1119
*               XTNHDSN=BLANKS;                                    1119
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1119
*               XTNHDDN=MOUTFVAL;                                  1120
         L     @04,@PC00001+4                                      1120
         L     @04,FDTPTR+412(,@04)                                1120
         MVC   XTNHDDN(8,XTNTPTR),MOUTFVAL(@04)                    1120
*               XTNHPWD=MOUTFPAS;                                  1121
         MVC   XTNHPWD(8,XTNTPTR),MOUTFPAS(@04)                    1121
*             END;                                                 1122
*                                                                  1122
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET  */
*           /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO OUTPUT */
*           /* IN XTNTTBL HEADER                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1123
*           XTNHVOLN=1;                                            1123
@RC01112 MVI   XTNHVOLN(XTNTPTR),X'01'                             1123
*           XTNHVOL=MODVOVAL;                                      1124
         L     @04,@PC00001+4                                      1124
         L     @04,FDTPTR+488(,@04)                                1124
         MVC   XTNHVOL(6,XTNTPTR),MODVOVAL(@04)                    1124
*           XTNHMODE=OUTPUT;                                       1125
         MVI   XTNHMODE(XTNTPTR),C'O'                              1125
*         END DSETMODO;                                            1126
*     END;                                                         1127
@RF01090 DS    0H                                                  1128
*                                                                  1128
*   /*****************************************************************/
*   /*                                                               */
*   /* VTOC AND DATA SET PROCESSING ALL INPUT PARAMETERS HAVE BEEN   */
*   /* VALIDATED ISSUE UALLOC TO GET DDNAME IF DSNAME WAS SPECIFIED  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1128
*   IF XTNHDSN^=BLANKS THEN                                        1128
@RF01053 CLC   XTNHDSN(44,XTNTPTR),BLANKS                          1128
         BE    @RF01128                                            1128
*     DO;                                                          1129
*                                                                  1129
*       /*************************************************************/
*       /*                                                           */
*       /* IF DSNAME SPECIFIED IS FORMAT4.DSCB, PREPARE TO RETURN TO */
*       /* THE CALLER WITH RC = 12                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1130
*       IF XTNHDSN=FMT4DSCB THEN                                   1130
         CLC   XTNHDSN(44,XTNTPTR),FMT4DSCB                        1130
         BNE   @RF01130                                            1130
*         DO;                                                      1131
*                                                                  1131
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31209I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1132
*           DO;                                                    1132
*             CKREQ=CKREQ&&CKREQ;                                  1133
         L     @15,@PC00001+8                                      1133
         XC    CKREQ(44,@15),CKREQ(@15)                            1133
*             CKRERN=MSG09;                                        1134
         MVC   CKRERN(2,@15),@CH00036                              1134
*             CALL IDCRDER;                                        1135
         L     @15,@CV01553                                        1135
         BALR  @14,@15                                             1135
*           END;                                                   1136
*                                                                  1136
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1137
*           RETURN CODE(LASTCC12);                                 1137
         LA    @15,12                                              1137
         L     @14,@SA00002                                        1137
         LM    @00,@12,@SA00002+8                                  1137
         BR    @14                                                 1137
*         END;                                                     1138
*                                                                  1138
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT UALLOC ARGUMENT LIST (ALLAGL)                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1139
*       RESPECIFY                                                  1139
*         ALLAGL BASED(REPALLAG);                                  1139
@RF01130 DS    0H                                                  1140
*       ALLAGL=''B;                                                1140
         L     @04,@PC00001+8                                      1140
         L     @04,REPALLAG(,@04)                                  1140
         XC    ALLAGL(31,@04),ALLAGL(@04)                          1140
*       ALLDSN=ADDR(XTNHDSN);                                      1141
         LA    @15,XTNHDSN(,XTNTPTR)                               1141
         ST    @15,ALLDSN(,@04)                                    1141
*       IF XTNHPWD^=ZEROS THEN                                     1142
         CLC   XTNHPWD(8,XTNTPTR),ZEROS                            1142
         BE    @RF01142                                            1142
*         ALLPWD=ADDR(XTNHPWD);                                    1143
         LA    @15,XTNHPWD(,XTNTPTR)                               1143
         ST    @15,ALLPWD(,@04)                                    1143
*       ALLSTSOD=ON;                                               1144
@RF01142 L     @04,@PC00001+8                                      1144
         L     @04,REPALLAG(,@04)                                  1144
         OI    ALLSTSOD(@04),B'00000001'                           1144
*       ALLDSPKP=ON;                                               1145
         OI    ALLDSPKP(@04),B'00001000'                           1145
*       ALLOPTVL=OFF;                                              1146
*       ALLOPTDS=ON;                                               1147
*                                                                  1147
         OI    ALLOPTDS(@04),B'01000000'                           1147
         NI    ALLOPTVL(@04),B'01111111'                           1147
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UALLOC.                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1148
*       CALL IDCSAAL0(GDTTBL,ALLAGL);                              1148
*                                                                  1148
         L     @15,@PC00001                                        1148
         ST    @15,@AL00001                                        1148
         ST    @04,@AL00001+4                                      1148
         MVI   @AL00001+4,X'80'                                    1148
         L     @15,GDTALC(,@15)                                    1148
         LA    @01,@AL00001                                        1148
         BALR  @14,@15                                             1148
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UALLOC                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1149
*       RESPECIFY                                                  1149
*         RTNREG RSTD;                                             1149
*       TESTRC=RTNREG;                                             1150
         STH   RTNREG,TESTRC                                       1150
*       RESPECIFY                                                  1151
*         RTNREG UNRSTD;                                           1151
*                                                                  1151
*       /*************************************************************/
*       /*                                                           */
*       /* IF UALLOC FAILS, RETURN TO THE CALLER WITH RC = 12        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1152
*       IF TESTRC^=0 THEN                                          1152
         LH    @04,TESTRC                                          1152
         LTR   @04,@04                                             1152
         BZ    @RF01152                                            1152
*         RETURN CODE(LASTCC12);                                   1153
*                                                                  1153
         LA    @15,12                                              1153
         L     @14,@SA00002                                        1153
         LM    @00,@12,@SA00002+8                                  1153
         BR    @14                                                 1153
*       /*************************************************************/
*       /*                                                           */
*       /* PLACE DDNAME IN THE EXTENT TABLE HEADER                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1154
*       XTNHDDN=ALLDDN;                                            1154
@RF01152 L     @04,@PC00001+8                                      1154
         L     @04,REPALLAG(,@04)                                  1154
         MVC   XTNHDDN(8,XTNTPTR),ALLDDN(@04)                      1154
*     END;                                                         1155
*                                                                  1155
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UIOINFO TO GET DSNAME AND VOLSER INFO CONSTRUCT UIOINFO */
*   /* OPTION BYTE                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1156
*   IOINFOPT=''B;                                                  1156
@RF01128 LA    @04,INFOBYT                                         1156
         MVI   IOINFOPT(@04),X'00'                                 1156
*   IOINFVOL=ON;                                                   1157
*   IOINFDSN=ON;                                                   1158
*                                                                  1158
         OI    IOINFVOL(@04),B'01100000'                           1158
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ADDRESS OF UIOINFO RETURN AREA                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1159
*   IF ADDR(MODIF)^=NULLPTR&IOPARM^=INPUT THEN                     1159
         L     @04,@PC00001+4                                      1159
         L     @04,FDTPTR+356(,@04)                                1159
         LTR   @04,@04                                             1159
         BZ    @RF01159                                            1159
         L     @04,@PC00002                                        1159
         CLI   IOPARM(@04),C'I'                                    1159
         BE    @RF01159                                            1159
*     INFOPTR=REPOINFO;                                            1160
         L     @04,@PC00001+8                                      1160
         L     @04,REPOINFO(,@04)                                  1160
         ST    @04,INFOPTR                                         1160
*   ELSE                                                           1161
*     INFOPTR=REPIINFO;                                            1161
*                                                                  1161
         B     @RC01159                                            1161
@RF01159 L     @04,@PC00001+8                                      1161
         L     @04,REPIINFO(,@04)                                  1161
         ST    @04,INFOPTR                                         1161
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UIOINFO                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1162
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,XTNHDDN);                1162
*                                                                  1162
@RC01159 L     @04,@PC00001                                        1162
         ST    @04,@AL00001                                        1162
         LA    @15,INFOBYT                                         1162
         ST    @15,@AL00001+4                                      1162
         LA    @15,INFOPTR                                         1162
         ST    @15,@AL00001+8                                      1162
         ST    XTNTPTR,@AL00001+12                                 1162
         MVI   @AL00001+12,X'80'                                   1162
         L     @15,GDTIFO(,@04)                                    1162
         LA    @01,@AL00001                                        1162
         BALR  @14,@15                                             1162
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN CODE UIOINFO                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1163
*   RESPECIFY                                                      1163
*     RTNREG RSTD;                                                 1163
*   TESTRC=RTNREG;                                                 1164
         STH   RTNREG,TESTRC                                       1164
*   RESPECIFY                                                      1165
*     RTNREG UNRSTD;                                               1165
*                                                                  1165
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UIOINFO FAILS, RETURN TO THE CALLER WITH RC = 12           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1166
*   IF TESTRC^=0 THEN                                              1166
         LH    @04,TESTRC                                          1166
         LTR   @04,@04                                             1166
         BZ    @RF01166                                            1166
*     RETURN CODE(LASTCC12);                                       1167
*                                                                  1167
         LA    @15,12                                              1167
         L     @14,@SA00002                                        1167
         LM    @00,@12,@SA00002+8                                  1167
         BR    @14                                                 1167
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP UIOINFO RETURN AREA ADDRESSABILITY                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   RESPECIFY                                                      1168
*     INFOAREA BASED(INFOPTR);                                     1168
@RF01166 DS    0H                                                  1169
*   RESPECIFY                                                      1169
*     INFOSCAN BASED(INFSCNPT);                                    1169
*   INFSCNPT=INFOPTR+LENGTH(INFAREAL)+LENGTH(INFDATAL);            1170
*                                                                  1170
         LA    INFSCNPT,4                                          1170
         AL    INFSCNPT,INFOPTR                                    1170
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP TWICE THROUGH UIOINFO RETURN AREA TO LOCATE DATA SET NAME*/
*   /* AND VOLSER LIST                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1171
*   INFDSNPT=0;                                                    1171
         SLR   @04,@04                                             1171
         LR    INFDSNPT,@04                                        1171
*   INFVOLPT=0;                                                    1172
         ST    @04,INFVOLPT                                        1172
*   DO I=1 TO 2;                                                   1173
         LA    @04,1                                               1173
         L     @15,@PC00001+8                                      1173
         STC   @04,I(,@15)                                         1173
@DL01173 DS    0H                                                  1174
*     IF INFSCNID=DSNIDENT THEN                                    1174
         CLC   INFSCNID(2,INFSCNPT),@CH00221                       1174
         BNE   @RF01174                                            1174
*       DO;                                                        1175
*         INFDSNPT=INFSCNPT;                                       1176
         LR    INFDSNPT,INFSCNPT                                   1176
*         RESPECIFY                                                1177
*           INFODSN BASED(INFDSNPT);                               1177
*       END;                                                       1178
*     ELSE                                                         1179
*       IF INFSCNID=VOLIDENT THEN                                  1179
         B     @RC01174                                            1179
@RF01174 CLC   INFSCNID(2,INFSCNPT),@CH00156                       1179
         BNE   @RF01179                                            1179
*         DO;                                                      1180
*           INFVOLPT=INFSCNPT;                                     1181
         ST    INFSCNPT,INFVOLPT                                   1181
*           RESPECIFY                                              1182
*             INFOVOL BASED(INFVOLPT);                             1182
*         END;                                                     1183
*     INFSCNPT=INFSCNPT+INFSCNLN+LENGTH(INFSCNID)+LENGTH(INFSCNLN);
@RF01179 DS    0H                                                  1184
@RC01174 LR    @04,INFSCNPT                                        1184
         LH    @15,INFSCNLN(,INFSCNPT)                             1184
         N     @15,@CF03043                                        1184
         ALR   @04,@15                                             1184
         AL    @04,@CF00045                                        1184
         LR    INFSCNPT,@04                                        1184
*   END;                                                           1185
*                                                                  1185
         L     @15,@PC00001+8                                      1185
         LA    @04,1                                               1185
         SLR   @14,@14                                             1185
         IC    @14,I(,@15)                                         1185
         ALR   @04,@14                                             1185
         L     @15,@PC00001+8                                      1185
         STC   @04,I(,@15)                                         1185
         C     @04,@CF00156                                        1185
         BNH   @DL01173                                            1185
*   /*****************************************************************/
*   /*                                                               */
*   /* IF EITHER DSNAME OR VOLSER LIST CANNOT BE LOCATED, RETURN TO  */
*   /* THE CALLER WITH RC = 12                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1186
*   IF INFDSNPT=0INFVOLPT=0 THEN                                  1186
         SLR   @04,@04                                             1186
         CR    INFDSNPT,@04                                        1186
         BE    @RT01186                                            1186
         C     @04,INFVOLPT                                        1186
         BNE   @RF01186                                            1186
@RT01186 DS    0H                                                  1187
*     RETURN CODE(LASTCC12);                                       1187
*                                                                  1187
         LA    @15,12                                              1187
         L     @14,@SA00002                                        1187
         LM    @00,@12,@SA00002+8                                  1187
         BR    @14                                                 1187
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT DSNAME IN EXTENT TABLE HEADER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1188
*   IF XTNHDSN=BLANKS THEN                                         1188
@RF01186 CLC   XTNHDSN(44,XTNTPTR),BLANKS                          1188
         BNE   @RF01188                                            1188
*     DO;                                                          1189
*       IF INFDSN=FMT4DSCB THEN                                    1190
         CLC   INFDSN(44,INFDSNPT),FMT4DSCB                        1190
         BNE   @RF01190                                            1190
*         XTNHDSN=FMT4DSN;                                         1191
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         1191
*       ELSE                                                       1192
*         XTNHDSN=INFDSN;                                          1192
         B     @RC01190                                            1192
@RF01190 MVC   XTNHDSN(44,XTNTPTR),INFDSN(INFDSNPT)                1192
*     END;                                                         1193
*                                                                  1193
@RC01190 DS    0H                                                  1194
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME SERIAL NUMBER FROM UIOINFO DOES NOT MATCH VOLUME    */
*   /* SERIAL NUMBER IN SYNTAX, PREPARE TO RETURN TO RETURN TO THE   */
*   /* CALLER WITH RC = 12                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1194
*   IF XTNHVOL^=INFVOL(1) THEN                                     1194
@RF01188 L     @04,INFVOLPT                                        1194
         CLC   XTNHVOL(6,XTNTPTR),INFVOL(@04)                      1194
         BE    @RF01194                                            1194
*     DO;                                                          1195
*       IF ADDR(DISPL)^=NULLPTRADDR(COPY)^=NULLPTR THEN           1196
         SLR   @04,@04                                             1196
         L     @15,@PC00001+4                                      1196
         C     @04,FDTPTR(,@15)                                    1196
         BNE   @RT01196                                            1196
         C     @04,FDTPTR+136(,@15)                                1196
         BE    @RF01196                                            1196
@RT01196 DS    0H                                                  1197
*         PARMHOLD=DSRANGE;                                        1197
         MVC   PARMHOLD(17),@CC02833                               1197
*       ELSE                                                       1198
*         IF XTNHMODE=INPUT THEN                                   1198
         B     @RC01196                                            1198
@RF01196 CLI   XTNHMODE(XTNTPTR),C'I'                              1198
         BNE   @RF01198                                            1198
*           PARMHOLD=INDSADD;                                      1199
         MVC   PARMHOLD(17),@CC02836                               1199
*         ELSE                                                     1200
*           PARMHOLD=OUTDSADD;                                     1200
*                                                                  1200
         B     @RC01198                                            1200
@RF01198 MVC   PARMHOLD(17),@CC02839                               1200
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE ERROR MESSAGE IDC31210I                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1201
*       DO;                                                        1201
@RC01198 DS    0H                                                  1201
@RC01196 DS    0H                                                  1202
*         CKREQ=CKREQ&&CKREQ;                                      1202
         L     @04,@PC00001+8                                      1202
         XC    CKREQ(44,@04),CKREQ(@04)                            1202
*         CKRERN=MSG10;                                            1203
         MVC   CKRERN(2,@04),@CH00037                              1203
*         CKRMVAR(1)=ADDR(XTNHVOL);                                1204
         LA    @15,XTNHVOL(,XTNTPTR)                               1204
         ST    @15,CKRMVAR(,@04)                                   1204
*         CKRMVAR(2)=ADDR(PARMHOLD);                               1205
         LA    @05,PARMHOLD                                        1205
         ST    @05,CKRMVAR+4(,@04)                                 1205
*         CKRMVAR(3)=ADDR(INFODD);                                 1206
         LA    @05,INFODD                                          1206
         ST    @05,CKRMVAR+8(,@04)                                 1206
*         CALL IDCRDER;                                            1207
         L     @15,@CV01553                                        1207
         BALR  @14,@15                                             1207
*       END;                                                       1208
*                                                                  1208
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALL WITH RC = 12                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1209
*       RETURN CODE(LASTCC12);                                     1209
         LA    @15,12                                              1209
         L     @14,@SA00002                                        1209
         LM    @00,@12,@SA00002+8                                  1209
         BR    @14                                                 1209
*     END;                                                         1210
*                                                                  1210
*   /*****************************************************************/
*   /*                                                               */
*   /* IF STARTING ADDRESS GREATER THAN ENDING ADDRESS, PREPARE TO   */
*   /* RETURN TO THE CALLER WITH RC = 12                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1211
*   IF XTNHCHR1>XTNHCHR2 THEN                                      1211
@RF01194 CLC   XTNHCHR1(5,XTNTPTR),XTNHCHR2(XTNTPTR)               1211
         BNH   @RF01211                                            1211
*     DO;                                                          1212
*                                                                  1212
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE ERROR MESSAGE IDC31235I                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1213
*       DO;                                                        1213
*         CKREQ=CKREQ&&CKREQ;                                      1214
         L     @04,@PC00001+8                                      1214
         XC    CKREQ(44,@04),CKREQ(@04)                            1214
*         CKRERN=MSG35;                                            1215
         MVC   CKRERN(2,@04),@CH00709                              1215
*         CKRMVAR(1)=ADDR(XTNHCHR1);                               1216
         LA    @15,XTNHCHR1(,XTNTPTR)                              1216
         ST    @15,CKRMVAR(,@04)                                   1216
*         CKRMVAR(2)=ADDR(XTNHCHR2);                               1217
         LA    @15,XTNHCHR2(,XTNTPTR)                              1217
         ST    @15,CKRMVAR+4(,@04)                                 1217
*         CKRMVAR(3)=ADDR(XTNHDSN);                                1218
         LA    @15,XTNHDSN(,XTNTPTR)                               1218
         ST    @15,CKRMVAR+8(,@04)                                 1218
*         CALL IDCRDER;                                            1219
         L     @15,@CV01553                                        1219
         BALR  @14,@15                                             1219
*       END;                                                       1220
*                                                                  1220
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1221
*       RETURN CODE(LASTCC12);                                     1221
         LA    @15,12                                              1221
         L     @14,@SA00002                                        1221
         LM    @00,@12,@SA00002+8                                  1221
         BR    @14                                                 1221
*     END;                                                         1222
*                                                                  1222
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ADDRESS OF DEVTYPE RETURN AREA                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1223
*   IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN                     1223
@RF01211 L     @04,@PC00001+4                                      1223
         L     @04,FDTPTR+356(,@04)                                1223
         LTR   @04,@04                                             1223
         BZ    @RF01223                                            1223
         L     @04,@PC00002                                        1223
         CLI   IOPARM(@04),C'O'                                    1223
         BNE   @RF01223                                            1223
*     DEVAREAP=REPODEVA;                                           1224
         L     @04,@PC00001+8                                      1224
         L     @04,REPODEVA(,@04)                                  1224
         ST    @04,DEVAREAP                                        1224
*   ELSE                                                           1225
*     DEVAREAP=REPIDEVA;                                           1225
*                                                                  1225
         B     @RC01223                                            1225
@RF01223 L     @04,@PC00001+8                                      1225
         L     @04,REPIDEVA(,@04)                                  1225
         ST    @04,DEVAREAP                                        1225
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE DEVTYPE MACRO                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1226
*   RESPECIFY                                                      1226
*    (REG3,                                                        1226
*     REG4) RESTRICTED;                                            1226
@RC01223 DS    0H                                                  1227
*   REG3=ADDR(XTNHDDN);                                            1227
         LR    REG3,XTNTPTR                                        1227
*   REG4=DEVAREAP;                                                 1228
         L     REG4,DEVAREAP                                       1228
*LDEVTYP3:                                                         1229
*   GEN;                                                           1229
LDEVTYP3 DS    0H                                                  1229
         DEVTYPE (3),(4),DEVTAB
*   RESPECIFY                                                      1230
*    (REG3,                                                        1230
*     REG4) UNRESTRICTED;                                          1230
*                                                                  1230
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN CODE FROM DEVTYPE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1231
*   RESPECIFY                                                      1231
*     RTNREG RSTD;                                                 1231
*   TESTRC=RTNREG;                                                 1232
         STH   RTNREG,TESTRC                                       1232
*   RESPECIFY                                                      1233
*     RTNREG UNRSTD;                                               1233
*                                                                  1233
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DEVTYPE FAILS, RETURN TO CALLER WITH RC = 12               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1234
*   IF TESTRC^=0 THEN                                              1234
         LH    @04,TESTRC                                          1234
         LTR   @04,@04                                             1234
         BZ    @RF01234                                            1234
*     RETURN CODE(LASTCC12);                                       1235
*                                                                  1235
         LA    @15,12                                              1235
         L     @14,@SA00002                                        1235
         LM    @00,@12,@SA00002+8                                  1235
         BR    @14                                                 1235
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DATA SET IS MOUNTED ON A REAL UNIT, PREPARE TO RETURN  */
*   /* TO THE CALLER WITH RC = 12                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1236
*   IF DEVRVDEV=OFF THEN                                           1236
@RF01234 L     @04,DEVAREAP                                        1236
         TM    DEVRVDEV(@04),B'00001000'                           1236
         BNZ   @RF01236                                            1236
*     DO;                                                          1237
*                                                                  1237
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR VTOC                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1238
*       IF XTNHDSN=FMT4DSN THEN                                    1238
         CLC   XTNHDSN(44,XTNTPTR),FMT4DSN                         1238
         BNE   @RF01238                                            1238
*         XTNHDSN=FMT4DSCB;                                        1239
*                                                                  1239
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSCB                        1239
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE ERROR MESSAGE IDC31211I                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1240
*       DO;                                                        1240
@RF01238 DS    0H                                                  1241
*         CKREQ=CKREQ&&CKREQ;                                      1241
         L     @04,@PC00001+8                                      1241
         XC    CKREQ(44,@04),CKREQ(@04)                            1241
*         CKRERN=MSG11;                                            1242
         MVC   CKRERN(2,@04),@CH00038                              1242
*         CKRMVAR(1)=ADDR(XTNHDSN);                                1243
         LA    @15,XTNHDSN(,XTNTPTR)                               1243
         ST    @15,CKRMVAR(,@04)                                   1243
*         CALL IDCRDER;                                            1244
         L     @15,@CV01553                                        1244
         BALR  @14,@15                                             1244
*       END;                                                       1245
*                                                                  1245
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1246
*       RETURN CODE(LASTCC12);                                     1246
         LA    @15,12                                              1246
         L     @14,@SA00002                                        1246
         LM    @00,@12,@SA00002+8                                  1246
         BR    @14                                                 1246
*     END;                                                         1247
*                                                                  1247
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPARE STARTING ADDRESS CC AND HH AGAINST MAXIMUM CYLINDER   */
*   /* AND TRACK NUMBERS FOR THE DEVICE AS RETURNED BY DEVTYPE. IF   */
*   /* ANY USER-SUPPLIED VALUE IS LARGER THAN THE CORRESPONDING      */
*   /* MAXIMUM FOR THE DEVICE, PREPARE TO RETURN TO THE CALLER WITH  */
*   /* RC = 12                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1248
*   IF XTNHCHR1(1:2)>DEVMAXCCXTNHCHR1(3:4)>DEVMAXHH THEN          1248
@RF01236 L     @04,DEVAREAP                                        1248
         CLC   XTNHCHR1(2,XTNTPTR),DEVMAXCC(@04)                   1248
         BH    @RT01248                                            1248
         CLC   XTNHCHR1+2(2,XTNTPTR),DEVMAXHH(@04)                 1248
         BNH   @RF01248                                            1248
@RT01248 DS    0H                                                  1249
*     DO;                                                          1249
*       IF ADDR(DISPL)^=NULLPTRADDR(COPY)^=NULLPTR THEN           1250
         SLR   @04,@04                                             1250
         L     @15,@PC00001+4                                      1250
         C     @04,FDTPTR(,@15)                                    1250
         BNE   @RT01250                                            1250
         C     @04,FDTPTR+136(,@15)                                1250
         BE    @RF01250                                            1250
@RT01250 DS    0H                                                  1251
*         PARMHOLD=DSRANGE;                                        1251
         MVC   PARMHOLD(17),@CC02833                               1251
*       ELSE                                                       1252
*         IF XTNHMODE=INPUT THEN                                   1252
         B     @RC01250                                            1252
@RF01250 CLI   XTNHMODE(XTNTPTR),C'I'                              1252
         BNE   @RF01252                                            1252
*           PARMHOLD=INDSADD;                                      1253
         MVC   PARMHOLD(17),@CC02836                               1253
*         ELSE                                                     1254
*           PARMHOLD=OUTDSADD;                                     1254
*                                                                  1254
         B     @RC01252                                            1254
@RF01252 MVC   PARMHOLD(17),@CC02839                               1254
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE ERROR MESSAGE IDC31234I                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1255
*       DO;                                                        1255
@RC01252 DS    0H                                                  1255
@RC01250 DS    0H                                                  1256
*         CKREQ=CKREQ&&CKREQ;                                      1256
         L     @04,@PC00001+8                                      1256
         XC    CKREQ(44,@04),CKREQ(@04)                            1256
*         CKRERN=MSG34;                                            1257
         MVC   CKRERN(2,@04),@CH02802                              1257
*         CKRMVAR(1)=ADDR(PARMHOLD);                               1258
         LA    @15,PARMHOLD                                        1258
         ST    @15,CKRMVAR(,@04)                                   1258
*         CKRMVAR(2)=ADDR(XTNHCHR1);                               1259
         LA    @15,XTNHCHR1(,XTNTPTR)                              1259
         ST    @15,CKRMVAR+4(,@04)                                 1259
*         CALL IDCRDER;                                            1260
         L     @15,@CV01553                                        1260
         BALR  @14,@15                                             1260
*       END;                                                       1261
*                                                                  1261
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1262
*       RETURN CODE(LASTCC12);                                     1262
         LA    @15,12                                              1262
         L     @14,@SA00002                                        1262
         LM    @00,@12,@SA00002+8                                  1262
         BR    @14                                                 1262
*     END;                                                         1263
*                                                                  1263
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ENDING ADDRESS IS NOT EQUAL TO STARTING ADDRESS, COMPARE   */
*   /* ENDING ADDRESS CC AND HH AGAINST MAXIMUM CYLINDER AND TRACK   */
*   /* NUMBERS FOR THE DEVICE AS RETURNED BY DEVTYPE. IF ANY         */
*   /* USER-SUPPLIED VALUE IS LARGER THAN THE CORRESPONDING MAXIMUM  */
*   /* FOR THE DEVICE, PREPARE TO RETURN TO THE CALLER WITH RC = 12  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1264
*   IF XTNHCHR1(1:4)^=XTNHCHR2(1:4) THEN                           1264
@RF01248 CLC   XTNHCHR1(4,XTNTPTR),XTNHCHR2(XTNTPTR)               1264
         BE    @RF01264                                            1264
*     DO;                                                          1265
*       IF XTNHCHR2(1:2)>DEVMAXCCXTNHCHR2(3:4)>DEVMAXHH THEN      1266
         L     @04,DEVAREAP                                        1266
         CLC   XTNHCHR2(2,XTNTPTR),DEVMAXCC(@04)                   1266
         BH    @RT01266                                            1266
         CLC   XTNHCHR2+2(2,XTNTPTR),DEVMAXHH(@04)                 1266
         BNH   @RF01266                                            1266
@RT01266 DS    0H                                                  1267
*         DO;                                                      1267
*           IF ADDR(DISPL)^=NULLPTRADDR(COPY)^=NULLPTR THEN       1268
         SLR   @04,@04                                             1268
         L     @15,@PC00001+4                                      1268
         C     @04,FDTPTR(,@15)                                    1268
         BNE   @RT01268                                            1268
         C     @04,FDTPTR+136(,@15)                                1268
         BE    @RF01268                                            1268
@RT01268 DS    0H                                                  1269
*             PARMHOLD=DSRANGE;                                    1269
         MVC   PARMHOLD(17),@CC02833                               1269
*           ELSE                                                   1270
*             IF XTNHMODE=INPUT THEN                               1270
         B     @RC01268                                            1270
@RF01268 CLI   XTNHMODE(XTNTPTR),C'I'                              1270
         BNE   @RF01270                                            1270
*               PARMHOLD=INDSADD;                                  1271
         MVC   PARMHOLD(17),@CC02836                               1271
*             ELSE                                                 1272
*               PARMHOLD=OUTDSADD;                                 1272
*                                                                  1272
         B     @RC01270                                            1272
@RF01270 MVC   PARMHOLD(17),@CC02839                               1272
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31234I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1273
*           DO;                                                    1273
@RC01270 DS    0H                                                  1273
@RC01268 DS    0H                                                  1274
*             CKREQ=CKREQ&&CKREQ;                                  1274
         L     @04,@PC00001+8                                      1274
         XC    CKREQ(44,@04),CKREQ(@04)                            1274
*             CKRERN=MSG34;                                        1275
         MVC   CKRERN(2,@04),@CH02802                              1275
*             CKRMVAR(1)=ADDR(PARMHOLD);                           1276
         LA    @15,PARMHOLD                                        1276
         ST    @15,CKRMVAR(,@04)                                   1276
*             CKRMVAR(2)=ADDR(XTNHCHR2);                           1277
         LA    @15,XTNHCHR2(,XTNTPTR)                              1277
         ST    @15,CKRMVAR+4(,@04)                                 1277
*             CALL IDCRDER;                                        1278
         L     @15,@CV01553                                        1278
         BALR  @14,@15                                             1278
*           END;                                                   1279
*                                                                  1279
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1280
*           RETURN CODE(LASTCC12);                                 1280
         LA    @15,12                                              1280
         L     @14,@SA00002                                        1280
         LM    @00,@12,@SA00002+8                                  1280
         BR    @14                                                 1280
*         END;                                                     1281
*     END;                                                         1282
*                                                                  1282
@RF01266 DS    0H                                                  1283
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE REQUIRED BYTES FOR I/O BUFFER                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1283
*   REQBYTES=DEVTC+LENGTH(RIOHDR);                                 1283
*                                                                  1283
@RF01264 LA    @04,282                                             1283
         L     @01,DEVAREAP                                        1283
         LH    @15,DEVTC(,@01)                                     1283
         N     @15,@CF03043                                        1283
         ALR   @04,@15                                             1283
         ST    @04,REQBYTES                                        1283
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UGPOOL                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1284
*   CALL IDCSAGP0(GDTTBL,REQBYTES,REQADDR,RD01,SETZERO);           1284
*                                                                  1284
         L     @04,@PC00001                                        1284
         ST    @04,@AL00001                                        1284
         LA    @15,REQBYTES                                        1284
         ST    @15,@AL00001+4                                      1284
         LA    @15,REQADDR                                         1284
         ST    @15,@AL00001+8                                      1284
         LA    @15,@CC02759                                        1284
         ST    @15,@AL00001+12                                     1284
         LA    @15,SETZERO                                         1284
         ST    @15,@AL00001+16                                     1284
         MVI   @AL00001+16,X'80'                                   1284
         L     @15,GDTGPL(,@04)                                    1284
         LA    @01,@AL00001                                        1284
         BALR  @14,@15                                             1284
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN CODE FROM UGPOOL                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1285
*   RESPECIFY                                                      1285
*     RTNREG RSTD;                                                 1285
*   TESTRC=RTNREG;                                                 1286
         STH   RTNREG,TESTRC                                       1286
*   RESPECIFY                                                      1287
*     RTNREG UNRSTD;                                               1287
*                                                                  1287
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UGPOOL FAILS, RETURN TO THE CALLER WITH RC = 12            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1288
*   IF TESTRC^=0 THEN                                              1288
         LH    @04,TESTRC                                          1288
         LTR   @04,@04                                             1288
         BZ    @RF01288                                            1288
*     RETURN CODE(LASTCC12);                                       1289
*                                                                  1289
         LA    @15,12                                              1289
         L     @14,@SA00002                                        1289
         LM    @00,@12,@SA00002+8                                  1289
         BR    @14                                                 1289
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE FIRST BYTE OF THE BUFFER AREA TO X'FF' TO INDICATE TO */
*   /* UEXCP THAT THE AREA HAS NOT PREVIOUSLY BEEN USED              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1290
*   IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN                   1290
@RF01288 L     @04,@PC00001+4                                      1290
         L     @04,FDTPTR+356(,@04)                                1290
         LTR   @04,@04                                             1290
         BZ    @RF01290                                            1290
         CLI   XTNHMODE(XTNTPTR),C'O'                              1290
         BNE   @RF01290                                            1290
*     DO;                                                          1291
*       REPOBFPT=REQADDR;                                          1292
         L     @15,@PC00001+8                                      1292
         L     @14,REQADDR                                         1292
         ST    @14,REPOBFPT(,@15)                                  1292
*       XTNTPTR2=REPOXTN2;                                         1293
         L     XTNTPTR2,REPOXTN2(,@15)                             1293
*     END;                                                         1294
*   ELSE                                                           1295
*     DO;                                                          1295
         B     @RC01290                                            1295
@RF01290 DS    0H                                                  1296
*       REPIBFPT=REQADDR;                                          1296
         L     @15,@PC00001+8                                      1296
         L     @14,REQADDR                                         1296
         ST    @14,REPIBFPT(,@15)                                  1296
*       XTNTPTR2=REPIXTN2;                                         1297
         L     XTNTPTR2,REPIXTN2(,@15)                             1297
*     END;                                                         1298
*   RESPECIFY                                                      1299
*     RIOAREA BASED(REQADDR);                                      1299
@RC01290 DS    0H                                                  1300
*   RFIRST='FF'X;                                                  1300
         L     @01,REQADDR                                         1300
         MVI   RFIRST(@01),X'FF'                                   1300
*                                                                  1301
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A DATA SET: VTOC (OPENABLE)                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*   IF XTNHDSN=FMT4DSN THEN                                        1301
         CLC   XTNHDSN(44,XTNTPTR),FMT4DSN                         1301
         BNE   @RF01301                                            1301
*DSVTOC:                                                           1302
*     DO;                                                          1302
*                                                                  1302
DSVTOC   DS    0H                                                  1303
*       /*************************************************************/
*       /*                                                           */
*       /* SET TRACE POINTS                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1303
*       OLDERID2=NEWERID2;                                         1303
         L     @04,@PC00001                                        1303
         L     @15,GDTTR2(,@04)                                    1303
         MVC   @TS00001(95),NEWERID2(@15)                          1303
         MVC   OLDERID2(95,@15),@TS00001                           1303
*       NEWID2='RD6L';                                             1304
*                                                                  1304
         MVC   NEWID2(4,@15),@CC02909                              1304
*       /*************************************************************/
*       /*                                                           */
*       /* FOR MODIFY OUTPUT PROCESSING, PROMPT THE CONSOLE OPERATOR */
*       /* FOR AUTHROIZATION TO ACCESS VOLUME                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1305
*       IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN               1305
         L     @15,@PC00001+4                                      1305
         L     @15,FDTPTR+356(,@15)                                1305
         LTR   @15,@15                                             1305
         BZ    @RF01305                                            1305
         CLI   XTNHMODE(XTNTPTR),C'O'                              1305
         BNE   @RF01305                                            1305
*         DO;                                                      1306
*                                                                  1306
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE WTOR LIST FORM                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1307
*           WTORLIST=LWTORLST;                                     1307
*                                                                  1307
         MVC   WTORLIST(84),LWTORLST                               1307
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP DARGLIST TO LOAD MESSAGE IDC498D IF REQUEST IS  */
*           /* FOR MODIFY OUTPUT                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1308
*           DARGL=''B;                                             1308
         XC    DARGL(20),DARGL                                     1308
*           DDSTRU=ADDR(DARGL);                                    1309
         LA    @15,DARGL                                           1309
         ST    @15,DDSTRU                                          1309
*           DARGRETP=ADDR(WTORLIST)+12;                            1310
         LA    @14,WTORLIST                                        1310
         AL    @14,@CF00039                                        1310
         ST    @14,DARGRETP(,@15)                                  1310
*           DARGSENT=MSG79;                                        1311
         MVI   DARGSENT(@15),X'4F'                                 1311
*           DARGSMOD=WTORID;                                       1312
         MVC   DARGSMOD(3,@15),@CC02814                            1312
*           DARGRETL=LENGTH(WTORLIST)-12;                          1313
*                                                                  1313
         MVC   DARGRETL(2,@15),@CH00818                            1313
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UPRINT TO LOAD IDC498D MESSAGE                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1314
*           CALL AMSTP011(GDTTBL,0,DDSTRU);                        1314
*                                                                  1314
         ST    @04,@AL00001                                        1314
         LA    @15,@CF00118                                        1314
         ST    @15,@AL00001+4                                      1314
         LA    @15,DDSTRU                                          1314
         ST    @15,@AL00001+8                                      1314
         MVI   @AL00001+8,X'80'                                    1314
         L     @15,GDTPRT(,@04)                                    1314
         LA    @01,@AL00001                                        1314
         BALR  @14,@15                                             1314
*           /*********************************************************/
*           /*                                                       */
*           /* SAVE RETURN CODE FROM UPRINT                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1315
*           RESPECIFY                                              1315
*             RTNREG RSTD;                                         1315
*           TESTRC=RTNREG;                                         1316
         STH   RTNREG,TESTRC                                       1316
*           RESPECIFY                                              1317
*             RTNREG UNRSTD;                                       1317
*                                                                  1317
*           /*********************************************************/
*           /*                                                       */
*           /* IF UPRINT FAILS, RETURN TO IDCRD05 WITH RC = 12       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1318
*           IF TESTRC^=0 THEN                                      1318
         LH    @04,TESTRC                                          1318
         LTR   @04,@04                                             1318
         BZ    @RF01318                                            1318
*             RETURN CODE(LASTCC12);                               1319
*                                                                  1319
         LA    @15,12                                              1319
         L     @14,@SA00002                                        1319
         LM    @00,@12,@SA00002+8                                  1319
         BR    @14                                                 1319
*           /*********************************************************/
*           /*                                                       */
*           /* INSERT VOLSER OF VTOC OR DATA SET IN MESSAGE          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1320
*           WTORLIST(56:61)=XTNHVOL;                               1320
*                                                                  1320
@RF01318 MVC   WTORLIST+55(6),XTNHVOL(XTNTPTR)                     1320
*           /*********************************************************/
*           /*                                                       */
*           /* PROMPT CONSOLE OPERATOR FOR AUTHORIZATION TO ACCESS   */
*           /* VOLUME                                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1321
*           DO UNTIL(WTOREPLY=Y)(WTOREPLY=N);                     1321
@DL01321 DS    0H                                                  1322
*             WTOREPLY=''B;                                        1322
         MVI   WTOREPLY,X'00'                                      1322
*             WTORECB=''B;                                         1323
         XC    WTORECB(4),WTORECB                                  1323
*             RESPECIFY                                            1324
*               REG3 RESTRICTED;                                   1324
*             REG3=ADDR(WTORLIST);                                 1325
         LA    REG3,WTORLIST                                       1325
*LWTOR3:                                                           1326
*             GEN;                                                 1326
LWTOR3   DS    0H                                                  1326
         WTOR  ,WTOREPLY,1,WTORECB,MF=(E,(3))
         WAIT  ECB=WTORECB
         DOM   MSG=(1)
*             RESPECIFY                                            1327
*               REG3 UNRESTRICTED;                                 1327
*           END;                                                   1328
*                                                                  1328
@DE01321 CLI   WTOREPLY,C'Y'                                       1328
         BE    @DC01321                                            1328
         CLI   WTOREPLY,C'N'                                       1328
         BNE   @DL01321                                            1328
@DC01321 DS    0H                                                  1329
*           /*********************************************************/
*           /*                                                       */
*           /* IF REPLY IS 'N', PREPARE TO RETURN TO IDCRD05 WITH RC */
*           /* = 12                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1329
*           IF WTOREPLY=N THEN                                     1329
         CLI   WTOREPLY,C'N'                                       1329
         BNE   @RF01329                                            1329
*             DO;                                                  1330
*                                                                  1330
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ACCESS DENIAL MESSAGE IDC31206I             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1331
*               DO;                                                1331
*                 CKREQ=CKREQ&&CKREQ;                              1332
         L     @04,@PC00001+8                                      1332
         XC    CKREQ(44,@04),CKREQ(@04)                            1332
*                 CKRERN=MSG06;                                    1333
         MVC   CKRERN(2,@04),@CH00035                              1333
*                 CKRMVAR(1)=ADDR(XTNHVOL);                        1334
         LA    @15,XTNHVOL(,XTNTPTR)                               1334
         ST    @15,CKRMVAR(,@04)                                   1334
*                 CALL IDCRDER;                                    1335
         L     @15,@CV01553                                        1335
         BALR  @14,@15                                             1335
*               END;                                               1336
*                                                                  1336
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN TO THE CALLER WITH RC = 12                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1337
*               RETURN CODE(LASTCC12);                             1337
         LA    @15,12                                              1337
         L     @14,@SA00002                                        1337
         LM    @00,@12,@SA00002+8                                  1337
         BR    @14                                                 1337
*             END;                                                 1338
*                                                                  1338
*           /*********************************************************/
*           /*                                                       */
*           /* GET ADDRESS OF USYSINFO RETURN AREA                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1339
*           SINFPTR=REPOSYSI;                                      1339
*                                                                  1339
@RF01329 L     @04,@PC00001+8                                      1339
         L     @04,REPOSYSI(,@04)                                  1339
         ST    @04,SINFPTR                                         1339
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE USYSINFO TO GET UCB ADDRESS                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1340
*           CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);            1340
*                                                                  1340
         L     @04,@PC00001                                        1340
         ST    @04,@AL00001                                        1340
         LA    @15,UNIT                                            1340
         ST    @15,@AL00001+4                                      1340
         LA    @15,SINFPTR                                         1340
         ST    @15,@AL00001+8                                      1340
         ST    XTNTPTR,@AL00001+12                                 1340
         MVI   @AL00001+12,X'80'                                   1340
         L     @15,GDTSFO(,@04)                                    1340
         LA    @01,@AL00001                                        1340
         BALR  @14,@15                                             1340
*           /*********************************************************/
*           /*                                                       */
*           /* SAVE RETURN CODE FROM USYSINFO                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1341
*           RESPECIFY                                              1341
*             RTNREG RSTD;                                         1341
*           TESTRC=RTNREG;                                         1342
         STH   RTNREG,TESTRC                                       1342
*           RESPECIFY                                              1343
*             RTNREG UNRSTD;                                       1343
*                                                                  1343
*           /*********************************************************/
*           /*                                                       */
*           /* IF USYSINFO FAILS, RETURN TO IDCRD05 WITH RC = 12     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1344
*           IF TESTRC^=0 THEN                                      1344
         LH    @04,TESTRC                                          1344
         LTR   @04,@04                                             1344
         BZ    @RF01344                                            1344
*             RETURN CODE(LASTCC12);                               1345
*                                                                  1345
         LA    @15,12                                              1345
         L     @14,@SA00002                                        1345
         LM    @00,@12,@SA00002+8                                  1345
         BR    @14                                                 1345
*           /*********************************************************/
*           /*                                                       */
*           /* CONSTRUCT QNAME, RNAME LENGTH, AND RNAME              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1346
*           SPQNAME=SYSVTOC;                                       1346
@RF01344 L     @04,@PC00001+8                                      1346
         L     @04,REPQRPTR(,@04)                                  1346
         MVC   SPQNAME(8,@04),@CC02747                             1346
*           SPRLEN=LENGTH(SPRVOL);                                 1347
         MVI   SPRLEN(@04),X'06'                                   1347
*           SPRVOL=XTNHVOL;                                        1348
*                                                                  1348
         MVC   SPRVOL(6,@04),XTNHVOL(XTNTPTR)                      1348
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE URESERVE TO RESERVE THE VTOC                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1349
*           CALL IDCSARV0(GDTTBL,EXCL,WAIT,SINFAREA,SPQNAME,SPRNAME);
*                                                                  1349
         L     @15,@PC00001                                        1349
         ST    @15,@AL00001                                        1349
         LA    @14,EXCL                                            1349
         ST    @14,@AL00001+4                                      1349
         LA    @14,WAIT                                            1349
         ST    @14,@AL00001+8                                      1349
         L     @01,SINFPTR                                         1349
         ST    @01,@AL00001+12                                     1349
         ST    @04,@AL00001+16                                     1349
         LA    @04,SPRNAME(,@04)                                   1349
         ST    @04,@AL00001+20                                     1349
         MVI   @AL00001+20,X'80'                                   1349
         L     @15,GDTRSV(,@15)                                    1349
         LA    @01,@AL00001                                        1349
         BALR  @14,@15                                             1349
*           /*********************************************************/
*           /*                                                       */
*           /* SAVE THE RETURN CODE FROM URESERVE                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1350
*           RESPECIFY                                              1350
*             RTNREG RSTD;                                         1350
*           TESTRC=RTNREG;                                         1351
         STH   RTNREG,TESTRC                                       1351
*           RESPECIFY                                              1352
*             RTNREG UNRSTD;                                       1352
*                                                                  1352
*           /*********************************************************/
*           /*                                                       */
*           /* IF URESERVE FAILS, RETURN TO IDCRD05 WITH RC = 12     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1353
*           IF TESTRC^=0 THEN                                      1353
         LH    @04,TESTRC                                          1353
         LTR   @04,@04                                             1353
         BZ    @RF01353                                            1353
*             RETURN CODE(LASTCC12);                               1354
*                                                                  1354
         LA    @15,12                                              1354
         L     @14,@SA00002                                        1354
         LM    @00,@12,@SA00002+8                                  1354
         BR    @14                                                 1354
*           /*********************************************************/
*           /*                                                       */
*           /* SET MODIFY ENQ INDICATOR                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1355
*           REPENQSW=MODENQ;                                       1355
@RF01353 L     @04,@PC00001+8                                      1355
         MVI   REPENQSW(@04),X'80'                                 1355
*         END;                                                     1356
*                                                                  1356
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (OPNAGL)                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1357
*       OPNPTR=REPOPAGL;                                           1357
@RF01305 L     @04,@PC00001+8                                      1357
         L     OPNPTR,REPOPAGL(,@04)                               1357
*       OPNAGL=''B;                                                1358
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1358
*       OPNIOC=ADDR(REPCDSOP);                                     1359
         LA    @04,REPCDSOP(,@04)                                  1359
         ST    @04,OPNIOC(,OPNPTR)                                 1359
*       OPNOPTIN=ON;                                               1360
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1360
*       OPNDSOPS=ON;                                               1361
         OI    OPNDSOPS(OPNPTR),B'01000000'                        1361
*       OPNOPTBK=ON;                                               1362
         OI    OPNOPTBK(OPNPTR),B'00010000'                        1362
*       OPNOPTJM=ON;                                               1363
         OI    OPNOPTJM(OPNPTR),B'00100000'                        1363
*       OPNDDN=ADDR(XTNHDDN);                                      1364
         ST    XTNTPTR,OPNDDN(,OPNPTR)                             1364
*       OPNDSN=ADDR(XTNHDSN);                                      1365
         LA    @04,XTNHDSN(,XTNTPTR)                               1365
         ST    @04,OPNDSN(,OPNPTR)                                 1365
*       OPNBLK=VTOCRECL;                                           1366
         MVC   OPNBLK(4,OPNPTR),@CF00886                           1366
*       OPNKYL=VTOCKEYL;                                           1367
         MVI   OPNKYL(OPNPTR),X'2C'                                1367
*       OPNVOL=ADDR(XTNHVOLN);                                     1368
*                                                                  1368
         LA    @04,XTNHVOLN(,XTNTPTR)                              1368
         ST    @04,OPNVOL(,OPNPTR)                                 1368
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UOPEN                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1369
*       CALL IDCIOOP0(GDTTBL,OPNAGL);                              1369
*                                                                  1369
         L     @04,@PC00001                                        1369
         ST    @04,@AL00001                                        1369
         ST    OPNPTR,@AL00001+4                                   1369
         MVI   @AL00001+4,X'80'                                    1369
         L     @15,GDTOPN(,@04)                                    1369
         LA    @01,@AL00001                                        1369
         BALR  @14,@15                                             1369
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE RETURN CODE FROM UOPEN                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1370
*       RESPECIFY                                                  1370
*         RTNREG RSTD;                                             1370
*       TESTRC=RTNREG;                                             1371
         STH   RTNREG,TESTRC                                       1371
*       RESPECIFY                                                  1372
*         RTNREG UNRSTD;                                           1372
*                                                                  1372
*       /*************************************************************/
*       /*                                                           */
*       /* IF UOPEN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1373
*       IF TESTRC^=0 THEN                                          1373
         LH    @04,TESTRC                                          1373
         SLR   @15,@15                                             1373
         CR    @04,@15                                             1373
         BE    @RF01373                                            1373
*         DO;                                                      1374
*                                                                  1374
*           /*********************************************************/
*           /*                                                       */
*           /* IF MODIFY OUTPUT, DEQ THE VTOC                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1375
*           IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN           1375
         L     @04,@PC00001+4                                      1375
         C     @15,FDTPTR+356(,@04)                                1375
         BE    @RF01375                                            1375
         CLI   XTNHMODE(XTNTPTR),C'O'                              1375
         BNE   @RF01375                                            1375
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               1376
*                                                                  1376
         L     @15,@PC00001                                        1376
         ST    @15,@AL00001                                        1376
         L     @14,@PC00001+8                                      1376
         L     @14,REPQRPTR(,@14)                                  1376
         ST    @14,@AL00001+4                                      1376
         LA    @14,SPRNAME(,@14)                                   1376
         ST    @14,@AL00001+8                                      1376
         MVI   @AL00001+8,X'80'                                    1376
         L     @15,GDTDEQ(,@15)                                    1376
         LA    @01,@AL00001                                        1376
         BALR  @14,@15                                             1376
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1377
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1377
*                                                                  1377
@RF01375 MVC   @AL00001+4(8),@AL01377                              1377
         L     @15,@PC00001                                        1377
         ST    @15,@AL00001                                        1377
         L     @15,GDTFPL(,@15)                                    1377
         LA    @01,@AL00001                                        1377
         BALR  @14,@15                                             1377
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1378
*           RETURN CODE(LASTCC12);                                 1378
         LA    @15,12                                              1378
         L     @14,@SA00002                                        1378
         LM    @00,@12,@SA00002+8                                  1378
         BR    @14                                                 1378
*         END;                                                     1379
*                                                                  1379
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UGET FOR FIRST RECORD IN THE VTOC FIRST RECORD IS   */
*       /* FORMAT 4 DSCB                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1380
*       CALL IDCIOGT0(GDTTBL,REPCDSOP);                            1380
*                                                                  1380
@RF01373 L     @04,@PC00001                                        1380
         ST    @04,@AL00001                                        1380
         L     @15,@PC00001+8                                      1380
         LA    @15,REPCDSOP(,@15)                                  1380
         ST    @15,@AL00001+4                                      1380
         MVI   @AL00001+4,X'80'                                    1380
         L     @15,GDTGET(,@04)                                    1380
         LA    @01,@AL00001                                        1380
         BALR  @14,@15                                             1380
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UGET                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1381
*       RESPECIFY                                                  1381
*         RTNREG RSTD;                                             1381
*       TESTRC=RTNREG;                                             1382
         STH   RTNREG,TESTRC                                       1382
*       RESPECIFY                                                  1383
*         RTNREG UNRSTD;                                           1383
*                                                                  1383
*       /*************************************************************/
*       /*                                                           */
*       /* IF UGET FAILS, PREPARE TO RETURN TO THE CALLER WITH RC =  */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1384
*       IF TESTRC^=0 THEN                                          1384
         LH    @04,TESTRC                                          1384
         LTR   @04,@04                                             1384
         BZ    @RF01384                                            1384
*         DO;                                                      1385
*                                                                  1385
*           /*********************************************************/
*           /*                                                       */
*           /* CLOSE THE VTOC                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1386
*           CALL IDCIOCL0(GDTTBL,REPCDSOP);                        1386
*                                                                  1386
         L     @04,@PC00001                                        1386
         ST    @04,@AL00001                                        1386
         L     @15,@PC00001+8                                      1386
         LA    @15,REPCDSOP(,@15)                                  1386
         ST    @15,@AL00001+4                                      1386
         MVI   @AL00001+4,X'80'                                    1386
         L     @15,GDTCLS(,@04)                                    1386
         LA    @01,@AL00001                                        1386
         BALR  @14,@15                                             1386
*           /*********************************************************/
*           /*                                                       */
*           /* IF MODIFY OUTPUT, DEQ THE VTOC                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1387
*           IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN           1387
         L     @04,@PC00001+4                                      1387
         L     @04,FDTPTR+356(,@04)                                1387
         LTR   @04,@04                                             1387
         BZ    @RF01387                                            1387
         CLI   XTNHMODE(XTNTPTR),C'O'                              1387
         BNE   @RF01387                                            1387
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               1388
*                                                                  1388
         L     @15,@PC00001                                        1388
         ST    @15,@AL00001                                        1388
         L     @14,@PC00001+8                                      1388
         L     @14,REPQRPTR(,@14)                                  1388
         ST    @14,@AL00001+4                                      1388
         LA    @14,SPRNAME(,@14)                                   1388
         ST    @14,@AL00001+8                                      1388
         MVI   @AL00001+8,X'80'                                    1388
         L     @15,GDTDEQ(,@15)                                    1388
         LA    @01,@AL00001                                        1388
         BALR  @14,@15                                             1388
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1389
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1389
*                                                                  1389
@RF01387 MVC   @AL00001+4(8),@AL01389                              1389
         L     @15,@PC00001                                        1389
         ST    @15,@AL00001                                        1389
         L     @15,GDTFPL(,@15)                                    1389
         LA    @01,@AL00001                                        1389
         BALR  @14,@15                                             1389
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1390
*           RETURN CODE(LASTCC12);                                 1390
         LA    @15,12                                              1390
         L     @14,@SA00002                                        1390
         LM    @00,@12,@SA00002+8                                  1390
         BR    @14                                                 1390
*         END;                                                     1391
*                                                                  1391
*       /*************************************************************/
*       /*                                                           */
*       /* UGET WAS SUCCESSFUL. SET-UP FORMAT 4 DSCB ADDRESSABILITY  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1392
*       IOCSPTR=REPCDSOP;                                          1392
@RF01384 L     @04,@PC00001+8                                      1392
         L     @03,REPCDSOP(,@04)                                  1392
         ST    @03,IOCSPTR                                         1392
*       F4PTR=IOCDAD+VTOCKEYL;                                     1393
*                                                                  1393
         LA    F4PTR,44                                            1393
         AL    F4PTR,IOCDAD(,@03)                                  1393
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE EXTENT TABLE ENTRY FOR THE VTOC INITIALIZE  */
*       /* INDEX                                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1394
*       I=1;                                                       1394
*                                                                  1394
         LA    @03,1                                               1394
         STC   @03,I(,@04)                                         1394
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VTOC STARTING ADDRESS (CCHH) IS GREATER THAN THE   */
*       /* USER-SUPPLIED STARTING ADDRESS, USE THE VTOC STARTING     */
*       /* ADDRESS                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1395
*       IF DS4VTOCE(3:6)>XTNHCHR1(1:4) THEN                        1395
         CLC   DS4VTOCE+2(4,F4PTR),XTNHCHR1(XTNTPTR)               1395
         BNH   @RF01395                                            1395
*         DO;                                                      1396
*           XTNTCHR1(I,1:4)=DS4VTOCE(3:6);                         1397
         MH    @03,@CH02809                                        1397
         ST    @03,@TF00001                                        1397
         ALR   @03,XTNTPTR                                         1397
         MVC   XTNTCHR1-78(4,@03),DS4VTOCE+2(F4PTR)                1397
*           XTNTCHR1(I,5:5)='00'X;                                 1398
         LR    @04,XTNTPTR                                         1398
         AL    @04,@TF00001                                        1398
         MVI   XTNTCHR1-74(@04),X'00'                              1398
*         END;                                                     1399
*                                                                  1399
*       /*************************************************************/
*       /*                                                           */
*       /* OTHERWISE, USE THE USER'S STARTING ADDRESS.               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1400
*       ELSE                                                       1400
*         XTNTCHR1(I)=XTNHCHR1;                                    1400
*                                                                  1400
         B     @RC01395                                            1400
@RF01395 L     @04,@PC00001+8                                      1400
         SLR   @03,@03                                             1400
         IC    @03,I(,@04)                                         1400
         MH    @03,@CH02809                                        1400
         ALR   @03,XTNTPTR                                         1400
         MVC   XTNTCHR1-78(5,@03),XTNHCHR1(XTNTPTR)                1400
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VTOC ENDING ADDRESS (CCHH) IS LESS THAN THE        */
*       /* USER-SUPPLIED ENDING ADDRESS, USE THE VTOC ENDING ADDRESS */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1401
*       IF DS4VTOCE(7:10)<XTNHCHR2(1:4) THEN                       1401
@RC01395 CLC   DS4VTOCE+6(4,F4PTR),XTNHCHR2(XTNTPTR)               1401
         BNL   @RF01401                                            1401
*         DO;                                                      1402
*           XTNTCHR2(I,1:4)=DS4VTOCE(7:10);                        1403
         L     @04,@PC00001+8                                      1403
         SLR   @03,@03                                             1403
         IC    @03,I(,@04)                                         1403
         MH    @03,@CH02809                                        1403
         ST    @03,@TF00001                                        1403
         ALR   @03,XTNTPTR                                         1403
         MVC   XTNTCHR2-78(4,@03),DS4VTOCE+6(F4PTR)                1403
*           XTNTCHR2(I,5:5)='FF'X;                                 1404
         LR    @04,XTNTPTR                                         1404
         AL    @04,@TF00001                                        1404
         MVI   XTNTCHR2-74(@04),X'FF'                              1404
*         END;                                                     1405
*                                                                  1405
*       /*************************************************************/
*       /*                                                           */
*       /* OTHERWISE, USE THE USER'S ENDING ADDRESS.                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1406
*       ELSE                                                       1406
*         XTNTCHR2(I)=XTNHCHR2;                                    1406
*                                                                  1406
         B     @RC01401                                            1406
@RF01401 L     @04,@PC00001+8                                      1406
         SLR   @15,@15                                             1406
         IC    @15,I(,@04)                                         1406
         MH    @15,@CH02809                                        1406
         ALR   @15,XTNTPTR                                         1406
         MVC   XTNTCHR2-78(5,@15),XTNHCHR2(XTNTPTR)                1406
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE THE VTOC                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1407
*       CALL IDCIOCL0(GDTTBL,REPCDSOP);                            1407
*                                                                  1407
@RC01401 L     @04,@PC00001                                        1407
         ST    @04,@AL00001                                        1407
         L     @15,@PC00001+8                                      1407
         LA    @15,REPCDSOP(,@15)                                  1407
         ST    @15,@AL00001+4                                      1407
         MVI   @AL00001+4,X'80'                                    1407
         L     @15,GDTCLS(,@04)                                    1407
         LA    @01,@AL00001                                        1407
         BALR  @14,@15                                             1407
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN INVALID ENTRY WAS MADE IN THE EXTENT TABLE, (USER   */
*       /* SUPPLIED RANGE NOT WITHIN EXTENTS OF VTOC), PREPARE TO    */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1408
*       IF XTNHCHR1(1:4)>XTNTCHR2(I,1:4)XTNHCHR2(1:4)<XTNTCHR1(I,1:4)
*         THEN                                                     1408
         L     @04,@PC00001+8                                      1408
         SLR   @15,@15                                             1408
         IC    @15,I(,@04)                                         1408
         MH    @15,@CH02809                                        1408
         ST    @15,@TF00001                                        1408
         ALR   @15,XTNTPTR                                         1408
         CLC   XTNHCHR1(4,XTNTPTR),XTNTCHR2-78(@15)                1408
         BH    @RT01408                                            1408
         LR    @04,XTNTPTR                                         1408
         AL    @04,@TF00001                                        1408
         CLC   XTNHCHR2(4,XTNTPTR),XTNTCHR1-78(@04)                1408
         BNL   @RF01408                                            1408
@RT01408 DS    0H                                                  1409
*         DO;                                                      1409
*           IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN             1410
         L     @04,@PC00001+4                                      1410
         L     @04,FDTPTR+356(,@04)                                1410
         LTR   @04,@04                                             1410
         BZ    @RF01410                                            1410
         L     @04,@PC00002                                        1410
         CLI   IOPARM(@04),C'O'                                    1410
         BNE   @RF01410                                            1410
*             DO;                                                  1411
*                                                                  1411
*               /*****************************************************/
*               /*                                                   */
*               /* DEQ THE VTOC                                      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1412
*               CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);             1412
*                                                                  1412
         L     @04,@PC00001                                        1412
         ST    @04,@AL00001                                        1412
         L     @15,@PC00001+8                                      1412
         L     @15,REPQRPTR(,@15)                                  1412
         ST    @15,@AL00001+4                                      1412
         LA    @15,SPRNAME(,@15)                                   1412
         ST    @15,@AL00001+8                                      1412
         MVI   @AL00001+8,X'80'                                    1412
         L     @15,GDTDEQ(,@04)                                    1412
         LA    @01,@AL00001                                        1412
         BALR  @14,@15                                             1412
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31240I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1413
*               DO;                                                1413
*                 CKREQ=CKREQ&&CKREQ;                              1414
         L     @04,@PC00001+8                                      1414
         XC    CKREQ(44,@04),CKREQ(@04)                            1414
*                 CKRERN=MSG40;                                    1415
         MVC   CKRERN(2,@04),@CH00732                              1415
*                 CKRMVAR(1)=ADDR(XTNHCHR2);                       1416
         LA    @15,XTNHCHR2(,XTNTPTR)                              1416
         ST    @15,CKRMVAR(,@04)                                   1416
*                 CALL IDCRDER;                                    1417
         L     @15,@CV01553                                        1417
         BALR  @14,@15                                             1417
*               END;                                               1418
*             END;                                                 1419
*           ELSE                                                   1420
*             IF ADDR(MODIF)^=NULLPTR&IOPARM=INPUT THEN            1420
*                                                                  1420
         B     @RC01410                                            1420
@RF01410 L     @04,@PC00001+4                                      1420
         L     @04,FDTPTR+356(,@04)                                1420
         LTR   @04,@04                                             1420
         BZ    @RF01420                                            1420
         L     @04,@PC00002                                        1420
         CLI   IOPARM(@04),C'I'                                    1420
         BNE   @RF01420                                            1420
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31221I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1421
*               DO;                                                1421
*                 CKREQ=CKREQ&&CKREQ;                              1422
         L     @04,@PC00001+8                                      1422
         XC    CKREQ(44,@04),CKREQ(@04)                            1422
*                 CKRERN=MSG21;                                    1423
         MVC   CKRERN(2,@04),@CH00651                              1423
*                 CKRMVAR(1)=ADDR(XTNHVOL);                        1424
         LA    @15,XTNHVOL(,XTNTPTR)                               1424
         ST    @15,CKRMVAR(,@04)                                   1424
*                 CKRMVAR(2)=ADDR(XTNHCHR1);                       1425
         LA    @15,XTNHCHR1(,XTNTPTR)                              1425
         ST    @15,CKRMVAR+4(,@04)                                 1425
*                 CKRMVAR(3)=ADDR(FMT4DSCB);                       1426
         LA    @05,FMT4DSCB                                        1426
         ST    @05,CKRMVAR+8(,@04)                                 1426
*                 CALL IDCRDER;                                    1427
         L     @15,@CV01553                                        1427
         BALR  @14,@15                                             1427
*               END;                                               1428
*             ELSE                                                 1429
*                                                                  1429
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE ERROR MESSAGE IDC31212I                     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1429
*               DO;                                                1429
         B     @RC01420                                            1429
@RF01420 DS    0H                                                  1430
*                 CKREQ=CKREQ&&CKREQ;                              1430
         L     @04,@PC00001+8                                      1430
         XC    CKREQ(44,@04),CKREQ(@04)                            1430
*                 CKRERN=MSG12;                                    1431
         MVC   CKRERN(2,@04),@CH00039                              1431
*                 CKRMVAR(1)=ADDR(XTNHCHR1);                       1432
         LA    @15,XTNHCHR1(,XTNTPTR)                              1432
         ST    @15,CKRMVAR(,@04)                                   1432
*                 CKRMVAR(2)=ADDR(XTNHCHR2);                       1433
         LA    @15,XTNHCHR2(,XTNTPTR)                              1433
         ST    @15,CKRMVAR+4(,@04)                                 1433
*                 CKRMVAR(3)=ADDR(FMT4DSCB);                       1434
         LA    @05,FMT4DSCB                                        1434
         ST    @05,CKRMVAR+8(,@04)                                 1434
*                 CALL IDCRDER;                                    1435
         L     @15,@CV01553                                        1435
         BALR  @14,@15                                             1435
*               END;                                               1436
*                                                                  1436
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1437
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1437
*                                                                  1437
@RC01420 DS    0H                                                  1437
@RC01410 MVC   @AL00001+4(8),@AL01437                              1437
         L     @15,@PC00001                                        1437
         ST    @15,@AL00001                                        1437
         L     @15,GDTFPL(,@15)                                    1437
         LA    @01,@AL00001                                        1437
         BALR  @14,@15                                             1437
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1438
*           RETURN CODE(LASTCC12);                                 1438
         LA    @15,12                                              1438
         L     @14,@SA00002                                        1438
         LM    @00,@12,@SA00002+8                                  1438
         BR    @14                                                 1438
*         END;                                                     1439
*                                                                  1439
*       /*************************************************************/
*       /*                                                           */
*       /* THE USER-SUPPLIED RANGE IS VALIDATED, CONSTRUCT THE EXTENT*/
*       /* TABLE ENTRY                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1440
*       XTNTDDN(I)=XTNHDDN;                                        1440
@RF01408 LA    @04,78                                              1440
         L     @15,@PC00001+8                                      1440
         SLR   @14,@14                                             1440
         IC    @14,I(,@15)                                         1440
         LR    @01,@14                                             1440
         MR    @00,@04                                             1440
         ST    @01,@TF00001                                        1440
         ALR   @01,XTNTPTR                                         1440
         MVC   XTNTDDN-78(8,@01),XTNHDDN(XTNTPTR)                  1440
*       XTNTDSN(I)=XTNHDSN;                                        1441
         LR    @01,XTNTPTR                                         1441
         AL    @01,@TF00001                                        1441
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 1441
*       XTNTVOLN(I)=XTNHVOLN;                                      1442
         LR    @01,XTNTPTR                                         1442
         AL    @01,@TF00001                                        1442
         MVC   XTNTVOLN-78(1,@01),XTNHVOLN(XTNTPTR)                1442
*       XTNTVOL(I)=XTNHVOL;                                        1443
*                                                                  1443
         LR    @01,XTNTPTR                                         1443
         AL    @01,@TF00001                                        1443
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  1443
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE NEXT EXTENT TABLE ENTRY TO X'FF' TO INDICATE THE  */
*       /* LAST ENTRY.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1444
*       I=I+1;                                                     1444
         AL    @14,@CF00221                                        1444
         STC   @14,I(,@15)                                         1444
*       XTNTENT(I)=LASTENT;                                        1445
*                                                                  1445
         LR    @01,@14                                             1445
         MR    @00,@04                                             1445
         ALR   @01,XTNTPTR                                         1445
         MVC   XTNTENT-78(78,@01),LASTENT                          1445
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (EXOARG)                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1446
*       I=1;                                                       1446
         LA    @14,1                                               1446
         STC   @14,I(,@15)                                         1446
*       EXOARG=''B;                                                1447
         L     @03,REPEXOAR(,@15)                                  1447
         XC    EXOARG(34,@03),EXOARG(@03)                          1447
*       EXODDN=ADDR(XTNTDDN(I));                                   1448
         LR    @01,@14                                             1448
         MR    @00,@04                                             1448
         LA    @04,XTNTDDN-78(@01,XTNTPTR)                         1448
         ST    @04,EXODDN(,@03)                                    1448
*       EXODSN=ADDR(XTNTDSN(I));                                   1449
         LA    @04,XTNTDSN-78(@01,XTNTPTR)                         1449
         ST    @04,EXODSN(,@03)                                    1449
*       IF XTNHMODE=INPUT THEN                                     1450
         CLI   XTNHMODE(XTNTPTR),C'I'                              1450
         BNE   @RF01450                                            1450
*         EXOCTLBK=ADDR(REPIDSOP);                                 1451
         LA    @04,REPIDSOP(,@15)                                  1451
         ST    @04,EXOCTLBK(,@03)                                  1451
*       ELSE                                                       1452
*         EXOCTLBK=ADDR(REPODSOP);                                 1452
         B     @RC01450                                            1452
@RF01450 L     @04,@PC00001+8                                      1452
         L     @01,REPEXOAR(,@04)                                  1452
         LA    @04,REPODSOP(,@04)                                  1452
         ST    @04,EXOCTLBK(,@01)                                  1452
*       EXORVT=ON;                                                 1453
@RC01450 L     @04,@PC00001+8                                      1453
         L     @04,REPEXOAR(,@04)                                  1453
         OI    EXORVT(@04),B'00000010'                             1453
*       EXOREP=ON;                                                 1454
*                                                                  1454
         OI    EXOREP(@04),B'00000100'                             1454
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UEXCP OPENR                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1455
*       CALL IDCIO050(GDTTBL,OPENR,EXOARG);                        1455
*                                                                  1455
         L     @15,@PC00001                                        1455
         ST    @15,@AL00001                                        1455
         LA    @14,@CC02024                                        1455
         ST    @14,@AL00001+4                                      1455
         ST    @04,@AL00001+8                                      1455
         MVI   @AL00001+8,X'80'                                    1455
         L     @15,GDTEXP(,@15)                                    1455
         LA    @01,@AL00001                                        1455
         BALR  @14,@15                                             1455
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UEXCP                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1456
*       RESPECIFY                                                  1456
*         RTNREG RSTD;                                             1456
*       TESTRC=RTNREG;                                             1457
         STH   RTNREG,TESTRC                                       1457
*       RESPECIFY                                                  1458
*         RTNREG UNRSTD;                                           1458
*                                                                  1458
*       /*************************************************************/
*       /*                                                           */
*       /* SET DUMP POINT                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1459
*       IF GDTDBG=NULLPTR THEN                                     1459
         L     @04,@PC00001                                        1459
         L     @04,GDTDBG(,@04)                                    1459
         LTR   @04,@04                                             1459
         BZ    @RT01459                                            1459
*         ;                                                        1460
*       ELSE                                                       1461
*         CALL IDCDB010(GDTTBL,'RD6P');                            1461
*                                                                  1461
         L     @04,@PC00001                                        1461
         ST    @04,@AL00001                                        1461
         LA    @15,@CC02914                                        1461
         ST    @15,@AL00001+4                                      1461
         MVI   @AL00001+4,X'80'                                    1461
         L     @15,GDTDBG(,@04)                                    1461
         LA    @01,@AL00001                                        1461
         BALR  @14,@15                                             1461
*       /*************************************************************/
*       /*                                                           */
*       /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1462
*       IF TESTRC^=0 THEN                                          1462
@RT01459 SLR   @04,@04                                             1462
         CH    @04,TESTRC                                          1462
         BE    @RF01462                                            1462
*         DO;                                                      1463
*                                                                  1463
*           /*********************************************************/
*           /*                                                       */
*           /* IF MODIFY OUTPUT, DEQ THE VTOC                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1464
*           IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN           1464
         L     @15,@PC00001+4                                      1464
         C     @04,FDTPTR+356(,@15)                                1464
         BE    @RF01464                                            1464
         CLI   XTNHMODE(XTNTPTR),C'O'                              1464
         BNE   @RF01464                                            1464
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               1465
*                                                                  1465
         L     @15,@PC00001                                        1465
         ST    @15,@AL00001                                        1465
         L     @14,@PC00001+8                                      1465
         L     @14,REPQRPTR(,@14)                                  1465
         ST    @14,@AL00001+4                                      1465
         LA    @14,SPRNAME(,@14)                                   1465
         ST    @14,@AL00001+8                                      1465
         MVI   @AL00001+8,X'80'                                    1465
         L     @15,GDTDEQ(,@15)                                    1465
         LA    @01,@AL00001                                        1465
         BALR  @14,@15                                             1465
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1466
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1466
*                                                                  1466
@RF01464 MVC   @AL00001+4(8),@AL01466                              1466
         L     @15,@PC00001                                        1466
         ST    @15,@AL00001                                        1466
         L     @15,GDTFPL(,@15)                                    1466
         LA    @01,@AL00001                                        1466
         BALR  @14,@15                                             1466
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1467
*           RETURN CODE(LASTCC12);                                 1467
         LA    @15,12                                              1467
         L     @14,@SA00002                                        1467
         LM    @00,@12,@SA00002+8                                  1467
         BR    @14                                                 1467
*         END;                                                     1468
*                                                                  1468
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 00                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1469
*       RETURN CODE(LASTCC00);                                     1469
@RF01462 SLR   @15,@15                                             1469
         L     @14,@SA00002                                        1469
         LM    @00,@12,@SA00002+8                                  1469
         BR    @14                                                 1469
*     END DSVTOC;                                                  1470
*                                                                  1471
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A DATA SET: VSAM/NON-VSAM                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1471
*   RESPECIFY                                                      1471
*     IOINFOPT BASED(ADDR(INFOBYT));                               1471
@RF01301 DS    0H                                                  1472
*   RESPECIFY                                                      1472
*     XTNTTBL BASED(XTNTPTR);                                      1472
*   RESPECIFY                                                      1473
*     XTNTTBL2 BASED(XTNTPTR2);                                    1473
*   RESPECIFY                                                      1474
*     EXOARG BASED(REPEXOAR);                                      1474
*                                                                  1474
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE OBTAIN TO READ FORMAT 1 DSCB TO DETERMINE DATA SET TYPE */
*   /* (VSAM OR NON-VSAM)                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1475
*   CAM1=CAMLIST;                                                  1475
         MVC   CAM1(16),CAMLIST                                    1475
*   RESPECIFY                                                      1476
*     REG3 RESTRICTED;                                             1476
*   CAMDSN=ADDR(XTNHDSN);                                          1477
         LA    @02,XTNHDSN(,XTNTPTR)                               1477
         ST    @02,CAMDSN                                          1477
*   CAMVOL=ADDR(XTNHVOL);                                          1478
         LA    @02,XTNHVOL(,XTNTPTR)                               1478
         ST    @02,CAMVOL                                          1478
*   CAMWA=ADDR(OBTAINWA);                                          1479
         LA    @02,OBTAINWA                                        1479
         ST    @02,CAMWA                                           1479
*   REG3=ADDR(CAM1);                                               1480
         LA    REG3,CAM1                                           1480
*LOBTAIN:                                                          1481
*   GEN;                                                           1481
LOBTAIN  DS    0H                                                  1481
         OBTAIN (3)
*   RESPECIFY                                                      1482
*     REG3 UNRESTRICTED;                                           1482
*                                                                  1482
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN CODE FROM OBTAIN                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1483
*   RESPECIFY                                                      1483
*     RTNREG RSTD;                                                 1483
*   TESTRC=RTNREG;                                                 1484
         STH   RTNREG,TESTRC                                       1484
*   RESPECIFY                                                      1485
*     RTNREG UNRSTD;                                               1485
*                                                                  1485
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OBTAIN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = 12 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1486
*   IF TESTRC^=0 THEN                                              1486
         LH    @15,TESTRC                                          1486
         LTR   @15,@15                                             1486
         BZ    @RF01486                                            1486
*     DO;                                                          1487
*                                                                  1487
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE ERROR MESSAGE IDC31246I                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1488
*       DO;                                                        1488
*         CKREQ=CKREQ&&CKREQ;                                      1489
         L     @04,@PC00001+8                                      1489
         XC    CKREQ(44,@04),CKREQ(@04)                            1489
*         CKRERN=MSG46;                                            1490
         MVC   CKRERN(2,@04),@CH00770                              1490
*         CKRMVAR(1)=ADDR(OBTAIN);                                 1491
         LA    @15,@CC02831                                        1491
         ST    @15,CKRMVAR(,@04)                                   1491
*         CKRMVAR(2)=ADDR(XTNHDSN);                                1492
         LA    @15,XTNHDSN(,XTNTPTR)                               1492
         ST    @15,CKRMVAR+4(,@04)                                 1492
*         CALL IDCRDER;                                            1493
         L     @15,@CV01553                                        1493
         BALR  @14,@15                                             1493
*       END;                                                       1494
*                                                                  1494
*       /*************************************************************/
*       /*                                                           */
*       /* FREE THE BUFFERS                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1495
*       CALL IDCSAFP0(GDTTBL,RD01,ALL);                            1495
*                                                                  1495
         MVC   @AL00001+4(8),@AL01495                              1495
         L     @15,@PC00001                                        1495
         ST    @15,@AL00001                                        1495
         L     @15,GDTFPL(,@15)                                    1495
         LA    @01,@AL00001                                        1495
         BALR  @14,@15                                             1495
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1496
*       RETURN CODE(LASTCC12);                                     1496
         LA    @15,12                                              1496
         L     @14,@SA00002                                        1496
         LM    @00,@12,@SA00002+8                                  1496
         BR    @14                                                 1496
*     END;                                                         1497
*                                                                  1497
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DATA SET IS FIXED BLOCK STANDARD, SET REPAIR WORKFILE  */
*   /* HEADER RECORD INDICATORS                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1498
*   F1PTR=ADDR(OBTAINWA)-LENGTH(XTNHDSN);                          1498
@RF01486 LA    F1PTR,OBTAINWA                                      1498
         SL    F1PTR,@CF00600                                      1498
*   IF DS1RECFM=FBS THEN                                           1499
         CLI   DS1RECFM(F1PTR),X'88'                               1499
         BNE   @RF01499                                            1499
*     DO;                                                          1500
*       RWHDRFIX=FXBLKSTD;                                         1501
         L     @03,@PC00001+8                                      1501
         L     @03,REPRWHAR(,@03)                                  1501
         MVI   RWHDRFIX(@03),C'F'                                  1501
*       RWHDRDLN=DS1LRECL;                                         1502
         MVC   RWHDRDLN(2,@03),DS1LRECL(F1PTR)                     1502
*       RWHDRKLN=NULLPTR;                                          1503
         MVI   RWHDRKLN(@03),X'00'                                 1503
*     END;                                                         1504
*                                                                  1504
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE, CLEAR THE INDICATORS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1505
*   ELSE                                                           1505
*     DO;                                                          1505
         B     @RC01499                                            1505
@RF01499 DS    0H                                                  1506
*       RWHDRFIX=''B;                                              1506
         L     @03,@PC00001+8                                      1506
         L     @03,REPRWHAR(,@03)                                  1506
         MVI   RWHDRFIX(@03),X'00'                                 1506
*       RWHDRDLN=NULLPTR;                                          1507
         SLR   @15,@15                                             1507
         STH   @15,RWHDRDLN(,@03)                                  1507
*       RWHDRKLN=NULLPTR;                                          1508
         MVI   RWHDRKLN(@03),X'00'                                 1508
*     END;                                                         1509
*                                                                  1510
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A DATA SET: VSAM                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1510
*   IF DS1DSORG(2)=VSAMFMT THEN                                    1510
@RC01499 CLI   DS1DSORG+1(F1PTR),X'08'                             1510
         BNE   @RF01510                                            1510
*DSVSAM:                                                           1511
*     DO;                                                          1511
*                                                                  1511
DSVSAM   DS    0H                                                  1512
*       /*************************************************************/
*       /*                                                           */
*       /* SET TRACE POINT                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1512
*       OLDERID2=NEWERID2;                                         1512
         L     @03,@PC00001                                        1512
         L     @03,GDTTR2(,@03)                                    1512
         MVC   @TS00001(95),NEWERID2(@03)                          1512
         MVC   OLDERID2(95,@03),@TS00001                           1512
*       NEWID2='RD6M';                                             1513
*                                                                  1513
         MVC   NEWID2(4,@03),@CC02924                              1513
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (OPNAGL)                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1514
*       OPNPTR=REPOPAGL;                                           1514
         L     @15,@PC00001+8                                      1514
         L     OPNPTR,REPOPAGL(,@15)                               1514
*       OPNAGL=''B;                                                1515
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1515
*       OPNMODRC=ON;                                               1516
         OI    OPNMODRC(OPNPTR),B'00100000'                        1516
*       OPNOPTIN=ON;                                               1517
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1517
*       OPNDSOAM=ON;                                               1518
         OI    OPNDSOAM(OPNPTR),B'10000000'                        1518
*       OPNDDN=ADDR(XTNHDDN);                                      1519
         ST    XTNTPTR,OPNDDN(,OPNPTR)                             1519
*       IF XTNHPWD^=ZEROS THEN                                     1520
         CLC   XTNHPWD(8,XTNTPTR),ZEROS                            1520
         BE    @RF01520                                            1520
*         OPNPWA=ADDR(XTNHPWD);                                    1521
         LA    @03,XTNHPWD(,XTNTPTR)                               1521
         ST    @03,OPNPWA(,OPNPTR)                                 1521
*       OPNIOC=ADDR(REPCDSOP);                                     1522
*                                                                  1522
@RF01520 L     @03,@PC00001+8                                      1522
         LA    @03,REPCDSOP(,@03)                                  1522
         ST    @03,OPNIOC(,OPNPTR)                                 1522
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UOPEN                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1523
*       CALL IDCIOOP0(GDTTBL,OPNAGL);                              1523
*                                                                  1523
         L     @03,@PC00001                                        1523
         ST    @03,@AL00001                                        1523
         ST    OPNPTR,@AL00001+4                                   1523
         MVI   @AL00001+4,X'80'                                    1523
         L     @15,GDTOPN(,@03)                                    1523
         LA    @01,@AL00001                                        1523
         BALR  @14,@15                                             1523
*       /*************************************************************/
*       /*                                                           */
*       /* * SAVE RETURN CODE FROM UOPEN                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1524
*       RESPECIFY                                                  1524
*         RTNREG RSTD;                                             1524
*       TESTRC=RTNREG;                                             1525
         STH   RTNREG,TESTRC                                       1525
*       RESPECIFY                                                  1526
*         RTNREG UNRSTD;                                           1526
*       IOCSPTR=REPCDSOP;                                          1527
*                                                                  1527
         L     @15,@PC00001+8                                      1527
         L     @15,REPCDSOP(,@15)                                  1527
         ST    @15,IOCSPTR                                         1527
*       /*************************************************************/
*       /*                                                           */
*       /* IF UOPEN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1528
*       IF TESTRC^=0&IOCMSGOP=OFF THEN                             1528
         LH    @14,TESTRC                                          1528
         LTR   @14,@14                                             1528
         BZ    @RF01528                                            1528
         TM    IOCMSGOP(@15),B'00100000'                           1528
         BNZ   @RF01528                                            1528
*         DO;                                                      1529
*                                                                  1529
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1530
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1530
*                                                                  1530
         MVC   @AL00001+4(8),@AL01530                              1530
         L     @15,@PC00001                                        1530
         ST    @15,@AL00001                                        1530
         L     @15,GDTFPL(,@15)                                    1530
         LA    @01,@AL00001                                        1530
         BALR  @14,@15                                             1530
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1531
*           RETURN CODE(LASTCC12);                                 1531
         LA    @15,12                                              1531
         L     @14,@SA00002                                        1531
         LM    @00,@12,@SA00002+8                                  1531
         BR    @14                                                 1531
*         END;                                                     1532
*       RESPECIFY                                                  1533
*         IFGACB BASED(IOCCBP);                                    1533
@RF01528 DS    0H                                                  1534
*       RESPECIFY                                                  1534
*         IDAAMBL BASED(ACBAMBL);                                  1534
*       RESPECIFY                                                  1535
*         IDAAMB BASED(AMBLIX);                                    1535
*       RESPECIFY                                                  1536
*         IDAAMDSB BASED(AMBDSB);                                  1536
*                                                                  1536
*       /*************************************************************/
*       /*                                                           */
*       /* IF FIELD AMBLIX IS NOT EQUAL TO ZERO, DATA SET IS A KEY   */
*       /* SEQUENTIAL DATA SET (KSDS)                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1537
*       IF AMBLIX^=NULLPTR THEN                                    1537
         SLR   @15,@15                                             1537
         L     @01,IOCSPTR                                         1537
         L     @01,IOCCBP(,@01)                                    1537
         L     @01,ACBAMBL(,@01)                                   1537
         L     @14,AMBLIX(,@01)                                    1537
         CR    @14,@15                                             1537
         BE    @RF01537                                            1537
*         DO;                                                      1538
*           DEBPTR=AMBDEBAD;                                       1539
         L     @03,AMBDEBAD-1(,@14)                                1539
         LA    @03,0(,@03)                                         1539
         ST    @03,DEBPTR                                          1539
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              1540
*                                                                  1540
         AL    @03,@CF00223                                        1540
         LR    DEBDAPTR,@03                                        1540
*           /*********************************************************/
*           /*                                                       */
*           /* CONSTRUCT XTNTTBL2                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1541
*           RESPECIFY                                              1541
*             REG3 RESTRICTED;                                     1541
*           REG3=ZERO;                                             1542
         LR    REG3,@15                                            1542
*           DO I=1 BY 1 TO DEBNMEXT;                               1543
         LA    @15,1                                               1543
         L     @14,@PC00001+8                                      1543
         STC   @15,I(,@14)                                         1543
         B     @DE01543                                            1543
@DL01543 DS    0H                                                  1544
*             XTN2CC1(I)=(DEBDAPTR+REG3)->DEBSTRCC;                1544
         L     @15,@PC00001+8                                      1544
         SLR   @14,@14                                             1544
         IC    @14,I(,@15)                                         1544
         LR    @15,@14                                             1544
         MH    @15,@CH00797                                        1544
         LR    @01,DEBDAPTR                                        1544
         ALR   @01,REG3                                            1544
         LH    @00,DEBSTRCC(,@01)                                  1544
         N     @00,@CF03043                                        1544
         LR    @14,XTNTPTR2                                        1544
         AL    @14,@CF03047                                        1544
         STH   @00,XTN2CC1-44(@15,@14)                             1544
*             XTN2HH1(I)=(DEBDAPTR+REG3)->DEBSTRHH;                1545
         LH    @14,DEBSTRHH(,@01)                                  1545
         N     @14,@CF03043                                        1545
         ST    @01,@TF00001                                        1545
         LR    @01,XTNTPTR2                                        1545
         AL    @01,@CF03048                                        1545
         STH   @14,XTN2HH1-46(@15,@01)                             1545
*             XTN2CC2(I)=(DEBDAPTR+REG3)->DEBENDCC;                1546
         L     @01,@TF00001                                        1546
         LH    @14,DEBENDCC(,@01)                                  1546
         N     @14,@CF03043                                        1546
         LR    @01,XTNTPTR2                                        1546
         AL    @01,@CF03049                                        1546
         STH   @14,XTN2CC2-48(@15,@01)                             1546
*             XTN2HH2(I)=(DEBDAPTR+REG3)->DEBENDHH;                1547
         L     @01,@TF00001                                        1547
         LH    @14,DEBENDHH(,@01)                                  1547
         N     @14,@CF03043                                        1547
         AL    @15,@CF03050                                        1547
         STH   @14,XTN2HH2-50(@15,XTNTPTR2)                        1547
*             REG3=I;                                              1548
         L     @15,@PC00001+8                                      1548
         SLR   @14,@14                                             1548
         IC    @14,I(,@15)                                         1548
         LR    REG3,@14                                            1548
*             SLL(REG3,EXTNTVAL);                                  1549
         L     @01,DEBPTR                                          1549
         SLR   @15,@15                                             1549
         IC    @15,EXTNTVAL(,@01)                                  1549
         SLL   REG3,0(@15)                                         1549
*           END;                                                   1550
         L     @14,@PC00001+8                                      1550
         LA    @15,1                                               1550
         SLR   @01,@01                                             1550
         IC    @01,I(,@14)                                         1550
         ALR   @15,@01                                             1550
         L     @14,@PC00001+8                                      1550
         STC   @15,I(,@14)                                         1550
@DE01543 L     @14,DEBPTR                                          1550
         SLR   @01,@01                                             1550
         IC    @01,DEBNMEXT(,@14)                                  1550
         CR    @15,@01                                             1550
         BNH   @DL01543                                            1550
*           RESPECIFY                                              1551
*             IDAAMB BASED(AMBLDTA);                               1551
*           DEBPTR=AMBDEBAD;                                       1552
         L     @01,IOCSPTR                                         1552
         L     @01,IOCCBP(,@01)                                    1552
         L     @01,ACBAMBL(,@01)                                   1552
         L     @01,AMBLDTA(,@01)                                   1552
         L     @15,AMBDEBAD-1(,@01)                                1552
         LA    @15,0(,@15)                                         1552
         ST    @15,DEBPTR                                          1552
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              1553
         AL    @15,@CF00223                                        1553
         LR    DEBDAPTR,@15                                        1553
*           REG3=0;                                                1554
         SLR   REG3,REG3                                           1554
*           K=0;                                                   1555
         L     @15,@PC00001+8                                      1555
         MVI   K(@15),X'00'                                        1555
*           DO J=I BY 1 TO(DEBNMEXT+(I-1));                        1556
         SLR   @14,@14                                             1556
         IC    @14,I(,@15)                                         1556
         L     @15,@PC00001+8                                      1556
         STC   @14,J(,@15)                                         1556
         B     @DE01556                                            1556
@DL01556 DS    0H                                                  1557
*             XTN2CC1(J)=(DEBDAPTR+REG3)->DEBSTRCC;                1557
         L     @15,@PC00001+8                                      1557
         SLR   @14,@14                                             1557
         IC    @14,J(,@15)                                         1557
         MH    @14,@CH00797                                        1557
         LR    @01,DEBDAPTR                                        1557
         ALR   @01,REG3                                            1557
         LH    @00,DEBSTRCC(,@01)                                  1557
         N     @00,@CF03043                                        1557
         LR    @15,XTNTPTR2                                        1557
         AL    @15,@CF03047                                        1557
         STH   @00,XTN2CC1-44(@14,@15)                             1557
*             XTN2HH1(J)=(DEBDAPTR+REG3)->DEBSTRHH;                1558
         LH    @15,DEBSTRHH(,@01)                                  1558
         N     @15,@CF03043                                        1558
         ST    @01,@TF00001                                        1558
         LR    @01,XTNTPTR2                                        1558
         AL    @01,@CF03048                                        1558
         STH   @15,XTN2HH1-46(@14,@01)                             1558
*             XTN2CC2(J)=(DEBDAPTR+REG3)->DEBENDCC;                1559
         L     @01,@TF00001                                        1559
         LH    @15,DEBENDCC(,@01)                                  1559
         N     @15,@CF03043                                        1559
         LR    @01,XTNTPTR2                                        1559
         AL    @01,@CF03049                                        1559
         STH   @15,XTN2CC2-48(@14,@01)                             1559
*             XTN2HH2(J)=(DEBDAPTR+REG3)->DEBENDHH;                1560
         L     @01,@TF00001                                        1560
         LH    @15,DEBENDHH(,@01)                                  1560
         N     @15,@CF03043                                        1560
         AL    @14,@CF03050                                        1560
         STH   @15,XTN2HH2-50(@14,XTNTPTR2)                        1560
*             K=K+1;                                               1561
         L     @15,@PC00001+8                                      1561
         LA    @14,1                                               1561
         SLR   @01,@01                                             1561
         IC    @01,K(,@15)                                         1561
         ALR   @14,@01                                             1561
         STC   @14,K(,@15)                                         1561
*             REG3=K;                                              1562
         LR    REG3,@14                                            1562
*             SLL(REG3,EXTNTVAL);                                  1563
         L     @01,DEBPTR                                          1563
         SLR   @15,@15                                             1563
         IC    @15,EXTNTVAL(,@01)                                  1563
         SLL   REG3,0(@15)                                         1563
*           END;                                                   1564
         L     @15,@PC00001+8                                      1564
         LA    @14,1                                               1564
         SLR   @01,@01                                             1564
         IC    @01,J(,@15)                                         1564
         ALR   @14,@01                                             1564
         L     @15,@PC00001+8                                      1564
         STC   @14,J(,@15)                                         1564
@DE01556 L     @15,@PC00001+8                                      1564
         SLR   @01,@01                                             1564
         IC    @01,I(,@15)                                         1564
         BCTR  @01,0                                               1564
         L     @15,DEBPTR                                          1564
         SLR   @00,@00                                             1564
         IC    @00,DEBNMEXT(,@15)                                  1564
         ALR   @01,@00                                             1564
         CR    @14,@01                                             1564
         BNH   @DL01556                                            1564
*           XTN2ENT(J)=LASTENT;                                    1565
         L     @02,@PC00001+8                                      1565
         SLR   @15,@15                                             1565
         IC    @15,J(,@02)                                         1565
         MH    @15,@CH00797                                        1565
         ALR   @15,XTNTPTR2                                        1565
         AL    @15,@CF03051                                        1565
         MVC   XTN2ENT(52,@15),LASTENT                             1565
*         END;                                                     1566
*                                                                  1566
*       /*************************************************************/
*       /*                                                           */
*       /* IF NOT A KSDS, SAVE DATA EXTENTS ONLY IN XTNTTBL2         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1567
*       ELSE                                                       1567
*         DO;                                                      1567
         B     @RC01537                                            1567
@RF01537 DS    0H                                                  1568
*           REG3=0;                                                1568
         SLR   REG3,REG3                                           1568
*           DEBPTR=AMBDEBAD;                                       1569
         L     @01,IOCSPTR                                         1569
         L     @01,IOCCBP(,@01)                                    1569
         L     @01,ACBAMBL(,@01)                                   1569
         L     @01,AMBLDTA(,@01)                                   1569
         L     @15,AMBDEBAD-1(,@01)                                1569
         LA    @15,0(,@15)                                         1569
         ST    @15,DEBPTR                                          1569
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              1570
         AL    @15,@CF00223                                        1570
         LR    DEBDAPTR,@15                                        1570
*           DO I=1 BY 1 TO DEBNMEXT;                               1571
         LA    @15,1                                               1571
         L     @14,@PC00001+8                                      1571
         STC   @15,I(,@14)                                         1571
         B     @DE01571                                            1571
@DL01571 DS    0H                                                  1572
*             XTN2CC1(I)=(DEBDAPTR+REG3)->DEBSTRCC;                1572
         L     @15,@PC00001+8                                      1572
         SLR   @14,@14                                             1572
         IC    @14,I(,@15)                                         1572
         LR    @15,@14                                             1572
         MH    @15,@CH00797                                        1572
         LR    @01,DEBDAPTR                                        1572
         ALR   @01,REG3                                            1572
         LH    @00,DEBSTRCC(,@01)                                  1572
         N     @00,@CF03043                                        1572
         LR    @14,XTNTPTR2                                        1572
         AL    @14,@CF03047                                        1572
         STH   @00,XTN2CC1-44(@15,@14)                             1572
*             XTN2HH1(I)=(DEBDAPTR+REG3)->DEBSTRHH;                1573
         LH    @14,DEBSTRHH(,@01)                                  1573
         N     @14,@CF03043                                        1573
         ST    @01,@TF00001                                        1573
         LR    @01,XTNTPTR2                                        1573
         AL    @01,@CF03048                                        1573
         STH   @14,XTN2HH1-46(@15,@01)                             1573
*             XTN2CC2(I)=(DEBDAPTR+REG3)->DEBENDCC;                1574
         L     @01,@TF00001                                        1574
         LH    @14,DEBENDCC(,@01)                                  1574
         N     @14,@CF03043                                        1574
         LR    @01,XTNTPTR2                                        1574
         AL    @01,@CF03049                                        1574
         STH   @14,XTN2CC2-48(@15,@01)                             1574
*             XTN2HH2(I)=(DEBDAPTR+REG3)->DEBENDHH;                1575
         L     @01,@TF00001                                        1575
         LH    @14,DEBENDHH(,@01)                                  1575
         N     @14,@CF03043                                        1575
         AL    @15,@CF03050                                        1575
         STH   @14,XTN2HH2-50(@15,XTNTPTR2)                        1575
*             REG3=I;                                              1576
         L     @15,@PC00001+8                                      1576
         SLR   @14,@14                                             1576
         IC    @14,I(,@15)                                         1576
         LR    REG3,@14                                            1576
*             SLL(REG3,EXTNTVAL);                                  1577
         L     @01,DEBPTR                                          1577
         SLR   @15,@15                                             1577
         IC    @15,EXTNTVAL(,@01)                                  1577
         SLL   REG3,0(@15)                                         1577
*           END;                                                   1578
         L     @14,@PC00001+8                                      1578
         LA    @15,1                                               1578
         SLR   @01,@01                                             1578
         IC    @01,I(,@14)                                         1578
         ALR   @15,@01                                             1578
         L     @14,@PC00001+8                                      1578
         STC   @15,I(,@14)                                         1578
@DE01571 L     @14,DEBPTR                                          1578
         SLR   @01,@01                                             1578
         IC    @01,DEBNMEXT(,@14)                                  1578
         CR    @15,@01                                             1578
         BNH   @DL01571                                            1578
*           XTN2ENT(I)=LASTENT;                                    1579
         L     @02,@PC00001+8                                      1579
         SLR   @15,@15                                             1579
         IC    @15,I(,@02)                                         1579
         MH    @15,@CH00797                                        1579
         ALR   @15,XTNTPTR2                                        1579
         AL    @15,@CF03051                                        1579
         MVC   XTN2ENT(52,@15),LASTENT                             1579
*         END;                                                     1580
*       RESPECIFY                                                  1581
*         REG3 UNRESTRICTED;                                       1581
*                                                                  1581
@RC01537 DS    0H                                                  1582
*       /*************************************************************/
*       /*                                                           */
*       /* GET ADDRESS OF USYSINFO RETURN AREA                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1582
*       IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN                 1582
         L     @15,@PC00001+4                                      1582
         L     @15,FDTPTR+356(,@15)                                1582
         LTR   @15,@15                                             1582
         BZ    @RF01582                                            1582
         L     @15,@PC00002                                        1582
         CLI   IOPARM(@15),C'O'                                    1582
         BNE   @RF01582                                            1582
*         SINFPTR=REPOSYSI;                                        1583
*                                                                  1583
         L     @15,@PC00001+8                                      1583
         L     @15,REPOSYSI(,@15)                                  1583
         ST    @15,SINFPTR                                         1583
*       /*************************************************************/
*       /*                                                           */
*       /* DO NOT CLOSE VSAM DATA SET IN ORDER TO ENSURE NO ONE ELSE */
*       /* WILL GET CONTROL DURING MODIFY                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1584
*       ELSE                                                       1584
*         DO;                                                      1584
         B     @RC01582                                            1584
@RF01582 DS    0H                                                  1585
*           SINFPTR=REPISYSI;                                      1585
*                                                                  1585
         L     @15,@PC00001+8                                      1585
         L     @14,REPISYSI(,@15)                                  1585
         ST    @14,SINFPTR                                         1585
*           /*********************************************************/
*           /*                                                       */
*           /* CLOSE VSAM DATA SET IF INPUT PROCESSING AND ZERO OUT  */
*           /* REPCDSOP SO MODIFY KNOWS ITS CLOSED                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1586
*           CALL IDCIOCL0(GDTTBL,REPCDSOP);                        1586
         L     @14,@PC00001                                        1586
         ST    @14,@AL00001                                        1586
         LA    @15,REPCDSOP(,@15)                                  1586
         ST    @15,@AL00001+4                                      1586
         MVI   @AL00001+4,X'80'                                    1586
         L     @15,GDTCLS(,@14)                                    1586
         LA    @01,@AL00001                                        1586
         BALR  @14,@15                                             1586
*           REPCDSOP=NULLPTR;                                      1587
         L     @15,@PC00001+8                                      1587
         SLR   @14,@14                                             1587
         ST    @14,REPCDSOP(,@15)                                  1587
*         END;                                                     1588
*                                                                  1588
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USYSINFO TO GET UCB ADDRESS                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1589
*       CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);                1589
*                                                                  1589
@RC01582 L     @15,@PC00001                                        1589
         ST    @15,@AL00001                                        1589
         LA    @14,UNIT                                            1589
         ST    @14,@AL00001+4                                      1589
         LA    @14,SINFPTR                                         1589
         ST    @14,@AL00001+8                                      1589
         ST    XTNTPTR,@AL00001+12                                 1589
         MVI   @AL00001+12,X'80'                                   1589
         L     @15,GDTSFO(,@15)                                    1589
         LA    @01,@AL00001                                        1589
         BALR  @14,@15                                             1589
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM USYSINFO                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1590
*       RESPECIFY                                                  1590
*         RTNREG RSTD;                                             1590
*       TESTRC=RTNREG;                                             1591
         STH   RTNREG,TESTRC                                       1591
*       RESPECIFY                                                  1592
*         RTNREG UNRSTD;                                           1592
*                                                                  1592
*       /*************************************************************/
*       /*                                                           */
*       /* IF USYSINFO FAILS, PREPARE TO RETURN TO THE CALLER WITH RC*/
*       /* = 12                                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1593
*       IF TESTRC^=0 THEN                                          1593
         LH    @15,TESTRC                                          1593
         LTR   @15,@15                                             1593
         BZ    @RF01593                                            1593
*         DO;                                                      1594
*                                                                  1594
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1595
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1595
*                                                                  1595
         MVC   @AL00001+4(8),@AL01595                              1595
         L     @15,@PC00001                                        1595
         ST    @15,@AL00001                                        1595
         L     @15,GDTFPL(,@15)                                    1595
         LA    @01,@AL00001                                        1595
         BALR  @14,@15                                             1595
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1596
*           RETURN CODE(LASTCC12);                                 1596
         LA    @15,12                                              1596
         L     @14,@SA00002                                        1596
         LM    @00,@12,@SA00002+8                                  1596
         BR    @14                                                 1596
*         END;                                                     1597
*                                                                  1597
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE UCB ADDRESS INTO THE EXOARG FOR CALLING UEXCP TO  */
*       /* OPEN THE VSAM EXTENTS LATER                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1598
*       EXOUCB=SINFAREA;                                           1598
*                                                                  1598
@RF01593 L     @15,@PC00001+8                                      1598
         L     @15,REPEXOAR(,@15)                                  1598
         L     @14,SINFPTR                                         1598
         L     @14,SINFAREA(,@14)                                  1598
         ST    @14,EXOUCB(,@15)                                    1598
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE VSAM BIT FOR UEXCP OPEN                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1599
*       EXORVS=ON;                                                 1599
         OI    EXORVS(@15),B'00010000'                             1599
*     END DSVSAM;                                                  1600
*                                                                  1601
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING A DATA SET: NON-VSAM                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1601
*   ELSE                                                           1601
*     DO;                                                          1601
*                                                                  1601
         B     @RC01510                                            1601
@RF01510 DS    0H                                                  1602
*       /*************************************************************/
*       /*                                                           */
*       /* SET TRACE POINT                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1602
*       OLDERID2=NEWERID2;                                         1602
         L     @03,@PC00001                                        1602
         L     @15,GDTTR2(,@03)                                    1602
         MVC   @TS00001(95),NEWERID2(@15)                          1602
         MVC   OLDERID2(95,@15),@TS00001                           1602
*       NEWID2='RD6N';                                             1603
*                                                                  1603
         MVC   NEWID2(4,@15),@CC02931                              1603
*       /*************************************************************/
*       /*                                                           */
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (OPNAGL)                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1604
*       OPNPTR=REPOPAGL;                                           1604
         L     @15,@PC00001+8                                      1604
         L     OPNPTR,REPOPAGL(,@15)                               1604
*       OPNAGL=''B;                                                1605
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1605
*       OPNMODRC=ON;                                               1606
         OI    OPNMODRC(OPNPTR),B'00100000'                        1606
*       OPNOPTIN=ON;                                               1607
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1607
*       OPNDDN=ADDR(XTNHDDN);                                      1608
         ST    XTNTPTR,OPNDDN(,OPNPTR)                             1608
*       OPNIOC=ADDR(REPCDSOP);                                     1609
*                                                                  1609
         LA    @15,REPCDSOP(,@15)                                  1609
         ST    @15,OPNIOC(,OPNPTR)                                 1609
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UOPEN                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1610
*       CALL IDCIOOP0(GDTTBL,OPNAGL);                              1610
*                                                                  1610
         ST    @03,@AL00001                                        1610
         ST    OPNPTR,@AL00001+4                                   1610
         MVI   @AL00001+4,X'80'                                    1610
         L     @15,GDTOPN(,@03)                                    1610
         LA    @01,@AL00001                                        1610
         BALR  @14,@15                                             1610
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE RETURN CODE FROM UOPEN                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1611
*       RESPECIFY                                                  1611
*         RTNREG RSTD;                                             1611
*       TESTRC=RTNREG;                                             1612
         STH   RTNREG,TESTRC                                       1612
*       RESPECIFY                                                  1613
*         RTNREG UNRSTD;                                           1613
*                                                                  1613
*       /*************************************************************/
*       /*                                                           */
*       /* IF UOPEN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */
*       /* 12                                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1614
*       IF TESTRC^=0 THEN                                          1614
         LH    @15,TESTRC                                          1614
         LTR   @15,@15                                             1614
         BZ    @RF01614                                            1614
*         DO;                                                      1615
*                                                                  1615
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE BUFFERS                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1616
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1616
*                                                                  1616
         MVC   @AL00001+4(8),@AL01616                              1616
         L     @15,@PC00001                                        1616
         ST    @15,@AL00001                                        1616
         L     @15,GDTFPL(,@15)                                    1616
         LA    @01,@AL00001                                        1616
         BALR  @14,@15                                             1616
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN TO THE CALLER WITH RC = 12                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1617
*           RETURN CODE(LASTCC12);                                 1617
         LA    @15,12                                              1617
         L     @14,@SA00002                                        1617
         LM    @00,@12,@SA00002+8                                  1617
         BR    @14                                                 1617
*         END;                                                     1618
*       IOCSPTR=REPCDSOP;                                          1619
@RF01614 L     @03,@PC00001+8                                      1619
         L     @03,REPCDSOP(,@03)                                  1619
         ST    @03,IOCSPTR                                         1619
*       RESPECIFY                                                  1620
*         IHADCB BASED(IOCCBP);                                    1620
*       DEBPTR=DCBDEBAD;                                           1621
         L     @03,IOCCBP(,@03)                                    1621
         L     @03,DCBDEBAD+40(,@03)                               1621
         ST    @03,DEBPTR                                          1621
*       DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);                  1622
*                                                                  1622
         AL    @03,@CF00223                                        1622
         LR    DEBDAPTR,@03                                        1622
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE DEB EXTENTS IN XTNTTBL2.                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1623
*       RESPECIFY                                                  1623
*         REG3 RESTRICTED;                                         1623
*       REG3=0;                                                    1624
         SLR   REG3,REG3                                           1624
*       DO I=1 BY 1 TO DEBNMEXT;                                   1625
         LA    @15,1                                               1625
         L     @14,@PC00001+8                                      1625
         STC   @15,I(,@14)                                         1625
         B     @DE01625                                            1625
@DL01625 DS    0H                                                  1626
*         XTN2CC1(I)=(DEBDAPTR+REG3)->DEBSTRCC;                    1626
         L     @15,@PC00001+8                                      1626
         SLR   @14,@14                                             1626
         IC    @14,I(,@15)                                         1626
         LR    @15,@14                                             1626
         MH    @15,@CH00797                                        1626
         LR    @01,DEBDAPTR                                        1626
         ALR   @01,REG3                                            1626
         LH    @00,DEBSTRCC(,@01)                                  1626
         N     @00,@CF03043                                        1626
         LR    @14,XTNTPTR2                                        1626
         AL    @14,@CF03047                                        1626
         STH   @00,XTN2CC1-44(@15,@14)                             1626
*         XTN2HH1(I)=(DEBDAPTR+REG3)->DEBSTRHH;                    1627
         LH    @14,DEBSTRHH(,@01)                                  1627
         N     @14,@CF03043                                        1627
         ST    @01,@TF00001                                        1627
         LR    @01,XTNTPTR2                                        1627
         AL    @01,@CF03048                                        1627
         STH   @14,XTN2HH1-46(@15,@01)                             1627
*         XTN2CC2(I)=(DEBDAPTR+REG3)->DEBENDCC;                    1628
         L     @01,@TF00001                                        1628
         LH    @14,DEBENDCC(,@01)                                  1628
         N     @14,@CF03043                                        1628
         LR    @01,XTNTPTR2                                        1628
         AL    @01,@CF03049                                        1628
         STH   @14,XTN2CC2-48(@15,@01)                             1628
*         XTN2HH2(I)=(DEBDAPTR+REG3)->DEBENDHH;                    1629
         L     @01,@TF00001                                        1629
         LH    @14,DEBENDHH(,@01)                                  1629
         N     @14,@CF03043                                        1629
         AL    @15,@CF03050                                        1629
         STH   @14,XTN2HH2-50(@15,XTNTPTR2)                        1629
*         REG3=I;                                                  1630
         L     @15,@PC00001+8                                      1630
         SLR   @14,@14                                             1630
         IC    @14,I(,@15)                                         1630
         LR    REG3,@14                                            1630
*         SLL(REG3,EXTNTVAL);                                      1631
         L     @01,DEBPTR                                          1631
         SLR   @15,@15                                             1631
         IC    @15,EXTNTVAL(,@01)                                  1631
         SLL   REG3,0(@15)                                         1631
*       END;                                                       1632
         L     @14,@PC00001+8                                      1632
         LA    @15,1                                               1632
         SLR   @01,@01                                             1632
         IC    @01,I(,@14)                                         1632
         ALR   @15,@01                                             1632
         L     @14,@PC00001+8                                      1632
         STC   @15,I(,@14)                                         1632
@DE01625 L     @14,DEBPTR                                          1632
         SLR   @01,@01                                             1632
         IC    @01,DEBNMEXT(,@14)                                  1632
         CR    @15,@01                                             1632
         BNH   @DL01625                                            1632
*       RESPECIFY                                                  1633
*         REG3 UNRESTRICTED;                                       1633
*                                                                  1633
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE LAST ENTRY INDICATOR IN XTNTTBL2                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1634
*       I=I+1;                                                     1634
         L     @15,@PC00001+8                                      1634
         LA    @14,1                                               1634
         SLR   @03,@03                                             1634
         IC    @03,I(,@15)                                         1634
         ALR   @14,@03                                             1634
         STC   @14,I(,@15)                                         1634
*       XTN2ENT(I)=LASTENT;                                        1635
*                                                                  1635
         MH    @14,@CH00797                                        1635
         ALR   @14,XTNTPTR2                                        1635
         AL    @14,@CF03051                                        1635
         MVC   XTN2ENT(52,@14),LASTENT                             1635
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE THE NON-VSAM DATA SET                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1636
*       CALL IDCIOCL0(GDTTBL,REPCDSOP);                            1636
         L     @15,@PC00001                                        1636
         ST    @15,@AL00001                                        1636
         L     @14,@PC00001+8                                      1636
         LA    @14,REPCDSOP(,@14)                                  1636
         ST    @14,@AL00001+4                                      1636
         MVI   @AL00001+4,X'80'                                    1636
         L     @15,GDTCLS(,@15)                                    1636
         LA    @01,@AL00001                                        1636
         BALR  @14,@15                                             1636
*       REPCDSOP=NULLPTR;                                          1637
*                                                                  1637
         L     @15,@PC00001+8                                      1637
         SLR   @14,@14                                             1637
         ST    @14,REPCDSOP(,@15)                                  1637
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE DATA SET INDICATOR IN THE UEXCP ARG LIST          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1638
*       EXORDS=ON;                                                 1638
         L     @01,REPEXOAR(,@15)                                  1638
         OI    EXORDS(@01),B'00000100'                             1638
*     END;                                                         1639
*                                                                  1640
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION COMPLETES VSAM AND NON-VSAM DATA SET PROCESSING  */
*   /* BY BUILDING XTNTTBL TO CONTAIN ONLY THE ENTRIES FROM XTNTTBL2 */
*   /* THAT ARE WITHIN THE RANGE SPECIFIED BY THE USER. I INDEXES    */
*   /* XTNTTBL2 J INDEXES XTNTTBL K EQUALS XTNTTBL2 ENTRIES          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1640
*   I=1;                                                           1640
@RC01510 L     @15,@PC00001+8                                      1640
         MVI   I(@15),X'01'                                        1640
*   J=1;                                                           1641
         MVI   J(@15),X'01'                                        1641
*   K=0;                                                           1642
*                                                                  1642
         MVI   K(@15),X'00'                                        1642
*   /*****************************************************************/
*   /*                                                               */
*   /* EACH ENTRY IN XTNTTBL2 IS CHECKED AGAINST THE USER SUPPLIED   */
*   /* RANGE AND XTNTTBL IS CONSTRUCTED USING THE THE EXTENTS OR     */
*   /* PORTIONS OF EXTENTS THAT FALL WITHIN THE RANGE.               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1643
*BLDXTTBL:                                                         1643
*   DO UNTIL XTN2ENT(I)=LASTENT(1:LENGTH(XTN2ENT));                1643
*                                                                  1643
BLDXTTBL DS    0H                                                  1643
@DL01643 DS    0H                                                  1644
*     /***************************************************************/
*     /*                                                             */
*     /* COMPARE THE XTNTTBL2 LOWER LIMIT AGAINST THE USER SUPPLIED  */
*     /* RANGE                                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1644
*     IF XTNHCHR1(1:4)<=XTN2CHR2(I)&XTNHCHR2(1:4)>=XTN2CHR1(I) THEN
         L     @15,@PC00001+8                                      1644
         SLR   @14,@14                                             1644
         IC    @14,I(,@15)                                         1644
         MH    @14,@CH00797                                        1644
         ST    @14,@TF00001                                        1644
         ALR   @14,XTNTPTR2                                        1644
         AL    @14,@CF03049                                        1644
         CLC   XTNHCHR1(4,XTNTPTR),XTN2CHR2-48(@14)                1644
         BH    @RF01644                                            1644
         LR    @01,XTNTPTR2                                        1644
         AL    @01,@TF00001                                        1644
         AL    @01,@CF03047                                        1644
         CLC   XTNHCHR2(4,XTNTPTR),XTN2CHR1-44(@01)                1644
         BL    @RF01644                                            1644
*       DO;                                                        1645
*                                                                  1645
*         /***********************************************************/
*         /*                                                         */
*         /* IF WITHIN THE RANGE (COMPARING CCHH ONLY), SAVE THE     */
*         /* DDNAME AND VOLUME SERIAL NUMBER FROM THE EXTENT TABLE   */
*         /* HEADER AND THE DSNAME FROM THE XTNTTBL2 ENTRY.          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1646
*         K=K+1;                                                   1646
         LA    @14,1                                               1646
         SLR   @03,@03                                             1646
         IC    @03,K(,@15)                                         1646
         ALR   @03,@14                                             1646
         STC   @03,K(,@15)                                         1646
*         XTNTDDN(J)=XTNHDDN;                                      1647
         SLR   @03,@03                                             1647
         IC    @03,J(,@15)                                         1647
         MH    @03,@CH02809                                        1647
         ST    @03,@TF00002                                        1647
         ALR   @03,XTNTPTR                                         1647
         MVC   XTNTDDN-78(8,@03),XTNHDDN(XTNTPTR)                  1647
*         XTNTDSN(J)=XTNHDSN;                                      1648
         LR    @01,XTNTPTR                                         1648
         AL    @01,@TF00002                                        1648
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 1648
*         XTNTVOLN(J)=1;                                           1649
         L     @15,@TF00002                                        1649
         STC   @14,XTNTVOLN-78(@15,XTNTPTR)                        1649
*         XTNTVOL(J)=XTNHVOL;                                      1650
*                                                                  1650
         LR    @01,XTNTPTR                                         1650
         AL    @01,@TF00002                                        1650
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  1650
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE XTNTTBL LOWER LIMIT: = USER LOWER LIMIT IF THE  */
*         /* REAL EXTENT BEGINS BEFORE THE USER REQUESTED EXTENT =   */
*         /* XTNTTBL2 LOWER LIMIT IF THE USER EXTENT BEGINS IN A     */
*         /* DIFFERENT REAL EXTENT                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1651
*         IF XTNHCHR1(1:4)>=XTN2CHR1(I)&XTNHCHR1(1:4)<=XTN2CHR2(I) THEN
         LR    @01,XTNTPTR2                                        1651
         AL    @01,@TF00001                                        1651
         AL    @01,@CF03047                                        1651
         CLC   XTNHCHR1(4,XTNTPTR),XTN2CHR1-44(@01)                1651
         BL    @RF01651                                            1651
         LR    @01,XTNTPTR2                                        1651
         AL    @01,@TF00001                                        1651
         AL    @01,@CF03049                                        1651
         CLC   XTNHCHR1(4,XTNTPTR),XTN2CHR2-48(@01)                1651
         BH    @RF01651                                            1651
*           XTNTCHR1(J)=XTNHCHR1;                                  1652
         LR    @01,XTNTPTR                                         1652
         AL    @01,@TF00002                                        1652
         MVC   XTNTCHR1-78(5,@01),XTNHCHR1(XTNTPTR)                1652
*         ELSE                                                     1653
*           DO;                                                    1653
         B     @RC01651                                            1653
@RF01651 DS    0H                                                  1654
*             XTNTCHR1(J,1:4)=XTN2CHR1(I);                         1654
         L     @15,@PC00001+8                                      1654
         SLR   @14,@14                                             1654
         IC    @14,J(,@15)                                         1654
         MH    @14,@CH02809                                        1654
         ST    @14,@TF00001                                        1654
         ALR   @14,XTNTPTR                                         1654
         SLR   @03,@03                                             1654
         IC    @03,I(,@15)                                         1654
         MH    @03,@CH00797                                        1654
         ALR   @03,XTNTPTR2                                        1654
         AL    @03,@CF03047                                        1654
         MVC   XTNTCHR1-78(4,@14),XTN2CHR1-44(@03)                 1654
*             XTNTCHR1(J,5:5)=0;                                   1655
         SLR   @15,@15                                             1655
         L     @14,@TF00001                                        1655
         STC   @15,XTNTCHR1-74(@14,XTNTPTR)                        1655
*           END;                                                   1656
*                                                                  1656
*         /***********************************************************/
*         /*                                                         */
*         /* SET END OF THIS EXTENT = USER UPPER LIMIT IF USER UPPER */
*         /* CCHH IS REALLY LESS THAN THE END OF THIS EXTENT =       */
*         /* XTNTTBL2 UPPER LIMIT CCHH IF USER UPPER LIMIT IS IN A   */
*         /* DIFFERENT EXTENT                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1657
*         IF XTNHCHR2(1:4)<=XTN2CHR2(I)&XTNHCHR2(1:4)>=XTN2CHR1(I) THEN
@RC01651 L     @15,@PC00001+8                                      1657
         SLR   @14,@14                                             1657
         IC    @14,I(,@15)                                         1657
         MH    @14,@CH00797                                        1657
         ST    @14,@TF00001                                        1657
         ALR   @14,XTNTPTR2                                        1657
         AL    @14,@CF03049                                        1657
         CLC   XTNHCHR2(4,XTNTPTR),XTN2CHR2-48(@14)                1657
         BH    @RF01657                                            1657
         LR    @01,XTNTPTR2                                        1657
         AL    @01,@TF00001                                        1657
         AL    @01,@CF03047                                        1657
         CLC   XTNHCHR2(4,XTNTPTR),XTN2CHR1-44(@01)                1657
         BL    @RF01657                                            1657
*           XTNTCHR2(J)=XTNHCHR2;                                  1658
         SLR   @14,@14                                             1658
         IC    @14,J(,@15)                                         1658
         MH    @14,@CH02809                                        1658
         ALR   @14,XTNTPTR                                         1658
         MVC   XTNTCHR2-78(5,@14),XTNHCHR2(XTNTPTR)                1658
*         ELSE                                                     1659
*           DO;                                                    1659
         B     @RC01657                                            1659
@RF01657 DS    0H                                                  1660
*             XTNTCHR2(J,1:4)=XTN2CHR2(I);                         1660
         L     @15,@PC00001+8                                      1660
         SLR   @14,@14                                             1660
         IC    @14,J(,@15)                                         1660
         MH    @14,@CH02809                                        1660
         ST    @14,@TF00001                                        1660
         ALR   @14,XTNTPTR                                         1660
         SLR   @03,@03                                             1660
         IC    @03,I(,@15)                                         1660
         MH    @03,@CH00797                                        1660
         ALR   @03,XTNTPTR2                                        1660
         AL    @03,@CF03049                                        1660
         MVC   XTNTCHR2-78(4,@14),XTN2CHR2-48(@03)                 1660
*             XTNTCHR2(J,5:5)='FF'X;                               1661
         LR    @01,XTNTPTR                                         1661
         AL    @01,@TF00001                                        1661
         MVI   XTNTCHR2-74(@01),X'FF'                              1661
*           END;                                                   1662
*         I=I+1;                                                   1663
@RC01657 L     @15,@PC00001+8                                      1663
         LA    @14,1                                               1663
         SLR   @03,@03                                             1663
         IC    @03,I(,@15)                                         1663
         ALR   @03,@14                                             1663
         STC   @03,I(,@15)                                         1663
*         J=J+1;                                                   1664
         SLR   @03,@03                                             1664
         IC    @03,J(,@15)                                         1664
         ALR   @14,@03                                             1664
         STC   @14,J(,@15)                                         1664
*       END;                                                       1665
*                                                                  1665
*     /***************************************************************/
*     /*                                                             */
*     /* IF NEITHER XTNTTBL2 LIMIT IS WITHIN THE USER'S RANGE, SKIP  */
*     /* THIS XTNTTBL2 ENTRY.                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1666
*     ELSE                                                         1666
*       I=I+1;                                                     1666
         B     @RC01644                                            1666
@RF01644 L     @15,@PC00001+8                                      1666
         LA    @14,1                                               1666
         SLR   @03,@03                                             1666
         IC    @03,I(,@15)                                         1666
         ALR   @14,@03                                             1666
         STC   @14,I(,@15)                                         1666
*   END BLDXTTBL;                                                  1667
*                                                                  1667
@RC01644 DS    0H                                                  1667
@DE01643 L     @15,@PC00001+8                                      1667
         SLR   @14,@14                                             1667
         IC    @14,I(,@15)                                         1667
         MH    @14,@CH00797                                        1667
         ALR   @14,XTNTPTR2                                        1667
         AL    @14,@CF03051                                        1667
         CLC   XTN2ENT(52,@14),LASTENT                             1667
         BNE   @DL01643                                            1667
*   /*****************************************************************/
*   /*                                                               */
*   /* SET LAST EXTENT ENTRY INDICATOR IN XTNTTBL                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1668
*   XTNTENT(J)=LASTENT;                                            1668
*                                                                  1668
         LA    @04,78                                              1668
         SLR   @01,@01                                             1668
         IC    @01,J(,@15)                                         1668
         MR    @00,@04                                             1668
         ALR   @01,XTNTPTR                                         1668
         MVC   XTNTENT-78(78,@01),LASTENT                          1668
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ENTRIES WERE MADE IN XTNTTBL, PREPARE TO RETURN TO THE  */
*   /* CALLER WITH RC = 12                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1669
*   I=1;                                                           1669
         LA    @14,1                                               1669
         STC   @14,I(,@15)                                         1669
*   IF XTNTENT(I)=LASTENT THEN                                     1670
         LR    @01,@14                                             1670
         MR    @00,@04                                             1670
         ALR   @01,XTNTPTR                                         1670
         CLC   XTNTENT-78(78,@01),LASTENT                          1670
         BNE   @RF01670                                            1670
*     DO;                                                          1671
*       IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN                 1672
*                                                                  1672
         L     @04,@PC00001+4                                      1672
         L     @01,FDTPTR+356(,@04)                                1672
         LTR   @01,@01                                             1672
         BZ    @RF01672                                            1672
         L     @04,@PC00002                                        1672
         CLI   IOPARM(@04),C'O'                                    1672
         BNE   @RF01672                                            1672
*         /***********************************************************/
*         /*                                                         */
*         /* WRITE ERROR MESSAGE IDC31223I                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1673
*         DO;                                                      1673
*           CKREQ=CKREQ&&CKREQ;                                    1674
         XC    CKREQ(44,@15),CKREQ(@15)                            1674
*           CKRERN=MSG23;                                          1675
         MVC   CKRERN(2,@15),@CH00666                              1675
*           CKRMVAR(1)=ADDR(XTNHVOL);                              1676
         LA    @04,XTNHVOL(,XTNTPTR)                               1676
         ST    @04,CKRMVAR(,@15)                                   1676
*           CKRMVAR(2)=ADDR(XTNHCHR2);                             1677
         LA    @04,XTNHCHR2(,XTNTPTR)                              1677
         ST    @04,CKRMVAR+4(,@15)                                 1677
*           CKRMVAR(3)=ADDR(OUTDSADD);                             1678
         LA    @04,@CC02839                                        1678
         ST    @04,CKRMVAR+8(,@15)                                 1678
*           CKRMVAR(4)=ADDR(XTNHDSN);                              1679
         LA    @04,XTNHDSN(,XTNTPTR)                               1679
         ST    @04,CKRMVAR+12(,@15)                                1679
*           CALL IDCRDER;                                          1680
         L     @15,@CV01553                                        1680
         BALR  @14,@15                                             1680
*         END;                                                     1681
*       ELSE                                                       1682
*         IF ADDR(MODIF)^=NULLPTR&IOPARM=INPUT THEN                1682
*                                                                  1682
         B     @RC01672                                            1682
@RF01672 L     @04,@PC00001+4                                      1682
         L     @04,FDTPTR+356(,@04)                                1682
         LTR   @04,@04                                             1682
         BZ    @RF01682                                            1682
         L     @04,@PC00002                                        1682
         CLI   IOPARM(@04),C'I'                                    1682
         BNE   @RF01682                                            1682
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31221I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1683
*           DO;                                                    1683
*             CKREQ=CKREQ&&CKREQ;                                  1684
         L     @04,@PC00001+8                                      1684
         XC    CKREQ(44,@04),CKREQ(@04)                            1684
*             CKRERN=MSG21;                                        1685
         MVC   CKRERN(2,@04),@CH00651                              1685
*             CKRMVAR(1)=ADDR(XTNHVOL);                            1686
         LA    @01,XTNHVOL(,XTNTPTR)                               1686
         ST    @01,CKRMVAR(,@04)                                   1686
*             CKRMVAR(2)=ADDR(XTNHCHR1);                           1687
         LA    @01,XTNHCHR1(,XTNTPTR)                              1687
         ST    @01,CKRMVAR+4(,@04)                                 1687
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1688
         LA    @01,XTNHDSN(,XTNTPTR)                               1688
         ST    @01,CKRMVAR+8(,@04)                                 1688
*             CALL IDCRDER;                                        1689
         L     @15,@CV01553                                        1689
         BALR  @14,@15                                             1689
*           END;                                                   1690
*         ELSE                                                     1691
*                                                                  1691
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE ERROR MESSAGE IDC31212I                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1691
*           DO;                                                    1691
         B     @RC01682                                            1691
@RF01682 DS    0H                                                  1692
*             CKREQ=CKREQ&&CKREQ;                                  1692
         L     @04,@PC00001+8                                      1692
         XC    CKREQ(44,@04),CKREQ(@04)                            1692
*             CKRERN=MSG12;                                        1693
         MVC   CKRERN(2,@04),@CH00039                              1693
*             CKRMVAR(1)=ADDR(XTNHCHR1);                           1694
         LA    @01,XTNHCHR1(,XTNTPTR)                              1694
         ST    @01,CKRMVAR(,@04)                                   1694
*             CKRMVAR(2)=ADDR(XTNHCHR2);                           1695
         LA    @01,XTNHCHR2(,XTNTPTR)                              1695
         ST    @01,CKRMVAR+4(,@04)                                 1695
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1696
         LA    @01,XTNHDSN(,XTNTPTR)                               1696
         ST    @01,CKRMVAR+8(,@04)                                 1696
*             CALL IDCRDER;                                        1697
         L     @15,@CV01553                                        1697
         BALR  @14,@15                                             1697
*           END;                                                   1698
*                                                                  1698
*       /*************************************************************/
*       /*                                                           */
*       /* FREE THE BUFFERS                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1699
*       CALL IDCSAFP0(GDTTBL,RD01,ALL);                            1699
*                                                                  1699
@RC01682 DS    0H                                                  1699
@RC01672 MVC   @AL00001+4(8),@AL01699                              1699
         L     @01,@PC00001                                        1699
         ST    @01,@AL00001                                        1699
         L     @15,GDTFPL(,@01)                                    1699
         LA    @01,@AL00001                                        1699
         BALR  @14,@15                                             1699
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1700
*       RETURN CODE(LASTCC12);                                     1700
         LA    @15,12                                              1700
         L     @14,@SA00002                                        1700
         LM    @00,@12,@SA00002+8                                  1700
         BR    @14                                                 1700
*     END;                                                         1701
*                                                                  1701
*   /*****************************************************************/
*   /*                                                               */
*   /* SORT THE XTNTTBL ENTRIES INTO ASCENDING SEQUENCE OF STARTING  */
*   /* ADDRESS. K = NUMBER OF ENTRIES IN TABLE.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1702
*   DO I=1 TO K;                                                   1702
@RF01670 LA    @04,1                                               1702
         B     @DE01702                                            1702
@DL01702 DS    0H                                                  1703
*     DO J=I TO K;                                                 1703
         L     @04,@PC00001+8                                      1703
         SLR   @01,@01                                             1703
         IC    @01,I(,@04)                                         1703
         B     @DE01703                                            1703
@DL01703 DS    0H                                                  1704
*       IF XTNTCHR1(I)>XTNTCHR1(J+1) THEN                          1704
         LA    @04,78                                              1704
         L     @01,@PC00001+8                                      1704
         SLR   @03,@03                                             1704
         IC    @03,I(,@01)                                         1704
         MR    @02,@04                                             1704
         LR    @15,@04                                             1704
         SLR   @04,@04                                             1704
         IC    @04,J(,@01)                                         1704
         MR    @14,@04                                             1704
         ST    @03,@TF00001                                        1704
         ALR   @03,XTNTPTR                                         1704
         ST    @15,@TF00002                                        1704
         ALR   @15,XTNTPTR                                         1704
         CLC   XTNTCHR1-78(5,@03),XTNTCHR1(@15)                    1704
         BNH   @RF01704                                            1704
*         DO;                                                      1705
*           XTNTHOLD=XTNTENT(I);                                   1706
         LR    @04,XTNTPTR                                         1706
         AL    @04,@TF00001                                        1706
         MVC   XTNTHOLD(78),XTNTENT-78(@04)                        1706
*           XTNTENT(I)=XTNTENT(J+1);                               1707
         LR    @04,XTNTPTR                                         1707
         AL    @04,@TF00001                                        1707
         LR    @01,XTNTPTR                                         1707
         AL    @01,@TF00002                                        1707
         MVC   @TS00001(78),XTNTENT(@01)                           1707
         MVC   XTNTENT-78(78,@04),@TS00001                         1707
*           XTNTENT(J+1)=XTNTHOLD;                                 1708
         LR    @04,XTNTPTR                                         1708
         AL    @04,@TF00002                                        1708
         MVC   XTNTENT(78,@04),XTNTHOLD                            1708
*         END;                                                     1709
*     END;                                                         1710
@RF01704 L     @04,@PC00001+8                                      1710
         LA    @01,1                                               1710
         SLR   @15,@15                                             1710
         IC    @15,J(,@04)                                         1710
         ALR   @01,@15                                             1710
@DE01703 L     @04,@PC00001+8                                      1710
         STC   @01,J(,@04)                                         1710
         L     @04,@PC00001+8                                      1710
         SLR   @15,@15                                             1710
         IC    @15,K(,@04)                                         1710
         CR    @01,@15                                             1710
         BNH   @DL01703                                            1710
*   END;                                                           1711
*                                                                  1711
         L     @01,@PC00001+8                                      1711
         LA    @04,1                                               1711
         SLR   @15,@15                                             1711
         IC    @15,I(,@01)                                         1711
         ALR   @04,@15                                             1711
@DE01702 L     @01,@PC00001+8                                      1711
         STC   @04,I(,@01)                                         1711
         L     @01,@PC00001+8                                      1711
         SLR   @15,@15                                             1711
         IC    @15,K(,@01)                                         1711
         CR    @04,@15                                             1711
         BNH   @DL01702                                            1711
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE EXTENT LIST FOR DUPLICATE ENTRIES THAT CAN EXIST IN */
*   /* KSDS DATA SETS K STILL EQUALS THE NUMBER OF EXTENT TABLE      */
*   /* ENTRIES                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1712
*   I=1;                                                           1712
         L     @04,@PC00001+8                                      1712
         MVI   I(@04),X'01'                                        1712
*   DO WHILE XTNTENT(I)^=LASTENT;                                  1713
         B     @DE01713                                            1713
@DL01713 DS    0H                                                  1714
*     IF XTNTENT(I)=XTNTENT(I+1) THEN                              1714
         L     @04,@PC00001+8                                      1714
         SLR   @01,@01                                             1714
         IC    @01,I(,@04)                                         1714
         LR    @04,@01                                             1714
         MH    @04,@CH02809                                        1714
         ST    @04,@TF00001                                        1714
         ALR   @04,XTNTPTR                                         1714
         LR    @15,XTNTPTR                                         1714
         AL    @15,@TF00001                                        1714
         CLC   XTNTENT-78(78,@04),XTNTENT(@15)                     1714
         BNE   @RF01714                                            1714
*       DO J=I TO K;                                               1715
         B     @DE01715                                            1715
@DL01715 DS    0H                                                  1716
*         XTNTENT(J)=XTNTENT(J+1);                                 1716
         L     @04,@PC00001+8                                      1716
         SLR   @01,@01                                             1716
         IC    @01,J(,@04)                                         1716
         MH    @01,@CH02809                                        1716
         ST    @01,@TF00001                                        1716
         ALR   @01,XTNTPTR                                         1716
         LR    @04,XTNTPTR                                         1716
         AL    @04,@TF00001                                        1716
         MVC   XTNTENT-78(78,@01),XTNTENT(@04)                     1716
*       END;                                                       1717
         L     @04,@PC00001+8                                      1717
         LA    @01,1                                               1717
         SLR   @00,@00                                             1717
         IC    @00,J(,@04)                                         1717
         ALR   @01,@00                                             1717
@DE01715 L     @04,@PC00001+8                                      1717
         STC   @01,J(,@04)                                         1717
         L     @04,@PC00001+8                                      1717
         SLR   @00,@00                                             1717
         IC    @00,K(,@04)                                         1717
         CR    @01,@00                                             1717
         BNH   @DL01715                                            1717
*     ELSE                                                         1718
*       I=I+1;                                                     1718
         B     @RC01714                                            1718
@RF01714 L     @04,@PC00001+8                                      1718
         LA    @15,1                                               1718
         SLR   @14,@14                                             1718
         IC    @14,I(,@04)                                         1718
         ALR   @15,@14                                             1718
         STC   @15,I(,@04)                                         1718
*   END;                                                           1719
*                                                                  1719
@RC01714 DS    0H                                                  1719
@DE01713 LA    @04,78                                              1719
         L     @15,@PC00001+8                                      1719
         SLR   @01,@01                                             1719
         IC    @01,I(,@15)                                         1719
         MR    @00,@04                                             1719
         ALR   @01,XTNTPTR                                         1719
         CLC   XTNTENT-78(78,@01),LASTENT                          1719
         BNE   @DL01713                                            1719
*   /*****************************************************************/
*   /*                                                               */
*   /* CONSTRUCT THE OPEN ARGUMENT LIST (EXOARG)                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1720
*   I=1;                                                           1720
         LA    @14,1                                               1720
         STC   @14,I(,@15)                                         1720
*   EXODDN=ADDR(XTNTDDN(I));                                       1721
         L     @03,REPEXOAR(,@15)                                  1721
         LR    @01,@14                                             1721
         MR    @00,@04                                             1721
         LA    @04,XTNTDDN-78(@01,XTNTPTR)                         1721
         ST    @04,EXODDN(,@03)                                    1721
*   EXODSN=ADDR(XTNTDSN(I));                                       1722
         LA    @04,XTNTDSN-78(@01,XTNTPTR)                         1722
         ST    @04,EXODSN(,@03)                                    1722
*   IF XTNHMODE=INPUT THEN                                         1723
         CLI   XTNHMODE(XTNTPTR),C'I'                              1723
         BNE   @RF01723                                            1723
*     EXOCTLBK=ADDR(REPIDSOP);                                     1724
         LA    @04,REPIDSOP(,@15)                                  1724
         ST    @04,EXOCTLBK(,@03)                                  1724
*   ELSE                                                           1725
*     EXOCTLBK=ADDR(REPODSOP);                                     1725
         B     @RC01723                                            1725
@RF01723 L     @04,@PC00001+8                                      1725
         L     @01,REPEXOAR(,@04)                                  1725
         LA    @04,REPODSOP(,@04)                                  1725
         ST    @04,EXOCTLBK(,@01)                                  1725
*   EXOREP=ON;                                                     1726
@RC01723 L     @04,@PC00001+8                                      1726
         L     @15,REPEXOAR(,@04)                                  1726
         OI    EXOREP(@15),B'00000100'                             1726
*   EXOEXT=ADDR(XTNTCHR1(I));                                      1727
*                                                                  1727
         SLR   @14,@14                                             1727
         IC    @14,I(,@04)                                         1727
         MH    @14,@CH02809                                        1727
         LA    @04,XTNTCHR1-78(@14,XTNTPTR)                        1727
         ST    @04,EXOEXT(,@15)                                    1727
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UEXCP OPENR TO OPEN THE FIRST EXTENT.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1728
*   CALL IDCIO050(GDTTBL,OPENR,EXOARG);                            1728
*                                                                  1728
         L     @14,@PC00001                                        1728
         ST    @14,@AL00001                                        1728
         LA    @05,@CC02024                                        1728
         ST    @05,@AL00001+4                                      1728
         ST    @15,@AL00001+8                                      1728
         MVI   @AL00001+8,X'80'                                    1728
         L     @15,GDTEXP(,@14)                                    1728
         LA    @01,@AL00001                                        1728
         BALR  @14,@15                                             1728
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN CODE FROM UEXCP                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1729
*   RESPECIFY                                                      1729
*     RTNREG RSTD;                                                 1729
*   TESTRC=RTNREG;                                                 1730
         STH   RTNREG,TESTRC                                       1730
*   RESPECIFY                                                      1731
*     RTNREG UNRSTD;                                               1731
*                                                                  1731
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = 12  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1732
*   IF TESTRC^=0 THEN                                              1732
         LH    @15,TESTRC                                          1732
         LTR   @15,@15                                             1732
         BZ    @RF01732                                            1732
*     DO;                                                          1733
*                                                                  1733
*       /*************************************************************/
*       /*                                                           */
*       /* FREE THE BUFFERS                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1734
*       CALL IDCSAFP0(GDTTBL,RD01,ALL);                            1734
*                                                                  1734
         MVC   @AL00001+4(8),@AL01734                              1734
         L     @15,@PC00001                                        1734
         ST    @15,@AL00001                                        1734
         L     @15,GDTFPL(,@15)                                    1734
         LA    @01,@AL00001                                        1734
         BALR  @14,@15                                             1734
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN TO THE CALLER WITH RC = 12                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1735
*       RETURN CODE(LASTCC12);                                     1735
         LA    @15,12                                              1735
         L     @14,@SA00002                                        1735
         LM    @00,@12,@SA00002+8                                  1735
         BR    @14                                                 1735
*     END;                                                         1736
*                                                                  1736
*   /*****************************************************************/
*   /*                                                               */
*   /* SET DUMP POINT                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1737
*   IF GDTDBG=NULLPTR THEN                                         1737
@RF01732 L     @15,@PC00001                                        1737
         L     @15,GDTDBG(,@15)                                    1737
         LTR   @15,@15                                             1737
         BZ    @RT01737                                            1737
*     ;                                                            1738
*   ELSE                                                           1739
*     CALL IDCDB010(GDTTBL,'RD6Q');                                1739
*                                                                  1739
         L     @15,@PC00001                                        1739
         ST    @15,@AL00001                                        1739
         LA    @14,@CC02935                                        1739
         ST    @14,@AL00001+4                                      1739
         MVI   @AL00001+4,X'80'                                    1739
         L     @15,GDTDBG(,@15)                                    1739
         LA    @01,@AL00001                                        1739
         BALR  @14,@15                                             1739
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL DATA SET PROCESSING COMPLETE RETURN TO THE CALLER WITH RC */
*   /* = 00                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1740
*   RETURN CODE(LASTCC00);                                         1740
@RT01737 SLR   @15,@15                                             1740
         L     @14,@SA00002                                        1740
         LM    @00,@12,@SA00002+8                                  1740
         BR    @14                                                 1740
*IDCRDIN:                                                          1741
*   PROCEDURE;                                                     1741
*                                                                  1741
IDCRDIN  STM   @14,@12,@SA00003                                    1741
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME -IDCRDIN                                          */
*/*                                                                  */
*/* FUNCTION - THIS SUBROUTINE IS CALLED TO OBTAIN THE NAME OF THE   */
*/*            DATA SET BEING OPENED BY ISSUING THE UIOINFO MACRO.   */
*/*            IF THE DATA SET NAME CANNOT BE LOCATED OR IF UIOINFO  */
*/*            FAILS, THE DATA SET NAME FIELD, XTNHDSN IN XTNTTBL,   */
*/*            IS SET TO BLANKS, ELSE XTNHDSN IS SET EQUAL TO THE    */
*/*            DATA SET NAME IN THE UIOINFO RETURN AREA.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1742
*                                                                  1742
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UIOINFO TO GET DATA SET NAME CONSTRUCT UIOINFO OPTION   */
*   /* BYTE                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1742
*   IOINFOPT=''B;                                                  1742
         LA    @04,INFOBYT                                         1742
         MVI   IOINFOPT(@04),X'00'                                 1742
*   IOINFDSN=ON;                                                   1743
*                                                                  1743
         OI    IOINFDSN(@04),B'00100000'                           1743
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UIOINFO                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1744
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,INFODD);                 1744
*                                                                  1744
         L     @15,@PC00001                                        1744
         ST    @15,@AL00001                                        1744
         ST    @04,@AL00001+4                                      1744
         LA    @04,INFOPTR                                         1744
         ST    @04,@AL00001+8                                      1744
         LA    @04,INFODD                                          1744
         ST    @04,@AL00001+12                                     1744
         MVI   @AL00001+12,X'80'                                   1744
         L     @15,GDTIFO(,@15)                                    1744
         LA    @01,@AL00001                                        1744
         BALR  @14,@15                                             1744
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN CODE FROM UIOINFO                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1745
*   RESPECIFY                                                      1745
*     RTNREG RSTD;                                                 1745
*   TESTRC=RTNREG;                                                 1746
         STH   RTNREG,TESTRC                                       1746
*   RESPECIFY                                                      1747
*     RTNREG UNRSTD;                                               1747
*                                                                  1747
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UIOINFO IS SUCCESSFUL, LOCATE DSNAME                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1748
*   IF TESTRC=0 THEN                                               1748
         LH    @04,TESTRC                                          1748
         LTR   @04,@04                                             1748
         BNZ   @RF01748                                            1748
*     DO;                                                          1749
*       INFDSNPT=INFOPTR+LENGTH(INFAREAL)+LENGTH(INFDATAL);        1750
         LA    INFDSNPT,4                                          1750
         AL    INFDSNPT,INFOPTR                                    1750
*       RESPECIFY                                                  1751
*         INFODSN BASED(INFDSNPT);                                 1751
*       IF INFDSNID=DSNIDENT THEN                                  1752
         CLC   INFDSNID(2,INFDSNPT),@CH00221                       1752
         BNE   @RF01752                                            1752
*         XTNHDSN=INFDSN;                                          1753
         MVC   XTNHDSN(44,XTNTPTR),INFDSN(INFDSNPT)                1753
*       ELSE                                                       1754
*         XTNHDSN=BLANKS;                                          1754
         B     @RC01752                                            1754
@RF01752 MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1754
*     END;                                                         1755
*                                                                  1755
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UIOINFO IS UNSUCCESSFUL, SET DSNAME EQUAL TO BLANKS        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1756
*   ELSE                                                           1756
*     XTNHDSN=BLANKS;                                              1756
         B     @RC01748                                            1756
@RF01748 MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1756
*   RETURN CODE(LASTCC00);                                         1757
@RC01748 SLR   @15,@15                                             1757
         L     @14,@SA00003                                        1757
         LM    @00,@12,@SA00003+8                                  1757
         BR    @14                                                 1757
*   END IDCRDIN;                                                   1758
*   END IDCRDDS;                                                   1759
*                                                                  1760
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - IDCRDRD                                        */
*/*                                                                  */
*/*  DESCRIPTIVE NAME - SREADREC                                     */
*/*                                                                  */
*/*  DESCRIPTION - SREADREC IS USED TO READ ALL POSSIBLE             */
*/*           RECORDS ON A TRACK, AND TO RETURN A                    */
*/*           POINTER TO THE REQUESTED RECORD WITH A                 */
*/*           RETURN CODE INDICATING A COMBINATION                   */
*/*           OF THE RESULTS OF READING THE COUNT FIELD              */
*/*           OF THE REQUESTED RECORD, AND THE KEY/DATA              */
*/*           FIELDS FOR THAT RECORD                                 */
*/*                                                                  */
*/*  INPUT - THE FOLLOWING FIELDS OF RDARG:                          */
*/*          RDCTLBL - I/O CNTL BLK POINTER                          */
*/*          RDIOAREA- READ BUFFER AREA PTR                          */
*/*          RDLOCPTR- LOCATION TABLE POINTER                        */
*/*          RDCC    - CYLINDER ADDR OR REQUESTED RECORD             */
*/*          RDHH    - TRACK    ADDR OR REQUESTED RECORD             */
*/*          RDRECNUM- REQUESTED RECORD NUMBER                       */
*/*          RDDS    - ZERO FOR DATA SET REQUEST                     */
*/*          RDRWPKLN- LENGTH PTR IF NECESSARY                       */
*/*                                                                  */
*/*  OUTPUT - THE FOLLOWING FIELD  OF RDARG:                         */
*/*           RDDARE - ADDR OF THE REQUESTED RECORD                  */
*/*                                                                  */
*/*         - ONE OF THE FOLLOWING RETURN CODES:                     */
*/*           NOTE THAT THE '*'ED RETURN CODES                       */
*/*            INDICATE AN ACTUAL ERROR NOT RELATED                  */
*/*            TO AN MSS STAGE OR DESTAGE ERROR-                     */
*/*           REPAIRV PROCESSING WILL TERMINATE FOR ALL              */
*/*            '*'ED RETURN CODES OVER 16                            */
*/*                                                                  */
*/*            CODE-INDICATION                                       */
*/*                                                                  */
*/*              01 GOOD COUNT,GOOD KEY/DATA                         */
*/*            * 02 GOOD COUNT,BAD KEY/DATA                          */
*/*              03 GOOD COUNT,DESTAGE ERROR ON KEY/DATA             */
*/*              04 GOOD COUNT,OVERFLOW,GOOD KEY/DATA                */
*/*              05 RESERVED                                         */
*/*              06 RESERVED                                         */
*/*            * 07 BAD COUNT,GOOD KEY/DATA                          */
*/*              08 DESTAGE ERROR ON COUNT,DESTAGE ERROR ON KEY/DATA */
*/*              09 STAGE ERROR ON COUNT,DESTAGE ERROR ON KEY/DATA   */
*/*              10 STAGE ERROR ON COUNT,STAGE ERROR ON KEY/DATA     */
*/*              11 RESERVED                                         */
*/*              12 RESERVED                                         */
*/*              13 RESERVED                                         */
*/*              14 RESERVED                                         */
*/*              15 RESERVED                                         */
*/*            * 16 GOOD COUNT,BAD KEY/DATA                          */
*/*              17 RESERVED                                         */
*/*            * 18 BAD COUNT                                        */
*/*            * 19 BAD COUNT,BAD KEY/DATA                           */
*/*            * 20 DESTAGE ERROR ON COUNT,BAD KEY/DATA              */
*/*            * 21 STAGE ERROR ON COUNT,BAD KEY/DATA                */
*/*            * 22 UNCORRECTABLE I/O ERROR PRIOR TO REQUESTED RECORD*/
*/*              23 RESERVED                                         */
*/*              24 RESERVED                                         */
*/*              25 RESERVED                                         */
*/*              26 RESERVED                                         */
*/*              27 RESERVED                                         */
*/*              28 RESERVED                                         */
*/*              29 END OF FILE                                      */
*/*              30 END OF TRACK                                     */
*/*            * 31 UNEXPECTED RESULTS                               */
*/*              32 SYNC BYTE MISSING-TRACK UNRECOVERABLE            */
*/*              33 NO RECORD FOUND                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1760
*IDCRDRD:                                                          1760
*   PROC(ARGLST);                                                  1760
*                                                                  1760
IDCRDRD  STM   @14,@12,@SA00004                                    1760
         MVC   @PC00004(4),0(@01)                                  1760
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*  THE FOLLOWING ARE THE RETURN CODES RETURNED BY                  */
*/*   SREADREC                                                       */
*/*                                                                  */
*/*   ALL OTHER COMBINATIONS ARE IMPOSSIBLE CONDITIONS               */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                  GOOD COUNT,GOOD KEY/DATA                        */
*/********************************************************************/
*                                                                  1761
*   DCL                                                            1761
*     RCSRGG FIXED(15) INIT(01);                                   1761
*                                                                  1761
*/********************************************************************/
*/*                  GOOD COUNT,BAD KEY/DATA,STAGING PACK            */
*/********************************************************************/
*                                                                  1762
*   DCL                                                            1762
*     RCSRGBSP FIXED(15) INIT(02);                                 1762
*                                                                  1762
*/********************************************************************/
*/*                  GOOD COUNT,DESTAGE ERROR KEY/DATA,DS            */
*/********************************************************************/
*                                                                  1763
*   DCL                                                            1763
*     RCSRGDS FIXED(15) INIT(03);                                  1763
*                                                                  1763
*/********************************************************************/
*/*                  GOOD COUNT,OVERFLOW,GOOD KEY/DATA               */
*/********************************************************************/
*                                                                  1764
*   DCL                                                            1764
*     RCSRGGOF FIXED(15) INIT(04);                                 1764
*                                                                  1764
*/********************************************************************/
*/*                  GOOD COUNT,STAGE ERROR   KEY/DATA               */
*/********************************************************************/
*                                                                  1765
*   DCL                                                            1765
*     RCSRGSTG FIXED(15) INIT(05);                                 1765
*                                                                  1765
*/********************************************************************/
*/*                  BAD COUNT,GOOD KEY/DATA,STG PACK                */
*/********************************************************************/
*                                                                  1766
*   DCL                                                            1766
*     RCSRBG FIXED(15) INIT(07);                                   1766
*                                                                  1766
*/********************************************************************/
*/*                  DESTAGE ERR COUNT,DESTAGE ERR K/D, DS           */
*/********************************************************************/
*                                                                  1767
*   DCL                                                            1767
*     RCSRDSDS FIXED(15) INIT(08);                                 1767
*                                                                  1767
*/********************************************************************/
*/*                  STAGE ERROR ON COUNT,DESTAGE ERR KEY/DATA       */
*/********************************************************************/
*                                                                  1768
*   DCL                                                            1768
*     RCSRSTDS FIXED(15) INIT(09);                                 1768
*                                                                  1768
*/********************************************************************/
*/*                  STAGE ERROR COUNT,STAGE ERR KEY/DATA,DS         */
*/********************************************************************/
*                                                                  1769
*   DCL                                                            1769
*     RCSRSTST FIXED(15) INIT(10);                                 1769
*                                                                  1769
*/********************************************************************/
*/*                  GOOD COUNT/BAD KEY/DATA,DS                      */
*/********************************************************************/
*                                                                  1770
*   DCL                                                            1770
*     RCSRGBDT FIXED(15) INIT(16);                                 1770
*                                                                  1770
*/********************************************************************/
*/*                  BAD COUNT,DATA SET                              */
*/********************************************************************/
*                                                                  1771
*   DCL                                                            1771
*     RCSRBCNT FIXED(15) INIT(18);                                 1771
*                                                                  1771
*/********************************************************************/
*/*                  BAD COUNT,BAD KEY/DATA,SP                       */
*/********************************************************************/
*                                                                  1772
*   DCL                                                            1772
*     RCSRBB FIXED(15) INIT(19);                                   1772
*                                                                  1772
*/********************************************************************/
*/*                  DESTAGE ERROR ON COUNT,BAD KEY/DATA,DS          */
*/********************************************************************/
*                                                                  1773
*   DCL                                                            1773
*     RCSRDSB FIXED(15) INIT(20);                                  1773
*                                                                  1773
*/********************************************************************/
*/*                  STAGE ERROR ON COUNT,BAD KEY/DATA,DS            */
*/********************************************************************/
*                                                                  1774
*   DCL                                                            1774
*     RCSRSTB FIXED(15) INIT(21);                                  1774
*                                                                  1774
*/********************************************************************/
*/*                  UNCORRECTABLE I/O ERROR PRIOR TO REQ REC        */
*/********************************************************************/
*                                                                  1775
*   DCL                                                            1775
*     RCSRUNCO FIXED(15) INIT(22);                                 1775
*                                                                  1775
*/********************************************************************/
*/*                  END OF FILE                                     */
*/********************************************************************/
*                                                                  1776
*   DCL                                                            1776
*     RCSREOF FIXED(15) INIT(29);                                  1776
*                                                                  1776
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF TRACK                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1777
*/********************************************************************/
*                                                                  1777
*   DCL                                                            1777
*     RCSREOTR FIXED(15) INIT(30);                                 1777
*                                                                  1777
*/********************************************************************/
*/*                  UNEXPECTED RESULTS                              */
*/********************************************************************/
*                                                                  1778
*   DCL                                                            1778
*     RCSRUEX FIXED(15) INIT(31);                                  1778
*                                                                  1778
*/********************************************************************/
*/*                  SYNC BYTE MISSING-TRACK UNRECOVERABLE           */
*/********************************************************************/
*                                                                  1779
*   DCL                                                            1779
*     RCSRSYNC FIXED(15) INIT(32);                                 1779
*                                                                  1779
*/********************************************************************/
*/*                  NO RECORD FOUND                                 */
*/********************************************************************/
*                                                                  1780
*   DCL                                                            1780
*     RCSRNRF FIXED(15) INIT(33);                                  1780
*                                                                  1780
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*      THE FOLLOWING ARE THE RETURN CODES SENT BACK                */
*/*        TO SREADREC FROM THE UEXCP FUNCTIONS                      */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                  DESTAGE ERROR                                   */
*/********************************************************************/
*                                                                  1781
*   DCL                                                            1781
*     RCABDS FIXED(15) INIT(08);                                   1781
*                                                                  1781
*/********************************************************************/
*/*                  STAGE ERROR                                     */
*/********************************************************************/
*                                                                  1782
*   DCL                                                            1782
*     RCABST FIXED(15) INIT(12);                                   1782
*                                                                  1782
*/********************************************************************/
*/*                  OVERFLOW RECORD, GOOD DATA                      */
*/********************************************************************/
*                                                                  1783
*   DCL                                                            1783
*     RCABOV FIXED(15) INIT(16);                                   1783
*                                                                  1783
*/********************************************************************/
*/*                  NO RECORD FOUND                                 */
*/********************************************************************/
*                                                                  1784
*   DCL                                                            1784
*     RCABNRF FIXED(15) INIT(20);                                  1784
*                                                                  1784
*/********************************************************************/
*/*                  SYNC BYTE MISSING                               */
*/********************************************************************/
*                                                                  1785
*   DCL                                                            1785
*     RCABSYNC FIXED(15) INIT(24);                                 1785
*                                                                  1785
*/********************************************************************/
*/*                  UNCORRECTABLE DATA CHECK                        */
*/********************************************************************/
*                                                                  1786
*   DCL                                                            1786
*     RCABDTCK FIXED(15) INIT(28);                                 1786
*                                                                  1786
*/********************************************************************/
*/*                  END OF FILE RECORD READ                         */
*/********************************************************************/
*                                                                  1787
*   DCL                                                            1787
*     RCABEOFR FIXED(15) INIT(32);                                 1787
*                                                                  1787
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*    THE FOLLOWING ARE MISCELLANEOUS CONSTANTS                     */
*/*      USED BY SREADREC                                            */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1788
*   DCL                                                            1788
*     FSTIME FIXED(8) INIT('FF'X);  /* FIRST TIME INDICATOR          */
*   DCL                                                            1789
*     NTFNDPTR CHAR(4) INIT('FFFFFFFF'X);/* NOT FIRST TIME IND       */
*   DCL                                                            1790
*     DSIND FIXED(8) INIT('00'X);   /* DATA SET INDICATOR            */
*   DCL                                                            1791
*     KEYPTR(110) BASED(RDKLEN);    /* BASE FOR KEY LENGTHS          */
*   DCL                                                            1792
*     KEYLENS FIXED(31) BASED(KEYPTR(LENINDEX));                   1792
*   DCL                                                            1793
*     DATPTR(110) BASED(RDDLEN);    /* BASE FOR KEY LENGTHS          */
*   DCL                                                            1794
*     DATALENS FIXED(31) BASED(DATPTR(LENINDEX));/* LIST OF DATA   1794
*                                      LENGTHS                       */
*   DCL                                                            1795
*     LENINDEX FIXED(15);           /* DO LOOP CONTROL               */
*   DCL                                                            1796
*     RDCTR FIXED(15);              /* DO LOOP CONTROL               */
*   DCL                                                            1797
*     READCNT CHAR(8) INIT('READCNT ');                            1797
*   DCL                                                            1798
*     READKD CHAR(8) INIT('READKD  ');                             1798
*   DCL                                                            1799
*     SPACCR CHAR(8) INIT('SPACCR  ');                             1799
*   DCL                                                            1800
*     LOCENT FIXED(15) INIT(DIM(LOCTAB));/* NUM ENTS IN LOCTAB       */
*   DCL                                                            1801
*     ARGLST CHAR(*);                                              1801
*                                                                  1802
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*      THE FOLLOWING IS THE CODE FOR SREADREC                      */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1802
*   GEN(ENTRY IDCRDRD);                                            1802
         ENTRY IDCRDRD
*   GEN(L REG6,SPLITSV1);                                          1803
         L REG6,SPLITSV1
*   LM(REG9,REG12,SPLITSAV);                                       1804
*                                                                  1804
         LM    REG9,REG12,SPLITSAV                                 1804
*/********************************************************************/
*/* OBTAIN ADDRESSABILITY TO INPUT CONTROL BLOCKS                    */
*/********************************************************************/
*                                                                  1805
*   RESPECIFY                                                      1805
*     RDARG BASED(ADDR(ARGLST));                                   1805
*   RESPECIFY                                                      1806
*     RIOAREA BASED(RDIOAREA);                                     1806
*   RESPECIFY                                                      1807
*     LOCTAB BASED(RDLOCPTR);                                      1807
*                                                                  1807
*/********************************************************************/
*/* SET UP FULL REGION DUMP POINT                                    */
*/********************************************************************/
*                                                                  1808
*   IF GDTDBG=NULLPTR THEN                                         1808
         L     @15,@PC00001                                        1808
         L     @15,GDTDBG(,@15)                                    1808
         LTR   @15,@15                                             1808
         BZ    @RT01808                                            1808
*     ;                                                            1809
*   ELSE                                                           1810
*     CALL IDCDB010(GDTTBL,'RDDD');                                1810
*                                                                  1810
         L     @15,@PC00001                                        1810
         ST    @15,@AL00001                                        1810
         LA    @14,@CC02992                                        1810
         ST    @14,@AL00001+4                                      1810
         MVI   @AL00001+4,X'80'                                    1810
         L     @15,GDTDBG(,@15)                                    1810
         LA    @01,@AL00001                                        1810
         BALR  @14,@15                                             1810
*/********************************************************************/
*/* SET TRACE ID                                                     */
*/********************************************************************/
*                                                                  1811
*   OLDERID2=NEWERID2;                                             1811
@RT01808 L     @15,@PC00001                                        1811
         L     @15,GDTTR2(,@15)                                    1811
         MVC   @TS00001(95),NEWERID2(@15)                          1811
         MVC   OLDERID2(95,@15),@TS00001                           1811
*   NEWID2='RDD1';                                                 1812
*                                                                  1812
         MVC   NEWID2(4,@15),@CC02993                              1812
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF CALL IS FOR SAME TRACK                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1813
*   IF RPREVCC^=RDCCRPREVHH^=RDHHRFIRST=FSTIME                   1813
*                                                                  1813
*   /*****************************************************************/
*   /*                                                               */
*   /* NEW TRACK REQUESTED                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1813
*     THEN                                                         1813
         L     @15,@PC00004                                        1813
         L     @14,RDIOAREA(,@15)                                  1813
         LH    @05,RDCC(,@15)                                      1813
         N     @05,@CF03043                                        1813
         CH    @05,RPREVCC(,@14)                                   1813
         BNE   @RT01813                                            1813
         LH    @15,RDHH(,@15)                                      1813
         N     @15,@CF03043                                        1813
         CH    @15,RPREVHH(,@14)                                   1813
         BNE   @RT01813                                            1813
         CLC   RFIRST(1,@14),FSTIME                                1813
         BNE   @RF01813                                            1813
@RT01813 DS    0H                                                  1814
*     DO;                                                          1814
*                                                                  1814
*       /*************************************************************/
*       /*                                                           */
*       /* READ THE NEW TRACK                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1815
*       CALL SRDRCRD;                                              1815
         BAL   @14,SRDRCRD                                         1815
*       RESPECIFY                                                  1816
*         RTNREG RSTD;                                             1816
*       TESTRC=RTNREG;                                             1817
         STH   RTNREG,TESTRC                                       1817
*       RESPECIFY                                                  1818
*         RTNREG UNRSTD;                                           1818
*     END;                                                         1819
*   ELSE                                                           1820
*                                                                  1820
*     /***************************************************************/
*     /*                                                             */
*     /* ENSURE RETURN CODE IS OK                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1820
*     TESTRC=0;                                                    1820
*                                                                  1820
         B     @RC01813                                            1820
@RF01813 SLR   @15,@15                                             1820
         STH   @15,TESTRC                                          1820
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUESTED RECORD NUMBER IS GREATER THAN THE SIZE OF THE    */
*   /* LOCATION TABLE THEN IT OBVIOUSLY IS NOT THERE                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1821
*   IF RDRECNUM+1>LOCENT THEN                                      1821
@RC01813 L     @15,@PC00004                                        1821
         LA    @14,1                                               1821
         SLR   @05,@05                                             1821
         IC    @05,RDRECNUM(,@15)                                  1821
         ALR   @14,@05                                             1821
         CH    @14,LOCENT                                          1821
         BNH   @RF01821                                            1821
*     RETURN CODE(RCSREOTR);                                       1822
*                                                                  1822
         LH    @15,RCSREOTR                                        1822
         L     @14,@SA00004                                        1822
         LM    @00,@12,@SA00004+8                                  1822
         BR    @14                                                 1822
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF RETURN CODE IS ACCEPTABLE UNEXPECTED RESULTS  */
*   /* IS NOT ACCEPTABLE                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1823
*   IF TESTRC^=RCSRUEX THEN                                        1823
@RF01821 LH    @15,RCSRUEX                                         1823
         CH    @15,TESTRC                                          1823
         BE    @RF01823                                            1823
*     DO;                                                          1824
*                                                                  1824
*       /*************************************************************/
*       /*                                                           */
*       /* CONTINUE SET TESTRC TO UNEXPECTED RESULTS IN CASE NONE OF */
*       /* THE CONDITIONS WERE TESTING FOR EXIST                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1825
*       TESTRC=RCSRUEX;                                            1825
*                                                                  1825
         STH   @15,TESTRC                                          1825
*       /*************************************************************/
*       /*                                                           */
*       /* GET ADDRESS OF DATA FOR REQUESTED RECORD                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1826
*       RDDARE=LOCADDR(RDRECNUM+1);                                1826
*                                                                  1826
         L     @14,@PC00004                                        1826
         SLR   @05,@05                                             1826
         IC    @05,RDRECNUM(,@14)                                  1826
         MH    @05,@CH00647                                        1826
         L     @04,RDLOCPTR(,@14)                                  1826
         L     @03,LOCADDR(@05,@04)                                1826
         ST    @03,RDDARE(,@14)                                    1826
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE RETURN CODE TO SEND BACK IT IS A COMBINATION OF */
*       /* THE READ COUNT RETURN CODE AND THE READ KEY/DATA RETURN   */
*       /* CODE OF THE RECORD SET TRACE ID                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1827
*       OLDERID2=NEWERID2;                                         1827
         L     @14,@PC00001                                        1827
         L     @14,GDTTR2(,@14)                                    1827
         MVC   @TS00001(95),NEWERID2(@14)                          1827
         MVC   OLDERID2(95,@14),@TS00001                           1827
*       NEWID2='RDDR';                                             1828
*                                                                  1828
         MVC   NEWID2(4,@14),@CC02995                              1828
*       /*************************************************************/
*       /*                                                           */
*       /* IF EITHER RETURN CODE WAS UNEXPECTED RESULTS THEN RETURN  */
*       /* WITH UNEXPECTED RESULTS                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1829
*       IF LOCRCNT(RDRECNUM+1)=RCSRUEXLOCRCKD(RDRECNUM+1)=RCSRUEX THEN
         CH    @15,LOCRCNT(@05,@04)                                1829
         BE    @RT01829                                            1829
         CH    @15,LOCRCKD(@05,@04)                                1829
         BNE   @RF01829                                            1829
@RT01829 DS    0H                                                  1830
*         TESTRC=RCSRUEX;                                          1830
*                                                                  1830
         LH    @15,RCSRUEX                                         1830
         STH   @15,TESTRC                                          1830
*       /*************************************************************/
*       /*                                                           */
*       /* IF EITHER RETURN CODE WAS SYNC BYTE MISSING THEN RETURN   */
*       /* WITH RC INDICATING SYNC BYTE MISSING                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1831
*       IF LOCRCNT(RDRECNUM+1)=RCABSYNCLOCRCKD(RDRECNUM+1)=RCABSYNC
*         THEN                                                     1831
@RF01829 LH    @15,RCABSYNC                                        1831
         L     @14,@PC00004                                        1831
         SLR   @05,@05                                             1831
         IC    @05,RDRECNUM(,@14)                                  1831
         MH    @05,@CH00647                                        1831
         L     @14,RDLOCPTR(,@14)                                  1831
         CH    @15,LOCRCNT(@05,@14)                                1831
         BE    @RT01831                                            1831
         CH    @15,LOCRCKD(@05,@14)                                1831
         BNE   @RF01831                                            1831
@RT01831 DS    0H                                                  1832
*         TESTRC=RCSRSYNC;                                         1832
*                                                                  1832
         LH    @15,RCSRSYNC                                        1832
         STH   @15,TESTRC                                          1832
*       /*************************************************************/
*       /*                                                           */
*       /* IF EITHER RETURN CODE WAS UNCORRECTABLE I/O ERROR THEN    */
*       /* RETURN WITH UNCORRECTABLE I/O ERROR                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1833
*       IF LOCRCNT(RDRECNUM+1)=RCSRUNCOLOCRCKD(RDRECNUM+1)=RCSRUNCO
*         THEN                                                     1833
@RF01831 LH    @15,RCSRUNCO                                        1833
         L     @14,@PC00004                                        1833
         SLR   @05,@05                                             1833
         IC    @05,RDRECNUM(,@14)                                  1833
         MH    @05,@CH00647                                        1833
         L     @14,RDLOCPTR(,@14)                                  1833
         CH    @15,LOCRCNT(@05,@14)                                1833
         BE    @RT01833                                            1833
         CH    @15,LOCRCKD(@05,@14)                                1833
         BNE   @RF01833                                            1833
@RT01833 DS    0H                                                  1834
*         TESTRC=RCSRUNCO;                                         1834
*                                                                  1834
         LH    @15,RCSRUNCO                                        1834
         STH   @15,TESTRC                                          1834
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE IS RECORD NOT FOUND THEN RETURN WITH */
*       /* RECORD NOT FOUND                                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1835
*       IF LOCRCNT(RDRECNUM+1)=RCABNRF THEN                        1835
@RF01833 L     @15,@PC00004                                        1835
         SLR   @14,@14                                             1835
         IC    @14,RDRECNUM(,@15)                                  1835
         MH    @14,@CH00647                                        1835
         L     @01,RDLOCPTR(,@15)                                  1835
         LH    @15,LOCRCNT(@14,@01)                                1835
         CH    @15,RCABNRF                                         1835
         BNE   @RF01835                                            1835
*         TESTRC=RCSRNRF;                                          1836
*                                                                  1836
         LH    @15,RCSRNRF                                         1836
         STH   @15,TESTRC                                          1836
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS END OF TRACK THEN RETURN WITH END*/
*       /* OF TRACK                                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1837
*       IF LOCRCNT(RDRECNUM+1)=RCSREOTR THEN                       1837
@RF01835 LH    @15,RCSREOTR                                        1837
         L     @14,@PC00004                                        1837
         SLR   @05,@05                                             1837
         IC    @05,RDRECNUM(,@14)                                  1837
         MH    @05,@CH00647                                        1837
         L     @01,RDLOCPTR(,@14)                                  1837
         CH    @15,LOCRCNT(@05,@01)                                1837
         BNE   @RF01837                                            1837
*         TESTRC=RCSREOTR;                                         1838
*                                                                  1838
         STH   @15,TESTRC                                          1838
*       /*************************************************************/
*       /*                                                           */
*       /* IF KEY/D RETURN CODE WAS END OF FILE READ THEN RETURN WITH*/
*       /* END OF FILE INDICATION                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1839
*       IF LOCRCKD(RDRECNUM+1)=RCABEOFR THEN                       1839
@RF01837 L     @15,@PC00004                                        1839
         SLR   @14,@14                                             1839
         IC    @14,RDRECNUM(,@15)                                  1839
         MH    @14,@CH00647                                        1839
         L     @01,RDLOCPTR(,@15)                                  1839
         LH    @15,LOCRCKD(@14,@01)                                1839
         CH    @15,RCABEOFR                                        1839
         BNE   @RF01839                                            1839
*         TESTRC=RCSREOF;                                          1840
*                                                                  1840
         LH    @15,RCSREOF                                         1840
         STH   @15,TESTRC                                          1840
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS OK AND KEY/DATA RETURN CODE WAS  */
*       /* OK THEN RETURN PROPER CODE                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1841
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=0 THEN        1841
@RF01839 SLR   @15,@15                                             1841
         L     @14,@PC00004                                        1841
         SLR   @05,@05                                             1841
         IC    @05,RDRECNUM(,@14)                                  1841
         MH    @05,@CH00647                                        1841
         L     @14,RDLOCPTR(,@14)                                  1841
         CH    @15,LOCRCNT(@05,@14)                                1841
         BNE   @RF01841                                            1841
         CH    @15,LOCRCKD(@05,@14)                                1841
         BNE   @RF01841                                            1841
*         TESTRC=RCSRGG;                                           1842
*                                                                  1842
         LH    @15,RCSRGG                                          1842
         STH   @15,TESTRC                                          1842
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/
*       /* BAD KEY/DATA AND REQUEST WAS FOR A STAGING PACK THEN      */
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1843
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS^=
*           DSIND THEN                                             1843
@RF01841 L     @15,@PC00004                                        1843
         SLR   @14,@14                                             1843
         IC    @14,RDRECNUM(,@15)                                  1843
         MH    @14,@CH00647                                        1843
         L     @05,RDLOCPTR(,@15)                                  1843
         LH    @04,LOCRCNT(@14,@05)                                1843
         LTR   @04,@04                                             1843
         BNZ   @RF01843                                            1843
         LH    @14,LOCRCKD(@14,@05)                                1843
         CH    @14,RCABDTCK                                        1843
         BNE   @RF01843                                            1843
         CLC   RDDS(1,@15),DSIND                                   1843
         BE    @RF01843                                            1843
*         TESTRC=RCSRGBSP;                                         1844
*                                                                  1844
         LH    @15,RCSRGBSP                                        1844
         STH   @15,TESTRC                                          1844
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/
*       /* DESTAGE ERROR AND REQUEST WAS FOR A DATA SET THEN RETURN  */
*       /* PROPER CODE                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1845
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABDS&RDDS=DSIND
*         THEN                                                     1845
@RF01843 L     @15,@PC00004                                        1845
         SLR   @14,@14                                             1845
         IC    @14,RDRECNUM(,@15)                                  1845
         MH    @14,@CH00647                                        1845
         L     @05,RDLOCPTR(,@15)                                  1845
         LH    @04,LOCRCNT(@14,@05)                                1845
         LTR   @04,@04                                             1845
         BNZ   @RF01845                                            1845
         LH    @14,LOCRCKD(@14,@05)                                1845
         CH    @14,RCABDS                                          1845
         BNE   @RF01845                                            1845
         CLC   RDDS(1,@15),DSIND                                   1845
         BNE   @RF01845                                            1845
*         TESTRC=RCSRGDS;                                          1846
*                                                                  1846
         LH    @15,RCSRGDS                                         1846
         STH   @15,TESTRC                                          1846
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE    */
*       /* GOOD WITH OVERFLOW THEN RETURN PROPER CODE                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1847
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABOV THEN   1847
@RF01845 L     @15,@PC00004                                        1847
         SLR   @14,@14                                             1847
         IC    @14,RDRECNUM(,@15)                                  1847
         MH    @14,@CH00647                                        1847
         L     @15,RDLOCPTR(,@15)                                  1847
         LH    @05,LOCRCNT(@14,@15)                                1847
         LTR   @05,@05                                             1847
         BNZ   @RF01847                                            1847
         LH    @15,LOCRCKD(@14,@15)                                1847
         CH    @15,RCABOV                                          1847
         BNE   @RF01847                                            1847
*         TESTRC=RCSRGGOF;                                         1848
*                                                                  1848
         LH    @15,RCSRGGOF                                        1848
         STH   @15,TESTRC                                          1848
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS BAD AND KEY/DATA RETURN CODE WAS */
*       /* GOOD AND REQUEST WAS FOR A STAGING PACK THEN RETURN PROPER*/
*       /* CODE                                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1849
*       IF LOCRCNT(RDRECNUM+1)=RCABDTCK&LOCRCKD(RDRECNUM+1)=0&RDDS^=
*           DSIND THEN                                             1849
@RF01847 L     @15,@PC00004                                        1849
         SLR   @14,@14                                             1849
         IC    @14,RDRECNUM(,@15)                                  1849
         MH    @14,@CH00647                                        1849
         L     @05,RDLOCPTR(,@15)                                  1849
         LH    @04,LOCRCNT(@14,@05)                                1849
         CH    @04,RCABDTCK                                        1849
         BNE   @RF01849                                            1849
         LH    @04,LOCRCKD(@14,@05)                                1849
         LTR   @04,@04                                             1849
         BNZ   @RF01849                                            1849
         CLC   RDDS(1,@15),DSIND                                   1849
         BE    @RF01849                                            1849
*         DO;                                                      1850
*                                                                  1850
*           /*********************************************************/
*           /*                                                       */
*           /* SET RETURN CODE AND KEY/DATA LENGTHS USED             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1851
*           TESTRC=RCSRBG;                                         1851
         LH    @04,RCSRBG                                          1851
         STH   @04,TESTRC                                          1851
*           RDSPKL=LOCKLEN(RDRECNUM+1);                            1852
         SLR   @04,@04                                             1852
         IC    @04,LOCKLEN(@14,@05)                                1852
         STC   @04,RDSPKL(,@15)                                    1852
*           RDSPDL=LOCDLEN(RDRECNUM+1);                            1853
         LH    @14,LOCDLEN(@14,@05)                                1853
         STH   @14,RDSPDL(,@15)                                    1853
*         END;                                                     1854
*                                                                  1854
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS DESTAGE ERROR AND KEY/DATA RETURN*/
*       /* CODE WAS DESTAGE ERROR AND REQUEST WAS FOR A DATA SET THEN*/
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1855
*       IF LOCRCNT(RDRECNUM+1)=RCABDS&LOCRCKD(RDRECNUM+1)=RCABDS&RDDS=
*           DSIND THEN                                             1855
@RF01849 LH    @15,RCABDS                                          1855
         L     @14,@PC00004                                        1855
         SLR   @05,@05                                             1855
         IC    @05,RDRECNUM(,@14)                                  1855
         MH    @05,@CH00647                                        1855
         L     @04,RDLOCPTR(,@14)                                  1855
         CH    @15,LOCRCNT(@05,@04)                                1855
         BNE   @RF01855                                            1855
         CH    @15,LOCRCKD(@05,@04)                                1855
         BNE   @RF01855                                            1855
         CLC   RDDS(1,@14),DSIND                                   1855
         BNE   @RF01855                                            1855
*         TESTRC=RCSRDSDS;                                         1856
*                                                                  1856
         LH    @15,RCSRDSDS                                        1856
         STH   @15,TESTRC                                          1856
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE STAGE ERROR AND KEY/DATA RETURN CODE */
*       /* WAS DESTAGE ERROR AND REQUEST WAS FOR A DATA SET THEN     */
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1857
*       IF LOCRCNT(RDRECNUM+1)=RCABST&LOCRCKD(RDRECNUM+1)=RCABDS&RDDS=
*           DSIND THEN                                             1857
@RF01855 L     @15,@PC00004                                        1857
         SLR   @14,@14                                             1857
         IC    @14,RDRECNUM(,@15)                                  1857
         MH    @14,@CH00647                                        1857
         L     @05,RDLOCPTR(,@15)                                  1857
         LH    @04,LOCRCNT(@14,@05)                                1857
         CH    @04,RCABST                                          1857
         BNE   @RF01857                                            1857
         LH    @14,LOCRCKD(@14,@05)                                1857
         CH    @14,RCABDS                                          1857
         BNE   @RF01857                                            1857
         CLC   RDDS(1,@15),DSIND                                   1857
         BNE   @RF01857                                            1857
*         TESTRC=RCSRSTDS;                                         1858
*                                                                  1858
         LH    @15,RCSRSTDS                                        1858
         STH   @15,TESTRC                                          1858
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS STAGE ERROR AND KEY/DATA RETURN  */
*       /* CODE WAS STAGE ERROR AND REQUEST WAS FOR A DATA SET THEN  */
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1859
*       IF LOCRCNT(RDRECNUM+1)=RCABST&LOCRCKD(RDRECNUM+1)=RCABST&RDDS=
*           DSIND THEN                                             1859
@RF01857 LH    @15,RCABST                                          1859
         L     @14,@PC00004                                        1859
         SLR   @05,@05                                             1859
         IC    @05,RDRECNUM(,@14)                                  1859
         MH    @05,@CH00647                                        1859
         L     @04,RDLOCPTR(,@14)                                  1859
         CH    @15,LOCRCNT(@05,@04)                                1859
         BNE   @RF01859                                            1859
         CH    @15,LOCRCKD(@05,@04)                                1859
         BNE   @RF01859                                            1859
         CLC   RDDS(1,@14),DSIND                                   1859
         BNE   @RF01859                                            1859
*         TESTRC=RCSRSTST;                                         1860
*                                                                  1860
         LH    @15,RCSRSTST                                        1860
         STH   @15,TESTRC                                          1860
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/
*       /* STAGE ERROR AND REQUEST WAS FOR A DATA SET THEN RETURN    */
*       /* PROPER CODE                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1861
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABST&RDDS=DSIND
*         THEN                                                     1861
@RF01859 L     @15,@PC00004                                        1861
         SLR   @14,@14                                             1861
         IC    @14,RDRECNUM(,@15)                                  1861
         MH    @14,@CH00647                                        1861
         L     @05,RDLOCPTR(,@15)                                  1861
         LH    @04,LOCRCNT(@14,@05)                                1861
         LTR   @04,@04                                             1861
         BNZ   @RF01861                                            1861
         LH    @14,LOCRCKD(@14,@05)                                1861
         CH    @14,RCABST                                          1861
         BNE   @RF01861                                            1861
         CLC   RDDS(1,@15),DSIND                                   1861
         BNE   @RF01861                                            1861
*         TESTRC=RCSRGSTG;                                         1862
*                                                                  1862
         LH    @15,RCSRGSTG                                        1862
         STH   @15,TESTRC                                          1862
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/
*       /* BAD KEY/DATA AND REQUEST WAS FOR A DATA SET THEN RETURN   */
*       /* PROPER CODE                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1863
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS=
*           DSIND THEN                                             1863
@RF01861 L     @15,@PC00004                                        1863
         SLR   @14,@14                                             1863
         IC    @14,RDRECNUM(,@15)                                  1863
         MH    @14,@CH00647                                        1863
         L     @05,RDLOCPTR(,@15)                                  1863
         LH    @04,LOCRCNT(@14,@05)                                1863
         LTR   @04,@04                                             1863
         BNZ   @RF01863                                            1863
         LH    @14,LOCRCKD(@14,@05)                                1863
         CH    @14,RCABDTCK                                        1863
         BNE   @RF01863                                            1863
         CLC   RDDS(1,@15),DSIND                                   1863
         BNE   @RF01863                                            1863
*         TESTRC=RCSRGBDT;                                         1864
*                                                                  1864
         LH    @15,RCSRGBDT                                        1864
         STH   @15,TESTRC                                          1864
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS BAD AND REQUEST WAS FOR A DATA   */
*       /* SET THEN RETURN PROPER CODE                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1865
*       IF LOCRCNT(RDRECNUM+1)=RCABDTCK&RDDS=DSIND THEN            1865
@RF01863 L     @15,@PC00004                                        1865
         SLR   @14,@14                                             1865
         IC    @14,RDRECNUM(,@15)                                  1865
         MH    @14,@CH00647                                        1865
         L     @01,RDLOCPTR(,@15)                                  1865
         LH    @14,LOCRCNT(@14,@01)                                1865
         CH    @14,RCABDTCK                                        1865
         BNE   @RF01865                                            1865
         CLC   RDDS(1,@15),DSIND                                   1865
         BNE   @RF01865                                            1865
*         TESTRC=RCSRBCNT;                                         1866
*                                                                  1866
         LH    @15,RCSRBCNT                                        1866
         STH   @15,TESTRC                                          1866
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS BAD AND KEY/DATA RETURN CODE WAS */
*       /* BAD KEY/DATA AND REQUEST WAS FOR A STAGING PACK THEN      */
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1867
*       IF LOCRCNT(RDRECNUM+1)=RCABDTCK&LOCRCKD(RDRECNUM+1)=RCABDTCK&
*           RDDS^=DSIND THEN                                       1867
@RF01865 LH    @15,RCABDTCK                                        1867
         L     @14,@PC00004                                        1867
         SLR   @05,@05                                             1867
         IC    @05,RDRECNUM(,@14)                                  1867
         MH    @05,@CH00647                                        1867
         L     @04,RDLOCPTR(,@14)                                  1867
         CH    @15,LOCRCNT(@05,@04)                                1867
         BNE   @RF01867                                            1867
         CH    @15,LOCRCKD(@05,@04)                                1867
         BNE   @RF01867                                            1867
         CLC   RDDS(1,@14),DSIND                                   1867
         BE    @RF01867                                            1867
*         DO;                                                      1868
*                                                                  1868
*           /*********************************************************/
*           /*                                                       */
*           /* SET RETURN CODE AND KEY/DATA LENGTHS USED             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1869
*           TESTRC=RCSRBB;                                         1869
         LH    @15,RCSRBB                                          1869
         STH   @15,TESTRC                                          1869
*           RDSPKL=LOCKLEN(RDRECNUM+1);                            1870
         SLR   @15,@15                                             1870
         IC    @15,LOCKLEN(@05,@04)                                1870
         STC   @15,RDSPKL(,@14)                                    1870
*           RDSPDL=LOCDLEN(RDRECNUM+1);                            1871
         LH    @15,LOCDLEN(@05,@04)                                1871
         STH   @15,RDSPDL(,@14)                                    1871
*         END;                                                     1872
*                                                                  1872
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS DESTAGE ERROR AND KEY/DATA RETURN*/
*       /* CODE WAS BAD KEY/DATA AND REQUEST WAS FOR A DATA SET THEN */
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1873
*       IF LOCRCNT(RDRECNUM+1)=RCABDS&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS
*           =DSIND THEN                                            1873
@RF01867 L     @15,@PC00004                                        1873
         SLR   @14,@14                                             1873
         IC    @14,RDRECNUM(,@15)                                  1873
         MH    @14,@CH00647                                        1873
         L     @05,RDLOCPTR(,@15)                                  1873
         LH    @04,LOCRCNT(@14,@05)                                1873
         CH    @04,RCABDS                                          1873
         BNE   @RF01873                                            1873
         LH    @14,LOCRCKD(@14,@05)                                1873
         CH    @14,RCABDTCK                                        1873
         BNE   @RF01873                                            1873
         CLC   RDDS(1,@15),DSIND                                   1873
         BNE   @RF01873                                            1873
*         TESTRC=RCSRDSB;                                          1874
*                                                                  1874
         LH    @15,RCSRDSB                                         1874
         STH   @15,TESTRC                                          1874
*       /*************************************************************/
*       /*                                                           */
*       /* IF COUNT RETURN CODE WAS STAGE ERROR AND KEY/DATA RETURN  */
*       /* CODE WAS BAD KEY/DATA AND REQUEST WAS FOR A DATA SET THEN */
*       /* RETURN PROPER CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1875
*       IF LOCRCNT(RDRECNUM+1)=RCABST&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS
*           =DSIND THEN                                            1875
@RF01873 L     @15,@PC00004                                        1875
         SLR   @14,@14                                             1875
         IC    @14,RDRECNUM(,@15)                                  1875
         MH    @14,@CH00647                                        1875
         L     @05,RDLOCPTR(,@15)                                  1875
         LH    @04,LOCRCNT(@14,@05)                                1875
         CH    @04,RCABST                                          1875
         BNE   @RF01875                                            1875
         LH    @14,LOCRCKD(@14,@05)                                1875
         CH    @14,RCABDTCK                                        1875
         BNE   @RF01875                                            1875
         CLC   RDDS(1,@15),DSIND                                   1875
         BNE   @RF01875                                            1875
*         TESTRC=RCSRSTB;                                          1876
         LH    @15,RCSRSTB                                         1876
         STH   @15,TESTRC                                          1876
*     END;                          /* NOT UNEXPECTED RC             */
@RF01875 DS    0H                                                  1878
*   RETURN CODE(TESTRC);                                           1878
@RF01823 LH    @15,TESTRC                                          1878
         L     @14,@SA00004                                        1878
         LM    @00,@12,@SA00004+8                                  1878
         BR    @14                                                 1878
*                                                                  1879
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME - SRDRCRD                                        */
*/*                                                                  */
*/*  DESCRIPTION - SRDRCRD WILL READ IN THE RECORDS                  */
*/*     ON THE REQUESTED TRACK AND SET THE LOCATION                  */
*/*     TABLE ENTRIES FOR THAT TRACK                                 */
*/*                                                                  */
*/*   IT USES THE UEXCP READCNT FUNCTION,                            */
*/*           THE UEXCP READKD FUNCTION,                             */
*/*           AND THE UEXCP SPACCR FUNCTION                          */
*/*                                                                  */
*/*  INPUT - RDARG                                                   */
*/*                                                                  */
*/*   OUTPUT - THE LOCATION TABLE FOR THE TRACK                      */
*/*    WILL CONTAIN ALL THE INFORMATION ABOUT                        */
*/*    THE RECORDS ON THE TRACK                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  1879
*SRDRCRD:                                                          1879
*   PROC;                                                          1879
*                                                                  1879
SRDRCRD  STM   @14,@12,@SA00005                                    1879
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES                                              @ZA17169*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1880
*   DCL                                                            1880
*     SPACCRCT FIXED(15);           /* IO05 SPACCR LOOP CONTROL    1880
*                                                            @ZA17169*/
*   DCL                                                            1881
*     SAVCCWCT FIXED(15);           /* RDCCWCT SAVED VALUE   @ZA17169*/
*   DCL                                                            1882
*     RETRY FIXED(15) CONSTANT(2);  /* # OF ATTEMPTS         @ZA17169*/
*                                                                  1882
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACK ID TO 'RDD2'                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1883
*   OLDERID2=NEWERID2;                                             1883
         L     @02,@PC00001                                        1883
         L     @02,GDTTR2(,@02)                                    1883
         MVC   @TS00001(95),NEWERID2(@02)                          1883
         MVC   OLDERID2(95,@02),@TS00001                           1883
*   NEWID2='RDD2';                                                 1884
*                                                                  1884
         MVC   NEWID2(4,@02),@CC03002                              1884
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FIRST TIME SWITCH FOR READCNT                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1885
*   RFIRST=FSTIME;                                                 1885
*                                                                  1885
         L     @02,@PC00004                                        1885
         L     @15,RDIOAREA(,@02)                                  1885
         MVC   RFIRST(1,@15),FSTIME                                1885
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CURRENT CCHHR IN RIOAREA FOR NEXT SREADREC CALL           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1886
*   RPREV=RDCHR;                                                   1886
*                                                                  1886
         MVC   RPREV(5,@15),RDCHR(@02)                             1886
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LEN ENTRY INDEX AND SAVED RDCCWCNT         @ZA17169*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1887
*   LENINDEX=ZERO;                                                 1887
         SLR   @02,@02                                             1887
         LR    LENINDEX,@02                                        1887
*   SAVCCWCT=ZERO;                  /*                       @ZA17169*/
         LR    SAVCCWCT,@02                                        1888
*   SPACCRCT=ZERO;                  /*                       @ZA17169*/
*                                                                  1889
         LR    SPACCRCT,@02                                        1889
*   /*****************************************************************/
*   /*                                                               */
*   /* KEEP CALLING UEXCP TO READ THE COUNT FIELDS UNTIL IT RETURNS  */
*   /* AN INDICATION THAT NO MORE READING CAN BE DONE                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1890
*   TESTRC=0;                                                      1890
*                                                                  1890
         STH   @02,TESTRC                                          1890
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM THE DO WHILE IF NO RECORD FOUND OR, UNCORRECTABLE   */
*   /* I/O ERROR BEFORE REQUESTED REC OR SYNCH BYTE MISSING ON TRACK */
*   /* OR UNEXPECTED RESULTS                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1891
*   DO WHILE TESTRC^=RCABNRF&TESTRC^=RCSRUNCO&TESTRC^=RCABSYNC&TESTRC^=
*         RCSRUEX;                                                 1891
         B     @DE01891                                            1891
@DL01891 DS    0H                                                  1892
*     CALL IDCIO050(GDTTBL,READCNT,RDARG);                         1892
         L     @02,@PC00001                                        1892
         ST    @02,@AL00001                                        1892
         LA    @15,READCNT                                         1892
         ST    @15,@AL00001+4                                      1892
         L     @15,@PC00004                                        1892
         ST    @15,@AL00001+8                                      1892
         MVI   @AL00001+8,X'80'                                    1892
         L     @15,GDTEXP(,@02)                                    1892
         LA    @01,@AL00001                                        1892
         BALR  @14,@15                                             1892
*     RESPECIFY                                                    1893
*       RTNREG RSTD;                                               1893
*     TESTRC=RTNREG;                                               1894
         STH   RTNREG,TESTRC                                       1894
*     RESPECIFY                                                    1895
*       RTNREG UNRSTD;                                             1895
*                                                                  1895
*     /***************************************************************/
*     /*                                                             */
*     /* SET TRACE ID                                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1896
*     OLDERID2=NEWERID2;                                           1896
         L     @02,@PC00001                                        1896
         L     @02,GDTTR2(,@02)                                    1896
         MVC   @TS00001(95),NEWERID2(@02)                          1896
         MVC   OLDERID2(95,@02),@TS00001                           1896
*     NEWID2='RDD3';                                               1897
*                                                                  1897
         MVC   NEWID2(4,@02),@CC03003                              1897
*     /***************************************************************/
*     /*                                                             */
*     /* AS LONG AS WE ARE PROGRESSING THROUGH OUR CCW STRING WE CAN */
*     /* CONTINUE WITHOUT THE FEAR OF LOOPING. HOWEVER, SINCE CALLS  */
*     /* TO IDCIO05 TO SPACE OVER THE BAD COUNTS ZERO THE RETURN     */
*     /* CODE, WE MUST ALLOW ONLY A FINITE NUMBER OF RETRIES. WE     */
*     /* ALLOW 2 RETRIES.                                    @ZA17169*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1898
*     IF RDCCWCNT>SAVCCWCT THEN     /*                       @ZA17169*/
         L     @02,@PC00004                                        1898
         LH    @02,RDCCWCNT(,@02)                                  1898
         CR    @02,SAVCCWCT                                        1898
         BNH   @RF01898                                            1898
*       DO;                         /*                       @ZA17169*/
*         SPACCRCT=ZERO;            /*                       @ZA17169*/
         SLR   SPACCRCT,SPACCRCT                                   1900
*         SAVCCWCT=RDCCWCNT;        /*                       @ZA17169*/
         LR    SAVCCWCT,@02                                        1901
*       END;                        /*                       @ZA17169*/
*                                                                  1902
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK TO SEE IF LAST REC READ WAS R0                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1903
*     IF RDCCWCNT=ZERO&TESTRC^=4 THEN                              1903
@RF01898 SLR   @02,@02                                             1903
         L     @15,@PC00004                                        1903
         CH    @02,RDCCWCNT(,@15)                                  1903
         BNE   @RF01903                                            1903
         LH    @14,TESTRC                                          1903
         C     @14,@CF00045                                        1903
         BE    @RF01903                                            1903
*       DO;                                                        1904
*                                                                  1904
*         /***********************************************************/
*         /*                                                         */
*         /* READCNT STOPPED ON R0, SET COUNT TO OK, KEY/DATA TO     */
*         /* CURRENT RC AND CALL SPACCR TO BYPASS READ R0 UP TO TWO  */
*         /* TIMES ONLY                                      @ZA17169*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1905
*         LOCRCNT(1)=0;                                            1905
         L     @01,RDLOCPTR(,@15)                                  1905
         STH   @02,LOCRCNT(,@01)                                   1905
*         LOCRCKD(1)=TESTRC;                                       1906
*                                                                  1906
         STH   @14,LOCRCKD(,@01)                                   1906
*         /***********************************************************/
*         /*                                                         */
*         /* IF WE HAVE ALREADY RETRIED THIS TWICE THEN      @ZA17169*/
*         /* SIMPLY RETURN, OTHERWISE CALL IO05 AND          @ZA17169*/
*         /* INCREMENT THE SPACCR COUNT.                     @ZA17169*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1907
*         IF SPACCRCT<=RETRY THEN   /*                       @ZA17169*/
         C     SPACCRCT,@CF00156                                   1907
         BH    @RF01907                                            1907
*           DO;                     /*                       @ZA17169*/
*             CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*          @ZA17169*/
         L     @02,@PC00001                                        1909
         ST    @02,@AL00001                                        1909
         LA    @14,SPACCR                                          1909
         ST    @14,@AL00001+4                                      1909
         ST    @15,@AL00001+8                                      1909
         MVI   @AL00001+8,X'80'                                    1909
         L     @15,GDTEXP(,@02)                                    1909
         LA    @01,@AL00001                                        1909
         BALR  @14,@15                                             1909
*             RESPECIFY                                            1910
*               RTNREG RSTD;                                       1910
*             TESTRC=RTNREG;                                       1911
         STH   RTNREG,TESTRC                                       1911
*             RESPECIFY                                            1912
*               RTNREG UNRSTD;      /*                       @ZA17169*/
*             SPACCRCT=SPACCRCT+1;  /*                       @ZA17169*/
         AL    SPACCRCT,@CF00221                                   1913
*           END;                    /*                       @ZA17169*/
*       END;                                                       1915
*                                                                  1915
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK RETURN CODE FROM READCNT                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1916
*     ELSE                                                         1916
*       IF TESTRC=RCABNRF THEN                                     1916
         B     @RC01903                                            1916
@RF01903 CLC   TESTRC(2),RCABNRF                                   1916
         BNE   @RF01916                                            1916
*         DO;                                                      1917
*                                                                  1917
*           /*********************************************************/
*           /*                                                       */
*           /* RECORD NOT FOUND- FIRST SET EO TRACK IND IN ALL LOCTAB*/
*           /* ENTRIES FROM HERE TO END THEN SET LAST RECORD NUMBER  */
*           /* FOR READ KEY/DATA TO READ                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1918
*           DO RDCTR=(RDCCWCNT+1) TO LOCENT;                       1918
         L     @15,@PC00004                                        1918
         LA    RDCTR,1                                             1918
         AH    RDCTR,RDCCWCNT(,@15)                                1918
         B     @DE01918                                            1918
@DL01918 DS    0H                                                  1919
*             LOCRCNT(RDCTR)=RCSREOTR;                             1919
         LR    @15,RDCTR                                           1919
         MH    @15,@CH00647                                        1919
         L     @14,@PC00004                                        1919
         L     @01,RDLOCPTR(,@14)                                  1919
         LH    @14,RCSREOTR                                        1919
         AL    @01,@CF03052                                        1919
         STH   @14,LOCRCNT-4(@15,@01)                              1919
*           END;                                                   1920
         AL    RDCTR,@CF00221                                      1920
@DE01918 CH    RDCTR,LOCENT                                        1920
         BNH   @DL01918                                            1920
*           RDCCWCNT=RDCCWCNT-1;                                   1921
         L     @02,@PC00004                                        1921
         LH    @15,RDCCWCNT(,@02)                                  1921
         BCTR  @15,0                                               1921
         STH   @15,RDCCWCNT(,@02)                                  1921
*         END;                                                     1922
*       ELSE                                                       1923
*         IF TESTRC=RCABDTCK THEN                                  1923
         B     @RC01916                                            1923
@RF01916 CLC   TESTRC(2),RCABDTCK                                  1923
         BNE   @RF01923                                            1923
*           DO;                                                    1924
*                                                                  1924
*             /*******************************************************/
*             /*                                                     */
*             /* BAD COUNT FIELD - DETERMINE WHAT TO DO NOW          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1925
*                                                                  1925
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*  THE FOLLOWING SECTION OF CODE IS USED TO DETERMINE              */
*/*   THE CONDITIONS FOLLOWING A BAD COUNT RETURN CODE               */
*/*   FROM READ COUNT                                                */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1925
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF DATA SET REQUEST, OR IF LEN INFO NOT AVAIL */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1925
*             IF RDDS=DSINDRDLENTOT=ZERO THEN                     1925
*                                                                  1925
         L     @02,@PC00004                                        1925
         CLC   RDDS(1,@02),DSIND                                   1925
         BE    @RT01925                                            1925
         LH    @02,RDLENTOT(,@02)                                  1925
         LTR   @02,@02                                             1925
         BNZ   @RF01925                                            1925
@RT01925 DS    0H                                                  1926
*               /*****************************************************/
*               /*                                                   */
*               /* CANNOT CONTINUE ON THIS TRACK CHECK TO SEE IF WE  */
*               /* CAN SATISFY THIS REQUEST                          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1926
*               IF RDRECNUM>=RDCCWCNT THEN                         1926
         L     @02,@PC00004                                        1926
         SLR   @15,@15                                             1926
         IC    @15,RDRECNUM(,@02)                                  1926
         CH    @15,RDCCWCNT(,@02)                                  1926
         BL    @RF01926                                            1926
*                 DO;                                              1927
*                                                                  1927
*                   /*************************************************/
*                   /*                                               */
*                   /* ERROR BEFORE REQUESTED RECORD                 */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1928
*                   TESTRC=RCSRUNCO;                               1928
         LH    @14,RCSRUNCO                                        1928
         STH   @14,TESTRC                                          1928
*                   LOCRCNT(RDRECNUM+1)=TESTRC;                    1929
         MH    @15,@CH00647                                        1929
         L     @02,RDLOCPTR(,@02)                                  1929
         STH   @14,LOCRCNT(@15,@02)                                1929
*                 END;                                             1930
*               ELSE                                               1931
*                 DO;                                              1931
*                                                                  1931
         B     @RC01926                                            1931
@RF01926 DS    0H                                                  1932
*                   /*************************************************/
*                   /*                                               */
*                   /* ERROR AFTER REQUESTED RECORD SET UNCORRECTABLE*/
*                   /* ERROR BEFORE REQUESTED RECORD RC IN REST OF   */
*                   /* LOCTAB                                        */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1932
*                   DO RDCTR=(RDCCWCNT+1) TO LOCENT;               1932
         L     @15,@PC00004                                        1932
         LA    RDCTR,1                                             1932
         AH    RDCTR,RDCCWCNT(,@15)                                1932
         B     @DE01932                                            1932
@DL01932 DS    0H                                                  1933
*                     LOCRCNT(RDCTR)=TESTRC;                       1933
         LR    @15,RDCTR                                           1933
         MH    @15,@CH00647                                        1933
         L     @14,@PC00004                                        1933
         L     @01,RDLOCPTR(,@14)                                  1933
         LH    @14,TESTRC                                          1933
         AL    @01,@CF03052                                        1933
         STH   @14,LOCRCNT-4(@15,@01)                              1933
*                   END;                                           1934
*                                                                  1934
         AL    RDCTR,@CF00221                                      1934
@DE01932 CH    RDCTR,LOCENT                                        1934
         BNH   @DL01932                                            1934
*                   /*************************************************/
*                   /*                                               */
*                   /* SET LAST RECORD FOR READKD TO READ            */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1935
*                   RDCCWCNT=RDCCWCNT-1;                           1935
         L     @02,@PC00004                                        1935
         LH    @15,RDCCWCNT(,@02)                                  1935
         BCTR  @15,0                                               1935
         STH   @15,RDCCWCNT(,@02)                                  1935
*                 END;                                             1936
*                                                                  1936
*             /*******************************************************/
*             /*                                                     */
*             /* NOT A DATA SET REQUEST, LEN INFO AVAILABLE          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1937
*             ELSE                                                 1937
*               DO;                                                1937
*                                                                  1937
         B     @RC01925                                            1937
@RF01925 DS    0H                                                  1938
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALC WHICH LEN ENTRY TO USE AND SET IN LOCTAB   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1938
*                 IF RDLENTOT^=LENINDEX THEN                       1938
*                                                                  1938
         L     @02,@PC00004                                        1938
         CH    LENINDEX,RDLENTOT(,@02)                             1938
         BE    @RF01938                                            1938
*                   /*************************************************/
*                   /*                                               */
*                   /* IF NOT AT LAST ENTRY PROVIDED, USE NEXT ONE   */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1939
*                   LENINDEX=LENINDEX+1;                           1939
         AL    LENINDEX,@CF00221                                   1939
*                 ELSE                                             1940
*                   ;                                              1940
*                                                                  1940
@RF01938 DS    0H                                                  1941
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET CURRENT KEY AND DATA LENGTH IN LOCTAB ENTRY */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1941
*                 LOCKLEN(RDCCWCNT+1)=KEYLENS;                     1941
         L     @02,@PC00004                                        1941
         LH    @15,RDCCWCNT(,@02)                                  1941
         MH    @15,@CH00647                                        1941
         L     @14,RDLOCPTR(,@02)                                  1941
         LR    @01,LENINDEX                                        1941
         SLA   @01,2                                               1941
         ST    @02,@TF00001                                        1941
         L     @02,RDKLEN(,@02)                                    1941
         AL    @02,@CF03049                                        1941
         L     @02,KEYPTR(@01,@02)                                 1941
         L     @02,KEYLENS(,@02)                                   1941
         STC   @02,LOCKLEN(@15,@14)                                1941
*                 LOCDLEN(RDCCWCNT+1)=DATALENS;                    1942
*                                                                  1942
         L     @02,@TF00001                                        1942
         L     @02,RDDLEN(,@02)                                    1942
         AL    @02,@CF03049                                        1942
         L     @02,DATPTR(@01,@02)                                 1942
         L     @02,DATALENS(,@02)                                  1942
         STH   @02,LOCDLEN(@15,@14)                                1942
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET LEN PTR FOR SPACE COUNT                     */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1943
*                 RDRWPKLN=ADDR(LOCKLEN(RDCCWCNT+1));              1943
*                                                                  1943
         LA    @02,LOCKLEN(@15,@14)                                1943
         L     @01,@TF00001                                        1943
         ST    @02,RDRWPKLN(,@01)                                  1943
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALL SPACCR TO SET UP TO BYPASS BAD COUNT IF WE */
*                 /* HAVE ALREADY RETRIED THIS TWICE THEN    @ZA17169*/
*                 /* SIMPLY RETURN, OTHERWISE CALL IO05 AND  @ZA17169*/
*                 /* INCREMENT THE SPACCR COUNT.             @ZA17169*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1944
*                 IF SPACCRCT<=RETRY THEN/*                  @ZA17169*/
         C     SPACCRCT,@CF00156                                   1944
         BH    @RF01944                                            1944
*                   DO;             /*                       @ZA17169*/
*                     CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*  @ZA17169*/
         L     @02,@PC00001                                        1946
         ST    @02,@AL00001                                        1946
         LA    @15,SPACCR                                          1946
         ST    @15,@AL00001+4                                      1946
         L     @01,@TF00001                                        1946
         ST    @01,@AL00001+8                                      1946
         MVI   @AL00001+8,X'80'                                    1946
         L     @15,GDTEXP(,@02)                                    1946
         LA    @01,@AL00001                                        1946
         BALR  @14,@15                                             1946
*                     RESPECIFY                                    1947
*                       RTNREG RSTD;                               1947
*                     TESTRC=RTNREG;                               1948
         STH   RTNREG,TESTRC                                       1948
*                     RESPECIFY                                    1949
*                       RTNREG UNRSTD;/*                     @ZA17169*/
*                     SPACCRCT=SPACCRCT+1;/*                 @ZA17169*/
         AL    SPACCRCT,@CF00221                                   1950
*                   END;            /*                       @ZA17169*/
*               END;                                               1952
*                                                                  1952
*             /*******************************************************/
*             /*                                                     */
*             /* END DATA CHECK DO                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1953
*           END;                                                   1953
*                                                                  1953
*     /***************************************************************/
*     /*                                                             */
*     /* NOT A DATA CHECK CHECK FOR DESTAGE ERROR                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1954
*         ELSE                                                     1954
*           IF TESTRC=RCABDS THEN                                  1954
         B     @RC01923                                            1954
@RF01923 CLC   TESTRC(2),RCABDS                                    1954
         BNE   @RF01954                                            1954
*             DO;                                                  1955
*                                                                  1955
*               /*****************************************************/
*               /*                                                   */
*               /* DESTAGE ERROR ON COUNT SET KEY LEN TO ZERO AND    */
*               /* DATA LEN TO ONE AND CALL SPACCR TO BYPASS THE BAD */
*               /* COUNT IF WE HAVE ALREADY RETRIED THIS TWICE THEN  */
*               /*                                           @ZA17169*/
*               /* SIMPLY RETURN, OTHERWISE CALL IO05 AND    @ZA17169*/
*               /* INCREMENT THE SPACCR COUNT.               @ZA17169*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1956
*               LOCKLEN(RDCCWCNT+1)=ZERO;                          1956
         L     @02,@PC00004                                        1956
         LH    @15,RDCCWCNT(,@02)                                  1956
         MH    @15,@CH00647                                        1956
         L     @14,RDLOCPTR(,@02)                                  1956
         SLR   @01,@01                                             1956
         STC   @01,LOCKLEN(@15,@14)                                1956
*               LOCDLEN(RDCCWCNT+1)=1;                             1957
         LA    @01,1                                               1957
         STH   @01,LOCDLEN(@15,@14)                                1957
*               RDRWPKLN=ADDR(LOCKLEN(RDCCWCNT+1));                1958
         LA    @15,LOCKLEN(@15,@14)                                1958
         ST    @15,RDRWPKLN(,@02)                                  1958
*               IF SPACCRCT<=RETRY THEN/*                    @ZA17169*/
         C     SPACCRCT,@CF00156                                   1959
         BH    @RF01959                                            1959
*                 DO;               /*                       @ZA17169*/
*                   CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*    @ZA17169*/
         L     @15,@PC00001                                        1961
         ST    @15,@AL00001                                        1961
         LA    @14,SPACCR                                          1961
         ST    @14,@AL00001+4                                      1961
         ST    @02,@AL00001+8                                      1961
         MVI   @AL00001+8,X'80'                                    1961
         L     @15,GDTEXP(,@15)                                    1961
         LA    @01,@AL00001                                        1961
         BALR  @14,@15                                             1961
*                   RESPECIFY                                      1962
*                     RTNREG RSTD;                                 1962
*                   TESTRC=RTNREG;                                 1963
         STH   RTNREG,TESTRC                                       1963
*                   RESPECIFY                                      1964
*                     RTNREG UNRSTD;/*                       @ZA17169*/
*                   SPACCRCT=SPACCRCT+1;/*                   @ZA17169*/
         AL    SPACCRCT,@CF00221                                   1965
*                 END;              /*                       @ZA17169*/
*             END;                                                 1967
*           ELSE                                                   1968
*             IF TESTRC=RCABST THEN                                1968
         B     @RC01954                                            1968
@RF01954 CLC   TESTRC(2),RCABST                                    1968
         BNE   @RF01968                                            1968
*               DO;                                                1969
*                                                                  1969
*                 /***************************************************/
*                 /*                                                 */
*                 /* STAGING ERROR ON COUNT KEY/DATA LENGTHS IN COUNT*/
*                 /* FIELD CALL UEXCP SPACCR TO BYPASS BAD COUNT IF  */
*                 /* WE HAVE ALREADY RETRIED THIS TWICE THEN @ZA17169*/
*                 /* SIMPLY RETURN, OTHERWISE CALL IO05 AND  @ZA17169*/
*                 /* INCREMENT THE SPACCR COUNT.             @ZA17169*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1970
*                 RDRWPKLN=NULLPTR;                                1970
         L     @02,@PC00004                                        1970
         SLR   @15,@15                                             1970
         ST    @15,RDRWPKLN(,@02)                                  1970
*                 IF SPACCRCT<=RETRY THEN/*                  @ZA17169*/
         C     SPACCRCT,@CF00156                                   1971
         BH    @RF01971                                            1971
*                   DO;             /*                       @ZA17169*/
*                     CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*  @ZA17169*/
         L     @15,@PC00001                                        1973
         ST    @15,@AL00001                                        1973
         LA    @14,SPACCR                                          1973
         ST    @14,@AL00001+4                                      1973
         ST    @02,@AL00001+8                                      1973
         MVI   @AL00001+8,X'80'                                    1973
         L     @15,GDTEXP(,@15)                                    1973
         LA    @01,@AL00001                                        1973
         BALR  @14,@15                                             1973
*                     RESPECIFY                                    1974
*                       RTNREG RSTD;                               1974
*                     TESTRC=RTNREG;                               1975
         STH   RTNREG,TESTRC                                       1975
*                     RESPECIFY                                    1976
*                       RTNREG UNRSTD;/*                     @ZA17169*/
*                     SPACCRCT=SPACCRCT+1;/*                 @ZA17169*/
         AL    SPACCRCT,@CF00221                                   1977
*                   END;            /*                       @ZA17169*/
*               END;                                               1979
*             ELSE                                                 1980
*               IF TESTRC=RCABSYNC THEN                            1980
*                                                                  1980
         B     @RC01968                                            1980
@RF01968 CLC   TESTRC(2),RCABSYNC                                  1980
         BNE   @RF01980                                            1980
*                 /***************************************************/
*                 /*                                                 */
*                 /* SYNC BYTE MISSING CANNOT CONTINUE ON THIS TRACK */
*                 /* CHECK TO SEE IF WE CAN SATISFY THIS REQUEST     */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1981
*                 IF RDRECNUM>=RDCCWCNT THEN                       1981
         L     @02,@PC00004                                        1981
         SLR   @15,@15                                             1981
         IC    @15,RDRECNUM(,@02)                                  1981
         CH    @15,RDCCWCNT(,@02)                                  1981
         BL    @RF01981                                            1981
*                   DO;                                            1982
*                                                                  1982
*                     /***********************************************/
*                     /*                                             */
*                     /* ERROR BEFORE REQUESTED RECORD               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1983
*                     TESTRC=RCSRUNCO;                             1983
         LH    @14,RCSRUNCO                                        1983
         STH   @14,TESTRC                                          1983
*                     LOCRCNT(RDRECNUM+1)=TESTRC;                  1984
         MH    @15,@CH00647                                        1984
         L     @02,RDLOCPTR(,@02)                                  1984
         STH   @14,LOCRCNT(@15,@02)                                1984
*                   END;                                           1985
*                 ELSE                                             1986
*                   DO;                                            1986
*                                                                  1986
         B     @RC01981                                            1986
@RF01981 DS    0H                                                  1987
*                     /***********************************************/
*                     /*                                             */
*                     /* ERROR AFTER REQUESTED RECORD SET            */
*                     /* UNCORRECTABLE ERROR BEFORE REQUESTED RECORD */
*                     /* RC IN REST OF LOCTAB                        */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1987
*                     DO RDCTR=(RDCCWCNT+1) TO LOCENT;             1987
         L     @15,@PC00004                                        1987
         LA    RDCTR,1                                             1987
         AH    RDCTR,RDCCWCNT(,@15)                                1987
         B     @DE01987                                            1987
@DL01987 DS    0H                                                  1988
*                       LOCRCNT(RDCTR)=TESTRC;                     1988
         LH    @15,TESTRC                                          1988
         LR    @14,RDCTR                                           1988
         MH    @14,@CH00647                                        1988
         L     @01,@PC00004                                        1988
         L     @01,RDLOCPTR(,@01)                                  1988
         ST    @14,@TF00001                                        1988
         LA    @14,0(@14,@01)                                      1988
         AL    @14,@CF03052                                        1988
         STH   @15,LOCRCNT-4(,@14)                                 1988
*                       LOCRCKD(RDCTR)=TESTRC;                     1989
         L     @14,@TF00001                                        1989
         AL    @14,@CF03053                                        1989
         STH   @15,LOCRCKD-6(@14,@01)                              1989
*                       LOCADDR(RDCTR)=NTFNDPTR;                   1990
         ICM   @00,15,NTFNDPTR                                     1990
         L     @15,@TF00001                                        1990
         AL    @01,@CF03054                                        1990
         ST    @00,LOCADDR(@15,@01)                                1990
*                     END;                                         1991
*                                                                  1991
         AL    RDCTR,@CF00221                                      1991
@DE01987 CH    RDCTR,LOCENT                                        1991
         BNH   @DL01987                                            1991
*                     /***********************************************/
*                     /*                                             */
*                     /* SET LAST RECORD FOR READKD TO READ          */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1992
*                     RDCCWCNT=RDCCWCNT-1;                         1992
         L     @02,@PC00004                                        1992
         LH    @15,RDCCWCNT(,@02)                                  1992
         BCTR  @15,0                                               1992
         STH   @15,RDCCWCNT(,@02)                                  1992
*                   END;                                           1993
*               ELSE                                               1994
*                 IF TESTRC=4 THEN                                 1994
         B     @RC01980                                            1994
@RF01980 CLC   TESTRC(2),@CH00045                                  1994
         BNE   @RF01994                                            1994
*                   DO;                                            1995
*                                                                  1995
*                     /***********************************************/
*                     /*                                             */
*                     /* UNCORRECTABLE ERROR SOMEWHERE ON THE TRACK  */
*                     /* SET UNCORRECTABLE RETURN CODE AND RETURN    */
*                     /*                                             */
*                     /***********************************************/
*                                                                  1996
*                     TESTRC=RCSRUNCO;                             1996
         LH    @02,RCSRUNCO                                        1996
         STH   @02,TESTRC                                          1996
*                     LOCRCNT(RDRECNUM+1)=TESTRC;                  1997
         L     @15,@PC00004                                        1997
         SLR   @14,@14                                             1997
         IC    @14,RDRECNUM(,@15)                                  1997
         MH    @14,@CH00647                                        1997
         L     @01,RDLOCPTR(,@15)                                  1997
         STH   @02,LOCRCNT(@14,@01)                                1997
*                   END;                                           1998
*                 ELSE                                             1999
*                   DO;                                            1999
*                                                                  1999
         B     @RC01994                                            1999
@RF01994 DS    0H                                                  2000
*                     /***********************************************/
*                     /*                                             */
*                     /* NONE OF THE EXPECTED RETURN CODES SET       */
*                     /* UNEXPECTED RESULTS AND RETURN               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  2000
*                     TESTRC=RCSRUEX;                              2000
         LH    @02,RCSRUEX                                         2000
         STH   @02,TESTRC                                          2000
*                     DO RDCTR=(RDCCWCNT+1) TO LOCENT;             2001
         L     @15,@PC00004                                        2001
         LA    RDCTR,1                                             2001
         AH    RDCTR,RDCCWCNT(,@15)                                2001
         B     @DE02001                                            2001
@DL02001 DS    0H                                                  2002
*                       LOCRCNT(RDCTR)=TESTRC;                     2002
         LH    @15,TESTRC                                          2002
         LR    @14,RDCTR                                           2002
         MH    @14,@CH00647                                        2002
         L     @01,@PC00004                                        2002
         L     @01,RDLOCPTR(,@01)                                  2002
         ST    @14,@TF00001                                        2002
         LA    @14,0(@14,@01)                                      2002
         AL    @14,@CF03052                                        2002
         STH   @15,LOCRCNT-4(,@14)                                 2002
*                       LOCRCKD(RDCTR)=TESTRC;                     2003
         L     @14,@TF00001                                        2003
         AL    @14,@CF03053                                        2003
         STH   @15,LOCRCKD-6(@14,@01)                              2003
*                       LOCADDR(RDCTR)=NTFNDPTR;                   2004
         ICM   @00,15,NTFNDPTR                                     2004
         L     @15,@TF00001                                        2004
         AL    @01,@CF03054                                        2004
         ST    @00,LOCADDR(@15,@01)                                2004
*                     END;                                         2005
         AL    RDCTR,@CF00221                                      2005
@DE02001 CH    RDCTR,LOCENT                                        2005
         BNH   @DL02001                                            2005
*                   END;                                           2006
*                                                                  2006
*     /***************************************************************/
*     /*                                                             */
*     /* END OF DO WHILE LOOP FOR READING COUNTS                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  2007
*   END;                                                           2007
*                                                                  2007
@RC01994 DS    0H                                                  2007
@RC01980 DS    0H                                                  2007
@RC01968 DS    0H                                                  2007
@RC01954 DS    0H                                                  2007
@RC01923 DS    0H                                                  2007
@RC01916 DS    0H                                                  2007
@RC01903 DS    0H                                                  2007
@DE01891 LH    @02,TESTRC                                          2007
         CH    @02,RCABNRF                                         2007
         BE    @DC01891                                            2007
         CH    @02,RCSRUNCO                                        2007
         BE    @DC01891                                            2007
         CH    @02,RCABSYNC                                        2007
         BE    @DC01891                                            2007
         CH    @02,RCSRUEX                                         2007
         BNE   @DL01891                                            2007
@DC01891 DS    0H                                                  2008
*/********************************************************************/
*/*                                                                  */
*/*    ALL COUNT FIELDS HAVE BEEN READ                               */
*/*                                                                  */
*/*    READ KEY  AND  DATA FIELDS IF NECESSARY                       */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  2008
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INDEX OF LAST RECORD READ RESET RECORDS READ COUNTER      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2008
*   RNUMREC=RDCCWCNT;                                              2008
         L     @15,@PC00004                                        2008
         L     @14,RDIOAREA(,@15)                                  2008
         LH    @05,RDCCWCNT(,@15)                                  2008
         STH   @05,RNUMREC(,@14)                                   2008
*   RDCCWCNT=ZERO;                                                 2009
*                                                                  2009
         SLR   @05,@05                                             2009
         STH   @05,RDCCWCNT(,@15)                                  2009
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FIRST TIME TO READ KEY/DATA                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2010
*   RFIRST=FSTIME;                                                 2010
*                                                                  2010
         MVC   RFIRST(1,@14),FSTIME                                2010
*   /*****************************************************************/
*   /*                                                               */
*   /* READ ALL THE RECORDS AVAILABLE UNLESS AN UNCORRECTABLE I/O    */
*   /* ERROR OCCURRED BEFORE REQUESTED RECORD OR UNEXPECTED RESULTS  */
*   /* WERE INDICATED FROM READCNT                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2011
*   DO WHILE RNUMREC>RDCCWCNT&TESTRC^=RCSRUNCO&TESTRC^=RCSRUEX;    2011
*                                                                  2011
         B     @DE02011                                            2011
@DL02011 DS    0H                                                  2012
*     /***************************************************************/
*     /*                                                             */
*     /* CALL READKD TO READ IN AS MUCH AS POSSIBLE                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  2012
*     CALL IDCIO050(GDTTBL,READKD,RDARG);                          2012
         L     @15,@PC00001                                        2012
         ST    @15,@AL00001                                        2012
         LA    @14,READKD                                          2012
         ST    @14,@AL00001+4                                      2012
         L     @14,@PC00004                                        2012
         ST    @14,@AL00001+8                                      2012
         MVI   @AL00001+8,X'80'                                    2012
         L     @15,GDTEXP(,@15)                                    2012
         LA    @01,@AL00001                                        2012
         BALR  @14,@15                                             2012
*     RESPECIFY                                                    2013
*       RTNREG RSTD;                                               2013
*     TESTRC=RTNREG;                                               2014
         STH   RTNREG,TESTRC                                       2014
*     RESPECIFY                                                    2015
*       RTNREG UNRSTD;                                             2015
*                                                                  2015
*     /***************************************************************/
*     /*                                                             */
*     /* END OF DO WHILE LOOP TO READ COUNT/KEY/DATA FIELDS          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  2016
*   END;                                                           2016
@DE02011 L     @15,@PC00004                                        2016
         L     @01,RDIOAREA(,@15)                                  2016
         LH    @14,RNUMREC(,@01)                                   2016
         CH    @14,RDCCWCNT(,@15)                                  2016
         BNH   @DC02011                                            2016
         LH    @15,TESTRC                                          2016
         CH    @15,RCSRUNCO                                        2016
         BE    @DC02011                                            2016
         CH    @15,RCSRUEX                                         2016
         BNE   @DL02011                                            2016
@DC02011 DS    0H                                                  2017
*   RETURN CODE(TESTRC);                                           2017
         LH    @15,TESTRC                                          2017
         L     @14,@SA00005                                        2017
         LM    @00,@12,@SA00005+8                                  2017
         BR    @14                                                 2017
*   END SRDRCRD;                                                   2018
*   END IDCRDRD;                                                   2019
*IDCRD7X:                                                          2020
*   PROCEDURE;                                                     2020
*                                                                  2020
IDCRD7X  STM   @14,@12,@SA00006                                    2020
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - IDCRD7X                                         */
*/*                                                                  */
*/* FUNCTION - THIS PROCEDURE FREES AUTOMATIC STORAGE OBTAINED WHEN  */
*/*            THIS MODULE WAS INITIALLY ENTERED IN PROCEDURE        */
*/*            IDCRD07 AND RESTORES THE CODE REGS.                   */
*/*                                                                  */
*/* ENTRY POINT -IDCRD7X (ONLY ENTRY POINT FOR THIS PROCEDURE)       */
*/*                                                                  */
*/*            LINKAGE - 'CALL IDCRD7X;'                             */
*/*                                                                  */
*/*            INPUT -                                               */
*/*                                                                  */
*/*              NONE                                                */
*/*                                                                  */
*/*            OUTPUT -                                              */
*/*                                                                  */
*/*              NONE                                                */
*/*                                                                  */
*/*            EXIT, NORMAL -                                        */
*/*                                                                  */
*/*              LASTCC = CURRENT VALUE                              */
*/*                                                                  */
*/*            EXIT, ERROR -                                         */
*/*                                                                  */
*/*              NONE                                                */
*/*                                                                  */
*/* INTERNAL INTERFACES -                                            */
*/*                                                                  */
*/*      NONE                                                        */
*/*                                                                  */
*/* EXTERNAL INTERFACES -                                            */
*/*                                                                  */
*/*      MACROS/SVCS -                                               */
*/*                                                                  */
*/*            ?UEPIL - IDCAMS SYSTEM ADAPTER EPILOG ROUTINE         */
*/*              FACILITATES SYSTEM INDEPENDENT EPILOG ACTIVITY      */
*/*              GENERATES A CALL TO MODULE IDCSAEP                  */
*/*                                                                  */
*/*            UTRACE - IDCAMS TRACE POINT ROUTINE                   */
*/*              SETS TRACE POINT                                    */
*/*                                                                  */
*/*      PROCEDURES/SUBROUTINES CALLED -                             */
*/*                                                                  */
*/*            NONE                                                  */
*/*                                                                  */
*/*      DATA AREAS -                                                */
*/*                                                                  */
*/*            NONE                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  2021
*                                                                  2021
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY POINT FOR IDCRD7X                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2021
*   GEN(ENTRY IDCRD7X);                                            2021
         ENTRY IDCRD7X
*   GEN(STM 14,12,12(13));          /*                       @ZA27486*/
         STM 14,12,12(13)
*   GEN(L REG6,SPLITSV1);                                          2023
         L REG6,SPLITSV1
*   LM(REG9,REG12,SPLITSAV);                                       2024
*                                                                  2024
         LM    REG9,REG12,SPLITSAV                                 2024
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TRACE POINT                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2025
*   OLDERID2=NEWERID2;                                             2025
         L     @03,@PC00001                                        2025
         L     @15,GDTTR2(,@03)                                    2025
         MVC   @TS00001(95),NEWERID2(@15)                          2025
         MVC   OLDERID2(95,@15),@TS00001                           2025
*   NEWID2='RD73';                                                 2026
*                                                                  2026
         MVC   NEWID2(4,@15),@CC03008                              2026
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UEPIL TO FREE STORAGE AND RETURN TO IDCRD01 ESTABLISHING*/
*   /* LINKAGE TO THE RD06 SAVE AREA.                        @ZA27486*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2027
*   RESPECIFY                                                      2027
*    (REG7,                                                        2027
*     REG13) RESTRICTED;            /*                       @ZA27486*/
*   FORCHAIN=REG7;                  /*                       @ZA27486*/
         ST    REG7,FORCHAIN(,REG13)                               2028
*   SAVER13=REG13;                  /*                       @ZA27486*/
         LR    SAVER13,REG13                                       2029
*   REG13=REG7;                     /*                       @ZA27486*/
         LR    REG13,REG7                                          2030
*   BACKCHAN=SAVER13;               /*                       @ZA27486*/
         ST    SAVER13,BACKCHAN(,REG13)                            2031
*   FORCHAIN=NULLPTR;               /*                       @ZA27486*/
         SLR   @02,@02                                             2032
         ST    @02,FORCHAIN(,REG13)                                2032
*   RESPECIFY                                                      2033
*    (REG7,                                                        2033
*     REG13) UNRESTRICTED;          /*                       @ZA27486*/
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                            2034
         ST    @03,@AL00001                                        2034
         LA    @02,MODID                                           2034
         ST    @02,@AL00001+4                                      2034
         LA    @02,LASTCC                                          2034
         ST    @02,@AL00001+8                                      2034
         MVI   @AL00001+8,X'80'                                    2034
         L     @15,GDTEPL(,@03)                                    2034
         LA    @01,@AL00001                                        2034
         BALR  @14,@15                                             2034
*   END IDCRD7X;                                                   2035
@EL00006 DS    0H                                                  2035
@EF00006 DS    0H                                                  2035
@ER00006 LM    @14,@12,@SA00006                                    2035
         BR    @14                                                 2035
         EJECT
*   END IDCRD07                                                    2036
*                                                                  2036
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSRD )                                       */
*/*%INCLUDE SYSLIB  (IDCDF65 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF66 )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */
*/*%INCLUDE SYSLIB  (IECSDSL1)                                       */
*                                                                  2036
*       ;                                                          2036
@DATA    DS    0H
@CH00164 DC    H'3'
@CH00288 DC    H'5'
@CH00035 DC    H'6'
@CH00040 DC    H'7'
@CH00181 DC    H'8'
@CH00036 DC    H'9'
@CH00037 DC    H'10'
@CH00038 DC    H'11'
@CH00647 DC    H'20'
@CH00651 DC    H'21'
@CH00666 DC    H'23'
@CH02800 DC    H'33'
@CH02802 DC    H'34'
@CH00709 DC    H'35'
@CH00730 DC    H'39'
@CH00732 DC    H'40'
@CH00770 DC    H'46'
@CH00797 DC    H'52'
@CH00818 DC    H'72'
@CH02809 DC    H'78'
@CH00866 DC    H'93'
         DS    0F
@AL01377 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01389 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01437 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01466 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01495 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01530 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01595 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01616 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01699 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01734 DC    A(@CC02759)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@PC00002 DS    2F
@SA00003 DS    15F
@SA00004 DS    15F
@PC00004 DS    1F
@SA00005 DS    15F
@SA00006 DS    15F
@AL00001 DS    6A
@TF00001 DS    F
@TF00002 DS    F
IDCRD07  CSECT
         DS    0F
@CF00118 DC    F'0'
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00156 DC    F'2'
@CH00156 EQU   @CF00156+2
@CF00045 DC    F'4'
@CH00045 EQU   @CF00045+2
@CF00039 DC    F'12'
@CH00039 EQU   @CF00039+2
@CF00223 DC    F'32'
@CF00600 DC    F'44'
@CF00886 DC    F'96'
@CF03051 DC    F'-52'
@CF03054 DC    F'-20'
@CF03052 DC    F'-16'
@CF03053 DC    F'-14'
@CF03047 DC    F'-8'
@CF03048 DC    F'-6'
@CF03049 DC    F'-4'
@CF03050 DC    F'-2'
@CF03043 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
DCBPTR   DS    A
DEBPTR   DS    A
DEBEXPTR DS    A
DEBSBPTR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
F3PTR    DS    A
REQBYTES DS    F
REQADDR  DS    A
DEVAREAP DS    A
INFOPTR  DS    A
SINFPTR  DS    A
INFVOLPT DS    A
DEVDD    DS    A
LISTPTR  DS    A
TESTRC   DS    H
LASTCC   DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
SPLITSAV DS    CL16
WTORECB  DS    CL4
WTOREPLY DS    CL1
INFOBYT  DS    CL1
XTNTHOLD DS    CL78
INFODD   DS    CL8
WTORLIST DS    CL84
CAM1     DS    CL16
         ORG   CAM1
@NM00196 DS    CL4
CAMDSN   DS    FL4
CAMVOL   DS    FL4
CAMWA    DS    FL4
         ORG   CAM1+16
         DS    CL4
OBTAINWA DS    CL148
DARGL    DS    CL20
PARMHOLD DS    CL17
         DS    CL1
VTOCADDR DS    CL5
         ORG   VTOCADDR
VTOCCC   DS    FL2
VTOCHH   DS    FL2
VTOCR    DS    FL1
         ORG   VTOCADDR+5
FMT1ADDR DS    CL5
SPLITSV1 DS    CL4
IDCRD07  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01553 DC    V(IDCRDER)
         DS    0D
RCSRGG   DC    H'1'
RCSRGBSP DC    H'2'
RCSRGDS  DC    H'3'
RCSRGGOF DC    H'4'
RCSRGSTG DC    H'5'
RCSRBG   DC    H'7'
RCSRDSDS DC    H'8'
RCSRSTDS DC    H'9'
RCSRSTST DC    H'10'
RCSRGBDT DC    H'16'
RCSRBCNT DC    H'18'
RCSRBB   DC    H'19'
RCSRDSB  DC    H'20'
RCSRSTB  DC    H'21'
RCSRUNCO DC    H'22'
RCSREOF  DC    H'29'
RCSREOTR DC    H'30'
RCSRUEX  DC    H'31'
RCSRSYNC DC    H'32'
RCSRNRF  DC    H'33'
RCABDS   DC    H'8'
RCABST   DC    H'12'
RCABOV   DC    H'16'
RCABNRF  DC    H'20'
RCABSYNC DC    H'24'
RCABDTCK DC    H'28'
RCABEOFR DC    H'32'
LOCENT   DC    AL2(125)
FSTIME   DC    XL1'FF'
DSIND    DC    XL1'00'
@CC02833 DC    C'DATASETRANGE     '
@CC02836 DC    C'INDATASETADDRESS '
@CC02839 DC    C'OUTDATASETADDRESS'
@CC02842 DC    C'VTOCHEADERADDRESS'
@CC02024 DC    C'OPENR   '
@CC02747 DC    C'SYSVTOC '
@CC02831 DC    C'OBTAIN  '
@CC01568 DC    C'RD71'
@CC01569 DC    C'RD72'
@CC02759 DC    C'RD01'
@CC02856 DC    C'RD6H'
@CC02857 DC    C'RD6I'
@CC02879 DC    C'RD6J'
@CC02909 DC    C'RD6L'
@CC02914 DC    C'RD6P'
@CC02924 DC    C'RD6M'
@CC02931 DC    C'RD6N'
@CC02935 DC    C'RD6Q'
@CC02992 DC    C'RDDD'
@CC02993 DC    C'RDD1'
@CC02995 DC    C'RDDR'
@CC03002 DC    C'RDD2'
@CC03003 DC    C'RDD3'
@CC03008 DC    C'RD73'
@CC02814 EQU   @CC02759
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'RD07'
FIXAREA  DS    CL1024
         ORG   FIXAREA
@NM00089 DS    CL256
         ORG   @NM00089
@NM00090 DC    256X'00'
         ORG   FIXAREA+256
@NM00091 DS    CL256
         ORG   @NM00091
@NM00092 DC    256X'00'
         ORG   FIXAREA+512
@NM00093 DS    CL256
         ORG   @NM00093
@NM00094 DC    256X'00'
         ORG   FIXAREA+768
@NM00095 DS    CL256
         ORG   @NM00095
@NM00096 DC    256X'00'
         ORG   FIXAREA+1024
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
VHDRDSN  DC    CL44'VTOCHEADER'
FMT4DSCB DC    CL44'FORMAT4.DSCB'
ZEROS    DS    CL8
         ORG   ZEROS
@NM00197 DC    8X'00'
         ORG   ZEROS+8
LASTENT  DS    CL78
         ORG   LASTENT
@NM00198 DC    78X'FF'
         ORG   LASTENT+78
FMT4DSN  DS    CL44
         ORG   FMT4DSN
@NM00199 DC    44X'04'
         ORG   FMT4DSN+44
BLANKS   DS    CL44
         ORG   BLANKS
@NM00200 DC    44X'40'
         ORG   BLANKS+44
NTFNDPTR DC    X'FFFFFFFF'
READCNT  DC    CL8'READCNT '
READKD   DC    CL8'READKD  '
SPACCR   DC    CL8'SPACCR  '
@DATD    DSECT
IDCRD07  CSECT
LWTORLST WTOR  '1234567890123456789012345678901234567890123456789012345X
               67890123456789012',MF=L
CAMLIST  CAMLST SEARCH,XTNHDSN,XTNHVOL,XTNHVOL
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRD07  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SAVCCWCT EQU   @05
SPACCRCT EQU   @03
RDCTR    EQU   @02
LENINDEX EQU   @04
INFDSNPT EQU   @03
INFSCNPT EQU   @02
XTNTPTR2 EQU   @04
XTNTPTR  EQU   @05
F4PTR    EQU   @02
F1PTR    EQU   @02
SAVER13  EQU   @02
DEBDAPTR EQU   @02
OPNPTR   EQU   @02
RTNREG   EQU   @15
REG3     EQU   @03
REG4     EQU   @04
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
REG12    EQU   @12
REG13    EQU   @13
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG5     EQU   @05
REG6     EQU   @06
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSAAL0 EQU   0
IDCSARV0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLPWD   EQU   ALLAGL+20
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOGT0 EQU   0
IDCIOSI0 EQU   0
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCCBP   EQU   IOCSTR+36
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNMODRC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+36
OPNKYL   EQU   OPNAGL+40
OPNDSO   EQU   OPNAGL+41
OPNDSOAM EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
OPNOPTJM EQU   OPNOPT2
OPNVOL   EQU   OPNAGL+44
IOINFOPT EQU   0
IOINFVOL EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
DISPL    EQU   0
INFIL    EQU   0
INFILPAS EQU   INFIL+1
INFILVAL EQU   INFIL+10
INDS     EQU   0
INDSPAS  EQU   INDS+1
INDSFLG  EQU   INDS+10
INDSVAL  EQU   INDS+21
DSRNG    EQU   0
STAGR    EQU   0
DOUTF    EQU   0
DOTDS    EQU   0
DOTDSFLG EQU   DOTDS+10
VOLSR    EQU   0
VOLSRFLG EQU   VOLSR+10
VOLSRVAL EQU   VOLSR+21
DCCHR    EQU   0
DCCHRLEN EQU   DCCHR
DCCHRVAL EQU   DCCHR+1
DREC     EQU   0
DRECLEN  EQU   DREC
DRECVAL  EQU   DREC+1
VOLDS    EQU   0
VOLDSFLG EQU   VOLDS+10
VOLDSVAL EQU   VOLDS+21
DSCHR    EQU   0
DSCHRLEN EQU   DSCHR
DSCHRVAL EQU   DSCHR+1
DSCHH    EQU   0
DSCHHLEN EQU   DSCHH
DSCHHVAL EQU   DSCHH+1
VOLRR    EQU   0
VOLRRFLG EQU   VOLRR+10
RRCHR    EQU   0
RRCHH    EQU   0
DKEYL    EQU   0
DATAL    EQU   0
DPVTC    EQU   0
DVTCS    EQU   0
DVTCSFLG EQU   DVTCS+10
DVTCSVAL EQU   DVTCS+21
COPY     EQU   0
CINFL    EQU   0
CINFLPAS EQU   CINFL+1
CINFLVAL EQU   CINFL+10
CINDS    EQU   0
CINDSPAS EQU   CINDS+1
CINDSFLG EQU   CINDS+10
CINDSVAL EQU   CINDS+21
CSRNG    EQU   0
CDSRG    EQU   0
COFIL    EQU   0
CCATL    EQU   0
CCATLFLG EQU   CCATL+10
CVOLD    EQU   0
CVOLDFLG EQU   CVOLD+10
CVOLDVAL EQU   CVOLD+21
CDCHR    EQU   0
CDCHRLEN EQU   CDCHR
CDCHRVAL EQU   CDCHR+1
CDHHR    EQU   0
CDHHRLEN EQU   CDHHR
CDHHRVAL EQU   CDHHR+1
CVOLS    EQU   0
CVOLSFLG EQU   CVOLS+10
CVOLSVAL EQU   CVOLS+21
CCCHR    EQU   0
CCCHRLEN EQU   CCCHR
CCCHRVAL EQU   CCCHR+1
CRECR    EQU   0
CRECRLEN EQU   CRECR
CRECRVAL EQU   CRECR+1
CKEYL    EQU   0
CDATL    EQU   0
CVTOC    EQU   0
CVTCS    EQU   0
CVTCSFLG EQU   CVTCS+10
CVTCSVAL EQU   CVTCS+21
DBFIL    EQU   0
DBDS     EQU   0
DBDSFLG  EQU   DBDS+10
DBVOL    EQU   0
DBVOLFLG EQU   DBVOL+10
DBCCH    EQU   0
DBHHH    EQU   0
DBKEY    EQU   0
DBDAT    EQU   0
MODIF    EQU   0
MNCNT    EQU   0
MINFL    EQU   0
MINFLPAS EQU   MINFL+1
MINFLVAL EQU   MINFL+10
MINDS    EQU   0
MINDSPAS EQU   MINDS+1
MINDSFLG EQU   MINDS+10
MINDSVAL EQU   MINDS+21
MIDSA    EQU   0
MODSA    EQU   0
MOUTF    EQU   0
MOUTFPAS EQU   MOUTF+1
MOUTFVAL EQU   MOUTF+10
MODS     EQU   0
MODSPAS  EQU   MODS+1
MODSFLG  EQU   MODS+10
MODSVAL  EQU   MODS+21
MVTOC    EQU   0
MVTCS    EQU   0
MVTCSFLG EQU   MVTCS+10
MVTCSVAL EQU   MVTCS+21
MVTCR    EQU   0
MVTCRLEN EQU   MVTCR
MVTCRVAL EQU   MVTCR+1
MIRVO    EQU   0
MIRVOFLG EQU   MIRVO+10
MIRCH    EQU   0
MIDVO    EQU   0
MIDVOFLG EQU   MIDVO+10
MIDVOVAL EQU   MIDVO+21
MIDCH    EQU   0
MIDCHLEN EQU   MIDCH
MIDCHVAL EQU   MIDCH+1
MRRVO    EQU   0
MRRVOFLG EQU   MRRVO+10
MRRCH    EQU   0
MRRHH    EQU   0
MNDOF    EQU   0
MNDST    EQU   0
MNKOF    EQU   0
MNKST    EQU   0
MORVO    EQU   0
MORVOFLG EQU   MORVO+10
MORCH    EQU   0
MODVO    EQU   0
MODVOFLG EQU   MODVO+10
MODVOVAL EQU   MODVO+21
MODCH    EQU   0
MODCHLEN EQU   MODCH
MODCHVAL EQU   MODCH+1
RWFHDR   EQU   0
RWFHDSNU EQU   RWFHDR+55
SRPRTARG EQU   0
RWFINFO  EQU   0
RWFKEY1  EQU   RWFINFO+82
RWFKEY2  EQU   RWFINFO+93
RWHDRINF EQU   0
RWHDRFIX EQU   RWHDRINF
RWHDRKLN EQU   RWHDRINF+5
RWHDRDLN EQU   RWHDRINF+6
RDARG    EQU   0
RDIOAREA EQU   RDARG+12
RDDARE   EQU   RDARG+16
RDLOCPTR EQU   RDARG+20
RDCCWCNT EQU   RDARG+24
RDCHR    EQU   RDARG+26
RDCC     EQU   RDCHR
RDHH     EQU   RDCHR+2
RDRECNUM EQU   RDCHR+4
RDDS     EQU   RDARG+31
RDRWPKLN EQU   RDARG+32
RDSPACE  EQU   RDARG+36
RDSPKL   EQU   RDARG+47
RDSPDL   EQU   RDARG+48
RDLENTOT EQU   RDARG+50
RDKLEN   EQU   RDARG+52
RDDLEN   EQU   RDARG+56
INFOAREA EQU   0
INFAREAL EQU   INFOAREA
INFDATAL EQU   INFOAREA+2
INFAREA  EQU   INFOAREA+4
INFODSN  EQU   0
INFDSNID EQU   INFODSN
INFDSN   EQU   INFODSN+4
INFOVOL  EQU   0
INFVOL   EQU   INFOVOL+4
DEVAREA  EQU   0
DEVDEVTP EQU   DEVAREA
DEVTBYT2 EQU   DEVDEVTP+1
DEVRVDEV EQU   DEVTBYT2
@NM00054 EQU   DEVAREA+8
DEVMAXCC EQU   @NM00054
DEVMAXHH EQU   @NM00054+2
DEVWORD3 EQU   DEVAREA+12
DEVTC    EQU   DEVWORD3
DEVBOH   EQU   DEVWORD3+2
DEVWORD4 EQU   DEVAREA+16
DEV4B1   EQU   DEVWORD4+1
XTNTTBL2 EQU   0
XTN2ENT  EQU   XTNTTBL2
XTN2CHR1 EQU   XTN2ENT+44
XTN2CC1  EQU   XTN2CHR1
XTN2HH1  EQU   XTN2CHR1+2
XTN2CHR2 EQU   XTN2ENT+48
XTN2CC2  EQU   XTN2CHR2
XTN2HH2  EQU   XTN2CHR2+2
XTNTTBL  EQU   0
XTNTHDR  EQU   XTNTTBL
XTNHDDN  EQU   XTNTHDR
XTNHDSN  EQU   XTNTHDR+8
XTNHVOLN EQU   XTNTHDR+52
XTNHVOL  EQU   XTNTHDR+53
XTNHPWD  EQU   XTNTHDR+60
XTNHCHR1 EQU   XTNTHDR+68
XTNHCHR2 EQU   XTNTHDR+76
XTNHMODE EQU   XTNTHDR+84
XTNTENT  EQU   XTNTTBL+88
XTNTDDN  EQU   XTNTENT
XTNTDSN  EQU   XTNTENT+8
XTNTVOLN EQU   XTNTENT+52
XTNTVOL  EQU   XTNTENT+53
XTNTCHR1 EQU   XTNTENT+62
XTNTCHR2 EQU   XTNTENT+70
SPLIST   EQU   0
SPQNAME  EQU   SPLIST
SPRNAME  EQU   SPLIST+8
SPRLEN   EQU   SPRNAME
SPRVOL   EQU   SPRNAME+1
RWFR     EQU   0
RWFRCNT  EQU   RWFR+16
LOCTAB   EQU   0
LOCADDR  EQU   LOCTAB
LOCRCNT  EQU   LOCTAB+4
LOCRCKD  EQU   LOCTAB+6
LOCKLEN  EQU   LOCTAB+17
LOCDLEN  EQU   LOCTAB+18
RIOAREA  EQU   0
RIOHDR   EQU   RIOAREA
RFIRST   EQU   RIOHDR
RPREV    EQU   RIOHDR+2
RPREVCC  EQU   RPREV
RPREVHH  EQU   RPREV+2
RNUMREC  EQU   RIOHDR+8
RKEY     EQU   0
RKEYCHR  EQU   RKEY+6
RKEYFLG  EQU   RKEY+11
RBUF     EQU   0
RBUFCNT  EQU   RBUF
RBCCHHR  EQU   RBUFCNT
WIOAREA  EQU   0
WBUF     EQU   0
WBUFCNT  EQU   WBUF
WBCCHHR  EQU   WBUFCNT
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS28 EQU   0
DCBOPTCD EQU   IHADCS28
DCBOPTZ  EQU   DCBOPTCD
IHADCS44 EQU   0
LINKAGES EQU   0
BACKCHAN EQU   LINKAGES+4
FORCHAIN EQU   LINKAGES+8
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXODDN   EQU   EXOARG+8
EXODSN   EQU   EXOARG+12
EXOUCB   EQU   EXOARG+20
EXOEXT   EQU   EXOARG+24
EXOCTLBK EQU   EXOARG+28
EXOPT    EQU   EXOARG+32
EXOREP   EQU   EXOPT
EXFLG    EQU   EXOARG+33
EXOREAD  EQU   EXFLG
EXORVS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORDS   EQU   EXFLG
EXORVT   EQU   EXFLG
EXOVTH   EQU   EXFLG
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00131 EQU   SV82LIST+4
SV82DCBP EQU   @NM00131
@NM00132 EQU   SV82LIST+12
SV82WRKP EQU   @NM00132
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBINFLG EQU   ACBCOMN+50
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
IDAAMBL  EQU   0
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLSHAR EQU   IDAAMBL+33
AMBLFLG1 EQU   IDAAMBL+35
AMBLFLG2 EQU   IDAAMBL+36
AMBLDTA  EQU   IDAAMBL+52
AMBLIX   EQU   IDAAMBL+56
IDAAMB   EQU   0
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBFLG1  EQU   IDAAMB+25
AMBDSORG EQU   IDAAMB+26
AMBIOBAD EQU   IDAAMB+28
AMBINFL  EQU   IDAAMB+42
AMBDEBPT EQU   IDAAMB+44
AMBDEBAD EQU   AMBDEBPT+1
AMBOFLGS EQU   IDAAMB+48
AMBFLG2  EQU   IDAAMB+49
AMBEOVPT EQU   IDAAMB+56
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBNMEXT EQU   DEBUSRPG
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBAPPAD EQU   DEBBASIC+28
DEBEXSCL EQU   DEBAPPAD
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBSTRCC EQU   DEBDASD+6
DEBSTRHH EQU   DEBDASD+8
DEBENDCC EQU   DEBDASD+10
DEBENDHH EQU   DEBDASD+12
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
IECSDSF1 EQU   0
IECSDSL1 EQU   0
DS1DSORG EQU   IECSDSL1+82
DS1RECFM EQU   IECSDSL1+84
DS1LRECL EQU   IECSDSL1+88
IECSDSF3 EQU   0
IECSDSL3 EQU   0
IECSDSF4 EQU   0
IECSDSL4 EQU   0
DS4DEVCT EQU   IECSDSL4+18
DS4DEVOV EQU   DS4DEVCT+6
DS4AMCAT EQU   IECSDSL4+40
DS4VSIND EQU   DS4AMCAT
DS4VTOCE EQU   IECSDSL4+61
SINFAREA EQU   0
INFOSCAN EQU   0
INFSCNID EQU   INFOSCAN
INFSCNLN EQU   INFOSCAN+2
DSCBAREA EQU   0
KEYPTR   EQU   0
KEYLENS  EQU   0
DATPTR   EQU   0
DATALENS EQU   0
ALLA     EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CDATLPTR EQU   0
CHARA    EQU   0
CKEYLPTR EQU   0
CLEN     EQU   0
CLENCNT  EQU   0
DATALPTR EQU   0
DBDATPTR EQU   0
DBKEYPTR EQU   0
DBLOC    EQU   0
DBLST    EQU   0
DBLSTCNT EQU   0
DBRNG    EQU   0
DKEYLPTR EQU   0
DLENG    EQU   0
DLENGCNT EQU   0
DMPTRM   EQU   0
DRRNG    EQU   0
DUMP     EQU   0
ERROR    EQU   0
FREC     EQU   0
FULLR    EQU   0
HEXA     EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IDONL    EQU   0
LISTTEST EQU   0
MIRK     EQU   0
MIRNG    EQU   0
MNDAT    EQU   0
MNKEY    EQU   0
MORK     EQU   0
MOVFL    EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
REPTBL   EQU   0
REPCB    EQU   REPTBL
REPIDSOP EQU   REPCB+24
REPODSOP EQU   REPCB+28
REPSPRIT EQU   REPCB+40
REPIBFPT EQU   REPCB+44
REPOBFPT EQU   REPCB+48
REPIXTN2 EQU   REPCB+76
REPIXTNT EQU   REPCB+80
REPOXTN2 EQU   REPCB+84
REPOXTNT EQU   REPCB+88
REPIINFO EQU   REPCB+92
REPOINFO EQU   REPCB+96
REPRWHAR EQU   REPCB+100
REPRWINA EQU   REPCB+104
REPISYSI EQU   REPCB+108
REPOSYSI EQU   REPCB+112
REPIDEVA EQU   REPCB+124
REPODEVA EQU   REPCB+128
REPQRPTR EQU   REPCB+132
REPALLAG EQU   REPCB+136
REPEXOAR EQU   REPCB+140
REPOPAGL EQU   REPCB+144
REPCDSOP EQU   REPCB+152
REPCBEXT EQU   REPTBL+156
REPSRPR  EQU   REPCBEXT+4
I        EQU   REPCBEXT+12
J        EQU   REPCBEXT+13
K        EQU   REPCBEXT+14
CKREQ    EQU   REPCBEXT+16
CKRERN   EQU   CKREQ
CKRMVAR  EQU   CKREQ+4
WFAREA   EQU   REPCBEXT+76
WFREQ    EQU   WFAREA+12
WFRTYP   EQU   WFREQ
WFROPT   EQU   WFREQ+1
REPENQSW EQU   REPCBEXT+90
IOPARM   EQU   0
TOCHRVAL EQU   0
ARGLST   EQU   0
RWDEF    EQU   RWFHDR
RWFRDE   EQU   RWFR
EXTNTVAL EQU   DEBEXSCL
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
RDSPKLDL EQU   RDSPKL
*                                      START UNREFERENCED COMPONENTS
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
@NM00066 EQU   RWFRDE+15
RWFROV   EQU   RWFRDE+14
RWFRF2   EQU   RWFRDE+12
RWFRF1   EQU   RWFRDE+11
@NM00065 EQU   RWFRDE
RWFHKLN  EQU   RWDEF+92
RWFHDLN  EQU   RWDEF+90
RWFHFT   EQU   RWDEF+89
@NM00045 EQU   RWDEF
@NM00044 EQU   WFROPT
WFRUP    EQU   WFROPT
WFRIN    EQU   WFROPT
@NM00043 EQU   WFRTYP
WFRPOS   EQU   WFRTYP
WFRUPD   EQU   WFRTYP
WFRGET   EQU   WFRTYP
WFRLD    EQU   WFRTYP
WFRADD   EQU   WFRTYP
WFIOKYA  EQU   WFAREA+8
WFIODLN  EQU   WFAREA+4
WFIODAD  EQU   WFAREA
@NM00042 EQU   REPCBEXT+75
WFIOGUK  EQU   REPCBEXT+64
RDCATRC  EQU   REPCBEXT+60
@NM00041 EQU   CKREQ+2
@NM00040 EQU   REPCBEXT+15
REPRCDCT EQU   REPCBEXT+8
REPRC    EQU   REPCBEXT+6
@NM00039 EQU   REPSRPR+1
@NM00038 EQU   REPSRPR
REPSRPRT EQU   REPSRPR
REPR1LN  EQU   REPCBEXT+2
REPR0LN  EQU   REPCBEXT
REPCPPTR EQU   REPCB+148
REPOLCPT EQU   REPCB+120
REPILCPT EQU   REPCB+116
REPOUTCL EQU   REPCB+72
REPINCL  EQU   REPCB+68
REPRWHDO EQU   REPCB+64
REPRWHDI EQU   REPCB+60
REPBUFF1 EQU   REPCB+56
REPBUFF0 EQU   REPCB+52
REPODSAR EQU   REPCB+36
REPIDSAR EQU   REPCB+32
REPORWIO EQU   REPCB+20
REPIRWIO EQU   REPCB+16
REPARFIO EQU   REPCB+12
REPRESER EQU   REPCB
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
DSCBID   EQU   DSCBAREA+44
@NM00201 EQU   DSCBAREA
INFSCNAR EQU   INFOSCAN+4
DS4END   EQU   IECSDSL4+96
@NM00195 EQU   IECSDSL4+71
DS4F6PTR EQU   IECSDSL4+56
@NM00194 EQU   IECSDSL4+51
DS4R2TIM EQU   IECSDSL4+43
DS4VSCRA EQU   DS4AMCAT+1
@NM00193 EQU   DS4VSIND
DS4VSBAD EQU   DS4VSIND
DS4VSREF EQU   DS4VSIND
DS4AMTIM EQU   IECSDSL4+32
DS4DEVDB EQU   DS4DEVCT+13
DS4DEVDT EQU   DS4DEVCT+12
DS4DEVTL EQU   DS4DEVCT+10
DS4DEVFG EQU   DS4DEVCT+9
DS4DEVK  EQU   DS4DEVCT+8
DS4DEVL  EQU   DS4DEVOV+1
DS4DEVI  EQU   DS4DEVOV
DS4DEVTK EQU   DS4DEVCT+4
DS4DEVSZ EQU   DS4DEVCT
@NM00192 EQU   IECSDSL4+16
DS4NOEXT EQU   IECSDSL4+15
DS4VTOCI EQU   IECSDSL4+14
DS4NOATK EQU   IECSDSL4+12
DS4HCCHH EQU   IECSDSL4+8
DS4DSREC EQU   IECSDSL4+6
DS4HPCHR EQU   IECSDSL4+1
DS4IDFMT EQU   IECSDSL4
@NM00191 EQU   IECSDSF4
DS3END   EQU   IECSDSL3+140
DS3PTRDS EQU   IECSDSL3+135
DS3ADEXT EQU   IECSDSL3+45
DS3FMTID EQU   IECSDSL3+44
DS3EXTNT EQU   IECSDSL3+4
@NM00190 EQU   IECSDSL3
@NM00189 EQU   IECSDSF3
DS1END   EQU   IECSDSL1+140
DS1PTRDS EQU   IECSDSL1+135
DS1EXT3  EQU   IECSDSL1+125
DS1EXT2  EQU   IECSDSL1+115
DS1EXT1  EQU   IECSDSL1+105
@NM00188 EQU   IECSDSL1+103
DS1TRBAL EQU   IECSDSL1+101
DS1LSTAR EQU   IECSDSL1+98
DS1SCALO EQU   IECSDSL1+94
DS1DSIND EQU   IECSDSL1+93
DS1RKP   EQU   IECSDSL1+91
DS1KEYL  EQU   IECSDSL1+90
DS1BLKL  EQU   IECSDSL1+86
DS1OPTCD EQU   IECSDSL1+85
@NM00187 EQU   IECSDSL1+75
DS1SYSCD EQU   IECSDSL1+62
@NM00186 EQU   IECSDSL1+61
DS1NOBDB EQU   IECSDSL1+60
DS1NOEPV EQU   IECSDSL1+59
DS1EXPDT EQU   IECSDSL1+56
DS1CREDT EQU   IECSDSL1+53
DS1VOLSQ EQU   IECSDSL1+51
DS1DSSN  EQU   IECSDSL1+45
DS1FMTID EQU   IECSDSL1+44
DS1DSNAM EQU   IECSDSL1
@NM00185 EQU   IECSDSF1
DEBXRV40 EQU   DEBXTN+28
DEBXOPNJ EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXDSSI EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCEAD EQU   DEBXCEA+1
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCEAD  EQU   DEBCEA+1
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCIAD EQU   DEBPCIA+1
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIOAD EQU   DEBSIOA+1
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOEAD EQU   DEBEOEA+1
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBRSV19 EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00184 EQU   DEBACS08+12
@NM00183 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00182 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00181 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBLRECL EQU   DEBACSMD+14
DEBBLKSI EQU   DEBACSMD+12
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBNMTRK EQU   DEBDASD+14
DEBBINUM EQU   DEBDASD+4
DEBUCBA  EQU   DEBUCBAD+1
DEBDVMOD EQU   DEBUCBAD
DEBAPPB  EQU   DEBAPPAD+1
DEBDCBB  EQU   DEBDCBAD+1
DEBDEBID EQU   DEBPROTG
DEBECBB  EQU   DEBECBAD+1
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBCPA   EQU   IDAAMB+92
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00180 EQU   AMBCSWD1+1
@NM00179 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
AMBLSR   EQU   AMBAFLG
@NM00178 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
AMBPAMBL EQU   IDAAMB+76
AMBPIXP  EQU   IDAAMB+72
@NM00177 EQU   IDAAMB+68
AMBIWA   EQU   IDAAMB+64
AMBWKA   EQU   IDAAMB+60
AMBAMBXN EQU   AMBEOVPT
AMBEDB   EQU   IDAAMB+52
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
AMBEXFG  EQU   AMBOFLGS
@NM00176 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00175 EQU   AMBOFLGS
AMBIFLGS EQU   AMBDEBPT
AMBAMETH EQU   IDAAMB+43
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00174 EQU   AMBINFL
@NM00173 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00172 EQU   IDAAMB+38
AMBDDSN  EQU   IDAAMB+35
AMBCDSN  EQU   IDAAMB+32
AMBIOMB  EQU   AMBIOBAD
@NM00171 EQU   AMBDSORG+1
AMBDORGA EQU   AMBDSORG+1
@NM00170 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBTYPE  EQU   AMBFLG1
AMBCREAT EQU   AMBFLG1
@NM00169 EQU   AMBFLG0
AMBPSDS  EQU   AMBFLG0
AMBCACB  EQU   IDAAMB+16
AMBPH    EQU   IDAAMB+12
AMBBUFC  EQU   IDAAMB+8
AMBLINK  EQU   IDAAMB+4
AMBLEN   EQU   IDAAMB+2
AMBRSC   EQU   IDAAMB+1
AMBID    EQU   IDAAMB
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00168 EQU   IDAAMBL+40
AMBLNUM  EQU   IDAAMBL+38
AMBLNST  EQU   IDAAMBL+37
@NM00167 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00166 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLCAT  EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLVVIC EQU   AMBLFLG1
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
AMBLLEN  EQU   IDAAMBL+34
@NM00165 EQU   AMBLSHAR
AMBLWRIT EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
AMBLID   EQU   IDAAMBL+32
@NM00164 EQU   IDAAMBL+31
@NM00163 EQU   AMBLTYPE
AMBLFIX  EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00162 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLACB  EQU   IDAAMBL+8
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBUAPTR EQU   ACBCOMN+64
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00161 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBVVIC  EQU   ACBINFLG
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBCAT   EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00160 EQU   ACBINFLG
ACBERFLG EQU   ACBCOMN+49
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00159 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBOPEN  EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00158 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00157 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00156 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00155 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00154 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00153 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00152 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00151 EQU   IDAAMDSB+41
@NM00150 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDCINV  EQU   IDAAMDSB+20
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDKEYLN EQU   IDAAMDSB+8
AMDRKP   EQU   IDAAMDSB+6
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00149 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00148 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00147 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00146 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00145 EQU   VSDSCR+5
@NM00144 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00143 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00142 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00141 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00140 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00139 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00138 EQU   VSDVTOC
@NM00137 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00136 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00135 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00134 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00133 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00130 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00129 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00128 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00127 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00126 EQU   RCTAGL+10
@NM00125 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00124 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00123 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00122 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00121 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00120 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00119 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00118 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00117 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00116 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00115 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00114 EQU   EXSPACE+8
@NM00113 EQU   EXSPACE+6
@NM00112 EQU   EXSPACE+4
@NM00111 EQU   EXSPACE+1
@NM00110 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00109 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00108 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00107 EQU   EXFLG
@NM00106 EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOVSN   EQU   EXOARG+16
EXOHEAD  EQU   EXOARG
@NM00105 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00104 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00103 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00102 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00101 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00100 EQU   CMMSG+7
@NM00099 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00098 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00097 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
IDBYTES  EQU   LINKAGES
@NM00088 EQU   IHADCS44+10
DCBXENDA EQU   IHADCS44+8
DCBCENDA EQU   IHADCS44+6
DCBSIOA  EQU   IHADCS44+4
DCBPCIA  EQU   IHADCS44+2
DCBEOEA  EQU   IHADCS44
@NM00087 EQU   IHADCS28+1
@NM00086 EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
@NM00085 EQU   DCBOPTCD
DCBDEBA  EQU   DCBDEBAD+1
@NM00084 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00083 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00082 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00081 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00080 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00079 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00078 EQU   DCBDSRG1
@NM00077 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00076 EQU   IHADCS01+5
@NM00075 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00074 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00073 EQU   IHADCB
WKEYDAT  EQU   WBUF+8
WBDL     EQU   WBUFCNT+6
WBKL     EQU   WBUFCNT+5
WBREC    EQU   WBCCHHR+4
WBHH     EQU   WBCCHHR+2
WBCC     EQU   WBCCHHR
WBUFF    EQU   WIOAREA+4
WNUMREC  EQU   WIOAREA
RKEYDAT  EQU   RBUF+8
RBDL     EQU   RBUFCNT+6
RBKL     EQU   RBUFCNT+5
RBREC    EQU   RBCCHHR+4
RBHH     EQU   RBCCHHR+2
RBCC     EQU   RBCCHHR
@NM00072 EQU   RKEYFLG+4
RKEYFLG3 EQU   RKEYFLG+3
RKEYFLG2 EQU   RKEYFLG+1
RKEYFLG1 EQU   RKEYFLG
RKEYR    EQU   RKEYCHR+4
RKEYHH   EQU   RKEYCHR+2
RKEYCC   EQU   RKEYCHR
RKEYVOL  EQU   RKEY
RBUFF    EQU   RIOAREA+282
@NM00071 EQU   RIOHDR+26
@NM00070 EQU   RIOHDR+10
@NM00069 EQU   RIOHDR+7
RPREVR   EQU   RPREV+4
@NM00068 EQU   RIOHDR+1
@NM00067 EQU   LOCTAB+16
LOCCNTFD EQU   LOCTAB+8
RWFRKD   EQU   RWFR+24
RWFRDLN  EQU   RWFRCNT+6
RWFRKLN  EQU   RWFRCNT+5
RWFRR    EQU   RWFRCNT+4
RWFRHH   EQU   RWFRCNT+2
RWFRCC   EQU   RWFRCNT
RWFRFLG  EQU   RWFR+11
RWFRKEY  EQU   RWFR
@NM00064 EQU   XTNTENT+75
XTNTR2   EQU   XTNTCHR2+4
XTNTHH2  EQU   XTNTCHR2+2
XTNTCC2  EQU   XTNTCHR2
@NM00063 EQU   XTNTENT+67
XTNTR1   EQU   XTNTCHR1+4
XTNTHH1  EQU   XTNTCHR1+2
XTNTCC1  EQU   XTNTCHR1
@NM00062 EQU   XTNTENT+59
@NM00061 EQU   XTNTHDR+85
@NM00060 EQU   XTNTHDR+81
XTNHR2   EQU   XTNHCHR2+4
XTNHHH2  EQU   XTNHCHR2+2
XTNHCC2  EQU   XTNHCHR2
@NM00059 EQU   XTNTHDR+73
XTNHR1   EQU   XTNHCHR1+4
XTNHHH1  EQU   XTNHCHR1+2
XTNHCC1  EQU   XTNHCHR1
@NM00058 EQU   XTNTHDR+59
XTN2DSN  EQU   XTN2ENT
DEVWORD5 EQU   DEVAREA+20
@NM00057 EQU   DEV4B1+1
@NM00056 EQU   DEV4B1
INF4FLG  EQU   DEV4B1
@NM00055 EQU   DEV4B1
DEVKC    EQU   DEVWORD4
DEVBOH2  EQU   DEVBOH+1
DEVBOH1  EQU   DEVBOH
DEVMAXBK EQU   DEVAREA+4
DEVTBYT4 EQU   DEVDEVTP+3
DEVTBYT3 EQU   DEVDEVTP+2
@NM00053 EQU   DEVTBYT2
@NM00052 EQU   DEVTBYT2
DEVTBYT1 EQU   DEVDEVTP
INFVOLLN EQU   INFOVOL+2
INFVOLID EQU   INFOVOL
INFDSNLN EQU   INFODSN+2
RDFUNC   EQU   RDARG+46
@NM00051 EQU   RDSPACE+8
@NM00050 EQU   RDSPACE+6
@NM00049 EQU   RDSPACE+4
@NM00048 EQU   RDSPACE+1
@NM00047 EQU   RDSPACE
RDCTLBK  EQU   RDARG+8
RDRES    EQU   RDARG
@NM00046 EQU   RWHDRINF+1
RWFKCHR2 EQU   RWFKEY2+6
RWFKVOL2 EQU   RWFKEY2
RWFKCHR1 EQU   RWFKEY1+6
RWFKVOL1 EQU   RWFKEY1
RWFVOL   EQU   RWFINFO+52
RWFDSN   EQU   RWFINFO+8
RWFDDN   EQU   RWFINFO
SRCCHHRP EQU   SRPRTARG+40
SRRECPTR EQU   SRPRTARG+36
SRSPRECL EQU   SRPRTARG+32
SRDSNPTR EQU   SRPRTARG+28
SRERCODE EQU   SRPRTARG+24
SRRWFKEY EQU   SRPRTARG+20
SRRWFDSN EQU   SRPRTARG+16
SRVOLPTR EQU   SRPRTARG+12
SRDSNHDR EQU   SRPRTARG+8
SRVREPTR EQU   SRPRTARG+4
SRVRECL  EQU   SRPRTARG
RWFHFM   EQU   RWFHDR+99
RWFHDSNR EQU   RWFHDR+11
RWFHKEY  EQU   RWFHDR
MODVOLEN EQU   MODVO+20
MODVOMEM EQU   MODVO+12
MODVOMLN EQU   MODVO+11
MODVOFUQ EQU   MODVOFLG
MODVOPOS EQU   MODVO+9
MODVOPAS EQU   MODVO+1
MODVOPLN EQU   MODVO
MORCHVAL EQU   MORCH+1
MORCHLEN EQU   MORCH
MORVOVAL EQU   MORVO+21
MORVOLEN EQU   MORVO+20
MORVOMEM EQU   MORVO+12
MORVOMLN EQU   MORVO+11
MORVOFUQ EQU   MORVOFLG
MORVOPOS EQU   MORVO+9
MORVOPAS EQU   MORVO+1
MORVOPLN EQU   MORVO
MNKSTVAL EQU   MNKST+1
MNKSTLEN EQU   MNKST
MNKOFVAL EQU   MNKOF
MNDSTVAL EQU   MNDST+1
MNDSTLEN EQU   MNDST
MNDOFVAL EQU   MNDOF
MRRHHVAL EQU   MRRHH+1
MRRHHLEN EQU   MRRHH
MRRCHVAL EQU   MRRCH+1
MRRCHLEN EQU   MRRCH
MRRVOVAL EQU   MRRVO+21
MRRVOLEN EQU   MRRVO+20
MRRVOMEM EQU   MRRVO+12
MRRVOMLN EQU   MRRVO+11
MRRVOFUQ EQU   MRRVOFLG
MRRVOPOS EQU   MRRVO+9
MRRVOPAS EQU   MRRVO+1
MRRVOPLN EQU   MRRVO
MIDVOLEN EQU   MIDVO+20
MIDVOMEM EQU   MIDVO+12
MIDVOMLN EQU   MIDVO+11
MIDVOFUQ EQU   MIDVOFLG
MIDVOPOS EQU   MIDVO+9
MIDVOPAS EQU   MIDVO+1
MIDVOPLN EQU   MIDVO
MIRCHVAL EQU   MIRCH+1
MIRCHLEN EQU   MIRCH
MIRVOVAL EQU   MIRVO+21
MIRVOLEN EQU   MIRVO+20
MIRVOMEM EQU   MIRVO+12
MIRVOMLN EQU   MIRVO+11
MIRVOFUQ EQU   MIRVOFLG
MIRVOPOS EQU   MIRVO+9
MIRVOPAS EQU   MIRVO+1
MIRVOPLN EQU   MIRVO
MVTCSLEN EQU   MVTCS+20
MVTCSMEM EQU   MVTCS+12
MVTCSMLN EQU   MVTCS+11
MVTCSFUQ EQU   MVTCSFLG
MVTCSPOS EQU   MVTCS+9
MVTCSPAS EQU   MVTCS+1
MVTCSPLN EQU   MVTCS
MODSLEN  EQU   MODS+20
MODSMEM  EQU   MODS+12
MODSMLN  EQU   MODS+11
MODSFUQ  EQU   MODSFLG
MODSPOS  EQU   MODS+9
MODSPLN  EQU   MODS
MOUTFLEN EQU   MOUTF+9
MOUTFPLN EQU   MOUTF
MINDSLEN EQU   MINDS+20
MINDSMEM EQU   MINDS+12
MINDSMLN EQU   MINDS+11
MINDSFUQ EQU   MINDSFLG
MINDSPOS EQU   MINDS+9
MINDSPLN EQU   MINDS
MINFLLEN EQU   MINFL+9
MINFLPLN EQU   MINFL
MNCNTVAL EQU   MNCNT+1
MNCNTLEN EQU   MNCNT
DBDATVAL EQU   DBDAT
DBKEYVAL EQU   DBKEY
DBHHHVAL EQU   DBHHH+1
DBHHHLEN EQU   DBHHH
DBCCHVAL EQU   DBCCH+1
DBCCHLEN EQU   DBCCH
DBVOLVAL EQU   DBVOL+21
DBVOLLEN EQU   DBVOL+20
DBVOLMEM EQU   DBVOL+12
DBVOLMLN EQU   DBVOL+11
DBVOLFUQ EQU   DBVOLFLG
DBVOLPOS EQU   DBVOL+9
DBVOLPAS EQU   DBVOL+1
DBVOLPLN EQU   DBVOL
DBDSVAL  EQU   DBDS+21
DBDSLEN  EQU   DBDS+20
DBDSMEM  EQU   DBDS+12
DBDSMLN  EQU   DBDS+11
DBDSFUQ  EQU   DBDSFLG
DBDSPOS  EQU   DBDS+9
DBDSPAS  EQU   DBDS+1
DBDSPLN  EQU   DBDS
DBFILVAL EQU   DBFIL+10
DBFILLEN EQU   DBFIL+9
DBFILPAS EQU   DBFIL+1
DBFILPLN EQU   DBFIL
CVTCSLEN EQU   CVTCS+20
CVTCSMEM EQU   CVTCS+12
CVTCSMLN EQU   CVTCS+11
CVTCSFUQ EQU   CVTCSFLG
CVTCSPOS EQU   CVTCS+9
CVTCSPAS EQU   CVTCS+1
CVTCSPLN EQU   CVTCS
CDATLVAL EQU   CDATL
CKEYLVAL EQU   CKEYL
CVOLSLEN EQU   CVOLS+20
CVOLSMEM EQU   CVOLS+12
CVOLSMLN EQU   CVOLS+11
CVOLSFUQ EQU   CVOLSFLG
CVOLSPOS EQU   CVOLS+9
CVOLSPAS EQU   CVOLS+1
CVOLSPLN EQU   CVOLS
CVOLDLEN EQU   CVOLD+20
CVOLDMEM EQU   CVOLD+12
CVOLDMLN EQU   CVOLD+11
CVOLDFUQ EQU   CVOLDFLG
CVOLDPOS EQU   CVOLD+9
CVOLDPAS EQU   CVOLD+1
CVOLDPLN EQU   CVOLD
CCATLVAL EQU   CCATL+21
CCATLLEN EQU   CCATL+20
CCATLMEM EQU   CCATL+12
CCATLMLN EQU   CCATL+11
CCATLFUQ EQU   CCATLFLG
CCATLPOS EQU   CCATL+9
CCATLPAS EQU   CCATL+1
CCATLPLN EQU   CCATL
COFILVAL EQU   COFIL+10
COFILLEN EQU   COFIL+9
COFILPAS EQU   COFIL+1
COFILPLN EQU   COFIL
CINDSLEN EQU   CINDS+20
CINDSMEM EQU   CINDS+12
CINDSMLN EQU   CINDS+11
CINDSFUQ EQU   CINDSFLG
CINDSPOS EQU   CINDS+9
CINDSPLN EQU   CINDS
CINFLLEN EQU   CINFL+9
CINFLPLN EQU   CINFL
DVTCSLEN EQU   DVTCS+20
DVTCSMEM EQU   DVTCS+12
DVTCSMLN EQU   DVTCS+11
DVTCSFUQ EQU   DVTCSFLG
DVTCSPOS EQU   DVTCS+9
DVTCSPAS EQU   DVTCS+1
DVTCSPLN EQU   DVTCS
DATALVAL EQU   DATAL
DKEYLVAL EQU   DKEYL
RRCHHVAL EQU   RRCHH+1
RRCHHLEN EQU   RRCHH
RRCHRVAL EQU   RRCHR+1
RRCHRLEN EQU   RRCHR
VOLRRVAL EQU   VOLRR+21
VOLRRLEN EQU   VOLRR+20
VOLRRMEM EQU   VOLRR+12
VOLRRMLN EQU   VOLRR+11
VOLRRFUQ EQU   VOLRRFLG
VOLRRPOS EQU   VOLRR+9
VOLRRPAS EQU   VOLRR+1
VOLRRPLN EQU   VOLRR
VOLDSLEN EQU   VOLDS+20
VOLDSMEM EQU   VOLDS+12
VOLDSMLN EQU   VOLDS+11
VOLDSFUQ EQU   VOLDSFLG
VOLDSPOS EQU   VOLDS+9
VOLDSPAS EQU   VOLDS+1
VOLDSPLN EQU   VOLDS
VOLSRLEN EQU   VOLSR+20
VOLSRMEM EQU   VOLSR+12
VOLSRMLN EQU   VOLSR+11
VOLSRFUQ EQU   VOLSRFLG
VOLSRPOS EQU   VOLSR+9
VOLSRPAS EQU   VOLSR+1
VOLSRPLN EQU   VOLSR
DOTDSVAL EQU   DOTDS+21
DOTDSLEN EQU   DOTDS+20
DOTDSMEM EQU   DOTDS+12
DOTDSMLN EQU   DOTDS+11
DOTDSFUQ EQU   DOTDSFLG
DOTDSPOS EQU   DOTDS+9
DOTDSPAS EQU   DOTDS+1
DOTDSPLN EQU   DOTDS
DOUTFVAL EQU   DOUTF+10
DOUTFLEN EQU   DOUTF+9
DOUTFPAS EQU   DOUTF+1
DOUTFPLN EQU   DOUTF
INDSLEN  EQU   INDS+20
INDSMEM  EQU   INDS+12
INDSMLN  EQU   INDS+11
INDSFUQ  EQU   INDSFLG
INDSPOS  EQU   INDS+9
INDSPLN  EQU   INDS
INFILLEN EQU   INFIL+9
INFILPLN EQU   INFIL
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RF00543 EQU   @RC00518
@RC01752 EQU   @RC01748
@RF01907 EQU   @RC01903
@RC01925 EQU   @RC01923
@RF01944 EQU   @RC01923
@RF01959 EQU   @RC01954
@RF01971 EQU   @RC01968
@RC01981 EQU   @RC01980
@PB00006 EQU   @EL00001
@RC01926 EQU   @RC01925
@PB00004 EQU   @PB00006
@PB00002 EQU   @PB00004
@ENDDATA EQU   *
         END   IDCRD07,(C'PLS1223',0603,77300)

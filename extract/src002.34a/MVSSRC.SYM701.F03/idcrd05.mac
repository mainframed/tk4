         TITLE 'IDCRD05: MODIFY REPAIRV FUNCTION                       *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRD05  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRD05   76.328'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@11                                    0002
         USING @PSTART+12285,@12                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @06,@01                                             0002
         USING @DATD,@06                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @06,8(,@13)                                         0002
         LR    @13,@06                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0447
*        /************************************************************/
*        /* SET TRACE AND DUMP POINT                                 */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0448
*          THEN;                                                   0448
         L     @15,@PC00001                                        0448
         L     @15,GDTDBG(,@15)                                    0448
         LTR   @15,@15                                             0448
         BZ    @RT00448                                            0448
*          ELSE                                                    0450
*            CALL IDCDB010 (GDTTBL,'RD50');                        0450
         L     @15,@PC00001                                        0450
         ST    @15,@AL00001                                        0450
         LA    @15,@CC02060                                        0450
         ST    @15,@AL00001+4                                      0450
         MVI   @AL00001+4,X'80'                                    0450
         L     @14,@PC00001                                        0450
         L     @15,GDTDBG(,@14)                                    0450
         LA    @01,@AL00001                                        0450
         BALR  @14,@15                                             0450
*        OLDERID2 = NEWERID2;                                      0451
@RT00448 L     @15,@PC00001                                        0451
         L     @01,GDTTR2(,@15)                                    0451
         L     @15,@PC00001                                        0451
         L     @15,GDTTR2(,@15)                                    0451
         MVC   @TS00001(95),NEWERID2(@15)                          0451
         MVC   OLDERID2(95,@01),@TS00001                           0451
*        NEWID2 = 'RD51';                                          0452
*                                                                  0452
         L     @15,@PC00001                                        0452
         L     @01,GDTTR2(,@15)                                    0452
         MVC   NEWID2(4,@01),@CC02061                              0452
*        /************************************************************/
*        /* CALL MODIFY ROUTINE                                      */
*        /************************************************************/
*        CALL IDCRD050;                                            0453
*                                                                  0453
         BAL   @14,IDCRD050                                        0453
*        /************************************************************/
*        /* SAVE RETURN CODE FROM MODIFY ROUTINE                     */
*        /************************************************************/
*        RESPECIFY RTNREG RSTD;                                    0454
*        TESTRC = RTNREG;                                          0455
         STH   RTNREG,TESTRC                                       0455
*        RESPECIFY RTNREG UNRSTD;                                  0456
*                                                                  0456
*        /************************************************************/
*        /* SET MODIFY RETURN CODE IN LASTCC                         */
*        /************************************************************/
*        LASTCC = TESTRC;                                          0457
*                                                                  0457
         LH    @15,TESTRC                                          0457
         STH   @15,LASTCC                                          0457
*        /************************************************************/
*        /* ISSUE RECORDS PROCESSED MESSAGE                          */
*        /************************************************************/
*        IF ADDR(MIRNG) ^= NULLPTR                                 0458
*          THEN                                                    0458
*                                                                  0458
         L     @15,@PC00001+4                                      0458
         L     @15,FDTPTR+388(,@15)                                0458
         LTR   @15,@15                                             0458
         BZ    @RF00458                                            0458
*            /********************************************************/
*            /*                                                      */
*            /* PRINT THE NUMBER OF RECORDS MODIFIED FROM            */
*            /* INREPAIRRANGE                                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0459
*             DO;                                                  0459
*               CKREQ = CKREQ && CKREQ;                            0460
         L     @15,@PC00001+8                                      0460
         XC    CKREQ(44,@15),CKREQ(@15)                            0460
*               CKRERN = MSG92;                                    0461
         L     @15,@PC00001+8                                      0461
         MVC   CKRERN(2,@15),@CH00865                              0461
*               CKRMVAR(1) = ADDR(REPRCDCT);                       0462
         L     @15,@PC00001+8                                      0462
         L     @14,@PC00001+8                                      0462
         LA    @14,REPRCDCT(,@14)                                  0462
         ST    @14,CKRMVAR(,@15)                                   0462
*               CALL IDCRDER;                                      0463
         L     @15,@CV01811                                        0463
         BALR  @14,@15                                             0463
*             END;                                                 0464
*                                                                  0464
*          ELSE                                                    0465
*                                                                  0465
*            /********************************************************/
*            /*                                                      */
*            /* IF LASTCC = 0, THEN ONE RECORD WAS PROCESSED,        */
*            /* OTHERWISE NO RECORDS WERE PROCESSED                  */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0465
         B     @RC00458                                            0465
@RF00458 DS    0H                                                  0466
*            IF LASTCC = 0                                         0466
*              THEN                                                0466
         LH    @15,LASTCC                                          0466
         LTR   @15,@15                                             0466
         BNZ   @RF00466                                            0466
*                REPRCDCT = 1;                                     0467
         L     @15,@PC00001+8                                      0467
         MVC   REPRCDCT(4,@15),@CF00221                            0467
*              ELSE                                                0468
*                REPRCDCT = 0;                                     0468
*                                                                  0468
         B     @RC00466                                            0468
@RF00466 L     @15,@PC00001+8                                      0468
         SLR   @14,@14                                             0468
         ST    @14,REPRCDCT(,@15)                                  0468
*             DO;                                                  0469
@RC00466 DS    0H                                                  0470
*               CKREQ = CKREQ && CKREQ;                            0470
         L     @15,@PC00001+8                                      0470
         XC    CKREQ(44,@15),CKREQ(@15)                            0470
*               CKRERN = MSG92;                                    0471
         L     @15,@PC00001+8                                      0471
         MVC   CKRERN(2,@15),@CH00865                              0471
*               CKRMVAR(1) = ADDR(REPRCDCT);                       0472
         L     @15,@PC00001+8                                      0472
         L     @14,@PC00001+8                                      0472
         LA    @14,REPRCDCT(,@14)                                  0472
         ST    @14,CKRMVAR(,@15)                                   0472
*               CALL IDCRDER;                                      0473
         L     @15,@CV01811                                        0473
         BALR  @14,@15                                             0473
*             END;                                                 0474
*            END;                                                  0475
*                                                                  0475
*        /************************************************************/
*        /* ISSUE UEPIL TO FREE STORAGE AND RETURN TO IDCRD01        */
*        /************************************************************/
*         CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                      0476
@RC00458 L     @15,@PC00001                                        0476
         ST    @15,@AL00001                                        0476
         LA    @15,MODID                                           0476
         ST    @15,@AL00001+4                                      0476
         LA    @15,LASTCC                                          0476
         ST    @15,@AL00001+8                                      0476
         MVI   @AL00001+8,X'80'                                    0476
         L     @14,@PC00001                                        0476
         L     @15,GDTEPL(,@14)                                    0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*IDCRD050:                                                         0477
*        /************************************************************/
*        /*                                                          */
*        /* SUBROUTINE NAME - IDCRD050                               */
*        /*                                                          */
*        /* FUNCTION -                                               */
*        /*                                                          */
*        /* THIS IS THE MAIN PROCEDURE FOR THE MODIFY FUNCTION.      */
*        /* IF THE INREPAIRRANGE PARAMETER WAS SPECIFIED, THE        */
*        /* PROCEDURE MODRNG WILL BE CALLED TO PROCESS THE REQUEST.  */
*        /* IF THE INREPAIRRANGE IS NOT PRESENT, THEN WE MAY HAVE    */
*        /* AN INPUT RECORD FROM EITHER A DATASET OR A REPAIR        */
*        /* WORKFILE, OR WE MAY HAVE SOME INPUT STRING IN THE        */
*        /* COMMAND OR THE USER MAY BE TRYING TO REWRITE THE OUTPUT  */
*        /* RECORD AS AN OVERFLOW RECORD.                            */
*        /* IF AN INPUT RECORD IS PRESENT, IT IS SET IN AREA RB3     */
*        /* POINTED BY BFPTRIN                                       */
*        /* IF INPUT RECORD IS NOT PRESENT, BFPTRIN IS SET TO NULL   */
*        /* AND STRINGSW IS SET TO ZERO(NOT).                        */
*        /* A CHECK IS MADE FOR THE KIND OF OUTPUT.                  */
*        /* IF THE OUTPUT IS A REPAIR WORKFILE, THE OUTPUT RECORD IS */
*        /* SET IN AREA RB1 POINTED BY BFPTROUT AND THE PROCEDURE    */
*        /* MODROUT IS CALLED TO PROCESS THE MODIFY REQUEST.         */
*        /* IF THE OUTPUT IS A DATA SET OR A VTOCHEADER, THE OUTPUT  */
*        /* RECORD IS SET IN AREA RB1 POINTED BY BFPTROUT AND THE    */
*        /* PROCEDURE MODDSOUT IS CALL TO PROCESS THE MODIFY REQUEST.*/
*        /* AFTER THE PROCEDURES RETURN TO IDCRD050, PROCEDURE       */
*        /* MODCLFP IS CALLED TO CLOSE FILES, DEQUEUE AND FREE POOLS */
*        /*                                                          */
*        /* NOTES -                                                  */
*        /*                                                          */
*        /*    DEPENDENCIES - NONE                                   */
*        /*                                                          */
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */
*        /*                   AND IDCRD06 RESPECTIVELY               */
*        /*                                                          */
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */
*        /*                                                          */
*        /*    PATCH LABEL - 'UPATCHIT'                              */
*        /*                                                          */
*        /* ENTRY POINT - IDCRD050 (ONLY ENTRY POINT)                */
*        /*                                                          */
*        /*    PURPOSE - MAIN ROUTINE OF THE REPAIRV FSR             */
*        /*    MODIFY  FUNCTION                                      */
*        /*                                                          */
*        /*    LINKAGE - 'CALL IDCRD050'                             */
*        /*                                                          */
*        /*    INPUT -                                               */
*        /*                                                          */
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */
*        /*       A) DATA STRING SPECFIED IN THE COMMAND             */
*        /*       B) A RECORD IN A DATA SET                          */
*        /*       C) A RECORD IN A REPAIR WORKFILE                   */
*        /*       D) A RANGE OF DEBLOCKED RECORDS IN A REPAIR        */
*        /*            WORKFILE                                      */
*        /*                                                          */
*        /*    OUTPUT -                                              */
*        /*                                                          */
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */
*        /*       A) A MODIFIED RECORD ON A DATA SET                 */
*        /*       B) A MODIFIED RECORD IN A VTOCHEADER               */
*        /*       C) A MODIFIED RECORD IN A REPAIR WORKFILE          */
*        /*       D) A RANGE OF MODIFIED RECORDS EITHER IN A DATA    */
*        /*            SET OR VTOCHEADER                             */
*        /*                                                          */
*        /*      ERROR MESSAGES: IDC31221I                           */
*        /*                      IDC31222I                           */
*        /*                      IDC31223I                           */
*        /*                      IDC31224I                           */
*        /*                                                          */
*        /*                                                          */
*        /*    EXIT, NORMAL -                                        */
*        /*                                                          */
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */
*        /*                                                          */
*        /*    EXIT, ERROR -                                         */
*        /*                                                          */
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */
*        /*                                                          */
*        /* INTERNAL REFERENCES -                                    */
*        /*    PROCEDURES/SUBROUTINES CALLED                         */
*        /*                                                          */
*        /*    MODROUT  - MODIFY A REPAIR WORKFILE RECORD SUBROUTINE */
*        /*                                                          */
*        /*    MODDSOUT - MODIFY A DATA SET OR VTOCHEADER RECORD     */
*        /*      SUBROUTINE                                          */
*        /*                                                          */
*        /*    MODRNG   - MODIFY A RANGE OF RECORDS IN A DATA SET    */
*        /*      OR VTOCHEADER FROM A RANGE OF DEBLOCKED RECORDS     */
*        /*      IN A REPAIR WORKFILE SUBROUTINE                     */
*        /*                                                          */
*        /*    MODCLFP  - CLOSE FILES, FREE POOLS SUBROUTINE AND     */
*        /*      DEQUEUE SUBROUTINE                                  */
*        /*                                                          */
*        /* EXTERNAL REFERENCES -                                    */
*        /*    MACROS/SVCS -                                         */
*        /*                                                          */
*        /*    UCLOSE - IDCAMS I/O ADAPTER CLOSE ROUTINE             */
*        /*      CLOSES THE REPAIR WORKFILE, AND THE ALTERNATE       */
*        /*      REPORT FILE IF SPECIFIED                            */
*        /*      GENERATES A CALL TO MODULE IDCIOCL                  */
*        /*                                                          */
*        /*    UEXCP  - IDCAMS I/O ADAPTER EXCP ROUTINE              */
*        /*      TO CLOSE AND WRITE DATA SET OR VTOCHEADER           */
*        /*      GENERATES A CALL TO MODULE IDCIO05                  */
*        /*                                                          */
*        /*    ?GETRCD - REPAIRV GET RECORD ROUTINE                  */
*        /*      READS RECORDS FROM THE REPAIR WORKFILE              */
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */
*        /*                                                          */
*        /*    ?POSRCD - REPAIRV RECORD POSITIONING ROUTINE          */
*        /*      POSITIONS TO FIRST RECORD IN REPAIRRANGE            */
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */
*        /*                                                          */
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */
*        /*      WRITES ALL MESSAGES                                 */
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */
*        /*                                                          */
*        /*    ?MOVELONG - REPAIRV MVCL MACRO                        */
*        /*      EXECUTES MVCL INSTRUCTION WITH GPR'S 2,3,4 & 5      */
*        /*                                                          */
*        /* PROCEDURES/SUBROUTINES CALLED                            */
*        /*                                                          */
*        /*    IDCRDDS - TO OPEN THE INPUT DATA SET OR               */
*        /*      VTOCHEADER AND OBTAIN BUFFER SPACE                  */
*        /*                                                          */
*        /*    IDCRDRF - TO OPEN THE REPAIR WORKFILE AND OBTAIN      */
*        /*      BUFFER AREAS                                        */
*        /*                                                          */
*        /*    IDCRDRD - TO READ A RECORD IN A DATA SET OR           */
*        /*      VTOCHEADER                                          */
*        /************************************************************/
*                                                                  0477
*        PROCEDURE;                                                0477
@EL00001 L     @13,4(,@13)                                         0477
@EF00001 L     @00,@SIZDATD                                        0477
         LR    @01,@06                                             0477
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0477
         BR    @14                                                 0477
IDCRD050 STM   @14,@12,@SA00002                                    0477
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE POINTERS TO ZERO AND INDICATORS               */
*        /*                                                          */
*        /************************************************************/
*        SAVCLOUT = NULLPTR;                                       0478
         SLR   @15,@15                                             0478
         ST    @15,SAVCLOUT                                        0478
*        SAVCLIN  = NULLPTR;                                       0479
         SLR   @15,@15                                             0479
         ST    @15,SAVCLIN                                         0479
*        STRINGSW = NOT;                                           0480
         MVI   STRINGSW,X'00'                                      0480
*        OVFLSW = NOT;                                             0481
         MVI   OVFLSW,X'00'                                        0481
*        DATSPA = NOT;                                             0482
*                                                                  0482
         MVI   DATSPA,X'00'                                        0482
*        /************************************************************/
*        /*                                                          */
*        /*  PUT THE OUTPUT VOLSER AND CCHHR IN COMMON AREA          */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MVTOC) ^= NULLPTR                                 0483
*          THEN                                                    0483
         L     @15,@PC00001+4                                      0483
         L     @15,FDTPTR+424(,@15)                                0483
         LTR   @15,@15                                             0483
         BZ    @RF00483                                            0483
*            DO;                                                   0484
*            MOKAD6 = MVTCSVAL;                                    0485
         L     @15,@PC00001+4                                      0485
         L     @01,FDTPTR+428(,@15)                                0485
         MVC   MOKAD6(6),MVTCSVAL(@01)                             0485
*            MOKAD5 = MVTCRVAL;                                    0486
         L     @15,@PC00001+4                                      0486
         L     @01,FDTPTR+432(,@15)                                0486
         MVC   MOKAD5(5),MVTCRVAL(@01)                             0486
*            PARNA  = VTOCHDRK;                                    0487
         MVC   PARNA(17),VTOCHDRK                                  0487
*            END;                                                  0488
*           ELSE                                                   0489
*             DO;                                                  0489
         B     @RC00483                                            0489
@RF00483 DS    0H                                                  0490
*             IF ADDR(MODSA) ^= NULLPTR                            0490
*               THEN                                               0490
         L     @15,@PC00001+4                                      0490
         L     @15,FDTPTR+408(,@15)                                0490
         LTR   @15,@15                                             0490
         BZ    @RF00490                                            0490
*                 DO;                                              0491
*                 MOKAD6 = MODVOVAL;                               0492
         L     @15,@PC00001+4                                      0492
         L     @01,FDTPTR+488(,@15)                                0492
         MVC   MOKAD6(6),MODVOVAL(@01)                             0492
*                 MOKAD5 = MODCHVAL;                               0493
         L     @15,@PC00001+4                                      0493
         L     @01,FDTPTR+492(,@15)                                0493
         MVC   MOKAD5(5),MODCHVAL(@01)                             0493
*                 PARNA  = OUTDSAK;                                0494
         MVC   PARNA(17),OUTDSAK                                   0494
*                 END;                                             0495
*               ELSE;                                              0496
@RF00490 DS    0H                                                  0497
*             END;                                                 0497
*                                                                  0497
*        /************************************************************/
*        /*                                                          */
*        /* IF INREPAIRRANGE PRESENT  CALL MODRNG                    */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MIRNG) ^= NULLPTR                                 0498
*          THEN                                                    0498
@RC00483 L     @15,@PC00001+4                                      0498
         L     @15,FDTPTR+388(,@15)                                0498
         LTR   @15,@15                                             0498
         BZ    @RF00498                                            0498
*            DO;                                                   0499
*            CALL MODRNG;                                          0500
         BAL   @14,MODRNG                                          0500
*            RESPECIFY RTNREG RSTD;                                0501
*            TESTRC = RTNREG;                                      0502
         STH   RTNREG,TESTRC                                       0502
*            RESPECIFY RTNREG UNRSTD;                              0503
*            CALL MODCLFP;                                         0504
         BAL   @14,MODCLFP                                         0504
*            RETURN CODE(TESTRC);                                  0505
         LH    @15,TESTRC                                          0505
         L     @14,@SA00002                                        0505
         LM    @00,@12,@SA00002+8                                  0505
         BR    @14                                                 0505
*            END;                                                  0506
*          ELSE;                                                   0507
*                                                                  0507
@RF00498 DS    0H                                                  0508
*        /************************************************************/
*        /*                                                          */
*        /* IF INREPAIRKEY PRESENT CALL IDCRDRF TO OPEN THE REPAIR   */
*        /*  WORKFILE AND OBTAIN BUFFERS                             */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MIRK) ^= NULLPTR                                  0508
*          THEN                                                    0508
         L     @15,@PC00001+4                                      0508
         L     @15,FDTPTR+380(,@15)                                0508
         LTR   @15,@15                                             0508
         BZ    @RF00508                                            0508
*            DO;                                                   0509
*            CALL IDCRDRF (IN);                                    0510
         L     @15,@CV01813                                        0510
         LA    @01,@AL00510                                        0510
         BALR  @14,@15                                             0510
*            RESPECIFY RTNREG RSTD;                                0511
*            TESTRC = RTNREG;                                      0512
         STH   RTNREG,TESTRC                                       0512
*            RESPECIFY RTNREG UNRSTD;                              0513
*                                                                  0513
*            /********************************************************/
*            /* CHECK THE RETURN CODE FROM IDCRDRF AND IF NOT ZERO   */
*            /*  RETURN WITH RC =12                                  */
*            /********************************************************/
*            IF TESTRC ^= 0                                        0514
*              THEN                                                0514
         LH    @15,TESTRC                                          0514
         LTR   @15,@15                                             0514
         BZ    @RF00514                                            0514
*                RETURN CODE(LASTCC12);                            0515
         LA    @15,12                                              0515
         L     @14,@SA00002                                        0515
         LM    @00,@12,@SA00002+8                                  0515
         BR    @14                                                 0515
*              ELSE;                                               0516
*                                                                  0516
@RF00514 DS    0H                                                  0517
*            /********************************************************/
*            /*                                                      */
*            /* SET PTR FOR DSNAME  AND DATSPA INDICATOR             */
*            /*                                                      */
*            /********************************************************/
*            RWFPTR1 = REPIRWIO -> IOCDSN;                         0517
         L     @15,@PC00001+8                                      0517
         L     @01,REPIRWIO(,@15)                                  0517
         L     @15,IOCDSN(,@01)                                    0517
         ST    @15,RWFPTR1                                         0517
*            DATSPA = YESS;                                        0518
*                                                                  0518
         MVI   DATSPA,X'01'                                        0518
*            /********************************************************/
*            /*                                                      */
*            /* SET KEY FOR POSITIONING  AND POSITION RECORD         */
*            /* FOR INPUT REPAIR WORKFILE RECORD                     */
*            /********************************************************/
*            KEYRWFVS = MIRVOVAL;                                  0519
         L     @15,@PC00001+4                                      0519
         L     @01,FDTPTR+436(,@15)                                0519
         MVC   KEYRWFVS(6),MIRVOVAL(@01)                           0519
*            KEYRWCHR = MIRCHVAL;                                  0520
         L     @15,@PC00001+4                                      0520
         L     @01,FDTPTR+440(,@15)                                0520
         MVC   KEYRWCHR(5),MIRCHVAL(@01)                           0520
*            WFIOKYA = ADDR(KEYRWF);                               0521
*                                                                  0521
         L     @15,@PC00001+8                                      0521
         LA    @14,KEYRWF                                          0521
         ST    @14,WFIOKYA(,@15)                                   0521
*            /********************************************************/
*            /* ISSUE POSITION                                       */
*            /********************************************************/
*                                                                  0522
*             DO;                                                  0522
*               WFREQ = ''B;                                       0523
         L     @15,@PC00001+8                                      0523
         XC    WFREQ(2,@15),WFREQ(@15)                             0523
*               WFRPOS = ON;      /*  POSRCD */                    0524
         L     @15,@PC00001+8                                      0524
         OI    WFRPOS(@15),B'00001000'                             0524
*               WFRIN  = ON;      /* INPUT DS */                   0525
         L     @15,@PC00001+8                                      0525
         OI    WFRIN(@15),B'10000000'                              0525
*               CALL IDCRDIO;                                      0526
         L     @15,@CV01814                                        0526
         BALR  @14,@15                                             0526
*               RFY RTNREG RSTD;                                   0527
*               TESTRC = RTNREG;                                   0528
         STH   RTNREG,TESTRC                                       0528
*               RFY RTNREG UNRSTD;                                 0529
*             END;                                                 0530
*                                                                  0530
*            /********************************************************/
*            /*  CHECK RETURN CODE FROM POSITIONING                  */
*            /********************************************************/
*            IF TESTRC ^= 0                                        0531
*              THEN                                                0531
*                                                                  0531
         LH    @15,TESTRC                                          0531
         LTR   @15,@15                                             0531
         BZ    @RF00531                                            0531
*                /****************************************************/
*                /* POSITIONING FAILED. IF RECORD NOT FOUND, ISSUE   */
*                /*  MESSAGE IDC31222I                               */
*                /* CALL MODCLFP TO CLOSE FILE AND FREE POOLS        */
*                /****************************************************/
*                DO;                                               0532
*                IF TESTRC = NOTFOUND                              0533
*                  THEN                                            0533
*                                                                  0533
         CLC   TESTRC(2),@CH00181                                  0533
         BNE   @RF00533                                            0533
*                     DO;                                          0534
*                       CKREQ = CKREQ && CKREQ;                    0535
         L     @15,@PC00001+8                                      0535
         XC    CKREQ(44,@15),CKREQ(@15)                            0535
*                       CKRERN = MSG22;                            0536
         L     @15,@PC00001+8                                      0536
         MVC   CKRERN(2,@15),@CH00663                              0536
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0537
         L     @15,@PC00001+8                                      0537
         LA    @14,KEYRWFVS                                        0537
         ST    @14,CKRMVAR(,@15)                                   0537
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0538
         L     @15,@PC00001+8                                      0538
         LA    @14,KEYRWCHR                                        0538
         ST    @14,CKRMVAR+4(,@15)                                 0538
*                       CKRMVAR(3) = ADDR(RWFDANA);                0539
         L     @15,@PC00001+8                                      0539
         L     @14,RWFPTR1                                         0539
         ST    @14,CKRMVAR+8(,@15)                                 0539
*                       CALL IDCRDER;                              0540
         L     @15,@CV01811                                        0540
         BALR  @14,@15                                             0540
*                     END;                                         0541
*                  ELSE;                                           0542
@RF00533 DS    0H                                                  0543
*                CALL MODCLFP;                                     0543
         BAL   @14,MODCLFP                                         0543
*                RETURN CODE (LASTCC12);                           0544
         LA    @15,12                                              0544
         L     @14,@SA00002                                        0544
         LM    @00,@12,@SA00002+8                                  0544
         BR    @14                                                 0544
*                END;                                              0545
*               ELSE;                                              0546
*                                                                  0546
@RF00531 DS    0H                                                  0547
*            /********************************************************/
*            /*  POSITIONING OK.   GET THE RECORD                    */
*            /********************************************************/
*                                                                  0547
*             DO;                                                  0547
*               WFREQ = ''B;                                       0548
         L     @15,@PC00001+8                                      0548
         XC    WFREQ(2,@15),WFREQ(@15)                             0548
*               WFRGET = ON;      /*  GETRCD */                    0549
         L     @15,@PC00001+8                                      0549
         OI    WFRGET(@15),B'00100000'                             0549
*               WFRIN  = ON;      /* INPUT DS */                   0550
         L     @15,@PC00001+8                                      0550
         OI    WFRIN(@15),B'10000000'                              0550
*               CALL IDCRDIO;                                      0551
         L     @15,@CV01814                                        0551
         BALR  @14,@15                                             0551
*               RFY RTNREG RSTD;                                   0552
*               TESTRC = RTNREG;                                   0553
         STH   RTNREG,TESTRC                                       0553
*               RFY RTNREG UNRSTD;                                 0554
*             END;                                                 0555
*                                                                  0555
*            /********************************************************/
*            /* CHECK IF RECORD FOUND                                */
*            /********************************************************/
*            IF TESTRC ^= 0                                        0556
*              THEN                                                0556
*                                                                  0556
         LH    @15,TESTRC                                          0556
         LTR   @15,@15                                             0556
         BZ    @RF00556                                            0556
*                /****************************************************/
*                /* RECORD COULD NOT BE READ. IF THE RECORD WAS NOT  */
*                /*  FOUND, MESSAGE IDC31222I IS ISSUED              */
*                /* CALL MODCLFP TO CLOSE FILE AND FREE POOLS        */
*                /****************************************************/
*                DO;                                               0557
*                IF TESTRC = EOF                                   0558
*                  THEN                                            0558
*                                                                  0558
         CLC   TESTRC(2),@CH00475                                  0558
         BNE   @RF00558                                            0558
*                     DO;                                          0559
*                       CKREQ = CKREQ && CKREQ;                    0560
         L     @15,@PC00001+8                                      0560
         XC    CKREQ(44,@15),CKREQ(@15)                            0560
*                       CKRERN = MSG22;                            0561
         L     @15,@PC00001+8                                      0561
         MVC   CKRERN(2,@15),@CH00663                              0561
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0562
         L     @15,@PC00001+8                                      0562
         LA    @14,KEYRWFVS                                        0562
         ST    @14,CKRMVAR(,@15)                                   0562
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0563
         L     @15,@PC00001+8                                      0563
         LA    @14,KEYRWCHR                                        0563
         ST    @14,CKRMVAR+4(,@15)                                 0563
*                       CKRMVAR(3) = ADDR(RWFDANA);                0564
         L     @15,@PC00001+8                                      0564
         L     @14,RWFPTR1                                         0564
         ST    @14,CKRMVAR+8(,@15)                                 0564
*                       CALL IDCRDER;                              0565
         L     @15,@CV01811                                        0565
         BALR  @14,@15                                             0565
*                     END;                                         0566
*                  ELSE;                                           0567
@RF00558 DS    0H                                                  0568
*                CALL MODCLFP;                                     0568
         BAL   @14,MODCLFP                                         0568
*                RETURN CODE (LASTCC12);                           0569
         LA    @15,12                                              0569
         L     @14,@SA00002                                        0569
         LM    @00,@12,@SA00002+8                                  0569
         BR    @14                                                 0569
*                END;                                              0570
*              ELSE;                                               0571
*                                                                  0571
@RF00556 DS    0H                                                  0572
*            /********************************************************/
*            /*                                                      */
*            /* SET INPUT IN AREA POINTED BY REPBUFF0                */
*            /*                                                      */
*            /********************************************************/
*            REPR0LN = WFIODLN;                                    0572
         L     @15,@PC00001+8                                      0572
         L     @14,@PC00001+8                                      0572
         L     @14,WFIODLN(,@14)                                   0572
         STH   @14,REPR0LN(,@15)                                   0572
*            BFPTRIN = REPBUFF0;                                   0573
         L     @15,@PC00001+8                                      0573
         L     @15,REPBUFF0(,@15)                                  0573
         ST    @15,BFPTRIN                                         0573
*            RFY RWF1 BASED (WFIODAD);                             0574
*            RFY RB3 BASED (REPBUFF0);                             0575
*            MOVLEN = WFIODLN - KEYFLGLN;                          0576
*                                                                  0576
         L     @15,@PC00001+8                                      0576
         L     @15,WFIODLN(,@15)                                   0576
         SL    @15,@CF00475                                        0576
         STH   @15,MOVLEN                                          0576
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      0577
*             REG2 = ADDR(RB3C);                                   0578
         L     @15,@PC00001+8                                      0578
         L     REG2,REPBUFF0(,@15)                                 0578
         LA    REG2,RB3C(,REG2)                                    0578
*             REG3 = MOVLEN;                                       0579
         LH    REG3,MOVLEN                                         0579
         N     REG3,@CF02153                                       0579
*             REG4 = ADDR(RWF1C);                                  0580
         L     @15,@PC00001+8                                      0580
         L     REG4,WFIODAD(,@15)                                  0580
         LA    REG4,RWF1C(,REG4)                                   0580
*             REG5 = MOVLEN;                                       0581
         LH    REG5,MOVLEN                                         0581
         N     REG5,@CF02153                                       0581
*             MVCL (REG2,REG4);                                    0582
         MVCL  REG2,REG4                                           0582
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     0583
*                                                                  0583
*            /********************************************************/
*            /*                                                      */
*            /* RB3 CONTAINS THE INPUT RECORD                        */
*            /* THE INPUT REPAIR WORKFILE IS CLOSED, SAVCLIN IS      */
*            /* SET TO ZEROS                                         */
*            /*                                                      */
*            /********************************************************/
*            CALL IDCIOCL0(GDTTBL,REPIRWIO);                       0584
         L     @15,@PC00001                                        0584
         ST    @15,@AL00001                                        0584
         L     @15,@PC00001+8                                      0584
         LA    @15,REPIRWIO(,@15)                                  0584
         ST    @15,@AL00001+4                                      0584
         MVI   @AL00001+4,X'80'                                    0584
         L     @14,@PC00001                                        0584
         L     @15,GDTCLS(,@14)                                    0584
         LA    @01,@AL00001                                        0584
         BALR  @14,@15                                             0584
*            REPIRWIO = NULLPTR;                                   0585
         L     @15,@PC00001+8                                      0585
         SLR   @14,@14                                             0585
         ST    @14,REPIRWIO(,@15)                                  0585
*            END;                                                  0586
*          ELSE                                                    0587
*                                                                  0587
*            /********************************************************/
*            /*                                                      */
*            /* IF INDATASETADDRESS IS PRESENT CALL IDCRDDS TO OPEN  */
*            /*  THE DATA SET OR VTOCHEADER AND OBTAIN BUFFERS       */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0587
         B     @RC00508                                            0587
@RF00508 DS    0H                                                  0588
*            IF ADDR(MIDSA) ^= NULLPTR                             0588
*              THEN                                                0588
         L     @15,@PC00001+4                                      0588
         L     @15,FDTPTR+384(,@15)                                0588
         LTR   @15,@15                                             0588
         BZ    @RF00588                                            0588
*                DO;                                               0589
*                CALL IDCRDDS(IN,ZEROS);                           0590
         L     @15,@CV01810                                        0590
         LA    @01,@AL00590                                        0590
         BALR  @14,@15                                             0590
*                RESPECIFY RTNREG RSTD;                            0591
*                TESTRC = RTNREG;                                  0592
         STH   RTNREG,TESTRC                                       0592
*                RESPECIFY RTNREG UNRSTD;                          0593
*                                                                  0593
*                /****************************************************/
*                /* CHECK THE RETURN CODE FROM IDCRDDS AND IF NOT    */
*                /*  ZERO RETURN WITH RC = 12                        */
*                /****************************************************/
*                IF TESTRC ^= 0                                    0594
*                  THEN                                            0594
         LH    @15,TESTRC                                          0594
         LTR   @15,@15                                             0594
         BZ    @RF00594                                            0594
*                    RETURN CODE(LASTCC12);                        0595
         LA    @15,12                                              0595
         L     @14,@SA00002                                        0595
         LM    @00,@12,@SA00002+8                                  0595
         BR    @14                                                 0595
*                  ELSE;                                           0596
*                                                                  0596
@RF00594 DS    0H                                                  0597
*                /****************************************************/
*                /*                                                  */
*                /* SAVE REPIDSOP FOR CLOSE AND SET DATSPA INDICATOR */
*                /*                                                  */
*                /****************************************************/
*                SAVCLIN = REPIDSOP;                               0597
         L     @15,@PC00001+8                                      0597
         L     @15,REPIDSOP(,@15)                                  0597
         ST    @15,SAVCLIN                                         0597
*                DATSPA = YESS;                                    0598
*                                                                  0598
         MVI   DATSPA,X'01'                                        0598
*                /****************************************************/
*                /*                                                  */
*                /* BUILD ARG LIST                                   */
*                /*                                                  */
*                /****************************************************/
*                RFY RDARG BASED (REPIDSAR);                       0599
*                RDLOCPTR=REPILCPT;                                0600
         L     @15,@PC00001+8                                      0600
         L     @01,REPIDSAR(,@15)                                  0600
         L     @15,@PC00001+8                                      0600
         L     @00,REPILCPT(,@15)                                  0600
         ST    @00,RDLOCPTR(,@01)                                  0600
*                RDCTLBK = REPIDSOP;                               0601
         L     @15,@PC00001+8                                      0601
         L     @01,REPIDSAR(,@15)                                  0601
         L     @15,@PC00001+8                                      0601
         L     @00,REPIDSOP(,@15)                                  0601
         ST    @00,RDCTLBK(,@01)                                   0601
*                RDCHRC=MIDCHVAL;                                  0602
         L     @15,@PC00001+8                                      0602
         L     @01,REPIDSAR(,@15)                                  0602
         L     @15,@PC00001+4                                      0602
         L     @15,FDTPTR+448(,@15)                                0602
         MVC   RDCHRC(5,@01),MIDCHVAL(@15)                         0602
*                RDIOAREA = REPIBFPT;                              0603
         L     @15,@PC00001+8                                      0603
         L     @01,REPIDSAR(,@15)                                  0603
         L     @15,@PC00001+8                                      0603
         L     @00,REPIBFPT(,@15)                                  0603
         ST    @00,RDIOAREA(,@01)                                  0603
*                RDDS=ZERO;                                        0604
*                                                                  0604
         L     @15,@PC00001+8                                      0604
         L     @01,REPIDSAR(,@15)                                  0604
         MVI   RDDS(@01),X'00'                                     0604
*                /****************************************************/
*                /* READ RECORD                                      */
*                /****************************************************/
*                CALL IDCRDRD(RDARG);                              0605
         L     @15,@PC00001+8                                      0605
         L     @01,REPIDSAR(,@15)                                  0605
         ST    @01,@AL00001                                        0605
         L     @15,@CV01812                                        0605
         LA    @01,@AL00001                                        0605
         BALR  @14,@15                                             0605
*                RFY XTNTTBL BASED(REPIXTNT);                      0606
*                RESPECIFY RTNREG RSTD;                            0607
*                TESTRC = RTNREG;                                  0608
         STH   RTNREG,TESTRC                                       0608
*                RESPECIFY RTNREG UNRSTD;                          0609
*                                                                  0609
*                /****************************************************/
*                /*                                                  */
*                /* CHECK THE RETURN CODE FROM IDCRDRD               */
*                /* IF THE RC > 21, THEN THE RECORD COULD NOT BE READ*/
*                /* CALL MODCLFP TO CLOSE FILE AND FREE POOLS        */
*                /****************************************************/
*                IF TESTRC > 21                                    0610
*                  THEN                                            0610
*                                                                  0610
         LH    @15,TESTRC                                          0610
         C     @15,@CF00652                                        0610
         BNH   @RF00610                                            0610
*                    /************************************************/
*                    /* RECORD COULD NOT BE READ                     */
*                    /* CALL MODCLFP TO CLSE FILE AND FREE POOLS     */
*                    /************************************************/
*                    DO;                                           0611
*                                                                  0611
*                    /************************************************/
*                    /* CHECK IF RECORD NOT FOUND OR END OF TRACK    */
*                    /************************************************/
*                    IF TESTRC = NTFNDRD  TESTRC = ENDTRK         0612
*                      THEN                                        0612
         CLC   TESTRC(2),@CH01990                                  0612
         BE    @RT00612                                            0612
         CLC   TESTRC(2),@CH00698                                  0612
         BNE   @RF00612                                            0612
@RT00612 DS    0H                                                  0613
*                        DO;                                       0613
*                                                                  0613
*                        /********************************************/
*                        /* RECORD NOT FOUND OR END OF TRACK  ISSUE  */
*                        /*  MESSAGE IDC31221I                       */
*                        /********************************************/
*                        IF XTNHDSN = VTOCDSN                      0614
*                          THEN                                    0614
         L     @15,@PC00001+8                                      0614
         L     @01,REPIXTNT(,@15)                                  0614
         CLC   XTNHDSN(44,@01),VTOCDSN                             0614
         BNE   @RF00614                                            0614
*                            DSNMSG = FMT4DSN;                     0615
         MVC   DSNMSG(44),FMT4DSN                                  0615
*                          ELSE                                    0616
*                            DSNMSG = XTNHDSN;                     0616
*                                                                  0616
         B     @RC00614                                            0616
@RF00614 L     @15,@PC00001+8                                      0616
         L     @01,REPIXTNT(,@15)                                  0616
         MVC   DSNMSG(44),XTNHDSN(@01)                             0616
*                         DO;                                      0617
@RC00614 DS    0H                                                  0618
*                           CKREQ = CKREQ && CKREQ;                0618
         L     @15,@PC00001+8                                      0618
         XC    CKREQ(44,@15),CKREQ(@15)                            0618
*                           CKRERN = MSG21;                        0619
         L     @15,@PC00001+8                                      0619
         MVC   CKRERN(2,@15),@CH00652                              0619
*                           CKRMVAR(1) = ADDR(MIDVOVAL);           0620
         L     @15,@PC00001+8                                      0620
         L     @14,@PC00001+4                                      0620
         L     @01,FDTPTR+444(,@14)                                0620
         LA    @14,MIDVOVAL(,@01)                                  0620
         ST    @14,CKRMVAR(,@15)                                   0620
*                           CKRMVAR(2) = ADDR(RDCHR);              0621
         L     @15,@PC00001+8                                      0621
         L     @14,@PC00001+8                                      0621
         L     @01,REPIDSAR(,@14)                                  0621
         LA    @14,RDCHR(,@01)                                     0621
         ST    @14,CKRMVAR+4(,@15)                                 0621
*                           CKRMVAR(3) = ADDR(DSNMSG);             0622
         L     @15,@PC00001+8                                      0622
         LA    @14,DSNMSG                                          0622
         ST    @14,CKRMVAR+8(,@15)                                 0622
*                           CALL IDCRDER;                          0623
         L     @15,@CV01811                                        0623
         BALR  @14,@15                                             0623
*                         END;                                     0624
*                        END;                                      0625
*                      ELSE;                                       0626
@RF00612 DS    0H                                                  0627
*                    CALL MODCLFP;                                 0627
         BAL   @14,MODCLFP                                         0627
*                    RETURN CODE(LASTCC12);                        0628
         LA    @15,12                                              0628
         L     @14,@SA00002                                        0628
         LM    @00,@12,@SA00002+8                                  0628
         BR    @14                                                 0628
*                    END;                                          0629
*                                                                  0629
*                  ELSE;                                           0630
*                                                                  0630
@RF00610 DS    0H                                                  0631
*                /****************************************************/
*                /*                                                  */
*                /* SET BFPTRIN                                      */
*                /*                                                  */
*                /****************************************************/
*                BFPTRIN = RDDARE - LENGTH(RB3NUM);                0631
         L     @15,@PC00001+8                                      0631
         L     @01,REPIDSAR(,@15)                                  0631
         L     @15,RDDARE(,@01)                                    0631
         SL    @15,@CF00044                                        0631
         ST    @15,BFPTRIN                                         0631
*                RFY RB3 BASED (BFPTRIN);                          0632
*                /****************************************************/
*                /*                                                  */
*                /* CLOSE INPUT DATA SET, CLEAR SAVCLIN              */
*                /****************************************************/
*                CALL IDCIO050(GDTTBL,CLOSE,SAVCLIN);              0633
         L     @15,@PC00001                                        0633
         ST    @15,@AL00001                                        0633
         LA    @15,CLOSE                                           0633
         ST    @15,@AL00001+4                                      0633
         LA    @15,SAVCLIN                                         0633
         ST    @15,@AL00001+8                                      0633
         MVI   @AL00001+8,X'80'                                    0633
         L     @14,@PC00001                                        0633
         L     @15,GDTEXP(,@14)                                    0633
         LA    @01,@AL00001                                        0633
         BALR  @14,@15                                             0633
*                SAVCLIN = NULLPTR;                                0634
*                                                                  0634
         SLR   @15,@15                                             0634
         ST    @15,SAVCLIN                                         0634
*                /****************************************************/
*                /*                                                  */
*                /* RB3 HAS THE INPUT RECORD                         */
*                /*                                                  */
*                /****************************************************/
*                END;                                              0635
*                                                                  0635
*              /******************************************************/
*              /*                                                    */
*              /*   THE INPUT IS NOT A RECORD                        */
*              /*   SET BFPTRIN NULL  AND STRINGSW ON                */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0636
*                DO;                                               0636
         B     @RC00588                                            0636
@RF00588 DS    0H                                                  0637
*                STRINGSW =YESS;                                   0637
         MVI   STRINGSW,X'01'                                      0637
*                BFPTRIN = NULLPTR;                                0638
         SLR   @15,@15                                             0638
         ST    @15,BFPTRIN                                         0638
*                END;                                              0639
*            END;                                                  0640
*                                                                  0640
@RC00588 DS    0H                                                  0641
*        /************************************************************/
*        /*                                                          */
*        /* NOW WE ARE GOING TO GET THE OUTPUT RECORD                */
*        /* CHECK IF OUTREPAIRKEY PRESENT                            */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MORK) ^= NULLPTR                                  0641
*          THEN                                                    0641
@RC00508 L     @15,@PC00001+4                                      0641
         L     @15,FDTPTR+404(,@15)                                0641
         LTR   @15,@15                                             0641
         BZ    @RF00641                                            0641
*            DO;                                                   0642
*            CALL IDCRDRF(OUT);                                    0643
         L     @15,@CV01813                                        0643
         LA    @01,@AL00643                                        0643
         BALR  @14,@15                                             0643
*            RESPECIFY RTNREG RSTD;                                0644
*            TESTRC = RTNREG;                                      0645
         STH   RTNREG,TESTRC                                       0645
*            RESPECIFY RTNREG UNRSTD;                              0646
*                                                                  0646
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THE RETURN CODE FROM IDCRDRF.                  */
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC ^= 0                                        0647
*              THEN                                                0647
*                                                                  0647
         LH    @15,TESTRC                                          0647
         LTR   @15,@15                                             0647
         BZ    @RF00647                                            0647
*                /****************************************************/
*                /*  THE RC FROM RC ^= 0.  CALL MODCLFP TO CLOSE     */
*                /*   FILES AND FREE POOLS                           */
*                /*  RETURN WITH A RC = 12                           */
*                /****************************************************/
*                DO;                                               0648
*                /****************************************************/
*                /* IDCRDRF ALREADY CLOSED THE RWF. IF AN ERROR      */
*                /* OCCURRED ZERO OUT THE POINTER AND CALL CLEANUP   */
*                /****************************************************/
*                REPORWIO = NULLPTR;                               0649
         L     @15,@PC00001+8                                      0649
         SLR   @14,@14                                             0649
         ST    @14,REPORWIO(,@15)                                  0649
*                CALL MODCLFP;                                     0650
         BAL   @14,MODCLFP                                         0650
*                RETURN CODE(LASTCC12);                            0651
         LA    @15,12                                              0651
         L     @14,@SA00002                                        0651
         LM    @00,@12,@SA00002+8                                  0651
         BR    @14                                                 0651
*                END;                                              0652
*              ELSE;                                               0653
*                                                                  0653
@RF00647 DS    0H                                                  0654
*            /********************************************************/
*            /*                                                      */
*            /* SET DSNAME AND DATSPA INDICATOR                      */
*            /*                                                      */
*            /********************************************************/
*            RWFPTR1 = REPORWIO -> IOCDSN;                         0654
         L     @15,@PC00001+8                                      0654
         L     @01,REPORWIO(,@15)                                  0654
         L     @15,IOCDSN(,@01)                                    0654
         ST    @15,RWFPTR1                                         0654
*            DATSPA = YESS;                                        0655
*                                                                  0655
         MVI   DATSPA,X'01'                                        0655
*            /********************************************************/
*            /*                                                      */
*            /* POSITION FOR THE OUTPUT RECORD                       */
*            /*                                                      */
*            /********************************************************/
*            KEYRWFVS = MORVOVAL;                                  0656
         L     @15,@PC00001+4                                      0656
         L     @01,FDTPTR+480(,@15)                                0656
         MVC   KEYRWFVS(6),MORVOVAL(@01)                           0656
*            KEYRWCHR = MORCHVAL;                                  0657
         L     @15,@PC00001+4                                      0657
         L     @01,FDTPTR+484(,@15)                                0657
         MVC   KEYRWCHR(5),MORCHVAL(@01)                           0657
*            WFIOKYA = ADDR(KEYRWF);                               0658
*                                                                  0658
         L     @15,@PC00001+8                                      0658
         LA    @14,KEYRWF                                          0658
         ST    @14,WFIOKYA(,@15)                                   0658
*             DO;                                                  0659
*               WFREQ = ''B;                                       0660
         L     @15,@PC00001+8                                      0660
         XC    WFREQ(2,@15),WFREQ(@15)                             0660
*               WFRPOS = ON;      /*  POSRCD */                    0661
         L     @15,@PC00001+8                                      0661
         OI    WFRPOS(@15),B'00001000'                             0661
*               CALL IDCRDIO;                                      0662
         L     @15,@CV01814                                        0662
         BALR  @14,@15                                             0662
*               RFY RTNREG RSTD;                                   0663
*               TESTRC = RTNREG;                                   0664
         STH   RTNREG,TESTRC                                       0664
*               RFY RTNREG UNRSTD;                                 0665
*             END;                                                 0666
*                                                                  0666
*            /********************************************************/
*            /* CHECK THE RETURN CODE FROM POSITIONING THE RECORD    */
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC ^= 0                                        0667
*              THEN                                                0667
*                                                                  0667
         LH    @15,TESTRC                                          0667
         LTR   @15,@15                                             0667
         BZ    @RF00667                                            0667
*                /****************************************************/
*                /* BAD RETURN CODE FROM POSITIONING                 */
*                /* CALL MODCLFP TO CLSE FILES AND FREE POOLS        */
*                /****************************************************/
*                DO;                                               0668
*                                                                  0668
*                /****************************************************/
*                /* CHECK IS RECORD NOT FOUND                        */
*                /****************************************************/
*                IF TESTRC = NOTFOUND                              0669
*                  THEN                                            0669
*                                                                  0669
         CLC   TESTRC(2),@CH00181                                  0669
         BNE   @RF00669                                            0669
*                    /************************************************/
*                    /* RECORD NOT FOUND. ISSUE MESSAGE IDC31224I    */
*                    /************************************************/
*                                                                  0670
*                     DO;                                          0670
*                       CKREQ = CKREQ && CKREQ;                    0671
         L     @15,@PC00001+8                                      0671
         XC    CKREQ(44,@15),CKREQ(@15)                            0671
*                       CKRERN = MSG24;                            0672
         L     @15,@PC00001+8                                      0672
         MVC   CKRERN(2,@15),@CH00312                              0672
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0673
         L     @15,@PC00001+8                                      0673
         LA    @14,KEYRWFVS                                        0673
         ST    @14,CKRMVAR(,@15)                                   0673
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0674
         L     @15,@PC00001+8                                      0674
         LA    @14,KEYRWCHR                                        0674
         ST    @14,CKRMVAR+4(,@15)                                 0674
*                       CKRMVAR(3) = ADDR(RWFDANA);                0675
         L     @15,@PC00001+8                                      0675
         L     @14,RWFPTR1                                         0675
         ST    @14,CKRMVAR+8(,@15)                                 0675
*                       CALL IDCRDER;                              0676
         L     @15,@CV01811                                        0676
         BALR  @14,@15                                             0676
*                     END;                                         0677
*                  ELSE;                                           0678
@RF00669 DS    0H                                                  0679
*                CALL MODCLFP;                                     0679
         BAL   @14,MODCLFP                                         0679
*                RETURN CODE(LASTCC12);                            0680
         LA    @15,12                                              0680
         L     @14,@SA00002                                        0680
         LM    @00,@12,@SA00002+8                                  0680
         BR    @14                                                 0680
*                END;                                              0681
*              ELSE;                                               0682
*                                                                  0682
@RF00667 DS    0H                                                  0683
*            /********************************************************/
*            /*                                                      */
*            /* GET THE RECORD                                       */
*            /*                                                      */
*            /********************************************************/
*                                                                  0683
*             DO;                                                  0683
*               WFREQ = ''B;                                       0684
         L     @15,@PC00001+8                                      0684
         XC    WFREQ(2,@15),WFREQ(@15)                             0684
*               WFRGET = ON;      /*  GETRCD */                    0685
         L     @15,@PC00001+8                                      0685
         OI    WFRGET(@15),B'00100000'                             0685
*               WFRUP  = ON;      /* UPDATE */                     0686
         L     @15,@PC00001+8                                      0686
         OI    WFRUP(@15),B'01000000'                              0686
*               CALL IDCRDIO;                                      0687
         L     @15,@CV01814                                        0687
         BALR  @14,@15                                             0687
*               RFY RTNREG RSTD;                                   0688
*               TESTRC = RTNREG;                                   0689
         STH   RTNREG,TESTRC                                       0689
*               RFY RTNREG UNRSTD;                                 0690
*             END;                                                 0691
*                                                                  0691
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THE RETURN CODE FROM GETTING THE RECORD        */
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC ^= 0                                        0692
*              THEN                                                0692
*                                                                  0692
         LH    @15,TESTRC                                          0692
         LTR   @15,@15                                             0692
         BZ    @RF00692                                            0692
*                /****************************************************/
*                /*                                                  */
*                /* THE RETURN CODE FROM GETTING THE RECORD IS NOT 0 */
*                /* CALL MODCLFP TO CLOSE FILES AND FREE POOLS       */
*                /*                                                  */
*                /****************************************************/
*                DO;                                               0693
*                                                                  0693
*                /****************************************************/
*                /* CHECK IF THE RC WAS END OF FILE                  */
*                /****************************************************/
*                IF TESTRC = EOF                                   0694
*                  THEN                                            0694
*                                                                  0694
         CLC   TESTRC(2),@CH00475                                  0694
         BNE   @RF00694                                            0694
*                    /************************************************/
*                    /* RC INDICATES END OF FILE. ISSUE MESSAGE      */
*                    /*  IDC31224I                                   */
*                    /************************************************/
*                                                                  0695
*                     DO;                                          0695
*                       CKREQ = CKREQ && CKREQ;                    0696
         L     @15,@PC00001+8                                      0696
         XC    CKREQ(44,@15),CKREQ(@15)                            0696
*                       CKRERN = MSG24;                            0697
         L     @15,@PC00001+8                                      0697
         MVC   CKRERN(2,@15),@CH00312                              0697
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0698
         L     @15,@PC00001+8                                      0698
         LA    @14,KEYRWFVS                                        0698
         ST    @14,CKRMVAR(,@15)                                   0698
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0699
         L     @15,@PC00001+8                                      0699
         LA    @14,KEYRWCHR                                        0699
         ST    @14,CKRMVAR+4(,@15)                                 0699
*                       CKRMVAR(3) = ADDR(RWFDANA);                0700
         L     @15,@PC00001+8                                      0700
         L     @14,RWFPTR1                                         0700
         ST    @14,CKRMVAR+8(,@15)                                 0700
*                       CALL IDCRDER;                              0701
         L     @15,@CV01811                                        0701
         BALR  @14,@15                                             0701
*                     END;                                         0702
*                  ELSE;                                           0703
@RF00694 DS    0H                                                  0704
*                CALL MODCLFP;                                     0704
         BAL   @14,MODCLFP                                         0704
*                RETURN CODE(LASTCC12);                            0705
         LA    @15,12                                              0705
         L     @14,@SA00002                                        0705
         LM    @00,@12,@SA00002+8                                  0705
         BR    @14                                                 0705
*                END;                                              0706
*              ELSE;                                               0707
*                                                                  0707
@RF00692 DS    0H                                                  0708
*            /********************************************************/
*            /*                                                      */
*            /* PROCESS REPAIR WORKFILE OUTPUT                       */
*            /*                                                      */
*            /********************************************************/
*            REPR1LN = WFIODLN;                                    0708
         L     @15,@PC00001+8                                      0708
         L     @14,@PC00001+8                                      0708
         L     @14,WFIODLN(,@14)                                   0708
         STH   @14,REPR1LN(,@15)                                   0708
*            BFPTROUT = REPBUFF1;                                  0709
         L     @15,@PC00001+8                                      0709
         L     @15,REPBUFF1(,@15)                                  0709
         ST    @15,BFPTROUT                                        0709
*            RFY RWF1 BASED (WFIODAD);                             0710
*            RFY RB2 BASED (REPBUFF1);                             0711
*                                                                  0711
*            /********************************************************/
*            /*                                                      */
*            /* MOVLEN HAS RECORD LENGTH TO BE MOVED                 */
*            /*                                                      */
*            /********************************************************/
*            MOVLEN = WFIODLN;                                     0712
*                                                                  0712
         L     @15,@PC00001+8                                      0712
         L     @15,WFIODLN(,@15)                                   0712
         STH   @15,MOVLEN                                          0712
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      0713
*             REG2 = ADDR(RB2);                                    0714
         L     @15,@PC00001+8                                      0714
         L     REG2,REPBUFF1(,@15)                                 0714
*             REG3 = MOVLEN;                                       0715
         LH    REG3,MOVLEN                                         0715
         N     REG3,@CF02153                                       0715
*             REG4 = ADDR(RWF1);                                   0716
         L     @15,@PC00001+8                                      0716
         L     REG4,WFIODAD(,@15)                                  0716
*             REG5 = MOVLEN;                                       0717
         LH    REG5,MOVLEN                                         0717
         N     REG5,@CF02153                                       0717
*             MVCL (REG2,REG4);                                    0718
         MVCL  REG2,REG4                                           0718
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     0719
*                                                                  0719
*            /********************************************************/
*            /*                                                      */
*            /* CALL MODROUT SUBROUTINE TO MODIFY ONE REPAIR         */
*            /*  WORKFILE RECORD                                     */
*            /*                                                      */
*            /********************************************************/
*            CALL MODROUT;                                         0720
         BAL   @14,MODROUT                                         0720
*            RESPECIFY RTNREG RSTD;                                0721
*            TESTRC = RTNREG;                                      0722
         STH   RTNREG,TESTRC                                       0722
*            RESPECIFY RTNREG UNRSTD;                              0723
*            CALL MODCLFP;                                         0724
         BAL   @14,MODCLFP                                         0724
*            RETURN CODE(TESTRC);                                  0725
         LH    @15,TESTRC                                          0725
         L     @14,@SA00002                                        0725
         LM    @00,@12,@SA00002+8                                  0725
         BR    @14                                                 0725
*            END;                                                  0726
*          ELSE;                                                   0727
*                                                                  0727
@RF00641 DS    0H                                                  0728
*          /**********************************************************/
*          /*                                                        */
*          /* THE OUTPUT IS EITHER A DATA SET OR VTOCHEADER          */
*          /* CALL IDCRDDS TO OPEN AND OBTAIN BUFFERS                */
*          /**********************************************************/
*          CALL IDCRDDS(OUT,ZEROS);                                0728
         L     @15,@CV01810                                        0728
         LA    @01,@AL00728                                        0728
         BALR  @14,@15                                             0728
*          RESPECIFY RTNREG RSTD;                                  0729
*          TESTRC = RTNREG;                                        0730
         STH   RTNREG,TESTRC                                       0730
*          RESPECIFY RTNREG UNRSTD;                                0731
*                                                                  0731
*          /**********************************************************/
*          /*                                                        */
*          /*CHECK IF THE RETURN CODE FROM IDCRDDS IS NOT ZERO       */
*          /*                                                        */
*          /**********************************************************/
*          IF TESTRC ^= 0                                          0732
*            THEN                                                  0732
*                                                                  0732
         LH    @15,TESTRC                                          0732
         LTR   @15,@15                                             0732
         BZ    @RF00732                                            0732
*              /******************************************************/
*              /* RC ^= 0 FROM IDCRDDS                               */
*              /* CALL MODCLFP TO CLOSE FILES AND FREE POOLS         */
*              /* RETURN WITH RC = 12. SET REPENQSW = ZERO SO NO     */
*              /* DEQUEUE IS ISSUED IN MODCLFP.                      */
*              /******************************************************/
*              DO;                                                 0733
*              REPENQSW = ZERO;                                    0734
         L     @15,@PC00001+8                                      0734
         MVI   REPENQSW(@15),X'00'                                 0734
*              CALL MODCLFP;                                       0735
         BAL   @14,MODCLFP                                         0735
*              RETURN CODE(LASTCC12);                              0736
         LA    @15,12                                              0736
         L     @14,@SA00002                                        0736
         LM    @00,@12,@SA00002+8                                  0736
         BR    @14                                                 0736
*              END;                                                0737
*            ELSE;                                                 0738
*                                                                  0738
@RF00732 DS    0H                                                  0739
*          /**********************************************************/
*          /*                                                        */
*          /* SAVE FOR CLOSE AND SET ADDRESSABILITY FOR RDARG        */
*          /* SET EITHER DSN OR VTOCHEADR CONSTANT IN A COMMON FIELD */
*          /* TO BE USED FOR MESSAGES( DSNMSG)                       */
*          /* SET THE DATSPA INDICATOR                               */
*          /**********************************************************/
*          SAVCLOUT = REPODSOP;                                    0739
         L     @15,@PC00001+8                                      0739
         L     @15,REPODSOP(,@15)                                  0739
         ST    @15,SAVCLOUT                                        0739
*          DATSPA = YESS;                                          0740
         MVI   DATSPA,X'01'                                        0740
*          RFY RDARG BASED (REPODSAR);                             0741
*          RFY XTNTTBL BASED(REPOXTNT);                            0742
*                                                                  0742
*          /**********************************************************/
*          /*                                                        */
*          /* CHECK IF THE OUT PUT IS VTOCHEADERADDRESS              */
*          /*                                                        */
*          /**********************************************************/
*          IF ADDR(MVTOC) ^= NULLPTR                               0743
*             THEN                                                 0743
*                                                                  0743
         L     @15,@PC00001+4                                      0743
         L     @15,FDTPTR+424(,@15)                                0743
         LTR   @15,@15                                             0743
         BZ    @RF00743                                            0743
*               /*****************************************************/
*               /*                                                   */
*               /* THE VTOCHEADERADRRESS PARAMETER IS PRESENT        */
*               /* MOVE THE VTOCNAME LITERAL TO COMMON MESSAGE AREA  */
*               /*                                                   */
*               /*****************************************************/
*               DSNMSG = VTOCNAME;                                 0744
         MVI   DSNMSG+10,C' '                                      0744
         MVC   DSNMSG+11(33),DSNMSG+10                             0744
         MVC   DSNMSG(10),VTOCNAME                                 0744
*             ELSE                                                 0745
*                                                                  0745
*               /*****************************************************/
*               /*                                                   */
*               /* THE OUTDATASETADDRRESS PARAMETER IS PRESENT       */
*               /* MOVE THE DSNAME LITERAL TO COMMON MESSAGE AREA    */
*               /*  DSNMSG. NOTE THAT IF THE DATA SET IS A VTOC, THE */
*               /*  DSNAME IS A FORMAT4.DSCB                         */
*               /*****************************************************/
*               DO;                                                0745
         B     @RC00743                                            0745
@RF00743 DS    0H                                                  0746
*               IF XTNHDSN = VTOCDSN                               0746
*                 THEN                                             0746
         L     @15,@PC00001+8                                      0746
         L     @01,REPOXTNT(,@15)                                  0746
         CLC   XTNHDSN(44,@01),VTOCDSN                             0746
         BNE   @RF00746                                            0746
*                   DSNMSG = FMT4DSN;                              0747
         MVC   DSNMSG(44),FMT4DSN                                  0747
*                 ELSE                                             0748
*                   DSNMSG = XTNHDSN;                              0748
         B     @RC00746                                            0748
@RF00746 L     @15,@PC00001+8                                      0748
         L     @01,REPOXTNT(,@15)                                  0748
         MVC   DSNMSG(44),XTNHDSN(@01)                             0748
*               END;                                               0749
*                                                                  0749
@RC00746 DS    0H                                                  0750
*          /**********************************************************/
*          /*                                                        */
*          /* GOOD OPEN SET RDARG LIST                               */
*          /*                                                        */
*          /**********************************************************/
*          RDCHR = MOKAD5;                                         0750
@RC00743 L     @15,@PC00001+8                                      0750
         L     @01,REPODSAR(,@15)                                  0750
         MVC   RDCHR(5,@01),MOKAD5                                 0750
*          RDCTLBK  = REPODSOP;                                    0751
         L     @15,@PC00001+8                                      0751
         L     @01,REPODSAR(,@15)                                  0751
         L     @15,@PC00001+8                                      0751
         L     @00,REPODSOP(,@15)                                  0751
         ST    @00,RDCTLBK(,@01)                                   0751
*          RDLOCPTR = REPOLCPT;                                    0752
         L     @15,@PC00001+8                                      0752
         L     @01,REPODSAR(,@15)                                  0752
         L     @15,@PC00001+8                                      0752
         L     @00,REPOLCPT(,@15)                                  0752
         ST    @00,RDLOCPTR(,@01)                                  0752
*          RDIOAREA = REPOBFPT;                                    0753
         L     @15,@PC00001+8                                      0753
         L     @01,REPODSAR(,@15)                                  0753
         L     @15,@PC00001+8                                      0753
         L     @00,REPOBFPT(,@15)                                  0753
         ST    @00,RDIOAREA(,@01)                                  0753
*          RDDS     = ZERO;                                        0754
*                                                                  0754
         L     @15,@PC00001+8                                      0754
         L     @01,REPODSAR(,@15)                                  0754
         MVI   RDDS(@01),X'00'                                     0754
*          /**********************************************************/
*          /*                                                        */
*          /* CALL IDCRDRD TO READ ONE RECORD FROM A DATA SET OR     */
*          /*  VTOCHEADER                                            */
*          /*                                                        */
*          /**********************************************************/
*          CALL IDCRDRD(RDARG);                                    0755
         L     @15,@PC00001+8                                      0755
         L     @01,REPODSAR(,@15)                                  0755
         ST    @01,@AL00001                                        0755
         L     @15,@CV01812                                        0755
         LA    @01,@AL00001                                        0755
         BALR  @14,@15                                             0755
*          RESPECIFY RTNREG RSTD;                                  0756
*          TESTRC = RTNREG;                                        0757
         STH   RTNREG,TESTRC                                       0757
*          RESPECIFY RTNREG UNRSTD;                                0758
*                                                                  0758
*          /**********************************************************/
*          /*                                                        */
*          /*CHECK THE RETURN CODE FROM IDCRDRD                      */
*          /*                                                        */
*          /**********************************************************/
*          IF TESTRC > 21                                          0759
*            THEN                                                  0759
*                                                                  0759
         LH    @15,TESTRC                                          0759
         C     @15,@CF00652                                        0759
         BNH   @RF00759                                            0759
*              /******************************************************/
*              /*                                                    */
*              /* THE RETURN CODE FROM IDCRDRD IS > 21 WHICH         */
*              /*  INDICATES A BAD RECORD.  CALL MODCLFP TO CLOSE    */
*              /*  THE FILES AND FREE POOLS AND RETURN WITH A RC = 12*/
*              /******************************************************/
*              DO;                                                 0760
*                                                                  0760
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF THE RC IS FOR RECORD NOT FOUND OR IF THE  */
*              /*  END OF TRACK WAS ENCOUNTERED                      */
*              /*                                                    */
*              /******************************************************/
*              IF TESTRC = NTFNDRD  TESTRC = ENDTRK               0761
*                THEN                                              0761
*                                                                  0761
         CLC   TESTRC(2),@CH01990                                  0761
         BE    @RT00761                                            0761
         CLC   TESTRC(2),@CH00698                                  0761
         BNE   @RF00761                                            0761
@RT00761 DS    0H                                                  0762
*                  /**************************************************/
*                  /* RECORD NOT FOUND OR END OF TRACK ENCOUNTERED   */
*                  /*  ISSUE MESSAGE IDC31223I                       */
*                  /**************************************************/
*                                                                  0762
*                   DO;                                            0762
*                     CKREQ = CKREQ && CKREQ;                      0763
         L     @15,@PC00001+8                                      0763
         XC    CKREQ(44,@15),CKREQ(@15)                            0763
*                     CKRERN = MSG23;                              0764
         L     @15,@PC00001+8                                      0764
         MVC   CKRERN(2,@15),@CH00667                              0764
*                     CKRMVAR(1) = ADDR(MOKAD6);                   0765
         L     @15,@PC00001+8                                      0765
         LA    @14,MOKAD6                                          0765
         ST    @14,CKRMVAR(,@15)                                   0765
*                     CKRMVAR(2) = ADDR(RDCHR);                    0766
         L     @15,@PC00001+8                                      0766
         L     @14,@PC00001+8                                      0766
         L     @01,REPODSAR(,@14)                                  0766
         LA    @14,RDCHR(,@01)                                     0766
         ST    @14,CKRMVAR+4(,@15)                                 0766
*                     CKRMVAR(3) = ADDR(PARNA);                    0767
         L     @15,@PC00001+8                                      0767
         LA    @14,PARNA                                           0767
         ST    @14,CKRMVAR+8(,@15)                                 0767
*                     CKRMVAR(4) = ADDR(DSNMSG);                   0768
         L     @15,@PC00001+8                                      0768
         LA    @14,DSNMSG                                          0768
         ST    @14,CKRMVAR+12(,@15)                                0768
*                     CALL IDCRDER;                                0769
         L     @15,@CV01811                                        0769
         BALR  @14,@15                                             0769
*                   END;                                           0770
*                ELSE;                                             0771
@RF00761 DS    0H                                                  0772
*              CALL MODCLFP;                                       0772
         BAL   @14,MODCLFP                                         0772
*              RETURN CODE(LASTCC12);                              0773
         LA    @15,12                                              0773
         L     @14,@SA00002                                        0773
         LM    @00,@12,@SA00002+8                                  0773
         BR    @14                                                 0773
*              END;                                                0774
*            ELSE;                                                 0775
*                                                                  0775
@RF00759 DS    0H                                                  0776
*        /************************************************************/
*        /*                                                          */
*        /*               FOR  OUTPUT  DEVICE                        */
*        /* CALCULATE DEVICE MAX TRACK CAPACITY CONSTANTS            */
*        /* KYCNST (IN KYCNSTCH) HAS RECORD WITH KEY OVERHEAD        */
*        /* NOKYCNST HAS RECORD WITHOUT KEY OVERHEAD                 */
*        /* DEVTC HAS TRACK CAPACITY                                 */
*        /* SUMKEY WILL LATER HAVE NUMBER OF RECORDS WITH KEY        */
*        /* SUMNOKEY WILL LATER HAVE NUMBER OF RECORDS WITHOUT KEY   */
*        /*                                                          */
*        /************************************************************/
*        RFY DEVAREA BASED(REPODEVA);                              0776
*                                                                  0776
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF OVERHEAD FOR RECORD WITH KEY IS ONE OR TWO BYTES*/
*        /* IF INF4FLG IS ON, THEN OVERHEAD CONSTANT IS TWO BYTES    */
*        /*                                                          */
*        /************************************************************/
*        IF INF4FLG = ON                                           0777
*          THEN                                                    0777
         L     @15,@PC00001+8                                      0777
         L     @01,REPODEVA(,@15)                                  0777
         TM    INF4FLG(@01),B'00001000'                            0777
         BNO   @RF00777                                            0777
*            KYCNSTCH = DEVBOH;                                    0778
         L     @15,@PC00001+8                                      0778
         L     @01,REPODEVA(,@15)                                  0778
         MVC   KYCNSTCH(2),DEVBOH(@01)                             0778
*          ELSE                                                    0779
*            KYCNST   = DEVBOH1;                                   0779
         B     @RC00777                                            0779
@RF00777 L     @15,@PC00001+8                                      0779
         L     @01,REPODEVA(,@15)                                  0779
         SLR   @00,@00                                             0779
         IC    @00,DEVBOH1(,@01)                                   0779
         STH   @00,KYCNST                                          0779
*        NOKYCNST = KYCNST - DEVKC;                                0780
*                                                                  0780
@RC00777 L     @15,@PC00001+8                                      0780
         L     @01,REPODEVA(,@15)                                  0780
         LH    @00,KYCNST                                          0780
         N     @00,@CF02153                                        0780
         SLR   @15,@15                                             0780
         IC    @15,DEVKC(,@01)                                     0780
         SLR   @00,@15                                             0780
         STC   @00,NOKYCNST                                        0780
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IS OUTPUT RECORD IS OVERFLOW                       */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC = OVFLRCD                                       0781
*          THEN                                                    0781
         CLC   TESTRC(2),@CH00044                                  0781
         BNE   @RF00781                                            0781
*              OVFLSW = YESS;                                      0782
         MVI   OVFLSW,X'01'                                        0782
*            ELSE                                                  0783
*              OVFLSW = NOT;                                       0783
         B     @RC00781                                            0783
@RF00781 MVI   OVFLSW,X'00'                                        0783
*          BFPTROUT = RDDARE - LENGTH(RB1NUM);                     0784
@RC00781 L     @15,@PC00001+8                                      0784
         L     @01,REPODSAR(,@15)                                  0784
         L     @15,RDDARE(,@01)                                    0784
         SL    @15,@CF00044                                        0784
         ST    @15,BFPTROUT                                        0784
*          RFY RB1 BASED (BFPTROUT);                               0785
*                                                                  0785
*          /**********************************************************/
*          /*                                                        */
*          /* COMPUTE THE ADDRESS OF THE NEXT RECORD AND SAVE IT IN  */
*          /* SVDTADDR. THIS ADDRESS WILL BE NEEDED IN CASE OF A     */
*          /* FORMAT WRITE                                           */
*          /*                                                        */
*          /**********************************************************/
*          SVDTADDR = RDDARE+ RB1CKL + RB1CDL + LENGTH(RB1C);      0786
*                                                                  0786
         L     @15,@PC00001+8                                      0786
         L     @01,REPODSAR(,@15)                                  0786
         L     @15,BFPTROUT                                        0786
         SLR   @14,@14                                             0786
         IC    @14,RB1CKL(,@15)                                    0786
         AL    @14,RDDARE(,@01)                                    0786
         L     @15,BFPTROUT                                        0786
         LH    @15,RB1CDL(,@15)                                    0786
         N     @15,@CF02153                                        0786
         ALR   @14,@15                                             0786
         AL    @14,@CF00181                                        0786
         ST    @14,SVDTADDR                                        0786
*        /************************************************************/
*        /*                                                          */
*        /* CALL MODDSOUT TO MODIFY ONE RECORD IN A DATA SET OR      */
*        /*  VTOCHEADER                                              */
*        /*                                                          */
*        /************************************************************/
*          CALL MODDSOUT;                                          0787
         BAL   @14,MODDSOUT                                        0787
*          RESPECIFY RTNREG RSTD;                                  0788
*          TESTRC = RTNREG;                                        0789
         STH   RTNREG,TESTRC                                       0789
*          RESPECIFY RTNREG UNRSTD;                                0790
*          CALL MODCLFP;                                           0791
         BAL   @14,MODCLFP                                         0791
*          RETURN CODE(TESTRC);                                    0792
         LH    @15,TESTRC                                          0792
         L     @14,@SA00002                                        0792
         LM    @00,@12,@SA00002+8                                  0792
         BR    @14                                                 0792
*MODROUT:   PROCEDURE;                                             0793
MODROUT  STM   @14,@12,@SA00003                                    0793
*        /************************************************************/
*        /*                                                          */
*        /* SUBROUTINE NAME - MODROUT                                */
*        /*                                                          */
*        /* FUNCTION -                                               */
*        /*                                                          */
*        /*  THIS PROCEDURE WILL MODIFY ONE RECORD (OUTPUT) IN A     */
*        /*  A REPAIR WORKFILE.                                      */
*        /*  IF THE INPUT IS A RECORD, THE BFPTRIN IS NOT NULL.      */
*        /*  IF BFPTRIN IS NULL, THE INPUT IS  A DATA STRING         */
*        /*  AND  DATA IS IN AREA RB3. THE OUTPUT RECORD IS IN AREA  */
*        /*  RB2 POINTED BY BFPTROUT                                 */
*        /*                                                          */
*        /*                                                          */
*        /* NOTES -                                                  */
*        /*                                                          */
*        /*    DEPENDENCIES - NONE                                   */
*        /*                                                          */
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */
*        /*                   AND IDCRD06 RESPECTIVELY               */
*        /*                                                          */
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */
*        /*                                                          */
*        /*    PATCH LABEL - 'UPATCHIT'                              */
*        /*                                                          */
*        /* ENTRY POINT - MODROUT (ONLY ENTRY POINT)                 */
*        /*                                                          */
*        /*    PURPOSE - INVOKED TO PERFORM THE REPAIRV FSR          */
*        /*    MODIFY  FUNCTION  FOR A RECORD IN A REPAIR WORKFILE   */
*        /*                                                          */
*        /*    LINKAGE - 'CALL MODROUT'                              */
*        /*                                                          */
*        /*    INPUT -                                               */
*        /*                                                          */
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */
*        /*       A) DATA STRING SPECFIED IN THE COMMAND             */
*        /*       B) A RECORD IN A DATA SET                          */
*        /*       C) A RECORD IN A REPAIR WORKFILE                   */
*        /*                                                          */
*        /*    OUTPUT -                                              */
*        /*                                                          */
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */
*        /*       A) A MODIFIED RECORD IN A REPAIR WORKFILE          */
*        /*                                                          */
*        /*      ERROR MESSAGES: IDC31230I                           */
*        /*                      IDC31231I                           */
*        /*                      IDC31232I                           */
*        /*                      IDC31241I                           */
*        /*                                                          */
*        /*    EXIT, NORMAL -                                        */
*        /*                                                          */
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */
*        /*                                                          */
*        /*    EXIT, ERROR -                                         */
*        /*                                                          */
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */
*        /*                                                          */
*        /* INTERNAL REFERENCES -                                    */
*        /*    PROCEDURES/SUBROUTINES CALLED                         */
*        /*                                                          */
*        /*    NONE                                                  */
*        /*                                                          */
*        /* EXTERNAL REFERENCES -                                    */
*        /*    MACROS/SVCS -                                         */
*        /*                                                          */
*        /*    ?MOVELONG - REPAIRV MVCL MACRO                        */
*        /*      EXECUTES MVCL INSTRUCTION WITH GPR'S 2,3,4 & 5      */
*        /*                                                          */
*        /*    ?UPDRDC - REPAIRV RECORD UPDATE ROUTINE               */
*        /*      UPDATES A RECORD IN A REPAIR WORKFILE               */
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */
*        /*                                                          */
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */
*        /*      WRITES ALL MESSAGES                                 */
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */
*        /*                                                          */
*        /* PROCEDURES/SUBROUTINES CALLED                            */
*        /*                                                          */
*        /*    NONE                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0794
*        /************************************************************/
*        /*                                                          */
*        /* SET DUMP POINT                                           */
*        /*                                                          */
*        /************************************************************/
*          IF GDTDBG = NULLPTR                                     0794
*            THEN;                                                 0794
         L     @15,@PC00001                                        0794
         L     @15,GDTDBG(,@15)                                    0794
         LTR   @15,@15                                             0794
         BZ    @RT00794                                            0794
*            ELSE                                                  0796
*              CALL IDCDB010(GDTTBL,'RD52');                       0796
*                                                                  0796
         L     @15,@PC00001                                        0796
         ST    @15,@AL00001                                        0796
         LA    @15,@CC02086                                        0796
         ST    @15,@AL00001+4                                      0796
         MVI   @AL00001+4,X'80'                                    0796
         L     @14,@PC00001                                        0796
         L     @15,GDTDBG(,@14)                                    0796
         LA    @01,@AL00001                                        0796
         BALR  @14,@15                                             0796
*        /************************************************************/
*        /*                                                          */
*        /* SET TRACE POINT                                          */
*        /*                                                          */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0797
@RT00794 L     @15,@PC00001                                        0797
         L     @01,GDTTR2(,@15)                                    0797
         L     @15,@PC00001                                        0797
         L     @15,GDTTR2(,@15)                                    0797
         MVC   @TS00001(95),NEWERID2(@15)                          0797
         MVC   OLDERID2(95,@01),@TS00001                           0797
*        NEWID2 = 'RD53';                                          0798
*                                                                  0798
         L     @15,@PC00001                                        0798
         L     @01,GDTTR2(,@15)                                    0798
         MVC   NEWID2(4,@01),@CC02087                              0798
*        /************************************************************/
*        /*                                                          */
*        /* CK FOR TYPE OF INPUT                                     */
*        /*                                                          */
*        /************************************************************/
*        IF BFPTRIN ^= NULLPTR                                     0799
*          THEN                                                    0799
         L     @15,BFPTRIN                                         0799
         LTR   @15,@15                                             0799
         BZ    @RF00799                                            0799
*            DO;                                                   0800
*                                                                  0800
*            /********************************************************/
*            /*                                                      */
*            /* INPUT IS IN RB3 POINTED TO BY BFPTRIN                */
*            /* WE WILL USE RWF2 AREA FOR INPUT                      */
*            /*                                                      */
*            /********************************************************/
*            BFPTRIN = BFPTRIN - KEYFLGLN + LENGTH(RB3NUM);        0801
         L     @15,@CF02135                                        0801
         AL    @15,BFPTRIN                                         0801
         ST    @15,BFPTRIN                                         0801
*            RFY RWF2 BASED (BFPTRIN);                             0802
*            RWF2KYFL = RWF1KYFL;                                  0803
         L     @01,BFPTRIN                                         0803
         L     @15,@PC00001+8                                      0803
         L     @15,WFIODAD(,@15)                                   0803
         MVC   RWF2KYFL(16,@01),RWF1KYFL(@15)                      0803
*            RWF2CHR = RWF1CHR;                                    0804
*                                                                  0804
         L     @01,BFPTRIN                                         0804
         L     @15,@PC00001+8                                      0804
         L     @15,WFIODAD(,@15)                                   0804
         MVC   RWF2CHR(5,@01),RWF1CHR(@15)                         0804
*            /********************************************************/
*            /*                                                      */
*            /* SET MODIFIED FLAG                                    */
*            /*                                                      */
*            /********************************************************/
*            IF RWF2FLG1 = UNMOD  RWF2FLG1 = DEBLOCKD             0805
*              THEN                                                0805
         L     @01,BFPTRIN                                         0805
         CLI   RWF2FLG1(@01),0                                     0805
         BE    @RT00805                                            0805
         L     @01,BFPTRIN                                         0805
         CLI   RWF2FLG1(@01),2                                     0805
         BNE   @RF00805                                            0805
@RT00805 DS    0H                                                  0806
*                RWF2FLG1 = RWF2FLG1 + 1;                          0806
         LA    @15,1                                               0806
         L     @14,BFPTRIN                                         0806
         SLR   @05,@05                                             0806
         IC    @05,RWF2FLG1(,@14)                                  0806
         ALR   @15,@05                                             0806
         L     @14,BFPTRIN                                         0806
         STC   @15,RWF2FLG1(,@14)                                  0806
*              ELSE;                                               0807
*                                                                  0807
@RF00805 DS    0H                                                  0808
*            /********************************************************/
*            /*                                                      */
*            /* UPDATE RECORD  LENGTH                                */
*            /*                                                      */
*            /********************************************************/
*            WFIODAD = BFPTRIN;                                    0808
         L     @15,@PC00001+8                                      0808
         L     @14,BFPTRIN                                         0808
         ST    @14,WFIODAD(,@15)                                   0808
*            WFIODLN = RWF2CKL + RWF2CDL +KEYFLGLN + COUNTLN;      0809
         L     @15,@PC00001+8                                      0809
         L     @01,BFPTRIN                                         0809
         SLR   @00,@00                                             0809
         IC    @00,RWF2CKL(,@01)                                   0809
         L     @01,BFPTRIN                                         0809
         LH    @01,RWF2CDL(,@01)                                   0809
         N     @01,@CF02153                                        0809
         ALR   @00,@01                                             0809
         AL    @00,@CF00312                                        0809
         ST    @00,WFIODLN(,@15)                                   0809
*            IF RWF2CDL = ZERO                                     0810
*              THEN                                                0810
         L     @01,BFPTRIN                                         0810
         LH    @15,RWF2CDL(,@01)                                   0810
         N     @15,@CF02153                                        0810
         LTR   @15,@15                                             0810
         BNZ   @RF00810                                            0810
*                WFIODLN = WFIODLN + 1;                            0811
         L     @15,@PC00001+8                                      0811
         L     @14,@PC00001+8                                      0811
         LA    @05,1                                               0811
         AL    @05,WFIODLN(,@14)                                   0811
         ST    @05,WFIODLN(,@15)                                   0811
*              ELSE;                                               0812
*                                                                  0812
@RF00810 DS    0H                                                  0813
*            /********************************************************/
*            /*                                                      */
*            /* CK IF IT WILL FIT IN RWF                             */
*            /*                                                      */
*            /********************************************************/
*            IF WFIODLN > (REPORWIO->IOCTRN)                       0813
*              THEN                                                0813
         L     @15,@PC00001+8                                      0813
         L     @14,@PC00001+8                                      0813
         L     @01,REPORWIO(,@14)                                  0813
         L     @00,WFIODLN(,@15)                                   0813
         C     @00,IOCTRN(,@01)                                    0813
         BNH   @RF00813                                            0813
*                DO;                                               0814
*                                                                  0814
*                /****************************************************/
*                /*                                                  */
*                /* INPUT TOO LONG. ISSUE MESSAGE IDC3121I           */
*                /*                                                  */
*                /****************************************************/
*                                                                  0815
*                 DO;                                              0815
*                   CKREQ = CKREQ && CKREQ;                        0816
         L     @15,@PC00001+8                                      0816
         XC    CKREQ(44,@15),CKREQ(@15)                            0816
*                   CKRERN = MSG31;                                0817
         L     @15,@PC00001+8                                      0817
         MVC   CKRERN(2,@15),@CH00046                              0817
*                   CKRMVAR(1) = ADDR(RWFDANA);                    0818
         L     @15,@PC00001+8                                      0818
         L     @14,RWFPTR1                                         0818
         ST    @14,CKRMVAR(,@15)                                   0818
*                   CALL IDCRDER;                                  0819
         L     @15,@CV01811                                        0819
         BALR  @14,@15                                             0819
*                 END;                                             0820
*                RETURN CODE(LASTCC12);                            0821
         LA    @15,12                                              0821
         L     @14,@SA00003                                        0821
         LM    @00,@12,@SA00003+8                                  0821
         BR    @14                                                 0821
*                END;                                              0822
*              ELSE;                                               0823
*                                                                  0823
@RF00813 DS    0H                                                  0824
*            /********************************************************/
*            /*                                                      */
*            /* UPDATE THE REPAIR WORK FILE WITH THE INPUT RECORD    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0824
*             DO;                                                  0824
*               WFREQ = ''B;                                       0825
         L     @15,@PC00001+8                                      0825
         XC    WFREQ(2,@15),WFREQ(@15)                             0825
*               WFRUPD = ON;      /*  UPDRCD */                    0826
         L     @15,@PC00001+8                                      0826
         OI    WFRUPD(@15),B'00010000'                             0826
*               WFRUP  = ON;      /* UPDATE */                     0827
         L     @15,@PC00001+8                                      0827
         OI    WFRUP(@15),B'01000000'                              0827
*               CALL IDCRDIO;                                      0828
         L     @15,@CV01814                                        0828
         BALR  @14,@15                                             0828
*               RFY RTNREG RSTD;                                   0829
*               TESTRC = RTNREG;                                   0830
         STH   RTNREG,TESTRC                                       0830
*               RFY RTNREG UNRSTD;                                 0831
*             END;                                                 0832
*            RETURN CODE(TESTRC);                                  0833
         LH    @15,TESTRC                                          0833
         L     @14,@SA00003                                        0833
         LM    @00,@12,@SA00003+8                                  0833
         BR    @14                                                 0833
*            END;                                                  0834
*          ELSE;                                                   0835
*                                                                  0835
@RF00799 DS    0H                                                  0836
*        /************************************************************/
*        /*                                                          */
*        /* THE OUTPUT IS IN RB2 AND INPUT IS A STRING               */
*        /* SET THE NEW RECORD IN AREA RWF2 POINTED BY REPBUFF0      */
*        /*                                                          */
*        /************************************************************/
*        RFY RWF2 BASED (REPBUFF0);                                0836
*        RWF2KEY = RB2KEY;                                         0837
         L     @15,@PC00001+8                                      0837
         L     @01,REPBUFF0(,@15)                                  0837
         L     @15,@PC00001+8                                      0837
         L     @15,REPBUFF1(,@15)                                  0837
         MVC   RWF2KEY(11,@01),RB2KEY(@15)                         0837
*        RWF2FLG = RB2FLG;                                         0838
*                                                                  0838
         L     @15,@PC00001+8                                      0838
         L     @01,REPBUFF0(,@15)                                  0838
         L     @15,@PC00001+8                                      0838
         L     @15,REPBUFF1(,@15)                                  0838
         MVC   RWF2FLG(5,@01),RB2FLG(@15)                          0838
*        /************************************************************/
*        /*                                                          */
*        /*    SET MODIFIED RECORD INDICATOR                         */
*        /*                                                          */
*        /************************************************************/
*        IF RWF2FLG1 = UNMOD  RWF2FLG1 = DEBLOCKD                 0839
*          THEN                                                    0839
         L     @15,@PC00001+8                                      0839
         L     @01,REPBUFF0(,@15)                                  0839
         CLI   RWF2FLG1(@01),0                                     0839
         BE    @RT00839                                            0839
         L     @15,@PC00001+8                                      0839
         L     @01,REPBUFF0(,@15)                                  0839
         CLI   RWF2FLG1(@01),2                                     0839
         BNE   @RF00839                                            0839
@RT00839 DS    0H                                                  0840
*            RWF2FLG1 = RWF2FLG1 + 1;                              0840
         L     @15,@PC00001+8                                      0840
         L     @01,REPBUFF0(,@15)                                  0840
         L     @15,@PC00001+8                                      0840
         L     @15,REPBUFF0(,@15)                                  0840
         LA    @14,1                                               0840
         SLR   @00,@00                                             0840
         IC    @00,RWF2FLG1(,@15)                                  0840
         ALR   @14,@00                                             0840
         STC   @14,RWF2FLG1(,@01)                                  0840
*          ELSE;                                                   0841
*                                                                  0841
@RF00839 DS    0H                                                  0842
*        /************************************************************/
*        /*                                                          */
*        /*  IF NEWCOUNT KEYWORD IS PRESENT, PROCESS NEWCOUNT        */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MNCNT) ^= NULLPTR                                 0842
*          THEN                                                    0842
*                                                                  0842
         L     @15,@PC00001+4                                      0842
         L     @15,FDTPTR+368(,@15)                                0842
         LTR   @15,@15                                             0842
         BZ    @RF00842                                            0842
*            /********************************************************/
*            /* CHECK THAT THE NEWCOUNT PARAMETER LENGTH IS 8        */
*            /********************************************************/
*            DO;                                                   0843
*            IF MNCNTLEN ^= COUNTLN                                0844
*              THEN                                                0844
*                                                                  0844
         L     @15,@PC00001+4                                      0844
         L     @01,FDTPTR+368(,@15)                                0844
         CLI   MNCNTLEN(@01),8                                     0844
         BE    @RF00844                                            0844
*                /****************************************************/
*                /* BAD COUNT LENGTH ISSUE MESSAGE IDC31241I         */
*                /****************************************************/
*                DO;                                               0845
*                                                                  0845
*                 DO;                                              0846
*                   CKREQ = CKREQ && CKREQ;                        0847
         L     @15,@PC00001+8                                      0847
         XC    CKREQ(44,@15),CKREQ(@15)                            0847
*                   CKRERN = MSG41;                                0848
         L     @15,@PC00001+8                                      0848
         MVC   CKRERN(2,@15),@CH00736                              0848
*                   CALL IDCRDER;                                  0849
         L     @15,@CV01811                                        0849
         BALR  @14,@15                                             0849
*                 END;                                             0850
*                RETURN CODE(LASTCC12);                            0851
         LA    @15,12                                              0851
         L     @14,@SA00003                                        0851
         LM    @00,@12,@SA00003+8                                  0851
         BR    @14                                                 0851
*                END;                                              0852
*              ELSE;                                               0853
@RF00844 DS    0H                                                  0854
*            RWF2C = MNCNTVAL;                                     0854
         L     @15,@PC00001+8                                      0854
         L     @01,REPBUFF0(,@15)                                  0854
         L     @15,@PC00001+4                                      0854
         L     @15,FDTPTR+368(,@15)                                0854
         MVC   RWF2C(8,@01),MNCNTVAL(@15)                          0854
*            END;                                                  0855
*          ELSE                                                    0856
*            RWF2C = RB2C;                                         0856
*                                                                  0856
         B     @RC00842                                            0856
@RF00842 L     @15,@PC00001+8                                      0856
         L     @01,REPBUFF0(,@15)                                  0856
         L     @15,@PC00001+8                                      0856
         L     @15,REPBUFF1(,@15)                                  0856
         MVC   RWF2C(8,@01),RB2C(@15)                              0856
*        /************************************************************/
*        /*  MOVE KEY IF PRESENT                                     */
*        /************************************************************/
*        IF RB2CKL ^= ZERO                                         0857
*          THEN                                                    0857
@RC00842 L     @15,@PC00001+8                                      0857
         L     @01,REPBUFF1(,@15)                                  0857
         CLI   RB2CKL(@01),0                                       0857
         BE    @RF00857                                            0857
*            RWF2KD(1:RB2CKL) = RB2KD(1:RB2CKL);                   0858
         L     @15,@PC00001+8                                      0858
         L     @01,REPBUFF0(,@15)                                  0858
         L     @15,@PC00001+8                                      0858
         L     @15,REPBUFF1(,@15)                                  0858
         SLR   @14,@14                                             0858
         IC    @14,RB2CKL(,@15)                                    0858
         BCTR  @14,0                                               0858
         L     @15,@PC00001+8                                      0858
         L     @15,REPBUFF1(,@15)                                  0858
         EX    @14,@SM02156                                        0858
*          ELSE;                                                   0859
*                                                                  0859
@RF00857 DS    0H                                                  0860
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF NEWKEY PRESENT                                  */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MNKEY) ^= NULLPTR                                 0860
*          THEN                                                    0860
*                                                                  0860
         L     @15,@PC00001+4                                      0860
         L     @15,FDTPTR+364(,@15)                                0860
         LTR   @15,@15                                             0860
         BZ    @RF00860                                            0860
*            /********************************************************/
*            /*                                                      */
*            /* CHECK IF NEWKEY PARAMETER LENGTH IS OK, THAT IS, THE */
*            /*  LENGTH IS LESS THAN 256 AND THE OFFSET IS NOT       */
*            /*  GREATER THAN THE CURRENT KEY LENGTH + 1             */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0861
*            IF (MNKOFVAL > RB2CKL+1)  (MNKOFVAL+MNKSTLEN-1) >KEYMAXLN
*              THEN                                                0862
         L     @15,@PC00001+4                                      0862
         L     @01,FDTPTR+472(,@15)                                0862
         L     @15,@PC00001+8                                      0862
         L     @15,REPBUFF1(,@15)                                  0862
         LA    @14,1                                               0862
         SLR   @00,@00                                             0862
         IC    @00,RB2CKL(,@15)                                    0862
         ALR   @14,@00                                             0862
         C     @14,MNKOFVAL(,@01)                                  0862
         BL    @RT00862                                            0862
         L     @15,@PC00001+4                                      0862
         L     @01,FDTPTR+472(,@15)                                0862
         L     @15,@PC00001+4                                      0862
         L     @15,FDTPTR+476(,@15)                                0862
         SLR   @14,@14                                             0862
         IC    @14,MNKSTLEN(,@15)                                  0862
         AL    @14,MNKOFVAL(,@01)                                  0862
         BCTR  @14,0                                               0862
         C     @14,@CF00987                                        0862
         BNH   @RF00862                                            0862
@RT00862 DS    0H                                                  0863
*                DO;                                               0863
*                                                                  0863
*                /****************************************************/
*                /* BAD OFFSET ISSUE MESSAGE IDC31230I               */
*                /****************************************************/
*                                                                  0864
*                 DO;                                              0864
*                   CKREQ = CKREQ && CKREQ;                        0865
         L     @15,@PC00001+8                                      0865
         XC    CKREQ(44,@15),CKREQ(@15)                            0865
*                   CKRERN = MSG30;                                0866
         L     @15,@PC00001+8                                      0866
         MVC   CKRERN(2,@15),@CH00698                              0866
*                   CKRMVAR(1) = ADDR(MNKOFVAL);                   0867
         L     @15,@PC00001+8                                      0867
         L     @14,@PC00001+4                                      0867
         L     @14,FDTPTR+472(,@14)                                0867
         ST    @14,CKRMVAR(,@15)                                   0867
*                   CALL IDCRDER;                                  0868
         L     @15,@CV01811                                        0868
         BALR  @14,@15                                             0868
*                 END;                                             0869
*                RETURN CODE(LASTCC12);                            0870
         LA    @15,12                                              0870
         L     @14,@SA00003                                        0870
         LM    @00,@12,@SA00003+8                                  0870
         BR    @14                                                 0870
*                END;                                              0871
*              ELSE;                                               0872
*                                                                  0872
@RF00862 DS    0H                                                  0873
*            /********************************************************/
*            /*                                                      */
*            /* CHECK IF KEY FIELD WILL EXPAND                       */
*            /*                                                      */
*            /********************************************************/
*            IF RB2CKL = ZERO  RB2CKL< (MNKOFVAL+MNKSTLEN-1)      0873
*              THEN                                                0873
*                                                                  0873
         L     @15,@PC00001+8                                      0873
         L     @01,REPBUFF1(,@15)                                  0873
         CLI   RB2CKL(@01),0                                       0873
         BE    @RT00873                                            0873
         L     @15,@PC00001+8                                      0873
         L     @01,REPBUFF1(,@15)                                  0873
         L     @15,@PC00001+4                                      0873
         L     @15,FDTPTR+472(,@15)                                0873
         L     @14,@PC00001+4                                      0873
         L     @14,FDTPTR+476(,@14)                                0873
         SLR   @00,@00                                             0873
         IC    @00,MNKSTLEN(,@14)                                  0873
         AL    @00,MNKOFVAL(,@15)                                  0873
         BCTR  @00,0                                               0873
         SLR   @15,@15                                             0873
         IC    @15,RB2CKL(,@01)                                    0873
         CR    @00,@15                                             0873
         BNH   @RF00873                                            0873
@RT00873 DS    0H                                                  0874
*                /****************************************************/
*                /*                                                  */
*                /* KEY FIELD WILL EXPAND                            */
*                /*                                                  */
*                /****************************************************/
*                RWF2CKL = MNKOFVAL+MNKSTLEN - 1;                  0874
         L     @15,@PC00001+8                                      0874
         L     @01,REPBUFF0(,@15)                                  0874
         L     @15,@PC00001+4                                      0874
         L     @15,FDTPTR+472(,@15)                                0874
         L     @14,@PC00001+4                                      0874
         L     @14,FDTPTR+476(,@14)                                0874
         SLR   @00,@00                                             0874
         IC    @00,MNKSTLEN(,@14)                                  0874
         AL    @00,MNKOFVAL(,@15)                                  0874
         BCTR  @00,0                                               0874
         STC   @00,RWF2CKL(,@01)                                   0874
*              ELSE;                                               0875
*                                                                  0875
@RF00873 DS    0H                                                  0876
*            /********************************************************/
*            /*                                                      */
*            /* NOW MOVE THE KEY INPUT STRING                        */
*            /*                                                      */
*            /********************************************************/
*            RWF2KD(MNKOFVAL:(MNKSTLEN+MNKOFVAL-1)) = MNKSTVAL;    0876
*                                                                  0876
         L     @15,@PC00001+4                                      0876
         L     @01,FDTPTR+472(,@15)                                0876
         L     @01,MNKOFVAL(,@01)                                  0876
         L     @15,@PC00001+8                                      0876
         L     @15,REPBUFF0(,@15)                                  0876
         ALR   @15,@01                                             0876
         L     @14,@PC00001+4                                      0876
         L     @01,FDTPTR+476(,@14)                                0876
         L     @14,@PC00001+4                                      0876
         L     @14,FDTPTR+472(,@14)                                0876
         SLR   @05,@05                                             0876
         IC    @05,MNKSTLEN(,@01)                                  0876
         AL    @05,MNKOFVAL(,@14)                                  0876
         L     @14,@PC00001+4                                      0876
         L     @01,FDTPTR+472(,@14)                                0876
         SL    @05,MNKOFVAL(,@01)                                  0876
         BCTR  @05,0                                               0876
         L     @14,@PC00001+4                                      0876
         L     @01,FDTPTR+476(,@14)                                0876
         EX    @05,@SM02158                                        0876
*            /********************************************************/
*            /*                                                      */
*            /* CHECK THAT THE RECORD UPDATED WITH THE NEW KEY IN NOT*/
*            /*  LARGER THAN THE REPAIR WORKFILE MAXIMUN RECORD SIZE,*/
*            /*  WHICH IS THE ORIGINAL RECORD DEVICE TRACK CAPACITY  */
*            /*                                                      */
*            /********************************************************/
*            IF (REPR1LN+(RWF2CKL-RB2CKL))> REPORWIO->IOCTRN       0877
*              THEN                                                0877
         L     @15,@PC00001+8                                      0877
         L     @14,@PC00001+8                                      0877
         L     @01,REPBUFF0(,@14)                                  0877
         L     @14,@PC00001+8                                      0877
         L     @14,REPBUFF1(,@14)                                  0877
         SLR   @00,@00                                             0877
         IC    @00,RWF2CKL(,@01)                                   0877
         SLR   @01,@01                                             0877
         IC    @01,RB2CKL(,@14)                                    0877
         SLR   @00,@01                                             0877
         LH    @01,REPR1LN(,@15)                                   0877
         N     @01,@CF02153                                        0877
         ALR   @00,@01                                             0877
         L     @01,@PC00001+8                                      0877
         L     @01,REPORWIO(,@01)                                  0877
         C     @00,IOCTRN(,@01)                                    0877
         BNH   @RF00877                                            0877
*                DO;                                               0878
*                                                                  0878
*                /****************************************************/
*                /*  RECORD IS TOO LONG.  ISSUE MESSAGE IDC31232     */
*                /****************************************************/
*                                                                  0879
*                 DO;                                              0879
*                   CKREQ = CKREQ && CKREQ;                        0880
         L     @15,@PC00001+8                                      0880
         XC    CKREQ(44,@15),CKREQ(@15)                            0880
*                   CKRERN = MSG32;                                0881
         L     @15,@PC00001+8                                      0881
         MVC   CKRERN(2,@15),@CH00223                              0881
*                   CKRMVAR(1) = ADDR(RWFDANA);                    0882
         L     @15,@PC00001+8                                      0882
         L     @14,RWFPTR1                                         0882
         ST    @14,CKRMVAR(,@15)                                   0882
*                   CALL IDCRDER;                                  0883
         L     @15,@CV01811                                        0883
         BALR  @14,@15                                             0883
*                 END;                                             0884
*                RETURN CODE(LASTCC12);                            0885
         LA    @15,12                                              0885
         L     @14,@SA00003                                        0885
         LM    @00,@12,@SA00003+8                                  0885
         BR    @14                                                 0885
*                END;                                              0886
*              ELSE;                                               0887
*                                                                  0887
@RF00877 DS    0H                                                  0888
*            /********************************************************/
*            /* END OF NEWKEY                                        */
*            /********************************************************/
*            END;                                                  0888
*                                                                  0888
*            /********************************************************/
*            /*                                                      */
*            /* MOVE THE DATA TO RWF2KD+RWF2CKL                      */
*            /*                                                      */
*            /********************************************************/
*            TARPTR = ADDR(RWF2KD) + RWF2CKL;                      0889
@RF00860 L     @15,@PC00001+8                                      0889
         L     @01,REPBUFF0(,@15)                                  0889
         LA    @15,RWF2KD(,@01)                                    0889
         L     @14,@PC00001+8                                      0889
         L     @01,REPBUFF0(,@14)                                  0889
         SLR   @14,@14                                             0889
         IC    @14,RWF2CKL(,@01)                                   0889
         ALR   @15,@14                                             0889
         ST    @15,TARPTR                                          0889
*            SOURPTR = ADDR(RB2KD) + RB2CKL;                       0890
*                                                                  0890
         L     @15,@PC00001+8                                      0890
         L     @01,REPBUFF1(,@15)                                  0890
         LA    @15,RB2KD(,@01)                                     0890
         L     @14,@PC00001+8                                      0890
         L     @01,REPBUFF1(,@14)                                  0890
         SLR   @14,@14                                             0890
         IC    @14,RB2CKL(,@01)                                    0890
         ALR   @15,@14                                             0890
         ST    @15,SOURPTR                                         0890
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      0891
*             REG2 = TARPTR;                                       0892
         L     REG2,TARPTR                                         0892
*             REG3 = RB2CDL;                                       0893
         L     @15,@PC00001+8                                      0893
         L     @01,REPBUFF1(,@15)                                  0893
         LH    REG3,RB2CDL(,@01)                                   0893
         N     REG3,@CF02153                                       0893
*             REG4 = SOURPTR;                                      0894
         L     REG4,SOURPTR                                        0894
*             REG5 = RB2CDL;                                       0895
         L     @15,@PC00001+8                                      0895
         L     @01,REPBUFF1(,@15)                                  0895
         LH    REG5,RB2CDL(,@01)                                   0895
         N     REG5,@CF02153                                       0895
*             MVCL (REG2,REG4);                                    0896
         MVCL  REG2,REG4                                           0896
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     0897
*            /********************************************************/
*            /*                                                      */
*            /* CHECK IS NEWDATA KEYWORD PRESENT                     */
*            /*                                                      */
*            /********************************************************/
*            IF ADDR(MNDAT) ^= NULLPTR                             0898
*              THEN                                                0898
*                                                                  0898
         L     @15,@PC00001+4                                      0898
         L     @15,FDTPTR+360(,@15)                                0898
         LTR   @15,@15                                             0898
         BZ    @RF00898                                            0898
*                /****************************************************/
*                /*                                                  */
*                /* CHECK THAT THE NEWDATA OFFSET IS NOT             */
*                /*  LARGER THAN THE CURRENT DATA LENGTH + 1         */
*                /*                                                  */
*                /****************************************************/
*                DO;                                               0899
*                IF MNDOFVAL > RB2CDL + 1                          0900
*                  THEN                                            0900
*                                                                  0900
         L     @15,@PC00001+4                                      0900
         L     @01,FDTPTR+464(,@15)                                0900
         L     @15,@PC00001+8                                      0900
         L     @15,REPBUFF1(,@15)                                  0900
         LA    @14,1                                               0900
         LH    @15,RB2CDL(,@15)                                    0900
         N     @15,@CF02153                                        0900
         ALR   @14,@15                                             0900
         C     @14,MNDOFVAL(,@01)                                  0900
         BNL   @RF00900                                            0900
*                   /*************************************************/
*                   /*NEWDATA OFFSET OUTSIDE DATA FIELD. ISSUE       */
*                   /* MESSAGE IDC31230I                             */
*                   /*************************************************/
*                    DO;                                           0901
*                                                                  0901
*                     DO;                                          0902
*                       CKREQ = CKREQ && CKREQ;                    0903
         L     @15,@PC00001+8                                      0903
         XC    CKREQ(44,@15),CKREQ(@15)                            0903
*                       CKRERN = MSG30;                            0904
         L     @15,@PC00001+8                                      0904
         MVC   CKRERN(2,@15),@CH00698                              0904
*                       CKRMVAR(1) = ADDR(MNDOFVAL);               0905
         L     @15,@PC00001+8                                      0905
         L     @14,@PC00001+4                                      0905
         L     @14,FDTPTR+464(,@14)                                0905
         ST    @14,CKRMVAR(,@15)                                   0905
*                       CALL IDCRDER;                              0906
         L     @15,@CV01811                                        0906
         BALR  @14,@15                                             0906
*                     END;                                         0907
*                    RETURN CODE(LASTCC12);                        0908
         LA    @15,12                                              0908
         L     @14,@SA00003                                        0908
         LM    @00,@12,@SA00003+8                                  0908
         BR    @14                                                 0908
*                    END;                                          0909
*                  ELSE;                                           0910
*                                                                  0910
@RF00900 DS    0H                                                  0911
*                /****************************************************/
*                /*                                                  */
*                /* CHECK IF DATA FIELD WILL INCREASE                */
*                /*                                                  */
*                /****************************************************/
*                IF RB2CDL<(MNDOFVAL+MNDSTLEN-1)                   0911
*                  THEN                                            0911
*                                                                  0911
         L     @15,@PC00001+8                                      0911
         L     @01,REPBUFF1(,@15)                                  0911
         L     @15,@PC00001+4                                      0911
         L     @15,FDTPTR+464(,@15)                                0911
         L     @14,@PC00001+4                                      0911
         L     @14,FDTPTR+468(,@14)                                0911
         SLR   @00,@00                                             0911
         IC    @00,MNDSTLEN(,@14)                                  0911
         AL    @00,MNDOFVAL(,@15)                                  0911
         BCTR  @00,0                                               0911
         LH    @01,RB2CDL(,@01)                                    0911
         N     @01,@CF02153                                        0911
         CR    @00,@01                                             0911
         BNH   @RF00911                                            0911
*                    /************************************************/
*                    /* DATA LENGTH WILL INCREASE                    */
*                    /* CHECK IF THE RECORD UPDATED WITH THE NEWDATA */
*                    /*  PARAMETER IS NOT LARGER THAN THE REPAIR     */
*                    /*  WORKFILE RECORD MAXIMUN SIZE, WHICH IS THE  */
*                    /*  ORIGINAL RECORD DEVICE TRACK CAPACITY       */
*                    /*                                              */
*                    /************************************************/
*                    DO;                                           0912
*                    NEWLN= KEYFLGLN + COUNTLN + RWF2CKL + MNDOFVAL
*                         + MNDSTLEN - 1;                          0913
         L     @15,@PC00001+8                                      0913
         L     @01,REPBUFF0(,@15)                                  0913
         LA    @00,24                                              0913
         SLR   @15,@15                                             0913
         IC    @15,RWF2CKL(,@01)                                   0913
         ALR   @00,@15                                             0913
         L     @01,@PC00001+4                                      0913
         L     @01,FDTPTR+464(,@01)                                0913
         AL    @00,MNDOFVAL(,@01)                                  0913
         L     @01,@PC00001+4                                      0913
         L     @01,FDTPTR+468(,@01)                                0913
         SLR   @15,@15                                             0913
         IC    @15,MNDSTLEN(,@01)                                  0913
         ALR   @00,@15                                             0913
         BCTR  @00,0                                               0913
         STH   @00,NEWLN                                           0913
*                    IF NEWLN > REPORWIO->IOCTRN                   0914
*                      THEN                                        0914
*                                                                  0914
         L     @15,@PC00001+8                                      0914
         L     @01,REPORWIO(,@15)                                  0914
         LH    @00,NEWLN                                           0914
         N     @00,@CF02153                                        0914
         C     @00,IOCTRN(,@01)                                    0914
         BNH   @RF00914                                            0914
*                        /********************************************/
*                        /* NEWDATA TOO LONG. ISSUE MESSAGE IDC31232I*/
*                        /********************************************/
*                        DO;                                       0915
*                                                                  0915
*                         DO;                                      0916
*                           CKREQ = CKREQ && CKREQ;                0917
         L     @15,@PC00001+8                                      0917
         XC    CKREQ(44,@15),CKREQ(@15)                            0917
*                           CKRERN = MSG32;                        0918
         L     @15,@PC00001+8                                      0918
         MVC   CKRERN(2,@15),@CH00223                              0918
*                           CKRMVAR(1) = ADDR(RWFDANA);            0919
         L     @15,@PC00001+8                                      0919
         L     @14,RWFPTR1                                         0919
         ST    @14,CKRMVAR(,@15)                                   0919
*                           CALL IDCRDER;                          0920
         L     @15,@CV01811                                        0920
         BALR  @14,@15                                             0920
*                         END;                                     0921
*                        RETURN CODE(LASTCC12);                    0922
         LA    @15,12                                              0922
         L     @14,@SA00003                                        0922
         LM    @00,@12,@SA00003+8                                  0922
         BR    @14                                                 0922
*                        END;                                      0923
*                      ELSE;                                       0924
*                                                                  0924
@RF00914 DS    0H                                                  0925
*                        /********************************************/
*                        /*                                          */
*                        /* RESET DATA LENGTH TO NEW DATA LENGTH     */
*                        /*                                          */
*                        /********************************************/
*                        RWF2CDL = MNDOFVAL + MNDSTLEN - 1;        0925
*                                                                  0925
         L     @15,@PC00001+8                                      0925
         L     @01,REPBUFF0(,@15)                                  0925
         L     @15,@PC00001+4                                      0925
         L     @15,FDTPTR+464(,@15)                                0925
         L     @14,@PC00001+4                                      0925
         L     @14,FDTPTR+468(,@14)                                0925
         SLR   @00,@00                                             0925
         IC    @00,MNDSTLEN(,@14)                                  0925
         AL    @00,MNDOFVAL(,@15)                                  0925
         BCTR  @00,0                                               0925
         STH   @00,RWF2CDL(,@01)                                   0925
*                    END;                                          0926
*                                                                  0926
*                  ELSE;                                           0927
*                                                                  0927
@RF00911 DS    0H                                                  0928
*                /****************************************************/
*                /*                                                  */
*                /* MOVE DATA INPUT STRING                           */
*                /*                                                  */
*                /****************************************************/
*                RWF2KD((RWF2CKL+MNDOFVAL):(MNDOFVAL+RWF2CKL       0928
*                               +MNDSTLEN-1))=MNDSTVAL;            0928
         L     @15,@PC00001+8                                      0928
         L     @01,REPBUFF0(,@15)                                  0928
         L     @15,@PC00001+4                                      0928
         L     @15,FDTPTR+464(,@15)                                0928
         SLR   @14,@14                                             0928
         IC    @14,RWF2CKL(,@01)                                   0928
         AL    @14,MNDOFVAL(,@15)                                  0928
         L     @15,@PC00001+8                                      0928
         L     @01,REPBUFF0(,@15)                                  0928
         ALR   @01,@14                                             0928
         L     @15,@PC00001+4                                      0928
         L     @15,FDTPTR+464(,@15)                                0928
         L     @14,@PC00001+8                                      0928
         L     @14,REPBUFF0(,@14)                                  0928
         SLR   @05,@05                                             0928
         IC    @05,RWF2CKL(,@14)                                   0928
         AL    @05,MNDOFVAL(,@15)                                  0928
         L     @04,@PC00001+4                                      0928
         L     @04,FDTPTR+468(,@04)                                0928
         SLR   @15,@15                                             0928
         IC    @15,MNDSTLEN(,@04)                                  0928
         ALR   @05,@15                                             0928
         L     @04,@PC00001+8                                      0928
         L     @04,REPBUFF0(,@04)                                  0928
         L     @15,@PC00001+4                                      0928
         L     @15,FDTPTR+464(,@15)                                0928
         SLR   @14,@14                                             0928
         IC    @14,RWF2CKL(,@04)                                   0928
         AL    @14,MNDOFVAL(,@15)                                  0928
         SLR   @05,@14                                             0928
         BCTR  @05,0                                               0928
         L     @04,@PC00001+4                                      0928
         L     @04,FDTPTR+468(,@04)                                0928
         EX    @05,@SM02160                                        0928
*                END;                                              0929
*              ELSE;                                               0930
*                                                                  0930
@RF00898 DS    0H                                                  0931
*              /******************************************************/
*              /*                                                    */
*              /* UPDATE THE RECORD                                  */
*              /*                                                    */
*              /******************************************************/
*              WFIODAD = ADDR(RWF2);                               0931
         L     @15,@PC00001+8                                      0931
         L     @14,@PC00001+8                                      0931
         L     @14,REPBUFF0(,@14)                                  0931
         ST    @14,WFIODAD(,@15)                                   0931
*              WFIODLN = KEYFLGLN + COUNTLN + RWF2CKL+RWF2CDL;     0932
*                                                                  0932
         L     @15,@PC00001+8                                      0932
         L     @14,@PC00001+8                                      0932
         L     @01,REPBUFF0(,@14)                                  0932
         LA    @14,24                                              0932
         SLR   @00,@00                                             0932
         IC    @00,RWF2CKL(,@01)                                   0932
         ALR   @14,@00                                             0932
         L     @05,@PC00001+8                                      0932
         L     @01,REPBUFF0(,@05)                                  0932
         LH    @05,RWF2CDL(,@01)                                   0932
         N     @05,@CF02153                                        0932
         ALR   @14,@05                                             0932
         ST    @14,WFIODLN(,@15)                                   0932
*               DO;                                                0933
*                 WFREQ = ''B;                                     0934
         L     @15,@PC00001+8                                      0934
         XC    WFREQ(2,@15),WFREQ(@15)                             0934
*                 WFRUPD = ON;      /*  UPDRCD */                  0935
         L     @15,@PC00001+8                                      0935
         OI    WFRUPD(@15),B'00010000'                             0935
*                 WFRUP  = ON;      /* UPDATE */                   0936
         L     @15,@PC00001+8                                      0936
         OI    WFRUP(@15),B'01000000'                              0936
*                 CALL IDCRDIO;                                    0937
         L     @15,@CV01814                                        0937
         BALR  @14,@15                                             0937
*                 RFY RTNREG RSTD;                                 0938
*                 TESTRC = RTNREG;                                 0939
         STH   RTNREG,TESTRC                                       0939
*                 RFY RTNREG UNRSTD;                               0940
*               END;                                               0941
*              RETURN CODE(TESTRC);                                0942
         LH    @15,TESTRC                                          0942
         L     @14,@SA00003                                        0942
         LM    @00,@12,@SA00003+8                                  0942
         BR    @14                                                 0942
*END MODROUT;                                                      0943
*MODRNG:   PROCEDURE;                                              0944
MODRNG   STM   @14,@12,@SA00004                                    0944
*        /************************************************************/
*        /*                                                          */
*        /* SUBROUTINE NAME - MODRNG                                 */
*        /*                                                          */
*        /* FUNCTION -                                               */
*        /*                                                          */
*        /* THIS PROCEDURE WILL PROCESS THE MODIFY REQUEST WHEN      */
*        /* INREPAIRRANGE IS PRESENT. THE INPUT RECORDS ARE IN A     */
*        /* REPAIR WORK FILE AND MUST BE DEBLOCKED STAGE ERROR       */
*        /* RECORDS.                                                 */
*        /* THE MINIMUM NUMBER OF RECORDS TO BE MODIFIED IS A FULL   */
*        /* TRACK AND THE MAXIMUM NUMBER IS A FULL CYLINDER.         */
*        /*                                                          */
*        /*                                                          */
*        /* NOTES -                                                  */
*        /*                                                          */
*        /*    DEPENDENCIES - NONE                                   */
*        /*                                                          */
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */
*        /*                   AND IDCRD06 RESPECTIVELY               */
*        /*                                                          */
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */
*        /*                                                          */
*        /*    PATCH LABEL - 'UPATCHIT'                              */
*        /*                                                          */
*        /* ENTRY POINT - MODRNG (ONLY ENTRY POINT)                  */
*        /*                                                          */
*        /*    PURPOSE - INVOKED TO PERFORM THE REPAIRV FSR          */
*        /*    MODIFY  FUNCTION  WHEN THE INPUT IS A RANGE OF        */
*        /*    RECORDS FROM A REPAIR WORKFILE                        */
*        /*                                                          */
*        /*    LINKAGE - 'CALL MODRNG'                               */
*        /*                                                          */
*        /*    INPUT -                                               */
*        /*                                                          */
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */
*        /*       A) A RANGE OF DEBLOCKED RECORDS IN A REPAIR        */
*        /*            WORKFILE                                      */
*        /*                                                          */
*        /*    OUTPUT -                                              */
*        /*                                                          */
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */
*        /*       A) A RANGE OF MODIFIED RECORDS EITHER IN A DATA    */
*        /*            SET OR VTOCHEADER                             */
*        /*                                                          */
*        /*      ERROR MESSAGES: IDC31213I                           */
*        /*                      IDC31225I                           */
*        /*                      IDC31226I                           */
*        /*                      IDC31227I                           */
*        /*                      IDC31228I                           */
*        /*                      IDC31229I                           */
*        /*                                                          */
*        /*    EXIT, NORMAL -                                        */
*        /*                                                          */
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */
*        /*                                                          */
*        /*    EXIT, ERROR -                                         */
*        /*                                                          */
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */
*        /*                                                          */
*        /* INTERNAL REFERENCES -                                    */
*        /*    PROCEDURES/SUBROUTINES CALLED                         */
*        /*                                                          */
*        /*    MODCLFP  - CLOSE FILES AND FREE POOLS SUBROUTINE      */
*        /*                                                          */
*        /* EXTERNAL REFERENCES -                                    */
*        /*    MACROS/SVCS -                                         */
*        /*                                                          */
*        /*    UEXCP - IDCAMS SYSTEM ADAPTER EXCP ROUTINE            */
*        /*      TO CLOSE, OPEN AND WRITE DATA SET OR VTOCHEADER     */
*        /*      RECORDS                                             */
*        /*      GENERATES A CALL TO MODULE IDCSADQO                 */
*        /*                                                          */
*        /*    ?GETRCD - REPAIRV GET RECORD ROUTINE                  */
*        /*      READS RECORDS FROM THE REPAIR WORKFILE              */
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */
*        /*                                                          */
*        /*    ?POSRCD - REPAIRV RECORD POSITIONING ROUTINE          */
*        /*      POSITIONS TO FIRST RECORD IN REPAIRRANGE            */
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */
*        /*                                                          */
*        /*    ?UPDRCD - REPAIRV RECORD UPDATE ROUTINE               */
*        /*      UPDATES A RECORD IN A REPAIR WORKFILE               */
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */
*        /*                                                          */
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */
*        /*      WRITES ALL MESSAGES                                 */
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */
*        /*                                                          */
*        /* PROCEDURES/SUBROUTINES CALLED                            */
*        /*                                                          */
*        /*    IDCRDDS - TO OPEN THE INPUT DATA SET OR               */
*        /*      VTOCHEADER AND OBTAIN BUFFER SPACE                  */
*        /*                                                          */
*        /*    IDCRDRF - TO OPEN THE REPAIR WORKFILE AND OBTAIN      */
*        /*      BUFFER AREAS                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0945
*        /************************************************************/
*        /*                                                          */
*        /* SET DUMP POINT                                           */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       0945
*          THEN;                                                   0945
         L     @15,@PC00001                                        0945
         L     @15,GDTDBG(,@15)                                    0945
         LTR   @15,@15                                             0945
         BZ    @RT00945                                            0945
*          ELSE                                                    0947
*            CALL IDCDB010(GDTTBL,'RD58');                         0947
*                                                                  0947
         L     @15,@PC00001                                        0947
         ST    @15,@AL00001                                        0947
         LA    @15,@CC02093                                        0947
         ST    @15,@AL00001+4                                      0947
         MVI   @AL00001+4,X'80'                                    0947
         L     @14,@PC00001                                        0947
         L     @15,GDTDBG(,@14)                                    0947
         LA    @01,@AL00001                                        0947
         BALR  @14,@15                                             0947
*        /************************************************************/
*        /*                                                          */
*        /* SET TRACE POINT                                          */
*        /*                                                          */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0948
@RT00945 L     @15,@PC00001                                        0948
         L     @01,GDTTR2(,@15)                                    0948
         L     @15,@PC00001                                        0948
         L     @15,GDTTR2(,@15)                                    0948
         MVC   @TS00001(95),NEWERID2(@15)                          0948
         MVC   OLDERID2(95,@01),@TS00001                           0948
*        NEWID2 = 'RD59';                                          0949
*                                                                  0949
         L     @15,@PC00001                                        0949
         L     @01,GDTTR2(,@15)                                    0949
         MVC   NEWID2(4,@01),@CC02094                              0949
*        /************************************************************/
*        /* ZERO RECORDS PROCESSED COUNTER                           */
*        /************************************************************/
*        REPRCDCT = 0;                                             0950
*                                                                  0950
         L     @15,@PC00001+8                                      0950
         SLR   @14,@14                                             0950
         ST    @14,REPRCDCT(,@15)                                  0950
*        /************************************************************/
*        /*                                                          */
*        /* CALL IDCRDRF TO OPEN THE REPAIR WORKFILE AND OBTAIN      */
*        /*  BUFFERS                                                 */
*        /*                                                          */
*        /************************************************************/
*        CALL IDCRDRF(IN);                                         0951
         L     @15,@CV01813                                        0951
         LA    @01,@AL00951                                        0951
         BALR  @14,@15                                             0951
*        RESPECIFY RTNREG RSTD;                                    0952
*        TESTRC = RTNREG;                                          0953
         STH   RTNREG,TESTRC                                       0953
*        RESPECIFY RTNREG UNRSTD;                                  0954
*                                                                  0954
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE RETURN CODE FROM IDCRDRF.  IF RC ^= 0 THEN     */
*        /*  RETURN WITH RC = 12                                     */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC ^= 0                                            0955
*          THEN                                                    0955
*                                                                  0955
         LH    @15,TESTRC                                          0955
         LTR   @15,@15                                             0955
         BZ    @RF00955                                            0955
*            /********************************************************/
*            /* BAD RETURN FROM IDCRDRF                              */
*            /********************************************************/
*            DO;                                                   0956
*            RETURN CODE(LASTCC12);                                0957
         LA    @15,12                                              0957
         L     @14,@SA00004                                        0957
         LM    @00,@12,@SA00004+8                                  0957
         BR    @14                                                 0957
*            END;                                                  0958
*          ELSE;                                                   0959
*                                                                  0959
@RF00955 DS    0H                                                  0960
*        /***********************************************************/
*        /*  SAVE REPIRWIO FOR CLOSE, AND SET ADDRRESSABILTY FOR DSN*/
*        /***********************************************************/
*        RWFPTR1= REPIRWIO-> IOCDSN;                               0960
*                                                                  0960
         L     @15,@PC00001+8                                      0960
         L     @01,REPIRWIO(,@15)                                  0960
         L     @15,IOCDSN(,@01)                                    0960
         ST    @15,RWFPTR1                                         0960
*        /************************************************************/
*        /*                                                          */
*        /* CK FIRST INPUT ADR SAME AS OUTPUT ADDRESS                */
*        /*  MODKAD HAS OUTPUT ADDRESS                               */
*        /*                                                          */
*        /************************************************************/
*        MIKAD6 = MRRVOVAL;                                        0961
         L     @15,@PC00001+4                                      0961
         L     @01,FDTPTR+452(,@15)                                0961
         MVC   MIKAD6(6),MRRVOVAL(@01)                             0961
*        MIKAD54= MRRCHVAL;                                        0962
         L     @15,@PC00001+4                                      0962
         L     @01,FDTPTR+456(,@15)                                0962
         MVC   MIKAD54(4),MRRCHVAL(@01)                            0962
*        MIKAD54R=ZERO;                                            0963
         MVI   MIKAD54R,X'00'                                      0963
*        IF MIKAD ^= MOKAD                                         0964
*          THEN                                                    0964
*                                                                  0964
         CLC   MIKAD(11),MOKAD                                     0964
         BE    @RF00964                                            0964
*            /********************************************************/
*            /* FIRST INPUT ADDRESS NOT EQUAL TO OUTPUT ADDRESS      */
*            /* ISSUE MESSAGE IDC31225I                              */
*            /********************************************************/
*            DO;                                                   0965
*                                                                  0965
*             DO;                                                  0966
*               CKREQ = CKREQ && CKREQ;                            0967
         L     @15,@PC00001+8                                      0967
         XC    CKREQ(44,@15),CKREQ(@15)                            0967
*               CKRERN = MSG25;                                    0968
         L     @15,@PC00001+8                                      0968
         MVC   CKRERN(2,@15),@CH00681                              0968
*               CKRMVAR(1) = ADDR(MOKAD6);                         0969
         L     @15,@PC00001+8                                      0969
         LA    @14,MOKAD6                                          0969
         ST    @14,CKRMVAR(,@15)                                   0969
*               CKRMVAR(2) = ADDR(MOKAD5);                         0970
         L     @15,@PC00001+8                                      0970
         LA    @14,MOKAD5                                          0970
         ST    @14,CKRMVAR+4(,@15)                                 0970
*               CKRMVAR(3) = ADDR(PARNA);                          0971
         L     @15,@PC00001+8                                      0971
         LA    @14,PARNA                                           0971
         ST    @14,CKRMVAR+8(,@15)                                 0971
*               CALL IDCRDER;                                      0972
         L     @15,@CV01811                                        0972
         BALR  @14,@15                                             0972
*             END;                                                 0973
*            RETURN CODE(LASTCC12);                                0974
         LA    @15,12                                              0974
         L     @14,@SA00004                                        0974
         LM    @00,@12,@SA00004+8                                  0974
         BR    @14                                                 0974
*            END;                                                  0975
*          ELSE;                                                   0976
*                                                                  0976
@RF00964 DS    0H                                                  0977
*        /************************************************************/
*        /*                                                          */
*        /* SET LAST ADDRESS   IN  MOKAD                             */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MRRHH) ^= NULLPTR                                 0977
*          THEN                                                    0977
         L     @15,@PC00001+4                                      0977
         L     @15,FDTPTR+460(,@15)                                0977
         LTR   @15,@15                                             0977
         BZ    @RF00977                                            0977
*            MOKAD5H = MRRHHVAL;                                   0978
         L     @15,@PC00001+4                                      0978
         L     @01,FDTPTR+460(,@15)                                0978
         MVC   MOKAD5H(2),MRRHHVAL(@01)                            0978
*          ELSE                                                    0979
*            MOKAD = MIKAD;                                        0979
*                                                                  0979
         B     @RC00977                                            0979
@RF00977 MVC   MOKAD(11),MIKAD                                     0979
*        /************************************************************/
*        /*                                                          */
*        /* CK LAST ADDR NOT LESS FIRST ADDRESS                      */
*        /*                                                          */
*        /************************************************************/
*        IF MOKAD < MIKAD                                          0980
*          THEN                                                    0980
*                                                                  0980
@RC00977 CLC   MOKAD(11),MIKAD                                     0980
         BNL   @RF00980                                            0980
*            /********************************************************/
*            /*  LAST (OUTPUT) ADDRESS IS LESS THAN FIRST( BEGINNING)*/
*            /*   ADDRESS.   ISSUE MESSAGE IDC31213I                 */
*            /********************************************************/
*            DO;                                                   0981
*                                                                  0981
*             DO;                                                  0982
*               CKREQ = CKREQ && CKREQ;                            0983
         L     @15,@PC00001+8                                      0983
         XC    CKREQ(44,@15),CKREQ(@15)                            0983
*               CKRERN = MSG13;                                    0984
         L     @15,@PC00001+8                                      0984
         MVC   CKRERN(2,@15),@CH00612                              0984
*               CKRMVAR(1) = ADDR(MIKAD54H);                       0985
         L     @15,@PC00001+8                                      0985
         LA    @14,MIKAD54H                                        0985
         ST    @14,CKRMVAR(,@15)                                   0985
*               CKRMVAR(2) = ADDR(MOKAD5H);                        0986
         L     @15,@PC00001+8                                      0986
         LA    @14,MOKAD5H                                         0986
         ST    @14,CKRMVAR+4(,@15)                                 0986
*               CKRMVAR(3) = ADDR(INRRCON);                        0987
         L     @15,@PC00001+8                                      0987
         LA    @14,INRRCON                                         0987
         ST    @14,CKRMVAR+8(,@15)                                 0987
*               CKRMVAR(4) = ADDR(RWFDANA);                        0988
         L     @15,@PC00001+8                                      0988
         L     @14,RWFPTR1                                         0988
         ST    @14,CKRMVAR+12(,@15)                                0988
*               CALL IDCRDER;                                      0989
         L     @15,@CV01811                                        0989
         BALR  @14,@15                                             0989
*             END;                                                 0990
*            RETURN CODE(LASTCC12);                                0991
         LA    @15,12                                              0991
         L     @14,@SA00004                                        0991
         LM    @00,@12,@SA00004+8                                  0991
         BR    @14                                                 0991
*            END;                                                  0992
*          ELSE;                                                   0993
*                                                                  0993
@RF00980 DS    0H                                                  0994
*        /************************************************************/
*        /* CALL IDCRDDS TO OPEN OUTPUT DATA SET OR VTOCHEADER AND   */
*        /* OBTAIN BUFFERS, SET COMMON OUTPUT DSN OR                 */
*        /* VTOCNAME AND SET ADDRESSABILITY FOR XTNTTBL              */
*        /************************************************************/
*        CALL IDCRDDS (OUT,MOKAD5);                                0994
         LA    @15,OUT                                             0994
         ST    @15,@AL00001                                        0994
         LA    @15,MOKAD5                                          0994
         ST    @15,@AL00001+4                                      0994
         L     @15,@CV01810                                        0994
         LA    @01,@AL00001                                        0994
         BALR  @14,@15                                             0994
*        RESPECIFY RTNREG RSTD;                                    0995
*        TESTRC = RTNREG;                                          0996
         STH   RTNREG,TESTRC                                       0996
*        RESPECIFY RTNREG UNRSTD;                                  0997
*                                                                  0997
*        /************************************************************/
*        /*  CHECK THE RETURN CODE FROM IDCRDDS. IF THE RC ^= 0 THEN */
*        /*   RETURN WITH RC = 12. SET REPENQSW = ZERO SO NO DEQUEUE */
*        /*   IS ISSUED LATER.                                       */
*        /************************************************************/
*        IF TESTRC ^= 0                                            0998
*          THEN                                                    0998
         LH    @15,TESTRC                                          0998
         LTR   @15,@15                                             0998
         BZ    @RF00998                                            0998
*            DO;                                                   0999
*            REPENQSW = ZERO;                                      1000
         L     @15,@PC00001+8                                      1000
         MVI   REPENQSW(@15),X'00'                                 1000
*            RETURN CODE(LASTCC12);                                1001
         LA    @15,12                                              1001
         L     @14,@SA00004                                        1001
         LM    @00,@12,@SA00004+8                                  1001
         BR    @14                                                 1001
*            END;                                                  1002
*          ELSE                                                    1003
*        SAVCLOUT=REPODSOP;                                        1003
*                                                                  1003
@RF00998 L     @15,@PC00001+8                                      1003
         L     @15,REPODSOP(,@15)                                  1003
         ST    @15,SAVCLOUT                                        1003
*        /************************************************************/
*        /*                                                          */
*        /*               FOR  OUTPUT  DEVICE                        */
*        /* CALCULATE DEVICE MAX TRACK CAPACITY CONSTANTS            */
*        /* KYCNST (IN KYCNSTCH) HAS RECORD WITH KEY OVERHEAD        */
*        /* NOKYCNST HAS RECORD WITHOUT KEY OVERHEAD                 */
*        /* DEVTC HAS TRACK CAPACITY                                 */
*        /* SUMKEY WILL LATER HAVE NUMBER OF RECORDS WITH KEY        */
*        /* SUMNOKEY WILL LATER HAVE NUMBER OF RECORDS WITHOUT KEY   */
*        /*                                                          */
*        /************************************************************/
*        RFY DEVAREA BASED(REPODEVA);                              1004
*                                                                  1004
*        /************************************************************/
*        /*                                                          */
*        /* CHECK IF THE KEY CONSTANT IN DEVICE TABLE IS ONE OR TWO  */
*        /*  BYTES, ACCORDING TO THE VALUE OF INF4FLG                */
*        /*                                                          */
*        /************************************************************/
*        IF INF4FLG = ON                                           1005
*          THEN                                                    1005
         L     @15,@PC00001+8                                      1005
         L     @01,REPODEVA(,@15)                                  1005
         TM    INF4FLG(@01),B'00001000'                            1005
         BNO   @RF01005                                            1005
*            KYCNSTCH = DEVBOH;                                    1006
         L     @15,@PC00001+8                                      1006
         L     @01,REPODEVA(,@15)                                  1006
         MVC   KYCNSTCH(2),DEVBOH(@01)                             1006
*          ELSE                                                    1007
*            KYCNST   = DEVBOH1;                                   1007
         B     @RC01005                                            1007
@RF01005 L     @15,@PC00001+8                                      1007
         L     @01,REPODEVA(,@15)                                  1007
         SLR   @00,@00                                             1007
         IC    @00,DEVBOH1(,@01)                                   1007
         STH   @00,KYCNST                                          1007
*        NOKYCNST = KYCNST - DEVKC;                                1008
@RC01005 L     @15,@PC00001+8                                      1008
         L     @01,REPODEVA(,@15)                                  1008
         LH    @00,KYCNST                                          1008
         N     @00,@CF02153                                        1008
         SLR   @15,@15                                             1008
         IC    @15,DEVKC(,@01)                                     1008
         SLR   @00,@15                                             1008
         STC   @00,NOKYCNST                                        1008
*        RFY XTNTTBL BASED(REPOXTNT);                              1009
*        RFY RDARG BASED (REPODSAR);                               1010
*                                                                  1010
*        /************************************************************/
*        /*  CHECK IF THE VTOCHEADERADDRESS PARAMETER IS PRESENT     */
*        /************************************************************/
*        IF ADDR(MVTOC) ^= NULLPTR                                 1011
*          THEN                                                    1011
*                                                                  1011
         L     @15,@PC00001+4                                      1011
         L     @15,FDTPTR+424(,@15)                                1011
         LTR   @15,@15                                             1011
         BZ    @RF01011                                            1011
*            /********************************************************/
*            /* VTOCHEADER ADDRESS  PARAMETER PRESENT                */
*            /* SET VTOCHEADERADDRESS LITERAL FOR MESSAGES           */
*            /********************************************************/
*            DSNMSG = VTOCNAME;                                    1012
         MVI   DSNMSG+10,C' '                                      1012
         MVC   DSNMSG+11(33),DSNMSG+10                             1012
         MVC   DSNMSG(10),VTOCNAME                                 1012
*          ELSE                                                    1013
*                                                                  1013
*            /********************************************************/
*            /* THE OUTPUT IS A DATA SET.  SET THE LITERAL FOR       */
*            /*  MESSAGES TO THE DSNAME                              */
*            /********************************************************/
*            DSNMSG = XTNHDSN;                                     1013
*                                                                  1013
         B     @RC01011                                            1013
@RF01011 L     @15,@PC00001+8                                      1013
         L     @01,REPOXTNT(,@15)                                  1013
         MVC   DSNMSG(44),XTNHDSN(@01)                             1013
*        /************************************************************/
*        /*                                                          */
*        /* CK ALL TRACKS BETWEEN FIRST & LAST ADDRESS EXISTS        */
*        /* FOR THE OUTPUT DATA EXTENT TABLE                         */
*        /*                                                          */
*        /************************************************************/
*        SMIKAD5 = MIKAD5;                                         1014
@RC01011 MVC   SMIKAD5(5),MIKAD5                                   1014
*        ILOOP = 1;                                                1015
         MVC   ILOOP(2),@CH00221                                   1015
*        DO WHILE (XTNTCHR1(ILOOP) ^= LASTEXT & SMIKAD5 <= MOKAD5);
*                                                                  1016
         B     @DE01016                                            1016
@DL01016 DS    0H                                                  1017
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THAT THE CURRENT FIRST ADDRESS IS >= THAN THE      */
*        /*  CURRENT FIRST EXTENT TABLE ENTRY AND THAT IS ALSO <=    */
*        /*  THAN THE CURRENT LAST EXTENT TABLE ENTRY                */
*        /************************************************************/
*        IF SMIKAD5 >= XTNTCHR1(ILOOP) & SMIKAD5 <= XTNTCHR2(ILOOP)
*          THEN                                                    1017
         LH    @15,ILOOP                                           1017
         N     @15,@CF02153                                        1017
         MH    @15,@CH02146                                        1017
         L     @14,@PC00001+8                                      1017
         L     @01,REPOXTNT(,@14)                                  1017
         ALR   @01,@15                                             1017
         CLC   SMIKAD5(5),XTNTCHR1-78(@01)                         1017
         BL    @RF01017                                            1017
         LH    @15,ILOOP                                           1017
         N     @15,@CF02153                                        1017
         MH    @15,@CH02146                                        1017
         L     @14,@PC00001+8                                      1017
         L     @01,REPOXTNT(,@14)                                  1017
         ALR   @01,@15                                             1017
         CLC   SMIKAD5(5),XTNTCHR2-78(@01)                         1017
         BH    @RF01017                                            1017
*            DO;                                                   1018
*            SMIHH = SMIHH + 1;                                    1019
         LA    @15,1                                               1019
         LH    @14,SMIHH                                           1019
         N     @14,@CF02153                                        1019
         ALR   @15,@14                                             1019
         STH   @15,SMIHH                                           1019
*            END;                                                  1020
*          ELSE                                                    1021
*            ILOOP = ILOOP + 1;                                    1021
         B     @RC01017                                            1021
@RF01017 LA    @15,1                                               1021
         LH    @14,ILOOP                                           1021
         N     @14,@CF02153                                        1021
         ALR   @15,@14                                             1021
         STH   @15,ILOOP                                           1021
*        END;                                                      1022
*                                                                  1022
@RC01017 DS    0H                                                  1022
@DE01016 LH    @15,ILOOP                                           1022
         N     @15,@CF02153                                        1022
         MH    @15,@CH02146                                        1022
         L     @14,@PC00001+8                                      1022
         L     @01,REPOXTNT(,@14)                                  1022
         ALR   @01,@15                                             1022
         CLC   XTNTCHR1-78(5,@01),LASTEXT                          1022
         BE    @DC01016                                            1022
         CLC   SMIKAD5(5),MOKAD5                                   1022
         BNH   @DL01016                                            1022
@DC01016 DS    0H                                                  1023
*        /************************************************************/
*        /*                                                          */
*        /* IF ALL TRACKS EXIST, XTNTCHR1 (ILOOP) IS NOT EQUAL TO    */
*        /* LASTEXT ( ALL X'FF').                                    */
*        /*                                                          */
*        /************************************************************/
*        IF XTNTCHR1(ILOOP) = LASTEXT                              1023
*          THEN                                                    1023
*                                                                  1023
         LH    @15,ILOOP                                           1023
         N     @15,@CF02153                                        1023
         MH    @15,@CH02146                                        1023
         L     @14,@PC00001+8                                      1023
         L     @01,REPOXTNT(,@14)                                  1023
         ALR   @01,@15                                             1023
         CLC   XTNTCHR1-78(5,@01),LASTEXT                          1023
         BNE   @RF01023                                            1023
*            /********************************************************/
*            /* NOT ALL TRACKS EXIST.  ISSUE MESSAGE IDC31226I       */
*            /********************************************************/
*            DO;                                                   1024
*                                                                  1024
*             DO;                                                  1025
*               CKREQ = CKREQ && CKREQ;                            1026
         L     @15,@PC00001+8                                      1026
         XC    CKREQ(44,@15),CKREQ(@15)                            1026
*               CKRERN = MSG26;                                    1027
         L     @15,@PC00001+8                                      1027
         MVC   CKRERN(2,@15),@CH00685                              1027
*               CKRMVAR(1) = ADDR(DSNMSG);                         1028
         L     @15,@PC00001+8                                      1028
         LA    @14,DSNMSG                                          1028
         ST    @14,CKRMVAR(,@15)                                   1028
*               CALL IDCRDER;                                      1029
         L     @15,@CV01811                                        1029
         BALR  @14,@15                                             1029
*             END;                                                 1030
*            RETURN CODE(LASTCC12);                                1031
         LA    @15,12                                              1031
         L     @14,@SA00004                                        1031
         LM    @00,@12,@SA00004+8                                  1031
         BR    @14                                                 1031
*            END;                                                  1032
*          ELSE;                                                   1033
*                                                                  1033
@RF01023 DS    0H                                                  1034
*        /************************************************************/
*        /*                                                          */
*        /*  ALL TRACKS IN THE OUTPUT EXIST AS INDICATED BY          */
*        /*  INREPAIRRANGE.                                          */
*        /*                                                          */
*        /************************************************************/
*        SMIKAD5 = MIKAD5;                                         1034
         MVC   SMIKAD5(5),MIKAD5                                   1034
*        SMOKAD5 = MOKAD5;                                         1035
         MVC   SMOKAD5(5),MOKAD5                                   1035
*        XIND = 1;                                                 1036
         MVC   XIND(2),@CH00221                                    1036
*        RFY EXOARG BASED(REPEXOAR);                               1037
*        /************************************************************/
*        /*                                                          */
*        /* THIS IS THE MAIN LOOP TO PROCESS THE INPUT TRACKS.       */
*        /* IF ANY ERROR OCCURS, MESSAGE IS ISSUED AND OUT.          */
*        /*                                                          */
*        /************************************************************/
*        DO ILOOP = SMIHH TO SMOHH;                                1038
*                                                                  1038
         LH    @15,SMIHH                                           1038
         N     @15,@CF02153                                        1038
         B     @DE01038                                            1038
@DL01038 DS    0H                                                  1039
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK IF EXTENT OPEN FOR ADDRESS SMIKADHH               */
*        /*                                                          */
*        /************************************************************/
*        IF SMIKAD5 >= XTNTCHR1(XIND) & SMIKAD5 <= XTNTCHR2(XIND)  1039
*          THEN;                                                   1039
         LH    @15,XIND                                            1039
         N     @15,@CF02153                                        1039
         MH    @15,@CH02146                                        1039
         L     @14,@PC00001+8                                      1039
         L     @01,REPOXTNT(,@14)                                  1039
         ALR   @01,@15                                             1039
         CLC   SMIKAD5(5),XTNTCHR1-78(@01)                         1039
         BL    @RF01039                                            1039
         LH    @15,XIND                                            1039
         N     @15,@CF02153                                        1039
         MH    @15,@CH02146                                        1039
         L     @14,@PC00001+8                                      1039
         L     @01,REPOXTNT(,@14)                                  1039
         ALR   @01,@15                                             1039
         CLC   SMIKAD5(5),XTNTCHR2-78(@01)                         1039
         BNH   @RT01039                                            1039
*          ELSE                                                    1041
*                                                                  1041
*            /********************************************************/
*            /*                                                      */
*            /* CLOSE CURRENT EXTENT AND OPEN NEXT EXTENT            */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1041
@RF01039 DS    0H                                                  1042
*            CALL IDCIO050(GDTTBL,CLOSE,REPODSOP);                 1042
         L     @15,@PC00001                                        1042
         ST    @15,@AL00001                                        1042
         LA    @15,CLOSE                                           1042
         ST    @15,@AL00001+4                                      1042
         L     @15,@PC00001+8                                      1042
         LA    @15,REPODSOP(,@15)                                  1042
         ST    @15,@AL00001+8                                      1042
         MVI   @AL00001+8,X'80'                                    1042
         L     @14,@PC00001                                        1042
         L     @15,GDTEXP(,@14)                                    1042
         LA    @01,@AL00001                                        1042
         BALR  @14,@15                                             1042
*            XIND = XIND+1;                                        1043
         LA    @15,1                                               1043
         LH    @14,XIND                                            1043
         N     @14,@CF02153                                        1043
         ALR   @15,@14                                             1043
         STH   @15,XIND                                            1043
*            EXOEXT = ADDR(XTNTCHR1(XIND));                        1044
         L     @15,@PC00001+8                                      1044
         L     @01,REPEXOAR(,@15)                                  1044
         LH    @15,XIND                                            1044
         N     @15,@CF02153                                        1044
         MH    @15,@CH02146                                        1044
         L     @14,@PC00001+8                                      1044
         L     @14,REPOXTNT(,@14)                                  1044
         LA    @00,XTNTCHR1-78(@15,@14)                            1044
         ST    @00,EXOEXT(,@01)                                    1044
*            CALL IDCIO050(GDTTBL,OPENR,EXOARG);                   1045
         L     @15,@PC00001                                        1045
         ST    @15,@AL00001                                        1045
         LA    @15,OPENR                                           1045
         ST    @15,@AL00001+4                                      1045
         L     @15,@PC00001+8                                      1045
         L     @01,REPEXOAR(,@15)                                  1045
         ST    @01,@AL00001+8                                      1045
         MVI   @AL00001+8,X'80'                                    1045
         L     @14,@PC00001                                        1045
         L     @15,GDTEXP(,@14)                                    1045
         LA    @01,@AL00001                                        1045
         BALR  @14,@15                                             1045
*            RESPECIFY RTNREG RSTD;                                1046
*            TESTRC = RTNREG;                                      1047
         STH   RTNREG,TESTRC                                       1047
*            RESPECIFY RTNREG UNRSTD;                              1048
*                                                                  1048
*            /********************************************************/
*            /* CHECK THE RC FROM UEXCP OPEN.  IF THE RC ^= 0 THEN   */
*            /*  RETURN WITH RC = 12                                 */
*            /********************************************************/
*            IF TESTRC ^= 0                                        1049
*              THEN                                                1049
*                                                                  1049
         LH    @15,TESTRC                                          1049
         LTR   @15,@15                                             1049
         BZ    @RF01049                                            1049
*                /****************************************************/
*                /*  BAD RC FROM UEXCP OPEN.  GET OUT                */
*                /****************************************************/
*                DO;                                               1050
*                RETURN CODE(LASTCC12);                            1051
         LA    @15,12                                              1051
         L     @14,@SA00004                                        1051
         LM    @00,@12,@SA00004+8                                  1051
         BR    @14                                                 1051
*                END;                                              1052
*              ELSE;                                               1053
@RF01049 DS    0H                                                  1054
*            END;                                                  1054
*                                                                  1054
*        /************************************************************/
*        /*                                                          */
*        /*  CONTINUE  EXTENT IS OK                                  */
*        /*  POSTION FOR FIRST RECORD IN REPAIR WORKFILE TRACK       */
*        /*                                                          */
*        /************************************************************/
*        WFIOKYA =ADDR(MIKAD);                                     1055
*                                                                  1055
@RT01039 L     @15,@PC00001+8                                      1055
         LA    @14,MIKAD                                           1055
         ST    @14,WFIOKYA(,@15)                                   1055
*         DO;                                                      1056
*           WFREQ = ''B;                                           1057
         L     @15,@PC00001+8                                      1057
         XC    WFREQ(2,@15),WFREQ(@15)                             1057
*           WFRPOS = ON;      /*  POSRCD */                        1058
         L     @15,@PC00001+8                                      1058
         OI    WFRPOS(@15),B'00001000'                             1058
*           WFRIN  = ON;      /* INPUT DS */                       1059
         L     @15,@PC00001+8                                      1059
         OI    WFRIN(@15),B'10000000'                              1059
*           CALL IDCRDIO;                                          1060
         L     @15,@CV01814                                        1060
         BALR  @14,@15                                             1060
*           RFY RTNREG RSTD;                                       1061
*           TESTRC = RTNREG;                                       1062
         STH   RTNREG,TESTRC                                       1062
*           RFY RTNREG UNRSTD;                                     1063
*         END;                                                     1064
*                                                                  1064
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE RETURN CODE FROM POSITIONING                   */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC ^= 0                                            1065
*          THEN                                                    1065
*                                                                  1065
         LH    @15,TESTRC                                          1065
         LTR   @15,@15                                             1065
         BZ    @RF01065                                            1065
*        /************************************************************/
*        /*                                                          */
*        /*  BAD RETURN CODE FROM POSITIONING. CALL MODCLFP TO CLOSE */
*        /*   FILES AND FREE POOLS                                   */
*        /************************************************************/
*                                                                  1066
*            DO;                                                   1066
*            IF TESTRC = EOF  TESTRC = NOTFOUND                   1067
*              THEN                                                1067
*                                                                  1067
         CLC   TESTRC(2),@CH00475                                  1067
         BE    @RT01067                                            1067
         CLC   TESTRC(2),@CH00181                                  1067
         BNE   @RF01067                                            1067
@RT01067 DS    0H                                                  1068
*              /******************************************************/
*              /* RECORD NOT FOUND OR END OF TRACK ENCOUNTERED       */
*              /*  ISSUE MESSAGE IDC31227I                           */
*              /******************************************************/
*                                                                  1068
*                 DO;                                              1068
*                   CKREQ = CKREQ && CKREQ;                        1069
         L     @15,@PC00001+8                                      1069
         XC    CKREQ(44,@15),CKREQ(@15)                            1069
*                   CKRERN = MSG27;                                1070
         L     @15,@PC00001+8                                      1070
         MVC   CKRERN(2,@15),@CH01944                              1070
*                   CKRMVAR(1) = ADDR(MIKAD6);                     1071
         L     @15,@PC00001+8                                      1071
         LA    @14,MIKAD6                                          1071
         ST    @14,CKRMVAR(,@15)                                   1071
*                   CKRMVAR(2) = ADDR(MIKAD54);                    1072
         L     @15,@PC00001+8                                      1072
         LA    @14,MIKAD54                                         1072
         ST    @14,CKRMVAR+4(,@15)                                 1072
*                   CKRMVAR(3) = ADDR(RWFDANA);                    1073
         L     @15,@PC00001+8                                      1073
         L     @14,RWFPTR1                                         1073
         ST    @14,CKRMVAR+8(,@15)                                 1073
*                   CALL IDCRDER;                                  1074
         L     @15,@CV01811                                        1074
         BALR  @14,@15                                             1074
*                 END;                                             1075
*              ELSE;                                               1076
@RF01067 DS    0H                                                  1077
*                DO;                                               1077
*                CALL MODCLFP;                                     1078
         BAL   @14,MODCLFP                                         1078
*                RETURN CODE(LASTCC12);                            1079
         LA    @15,12                                              1079
         L     @14,@SA00004                                        1079
         LM    @00,@12,@SA00004+8                                  1079
         BR    @14                                                 1079
*                END;                                              1080
*                                                                  1080
*            END;                                                  1081
*                                                                  1081
*          ELSE;                                                   1082
*                                                                  1082
@RF01065 DS    0H                                                  1083
*        /************************************************************/
*        /*                                                          */
*        /*  READ RECORD ZERO                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1083
*         DO;                                                      1083
*           WFREQ = ''B;                                           1084
         L     @15,@PC00001+8                                      1084
         XC    WFREQ(2,@15),WFREQ(@15)                             1084
*           WFRGET = ON;      /*  GETRCD */                        1085
         L     @15,@PC00001+8                                      1085
         OI    WFRGET(@15),B'00100000'                             1085
*           WFRIN  = ON;      /* INPUT DS */                       1086
         L     @15,@PC00001+8                                      1086
         OI    WFRIN(@15),B'10000000'                              1086
*           CALL IDCRDIO;                                          1087
         L     @15,@CV01814                                        1087
         BALR  @14,@15                                             1087
*           RFY RTNREG RSTD;                                       1088
*           TESTRC = RTNREG;                                       1089
         STH   RTNREG,TESTRC                                       1089
*           RFY RTNREG UNRSTD;                                     1090
*         END;                                                     1091
*                                                                  1091
*        /************************************************************/
*        /*                                                          */
*        /* CHECK THE RETURN CODE FROM GETTING RECORD ZERO           */
*        /*                                                          */
*        /************************************************************/
*          IF TESTRC ^= 0                                          1092
*            THEN                                                  1092
*                                                                  1092
         LH    @15,TESTRC                                          1092
         LTR   @15,@15                                             1092
         BZ    @RF01092                                            1092
*              /******************************************************/
*              /* THE RC FROM GETTING THE RECORD IN NOT ZERO.  CALL  */
*              /*  MODCLFP TO CLOSE FILES AND FREE POOLS             */
*              /******************************************************/
*              DO;                                                 1093
*              IF TESTRC = NOTFOUND  TESTRC = EOF                 1094
*                THEN                                              1094
*                                                                  1094
         CLC   TESTRC(2),@CH00181                                  1094
         BE    @RT01094                                            1094
         CLC   TESTRC(2),@CH00475                                  1094
         BNE   @RF01094                                            1094
@RT01094 DS    0H                                                  1095
*                  /**************************************************/
*                  /* THE RECORD WAS NOT FOUND OR END OF FILE WAS    */
*                  /*  ENCOUNTERED.  ISSUE MESSAGE IDC31227I         */
*                  /**************************************************/
*                                                                  1095
*                   DO;                                            1095
*                     CKREQ = CKREQ && CKREQ;                      1096
         L     @15,@PC00001+8                                      1096
         XC    CKREQ(44,@15),CKREQ(@15)                            1096
*                     CKRERN = MSG27;                              1097
         L     @15,@PC00001+8                                      1097
         MVC   CKRERN(2,@15),@CH01944                              1097
*                     CKRMVAR(1) = ADDR(MIKAD6);                   1098
         L     @15,@PC00001+8                                      1098
         LA    @14,MIKAD6                                          1098
         ST    @14,CKRMVAR(,@15)                                   1098
*                     CKRMVAR(2) = ADDR(MIKAD54);                  1099
         L     @15,@PC00001+8                                      1099
         LA    @14,MIKAD54                                         1099
         ST    @14,CKRMVAR+4(,@15)                                 1099
*                     CKRMVAR(3) = ADDR(RWFDANA);                  1100
         L     @15,@PC00001+8                                      1100
         L     @14,RWFPTR1                                         1100
         ST    @14,CKRMVAR+8(,@15)                                 1100
*                     CALL IDCRDER;                                1101
         L     @15,@CV01811                                        1101
         BALR  @14,@15                                             1101
*                   END;                                           1102
*                ELSE;                                             1103
@RF01094 DS    0H                                                  1104
*                  DO;                                             1104
*                  CALL MODCLFP;                                   1105
         BAL   @14,MODCLFP                                         1105
*                  RETURN CODE(LASTCC12);                          1106
         LA    @15,12                                              1106
         L     @14,@SA00004                                        1106
         LM    @00,@12,@SA00004+8                                  1106
         BR    @14                                                 1106
*                  END;                                            1107
*              END;                                                1108
*            ELSE;                                                 1109
*                                                                  1109
*                                                                  1109
@RF01092 DS    0H                                                  1110
*        /************************************************************/
*        /*                                                          */
*        /*  THE OUTBUFFER WII BE BUILD IN AREA POINTED BY BFPTROUT  */
*        /*                                                          */
*        /************************************************************/
*        RFY DSOUT BASED (REPOBFPT);                               1110
*        RFY RB2 BASED (WFIODAD);                                  1111
*        BFPTROUT = REPOBFPT;                                      1112
         L     @15,@PC00001+8                                      1112
         L     @15,REPOBFPT(,@15)                                  1112
         ST    @15,BFPTROUT                                        1112
*        BFPTROUT = BFPTROUT + CNST04;                             1113
*                                                                  1113
         LA    @15,4                                               1113
         AL    @15,BFPTROUT                                        1113
         ST    @15,BFPTROUT                                        1113
*        /************************************************************/
*        /*                                                          */
*        /* SINCE R0 WILL BE PART OF THE LOOP WHERE THE TRACK SIZE IS*/
*        /* COMPUTED AND TRACK SIZE DOES NOT INCLUDE R0, THE CONSTNTS*/
*        /* ARE INITIALIZED TO COMPENSATE FOR THE R0 LENGTH          */
*        /*                                                          */
*        /************************************************************/
*        SIGMA = - KEYFLGLN;                                       1114
         MVC   SIGMA(4),@CF02147                                   1114
*        SUMKEY = ZERO;                                            1115
         SLR   @15,@15                                             1115
         STH   @15,SUMKEY                                          1115
*        SUMNOKEY = - 1;                                           1116
         MVC   SUMNOKEY(2),@CH02101                                1116
*        DOUT = ZERO;                                              1117
*                                                                  1117
         MVI   DOUT,X'00'                                          1117
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS ALL RECORDS IN A TRACK                           */
*        /* THE RWF INPUT RECORD IS IN RB2 AND THE OUTPUT            */
*        /* TRACK IS BUILD IN DSOUT POINTED BY BFPTROUT              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1118
*        DO WHILE (DOUT = ZERO);                                   1118
         B     @DE01118                                            1118
@DL01118 DS    0H                                                  1119
*          /**********************************************************/
*          /* CHECK TO SEE IF IGNORE FLAG IS SET FOR THIS RECORD     */
*          /*  IF IT IS NOT, THEN CONTINUE PROCESSING THIS RECORD    */
*          /* NOTE THAT THE IGNORE FLAG IS CREATED ONLY WHEN AN STAGE*/
*          /*  ERROR RECORD PAIR DOES NOT CONTAIN AN ORIGINAL RECORD */
*          /*  ONE AND THE PAIR IS DEBLOCKED                         */
*          /**********************************************************/
*          IF RB2FLG1 ^= IGNORE                                    1119
*            THEN                                                  1119
*                                                                  1119
         L     @15,@PC00001+8                                      1119
         L     @01,WFIODAD(,@15)                                   1119
         CLC   RB2FLG1(1,@01),IGNORE                               1119
         BE    @RF01119                                            1119
*              /******************************************************/
*              /*                                                    */
*              /* THE RECORD WILL NOT BE BYPASSED                    */
*              /*                                                    */
*              /******************************************************/
*              DO;                                                 1120
*                                                                  1120
*              /******************************************************/
*              /*                                                    */
*              /* CHECK IF THE INPUT REPAIR WORKFILE RECORD IS A     */
*              /*  DEBLOCKED OR DEBLOCKED/MODIFIED RECORD            */
*              /*                                                    */
*              /******************************************************/
*              IF RB2FLG1 ^= DEBLKFLG & RB2FLG1 ^= DBKMODFL        1121
*                 THEN                                             1121
*                                                                  1121
         L     @15,@PC00001+8                                      1121
         L     @01,WFIODAD(,@15)                                   1121
         CLI   RB2FLG1(@01),2                                      1121
         BE    @RF01121                                            1121
         L     @15,@PC00001+8                                      1121
         L     @01,WFIODAD(,@15)                                   1121
         CLI   RB2FLG1(@01),3                                      1121
         BE    @RF01121                                            1121
*                  /**************************************************/
*                  /*                                                */
*                  /*  THE INPUT RECORD IS NOT A DEBLOCKED RECORD    */
*                  /*  ISSUE MESSGE IDC31228I                        */
*                  /**************************************************/
*                  DO;                                             1122
*                                                                  1122
*                   DO;                                            1123
*                     CKREQ = CKREQ && CKREQ;                      1124
         L     @15,@PC00001+8                                      1124
         XC    CKREQ(44,@15),CKREQ(@15)                            1124
*                     CKRERN = MSG28;                              1125
         L     @15,@PC00001+8                                      1125
         MVC   CKRERN(2,@15),@CH00690                              1125
*                     CKRMVAR(1) = ADDR(MIKAD6);                   1126
         L     @15,@PC00001+8                                      1126
         LA    @14,MIKAD6                                          1126
         ST    @14,CKRMVAR(,@15)                                   1126
*                     CKRMVAR(2) = ADDR(MIKAD54);                  1127
         L     @15,@PC00001+8                                      1127
         LA    @14,MIKAD54                                         1127
         ST    @14,CKRMVAR+4(,@15)                                 1127
*                     CKRMVAR(3) = ADDR(RWFDANA);                  1128
         L     @15,@PC00001+8                                      1128
         L     @14,RWFPTR1                                         1128
         ST    @14,CKRMVAR+8(,@15)                                 1128
*                     CALL IDCRDER;                                1129
         L     @15,@CV01811                                        1129
         BALR  @14,@15                                             1129
*                   END;                                           1130
*                  RETURN CODE(LASTCC12);                          1131
         LA    @15,12                                              1131
         L     @14,@SA00004                                        1131
         LM    @00,@12,@SA00004+8                                  1131
         BR    @14                                                 1131
*                  END;                                            1132
*                ELSE;                                             1133
*                                                                  1133
@RF01121 DS    0H                                                  1134
*              /******************************************************/
*              /*                                                    */
*              /*  CK IF RECORD FITS IN THE OUTPUT TRACK             */
*              /*  MUST SUBSTRACT 16 FROM INPUT LENGTH               */
*              /*                                                    */
*              /******************************************************/
*              SIGMA = WFIODLN - KEYFLGLN + SIGMA - COUNTLN;       1134
         L     @15,@PC00001+8                                      1134
         L     @15,WFIODLN(,@15)                                   1134
         SL    @15,@CF00475                                        1134
         AL    @15,SIGMA                                           1134
         SL    @15,@CF00181                                        1134
         ST    @15,SIGMA                                           1134
*              IF RB2CKL ^= ZERO                                   1135
*                THEN                                              1135
         L     @15,@PC00001+8                                      1135
         L     @01,WFIODAD(,@15)                                   1135
         CLI   RB2CKL(@01),0                                       1135
         BE    @RF01135                                            1135
*                  SUMKEY = SUMKEY+1;                              1136
         LA    @15,1                                               1136
         LH    @14,SUMKEY                                          1136
         N     @14,@CF02153                                        1136
         ALR   @15,@14                                             1136
         STH   @15,SUMKEY                                          1136
*                ELSE                                              1137
*                 SUMNOKEY = SUMNOKEY+1;                           1137
         B     @RC01135                                            1137
@RF01135 LA    @15,1                                               1137
         AH    @15,SUMNOKEY                                        1137
         STH   @15,SUMNOKEY                                        1137
*              IF DEVTC < SIGMA + SUMKEY * KYCNST                  1138
*                        + SUMNOKEY * NOKYCNST                     1138
*                THEN                                              1138
*                                                                  1138
@RC01135 L     @15,@PC00001+8                                      1138
         L     @01,REPODEVA(,@15)                                  1138
         LH    @03,KYCNST                                          1138
         N     @03,@CF02153                                        1138
         LH    @00,SUMKEY                                          1138
         N     @00,@CF02153                                        1138
         MR    @02,@00                                             1138
         AL    @03,SIGMA                                           1138
         SLR   @02,@02                                             1138
         IC    @02,NOKYCNST                                        1138
         MH    @02,SUMNOKEY                                        1138
         ALR   @03,@02                                             1138
         LH    @02,DEVTC(,@01)                                     1138
         N     @02,@CF02153                                        1138
         CR    @03,@02                                             1138
         BNH   @RF01138                                            1138
*                  /**************************************************/
*                  /*                                                */
*                  /*  THE ACCUMULATIVE LENGTH OF THE INPUT RECRDS IS*/
*                  /*  GREATER THAN THE OUTPUT DEVICE CAPACITY.      */
*                  /*                                                */
*                  /**************************************************/
*                  DO;                                             1139
*                                                                  1139
*                   DO;                                            1140
*                     CKREQ = CKREQ && CKREQ;                      1141
         L     @15,@PC00001+8                                      1141
         XC    CKREQ(44,@15),CKREQ(@15)                            1141
*                     CKRERN = MSG29;                              1142
         L     @15,@PC00001+8                                      1142
         MVC   CKRERN(2,@15),@CH00694                              1142
*                     CKRMVAR(1) = ADDR(MIKAD54);                  1143
         L     @15,@PC00001+8                                      1143
         LA    @14,MIKAD54                                         1143
         ST    @14,CKRMVAR(,@15)                                   1143
*                     CKRMVAR(2) = ADDR(DSNMSG);                   1144
         L     @15,@PC00001+8                                      1144
         LA    @14,DSNMSG                                          1144
         ST    @14,CKRMVAR+4(,@15)                                 1144
*                     CALL IDCRDER;                                1145
         L     @15,@CV01811                                        1145
         BALR  @14,@15                                             1145
*                   END;                                           1146
*                  RETURN CODE(LASTCC12);                          1147
         LA    @15,12                                              1147
         L     @14,@SA00004                                        1147
         LM    @00,@12,@SA00004+8                                  1147
         BR    @14                                                 1147
*                  END;                                            1148
*                ELSE;                                             1149
*                                                                  1149
@RF01138 DS    0H                                                  1150
*              /******************************************************/
*              /*                                                    */
*              /* MOVE RECORD TO OUTPUT DSOUT POINTED TO BY BFPTROUT */
*              /*                                                    */
*              /******************************************************/
*                                                                  1150
*               RFY (REG2,REG3,REG4,REG5) RSTD;                    1150
*               REG2 = BFPTROUT;                                   1151
         L     REG2,BFPTROUT                                       1151
*               REG3 = WFIODLN-KEYFLGLN;                           1152
         L     @15,@PC00001+8                                      1152
         L     REG3,WFIODLN(,@15)                                  1152
         SL    REG3,@CF00475                                       1152
*               REG4 = ADDR(RB2C);                                 1153
         L     @15,@PC00001+8                                      1153
         L     REG4,WFIODAD(,@15)                                  1153
         LA    REG4,RB2C(,REG4)                                    1153
*               REG5 = WFIODLN-KEYFLGLN;                           1154
         L     @15,@PC00001+8                                      1154
         L     REG5,WFIODLN(,@15)                                  1154
         SL    REG5,@CF00475                                       1154
*               MVCL (REG2,REG4);                                  1155
         MVCL  REG2,REG4                                           1155
*               RFY(REG2,REG3,REG4,REG5) UNRSTD;                   1156
*                                                                  1156
*              /******************************************************/
*              /*                                                    */
*              /*  SAVE OVERFLOW INDICATOR                           */
*              /*                                                    */
*              /******************************************************/
*              IF RB2FLG3 = 1                                      1157
*                THEN                                              1157
         L     @15,@PC00001+8                                      1157
         L     @01,WFIODAD(,@15)                                   1157
         CLI   RB2FLG3(@01),1                                      1157
         BNE   @RF01157                                            1157
*                  OVFLSW = YESS;                                  1158
         MVI   OVFLSW,X'01'                                        1158
*                ELSE                                              1159
*                  OVFLSW = NOT;                                   1159
         B     @RC01157                                            1159
@RF01157 MVI   OVFLSW,X'00'                                        1159
*              BFPTROUT = BFPTROUT + WFIODLN - KEYFLGLN;           1160
*                                                                  1160
@RC01157 L     @15,@PC00001+8                                      1160
         L     @14,BFPTROUT                                        1160
         AL    @14,WFIODLN(,@15)                                   1160
         SL    @14,@CF00475                                        1160
         ST    @14,BFPTROUT                                        1160
*              END;                                                1161
*                                                                  1161
*            /********************************************************/
*            /*                                                      */
*            /*  OTHERWISE IGNORE THIS RECORD                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  1162
*            ELSE;                                                 1162
*                                                                  1162
@RF01119 DS    0H                                                  1163
*          /**********************************************************/
*          /*                                                        */
*          /* GET NEXT RECORD                                        */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1163
*           DO;                                                    1163
*             WFREQ = ''B;                                         1164
         L     @15,@PC00001+8                                      1164
         XC    WFREQ(2,@15),WFREQ(@15)                             1164
*             WFRGET = ON;      /*  GETRCD */                      1165
         L     @15,@PC00001+8                                      1165
         OI    WFRGET(@15),B'00100000'                             1165
*             WFRIN  = ON;      /* INPUT DS */                     1166
         L     @15,@PC00001+8                                      1166
         OI    WFRIN(@15),B'10000000'                              1166
*             CALL IDCRDIO;                                        1167
         L     @15,@CV01814                                        1167
         BALR  @14,@15                                             1167
*             RFY RTNREG RSTD;                                     1168
*             TESTRC = RTNREG;                                     1169
         STH   RTNREG,TESTRC                                       1169
*             RFY RTNREG UNRSTD;                                   1170
*           END;                                                   1171
*                                                                  1171
*          /**********************************************************/
*          /*                                                        */
*          /*  CHECK THE RETURN CODE FROM GETTING THE RECORD         */
*          /*                                                        */
*          /**********************************************************/
*          IF TESTRC = IOERROR                                     1172
*            THEN                                                  1172
*                                                                  1172
         CLC   TESTRC(2),@CH00044                                  1172
         BNE   @RF01172                                            1172
*              /******************************************************/
*              /*                                                    */
*              /* I/O ERROR.  GET OUT WITH A RC = 12                 */
*              /*                                                    */
*              /******************************************************/
*              RETURN CODE(LASTCC12);                              1173
         LA    @15,12                                              1173
         L     @14,@SA00004                                        1173
         LM    @00,@12,@SA00004+8                                  1173
         BR    @14                                                 1173
*            ELSE;                                                 1174
*                                                                  1174
@RF01172 DS    0H                                                  1175
*          /**********************************************************/
*          /*                                                        */
*          /* CHECK IF RC FROM IDCRDRD IS END OF FILE                */
*          /*                                                        */
*          /**********************************************************/
*          IF TESTRC = EOF                                         1175
*            THEN                                                  1175
*                                                                  1175
         CLC   TESTRC(2),@CH00475                                  1175
         BNE   @RF01175                                            1175
*              /******************************************************/
*              /*                                                    */
*              /* END OF FILE ENCOUNTERED  SET DOUT = 1 & ILOOP=SMOHH*/
*              /*  TO GET OUT OF BOTH LOOPS                          */
*              /*                                                    */
*              /******************************************************/
*              DO;                                                 1176
*              DOUT = 1;                                           1177
         MVI   DOUT,X'01'                                          1177
*              ILOOP  = SMOHH;                                     1178
         LH    @15,SMOHH                                           1178
         N     @15,@CF02153                                        1178
         STH   @15,ILOOP                                           1178
*              END;                                                1179
*            ELSE                                                  1180
*                                                                  1180
*              DO;                                                 1180
         B     @RC01175                                            1180
@RF01175 DS    0H                                                  1181
*              /*******************************************************
*              /*                                                     *
*              /* CHECK IF IN THE SAME TRACK AND IF NOT OUT OF LOOP   *
*              /*                                                     *
*              /*******************************************************
*              IF RB2CHH ^= SMIHH                                  1181
*                THEN                                              1181
         L     @15,@PC00001+8                                      1181
         L     @01,WFIODAD(,@15)                                   1181
         CLC   RB2CHH(2,@01),SMIHH                                 1181
         BE    @RF01181                                            1181
*                  DO;                                             1182
*                  SMIHH = SMIHH + 1;                              1183
         LA    @15,1                                               1183
         LH    @14,SMIHH                                           1183
         N     @14,@CF02153                                        1183
         ALR   @15,@14                                             1183
         STH   @15,SMIHH                                           1183
*                  MIKAD54H = MIKAD54H + 1;                        1184
         LA    @15,1                                               1184
         SLR   @14,@14                                             1184
         ICM   @14,3,MIKAD54H                                      1184
         ALR   @15,@14                                             1184
         STCM  @15,3,MIKAD54H                                      1184
*                  DOUT = 1;                                       1185
         MVI   DOUT,X'01'                                          1185
*                  END;                                            1186
*                ELSE;                                             1187
@RF01181 DS    0H                                                  1188
*              END;                                                1188
*                                                                  1188
*        /************************************************************/
*        /*                                                          */
*        /*      END OF DO WHILE RECORD PROCESSING OF TRACK          */
*        /*                                                          */
*        /************************************************************/
*        END;                                                      1189
*                                                                  1189
@RC01175 DS    0H                                                  1189
@DE01118 CLI   DOUT,0                                              1189
         BE    @DL01118                                            1189
*        /************************************************************/
*        /*                                                          */
*        /*THE TRACK WAS READ AND THE UPDATED RECORD WILL FIT ON THE */
*        /* TRACK                                                    */
*        /*RESET BFPTROUT, SIGMA, SUMNOKEY, SUMKEY AND SAVE NUMBER   */
*        /*OF RECORDS IN THE TRACK                                   */
*        /*THEN THE TRACK IN DSOUT (REPOFBPT) IS WRITTEN             */
*        /*                                                          */
*        /************************************************************/
*        SAVNURE = SUMKEY + SUMNOKEY;                              1190
         LH    @15,SUMKEY                                          1190
         N     @15,@CF02153                                        1190
         AH    @15,SUMNOKEY                                        1190
         STH   @15,SAVNURE                                         1190
*        SUMKEY  = ZERO;                                           1191
         SLR   @15,@15                                             1191
         STH   @15,SUMKEY                                          1191
*        SUMNOKEY = - 1;                                           1192
         MVC   SUMNOKEY(2),@CH02101                                1192
*        SIGMA = - KEYFLGLN;                                       1193
         MVC   SIGMA(4),@CF02147                                   1193
*        BFPTROUT = REPOBFPT + CNST04;                             1194
*                                                                  1194
         L     @15,@PC00001+8                                      1194
         LA    @14,4                                               1194
         AL    @14,REPOBFPT(,@15)                                  1194
         ST    @14,BFPTROUT                                        1194
*        /************************************************************/
*        /*      BUILD ARG LIST                                      */
*        /*                                                          */
*        /************************************************************/
*        RDCTLBK = REPODSOP;                                       1195
         L     @15,@PC00001+8                                      1195
         L     @01,REPODSAR(,@15)                                  1195
         L     @15,@PC00001+8                                      1195
         L     @00,REPODSOP(,@15)                                  1195
         ST    @00,RDCTLBK(,@01)                                   1195
*        RDIOAREA = REPOBFPT;                                      1196
*                                                                  1196
         L     @15,@PC00001+8                                      1196
         L     @01,REPODSAR(,@15)                                  1196
         L     @15,@PC00001+8                                      1196
         L     @00,REPOBFPT(,@15)                                  1196
         ST    @00,RDIOAREA(,@01)                                  1196
*        /************************************************************/
*        /*  SET THE BEGINNING CCHHR TO THE FIRST CCHHR IN THE       */
*        /*    BUFFER WE ARE WRITING FROM                            */
*        /*                                                          */
*        /************************************************************/
*        RESPECIFY WIOAREA  BASED (RDIOAREA);                      1197
*        RESPECIFY WBUF     BASED (ADDR(WBUFF));                   1198
*        RDCHR = WBCCHHR;                                          1199
         L     @15,@PC00001+8                                      1199
         L     @01,REPODSAR(,@15)                                  1199
         L     @15,@PC00001+8                                      1199
         L     @15,REPODSAR(,@15)                                  1199
         L     @15,RDIOAREA(,@15)                                  1199
         MVC   RDCHR(5,@01),WBCCHHR+4(@15)                         1199
*        RDDS = ZERO;                                              1200
*                                                                  1200
         L     @15,@PC00001+8                                      1200
         L     @01,REPODSAR(,@15)                                  1200
         MVI   RDDS(@01),X'00'                                     1200
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK IF LAST RECORD IS OVERFLOW                     */
*        /*                                                          */
*        /************************************************************/
*        IF OVFLSW = 1                                             1201
*          THEN                                                    1201
         CLI   OVFLSW,1                                            1201
         BNE   @RF01201                                            1201
*            RDFUNC = 2;                                           1202
         L     @15,@PC00001+8                                      1202
         L     @01,REPODSAR(,@15)                                  1202
         MVI   RDFUNC(@01),X'02'                                   1202
*          ELSE                                                    1203
*            RDFUNC = ZERO;                                        1203
*                                                                  1203
         B     @RC01201                                            1203
@RF01201 L     @15,@PC00001+8                                      1203
         L     @01,REPODSAR(,@15)                                  1203
         MVI   RDFUNC(@01),X'00'                                   1203
*        /************************************************************/
*        /*                                                          */
*        /*SET NUMBER OF RECORDS IN FRONT OF OUTPUT BUFFER           */
*        /*                                                          */
*        /************************************************************/
*        DSOUT4 = SAVNURE;                                         1204
@RC01201 L     @15,@PC00001+8                                      1204
         L     @01,REPOBFPT(,@15)                                  1204
         LH    @00,SAVNURE                                         1204
         N     @00,@CF02153                                        1204
         ST    @00,DSOUT4(,@01)                                    1204
*        OLDERID2 = NEWERID2;                                      1205
         L     @15,@PC00001                                        1205
         L     @01,GDTTR2(,@15)                                    1205
         L     @15,@PC00001                                        1205
         L     @15,GDTTR2(,@15)                                    1205
         MVC   @TS00001(95),NEWERID2(@15)                          1205
         MVC   OLDERID2(95,@01),@TS00001                           1205
*        NEWID2 = 'RD5A';                                          1206
*                                                                  1206
         L     @15,@PC00001                                        1206
         L     @01,GDTTR2(,@15)                                    1206
         MVC   NEWID2(4,@01),@CC02105                              1206
*        /************************************************************/
*        /*                                                          */
*        /*  SET DUMP AND TRACE POINTS                               */
*        /*                                                          */
*        /************************************************************/
*        IF GDTDBG = NULLPTR                                       1207
*          THEN;                                                   1207
         L     @15,@PC00001                                        1207
         L     @15,GDTDBG(,@15)                                    1207
         LTR   @15,@15                                             1207
         BZ    @RT01207                                            1207
*          ELSE                                                    1209
*            CALL IDCDB010(GDTTBL,'RD5B');                         1209
         L     @15,@PC00001                                        1209
         ST    @15,@AL00001                                        1209
         LA    @15,@CC02106                                        1209
         ST    @15,@AL00001+4                                      1209
         MVI   @AL00001+4,X'80'                                    1209
         L     @14,@PC00001                                        1209
         L     @15,GDTDBG(,@14)                                    1209
         LA    @01,@AL00001                                        1209
         BALR  @14,@15                                             1209
*        CALL IDCIO050(GDTTBL,FWRITE,RDARG);                       1210
@RT01207 L     @15,@PC00001                                        1210
         ST    @15,@AL00001                                        1210
         LA    @15,FWRITE                                          1210
         ST    @15,@AL00001+4                                      1210
         L     @15,@PC00001+8                                      1210
         L     @01,REPODSAR(,@15)                                  1210
         ST    @01,@AL00001+8                                      1210
         MVI   @AL00001+8,X'80'                                    1210
         L     @14,@PC00001                                        1210
         L     @15,GDTEXP(,@14)                                    1210
         LA    @01,@AL00001                                        1210
         BALR  @14,@15                                             1210
*        RESPECIFY RTNREG RSTD;                                    1211
*        TESTRC = RTNREG;                                          1212
         STH   RTNREG,TESTRC                                       1212
*        RESPECIFY RTNREG UNRSTD;                                  1213
*        IF TESTRC ^= 0                                            1214
*          THEN                                                    1214
         LH    @15,TESTRC                                          1214
         LTR   @15,@15                                             1214
         BZ    @RF01214                                            1214
*            DO;                                                   1215
*                                                                  1215
*            /********************************************************/
*            /*                                                      */
*            /* ISSUE MSG IDC31245I - I/O ERROR WHILE MODIFYING TRACK*/
*            /*                                                      */
*            /********************************************************/
*                                                                  1216
*             DO;                                                  1216
*               CKREQ = CKREQ && CKREQ;                            1217
         L     @15,@PC00001+8                                      1217
         XC    CKREQ(44,@15),CKREQ(@15)                            1217
*               CKRERN = MSG45;                                    1218
         L     @15,@PC00001+8                                      1218
         MVC   CKRERN(2,@15),@CH00767                              1218
*               CKRMVAR(1) = ADDR(RDCHR);                          1219
         L     @15,@PC00001+8                                      1219
         L     @14,@PC00001+8                                      1219
         L     @01,REPODSAR(,@14)                                  1219
         LA    @14,RDCHR(,@01)                                     1219
         ST    @14,CKRMVAR(,@15)                                   1219
*               CKRMVAR(2) = ADDR(DSNMSG);                         1220
         L     @15,@PC00001+8                                      1220
         LA    @14,DSNMSG                                          1220
         ST    @14,CKRMVAR+4(,@15)                                 1220
*               CALL IDCRDER;                                      1221
         L     @15,@CV01811                                        1221
         BALR  @14,@15                                             1221
*             END;                                                 1222
*            RETURN CODE(LASTCC12);                                1223
         LA    @15,12                                              1223
         L     @14,@SA00004                                        1223
         LM    @00,@12,@SA00004+8                                  1223
         BR    @14                                                 1223
*            END;                                                  1224
*          ELSE;                                                   1225
@RF01214 DS    0H                                                  1226
*          REPRCDCT = REPRCDCT + SAVNURE+1;                        1226
*                                                                  1226
         L     @15,@PC00001+8                                      1226
         L     @14,@PC00001+8                                      1226
         LH    @05,SAVNURE                                         1226
         N     @05,@CF02153                                        1226
         AL    @05,REPRCDCT(,@14)                                  1226
         AL    @05,@CF00221                                        1226
         ST    @05,REPRCDCT(,@15)                                  1226
*        /************************************************************/
*        /*                                                          */
*        /*     END OF DO ILOOP                                      */
*        /*                                                          */
*        /************************************************************/
*        END;                                                      1227
         LA    @15,1                                               1227
         LH    @14,ILOOP                                           1227
         N     @14,@CF02153                                        1227
         ALR   @15,@14                                             1227
@DE01038 STH   @15,ILOOP                                           1227
         LH    @14,SMOHH                                           1227
         N     @14,@CF02153                                        1227
         CR    @15,@14                                             1227
         BNH   @DL01038                                            1227
*        RETURN CODE(LASTCC00);                                    1228
         SLR   @15,@15                                             1228
         L     @14,@SA00004                                        1228
         LM    @00,@12,@SA00004+8                                  1228
         BR    @14                                                 1228
*END MODRNG;                                                       1229
*                                                                  1229
*MODDSOUT:    PROCEDURE;                                           1230
MODDSOUT STM   @14,@12,@SA00005                                    1230
*        /************************************************************/
*        /*                                                          */
*        /* SUBROUTINE NAME - MODDSOUT                               */
*        /*                                                          */
*        /* FUNCTION -                                               */
*        /*                                                          */
*        /*  PROCEDURE NAME - MODDSOUT                               */
*        /*                                                          */
*        /*  THIS PROCEDURE WILL PROCESS THE MODIFY REQUEST WHEN THE */
*        /*  INPUT IS A RECORD FROM EITHER A DATA SET OR A REPAIR    */
*        /*  WORK FILE, OR AN INPUT STRING OR IF THE OVERFLOW KEYWORD*/
*        /*  IS PRESENT. IF INPUT RECORD IS PRESENT, IT IS IN RB3    */
*        /*  POINTED BY BFPTRIN                                      */
*        /*  THE OUPUT RECORD IS IN RB1 POINTED BY BFPTROUT.         */
*        /*                                                          */
*        /*                                                          */
*        /* NOTES -                                                  */
*        /*                                                          */
*        /*    DEPENDENCIES - NONE                                   */
*        /*                                                          */
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */
*        /*                   AND IDCRD06 RESPECTIVELY               */
*        /*                                                          */
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */
*        /*                                                          */
*        /*    PATCH LABEL - 'UPATCHIT'                              */
*        /*                                                          */
*        /* ENTRY POINT - MODDSOUT(ONLY ENTRY POINT)                 */
*        /*                                                          */
*        /*    PURPOSE - INVOKED TO PERFORM THE REPAIRV FSR          */
*        /*    MODIFY  FUNCTION WHEN THE OUTPUT IS A RECORD          */
*        /*    IN A DATA SET OR VTOCHEADER                           */
*        /*                                                          */
*        /*    LINKAGE - 'CALL MODDSOUT'                             */
*        /*                                                          */
*        /*    INPUT -                                               */
*        /*                                                          */
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */
*        /*       A) DATA STRING SPECFIED IN THE COMMAND             */
*        /*       B) A RECORD IN A DATA SET                          */
*        /*       C) A RECORD IN A REPAIR WORKFILE                   */
*        /*                                                          */
*        /*    OUTPUT -                                              */
*        /*                                                          */
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */
*        /*       A) A MODIFIED RECORD ON A DATA SET                 */
*        /*       B) A MODIFIED RECORD IN A VTOCHEADER               */
*        /*                                                          */
*        /*      ERROR MESSAGES: IDC31230I                           */
*        /*                      IDC31231I                           */
*        /*                      IDC31232I                           */
*        /*                      IDC31241I                           */
*        /*                      IDC31242I                           */
*        /*                      IDC31243I                           */
*        /*                                                          */
*        /*    EXIT, NORMAL -                                        */
*        /*                                                          */
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */
*        /*                                                          */
*        /*    EXIT, ERROR -                                         */
*        /*                                                          */
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */
*        /*                                                          */
*        /* INTERNAL REFERENCES -                                    */
*        /*    PROCEDURES/SUBROUTINES CALLED                         */
*        /*                                                          */
*        /*    MODCLFP  - CLOSE FILES AND FREE POOLS SUBROUTINE      */
*        /*                                                          */
*        /* EXTERNAL REFERENCES -                                    */
*        /*    MACROS/SVCS -                                         */
*        /*                                                          */
*        /*    UGPOOL - IDCAMS SYSTEM ADAPTER FREE POOL RUTINE       */
*        /*      OBTAINS DYNAMIC STORAGE FOR I/O BUFFERS             */
*        /*      GENERATES A CALL TO MODULE IDCSAGP                  */
*        /*                                                          */
*        /*    UEXCP  - IDCAMS I/O ADAPTER EXCP ROUTINE              */
*        /*      TO WRITE DATA SET OR VTOCHEADER RECORDS             */
*        /*      GENERATES A CALL TO MODULE IDCSADQO                 */
*        /*                                                          */
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */
*        /*      WRITES ALL MESSAGES                                 */
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */
*        /*                                                          */
*        /*    ?MOVELONG - REPAIRV MVCL MACRO                        */
*        /*      EXECUTES MVCL INSTRUCTION WITH GPR'S 2,3,4 & 5      */
*        /*                                                          */
*        /* PROCEDURES/SUBROUTINES CALLED                            */
*        /*                                                          */
*        /*    NONE                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1231
*        /************************************************************/
*        /*  HERE BEGINS THE CODE FOR MODDSOUT                       */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      1231
         L     @15,@PC00001                                        1231
         L     @01,GDTTR2(,@15)                                    1231
         L     @15,@PC00001                                        1231
         L     @15,GDTTR2(,@15)                                    1231
         MVC   @TS00001(95),NEWERID2(@15)                          1231
         MVC   OLDERID2(95,@01),@TS00001                           1231
*        NEWID2='RD55';                                            1232
         L     @15,@PC00001                                        1232
         L     @01,GDTTR2(,@15)                                    1232
         MVC   NEWID2(4,@01),@CC02110                              1232
*        IF GDTDBG = NULLPTR                                       1233
*          THEN;                                                   1233
         L     @15,@PC00001                                        1233
         L     @15,GDTDBG(,@15)                                    1233
         LTR   @15,@15                                             1233
         BZ    @RT01233                                            1233
*          ELSE                                                    1235
*            CALL IDCDB010(GDTTBL,'RD54');                         1235
*                                                                  1235
         L     @15,@PC00001                                        1235
         ST    @15,@AL00001                                        1235
         LA    @15,@CC02111                                        1235
         ST    @15,@AL00001+4                                      1235
         MVI   @AL00001+4,X'80'                                    1235
         L     @14,@PC00001                                        1235
         L     @15,GDTDBG(,@14)                                    1235
         LA    @01,@AL00001                                        1235
         BALR  @14,@15                                             1235
*        /************************************************************/
*        /*  INITIALIZE FORMAT WRITE SWITCH TO NO FORMAT WRITE       */
*        /************************************************************/
*        FWSW = NOT;                                               1236
*                                                                  1236
@RT01233 MVI   FWSW,X'00'                                          1236
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK IF OVERFLOW SPECIFIED AS INPUT PARAMETER          */
*        /*                                                          */
*        /************************************************************/
*        IF ADDR(MOVFL) ^= NULLPTR                                 1237
*          THEN                                                    1237
         L     @15,@PC00001+4                                      1237
         L     @15,FDTPTR+420(,@15)                                1237
         LTR   @15,@15                                             1237
         BZ    @RF01237                                            1237
*            DO;                                                   1238
*                                                                  1238
*            /********************************************************/
*            /*                                                      */
*            /*  WRITE SPECIAL FROM OUTPUT BUFFER                    */
*            /*                                                      */
*            /*                                                      */
*            /********************************************************/
*                                                                  1239
*            /********************************************************/
*            /*                                                      */
*            /*  BUILD IDCRDRD ARGUMENT LIST (RDARG)                 */
*            /*                                                      */
*            /*                                                      */
*            /********************************************************/
*                                                                  1239
*            RDCHR = RB1CCHR;                                      1239
         L     @15,@PC00001+8                                      1239
         L     @01,REPODSAR(,@15)                                  1239
         L     @15,BFPTROUT                                        1239
         MVC   RDCHR(5,@01),RB1CCHR(@15)                           1239
*            RDDS = ZERO;                                          1240
         L     @15,@PC00001+8                                      1240
         L     @01,REPODSAR(,@15)                                  1240
         MVI   RDDS(@01),X'00'                                     1240
*            RDFUNC = RITEOVFL;                                    1241
         L     @15,@PC00001+8                                      1241
         L     @01,REPODSAR(,@15)                                  1241
         MVI   RDFUNC(@01),X'02'                                   1241
*            RDCTLBK = REPODSOP;                                   1242
         L     @15,@PC00001+8                                      1242
         L     @01,REPODSAR(,@15)                                  1242
         L     @15,@PC00001+8                                      1242
         L     @00,REPODSOP(,@15)                                  1242
         ST    @00,RDCTLBK(,@01)                                   1242
*            RDIOAREA = BFPTROUT;                                  1243
         L     @15,@PC00001+8                                      1243
         L     @01,REPODSAR(,@15)                                  1243
         L     @00,BFPTROUT                                        1243
         ST    @00,RDIOAREA(,@01)                                  1243
*            RB1NUM = 1;                                           1244
*                                                                  1244
         L     @01,BFPTROUT                                        1244
         MVC   RB1NUM(4,@01),@CF00221                              1244
*            /********************************************************/
*            /*                                                      */
*            /*  CALL UEXCP TO WRITE SPECIAL ONE RECORD AND RETURN   */
*            /*                                                      */
*            /********************************************************/
*            CALL IDCIO050(GDTTBL,WRITEREC,RDARG);                 1245
         L     @15,@PC00001                                        1245
         ST    @15,@AL00001                                        1245
         LA    @15,WRITEREC                                        1245
         ST    @15,@AL00001+4                                      1245
         L     @15,@PC00001+8                                      1245
         L     @01,REPODSAR(,@15)                                  1245
         ST    @01,@AL00001+8                                      1245
         MVI   @AL00001+8,X'80'                                    1245
         L     @14,@PC00001                                        1245
         L     @15,GDTEXP(,@14)                                    1245
         LA    @01,@AL00001                                        1245
         BALR  @14,@15                                             1245
*            RESPECIFY RTNREG RSTD;                                1246
*            TESTRC = RTNREG;                                      1247
         STH   RTNREG,TESTRC                                       1247
*            RESPECIFY RTNREG UNRSTD;                              1248
*            IF TESTRC ^= 0                                        1249
*              THEN                                                1249
         LH    @15,TESTRC                                          1249
         LTR   @15,@15                                             1249
         BZ    @RF01249                                            1249
*                DO;                                               1250
*                                                                  1250
*                /****************************************************/
*                /*                                                  */
*                /* ISSUE MSG IDC31245I - I/O ERROR WHILE MODIFYING  */
*                /*    TRACK                                         */
*                /*                                                  */
*                /****************************************************/
*                                                                  1251
*                 DO;                                              1251
*                   CKREQ = CKREQ && CKREQ;                        1252
         L     @15,@PC00001+8                                      1252
         XC    CKREQ(44,@15),CKREQ(@15)                            1252
*                   CKRERN = MSG45;                                1253
         L     @15,@PC00001+8                                      1253
         MVC   CKRERN(2,@15),@CH00767                              1253
*                   CKRMVAR(1) = ADDR(RDCHR);                      1254
         L     @15,@PC00001+8                                      1254
         L     @14,@PC00001+8                                      1254
         L     @01,REPODSAR(,@14)                                  1254
         LA    @14,RDCHR(,@01)                                     1254
         ST    @14,CKRMVAR(,@15)                                   1254
*                   CKRMVAR(2) = ADDR(DSNMSG);                     1255
         L     @15,@PC00001+8                                      1255
         LA    @14,DSNMSG                                          1255
         ST    @14,CKRMVAR+4(,@15)                                 1255
*                   CALL IDCRDER;                                  1256
         L     @15,@CV01811                                        1256
         BALR  @14,@15                                             1256
*                 END;                                             1257
*                RETURN CODE(LASTCC12);                            1258
         LA    @15,12                                              1258
         L     @14,@SA00005                                        1258
         LM    @00,@12,@SA00005+8                                  1258
         BR    @14                                                 1258
*                END;                                              1259
*              ELSE                                                1260
*                RETURN CODE(LASTCC00);                            1260
@RF01249 SLR   @15,@15                                             1260
         L     @14,@SA00005                                        1260
         LM    @00,@12,@SA00005+8                                  1260
         BR    @14                                                 1260
*            END;                                                  1261
*          ELSE;                                                   1262
*                                                                  1262
@RF01237 DS    0H                                                  1263
*        /************************************************************/
*        /*                                                          */
*        /* OVERFLOW NOT INPUT PARAMETER                             */
*        /*  CHECK IF INPUT COMING FROM RWF OR DATA SET              */
*        /*                                                          */
*        /************************************************************/
*        IF BFPTRIN ^= NULLPTR                                     1263
*          THEN                                                    1263
         L     @15,BFPTRIN                                         1263
         LTR   @15,@15                                             1263
         BZ    @RF01263                                            1263
*            DO;                                                   1264
*                                                                  1264
*            /********************************************************/
*            /*  INPUT FROM DATA SET  OR VTOCHEADER                  */
*            /*  SET NUMBER OF RECORDS TO WRITE AS ONE AND           */
*            /*  SET FORMAT WRITE SWITCH                             */
*            /*                                                      */
*            /********************************************************/
*            RB3NUM = 1;                                           1265
         L     @01,BFPTRIN                                         1265
         MVC   RB3NUM(4,@01),@CF00221                              1265
*            RB3CCHR = RB1CCHR;                                    1266
         L     @01,BFPTRIN                                         1266
         L     @15,BFPTROUT                                        1266
         MVC   RB3CCHR(5,@01),RB1CCHR(@15)                         1266
*            FWSW = YESS;                                          1267
         MVI   FWSW,X'01'                                          1267
*            END;                                                  1268
*                                                                  1268
*          ELSE                                                    1269
*                                                                  1269
*            /********************************************************/
*            /* USER SUPPLIED INPUT INFORMATION                      */
*            /* FIRST GET ENOUGH SPACE TO BUILD NEW INPUT BUFFER     */
*            /* EQUAL TO DEVICE TRACK SIZE + 510 +4, WHERE 510 ALLOWS*/
*            /* TO INCREASE KEY AND DATA BY 255 AND 4 IS NUMBER OF   */
*            /* RECORDS IN FRONT OF BUFFER                           */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1269
         B     @RC01263                                            1269
@RF01263 DS    0H                                                  1270
*            RESPECIFY DEVAREA BASED(REPODEVA);                    1270
*            INFTC=DEVTC+ CNST04+CNST510;                          1271
         L     @15,@PC00001+8                                      1271
         L     @01,REPODEVA(,@15)                                  1271
         LA    @00,514                                             1271
         LH    @01,DEVTC(,@01)                                     1271
         N     @01,@CF02153                                        1271
         ALR   @00,@01                                             1271
         ST    @00,INFTC                                           1271
*            CALL IDCSAGP0(GDTTBL,INFTC,BFPTRIN,RD01,SETZERO);     1272
         L     @15,@PC00001                                        1272
         ST    @15,@AL00001                                        1272
         LA    @15,INFTC                                           1272
         ST    @15,@AL00001+4                                      1272
         LA    @15,BFPTRIN                                         1272
         ST    @15,@AL00001+8                                      1272
         LA    @15,RD01                                            1272
         ST    @15,@AL00001+12                                     1272
         LA    @15,SETZERO                                         1272
         ST    @15,@AL00001+16                                     1272
         MVI   @AL00001+16,X'80'                                   1272
         L     @14,@PC00001                                        1272
         L     @15,GDTGPL(,@14)                                    1272
         LA    @01,@AL00001                                        1272
         BALR  @14,@15                                             1272
*            RESPECIFY RTNREG RSTD;                                1273
*            TESTRC = RTNREG;                                      1274
         STH   RTNREG,TESTRC                                       1274
*            RESPECIFY RTNREG UNRSTD;                              1275
*                                                                  1275
*            /********************************************************/
*            /* CHECK THE RETURN CODE FROM UGPPOL                    */
*            /********************************************************/
*            IF TESTRC ^= 0                                        1276
*              THEN                                                1276
*                                                                  1276
         LH    @15,TESTRC                                          1276
         LTR   @15,@15                                             1276
         BZ    @RF01276                                            1276
*                /****************************************************/
*                /* BAD RC FROM UGPOOL.  RETURN WITH A RC = 12       */
*                /****************************************************/
*                RETURN CODE(LASTCC12);                            1277
         LA    @15,12                                              1277
         L     @14,@SA00005                                        1277
         LM    @00,@12,@SA00005+8                                  1277
         BR    @14                                                 1277
*              ELSE;                                               1278
*                                                                  1278
@RF01276 DS    0H                                                  1279
*            /********************************************************/
*            /*  RETURN OK FROM GETTING CORE                         */
*            /*  BUILD NEW RECORD IN NEW INPUT BUFFER                */
*            /*                                                      */
*            /*                                                      */
*            /********************************************************/
*            RFY RB3 BASED (BFPTRIN);                              1279
*                                                                  1279
*            /********************************************************/
*            /* SET NUMBER OF RECORDS TO WRITE TO ONE                */
*            /********************************************************/
*            RB3NUM = 1;                                           1280
*                                                                  1280
         L     @01,BFPTRIN                                         1280
         MVC   RB3NUM(4,@01),@CF00221                              1280
*            /********************************************************/
*            /*                                                      */
*            /*  CHECK TO SEE IF USER SPECIFIED COUNT                */
*            /*                                                      */
*            /********************************************************/
*            IF ADDR(MNCNT) ^= NULLPTR                             1281
*              THEN                                                1281
         L     @15,@PC00001+4                                      1281
         L     @15,FDTPTR+368(,@15)                                1281
         LTR   @15,@15                                             1281
         BZ    @RF01281                                            1281
*                DO;                                               1282
*                                                                  1282
*                /****************************************************/
*                /* USER SUPPLIED COUNT FIELD                        */
*                /* ENSURE ITS LENGTH IS EXACTLY EIGHT BYTES         */
*                /* IF ITS NOT - ISSUE MESSAGE AND RETURN CODE 12    */
*                /****************************************************/
*                IF MNCNTLEN ^= COUNTLN                            1283
*                  THEN                                            1283
*                                                                  1283
         L     @15,@PC00001+4                                      1283
         L     @01,FDTPTR+368(,@15)                                1283
         CLI   MNCNTLEN(@01),8                                     1283
         BE    @RF01283                                            1283
*                    /************************************************/
*                    /* BAD NEWCOUNT LENGTH.  ISSUE MESSAGE IDC31241I*/
*                    /************************************************/
*                    DO;                                           1284
*                                                                  1284
*                     DO;                                          1285
*                       CKREQ = CKREQ && CKREQ;                    1286
         L     @15,@PC00001+8                                      1286
         XC    CKREQ(44,@15),CKREQ(@15)                            1286
*                       CKRERN = MSG41;                            1287
         L     @15,@PC00001+8                                      1287
         MVC   CKRERN(2,@15),@CH00736                              1287
*                       CALL IDCRDER;                              1288
         L     @15,@CV01811                                        1288
         BALR  @14,@15                                             1288
*                     END;                                         1289
*                    RETURN CODE(LASTCC12);                        1290
         LA    @15,12                                              1290
         L     @14,@SA00005                                        1290
         LM    @00,@12,@SA00005+8                                  1290
         BR    @14                                                 1290
*                    END;                                          1291
*                  ELSE;                                           1292
*                                                                  1292
@RF01283 DS    0H                                                  1293
*                /****************************************************/
*                /*                                                  */
*                /* MOVE USER SPECIFIED COUNT INTO NEW INPUT         */
*                /* COUNT FIELD AND SET FORMAT WRITE SWITCH ON       */
*                /*                                                  */
*                /****************************************************/
*                RB3C = MNCNTVAL;                                  1293
         L     @01,BFPTRIN                                         1293
         L     @15,@PC00001+4                                      1293
         L     @15,FDTPTR+368(,@15)                                1293
         MVC   RB3C(8,@01),MNCNTVAL(@15)                           1293
*                FWSW = YESS;                                      1294
         MVI   FWSW,X'01'                                          1294
*                END;                                              1295
*                                                                  1295
*              ELSE                                                1296
*                                                                  1296
*                /****************************************************/
*                /*  USER DIDNT SPECIFY COUNT - MOVE ORIGINAL        */
*                /*   COUNT FIELD INTO NEW INPUT BUFFER              */
*                /****************************************************/
*                RB3C = RB1C;                                      1296
*                                                                  1296
         B     @RC01281                                            1296
@RF01281 L     @01,BFPTRIN                                         1296
         L     @15,BFPTROUT                                        1296
         MVC   RB3C(8,@01),RB1C(@15)                               1296
*            /********************************************************/
*            /*                                                      */
*            /*   CHECK IF USER SPECIFIED NEWKEY PARAMETER           */
*            /*                                                      */
*            /*                                                      */
*            /********************************************************/
*            IF ADDR(MNKEY) ^= NULLPTR                             1297
*              THEN                                                1297
*                                                                  1297
@RC01281 L     @15,@PC00001+4                                      1297
         L     @15,FDTPTR+364(,@15)                                1297
         LTR   @15,@15                                             1297
         BZ    @RF01297                                            1297
*                /****************************************************/
*                /*USER SPECIFIED KEY INFORMATION - ENSURE THAT      */
*                /*THE OFFSET VALUE INTO THE KEY THAT HE WISHES TO   */
*                /*MODIFY IS WITHIN RANGE OF OLD KEY                 */
*                /****************************************************/
*                DO;                                               1298
*                IF MNKOFVAL >(RB1CKL+1)  (MNKOFVAL+MNKSTLEN-1) > 1299
*                  KEYMAXLN                                        1299
*                  THEN                                            1299
*                                                                  1299
         L     @15,@PC00001+4                                      1299
         L     @01,FDTPTR+472(,@15)                                1299
         LA    @00,1                                               1299
         L     @15,BFPTROUT                                        1299
         SLR   @14,@14                                             1299
         IC    @14,RB1CKL(,@15)                                    1299
         ALR   @00,@14                                             1299
         C     @00,MNKOFVAL(,@01)                                  1299
         BL    @RT01299                                            1299
         L     @15,@PC00001+4                                      1299
         L     @01,FDTPTR+472(,@15)                                1299
         L     @15,@PC00001+4                                      1299
         L     @15,FDTPTR+476(,@15)                                1299
         SLR   @14,@14                                             1299
         IC    @14,MNKSTLEN(,@15)                                  1299
         AL    @14,MNKOFVAL(,@01)                                  1299
         BCTR  @14,0                                               1299
         C     @14,@CF00987                                        1299
         BNH   @RF01299                                            1299
@RT01299 DS    0H                                                  1300
*                    /************************************************/
*                    /* BAD OFFSET ISSUE MESSAGE IDC31230I AND RETURN*/
*                    /************************************************/
*                    DO;                                           1300
*                                                                  1300
*                     DO;                                          1301
*                       CKREQ = CKREQ && CKREQ;                    1302
         L     @15,@PC00001+8                                      1302
         XC    CKREQ(44,@15),CKREQ(@15)                            1302
*                       CKRERN = MSG30;                            1303
         L     @15,@PC00001+8                                      1303
         MVC   CKRERN(2,@15),@CH00698                              1303
*                       CKRMVAR(1) = ADDR(MNKOFVAL);               1304
         L     @15,@PC00001+8                                      1304
         L     @14,@PC00001+4                                      1304
         L     @14,FDTPTR+472(,@14)                                1304
         ST    @14,CKRMVAR(,@15)                                   1304
*                       CALL IDCRDER;                              1305
         L     @15,@CV01811                                        1305
         BALR  @14,@15                                             1305
*                     END;                                         1306
*                    RETURN CODE(LASTCC12);                        1307
         LA    @15,12                                              1307
         L     @14,@SA00005                                        1307
         LM    @00,@12,@SA00005+8                                  1307
         BR    @14                                                 1307
*                    END;                                          1308
*                                                                  1308
*                  ELSE;                                           1309
*                                                                  1309
@RF01299 DS    0H                                                  1310
*                /****************************************************/
*                /*  MOVE NEW KEY TO INPUT BUFFER                    */
*                /*  IF ORIGINAL KEY LENGTH NOT EQUAL TO ZERO        */
*                /****************************************************/
*                IF RB1CKL ^= ZERO                                 1310
*                  THEN                                            1310
*                                                                  1310
         L     @01,BFPTROUT                                        1310
         CLI   RB1CKL(@01),0                                       1310
         BE    @RF01310                                            1310
*                    /************************************************/
*                    /*NON ZERO ORIGINAL KEY - MOVE INTO NEW INPUT   */
*                    /* BUFFER SO CAN MODIFY FROM OFFSET             */
*                    /************************************************/
*                    RB3KD(1:RB1CKL)= RB1KD(1:RB1CKL);             1311
*                                                                  1311
         L     @01,BFPTRIN                                         1311
         L     @15,BFPTROUT                                        1311
         SLR   @14,@14                                             1311
         IC    @14,RB1CKL(,@15)                                    1311
         BCTR  @14,0                                               1311
         L     @15,BFPTROUT                                        1311
         EX    @14,@SM02162                                        1311
*                  ELSE;                                           1312
*                                                                  1312
@RF01310 DS    0H                                                  1313
*                /****************************************************/
*                /*                                                  */
*                /* MOVE INPUT KEY STRING TO NEW INPUT BUFFER        */
*                /*                                                  */
*                /****************************************************/
*                RB3KD (MNKOFVAL:(MNKSTLEN + MNKOFVAL - 1))        1313
*                                          = MNKSTVAL;             1313
*                                                                  1313
         L     @15,@PC00001+4                                      1313
         L     @01,FDTPTR+472(,@15)                                1313
         L     @01,MNKOFVAL(,@01)                                  1313
         L     @15,BFPTRIN                                         1313
         ALR   @15,@01                                             1313
         L     @14,@PC00001+4                                      1313
         L     @01,FDTPTR+476(,@14)                                1313
         L     @14,@PC00001+4                                      1313
         L     @14,FDTPTR+472(,@14)                                1313
         SLR   @05,@05                                             1313
         IC    @05,MNKSTLEN(,@01)                                  1313
         AL    @05,MNKOFVAL(,@14)                                  1313
         L     @14,@PC00001+4                                      1313
         L     @01,FDTPTR+472(,@14)                                1313
         SL    @05,MNKOFVAL(,@01)                                  1313
         BCTR  @05,0                                               1313
         L     @14,@PC00001+4                                      1313
         L     @01,FDTPTR+476(,@14)                                1313
         EX    @05,@SM02164                                        1313
*                /****************************************************/
*                /*                                                  */
*                /* CK IF RECORD WILL EXPAND  AND IF IT DOES, SET    */
*                /* THE NEW KEYLENGTH IN RB3CKL AND SET FWSW ON      */
*                /*                                                  */
*                /****************************************************/
*                IF RB1CKL < (MNKOFVAL + MNKSTLEN - 1)  RB1CKL = ZERO
*                  THEN                                            1314
         L     @15,@PC00001+4                                      1314
         L     @01,FDTPTR+472(,@15)                                1314
         L     @15,@PC00001+4                                      1314
         L     @15,FDTPTR+476(,@15)                                1314
         SLR   @14,@14                                             1314
         IC    @14,MNKSTLEN(,@15)                                  1314
         AL    @14,MNKOFVAL(,@01)                                  1314
         BCTR  @14,0                                               1314
         L     @01,BFPTROUT                                        1314
         SLR   @00,@00                                             1314
         IC    @00,RB1CKL(,@01)                                    1314
         CR    @14,@00                                             1314
         BH    @RT01314                                            1314
         L     @01,BFPTROUT                                        1314
         CLI   RB1CKL(@01),0                                       1314
         BNE   @RF01314                                            1314
@RT01314 DS    0H                                                  1315
*                    DO;                                           1315
*                    FWSW = 1;                                     1316
         MVI   FWSW,X'01'                                          1316
*                    RB3CKL = MNKOFVAL + MNKSTLEN - 1;             1317
         L     @15,@PC00001+4                                      1317
         L     @01,FDTPTR+472(,@15)                                1317
         L     @15,@PC00001+4                                      1317
         L     @15,FDTPTR+476(,@15)                                1317
         SLR   @14,@14                                             1317
         IC    @14,MNKSTLEN(,@15)                                  1317
         AL    @14,MNKOFVAL(,@01)                                  1317
         BCTR  @14,0                                               1317
         L     @15,BFPTRIN                                         1317
         STC   @14,RB3CKL(,@15)                                    1317
*                    END;                                          1318
*                  ELSE;                                           1319
*                                                                  1319
@RF01314 DS    0H                                                  1320
*                /****************************************************/
*                /*                                                  */
*                /*   END OF USER SPECIFIED NEWKEY                   */
*                /*                                                  */
*                /****************************************************/
*                END;                                              1320
*                                                                  1320
*            /********************************************************/
*            /*                                                      */
*            /*  USER DID NOT SPECIFY KEY - MOVE KEY FROM ORIGINAL   */
*            /*   OUTPUT BUFFER                                      */
*            /*                                                      */
*            /********************************************************/
*              ELSE                                                1321
*                RB3KD(1:RB3CKL) = RB1KD(1:RB3CKL);                1321
*                                                                  1321
         B     @RC01297                                            1321
@RF01297 L     @01,BFPTRIN                                         1321
         L     @15,BFPTRIN                                         1321
         SLR   @14,@14                                             1321
         IC    @14,RB3CKL(,@15)                                    1321
         BCTR  @14,0                                               1321
         L     @15,BFPTROUT                                        1321
         EX    @14,@SM02162                                        1321
*            /********************************************************/
*            /*                                                      */
*            /*  MOVE DATA FROM OUTPUT BUFFER(RB3) TO RB1            */
*            /*                                                      */
*            /********************************************************/
*            TEMPB1PT = ADDR(RB1KD) + RB1CKL;                      1322
@RC01297 L     @01,BFPTROUT                                        1322
         LA    @15,RB1KD(,@01)                                     1322
         L     @14,BFPTROUT                                        1322
         SLR   @05,@05                                             1322
         IC    @05,RB1CKL(,@14)                                    1322
         ALR   @15,@05                                             1322
         ST    @15,TEMPB1PT                                        1322
*            TEMPB3PT = ADDR(RB3KD) + RB3CKL;                      1323
*                                                                  1323
         L     @01,BFPTRIN                                         1323
         LA    @15,RB3KD(,@01)                                     1323
         L     @14,BFPTRIN                                         1323
         SLR   @05,@05                                             1323
         IC    @05,RB3CKL(,@14)                                    1323
         ALR   @15,@05                                             1323
         ST    @15,TEMPB3PT                                        1323
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      1324
*             REG2 = TEMPB3PT;                                     1325
         L     REG2,TEMPB3PT                                       1325
*             REG3 = RB1CDL;                                       1326
         L     @01,BFPTROUT                                        1326
         LH    REG3,RB1CDL(,@01)                                   1326
         N     REG3,@CF02153                                       1326
*             REG4 = TEMPB1PT;                                     1327
         L     REG4,TEMPB1PT                                       1327
*             REG5 = RB1CDL;                                       1328
         L     @01,BFPTROUT                                        1328
         LH    REG5,RB1CDL(,@01)                                   1328
         N     REG5,@CF02153                                       1328
*             MVCL (REG2,REG4);                                    1329
         MVCL  REG2,REG4                                           1329
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     1330
*                                                                  1330
*            /********************************************************/
*            /* CHECK IF USER SPECIFIED NEWDATA PARAMETER            */
*            /********************************************************/
*            IF ADDR(MNDAT) = NULLPTR                              1331
*              THEN;                                               1331
         L     @15,@PC00001+4                                      1331
         L     @15,FDTPTR+360(,@15)                                1331
         LTR   @15,@15                                             1331
         BZ    @RT01331                                            1331
*              ELSE                                                1333
*                                                                  1333
*                /****************************************************/
*                /*                                                  */
*                /*USER SPECIFIED DATA - CHECK IF INPUT IS OK        */
*                /*IF OFFSET GREATER THAN DATA LENGTH- INPUT NOT OK */
*                /*                                                  */
*                /****************************************************/
*                DO;                                               1333
*                IF MNDOFVAL > RB1CDL + 1                          1334
*                  THEN                                            1334
*                                                                  1334
         L     @15,@PC00001+4                                      1334
         L     @01,FDTPTR+464(,@15)                                1334
         LA    @00,1                                               1334
         L     @15,BFPTROUT                                        1334
         LH    @15,RB1CDL(,@15)                                    1334
         N     @15,@CF02153                                        1334
         ALR   @00,@15                                             1334
         C     @00,MNDOFVAL(,@01)                                  1334
         BNL   @RF01334                                            1334
*                    /************************************************/
*                    /* BAD NEWDATA OFFSET. ISSUE MSG IDC31230 AND   */
*                    /*  RETURN WITH A RC = 12                       */
*                    /************************************************/
*                    DO;                                           1335
*                                                                  1335
*                     DO;                                          1336
*                       CKREQ = CKREQ && CKREQ;                    1337
         L     @15,@PC00001+8                                      1337
         XC    CKREQ(44,@15),CKREQ(@15)                            1337
*                       CKRERN = MSG30;                            1338
         L     @15,@PC00001+8                                      1338
         MVC   CKRERN(2,@15),@CH00698                              1338
*                       CKRMVAR(1) = ADDR(MNDOFVAL);               1339
         L     @15,@PC00001+8                                      1339
         L     @14,@PC00001+4                                      1339
         L     @14,FDTPTR+464(,@14)                                1339
         ST    @14,CKRMVAR(,@15)                                   1339
*                       CALL IDCRDER;                              1340
         L     @15,@CV01811                                        1340
         BALR  @14,@15                                             1340
*                     END;                                         1341
*                    RETURN CODE(LASTCC12);                        1342
         LA    @15,12                                              1342
         L     @14,@SA00005                                        1342
         LM    @00,@12,@SA00005+8                                  1342
         BR    @14                                                 1342
*                    END;                                          1343
*                                                                  1343
*                  ELSE;                                           1344
*                                                                  1344
@RF01334 DS    0H                                                  1345
*                /****************************************************/
*                /* CALCULATE THE EXPANSION IN THE SIZE OF THE DATA  */
*                /****************************************************/
*                EXP = MNDOFVAL + MNDSTLEN - 1 - RB3CDL;           1345
*                                                                  1345
         L     @15,@PC00001+4                                      1345
         L     @01,FDTPTR+464(,@15)                                1345
         L     @15,@PC00001+4                                      1345
         L     @15,FDTPTR+468(,@15)                                1345
         SLR   @14,@14                                             1345
         IC    @14,MNDSTLEN(,@15)                                  1345
         AL    @14,MNDOFVAL(,@01)                                  1345
         BCTR  @14,0                                               1345
         L     @15,BFPTRIN                                         1345
         LH    @15,RB3CDL(,@15)                                    1345
         N     @15,@CF02153                                        1345
         SLR   @14,@15                                             1345
         STH   @14,EXP                                             1345
*                /****************************************************/
*                /*                                                  */
*                /*  IF EXP IS MORE THAN ZERO, EXP HAS THE LENGTH    */
*                /*  INCREASE DUE TO THE NEWDATA PARAMETER           */
*                /*                                                  */
*                /****************************************************/
*                IF EXP > ZERO                                     1346
*                  THEN                                            1346
         LH    @15,EXP                                             1346
         LTR   @15,@15                                             1346
         BNP   @RF01346                                            1346
*                    DO;                                           1347
*                    RB3CDL = RB3CDL + EXP;                        1348
         L     @01,BFPTRIN                                         1348
         LH    @15,RB3CDL(,@01)                                    1348
         N     @15,@CF02153                                        1348
         AH    @15,EXP                                             1348
         L     @14,BFPTRIN                                         1348
         STH   @15,RB3CDL(,@14)                                    1348
*                    FWSW = YESS;                                  1349
*                                                                  1349
         MVI   FWSW,X'01'                                          1349
*                    /************************************************/
*                    /*  CHECK IF THE RECORD WITH THE INCREASED DATA */
*                    /*  WILL FIT IN THE BUFFER                      */
*                    /************************************************/
*                    IF (COUNTLN+RB3CKL+RB3CDL) > DEVTC            1350
*                      THEN                                        1350
*                                                                  1350
         LA    @15,8                                               1350
         L     @14,BFPTRIN                                         1350
         SLR   @05,@05                                             1350
         IC    @05,RB3CKL(,@14)                                    1350
         ALR   @15,@05                                             1350
         L     @14,BFPTRIN                                         1350
         LH    @14,RB3CDL(,@14)                                    1350
         N     @14,@CF02153                                        1350
         ALR   @15,@14                                             1350
         L     @14,@PC00001+8                                      1350
         L     @01,REPODEVA(,@14)                                  1350
         LH    @14,DEVTC(,@01)                                     1350
         N     @14,@CF02153                                        1350
         CR    @15,@14                                             1350
         BNH   @RF01350                                            1350
*                        /********************************************/
*                        /* RECORD WITH ADDITIONAL NEWDATA WILL NOT  */
*                        /* FIT IN BUFFER.  ISSUE MSG IDC31232I AND  */
*                        /* RETURN WITH A RC = 12                    */
*                        /********************************************/
*                        DO;                                       1351
*                                                                  1351
*                         DO;                                      1352
*                           CKREQ = CKREQ && CKREQ;                1353
         L     @15,@PC00001+8                                      1353
         XC    CKREQ(44,@15),CKREQ(@15)                            1353
*                           CKRERN = MSG32;                        1354
         L     @15,@PC00001+8                                      1354
         MVC   CKRERN(2,@15),@CH00223                              1354
*                           CKRMVAR(1) = ADDR(DSNMSG);             1355
         L     @15,@PC00001+8                                      1355
         LA    @14,DSNMSG                                          1355
         ST    @14,CKRMVAR(,@15)                                   1355
*                           CALL IDCRDER;                          1356
         L     @15,@CV01811                                        1356
         BALR  @14,@15                                             1356
*                         END;                                     1357
*                        RETURN CODE(LASTCC12);                    1358
         LA    @15,12                                              1358
         L     @14,@SA00005                                        1358
         LM    @00,@12,@SA00005+8                                  1358
         BR    @14                                                 1358
*                        END;                                      1359
*                      ELSE;                                       1360
*                                                                  1360
@RF01350 DS    0H                                                  1361
*                    /************************************************/
*                    /*      END OF EXP > 0                          */
*                    /************************************************/
*                    END;                                          1361
*                                                                  1361
*                  ELSE;                                           1362
*                                                                  1362
@RF01346 DS    0H                                                  1363
*                /****************************************************/
*                /*                                                  */
*                /*    MOVE DATA FROM INPUT PARAM STREAM             */
*                /*    TO NEW INPUT BUFFER                           */
*                /*    DATA CANT BE MORE THAN 256 BYTES              */
*                /****************************************************/
*                RB3KD(RB3CKL+MNDOFVAL:(MNDSTLEN+RB3CKL+MNDOFVAL-1))=
*                      MNDSTVAL;                                   1363
*                                                                  1363
         L     @15,@PC00001+4                                      1363
         L     @01,FDTPTR+464(,@15)                                1363
         L     @15,BFPTRIN                                         1363
         SLR   @14,@14                                             1363
         IC    @14,RB3CKL(,@15)                                    1363
         AL    @14,MNDOFVAL(,@01)                                  1363
         L     @01,BFPTRIN                                         1363
         ALR   @01,@14                                             1363
         L     @15,@PC00001+4                                      1363
         L     @15,FDTPTR+468(,@15)                                1363
         SLR   @14,@14                                             1363
         IC    @14,MNDSTLEN(,@15)                                  1363
         L     @15,BFPTRIN                                         1363
         SLR   @05,@05                                             1363
         IC    @05,RB3CKL(,@15)                                    1363
         ALR   @14,@05                                             1363
         L     @15,@PC00001+4                                      1363
         L     @15,FDTPTR+464(,@15)                                1363
         AL    @14,MNDOFVAL(,@15)                                  1363
         L     @15,@PC00001+4                                      1363
         L     @15,FDTPTR+464(,@15)                                1363
         L     @05,BFPTRIN                                         1363
         SLR   @04,@04                                             1363
         IC    @04,RB3CKL(,@05)                                    1363
         AL    @04,MNDOFVAL(,@15)                                  1363
         SLR   @14,@04                                             1363
         BCTR  @14,0                                               1363
         L     @15,@PC00001+4                                      1363
         L     @15,FDTPTR+468(,@15)                                1363
         EX    @14,@SM02166                                        1363
*              /******************************************************/
*              /*      END OF NEWDATA SPECIFIED ELSE                 */
*              /******************************************************/
*              END;                                                1364
*                                                                  1364
*          /**********************************************************/
*          /*    END OF DATA SUPPLIED INFORMATION                    */
*          /**********************************************************/
*          END;                                                    1365
*                                                                  1365
@RT01331 DS    0H                                                  1366
*        /************************************************************/
*        /*                                                          */
*        /*  RB3, THE INPUT BUFFER CONTAINS THE NEW RECORD           */
*        /*  FIRST SEE IF A FORMAT WRITE IS NEEDED                   */
*        /*                                                          */
*        /************************************************************/
*        IF FWSW = NOT                                             1366
*          THEN                                                    1366
*                                                                  1366
@RC01263 CLI   FWSW,0                                              1366
         BNE   @RF01366                                            1366
*            /********************************************************/
*            /*                                                      */
*            /* NO FORMAT WRITE - JUST BUILD ARG LIST FOR            */
*            /* UEXCP AND REWRITE THE MODIFIED RECORD                */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1367
*            RDCTLBK = REPODSOP;                                   1368
         L     @15,@PC00001+8                                      1368
         L     @01,REPODSAR(,@15)                                  1368
         L     @15,@PC00001+8                                      1368
         L     @00,REPODSOP(,@15)                                  1368
         ST    @00,RDCTLBK(,@01)                                   1368
*            RDIOAREA = BFPTRIN;                                   1369
         L     @15,@PC00001+8                                      1369
         L     @01,REPODSAR(,@15)                                  1369
         L     @00,BFPTRIN                                         1369
         ST    @00,RDIOAREA(,@01)                                  1369
*            RDCHR = RB1CCHR;                                      1370
         L     @15,@PC00001+8                                      1370
         L     @01,REPODSAR(,@15)                                  1370
         L     @15,BFPTROUT                                        1370
         MVC   RDCHR(5,@01),RB1CCHR(@15)                           1370
*            RDDS = ZERO;                                          1371
         L     @15,@PC00001+8                                      1371
         L     @01,REPODSAR(,@15)                                  1371
         MVI   RDDS(@01),X'00'                                     1371
*            RDFUNC = WRKYDATA;                                    1372
*                                                                  1372
         L     @15,@PC00001+8                                      1372
         L     @01,REPODSAR(,@15)                                  1372
         MVI   RDFUNC(@01),X'03'                                   1372
*            /********************************************************/
*            /*                                                      */
*            /*  CALL UEXCP TO WRITE KEY/DATA                        */
*            /********************************************************/
*            CALL IDCIO050(GDTTBL,WRITEREC,RDARG);                 1373
         L     @15,@PC00001                                        1373
         ST    @15,@AL00001                                        1373
         LA    @15,WRITEREC                                        1373
         ST    @15,@AL00001+4                                      1373
         L     @15,@PC00001+8                                      1373
         L     @01,REPODSAR(,@15)                                  1373
         ST    @01,@AL00001+8                                      1373
         MVI   @AL00001+8,X'80'                                    1373
         L     @14,@PC00001                                        1373
         L     @15,GDTEXP(,@14)                                    1373
         LA    @01,@AL00001                                        1373
         BALR  @14,@15                                             1373
*            RESPECIFY RTNREG RSTD;                                1374
*            TESTRC = RTNREG;                                      1375
         STH   RTNREG,TESTRC                                       1375
*            RESPECIFY RTNREG UNRSTD;                              1376
*            IF TESTRC ^= 0                                        1377
*              THEN                                                1377
         LH    @15,TESTRC                                          1377
         LTR   @15,@15                                             1377
         BZ    @RF01377                                            1377
*                DO;                                               1378
*                                                                  1378
*                /****************************************************/
*                /*                                                  */
*                /* ISSUE MSG IDC31245I - I/O ERROR MODIFYING TRACK  */
*                /*                                                  */
*                /****************************************************/
*                                                                  1379
*                 DO;                                              1379
*                   CKREQ = CKREQ && CKREQ;                        1380
         L     @15,@PC00001+8                                      1380
         XC    CKREQ(44,@15),CKREQ(@15)                            1380
*                   CKRERN = MSG45;                                1381
         L     @15,@PC00001+8                                      1381
         MVC   CKRERN(2,@15),@CH00767                              1381
*                   CKRMVAR(1) = ADDR(RDCHR);                      1382
         L     @15,@PC00001+8                                      1382
         L     @14,@PC00001+8                                      1382
         L     @01,REPODSAR(,@14)                                  1382
         LA    @14,RDCHR(,@01)                                     1382
         ST    @14,CKRMVAR(,@15)                                   1382
*                   CKRMVAR(2) = ADDR(DSNMSG);                     1383
         L     @15,@PC00001+8                                      1383
         LA    @14,DSNMSG                                          1383
         ST    @14,CKRMVAR+4(,@15)                                 1383
*                   CALL IDCRDER;                                  1384
         L     @15,@CV01811                                        1384
         BALR  @14,@15                                             1384
*                 END;                                             1385
*                RETURN CODE(LASTCC12);                            1386
         LA    @15,12                                              1386
         L     @14,@SA00005                                        1386
         LM    @00,@12,@SA00005+8                                  1386
         BR    @14                                                 1386
*                END;                                              1387
*              ELSE                                                1388
*                RETURN CODE(LASTCC00);                            1388
@RF01377 SLR   @15,@15                                             1388
         L     @14,@SA00005                                        1388
         LM    @00,@12,@SA00005+8                                  1388
         BR    @14                                                 1388
*            END;                                                  1389
*                                                                  1389
*          ELSE;                                                   1390
@RF01366 DS    0H                                                  1391
*        /************************************************************/
*        /*   MODIFIED RECORD MUST BE WRITTEN WITH A FORMAT WRITE    */
*        /*                                                          */
*        /*   INITIALIZE COUNTERS- SIGMA WILL BE THE NUMBER OF       */
*        /*    BYTES ON THE TRACK SO FAR - SUMKEY WILL BE THE        */
*        /*    NUMBER OF RECORDS ON THE TRACK WITH KEY FIELDS        */
*        /*    AND SUMNOKEY WILL BE THE NUMBER OF RECORDS ON THE     */
*        /*    TRACK WITH NO KEY FIELDS                              */
*        /*    NOTE THAT R0 IS NOT PART OF THE TRACK CAPACITY        */
*        /*                                                          */
*        /************************************************************/
*        SIGMA = ZERO;                                             1391
         SLR   @15,@15                                             1391
         ST    @15,SIGMA                                           1391
*        SUMKEY = ZERO;                                            1392
         SLR   @15,@15                                             1392
         STH   @15,SUMKEY                                          1392
*        SUMNOKEY = ZERO;                                          1393
*                                                                  1393
         SLR   @15,@15                                             1393
         STH   @15,SUMNOKEY                                        1393
*        /************************************************************/
*        /*    SAVE THE CCHHR OF THE INPUT RECORD                    */
*        /************************************************************/
*        SAVCHR = RB3CCHR;                                         1394
*                                                                  1394
         L     @01,BFPTRIN                                         1394
         MVC   SAVCHR(5),RB3CCHR(@01)                              1394
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK IF TRYING TO MODIFY RECORD ZERO COUNT- THATS      */
*        /*      A NO-NO                                             */
*        /*                                                          */
*        /************************************************************/
*        IF SAVCHR1 = ZERO                                         1395
*          THEN                                                    1395
*                                                                  1395
         CLI   SAVCHR1,0                                           1395
         BNE   @RF01395                                            1395
*            /********************************************************/
*            /* CANNOT WRITE R0 COUNT FIELD                          */
*            /* ISSUE MESSAGE AND RETURN CODE 12                     */
*            /********************************************************/
*            DO;                                                   1396
*                                                                  1396
*             DO;                                                  1397
*               CKREQ = CKREQ && CKREQ;                            1398
         L     @15,@PC00001+8                                      1398
         XC    CKREQ(44,@15),CKREQ(@15)                            1398
*               CKRERN = MSG43;                                    1399
         L     @15,@PC00001+8                                      1399
         MVC   CKRERN(2,@15),@CH00753                              1399
*               CKRMVAR(1) = ADDR(SAVCHR);                         1400
         L     @15,@PC00001+8                                      1400
         LA    @14,SAVCHR                                          1400
         ST    @14,CKRMVAR(,@15)                                   1400
*               CALL IDCRDER;                                      1401
         L     @15,@CV01811                                        1401
         BALR  @14,@15                                             1401
*             END;                                                 1402
*            RETURN CODE(LASTCC12);                                1403
         LA    @15,12                                              1403
         L     @14,@SA00005                                        1403
         LM    @00,@12,@SA00005+8                                  1403
         BR    @14                                                 1403
*            END;                                                  1404
*                                                                  1404
*          ELSE;                                                   1405
*                                                                  1405
@RF01395 DS    0H                                                  1406
*        /************************************************************/
*        /*  READ IN ALL RECORDS PRIOR TO REQUEST RECORD IN RB0      */
*        /*  EXCLUDING R0,                                           */
*        /*  TO CALCULATE THE NUMBER OF BYTES USED                   */
*        /*  ON THE TRACK SO FAR                                     */
*        /*  SET THE CONSTANT PARAMETERS IN THE READ ARGUMENT LIST   */
*        /*                                                          */
*        /************************************************************/
*        RDCTLBK = REPODSOP;                                       1406
         L     @15,@PC00001+8                                      1406
         L     @01,REPODSAR(,@15)                                  1406
         L     @15,@PC00001+8                                      1406
         L     @00,REPODSOP(,@15)                                  1406
         ST    @00,RDCTLBK(,@01)                                   1406
*        RDIOAREA = REPOBFPT;                                      1407
         L     @15,@PC00001+8                                      1407
         L     @01,REPODSAR(,@15)                                  1407
         L     @15,@PC00001+8                                      1407
         L     @00,REPOBFPT(,@15)                                  1407
         ST    @00,RDIOAREA(,@01)                                  1407
*        RDDS = ZERO;                                              1408
         L     @15,@PC00001+8                                      1408
         L     @01,REPODSAR(,@15)                                  1408
         MVI   RDDS(@01),X'00'                                     1408
*        PREVREC = SAVCHR1 - 1;                                    1409
*                                                                  1409
         SLR   @15,@15                                             1409
         IC    @15,SAVCHR1                                         1409
         BCTR  @15,0                                               1409
         STC   @15,PREVREC                                         1409
*        /************************************************************/
*        /* CHECK IS THERE IS AT LEAST ONE PREVIOUS RECORD           */
*        /************************************************************/
*        IF PREVREC = ZERO                                         1410
*          THEN;                                                   1410
         CLI   PREVREC,0                                           1410
         BE    @RT01410                                            1410
*          ELSE                                                    1412
*                                                                  1412
*            /********************************************************/
*            /*                                                      */
*            /*  THERE IS AT LEAST ONE RECORD IN THE TRACK PRECEEDING*/
*            /*  THE ONE TO BE MODIFIED.  ALL PREVIOUS RECORDS MUST  */
*            /*  BE READ TO COMPUTE HOW MUCH SPACE IS LEFT IN THE    */
*            /*  TRACK                                               */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1412
*                                                                  1412
*            /********************************************************/
*            /*  LOOP UNTIL CURRENT RECORD                           */
*            /********************************************************/
*            DO I6 = 1 TO PREVREC;                                 1413
*                                                                  1413
         LA    @15,1                                               1413
         B     @DE01413                                            1413
@DL01413 DS    0H                                                  1414
*            /********************************************************/
*            /*SET RECORD NUMBER AND MOVE CCHHR TO READ ARGUMENT LIST*/
*            /********************************************************/
*            SAVCHR1 = I6;                                         1414
         MVC   SAVCHR1(1),I6+1                                     1414
*            RDCHR = SAVCHR;                                       1415
*                                                                  1415
         L     @15,@PC00001+8                                      1415
         L     @01,REPODSAR(,@15)                                  1415
         MVC   RDCHR(5,@01),SAVCHR                                 1415
*            /********************************************************/
*            /*  CALL IDCRDRD TO READ THE RECORD                     */
*            /********************************************************/
*            CALL IDCRDRD(RDARG);                                  1416
         L     @15,@PC00001+8                                      1416
         L     @01,REPODSAR(,@15)                                  1416
         ST    @01,@AL00001                                        1416
         L     @15,@CV01812                                        1416
         LA    @01,@AL00001                                        1416
         BALR  @14,@15                                             1416
*            RESPECIFY RTNREG RSTD;                                1417
*            TESTRC = RTNREG;                                      1418
         STH   RTNREG,TESTRC                                       1418
*            RESPECIFY RTNREG UNRSTD;                              1419
*            RESPECIFY RB0 BASED(RDDARE);                          1420
*                                                                  1420
*            /********************************************************/
*            /*  CHECK THE RETURN CODE - IF IT IS NOT                */
*            /*  OK OR RECORD NOT FOUND                              */
*            /*  THEN PRIOR ERROR EXISTS ON TRACK                    */
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC > GOODCNT & TESTRC ^= NTFNDRD               1421
*              THEN                                                1421
         LH    @15,TESTRC                                          1421
         C     @15,@CF00288                                        1421
         BNH   @RF01421                                            1421
         CLC   TESTRC(2),@CH01990                                  1421
         BE    @RF01421                                            1421
*                DO;                                               1422
*                                                                  1422
*                /****************************************************/
*                /*     BAD RECORD PRECEDING THE ONE TO BE UPDATED   */
*                /*     ISSUE MSG IDC31242I AND RETURN WITH RC=12    */
*                /****************************************************/
*                                                                  1423
*                 DO;                                              1423
*                   CKREQ = CKREQ && CKREQ;                        1424
         L     @15,@PC00001+8                                      1424
         XC    CKREQ(44,@15),CKREQ(@15)                            1424
*                   CKRERN = MSG42;                                1425
         L     @15,@PC00001+8                                      1425
         MVC   CKRERN(2,@15),@CH00742                              1425
*                   CKRMVAR(1) = ADDR(PRECED);                     1426
         L     @15,@PC00001+8                                      1426
         LA    @14,PRECED                                          1426
         ST    @14,CKRMVAR(,@15)                                   1426
*                   CKRMVAR(2) = ADDR(MOKAD6);                     1427
         L     @15,@PC00001+8                                      1427
         LA    @14,MOKAD6                                          1427
         ST    @14,CKRMVAR+4(,@15)                                 1427
*                   CKRMVAR(3) = ADDR(MOKAD5);                     1428
         L     @15,@PC00001+8                                      1428
         LA    @14,MOKAD5                                          1428
         ST    @14,CKRMVAR+8(,@15)                                 1428
*                   CKRMVAR(4) = ADDR(DSNMSG);                     1429
         L     @15,@PC00001+8                                      1429
         LA    @14,DSNMSG                                          1429
         ST    @14,CKRMVAR+12(,@15)                                1429
*                   CALL IDCRDER;                                  1430
         L     @15,@CV01811                                        1430
         BALR  @14,@15                                             1430
*                 END;                                             1431
*                RETURN CODE(LASTCC12);                            1432
         LA    @15,12                                              1432
         L     @14,@SA00005                                        1432
         LM    @00,@12,@SA00005+8                                  1432
         BR    @14                                                 1432
*                END;                                              1433
*              ELSE;                                               1434
*                                                                  1434
@RF01421 DS    0H                                                  1435
*            /*******************************************************/
*            /*  THIS RECORD OK - SEE IF RECORD FOUND               */
*            /*******************************************************/
*            IF TESTRC ^= NTFNDRD                                  1435
*              THEN                                                1435
         CLC   TESTRC(2),@CH01990                                  1435
         BE    @RF01435                                            1435
*                DO;                                               1436
*                                                                  1436
*                /*****************************************************
*                /*ADD LENGTH OF THIS RECORD TO LENGTH OF TRACK SO FAR*
*                /*IF KEY EXISTS, ADD ONE TO SUM OF RECS WITH KEYS.   *
*                /*OTHERWISE ADD ONE TO SUM OF RECS WITHOUT KEYS.     *
*                /*LENGTH OF THIS RECORD IS KEY LEN PLUS DATA LEN     *
*                /*OF RECORD IN BUFFER.                               *
*                /*                                                   *
*                /*****************************************************
*                SIGMA = SIGMA + RB0CKL+ RB0CDL;                   1437
         L     @15,@PC00001+8                                      1437
         L     @01,REPODSAR(,@15)                                  1437
         L     @01,RDDARE(,@01)                                    1437
         SLR   @00,@00                                             1437
         IC    @00,RB0CKL(,@01)                                    1437
         AL    @00,SIGMA                                           1437
         L     @01,@PC00001+8                                      1437
         L     @01,REPODSAR(,@01)                                  1437
         L     @01,RDDARE(,@01)                                    1437
         LH    @01,RB0CDL(,@01)                                    1437
         N     @01,@CF02153                                        1437
         ALR   @00,@01                                             1437
         ST    @00,SIGMA                                           1437
*                IF RB0CKL ^= ZERO                                 1438
*                  THEN                                            1438
         L     @15,@PC00001+8                                      1438
         L     @01,REPODSAR(,@15)                                  1438
         L     @01,RDDARE(,@01)                                    1438
         CLI   RB0CKL(@01),0                                       1438
         BE    @RF01438                                            1438
*                    SUMKEY=SUMKEY + 1;                            1439
         LA    @15,1                                               1439
         LH    @14,SUMKEY                                          1439
         N     @14,@CF02153                                        1439
         ALR   @15,@14                                             1439
         STH   @15,SUMKEY                                          1439
*                  ELSE                                            1440
*                    SUMNOKEY = SUMNOKEY + 1;                      1440
*                                                                  1440
         B     @RC01438                                            1440
@RF01438 LA    @15,1                                               1440
         AH    @15,SUMNOKEY                                        1440
         STH   @15,SUMNOKEY                                        1440
*                /*****************************************************
*                /* IF END OF FILE RECORD THEN THE DATA LENGTH IS ZERO*
*                /*      BUT ACTUAL BYTES USED ON THE TRACK IS ONE    *
*                /*****************************************************
*                                                                  1441
*                IF  RB0CDL = ZERO                                 1441
*                  THEN                                            1441
@RC01438 L     @15,@PC00001+8                                      1441
         L     @01,REPODSAR(,@15)                                  1441
         L     @01,RDDARE(,@01)                                    1441
         LH    @15,RB0CDL(,@01)                                    1441
         N     @15,@CF02153                                        1441
         LTR   @15,@15                                             1441
         BNZ   @RF01441                                            1441
*                    SIGMA = SIGMA + 1;                            1442
         LA    @15,1                                               1442
         AL    @15,SIGMA                                           1442
         ST    @15,SIGMA                                           1442
*                  ELSE;                                           1443
@RF01441 DS    0H                                                  1444
*                END;                                              1444
*                                                                  1444
*              /******************************************************/
*              /*IF RECORD NOT FOUND - JUST LOOP AGAIN*/           1445
*              /******************************************************/
*              ELSE;                                               1445
*                                                                  1445
@RF01435 DS    0H                                                  1446
*            /********************************************************/
*            /*END OF DO I6 = 1 TO PREVREC                           */
*            /********************************************************/
*            END;                                                  1446
*                                                                  1446
         LA    @15,1                                               1446
         LH    @14,I6                                              1446
         N     @14,@CF02153                                        1446
         ALR   @15,@14                                             1446
@DE01413 STH   @15,I6                                              1446
         SLR   @14,@14                                             1446
         IC    @14,PREVREC                                         1446
         CR    @15,@14                                             1446
         BNH   @DL01413                                            1446
*            /********************************************************/
*            /*  END OF ELSE                                         */
*            /********************************************************/
*            END;                                                  1447
*                                                                  1447
*        /************************************************************/
*        /*    ALL RECORDS UP TO INPUT RECORD HAVE BEEN READ         */
*        /*    SIGMA HAS THE NUMBER OF BYTES USED SO FAR.            */
*        /*    ADD OVERHEAD FACTORS FOR THE DEVICE                   */
*        /*    TYPE   AND SAVE SIGMA                                 */
*        /************************************************************/
*        SIGMA = SIGMA + SUMKEY * KYCNST+ SUMNOKEY*NOKYCNST;       1448
*                                                                  1448
@RT01410 LH    @01,KYCNST                                          1448
         N     @01,@CF02153                                        1448
         LH    @15,SUMKEY                                          1448
         N     @15,@CF02153                                        1448
         MR    @00,@15                                             1448
         AL    @01,SIGMA                                           1448
         SLR   @00,@00                                             1448
         IC    @00,NOKYCNST                                        1448
         MH    @00,SUMNOKEY                                        1448
         ALR   @01,@00                                             1448
         ST    @01,SIGMA                                           1448
*        /************************************************************/
*        /*    ADD TO THE SAVED VALUE OF SIGMA THE NUMBER            */
*        /*    OF BYTES IN THE INPUT RECORD- AND ADJUST              */
*        /*    FOR THE PADDING FACTOR FOR THE DEVICE TYPE            */
*        /************************************************************/
*        SAVSIG = SIGMA + RB3CKL + RB3CDL;                         1449
         L     @01,BFPTRIN                                         1449
         SLR   @00,@00                                             1449
         IC    @00,RB3CKL(,@01)                                    1449
         AL    @00,SIGMA                                           1449
         L     @01,BFPTRIN                                         1449
         LH    @01,RB3CDL(,@01)                                    1449
         N     @01,@CF02153                                        1449
         ALR   @00,@01                                             1449
         STH   @00,SAVSIG                                          1449
*        IF RB3CKL ^= ZERO                                         1450
*          THEN                                                    1450
         L     @01,BFPTRIN                                         1450
         CLI   RB3CKL(@01),0                                       1450
         BE    @RF01450                                            1450
*            SAVSIG=SAVSIG+KYCNST;                                 1451
         LH    @15,SAVSIG                                          1451
         N     @15,@CF02153                                        1451
         LH    @14,KYCNST                                          1451
         N     @14,@CF02153                                        1451
         ALR   @15,@14                                             1451
         STH   @15,SAVSIG                                          1451
*          ELSE                                                    1452
*            SAVSIG = SAVSIG + NOKYCNST;                           1452
         B     @RC01450                                            1452
@RF01450 LH    @15,SAVSIG                                          1452
         N     @15,@CF02153                                        1452
         SLR   @14,@14                                             1452
         IC    @14,NOKYCNST                                        1452
         ALR   @15,@14                                             1452
         STH   @15,SAVSIG                                          1452
*        IF RB3CDL = ZERO                                          1453
*          THEN                                                    1453
@RC01450 L     @01,BFPTRIN                                         1453
         LH    @15,RB3CDL(,@01)                                    1453
         N     @15,@CF02153                                        1453
         LTR   @15,@15                                             1453
         BNZ   @RF01453                                            1453
*            SAVSIG = SAVSIG + 1;                                  1454
         LA    @15,1                                               1454
         LH    @14,SAVSIG                                          1454
         N     @14,@CF02153                                        1454
         ALR   @15,@14                                             1454
         STH   @15,SAVSIG                                          1454
*          ELSE;                                                   1455
*                                                                  1455
@RF01453 DS    0H                                                  1456
*        /************************************************************/
*        /*   RESET COUNTERS AND READ ALL SUBSEQUENT RECORD ON       */
*        /*   THE TRACK TO COMPUTE THE TOTAL NUMBER OF BYTES         */
*        /*   THAT WILL BE USED                                      */
*        /*                                                          */
*        /************************************************************/
*        SIGMA = ZERO;                                             1456
         SLR   @15,@15                                             1456
         ST    @15,SIGMA                                           1456
*        SUMKEY = ZERO;                                            1457
         SLR   @15,@15                                             1457
         STH   @15,SUMKEY                                          1457
*        SUMNOKEY=ZERO;                                            1458
*                                                                  1458
         SLR   @15,@15                                             1458
         STH   @15,SUMNOKEY                                        1458
*        /************************************************************/
*        /*  SET CONSTANT FIELDS FOR READ ARG LIST                   */
*        /************************************************************/
*        RDCTLBK = REPODSOP;                                       1459
         L     @15,@PC00001+8                                      1459
         L     @01,REPODSAR(,@15)                                  1459
         L     @15,@PC00001+8                                      1459
         L     @00,REPODSOP(,@15)                                  1459
         ST    @00,RDCTLBK(,@01)                                   1459
*        RDIOAREA = REPOBFPT;                                      1460
         L     @15,@PC00001+8                                      1460
         L     @01,REPODSAR(,@15)                                  1460
         L     @15,@PC00001+8                                      1460
         L     @00,REPOBFPT(,@15)                                  1460
         ST    @00,RDIOAREA(,@01)                                  1460
*        RDDS = ZERO;                                              1461
*                                                                  1461
         L     @15,@PC00001+8                                      1461
         L     @01,REPODSAR(,@15)                                  1461
         MVI   RDDS(@01),X'00'                                     1461
*        /************************************************************/
*        /*  SET INIT VALUE OF CCHHR TO READ                         */
*        /*                                                          */
*        /************************************************************/
*        SAVCHR = RB3CCHR;                                         1462
*                                                                  1462
         L     @01,BFPTRIN                                         1462
         MVC   SAVCHR(5),RB3CCHR(@01)                              1462
*        /************************************************************/
*        /*  INITIALIZE COUNT OF RECORDS READ AFTER REQUESTED ONE    */
*        /************************************************************/
*        SVRECNUM = ZERO;                                          1463
         MVI   SVRECNUM,X'00'                                      1463
*        LASTOVFL = NOT;                                           1464
*                                                                  1464
         MVI   LASTOVFL,X'00'                                      1464
*        /************************************************************/
*        /*  ALL THE RECORDS PAST THE RECORD TO BE MODIFIED MUST     */
*        /*  BE READ TO CALCULATE THE NUMBER OF BYTES LEFT IN THE    */
*        /*  TRACK LOOP TO LAST RECORD ON THE TRACK - FROM THE RECORD*/
*        /*  BEYOND THE INPUT RECORD                                 */
*        /*                                                          */
*        /************************************************************/
*        DO I6 = (RB3CR + 1) TO MAXNURCD;                          1465
*                                                                  1465
         LA    @15,1                                               1465
         L     @14,BFPTRIN                                         1465
         SLR   @05,@05                                             1465
         IC    @05,RB3CR(,@14)                                     1465
         ALR   @15,@05                                             1465
         B     @DE01465                                            1465
@DL01465 DS    0H                                                  1466
*        /************************************************************/
*        /*  SET RECORD NUMBER AND MOVE CCHHR TO READ ARGUMENT LIST  */
*        /************************************************************/
*        SAVCHR1 = I6;                                             1466
         MVC   SAVCHR1(1),I6+1                                     1466
*        RDCHR = SAVCHR;                                           1467
*                                                                  1467
         L     @15,@PC00001+8                                      1467
         L     @01,REPODSAR(,@15)                                  1467
         MVC   RDCHR(5,@01),SAVCHR                                 1467
*        /************************************************************/
*        /*  CALL IDCRDRD TO READ THE RECORD                         */
*        /************************************************************/
*        CALL IDCRDRD(RDARG);                                      1468
         L     @15,@PC00001+8                                      1468
         L     @01,REPODSAR(,@15)                                  1468
         ST    @01,@AL00001                                        1468
         L     @15,@CV01812                                        1468
         LA    @01,@AL00001                                        1468
         BALR  @14,@15                                             1468
*        RESPECIFY RTNREG RSTD;                                    1469
*        TESTRC = RTNREG;                                          1470
         STH   RTNREG,TESTRC                                       1470
*        RESPECIFY RTNREG UNRSTD;                                  1471
*                                                                  1471
*        /************************************************************/
*        /*   CHECK TO SEE IF AT END OF TRACK - IF SO THEN           */
*        /*     GET OUT OF LOOP                                      */
*        /************************************************************/
*        IF TESTRC = ENDTRK                                        1472
*          THEN                                                    1472
*                                                                  1472
         CLC   TESTRC(2),@CH00698                                  1472
         BNE   @RF01472                                            1472
*        /************************************************************/
*        /*   GET OUT OF LOOP                                        */
*        /************************************************************/
*            I6 = MAXNURCD;                                        1473
         MVC   I6(2),@CH00689                                      1473
*          ELSE                                                    1474
*            DO;                                                   1474
*                                                                  1474
         B     @RC01472                                            1474
@RF01472 DS    0H                                                  1475
*            /********************************************************/
*            /*   CHECK IF RECORD NOT FOUND                          */
*            /********************************************************/
*            IF TESTRC = NTFNDRD                                   1475
*              /******************************************************/
*              /*YES-THEN JUST CONTINUE                              */
*              /******************************************************/
*                                                                  1475
*              THEN;                                               1475
*                                                                  1475
         CLC   TESTRC(2),@CH01990                                  1475
         BE    @RT01475                                            1475
*              ELSE                                                1477
*                                                                  1477
*                /****************************************************/
*                /* CK RETURN CODE IS OK FOR A                       */
*                /* VALID CONDITION THAT CAN OCCUR IF A DATA SET     */
*                /* PROCESS IS TAKING PLACE                          */
*                /* OTHERWISE IS AN UNCORRECTABLE TRACK              */
*                /****************************************************/
*                DO;                                               1477
*                IF (TESTRC > 15 & TESTRC < 29)  TESTRC = UNEXPEC 1478
*                             TESTRC = NOSYNCBY                   1478
*                  THEN                                            1478
         LH    @15,TESTRC                                          1478
         C     @15,@CF00230                                        1478
         BNH   @GL00017                                            1478
         LH    @15,TESTRC                                          1478
         C     @15,@CF00694                                        1478
         BL    @RT01478                                            1478
@GL00017 CLC   TESTRC(2),@CH00046                                  1478
         BE    @RT01478                                            1478
         CLC   TESTRC(2),@CH00223                                  1478
         BNE   @RF01478                                            1478
@RT01478 DS    0H                                                  1479
*                    DO;                                           1479
*                                                                  1479
*                    /************************************************/
*                    /* BAD RETURN CODE- CANNOT WRITE                */
*                    /* ISSUE MSG IDC31242 AND RETURN WITH RC = 12   */
*                    /************************************************/
*                                                                  1480
*                     DO;                                          1480
*                       CKREQ = CKREQ && CKREQ;                    1481
         L     @15,@PC00001+8                                      1481
         XC    CKREQ(44,@15),CKREQ(@15)                            1481
*                       CKRERN = MSG42;                            1482
         L     @15,@PC00001+8                                      1482
         MVC   CKRERN(2,@15),@CH00742                              1482
*                       CKRMVAR(1) = ADDR(SUBSEQ);                 1483
         L     @15,@PC00001+8                                      1483
         LA    @14,SUBSEQ                                          1483
         ST    @14,CKRMVAR(,@15)                                   1483
*                       CKRMVAR(2) = ADDR(MOKAD6);                 1484
         L     @15,@PC00001+8                                      1484
         LA    @14,MOKAD6                                          1484
         ST    @14,CKRMVAR+4(,@15)                                 1484
*                       CKRMVAR(3) = ADDR(MOKAD5);                 1485
         L     @15,@PC00001+8                                      1485
         LA    @14,MOKAD5                                          1485
         ST    @14,CKRMVAR+8(,@15)                                 1485
*                       CKRMVAR(4) = ADDR(DSNMSG);                 1486
         L     @15,@PC00001+8                                      1486
         LA    @14,DSNMSG                                          1486
         ST    @14,CKRMVAR+12(,@15)                                1486
*                       CALL IDCRDER;                              1487
         L     @15,@CV01811                                        1487
         BALR  @14,@15                                             1487
*                     END;                                         1488
*                    RETURN CODE(LASTCC12);                        1489
         LA    @15,12                                              1489
         L     @14,@SA00005                                        1489
         LM    @00,@12,@SA00005+8                                  1489
         BR    @14                                                 1489
*                    END;                                          1490
*                  ELSE;                                           1491
*                                                                  1491
@RF01478 DS    0H                                                  1492
*                /****************************************************/
*                /* THE RECORD JUST READ IN IS OK - COMPUTE ITS      */
*                /* SIZE AND ADD TO NUMBER OF BYTES SO FAR           */
*                /* IF OVERFLOW RECORD, SET LASTOVFL TO ONE          */
*                /****************************************************/
*                SIGMA = SIGMA + RB0CKL + RB0CDL;                  1492
         L     @15,@PC00001+8                                      1492
         L     @01,REPODSAR(,@15)                                  1492
         L     @01,RDDARE(,@01)                                    1492
         SLR   @00,@00                                             1492
         IC    @00,RB0CKL(,@01)                                    1492
         AL    @00,SIGMA                                           1492
         L     @01,@PC00001+8                                      1492
         L     @01,REPODSAR(,@01)                                  1492
         L     @01,RDDARE(,@01)                                    1492
         LH    @01,RB0CDL(,@01)                                    1492
         N     @01,@CF02153                                        1492
         ALR   @00,@01                                             1492
         ST    @00,SIGMA                                           1492
*                IF TESTRC = OVFLRCD                               1493
*                  THEN                                            1493
         CLC   TESTRC(2),@CH00044                                  1493
         BNE   @RF01493                                            1493
*                    LASTOVFL = YESS;                              1494
         MVI   LASTOVFL,X'01'                                      1494
*                  ELSE;                                           1495
@RF01493 DS    0H                                                  1496
*                IF RB0CKL ^= ZERO                                 1496
*                  THEN                                            1496
         L     @15,@PC00001+8                                      1496
         L     @01,REPODSAR(,@15)                                  1496
         L     @01,RDDARE(,@01)                                    1496
         CLI   RB0CKL(@01),0                                       1496
         BE    @RF01496                                            1496
*                    SUMKEY = SUMKEY + 1;                          1497
         LA    @15,1                                               1497
         LH    @14,SUMKEY                                          1497
         N     @14,@CF02153                                        1497
         ALR   @15,@14                                             1497
         STH   @15,SUMKEY                                          1497
*                  ELSE                                            1498
*                    SUMNOKEY = SUMNOKEY + 1;                      1498
*                                                                  1498
         B     @RC01496                                            1498
@RF01496 LA    @15,1                                               1498
         AH    @15,SUMNOKEY                                        1498
         STH   @15,SUMNOKEY                                        1498
*                /****************************************************/
*                /* INCREMENT COUNT OF RECORDS READ                  */
*                /****************************************************/
*                SVRECNUM = SVRECNUM + 1;                          1499
*                                                                  1499
@RC01496 LA    @15,1                                               1499
         SLR   @14,@14                                             1499
         IC    @14,SVRECNUM                                        1499
         ALR   @15,@14                                             1499
         STC   @15,SVRECNUM                                        1499
*                /****************************************************/
*                /* IF  END OF FILE RECORD THEN ADJUST NUMBER OF     */
*                /* BYTES IN TRACK                                   */
*                /****************************************************/
*                IF RB0CDL= ZERO                                   1500
*                  THEN                                            1500
         L     @15,@PC00001+8                                      1500
         L     @01,REPODSAR(,@15)                                  1500
         L     @01,RDDARE(,@01)                                    1500
         LH    @15,RB0CDL(,@01)                                    1500
         N     @15,@CF02153                                        1500
         LTR   @15,@15                                             1500
         BNZ   @RF01500                                            1500
*                    SIGMA = SIGMA + 1;                            1501
         LA    @15,1                                               1501
         AL    @15,SIGMA                                           1501
         ST    @15,SIGMA                                           1501
*                  ELSE;                                           1502
*                                                                  1502
@RF01500 DS    0H                                                  1503
*                /****************************************************/
*                /*   END OF DO FOR RECORD FOUND                     */
*                /****************************************************/
*                END;                                              1503
*                                                                  1503
*            /********************************************************/
*            /*  END OF DO FOR NOT END OF TRACK ELSE                 */
*            /********************************************************/
*            END;                                                  1504
*                                                                  1504
@RT01475 DS    0H                                                  1505
*        /************************************************************/
*        /*  END OF DO I6 LOOP                                       */
*        /************************************************************/
*        END;                                                      1505
*                                                                  1505
@RC01472 LA    @15,1                                               1505
         LH    @14,I6                                              1505
         N     @14,@CF02153                                        1505
         ALR   @15,@14                                             1505
@DE01465 STH   @15,I6                                              1505
         C     @15,@CF00689                                        1505
         BNH   @DL01465                                            1505
*        /************************************************************/
*        /*   OUT OF LOOP - ADD SIGMA TO SAVED VALUE OF SIGMA        */
*        /*   TO CALCULATE THE NUMBER OF BYTES ON THE TRACK          */
*        /*   AND ADJUST FOR OVERHEAD FOR DEVICE                     */
*        /*                                                          */
*        /************************************************************/
*        SIGMA = SIGMA + SUMKEY*KYCNST + SUMNOKEY*NOKYCNST + SAVSIG;
*                                                                  1506
         LH    @01,KYCNST                                          1506
         N     @01,@CF02153                                        1506
         LH    @15,SUMKEY                                          1506
         N     @15,@CF02153                                        1506
         MR    @00,@15                                             1506
         AL    @01,SIGMA                                           1506
         SLR   @00,@00                                             1506
         IC    @00,NOKYCNST                                        1506
         MH    @00,SUMNOKEY                                        1506
         ALR   @01,@00                                             1506
         LH    @00,SAVSIG                                          1506
         N     @00,@CF02153                                        1506
         ALR   @01,@00                                             1506
         ST    @01,SIGMA                                           1506
*        /************************************************************/
*        /*   CHECK IF NEW TRACK WILL FIT ON DEVICE                  */
*        /************************************************************/
*        IF SIGMA > DEVTC                                          1507
*          THEN                                                    1507
         L     @15,@PC00001+8                                      1507
         L     @01,REPODEVA(,@15)                                  1507
         LH    @15,DEVTC(,@01)                                     1507
         N     @15,@CF02153                                        1507
         C     @15,SIGMA                                           1507
         BNL   @RF01507                                            1507
*            DO;                                                   1508
*                                                                  1508
*            /********************************************************/
*            /* NO-INPUT TOO LONG                                    */
*            /* ISSUE MESSAGE AS TO WHICH TYPE OF INPUT WAS          */
*            /* IN ERROR AND RETURN CODE 12                          */
*            /*                                                      */
*            /********************************************************/
*            IF STRINGSW = YESS                                    1509
*              THEN                                                1509
*                                                                  1509
         CLI   STRINGSW,1                                          1509
         BNE   @RF01509                                            1509
*                /****************************************************/
*                /* INPUT STRING TOO LARGE.  ISSUE MSG IDC31232I     */
*                /* RETURN WITH RC =12                               */
*                /****************************************************/
*                                                                  1510
*                 DO;                                              1510
*                   CKREQ = CKREQ && CKREQ;                        1511
         L     @15,@PC00001+8                                      1511
         XC    CKREQ(44,@15),CKREQ(@15)                            1511
*                   CKRERN = MSG32;                                1512
         L     @15,@PC00001+8                                      1512
         MVC   CKRERN(2,@15),@CH00223                              1512
*                   CKRMVAR(1) = ADDR(DSNMSG);                     1513
         L     @15,@PC00001+8                                      1513
         LA    @14,DSNMSG                                          1513
         ST    @14,CKRMVAR(,@15)                                   1513
*                   CALL IDCRDER;                                  1514
         L     @15,@CV01811                                        1514
         BALR  @14,@15                                             1514
*                 END;                                             1515
*              ELSE                                                1516
*                                                                  1516
*                /****************************************************/
*                /* REPLACING RECORD TOO LARGE. ISSUE MSG IDC31231I  */
*                /* RETURN WITH RC = 12                              */
*                /****************************************************/
*                                                                  1516
*                 DO;                                              1516
         B     @RC01509                                            1516
@RF01509 DS    0H                                                  1517
*                   CKREQ = CKREQ && CKREQ;                        1517
         L     @15,@PC00001+8                                      1517
         XC    CKREQ(44,@15),CKREQ(@15)                            1517
*                   CKRERN = MSG31;                                1518
         L     @15,@PC00001+8                                      1518
         MVC   CKRERN(2,@15),@CH00046                              1518
*                   CKRMVAR(1) = ADDR(DSNMSG);                     1519
         L     @15,@PC00001+8                                      1519
         LA    @14,DSNMSG                                          1519
         ST    @14,CKRMVAR(,@15)                                   1519
*                   CALL IDCRDER;                                  1520
         L     @15,@CV01811                                        1520
         BALR  @14,@15                                             1520
*                 END;                                             1521
*                                                                  1521
*            RETURN CODE(LASTCC12);                                1522
@RC01509 LA    @15,12                                              1522
         L     @14,@SA00005                                        1522
         LM    @00,@12,@SA00005+8                                  1522
         BR    @14                                                 1522
*            END;                                                  1523
*                                                                  1523
*          ELSE;                                                   1524
*                                                                  1524
@RF01507 DS    0H                                                  1525
*        /************************************************************/
*        /*  THE MODIFIED RECORD WILL FIT IN THE TRACK               */
*        /************************************************************/
*        RDCHR = RB3CCHR;                                          1525
         L     @15,@PC00001+8                                      1525
         L     @01,REPODSAR(,@15)                                  1525
         L     @15,BFPTRIN                                         1525
         MVC   RDCHR(5,@01),RB3CCHR(@15)                           1525
*        RDDS = ZERO;                                              1526
*                                                                  1526
         L     @15,@PC00001+8                                      1526
         L     @01,REPODSAR(,@15)                                  1526
         MVI   RDDS(@01),X'00'                                     1526
*        /************************************************************/
*        /*   DETERMINE IF INPUT RECORD IS TO BE OVERFLOW RECORD     */
*        /*                                                          */
*        /************************************************************/
*        IF OVFLSW  = YESS                                         1527
*          THEN                                                    1527
         CLI   OVFLSW,1                                            1527
         BNE   @RF01527                                            1527
*            RDFUNC = RITEOVFL;                                    1528
         L     @15,@PC00001+8                                      1528
         L     @01,REPODSAR(,@15)                                  1528
         MVI   RDFUNC(@01),X'02'                                   1528
*          ELSE                                                    1529
*            RDFUNC = 1;                                           1529
         B     @RC01527                                            1529
@RF01527 L     @15,@PC00001+8                                      1529
         L     @01,REPODSAR(,@15)                                  1529
         MVI   RDFUNC(@01),X'01'                                   1529
*        RDCTLBK = REPODSOP;                                       1530
@RC01527 L     @15,@PC00001+8                                      1530
         L     @01,REPODSAR(,@15)                                  1530
         L     @15,@PC00001+8                                      1530
         L     @00,REPODSOP(,@15)                                  1530
         ST    @00,RDCTLBK(,@01)                                   1530
*        RDIOAREA = BFPTRIN;                                       1531
         L     @15,@PC00001+8                                      1531
         L     @01,REPODSAR(,@15)                                  1531
         L     @00,BFPTRIN                                         1531
         ST    @00,RDIOAREA(,@01)                                  1531
*        RB1NUM = 1;                                               1532
*                                                                  1532
         L     @01,BFPTROUT                                        1532
         MVC   RB1NUM(4,@01),@CF00221                              1532
*        /************************************************************/
*        /*   CALL FWRITE TO DO A FORMAT WRITE OF ONE RECORD FOR     */
*        /*   THE INPUT BUFFER                                       */
*        /************************************************************/
*        CALL IDCIO050(GDTTBL,FWRITE,RDARG);                       1533
*                                                                  1533
         L     @15,@PC00001                                        1533
         ST    @15,@AL00001                                        1533
         LA    @15,FWRITE                                          1533
         ST    @15,@AL00001+4                                      1533
         L     @15,@PC00001+8                                      1533
         L     @01,REPODSAR(,@15)                                  1533
         ST    @01,@AL00001+8                                      1533
         MVI   @AL00001+8,X'80'                                    1533
         L     @14,@PC00001                                        1533
         L     @15,GDTEXP(,@14)                                    1533
         LA    @01,@AL00001                                        1533
         BALR  @14,@15                                             1533
*        RESPECIFY RTNREG RSTD;                                    1534
*        TESTRC = RTNREG;                                          1535
         STH   RTNREG,TESTRC                                       1535
*        RESPECIFY RTNREG UNRSTD;                                  1536
*        IF TESTRC ^= 0                                            1537
*          THEN                                                    1537
         LH    @15,TESTRC                                          1537
         LTR   @15,@15                                             1537
         BZ    @RF01537                                            1537
*            DO;                                                   1538
*                                                                  1538
*            /********************************************************/
*            /*                                                      */
*            /* WRITE MSG IDC31245I - I/O ERROR WHILE MODIFYING TRACK*/
*            /*                                                      */
*            /********************************************************/
*                                                                  1539
*             DO;                                                  1539
*               CKREQ = CKREQ && CKREQ;                            1540
         L     @15,@PC00001+8                                      1540
         XC    CKREQ(44,@15),CKREQ(@15)                            1540
*               CKRERN = MSG45;                                    1541
         L     @15,@PC00001+8                                      1541
         MVC   CKRERN(2,@15),@CH00767                              1541
*               CKRMVAR(1) = ADDR(RDCHR);                          1542
         L     @15,@PC00001+8                                      1542
         L     @14,@PC00001+8                                      1542
         L     @01,REPODSAR(,@14)                                  1542
         LA    @14,RDCHR(,@01)                                     1542
         ST    @14,CKRMVAR(,@15)                                   1542
*               CKRMVAR(2) = ADDR(DSNMSG);                         1543
         L     @15,@PC00001+8                                      1543
         LA    @14,DSNMSG                                          1543
         ST    @14,CKRMVAR+4(,@15)                                 1543
*               CALL IDCRDER;                                      1544
         L     @15,@CV01811                                        1544
         BALR  @14,@15                                             1544
*             END;                                                 1545
*            RETURN CODE(LASTCC12);                                1546
         LA    @15,12                                              1546
         L     @14,@SA00005                                        1546
         LM    @00,@12,@SA00005+8                                  1546
         BR    @14                                                 1546
*            END;                                                  1547
*                                                                  1547
*        /************************************************************/
*        /*   CALCULATE THE NUMBER OF RECORDS LEFT TO WRITE ON       */
*        /*     THE TRACK                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1548
*        IF SVRECNUM  = ZERO                                       1548
*          THEN;                                                   1548
@RF01537 CLI   SVRECNUM,0                                          1548
         BE    @RT01548                                            1548
*          ELSE                                                    1550
*            DO;                                                   1550
*                                                                  1550
*            /********************************************************/
*            /* RESET ADDRESSABILITY TO THE SAVED ADDRESS OF THE     */
*            /* FIRST RECORD READ AFTER THE INPUT RECORD MINUS       */
*            /* THE FULL WORD AREA USED FOR THE NUMBER OF RECORDS    */
*            /* TO WRITE                                             */
*            /********************************************************/
*            RESPECIFY  RB1     BASED (SVDTADDR-CNST04);           1551
*                                                                  1551
*            /********************************************************/
*            /*   SET THE NUMBER OF RECORDS TO WRITE TO THE LAST     */
*            /*   RECORD READ MINUS THE INPUT RECORD NUMBER.         */
*            /*   WATCH OUT FOR MISSING RECORD NUMBERS               */
*            /*   AND BUILD RDARG AREA                               */
*            /********************************************************/
*            RB1NUM=SVRECNUM;                                      1552
         SLR   @15,@15                                             1552
         IC    @15,SVRECNUM                                        1552
         L     @14,SVDTADDR                                        1552
         AL    @14,@CF02168                                        1552
         ST    @15,RB1NUM(,@14)                                    1552
*            RDIOAREA = SVDTADDR - LENGTH(RB1NUM);                 1553
         L     @15,@PC00001+8                                      1553
         L     @01,REPODSAR(,@15)                                  1553
         L     @00,SVDTADDR                                        1553
         SL    @00,@CF00044                                        1553
         ST    @00,RDIOAREA(,@01)                                  1553
*            RDCHR = RB1CCHR;                                      1554
         L     @15,@PC00001+8                                      1554
         L     @01,REPODSAR(,@15)                                  1554
         L     @15,SVDTADDR                                        1554
         MVC   RDCHR(5,@01),RB1CCHR-4(@15)                         1554
*            RDDS = ZERO;                                          1555
*                                                                  1555
         L     @15,@PC00001+8                                      1555
         L     @01,REPODSAR(,@15)                                  1555
         MVI   RDDS(@01),X'00'                                     1555
*            /********************************************************/
*            /* SET TO WRITE SPECIAL ON THE LAST RECORD IF NEEDED    */
*            /********************************************************/
*            IF LASTOVFL = YESS                                    1556
*              THEN                                                1556
         CLI   LASTOVFL,1                                          1556
         BNE   @RF01556                                            1556
*                RDFUNC = RITEOVFL;                                1557
         L     @15,@PC00001+8                                      1557
         L     @01,REPODSAR(,@15)                                  1557
         MVI   RDFUNC(@01),X'02'                                   1557
*              ELSE                                                1558
*                RDFUNC = 1;                                       1558
*                                                                  1558
         B     @RC01556                                            1558
@RF01556 L     @15,@PC00001+8                                      1558
         L     @01,REPODSAR(,@15)                                  1558
         MVI   RDFUNC(@01),X'01'                                   1558
*            /********************************************************/
*            /* CALL FWRITE TO FORMAT WRITE THE REST OF THE TRACK    */
*            /********************************************************/
*            CALL IDCIO050(GDTTBL,FWRITE,RDARG);                   1559
@RC01556 L     @15,@PC00001                                        1559
         ST    @15,@AL00001                                        1559
         LA    @15,FWRITE                                          1559
         ST    @15,@AL00001+4                                      1559
         L     @15,@PC00001+8                                      1559
         L     @01,REPODSAR(,@15)                                  1559
         ST    @01,@AL00001+8                                      1559
         MVI   @AL00001+8,X'80'                                    1559
         L     @14,@PC00001                                        1559
         L     @15,GDTEXP(,@14)                                    1559
         LA    @01,@AL00001                                        1559
         BALR  @14,@15                                             1559
*            RESPECIFY RTNREG RSTD;                                1560
*            TESTRC = RTNREG;                                      1561
         STH   RTNREG,TESTRC                                       1561
*            RESPECIFY RTNREG UNRSTD;                              1562
*            IF TESTRC ^= 0                                        1563
*              THEN                                                1563
         LH    @15,TESTRC                                          1563
         LTR   @15,@15                                             1563
         BZ    @RF01563                                            1563
*                DO;                                               1564
*                                                                  1564
*                /****************************************************/
*                /*                                                  */
*                /* WRITE MSG IDC31245I - I/O ERROR WHILE MODIFYING  */
*                /* TRACK                                            */
*                /*                                                  */
*                /****************************************************/
*                                                                  1565
*                 DO;                                              1565
*                   CKREQ = CKREQ && CKREQ;                        1566
         L     @15,@PC00001+8                                      1566
         XC    CKREQ(44,@15),CKREQ(@15)                            1566
*                   CKRERN = MSG45;                                1567
         L     @15,@PC00001+8                                      1567
         MVC   CKRERN(2,@15),@CH00767                              1567
*                   CKRMVAR(1) = ADDR(RDCHR);                      1568
         L     @15,@PC00001+8                                      1568
         L     @14,@PC00001+8                                      1568
         L     @01,REPODSAR(,@14)                                  1568
         LA    @14,RDCHR(,@01)                                     1568
         ST    @14,CKRMVAR(,@15)                                   1568
*                   CKRMVAR(2) = ADDR(DSNMSG);                     1569
         L     @15,@PC00001+8                                      1569
         LA    @14,DSNMSG                                          1569
         ST    @14,CKRMVAR+4(,@15)                                 1569
*                   CALL IDCRDER;                                  1570
         L     @15,@CV01811                                        1570
         BALR  @14,@15                                             1570
*                 END;                                             1571
*                RETURN CODE(LASTCC12);                            1572
         LA    @15,12                                              1572
         L     @14,@SA00005                                        1572
         LM    @00,@12,@SA00005+8                                  1572
         BR    @14                                                 1572
*                END;                                              1573
*                                                                  1573
*            /********************************************************/
*            /* END OF MORE RECORDS TO REWRITE ELSE                  */
*            /********************************************************/
*            END;                                                  1574
*                                                                  1574
@RF01563 DS    0H                                                  1575
*        RETURN CODE(LASTCC00);                                    1575
@RT01548 SLR   @15,@15                                             1575
         L     @14,@SA00005                                        1575
         LM    @00,@12,@SA00005+8                                  1575
         BR    @14                                                 1575
*END MODDSOUT;                                                     1576
*MODCLFP:   PROCEDURE;                                             1577
MODCLFP  STM   @14,@12,@SA00006                                    1577
*        /************************************************************/
*        /*                                                          */
*        /* SUBROUTINE NAME - MODCLFP                                */
*        /*                                                          */
*        /* FUNCTION -                                               */
*        /*                                                          */
*        /* THIS PROCEDURE WILL CLOSE FILES, FREE POOL AND WILL      */
*        /*   DEQUEUE ENQUEUED VTOC OR VTOCHEADER                    */
*        /*                                                          */
*        /* NOTES -                                                  */
*        /*                                                          */
*        /*    DEPENDENCIES - NONE                                   */
*        /*                                                          */
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */
*        /*                   AND IDCRD06 RESPECTIVELY               */
*        /*                                                          */
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */
*        /*                                                          */
*        /*    PATCH LABEL - 'UPATCHIT'                              */
*        /*                                                          */
*        /* ENTRY POINT - MODCLFP (ONLY ENTRY POINT)                 */
*        /*                                                          */
*        /*    LINKAGE - 'CALL MODCLFP'                              */
*        /*                                                          */
*        /*    INPUT -                                               */
*        /*                                                          */
*        /*      REPIRWIO - IOCSTR POINTER FOR INPUT REPAIRWORKFILE*/
*        /*      REPORWIO - IOCSTR POINTER FOR OUTPUT REPAIR WORKFILE*/
*        /*      SAVCLIN  - IOCTLBK POINTER FOR INPUT DATA SET       */
*        /*      SAVCLOUT - IOCTLBK POINTER FOR OUTPUT DATA SET      */
*        /*      REPQRPTR - QNAME AND RNAME POINTER                  */
*        /*      DATSPA   - DATA SET INPUT INDICATOR                 */
*        /*                                                          */
*        /*    OUTPUT -                                              */
*        /*      NONE                                                */
*        /*                                                          */
*        /*    EXIT, NORMAL -                                        */
*        /*                                                          */
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */
*        /*                                                          */
*        /*    PROCEDURES/SUBROUTINES CALLED                         */
*        /*      NONE                                                */
*        /*                                                          */
*        /* EXTERNAL REFERENCES -                                    */
*        /*    MACROS/SVCS -                                         */
*        /*                                                          */
*        /*    UCLOSE - IDCAMS I/O ADAPTER CLOSE ROUTINE             */
*        /*      CLOSES THE REPAIR WORKFILE                          */
*        /*      GENERATES A CALL TO MODULE IDCIOCL                  */
*        /*                                                          */
*        /*    UFPOOL - IDCAMS SYSTEM ADAPTER FREE POOL ROUTINE      */
*        /*      RELEASES DYNAMIC STORAGE ACQUIRED FOR I/O BUFFERS   */
*        /*      GENERATES A CALL TO MODULE IDCSAFP                  */
*        /*                                                          */
*        /*    UDEQ   - IDCAMS SYSTEM ADAPTER DEQUEUE ROUTINE        */
*        /*      DEQUEUES VTOC OR VTOCHEADER THAT HAVE BEEN ENQUEUED */
*        /*      GENERATES A CALL TO MODULE IDCSADQ                  */
*        /*                                                          */
*        /*    UEXCP  - IDCAMS I/O ADAPTER EXCP ROUTINE              */
*        /*      TO CLOSE DATA SET OR VTOCHEADER                     */
*        /*      GENERATES A CALL TO MODULE IDCSADQO                 */
*        /*                                                          */
*        /*                                                          */
*        /* PROCEDURES/SUBROUTINES CALLED                            */
*        /*   NONE                                                   */
*        /************************************************************/
*                                                                  1578
*        /************************************************************/
*        /* IF INPUT REPAIR WORKFILE PRESENT, CLOSE IT               */
*        /************************************************************/
*        IF REPIRWIO ^= NULLPTR                                    1578
*          THEN                                                    1578
         L     @15,@PC00001+8                                      1578
         L     @15,REPIRWIO(,@15)                                  1578
         LTR   @15,@15                                             1578
         BZ    @RF01578                                            1578
*            CALL IDCIOCL0(GDTTBL,REPIRWIO);                       1579
         L     @15,@PC00001                                        1579
         ST    @15,@AL00001                                        1579
         L     @15,@PC00001+8                                      1579
         LA    @15,REPIRWIO(,@15)                                  1579
         ST    @15,@AL00001+4                                      1579
         MVI   @AL00001+4,X'80'                                    1579
         L     @14,@PC00001                                        1579
         L     @15,GDTCLS(,@14)                                    1579
         LA    @01,@AL00001                                        1579
         BALR  @14,@15                                             1579
*          ELSE;                                                   1580
*                                                                  1580
@RF01578 DS    0H                                                  1581
*        /************************************************************/
*        /* IF OUTPUT REPAIR WORKFILE PRESENT, CLOSE IT              */
*        /************************************************************/
*        IF REPORWIO ^= NULLPTR                                    1581
*          THEN                                                    1581
         L     @15,@PC00001+8                                      1581
         L     @15,REPORWIO(,@15)                                  1581
         LTR   @15,@15                                             1581
         BZ    @RF01581                                            1581
*            CALL IDCIOCL0(GDTTBL,REPORWIO);                       1582
         L     @15,@PC00001                                        1582
         ST    @15,@AL00001                                        1582
         L     @15,@PC00001+8                                      1582
         LA    @15,REPORWIO(,@15)                                  1582
         ST    @15,@AL00001+4                                      1582
         MVI   @AL00001+4,X'80'                                    1582
         L     @14,@PC00001                                        1582
         L     @15,GDTCLS(,@14)                                    1582
         LA    @01,@AL00001                                        1582
         BALR  @14,@15                                             1582
*          ELSE;                                                   1583
*                                                                  1583
@RF01581 DS    0H                                                  1584
*        /************************************************************/
*        /* IF INPUT DATASET IS PRESENT, CLOSE IT                    */
*        /************************************************************/
*        IF SAVCLIN ^= NULLPTR                                     1584
*          THEN                                                    1584
         L     @15,SAVCLIN                                         1584
         LTR   @15,@15                                             1584
         BZ    @RF01584                                            1584
*            CALL IDCIO050(GDTTBL,CLOSE,SAVCLIN);                  1585
         L     @15,@PC00001                                        1585
         ST    @15,@AL00001                                        1585
         LA    @15,CLOSE                                           1585
         ST    @15,@AL00001+4                                      1585
         LA    @15,SAVCLIN                                         1585
         ST    @15,@AL00001+8                                      1585
         MVI   @AL00001+8,X'80'                                    1585
         L     @14,@PC00001                                        1585
         L     @15,GDTEXP(,@14)                                    1585
         LA    @01,@AL00001                                        1585
         BALR  @14,@15                                             1585
*          ELSE;                                                   1586
*                                                                  1586
@RF01584 DS    0H                                                  1587
*        /************************************************************/
*        /* IF OUTPUT DATA SET OR VTOCHEADER PRESENT, CLOSE IT       */
*        /************************************************************/
*        IF SAVCLOUT ^= NULLPTR                                    1587
*          THEN                                                    1587
         L     @15,SAVCLOUT                                        1587
         LTR   @15,@15                                             1587
         BZ    @RF01587                                            1587
*            CALL IDCIO050(GDTTBL,CLOSE,SAVCLOUT);                 1588
         L     @15,@PC00001                                        1588
         ST    @15,@AL00001                                        1588
         LA    @15,CLOSE                                           1588
         ST    @15,@AL00001+4                                      1588
         LA    @15,SAVCLOUT                                        1588
         ST    @15,@AL00001+8                                      1588
         MVI   @AL00001+8,X'80'                                    1588
         L     @14,@PC00001                                        1588
         L     @15,GDTEXP(,@14)                                    1588
         LA    @01,@AL00001                                        1588
         BALR  @14,@15                                             1588
*          ELSE;                                                   1589
*                                                                  1589
@RF01587 DS    0H                                                  1590
*            /********************************************************/
*            /* IF VTOC OR VTOCHEADER ENQUEUED, DEQUEUED IT          */
*            /********************************************************/
*        IF REPENQSW ^= ZERO                                       1590
*          THEN                                                    1590
         L     @15,@PC00001+8                                      1590
         CLI   REPENQSW(@15),0                                     1590
         BE    @RF01590                                            1590
*            CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);                1591
         L     @15,@PC00001                                        1591
         ST    @15,@AL00001                                        1591
         L     @15,@PC00001+8                                      1591
         L     @01,REPQRPTR(,@15)                                  1591
         ST    @01,@AL00001+4                                      1591
         L     @15,@PC00001+8                                      1591
         L     @01,REPQRPTR(,@15)                                  1591
         LA    @15,SPRNAME(,@01)                                   1591
         ST    @15,@AL00001+8                                      1591
         MVI   @AL00001+8,X'80'                                    1591
         L     @14,@PC00001                                        1591
         L     @15,GDTDEQ(,@14)                                    1591
         LA    @01,@AL00001                                        1591
         BALR  @14,@15                                             1591
*          ELSE;                                                   1592
@RF01590 DS    0H                                                  1593
*        IF SAVCLOUT ^= ZERO  SAVCLIN ^= ZERO  DATSPA = YESS     1593
*          THEN                                                    1593
         L     @15,SAVCLOUT                                        1593
         LTR   @15,@15                                             1593
         BNZ   @RT01593                                            1593
         L     @15,SAVCLIN                                         1593
         LTR   @15,@15                                             1593
         BNZ   @RT01593                                            1593
         CLI   DATSPA,1                                            1593
         BNE   @RF01593                                            1593
@RT01593 DS    0H                                                  1594
*            CALL IDCSAFP0(GDTTBL,RD01,ALL);                       1594
         MVC   @AL00001+4(8),@AL01594                              1594
         L     @15,@PC00001                                        1594
         ST    @15,@AL00001                                        1594
         L     @14,@PC00001                                        1594
         L     @15,GDTFPL(,@14)                                    1594
         LA    @01,@AL00001                                        1594
         BALR  @14,@15                                             1594
*          ELSE;                                                   1595
*                                                                  1595
@RF01593 DS    0H                                                  1596
*        /************************************************************/
*        /*                                                          */
*        /*CLEAR DATA SETS AND REPAIR WORKFILE CONTROL BLOCK POINTERS*/
*        /*CLEAR THE DATSPA INDICATOR                                */
*        /*                                                          */
*        /************************************************************/
*        SAVCLIN = NULLPTR;                                        1596
         SLR   @15,@15                                             1596
         ST    @15,SAVCLIN                                         1596
*        SAVCLOUT = NULLPTR;                                       1597
         SLR   @15,@15                                             1597
         ST    @15,SAVCLOUT                                        1597
*        REPIRWIO = NULLPTR;                                       1598
         L     @15,@PC00001+8                                      1598
         SLR   @14,@14                                             1598
         ST    @14,REPIRWIO(,@15)                                  1598
*        REPORWIO = NULLPTR;                                       1599
         L     @15,@PC00001+8                                      1599
         SLR   @14,@14                                             1599
         ST    @14,REPORWIO(,@15)                                  1599
*        REPENQSW = ZERO;                                          1600
         L     @15,@PC00001+8                                      1600
         MVI   REPENQSW(@15),X'00'                                 1600
*        DATSPA = NOT;                                             1601
         MVI   DATSPA,X'00'                                        1601
*        RETURN CODE(LASTCC00);                                    1602
         SLR   @15,@15                                             1602
         L     @14,@SA00006                                        1602
         LM    @00,@12,@SA00006+8                                  1602
         BR    @14                                                 1602
*END MODCLFP;                                                      1603
*END IDCRD050;                                                     1604
*END IDCRD05                                                       1605
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRD )                                        *
*/*%INCLUDE SYSLIB  (IDCDF04 )                                        *
*/*%INCLUDE SYSLIB  (IDCDF66 )                                        *
*/*%INCLUDE SYSLIB  (IDCDF65 )                                        *
*;                                                                 1605
@DATA    DS    0H
@CH00612 DC    H'13'
@CH00663 DC    H'22'
@CH00667 DC    H'23'
@CH00681 DC    H'25'
@CH00685 DC    H'26'
@CH01944 DC    H'27'
@CH00690 DC    H'28'
@CH00698 DC    H'30'
@CH00046 DC    H'31'
@CH00223 DC    H'32'
@CH01990 DC    H'33'
@CH00736 DC    H'41'
@CH00742 DC    H'42'
@CH00753 DC    H'43'
@CH00767 DC    H'45'
@CH02146 DC    H'78'
@CH00865 DC    H'92'
@CH02101 DC    H'-1'
@SM02156 MVC   RWF2KD(0,@01),RB2KD(@15)
@SM02158 MVC   RWF2KD-1(0,@15),MNKSTVAL(@01)
@SM02160 MVC   RWF2KD-1(0,@01),MNDSTVAL(@04)
@SM02162 MVC   RB3KD(0,@01),RB1KD(@15)
@SM02164 MVC   RB3KD-1(0,@15),MNKSTVAL(@01)
@SM02166 MVC   RB3KD-1(0,@01),MNDSTVAL(@15)
         DS    0F
@AL00590 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00510 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00951 DC    A(IN)                   LIST WITH   1 ARGUMENT(S)
         DC    A(ZEROS)
@AL00728 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00643 DC    A(OUT)                  LIST WITH   1 ARGUMENT(S)
         DC    A(ZEROS)
@AL01594 DC    A(RD01)                 LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00004 DS    15F
@SA00006 DS    15F
@SA00003 DS    15F
@SA00005 DS    15F
@AL00001 DS    5A
IDCRD05  CSECT
         DS    0F
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00044 DC    F'4'
@CH00044 EQU   @CF00044+2
@CF00288 DC    F'5'
@CF00181 DC    F'8'
@CH00181 EQU   @CF00181+2
@CF00230 DC    F'15'
@CF00475 DC    F'16'
@CH00475 EQU   @CF00475+2
@CF00652 DC    F'21'
@CH00652 EQU   @CF00652+2
@CF00312 DC    F'24'
@CH00312 EQU   @CF00312+2
@CF00694 DC    F'29'
@CH00694 EQU   @CF00694+2
@CF00689 DC    F'110'
@CH00689 EQU   @CF00689+2
@CF00987 DC    F'255'
@CF02147 DC    F'-16'
@CF02135 DC    F'-12'
@CF02168 DC    F'-4'
@CF02153 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
INFTC    DS    F
SIGMA    DS    F
TARPTR   DS    A
SOURPTR  DS    A
BFPTROUT DS    A
BFPTRIN  DS    A
SAVCLOUT DS    A
SAVCLIN  DS    A
RWFPTR1  DS    A
TEMPB1PT DS    A
TEMPB3PT DS    A
SVDTADDR DS    A
LISTPTR  DS    A
TESTRC   DS    H
LASTCC   DS    H
NEWLN    DS    H
ILOOP    DS    H
SAVNURE  DS    H
SAVSIG   DS    H
I6       DS    H
SUMKEY   DS    H
SUMNOKEY DS    H
XIND     DS    H
EXP      DS    H
MOVLEN   DS    H
SETRC    DS    H
NOKYCNST DS    FL1
SVRECNUM DS    FL1
OVFLSW   DS    FL1
LASTOVFL DS    FL1
PREVREC  DS    FL1
DATSPA   DS    FL1
STRINGSW DS    FL1
FWSW     DS    FL1
DOUT     DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
KEYRWF   DS    CL11
         ORG   KEYRWF
KEYRWFVS DS    CL6
KEYRWCHR DS    CL5
         ORG   KEYRWCHR
KEYRWFCH DS    CL4
KEYRWFR  DS    CL1
         ORG   KEYRWF+11
MOKAD    DS    CL11
         ORG   MOKAD
MOKAD6   DS    CL6
MOKAD5   DS    CL5
         ORG   MOKAD5
MOKAD5C  DS    CL2
MOKAD5H  DS    CL2
MOKAD5R  DS    CL1
         ORG   MOKAD+11
PARNA    DS    CL17
DSNMSG   DS    CL44
MIKAD    DS    CL11
         ORG   MIKAD
MIKAD6   DS    CL6
MIKAD5   DS    CL5
         ORG   MIKAD5
MIKAD54  DS    CL4
         ORG   MIKAD54
MIKAD54C DS    CL2
MIKAD54H DS    CL2
         ORG   MIKAD5+4
MIKAD54R DS    CL1
         ORG   MIKAD+11
         DS    CL1
SMIKAD5  DS    CL5
         ORG   SMIKAD5
SMICC    DS    FL2
SMIHH    DS    FL2
SMIR     DS    FL1
         ORG   SMIKAD5+5
         DS    CL1
SMOKAD5  DS    CL5
         ORG   SMOKAD5
SMOCC    DS    FL2
SMOHH    DS    FL2
SMOR     DS    FL1
         ORG   SMOKAD5+5
         DS    CL1
KYCNSTCH DS    CL2
         ORG   KYCNSTCH
KYCNST   DS    FL2
         ORG   KYCNSTCH+2
SAVCHR   DS    CL5
         ORG   SAVCHR
@NM00142 DS    CL2
@NM00143 DS    CL2
SAVCHR1  DS    FL1
         ORG   SAVCHR+5
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRD05  CSECT
         NOPR  ((@ENDDATD-@DATD)/1025*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01810 DC    V(IDCRDDS)
@CV01811 DC    V(IDCRDER)
@CV01812 DC    V(IDCRDRD)
@CV01813 DC    V(IDCRDRF)
@CV01814 DC    V(IDCRDIO)
         DS    0D
IGNORE   DC    XL1'F0'
@CC02060 DC    C'RD50'
@CC02061 DC    C'RD51'
@CC02086 DC    C'RD52'
@CC02087 DC    C'RD53'
@CC02093 DC    C'RD58'
@CC02094 DC    C'RD59'
@CC02105 DC    C'RD5A'
@CC02106 DC    C'RD5B'
@CC02110 DC    C'RD55'
@CC02111 DC    C'RD54'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
OPENR    DC    CL8'OPENR   '
OUT      DC    CL1'O'
IN       DC    CL1'I'
RD01     DC    CL4'RD01'
VTOCHDRK DC    CL17'VTOCHEADERADDRESS'
OUTDSAK  DC    CL17'OUTDATASETADDRESS'
INRRCON  DC    CL17'INREPAIRRANGE    '
VTOCNAME DC    CL10'VTOCHEADER'
LASTEXT  DC    X'FFFFFFFFFF'
FWRITE   DC    CL8'FWRITE'
WRITEREC DC    CL8'WRITEREC'
MODID    DC    CL4'RD05'
PRECED   DC    CL13'PRECEDING    '
SUBSEQ   DC    CL13'SUBSEQUENT TO'
VTOCDSN  DS    CL44
         ORG   VTOCDSN
@NM00137 DC    44X'04'
         ORG   VTOCDSN+44
FMT4DSN  DS    CL44
         ORG   FMT4DSN
@NM00138 DC    CL12'FORMAT4.DSCB'
@NM00139 DC    32X'40'
         ORG   FMT4DSN+44
ZEROS    DS    CL8
         ORG   ZEROS
@NM00140 DC    8X'00'
         ORG   ZEROS+8
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG7     EQU   @07
REG8     EQU   @08
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG6     EQU   @06
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSADQ0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCTRN   EQU   IOCSTR+8
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
INFIL    EQU   0
INDS     EQU   0
INDSFLG  EQU   INDS+10
DOUTF    EQU   0
DOTDS    EQU   0
DOTDSFLG EQU   DOTDS+10
VOLSR    EQU   0
VOLSRFLG EQU   VOLSR+10
DCCHR    EQU   0
DREC     EQU   0
VOLDS    EQU   0
VOLDSFLG EQU   VOLDS+10
DSCHR    EQU   0
DSCHH    EQU   0
VOLRR    EQU   0
VOLRRFLG EQU   VOLRR+10
RRCHR    EQU   0
RRCHH    EQU   0
DKEYL    EQU   0
DATAL    EQU   0
DVTCS    EQU   0
DVTCSFLG EQU   DVTCS+10
CINFL    EQU   0
CINDS    EQU   0
CINDSFLG EQU   CINDS+10
COFIL    EQU   0
CCATL    EQU   0
CCATLFLG EQU   CCATL+10
CVOLD    EQU   0
CVOLDFLG EQU   CVOLD+10
CDCHR    EQU   0
CDHHR    EQU   0
CVOLS    EQU   0
CVOLSFLG EQU   CVOLS+10
CCCHR    EQU   0
CRECR    EQU   0
CKEYL    EQU   0
CDATL    EQU   0
CVTCS    EQU   0
CVTCSFLG EQU   CVTCS+10
DBFIL    EQU   0
DBDS     EQU   0
DBDSFLG  EQU   DBDS+10
DBVOL    EQU   0
DBVOLFLG EQU   DBVOL+10
DBCCH    EQU   0
DBHHH    EQU   0
DBKEY    EQU   0
DBDAT    EQU   0
MNDAT    EQU   0
MNKEY    EQU   0
MNCNT    EQU   0
MNCNTLEN EQU   MNCNT
MNCNTVAL EQU   MNCNT+1
MINFL    EQU   0
MINDS    EQU   0
MINDSFLG EQU   MINDS+10
MIRK     EQU   0
MIDSA    EQU   0
MIRNG    EQU   0
MORK     EQU   0
MODSA    EQU   0
MOUTF    EQU   0
MODS     EQU   0
MODSFLG  EQU   MODS+10
MOVFL    EQU   0
MVTOC    EQU   0
MVTCS    EQU   0
MVTCSFLG EQU   MVTCS+10
MVTCSVAL EQU   MVTCS+21
MVTCR    EQU   0
MVTCRVAL EQU   MVTCR+1
MIRVO    EQU   0
MIRVOFLG EQU   MIRVO+10
MIRVOVAL EQU   MIRVO+21
MIRCH    EQU   0
MIRCHVAL EQU   MIRCH+1
MIDVO    EQU   0
MIDVOFLG EQU   MIDVO+10
MIDVOVAL EQU   MIDVO+21
MIDCH    EQU   0
MIDCHVAL EQU   MIDCH+1
MRRVO    EQU   0
MRRVOFLG EQU   MRRVO+10
MRRVOVAL EQU   MRRVO+21
MRRCH    EQU   0
MRRCHVAL EQU   MRRCH+1
MRRHH    EQU   0
MRRHHVAL EQU   MRRHH+1
MNDOF    EQU   0
MNDOFVAL EQU   MNDOF
MNDST    EQU   0
MNDSTLEN EQU   MNDST
MNDSTVAL EQU   MNDST+1
MNKOF    EQU   0
MNKOFVAL EQU   MNKOF
MNKST    EQU   0
MNKSTLEN EQU   MNKST
MNKSTVAL EQU   MNKST+1
MORVO    EQU   0
MORVOFLG EQU   MORVO+10
MORVOVAL EQU   MORVO+21
MORCH    EQU   0
MORCHVAL EQU   MORCH+1
MODVO    EQU   0
MODVOFLG EQU   MODVO+10
MODVOVAL EQU   MODVO+21
MODCH    EQU   0
MODCHVAL EQU   MODCH+1
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOEXT   EQU   EXOARG+24
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00072 EQU   SV82LIST+4
SV82DCBP EQU   @NM00072
@NM00073 EQU   SV82LIST+12
SV82WRKP EQU   @NM00073
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
LOCTAB   EQU   0
RIOAREA  EQU   0
RIOHDR   EQU   RIOAREA
RPREV    EQU   RIOHDR+2
RKEY     EQU   0
RKEYCHR  EQU   RKEY+6
RKEYFLG  EQU   RKEY+11
RBUF     EQU   0
RBUFCNT  EQU   RBUF
RBCCHHR  EQU   RBUFCNT
WIOAREA  EQU   0
WBUFF    EQU   WIOAREA+4
WBUF     EQU   0
WBUFCNT  EQU   WBUF
WBCCHHR  EQU   WBUFCNT
RWFHDR   EQU   0
SRPRTARG EQU   0
RWFINFO  EQU   0
RWFKEY1  EQU   RWFINFO+82
RWFKEY2  EQU   RWFINFO+93
RWHDRINF EQU   0
RDARG    EQU   0
RDCTLBK  EQU   RDARG+8
RDIOAREA EQU   RDARG+12
RDDARE   EQU   RDARG+16
RDLOCPTR EQU   RDARG+20
RDCHR    EQU   RDARG+26
RDDS     EQU   RDARG+31
RDSPACE  EQU   RDARG+36
RDFUNC   EQU   RDARG+46
RDSPKL   EQU   RDARG+47
INFOAREA EQU   0
INFODSN  EQU   0
INFOVOL  EQU   0
DEVAREA  EQU   0
DEVDEVTP EQU   DEVAREA
DEVTBYT2 EQU   DEVDEVTP+1
@NM00113 EQU   DEVAREA+8
DEVWORD3 EQU   DEVAREA+12
DEVTC    EQU   DEVWORD3
DEVBOH   EQU   DEVWORD3+2
DEVBOH1  EQU   DEVBOH
DEVWORD4 EQU   DEVAREA+16
DEVKC    EQU   DEVWORD4
DEV4B1   EQU   DEVWORD4+1
INF4FLG  EQU   DEV4B1
XTNTTBL2 EQU   0
XTN2ENT  EQU   XTNTTBL2
XTN2CHR1 EQU   XTN2ENT+44
XTN2CHR2 EQU   XTN2ENT+48
XTNTTBL  EQU   0
XTNTHDR  EQU   XTNTTBL
XTNHDSN  EQU   XTNTHDR+8
XTNHCHR1 EQU   XTNTHDR+68
XTNHCHR2 EQU   XTNTHDR+76
XTNTENT  EQU   XTNTTBL+88
XTNTCHR1 EQU   XTNTENT+62
XTNTCHR2 EQU   XTNTENT+70
SPLIST   EQU   0
SPQNAME  EQU   SPLIST
SPRNAME  EQU   SPLIST+8
RWFR     EQU   0
RWFRCNT  EQU   RWFR+16
RB0      EQU   0
RB0C     EQU   RB0
RB0CKL   EQU   RB0C+5
RB0CDL   EQU   RB0C+6
RB1      EQU   0
RB1NUM   EQU   RB1
RB1C     EQU   RB1+4
RB1CCHR  EQU   RB1C
RB1CKL   EQU   RB1C+5
RB1CDL   EQU   RB1C+6
RB1KD    EQU   RB1+12
RB2      EQU   0
RB2KEY   EQU   RB2
RB2FLG1  EQU   RB2+11
RB2FLG3  EQU   RB2+14
RB2C     EQU   RB2+16
RB2CHR   EQU   RB2C
RB2CHH   EQU   RB2CHR+2
RB2CKL   EQU   RB2C+5
RB2CDL   EQU   RB2C+6
RB2KD    EQU   RB2+24
RB3      EQU   0
RB3NUM   EQU   RB3
RB3C     EQU   RB3+4
RB3CCHR  EQU   RB3C
RB3CR    EQU   RB3CCHR+4
RB3CKL   EQU   RB3C+5
RB3CDL   EQU   RB3C+6
RB3KD    EQU   RB3+12
RWF1     EQU   0
RWF1KYFL EQU   RWF1
RWF1C    EQU   RWF1+16
RWF1CHR  EQU   RWF1C
RWF2     EQU   0
RWF2KYFL EQU   RWF2
RWF2KEY  EQU   RWF2KYFL
RWF2FLG1 EQU   RWF2KYFL+11
RWF2C    EQU   RWF2+16
RWF2CHR  EQU   RWF2C
RWF2CKL  EQU   RWF2C+5
RWF2CDL  EQU   RWF2C+6
RWF2KD   EQU   RWF2+24
RWFDANA  EQU   0
DSOUT    EQU   0
DSOUT4   EQU   DSOUT
ALLA     EQU   0
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CDATLPTR EQU   0
CDSRG    EQU   0
CHARA    EQU   0
CKEYLPTR EQU   0
CLEN     EQU   0
CLENCNT  EQU   0
COPY     EQU   0
CSRNG    EQU   0
CVTOC    EQU   0
DATALPTR EQU   0
DBDATPTR EQU   0
DBKEYPTR EQU   0
DBLOC    EQU   0
DBLST    EQU   0
DBLSTCNT EQU   0
DBRNG    EQU   0
DISPL    EQU   0
DKEYLPTR EQU   0
DLENG    EQU   0
DLENGCNT EQU   0
DMPTRM   EQU   0
DPVTC    EQU   0
DRRNG    EQU   0
DSRNG    EQU   0
DUMP     EQU   0
ERROR    EQU   0
FREC     EQU   0
FULLR    EQU   0
HEXA     EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
IDONL    EQU   0
LISTTEST EQU   0
MODIF    EQU   0
NEWERID1 EQU   5
STAGR    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
REPTBL   EQU   0
REPCB    EQU   REPTBL
REPIRWIO EQU   REPCB+16
REPORWIO EQU   REPCB+20
REPIDSOP EQU   REPCB+24
REPODSOP EQU   REPCB+28
REPIDSAR EQU   REPCB+32
REPODSAR EQU   REPCB+36
REPSPRIT EQU   REPCB+40
REPIBFPT EQU   REPCB+44
REPOBFPT EQU   REPCB+48
REPBUFF0 EQU   REPCB+52
REPBUFF1 EQU   REPCB+56
REPIXTNT EQU   REPCB+80
REPOXTNT EQU   REPCB+88
REPRWHAR EQU   REPCB+100
REPRWINA EQU   REPCB+104
REPILCPT EQU   REPCB+116
REPOLCPT EQU   REPCB+120
REPODEVA EQU   REPCB+128
REPQRPTR EQU   REPCB+132
REPEXOAR EQU   REPCB+140
REPCBEXT EQU   REPTBL+156
REPR0LN  EQU   REPCBEXT
REPR1LN  EQU   REPCBEXT+2
REPSRPR  EQU   REPCBEXT+4
REPRCDCT EQU   REPCBEXT+8
CKREQ    EQU   REPCBEXT+16
CKRERN   EQU   CKREQ
CKRMVAR  EQU   CKREQ+4
WFAREA   EQU   REPCBEXT+76
WFIODAD  EQU   WFAREA
WFIODLN  EQU   WFAREA+4
WFIOKYA  EQU   WFAREA+8
WFREQ    EQU   WFAREA+12
WFRTYP   EQU   WFREQ
WFRGET   EQU   WFRTYP
WFRUPD   EQU   WFRTYP
WFRPOS   EQU   WFRTYP
WFROPT   EQU   WFREQ+1
WFRIN    EQU   WFROPT
WFRUP    EQU   WFROPT
REPENQSW EQU   REPCBEXT+90
RWDEF    EQU   RWFHDR
RWFRDE   EQU   RWFR
RB2DEF   EQU   RB2
RB2FLG   EQU   RB2DEF+11
RWF1DEF  EQU   RWF1
RWF2DEF  EQU   RWF2
RWF2FLG  EQU   RWF2DEF+11
RDCHRC   EQU   RDCHR
RDSPKLDL EQU   RDSPKL
*                                      START UNREFERENCED COMPONENTS
@NM00136 EQU   RWF2DEF+16
@NM00135 EQU   RWF2DEF
@NM00134 EQU   RWF1DEF+16
RWF1FLG  EQU   RWF1DEF+11
@NM00133 EQU   RWF1DEF
@NM00132 EQU   RB2DEF+16
@NM00131 EQU   RB2DEF
@NM00125 EQU   RWFRDE+15
RWFROV   EQU   RWFRDE+14
RWFRF2   EQU   RWFRDE+12
RWFRF1   EQU   RWFRDE+11
@NM00124 EQU   RWFRDE
RWFHKLN  EQU   RWDEF+92
RWFHDLN  EQU   RWDEF+90
RWFHFT   EQU   RWDEF+89
@NM00104 EQU   RWDEF
@NM00103 EQU   WFROPT
@NM00102 EQU   WFRTYP
WFRLD    EQU   WFRTYP
WFRADD   EQU   WFRTYP
@NM00101 EQU   REPCBEXT+75
WFIOGUK  EQU   REPCBEXT+64
RDCATRC  EQU   REPCBEXT+60
@NM00100 EQU   CKREQ+2
@NM00099 EQU   REPCBEXT+15
K        EQU   REPCBEXT+14
J        EQU   REPCBEXT+13
I        EQU   REPCBEXT+12
REPRC    EQU   REPCBEXT+6
@NM00098 EQU   REPSRPR+1
@NM00097 EQU   REPSRPR
REPSRPRT EQU   REPSRPR
REPCDSOP EQU   REPCB+152
REPCPPTR EQU   REPCB+148
REPOPAGL EQU   REPCB+144
REPALLAG EQU   REPCB+136
REPIDEVA EQU   REPCB+124
REPOSYSI EQU   REPCB+112
REPISYSI EQU   REPCB+108
REPOINFO EQU   REPCB+96
REPIINFO EQU   REPCB+92
REPOXTN2 EQU   REPCB+84
REPIXTN2 EQU   REPCB+76
REPOUTCL EQU   REPCB+72
REPINCL  EQU   REPCB+68
REPRWHDO EQU   REPCB+64
REPRWHDI EQU   REPCB+60
REPARFIO EQU   REPCB+12
REPRESER EQU   REPCB
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00141 EQU   DSOUT+4
@NM00130 EQU   RWF2KYFL+15
RWF2FLG3 EQU   RWF2KYFL+14
RWF2FLG2 EQU   RWF2KYFL+12
RWF1KD   EQU   RWF1+24
RWF1CDL  EQU   RWF1C+6
RWF1CKL  EQU   RWF1C+5
@NM00129 EQU   RWF1KYFL+15
RWF1FLG3 EQU   RWF1KYFL+14
RWF1FLG2 EQU   RWF1KYFL+12
RWF1FLG1 EQU   RWF1KYFL+11
RWF1KEY  EQU   RWF1KYFL
RB3CHH   EQU   RB3CCHR+2
RB3CCC   EQU   RB3CCHR
@NM00128 EQU   RB2CHR+4
@NM00127 EQU   RB2CHR
@NM00126 EQU   RB2+15
RB2FLG2  EQU   RB2+12
RB1CR    EQU   RB1CCHR+4
RB1CHH   EQU   RB1CCHR+2
RB1CCC   EQU   RB1CCHR
RB0KD    EQU   RB0+8
RB0CR    EQU   RB0C+4
RB0CHH   EQU   RB0C+2
RB0CCC   EQU   RB0C
RWFRKD   EQU   RWFR+24
RWFRDLN  EQU   RWFRCNT+6
RWFRKLN  EQU   RWFRCNT+5
RWFRR    EQU   RWFRCNT+4
RWFRHH   EQU   RWFRCNT+2
RWFRCC   EQU   RWFRCNT
RWFRFLG  EQU   RWFR+11
RWFRKEY  EQU   RWFR
SPRVOL   EQU   SPRNAME+1
SPRLEN   EQU   SPRNAME
@NM00123 EQU   XTNTENT+75
XTNTR2   EQU   XTNTCHR2+4
XTNTHH2  EQU   XTNTCHR2+2
XTNTCC2  EQU   XTNTCHR2
@NM00122 EQU   XTNTENT+67
XTNTR1   EQU   XTNTCHR1+4
XTNTHH1  EQU   XTNTCHR1+2
XTNTCC1  EQU   XTNTCHR1
@NM00121 EQU   XTNTENT+59
XTNTVOL  EQU   XTNTENT+53
XTNTVOLN EQU   XTNTENT+52
XTNTDSN  EQU   XTNTENT+8
XTNTDDN  EQU   XTNTENT
@NM00120 EQU   XTNTHDR+85
XTNHMODE EQU   XTNTHDR+84
@NM00119 EQU   XTNTHDR+81
XTNHR2   EQU   XTNHCHR2+4
XTNHHH2  EQU   XTNHCHR2+2
XTNHCC2  EQU   XTNHCHR2
@NM00118 EQU   XTNTHDR+73
XTNHR1   EQU   XTNHCHR1+4
XTNHHH1  EQU   XTNHCHR1+2
XTNHCC1  EQU   XTNHCHR1
XTNHPWD  EQU   XTNTHDR+60
@NM00117 EQU   XTNTHDR+59
XTNHVOL  EQU   XTNTHDR+53
XTNHVOLN EQU   XTNTHDR+52
XTNHDDN  EQU   XTNTHDR
XTN2HH2  EQU   XTN2CHR2+2
XTN2CC2  EQU   XTN2CHR2
XTN2HH1  EQU   XTN2CHR1+2
XTN2CC1  EQU   XTN2CHR1
XTN2DSN  EQU   XTN2ENT
DEVWORD5 EQU   DEVAREA+20
@NM00116 EQU   DEV4B1+1
@NM00115 EQU   DEV4B1
@NM00114 EQU   DEV4B1
DEVBOH2  EQU   DEVBOH+1
DEVMAXHH EQU   @NM00113+2
DEVMAXCC EQU   @NM00113
DEVMAXBK EQU   DEVAREA+4
DEVTBYT4 EQU   DEVDEVTP+3
DEVTBYT3 EQU   DEVDEVTP+2
@NM00112 EQU   DEVTBYT2
DEVRVDEV EQU   DEVTBYT2
@NM00111 EQU   DEVTBYT2
DEVTBYT1 EQU   DEVDEVTP
INFVOL   EQU   INFOVOL+4
INFVOLLN EQU   INFOVOL+2
INFVOLID EQU   INFOVOL
INFDSN   EQU   INFODSN+4
INFDSNLN EQU   INFODSN+2
INFDSNID EQU   INFODSN
INFAREA  EQU   INFOAREA+4
INFDATAL EQU   INFOAREA+2
INFAREAL EQU   INFOAREA
RDDLEN   EQU   RDARG+56
RDKLEN   EQU   RDARG+52
RDLENTOT EQU   RDARG+50
RDSPDL   EQU   RDARG+48
@NM00110 EQU   RDSPACE+8
@NM00109 EQU   RDSPACE+6
@NM00108 EQU   RDSPACE+4
@NM00107 EQU   RDSPACE+1
@NM00106 EQU   RDSPACE
RDRWPKLN EQU   RDARG+32
RDRECNUM EQU   RDCHR+4
RDHH     EQU   RDCHR+2
RDCC     EQU   RDCHR
RDCCWCNT EQU   RDARG+24
RDRES    EQU   RDARG
RWHDRDLN EQU   RWHDRINF+6
RWHDRKLN EQU   RWHDRINF+5
@NM00105 EQU   RWHDRINF+1
RWHDRFIX EQU   RWHDRINF
RWFKCHR2 EQU   RWFKEY2+6
RWFKVOL2 EQU   RWFKEY2
RWFKCHR1 EQU   RWFKEY1+6
RWFKVOL1 EQU   RWFKEY1
RWFVOL   EQU   RWFINFO+52
RWFDSN   EQU   RWFINFO+8
RWFDDN   EQU   RWFINFO
SRCCHHRP EQU   SRPRTARG+40
SRRECPTR EQU   SRPRTARG+36
SRSPRECL EQU   SRPRTARG+32
SRDSNPTR EQU   SRPRTARG+28
SRERCODE EQU   SRPRTARG+24
SRRWFKEY EQU   SRPRTARG+20
SRRWFDSN EQU   SRPRTARG+16
SRVOLPTR EQU   SRPRTARG+12
SRDSNHDR EQU   SRPRTARG+8
SRVREPTR EQU   SRPRTARG+4
SRVRECL  EQU   SRPRTARG
RWFHFM   EQU   RWFHDR+99
RWFHDSNU EQU   RWFHDR+55
RWFHDSNR EQU   RWFHDR+11
RWFHKEY  EQU   RWFHDR
WKEYDAT  EQU   WBUF+8
WBDL     EQU   WBUFCNT+6
WBKL     EQU   WBUFCNT+5
WBREC    EQU   WBCCHHR+4
WBHH     EQU   WBCCHHR+2
WBCC     EQU   WBCCHHR
WNUMREC  EQU   WIOAREA
RKEYDAT  EQU   RBUF+8
RBDL     EQU   RBUFCNT+6
RBKL     EQU   RBUFCNT+5
RBREC    EQU   RBCCHHR+4
RBHH     EQU   RBCCHHR+2
RBCC     EQU   RBCCHHR
@NM00096 EQU   RKEYFLG+4
RKEYFLG3 EQU   RKEYFLG+3
RKEYFLG2 EQU   RKEYFLG+1
RKEYFLG1 EQU   RKEYFLG
RKEYR    EQU   RKEYCHR+4
RKEYHH   EQU   RKEYCHR+2
RKEYCC   EQU   RKEYCHR
RKEYVOL  EQU   RKEY
RBUFF    EQU   RIOAREA+282
@NM00095 EQU   RIOHDR+26
@NM00094 EQU   RIOHDR+10
RNUMREC  EQU   RIOHDR+8
@NM00093 EQU   RIOHDR+7
RPREVR   EQU   RPREV+4
RPREVHH  EQU   RPREV+2
RPREVCC  EQU   RPREV
@NM00092 EQU   RIOHDR+1
RFIRST   EQU   RIOHDR
LOCDLEN  EQU   LOCTAB+18
LOCKLEN  EQU   LOCTAB+17
@NM00091 EQU   LOCTAB+16
LOCCNTFD EQU   LOCTAB+8
LOCRCKD  EQU   LOCTAB+6
LOCRCNT  EQU   LOCTAB+4
LOCADDR  EQU   LOCTAB
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00090 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00089 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00088 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00087 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00086 EQU   VSDSCR+5
@NM00085 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00084 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00083 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00082 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00081 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00080 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00079 EQU   VSDVTOC
@NM00078 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00077 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00076 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00075 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00074 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00071 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00070 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00069 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00068 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00067 EQU   RCTAGL+10
@NM00066 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00065 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00064 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00063 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00062 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00061 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00060 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00059 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00058 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00057 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00056 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00055 EQU   EXSPACE+8
@NM00054 EQU   EXSPACE+6
@NM00053 EQU   EXSPACE+4
@NM00052 EQU   EXSPACE+1
@NM00051 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00050 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
MODCHLEN EQU   MODCH
MODVOLEN EQU   MODVO+20
MODVOMEM EQU   MODVO+12
MODVOMLN EQU   MODVO+11
MODVOFUQ EQU   MODVOFLG
MODVOPOS EQU   MODVO+9
MODVOPAS EQU   MODVO+1
MODVOPLN EQU   MODVO
MORCHLEN EQU   MORCH
MORVOLEN EQU   MORVO+20
MORVOMEM EQU   MORVO+12
MORVOMLN EQU   MORVO+11
MORVOFUQ EQU   MORVOFLG
MORVOPOS EQU   MORVO+9
MORVOPAS EQU   MORVO+1
MORVOPLN EQU   MORVO
MRRHHLEN EQU   MRRHH
MRRCHLEN EQU   MRRCH
MRRVOLEN EQU   MRRVO+20
MRRVOMEM EQU   MRRVO+12
MRRVOMLN EQU   MRRVO+11
MRRVOFUQ EQU   MRRVOFLG
MRRVOPOS EQU   MRRVO+9
MRRVOPAS EQU   MRRVO+1
MRRVOPLN EQU   MRRVO
MIDCHLEN EQU   MIDCH
MIDVOLEN EQU   MIDVO+20
MIDVOMEM EQU   MIDVO+12
MIDVOMLN EQU   MIDVO+11
MIDVOFUQ EQU   MIDVOFLG
MIDVOPOS EQU   MIDVO+9
MIDVOPAS EQU   MIDVO+1
MIDVOPLN EQU   MIDVO
MIRCHLEN EQU   MIRCH
MIRVOLEN EQU   MIRVO+20
MIRVOMEM EQU   MIRVO+12
MIRVOMLN EQU   MIRVO+11
MIRVOFUQ EQU   MIRVOFLG
MIRVOPOS EQU   MIRVO+9
MIRVOPAS EQU   MIRVO+1
MIRVOPLN EQU   MIRVO
MVTCRLEN EQU   MVTCR
MVTCSLEN EQU   MVTCS+20
MVTCSMEM EQU   MVTCS+12
MVTCSMLN EQU   MVTCS+11
MVTCSFUQ EQU   MVTCSFLG
MVTCSPOS EQU   MVTCS+9
MVTCSPAS EQU   MVTCS+1
MVTCSPLN EQU   MVTCS
MODSVAL  EQU   MODS+21
MODSLEN  EQU   MODS+20
MODSMEM  EQU   MODS+12
MODSMLN  EQU   MODS+11
MODSFUQ  EQU   MODSFLG
MODSPOS  EQU   MODS+9
MODSPAS  EQU   MODS+1
MODSPLN  EQU   MODS
MOUTFVAL EQU   MOUTF+10
MOUTFLEN EQU   MOUTF+9
MOUTFPAS EQU   MOUTF+1
MOUTFPLN EQU   MOUTF
MINDSVAL EQU   MINDS+21
MINDSLEN EQU   MINDS+20
MINDSMEM EQU   MINDS+12
MINDSMLN EQU   MINDS+11
MINDSFUQ EQU   MINDSFLG
MINDSPOS EQU   MINDS+9
MINDSPAS EQU   MINDS+1
MINDSPLN EQU   MINDS
MINFLVAL EQU   MINFL+10
MINFLLEN EQU   MINFL+9
MINFLPAS EQU   MINFL+1
MINFLPLN EQU   MINFL
DBDATVAL EQU   DBDAT
DBKEYVAL EQU   DBKEY
DBHHHVAL EQU   DBHHH+1
DBHHHLEN EQU   DBHHH
DBCCHVAL EQU   DBCCH+1
DBCCHLEN EQU   DBCCH
DBVOLVAL EQU   DBVOL+21
DBVOLLEN EQU   DBVOL+20
DBVOLMEM EQU   DBVOL+12
DBVOLMLN EQU   DBVOL+11
DBVOLFUQ EQU   DBVOLFLG
DBVOLPOS EQU   DBVOL+9
DBVOLPAS EQU   DBVOL+1
DBVOLPLN EQU   DBVOL
DBDSVAL  EQU   DBDS+21
DBDSLEN  EQU   DBDS+20
DBDSMEM  EQU   DBDS+12
DBDSMLN  EQU   DBDS+11
DBDSFUQ  EQU   DBDSFLG
DBDSPOS  EQU   DBDS+9
DBDSPAS  EQU   DBDS+1
DBDSPLN  EQU   DBDS
DBFILVAL EQU   DBFIL+10
DBFILLEN EQU   DBFIL+9
DBFILPAS EQU   DBFIL+1
DBFILPLN EQU   DBFIL
CVTCSVAL EQU   CVTCS+21
CVTCSLEN EQU   CVTCS+20
CVTCSMEM EQU   CVTCS+12
CVTCSMLN EQU   CVTCS+11
CVTCSFUQ EQU   CVTCSFLG
CVTCSPOS EQU   CVTCS+9
CVTCSPAS EQU   CVTCS+1
CVTCSPLN EQU   CVTCS
CDATLVAL EQU   CDATL
CKEYLVAL EQU   CKEYL
CRECRVAL EQU   CRECR+1
CRECRLEN EQU   CRECR
CCCHRVAL EQU   CCCHR+1
CCCHRLEN EQU   CCCHR
CVOLSVAL EQU   CVOLS+21
CVOLSLEN EQU   CVOLS+20
CVOLSMEM EQU   CVOLS+12
CVOLSMLN EQU   CVOLS+11
CVOLSFUQ EQU   CVOLSFLG
CVOLSPOS EQU   CVOLS+9
CVOLSPAS EQU   CVOLS+1
CVOLSPLN EQU   CVOLS
CDHHRVAL EQU   CDHHR+1
CDHHRLEN EQU   CDHHR
CDCHRVAL EQU   CDCHR+1
CDCHRLEN EQU   CDCHR
CVOLDVAL EQU   CVOLD+21
CVOLDLEN EQU   CVOLD+20
CVOLDMEM EQU   CVOLD+12
CVOLDMLN EQU   CVOLD+11
CVOLDFUQ EQU   CVOLDFLG
CVOLDPOS EQU   CVOLD+9
CVOLDPAS EQU   CVOLD+1
CVOLDPLN EQU   CVOLD
CCATLVAL EQU   CCATL+21
CCATLLEN EQU   CCATL+20
CCATLMEM EQU   CCATL+12
CCATLMLN EQU   CCATL+11
CCATLFUQ EQU   CCATLFLG
CCATLPOS EQU   CCATL+9
CCATLPAS EQU   CCATL+1
CCATLPLN EQU   CCATL
COFILVAL EQU   COFIL+10
COFILLEN EQU   COFIL+9
COFILPAS EQU   COFIL+1
COFILPLN EQU   COFIL
CINDSVAL EQU   CINDS+21
CINDSLEN EQU   CINDS+20
CINDSMEM EQU   CINDS+12
CINDSMLN EQU   CINDS+11
CINDSFUQ EQU   CINDSFLG
CINDSPOS EQU   CINDS+9
CINDSPAS EQU   CINDS+1
CINDSPLN EQU   CINDS
CINFLVAL EQU   CINFL+10
CINFLLEN EQU   CINFL+9
CINFLPAS EQU   CINFL+1
CINFLPLN EQU   CINFL
DVTCSVAL EQU   DVTCS+21
DVTCSLEN EQU   DVTCS+20
DVTCSMEM EQU   DVTCS+12
DVTCSMLN EQU   DVTCS+11
DVTCSFUQ EQU   DVTCSFLG
DVTCSPOS EQU   DVTCS+9
DVTCSPAS EQU   DVTCS+1
DVTCSPLN EQU   DVTCS
DATALVAL EQU   DATAL
DKEYLVAL EQU   DKEYL
RRCHHVAL EQU   RRCHH+1
RRCHHLEN EQU   RRCHH
RRCHRVAL EQU   RRCHR+1
RRCHRLEN EQU   RRCHR
VOLRRVAL EQU   VOLRR+21
VOLRRLEN EQU   VOLRR+20
VOLRRMEM EQU   VOLRR+12
VOLRRMLN EQU   VOLRR+11
VOLRRFUQ EQU   VOLRRFLG
VOLRRPOS EQU   VOLRR+9
VOLRRPAS EQU   VOLRR+1
VOLRRPLN EQU   VOLRR
DSCHHVAL EQU   DSCHH+1
DSCHHLEN EQU   DSCHH
DSCHRVAL EQU   DSCHR+1
DSCHRLEN EQU   DSCHR
VOLDSVAL EQU   VOLDS+21
VOLDSLEN EQU   VOLDS+20
VOLDSMEM EQU   VOLDS+12
VOLDSMLN EQU   VOLDS+11
VOLDSFUQ EQU   VOLDSFLG
VOLDSPOS EQU   VOLDS+9
VOLDSPAS EQU   VOLDS+1
VOLDSPLN EQU   VOLDS
DRECVAL  EQU   DREC+1
DRECLEN  EQU   DREC
DCCHRVAL EQU   DCCHR+1
DCCHRLEN EQU   DCCHR
VOLSRVAL EQU   VOLSR+21
VOLSRLEN EQU   VOLSR+20
VOLSRMEM EQU   VOLSR+12
VOLSRMLN EQU   VOLSR+11
VOLSRFUQ EQU   VOLSRFLG
VOLSRPOS EQU   VOLSR+9
VOLSRPAS EQU   VOLSR+1
VOLSRPLN EQU   VOLSR
DOTDSVAL EQU   DOTDS+21
DOTDSLEN EQU   DOTDS+20
DOTDSMEM EQU   DOTDS+12
DOTDSMLN EQU   DOTDS+11
DOTDSFUQ EQU   DOTDSFLG
DOTDSPOS EQU   DOTDS+9
DOTDSPAS EQU   DOTDS+1
DOTDSPLN EQU   DOTDS
DOUTFVAL EQU   DOUTF+10
DOUTFLEN EQU   DOUTF+9
DOUTFPAS EQU   DOUTF+1
DOUTFPLN EQU   DOUTF
INDSVAL  EQU   INDS+21
INDSLEN  EQU   INDS+20
INDSMEM  EQU   INDS+12
INDSMLN  EQU   INDS+11
INDSFUQ  EQU   INDSFLG
INDSPOS  EQU   INDS+9
INDSPAS  EQU   INDS+1
INDSPLN  EQU   INDS
INFILVAL EQU   INFIL+10
INFILLEN EQU   INFIL+9
INFILPAS EQU   INFIL+1
INFILPLN EQU   INFIL
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@PB00002 EQU   @EL00001
@ENDDATA EQU   *
         END   IDCRD05,(C'PLS2120',0603,76328)

         MACRO
         IGGCP123 &OPTCD=
.*         RELEASE 23 DELETIONS/CHANGES
.*         RELEASE 22 DELETIONS/CHANGES
.*         RELEASE 21 DELETIONS/CHANGES
         AIF   ('&OPTCD' EQ 'V').VLR
* 123W   ADDENDUM TO CP12A AND CP12B OR TO CP13A AND CP13B WHEN WRITE
*        CHECKING IS SPECIFIED.
CEA00    CCW   NOP,0,CC+SILI,1
CEA      CCW   SIDEQ,0,CC,5              SEARCH FOR REC OR BLOCK AGAIN
CEB      CCW   TIC,CEA-CEA00,0,0
CEE      CCW   RCKD,0,SKIP,0             READ IT BACK
SZ123    EQU   CEE+8-CEA00
         AGO   .END
.VLR     ANOP
* 123WV  ADDENDUM TO CP12AV AND 12BV WHEN WRITE CHECKING IS SPECIFIED
CEA00    CCW   NOP,CEA00+5-CEA00,CC+SILI,1
CEA0     CCW   SIDEQ,CD0-CB1,CC,5        SEARCH FOR TRACK CAPACITY
CEA05    CCW   TIC,CEA0-CEA00,0,0        RECORD (R0)
CEA1     CCW   RDATA,0,CC+SILI+SKIP,3       READ CAPACITY RECORD
CEA2     CCW   TIC,CEA-CB1,0,0           TIC TO CED IF THE FULL TRACK
*                                        IS BEING CHECKED
CEA3     CCW   NOP,0,CC,1
CEA      CCW   SIDEQ,0,CC,5              SEARCH FOR FIRST DATA RECORD
CEB      CCW   TIC,CEA-CEA00,0,0         AGAIN
CED      CCW   RCKD,0,DC+SKIP+SILI,8     READ RECORD BACK
CEE      CCW   RKD,0,CC+SKIP+SILI,0      THE NUMBER OF CEE-CEF SETS
CEF      CCW   RCKD,0,CC+SKIP+SILI,0     EQUALS DCBHIRPD
SZ123V   EQU   CEF+8-CEA00
.END     MEND

         MACRO
         IGGCP10A &OPTCD=
.*          RELEASE 23 DELETIONS/CHANGES
.*          RELEASE 22 DELETIONS/CHANGES
.*          RELEASE 21 DELETIONS/CHANGES
* CP10A  WRITES A RECORD OR BLOCK TO REPLACE AN EOF MARK
CB46     CCW   SIDEQ,0,CC,5             SEARCH FOR LAST DATA REC
CB47     CCW   TIC,CB46-CB1,0,0
CB48     CCW   WCKD,CB51-CB1,DC,8       WRITE REC OR BLOCK OVER EOF MRK
CB49     CCW   0,0,DC,0
         AIF   ('&OPTCD' NE 'W').SWC
CB50     CCW   0,0,CC,0
         AGO   .TWC
.SWC     ANOP
CB50     CCW   0,0,0,0
.TWC     ANOP
SZ10A    EQU   (CB50+8-CB46)+8
         AIF   ('&OPTCD' NE 'W').CCHH
* 10AW   WRITE VALIDITY CHECK
CB500    CCW   NOP,0,CC+SILI,1
CB50A    CCW   SIDEQ,0,CC,5           SEARCH FOR REC AGAIN
CB50B    CCW   TIC,CB50A-CB1,0,0
CB50C    CCW   RCKD,0,SKIP,0          READ IT BACK
SZ10AW   EQU   CB50C+8-CB500+SZ10A
.CCHH    ANOP
CB51     DC    2F'00'                   C C H H R KL DL DL
         MEND

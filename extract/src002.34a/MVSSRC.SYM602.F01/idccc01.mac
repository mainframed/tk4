         TITLE '****  IDCCC01:  CONVERT CATALOG FUNCTION SUPPORT ROUTIN*
               NE  **** '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCCC01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCCC01   75.039'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0002
         USING @DATD,@09                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @09,8(,@13)                                         0002
         LR    @13,@09                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                      /*MSG PRINTED FLAG    @YL026UD*/
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ZERO POINTER TO 'DNAME' VALUE OF THE 'CATALOG'  @YL026UD*/
*        /*  PARAMETER (IF SPECIFIED) -                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE 'DNAME' VALUE IS NOT NEEDED TO FOR THE      @YL026UD*/
*        /*  'UOPEN' REQUEST FOR VS2 RELEASE 2 (BECAUSE      @YL026UD*/
*        /*  OF DYNAMIC ALLOCATION), BUT IS ALLOWED ON THE   @YL026UD*/
*        /*  'CNVTCAT' COMMAND TO BE COMPATIBLE WITH OTHER   @YL026UD*/
*        /*  AMS COMMANDS FOR PREVIOUS VS1 AND VS2 RELEASES  @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0197
*        FDTPTR(5) = NULLPTR;                              /*@Y30SSMK*/
*                                                                  0197
         SLR   @07,@07                                             0197
         L     @05,@PC00001+4                                      0197
         ST    @07,FDTPTR+16(,@05)                                 0197
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE 'UPRINT' MACRO ARGUMENT LIST         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0198
*        DDSTRU = ADDR(PRNTLIST);                          /*@YL026UD*/
         LA    @15,PRNTLIST                                        0198
         ST    @15,DDSTRU                                          0198
*        PRNTLIST = '00'X;                                 /*@YL026UD*/
*                                                                  0199
         XC    PRNTLIST+1(19),PRNTLIST+1                           0199
         MVI   PRNTLIST,X'00'                                      0199
*        LASTMSG = OFF;                                    /*@YL026UD*/
*                                                                  0200
*                                                                  0200
         NI    LASTMSG,B'01111111'                                 0200
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OPEN THE INPUT DATA SET -                       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE INPUT DATA SET (OS CATALOG 'SYSCTLG'        @YL026UD*/
*        /*  DATA SET) IS OPENED FOR BSAM PROCESSING         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE INPUT DATA SET IS REFERENCED VIA THE        @YL026UD*/
*        /*  'INFILE' (DD CARD) OR 'INDATASET'               @YL026UD*/
*        /*  (DYNAMIC ALLOCATION) PARAMETER                  @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE INPUT 'UOPEN' MACRO ARGUMENT LIST    @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0201
*        OPNPTR = ADDR(IOPENARG);                          /*@YL026UD*/
         LA    OPNPTR,IOPENARG                                     0201
*        IOPENARG = '00'X;                                 /*@YL026UD*/
*                                                                  0202
         XC    IOPENARG+1(43),IOPENARG+1                           0202
         MVI   IOPENARG,X'00'                                      0202
*        OPNOPTIN = ON;                                    /*@YL026UD*/
*        OPNOPTBK = ON;                                    /*@YL026UD*/
         OI    OPNOPTIN(OPNPTR),B'10010000'                        0204
*        OPNRFMFX = ON;                                    /*@YL026UD*/
*        OPNRFMBK = ON;                                    /*@YL026UD*/
         OI    OPNRFMFX(OPNPTR),B'10001000'                        0206
*        OPNIOC   = ADDR(IIOCSPTR);                        /*@YL026UD*/
*                                                                  0207
         LA    @15,IIOCSPTR                                        0207
         ST    @15,OPNIOC(,OPNPTR)                                 0207
*        IF ADDR(IFILE) ^= NULLPTR                                 0208
*          THEN                                                    0208
         L     @05,FDTPTR(,@05)                                    0208
         CR    @05,@07                                             0208
         BE    @RF00208                                            0208
*            OPNDDN = ADDR(IFILEVAL);                      /*@YL026UD*/
*                                                                  0209
         LA    @07,IFILEVAL(,@05)                                  0209
         ST    @07,OPNDDN(,OPNPTR)                                 0209
*        IF ADDR(IDS) ^= NULLPTR                                   0210
*          THEN                                                    0210
@RF00208 L     @07,@PC00001+4                                      0210
         L     @07,FDTPTR+4(,@07)                                  0210
         LTR   @07,@07                                             0210
         BZ    @RF00210                                            0210
*            OPNDSN = ADDR(IDSVAL);                        /*@YL026UD*/
*                                                                  0211
         LA    @07,IDSVAL(,@07)                                    0211
         ST    @07,OPNDSN(,OPNPTR)                                 0211
*        OPNBLK = BLKSIZE;                                 /*@Y30SSMK*/
@RF00210 MVC   OPNBLK(4,OPNPTR),@CF00823                           0212
*        OPNDSOPS = ON;                                    /*@YL026UD*/
*                                                                  0213
         OI    OPNDSOPS(OPNPTR),B'01000000'                        0213
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OPEN THE INPUT DATA SET ('UOPEN' MACRO)         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0214
*        CALL IDCIOOP0(GDTTBL,IOPENARG);                   /*@YL026UD*/
*                                                                  0214
         L     @07,@PC00001                                        0214
         ST    @07,@AL00001                                        0214
         LA    @02,IOPENARG                                        0214
         ST    @02,@AL00001+4                                      0214
         MVI   @AL00001+4,X'80'                                    0214
         L     @15,GDTOPN(,@07)                                    0214
         LA    @01,@AL00001                                        0214
         BALR  @14,@15                                             0214
*        RESPECIFY RTNREG RSTD;                                    0215
*        TESTRC = RTNREG;                                          0216
         LR    TESTRC,RTNREG                                       0216
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0217
*        IF TESTRC ^= 0                                            0218
*          THEN                                                    0218
         SLR   @07,@07                                             0218
         CR    TESTRC,@07                                          0218
         BE    @RF00218                                            0218
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  UNSUCCESSFUL OPEN OF INPUT DATA SET -     @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0220
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0220
         L     @05,@PC00001+8                                      0220
         MVC   LASTCOND(2,@05),@CH00037                            0220
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/
*                                                                  0221
         L     @05,DDSTRU                                          0221
         MVC   DARGSMOD(3,@05),@CC00849                            0221
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /*  IN A TSO ENVIRONMENT, THE LASTCC MESSAGE  @Y30SSMK*/
*              /*  WILL BE PRINTED OUT.  THE FUNCTION        @Y30SSMK*/
*              /*  TERMINATED MESSAGE WILL BE PRINTED OUT    @Y30SSMK*/
*              /*  FOR BACKGROUND PROCESSING.                @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  0222
*              IF GDTECT ^= NULLPTR                                0222
*                THEN                                              0222
         L     @02,@PC00001                                        0222
         C     @07,GDTECT(,@02)                                    0222
         BE    @RF00222                                            0222
*                  DARGSENT = LSCCMSG#;                    /*@Y30SSMK*/
         MVI   DARGSENT(@05),X'0F'                                 0223
*                ELSE                                              0224
*                  DARGSENT = TERMMSG#;                    /*@YL026UD*/
*                                                                  0224
         B     @RC00222                                            0224
@RF00222 L     @07,DDSTRU                                          0224
         MVI   DARGSENT(@07),X'03'                                 0224
*              DARGDBP = ADDR(LASTCOND);                   /*@YL026UD*/
@RC00222 L     @07,DDSTRU                                          0225
         L     @05,@PC00001+8                                      0225
         ST    @05,DARGDBP(,@07)                                   0225
*              DARGILP = LENGTH(LASTCOND);                 /*@YL026UD*/
*                                                                  0226
         MVC   DARGILP(2,@07),@CH00149                             0226
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0227
         L     @07,@PC00001                                        0227
         ST    @07,@AL00001                                        0227
         LA    @05,@CF00113                                        0227
         ST    @05,@AL00001+4                                      0227
         LA    @05,DDSTRU                                          0227
         ST    @05,@AL00001+8                                      0227
         MVI   @AL00001+8,X'80'                                    0227
         L     @15,GDTPRT(,@07)                                    0227
         LA    @01,@AL00001                                        0227
         BALR  @14,@15                                             0227
*              CALL IDCSAEP0(GDTTBL,MODID);                        0228
         L     @07,@PC00001                                        0228
         ST    @07,@AL00001                                        0228
         LA    @05,MODID                                           0228
         ST    @05,@AL00001+4                                      0228
         MVI   @AL00001+4,X'80'                                    0228
         L     @15,GDTEPL(,@07)                                    0228
         LA    @01,@AL00001                                        0228
         BALR  @14,@15                                             0228
*                                                          /*@YL026UD*/
*                                                                  0229
*            END;                                          /*@YL026UD*/
*                                                                  0229
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  CONVERT THE OS CATALOG ENTRIES TO               @YL026UD*/
*        /*  VSAM CATALOG ENTRIES                            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0230
*        CALL CONVERT;                                     /*@YL026UD*/
*                                                                  0230
@RF00218 BAL   @14,CONVERT                                         0230
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  CLOSE THE INPUT DATA SET                        @YL026UD*/
*        /*  ('UCLOSE' MACRO)                                @YL026UD*/
*        /*  IF CLOSE IS NOT SUCCESSFUL, UPDATE THE LAST     @Y30SSMK*/
*        /*  CONDITION CODE.                                 @Y30SSMK*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0231
*        CALL IDCIOCL0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0231
         L     @08,@PC00001                                        0231
         ST    @08,@AL00001                                        0231
         LA    @04,IIOCSPTR                                        0231
         ST    @04,@AL00001+4                                      0231
         MVI   @AL00001+4,X'80'                                    0231
         L     @15,GDTCLS(,@08)                                    0231
         LA    @01,@AL00001                                        0231
         BALR  @14,@15                                             0231
*        RESPECIFY RTNREG RSTD;                                    0232
*        TESTRC = RTNREG;                                          0233
         LR    TESTRC,RTNREG                                       0233
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0234
*        IF TESTRC ^= 0                                            0235
*          THEN                                                    0235
         LTR   TESTRC,TESTRC                                       0235
         BZ    @RF00235                                            0235
*            LASTCOND = MAX(LASTCOND,LASTCC04);            /*@YL026UD*/
*                                                                  0236
         L     @08,@PC00001+8                                      0236
         LH    @15,LASTCOND(,@08)                                  0236
         LA    @14,4                                               0236
         CR    @15,@14                                             0236
         BNL   *+6
         LR    @15,@14                                             0236
         STH   @15,LASTCOND(,@08)                                  0236
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  FREE STORAGE HELD BY SYSCTLG INDEX BLOCKS       @YL026UD*/
*        /*  FREE STORAGE HELD BY CPL/FVT/FPL LISTS          @YL026UD*/
*        /*  FREE STORAGE HELD BY VOLUME INFORMATION LISTS   @YL026UD*/
*        /*  FREE STORAGE HELD BY CATALOG WORKAREA           @YL026UD*/
*        /*  ('UFPOOL' MACRO)                                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0237
*        CALL IDCSAFP0(GDTTBL,POOLID);                     /*@YL026UD*/
*                                                                  0237
@RF00235 L     @08,@PC00001                                        0237
         ST    @08,@AL00001                                        0237
         LA    @15,@CC00862                                        0237
         ST    @15,@AL00001+4                                      0237
         MVI   @AL00001+4,X'80'                                    0237
         L     @15,GDTFPL(,@08)                                    0237
         LA    @01,@AL00001                                        0237
         BALR  @14,@15                                             0237
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  PRINT THE 'CNVTCAT' FUNCTION COMPLETION MESSAGE @YL026UD*/
*        /*  (IF NOT ALREADY PRINTED - I.E., 'INSUFFICIENT   @YL026UD*/
*        /*  STORAGE' TERMINATION MESSAGE)                   @YL026UD*/
*        /*  IN A TSO ENVIRONMENT, PRINT THE LASTCC MESSAGE  @Y30SSMK*/
*        /*  ONLY IF THE FINAL CONDITION CODE IS GREATER     @Y30SSMK*/
*        /*  THAN 0.                                         @Y30SSMK*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0238
*        IF LASTMSG = OFF                                          0238
*          THEN                                                    0238
         TM    LASTMSG,B'10000000'                                 0238
         BNZ   @RF00238                                            0238
*            IF GDTECT ^= NULLPTR                                  0239
*              THEN                                                0239
         SLR   @08,@08                                             0239
         L     @15,@PC00001                                        0239
         C     @08,GDTECT(,@15)                                    0239
         BE    @RF00239                                            0239
*                DO;                                       /*@Y30SSMK*/
*                  IF LASTCOND > 0                                 0241
*                    THEN                                          0241
         L     @14,@PC00001+8                                      0241
         CH    @08,LASTCOND(,@14)                                  0241
         BNL   @RF00241                                            0241
*                      DO;                                 /*@Y30SSMK*/
*                        DARGSMOD = UNIVMSG;               /*@Y30SSMK*/
         L     @08,DDSTRU                                          0243
         MVC   DARGSMOD(3,@08),@CC00849                            0243
*                        DARGSENT = LSCCMSG#;              /*@Y30SSMK*/
         MVI   DARGSENT(@08),X'0F'                                 0244
*                        DARGDBP = ADDR(LASTCOND);         /*@Y30SSMK*/
         ST    @14,DARGDBP(,@08)                                   0245
*                        DARGILP = LENGTH(LASTCOND);       /*@Y30SSMK*/
*                                                                  0246
         MVC   DARGILP(2,@08),@CH00149                             0246
*                        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     0247
         ST    @15,@AL00001                                        0247
         LA    @08,@CF00113                                        0247
         ST    @08,@AL00001+4                                      0247
         LA    @08,DDSTRU                                          0247
         ST    @08,@AL00001+8                                      0247
         MVI   @AL00001+8,X'80'                                    0247
         L     @15,GDTPRT(,@15)                                    0247
         LA    @01,@AL00001                                        0247
         BALR  @14,@15                                             0247
*                                                          /*@Y30SSMK*/
*                      END;                                /*@Y30SSMK*/
*                END;                                      /*@Y30SSMK*/
*              ELSE                                                0250
*                DO;                                       /*@Y30SSMK*/
         B     @RC00239                                            0250
@RF00239 DS    0H                                                  0251
*                  IF LASTCOND < LASTCC12                          0251
*                    THEN                                          0251
         L     @08,@PC00001+8                                      0251
         LH    @08,LASTCOND(,@08)                                  0251
         C     @08,@CF00037                                        0251
         BNL   @RF00251                                            0251
*                      DARGSENT = END0MSG#;                /*@Y30SSMK*/
         L     @08,DDSTRU                                          0252
         MVI   DARGSENT(@08),X'01'                                 0252
*                    ELSE                                          0253
*                      DARGSENT = TERMMSG#;                /*@Y30SSMK*/
*                                                                  0253
         B     @RC00251                                            0253
@RF00251 L     @08,DDSTRU                                          0253
         MVI   DARGSENT(@08),X'03'                                 0253
*                  DARGSMOD = UNIVMSG;                     /*@Y30SSMK*/
@RC00251 L     @08,DDSTRU                                          0254
         MVC   DARGSMOD(3,@08),@CC00849                            0254
*                  DARGDBP = ADDR(LASTCOND);               /*@Y30SSMK*/
         L     @15,@PC00001+8                                      0255
         ST    @15,DARGDBP(,@08)                                   0255
*                  DARGILP = LENGTH(LASTCOND);             /*@Y30SSMK*/
*                                                                  0256
         MVC   DARGILP(2,@08),@CH00149                             0256
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   /*@Y30SSMK*/
         L     @08,@PC00001                                        0257
         ST    @08,@AL00001                                        0257
         LA    @15,@CF00113                                        0257
         ST    @15,@AL00001+4                                      0257
         LA    @15,DDSTRU                                          0257
         ST    @15,@AL00001+8                                      0257
         MVI   @AL00001+8,X'80'                                    0257
         L     @15,GDTPRT(,@08)                                    0257
         LA    @01,@AL00001                                        0257
         BALR  @14,@15                                             0257
*                END;                                      /*@Y30SSMK*/
*                                                                  0258
*                                                                  0258
*        CALL IDCSAEP0(GDTTBL,MODID);                              0259
@RC00239 DS    0H                                                  0259
@RF00238 L     @08,@PC00001                                        0259
         ST    @08,@AL00001                                        0259
         LA    @15,MODID                                           0259
         ST    @15,@AL00001+4                                      0259
         MVI   @AL00001+4,X'80'                                    0259
         L     @15,GDTEPL(,@08)                                    0259
         LA    @01,@AL00001                                        0259
         BALR  @14,@15                                             0259
*                                                          /*@YL026UD*/
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - CONVERT                                @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - TO CONVERT THE OS CATALOG ENTRIES INTO       @YL026UD*/
*/*             'NONVSAM', 'ALIAS', OR 'GDG BASE' ENTRIES    @YL026UD*/
*/*             IN THE VSAM USER OR MASTER CATALOG           @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE SYSCTLG DATA SET IS SCANNED (BEGINNING   @YL026UD*/
*/*             WITH THE VOLUME INDEX) TO OBTAIN AND BUILD   @YL026UD*/
*/*             COMPLETE DATA SET NAMES TO BE DEFINED IN     @YL026UD*/
*/*             THE VSAM CATALOG                             @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE OS CATALOG ('SYSCTLG' DATA SET)             @YL026UD*/
*/*          CONTAINING THE ENTRIES TO BE CONVERTED          @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE VSAM USER CATALOG CONTAINING THE           @YL026UD*/
*/*           CONVERTED CATALOG ENTRIES                      @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0260
*CONVERT: PROCEDURE;                                       /*@YL026UD*/
@EL00001 L     @13,4(,@13)                                         0260
@EF00001 L     @00,@SIZDATD                                        0260
         LR    @01,@09                                             0260
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0260
         BR    @14                                                 0260
CONVERT  STM   @14,@12,@SA00002                                    0260
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  'SYSCTLG' DATA SET ENTRY TYPE CODES             @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0261
*        /*  ALIAS ENTRY (AE) TYPE CODE                      @YL026UD*/
*        DCL TYPEAE      BIT(8) BDY(BYTE) INIT('04'X);     /*@YL026UD*/
*                                                                  0261
*        /*  CONTROL VOLUME POINTER ENTRY (CVPE) ENTRY CODES @YL026UD*/
*        DCL TYPECVPE(2) BIT(8) BDY(BYTE) INIT('03'X,'05'X);       0262
*                                                                  0262
*        /*  DATA SET POINTER ENTRY (DSPE) TYPE CODES        @YL026UD*/
*        DCL TYPEDSPE(5) BIT(8) BDY(BYTE) INIT('07'X,'0D'X,        0263
*                                              '13'X,'19'X,        0263
*                                              '1F'X);     /*@YL026UD*/
*                                                                  0263
*        /*  GENERATION INDEX POINTER ENTRY (GIPE) TYPE CODE @YL026UD*/
*        DCL TYPEGIPE    BIT(8) BDY(BYTE) INIT('02'X);     /*@YL026UD*/
*                                                                  0264
*        /*  INDEX CONTROL ENTRY (ICE) TYPE CODE             @YL026UD*/
*        /*  (ENTRY NAME = '00...01'X)                       @YL026UD*/
*        DCL TYPEICE     BIT(8) BDY(BYTE) INIT('03'X);     /*@YL026UD*/
*                                                                  0265
*        /*  INDEX LINK ENTRY (ILE) TYPE CODE                @YL026UD*/
*        /*  (ENTRY NAME = 'FF...FF'X)                       @YL026UD*/
*        DCL TYPEILE     BIT(8) BDY(BYTE) INIT('00'X);     /*@YL026UD*/
*                                                                  0266
*        /*  INDEX POINTER ENTRY (IPE) TYPE CODE             @YL026UD*/
*        DCL TYPEIPE     BIT(8) BDY(BYTE) INIT('00'X);     /*@YL026UD*/
*                                                                  0267
*        /*  VOLUME CONTROL BLOCK POINTER ENTRY (VCBPE)      @YL026UD*/
*        /*  TYPE CODE                                       @YL026UD*/
*        DCL TYPEVCBP    BIT(8) BDY(BYTE) INIT('01'X);     /*@YL026UD*/
*                                                                  0268
*        /*  VOLUME INDEX CONTROL ENTRY (VICE) TYPE CODE     @YL026UD*/
*        /*  (ENTRY NAME = '00...01'X)                       @YL026UD*/
*        DCL TYPEVICE    BIT(8) BDY(BYTE) INIT('05'X);     /*@YL026UD*/
*                                                                  0269
*                                                                  0269
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  'SYSCTLG' DATA SET ENTRY FORMATS                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0270
*        DCL CATPTR          PTR(31);  /*CATALOG ENTRY       @YL026UD*/
*                                      /*BASE POINTER        @YL026UD*/
*                                                                  0271
*        /*  SYSCTLG BASIC ENTRY FORMAT                      @YL026UD*/
*        DCL 1 CATFORM        CHAR(12)  BDY(WORD)  BASED(CATPTR),  0271
*              2 CATENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 CATETTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/
*              2 CATETYPE     BIT(8);  /*ENTRY TYPE CODE     @YL026UD*/
*                                                                  0271
*        /*  ALIAS ENTRY (AE) FORMAT                         @YL026UD*/
*        DCL 1 AEFORM         CHAR(20)  BDY(WORD)  BASED(CATPTR),  0272
*              2 AENAME       CHAR(8), /*ALIAS NAME          @YL026UD*/
*              2 AETTR        CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/
*              2 AETYPE       BIT(8),  /*ALIAS ENTRY TYPE    @YL026UD*/
*              2 AETRUEN      CHAR(8); /*TRUE NAME OF ENTRY  @YL026UD*/
*                                                                  0272
*        /*  'OLD' CONTROL VOLUME POINTER ENTRY (CVPE) FORM  @YL026UD*/
*        DCL 1 CVP1FORM       CHAR(18)  BDY(WORD)  BASED(CATPTR),  0273
*              2 CVP1NAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 CVP1TTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/
*              2 CVP1TYPE     BIT(8),  /*OLD CVPE TYPE       @YL026UD*/
*              2 CVP1VOL      CHAR(6); /*CVOL SERIAL NUMBER  @YL026UD*/
*                                                                  0273
*        /*  'NEW' CONTROL VOLUME POINTER ENTRY (CVPE) FORM  @YL026UD*/
*        DCL 1 CVP2FORM       CHAR(22)  BDY(WORD)  BASED(CATPTR),  0274
*              2 CVP2NAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 CVP2TTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/
*              2 CVP2TYPE     BIT(8),  /*NEW CVPE TYPE       @YL026UD*/
*              2 CVP2VTYP     FIXED(32),/*CVOL DEVICE TYPE   @YL026UD*/
*              2 CVP2VOL      CHAR(6); /*CVOL SERIAL NUMBER  @YL026UD*/
*                                                                  0274
*        /*  DATA SET POINTER ENTRY (DSPE) FORMAT            @YL026UD*/
*        DCL 1 DSPEFORM       CHAR(74)  BDY(WORD)  BASED(CATPTR),  0275
*              2 DSPENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 DSPETTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/
*              2 DSPETYPE     BIT(8),  /*DSPE ENTRY TYPE     @YL026UD*/
*              2 DSPEVCNT     FIXED(15),/*VOLUME COUNT       @YL026UD*/
*              2 DSPEDATA(5)  CHAR(12),/*VOLUME ENTRIES LIST @YL026UD*/
*                3 DSPEDEVT   CHAR(4), /*DEVICE CODE         @YL026UD*/
*                3 DSPEDVOL   CHAR(6), /*VOLUME SERIAL       @YL026UD*/
*                3 DSPEDSEQ   CHAR(2); /*FILE SEQUENCE       @YL026UD*/
*                                                                  0275
*        /*  GENERATION INDEX POINTER ENTRY (GIPE) FORMAT    @YL026UD*/
*        DCL 1 GIPEFORM       CHAR(16)  BDY(WORD)  BASED(CATPTR),  0276
*              2 GIPENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 GIPETTR      CHAR(3), /*ENTRY ADDRESS (TTR) @YL026UD*/
*              2 GIPETYPE     BIT(8),  /*GIPE ENTRY TYPE     @YL026UD*/
*              2 GIPEFLGS     BIT(8),  /*GDG OPTION FLAGS    @YL026UD*/
*                3 *          BIT(6),  /*  RESERVED FLAGS    @YL026UD*/
*                3 GIPEFDEL   BIT(1),  /*  'DELETE' OPTION   @YL026UD*/
*                3 GIPEFEMP   BIT(1),  /*  'EMPTY'  OPTION   @YL026UD*/
*              2 GIPEMCNT     FIXED(8),/*MAXIMUM GENERATION  @YL026UD*/
*              2 GIPECCNT     FIXED(15);/*CURRENT GENERATION @YL026UD*/
*                                                                  0276
*        /*  INDEX CONTROL ENTRY (ICE) FORMAT                @YL026UD*/
*        DCL 1 ICEFORM        CHAR(18)  BDY(WORD)  BASED(CATPTR),  0277
*              2 ICENAME      CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 ICELBLK      CHAR(3), /*LAST  BLOCK ADDR    @YL026UD*/
*              2 ICETYPE      BIT(8),  /*ICE ENTRY TYPE      @YL026UD*/
*              2 ICEFBLK      CHAR(3), /*FIRST BLOCK ADDR    @YL026UD*/
*              2 ICEACNT      FIXED(8),/*NUMBER OF ALIASES   @YL026UD*/
*              2 *            CHAR(2); /*RESERVED            @YL026UD*/
*                                                                  0277
*        /*  INDEX LINK ENTRY (ILE) FORMAT                   @YL026UD*/
*        DCL 1 ILEFORM        CHAR(12)  BDY(WORD)  BASED(CATPTR),  0278
*              2 ILENAME      CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 ILETTR       CHAR(3), /*LINK ADDRESS (TTR)  @YL026UD*/
*              2 ILETYPE      BIT(8);  /*ILE ENTRY TYPE      @YL026UD*/
*                                                                  0278
*        /*  INDEX POINTER ENTRY (IPE) FORMAT                @YL026UD*/
*        DCL 1 IPEFORM        CHAR(12)  BDY(WORD)  BASED(CATPTR),  0279
*              2 IPENAME      CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 IPETTR       CHAR(3), /*INDEX ADDRESS (TTR) @YL026UD*/
*              2 IPETYPE      BIT(8);  /*IPE ENTRY TYPE      @YL026UD*/
*                                                                  0279
*        /*  VOLUME CONTROL BLOCK (VCB) FORMAT               @YL026UD*/
*        DCL 1 VCBFORM1       CHAR(242) BDY(WORD)  BASED(CATPTR),  0280
*              2 VCBVOLCT     FIXED(15),/*NUMBER OF VOLUMES  @YL026UD*/
*              2 VCBVOLS(*)   CHAR(12),/*VOLUME INFORMATION  @YL026UD*/
*                3 VCBDEVT    CHAR(4), /*DEVICE CODE         @YL026UD*/
*                3 VCBDVOL    CHAR(6), /*VOLUME SERIAL       @YL026UD*/
*                3 VCBDSEQ    CHAR(2); /*FILE SEQUENCE       @YL026UD*/
*                                                                  0280
*        /*  VOLUME CONTROL BLOCK (VCB) CHAIN FORMAT         @Y30SSMK*/
*        DCL 1 VCBFORM2       CHAR(14)  BDY(WORD)  BASED(CATPTR),  0281
*              2 VCBZERO1     CHAR(10),/*ZERO FIELD          @YL026UD*/
*              2 VCBTTR       CHAR(3), /*CHAIN ADDRESS       @YL026UD*/
*              2 VCBZERO2     CHAR(1); /*ZERO FIELD          @YL026UD*/
*                                                                  0281
*        /*  VOLUME CONTROL BLOCK POINTER ENTRY (VCBPE)      @YL026UD*/
*        /*  FORMAT                                          @YL026UD*/
*        DCL 1 VCBPFORM       CHAR(14)  BDY(WORD)  BASED(CATPTR),  0282
*              2 VCBPNAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 VCBPTTR      CHAR(3), /*VOLUME CONTROL      @YL026UD*/
*                                      /*BLOCK ADDRESS (TTR) @YL026UD*/
*              2 VCBPTYPE     BIT(8),  /*VCBPE ENTRY TYPE    @YL026UD*/
*              2 VCBPZERO     FIXED(15);/*ZERO FIELD         @YL026UD*/
*                                                                  0282
*        /*  VOLUME INDEX CONTROL ENTRY (VICE) FORMAT        @YL026UD*/
*        DCL 1 VICEFORM       CHAR(22)  BDY(WORD)  BASED(CATPTR),  0283
*              2 VICENAME     CHAR(8), /*ENTRY NAME          @YL026UD*/
*              2 VICELBLK     CHAR(3), /*INDEX LAST  BLOCK   @YL026UD*/
*                                      /*ADDRESS (TTR)       @YL026UD*/
*              2 VICETYPE     BIT(8),  /*VICE ENTRY TYPE     @YL026UD*/
*              2 VICECBLK     CHAR(3), /*CATALOG LAST BLOCK  @YL026UD*/
*                                      /*ADDRESS (TTR)       @YL026UD*/
*              2 VICEZRO1     FIXED(8),/*ZERO FIELD          @YL026UD*/
*              2 VICEHOLE     CHAR(3), /*FIRST AVAILABLE     @YL026UD*/
*                                      /*BLOCK ADDRESS (TTR) @YL026UD*/
*              2 VICEZRO2     FIXED(8),/*ZERO FIELD          @YL026UD*/
*              2 *            CHAR(2); /*RESERVED            @YL026UD*/
*                                                                  0283
*                                                                  0283
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR THE PUSH-DOWN STACK -          @YL026UD*/
*        /*  USED IN SCANNING THE SYSCTLG DATA SET           @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0284
*        DCL LVLINDEX       FIXED(15); /*PUSH-DOWN STACK     @YL026UD*/
*                                      /*LEVEL INDEX         @YL026UD*/
*                                                                  0285
*        /*  PUSH-DOWN STACK                                 @YL026UD*/
*        DCL 1 LVLSTACK(22) CHAR(2)   BDY(HWORD),                  0285
*              2 LVLOFSET   FIXED(15); /*PROCESSING OFFSET   @YL026UD*/
*                                      /*WITHIN INDEX LEVEL  @YL026UD*/
*                                                                  0286
*        DCL LVLMAX   FIXED(15) CONSTANT(22);              /*@YL026UD*/
*                                      /*MAX INDEX LEVELS    @YL026UD*/
*                                                                  0287
*                                                                  0287
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR DATA SET NAME -                @YL026UD*/
*        /*  BUILT DURING SCAN OF SYSCTLG INDEX LEVELS       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0287
*        DCL 1 DSINFO       CHAR(52),  /*DSNAME INFORMATION  @YL026UD*/
*              2 DSNAME     CHAR(44),  /*DSNAME BEING BUILT  @YL026UD*/
*              2 *          CHAR(8);   /*DSNAME BUILD AREA   @YL026UD*/
*                                                                  0287
*        DCL DSNLEN         FIXED(15); /*DATASET NAME LENGTH @YL026UD*/
*                                                                  0288
*        DCL IXNLEN(22)     FIXED(15); /*SYSCTLG INDEX LEVEL @YL026UD*/
*                                      /*NAME LENGTH         @YL026UD*/
*                                                                  0290
*        DCL PERIOD         CHAR(1)   CONSTANT('.');       /*@YL026UD*/
*                                      /*'PERIOD' CONSTANT   @YL026UD*/
*                                                                  0291
*        DCL BLANK          CHAR(1)   CONSTANT(' ');       /*@YL026UD*/
*                                      /*'BLANK' CONSTANT    @YL026UD*/
*                                                                  0292
*        DCL TRUENAME CHAR(8);         /*ALIAS ENTRY 'TRUE'  @YL026UD*/
*                                      /*TRUE NAME SEGMENT   @YL026UD*/
*                                                                  0293
*        DCL TRUENLEN FIXED(15);       /*ALIAS 'TRUE' NAME   @YL026UD*/
*                                      /*SEGMENT LENGTH      @YL026UD*/
*                                                                  0294
*        DCL TRUEDSN  CHAR(44);        /*ALIAS ENTRY 'TRUE'  @YL026UD*/
*                                      /*DATA SET NAME       @YL026UD*/
*                                                                  0295
*        DCL ALIASDSN CHAR(44);        /*ALIAS ENTRY 'ALIAS' @YL026UD*/
*                                      /*DATA SET NAME       @YL026UD*/
*                                                                  0296
*        DCL DSCBTTR  CHAR(4);         /*DSCB RELATIVE TRACK @YL026UD*/
*                                      /*ADDRESS (TTR)       @YL026UD*/
*                                                                  0297
*                                                                  0297
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR ACQUIRING STORAGE FOR          @YL026UD*/
*        /*  VSAM CATALOG PARAMETER LISTS -                  @YL026UD*/
*        /*  CPL, FVT, AND 4 FPLS                            @YL026UD*/
*        /*  (DEVTYPE, FILESEQ, ENTYPE, CATVOL)              @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0297
*        DCL CATPLPTR PTR(31);         /*VSAM PARM LISTS PTR @YL026UD*/
*        DCL CATPLLEN FIXED(31);       /*VSAM PARM LISTS LEN @YL026UD*/
*        DCL CATPL    CHAR(256)  BASED(CATPLPTR);          /*@YL026UD*/
*                                      /*VSAM PARM LISTS     @YL026UD*/
*                                                                  0300
*        /*  LENGTHS OF THE VSAM CATALOG PARAMETER LISTS     @YL026UD*/
*        DCL CPLLEN   FIXED(15);       /*CATALOG PARM LIST   @YL026UD*/
*        DCL FVTLEN   FIXED(15);       /*FIELD VECTOR TABLE  @YL026UD*/
*        DCL FPLLEN   FIXED(15);       /*FIELD PARM LIST     @YL026UD*/
*                                                                  0302
*        /*  ADDRESSES OF THE VSAM CATALOG PARAMETER LISTS   @YL026UD*/
*        DCL DEVTFPL  PTR(31);         /*DEVICE TYPE    FPL  @YL026UD*/
*        DCL FSEQFPL  PTR(31);         /*FILE SEQUENCE  FPL  @YL026UD*/
*        DCL ENTYPFPL PTR(31);         /*ENTRY TYPE     FPL  @YL026UD*/
*        DCL CATVLFPL PTR(31);         /*CATALOG VOLUME FPL  @YL026UD*/
*                                                                  0306
*                                                                  0306
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR EXTRACTING THE VOLUME          @YL026UD*/
*        /*  IDENTIFICATION INFORMATION FROM THE DSPE AND    @YL026UD*/
*        /*  VCB SYSCTLG ENTRIES -                           @YL026UD*/
*        /*  DEVICE CODE, VOLUME SERIAL, DATA SET SEQUENCE   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0307
*        /* DEVICE CODE LIST                                 @YL026UD*/
*        DCL 1 DEVTLIST(*)              BDY(HWORD)  BASED(DEVTPTR),
*              2 DEVTUNIT     CHAR(8), /*DEVICE UNIT NUMBER  @YL026UD*/
*              2 DEVTCODE     CHAR(4); /*DEVICE CODE NUMBER  @YL026UD*/
*                                                                  0307
*        /* VOLUME SERIAL NUMBER LIST                        @YL026UD*/
*        DCL 1 VOLLIST        BDY(HWORD)  BASED(VOLPTR),   /*@YL026UD*/
*              2 VOLSTLEN     FIXED(15),/*VOL SER LIST LEN   @YL026UD*/
*              2 VOLSERS(*)   CHAR(8)   BDY(HWORD),        /*@YL026UD*/
*                3 VOLZERO    FIXED(15),/*ZERO FIELD         @YL026UD*/
*                3 VOLSER     CHAR(6); /*VOLUME SERIAL       @YL026UD*/
*                                                                  0308
*        /* DATA SET SEQUENCE NUMBER LIST                    @YL026UD*/
*        DCL 1 FILELIST(*)    BDY(HWORD)  BASED(FILEPTR),  /*@YL026UD*/
*              2 FILESEQ      CHAR(2); /*DATA SET SEQUENCE   @YL026UD*/
*                                                                  0309
*        /*  VOLUME INFORMATION AREA (ACQUIRED)              @YL026UD*/
*        DCL VINFOPTR PTR(31);         /*VOL INFO AREA PTR   @YL026UD*/
*        DCL VINFOLEN FIXED(31);       /*VOL INFO AREA LEN   @YL026UD*/
*                                                                  0311
*        /*  DEVICE CODE LIST                                @YL026UD*/
*        DCL DEVTPTR  PTR(31);         /*DEV CODE LIST PTR   @YL026UD*/
*        DCL DEVTLEN  FIXED(15);       /*DEV CODE LIST LEN   @YL026UD*/
*                                                                  0313
*        /*  VOLUME SERIAL NUMBER LIST                       @YL026UD*/
*        DCL VOLPTR   PTR(31);         /*VOL SER LIST PTR    @YL026UD*/
*        DCL VOLLEN   FIXED(15);       /*VOL SER LIST LEN    @YL026UD*/
*                                                                  0315
*        /*  DATA SET SEQUENCE NUMBER LIST                   @YL026UD*/
*        DCL FILEPTR  PTR(31);         /*FILE SEQ LIST PTR   @YL026UD*/
*        DCL FILELEN  FIXED(15);       /*FILE SEQ LIST LEN   @YL026UD*/
*                                                                  0317
*        DCL VOLCNT   FIXED(15);       /*DATA SET VOLUME CNT @YL026UD*/
*                                                                  0318
*        DCL VLISTMAX FIXED(15)  CONSTANT(256);            /*@YL026UD*/
*                                      /*VOLUME INFORMATION  @YL026UD*/
*                                      /*MAXIMUM LIST LENGTH @YL026UD*/
*                                                                  0320
*                                                                  0320
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR EXTRACTING THE VOLUME          @YL026UD*/
*        /*  IDENTIFICATION INFORMATION FROM THE VSAM        @YL026UD*/
*        /*  CATALOG ENTRIES                                 @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0320
*        /*  ENTRY TYPE (REFERENCED BY ENTRY TYPE FPL)       @YL026UD*/
*        DCL ENTYPE   CHAR(1)   BASED;                     /*@YL026UD*/
*                                                                  0320
*        /*  DEVICE TYPE, VOLUME SERIAL, DATA SET SEQUENCE   @YL026UD*/
*        /*  NUMBER (REFERENCED BY CATALOG VOLUME FPL)       @YL026UD*/
*        DCL 1 CATVLIST(*)  BASED,                                 0321
*              2 CVRELREP CHAR(2),     /*RELATIVE REPTITION  @YL026UD*/
*                                      /*NUMBER      (UNUSED)@YL026UD*/
*              2 CVDEVTYP CHAR(4),     /*DEVICE TYPE   (USED)@YL026UD*/
*              2 CVVOLSER CHAR(6),     /*VOLUME SERIAL (USED)@YL026UD*/
*              2 CVFSEQ   CHAR(2),     /*FILE SEQUENCE (USED)@YL026UD*/
*              2 CVVOLFLG CHAR(1);     /*VOLUME FLAG (UNUSED)@YL026UD*/
*                                                                  0321
*        DCL CATVLCNT FIXED(15);       /*CATALOGED VOL COUNT @YL026UD*/
*                                                                  0322
*        /*  DECLARATIONS FOR CATALOG WORKAREA               @YL026UD*/
*        /*  (REQUIRED FOR VSAM 'LOCATE' REQUEST)            @YL026UD*/
*        DCL 1 WKAREA     BASED(WKAPTR),                           0323
*              2 WKALEN   FIXED(15),   /*WORKAREA LENGTH     @YL026UD*/
*              2 WKAREQD  FIXED(15),   /*WORKAREA REQUIRED   @YL026UD*/
*              2 WKADATA  CHAR(*);     /*WORKAREA DATA       @YL026UD*/
*                                                                  0323
*        DCL WKAPTR   PTR(31);         /*WORKAREA POINTER    @Y30SSMK*/
*                                                                  0324
*        DCL WKASIZE  FIXED(31);       /*CURRENT WORKAREA    @YL026UD*/
*                                      /*SIZE                @YL026UD*/
*                                                                  0326
*        DCL INITWKA  FIXED(31) CONSTANT(512);             /*@YL026UD*/
*                                      /*INITIAL WORKAREA    @YL026UD*/
*                                      /*SIZE                @YL026UD*/
*                                                                  0327
*                                                                  0327
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR SYSCTLG INDEX BLOCK            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0327
*        /*  SYSCTLG INDEX BLOCK STRUCTURE                   @YL026UD*/
*        /*  (CONTAINING SYSCTLG BLOCKS AT EACH INDEX LEVEL) @YL026UD*/
*        DCL BLOCK(*) CHAR(256) BDY(WORD) BASED(BLKLVPTR); /*@YL026UD*/
*                                                                  0327
*        DCL BLKLVPTR PTR(31);         /*BLOCK STRUCTURE PTR @YL026UD*/
*                                                                  0328
*        DCL BLKLVLEN FIXED(31);       /*BLOCK STRUCTURE LEN @YL026UD*/
*                                                                  0329
*        DCL BLOCKCNT FIXED(15);       /*SYSCTLG BLOCK       @YL026UD*/
*                                      /*COUNT FIELD         @YL026UD*/
*                                                                  0331
*        DCL BLOCKPTR PTR(31);         /*INDIVIDUAL INDEX    @YL026UD*/
*                                      /*BLOCK PTR           @YL026UD*/
*                                                                  0332
*        DCL BLKREAD  CHAR(256)  BASED(IIOCSPTR->IOCDAD);  /*@YL026UD*/
*                                      /*BLOCK READ BY       @YL026UD*/
*                                      /*'UGET' MACRO        @YL026UD*/
*                                                                  0333
*        DCL BLOCKTTR CHAR(4) BDY(WORD);/*BLOCK RELATIVE     @YL026UD*/
*                                      /*TRACK ADDRESS       @YL026UD*/
*                                                                  0334
*        DCL FIRSTTTR CHAR(4)   INIT('00000100'X);         /*@YL026UD*/
*                                      /*TTR OF FIRST        @YL026UD*/
*                                      /*SYSCTLG BLOCK       @YL026UD*/
*                                      /*(THE VOLUME INDEX)  @YL026UD*/
*                                                                  0335
*                                                                  0335
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR TEXT PROCESSOR                 @YL026UD*/
*        /*  'PAGE CONTROL ARGUMENT LIST' -                  @YL026UD*/
*        /*  USED TO ESTABLISH SUBTITLE LINE                 @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0335
*        DCL SUBTITLE CHAR(120);       /*SUBTITLE LINE AREA  @YL026UD*/
*                                                                  0335
*        /*  PAGE CONTROL ARGUMENT LIST                      @YL026UD*/
*        DCL 1 PCARGLST   BDY(WORD),                               0336
*              2 PCMTLP   PTR(31),     /*MAIN TITLE LINE PTR @YL026UD*/
*              2 PCSTLP   PTR(31),     /*SUB  TITLE LINE PTR @YL026UD*/
*              2 PCFLP    PTR(31),     /*FOOTING    LINE PTR @YL026UD*/
*              2 PCPCP    PTR(31),     /*PRINT CHAIN     PTR @YL026UD*/
*              2 PCPNL    FIXED(15),   /*MAIN TITLE PAGE LOC @YL026UD*/
*              2 PCPTL    FIXED(15),   /*MAIN TITLE TIME LOC @YL026UD*/
*              2 PCPDL    FIXED(15),   /*MAIN TITLE DATE LOC @YL026UD*/
*              2 PCMTLC   FIXED(15),   /*MAIN TITLE LINE CNT @YL026UD*/
*              2 PCSTLC   FIXED(15),   /*SUB  TITLE LINE CNT @YL026UD*/
*              2 PCFLC    FIXED(15),   /*FOOTING    LINE CNT @YL026UD*/
*              2 PCLW     FIXED(15),   /*SYSPRINT LINE WIDTH @YL026UD*/
*              2 PCPD     FIXED(15),   /*SYSPRINT PAGE DEPTH @YL026UD*/
*              2 PCDSC    FIXED(15);   /*DEFAULT SPACING     @YL026UD*/
*                                                                  0336
*                                                                  0336
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  MISCELLANEOUS DECLARATIONS                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0337
*        /*  COUNTS OF ENTRIES CONVERTED OR UPDATED          @YL026UD*/
*        DCL CNVTCNT  FIXED(31);       /*CONVERSION COUNT    @YL026UD*/
*        DCL UPDTCNT  FIXED(31);       /*UPDATE     COUNT    @YL026UD*/
*                                                                  0338
*        DCL ILEENAME CHAR(8)   INIT('FFFFFFFFFFFFFFFF'X); /*@YL026UD*/
*                                      /*'ILE' ENTRY NAME    @YL026UD*/
*                                                                  0340
*        DCL ZEROTTR  CHAR(3)   INIT('000000'X);           /*@YL026UD*/
*                                      /*ZERO TTR FOR 'ILE'  @YL026UD*/
*                                      /*COMPARISON          @YL026UD*/
*                                                                  0341
*        DCL ALLONES  CHAR(4)   INIT('FFFFFFFF'X);         /*@YL026UD*/
*                                      /*CONSTANT FOR        @YL026UD*/
*                                      /*COMPLEMENTING THE   @YL026UD*/
*                                      /*G0000V00 GENERATION @YL026UD*/
*                                      /*NUMBER              @YL026UD*/
*                                                                  0342
*        DCL INDEX    FIXED(15);       /*MISCELLANEOUS INDEX @YL026UD*/
*                                                                  0342
*        /*  'CVPE' ENTRY CVOL PROCESSING LOOP INDEXES       @YL026UD*/
*        DCL CVENINDX FIXED(15);       /*CVOL NAME   INDEX   @YL026UD*/
*        DCL CVEVINDX FIXED(15);       /*CVOL VOLUME INDEX   @YL026UD*/
*                                                                  0344
*        DCL CVPEVOL  CHAR(6);         /*CVPE ENTRY VOLUME   @YL026UD*/
*                                      /*SERIAL NUMBER       @YL026UD*/
*                                                                  0346
*        DCL DSPEINDX FIXED(15);       /*'DSPE' ENTRY        @YL026UD*/
*                                      /*PROCESSING INDEX    @YL026UD*/
*                                                                  0347
*        /*'GIPE' ENTRY TO 'GDG BASE' ENTRY INFORMATION      @YL026UD*/
*        DCL GDGLIMIT FIXED(8);        /*GDG BASE MAXIMUM    @YL026UD*/
*                                      /*GENERATION COUNT    @YL026UD*/
*        DCL GDGATTR  FIXED(8);        /*GDG BASE ATTRIBUTES @YL026UD*/
*        DCL GDGEMPTY BIT(8)  CONSTANT('80'X);             /*@VS04383*/
*                                      /*GDG BASE 'EMPTY'    @YL026UD*/
*                                      /*ATTRIBUTE           @YL026UD*/
*        DCL GDGDELET BIT(8)  CONSTANT('40'X);             /*@VS04383*/
*                                      /*GDG BASE 'DELETE'   @YL026UD*/
*                                      /*ATTRIBUTE           @YL026UD*/
*                                                                  0351
*        /*'VCBPE' ENTRY AND 'VCB' PROCESSING INFORMATION    @YL026UD*/
*        DCL VCBINDEX FIXED(15);       /*VCB PROCESSING INDEX@YL026UD*/
*                                                                  0351
*        DCL VCBDONE  BIT(1);          /*VCB PROCESSING FLAG @YL026UD*/
*                                                                  0352
*        DCL VCBVOLIM FIXED(15);       /*VCB VOLUME          @YL026UD*/
*                                      /*LOOP LIMIT          @YL026UD*/
*                                                                  0354
*        DCL VCBVOLMX FIXED(15) CONSTANT(20);              /*@YL026UD*/
*                                      /*VCB MAXIMUM         @YL026UD*/
*                                      /*VOLUME COUNT        @YL026UD*/
*                                                                  0355
*        /*  CONVERSION PROCESSING FLAGS                     @YL026UD*/
*        DCL ALIASFLG BIT(1);          /*'ALIAS PROCESSING'    FLAG  */
*        DCL TRUEFLG  BIT(1);          /*'TRUENAME PROCESSING' FLAG  */
*        DCL CVPEFLAG BIT(1);          /*'CVPE PROCESSING'     FLAG  */
*        DCL ENDFLAG  BIT(1);          /*'PROCESSING COMPLETE' FLAG  */
*        DCL FOUNDFLG BIT(1);          /*'ENTRY-TYPE FOUND'    FLAG  */
*        DCL GDGFLAG  BIT(1);          /*'GDG BASE PROCESSING' FLAG  */
*        DCL G0V0FLAG BIT(1);          /*'G0000V00 PROCESSING' FLAG  */
*                                                                  0361
*        DCL VOLCONST CHAR(6)   CONSTANT('VOLUME');        /*@YL026UD*/
*                                      /*'VOLUME' CONSTANT   @YL026UD*/
*                                                                  0363
*        DCL VOLLVL   FIXED(15) CONSTANT(1);               /*@Y30SSMK*/
*                                      /*VOLUME LEVEL INDEX  @Y30SSMK*/
*                                                                  0364
*        /*  MESSAGE TEXT ('CVOL ENTRY NOT CONVERTED' MSG)   @YL026UD*/
*        DCL 1 CVPETEXT   CHAR(14),    /*MESSAGE INSERT TEXT @YL026UD*/
*              2 CVPTXTNM CHAR(8),     /*'CVPE' ENTRY NAME   @YL026UD*/
*              2 CVPTXTVL CHAR(6);     /*'CVPE' ENTRY VOLUME @YL026UD*/
*                                                                  0364
*                                                                  0364
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR SYMBOLIC DUMP LISTS            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0365
*        /*  DUMP LIST FOR INPUT SYSCTLG BLOCK               @YL026UD*/
*        DCL DLISTBLK CHAR(49)   BDY(WORD);                /*@YL026UD*/
*                                                                  0365
*        /*  DUMP LIST FOR ENTRY VOLUME INFORMATION          @YL026UD*/
*        DCL DLISTVIL CHAR(97)   BDY(WORD);                /*@YL026UD*/
*                                                                  0366
*        /*  DUMP LIST FOR CPL/FVT/FPL PARM LISTS            @YL026UD*/
*        DCL DLISTCPL CHAR(129)  BDY(WORD);                /*@YL026UD*/
*        OLDERID2 = NEWERID2;                                      0368
         L     @07,@PC00001                                        0368
         L     @07,GDTTR2(,@07)                                    0368
         MVC   @TS00001(95),NEWERID2(@07)                          0368
         MVC   OLDERID2(95,@07),@TS00001                           0368
*        NEWID2 = 'CCCV';                                  /*@YL026UD*/
*                                                                  0369
         MVC   NEWID2(4,@07),@CC01103                              0369
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN REQUIRED STORAGE FOR PROCESSING THE      @YL026UD*/
*        /*  CATALOG CONVERSION                              @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE CATALOG CONVERSION SUBTITLE LINE @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE CONVERSION PROCESSING FLAGS      @YL026UD*/
*        /*                                                  @Y30SSMK*/
*        /*  TERMINATE PROCESSING IF STORAGE COULD NOT BE    @Y30SSMK*/
*        /*  OBTAINED.                                       @Y30SSMK*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0370
*        CALL CNVTINIT;                                    /*@YL026UD*/
*                                                                  0370
         BAL   @14,CNVTINIT                                        0370
*        IF LASTCOND = LASTCC12                                    0371
*          THEN                                                    0371
         L     @07,@PC00001+8                                      0371
         CLC   LASTCOND(2,@07),@CH00037                            0371
         BE    @RT00371                                            0371
*            RETURN;                                       /*@YL026UD*/
*                                                                  0372
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN THE FIRST-LEVEL SYSCTLG DATA SET INDEX   @YL026UD*/
*        /*  (THE VOLUME INDEX) TO BEGIN OS CATALOG SCAN.    @Y30SSMK*/
*        /*  TERMINATE IF THE FIRST-LEVEL SYSCTLG DATA SET   @Y30SSMK*/
*        /*  INDEX COULD NOT BE OBTAINED.                    @Y30SSMK*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0373
*        CALL VOLINDEX;                                    /*@YL026UD*/
*                                                                  0373
         BAL   @14,VOLINDEX                                        0373
*        IF LASTCOND = LASTCC12                                    0374
*          THEN                                                    0374
         L     @07,@PC00001+8                                      0374
         CLC   LASTCOND(2,@07),@CH00037                            0374
         BNE   @RF00374                                            0374
*            DO;                                           /*@YL026UD*/
*              ENDFLAG = ON;                               /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0376
*              RETURN;                                     /*@YL026UD*/
@EL00002 DS    0H                                                  0377
@EF00002 DS    0H                                                  0377
@ER00002 LM    @14,@12,@SA00002                                    0377
         BR    @14                                                 0377
*            END;                                          /*@YL026UD*/
*                                                                  0378
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  MAIN SYSCTLG PROCESSING LOOP -                  @YL026UD*/
*        /*  SCAN THE SYSCTLG DATA SET, CONVERTING ENTRIES   @YL026UD*/
*        /*  UNTIL THE ENTIRE OS CATALOG HAS BEEN SCANNED    @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0379
*SCANLOOP:                                                         0379
*        DO WHILE (ENDFLAG = OFF);                         /*@YL026UD*/
*                                                                  0379
@RF00374 DS    0H                                                  0379
SCANLOOP B     @DE00379                                            0379
@DL00379 DS    0H                                                  0380
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  RESET 'ENTRY-TYPE FOUND' FLAG -               @YL026UD*/
*          /*  THIS FLAG PREVENTS UNCONTROLLED LOOPING       @YL026UD*/
*          /*  IF THE SYSCTLG DATA SET IS INVALID            @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0380
*          FOUNDFLG = OFF;                                 /*@YL026UD*/
*                                                                  0380
         NI    FOUNDFLG,B'01111111'                                0380
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS AN 'AE' -       @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  AN ALIAS ENTRY ('AE') CONTAINS AN ALTERNATE   @YL026UD*/
*          /*  NAME FOR THE HIGH-LEVEL QUALIFIER OF A        @YL026UD*/
*          /*  DATA SET NAME                                 @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  AN ALIAS ENTRY CAN APPEAR ONLY WITHIN THE     @YL026UD*/
*          /*  VOLUME INDEX (THE FIRST-LEVEL SYSCTLG INDEX)  @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  AN ALIAS ENTRY IS CONVERTED INTO AN ALIAS     @YL026UD*/
*          /*  ENTRY (ENTRY TYPE = 'X') IN THE VSAM CATALOG  @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0381
*          IF CATETYPE = TYPEAE & ENDFLAG = OFF                    0381
*            THEN                                                  0381
         CLC   CATETYPE(1,CATPTR),TYPEAE                           0381
         BNE   @RF00381                                            0381
         TM    ENDFLAG,B'10000000'                                 0381
         BNZ   @RF00381                                            0381
*AE:           DO;                                         /*@YL026UD*/
AE       DS    0H                                                  0383
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  SYSCTLG ENTRY IS AN 'AE' -              @YL026UD*/
*                /*  PROCESS THE ALIAS ENTRY                 @YL026UD*/
*                /*  TERMINATE IF ANY ERRORS ARE ENCOUNTERED @Y30SSMK*/
*                /*  WHILE PROCESSING THE 'AE' ENTRY.        @Y30SSMK*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  0383
*                FOUNDFLG = ON;                            /*@YL026UD*/
*                                                                  0383
         OI    FOUNDFLG,B'10000000'                                0383
*                CALL AEPROC;                              /*@YL026UD*/
*                                                                  0384
         BAL   @14,AEPROC                                          0384
*                IF LASTCOND = LASTCC12                            0385
*                  THEN                                            0385
         L     @07,@PC00001+8                                      0385
         CLC   LASTCOND(2,@07),@CH00037                            0385
         BNE   @RF00385                                            0385
*                    DO;                                   /*@YL026UD*/
*                      ENDFLAG = ON;                       /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0387
*                      RETURN;                             /*@YL026UD*/
         B     @EL00002                                            0388
*                    END;                                  /*@YL026UD*/
*                                                                  0389
*              END AE;                                     /*@YL026UD*/
*                                                                  0390
*                                                                  0390
@RF00385 DS    0H                                                  0391
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS AN 'IPE' -      @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  AN INDEX POINTER ENTRY ('IPE') POINTS TO A    @YL026UD*/
*          /*  LOWER-LEVEL INDEX OF A DATA SET NAME          @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0391
*          IF CATETYPE = TYPEIPE & CATENAME ^= ILEENAME            0391
*                           & ENDFLAG = OFF                        0391
*            THEN                                                  0391
@RF00381 CLC   CATETYPE(1,CATPTR),TYPEIPE                          0391
         BNE   @RF00391                                            0391
         CLC   CATENAME(8,CATPTR),ILEENAME                         0391
         BE    @RF00391                                            0391
         TM    ENDFLAG,B'10000000'                                 0391
         BNZ   @RF00391                                            0391
*IPE:          DO;                                         /*@YL026UD*/
IPE      DS    0H                                                  0393
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  SYSCTLG ENTRY IS AN 'IPE' -             @YL026UD*/
*                /*  CONTINUE SCANNING AT LOWER INDEX LEVEL  @YL026UD*/
*                /*  TERMINATE IF ANY ERRORS ARE ENCOUNTERED @Y30SSMK*/
*                /*  IN THE CHANGE FROM ONE INDEX LEVEL TO   @Y30SSMK*/
*                /*  THE NEXT LOWER INDEX LEVEL.             @Y30SSMK*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  0393
*                FOUNDFLG = ON;                            /*@YL026UD*/
*                                                                  0393
         OI    FOUNDFLG,B'10000000'                                0393
*                CALL PUSHDOWN;                            /*@YL026UD*/
*                                                                  0394
         BAL   @14,PUSHDOWN                                        0394
*                IF LASTCOND = LASTCC12                            0395
*                  THEN                                            0395
         L     @07,@PC00001+8                                      0395
         CLC   LASTCOND(2,@07),@CH00037                            0395
         BNE   @RF00395                                            0395
*                    DO;                                   /*@YL026UD*/
*                      ENDFLAG = ON;                       /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0397
*                      RETURN;                             /*@YL026UD*/
         B     @EL00002                                            0398
*                    END;                                  /*@YL026UD*/
*                                                                  0399
*              END IPE;                                    /*@YL026UD*/
*                                                                  0400
*                                                                  0400
@RF00395 DS    0H                                                  0401
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS AN 'ILE' -      @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  AN INDEX LINK ENTRY ('ILE') IS ALWAYS THE     @YL026UD*/
*          /*  LAST ENTRY IN ANY INDEX BLOCK.  IT IS USED    @YL026UD*/
*          /*  TO LINK BLOCKS OF ONE INDEX INTO A CHAIN      @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0401
*          IF CATETYPE = TYPEILE & CATENAME = ILEENAME             0401
*                           & ENDFLAG = OFF                        0401
*            THEN                                                  0401
@RF00391 CLC   CATETYPE(1,CATPTR),TYPEILE                          0401
         BNE   @RF00401                                            0401
         CLC   CATENAME(8,CATPTR),ILEENAME                         0401
         BNE   @RF00401                                            0401
         TM    ENDFLAG,B'10000000'                                 0401
         BNZ   @RF00401                                            0401
*ILE:          DO;                                         /*@YL026UD*/
ILE      DS    0H                                                  0403
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  SYSCTLG ENTRY IS AN 'ILE' -             @YL026UD*/
*                /*  PROCESS THE INDEX LINK ENTRY            @YL026UD*/
*                /*  TERMINATE IF ANY ERRORS ARE ENCOUNTERED @Y30SSMK*/
*                /*  WHILE PROCESSING THE 'ILE' ENTRY.       @Y30SSMK*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  0403
*                FOUNDFLG = ON;                            /*@YL026UD*/
*                                                                  0403
         OI    FOUNDFLG,B'10000000'                                0403
*                CALL ILEPROC;                             /*@YL026UD*/
*                                                                  0404
         BAL   @14,ILEPROC                                         0404
*                IF LASTCOND = LASTCC12                            0405
*                  THEN                                            0405
         L     @07,@PC00001+8                                      0405
         CLC   LASTCOND(2,@07),@CH00037                            0405
         BNE   @RF00405                                            0405
*                    DO;                                   /*@YL026UD*/
*                      ENDFLAG = ON;                       /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0407
*                      RETURN;                             /*@YL026UD*/
         B     @EL00002                                            0408
*                    END;                                  /*@YL026UD*/
*                                                                  0409
*              END ILE;                                    /*@YL026UD*/
*                                                                  0410
*                                                                  0410
@RF00405 DS    0H                                                  0411
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'DSPE' -      @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A DATA SET POINTER ENTRY ('DSPE') CONTAINS    @YL026UD*/
*          /*  SIMPLE NAME OS A DATA SET AND FROM ONE TO     @YL026UD*/
*          /*  FIVE 12-BYTE FIELDS THAT EACH IDENTIFY A      @YL026UD*/
*          /*  VOLUME ON WHICH THE NAMED DATA SET RESIDES    @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A DATA SET POINTER ENTRY IS CONVERTED INTO    @YL026UD*/
*          /*  A NONVSAM ENTRY (ENTRY TYPE = 'A'), OR        @YL026UD*/
*          /*  AN ALIAS ENTRY (ENTRY TYPE = 'X' - IF THE     @YL026UD*/
*          /*  'ALIAS PROCESSING' FLAG IS TURNED ON)         @YL026UD*/
*          /*  IN THE VSAM CATALOG                           @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0411
*DSPE:     DO INDEX = 1 TO DIM(TYPEDSPE);                  /*@YL026UD*/
*                                                                  0411
@RF00401 DS    0H                                                  0411
DSPE     LA    INDEX,1                                             0411
@DL00411 DS    0H                                                  0412
*            IF CATETYPE = TYPEDSPE(INDEX) & ENDFLAG = OFF         0412
*              THEN                                                0412
         LA    @05,TYPEDSPE-1(INDEX)                               0412
         CLC   CATETYPE(1,CATPTR),0(@05)                           0412
         BNE   @RF00412                                            0412
         TM    ENDFLAG,B'10000000'                                 0412
         BNZ   @RF00412                                            0412
*                DO;                                       /*@YL026UD*/
*                  /**************************************************/
*                  /*                                        @YL026UD*/
*                  /*  SYSCTLG ENTRY IS A 'DSPE' -           @YL026UD*/
*                  /*  PROCESS THE DATA SET POINTER ENTRY    @YL026UD*/
*                  /*  TERMINATE IF A TERMINAL ERROR IS      @Y30SSMK*/
*                  /*  ENCOUNTERED WHILE PROCESSING THE      @Y30SSMK*/
*                  /*  'DSPE' ENTRY.                         @Y30SSMK*/
*                  /*                                        @YL026UD*/
*                  /**************************************************/
*                                                                  0414
*                  FOUNDFLG = ON;                          /*@YL026UD*/
*                                                                  0414
         OI    FOUNDFLG,B'10000000'                                0414
*                  CALL DSPEPROC;                          /*@YL026UD*/
*                                                                  0415
         BAL   @14,DSPEPROC                                        0415
*                  IF LASTCOND = LASTCC12                          0416
*                    THEN                                          0416
         L     @05,@PC00001+8                                      0416
         CLC   LASTCOND(2,@05),@CH00037                            0416
         BNE   @RF00416                                            0416
*                      DO;                                 /*@VS04383*/
*                      ENDFLAG = ON;                       /*@VS04383*/
         OI    ENDFLAG,B'10000000'                                 0418
*                      RETURN;                             /*@VS04383*/
         B     @EL00002                                            0419
*                      END;                                /*@VS04383*/
*                                                                  0420
*                END;                                      /*@YL026UD*/
*                                                                  0421
@RF00416 DS    0H                                                  0422
*          END DSPE;                                       /*@YL026UD*/
*                                                                  0422
*                                                                  0422
@RF00412 AL    INDEX,@CF00215                                      0422
         C     INDEX,@CF00426                                      0422
         BNH   @DL00411                                            0422
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'VCBPE' -     @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A VOLUME CONTROL BLOCK POINTER ENTRY ('VCBPE')        */
*          /*  CONTAINS THE SIMPLE NAME OF A DATA SET WHICH  @YL026UD*/
*          /*  RESIDES ON MORE THAN FIVE VOLUMES             @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  THE 'VCBPE' CONTAINS A POINTER TO A VOLUME    @YL026UD*/
*          /*  CONTROL BLOCK ('VCB') CONTAINING THE VOLUME   @YL026UD*/
*          /*  LIST FOR THE DATA SET THAT RESIDES ON MORE    @YL026UD*/
*          /*  THAN FIVE VOLUMES                             @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A VOLUME CONTROL BLOCK POINTER ENTRY IS       @YL026UD*/
*          /*  CONVERTED INTO A NONVSAM ENTRY                @YL026UD*/
*          /*  (ENTRY TYPE = 'A'), OR AN ALIAS ENTRY         @YL026UD*/
*          /*  (ENTRY TYPE = 'X' - IF THE 'ALIAS PROCESSING' @YL026UD*/
*          /*  FLAG IS TURNED ON) IN THE VSAM CATALOG        @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0423
*          IF CATETYPE = TYPEVCBP & ENDFLAG = OFF                  0423
*            THEN                                                  0423
         CLC   CATETYPE(1,CATPTR),TYPEVCBP                         0423
         BNE   @RF00423                                            0423
         TM    ENDFLAG,B'10000000'                                 0423
         BNZ   @RF00423                                            0423
*VCBPE:        DO;                                         /*@YL026UD*/
VCBPE    DS    0H                                                  0425
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  SYSCTLG ENTRY IS A 'VCBPE' -            @YL026UD*/
*                /*  PROCESS THE VOLUME CONTROL BLOCK        @YL026UD*/
*                /*  POINTER ENTRY AND THE CORRESPONDING     @YL026UD*/
*                /*  VOLUME CONTROL BLOCK                    @YL026UD*/
*                /*  TERMINATE IF ANY TERMINAL ERRORS ARE    @Y30SSMK*/
*                /*  ENCOUNTERED WHILE PROCESSING THE        @Y30SSMK*/
*                /*  'VCBPE' ENTRY.                          @Y30SSMK*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  0425
*                FOUNDFLG = ON;                            /*@YL026UD*/
*                                                                  0425
         OI    FOUNDFLG,B'10000000'                                0425
*                CALL VCBPPROC;                            /*@YL026UD*/
*                                                                  0426
         BAL   @14,VCBPPROC                                        0426
*                IF LASTCOND = LASTCC12                            0427
*                  THEN                                            0427
         L     @07,@PC00001+8                                      0427
         CLC   LASTCOND(2,@07),@CH00037                            0427
         BNE   @RF00427                                            0427
*                    DO;                                   /*@YL026UD*/
*                      ENDFLAG = ON;                       /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0429
*                      RETURN;                             /*@YL026UD*/
         B     @EL00002                                            0430
*                    END;                                  /*@YL026UD*/
*                                                                  0431
*              END VCBPE;                                  /*@YL026UD*/
*                                                                  0432
*                                                                  0432
@RF00427 DS    0H                                                  0433
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'GIPE' -      @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A GENERATION INDEX POINTER ENTRY ('GIPE')     @YL026UD*/
*          /*  POINTS TO THE LOWEST INDEX FOR A GENERATION   @YL026UD*/
*          /*  DATA GROUP (THE GENERATION INDEX)             @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  THE 'GIPE' CORRESPONDS TO THE SIMPLE NAME     @YL026UD*/
*          /*  USED IN THE RELATIVE NAME FOR A GDG DATA SET  @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A GENERATION INDEX POINTER ENTRY IS CONVERTED @YL026UD*/
*          /*  INTO A GDG BASE ENTRY (ENTRY TYPE = 'B')      @YL026UD*/
*          /*  IN THE VSAM CATALOG                           @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0433
*          IF CATETYPE = TYPEGIPE & ENDFLAG = OFF                  0433
*            THEN                                                  0433
@RF00423 CLC   CATETYPE(1,CATPTR),TYPEGIPE                         0433
         BNE   @RF00433                                            0433
         TM    ENDFLAG,B'10000000'                                 0433
         BNZ   @RF00433                                            0433
*GIPE:         DO;                                         /*@YL026UD*/
GIPE     DS    0H                                                  0435
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  SYSCTLG ENTRY IS A 'GIPE' -             @YL026UD*/
*                /*  PROCESS THE GENERATION INDEX POINTER    @YL026UD*/
*                /*  ENTRY                                   @YL026UD*/
*                /*  TERMINATE IF ANY TERMINAL ERRORS ARE    @Y30SSMK*/
*                /*  ENCOUNTERED WHILE PROCESSING THE 'GIPE' @Y30SSMK*/
*                /*  ENTRY.                                  @Y30SSMK*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  0435
*                FOUNDFLG = ON;                            /*@YL026UD*/
*                                                                  0435
         OI    FOUNDFLG,B'10000000'                                0435
*                CALL GIPEPROC;                            /*@YL026UD*/
*                                                                  0436
         BAL   @14,GIPEPROC                                        0436
*                IF LASTCOND = LASTCC12                            0437
*                  THEN                                            0437
         L     @07,@PC00001+8                                      0437
         CLC   LASTCOND(2,@07),@CH00037                            0437
         BNE   @RF00437                                            0437
*                    DO;                                   /*@YL026UD*/
*                      ENDFLAG = ON;                       /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0439
*                      RETURN;                             /*@YL026UD*/
         B     @EL00002                                            0440
*                    END;                                  /*@YL026UD*/
*                                                                  0441
*              END GIPE;                                   /*@YL026UD*/
*                                                                  0442
*                                                                  0442
@RF00437 DS    0H                                                  0443
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF SYSCTLG ENTRY IS A 'CVPE' -      @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A CONTROL VOLUME POINTER ENTRY ('CVPE')       @YL026UD*/
*          /*  CONNECTS ANOTHER CONTROL VOLUME (CVOL) TO     @YL026UD*/
*          /*  THE CVOL BEING CONVERTED                      @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A CONTROL VOLUME POINTER ENTRY CAN APPEAR     @YL026UD*/
*          /*  ONLY WITHIN THE VOLUME INDEX                  @YL026UD*/
*          /*  (THE FIRST-LEVEL SYSCTLG INDEX)               @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  THE 'CVPE' CONTAINS A NAME THAT APPEARS IN    @YL026UD*/
*          /*  THE VOLUME INDEX OF THE CONNECTED CVOL        @YL026UD*/
*          /*                                                @YL026UD*/
*          /*  A CONTROL VOLUME POINTER ENTRY IS CONVERTED   @YL026UD*/
*          /*  (BASED UPON PARAMETERS SPECIFIED WITH THE     @YL026UD*/
*          /*  'CVOLEQUATES' PARAMETER) INTO AN ALIAS ENTRY  @YL026UD*/
*          /*  (ENTRY TYPE = 'X') IN THE VSAM MASTER CATALOG @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0443
*CVPE:     DO INDEX = 1 TO DIM(TYPECVPE);                  /*@YL026UD*/
*                                                                  0443
@RF00433 DS    0H                                                  0443
CVPE     LA    INDEX,1                                             0443
@DL00443 DS    0H                                                  0444
*            IF CATETYPE = TYPECVPE(INDEX) & ENDFLAG = OFF         0444
*              THEN                                                0444
         LA    @05,TYPECVPE-1(INDEX)                               0444
         CLC   CATETYPE(1,CATPTR),0(@05)                           0444
         BNE   @RF00444                                            0444
         TM    ENDFLAG,B'10000000'                                 0444
         BNZ   @RF00444                                            0444
*                DO;                                       /*@YL026UD*/
*                  /**************************************************/
*                  /*                                        @YL026UD*/
*                  /*  SYSCTLG ENTRY IS A 'CVPE' -           @YL026UD*/
*                  /*  PROCESS THE CONTROL VOLUME POINTER    @YL026UD*/
*                  /*  ENTRY                                 @YL026UD*/
*                  /*                                        @YL026UD*/
*                  /**************************************************/
*                                                                  0446
*                  FOUNDFLG = ON;                          /*@YL026UD*/
*                                                                  0446
         OI    FOUNDFLG,B'10000000'                                0446
*                  CALL CVPEPROC;                          /*@YL026UD*/
*                                                                  0447
         BAL   @14,CVPEPROC                                        0447
*                END;                                      /*@YL026UD*/
*                                                                  0448
*          END CVPE;                                       /*@YL026UD*/
*                                                                  0449
*                                                                  0449
@RF00444 AL    INDEX,@CF00215                                      0449
         C     INDEX,@CF00149                                      0449
         BNH   @DL00443                                            0449
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  VERIFY THAT A VALID ENTRY TYPE HAS BEEN       @YL026UD*/
*          /*  ENCOUNTERED FOR THIS ITERATION OF 'SCANLOOP'  @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0450
*          IF FOUNDFLG = OFF                                       0450
*            THEN                                                  0450
         TM    FOUNDFLG,B'10000000'                                0450
         BNZ   @RF00450                                            0450
*              DO;                                         /*@YL026UD*/
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  VALID ENTRY TYPE NOT ENCOUNTERED -      @YL026UD*/
*                /*  SCANNING ERROR ON SYSCTLG DATA SET -    @YL026UD*/
*                /*  PRINT ERROR MESSAGE AND TERMINATE       @YL026UD*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  0452
*                DARGSMOD = CNVTMSG;                       /*@YL026UD*/
*                                                                  0452
         L     @07,DDSTRU                                          0452
         MVC   DARGSMOD(3,@07),@CC00831                            0452
*                DARGSENT = SCN1MSG#;                      /*@YL026UD*/
*                                                                  0453
         MVI   DARGSENT(@07),X'05'                                 0453
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@YL026UD*/
*                                                                  0454
         L     @07,@PC00001                                        0454
         ST    @07,@AL00001                                        0454
         LA    @05,@CF00113                                        0454
         ST    @05,@AL00001+4                                      0454
         LA    @05,DDSTRU                                          0454
         ST    @05,@AL00001+8                                      0454
         MVI   @AL00001+8,X'80'                                    0454
         L     @15,GDTPRT(,@07)                                    0454
         LA    @01,@AL00001                                        0454
         BALR  @14,@15                                             0454
*                DARGSENT = SCN2MSG#;                      /*@YL026UD*/
*                                                                  0455
         L     @07,DDSTRU                                          0455
         MVI   DARGSENT(@07),X'06'                                 0455
*                IF LVLINDEX = VOLLVL                              0456
*                  THEN                                            0456
         CLC   LVLINDEX(2),@CH00215                                0456
         BNE   @RF00456                                            0456
*                    DO;                                   /*@YL026UD*/
*                      DARGDBP = ADDR(VOLCONST);           /*@YL026UD*/
         LA    @05,@CC01092                                        0458
         ST    @05,DARGDBP(,@07)                                   0458
*                      DARGILP = LENGTH(VOLCONST);         /*@YL026UD*/
         MVC   DARGILP(2,@07),@CH00152                             0459
*                    END;                                  /*@YL026UD*/
*                  ELSE                                            0461
*                    DO;                                   /*@YL026UD*/
         B     @RC00456                                            0461
@RF00456 DS    0H                                                  0462
*                      DARGDBP = ADDR(DSNAME);             /*@YL026UD*/
         L     @07,DDSTRU                                          0462
         LA    @05,DSNAME                                          0462
         ST    @05,DARGDBP(,@07)                                   0462
*                      DARGILP = DSNLEN;                   /*@YL026UD*/
         STH   DSNLEN,DARGILP(,@07)                                0463
*                    END;                                  /*@YL026UD*/
*                                                                  0464
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@YL026UD*/
*                                                                  0465
@RC00456 L     @07,@PC00001                                        0465
         ST    @07,@AL00001                                        0465
         LA    @05,@CF00113                                        0465
         ST    @05,@AL00001+4                                      0465
         LA    @05,DDSTRU                                          0465
         ST    @05,@AL00001+8                                      0465
         MVI   @AL00001+8,X'80'                                    0465
         L     @15,GDTPRT(,@07)                                    0465
         LA    @01,@AL00001                                        0465
         BALR  @14,@15                                             0465
*                LASTCOND = LASTCC12;                      /*@Y30SSMK*/
*                                                                  0466
         L     @07,@PC00001+8                                      0466
         MVC   LASTCOND(2,@07),@CH00037                            0466
*                /****************************************************/
*                /*                                          @Y30SSMK*/
*                /*  DUMP POINT WHEN AN INVALID ENTRY IS     @Y30SSMK*/
*                /*  ENCOUNTERED IN THE OS CATALOG.          @Y30SSMK*/
*                /*                                          @Y30SSMK*/
*                /****************************************************/
*                                                                  0467
*                IF GDTDBG = NULLPTR                               0467
*                  THEN;                                           0467
         L     @07,@PC00001                                        0467
         L     @07,GDTDBG(,@07)                                    0467
         LTR   @07,@07                                             0467
         BZ    @RT00467                                            0467
*                  ELSE                                            0469
*                    CALL IDCDB010(GDTTBL,'CCSE');                 0469
         L     @07,@PC00001                                        0469
         ST    @07,@AL00001                                        0469
         LA    @05,@CC01130                                        0469
         ST    @05,@AL00001+4                                      0469
         MVI   @AL00001+4,X'80'                                    0469
         L     @15,GDTDBG(,@07)                                    0469
         LA    @01,@AL00001                                        0469
         BALR  @14,@15                                             0469
*                                                          /*@YL026UD*/
*                                                                  0470
*                ENDFLAG = ON;                             /*@YL026UD*/
@RT00467 OI    ENDFLAG,B'10000000'                                 0470
*              END;                                        /*@YL026UD*/
*                                                                  0471
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  END OF MAIN PROCESSING LOOP ('SCANLOOP')        @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0472
*        END SCANLOOP;                                     /*@YL026UD*/
*                                                                  0472
@RF00450 DS    0H                                                  0472
@DE00379 TM    ENDFLAG,B'10000000'                                 0472
         BZ    @DL00379                                            0472
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT AFTER THE OS ENTRIES ARE CONVERTED   @Y30SSMK*/
*        /*  TO VSAM ENTRIES.                                @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0473
*        IF GDTDBG = NULLPTR                                       0473
*          THEN;                                                   0473
         L     @08,@PC00001                                        0473
         L     @08,GDTDBG(,@08)                                    0473
         LTR   @08,@08                                             0473
         BZ    @RT00473                                            0473
*          ELSE                                                    0475
*            CALL IDCDB010(GDTTBL,'CCSL');                         0475
         L     @08,@PC00001                                        0475
         ST    @08,@AL00001                                        0475
         LA    @15,@CC01131                                        0475
         ST    @15,@AL00001+4                                      0475
         MVI   @AL00001+4,X'80'                                    0475
         L     @15,GDTDBG(,@08)                                    0475
         LA    @01,@AL00001                                        0475
         BALR  @14,@15                                             0475
*                                                          /*@YL026UD*/
*                                                                  0476
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  PRINT COUNT OF SYSCTLG ENTRIES CONVERTED TO     @YL026UD*/
*        /*  NONVSAM ENTRIES IN VSAM CATALOG                 @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0476
*        DARGSMOD = CNVTMSG;                               /*@YL026UD*/
@RT00473 L     @08,DDSTRU                                          0476
         MVC   DARGSMOD(3,@08),@CC00831                            0476
*        DARGSENT = CCNTMSG#;                              /*@YL026UD*/
*                                                                  0477
         MVI   DARGSENT(@08),X'07'                                 0477
*        DARGDBP = ADDR(CNVTCNT);                          /*@YL026UD*/
         LA    @15,CNVTCNT                                         0478
         ST    @15,DARGDBP(,@08)                                   0478
*        DARGILP = LENGTH(CNVTCNT);                        /*@YL026UD*/
*                                                                  0479
         MVC   DARGILP(2,@08),@CH00042                             0479
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UD*/
*                                                                  0480
         L     @08,@PC00001                                        0480
         ST    @08,@AL00001                                        0480
         LA    @15,@CF00113                                        0480
         ST    @15,@AL00001+4                                      0480
         LA    @15,DDSTRU                                          0480
         ST    @15,@AL00001+8                                      0480
         MVI   @AL00001+8,X'80'                                    0480
         L     @15,GDTPRT(,@08)                                    0480
         LA    @01,@AL00001                                        0480
         BALR  @14,@15                                             0480
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  PRINT COUNT OF VSAM CATALOG ENTRIES UPDATED     @YL026UD*/
*        /*  (VOLUME INFORMATION ALTERED) TO MATCH THE       @YL026UD*/
*        /*  CURRENT CORRESPONDING SYSCTLG ENTRY             @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0481
*        DARGSMOD = CNVTMSG;                               /*@YL026UD*/
         L     @08,DDSTRU                                          0481
         MVC   DARGSMOD(3,@08),@CC00831                            0481
*        DARGSENT = UCNTMSG#;                              /*@YL026UD*/
*                                                                  0482
         MVI   DARGSENT(@08),X'0D'                                 0482
*        DARGDBP = ADDR(UPDTCNT);                          /*@YL026UD*/
         LA    @15,UPDTCNT                                         0483
         ST    @15,DARGDBP(,@08)                                   0483
*        DARGILP = LENGTH(UPDTCNT);                        /*@YL026UD*/
*                                                                  0484
         MVC   DARGILP(2,@08),@CH00042                             0484
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UD*/
*                                                                  0485
         L     @08,@PC00001                                        0485
         ST    @08,@AL00001                                        0485
         LA    @15,@CF00113                                        0485
         ST    @15,@AL00001+4                                      0485
         LA    @15,DDSTRU                                          0485
         ST    @15,@AL00001+8                                      0485
         MVI   @AL00001+8,X'80'                                    0485
         L     @15,GDTPRT(,@08)                                    0485
         LA    @01,@AL00001                                        0485
         BALR  @14,@15                                             0485
*        RETURN;                                           /*@YL026UD*/
         B     @EL00002                                            0486
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - CNVTINIT                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - OBTAIN REQUIRED STORAGE FOR PROCESSING THE   @YL026UD*/
*/*             CATALOG CONVERSION.  STORAGE IS NEEDED FOR   @YL026UD*/
*/*             (1) SYSCTLG INDEX BLOCKS                     @YL026UD*/
*/*             (2) VSAM PARAMETER LISTS (CPL/FVT/FPLS)      @YL026UD*/
*/*             (3) DATA SET VOLUME INFORMATION LISTS        @YL026UD*/
*/*             (4) CATALOG WORKAREA (VSAM CATALOG LOCATE)   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             INITIALIZE THE CATALOG CONVERSION SUBTITLE   @YL026UD*/
*/*             LINE (IF 'LIST' OPTION IN EFFECT)            @YL026UD*/
*/*                                                          @YL026UD*/
*/*             INITIALIZE THE FLAGS AND INDEXES USED FOR    @YL026UD*/
*/*             SCANNING THE SYSCTLG DATA SET AND CONVERTING @YL026UD*/
*/*             THE EXTRACTED ENTRIES                        @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - (1) SIZES FOR REQUIRED STORAGE AREAS            @YL026UD*/
*/*          (2) UNINITIALIZED CONVERSION FLAGS AND INDEXES  @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - (1) INITIALIZED STORAGE AREAS                  @YL026UD*/
*/*           (2) ESTABLISHED SUBTITLE LINE                  @YL026UD*/
*/*               (IF 'LIST' OPTION SPECIFIED OR DEFAULTED)  @YL026UD*/
*/*           (3) INITIALIZED CONVERSION FLAGS AND INDEXES   @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0487
*CNVTINIT: PROCEDURE;                                      /*@YL026UD*/
CNVTINIT STM   @14,@03,@SA00003                                    0487
         ST    @05,@SA00003+24                                     0487
         ST    @07,@SA00003+28                                     0487
         STM   @09,@12,@SA00003+32                                 0487
*        OLDERID2 = NEWERID2;                                      0488
         L     @07,@PC00001                                        0488
         L     @15,GDTTR2(,@07)                                    0488
         MVC   @TS00001(95),NEWERID2(@15)                          0488
         MVC   OLDERID2(95,@15),@TS00001                           0488
*        NEWID2 = 'CCCI';                                  /*@YL026UD*/
*                                                                  0489
         MVC   NEWID2(4,@15),@CC01135                              0489
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN STORAGE FOR SYSCTLG INDEX BLOCKS -       @YL026UD*/
*        /*  ALLOW FOR 22 LEVELS OF INDEX BLOCKS             @YL026UD*/
*        /*  ('UGPOOL' MACRO)                                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0490
*        BLKLVLEN = LVLMAX * LENGTH(BLOCK);                /*@YL026UD*/
*                                                                  0490
         MVC   BLKLVLEN(4),@CF01297                                0490
*        CALL IDCSAGP0(GDTTBL,BLKLVLEN,BLKLVPTR,POOLID);   /*@YL026UD*/
*                                                                  0491
         ST    @07,@AL00001                                        0491
         LA    @15,BLKLVLEN                                        0491
         ST    @15,@AL00001+4                                      0491
         LA    @15,BLKLVPTR                                        0491
         ST    @15,@AL00001+8                                      0491
         LA    @15,@CC00862                                        0491
         ST    @15,@AL00001+12                                     0491
         MVI   @AL00001+12,X'80'                                   0491
         L     @15,GDTGPL(,@07)                                    0491
         LA    @01,@AL00001                                        0491
         BALR  @14,@15                                             0491
*        RESPECIFY RTNREG RSTD;                                    0492
*        TESTRC = RTNREG;                                          0493
         LR    TESTRC,RTNREG                                       0493
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0494
*        IF TESTRC ^= 0                                            0495
*          THEN                                                    0495
         LTR   TESTRC,TESTRC                                       0495
         BZ    @RF00495                                            0495
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  UNABLE TO OBTAIN STORAGE FOR SYSCTLG      @YL026UD*/
*              /*  INDEX BLOCKS -                            @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0497
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/
         L     @07,DDSTRU                                          0497
         MVC   DARGSMOD(3,@07),@CC00849                            0497
*              DARGSENT = STORMSG#;                        /*@YL026UD*/
*                                                                  0498
         MVI   DARGSENT(@07),X'04'                                 0498
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0499
         L     @07,@PC00001                                        0499
         ST    @07,@AL00001                                        0499
         LA    @05,@CF00113                                        0499
         ST    @05,@AL00001+4                                      0499
         LA    @05,DDSTRU                                          0499
         ST    @05,@AL00001+8                                      0499
         MVI   @AL00001+8,X'80'                                    0499
         L     @15,GDTPRT(,@07)                                    0499
         LA    @01,@AL00001                                        0499
         BALR  @14,@15                                             0499
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0500
         L     @07,@PC00001+8                                      0500
         MVC   LASTCOND(2,@07),@CH00037                            0500
*              LASTMSG = ON;                               /*@YL026UD*/
*                                                                  0501
         OI    LASTMSG,B'10000000'                                 0501
*              RETURN;                                     /*@YL026UD*/
@EL00003 DS    0H                                                  0502
@EF00003 DS    0H                                                  0502
@ER00003 LM    @14,@03,@SA00003                                    0502
         L     @05,@SA00003+24                                     0502
         L     @07,@SA00003+28                                     0502
         LM    @09,@12,@SA00003+32                                 0502
         BR    @14                                                 0502
*            END;                                          /*@YL026UD*/
*                                                                  0503
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN STORAGE FOR CPL/FVT/FPL                  @YL026UD*/
*        /*  (VSAM PARAMETER LISTS)                          @YL026UD*/
*        /*  ('UGPOOL' MACRO)                                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  CALCULATE LENGTHS TO                            @Y30SSMK*/
*        /*  ALIGN CPL, FVT, AND FPLS ON FULLWORD            @YL026UD*/
*        /*  BOUNDARIES                                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0504
*        CPLLEN = ((LENGTH(CTGPL) + 12) / 4) * 4;          /*@YL026UD*/
@RF00495 LA    @07,40                                              0504
         STH   @07,CPLLEN                                          0504
*        FVTLEN = ((LENGTH(CTGFV) + 12) / 4) * 4;          /*@YL026UD*/
         LA    @15,104                                             0505
         STH   @15,FVTLEN                                          0505
*        FPLLEN = ((LENGTH(CTGFL) + 12) / 4) * 4;          /*@YL026UD*/
*                                                                  0506
         LA    FPLLEN,28                                           0506
*        CATPLLEN = CPLLEN + FVTLEN + (4 * FPLLEN);        /*@YL026UD*/
*                                                                  0507
         ALR   @07,@15                                             0507
         LR    @15,FPLLEN                                          0507
         SLA   @15,2                                               0507
         ALR   @07,@15                                             0507
         ST    @07,CATPLLEN                                        0507
*        CALL IDCSAGP0(GDTTBL,CATPLLEN,CATPLPTR,POOLID);   /*@YL026UD*/
*                                                                  0508
         L     @07,@PC00001                                        0508
         ST    @07,@AL00001                                        0508
         LA    @15,CATPLLEN                                        0508
         ST    @15,@AL00001+4                                      0508
         LA    @15,CATPLPTR                                        0508
         ST    @15,@AL00001+8                                      0508
         LA    @15,@CC00862                                        0508
         ST    @15,@AL00001+12                                     0508
         MVI   @AL00001+12,X'80'                                   0508
         L     @15,GDTGPL(,@07)                                    0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*        RESPECIFY RTNREG RSTD;                                    0509
*        TESTRC = RTNREG;                                          0510
         LR    TESTRC,RTNREG                                       0510
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0511
*        IF TESTRC ^= 0                                            0512
*          THEN                                                    0512
         LTR   TESTRC,TESTRC                                       0512
         BZ    @RF00512                                            0512
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  UNABLE TO OBTAIN STORAGE FOR VSAM         @YL026UD*/
*              /*  CATALOG PARAMETER LISTS -                 @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0514
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/
         L     @07,DDSTRU                                          0514
         MVC   DARGSMOD(3,@07),@CC00849                            0514
*              DARGSENT = STORMSG#;                        /*@YL026UD*/
*                                                                  0515
         MVI   DARGSENT(@07),X'04'                                 0515
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0516
         L     @07,@PC00001                                        0516
         ST    @07,@AL00001                                        0516
         LA    @05,@CF00113                                        0516
         ST    @05,@AL00001+4                                      0516
         LA    @05,DDSTRU                                          0516
         ST    @05,@AL00001+8                                      0516
         MVI   @AL00001+8,X'80'                                    0516
         L     @15,GDTPRT(,@07)                                    0516
         LA    @01,@AL00001                                        0516
         BALR  @14,@15                                             0516
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0517
         L     @07,@PC00001+8                                      0517
         MVC   LASTCOND(2,@07),@CH00037                            0517
*              LASTMSG = ON;                               /*@YL026UD*/
*                                                                  0518
         OI    LASTMSG,B'10000000'                                 0518
*              RETURN;                                     /*@YL026UD*/
         B     @EL00003                                            0519
*            END;                                          /*@YL026UD*/
*                                                                  0520
*        CTGPLPTR = CATPLPTR;                              /*@YL026UD*/
*                                                                  0521
@RF00512 L     @07,CATPLPTR                                        0521
         LR    CTGPLPTR,@07                                        0521
*        CTGFVT   = CATPLPTR + CPLLEN;                     /*@YL026UD*/
*                                                                  0522
         AH    @07,CPLLEN                                          0522
         ST    @07,CTGFVT(,CTGPLPTR)                               0522
*        DEVTFPL  = CATPLPTR + CPLLEN + FVTLEN;            /*@YL026UD*/
         AH    @07,FVTLEN                                          0523
         ST    @07,DEVTFPL                                         0523
*        FSEQFPL  = DEVTFPL  + FPLLEN;                     /*@YL026UD*/
         ALR   @07,FPLLEN                                          0524
         ST    @07,FSEQFPL                                         0524
*        ENTYPFPL = FSEQFPL  + FPLLEN;                     /*@YL026UD*/
         ALR   @07,FPLLEN                                          0525
         ST    @07,ENTYPFPL                                        0525
*        CATVLFPL = ENTYPFPL + FPLLEN;                     /*@YL026UD*/
*                                                                  0526
         ALR   @07,FPLLEN                                          0526
         ST    @07,CATVLFPL                                        0526
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN STORAGE FOR DEVICE CODE, VOLUME SERIAL,  @YL026UD*/
*        /*  AND DATA SET SEQUENCE NUMBER LISTS              @YL026UD*/
*        /*  ('UGPOOL' MACRO)                                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0527
*        DEVTLEN = VLISTMAX * LENGTH(DEVTLIST);            /*@YL026UD*/
*                                                                  0527
         LA    @07,3072                                            0527
         STH   @07,DEVTLEN                                         0527
*        VOLLEN  = VLISTMAX * (LENGTH(VOLSERS) + 1);       /*@YL026UD*/
*                                                                  0528
         LA    @15,2304                                            0528
         STH   @15,VOLLEN                                          0528
*        FILELEN = VLISTMAX * LENGTH(FILELIST);            /*@YL026UD*/
*                                                                  0529
         LA    @14,512                                             0529
         STH   @14,FILELEN                                         0529
*        VINFOLEN = DEVTLEN + VOLLEN + FILELEN;            /*@YL026UD*/
*                                                                  0530
         ALR   @07,@15                                             0530
         ALR   @07,@14                                             0530
         ST    @07,VINFOLEN                                        0530
*        CALL IDCSAGP0(GDTTBL,VINFOLEN,VINFOPTR,POOLID);   /*@YL026UD*/
*                                                                  0531
         L     @07,@PC00001                                        0531
         ST    @07,@AL00001                                        0531
         LA    @15,VINFOLEN                                        0531
         ST    @15,@AL00001+4                                      0531
         LA    @15,VINFOPTR                                        0531
         ST    @15,@AL00001+8                                      0531
         LA    @15,@CC00862                                        0531
         ST    @15,@AL00001+12                                     0531
         MVI   @AL00001+12,X'80'                                   0531
         L     @15,GDTGPL(,@07)                                    0531
         LA    @01,@AL00001                                        0531
         BALR  @14,@15                                             0531
*        RESPECIFY RTNREG RSTD;                                    0532
*        TESTRC = RTNREG;                                          0533
         LR    TESTRC,RTNREG                                       0533
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0534
*        IF TESTRC ^= 0                                            0535
*          THEN                                                    0535
         LTR   TESTRC,TESTRC                                       0535
         BZ    @RF00535                                            0535
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  UNABLE TO OBTAIN STORAGE                  @YL026UD*/
*              /*  FOR REQUIRED LISTS -                      @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0537
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/
         L     @07,DDSTRU                                          0537
         MVC   DARGSMOD(3,@07),@CC00849                            0537
*              DARGSENT = STORMSG#;                        /*@YL026UD*/
*                                                                  0538
         MVI   DARGSENT(@07),X'04'                                 0538
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0539
         L     @07,@PC00001                                        0539
         ST    @07,@AL00001                                        0539
         LA    @05,@CF00113                                        0539
         ST    @05,@AL00001+4                                      0539
         LA    @05,DDSTRU                                          0539
         ST    @05,@AL00001+8                                      0539
         MVI   @AL00001+8,X'80'                                    0539
         L     @15,GDTPRT(,@07)                                    0539
         LA    @01,@AL00001                                        0539
         BALR  @14,@15                                             0539
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0540
         L     @07,@PC00001+8                                      0540
         MVC   LASTCOND(2,@07),@CH00037                            0540
*              LASTMSG = ON;                               /*@YL026UD*/
*                                                                  0541
         OI    LASTMSG,B'10000000'                                 0541
*              RETURN;                                     /*@YL026UD*/
         B     @EL00003                                            0542
*            END;                                          /*@YL026UD*/
*                                                                  0543
*        DEVTPTR = VINFOPTR;                               /*@YL026UD*/
@RF00535 L     @07,VINFOPTR                                        0544
         ST    @07,DEVTPTR                                         0544
*        VOLPTR  = VINFOPTR + DEVTLEN;                     /*@YL026UD*/
         AH    @07,DEVTLEN                                         0545
         ST    @07,VOLPTR                                          0545
*        FILEPTR = VOLPTR   + VOLLEN;                      /*@YL026UD*/
*                                                                  0546
*                                                                  0546
         AH    @07,VOLLEN                                          0546
         ST    @07,FILEPTR                                         0546
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN STORAGE FOR (INITIAL) CATALOG WORKAREA - @YL026UD*/
*        /*  THE WORKAREA IS REQUIRED FOR LOCATING ENTRIES   @YL026UD*/
*        /*  IN THE VSAM CATALOG ('UGPOOL' MACRO)            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0547
*        WKASIZE = INITWKA;                                /*@YL026UD*/
*                                                                  0547
         MVC   WKASIZE(4),@CF01036                                 0547
*        CALL IDCSAGP0(GDTTBL,WKASIZE,WKAPTR,POOLID,SETZERO);/*    0548
*                                                            @YL026UD*/
*                                                                  0548
         L     @07,@PC00001                                        0548
         ST    @07,@AL00001                                        0548
         LA    @15,WKASIZE                                         0548
         ST    @15,@AL00001+4                                      0548
         LA    @15,WKAPTR                                          0548
         ST    @15,@AL00001+8                                      0548
         LA    @15,@CC00862                                        0548
         ST    @15,@AL00001+12                                     0548
         LA    @15,SETZERO                                         0548
         ST    @15,@AL00001+16                                     0548
         MVI   @AL00001+16,X'80'                                   0548
         L     @15,GDTGPL(,@07)                                    0548
         LA    @01,@AL00001                                        0548
         BALR  @14,@15                                             0548
*        RESPECIFY RTNREG RSTD;                                    0549
*        TESTRC = RTNREG;                                          0550
         LR    TESTRC,RTNREG                                       0550
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0551
*        IF TESTRC ^= 0                                            0552
*          THEN                                                    0552
         LTR   TESTRC,TESTRC                                       0552
         BZ    @RF00552                                            0552
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  UNABLE TO OBTAIN STORAGE FOR WORKAREA -   @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0554
*              DARGSMOD = UNIVMSG;                         /*@YL026UD*/
         L     @07,DDSTRU                                          0554
         MVC   DARGSMOD(3,@07),@CC00849                            0554
*              DARGSENT = STORMSG#;                        /*@YL026UD*/
*                                                                  0555
         MVI   DARGSENT(@07),X'04'                                 0555
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0556
         L     @07,@PC00001                                        0556
         ST    @07,@AL00001                                        0556
         LA    @05,@CF00113                                        0556
         ST    @05,@AL00001+4                                      0556
         LA    @05,DDSTRU                                          0556
         ST    @05,@AL00001+8                                      0556
         MVI   @AL00001+8,X'80'                                    0556
         L     @15,GDTPRT(,@07)                                    0556
         LA    @01,@AL00001                                        0556
         BALR  @14,@15                                             0556
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0557
         L     @07,@PC00001+8                                      0557
         MVC   LASTCOND(2,@07),@CH00037                            0557
*              LASTMSG = ON;                               /*@YL026UD*/
*                                                                  0558
         OI    LASTMSG,B'10000000'                                 0558
*              RETURN;                                     /*@YL026UD*/
         B     @EL00003                                            0559
*            END;                                          /*@YL026UD*/
*                                                                  0560
*                                                                  0560
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF 'LIST' OPTION IS SPECIFIED OR DEFAULTED -    @YL026UD*/
*        /*  OBTAIN AND ESTABLISH THE CNVTCAT SUBTITLE LINE  @YL026UD*/
*        /*  ('UPRINT' AND 'UESTA' MACROS)                   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0561
*        IF ADDR(LIST) ^= NULLPTR  &  GDTECT = NULLPTR             0561
*          THEN                                                    0561
@RF00552 SLR   @05,@05                                             0561
         L     @15,@PC00001+4                                      0561
         C     @05,FDTPTR+36(,@15)                                 0561
         BE    @RF00561                                            0561
         L     @15,@PC00001                                        0561
         C     @05,GDTECT(,@15)                                    0561
         BNE   @RF00561                                            0561
*            DO;                                           /*@YL026UD*/
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @05,DDSTRU                                          0563
         MVC   DARGSMOD(3,@05),@CC00831                            0563
*              DARGSENT = SUBTMSG#;                        /*@YL026UD*/
*                                                                  0564
         MVI   DARGSENT(@05),X'01'                                 0564
*              DARGRETP = ADDR(SUBTITLE);                  /*@YL026UD*/
         LA    @14,SUBTITLE                                        0565
         ST    @14,DARGRETP(,@05)                                  0565
*              DARGRETL = LENGTH(SUBTITLE);                /*@YL026UD*/
*                                                                  0566
         MVC   DARGRETL(2,@05),@CH01047                            0566
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0567
         ST    @15,@AL00001                                        0567
         LA    @05,@CF00113                                        0567
         ST    @05,@AL00001+4                                      0567
         LA    @05,DDSTRU                                          0567
         ST    @05,@AL00001+8                                      0567
         MVI   @AL00001+8,X'80'                                    0567
         L     @15,GDTPRT(,@15)                                    0567
         LA    @01,@AL00001                                        0567
         BALR  @14,@15                                             0567
*              DARGRETP = NULLPTR;                         /*@YL026UD*/
         SLR   @05,@05                                             0568
         L     @15,DDSTRU                                          0568
         ST    @05,DARGRETP(,@15)                                  0568
*              DARGRETL = 0;                               /*@YL026UD*/
*                                                                  0569
         STH   @05,DARGRETL(,@15)                                  0569
*              PCARGLST = '00'X;                           /*@YL026UD*/
         XC    PCARGLST+1(33),PCARGLST+1                           0570
         MVI   PCARGLST,X'00'                                      0570
*              PCSTLP = ADDR(SUBTITLE);                    /*@YL026UD*/
         LA    @05,SUBTITLE                                        0571
         ST    @05,PCSTLP                                          0571
*              PCSTLC = 1;                                 /*@YL026UD*/
*                                                                  0572
         MVC   PCSTLC(2),@CH00215                                  0572
*              CALL AMSTP042(GDTTBL,PRTFILE,PCARGLST);     /*@YL026UD*/
*                                                                  0573
         L     @05,@PC00001                                        0573
         ST    @05,@AL00001                                        0573
         LA    @15,@CF00113                                        0573
         ST    @15,@AL00001+4                                      0573
         LA    @15,PCARGLST                                        0573
         ST    @15,@AL00001+8                                      0573
         L     @15,GDTESA(,@05)                                    0573
         LA    @01,@AL00001                                        0573
         BALR  @14,@15                                             0573
*            END;                                          /*@YL026UD*/
*                                                                  0574
*                                                                  0574
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE FLAGS AND INDEXES USED FOR           @YL026UD*/
*        /*  SCANNING THE SYSCTLG DATA SET                   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0575
*        DSNAME = ' ';                 /*INITIALIZE 'NULL'   @YL026UD*/
@RF00561 MVI   DSNAME+1,C' '                                       0575
         MVC   DSNAME+2(42),DSNAME+1                               0575
         MVI   DSNAME,C' '                                         0575
*                                      /*DATA SET NAME       @YL026UD*/
*                                                                  0576
*        DSNLEN = 0;                   /*DATA SET NAME LENGTH        */
*                                                                  0576
         SLR   @05,@05                                             0576
         LR    DSNLEN,@05                                          0576
*        DSCBTTR = '00'X;              /*DSCB RELATIVE TRACK @YL026UD*/
         XC    DSCBTTR+1(3),DSCBTTR+1                              0577
         MVI   DSCBTTR,X'00'                                       0577
*                                      /*ADDRESS (TTR)       @YL026UD*/
*                                                                  0578
*        LVLINDEX = 1;                 /*PUSH-DOWN STACK INDEX       */
*                                                                  0578
         MVC   LVLINDEX(2),@CH00215                                0578
*        CNVTCNT = 0;                  /*INITIALIZE COUNT    @YL026UD*/
         ST    @05,CNVTCNT                                         0579
*                                      /*OF CONVERSTIONS     @YL026UD*/
*        UPDTCNT = 0;                  /*INITIALIZE COUNT    @YL026UD*/
         ST    @05,UPDTCNT                                         0580
*                                      /*OF UPDATED ENTRIES  @YL026UD*/
*                                                                  0581
*        ALIASFLG = OFF;               /*'ALIAS ENTRY' FLAG  @YL026UD*/
         NI    ALIASFLG,B'01111111'                                0581
*        TRUEFLG  = OFF;               /*'TRUE ENTRY'  FLAG  @YL026UD*/
         NI    TRUEFLG,B'01111111'                                 0582
*        CVPEFLAG = OFF;               /*'CVPE ENTRY'  FLAG  @YL026UD*/
         NI    CVPEFLAG,B'01111111'                                0583
*        GDGFLAG  = OFF;               /*'GDG BASE'    FLAG  @YL026UD*/
         NI    GDGFLAG,B'01111111'                                 0584
*        G0V0FLAG = OFF;               /*'G0000V00'    FLAG  @YL026UD*/
*                                                                  0585
         NI    G0V0FLAG,B'01111111'                                0585
*        ENDFLAG  = OFF;               /*'CONVERT PROCESSING @YL026UD*/
         NI    ENDFLAG,B'01111111'                                 0586
*                                      /* COMPLETE' FLAG     @YL026UD*/
*                                                                  0587
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT AFTER STORAGE IS OBTAINED AND        @Y30SSMK*/
*        /*  INITIALIZED.                                    @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0587
*        IF GDTDBG = NULLPTR                                       0587
*          THEN;                                                   0587
         L     @07,@PC00001                                        0587
         C     @05,GDTDBG(,@07)                                    0587
         BE    @RT00587                                            0587
*          ELSE                                                    0589
*            CALL IDCDB010(GDTTBL,'CCIC');                         0589
         L     @07,@PC00001                                        0589
         ST    @07,@AL00001                                        0589
         LA    @05,@CC01136                                        0589
         ST    @05,@AL00001+4                                      0589
         MVI   @AL00001+4,X'80'                                    0589
         L     @15,GDTDBG(,@07)                                    0589
         LA    @01,@AL00001                                        0589
         BALR  @14,@15                                             0589
*                                                          /*@YL026UD*/
*                                                                  0590
*        END CNVTINIT;                                     /*@YL026UD*/
         B     @EL00003                                            0590
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - VOLINDEX                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - OBTAIN THE FIRST-LEVEL SYSCTLG DATA SET      @YL026UD*/
*/*             INDEX (THE VOLUME INDEX)                     @YL026UD*/
*/*                                                          @YL026UD*/
*/*             VERIFY THAT THE FIRST INDEX ENTRY IS A       @YL026UD*/
*/*             VOLUME INDEX CONTROL ENTRY ('VICE')          @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE FIRST VOLUME INDEX BLOCK CANNOT BE    @YL026UD*/
*/*             OBTAINED, OR IF THE 'VICE' CANNOT BE         @YL026UD*/
*/*             VERIFIED, PROCESSING IS TERMINATED           @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - INITIAL SYSCTLG RELATIVE TRACK ADDRESS (TTR)    @YL026UD*/
*/*          NEEDED TO OBTAIN THE VOLUME INDEX               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE ACQUIRED FIRST BLOCK OF THE SYSCTLG        @YL026UD*/
*/*           VOLUME INDEX WITH SCANNING POINTERS            @YL026UD*/
*/*           POSITIONED AFTER THE 'VICE'                    @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0591
*VOLINDEX: PROCEDURE;                                      /*@YL026UD*/
VOLINDEX STM   @14,@02,@SA00004                                    0591
         STM   @04,@12,@SA00004+20                                 0591
*        OLDERID2 = NEWERID2;                                      0592
         L     @08,@PC00001                                        0592
         L     @04,GDTTR2(,@08)                                    0592
         MVC   @TS00001(95),NEWERID2(@04)                          0592
         MVC   OLDERID2(95,@04),@TS00001                           0592
*        NEWID2 = 'CCVX';                                  /*@YL026UD*/
*                                                                  0593
         MVC   NEWID2(4,@04),@CC01140                              0593
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN THE FIRST-LEVEL SYSCTLG DATA SET INDEX   @YL026UD*/
*        /*  (THE VOLUME INDEX) -                            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE RELATIVE TRACK ADDRESS (TTR)     @YL026UD*/
*        /*  FOR THE INITIAL SYSCTLG INDEX BLOCK             @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  ISSUE 'UPOSIT'/'UGET' MACROS                    @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0594
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/
*                                                                  0594
         LH    @04,LVLINDEX                                        0594
         SLA   @04,8                                               0594
         L     @02,BLKLVPTR                                        0594
         AL    @02,@CF01312                                        0594
         LA    @04,BLOCK(@04,@02)                                  0594
         ST    @04,BLOCKPTR                                        0594
*        BLOCKTTR = FIRSTTTR;                              /*@YL026UD*/
*                                                                  0595
         MVC   BLOCKTTR(4),FIRSTTTR                                0595
*        IIOCSPTR -> IOCTTR = BLOCKTTR;                    /*@YL026UD*/
*                                                                  0596
         L     @04,IIOCSPTR                                        0596
         MVC   IOCTTR(4,@04),BLOCKTTR                              0596
*        CALL IDCIOPO0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0597
         ST    @08,@AL00001                                        0597
         LA    @04,IIOCSPTR                                        0597
         ST    @04,@AL00001+4                                      0597
         MVI   @AL00001+4,X'80'                                    0597
         L     @15,GDTPOS(,@08)                                    0597
         LA    @01,@AL00001                                        0597
         BALR  @14,@15                                             0597
*        CALL IDCIOGT0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0598
         L     @08,@PC00001                                        0598
         ST    @08,@AL00001                                        0598
         LA    @04,IIOCSPTR                                        0598
         ST    @04,@AL00001+4                                      0598
         MVI   @AL00001+4,X'80'                                    0598
         L     @15,GDTGET(,@08)                                    0598
         LA    @01,@AL00001                                        0598
         BALR  @14,@15                                             0598
*        RESPECIFY RTNREG RSTD;                                    0599
*        TESTRC = RTNREG;                                          0600
         LR    TESTRC,RTNREG                                       0600
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0601
*        IF TESTRC ^= 0                                            0602
*          THEN                                                    0602
         LTR   TESTRC,TESTRC                                       0602
         BZ    @RF00602                                            0602
*            DO;                                           /*@YL026UD*/
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
         L     @08,@PC00001+8                                      0604
         MVC   LASTCOND(2,@08),@CH00037                            0604
*              RETURN;                                     /*@YL026UD*/
@EL00004 DS    0H                                                  0605
@EF00004 DS    0H                                                  0605
@ER00004 LM    @14,@02,@SA00004                                    0605
         LM    @04,@12,@SA00004+20                                 0605
         BR    @14                                                 0605
*            END;                                          /*@YL026UD*/
*                                                                  0606
*        BLOCK(LVLINDEX) = BLKREAD;                        /*@YL026UD*/
*                                                                  0607
@RF00602 LH    @08,LVLINDEX                                        0607
         SLA   @08,8                                               0607
         L     @02,BLKLVPTR                                        0607
         ALR   @02,@08                                             0607
         AL    @02,@CF01312                                        0607
         L     @08,IIOCSPTR                                        0607
         L     @08,IOCDAD(,@08)                                    0607
         MVC   BLOCK(256,@02),BLKREAD(@08)                         0607
*        CATPTR = BLOCKPTR + LENGTH(BLOCKCNT);             /*@YL026UD*/
*                                                                  0608
         LA    CATPTR,2                                            0608
         AL    CATPTR,BLOCKPTR                                     0608
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/
*        /*  THE INPUT SYSCTLG BLOCK                         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0609
*                                                                  0609
*        IF GDTDBG = NULLPTR                                       0609
*          THEN;                                                   0609
         L     @08,@PC00001                                        0609
         L     @08,GDTDBG(,@08)                                    0609
         LTR   @08,@08                                             0609
         BZ    @RT00609                                            0609
*          ELSE                                                    0611
*            DO;                                                   0611
*              DMPINDEX = ADDR(DLISTBLK);                          0612
*                                                                  0612
         LA    DMPINDEX,DLISTBLK                                   0612
*              DMPITMNM = 'BLKLEVEL';                              0613
         MVC   DMPITMNM(8,DMPINDEX),@CC01141                       0613
*              DMPITMPT = ADDR(LVLINDEX);                          0614
         LA    @08,LVLINDEX                                        0614
         ST    @08,DMPITMPT(,DMPINDEX)                             0614
*              DMPITMLN = 2;                                       0615
         MVC   DMPITMLN(2,DMPINDEX),@CH00149                       0615
*              DMPITMTP = 'F';                                     0616
         MVI   DMPITMTP(DMPINDEX),C'F'                             0616
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0617
*                                                                  0617
         LA    @08,16                                              0617
         ALR   DMPINDEX,@08                                        0617
*              DMPITMNM = 'BLOCKPTR';                              0618
         MVC   DMPITMNM(8,DMPINDEX),@CC01142                       0618
*              DMPITMPT = ADDR(BLOCKPTR);                          0619
         LA    @15,BLOCKPTR                                        0619
         ST    @15,DMPITMPT(,DMPINDEX)                             0619
*              DMPITMLN = 4;                                       0620
         MVC   DMPITMLN(2,DMPINDEX),@CH00042                       0620
*              DMPITMTP = 'H';                                     0621
         MVI   DMPITMTP(DMPINDEX),C'H'                             0621
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0622
*                                                                  0622
         ALR   DMPINDEX,@08                                        0622
*              DMPITMNM = 'BLOCK';                                 0623
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0623
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0623
         MVC   DMPITMNM(5,DMPINDEX),@CC01144                       0623
*              DMPITMPT = ADDR(BLKREAD);                           0624
         L     @01,IIOCSPTR                                        0624
         L     @15,IOCDAD(,@01)                                    0624
         ST    @15,DMPITMPT(,DMPINDEX)                             0624
*              DMPITMLN = 256;                                     0625
         MVC   DMPITMLN(2,DMPINDEX),@CH00823                       0625
*              DMPITMTP = 'H';                                     0626
         MVI   DMPITMTP(DMPINDEX),C'H'                             0626
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0627
*                                                                  0627
         ALR   DMPINDEX,@08                                        0627
*              DMPTRM = DMPTRMVL;                                  0628
         MVI   DMPTRM(DMPINDEX),X'FF'                              0628
*            END;                                                  0629
*                                                                  0629
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT TO DUMP FIRST BLOCK OF VOLUME INDEX. @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0630
*        IF GDTDBG = NULLPTR                                       0630
*          THEN;                                                   0630
@RT00609 L     @08,@PC00001                                        0630
         L     @08,GDTDBG(,@08)                                    0630
         LTR   @08,@08                                             0630
         BZ    @RT00630                                            0630
*          ELSE                                                    0632
*            CALL IDCDB010(GDTTBL,'CCVI',ADDR(DLISTBLK));          0632
         L     @08,@PC00001                                        0632
         ST    @08,@AL00001                                        0632
         LA    @02,@CC01145                                        0632
         ST    @02,@AL00001+4                                      0632
         LA    @02,DLISTBLK                                        0632
         ST    @02,@AFTEMPS                                        0632
         LA    @02,@AFTEMPS                                        0632
         ST    @02,@AL00001+8                                      0632
         MVI   @AL00001+8,X'80'                                    0632
         L     @15,GDTDBG(,@08)                                    0632
         LA    @01,@AL00001                                        0632
         BALR  @14,@15                                             0632
*                                                          /*@YL026UD*/
*                                                                  0633
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  VERIFY THAT THE FIRST INDEX ENTRY IS A          @YL026UD*/
*        /*  VOLUME INDEX CONTROL ENTRY ('VICE')             @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0633
*        IF CATETYPE = TYPEVICE                                    0633
*          THEN                                                    0633
@RT00630 CLC   CATETYPE(1,CATPTR),TYPEVICE                         0633
         BNE   @RF00633                                            0633
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ENTRY IS A 'VICE' -                       @YL026UD*/
*              /*  BYPASS THE VICE ENTRY                     @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0635
*              CATPTR = CATPTR + (CATETYPE * 2)                    0635
*                       + LENGTH(CATFORM);                 /*@YL026UD*/
         SLR   @08,@08                                             0635
         IC    @08,CATETYPE(,CATPTR)                               0635
         ALR   @08,@08                                             0635
         ALR   @08,CATPTR                                          0635
         AL    @08,@CF00037                                        0635
         LR    CATPTR,@08                                          0635
*            END;                                          /*@YL026UD*/
*          ELSE                                                    0637
*            DO;                                           /*@YL026UD*/
         B     @RC00633                                            0637
@RF00633 DS    0H                                                  0638
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ENTRY IS NOT A 'VICE' -                   @YL026UD*/
*              /*  FURTHER SCANNING OF THE SYSCTLG DATA SET  @YL026UD*/
*              /*  IS IMPOSSIBLE -                           @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0638
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
*                                                                  0638
         L     @08,DDSTRU                                          0638
         MVC   DARGSMOD(3,@08),@CC00831                            0638
*              DARGSENT = SCN1MSG#;                        /*@YL026UD*/
*                                                                  0639
         MVI   DARGSENT(@08),X'05'                                 0639
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0640
         L     @08,@PC00001                                        0640
         ST    @08,@AL00001                                        0640
         LA    @02,@CF00113                                        0640
         ST    @02,@AL00001+4                                      0640
         LA    @02,DDSTRU                                          0640
         ST    @02,@AL00001+8                                      0640
         MVI   @AL00001+8,X'80'                                    0640
         L     @15,GDTPRT(,@08)                                    0640
         LA    @01,@AL00001                                        0640
         BALR  @14,@15                                             0640
*              DARGSENT = SCN2MSG#;                        /*@YL026UD*/
*                                                                  0641
         L     @08,DDSTRU                                          0641
         MVI   DARGSENT(@08),X'06'                                 0641
*              DARGDBP = ADDR(VOLCONST);                   /*@YL026UD*/
         LA    @02,@CC01092                                        0642
         ST    @02,DARGDBP(,@08)                                   0642
*              DARGILP = LENGTH(VOLCONST);                 /*@YL026UD*/
*                                                                  0643
         MVC   DARGILP(2,@08),@CH00152                             0643
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0644
         L     @08,@PC00001                                        0644
         ST    @08,@AL00001                                        0644
         LA    @02,@CF00113                                        0644
         ST    @02,@AL00001+4                                      0644
         LA    @02,DDSTRU                                          0644
         ST    @02,@AL00001+8                                      0644
         MVI   @AL00001+8,X'80'                                    0644
         L     @15,GDTPRT(,@08)                                    0644
         LA    @01,@AL00001                                        0644
         BALR  @14,@15                                             0644
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0645
         L     @08,@PC00001+8                                      0645
         MVC   LASTCOND(2,@08),@CH00037                            0645
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /*  DUMP POINT WHEN 'VICE' ENTRY IS NOT FOUND @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  0646
*              IF GDTDBG = NULLPTR                                 0646
*                THEN;                                             0646
         L     @08,@PC00001                                        0646
         L     @08,GDTDBG(,@08)                                    0646
         LTR   @08,@08                                             0646
         BZ    @RT00646                                            0646
*                ELSE                                              0648
*                  CALL IDCDB010(GDTTBL,'CCVE');                   0648
         L     @08,@PC00001                                        0648
         ST    @08,@AL00001                                        0648
         LA    @02,@CC01146                                        0648
         ST    @02,@AL00001+4                                      0648
         MVI   @AL00001+4,X'80'                                    0648
         L     @15,GDTDBG(,@08)                                    0648
         LA    @01,@AL00001                                        0648
         BALR  @14,@15                                             0648
*                                                          /*@YL026UD*/
*                                                                  0649
*              RETURN;                                     /*@YL026UD*/
         B     @EL00004                                            0649
*            END;                                          /*@YL026UD*/
*                                                                  0650
*        END VOLINDEX;                                     /*@YL026UD*/
         B     @EL00004                                            0651
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - AEPROC                                 @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSING OF SYSCTLG ALIAS ENTRIES ('AE')   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE TRUE NAME OF THE ENTRY IS SAVED          @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE 'ALIAS PROCESSING' FLAG IS TURNED ON     @YL026UD*/
*/*             TO INDICATE THAT AN ALIAS ENTRY IS BEING     @YL026UD*/
*/*             CONVERTED TO A VSAM CATALOG ALIAS ENTRY      @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - (1) THE SYSCTLG ALIAS ENTRY                     @YL026UD*/
*/*          (2) AN AREA TO SAVE THE TRUE NAME OF THE        @YL026UD*/
*/*              ALIAS ENTRY                                 @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE ALIAS NAME IS ADDED TO THE DATA SET NAME   @YL026UD*/
*/*           BEING BUILT                                    @YL026UD*/
*/*                                                          @YL026UD*/
*/*           THE TRUE NAME IS SAVED FOR USE WHEN DEFINING   @YL026UD*/
*/*           THE ALIAS DATA SET NAME(S) TO THE VSAM CATALOG @YL026UD*/
*/*                                                          @YL026UD*/
*/*           SCANNING CONTINUES AT THE NEXT LOWER INDEX     @YL026UD*/
*/*           LEVEL TO OBTAIN ALL DATA SETS UNDER THIS       @YL026UD*/
*/*           ALIAS SPECIFICATION                            @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0652
*AEPROC:   PROCEDURE;                                      /*@YL026UD*/
AEPROC   STM   @14,@02,@SA00005                                    0652
         STM   @04,@05,@SA00005+20                                 0652
         STM   @07,@12,@SA00005+28                                 0652
*        OLDERID2 = NEWERID2;                                      0653
         L     @08,@PC00001                                        0653
         L     @08,GDTTR2(,@08)                                    0653
         MVC   @TS00001(95),NEWERID2(@08)                          0653
         MVC   OLDERID2(95,@08),@TS00001                           0653
*        NEWID2 = 'CCAP';                                  /*@YL026UD*/
*                                                                  0654
         MVC   NEWID2(4,@08),@CC01150                              0654
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  SAVE THE 'TRUE' NAME FROM THE AE ENTRY          @YL026UD*/
*        /*  (AND DETERMINE ITS LENGTH)                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0655
*        TRUENAME = AETRUEN;                               /*@YL026UD*/
*                                                                  0655
         MVC   TRUENAME(8),AETRUEN(CATPTR)                         0655
*        TRUENLEN = 0;                                     /*@YL026UD*/
*                                                                  0656
         SLR   @08,@08                                             0656
         STH   @08,TRUENLEN                                        0656
*        DO INDEX = LENGTH(TRUENAME) TO 1 BY -1                    0657
*                    WHILE(TRUENLEN = 0);                  /*@YL026UD*/
*                                                                  0657
         LA    INDEX,8                                             0657
@DL00657 LH    @08,TRUENLEN                                        0657
         LTR   @08,@08                                             0657
         BNZ   @DC00657                                            0657
*          IF TRUENAME(INDEX) ^= BLANK                             0658
*            THEN                                                  0658
         LA    @08,TRUENAME-1(INDEX)                               0658
         CLI   0(@08),C' '                                         0658
         BE    @RF00658                                            0658
*              TRUENLEN = INDEX;                           /*@YL026UD*/
*                                                                  0659
         STH   INDEX,TRUENLEN                                      0659
*        END;                                              /*@YL026UD*/
*                                                                  0660
@RF00658 BCTR  INDEX,0                                             0660
         LTR   INDEX,INDEX                                         0660
         BP    @DL00657                                            0660
@DC00657 DS    0H                                                  0661
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  TURN ON 'ALIAS PROCESSING' FLAG, AND            @YL026UD*/
*        /*  CONTINUE SCANNING AT NEXT-LOWER INDEX LEVEL     @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0661
*        ALIASFLG = ON;                                    /*@YL026UD*/
*                                                                  0661
         OI    ALIASFLG,B'10000000'                                0661
*        CALL PUSHDOWN;                                    /*@YL026UD*/
*                                                                  0662
         BAL   @14,PUSHDOWN                                        0662
*        END AEPROC;                                       /*@YL026UD*/
@EL00005 DS    0H                                                  0663
@EF00005 DS    0H                                                  0663
@ER00005 LM    @14,@02,@SA00005                                    0663
         LM    @04,@05,@SA00005+20                                 0663
         LM    @07,@12,@SA00005+28                                 0663
         BR    @14                                                 0663
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - ILEPROC                                @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSING OF SYSCTLG INDEX LINK ENTRIES     @YL026UD*/
*/*             ('ILE')                                      @YL026UD*/
*/*                                                          @YL026UD*/
*/*             DETERMINES IF CONVERSION PROCESSING IS       @YL026UD*/
*/*             (1) COMPLETE FOR ENTIRE SYSCTLG DATA SET,    @YL026UD*/
*/*             (2) COMPLETE FOR A PARTICULAR INDEX LEVEL,   @YL026UD*/
*/*             (3) CONTINUED IN ANOTHER INDEX BLOCK AT      @YL026UD*/
*/*                 THE SAME INDEX LEVEL                     @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF CONVERSION PROCESSING IS COMPLETE FOR     @YL026UD*/
*/*             ENTIRE SYSCTLG DATA SET, A 'PROCESSING       @YL026UD*/
*/*             COMPLETE' FLAG IS TURNED ON                  @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF CONVERSION PROCESSING IS COMPLETE FOR     @YL026UD*/
*/*             A PARTICULAR INDEX LEVEL, THE 'POP' FLAG     @YL026UD*/
*/*             IS TURNED ON, TO INDICATE THAT SCANNING      @YL026UD*/
*/*             IS TO RETURN TO A HIGHER INDEX LEVEL         @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF CONVERSION PROCESSING IS CONTINUED IN     @YL026UD*/
*/*             ANOTHER INDEX BLOCK, THE 'CONTINUE' FLAG     @YL026UD*/
*/*             IF TURNED ON, TO OBTAIN THE CONTINUATION     @YL026UD*/
*/*             INDEX BLOCK                                  @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE SYSCTLG INDEX LINK ENTRY                    @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - (1) SCANNING CONTINUES WITHIN THE SAME INDEX   @YL026UD*/
*/*               LEVEL CONTINUATION BLOCK ('ILE' TTR ^= 0)  @YL026UD*/
*/*           (2) SCANNING CONTINUES WITHIN THE NEXT HIGHER  @YL026UD*/
*/*               LEVEL INDEX BLOCK ('ILE' TTR = 0), OR      @YL026UD*/
*/*           (3) SCANNING IS COMPLETE, AND THE 'PROCESSING  @YL026UD*/
*/*               COMPLETE' FLAG IS TURNED ON                @YL026UD*/
*/*               (VOLUME INDEX 'ILE' TTR = 0)               @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0664
*ILEPROC:  PROCEDURE;                                      /*@YL026UD*/
ILEPROC  STM   @14,@02,@SA00006                                    0664
         STM   @04,@05,@SA00006+20                                 0664
         STM   @07,@12,@SA00006+28                                 0664
*        OLDERID2 = NEWERID2;                                      0665
         L     @08,@PC00001                                        0665
         L     @08,GDTTR2(,@08)                                    0665
         MVC   @TS00001(95),NEWERID2(@08)                          0665
         MVC   OLDERID2(95,@08),@TS00001                           0665
*        NEWID2 = 'CCIP';                                  /*@YL026UD*/
*                                                                  0666
         MVC   NEWID2(4,@08),@CC01155                              0666
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DETERMINE IF THE ILE TTR CONTAINS ZERO          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0667
*        IF ILETTR = ZEROTTR                                       0667
*          THEN                                                    0667
         CLC   ILETTR(3,CATPTR),ZEROTTR                            0667
         BNE   @RF00667                                            0667
*ILEZERO:    DO;                                           /*@YL026UD*/
ILEZERO  DS    0H                                                  0669
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ILE TTR CONTAINS ZERO -                   @YL026UD*/
*              /*  FINAL ENTRY FOR CURRENT INDEX LEVEL       @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  DETERMINE IF AT VOLUME INDEX LEVEL        @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0669
*              IF LVLINDEX = 1                                     0669
*                THEN                                              0669
         CLC   LVLINDEX(2),@CH00215                                0669
         BNE   @RF00669                                            0669
*                  DO;                                     /*@YL026UD*/
*                    /************************************************/
*                    /*                                      @YL026UD*/
*                    /*  ILE IS FINAL ENTRY OF VOLUME INDEX  @YL026UD*/
*                    /*  (ENTIRE CATALOG HAS BEEN SCANNED)   @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /*  SET END FLAG TO INDICATE THAT       @YL026UD*/
*                    /*  PROCESSING IS COMPLETE              @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /************************************************/
*                                                                  0671
*                    ENDFLAG = ON;                         /*@YL026UD*/
         OI    ENDFLAG,B'10000000'                                 0671
*                  END;                                    /*@YL026UD*/
*                ELSE                                              0673
*                  DO;                                     /*@YL026UD*/
         B     @RC00669                                            0673
@RF00669 DS    0H                                                  0674
*                    /************************************************/
*                    /*                                      @YL026UD*/
*                    /*  ILE IS FINAL ENTRY OF LOWER-LEVEL   @YL026UD*/
*                    /*  INDEX -                             @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /*  TURN OFF 'GENERATION INDEX          @YL026UD*/
*                    /*  PROCESSING' (G0000V00) FLAG         @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /*  CONTINUE SCANNING AT HIGHER-LEVEL   @YL026UD*/
*                    /*  INDEX (POP-UP INDEX STATUS FROM     @YL026UD*/
*                    /*  PUSH-DOWN STACK)                    @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /************************************************/
*                                                                  0674
*                    G0V0FLAG = OFF;                       /*@YL026UD*/
*                                                                  0674
         NI    G0V0FLAG,B'01111111'                                0674
*                    CALL POPUP;                           /*@YL026UD*/
         BAL   @14,POPUP                                           0675
*                  END;                                    /*@YL026UD*/
*            END ILEZERO;                                  /*@YL026UD*/
*          ELSE                                                    0678
*ILENZERO:   DO;                                           /*@YL026UD*/
         B     @RC00667                                            0678
@RF00667 DS    0H                                                  0678
ILENZERO DS    0H                                                  0679
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ILE TTR DOES NOT CONTAIN ZERO -           @YL026UD*/
*              /*  INDEX IS CONTINUED IN ANOTHER INDEX BLOCK @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  OBTAIN CONTINUATION INDEX BLOCK           @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0679
*              CALL CONTINUE;                              /*@YL026UD*/
*                                                                  0679
         BAL   @14,CONTINUE                                        0679
*            END ILENZERO;                                 /*@YL026UD*/
*                                                                  0680
*        END ILEPROC;                                      /*@YL026UD*/
@EL00006 DS    0H                                                  0681
@EF00006 DS    0H                                                  0681
@ER00006 LM    @14,@02,@SA00006                                    0681
         LM    @04,@05,@SA00006+20                                 0681
         LM    @07,@12,@SA00006+28                                 0681
         BR    @14                                                 0681
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - DSPEPROC                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION -PROCESSING OF SYSCTLG DATA SET POINTER        @YL026UD*/
*/*            ENTRIES ('DSPE')                              @YL026UD*/
*/*                                                          @YL026UD*/
*/*            THE FOLLOWING ARE EXTRACTED FROM THE DSPE -   @YL026UD*/
*/*            (1) FINAL SEGMENT OF THE DATA SET NAME        @YL026UD*/
*/*            (2) DSCB RELATIVE TRACK ADDRESS (TTR)         @YL026UD*/
*/*            (3) DATA SET VOLUME INFORMATION               @YL026UD*/
*/*                                                          @YL026UD*/
*/*            THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE  @YL026UD*/
*/*            THE CONVERTED 'NONVSAM' OR 'ALIAS' ENTRY      @YL026UD*/
*/*            IN THE VSAM CATALOG                           @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - (1) THE SYSCTLG DATA SET POINTER ENTRY          @YL026UD*/
*/*          (2) THE ACQUIRED STORAGE AREA FOR THE DEVICE    @YL026UD*/
*/*              TYPE LIST, VOLUME SERIAL LIST, AND FILE     @YL026UD*/
*/*              SEQUENCE NUMBER LIST                        @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/
*/*           'DSPE' TO A 'NONVSAM' OR 'ALIAS' ENTRY IN      @YL026UD*/
*/*           THE VSAM CATALOG                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*           SCANNING CONTINUES WITHIN THE SAME INDEX       @YL026UD*/
*/*           BLOCK IMMEDIATELY FOLLOWING THE 'DSPE'         @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0682
*DSPEPROC: PROCEDURE;                                      /*@YL026UD*/
DSPEPROC STM   @14,@02,@SA00007                                    0682
         STM   @04,@05,@SA00007+20                                 0682
         STM   @08,@12,@SA00007+28                                 0682
*        OLDERID2 = NEWERID2;                                      0683
         L     @07,@PC00001                                        0683
         L     @07,GDTTR2(,@07)                                    0683
         MVC   @TS00001(95),NEWERID2(@07)                          0683
         MVC   OLDERID2(95,@07),@TS00001                           0683
*        NEWID2 = 'CCDP';                                  /*@YL026UD*/
*                                                                  0684
         MVC   NEWID2(4,@07),@CC01165                              0684
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ADD FINAL SEGMENT (DSPE NAME) TO DATA SET NAME  @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0685
*        DSNAME(DSNLEN+1:DSNLEN+9) = DSPENAME;             /*@YL026UD*/
*                                                                  0685
         LA    @07,DSNAME(DSNLEN)                                  0685
         MVI   8(@07),C' '                                         0685
         MVC   0(8,@07),DSPENAME(CATPTR)                           0685
*        DSNLEN = DSNLEN + LENGTH(DSPENAME);               /*@YL026UD*/
*                                                                  0686
         AL    DSNLEN,@CF00175                                     0686
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  EXTRACT DSCB TTR FROM THE DSPE ENTRY            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0687
*        DSCBTTR(1:3) = DSPETTR;                           /*@YL026UD*/
*                                                                  0687
         MVC   DSCBTTR(3),DSPETTR(CATPTR)                          0687
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  EXTRACT VOLUME INFORMATION FROM THE SYSCTLG     @YL026UD*/
*        /*  ENTRY TO BE USED IN 'DEFINING' THE VSAM         @YL026UD*/
*        /*  CATALOG ENTRY                                   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0688
*        VOLCNT = DSPEVCNT;                                /*@YL026UD*/
*                                                                  0688
         LH    @07,DSPEVCNT(,CATPTR)                               0688
         STH   @07,VOLCNT                                          0688
*        VOLSTLEN = DSPEVCNT * LENGTH(VOLSERS);            /*@YL026UD*/
*                                                                  0689
         SLA   @07,3                                               0689
         L     @05,VOLPTR                                          0689
         STH   @07,VOLSTLEN(,@05)                                  0689
*        DO DSPEINDX = 1 TO DSPEVCNT;                      /*@YL026UD*/
*                                                                  0690
         LA    DSPEINDX,1                                          0690
         B     @DE00690                                            0690
@DL00690 DS    0H                                                  0691
*          DEVTUNIT(DSPEINDX) = ' ';                       /*@YL026UD*/
         L     @07,DEVTPTR                                         0691
         LR    @05,DSPEINDX                                        0691
         MH    @05,@CH00037                                        0691
         ST    @05,@TF00001                                        0691
         ALR   @05,@07                                             0691
         AL    @05,@CF01313                                        0691
         MVI   DEVTUNIT+1(@05),C' '                                0691
         MVC   DEVTUNIT+2(6,@05),DEVTUNIT+1(@05)                   0691
         MVI   DEVTUNIT(@05),C' '                                  0691
*          DEVTCODE(DSPEINDX) = DSPEDEVT(DSPEINDX);        /*@YL026UD*/
*                                                                  0692
         AL    @07,@TF00001                                        0692
         AL    @07,@CF01314                                        0692
         LR    @05,CATPTR                                          0692
         AL    @05,@TF00001                                        0692
         MVC   DEVTCODE-8(4,@07),DSPEDEVT-12(@05)                  0692
*          VOLZERO(DSPEINDX) = 0;                          /*@YL026UD*/
         L     @07,VOLPTR                                          0693
         LR    @05,DSPEINDX                                        0693
         SLA   @05,3                                               0693
         SLR   @15,@15                                             0693
         LA    @14,0(@05,@07)                                      0693
         AL    @14,@CF01315                                        0693
         STH   @15,VOLZERO-2(,@14)                                 0693
*          VOLSER(DSPEINDX)  = DSPEDVOL(DSPEINDX);         /*@YL026UD*/
*                                                                  0694
         ALR   @07,@05                                             0694
         AL    @07,@CF01314                                        0694
         LR    @05,CATPTR                                          0694
         AL    @05,@TF00001                                        0694
         MVC   VOLSER-4(6,@07),DSPEDVOL-12(@05)                    0694
*          FILESEQ(DSPEINDX) = DSPEDSEQ(DSPEINDX);         /*@YL026UD*/
         LR    @07,DSPEINDX                                        0695
         ALR   @07,@07                                             0695
         L     @05,FILEPTR                                         0695
         ALR   @05,@07                                             0695
         AL    @05,@CF01316                                        0695
         LR    @07,CATPTR                                          0695
         AL    @07,@TF00001                                        0695
         MVC   FILESEQ(2,@05),DSPEDSEQ-12(@07)                     0695
*        END;                                              /*@YL026UD*/
*                                                                  0696
         AL    DSPEINDX,@CF00215                                   0696
@DE00690 CH    DSPEINDX,DSPEVCNT(,CATPTR)                          0696
         BNH   @DL00690                                            0696
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE CPL/FVT/FPL AND ISSUE CATALOG-ADD    @YL026UD*/
*        /*  REQUEST TO 'DEFINE' NONVSAM ENTRY               @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0697
*        CALL CATALOG;                                     /*@YL026UD*/
*                                                                  0697
         BAL   @14,CATALOG                                         0697
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DETERMINE IF ADDITIONAL CATALOG-ADD REQUEST IS  @YL026UD*/
*        /*  NECESSARY TO 'DEFINE' ALIAS ENTRY               @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THIS IS NECESSARY IF THE PREVIOUS CATALOG-ADD   @YL026UD*/
*        /*  REQUEST WAS FOR AN ALIAS DATA SET NAME, BUT THE @YL026UD*/
*        /*  REQUEST WAS NEEDED TO 'DEFINE' THE RELATED      @YL026UD*/
*        /*  TRUE DATA SET NAME FIRST ('TRUEFLG' = ON)       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0698
*        IF TRUEFLG = ON                                           0698
*          THEN                                                    0698
         TM    TRUEFLG,B'10000000'                                 0698
         BNO   @RF00698                                            0698
*            CALL CATALOG;                                 /*@YL026UD*/
*                                                                  0699
         BAL   @14,CATALOG                                         0699
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  SUBTRACT FINAL SEGMENT FROM DATA SET NAME       @YL026UD*/
*        /*  IN PREPARATION FOR SUBSEQUENT DSPES             @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0700
*        DSNLEN = DSNLEN - LENGTH(DSPENAME);               /*@YL026UD*/
*                                                                  0700
@RF00698 SL    DSNLEN,@CF00175                                     0700
*        DSNAME(DSNLEN+1:DSNLEN+9) = '        ';           /*@YL026UD*/
*                                                                  0701
         LA    @08,DSNAME(DSNLEN)                                  0701
         MVI   8(@08),C' '                                         0701
         MVC   0(8,@08),@CC01167                                   0701
*        CATPTR = CATPTR + (2 * DSPETYPE) +                        0702
*                 LENGTH(CATFORM);                         /*@YL026UD*/
*                                                                  0702
         SLR   @08,@08                                             0702
         IC    @08,DSPETYPE(,CATPTR)                               0702
         ALR   @08,@08                                             0702
         ALR   @08,CATPTR                                          0702
         AL    @08,@CF00037                                        0702
         LR    CATPTR,@08                                          0702
*        END DSPEPROC;                                     /*@YL026UD*/
@EL00007 DS    0H                                                  0703
@EF00007 DS    0H                                                  0703
@ER00007 LM    @14,@02,@SA00007                                    0703
         LM    @04,@05,@SA00007+20                                 0703
         LM    @08,@12,@SA00007+28                                 0703
         BR    @14                                                 0703
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - VCBPPROC                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSING OF SYSCTLG VOLUME CONTROL BLOCK   @YL026UD*/
*/*             POINTER ENTRIES ('VCBPE') AND THEIR          @YL026UD*/
*/*             CORRESPONDING VOLUME CONTROL BLOCKS ('VCB')  @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE FOLLOWING ARE EXTRACTED FROM THE VCBPE - @YL026UD*/
*/*             (1) FINAL SEGMENT OF THE DATA SET NAME       @YL026UD*/
*/*             (2) DSCB RELATIVE TRACK ADDRESS (TTR)        @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE DATA SET VOLUME INFORMATION IS EXTRACTED @YL026UD*/
*/*             FROM THE VCB                                 @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE @YL026UD*/
*/*             THE CONVERTED 'NONVSAM' OR 'ALIAS' ENTRY     @YL026UD*/
*/*             IN THE VSAM CATALOG                          @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - (1) THE SYSCTLG VOLUME CONTROL BLOCK POINTER    @YL026UD*/
*/*              ENTRY (AND CORRESPONDING VOLUME CONTROL     @YL026UD*/
*/*              BLOCK)                                      @YL026UD*/
*/*          (2) THE ACQUIRED STORAGE AREA FOR THE DEVICE    @YL026UD*/
*/*              TYPE LIST, VOLUME SERIAL LIST, AND FILE     @YL026UD*/
*/*              SEQUENCE NUMBER LIST                        @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/
*/*           'VCBPE' TO A 'NONVSAM' OR 'ALIAS' ENTRY IN     @YL026UD*/
*/*           THE VSAM CATALOG                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*           SCANNING CONTINUES WITHIN THE SAME INDEX       @YL026UD*/
*/*           BLOCK, IMMEDIATELY FOLLOWING THE 'VCBPE'       @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0704
*VCBPPROC: PROCEDURE;                                      /*@YL026UD*/
VCBPPROC STM   @14,@02,@SA00008                                    0704
         STM   @04,@05,@SA00008+20                                 0704
         STM   @07,@12,@SA00008+28                                 0704
*        OLDERID2 = NEWERID2;                                      0705
         L     @07,@PC00001                                        0705
         L     @07,GDTTR2(,@07)                                    0705
         MVC   @TS00001(95),NEWERID2(@07)                          0705
         MVC   OLDERID2(95,@07),@TS00001                           0705
*        NEWID2 = 'CCVP';                                  /*@YL026UD*/
*                                                                  0706
         MVC   NEWID2(4,@07),@CC01171                              0706
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ADD FINAL SEGMENT (VCBPE NAME) TO DATA SET NAME @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0707
*        DSNAME(DSNLEN+1:DSNLEN+9) = VCBPNAME;             /*@YL026UD*/
*                                                                  0707
         LA    @07,DSNAME(DSNLEN)                                  0707
         MVI   8(@07),C' '                                         0707
         MVC   0(8,@07),VCBPNAME(CATPTR)                           0707
*        DSNLEN = DSNLEN + LENGTH(VCBPNAME);               /*@YL026UD*/
*                                                                  0708
         AL    DSNLEN,@CF00175                                     0708
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  EXTRACT DSCB TTR FROM THE VCBPE ENTRY           @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0709
*        DSCBTTR(1:3) = VCBPTTR;                           /*@YL026UD*/
*                                                                  0709
         MVC   DSCBTTR(3),VCBPTTR(CATPTR)                          0709
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  SAVE VCBPE OFFSET WITHIN INDEX BLOCK -          @YL026UD*/
*        /*  PLACE THE INFORMATION IN THE PUSH-DOWN STACK    @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  CONTINUE SYSCTLG SCANNING AT THE NEXT LOWER     @YL026UD*/
*        /*  INDEX LEVEL - THE LEVEL OF THE 'VCB'            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0710
*        LVLOFSET(LVLINDEX) =                                      0710
*                (CATPTR + (2 * VCBPTYPE) +                        0710
*                LENGTH(CATFORM)) - BLOCKPTR;              /*@YL026UD*/
*                                                                  0710
         LH    @07,LVLINDEX                                        0710
         LR    @05,@07                                             0710
         ALR   @05,@05                                             0710
         SLR   @02,@02                                             0710
         IC    @02,VCBPTYPE(,CATPTR)                               0710
         ALR   @02,@02                                             0710
         ALR   @02,CATPTR                                          0710
         AL    @02,@CF00037                                        0710
         SL    @02,BLOCKPTR                                        0710
         STH   @02,LVLOFSET-2(@05)                                 0710
*        IXNLEN(LVLINDEX) = LENGTH(VCBPNAME) - 1;          /*@YL026UD*/
*                                                                  0711
         LA    @02,7                                               0711
         STH   @02,IXNLEN-2(@05)                                   0711
*        LVLINDEX = LVLINDEX + 1;                          /*@YL026UD*/
*                                                                  0712
         LA    @05,1                                               0712
         ALR   @07,@05                                             0712
         STH   @07,LVLINDEX                                        0712
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/
*                                                                  0713
         SLA   @07,8                                               0713
         L     @02,BLKLVPTR                                        0713
         AL    @02,@CF01312                                        0713
         LA    @07,BLOCK(@07,@02)                                  0713
         ST    @07,BLOCKPTR                                        0713
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE FLAGS AND INDEXES FOR VCB CHAIN      @YL026UD*/
*        /*  PROCESSING                                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0714
*        VCBINDEX = 1;                                     /*@YL026UD*/
*                                                                  0714
         STH   @05,VCBINDEX                                        0714
*        VCBDONE = NO;                                     /*@YL026UD*/
*                                                                  0715
         NI    VCBDONE,B'01111111'                                 0715
*        VOLSTLEN = 0;                                     /*@YL026UD*/
*                                                                  0716
         SLR   @07,@07                                             0716
         L     @05,VOLPTR                                          0716
         STH   @07,VOLSTLEN(,@05)                                  0716
*        VOLCNT = 0;                                       /*@YL026UD*/
*                                                                  0717
         STH   @07,VOLCNT                                          0717
*        BLOCKTTR(1:3) = VCBPTTR;                          /*@YL026UD*/
*                                                                  0718
         MVC   BLOCKTTR(3),VCBPTTR(CATPTR)                         0718
*VCBLOOP:                                                          0719
*        DO WHILE (VCBDONE = NO);                          /*@YL026UD*/
*                                                                  0719
VCBLOOP  B     @DE00719                                            0719
@DL00719 DS    0H                                                  0720
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  OBTAIN THE NEXT VCB -                         @YL026UD*/
*          /*  ISSUE THE 'UPOSIT'/'UGET' MACROS              @YL026UD*/
*          /*  TERMINATE IF AN ERROR OCCURS WHEN THE 'UGET'  @Y30SSMK*/
*          /*  MACRO IS ISSUED.                              @Y30SSMK*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0720
*          IIOCSPTR -> IOCTTR = BLOCKTTR;                  /*@YL026UD*/
*                                                                  0720
         L     @07,IIOCSPTR                                        0720
         MVC   IOCTTR(4,@07),BLOCKTTR                              0720
*          CALL IDCIOPO0(GDTTBL,IIOCSPTR);                 /*@YL026UD*/
*                                                                  0721
         L     @07,@PC00001                                        0721
         ST    @07,@AL00001                                        0721
         LA    @02,IIOCSPTR                                        0721
         ST    @02,@AL00001+4                                      0721
         MVI   @AL00001+4,X'80'                                    0721
         L     @15,GDTPOS(,@07)                                    0721
         LA    @01,@AL00001                                        0721
         BALR  @14,@15                                             0721
*          CALL IDCIOGT0(GDTTBL,IIOCSPTR);                 /*@YL026UD*/
*                                                                  0722
         L     @07,@PC00001                                        0722
         ST    @07,@AL00001                                        0722
         LA    @02,IIOCSPTR                                        0722
         ST    @02,@AL00001+4                                      0722
         MVI   @AL00001+4,X'80'                                    0722
         L     @15,GDTGET(,@07)                                    0722
         LA    @01,@AL00001                                        0722
         BALR  @14,@15                                             0722
*          RESPECIFY RTNREG RSTD;                                  0723
*          TESTRC = RTNREG;                                        0724
         LR    TESTRC,RTNREG                                       0724
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UD*/
*                                                                  0725
*          IF TESTRC ^= 0                                          0726
*            THEN                                                  0726
         LTR   TESTRC,TESTRC                                       0726
         BZ    @RF00726                                            0726
*              DO;                                         /*@YL026UD*/
*                LASTCOND = LASTCC12;                      /*@YL026UD*/
         L     @08,@PC00001+8                                      0728
         MVC   LASTCOND(2,@08),@CH00037                            0728
*                RETURN;                                   /*@YL026UD*/
@EL00008 DS    0H                                                  0729
@EF00008 DS    0H                                                  0729
@ER00008 LM    @14,@02,@SA00008                                    0729
         LM    @04,@05,@SA00008+20                                 0729
         LM    @07,@12,@SA00008+28                                 0729
         BR    @14                                                 0729
*              END;                                        /*@YL026UD*/
*                                                                  0730
*          BLOCK(LVLINDEX) = BLKREAD;                      /*@YL026UD*/
*                                                                  0731
@RF00726 LH    @07,LVLINDEX                                        0731
         SLA   @07,8                                               0731
         L     @05,BLKLVPTR                                        0731
         ALR   @05,@07                                             0731
         AL    @05,@CF01312                                        0731
         L     @07,IIOCSPTR                                        0731
         L     @07,IOCDAD(,@07)                                    0731
         MVC   BLOCK(256,@05),BLKREAD(@07)                         0731
*          CATPTR = BLOCKPTR;                              /*@YL026UD*/
*                                                                  0732
         L     CATPTR,BLOCKPTR                                     0732
*          VCBVOLIM = MIN(VCBVOLCT,VCBVOLMX);              /*@YL026UD*/
*                                                                  0733
         LH    @07,VCBVOLCT(,CATPTR)                               0733
         LA    VCBVOLIM,20                                         0733
         CR    VCBVOLIM,@07                                        0733
         BNH   *+6
         LR    VCBVOLIM,@07                                        0733
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  EXTRACT VOLUME INFORMATION FROM THE SYSCTLG   @YL026UD*/
*          /*  VCB ENTRY TO BE USED IN 'DEFINING' THE VSAM   @YL026UD*/
*          /*  CATALOG ENTRY                                 @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0734
*          VOLCNT = MAX(VOLCNT,VCBVOLCT);                  /*@YL026UD*/
*                                                                  0734
         LH    @05,VOLCNT                                          0734
         CR    @05,@07                                             0734
         BNL   *+6
         LR    @05,@07                                             0734
         STH   @05,VOLCNT                                          0734
*          VOLSTLEN = MAX(VOLSTLEN,                                0735
*                         (VCBVOLCT * LENGTH(VOLSERS)));   /*@YL026UD*/
*                                                                  0735
         L     @05,VOLPTR                                          0735
         SLA   @07,3                                               0735
         LH    @15,VOLSTLEN(,@05)                                  0735
         CR    @15,@07                                             0735
         BNL   *+6
         LR    @15,@07                                             0735
         STH   @15,VOLSTLEN(,@05)                                  0735
*          DO INDEX = 1 TO VCBVOLIM;                       /*@YL026UD*/
*                                                                  0736
         LA    INDEX,1                                             0736
         B     @DE00736                                            0736
@DL00736 DS    0H                                                  0737
*            DEVTUNIT(VCBINDEX) = ' ';                     /*@YL026UD*/
         L     @05,DEVTPTR                                         0737
         LH    @15,VCBINDEX                                        0737
         LA    @14,12                                              0737
         LR    @01,@15                                             0737
         MR    @00,@14                                             0737
         ST    @01,@TF00001                                        0737
         ALR   @01,@05                                             0737
         AL    @01,@CF01313                                        0737
         MVI   DEVTUNIT+1(@01),C' '                                0737
         MVC   DEVTUNIT+2(6,@01),DEVTUNIT+1(@01)                   0737
         MVI   DEVTUNIT(@01),C' '                                  0737
*            DEVTCODE(VCBINDEX) = VCBDEVT(INDEX);          /*@YL026UD*/
*                                                                  0738
         AL    @05,@TF00001                                        0738
         AL    @05,@CF01314                                        0738
         LR    @01,@14                                             0738
         MR    @00,INDEX                                           0738
         ST    @01,@TF00001                                        0738
         ALR   @01,CATPTR                                          0738
         AL    @01,@CF01317                                        0738
         MVC   DEVTCODE-8(4,@05),VCBDEVT-2(@01)                    0738
*            VOLZERO(VCBINDEX) = 0;                        /*@YL026UD*/
         L     @05,VOLPTR                                          0739
         LR    @14,@15                                             0739
         SLA   @14,3                                               0739
         SLR   @01,@01                                             0739
         LA    @05,0(@14,@05)                                      0739
         AL    @05,@CF01315                                        0739
         STH   @01,VOLZERO-2(,@05)                                 0739
*            VOLSER(VCBINDEX)  = VCBDVOL(INDEX);           /*@YL026UD*/
*                                                                  0740
         L     @05,VOLPTR                                          0740
         ALR   @05,@14                                             0740
         AL    @05,@CF01314                                        0740
         LR    @01,CATPTR                                          0740
         AL    @01,@TF00001                                        0740
         AL    @01,@CF01315                                        0740
         MVC   VOLSER-4(6,@05),VCBDVOL-6(@01)                      0740
*            FILESEQ(VCBINDEX) = VCBDSEQ(INDEX);           /*@YL026UD*/
*                                                                  0741
         LR    @05,@15                                             0741
         ALR   @05,@05                                             0741
         L     @01,FILEPTR                                         0741
         ALR   @01,@05                                             0741
         AL    @01,@CF01316                                        0741
         LR    @05,CATPTR                                          0741
         AL    @05,@TF00001                                        0741
         MVC   FILESEQ(2,@01),VCBDSEQ-12(@05)                      0741
*            VCBINDEX = VCBINDEX + 1;                      /*@YL026UD*/
         AL    @15,@CF00215                                        0742
         STH   @15,VCBINDEX                                        0742
*          END;                                            /*@YL026UD*/
*                                                                  0743
         AL    INDEX,@CF00215                                      0743
@DE00736 CR    INDEX,VCBVOLIM                                      0743
         BNH   @DL00736                                            0743
*          CATPTR = CATPTR + LENGTH(VCBVOLCT) +                    0744
*                            (VCBVOLMX * LENGTH(VCBVOLS)); /*@YL026UD*/
*                                                                  0744
         AL    CATPTR,@CF00948                                     0744
*          /**********************************************************/
*          /*                                                @YL026UD*/
*          /*  DETERMINE IF CURRENT VCB IS FINAL VCB IN      @YL026UD*/
*          /*  VCB CHAIN (VCB TTR = 0)                       @YL026UD*/
*          /*                                                @YL026UD*/
*          /**********************************************************/
*                                                                  0745
*          IF VCBTTR = ZEROTTR                                     0745
*            THEN                                                  0745
         CLC   VCBTTR(3,CATPTR),ZEROTTR                            0745
         BNE   @RF00745                                            0745
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  FINAL VCB -                               @YL026UD*/
*              /*  SET 'VCB PROCESSING DONE' FLAG            @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0746
*              VCBDONE = YES;                              /*@YL026UD*/
*                                                                  0746
         OI    VCBDONE,B'10000000'                                 0746
*            ELSE                                                  0747
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  NOT FINAL VCB -                           @YL026UD*/
*              /*  OBTAIN TTR OF NEXT VCB IN CHAIN           @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0747
*              BLOCKTTR(1:3) = VCBTTR;                     /*@YL026UD*/
*                                                                  0747
         B     @RC00745                                            0747
@RF00745 MVC   BLOCKTTR(3),VCBTTR(CATPTR)                          0747
*        END VCBLOOP;                                      /*@YL026UD*/
*                                                                  0748
@RC00745 DS    0H                                                  0748
@DE00719 TM    VCBDONE,B'10000000'                                 0748
         BZ    @DL00719                                            0748
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ALL VCB ENTRIES HAVE BEEN PROCESSED -           @YL026UD*/
*        /*  ALL VOLUME INFORMATION HAS BEEN PLACED          @YL026UD*/
*        /*  IN THE VOLUME LIST                              @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE CPL/FVT/FPL AND ISSUE CATALOG-ADD    @YL026UD*/
*        /*  REQUEST TO 'DEFINE' NONVSAM ENTRY               @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0749
*        CALL CATALOG;                                     /*@YL026UD*/
*                                                                  0749
         BAL   @14,CATALOG                                         0749
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DETERMINE IF ADDITIONAL CATALOG-ADD REQUEST IS  @YL026UD*/
*        /*  NECESSARY TO 'DEFINE' ALIAS ENTRY               @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THIS IS NECESSARY IF THE PREVIOUS CATALOG-ADD   @YL026UD*/
*        /*  REQUEST WAS FOR AN ALIAS DATA SET NAME, BUT THE @YL026UD*/
*        /*  REQUEST WAS NEEDED TO 'DEFINE' THE RELATED      @YL026UD*/
*        /*  TRUE DATA SET NAME FIRST ('TRUEFLG' = ON)       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0750
*        IF TRUEFLG = ON                                           0750
*          THEN                                                    0750
         TM    TRUEFLG,B'10000000'                                 0750
         BNO   @RF00750                                            0750
*            CALL CATALOG;                                 /*@YL026UD*/
*                                                                  0751
         BAL   @14,CATALOG                                         0751
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  CONTINUE SYSCTLG SCANNING AT THE NEXT HIGHER    @YL026UD*/
*        /*  INDEX LEVEL - THE LEVEL OF THE 'VCBPE'          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0752
*        CALL POPUP;                                       /*@YL026UD*/
*                                                                  0752
@RF00750 BAL   @14,POPUP                                           0752
*        END VCBPPROC;                                     /*@YL026UD*/
         B     @EL00008                                            0753
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - GIPEPROC                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSING OF SYSCTLG GENERATION INDEX       @YL026UD*/
*/*             POINTER ENTRIES ('GIPE')                     @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE 'ALIAS PROCESSING' FLAG IS TURNED ON, @YL026UD*/
*/*             NO CONVERSION IS PERFORMED ON THE 'GIPE'     @YL026UD*/
*/*             (VSAM DOES NOT ALLOW ALIASES OF 'GDG BASE')  @YL026UD*/
*/*             ENTRIES).  AN INFORMATIONAL MESSAGE IS       @YL026UD*/
*/*             PRINTED, EXPLAINING THE NON-CONVERSION       @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE 'ALIAS PROCESSING' FLAG IS 'OFF',     @YL026UD*/
*/*             THE FOLLOWING ARE EXTRACTED FROM THE GIPE -  @YL026UD*/
*/*             (1) FINAL SEGMENT OF DATA SET NAME           @YL026UD*/
*/*             (2) MAXIMUM GENERATION COUNT                 @YL026UD*/
*/*             (3) GENERATION DATA GROUP OPTION FLAGS       @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE @YL026UD*/
*/*             THE CONVERTED 'GDG BASE' ENTRY IN THE VSAM   @YL026UD*/
*/*             CATALOG                                      @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE 'G0000V00 PROCESSING' FLAG IS TURNED ON  @YL026UD*/
*/*             TO INDICATE THAT SUBSEQUENT (GENERATION      @YL026UD*/
*/*             INDEX) PROCESSING WILL TAKE PLACE            @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE SYSCTLG GENERATION INDEX POINTER ENTRY      @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - (1) IF THE 'ALIAS PROCESSING' FLAG IS 'ON',    @YL026UD*/
*/*           AN INFORMATIONAL MESSAGE EXPLAINING THE        @YL026UD*/
*/*           'GIPE' ALIAS NON-CONVERSION, OR                @Y30SSMK*/
*/*           (2) IF THE 'ALIAS PROCESSING' FLAG IS 'OFF',   @YL026UD*/
*/*           THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/
*/*           'GIPE' TO A 'GDG BASE' ENTRY IN THE VSAM       @YL026UD*/
*/*           CATALOG                                        @YL026UD*/
*/*                                                          @YL026UD*/
*/*           SCANNING CONTINUES WITHIN THE NEXT-LOWER       @YL026UD*/
*/*           LEVEL INDEX (THE GENERATION INDEX) TO          @YL026UD*/
*/*           CONVERT ALL GENERATIONS (G0000V00 ENTRIES)     @YL026UD*/
*/*           WHICH ARE ASSOCIATED WITH THE 'GIPE'           @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0754
*GIPEPROC: PROCEDURE;                                      /*@YL026UD*/
GIPEPROC STM   @14,@02,@SA00009                                    0754
         STM   @04,@05,@SA00009+20                                 0754
         STM   @07,@12,@SA00009+28                                 0754
*        OLDERID2 = NEWERID2;                                      0755
         L     @07,@PC00001                                        0755
         L     @05,GDTTR2(,@07)                                    0755
         MVC   @TS00001(95),NEWERID2(@05)                          0755
         MVC   OLDERID2(95,@05),@TS00001                           0755
*        NEWID2 = 'CCGP';                                  /*@YL026UD*/
*                                                                  0756
         MVC   NEWID2(4,@05),@CC01178                              0756
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ADD FINAL SEGMENT (GIPE NAME) TO DATA SET NAME  @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0757
*        DSNAME(DSNLEN+1:DSNLEN+9) = GIPENAME;             /*@YL026UD*/
*                                                                  0757
         LA    @05,DSNAME(DSNLEN)                                  0757
         MVI   8(@05),C' '                                         0757
         MVC   0(8,@05),GIPENAME(CATPTR)                           0757
*        DSNLEN = DSNLEN + LENGTH(GIPENAME);               /*@YL026UD*/
*                                                                  0758
         AL    DSNLEN,@CF00175                                     0758
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DETERMINE IF 'ALIAS PROCESSING' FLAG IS 'ON' -  @YL026UD*/
*        /*  ALIASES OF VSAM 'GDG BASE' ENTRIES              @YL026UD*/
*        /*  ARE NOT ALLOWED                                 @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0759
*        IF ALIASFLG = ON                                          0759
*          THEN                                                    0759
         TM    ALIASFLG,B'10000000'                                0759
         BNO   @RF00759                                            0759
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  'ALIAS PROCESSING' FLAG IS TURNED ON -    @YL026UD*/
*              /*  'GIPE' ALIAS ENTRY CANNOT BE CONVERTED    @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  PRINT INFORMATIONAL MESSAGE AND CONTINUE  @YL026UD*/
*              /*  SYSCTLG SCANNING AT SAME INDEX LEVEL      @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0761
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          0761
         MVC   DARGSMOD(3,@08),@CC00831                            0761
*              DARGSENT = GDGAMSG#;                        /*@YL026UD*/
*                                                                  0762
         MVI   DARGSENT(@08),X'0E'                                 0762
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0763
         ST    @07,@AL00001                                        0763
         LA    @08,@CF00113                                        0763
         ST    @08,@AL00001+4                                      0763
         LA    @08,DDSTRU                                          0763
         ST    @08,@AL00001+8                                      0763
         MVI   @AL00001+8,X'80'                                    0763
         L     @15,GDTPRT(,@07)                                    0763
         LA    @01,@AL00001                                        0763
         BALR  @14,@15                                             0763
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/
*                                                                  0764
         L     @08,DDSTRU                                          0764
         MVI   DARGSENT(@08),X'09'                                 0764
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @07,DSNAME                                          0765
         ST    @07,DARGDBP(,@08)                                   0765
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/
*                                                                  0766
         MVC   DARGILP(2,@08),@CH00583                             0766
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0767
         L     @08,@PC00001                                        0767
         ST    @08,@AL00001                                        0767
         LA    @07,@CF00113                                        0767
         ST    @07,@AL00001+4                                      0767
         LA    @07,DDSTRU                                          0767
         ST    @07,@AL00001+8                                      0767
         MVI   @AL00001+8,X'80'                                    0767
         L     @15,GDTPRT(,@08)                                    0767
         LA    @01,@AL00001                                        0767
         BALR  @14,@15                                             0767
*              LASTCOND = LASTCC04;                        /*@YL026UD*/
*                                                                  0768
         L     @08,@PC00001+8                                      0768
         MVC   LASTCOND(2,@08),@CH00042                            0768
*              DSNLEN = DSNLEN - LENGTH(GIPENAME);         /*@YL026UD*/
*                                                                  0769
         SL    DSNLEN,@CF00175                                     0769
*              DSNAME(DSNLEN+1:DSNLEN+9) = '        ';     /*@YL026UD*/
*                                                                  0770
         LA    @08,DSNAME(DSNLEN)                                  0770
         MVI   8(@08),C' '                                         0770
         MVC   0(8,@08),@CC01167                                   0770
*              CATPTR = CATPTR + (2 * GIPETYPE) +                  0771
*                       LENGTH(CATFORM);                   /*@YL026UD*/
*                                                                  0771
         SLR   @08,@08                                             0771
         IC    @08,GIPETYPE(,CATPTR)                               0771
         ALR   @08,@08                                             0771
         ALR   @08,CATPTR                                          0771
         AL    @08,@CF00037                                        0771
         LR    CATPTR,@08                                          0771
*              RETURN;                                     /*@YL026UD*/
*                                                                  0772
@EL00009 DS    0H                                                  0772
@EF00009 DS    0H                                                  0772
@ER00009 LM    @14,@02,@SA00009                                    0772
         LM    @04,@05,@SA00009+20                                 0772
         LM    @07,@12,@SA00009+28                                 0772
         BR    @14                                                 0772
*            END;                                          /*@YL026UD*/
*                                                                  0773
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  FLAG THE ENTRY AS A 'GIPE' ENTRY                @YL026UD*/
*        /*  AND EXTRACT THE MAXIMUM GENERATION              @YL026UD*/
*        /*  COUNT AND GDG OPTION FLAGS FROM THE             @YL026UD*/
*        /*  GIPE ENTRY TO BE USED IN DEFINING THE           @YL026UD*/
*        /*  'GDG BASE' ENTRY IN THE VSAM CATALOG            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0774
*        GDGFLAG = ON;                                     /*@YL026UD*/
*                                                                  0774
@RF00759 OI    GDGFLAG,B'10000000'                                 0774
*        GDGLIMIT = GIPEMCNT;                              /*@YL026UD*/
*                                                                  0775
         MVC   GDGLIMIT(1),GIPEMCNT(CATPTR)                        0775
*        GDGATTR = 0;                                      /*@YL026UD*/
*                                                                  0776
         MVI   GDGATTR,X'00'                                       0776
*        IF GIPEFEMP = ON                                          0777
*          THEN                                                    0777
         TM    GIPEFEMP(CATPTR),B'00000001'                        0777
         BNO   @RF00777                                            0777
*            GDGATTR = GDGEMPTY;                           /*@YL026UD*/
*                                                                  0778
         MVI   GDGATTR,X'80'                                       0778
*        IF GIPEFDEL = ON                                          0779
*          THEN                                                    0779
@RF00777 TM    GIPEFDEL(CATPTR),B'00000010'                        0779
         BNO   @RF00779                                            0779
*            GDGATTR = GDGATTR + GDGDELET;                 /*@YL026UD*/
*                                                                  0780
         LA    @07,64                                              0780
         SLR   @05,@05                                             0780
         IC    @05,GDGATTR                                         0780
         ALR   @07,@05                                             0780
         STC   @07,GDGATTR                                         0780
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE CPL/FVT AND ISSUE                    @YL026UD*/
*        /*  CATALOG-ADD REQUEST TO 'DEFINE'                 @YL026UD*/
*        /*  THE 'GDG BASE' ENTRY                            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0781
*        CALL CATALOG;                                     /*@YL026UD*/
*                                                                  0781
@RF00779 BAL   @14,CATALOG                                         0781
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  PROCESS THE GENERATION INDEX                    @YL026UD*/
*        /*  (NEXT LOWER INDEX LEVEL) ASSOCIATED             @YL026UD*/
*        /*  WITH THE GIPE ENTRY JUST PROCESSED              @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  FLAG SUBSEQUENT PROCESSING AS                   @YL026UD*/
*        /*  'GENERATION INDEX' (G0000V00)                   @YL026UD*/
*        /*  PROCESSING                                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0782
*        DSNLEN = DSNLEN - LENGTH(GIPENAME);               /*@YL026UD*/
*                                                                  0782
         SL    DSNLEN,@CF00175                                     0782
*        GDGFLAG = OFF;                                    /*@YL026UD*/
*                                                                  0783
         NI    GDGFLAG,B'01111111'                                 0783
*        G0V0FLAG = ON;                                    /*@YL026UD*/
*                                                                  0784
         OI    G0V0FLAG,B'10000000'                                0784
*        CALL PUSHDOWN;                                    /*@YL026UD*/
*                                                                  0785
         BAL   @14,PUSHDOWN                                        0785
*        END GIPEPROC;                                     /*@YL026UD*/
         B     @EL00009                                            0786
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - CVPEPROC                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSES SYSCTLG CONTROL VOLUME POINTER     @YL026UD*/
*/*             ENTRIES ('CVPE')                             @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE FOLLOWING ARE EXTRACTED FROM THE CVPE -  @YL026UD*/
*/*             (1) THE CVPE NAME                            @YL026UD*/
*/*             (2) THE CONNECTED CONTROL VOLUME NAME        @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE CONNECTED CONTROL VOLUME NAME (FROM THE  @YL026UD*/
*/*             CVPE) IS COMPARED WITH THE VOLUME NAMES      @YL026UD*/
*/*             LISTED IN THE 'CVOLEQUATES' PARAMETER.       @YL026UD*/
*/*             IF A MATCHING VOLUME NAME IS FOUND, THEN     @YL026UD*/
*/*             THE CVPE ENTRY IS CONVERTED INTO AN ALIAS    @YL026UD*/
*/*             (ENTRY TYPE = 'X') ENTRY IN THE VSAM MASTER  @YL026UD*/
*/*             CATALOG.  THE ALIAS NAME IS THE CVPE NAME,   @YL026UD*/
*/*             AND THE TRUE NAME IS THE CATALOG NAME IN     @YL026UD*/
*/*             THE 'CVOLEQAUTES' PARAMETER CORRESPONDING    @YL026UD*/
*/*             TO THE MATCHING VOLUME NAME.                 @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE 'CATALOG' PROCEDURE IS INVOKED TO DEFINE @YL026UD*/
*/*             THE CONVERTED 'ALAIS' ENTRY IN THE VSAM      @YL026UD*/
*/*             MASTER CATALOG                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - (1) THE SYSCTLG CONTROL VOLUME POINTER ENTRY    @YL026UD*/
*/*          (2) THE 'CVOLEQUATES' PARAMETER VALUES, AND     @YL026UD*/
*/*              THE 'MASTERCATALOG' PARAMETER VALUES        @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE SUCCESSFULLY OR UNSUCCESSFULLY CONVERTED   @YL026UD*/
*/*           'CVPE' TO AN 'ALIAS' ENTRY IN THE VSAM MASTER  @YL026UD*/
*/*           CATALOG                                        @YL026UD*/
*/*                                                          @YL026UD*/
*/*           SCANNING CONTINUES WITHIN THE VOLUME INDEX,    @YL026UD*/
*/*           IMMEDIATELY FOLLOWING THE 'CVPE'               @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0787
*CVPEPROC: PROCEDURE;                                      /*@YL026UD*/
CVPEPROC STM   @14,@02,@SA00010                                    0787
         STM   @04,@06,@SA00010+20                                 0787
         STM   @08,@12,@SA00010+32                                 0787
*        OLDERID2 = NEWERID2;                                      0788
         L     @05,@PC00001                                        0788
         L     @05,GDTTR2(,@05)                                    0788
         MVC   @TS00001(95),NEWERID2(@05)                          0788
         MVC   OLDERID2(95,@05),@TS00001                           0788
*        NEWID2 = 'CCCP';                                  /*@YL026UD*/
*                                                                  0789
         MVC   NEWID2(4,@05),@CC01182                              0789
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN CONTROL VOLUME SERIAL NUMBER             @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0790
*        IF CATETYPE = TYPECVPE(1)                                 0790
*          THEN                                                    0790
         CLC   CATETYPE(1,CATPTR),TYPECVPE                         0790
         BNE   @RF00790                                            0790
*            CVPEVOL = CVP1VOL;                            /*@YL026UD*/
         MVC   CVPEVOL(6),CVP1VOL(CATPTR)                          0791
*          ELSE                                                    0792
*            CVPEVOL = CVP2VOL;                            /*@YL026UD*/
*                                                                  0792
         B     @RC00790                                            0792
@RF00790 MVC   CVPEVOL(6),CVP2VOL(CATPTR)                          0792
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  COMPARE THE CONTROL VOLUME NUMBER               @YL026UD*/
*        /*  FROM THE CVPE ENTRY WITH THE VOLUME             @YL026UD*/
*        /*  SERIAL NUMBERS IN THE 'CVOLEQUATES'             @YL026UD*/
*        /*  PARAMETER, IF SPECIFIED                         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0793
*        IF ADDR(CVEQU) ^= NULLPTR                                 0793
*          THEN                                                    0793
@RC00790 L     @05,@PC00001+4                                      0793
         L     @05,FDTPTR+20(,@05)                                 0793
         LTR   @05,@05                                             0793
         BZ    @RF00793                                            0793
*            /********************************************************/
*            /*                                              @YL026UD*/
*            /*  'CVOLEQUATES' SPECIFIED -                   @YL026UD*/
*            /*  SEARCH ALL 'CVOLEQUATES'                    @YL026UD*/
*            /*  VOLUME SERIAL LISTS                         @YL026UD*/
*            /*                                              @YL026UD*/
*            /********************************************************/
*                                                                  0794
*CVPE1:      DO CVENINDX = 1 TO CVEQUCNT                           0794
*                       WHILE(CVPEFLAG = OFF);             /*@YL026UD*/
*                                                                  0794
CVPE1    LA    CVENINDX,1                                          0794
         B     @DE00794                                            0794
@DL00794 TM    CVPEFLAG,B'10000000'                                0794
         BNZ   @DC00794                                            0794
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  SEARCH EACH VOLUME NUMBER                 @YL026UD*/
*              /*  WITHIN A VOLUME SERIAL LIST               @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0795
*CVPE2:        DO CVEVINDX = 1 TO CVEVSPTR(CVENINDX) ->            0795
*                         CVEVSCNT                                 0795
*                         WHILE(CVPEFLAG = OFF);           /*@YL026UD*/
*                                                                  0795
CVPE2    LA    CVEVINDX,1                                          0795
         B     @DE00795                                            0795
@DL00795 TM    CVPEFLAG,B'10000000'                                0795
         BNZ   @DC00795                                            0795
*                IF CVPEVOL = CVEVSPTR(CVENINDX) ->                0796
*                             CVEVSVAL(CVEVINDX)                   0796
*                  THEN                                            0796
         LR    @15,CVEVINDX                                        0796
         SLA   @15,3                                               0796
         LR    @14,CVENINDX                                        0796
         SLA   @14,2                                               0796
         L     @01,@PC00001+4                                      0796
         L     @01,FDTPTR+28(,@01)                                 0796
         AL    @01,@CF01314                                        0796
         L     @01,CVEVSPTR(@14,@01)                               0796
         ALR   @01,@15                                             0796
         AL    @01,@CF01318                                        0796
         CLC   CVPEVOL(6),CVEVSVAL-3(@01)                          0796
         BNE   @RF00796                                            0796
*                    DO;                                   /*@YL026UD*/
*                      /**********************************************/
*                      /*                                    @YL026UD*/
*                      /*  A MATCHING VOLUME HAS             @YL026UD*/
*                      /*  BEEN FOUND -                      @YL026UD*/
*                      /*  'DEFINE' THE CVPE ENTRY           @YL026UD*/
*                      /*  NAME AS A MASTER CATALOG          @YL026UD*/
*                      /*  ALIAS ENTRY TO THE                @YL026UD*/
*                      /*  CORRESPONDING CATALOG             @YL026UD*/
*                      /*  NAME FROM THE                     @YL026UD*/
*                      /*  'CVOLEQUATES' PARAMETER           @YL026UD*/
*                      /*                                    @YL026UD*/
*                      /**********************************************/
*                                                                  0798
*                      DSNAME(1:8) = CATENAME;             /*@YL026UD*/
*                                                                  0798
         MVC   DSNAME(8),CATENAME(CATPTR)                          0798
*                      TRUEDSN = CVECNPTR(CVENINDX) ->             0799
*                                CVECNVAL;                 /*@YL026UD*/
*                                                                  0799
         L     @15,@PC00001+4                                      0799
         L     @01,FDTPTR+24(,@15)                                 0799
         AL    @01,@CF01314                                        0799
         L     @01,CVECNPTR(@14,@01)                               0799
         MVC   TRUEDSN(44),CVECNVAL(@01)                           0799
*                      CVPEFLAG = ON;                      /*@YL026UD*/
*                                                                  0800
         OI    CVPEFLAG,B'10000000'                                0800
*                      CALL CATALOG;                       /*@YL026UD*/
         BAL   @14,CATALOG                                         0801
*                    END;                                  /*@YL026UD*/
*                                                                  0802
*              END CVPE2;                                  /*@YL026UD*/
*                                                                  0803
@RF00796 AL    CVEVINDX,@CF00215                                   0803
@DE00795 LR    @15,CVENINDX                                        0803
         SLA   @15,2                                               0803
         L     @14,@PC00001+4                                      0803
         L     @01,FDTPTR+28(,@14)                                 0803
         AL    @01,@CF01314                                        0803
         L     @01,CVEVSPTR(@15,@01)                               0803
         CH    CVEVINDX,CVEVSCNT(,@01)                             0803
         BNH   @DL00795                                            0803
@DC00795 DS    0H                                                  0804
*            END CVPE1;                                    /*@YL026UD*/
*                                                                  0804
         AL    CVENINDX,@CF00215                                   0804
@DE00794 L     @05,@PC00001+4                                      0804
         LA    @05,FDTPTR+20(,@05)                                 0804
         C     CVENINDX,CVEQUCNT(,@05)                             0804
         BNH   @DL00794                                            0804
@DC00794 DS    0H                                                  0805
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF A MATCHING VOLUME NUMBER WAS NOT             @YL026UD*/
*        /*  FOUND IN THE 'CVOLEQUATES' PARAMETER            @YL026UD*/
*        /*  THEN PRINT 'CVPE ENTRY NOT CONVERTED'           @YL026UD*/
*        /*  MESSAGE                                         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0805
*        IF CVPEFLAG = ON                                          0805
*          THEN                                                    0805
@RF00793 TM    CVPEFLAG,B'10000000'                                0805
         BNO   @RF00805                                            0805
*            CVPEFLAG = OFF;                               /*@YL026UD*/
         NI    CVPEFLAG,B'01111111'                                0806
*          ELSE                                                    0807
*            DO;                                           /*@YL026UD*/
         B     @RC00805                                            0807
@RF00805 DS    0H                                                  0808
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          0808
         MVC   DARGSMOD(3,@08),@CC00831                            0808
*              DARGSENT = CVPEMSG#;                        /*@YL026UD*/
*                                                                  0809
         MVI   DARGSENT(@08),X'02'                                 0809
*              CVPTXTNM = CATENAME;                        /*@YL026UD*/
         MVC   CVPTXTNM(8),CATENAME(CATPTR)                        0810
*              CVPTXTVL = CVPEVOL;                         /*@YL026UD*/
*                                                                  0811
         MVC   CVPTXTVL(6),CVPEVOL                                 0811
*              DARGDBP = ADDR(CVPETEXT);                   /*@YL026UD*/
         LA    @06,CVPETEXT                                        0812
         ST    @06,DARGDBP(,@08)                                   0812
*              DARGILP = LENGTH(CVPETEXT);                 /*@YL026UD*/
*                                                                  0813
         MVC   DARGILP(2,@08),@CH00847                             0813
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0814
         L     @08,@PC00001                                        0814
         ST    @08,@AL00001                                        0814
         LA    @06,@CF00113                                        0814
         ST    @06,@AL00001+4                                      0814
         LA    @06,DDSTRU                                          0814
         ST    @06,@AL00001+8                                      0814
         MVI   @AL00001+8,X'80'                                    0814
         L     @15,GDTPRT(,@08)                                    0814
         LA    @01,@AL00001                                        0814
         BALR  @14,@15                                             0814
*              LASTCOND = LASTCC04;                        /*@YL026UD*/
*                                                                  0815
         L     @08,@PC00001+8                                      0815
         MVC   LASTCOND(2,@08),@CH00042                            0815
*            END;                                          /*@YL026UD*/
*                                                                  0816
*        CATPTR = CATPTR + (2*CATETYPE) +                          0817
*                 LENGTH(CATFORM);                         /*@YL026UD*/
*                                                                  0817
@RC00805 SLR   @08,@08                                             0817
         IC    @08,CATETYPE(,CATPTR)                               0817
         ALR   @08,@08                                             0817
         ALR   @08,CATPTR                                          0817
         AL    @08,@CF00037                                        0817
         LR    CATPTR,@08                                          0817
*        END CVPEPROC;                                     /*@YL026UD*/
@EL00010 DS    0H                                                  0818
@EF00010 DS    0H                                                  0818
@ER00010 LM    @14,@02,@SA00010                                    0818
         LM    @04,@06,@SA00010+20                                 0818
         LM    @08,@12,@SA00010+32                                 0818
         BR    @14                                                 0818
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - PUSHDOWN                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSES THE CHANGE FROM ONE SYSCTLG INDEX  @YL026UD*/
*/*             LEVEL TO A LOWER SYSCTLG INDEX LEVEL         @YL026UD*/
*/*             WHILE SCANNING THE SYSCTLG DATA SET          @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE CURRENT INDEX SCANNING STATUS IS SAVED - @YL026UD*/
*/*             I.E., THE OFFSET WITHIN THE INDEX BLOCK      @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE INDEX NAME IS EXTRACTED FROM THE         @YL026UD*/
*/*             CURRENT INDEX ENTRY IS ADDED TO THE DATA     @YL026UD*/
*/*             SET NAME BEING BUILT                         @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE LOWER LEVEL SYSCTLG INDEX BLOCK IS       @YL026UD*/
*/*             OBTAINED (VIA THE 'UPOSIT'/'UGET' MACROS)    @YL026UD*/
*/*             FROM TTR INFORMATION IN THE CURRENT INDEX    @YL026UD*/
*/*             ENTRY ('IPE', 'GIPE', OR 'AE' ENTRY)         @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE FIRST ENTRY IN THE LOWER LEVEL INDEX     @YL026UD*/
*/*             BLOCK IS VERIFIED TO BE AN INDEX CONTROL     @YL026UD*/
*/*             ENTRY ('ICE')                                @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE LOWER LEVEL INDEX BLOCK CANNOT BE     @YL026UD*/
*/*             OBTAINED, OR IF THE 'ICE' CANNOT BE          @YL026UD*/
*/*             VERIFIED, PROCESSING IS TERMINATED           @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - (1) THE OFFSET WITHIN THE CURRENT SYSCTLG       @YL026UD*/
*/*              BLOCK, AND THE PUSH-DOWN STACK IN WHICH     @YL026UD*/
*/*              THE OFFSET IS SAVED                         @YL026UD*/
*/*          (2) THE RELATIVE TRACK ADDRESS (TTR) OF THE     @YL026UD*/
*/*              NEXT-LOWER LEVEL SYSCTLG INDEX BLOCK AT     @YL026UD*/
*/*              WHICH SCANNING IS TO CONTINUE               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE ACQUIRED FIRST BLOCK OF THE NEXT-LOWER     @YL026UD*/
*/*           SYSCTLG INDEX WITH SCANNING POINTERS           @YL026UD*/
*/*           POSITIONED FOLLOWING THE 'ICE'                 @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0819
*PUSHDOWN: PROCEDURE;                                      /*@YL026UD*/
PUSHDOWN STM   @14,@02,@SA00011                                    0819
         STM   @04,@05,@SA00011+20                                 0819
         STM   @07,@12,@SA00011+28                                 0819
*        OLDERID2 = NEWERID2;                                      0820
         L     @08,@PC00001                                        0820
         L     @08,GDTTR2(,@08)                                    0820
         MVC   @TS00001(95),NEWERID2(@08)                          0820
         MVC   OLDERID2(95,@08),@TS00001                           0820
*        NEWID2 = 'CCPH';                                  /*@YL026UD*/
*                                                                  0821
         MVC   NEWID2(4,@08),@CC01190                              0821
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  SAVE CURRENT INDEX SCANNING STATUS -            @YL026UD*/
*        /*  THE OFFSET WITHIN THE CURRENT INDEX BLOCK       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0822
*        LVLOFSET(LVLINDEX) = (CATPTR +                            0822
*                (2*CATETYPE) + LENGTH(CATFORM)) -                 0822
*                BLOCKPTR;                                 /*@YL026UD*/
*                                                                  0822
         LH    @08,LVLINDEX                                        0822
         ALR   @08,@08                                             0822
         SLR   @07,@07                                             0822
         IC    @07,CATETYPE(,CATPTR)                               0822
         ALR   @07,@07                                             0822
         ALR   @07,CATPTR                                          0822
         AL    @07,@CF00037                                        0822
         SL    @07,BLOCKPTR                                        0822
         STH   @07,LVLOFSET-2(@08)                                 0822
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ADD INDEX NAME TO DATA SET NAME BEING BUILT     @YL026UD*/
*        /*  (DETERMINE LENGTH OF INDEX NAME)                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0823
*        IXNLEN(LVLINDEX) = 0;                             /*@YL026UD*/
*                                                                  0823
         SLR   @07,@07                                             0823
         STH   @07,IXNLEN-2(@08)                                   0823
*        DO INDEX = LENGTH(CATENAME) TO 1 BY -1                    0824
*                    WHILE(IXNLEN(LVLINDEX) = 0);          /*@YL026UD*/
*                                                                  0824
         LA    INDEX,8                                             0824
@DL00824 LH    @08,LVLINDEX                                        0824
         ALR   @08,@08                                             0824
         LH    @02,IXNLEN-2(@08)                                   0824
         LTR   @02,@02                                             0824
         BNZ   @DC00824                                            0824
*          IF CATENAME(INDEX) ^= BLANK                             0825
*            THEN                                                  0825
         LR    @02,CATPTR                                          0825
         ALR   @02,INDEX                                           0825
         AL    @02,@CF01151                                        0825
         CLI   CATENAME(@02),C' '                                  0825
         BE    @RF00825                                            0825
*              IXNLEN(LVLINDEX) = INDEX;                   /*@YL026UD*/
*                                                                  0826
         STH   INDEX,IXNLEN-2(@08)                                 0826
*        END;                                              /*@YL026UD*/
*                                                                  0827
@RF00825 BCTR  INDEX,0                                             0827
         LTR   INDEX,INDEX                                         0827
         BP    @DL00824                                            0827
@DC00824 DS    0H                                                  0828
*        DSNAME(DSNLEN + 1:DSNLEN + IXNLEN(LVLINDEX) + 1)          0828
*                              = CATENAME;                 /*@YL026UD*/
*                                                                  0828
         LA    @08,DSNAME(DSNLEN)                                  0828
         LH    @07,LVLINDEX                                        0828
         LR    @04,@07                                             0828
         ALR   @04,@04                                             0828
         LH    @04,IXNLEN-2(@04)                                   0828
         EX    @04,@SM01319                                        0828
*        DSNLEN = DSNLEN + IXNLEN(LVLINDEX);               /*@YL026UD*/
*                                                                  0829
         ALR   DSNLEN,@04                                          0829
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ADD A PERIOD TO THE DATA SET NAME -             @YL026UD*/
*        /*  TO SEPARATE SEGMENT JUST ADDED FROM THE NEXT    @YL026UD*/
*        /*  INDEX LEVEL NAME SEGMENT TO BE ADDED            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0830
*        DSNAME(DSNLEN + 1) = PERIOD;                      /*@YL026UD*/
*                                                                  0830
         LA    @08,DSNAME(DSNLEN)                                  0830
         MVI   0(@08),C'.'                                         0830
*        DSNLEN = DSNLEN + 1;                              /*@YL026UD*/
*                                                                  0831
         LA    @08,1                                               0831
         ALR   DSNLEN,@08                                          0831
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN THE LOWER LEVEL INDEX BLOCK              @YL026UD*/
*        /*  ('UPOSIT'/'UGET' MACROS)                        @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0832
*        LVLINDEX = LVLINDEX + 1;                          /*@YL026UD*/
*                                                                  0832
         ALR   @07,@08                                             0832
         STH   @07,LVLINDEX                                        0832
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/
*                                                                  0833
         SLA   @07,8                                               0833
         L     @08,BLKLVPTR                                        0833
         AL    @08,@CF01312                                        0833
         LA    @08,BLOCK(@07,@08)                                  0833
         ST    @08,BLOCKPTR                                        0833
*        BLOCKTTR(1:3) = CATETTR;                          /*@YL026UD*/
*                                                                  0834
         MVC   BLOCKTTR(3),CATETTR(CATPTR)                         0834
*        IIOCSPTR -> IOCTTR = BLOCKTTR;                    /*@YL026UD*/
*                                                                  0835
         L     @08,IIOCSPTR                                        0835
         MVC   IOCTTR(4,@08),BLOCKTTR                              0835
*        CALL IDCIOPO0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0836
         L     @08,@PC00001                                        0836
         ST    @08,@AL00001                                        0836
         LA    @07,IIOCSPTR                                        0836
         ST    @07,@AL00001+4                                      0836
         MVI   @AL00001+4,X'80'                                    0836
         L     @15,GDTPOS(,@08)                                    0836
         LA    @01,@AL00001                                        0836
         BALR  @14,@15                                             0836
*        CALL IDCIOGT0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0837
         L     @08,@PC00001                                        0837
         ST    @08,@AL00001                                        0837
         LA    @07,IIOCSPTR                                        0837
         ST    @07,@AL00001+4                                      0837
         MVI   @AL00001+4,X'80'                                    0837
         L     @15,GDTGET(,@08)                                    0837
         LA    @01,@AL00001                                        0837
         BALR  @14,@15                                             0837
*        RESPECIFY RTNREG RSTD;                                    0838
*        TESTRC = RTNREG;                                          0839
         LR    TESTRC,RTNREG                                       0839
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0840
*        IF TESTRC ^= 0                                            0841
*          THEN                                                    0841
         LTR   TESTRC,TESTRC                                       0841
         BZ    @RF00841                                            0841
*            DO;                                           /*@YL026UD*/
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
         L     @08,@PC00001+8                                      0843
         MVC   LASTCOND(2,@08),@CH00037                            0843
*              RETURN;                                     /*@YL026UD*/
@EL00011 DS    0H                                                  0844
@EF00011 DS    0H                                                  0844
@ER00011 LM    @14,@02,@SA00011                                    0844
         LM    @04,@05,@SA00011+20                                 0844
         LM    @07,@12,@SA00011+28                                 0844
         BR    @14                                                 0844
*            END;                                          /*@YL026UD*/
*                                                                  0845
*        BLOCK(LVLINDEX) = BLKREAD;                        /*@YL026UD*/
*                                                                  0846
@RF00841 LH    @08,LVLINDEX                                        0846
         SLA   @08,8                                               0846
         L     @07,BLKLVPTR                                        0846
         ALR   @07,@08                                             0846
         AL    @07,@CF01312                                        0846
         L     @08,IIOCSPTR                                        0846
         L     @08,IOCDAD(,@08)                                    0846
         MVC   BLOCK(256,@07),BLKREAD(@08)                         0846
*        CATPTR = BLOCKPTR + LENGTH(BLOCKCNT);             /*@YL026UD*/
*                                                                  0847
         LA    CATPTR,2                                            0847
         AL    CATPTR,BLOCKPTR                                     0847
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT TO DUMP INPUT SYSCTLG BLOCK          @Y30SSMK*/
*        /*  OBTAINED AT SAME INDEX AS LAST BLOCK.           @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0848
*        IF GDTDBG = NULLPTR                                       0848
*          THEN;                                                   0848
         L     @08,@PC00001                                        0848
         L     @08,GDTDBG(,@08)                                    0848
         LTR   @08,@08                                             0848
         BZ    @RT00848                                            0848
*          ELSE                                                    0850
*            CALL IDCDB010(GDTTBL,'CCPD',ADDR(DLISTBLK));          0850
         L     @08,@PC00001                                        0850
         ST    @08,@AL00001                                        0850
         LA    @07,@CC01191                                        0850
         ST    @07,@AL00001+4                                      0850
         LA    @07,DLISTBLK                                        0850
         ST    @07,@AFTEMPS+4                                      0850
         LA    @07,@AFTEMPS+4                                      0850
         ST    @07,@AL00001+8                                      0850
         MVI   @AL00001+8,X'80'                                    0850
         L     @15,GDTDBG(,@08)                                    0850
         LA    @01,@AL00001                                        0850
         BALR  @14,@15                                             0850
*                                                          /*@YL026UD*/
*                                                                  0851
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  NEW BLOCK IS FIRST BLOCK OF INDEX -             @YL026UD*/
*        /*  VERIFY THAT THE FIRST ENTRY IS AN               @YL026UD*/
*        /*  INDEX CONTROL ENTRY (ICE)                       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0851
*        IF CATETYPE = TYPEICE                                     0851
*          THEN                                                    0851
@RT00848 CLC   CATETYPE(1,CATPTR),TYPEICE                          0851
         BNE   @RF00851                                            0851
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ENTRY IS AN 'ICE' -                       @YL026UD*/
*              /*  BYPASS THE ICE ENTRY                      @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0853
*              CATPTR = CATPTR + (CATETYPE * 2) +                  0853
*                       LENGTH(CATFORM);                   /*@YL026UD*/
         SLR   @08,@08                                             0853
         IC    @08,CATETYPE(,CATPTR)                               0853
         ALR   @08,@08                                             0853
         ALR   @08,CATPTR                                          0853
         AL    @08,@CF00037                                        0853
         LR    CATPTR,@08                                          0853
*            END;                                          /*@YL026UD*/
*          ELSE                                                    0855
*            DO;                                           /*@Y30SSMK*/
         B     @RC00851                                            0855
@RF00851 DS    0H                                                  0856
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ENTRY IS NOT AN 'ICE' -                   @YL026UD*/
*              /*  FURTHER SCANNING OF THE SYSCTLG           @YL026UD*/
*              /*  DATA SET IS IMPOSSIBLE -                  @YL026UD*/
*              /*  PRINT ERROR MESSAGE AND TERMINATE         @YL026UD*/
*              /*  CNVTCAT PROCESSING                        @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0856
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
*                                                                  0856
         L     @08,DDSTRU                                          0856
         MVC   DARGSMOD(3,@08),@CC00831                            0856
*              DARGSENT = SCN1MSG#;                        /*@YL026UD*/
*                                                                  0857
         MVI   DARGSENT(@08),X'05'                                 0857
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0858
         L     @08,@PC00001                                        0858
         ST    @08,@AL00001                                        0858
         LA    @07,@CF00113                                        0858
         ST    @07,@AL00001+4                                      0858
         LA    @07,DDSTRU                                          0858
         ST    @07,@AL00001+8                                      0858
         MVI   @AL00001+8,X'80'                                    0858
         L     @15,GDTPRT(,@08)                                    0858
         LA    @01,@AL00001                                        0858
         BALR  @14,@15                                             0858
*              DARGSENT = SCN2MSG#;                        /*@YL026UD*/
*                                                                  0859
         L     @08,DDSTRU                                          0859
         MVI   DARGSENT(@08),X'06'                                 0859
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @07,DSNAME                                          0860
         ST    @07,DARGDBP(,@08)                                   0860
*              DARGILP = DSNLEN;                           /*@YL026UD*/
*                                                                  0861
         STH   DSNLEN,DARGILP(,@08)                                0861
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0862
         L     @08,@PC00001                                        0862
         ST    @08,@AL00001                                        0862
         LA    @07,@CF00113                                        0862
         ST    @07,@AL00001+4                                      0862
         LA    @07,DDSTRU                                          0862
         ST    @07,@AL00001+8                                      0862
         MVI   @AL00001+8,X'80'                                    0862
         L     @15,GDTPRT(,@08)                                    0862
         LA    @01,@AL00001                                        0862
         BALR  @14,@15                                             0862
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
*                                                                  0863
         L     @08,@PC00001+8                                      0863
         MVC   LASTCOND(2,@08),@CH00037                            0863
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /*  DUMP POINT WHEN 'ICE' ENTRY IS NOT FOUND. @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  0864
*              IF GDTDBG = NULLPTR                                 0864
*                THEN;                                             0864
         L     @08,@PC00001                                        0864
         L     @08,GDTDBG(,@08)                                    0864
         LTR   @08,@08                                             0864
         BZ    @RT00864                                            0864
*                ELSE                                              0866
*                  CALL IDCDB010(GDTTBL,'CCIE');                   0866
         L     @08,@PC00001                                        0866
         ST    @08,@AL00001                                        0866
         LA    @07,@CC01192                                        0866
         ST    @07,@AL00001+4                                      0866
         MVI   @AL00001+4,X'80'                                    0866
         L     @15,GDTDBG(,@08)                                    0866
         LA    @01,@AL00001                                        0866
         BALR  @14,@15                                             0866
*                                                          /*@YL026UD*/
*                                                                  0867
*              RETURN;                                     /*@YL026UD*/
         B     @EL00011                                            0867
*            END;                                          /*@YL026UD*/
*                                                                  0868
*        END PUSHDOWN;                                     /*@YL026UD*/
         B     @EL00011                                            0869
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - CONTINUE                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSES THE CHANGE FROM SYSCTLG INDEX      @YL026UD*/
*/*             BLOCK TO THE CONTINUATION OF THE SAME INDEX  @YL026UD*/
*/*             LEVEL IN A NEW SYSCTLG INDEX BLOCK           @YL026UD*/
*/*             WHILE SCANNING THE SYSCTLG DATA SET          @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE CONTINUATION SYSCTLG INDEX BLOCK IS      @YL026UD*/
*/*             OBTAINED (VIA THE 'UPOSIT'/'UGET' MACROS)    @YL026UD*/
*/*             FROM TTR INFORMATION IN THE CURRENT INDEX    @YL026UD*/
*/*             ENTRY ('ILE' ENTRY WITH NONZERO TTR FIELD)   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE FIRST ENTRY IN THE CONTINUATION INDEX    @YL026UD*/
*/*             BLOCK IS NOT AN INDEX CONTROL ENTRY ('ICE')  @YL026UD*/
*/*             SINCE THE BLOCK IS NOT THE BEGINNING OF A    @YL026UD*/
*/*             INDEX LEVEL, BUT THE CONTINUATION OF ONE     @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE CONTINUATION INDEX BLOCK CANNOT BE    @YL026UD*/
*/*             OBTAINED, PROCESSING IS TERMINATED           @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE RELATIVE TRACK ADDRESS (TTR) OF THE         @YL026UD*/
*/*          CONTINUATION SYSCTLG INDEX BLOCK AT WHICH       @YL026UD*/
*/*          SCANNING IS TO CONTINUE                         @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE ACQUIRED CONTINUATION BLOCK AT THE SAME    @YL026UD*/
*/*           INDEX LEVEL WITH SCANNING POINTERS POSITIONED  @YL026UD*/
*/*           TO THE FIRST ENTRY                             @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0870
*CONTINUE: PROCEDURE;                                      /*@YL026UD*/
CONTINUE STM   @14,@02,@SA00012                                    0870
         STM   @04,@12,@SA00012+20                                 0870
*        OLDERID2 = NEWERID2;                                      0871
         L     @08,@PC00001                                        0871
         L     @04,GDTTR2(,@08)                                    0871
         MVC   @TS00001(95),NEWERID2(@04)                          0871
         MVC   OLDERID2(95,@04),@TS00001                           0871
*        NEWID2 = 'CCCE';                                  /*@YL026UD*/
*                                                                  0872
         MVC   NEWID2(4,@04),@CC01196                              0872
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  OBTAIN THE CONTINUATION INDEX BLOCK             @YL026UD*/
*        /*  ('UPOSIT'/'UGET' MACROS)                        @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0873
*        BLOCKTTR(1:3) = CATETTR;                          /*@YL026UD*/
*                                                                  0873
         MVC   BLOCKTTR(3),CATETTR(CATPTR)                         0873
*        IIOCSPTR -> IOCTTR = BLOCKTTR;                    /*@YL026UD*/
*                                                                  0874
         L     @04,IIOCSPTR                                        0874
         MVC   IOCTTR(4,@04),BLOCKTTR                              0874
*        CALL IDCIOPO0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0875
         ST    @08,@AL00001                                        0875
         LA    @04,IIOCSPTR                                        0875
         ST    @04,@AL00001+4                                      0875
         MVI   @AL00001+4,X'80'                                    0875
         L     @15,GDTPOS(,@08)                                    0875
         LA    @01,@AL00001                                        0875
         BALR  @14,@15                                             0875
*        CALL IDCIOGT0(GDTTBL,IIOCSPTR);                   /*@YL026UD*/
*                                                                  0876
         L     @08,@PC00001                                        0876
         ST    @08,@AL00001                                        0876
         LA    @04,IIOCSPTR                                        0876
         ST    @04,@AL00001+4                                      0876
         MVI   @AL00001+4,X'80'                                    0876
         L     @15,GDTGET(,@08)                                    0876
         LA    @01,@AL00001                                        0876
         BALR  @14,@15                                             0876
*        RESPECIFY RTNREG RSTD;                                    0877
*        TESTRC = RTNREG;                                          0878
         LR    TESTRC,RTNREG                                       0878
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0879
*        IF TESTRC ^= 0                                            0880
*          THEN                                                    0880
         LTR   TESTRC,TESTRC                                       0880
         BZ    @RF00880                                            0880
*            DO;                                           /*@YL026UD*/
*              LASTCOND = LASTCC12;                        /*@YL026UD*/
         L     @08,@PC00001+8                                      0882
         MVC   LASTCOND(2,@08),@CH00037                            0882
*              RETURN;                                     /*@YL026UD*/
@EL00012 DS    0H                                                  0883
@EF00012 DS    0H                                                  0883
@ER00012 LM    @14,@02,@SA00012                                    0883
         LM    @04,@12,@SA00012+20                                 0883
         BR    @14                                                 0883
*            END;                                          /*@YL026UD*/
*                                                                  0884
*        BLOCK(LVLINDEX) = BLKREAD;                        /*@YL026UD*/
*                                                                  0885
@RF00880 LH    @08,LVLINDEX                                        0885
         SLA   @08,8                                               0885
         L     @02,BLKLVPTR                                        0885
         ALR   @02,@08                                             0885
         AL    @02,@CF01312                                        0885
         L     @08,IIOCSPTR                                        0885
         L     @08,IOCDAD(,@08)                                    0885
         MVC   BLOCK(256,@02),BLKREAD(@08)                         0885
*        CATPTR = BLOCKPTR + LENGTH(BLOCKCNT);             /*@YL026UD*/
*                                                                  0886
         LA    CATPTR,2                                            0886
         AL    CATPTR,BLOCKPTR                                     0886
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT AFTER SYSCTLG BLOCK AT SAME INDEX AS @Y30SSMK*/
*        /*  LAST BLOCK IS OBTAINED.                         @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0887
*        IF GDTDBG = NULLPTR                                       0887
*          THEN;                                                   0887
         L     @08,@PC00001                                        0887
         L     @08,GDTDBG(,@08)                                    0887
         LTR   @08,@08                                             0887
         BZ    @RT00887                                            0887
*          ELSE                                                    0889
*            CALL IDCDB010(GDTTBL,'CCCN',ADDR(DLISTBLK));          0889
         L     @08,@PC00001                                        0889
         ST    @08,@AL00001                                        0889
         LA    @02,@CC01197                                        0889
         ST    @02,@AL00001+4                                      0889
         LA    @02,DLISTBLK                                        0889
         ST    @02,@AFTEMPS+8                                      0889
         LA    @02,@AFTEMPS+8                                      0889
         ST    @02,@AL00001+8                                      0889
         MVI   @AL00001+8,X'80'                                    0889
         L     @15,GDTDBG(,@08)                                    0889
         LA    @01,@AL00001                                        0889
         BALR  @14,@15                                             0889
*                                                          /*@YL026UD*/
*                                                                  0890
*        END CONTINUE;                                     /*@YL026UD*/
         B     @EL00012                                            0890
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - POPUP                                  @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - PROCESSES THE CHANGE FROM ONE SYSCTLG INDEX  @YL026UD*/
*/*             LEVEL TO A HIGHER SYSCTLG INDEX LEVEL        @YL026UD*/
*/*             WHILE SCANNING THE SYSCTLG DATA SET          @YL026UD*/
*/*                                                          @YL026UD*/
*/*             SCANNING CONTINUES AT A HIGHER INDEX LEVEL   @YL026UD*/
*/*             WHEN THE END OF THE CURRENT INDEX LEVEL IS   @YL026UD*/
*/*             ENCOUNTERED ('ILE' ENTRY WITH A ZERO TTR,    @YL026UD*/
*/*             OR AT THE END OF A 'VCB')                    @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE HIGHER LEVEL SYSCTLG INDEX BLOCK IS      @YL026UD*/
*/*             OBTAINED (I.E., RETURNED TO) BY RESTORING    @YL026UD*/
*/*             THE SAVED STATUS OF THE HIGHER LEVEL INDEX   @YL026UD*/
*/*             LEVEL -                                      @YL026UD*/
*/*             I.E., THE OFFSET WITHIN THE INDEX BLOCK      @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE INDEX NAME FROM THE CURRENT INDEX LEVEL  @YL026UD*/
*/*             IS REMOVED FROM THE DATA SET NAME BEING      @YL026UD*/
*/*             BUILT                                        @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE RESTORED HIGHER-LEVEL INDEX IS THE    @YL026UD*/
*/*             VOLUME INDEX, THEN THE 'ALIAS PROCESSING'    @YL026UD*/
*/*             FLAG IS TURNED OFF                           @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE 'G0000V00 PROCESSING' FLAG (IF ON) IS    @YL026UD*/
*/*             TURNED OFF BEFORE SCANNING THE RESTORED      @YL026UD*/
*/*             HIGHER LEVEL INDEX                           @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE OFFSET WITHIN THE HIGHER LEVEL SYSCTLG      @YL026UD*/
*/*          INDEX BLOCK (RETRIEVED FROM THE PUSH-DOWN       @YL026UD*/
*/*          STACK)                                          @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE RESTORED STATUS OF THE HIGHER LEVEL        @YL026UD*/
*/*           SYSCTLG INDED BLOCK WITH SCANNING POINTERS     @YL026UD*/
*/*           POSITIONED FOLLOWING THE ENTRY AT WHICH        @YL026UD*/
*/*           PREVIOUS SCANNING (OF THIS BLOCK) WAS          @YL026UD*/
*/*           INTERRUPTED                                    @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0891
*POPUP:    PROCEDURE;                                      /*@YL026UD*/
POPUP    STM   @14,@02,@SA00013                                    0891
         STM   @04,@05,@SA00013+20                                 0891
         STM   @07,@12,@SA00013+28                                 0891
*        OLDERID2 = NEWERID2;                                      0892
         L     @08,@PC00001                                        0892
         L     @08,GDTTR2(,@08)                                    0892
         MVC   @TS00001(95),NEWERID2(@08)                          0892
         MVC   OLDERID2(95,@08),@TS00001                           0892
*        NEWID2 = 'CCPP';                                  /*@YL026UD*/
*                                                                  0893
         MVC   NEWID2(4,@08),@CC01201                              0893
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  REMOVE LAST DATA SET NAME SEGMENT FROM          @YL026UD*/
*        /*  DATA SET NAME                                   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  RESTORE THE SAVED STATUS OF THE INDEX LEVEL     @YL026UD*/
*        /*  TO WHICH SCANNING IS RETURNING -                @YL026UD*/
*        /*  THE OFFSET WITHIN THE INDEX BLOCK               @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0894
*        LVLINDEX = LVLINDEX - 1;                          /*@YL026UD*/
*                                                                  0894
         LH    @08,LVLINDEX                                        0894
         BCTR  @08,0                                               0894
         STH   @08,LVLINDEX                                        0894
*        DSNLEN = DSNLEN - (IXNLEN(LVLINDEX) + 1);         /*@YL026UD*/
*                                                                  0895
         LA    @07,1                                               0895
         LR    @02,@08                                             0895
         ALR   @02,@02                                             0895
         LH    @15,IXNLEN-2(@02)                                   0895
         ALR   @15,@07                                             0895
         SLR   DSNLEN,@15                                          0895
*        DSNAME(DSNLEN+1:DSNLEN+9) = '        ';           /*@YL026UD*/
*                                                                  0896
         LA    @01,DSNAME(DSNLEN)                                  0896
         MVI   8(@01),C' '                                         0896
         MVC   0(8,@01),@CC01167                                   0896
*        BLOCKPTR = ADDR(BLOCK(LVLINDEX));                 /*@YL026UD*/
*                                                                  0897
         LR    @15,@08                                             0897
         SLA   @15,8                                               0897
         L     @01,BLKLVPTR                                        0897
         AL    @01,@CF01312                                        0897
         LA    @15,BLOCK(@15,@01)                                  0897
         ST    @15,BLOCKPTR                                        0897
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  RETURN TO THE HIGHER LEVEL INDEX BLOCK          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0898
*        CATPTR = BLOCKPTR + LVLOFSET(LVLINDEX);           /*@YL026UD*/
*                                                                  0898
         AH    @15,LVLOFSET-2(@02)                                 0898
         LR    CATPTR,@15                                          0898
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF RESTORED INDEX IS THE VOLUME INDEX           @YL026UD*/
*        /*  (I.E., THE FIRST-LEVEL INDEX),                  @YL026UD*/
*        /*  TURN OFF THE 'ALIAS PROCESSING' FLAG            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0899
*        IF LVLINDEX = 1                                           0899
*          THEN                                                    0899
         CR    @08,@07                                             0899
         BNE   @RF00899                                            0899
*            ALIASFLG = OFF;                               /*@YL026UD*/
*                                                                  0900
         NI    ALIASFLG,B'01111111'                                0900
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT WHEN READY TO CONTINUE SCAN OF       @Y30SSMK*/
*        /*  HIGHER LEVEL INDEX BLOCK.                       @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0901
*        IF GDTDBG = NULLPTR                                       0901
*          THEN;                                                   0901
@RF00899 L     @08,@PC00001                                        0901
         L     @08,GDTDBG(,@08)                                    0901
         LTR   @08,@08                                             0901
         BZ    @RT00901                                            0901
*          ELSE                                                    0903
*            CALL IDCDB010(GDTTBL,'CCPU');                         0903
         L     @08,@PC00001                                        0903
         ST    @08,@AL00001                                        0903
         LA    @07,@CC01202                                        0903
         ST    @07,@AL00001+4                                      0903
         MVI   @AL00001+4,X'80'                                    0903
         L     @15,GDTDBG(,@08)                                    0903
         LA    @01,@AL00001                                        0903
         BALR  @14,@15                                             0903
*                                                          /*@YL026UD*/
*                                                                  0904
*        END POPUP;                                        /*@YL026UD*/
@EL00013 DS    0H                                                  0904
@EF00013 DS    0H                                                  0904
@ER00013 LM    @14,@02,@SA00013                                    0904
         LM    @04,@05,@SA00013+20                                 0904
         LM    @07,@12,@SA00013+28                                 0904
         BR    @14                                                 0904
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - CATALOG                                @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/
*/*             (CPL, FVT, AND FPLS) WHICH 'DEFINE' THE      @YL026UD*/
*/*             ENTRY TO BE CONVERTED TO THE VSAM CATALOG.   @YL026UD*/
*/*             THE ENTRY IS DEFINED TO THE VSAM CATALOG     @YL026UD*/
*/*             VIA THE 'UCATLG' MACRO.                      @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THREE VSAM ENTRY TYPES CAN BE DEFINED -      @YL026UD*/
*/*             (1) 'NONVSAM' ENTRY                          @YL026UD*/
*/*                 (FOR SYSCTLG 'DSPE' OR 'VCBPE' ENTRY)    @YL026UD*/
*/*             (2) 'GDG BASE' ENTRY                         @YL026UD*/
*/*                 (FOR SYSCTLG 'GIPE' ENTRY)               @YL026UD*/
*/*             (3) 'ALIAS' ENTRY                            @YL026UD*/
*/*                 (FOR SYSCTLG 'AE' OR 'CVPE' ENTRY)       @YL026UD*/
*/*                 (A 'CVPE' ENTRY IS CONVERTED INTO AN     @YL026UD*/
*/*                 ALIAS ENTRY IN THE VSAM MASTER CATALOG)  @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE VSAM CATALOG RETURN CODE IS EXAMINED     @YL026UD*/
*/*             TO DETERMINE IS THE 'DEFINE' REQUEST WAS     @YL026UD*/
*/*             SUCCESSFUL, IF THE ENTRY ALREADY EXISTS IN   @YL026UD*/
*/*             THE VSAM CATALOG, OR IF THERE WAS ANOTHER    @YL026UD*/
*/*             REASON FOR FAILURE.                          @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE ENTRY ALREADY EXISTS IN THE VSAM      @YL026UD*/
*/*             CATALOG, AND THE ENTRY NAME DOES NOT BEGIN   @YL026UD*/
*/*             WITH 'SYS1.', A VSAM 'LOCATE' REQUEST IS     @YL026UD*/
*/*             ISSUED TO DETERMINE THE ENTRY TYPE AND THE   @YL026UD*/
*/*             VOLUME INFORMATION OF THE CATALOGED ENTRY.   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE CATALOGED ENTRY IS NOT A NONVSAM      @YL026UD*/
*/*             ENTRY, NO FURTHER ACTION IS TAKEN.           @YL026UD*/
*/*                                                          @YL026UD*/
*/*             IF THE CATALOGED ENTRY IS A NONVSAM ENTRY,   @YL026UD*/
*/*             IT IS ASSUMED TO BE THE SAME DATA SET AS     @YL026UD*/
*/*             THE DATA SET ENTRY UNDERGOING CONVERSION.    @YL026UD*/
*/*             THE VOLUME INFORMATION RETURNED BY THE       @YL026UD*/
*/*             'LOCATE' REQUEST IS COMPARED WITH THAT OF    @YL026UD*/
*/*             THE ENTRY UNDERGOING CONVERSION.  IF THE     @YL026UD*/
*/*             VOLUME INFORMATION IS DIFFERENT, A VSAM      @YL026UD*/
*/*             'ALTER' REQUEST IS ISSUED AGAINST THE        @YL026UD*/
*/*             CATALOGED ENTRY TO UPDATE THE VOLUME         @YL026UD*/
*/*             INFORMATION TO AGREE WITH THAT OF THE ENTRY  @YL026UD*/
*/*             UNDERGOING CONVERSION.                       @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE VOLUME LIST (FOR THE FVT PSEUDO FPL),       @YL026UD*/
*/*          THE DEVICE LIST (FOR THE DEVICE TYPE FPL),      @YL026UD*/
*/*          THE DATA SET SEQUENCE LIST (FOR THE DATA SET    @YL026UD*/
*/*          SEQUENCE FPL),                                  @YL026UD*/
*/*          THE NAME OF THE ENTRY TO BE CONVERTED           @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE SUCCESSFUL CONVERSION OR UPDATING OF THE   @YL026UD*/
*/*           SPECIFIED ENTRY (IF THE 'LIST' OPTION IS       @YL026UD*/
*/*           SPECIFIED OR DEFAULTED, THE CONVERTED OR       @YL026UD*/
*/*           UPDATED ENTRY NAME WILL BE PRINTED), OR AN     @YL026UD*/
*/*           ERROR MESSAGE IS PRINTED EXPLAINING THE        @YL026UD*/
*/*           REASON FOR THE UNSUCCESSFUL CONVERSION OR      @YL026UD*/
*/*           UPDATING OF THE SPECIFIED ENTRY.               @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  0905
*CATALOG: PROCEDURE;                                       /*@YL026UD*/
CATALOG  STM   @14,@06,@SA00014                                    0905
         STM   @08,@12,@SA00014+36                                 0905
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DECLARATIONS FOR 'CATALOG' PROCEDURE            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0906
*        DCL SYS1NAME CHAR(5)   CONSTANT('SYS1.');         /*@YL026UD*/
*                                      /*'SYS1.' DATA SET    @YL026UD*/
*                                      /*NAME PREFIX         @YL026UD*/
*                                                                  0907
*        DCL CATZERO  CHAR(8)   INIT('0000000000000000'X); /*@YL026UD*/
*                                      /*8-BYTE ZERO FIELD   @YL026UD*/
*                                                                  0908
*        DCL DEVTCON  CHAR(8)   CONSTANT('DEVTYP  ');      /*@YL026UD*/
*                                      /*'DEVTYPE' FPL-TYPE  @YL026UD*/
*        DCL FILECON  CHAR(8)   CONSTANT('FILESEQ ');      /*@YL026UD*/
*                                      /*'FILESEQ' FPL-TYPE  @YL026UD*/
*        DCL ENTYPCON CHAR(8)   CONSTANT('ENTYPE  ');      /*@YL026UD*/
*                                      /*'ENTYPE'  FPL-TYPE  @YL026UD*/
*        DCL CATVLCON CHAR(8)   CONSTANT('CATVOL  ');      /*@YL026UD*/
*                                      /*'CATVOL'  FPL-TYPE  @YL026UD*/
*                                                                  0912
*        DCL LOCATFLG BIT(1);          /*'LOCATE ENTRY' FLAG @YL026UD*/
*        DCL MATCHFLG BIT(1);          /*'VOLUME MATCH' FLAG @YL026UD*/
*        DCL SCANFLAG BIT(1);          /*'VOLUME SCAN'  FLAG @YL026UD*/
*                                                                  0914
*        DCL CATVINDX FIXED(15);       /*VSAM    VOLUME      @YL026UD*/
*                                      /*INFORMATION INDEX   @YL026UD*/
*        DCL VOLINDX  FIXED(15);       /*SYSCTLG VOLUME      @YL026UD*/
*                                      /*INFORMATION INDEX   @YL026UD*/
*                                                                  0917
*        DCL DUPLCODE FIXED(15) CONSTANT(8);               /*@YL026UD*/
*                                      /*'DUPLICATE ENTRY'   @YL026UD*/
*                                      /*VSAM RETURN CODE    @YL026UD*/
*        DCL CATFULL FIXED(15) CONSTANT(20);               /*@VS04383*/
*                                      /* 'CATALOG FULL'     @VS04383*/
*                                      /* VSAM RETURN CODE   @VS04383*/
*        DCL WKASCODE FIXED(15) CONSTANT(40);              /*@YL026UD*/
*                                      /*'WORKAREA SPACE'    @YL026UD*/
*                                      /*VSAM RETURN CODE    @YL026UD*/
*                                                                  0920
*        DCL LOCINFO  CHAR(256) BASED; /*INFORMATION         @YL026UD*/
*                                      /*RETURNED FROM VSAM  @YL026UD*/
*                                      /*'LOCATE' REQUEST    @YL026UD*/
*                                                                  0921
*        DCL ERRORTAB CHAR(LENGTH(ERCNVTAB)) BDY(WORD);    /*@Y30SSMK*/
*                                      /*ERROR CONVERSION TABLE      */
*        DCL ERRORTYP FIXED(8);                            /*@Y30SSMK*/
*                                      /*CATALOG OPERATION PERFORMED */
*        DCL ERRORDE FIXED(8) CONSTANT(1);                 /*@Y30SSMK*/
*                                      /*CATALOG DEFINE ERROR        */
*        DCL ERRORLC FIXED(8) CONSTANT(2);                 /*@Y30SSMK*/
*                                      /*CATALOG LOCATE ERROR        */
*        DCL ERRORAL FIXED(8) CONSTANT(3);                 /*@Y30SSMK*/
*                                      /*CATALOG ALTER ERROR @Y30SSMK*/
*        OLDERID2 = NEWERID2;                                      0926
         L     @07,@PC00001                                        0926
         L     @07,GDTTR2(,@07)                                    0926
         MVC   @TS00001(95),NEWERID2(@07)                          0926
         MVC   OLDERID2(95,@07),@TS00001                           0926
*        NEWID2 = 'CCCT';                                  /*@YL026UD*/
*                                                                  0927
         MVC   NEWID2(4,@07),@CC01234                              0927
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF ENTRY NAME IS AN ALIAS DATA SET NAME -       @YL026UD*/
*        /*  OBTAIN THE TRUE DATA SET NAME BEFORE            @YL026UD*/
*        /*  'DEFINING' THE CORRESPONDING VSAM ALIAS ENTRY   @YL026UD*/
*        /*  AND DETERMINE IF THE TRUE DATA SET NAME MUST    @YL026UD*/
*        /*  BE 'DEFINED' BEFORE THE ALIAS DATA SET NAME     @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0928
*        IF ALIASFLG = ON                                          0928
*          THEN                                                    0928
         TM    ALIASFLG,B'10000000'                                0928
         BNO   @RF00928                                            0928
*            DO;                                           /*@YL026UD*/
*                                                                  0929
*              TRUEDSN = ' ';                              /*@YL026UD*/
*                                                                  0930
         MVI   TRUEDSN+1,C' '                                      0930
         MVC   TRUEDSN+2(42),TRUEDSN+1                             0930
         MVI   TRUEDSN,C' '                                        0930
*              TRUEDSN(1:TRUENLEN) = TRUENAME;             /*@YL026UD*/
*                                                                  0931
         LH    @07,TRUENLEN                                        0931
         LR    @05,@07                                             0931
         BCTR  @05,0                                               0931
         EX    @05,@SM01321                                        0931
*              TRUEDSN(TRUENLEN+1:DSNLEN+TRUENLEN-IXNLEN(1)) =     0932
*                     DSNAME(IXNLEN(1)+1:DSNLEN);          /*@YL026UD*/
*                                                                  0932
         LA    @05,TRUEDSN(@07)                                    0932
         LR    @15,DSNLEN                                          0932
         ALR   @15,@07                                             0932
         LH    @14,IXNLEN                                          0932
         SLR   @15,@14                                             0932
         SLR   @15,@07                                             0932
         BCTR  @15,0                                               0932
         LA    @07,DSNAME(@14)                                     0932
         EX    @15,@SM01323                                        0932
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  DETERMINE IF THE TRUE DATA SET NAME MUST  @YL026UD*/
*              /*  BE 'DEFINED' OR IS ALREADY CONVERTED      @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  THE TRUE ENTRY NAME MUST EXIST BEFORE     @YL026UD*/
*              /*  THE ALIAS ENTRY CAN BE 'DEFINED'          @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0933
*              IF DSNAME < TRUEDSN                                 0933
*                THEN                                              0933
         CLC   DSNAME(44),TRUEDSN                                  0933
         BNL   @RF00933                                            0933
*                  DO;                                     /*@YL026UD*/
*                    /************************************************/
*                    /*                                      @YL026UD*/
*                    /*  THE TRUE DATA SET NAME HAS NOT BEEN @YL026UD*/
*                    /*  'DEFINED' -                         @YL026UD*/
*                    /*  CONVERT THE TRUE DATA SET NAME NOW  @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /************************************************/
*                                                                  0935
*                    ALIASDSN = DSNAME;                    /*@YL026UD*/
         MVC   ALIASDSN(44),DSNAME                                 0935
*                    DSNAME = TRUEDSN;                     /*@YL026UD*/
*                                                                  0936
         MVC   DSNAME(44),TRUEDSN                                  0936
*                    TRUEFLG = ON;                         /*@YL026UD*/
         OI    TRUEFLG,B'10000000'                                 0937
*                    ALIASFLG = OFF;                       /*@YL026UD*/
*                                                                  0938
         NI    ALIASFLG,B'01111111'                                0938
*                  END;                                    /*@YL026UD*/
*                                                                  0939
*            END;                                          /*@YL026UD*/
*          ELSE                                                    0941
*            /********************************************************/
*            /*                                              @YL026UD*/
*            /*  IF ENTRY NAME IS AN ALIAS DATA SET NAME     @YL026UD*/
*            /*  WHOSE RELATED TRUE DATA SET NAME WAS        @YL026UD*/
*            /*  'DEFINED' DURING THE PREVIOUS CALL TO       @YL026UD*/
*            /*  'CATALOG' PROCEDURE -                       @YL026UD*/
*            /*  OBTAIN THE ALIAS DATA SET NAME AND 'DEFINE' @YL026UD*/
*            /*  THE VSAM ALIAS ENTRY AT THIS TIME           @YL026UD*/
*            /*                                              @YL026UD*/
*            /********************************************************/
*                                                                  0941
*            IF TRUEFLG = ON                                       0941
*              THEN                                                0941
         B     @RC00928                                            0941
@RF00928 TM    TRUEFLG,B'10000000'                                 0941
         BNO   @RF00941                                            0941
*                DO;                                       /*@YL026UD*/
*                                                                  0942
*                  TRUEFLG = OFF;                          /*@YL026UD*/
         NI    TRUEFLG,B'01111111'                                 0943
*                  ALIASFLG = ON;                          /*@YL026UD*/
*                                                                  0944
         OI    ALIASFLG,B'10000000'                                0944
*                  DSNAME = ALIASDSN;                      /*@YL026UD*/
*                                                                  0945
         MVC   DSNAME(44),ALIASDSN                                 0945
*                END;                                      /*@YL026UD*/
*                                                                  0946
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF ENTRY NAME IS A GENERATION DATA SET NAME -   @YL026UD*/
*        /*  COMPLEMENT THE G0000V00 GENERATION NUMBER       @YL026UD*/
*        /*  BEFORE 'DEFINING' THE CORRESPONDING VSAM        @YL026UD*/
*        /*  ALIEN (NONVSAM) ENTRY                           @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0947
*        IF G0V0FLAG = ON                                          0947
*          THEN                                                    0947
@RF00941 DS    0H                                                  0947
@RC00928 TM    G0V0FLAG,B'10000000'                                0947
         BNO   @RF00947                                            0947
*            DO;                                           /*@YL026UD*/
*                                                                  0948
*              DSNAME(DSNLEN-6:DSNLEN-3) =                         0949
*                    DSNAME(DSNLEN-6:DSNLEN-3) && ALLONES; /*@YL026UD*/
*                                                                  0949
         LA    @07,DSNAME-7(DSNLEN)                                0949
         XC    0(4,@07),ALLONES                                    0949
*            END;                                          /*@YL026UD*/
*                                                                  0950
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  BUILD THE VSAM CATALOG PARAMETER LISTS          @YL026UD*/
*        /*  TO 'DEFINE' THE CONVERTED CATALOG ENTRY         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  PARAMETER LISTS REQUIRED ARE -                  @YL026UD*/
*        /*  (1) CPL - CATALOG PARAMETER LIST                @YL026UD*/
*        /*            (TO IDENTIFY THE 'DEFINE' REQUEST     @YL026UD*/
*        /*            AND THE RECEIVING VSAM CATALOG)       @YL026UD*/
*        /*  (2) FVT - FIELD VECTOR TABLE                    @YL026UD*/
*        /*            (TO IDENTIFY THE CONVERTED ENTRY)     @YL026UD*/
*        /*  (3) FPL - FIELD PARAMETER LISTS                 @YL026UD*/
*        /*            (FOR DEVICE TYPE AND FILE SEQUENCE    @YL026UD*/
*        /*            INFORMATION)                          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0951
*        CALL DEFNLSTS;                                    /*@YL026UD*/
*                                                                  0951
@RF00947 BAL   @14,DEFNLSTS                                        0951
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ISSUE 'UCATLG' MACRO -                          @YL026UD*/
*        /*  TO DEFINE THE NONVSAM, ALIAS, OR GDG BASE       @YL026UD*/
*        /*  ENTRY TO THE PROPER VSAM CATALOG                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0952
*        CALL IDCSACA0(GDTTBL,CATPLPTR);                   /*@YL026UD*/
*                                                                  0952
         L     @15,@PC00001                                        0952
         ST    @15,@AL00001                                        0952
         LA    @14,CATPLPTR                                        0952
         ST    @14,@AL00001+4                                      0952
         L     @15,GDTCAT(,@15)                                    0952
         LA    @01,@AL00001                                        0952
         BALR  @14,@15                                             0952
*        RESPECIFY RTNREG RSTD;                                    0953
*        TESTRC = RTNREG;                                          0954
         LR    TESTRC,RTNREG                                       0954
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  0955
*        IF TESTRC = 0                                             0956
*          THEN                                                    0956
         SLR   @15,@15                                             0956
         CR    TESTRC,@15                                          0956
         BNE   @RF00956                                            0956
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  VSAM CATALOG RETURN CODE IS ZERO -        @YL026UD*/
*              /*  SYSCTLG ENTRY SUCCESSFULLY CONVERTED      @YL026UD*/
*              /*  TO VSAM CATALOG ENTRY                     @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  IF 'LIST' OPTION SPECIFIED OR DEFAULTED - @YL026UD*/
*              /*  PRINT NAME OF ENTRY SUCCESSFULLY CONVERTED        */
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0958
*              IF ADDR(LIST) ^= NULLPTR                            0958
*                THEN                                              0958
         L     @08,@PC00001+4                                      0958
         C     @15,FDTPTR+36(,@08)                                 0958
         BE    @RF00958                                            0958
*                  DO;                                     /*@YL026UD*/
*                    /************************************************/
*                    /*                                      @YL026UD*/
*                    /*  'LIST' OPTION IS SPECIFIED -        @YL026UD*/
*                    /*  PRINT THE NAME OF ENTRY CONVERTED   @YL026UD*/
*                    /*                                      @YL026UD*/
*                    /************************************************/
*                                                                  0960
*                    DARGSMOD = CNVTMSG;                   /*@YL026UD*/
         L     @08,DDSTRU                                          0960
         MVC   DARGSMOD(3,@08),@CC00831                            0960
*                    DARGSENT = CNVTMSG#;                  /*@YL026UD*/
*                                                                  0961
         MVI   DARGSENT(@08),X'0A'                                 0961
*                    DARGDBP = ADDR(DSNAME);               /*@YL026UD*/
         LA    @05,DSNAME                                          0962
         ST    @05,DARGDBP(,@08)                                   0962
*                    DARGILP = LENGTH(DSNAME);             /*@YL026UD*/
*                                                                  0963
         MVC   DARGILP(2,@08),@CH00583                             0963
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU); /*@YL026UD*/
*                                                                  0964
         L     @08,@PC00001                                        0964
         ST    @08,@AL00001                                        0964
         LA    @05,@CF00113                                        0964
         ST    @05,@AL00001+4                                      0964
         LA    @05,DDSTRU                                          0964
         ST    @05,@AL00001+8                                      0964
         MVI   @AL00001+8,X'80'                                    0964
         L     @15,GDTPRT(,@08)                                    0964
         LA    @01,@AL00001                                        0964
         BALR  @14,@15                                             0964
*                  END;                                    /*@YL026UD*/
*                                                                  0965
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  INCREMENT COUNT OF ENTRIES                @YL026UD*/
*              /*  SUCCESSFULLY CONVERTED                    @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0966
*              CNVTCNT = CNVTCNT + 1;                      /*@YL026UD*/
*                                                                  0966
@RF00958 LA    @08,1                                               0966
         AL    @08,CNVTCNT                                         0966
         ST    @08,CNVTCNT                                         0966
*              RETURN;                                     /*@YL026UD*/
*                                                                  0967
@EL00014 DS    0H                                                  0967
@EF00014 DS    0H                                                  0967
@ER00014 LM    @14,@06,@SA00014                                    0967
         LM    @08,@12,@SA00014+36                                 0967
         BR    @14                                                 0967
*            END;                                          /*@YL026UD*/
*                                                                  0968
*        /************************************************************/
*        /*                                                  @VS04383*/
*        /* VSAM CATALOG IS FULL, CALL ERRPROC TO INVOKE UERROR TO   */
*        /* PRINT ERROR MESSAGE, AND INDICATE THAT THE ENTRY @Y30SSMK*/
*        /* WAS NOT SUCCESSFULLY CONVERTED AND END.          @Y30SSMK*/
*        /*                                                  @VS04383*/
*        /************************************************************/
*        IF TESTRC = CATFULL                                       0969
*          THEN                                                    0969
@RF00956 C     TESTRC,@CF00894                                     0969
         BNE   @RF00969                                            0969
*                DO;                                       /*@VS04383*/
*                                                                  0970
*                ERRORTYP = ERRORDE;                       /*@Y30SSMK*/
         LA    ERRORTYP,1                                          0971
*                CALL ERRPROC;                             /*@Y30SSMK*/
*                                                                  0972
         BAL   @14,ERRPROC                                         0972
*                DARGSMOD = CNVTMSG;                               0973
         L     @08,DDSTRU                                          0973
         MVC   DARGSMOD(3,@08),@CC00831                            0973
*                DARGSENT = NCVTMSG#;                              0974
         MVI   DARGSENT(@08),X'09'                                 0974
*                DARGDBP = ADDR(DSNAME);                           0975
         LA    @05,DSNAME                                          0975
         ST    @05,DARGDBP(,@08)                                   0975
*                DARGILP = LENGTH(DSNAME);                         0976
*                                                                  0976
         MVC   DARGILP(2,@08),@CH00583                             0976
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             0977
*                                                                  0977
         L     @08,@PC00001                                        0977
         ST    @08,@AL00001                                        0977
         LA    @05,@CF00113                                        0977
         ST    @05,@AL00001+4                                      0977
         LA    @05,DDSTRU                                          0977
         ST    @05,@AL00001+8                                      0977
         MVI   @AL00001+8,X'80'                                    0977
         L     @15,GDTPRT(,@08)                                    0977
         LA    @01,@AL00001                                        0977
         BALR  @14,@15                                             0977
*                LASTCOND = LASTCC12;                      /*@VS04383*/
         L     @08,@PC00001+8                                      0978
         MVC   LASTCOND(2,@08),@CH00037                            0978
*                RETURN;                                           0979
*                                                                  0979
         B     @EL00014                                            0979
*                END;                                      /*@VS04383*/
*                                                                  0980
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  VSAM CATALOG RETURN CODE IS NOT EQUAL TO ZERO - @YL026UD*/
*        /*  IF NOT DEFINING A NONVSAM ENTRY OR IF THE VSAM  @YL026UD*/
*        /*  RETURN CODE DOES NOT INDICATE A DUPLICATE ENTRY @YL026UD*/
*        /*  THEN CALL ERRPROC TO INVOKE UERROR TO           @Y30SSMK*/
*        /*  PRINT THE ERROR MESSAGE AND INDICATE            @Y30SSMK*/
*        /*  THAT THE ENTRY WAS NOT SUCCESSFULLY CONVERTED   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0981
*        IF CVPEFLAG = ON  ALIASFLG = ON  GDGFLAG = ON           0981
*          TESTRC ^= DUPLCODE                                     0981
*          THEN                                                    0981
@RF00969 TM    CVPEFLAG,B'10000000'                                0981
         BO    @RT00981                                            0981
         TM    ALIASFLG,B'10000000'                                0981
         BO    @RT00981                                            0981
         TM    GDGFLAG,B'10000000'                                 0981
         BO    @RT00981                                            0981
         C     TESTRC,@CF00175                                     0981
         BE    @RF00981                                            0981
@RT00981 DS    0H                                                  0982
*            DO;                                           /*@YL026UD*/
*                                                                  0982
*              ERRORTYP = ERRORDE;                         /*@Y30SSMK*/
         LA    ERRORTYP,1                                          0983
*              CALL ERRPROC;                               /*@Y30SSMK*/
*                                                                  0984
         BAL   @14,ERRPROC                                         0984
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          0985
         MVC   DARGSMOD(3,@08),@CC00831                            0985
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/
*                                                                  0986
         MVI   DARGSENT(@08),X'09'                                 0986
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @05,DSNAME                                          0987
         ST    @05,DARGDBP(,@08)                                   0987
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/
*                                                                  0988
         MVC   DARGILP(2,@08),@CH00583                             0988
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0989
         L     @08,@PC00001                                        0989
         ST    @08,@AL00001                                        0989
         LA    @05,@CF00113                                        0989
         ST    @05,@AL00001+4                                      0989
         LA    @05,DDSTRU                                          0989
         ST    @05,@AL00001+8                                      0989
         MVI   @AL00001+8,X'80'                                    0989
         L     @15,GDTPRT(,@08)                                    0989
         LA    @01,@AL00001                                        0989
         BALR  @14,@15                                             0989
*              LASTCOND = LASTCC08;                        /*@YL026UD*/
*                                                                  0990
         L     @08,@PC00001+8                                      0990
         MVC   LASTCOND(2,@08),@CH00175                            0990
*              RETURN;                                     /*@YL026UD*/
         B     @EL00014                                            0991
*            END;                                          /*@YL026UD*/
*                                                                  0992
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DEFINE OPERATION WAS FOR A NONVSAM ENTRY AND    @YL026UD*/
*        /*  FAILED DUE TO DUPLICATE ENTRY IN VSAM CATALOG   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE VOLUME INFORMATION OF THE DUPLICATE ENTRY   @YL026UD*/
*        /*  WILL BE ALTERED (UPDATED) IF IT HAS CHANGED     @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  DETERMINE IF THE NONVSAM ENTRY IS A             @YL026UD*/
*        /*  'SYS1.' DATA SET ENTRY - NO ATTEMPT IS MADE TO  @YL026UD*/
*        /*  UPDATE THE VOLUME INFORMATION OF THESE ENTRIES  @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  0993
*        IF DSNAME(1:5) = SYS1NAME                                 0993
*          THEN                                                    0993
@RF00981 CLC   DSNAME(5),@CC01207                                  0993
         BNE   @RF00993                                            0993
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  DATA SET NAME BEGINS WITH 'SYS1.' -       @YL026UD*/
*              /*  THE VOLUME INFORMATION IS NOT UPDATED     @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  0995
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          0995
         MVC   DARGSMOD(3,@08),@CC00831                            0995
*              DARGSENT = SYS1MSG#;                        /*@YL026UD*/
*                                                                  0996
         MVI   DARGSENT(@08),X'04'                                 0996
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  0997
         L     @08,@PC00001                                        0997
         ST    @08,@AL00001                                        0997
         LA    @05,@CF00113                                        0997
         ST    @05,@AL00001+4                                      0997
         LA    @05,DDSTRU                                          0997
         ST    @05,@AL00001+8                                      0997
         MVI   @AL00001+8,X'80'                                    0997
         L     @15,GDTPRT(,@08)                                    0997
         LA    @01,@AL00001                                        0997
         BALR  @14,@15                                             0997
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/
*                                                                  0998
         L     @08,DDSTRU                                          0998
         MVI   DARGSENT(@08),X'09'                                 0998
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @05,DSNAME                                          0999
         ST    @05,DARGDBP(,@08)                                   0999
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/
*                                                                  1000
         MVC   DARGILP(2,@08),@CH00583                             1000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  1001
         L     @08,@PC00001                                        1001
         ST    @08,@AL00001                                        1001
         LA    @05,@CF00113                                        1001
         ST    @05,@AL00001+4                                      1001
         LA    @05,DDSTRU                                          1001
         ST    @05,@AL00001+8                                      1001
         MVI   @AL00001+8,X'80'                                    1001
         L     @15,GDTPRT(,@08)                                    1001
         LA    @01,@AL00001                                        1001
         BALR  @14,@15                                             1001
*              LASTCOND = LASTCC04;                        /*@YL026UD*/
*                                                                  1002
         L     @08,@PC00001+8                                      1002
         MVC   LASTCOND(2,@08),@CH00042                            1002
*              RETURN;                                     /*@YL026UD*/
*                                                                  1003
         B     @EL00014                                            1003
*            END;                                          /*@YL026UD*/
*                                                                  1004
*        OLDERID2 = NEWERID2;                                      1005
@RF00993 L     @07,@PC00001                                        1005
         L     @07,GDTTR2(,@07)                                    1005
         MVC   @TS00001(95),NEWERID2(@07)                          1005
         MVC   OLDERID2(95,@07),@TS00001                           1005
*        NEWID2 = 'CCLT';                                  /*@YL026UD*/
*                                                                  1006
         MVC   NEWID2(4,@07),@CC01237                              1006
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  LOCATE THE DUPLICATE ENTRY IN THE VSAM CATALOG -        */
*        /*  TO DETERMINE THE ENTRY TYPE AND OBTAIN THE      @YL026UD*/
*        /*  VOLUME INFORMATION OF THE ENTRY                 @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  BUILD THE VSAM CATALOG PARAMETER LISTS          @YL026UD*/
*        /*  TO 'LOCATE' THE DUPLICATE CATALOG ENTRY         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE PARAMETER LISTS REQUIRED ARE -              @YL026UD*/
*        /*  (1) CPL - CATALOG PARAMETER LIST                @YL026UD*/
*        /*            (TO IDENTIFY THE 'LOCATE' REQUEST,    @YL026UD*/
*        /*            THE DUPLICATE ENTRY NAME,             @YL026UD*/
*        /*            AND THE RECEIVING VSAM CATALOG)       @YL026UD*/
*        /*  (2) FPL - FIELD PARAMETER LISTS                 @YL026UD*/
*        /*            (TO REQUEST THAT ENTRY TYPE AND       @YL026UD*/
*        /*            ENTRY VOLUME INFO BE RETURNED)        @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1007
*        CALL LOCTLSTS;                                    /*@YL026UD*/
*                                                                  1007
         BAL   @14,LOCTLSTS                                        1007
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ISSUE 'UCATLG' MACRO -                          @YL026UD*/
*        /*  TO LOCATE THE DUPLICATE ENTRY IN VSAM CATALOG   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  LOOP PERMITS REISSUANCE OF LOCATE WHEN INITIAL  @YL026UD*/
*        /*  INVOCATION SPECIFIES INSUFFICIENT WORKAREA      @YL026UD*/
*        /*  (IF INSUFFICIENT WORKAREA, A 'UFSPACE' MACRO    @YL026UD*/
*        /*  IF ISSUED TO FREE THE EXISTING WORKAREA, AND    @YL026UD*/
*        /*  A 'UGPOOL' MACRO IS ISSUED TO ACQUIRE THE       @YL026UD*/
*        /*  LARGER WORKAREA REQUIRED.  THE LARGER REQUIRED  @YL026UD*/
*        /*  SIZE IS RETURNED FROM VSAM CATALOG MANAGEMENT   @YL026UD*/
*        /*  IN THE EXISTING WORKAREA)                       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1008
*        LOCATFLG = ON;                                    /*@YL026UD*/
*                                                                  1008
         OI    LOCATFLG,B'10000000'                                1008
*LOCATE: DO INDEX = 1 TO 2 WHILE(LOCATFLG = ON);           /*@YL026UD*/
*                                                                  1009
LOCATE   LA    INDEX,1                                             1009
@DL01009 TM    LOCATFLG,B'10000000'                                1009
         BNO   @DC01009                                            1009
*          CTGWKA = WKAPTR;                                /*@YL026UD*/
*                                                                  1010
         L     @15,WKAPTR                                          1010
         ST    @15,CTGWKA(,CTGPLPTR)                               1010
*          WKALEN = WKASIZE;                               /*@YL026UD*/
*                                                                  1011
         L     @14,WKASIZE                                         1011
         STH   @14,WKALEN(,@15)                                    1011
*          CALL IDCSACA0(GDTTBL,CATPLPTR);                 /*@YL026UD*/
*                                                                  1012
         L     @15,@PC00001                                        1012
         ST    @15,@AL00001                                        1012
         LA    @14,CATPLPTR                                        1012
         ST    @14,@AL00001+4                                      1012
         L     @15,GDTCAT(,@15)                                    1012
         LA    @01,@AL00001                                        1012
         BALR  @14,@15                                             1012
*          RESPECIFY RTNREG RSTD;                                  1013
*          TESTRC = RTNREG;                                        1014
         LR    TESTRC,RTNREG                                       1014
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UD*/
*                                                                  1015
*          IF TESTRC ^= 0                                          1016
*            THEN                                                  1016
         LTR   TESTRC,TESTRC                                       1016
         BZ    @RF01016                                            1016
*              DO;                                         /*@YL026UD*/
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  VSAM CATALOG RETURN CODE IS NOT ZERO -  @YL026UD*/
*                /*  IF RETURN CODE SPECIFIES INSUFFICIENT   @YL026UD*/
*                /*  WORKAREA, INCREASE THE WORKAREA AND     @YL026UD*/
*                /*  REISSUE THE 'LOCATE' REQUEST            @YL026UD*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  1018
*                IF TESTRC = WKASCODE & INDEX = 1                  1018
*                  THEN                                            1018
         C     TESTRC,@CF01227                                     1018
         BNE   @RF01018                                            1018
         C     INDEX,@CF00215                                      1018
         BNE   @RF01018                                            1018
*                    DO;                                   /*@YL026UD*/
*                      WKASIZE = WKAREQD;                  /*@YL026UD*/
*                                                                  1020
         L     @01,WKAPTR                                          1020
         LH    @15,WKAREQD(,@01)                                   1020
         ST    @15,WKASIZE                                         1020
*                      CALL IDCSAFS0(GDTTBL,WKAPTR);       /*@YL026UD*/
*                                                                  1021
         L     @15,@PC00001                                        1021
         ST    @15,@AL00001                                        1021
         LA    @14,WKAPTR                                          1021
         ST    @14,@AL00001+4                                      1021
         L     @15,GDTFSP(,@15)                                    1021
         LA    @01,@AL00001                                        1021
         BALR  @14,@15                                             1021
*                      CALL IDCSAGP0(GDTTBL,WKASIZE,WKAPTR,        1022
*                             POOLID,SETZERO);             /*@YL026UD*/
*                                                                  1022
         L     @15,@PC00001                                        1022
         ST    @15,@AL00001                                        1022
         LA    @14,WKASIZE                                         1022
         ST    @14,@AL00001+4                                      1022
         LA    @14,WKAPTR                                          1022
         ST    @14,@AL00001+8                                      1022
         LA    @14,@CC00862                                        1022
         ST    @14,@AL00001+12                                     1022
         LA    @14,SETZERO                                         1022
         ST    @14,@AL00001+16                                     1022
         MVI   @AL00001+16,X'80'                                   1022
         L     @15,GDTGPL(,@15)                                    1022
         LA    @01,@AL00001                                        1022
         BALR  @14,@15                                             1022
*                      RESPECIFY RTNREG RSTD;                      1023
*                      TESTRC = RTNREG;                            1024
         LR    TESTRC,RTNREG                                       1024
*                      RESPECIFY RTNREG UNRSTD;            /*@YL026UD*/
*                                                                  1025
*                      IF TESTRC ^= 0                              1026
*                        THEN                                      1026
         LTR   TESTRC,TESTRC                                       1026
         BZ    @RF01026                                            1026
*                          TESTRC = WKASCODE;              /*@YL026UD*/
         LA    TESTRC,40                                           1027
*                    END;                                  /*@YL026UD*/
*                                                                  1028
@RF01026 DS    0H                                                  1029
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  VSAM CATALOG RETURN CODE IS NOT ZERO -  @YL026UD*/
*                /*  CALL ERRPROC TO INVOKE UERROR TO        @Y30SSMK*/
*                /*  PRINT THE ERROR MESSAGE, AND INDICATE THAT      */
*                /*  THE ENTRY WAS NOT SUCESSFULLY CONVERTED.        */
*                /*                                          @YL026UD*/
*                /*  NOTE: ONLY ONE ATTEMPT IS MADE TO       @YL026UD*/
*                /*  SATISFY THE 'INSUFFICIENT WORKAREA'     @YL026UD*/
*                /*  RETURN CODE BY SUPPLYING THE 'REQUIRED' @YL026UD*/
*                /*  WORKAREA TO VSAM CATALOG MANAGEMENT     @YL026UD*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*                                                                  1029
*                IF TESTRC ^= 0                                    1029
*                  THEN                                            1029
@RF01018 LTR   TESTRC,TESTRC                                       1029
         BZ    @RF01029                                            1029
*                    DO;                                   /*@YL026UD*/
*                                                                  1030
*                      ERRORTYP = ERRORLC;                 /*@Y30SSMK*/
         LA    ERRORTYP,2                                          1031
*                      CALL ERRPROC;                       /*@Y30SSMK*/
*                                                                  1032
         BAL   @14,ERRPROC                                         1032
*                      DARGSMOD = CNVTMSG;                 /*@YL026UD*/
         L     @08,DDSTRU                                          1033
         MVC   DARGSMOD(3,@08),@CC00831                            1033
*                      DARGSENT = NCVTMSG#;                /*@YL026UD*/
*                                                                  1034
         MVI   DARGSENT(@08),X'09'                                 1034
*                      DARGDBP = ADDR(DSNAME);             /*@YL026UD*/
         LA    @05,DSNAME                                          1035
         ST    @05,DARGDBP(,@08)                                   1035
*                      DARGILP = LENGTH(DSNAME);           /*@YL026UD*/
*                                                                  1036
         MVC   DARGILP(2,@08),@CH00583                             1036
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       1037
         L     @08,@PC00001                                        1037
         ST    @08,@AL00001                                        1037
         LA    @05,@CF00113                                        1037
         ST    @05,@AL00001+4                                      1037
         LA    @05,DDSTRU                                          1037
         ST    @05,@AL00001+8                                      1037
         MVI   @AL00001+8,X'80'                                    1037
         L     @15,GDTPRT(,@08)                                    1037
         LA    @01,@AL00001                                        1037
         BALR  @14,@15                                             1037
*                                                          /*@YL026UD*/
*                                                                  1038
*                      LASTCOND = LASTCC08;                /*@YL026UD*/
*                                                                  1038
         L     @08,@PC00001+8                                      1038
         MVC   LASTCOND(2,@08),@CH00175                            1038
*                      RETURN;                             /*@YL026UD*/
         B     @EL00014                                            1039
*                    END;                                  /*@YL026UD*/
*                                                                  1040
*              END;                                        /*@YL026UD*/
*            ELSE                                                  1042
*              LOCATFLG = OFF;                             /*@YL026UD*/
*                                                                  1042
         B     @RC01016                                            1042
@RF01016 NI    LOCATFLG,B'01111111'                                1042
*        END LOCATE;                                       /*@YL026UD*/
*                                                                  1043
@RC01016 AL    INDEX,@CF00215                                      1043
         C     INDEX,@CF00149                                      1043
         BNH   @DL01009                                            1043
@DC01009 DS    0H                                                  1044
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/
*        /*  THE ENTRY TYPE, AND CATALOG VOLUME INFORMATION  @YL026UD*/
*        /*  RETURNED BY THE VSAM 'LOCATE' REQUEST           @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1044
*                                                                  1044
*        IF GDTDBG = NULLPTR                                       1044
*          THEN;                                                   1044
         L     @05,@PC00001                                        1044
         L     @05,GDTDBG(,@05)                                    1044
         LTR   @05,@05                                             1044
         BZ    @RT01044                                            1044
*          ELSE                                                    1046
*            DO;                                                   1046
*              DMPINDEX = ADDR(DLISTVIL);                          1047
*                                                                  1047
         LA    DMPINDEX,DLISTVIL                                   1047
*              DMPITMNM = 'ENTYPPTR';                              1048
         MVC   DMPITMNM(8,DMPINDEX),@CC01241                       1048
*              DMPITMPT = ADDR(ENTYPFPL->CTGFLPT(1));              1049
         L     @05,ENTYPFPL                                        1049
         LA    @03,CTGFLPT(,@05)                                   1049
         ST    @03,DMPITMPT(,DMPINDEX)                             1049
*              DMPITMLN = 4;                                       1050
         LA    @03,4                                               1050
         STH   @03,DMPITMLN(,DMPINDEX)                             1050
*              DMPITMTP = 'H';                                     1051
         MVI   DMPITMTP(DMPINDEX),C'H'                             1051
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1052
*                                                                  1052
         LA    @15,16                                              1052
         ALR   DMPINDEX,@15                                        1052
*              DMPITMNM = 'ENTYPLST';                              1053
         MVC   DMPITMNM(8,DMPINDEX),@CC01242                       1053
*              DMPITMPT = ADDR(ENTYPFPL->CTGFLPT(1)->LOCINFO);     1054
         L     @14,CTGFLPT(,@05)                                   1054
         ST    @14,DMPITMPT(,DMPINDEX)                             1054
*              DMPITMLN = MIN(256,ENTYPFPL->CTGFLNG(1));           1055
         LA    @14,256                                             1055
         L     @05,CTGFLNG(,@05)                                   1055
         CR    @05,@14                                             1055
         BNH   *+6
         LR    @05,@14                                             1055
         STH   @05,DMPITMLN(,DMPINDEX)                             1055
*              DMPITMTP = 'H';                                     1056
         MVI   DMPITMTP(DMPINDEX),C'H'                             1056
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1057
*                                                                  1057
         ALR   DMPINDEX,@15                                        1057
*              DMPITMNM = 'CATVLPTR';                              1058
         MVC   DMPITMNM(8,DMPINDEX),@CC01243                       1058
*              DMPITMPT = ADDR(CATVLFPL->CTGFLPT(1));              1059
         L     @05,CATVLFPL                                        1059
         LA    @01,CTGFLPT(,@05)                                   1059
         ST    @01,DMPITMPT(,DMPINDEX)                             1059
*              DMPITMLN = 4;                                       1060
         STH   @03,DMPITMLN(,DMPINDEX)                             1060
*              DMPITMTP = 'H';                                     1061
         MVI   DMPITMTP(DMPINDEX),C'H'                             1061
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1062
*                                                                  1062
         ALR   DMPINDEX,@15                                        1062
*              DMPITMNM = 'CATVLLST';                              1063
         MVC   DMPITMNM(8,DMPINDEX),@CC01244                       1063
*              DMPITMPT = ADDR(CATVLFPL->CTGFLPT(1)->LOCINFO);     1064
         L     @03,CTGFLPT(,@05)                                   1064
         ST    @03,DMPITMPT(,DMPINDEX)                             1064
*              DMPITMLN = MIN(256,CATVLFPL->CTGFLNG(1));           1065
         L     @05,CTGFLNG(,@05)                                   1065
         CR    @05,@14                                             1065
         BNH   *+6
         LR    @05,@14                                             1065
         STH   @05,DMPITMLN(,DMPINDEX)                             1065
*              DMPITMTP = 'H';                                     1066
         MVI   DMPITMTP(DMPINDEX),C'H'                             1066
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1067
*                                                                  1067
         ALR   DMPINDEX,@15                                        1067
*              DMPTRM = DMPTRMVL;                                  1068
         MVI   DMPTRM(DMPINDEX),X'FF'                              1068
*            END;                                                  1069
*                                                                  1069
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT AFTER VOLUME INFORMATION IS RETURNED @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1070
*        IF GDTDBG = NULLPTR                                       1070
*          THEN;                                                   1070
@RT01044 L     @05,@PC00001                                        1070
         L     @05,GDTDBG(,@05)                                    1070
         LTR   @05,@05                                             1070
         BZ    @RT01070                                            1070
*          ELSE                                                    1072
*            CALL IDCDB010(GDTTBL,'CCLV',ADDR(DLISTVIL));          1072
         L     @05,@PC00001                                        1072
         ST    @05,@AL00001                                        1072
         LA    @15,@CC01245                                        1072
         ST    @15,@AL00001+4                                      1072
         LA    @15,DLISTVIL                                        1072
         ST    @15,@AFTEMPS+24                                     1072
         LA    @15,@AFTEMPS+24                                     1072
         ST    @15,@AL00001+8                                      1072
         MVI   @AL00001+8,X'80'                                    1072
         L     @15,GDTDBG(,@05)                                    1072
         LA    @01,@AL00001                                        1072
         BALR  @14,@15                                             1072
*                                                          /*@YL026UD*/
*                                                                  1073
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DUPLICATE ENTRY SUCCESSFULLY LOCATED -          @YL026UD*/
*        /*  DETERMINE ENTRY TYPE OF LOCATED ENTRY           @YL026UD*/
*        /*  (FROM INFORMATION RETURNED BY LOCATE            @YL026UD*/
*        /*  IN THE ENTRY TYPE FPL)                          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1073
*        IF ENTYPFPL -> CTGFLPT(1) -> ENTYPE ^= CTGTALIN           1073
*          THEN                                                    1073
@RT01070 L     @05,ENTYPFPL                                        1073
         L     @05,CTGFLPT(,@05)                                   1073
         CLI   ENTYPE(@05),C'A'                                    1073
         BE    @RF01073                                            1073
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  ENTRY LOCATED IS NOT A NONVSAM ENTRY -    @YL026UD*/
*              /*  DUPLICATE ENTRY IS NOT CONVERTED          @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1075
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          1075
         MVC   DARGSMOD(3,@08),@CC00831                            1075
*              DARGSENT = DUPLMSG#;                        /*@YL026UD*/
*                                                                  1076
         MVI   DARGSENT(@08),X'03'                                 1076
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  1077
         L     @08,@PC00001                                        1077
         ST    @08,@AL00001                                        1077
         LA    @05,@CF00113                                        1077
         ST    @05,@AL00001+4                                      1077
         LA    @05,DDSTRU                                          1077
         ST    @05,@AL00001+8                                      1077
         MVI   @AL00001+8,X'80'                                    1077
         L     @15,GDTPRT(,@08)                                    1077
         LA    @01,@AL00001                                        1077
         BALR  @14,@15                                             1077
*              DARGSENT = NCVTMSG#;                        /*@YL026UD*/
*                                                                  1078
         L     @08,DDSTRU                                          1078
         MVI   DARGSENT(@08),X'09'                                 1078
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @05,DSNAME                                          1079
         ST    @05,DARGDBP(,@08)                                   1079
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/
*                                                                  1080
         MVC   DARGILP(2,@08),@CH00583                             1080
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  1081
         L     @08,@PC00001                                        1081
         ST    @08,@AL00001                                        1081
         LA    @05,@CF00113                                        1081
         ST    @05,@AL00001+4                                      1081
         LA    @05,DDSTRU                                          1081
         ST    @05,@AL00001+8                                      1081
         MVI   @AL00001+8,X'80'                                    1081
         L     @15,GDTPRT(,@08)                                    1081
         LA    @01,@AL00001                                        1081
         BALR  @14,@15                                             1081
*              TRUEFLG = OFF;                              /*@YL026UD*/
*                                                                  1082
         NI    TRUEFLG,B'01111111'                                 1082
*              LASTCOND = LASTCC08;                        /*@YL026UD*/
*                                                                  1083
         L     @08,@PC00001+8                                      1083
         MVC   LASTCOND(2,@08),@CH00175                            1083
*              RETURN;                                     /*@YL026UD*/
         B     @EL00014                                            1084
*            END;                                          /*@YL026UD*/
*                                                                  1085
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ENTRY LOCATED IS A NONVSAM ENTRY -              @YL026UD*/
*        /*  COMPARE THE VOLUME INFORMATION OF THE CATALOGED @YL026UD*/
*        /*  ENTRY WITH THE VOLUME INFORMATION OF THE        @YL026UD*/
*        /*  DUPLICATE ENTRY BEING DEFINED                   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE VOLUME INFORMATION OF THE CATALOGED ENTRY   @YL026UD*/
*        /*  WILL BE UPDATED (IF NECESSARY) TO MATCH THAT    @YL026UD*/
*        /*  OF THE DUPLICATE ENTRY BEING DEFINED            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1086
*        SCANFLAG = OFF;                                   /*@YL026UD*/
*                                                                  1086
@RF01073 NI    SCANFLAG,B'01111111'                                1086
*        CATVLCNT = CATVLFPL -> CTGFLNG(1)/LENGTH(CATVLIST);       1087
*                                                                  1087
         L     @01,CATVLFPL                                        1087
         L     @00,CTGFLNG(,@01)                                   1087
         SRDA  @00,32                                              1087
         D     @00,@CF00224                                        1087
         LR    CATVLCNT,@01                                        1087
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  COMPARE THE NUMBER OF VOLUMES OVER WHICH        @YL026UD*/
*        /*  THE DUPLICATE DATA SETS ARE DEFINED -           @YL026UD*/
*        /*  IF UNEQUAL, THE VOLUME INFORMATION CANNOT MATCH @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1088
*        IF CATVLCNT = VOLCNT                                      1088
*          THEN                                                    1088
         CH    CATVLCNT,VOLCNT                                     1088
         BNE   @RF01088                                            1088
*VOLSCAN1:   DO;                                           /*@YL026UD*/
VOLSCAN1 DS    0H                                                  1090
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  NUMBER OF VOLUMES IS EQUAL FOR THE        @YL026UD*/
*              /*  DUPLICATE DATA SETS                       @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  COMPARE THE VOLUME SERIAL NUMBERS FOR     @YL026UD*/
*              /*  EACH VOLUME OVER WHICH THE DUPLICATE      @YL026UD*/
*              /*  DATA SETS ARE DEFINED                     @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  LOOP THROUGH EACH VOLUME SERIAL NUMBER    @YL026UD*/
*              /*  FOR THE CATALOGED DATA SET UNTIL          @YL026UD*/
*              /*  UNMATCHING VOLUME INFORMATION IS FOUND    @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1090
*              SCANFLAG = ON;                              /*@YL026UD*/
*                                                                  1090
         OI    SCANFLAG,B'10000000'                                1090
*VOLSCAN2:     DO CATVINDX = 1 TO CATVLCNT                         1091
*                            WHILE(SCANFLAG = ON);         /*@YL026UD*/
*                                                                  1091
VOLSCAN2 LA    CATVINDX,1                                          1091
         B     @DE01091                                            1091
@DL01091 TM    SCANFLAG,B'10000000'                                1091
         BNO   @DC01091                                            1091
*                MATCHFLG = OFF;                           /*@YL026UD*/
*                                                                  1092
         NI    MATCHFLG,B'01111111'                                1092
*                /****************************************************/
*                /*                                          @YL026UD*/
*                /*  LOOP THROUGH EACH VOLUME SERIAL NUMBER  @YL026UD*/
*                /*  FOR THE DUPLICATE DATA SET BEING        @YL026UD*/
*                /*  CONVERTED UNTIL UNMATCHING VOLUME       @YL026UD*/
*                /*  INFORMATION IS FOUND                    @YL026UD*/
*                /*                                          @YL026UD*/
*                /****************************************************/
*VOLSCAN3:       DO VOLINDX = 1 TO VOLCNT                          1093
*                             WHILE(MATCHFLG = OFF);       /*@YL026UD*/
*                                                                  1093
VOLSCAN3 LA    VOLINDX,1                                           1093
         B     @DE01093                                            1093
@DL01093 TM    MATCHFLG,B'10000000'                                1093
         BNZ   @DC01093                                            1093
*                  IF VOLSER(VOLINDX) = CATVLFPL ->                1094
*                           CTGFLPT(1) -> CVVOLSER(CATVINDX)       1094
*                    THEN                                          1094
         LR    @15,VOLINDX                                         1094
         SLA   @15,3                                               1094
         LR    @14,CATVINDX                                        1094
         MH    @14,@CH00224                                        1094
         L     @01,CATVLFPL                                        1094
         L     @01,CTGFLPT(,@01)                                   1094
         ST    @15,@TF00001                                        1094
         L     @15,VOLPTR                                          1094
         AL    @15,@TF00001                                        1094
         AL    @15,@CF01314                                        1094
         ST    @14,@TF00001                                        1094
         ALR   @14,@01                                             1094
         AL    @14,@CF01325                                        1094
         CLC   VOLSER-4(6,@15),CVVOLSER-6(@14)                     1094
         BNE   @RF01094                                            1094
*                      DO;                                 /*@YL026UD*/
*                        /********************************************/
*                        /*                                  @YL026UD*/
*                        /*  MATCHING VOLUME NUMBER FOUND -  @YL026UD*/
*                        /*  COMPARE DEVICE TYPE AND FILE    @YL026UD*/
*                        /*  SEQUENCE INFORMATION FOR THE    @YL026UD*/
*                        /*  MATCHING VOLUMES                @YL026UD*/
*                        /*                                  @YL026UD*/
*                        /********************************************/
*                                                                  1096
*                        IF DEVTCODE(VOLINDX) ^=                   1096
*                                   CATVLFPL -> CTGFLPT(1) ->      1096
*                                   CVDEVTYP(CATVINDX)             1096
*                           FILESEQ(VOLINDX) ^=                   1096
*                                   CATVLFPL -> CTGFLPT(1) ->      1096
*                                   CVFSEQ(CATVINDX)               1096
*                          THEN                                    1096
         LR    @15,VOLINDX                                         1096
         MH    @15,@CH00037                                        1096
         L     @14,DEVTPTR                                         1096
         ALR   @14,@15                                             1096
         AL    @14,@CF01314                                        1096
         LR    @15,@01                                             1096
         AL    @15,@TF00001                                        1096
         AL    @15,@CF01326                                        1096
         CLC   DEVTCODE-8(4,@14),CVDEVTYP-2(@15)                   1096
         BNE   @RT01096                                            1096
         LR    @15,VOLINDX                                         1096
         ALR   @15,@15                                             1096
         L     @14,FILEPTR                                         1096
         ALR   @14,@15                                             1096
         AL    @14,@CF01316                                        1096
         AL    @01,@TF00001                                        1096
         AL    @01,@CF01327                                        1096
         CLC   FILESEQ(2,@14),CVFSEQ-12(@01)                       1096
         BE    @RF01096                                            1096
@RT01096 DS    0H                                                  1097
*                            SCANFLAG = OFF;               /*@YL026UD*/
*                                                                  1097
         NI    SCANFLAG,B'01111111'                                1097
*                        MATCHFLG = ON;                    /*@YL026UD*/
@RF01096 OI    MATCHFLG,B'10000000'                                1098
*                      END;                                /*@YL026UD*/
*                                                                  1099
*                END VOLSCAN3;                             /*@YL026UD*/
*                                                                  1100
@RF01094 AL    VOLINDX,@CF00215                                    1100
@DE01093 CH    VOLINDX,VOLCNT                                      1100
         BNH   @DL01093                                            1100
@DC01093 DS    0H                                                  1101
*                IF MATCHFLG = OFF                                 1101
*                  THEN                                            1101
         TM    MATCHFLG,B'10000000'                                1101
         BNZ   @RF01101                                            1101
*                    SCANFLAG = OFF;                       /*@YL026UD*/
*                                                                  1102
         NI    SCANFLAG,B'01111111'                                1102
*              END VOLSCAN2;                               /*@YL026UD*/
*                                                                  1103
@RF01101 AL    CATVINDX,@CF00215                                   1103
@DE01091 CR    CATVINDX,CATVLCNT                                   1103
         BNH   @DL01091                                            1103
@DC01091 DS    0H                                                  1104
*            END VOLSCAN1;                                 /*@YL026UD*/
*                                                                  1104
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF THE VOLUME INFORMATION OF THE CATALOGED      @YL026UD*/
*        /*  ENTRY MATCHES THAT OF THE DUPLICATE ENTRY       @YL026UD*/
*        /*  BEING DEFINED - NO UPDATING OF THE VOLUME       @YL026UD*/
*        /*  INFORMATION IS REQUIRED                         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  IF 'LIST' OPTION IS SPECIFIED OR DEFAULTED -    @YL026UD*/
*        /*  PRINT THE NAME OF THE EXISTING ENTRY            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1105
*        IF SCANFLAG = ON & ADDR(LIST) ^= NULLPTR                  1105
*          THEN                                                    1105
@RF01088 TM    SCANFLAG,B'10000000'                                1105
         BNO   @RF01105                                            1105
         L     @05,@PC00001+4                                      1105
         L     @05,FDTPTR+36(,@05)                                 1105
         LTR   @05,@05                                             1105
         BZ    @RF01105                                            1105
*            DO;                                           /*@YL026UD*/
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          1107
         MVC   DARGSMOD(3,@08),@CC00831                            1107
*              DARGSENT = EXSTMSG#;                        /*@YL026UD*/
*                                                                  1108
         MVI   DARGSENT(@08),X'08'                                 1108
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @05,DSNAME                                          1109
         ST    @05,DARGDBP(,@08)                                   1109
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/
*                                                                  1110
         MVC   DARGILP(2,@08),@CH00583                             1110
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  1111
         L     @08,@PC00001                                        1111
         ST    @08,@AL00001                                        1111
         LA    @05,@CF00113                                        1111
         ST    @05,@AL00001+4                                      1111
         LA    @05,DDSTRU                                          1111
         ST    @05,@AL00001+8                                      1111
         MVI   @AL00001+8,X'80'                                    1111
         L     @15,GDTPRT(,@08)                                    1111
         LA    @01,@AL00001                                        1111
         BALR  @14,@15                                             1111
*              RETURN;                                     /*@YL026UD*/
         B     @EL00014                                            1112
*            END;                                          /*@YL026UD*/
*                                                                  1113
*        OLDERID2 = NEWERID2;                                      1114
@RF01105 L     @05,@PC00001                                        1114
         L     @05,GDTTR2(,@05)                                    1114
         MVC   @TS00001(95),NEWERID2(@05)                          1114
         MVC   OLDERID2(95,@05),@TS00001                           1114
*        NEWID2 = 'CCAT';                                  /*@YL026UD*/
*                                                                  1115
         MVC   NEWID2(4,@05),@CC01252                              1115
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  VOLUME INFORMATION OF THE CATALOGED ENTRY       @YL026UD*/
*        /*  DOES NOT MATCH THE VOLUME INFORMATION OF THE    @YL026UD*/
*        /*  DUPLICATE ENTRY BEING DEFINED -                 @YL026UD*/
*        /*  VOLUME INFORMATION OF THE CATALOGED ENTRY       @YL026UD*/
*        /*  MUST BE UPDATED (ALTERED) TO MATCH THE          @YL026UD*/
*        /*  DUPLICATE ENTRY BEING DEFINED                   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  BUILD THE VSAM CATALOG PARAMETER LISTS          @YL026UD*/
*        /*  TO 'ALTER' THE NONVSAM CATALOG ENTRY            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /*  THE PARAMETER LISTS REQUIRED ARE -              @YL026UD*/
*        /*  (1) CPL - CATALOG PARAMETER LIST                @YL026UD*/
*        /*            (TO IDENTIFY THE 'ALTER' REQUEST      @YL026UD*/
*        /*            AND THE RECEIVING VSAM CATALOG)       @YL026UD*/
*        /*  (2) FVT - FIELD VECTOR TABLE                    @YL026UD*/
*        /*            (TO IDENTIFY THE ENTRY TO BE ALTERED) @YL026UD*/
*        /*  (3) FPL - FIELD PARAMETER LISTS                 @YL026UD*/
*        /*            (FOR THE UPDATED DEVICE TYPE AND      @YL026UD*/
*        /*            FILE SEQUENCE INFORMATION)            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1116
*        CALL ALTRLSTS;                                    /*@YL026UD*/
*                                                                  1116
         BAL   @14,ALTRLSTS                                        1116
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ISSUE 'UCATLG' MACRO -                          @YL026UD*/
*        /*  TO ALTER THE NONVSAM ENTRY IN THE VSAM CATALOG  @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1117
*        CALL IDCSACA0(GDTTBL,CATPLPTR);                   /*@YL026UD*/
*                                                                  1117
         L     @08,@PC00001                                        1117
         ST    @08,@AL00001                                        1117
         LA    @15,CATPLPTR                                        1117
         ST    @15,@AL00001+4                                      1117
         L     @15,GDTCAT(,@08)                                    1117
         LA    @01,@AL00001                                        1117
         BALR  @14,@15                                             1117
*        RESPECIFY RTNREG RSTD;                                    1118
*        TESTRC = RTNREG;                                          1119
         LR    TESTRC,RTNREG                                       1119
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UD*/
*                                                                  1120
*        IF TESTRC = 0                                             1121
*          THEN                                                    1121
         SLR   @08,@08                                             1121
         CR    TESTRC,@08                                          1121
         BNE   @RF01121                                            1121
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  VSAM CATALOG RETURN CODE IS ZERO -        @YL026UD*/
*              /*  NONVSAM ENTRY SUCCESSFULLY ALTERED        @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  IF 'LIST' OPTION IS SPECIFIED OR DEFAULTED        */
*              /*  PRINT NAME OF ENTRY SUCCESSFULLY ALTERED  @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1123
*              IF ADDR(LIST) ^= NULLPTR                            1123
*                THEN                                              1123
         L     @05,@PC00001+4                                      1123
         C     @08,FDTPTR+36(,@05)                                 1123
         BE    @RF01123                                            1123
*                  DO;                                     /*@YL026UD*/
*                    DARGSMOD = CNVTMSG;                   /*@YL026UD*/
         L     @08,DDSTRU                                          1125
         MVC   DARGSMOD(3,@08),@CC00831                            1125
*                    DARGSENT = UPDTMSG#;                  /*@YL026UD*/
*                                                                  1126
         MVI   DARGSENT(@08),X'0C'                                 1126
*                    DARGDBP = ADDR(DSNAME);               /*@YL026UD*/
         LA    @05,DSNAME                                          1127
         ST    @05,DARGDBP(,@08)                                   1127
*                    DARGILP = LENGTH(DSNAME);             /*@YL026UD*/
*                                                                  1128
         MVC   DARGILP(2,@08),@CH00583                             1128
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU); /*@YL026UD*/
         L     @08,@PC00001                                        1129
         ST    @08,@AL00001                                        1129
         LA    @05,@CF00113                                        1129
         ST    @05,@AL00001+4                                      1129
         LA    @05,DDSTRU                                          1129
         ST    @05,@AL00001+8                                      1129
         MVI   @AL00001+8,X'80'                                    1129
         L     @15,GDTPRT(,@08)                                    1129
         LA    @01,@AL00001                                        1129
         BALR  @14,@15                                             1129
*                  END;                                    /*@YL026UD*/
*                                                                  1130
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  INCREMENT COUNT OF ENTRIES                @YL026UD*/
*              /*  SUCCESSFULLY UPDATED                      @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1131
*              UPDTCNT = UPDTCNT + 1;                      /*@YL026UD*/
*                                                                  1131
@RF01123 LA    @08,1                                               1131
         AL    @08,UPDTCNT                                         1131
         ST    @08,UPDTCNT                                         1131
*              RETURN;                                     /*@YL026UD*/
         B     @EL00014                                            1132
*            END;                                          /*@YL026UD*/
*          ELSE                                                    1134
*            DO;                                           /*@YL026UD*/
@RF01121 DS    0H                                                  1135
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  VSAM CATALOG RETURN CODE IS NOT ZERO -    @YL026UD*/
*              /*  NONVSAM ENTRY NOT SUCCESSFULLY ALTERED    @YL026UD*/
*              /*                                            @YL026UD*/
*              /*  CALL ERRPROC TO INVOKE UERROR TO PRINT THE        */
*              /*  ERROR MESSAGE, AND INDICATE THAT THE ENTRY        */
*              /*  WAS NOT SUCCESSFULLY UPDATED.             @Y30SSMK*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1135
*              ERRORTYP = ERRORAL;                         /*@Y30SSMK*/
         LA    ERRORTYP,3                                          1135
*              CALL ERRPROC;                               /*@Y30SSMK*/
*                                                                  1136
         BAL   @14,ERRPROC                                         1136
*              DARGSMOD = CNVTMSG;                         /*@YL026UD*/
         L     @08,DDSTRU                                          1137
         MVC   DARGSMOD(3,@08),@CC00831                            1137
*              DARGSENT = NUPDMSG#;                        /*@YL026UD*/
*                                                                  1138
         MVI   DARGSENT(@08),X'0B'                                 1138
*              DARGDBP = ADDR(DSNAME);                     /*@YL026UD*/
         LA    @05,DSNAME                                          1139
         ST    @05,DARGDBP(,@08)                                   1139
*              DARGILP = LENGTH(DSNAME);                   /*@YL026UD*/
*                                                                  1140
         MVC   DARGILP(2,@08),@CH00583                             1140
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UD*/
*                                                                  1141
         L     @08,@PC00001                                        1141
         ST    @08,@AL00001                                        1141
         LA    @05,@CF00113                                        1141
         ST    @05,@AL00001+4                                      1141
         LA    @05,DDSTRU                                          1141
         ST    @05,@AL00001+8                                      1141
         MVI   @AL00001+8,X'80'                                    1141
         L     @15,GDTPRT(,@08)                                    1141
         LA    @01,@AL00001                                        1141
         BALR  @14,@15                                             1141
*              LASTCOND = LASTCC08;                        /*@YL026UD*/
*                                                                  1142
         L     @08,@PC00001+8                                      1142
         MVC   LASTCOND(2,@08),@CH00175                            1142
*              RETURN;                                     /*@YL026UD*/
         B     @EL00014                                            1143
*            END;                                          /*@YL026UD*/
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - DEFNLSTS                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/
*/*             REQUIRED TO 'DEFINE' THE CONVERTED ENTRY     @YL026UD*/
*/*             IN THE PROPER VSAM CATALOG                   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THREE VSAM ENTRY TYPES CAN BE DEFINED -      @YL026UD*/
*/*             (1) 'NONVSAM' ENTRY                          @YL026UD*/
*/*                 (FOR SYSCTLG 'DSPE' OR 'VCBPE' ENTRY)    @YL026UD*/
*/*             (2) 'GDG BASE' ENTRY                         @YL026UD*/
*/*                 (FOR SYSCTLG 'GIPE' ENTRY)               @YL026UD*/
*/*             (3) 'ALIAS' ENTRY                            @YL026UD*/
*/*                 (FOR SYSCTLG 'AE' OR 'CVPE' ENTRY)       @YL026UD*/
*/*                 (A 'CVPE' ENTRY IS CONVERTED INTO  AN    @YL026UD*/
*/*                 ALIAS ENTRY IN THE VSAM MASTER CATALOG)  @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THREE PARAMETER LISTS ARE REQUIRED -         @YL026UD*/
*/*             (1) CPL - CATALOG PARAMETER LIST             @YL026UD*/
*/*                 (TO IDENTIFY THE 'DEFINE' REQUEST        @YL026UD*/
*/*                 AND THE RECEIVING VSAM CATALOG)          @YL026UD*/
*/*             (2) FVT - FIELD VECTOR TABLE                 @YL026UD*/
*/*                 (TO IDENTIFY THE ENTRY TO BE DEFINED     @YL026UD*/
*/*                 AND THE TYPE OF VSAM ENTRY CREATED)      @YL026UD*/
*/*             (3) FPL - FIELD PARAMETER LISTS              @YL026UD*/
*/*                 (FOR THE DEVICE TYPE AND FILE SEQUENCE   @YL026UD*/
*/*                 INFORMATION)                             @YL026UD*/
*/*                 (THE FPLS ARE NEEDED ONLY FOR THE        @YL026UD*/
*/*                 'NONVSAM' ENTRY TYPE)                    @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE REQUIRED STORAGE AREAS FOR THE VSAM         @YL026UD*/
*/*          CATALOG PARAMETER LISTS                         @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE INITIALIZED VSAM CATALOG PARAMETER LISTS   @YL026UD*/
*/*           TO 'DEFINE' THE CONVERTED ENTRY                @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  1145
*DEFNLSTS: PROCEDURE;                                      /*@YL026UD*/
DEFNLSTS STM   @14,@06,@SA00015                                    1145
         STM   @08,@12,@SA00015+36                                 1145
*        OLDERID2 = NEWERID2;                                      1146
         L     @05,@PC00001                                        1146
         L     @05,GDTTR2(,@05)                                    1146
         MVC   @TS00001(95),NEWERID2(@05)                          1146
         MVC   OLDERID2(95,@05),@TS00001                           1146
*        NEWID2 = 'CCDL';                                  /*@YL026UD*/
*                                                                  1147
         MVC   NEWID2(4,@05),@CC01257                              1147
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ZERO THE CPL/FVT/FPL PARAMETER LISTS            @YL026UD*/
*        /*  (NECESSARY SINCE THESE ARE NOT TREATED AS       @YL026UD*/
*        /*  READ-ONLY PARAMETER LISTS BY VSAM)              @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1148
*        DO INDEX = 1 TO CATPLLEN BY 8;                    /*@YL026UD*/
*                                                                  1148
         LA    INDEX,1                                             1148
         B     @DE01148                                            1148
@DL01148 DS    0H                                                  1149
*          CATPL(INDEX:INDEX+7) = CATZERO;                 /*@YL026UD*/
*                                                                  1149
         L     @06,CATPLPTR                                        1149
         ALR   @06,INDEX                                           1149
         AL    @06,@CF01151                                        1149
         MVC   CATPL(8,@06),CATZERO                                1149
*        END;                                              /*@YL026UD*/
*                                                                  1150
         AL    INDEX,@CF00175                                      1150
@DE01148 C     INDEX,CATPLLEN                                      1150
         BNH   @DL01148                                            1150
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE CATALOG PARAMETER LIST (CPL)         @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1151
*        CTGFUNC = CTGCMS;                                 /*@YL026UD*/
         NI    CTGFUNC(CTGPLPTR),B'10011111'                       1151
         OI    CTGFUNC(CTGPLPTR),B'10000000'                       1151
*        CTGOPTNS = CTGDEFIN;                              /*@YL026UD*/
         NI    CTGOPTNS(CTGPLPTR),B'00001111'                      1152
         OI    CTGOPTNS(CTGPLPTR),B'00001000'                      1152
*        CTGAM0 = ON;                                      /*@YL026UD*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        1153
*        CTGNAME = ON;                                     /*@YL026UD*/
*        CTGCNAME = ON;                                    /*@YL026UD*/
*                                                                  1155
         OI    CTGNAME(CTGPLPTR),B'00000110'                       1155
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF A 'CVPE' ENTRY IS BEING PROCESSED            @YL026UD*/
*        /*  THEN AN ALIAS ENTRY IS TO BE DEFINED            @YL026UD*/
*        /*  IN THE VSAM MASTER CATALOG                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1156
*        IF CVPEFLAG = ON                                          1156
*          THEN                                                    1156
         TM    CVPEFLAG,B'10000000'                                1156
         BNO   @RF01156                                            1156
*            DO;                                           /*@YL026UD*/
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  'CVPE' ENTRY BEING PROCESSED -            @YL026UD*/
*              /*  ADDRESS THE MASTER CATALOG IN THE CPL     @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1158
*              IF MRCATPLN ^= 0                                    1158
*                THEN                                              1158
         L     @06,@PC00001+4                                      1158
         L     @06,FDTPTR+32(,@06)                                 1158
         CLI   MRCATPLN(@06),0                                     1158
         BE    @RF01158                                            1158
*                  CTGPSWD = ADDR(MRCATPAS);               /*@YL026UD*/
*                                                                  1159
         LA    @06,MRCATPAS(,@06)                                  1159
         ST    @06,CTGPSWD(,CTGPLPTR)                              1159
*              CTGCAT = ADDR(MRCATVAL);                    /*@YL026UD*/
*                                                                  1160
@RF01158 L     @06,@PC00001+4                                      1160
         L     @06,FDTPTR+32(,@06)                                 1160
         LA    @06,MRCATVAL(,@06)                                  1160
         ST    @06,CTGCAT(,CTGPLPTR)                               1160
*            END;                                          /*@YL026UD*/
*          ELSE                                                    1162
*            DO;                                           /*@YL026UD*/
         B     @RC01156                                            1162
@RF01156 DS    0H                                                  1163
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  'CVPE' ENTRY NOT BEING PROCESSED -        @YL026UD*/
*              /*  ADDRESS THE VSAM CATALOG SPECIFIED        @YL026UD*/
*              /*  BY 'CATALOG' PARAMETER, STEPCAT,          @YL026UD*/
*              /*  JOBCAT, OR MASTERCATALOG HIERARCHY        @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1163
*              IF CATNMPLN ^= 0                                    1163
*                THEN                                              1163
         L     @06,@PC00001+4                                      1163
         L     @06,FDTPTR+12(,@06)                                 1163
         CLI   CATNMPLN(@06),0                                     1163
         BE    @RF01163                                            1163
*                  CTGPSWD = ADDR(CATNMPAS);               /*@YL026UD*/
*                                                                  1164
         LA    @06,CATNMPAS(,@06)                                  1164
         ST    @06,CTGPSWD(,CTGPLPTR)                              1164
*              IF ADDR(CAT) ^= 0                                   1165
*                THEN                                              1165
@RF01163 L     @06,@PC00001+4                                      1165
         L     @05,FDTPTR+8(,@06)                                  1165
         LTR   @05,@05                                             1165
         BZ    @RF01165                                            1165
*                  CTGCAT = ADDR(CATNMVAL);                /*@Y30SSMK*/
*                                                                  1166
         L     @06,FDTPTR+12(,@06)                                 1166
         LA    @06,CATNMVAL(,@06)                                  1166
         ST    @06,CTGCAT(,CTGPLPTR)                               1166
*            END;                                          /*@YL026UD*/
*                                                                  1167
@RF01165 DS    0H                                                  1168
*        CTGFVT = CATPLPTR + CPLLEN;                       /*@YL026UD*/
*                                                                  1168
@RC01156 LH    @06,CPLLEN                                          1168
         AL    @06,CATPLPTR                                        1168
         ST    @06,CTGFVT(,CTGPLPTR)                               1168
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE PROPER FVT -                     @YL026UD*/
*        /*  FOR ALIAS, GDG BASE, OR ALIEN (NONVSAM) ENTRY   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1169
*        CTGFVENT = ADDR(DSNAME);                          /*@YL026UD*/
*                                                                  1169
         LA    @05,DSNAME                                          1169
         ST    @05,CTGFVENT(,@06)                                  1169
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF 'CVPE' OR 'ALIAS' ENTRY IS BEING PROCESSED - @YL026UD*/
*        /*  INITIALIZE 'ALIAS' FVT                          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1170
*        IF CVPEFLAG = ON  ALIASFLG = ON                          1170
*          THEN                                                    1170
         TM    CVPEFLAG,B'10000000'                                1170
         BO    @RT01170                                            1170
         TM    ALIASFLG,B'10000000'                                1170
         BNO   @RF01170                                            1170
@RT01170 DS    0H                                                  1171
*ALIASFVT:   DO;                                           /*@YL026UD*/
*                                                                  1171
ALIASFVT DS    0H                                                  1172
*              CTGFVTYP = CTGFVANM;                        /*@YL026UD*/
         L     @06,CTGFVT(,CTGPLPTR)                               1172
         MVI   CTGFVTYP(@06),C'X'                                  1172
*              CTGFVNAM = ADDR(TRUEDSN);                   /*@YL026UD*/
*                                                                  1173
         LA    @05,TRUEDSN                                         1173
         ST    @05,CTGFVNAM(,@06)                                  1173
*            END ALIASFVT;                                 /*@Y30SSMK*/
*                                                                  1174
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF 'GIPE' ENTRY IS BEING PROCESSED -            @YL026UD*/
*        /*  INITIALIZE 'GDG BASE' FVT                       @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1175
*        IF GDGFLAG = ON                                           1175
*          THEN                                                    1175
@RF01170 TM    GDGFLAG,B'10000000'                                 1175
         BNO   @RF01175                                            1175
*GDGFVT:     DO;                                           /*@YL026UD*/
*                                                                  1176
GDGFVT   DS    0H                                                  1177
*              CTGFVTYP = CTGFVGBS;                        /*@YL026UD*/
         L     @06,CTGFVT(,CTGPLPTR)                               1177
         MVI   CTGFVTYP(@06),C'B'                                  1177
*              CTGFVLMT = ADDR(GDGLIMIT);                  /*@YL026UD*/
         LA    @05,GDGLIMIT                                        1178
         ST    @05,CTGFVLMT(,@06)                                  1178
*              CTGFVGAT = ADDR(GDGATTR);                   /*@YL026UD*/
*                                                                  1179
         LA    @05,GDGATTR                                         1179
         ST    @05,CTGFVGAT(,@06)                                  1179
*            END GDGFVT;                                   /*@YL026UD*/
*                                                                  1180
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  IF 'DSPE' OR 'VCBPE' ENTRY IS BEING PROCESSED - @YL026UD*/
*        /*  INITIALIZE 'ALIEN' (NONVSAM) FVT                @YL026UD*/
*        /*  AND INITIALIZE REQUIRED FPLS                    @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1181
*        IF CVPEFLAG = OFF & ALIASFLG = OFF & GDGFLAG = OFF        1181
*          THEN                                                    1181
@RF01175 TM    CVPEFLAG,B'10000000'                                1181
         BNZ   @RF01181                                            1181
         TM    ALIASFLG,B'10000000'                                1181
         BNZ   @RF01181                                            1181
         TM    GDGFLAG,B'10000000'                                 1181
         BNZ   @RF01181                                            1181
*ALIENFVT:   DO;                                           /*@YL026UD*/
*                                                                  1182
ALIENFVT DS    0H                                                  1183
*              CTGFVTYP = CTGFVALN;                        /*@YL026UD*/
         L     @06,CTGFVT(,CTGPLPTR)                               1183
         MVI   CTGFVTYP(@06),C'A'                                  1183
*              CTGFVNDC = ON;                              /*@YL026UD*/
         OI    CTGFVNDC(@06),B'00100000'                           1184
*              CTGFVVLT = ADDR(VOLLIST);                   /*@YL026UD*/
         L     @05,VOLPTR                                          1185
         ST    @05,CTGFVVLT(,@06)                                  1185
*              CTGFVDVT = DEVTFPL;                         /*@YL026UD*/
         L     @05,DEVTFPL                                         1186
         ST    @05,CTGFVDVT(,@06)                                  1186
*              CTGFVTTR = ADDR(DSCBTTR);                   /*@YL026UD*/
         LA    @15,DSCBTTR                                         1187
         ST    @15,CTGFVTTR(,@06)                                  1187
*              CTGFVFSN = FSEQFPL;                         /*@YL026UD*/
*                                                                  1188
         L     @15,FSEQFPL                                         1188
         ST    @15,CTGFVFSN(,@06)                                  1188
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  INITIALIZE DEVICE TYPE FPL (DEVTFPL)      @YL026UD*/
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1189
*              DEVTFPL -> CTGFLDNO = 1;                    /*@YL026UD*/
         MVI   CTGFLDNO(@05),X'01'                                 1189
*              DEVTFPL -> CTGFLDNM = ADDR(DEVTCON);        /*@YL026UD*/
         LA    @06,@CC01212                                        1190
         ST    @06,CTGFLDNM(,@05)                                  1190
*              DEVTFPL -> CTGFLNG(1)  = VOLCNT * LENGTH(DEVTLIST); 1191
         LH    @06,VOLCNT                                          1191
         LR    @14,@06                                             1191
         MH    @14,@CH00037                                        1191
         ST    @14,CTGFLNG(,@05)                                   1191
*              DEVTFPL -> CTGFLPT(1)  = ADDR(DEVTLIST);    /*@YL026UD*/
*                                                                  1192
         L     @14,DEVTPTR                                         1192
         ST    @14,CTGFLPT(,@05)                                   1192
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  INITIALIZE DATA SET SEQUENCE NUMBER FPL (FSEQFPL) */
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1193
*              FSEQFPL -> CTGFLDNO = 1;                    /*@YL026UD*/
         MVI   CTGFLDNO(@15),X'01'                                 1193
*              FSEQFPL -> CTGFLDNM = ADDR(FILECON);        /*@YL026UD*/
         LA    @05,@CC01214                                        1194
         ST    @05,CTGFLDNM(,@15)                                  1194
*              FSEQFPL -> CTGFLNG(1)  = VOLCNT * LENGTH(FILELIST); 1195
         ALR   @06,@06                                             1195
         ST    @06,CTGFLNG(,@15)                                   1195
*              FSEQFPL -> CTGFLPT(1)  = ADDR(FILELIST);    /*@YL026UD*/
*                                                                  1196
         L     @06,FILEPTR                                         1196
         ST    @06,CTGFLPT(,@15)                                   1196
*              /******************************************************/
*              /*                                            @YL026UD*/
*              /*  DIAGNOSTIC AID (TEST MODE) -              @YL026UD*/
*              /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP     */
*              /*  THE DEVICE TYPE LIST, VOLUME LIST, AND    @YL026UD*/
*              /*  DATA SET SEQUENCE LIST                    @YL026UD*/
*              /*  (REFERENCED BY THE FVT AND RESPECTIVE FPLS)       */
*              /*                                            @YL026UD*/
*              /******************************************************/
*                                                                  1197
*                                                                  1197
*              IF GDTDBG = NULLPTR                                 1197
*                THEN;                                             1197
         L     @06,@PC00001                                        1197
         L     @06,GDTDBG(,@06)                                    1197
         LTR   @06,@06                                             1197
         BZ    @RT01197                                            1197
*                ELSE                                              1199
*                  DO;                                             1199
*                    DMPINDEX = ADDR(DLISTVIL);                    1200
*                                                                  1200
         LA    DMPINDEX,DLISTVIL                                   1200
*                    DMPITMNM = 'DEVTPTR';                         1201
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1201
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1201
*                    DMPITMPT = ADDR(DEVTPTR);                     1202
         LA    @06,DEVTPTR                                         1202
         ST    @06,DMPITMPT(,DMPINDEX)                             1202
*                    DMPITMLN = 4;                                 1203
         LA    @06,4                                               1203
         STH   @06,DMPITMLN(,DMPINDEX)                             1203
*                    DMPITMTP = 'H';                               1204
         MVI   DMPITMTP(DMPINDEX),C'H'                             1204
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1205
*                                                                  1205
         LA    @05,16                                              1205
         ALR   DMPINDEX,@05                                        1205
*                    DMPITMNM = 'DEVTLIST';                        1206
         MVC   DMPITMNM(8,DMPINDEX),@CC01265                       1206
*                    DMPITMPT = ADDR(DEVTLIST);                    1207
         L     @03,DEVTPTR                                         1207
         ST    @03,DMPITMPT(,DMPINDEX)                             1207
*                    DMPITMLN = MIN(256,DEVTLEN);                  1208
         LA    @03,256                                             1208
         LH    @15,DEVTLEN                                         1208
         CR    @15,@03                                             1208
         BNH   *+6
         LR    @15,@03                                             1208
         STH   @15,DMPITMLN(,DMPINDEX)                             1208
*                    DMPITMTP = 'H';                               1209
         MVI   DMPITMTP(DMPINDEX),C'H'                             1209
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1210
         ALR   DMPINDEX,@05                                        1210
*                    DMPITMNM = 'VOLPTR';                          1211
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1211
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1211
         MVC   DMPITMNM(6,DMPINDEX),@CC01266                       1211
*                    DMPITMPT = ADDR(VOLPTR);                      1212
         LA    @15,VOLPTR                                          1212
         ST    @15,DMPITMPT(,DMPINDEX)                             1212
*                    DMPITMLN = 4;                                 1213
         STH   @06,DMPITMLN(,DMPINDEX)                             1213
*                    DMPITMTP = 'H';                               1214
         MVI   DMPITMTP(DMPINDEX),C'H'                             1214
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1215
*                                                                  1215
         ALR   DMPINDEX,@05                                        1215
*                    DMPITMNM = 'VOLLIST';                         1216
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1216
         MVC   DMPITMNM(7,DMPINDEX),@CC01267                       1216
*                    DMPITMPT = ADDR(VOLLIST);                     1217
         L     @15,VOLPTR                                          1217
         ST    @15,DMPITMPT(,DMPINDEX)                             1217
*                    DMPITMLN = MIN(256,VOLLEN);                   1218
         LH    @15,VOLLEN                                          1218
         CR    @15,@03                                             1218
         BNH   *+6
         LR    @15,@03                                             1218
         STH   @15,DMPITMLN(,DMPINDEX)                             1218
*                    DMPITMTP = 'H';                               1219
         MVI   DMPITMTP(DMPINDEX),C'H'                             1219
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1220
*                                                                  1220
         ALR   DMPINDEX,@05                                        1220
*                    DMPITMNM = 'FILEPTR';                         1221
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1221
         MVC   DMPITMNM(7,DMPINDEX),@CC01268                       1221
*                    DMPITMPT = ADDR(FILEPTR);                     1222
         LA    @15,FILEPTR                                         1222
         ST    @15,DMPITMPT(,DMPINDEX)                             1222
*                    DMPITMLN = 4;                                 1223
         STH   @06,DMPITMLN(,DMPINDEX)                             1223
*                    DMPITMTP = 'H';                               1224
         MVI   DMPITMTP(DMPINDEX),C'H'                             1224
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1225
*                                                                  1225
         ALR   DMPINDEX,@05                                        1225
*                    DMPITMNM = 'FILELIST';                        1226
         MVC   DMPITMNM(8,DMPINDEX),@CC01269                       1226
*                    DMPITMPT = ADDR(FILELIST);                    1227
         L     @06,FILEPTR                                         1227
         ST    @06,DMPITMPT(,DMPINDEX)                             1227
*                    DMPITMLN = MIN(256,FILELEN);                  1228
         LH    @06,FILELEN                                         1228
         CR    @06,@03                                             1228
         BNH   *+6
         LR    @06,@03                                             1228
         STH   @06,DMPITMLN(,DMPINDEX)                             1228
*                    DMPITMTP = 'H';                               1229
         MVI   DMPITMTP(DMPINDEX),C'H'                             1229
*                    DMPINDEX = DMPINDEX + DMPELEMT;               1230
         ALR   DMPINDEX,@05                                        1230
*                    DMPTRM = DMPTRMVL;                            1231
         MVI   DMPTRM(DMPINDEX),X'FF'                              1231
*                  END;                                            1232
*                                                                  1232
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /*  DUMP POINT AFTER VSAM ARGUMENT LIST IS    @Y30SSMK*/
*              /*  BUILT TO DUMP DEVICE TYPE LIST, VOLUME    @Y30SSMK*/
*              /*  LIST, AND DATA SET SEQUENCE LIST.         @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1233
*              IF GDTDBG = NULLPTR                                 1233
*                THEN;                                             1233
@RT01197 L     @06,@PC00001                                        1233
         L     @06,GDTDBG(,@06)                                    1233
         LTR   @06,@06                                             1233
         BZ    @RT01233                                            1233
*                ELSE                                              1235
*                  CALL IDCDB010(GDTTBL,'CCDV',ADDR(DLISTVIL));    1235
         L     @06,@PC00001                                        1235
         ST    @06,@AL00001                                        1235
         LA    @05,@CC01270                                        1235
         ST    @05,@AL00001+4                                      1235
         LA    @05,DLISTVIL                                        1235
         ST    @05,@AFTEMPS+12                                     1235
         LA    @05,@AFTEMPS+12                                     1235
         ST    @05,@AL00001+8                                      1235
         MVI   @AL00001+8,X'80'                                    1235
         L     @15,GDTDBG(,@06)                                    1235
         LA    @01,@AL00001                                        1235
         BALR  @14,@15                                             1235
*                                                          /*@YL026UD*/
*                                                                  1236
*            END ALIENFVT;                                 /*@YL026UD*/
*                                                                  1236
@RT01233 DS    0H                                                  1237
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/
*        /*  THE CPL, FVT, AND FPLS                          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1237
*                                                                  1237
*        IF GDTDBG = NULLPTR                                       1237
*          THEN;                                                   1237
@RF01181 L     @06,@PC00001                                        1237
         L     @06,GDTDBG(,@06)                                    1237
         LTR   @06,@06                                             1237
         BZ    @RT01237                                            1237
*          ELSE                                                    1239
*            DO;                                                   1239
*              DMPINDEX = ADDR(DLISTCPL);                          1240
*                                                                  1240
         LA    DMPINDEX,DLISTCPL                                   1240
*              DMPITMNM = 'CPLPTR';                                1241
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1241
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1241
         MVC   DMPITMNM(6,DMPINDEX),@CC01271                       1241
*              DMPITMPT = ADDR(CATPLPTR);                          1242
         LA    @06,CATPLPTR                                        1242
         ST    @06,DMPITMPT(,DMPINDEX)                             1242
*              DMPITMLN = 4;                                       1243
         LA    @06,4                                               1243
         STH   @06,DMPITMLN(,DMPINDEX)                             1243
*              DMPITMTP = 'H';                                     1244
         MVI   DMPITMTP(DMPINDEX),C'H'                             1244
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1245
*                                                                  1245
         LA    @05,16                                              1245
         ALR   DMPINDEX,@05                                        1245
*              DMPITMNM = 'CPL';                                   1246
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1246
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1246
         MVC   DMPITMNM(3,DMPINDEX),@CC01272                       1246
*              DMPITMPT = ADDR(CATPL);                             1247
         L     @03,CATPLPTR                                        1247
         ST    @03,DMPITMPT(,DMPINDEX)                             1247
*              DMPITMLN = CPLLEN;                                  1248
         LH    @03,CPLLEN                                          1248
         STH   @03,DMPITMLN(,DMPINDEX)                             1248
*              DMPITMTP = 'H';                                     1249
         MVI   DMPITMTP(DMPINDEX),C'H'                             1249
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1250
*                                                                  1250
         ALR   DMPINDEX,@05                                        1250
*              DMPITMNM = 'FVTPTR';                                1251
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1251
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1251
         MVC   DMPITMNM(6,DMPINDEX),@CC01273                       1251
*              DMPITMPT = ADDR(CTGFVT);                            1252
         LA    @03,CTGFVT(,CTGPLPTR)                               1252
         ST    @03,DMPITMPT(,DMPINDEX)                             1252
*              DMPITMLN = 4;                                       1253
         STH   @06,DMPITMLN(,DMPINDEX)                             1253
*              DMPITMTP = 'H';                                     1254
         MVI   DMPITMTP(DMPINDEX),C'H'                             1254
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1255
*                                                                  1255
         ALR   DMPINDEX,@05                                        1255
*              DMPITMNM = 'FVT';                                   1256
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1256
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1256
         MVC   DMPITMNM(3,DMPINDEX),@CC01274                       1256
*              DMPITMPT = ADDR(CTGFV);                             1257
         L     @03,CTGFVT(,CTGPLPTR)                               1257
         ST    @03,DMPITMPT(,DMPINDEX)                             1257
*              DMPITMLN = FVTLEN;                                  1258
         LH    @03,FVTLEN                                          1258
         STH   @03,DMPITMLN(,DMPINDEX)                             1258
*              DMPITMTP = 'H';                                     1259
         MVI   DMPITMTP(DMPINDEX),C'H'                             1259
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1260
*                                                                  1260
         ALR   DMPINDEX,@05                                        1260
*              DMPITMNM = 'DEVTPTR';                               1261
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1261
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1261
*              DMPITMPT = ADDR(DEVTFPL);                           1262
         LA    @03,DEVTFPL                                         1262
         ST    @03,DMPITMPT(,DMPINDEX)                             1262
*              DMPITMLN = 4;                                       1263
         STH   @06,DMPITMLN(,DMPINDEX)                             1263
*              DMPITMTP = 'H';                                     1264
         MVI   DMPITMTP(DMPINDEX),C'H'                             1264
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1265
*                                                                  1265
         ALR   DMPINDEX,@05                                        1265
*              DMPITMNM = 'DEVTFPL';                               1266
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1266
         MVC   DMPITMNM(7,DMPINDEX),@CC01275                       1266
*              DMPITMPT = ADDR(DEVTFPL->CTGFL);                    1267
         L     @03,DEVTFPL                                         1267
         ST    @03,DMPITMPT(,DMPINDEX)                             1267
*              DMPITMLN = FPLLEN;                                  1268
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1268
*              DMPITMTP = 'H';                                     1269
         MVI   DMPITMTP(DMPINDEX),C'H'                             1269
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1270
*                                                                  1270
         ALR   DMPINDEX,@05                                        1270
*              DMPITMNM = 'FSEQPTR';                               1271
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1271
         MVC   DMPITMNM(7,DMPINDEX),@CC01276                       1271
*              DMPITMPT = ADDR(FSEQFPL);                           1272
         LA    @03,FSEQFPL                                         1272
         ST    @03,DMPITMPT(,DMPINDEX)                             1272
*              DMPITMLN = 4;                                       1273
         STH   @06,DMPITMLN(,DMPINDEX)                             1273
*              DMPITMTP = 'H';                                     1274
         MVI   DMPITMTP(DMPINDEX),C'H'                             1274
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1275
*                                                                  1275
         ALR   DMPINDEX,@05                                        1275
*              DMPITMNM = 'FSEQFPL';                               1276
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1276
         MVC   DMPITMNM(7,DMPINDEX),@CC01277                       1276
*              DMPITMPT = ADDR(FSEQFPL->CTGFL);                    1277
         L     @06,FSEQFPL                                         1277
         ST    @06,DMPITMPT(,DMPINDEX)                             1277
*              DMPITMLN = FPLLEN;                                  1278
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1278
*              DMPITMTP = 'H';                                     1279
         MVI   DMPITMTP(DMPINDEX),C'H'                             1279
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1280
*                                                                  1280
         ALR   DMPINDEX,@05                                        1280
*              DMPTRM = DMPTRMVL;                                  1281
         MVI   DMPTRM(DMPINDEX),X'FF'                              1281
*            END;                                                  1282
*                                                                  1282
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT TO DUMP CPL, FVT, AND FPLS.          @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1283
*        IF GDTDBG = NULLPTR                                       1283
*          THEN;                                                   1283
@RT01237 L     @06,@PC00001                                        1283
         L     @06,GDTDBG(,@06)                                    1283
         LTR   @06,@06                                             1283
         BZ    @RT01283                                            1283
*          ELSE                                                    1285
*            CALL IDCDB010(GDTTBL,'CCDC',ADDR(DLISTCPL));          1285
         L     @06,@PC00001                                        1285
         ST    @06,@AL00001                                        1285
         LA    @05,@CC01278                                        1285
         ST    @05,@AL00001+4                                      1285
         LA    @05,DLISTCPL                                        1285
         ST    @05,@AFTEMPS+12                                     1285
         LA    @05,@AFTEMPS+12                                     1285
         ST    @05,@AL00001+8                                      1285
         MVI   @AL00001+8,X'80'                                    1285
         L     @15,GDTDBG(,@06)                                    1285
         LA    @01,@AL00001                                        1285
         BALR  @14,@15                                             1285
*                                                          /*@YL026UD*/
*                                                                  1286
*        END DEFNLSTS;                                     /*@YL026UD*/
@EL00015 DS    0H                                                  1286
@EF00015 DS    0H                                                  1286
@ER00015 LM    @14,@06,@SA00015                                    1286
         LM    @08,@12,@SA00015+36                                 1286
         BR    @14                                                 1286
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - LOCTLSTS                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/
*/*             REQUIRED TO 'LOCATE' THE DUPLICATE ENTRY     @YL026UD*/
*/*             IN THE PROPER VSAM CATALOG                   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THE VSAM LOCATE PARAMETER LISTS WILL REQUEST @YL026UD*/
*/*             THAT THE FOLLOWING INFORMATION BE RETURNED   @YL026UD*/
*/*             FROM THE DUPLICATE ENTRY -                   @YL026UD*/
*/*             (1) ENTRY TYPE                               @YL026UD*/
*/*                 (VIA THE 'ENTYPE' FPL)                   @YL026UD*/
*/*             (2) CATALOG ENTRY VOLUME INFORMATION,        @YL026UD*/
*/*                 INCLUDING DEVICE TYPE(S), VOLUME SERIAL  @YL026UD*/
*/*                 NUMBER(S), AND FILE SEQUENCE NUMBER(S)   @YL026UD*/
*/*                 (VIA THE 'CATVOL' FPL)                   @YL026UD*/
*/*                                                          @YL026UD*/
*/*             TWO PARAMETER LISTS ARE REQUIRED -           @YL026UD*/
*/*             (1) CPL - CATALOG PARAMETER LIST             @YL026UD*/
*/*                 (TO IDENTIFY THE 'LOCATE' REQUEST,       @YL026UD*/
*/*                 THE DUPLICATE ENTRY BEING LOCATED,       @YL026UD*/
*/*                 AND THE RECEIVING VSAM CATALOG)          @YL026UD*/
*/*             (2) FPL - FIELD PARAMETER LISTS              @YL026UD*/
*/*                 (TO REQUEST THAT THE ENTRY TYPE AND      @YL026UD*/
*/*                 CATALOG ENTRY INFORMATION BE RETURNED)   @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE REQUIRED STORAGE AREAS FOR THE VSAM         @YL026UD*/
*/*          CATALOG PARAMETER LISTS                         @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE INITIALIZED VSAM CATALOG PARAMETER LISTS   @YL026UD*/
*/*           TO 'LOCATE' THE DUPLICATE ENTRY                @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  1287
*LOCTLSTS: PROCEDURE;                                      /*@YL026UD*/
LOCTLSTS STM   @14,@12,@SA00016                                    1287
*        OLDERID2 = NEWERID2;                                      1288
         L     @05,@PC00001                                        1288
         L     @05,GDTTR2(,@05)                                    1288
         MVC   @TS00001(95),NEWERID2(@05)                          1288
         MVC   OLDERID2(95,@05),@TS00001                           1288
*        NEWID2 = 'CCLL';                                  /*@YL026UD*/
*                                                                  1289
         MVC   NEWID2(4,@05),@CC01282                              1289
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ZERO THE CPL AND FPLS TO BUILD 'LOCATE' REQUEST @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1290
*        DO INDEX = 1 TO CATPLLEN BY 8;                    /*@YL026UD*/
*                                                                  1290
         LA    INDEX,1                                             1290
         B     @DE01290                                            1290
@DL01290 DS    0H                                                  1291
*          CATPL(INDEX:INDEX+7) = CATZERO;                 /*@YL026UD*/
*                                                                  1291
         L     @06,CATPLPTR                                        1291
         ALR   @06,INDEX                                           1291
         AL    @06,@CF01151                                        1291
         MVC   CATPL(8,@06),CATZERO                                1291
*        END;                                              /*@YL026UD*/
*                                                                  1292
         AL    INDEX,@CF00175                                      1292
@DE01290 C     INDEX,CATPLLEN                                      1292
         BNH   @DL01290                                            1292
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE CATALOG PARAMETER LIST (CPL) -   @YL026UD*/
*        /*  FOR THE 'LOCATE' REQUEST                        @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1293
*        CTGFUNC = CTGLOC;                                 /*@YL026UD*/
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       1293
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       1293
*        CTGNAME = ON;                                     /*@YL026UD*/
         OI    CTGNAME(CTGPLPTR),B'00000100'                       1294
*        CTGAM0 = ON;                                      /*@YL026UD*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        1295
*        CTGNAME = ON;                                     /*@YL026UD*/
*        CTGCNAME = ON;                                    /*@YL026UD*/
*                                                                  1297
         OI    CTGNAME(CTGPLPTR),B'00000110'                       1297
*        IF CATNMPLN ^= 0                                          1298
*          THEN                                                    1298
         L     @05,@PC00001+4                                      1298
         L     @05,FDTPTR+12(,@05)                                 1298
         CLI   CATNMPLN(@05),0                                     1298
         BE    @RF01298                                            1298
*            CTGPSWD = ADDR(CATNMPAS);                     /*@YL026UD*/
*                                                                  1299
         LA    @05,CATNMPAS(,@05)                                  1299
         ST    @05,CTGPSWD(,CTGPLPTR)                              1299
*        IF ADDR(CAT) ^= NULLPTR                                   1300
*          THEN                                                    1300
@RF01298 L     @05,@PC00001+4                                      1300
         L     @15,FDTPTR+8(,@05)                                  1300
         LTR   @15,@15                                             1300
         BZ    @RF01300                                            1300
*            CTGCAT = ADDR(CATNMVAL);                      /*@Y30SSMK*/
*                                                                  1301
         L     @05,FDTPTR+12(,@05)                                 1301
         LA    @05,CATNMVAL(,@05)                                  1301
         ST    @05,CTGCAT(,CTGPLPTR)                               1301
*        CTGENT = ADDR(DSNAME);                            /*@YL026UD*/
*                                                                  1302
@RF01300 LA    @05,DSNAME                                          1302
         ST    @05,CTGENT(,CTGPLPTR)                               1302
*        CTGNOFLD = 2;                                     /*@YL026UD*/
         MVI   CTGNOFLD(CTGPLPTR),X'02'                            1303
*        CTGFIELD(1) = ENTYPFPL;                           /*@YL026UD*/
         L     @05,ENTYPFPL                                        1304
         ST    @05,CTGFIELD(,CTGPLPTR)                             1304
*        CTGFIELD(2) = CATVLFPL;                           /*@YL026UD*/
*                                                                  1305
         L     @15,CATVLFPL                                        1305
         ST    @15,CTGFIELD+4(,CTGPLPTR)                           1305
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE ENTRY TYPE FPL (ENTYPFPL)            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1306
*        ENTYPFPL -> CTGFLDNO = 1;                         /*@YL026UD*/
         MVI   CTGFLDNO(@05),X'01'                                 1306
*        ENTYPFPL -> CTGFLDNM = ADDR(ENTYPCON);            /*@YL026UD*/
*                                                                  1307
         LA    @14,@CC01216                                        1307
         ST    @14,CTGFLDNM(,@05)                                  1307
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE CATALOG VOLUME INFORMATION FPL       @YL026UD*/
*        /*  (CATVLFPL)                                      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1308
*        CATVLFPL -> CTGFLDNO = 1;                         /*@YL026UD*/
         MVI   CTGFLDNO(@15),X'01'                                 1308
*        CATVLFPL -> CTGFLDNM = ADDR(CATVLCON);            /*@YL026UD*/
*                                                                  1309
         LA    @05,@CC01218                                        1309
         ST    @05,CTGFLDNM(,@15)                                  1309
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DIAGNOSTIC AIDS (TEST MODE) -                   @YL026UD*/
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/
*        /*  THE CPL AND FPLS                                @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1310
*                                                                  1310
*        IF GDTDBG = NULLPTR                                       1310
*          THEN;                                                   1310
         L     @05,@PC00001                                        1310
         L     @05,GDTDBG(,@05)                                    1310
         LTR   @05,@05                                             1310
         BZ    @RT01310                                            1310
*          ELSE                                                    1312
*            DO;                                                   1312
*              DMPINDEX = ADDR(DLISTCPL);                          1313
*                                                                  1313
         LA    DMPINDEX,DLISTCPL                                   1313
*              DMPITMNM = 'CPLPTR';                                1314
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1314
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1314
         MVC   DMPITMNM(6,DMPINDEX),@CC01271                       1314
*              DMPITMPT = ADDR(CATPLPTR);                          1315
         LA    @05,CATPLPTR                                        1315
         ST    @05,DMPITMPT(,DMPINDEX)                             1315
*              DMPITMLN = 4;                                       1316
         LA    @05,4                                               1316
         STH   @05,DMPITMLN(,DMPINDEX)                             1316
*              DMPITMTP = 'H';                                     1317
         MVI   DMPITMTP(DMPINDEX),C'H'                             1317
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1318
*                                                                  1318
         LA    @03,16                                              1318
         ALR   DMPINDEX,@03                                        1318
*              DMPITMNM = 'CPL';                                   1319
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1319
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1319
         MVC   DMPITMNM(3,DMPINDEX),@CC01272                       1319
*              DMPITMPT = ADDR(CATPL);                             1320
         L     @15,CATPLPTR                                        1320
         ST    @15,DMPITMPT(,DMPINDEX)                             1320
*              DMPITMLN = CPLLEN;                                  1321
         LH    @15,CPLLEN                                          1321
         STH   @15,DMPITMLN(,DMPINDEX)                             1321
*              DMPITMTP = 'H';                                     1322
         MVI   DMPITMTP(DMPINDEX),C'H'                             1322
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1323
*                                                                  1323
         ALR   DMPINDEX,@03                                        1323
*              DMPITMNM = 'ENTYPPTR';                              1324
         MVC   DMPITMNM(8,DMPINDEX),@CC01241                       1324
*              DMPITMPT = ADDR(ENTYPFPL);                          1325
         LA    @15,ENTYPFPL                                        1325
         ST    @15,DMPITMPT(,DMPINDEX)                             1325
*              DMPITMLN = 4;                                       1326
         STH   @05,DMPITMLN(,DMPINDEX)                             1326
*              DMPITMTP = 'H';                                     1327
         MVI   DMPITMTP(DMPINDEX),C'H'                             1327
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1328
*                                                                  1328
         ALR   DMPINDEX,@03                                        1328
*              DMPITMNM = 'ENTYPFPL';                              1329
         MVC   DMPITMNM(8,DMPINDEX),@CC01283                       1329
*              DMPITMPT = ADDR(ENTYPFPL->CTGFL);                   1330
         L     @15,ENTYPFPL                                        1330
         ST    @15,DMPITMPT(,DMPINDEX)                             1330
*              DMPITMLN = FPLLEN;                                  1331
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1331
*              DMPITMTP = 'H';                                     1332
         MVI   DMPITMTP(DMPINDEX),C'H'                             1332
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1333
*                                                                  1333
         ALR   DMPINDEX,@03                                        1333
*              DMPITMNM = 'CATVLPTR';                              1334
         MVC   DMPITMNM(8,DMPINDEX),@CC01243                       1334
*              DMPITMPT = ADDR(CATVLFPL);                          1335
         LA    @15,CATVLFPL                                        1335
         ST    @15,DMPITMPT(,DMPINDEX)                             1335
*              DMPITMLN = 4;                                       1336
         STH   @05,DMPITMLN(,DMPINDEX)                             1336
*              DMPITMTP = 'H';                                     1337
         MVI   DMPITMTP(DMPINDEX),C'H'                             1337
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1338
*                                                                  1338
         ALR   DMPINDEX,@03                                        1338
*              DMPITMNM = 'CATVLFPL';                              1339
         MVC   DMPITMNM(8,DMPINDEX),@CC01284                       1339
*              DMPITMPT = ADDR(CATVLFPL->CTGFL);                   1340
         L     @05,CATVLFPL                                        1340
         ST    @05,DMPITMPT(,DMPINDEX)                             1340
*              DMPITMLN = FPLLEN;                                  1341
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1341
*              DMPITMTP = 'H';                                     1342
         MVI   DMPITMTP(DMPINDEX),C'H'                             1342
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1343
*                                                                  1343
         ALR   DMPINDEX,@03                                        1343
*              DMPTRM = DMPTRMVL;                                  1344
         MVI   DMPTRM(DMPINDEX),X'FF'                              1344
*            END;                                                  1345
*                                                                  1345
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT TO DUMP CPL AND FPLS AFTER VSAM      @Y30SSMK*/
*        /*  PARAMETER LIST IS BUILT TO LOCATE INFORMATION   @Y30SSMK*/
*        /*  IN THE VSAM CATALOG.                            @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1346
*        IF GDTDBG = NULLPTR                                       1346
*          THEN;                                                   1346
@RT01310 L     @05,@PC00001                                        1346
         L     @05,GDTDBG(,@05)                                    1346
         LTR   @05,@05                                             1346
         BZ    @RT01346                                            1346
*          ELSE                                                    1348
*            CALL IDCDB010(GDTTBL,'CCLC',ADDR(DLISTCPL));          1348
         L     @05,@PC00001                                        1348
         ST    @05,@AL00001                                        1348
         LA    @15,@CC01285                                        1348
         ST    @15,@AL00001+4                                      1348
         LA    @15,DLISTCPL                                        1348
         ST    @15,@AFTEMPS+16                                     1348
         LA    @15,@AFTEMPS+16                                     1348
         ST    @15,@AL00001+8                                      1348
         MVI   @AL00001+8,X'80'                                    1348
         L     @15,GDTDBG(,@05)                                    1348
         LA    @01,@AL00001                                        1348
         BALR  @14,@15                                             1348
*                                                          /*@YL026UD*/
*                                                                  1349
*        END LOCTLSTS;                                     /*@YL026UD*/
@EL00016 DS    0H                                                  1349
@EF00016 DS    0H                                                  1349
@ER00016 LM    @14,@12,@SA00016                                    1349
         BR    @14                                                 1349
*/********************************************************************/
*/*                                                          @YL026UD*/
*/*  PROCEDURE NAME - ALTRLSTS                               @YL026UD*/
*/*                                                          @YL026UD*/
*/*  FUNCTION - TO BUILD THE VSAM CATALOG PARAMETER LISTS    @YL026UD*/
*/*             REQUIRED TO 'ALTER' THE NONVSAM CATALOG      @YL026UD*/
*/*             ENTRY IN THE PROPER VSAM CATALOG             @YL026UD*/
*/*                                                          @YL026UD*/
*/*             THREE PARAMETER LISTS ARE REQUIRED -         @YL026UD*/
*/*             (1) CPL - CATALOG PARAMETER LIST             @YL026UD*/
*/*                 (TO IDENTIFY THE 'ALTER' REQUEST         @YL026UD*/
*/*                 AND THE RECEIVING VSAM CATALOG)          @YL026UD*/
*/*              (2) FVT - FIELD VECTOR TABLE                @YL026UD*/
*/*                  (TO IDENTIFY THE ENTRY TO BE ALTERED)   @YL026UD*/
*/*              (3) FPL - FIELD PARAMETER LISTS             @YL026UD*/
*/*                  (FOR THE UPDATED DEVICE TYPE AND FILE   @YL026UD*/
*/*                  SEQUENCE INFORMATION)                   @YL026UD*/
*/*                                                          @YL026UD*/
*/*  INPUT - THE REQUIRED STORAGE AREAS FOR THE VSAM         @YL026UD*/
*/*          CATALOG PARAMETER LISTS                         @YL026UD*/
*/*                                                          @YL026UD*/
*/*  OUTPUT - THE INITIALIZED VSAM CATALOG PARAMETER LISTS   @YL026UD*/
*/*           TO 'ALTER' THE NONVSAM CATALOG ENTRY           @YL026UD*/
*/*                                                          @YL026UD*/
*/********************************************************************/
*                                                                  1350
*ALTRLSTS: PROCEDURE;                                      /*@YL026UD*/
ALTRLSTS STM   @14,@06,@SA00017                                    1350
         STM   @08,@12,@SA00017+36                                 1350
*        OLDERID2 = NEWERID2;                                      1351
         L     @05,@PC00001                                        1351
         L     @05,GDTTR2(,@05)                                    1351
         MVC   @TS00001(95),NEWERID2(@05)                          1351
         MVC   OLDERID2(95,@05),@TS00001                           1351
*        NEWID2 = 'CCAL';                                  /*@YL026UD*/
*                                                                  1352
         MVC   NEWID2(4,@05),@CC01289                              1352
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  ZERO THE CPL/FVT/FPL PARAMETER LISTS            @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1353
*        DO INDEX = 1 TO CATPLLEN BY 8;                    /*@YL026UD*/
*                                                                  1353
         LA    INDEX,1                                             1353
         B     @DE01353                                            1353
@DL01353 DS    0H                                                  1354
*          CATPL(INDEX:INDEX+7) = CATZERO;                 /*@YL026UD*/
*                                                                  1354
         L     @06,CATPLPTR                                        1354
         ALR   @06,INDEX                                           1354
         AL    @06,@CF01151                                        1354
         MVC   CATPL(8,@06),CATZERO                                1354
*        END;                                              /*@YL026UD*/
*                                                                  1355
         AL    INDEX,@CF00175                                      1355
@DE01353 C     INDEX,CATPLLEN                                      1355
         BNH   @DL01353                                            1355
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE CPL FOR THE 'ALTER' REQUEST      @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1356
*        CTGFUNC = CTGCMS;                                 /*@YL026UD*/
         NI    CTGFUNC(CTGPLPTR),B'10011111'                       1356
         OI    CTGFUNC(CTGPLPTR),B'10000000'                       1356
*        CTGOPTNS = CTGALTER;                              /*@YL026UD*/
         NI    CTGOPTNS(CTGPLPTR),B'00010111'                      1357
         OI    CTGOPTNS(CTGPLPTR),B'00010000'                      1357
*        CTGAM0 = ON;                                      /*@YL026UD*/
         OI    CTGAM0(CTGPLPTR),B'00000001'                        1358
*        CTGNAME = ON;                                     /*@YL026UD*/
*        CTGCNAME = ON;                                    /*@YL026UD*/
*                                                                  1360
         OI    CTGNAME(CTGPLPTR),B'00000110'                       1360
*        IF CATNMPLN ^= 0                                          1361
*          THEN                                                    1361
         L     @06,@PC00001+4                                      1361
         L     @06,FDTPTR+12(,@06)                                 1361
         CLI   CATNMPLN(@06),0                                     1361
         BE    @RF01361                                            1361
*            CTGPSWD = ADDR(CATNMPAS);                     /*@YL026UD*/
*                                                                  1362
         LA    @06,CATNMPAS(,@06)                                  1362
         ST    @06,CTGPSWD(,CTGPLPTR)                              1362
*        IF ADDR(CAT) ^= NULLPTR                                   1363
*          THEN                                                    1363
@RF01361 L     @06,@PC00001+4                                      1363
         L     @05,FDTPTR+8(,@06)                                  1363
         LTR   @05,@05                                             1363
         BZ    @RF01363                                            1363
*            CTGCAT = ADDR(CATNMVAL);                      /*@Y30SSMK*/
*                                                                  1364
         L     @06,FDTPTR+12(,@06)                                 1364
         LA    @06,CATNMVAL(,@06)                                  1364
         ST    @06,CTGCAT(,CTGPLPTR)                               1364
*        CTGFVT = CATPLPTR + CPLLEN;                       /*@YL026UD*/
*                                                                  1365
@RF01363 LH    @06,CPLLEN                                          1365
         AL    @06,CATPLPTR                                        1365
         ST    @06,CTGFVT(,CTGPLPTR)                               1365
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE ALIEN (NONVSAM) FVT              @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1366
*        CTGFVENT = ADDR(DSNAME);                          /*@YL026UD*/
         LA    @05,DSNAME                                          1366
         ST    @05,CTGFVENT(,@06)                                  1366
*        CTGFVTYP = CTGFVALN;                              /*@YL026UD*/
         MVI   CTGFVTYP(@06),C'A'                                  1367
*        CTGFVNDC = ON;                                    /*@YL026UD*/
         OI    CTGFVNDC(@06),B'00100000'                           1368
*        CTGFVVLT = ADDR(VOLLIST);                         /*@YL026UD*/
         L     @05,VOLPTR                                          1369
         ST    @05,CTGFVVLT(,@06)                                  1369
*        CTGFVDVT = DEVTFPL;                               /*@YL026UD*/
         L     @05,DEVTFPL                                         1370
         ST    @05,CTGFVDVT(,@06)                                  1370
*        CTGFVTTR = ADDR(DSCBTTR);                         /*@YL026UD*/
         LA    @15,DSCBTTR                                         1371
         ST    @15,CTGFVTTR(,@06)                                  1371
*        CTGFVFSN = FSEQFPL;                               /*@YL026UD*/
*                                                                  1372
         L     @15,FSEQFPL                                         1372
         ST    @15,CTGFVFSN(,@06)                                  1372
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE THE DEVICE TYPE FPL (DEVTFPL)        @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1373
*        DEVTFPL -> CTGFLDNO = 1;                          /*@YL026UD*/
         MVI   CTGFLDNO(@05),X'01'                                 1373
*        DEVTFPL -> CTGFLDNM = ADDR(DEVTCON);              /*@YL026UD*/
         LA    @06,@CC01212                                        1374
         ST    @06,CTGFLDNM(,@05)                                  1374
*        DEVTFPL -> CTGFLNG(1) = VOLCNT * LENGTH(DEVTLIST);/*@YL026UD*/
         LH    @06,VOLCNT                                          1375
         LR    @14,@06                                             1375
         MH    @14,@CH00037                                        1375
         ST    @14,CTGFLNG(,@05)                                   1375
*        DEVTFPL -> CTGFLPT(1) = ADDR(DEVTLIST);           /*@YL026UD*/
*                                                                  1376
         L     @14,DEVTPTR                                         1376
         ST    @14,CTGFLPT(,@05)                                   1376
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  INITIALIZE FILE SEQUENCE NUMBER FPL (FSEQFPL)   @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1377
*        FSEQFPL -> CTGFLDNO = 1;                          /*@YL026UD*/
         MVI   CTGFLDNO(@15),X'01'                                 1377
*        FSEQFPL -> CTGFLDNM = ADDR(FILECON);              /*@YL026UD*/
         LA    @05,@CC01214                                        1378
         ST    @05,CTGFLDNM(,@15)                                  1378
*        FSEQFPL -> CTGFLNG(1) = VOLCNT * LENGTH(FILELIST);/*@YL026UD*/
         ALR   @06,@06                                             1379
         ST    @06,CTGFLNG(,@15)                                   1379
*        FSEQFPL -> CTGFLPT(1) = ADDR(FILELIST);           /*@YL026UD*/
*                                                                  1380
         L     @06,FILEPTR                                         1380
         ST    @06,CTGFLPT(,@15)                                   1380
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DIAGNOSTIC AIDS (TEST MODE) -                   @YL026UD*/
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/
*        /*  THE DEVICE TYPE LIST, VOLUME LIST, AND          @YL026UD*/
*        /*  DATA SET SEQUENCE LIST                          @YL026UD*/
*        /*  (REFERENCED BY THE FVT AND RESPECTIVE FPLS)     @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1381
*                                                                  1381
*        IF GDTDBG = NULLPTR                                       1381
*          THEN;                                                   1381
         L     @06,@PC00001                                        1381
         L     @06,GDTDBG(,@06)                                    1381
         LTR   @06,@06                                             1381
         BZ    @RT01381                                            1381
*          ELSE                                                    1383
*            DO;                                                   1383
*              DMPINDEX = ADDR(DLISTVIL);                          1384
*                                                                  1384
         LA    DMPINDEX,DLISTVIL                                   1384
*              DMPITMNM = 'DEVTPTR';                               1385
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1385
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1385
*              DMPITMPT = ADDR(DEVTPTR);                           1386
         LA    @06,DEVTPTR                                         1386
         ST    @06,DMPITMPT(,DMPINDEX)                             1386
*              DMPITMLN = 4;                                       1387
         LA    @06,4                                               1387
         STH   @06,DMPITMLN(,DMPINDEX)                             1387
*              DMPITMTP = 'H';                                     1388
         MVI   DMPITMTP(DMPINDEX),C'H'                             1388
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1389
*                                                                  1389
         LA    @05,16                                              1389
         ALR   DMPINDEX,@05                                        1389
*              DMPITMNM = 'DEVTLIST';                              1390
         MVC   DMPITMNM(8,DMPINDEX),@CC01265                       1390
*              DMPITMPT = ADDR(DEVTLIST);                          1391
         L     @03,DEVTPTR                                         1391
         ST    @03,DMPITMPT(,DMPINDEX)                             1391
*              DMPITMLN = MIN(256,DEVTLEN);                        1392
         LA    @03,256                                             1392
         LH    @15,DEVTLEN                                         1392
         CR    @15,@03                                             1392
         BNH   *+6
         LR    @15,@03                                             1392
         STH   @15,DMPITMLN(,DMPINDEX)                             1392
*              DMPITMTP = 'H';                                     1393
         MVI   DMPITMTP(DMPINDEX),C'H'                             1393
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1394
*                                                                  1394
         ALR   DMPINDEX,@05                                        1394
*              DMPITMNM = 'VOLPTR';                                1395
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1395
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1395
         MVC   DMPITMNM(6,DMPINDEX),@CC01266                       1395
*              DMPITMPT = ADDR(VOLPTR);                            1396
         LA    @15,VOLPTR                                          1396
         ST    @15,DMPITMPT(,DMPINDEX)                             1396
*              DMPITMLN = 4;                                       1397
         STH   @06,DMPITMLN(,DMPINDEX)                             1397
*              DMPITMTP = 'H';                                     1398
         MVI   DMPITMTP(DMPINDEX),C'H'                             1398
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1399
*                                                                  1399
         ALR   DMPINDEX,@05                                        1399
*              DMPITMNM = 'VOLLIST';                               1400
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1400
         MVC   DMPITMNM(7,DMPINDEX),@CC01267                       1400
*              DMPITMPT = ADDR(VOLLIST);                           1401
         L     @15,VOLPTR                                          1401
         ST    @15,DMPITMPT(,DMPINDEX)                             1401
*              DMPITMLN = MIN(256,VOLLEN);                         1402
         LH    @15,VOLLEN                                          1402
         CR    @15,@03                                             1402
         BNH   *+6
         LR    @15,@03                                             1402
         STH   @15,DMPITMLN(,DMPINDEX)                             1402
*              DMPITMTP = 'H';                                     1403
         MVI   DMPITMTP(DMPINDEX),C'H'                             1403
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1404
*                                                                  1404
         ALR   DMPINDEX,@05                                        1404
*              DMPITMNM = 'FILEPTR';                               1405
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1405
         MVC   DMPITMNM(7,DMPINDEX),@CC01268                       1405
*              DMPITMPT = ADDR(FILEPTR);                           1406
         LA    @15,FILEPTR                                         1406
         ST    @15,DMPITMPT(,DMPINDEX)                             1406
*              DMPITMLN = 4;                                       1407
         STH   @06,DMPITMLN(,DMPINDEX)                             1407
*              DMPITMTP = 'H';                                     1408
         MVI   DMPITMTP(DMPINDEX),C'H'                             1408
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1409
*                                                                  1409
         ALR   DMPINDEX,@05                                        1409
*              DMPITMNM = 'FILELIST';                              1410
         MVC   DMPITMNM(8,DMPINDEX),@CC01269                       1410
*              DMPITMPT = ADDR(FILELIST);                          1411
         L     @06,FILEPTR                                         1411
         ST    @06,DMPITMPT(,DMPINDEX)                             1411
*              DMPITMLN = MIN(256,FILELEN);                        1412
         LH    @06,FILELEN                                         1412
         CR    @06,@03                                             1412
         BNH   *+6
         LR    @06,@03                                             1412
         STH   @06,DMPITMLN(,DMPINDEX)                             1412
*              DMPITMTP = 'H';                                     1413
         MVI   DMPITMTP(DMPINDEX),C'H'                             1413
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1414
*                                                                  1414
         ALR   DMPINDEX,@05                                        1414
*              DMPTRM = DMPTRMVL;                                  1415
         MVI   DMPTRM(DMPINDEX),X'FF'                              1415
*            END;                                                  1416
*                                                                  1416
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT TO DUMP DEVICE TYPE LIST, VOLUME     @Y30SSMK*/
*        /*  LIST, AND DATA SET SEQUENCE LIST AFTER BUILDING @Y30SSMK*/
*        /*  THE VSAM PARAMETER LIST TO ALTER A VSAM CATALOG @Y30SSMK*/
*        /*  ENTRY.                                          @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1417
*        IF GDTDBG = NULLPTR                                       1417
*          THEN;                                                   1417
@RT01381 L     @06,@PC00001                                        1417
         L     @06,GDTDBG(,@06)                                    1417
         LTR   @06,@06                                             1417
         BZ    @RT01417                                            1417
*          ELSE                                                    1419
*            CALL IDCDB010(GDTTBL,'CCAV',ADDR(DLISTVIL));          1419
         L     @06,@PC00001                                        1419
         ST    @06,@AL00001                                        1419
         LA    @05,@CC01290                                        1419
         ST    @05,@AL00001+4                                      1419
         LA    @05,DLISTVIL                                        1419
         ST    @05,@AFTEMPS+20                                     1419
         LA    @05,@AFTEMPS+20                                     1419
         ST    @05,@AL00001+8                                      1419
         MVI   @AL00001+8,X'80'                                    1419
         L     @15,GDTDBG(,@06)                                    1419
         LA    @01,@AL00001                                        1419
         BALR  @14,@15                                             1419
*                                                          /*@YL026UD*/
*                                                                  1420
*        /************************************************************/
*        /*                                                  @YL026UD*/
*        /*  DIAGNOSTIC AID (TEST MODE) -                    @YL026UD*/
*        /*  BUILD SYMBOLIC DUMP LIST TO SYMBOLICALLY DUMP   @YL026UD*/
*        /*  THE CPL, FVT, AND FPLS                          @YL026UD*/
*        /*                                                  @YL026UD*/
*        /************************************************************/
*                                                                  1420
*                                                                  1420
*        IF GDTDBG = NULLPTR                                       1420
*          THEN;                                                   1420
@RT01417 L     @06,@PC00001                                        1420
         L     @06,GDTDBG(,@06)                                    1420
         LTR   @06,@06                                             1420
         BZ    @RT01420                                            1420
*          ELSE                                                    1422
*            DO;                                                   1422
*              DMPINDEX = ADDR(DLISTCPL);                          1423
*                                                                  1423
         LA    DMPINDEX,DLISTCPL                                   1423
*              DMPITMNM = 'CPLPTR';                                1424
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1424
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1424
         MVC   DMPITMNM(6,DMPINDEX),@CC01271                       1424
*              DMPITMPT = ADDR(CATPLPTR);                          1425
         LA    @06,CATPLPTR                                        1425
         ST    @06,DMPITMPT(,DMPINDEX)                             1425
*              DMPITMLN = 4;                                       1426
         LA    @06,4                                               1426
         STH   @06,DMPITMLN(,DMPINDEX)                             1426
*              DMPITMTP = 'H';                                     1427
         MVI   DMPITMTP(DMPINDEX),C'H'                             1427
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1428
*                                                                  1428
         LA    @05,16                                              1428
         ALR   DMPINDEX,@05                                        1428
*              DMPITMNM = 'CPL';                                   1429
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1429
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1429
         MVC   DMPITMNM(3,DMPINDEX),@CC01272                       1429
*              DMPITMPT = ADDR(CATPL);                             1430
         L     @03,CATPLPTR                                        1430
         ST    @03,DMPITMPT(,DMPINDEX)                             1430
*              DMPITMLN = CPLLEN;                                  1431
         LH    @03,CPLLEN                                          1431
         STH   @03,DMPITMLN(,DMPINDEX)                             1431
*              DMPITMTP = 'H';                                     1432
         MVI   DMPITMTP(DMPINDEX),C'H'                             1432
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1433
*                                                                  1433
         ALR   DMPINDEX,@05                                        1433
*              DMPITMNM = 'FVTPTR';                                1434
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1434
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1434
         MVC   DMPITMNM(6,DMPINDEX),@CC01273                       1434
*              DMPITMPT = ADDR(CTGFVT);                            1435
         LA    @03,CTGFVT(,CTGPLPTR)                               1435
         ST    @03,DMPITMPT(,DMPINDEX)                             1435
*              DMPITMLN = 4;                                       1436
         STH   @06,DMPITMLN(,DMPINDEX)                             1436
*              DMPITMTP = 'H';                                     1437
         MVI   DMPITMTP(DMPINDEX),C'H'                             1437
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1438
*                                                                  1438
         ALR   DMPINDEX,@05                                        1438
*              DMPITMNM = 'FVT';                                   1439
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1439
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1439
         MVC   DMPITMNM(3,DMPINDEX),@CC01274                       1439
*              DMPITMPT = ADDR(CTGFV);                             1440
         L     @03,CTGFVT(,CTGPLPTR)                               1440
         ST    @03,DMPITMPT(,DMPINDEX)                             1440
*              DMPITMLN = FVTLEN;                                  1441
         LH    @03,FVTLEN                                          1441
         STH   @03,DMPITMLN(,DMPINDEX)                             1441
*              DMPITMTP = 'H';                                     1442
         MVI   DMPITMTP(DMPINDEX),C'H'                             1442
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1443
*                                                                  1443
         ALR   DMPINDEX,@05                                        1443
*              DMPITMNM = 'DEVTPTR';                               1444
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1444
         MVC   DMPITMNM(7,DMPINDEX),@CC01264                       1444
*              DMPITMPT = ADDR(DEVTFPL);                           1445
         LA    @03,DEVTFPL                                         1445
         ST    @03,DMPITMPT(,DMPINDEX)                             1445
*              DMPITMLN = 4;                                       1446
         STH   @06,DMPITMLN(,DMPINDEX)                             1446
*              DMPITMTP = 'H';                                     1447
         MVI   DMPITMTP(DMPINDEX),C'H'                             1447
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1448
*                                                                  1448
         ALR   DMPINDEX,@05                                        1448
*              DMPITMNM = 'DEVTFPL';                               1449
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1449
         MVC   DMPITMNM(7,DMPINDEX),@CC01275                       1449
*              DMPITMPT = ADDR(DEVTFPL->CTGFL);                    1450
         L     @03,DEVTFPL                                         1450
         ST    @03,DMPITMPT(,DMPINDEX)                             1450
*              DMPITMLN = FPLLEN;                                  1451
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1451
*              DMPITMTP = 'H';                                     1452
         MVI   DMPITMTP(DMPINDEX),C'H'                             1452
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1453
*                                                                  1453
         ALR   DMPINDEX,@05                                        1453
*              DMPITMNM = 'FSEQPTR';                               1454
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1454
         MVC   DMPITMNM(7,DMPINDEX),@CC01276                       1454
*              DMPITMPT = ADDR(FSEQFPL);                           1455
         LA    @03,FSEQFPL                                         1455
         ST    @03,DMPITMPT(,DMPINDEX)                             1455
*              DMPITMLN = 4;                                       1456
         STH   @06,DMPITMLN(,DMPINDEX)                             1456
*              DMPITMTP = 'H';                                     1457
         MVI   DMPITMTP(DMPINDEX),C'H'                             1457
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1458
*                                                                  1458
         ALR   DMPINDEX,@05                                        1458
*              DMPITMNM = 'FSEQFPL';                               1459
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1459
         MVC   DMPITMNM(7,DMPINDEX),@CC01277                       1459
*              DMPITMPT = ADDR(FSEQFPL->CTGFL);                    1460
         L     @06,FSEQFPL                                         1460
         ST    @06,DMPITMPT(,DMPINDEX)                             1460
*              DMPITMLN = FPLLEN;                                  1461
         STH   FPLLEN,DMPITMLN(,DMPINDEX)                          1461
*              DMPITMTP = 'H';                                     1462
         MVI   DMPITMTP(DMPINDEX),C'H'                             1462
*              DMPINDEX = DMPINDEX + DMPELEMT;                     1463
*                                                                  1463
         ALR   DMPINDEX,@05                                        1463
*              DMPTRM = DMPTRMVL;                                  1464
         MVI   DMPTRM(DMPINDEX),X'FF'                              1464
*            END;                                                  1465
*                                                                  1465
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  DUMP POINT TO DUMP CPL, FVT, AND FPLS AFTER     @Y30SSMK*/
*        /*  BUILDING THE VSAM PARAMETER LIST TO ALTER A     @Y30SSMK*/
*        /*  VSAM CATALOG ENTRY.                             @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1466
*        IF GDTDBG = NULLPTR                                       1466
*          THEN;                                                   1466
@RT01420 L     @08,@PC00001                                        1466
         L     @08,GDTDBG(,@08)                                    1466
         LTR   @08,@08                                             1466
         BZ    @RT01466                                            1466
*          ELSE                                                    1468
*            CALL IDCDB010(GDTTBL,'CCAC',ADDR(DLISTCPL));          1468
         L     @08,@PC00001                                        1468
         ST    @08,@AL00001                                        1468
         LA    @06,@CC01291                                        1468
         ST    @06,@AL00001+4                                      1468
         LA    @06,DLISTCPL                                        1468
         ST    @06,@AFTEMPS+20                                     1468
         LA    @06,@AFTEMPS+20                                     1468
         ST    @06,@AL00001+8                                      1468
         MVI   @AL00001+8,X'80'                                    1468
         L     @15,GDTDBG(,@08)                                    1468
         LA    @01,@AL00001                                        1468
         BALR  @14,@15                                             1468
*                                                          /*@YL026UD*/
*                                                                  1469
*        END ALTRLSTS;                                     /*@YL026UD*/
@EL00017 DS    0H                                                  1469
@EF00017 DS    0H                                                  1469
@ER00017 LM    @14,@06,@SA00017                                    1469
         LM    @08,@12,@SA00017+36                                 1469
         BR    @14                                                 1469
*/********************************************************************/
*/*                                                          @Y30SSMK*/
*/* PROCEDURE NAME - ERRPROC                                 @Y30SSMK*/
*/*                                                          @Y30SSMK*/
*/* FUNCTION - TO BUILD THE ERROR CONVERSION TABLE AND       @Y30SSMK*/
*/*            INVOKE UERROR TO PRINT THE APPROPRIATE        @Y30SSMK*/
*/*            ERROR MESSAGE.                                @Y30SSMK*/
*/*                                                          @Y30SSMK*/
*/* INPUT - THE REQUIRED STORAGE AREA FOR THE ERROR          @Y30SSMK*/
*/*         CONVERSION TABLE AND A FIELD INDICATING THE TYPE @Y30SSMK*/
*/*         OF CATALOG OPERATION PERFORMED.                  @Y30SSMK*/
*/*                                                          @Y30SSMK*/
*/* OUTPUT - APPROPRIATE ERROR MESSAGE PRINTED.              @Y30SSMK*/
*/*                                                          @Y30SSMK*/
*/********************************************************************/
*                                                                  1470
*ERRPROC: PROCEDURE;                                       /*@Y30SSMK*/
ERRPROC  STM   @14,@12,@SA00018                                    1470
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  BUILD THE ERROR CONVERSION TABLE AND INVOKE     @Y30SSMK*/
*        /*  UERROR TO PRINT THE APPROPRIATE ERROR MESSAGE.  @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1471
*        OLDERID2 = NEWERID2;                                      1471
         L     @08,@PC00001                                        1471
         L     @08,GDTTR2(,@08)                                    1471
         MVC   @TS00001(95),NEWERID2(@08)                          1471
         MVC   OLDERID2(95,@08),@TS00001                           1471
*        NEWID2 = 'CCER';                                  /*@Y30SSMK*/
*                                                                  1472
         MVC   NEWID2(4,@08),@CC01295                              1472
*        ERCNVADR = ADDR(ERRORTAB);                        /*@Y30SSMK*/
         LA    @08,ERRORTAB                                        1473
         ST    @08,ERCNVADR                                        1473
*        ERCNVTAB = ''B;                                   /*@Y30SSMK*/
         XC    ERCNVTAB(32,@08),ERCNVTAB(@08)                      1474
*        ERCATLG = ON;                                     /*@Y30SSMK*/
*                                                                  1475
         OI    ERCATLG(@08),B'10000000'                            1475
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  SET THE APPROPRIATE FUNCTION TYPE FLAG          @Y30SSMK*/
*        /*  DEPENDING ON WHAT CATALOG FUNCTION WAS BEING    @Y30SSMK*/
*        /*  EXECUTED. (I.E., DEFINE, LOCATE, OR ALTER)      @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1476
*        IF ERRORTYP = ERRORDE                                     1476
*          THEN                                                    1476
         C     ERRORTYP,@CF00215                                   1476
         BNE   @RF01476                                            1476
*            ERCATDE = ON;                                 /*@Y30SSMK*/
         OI    ERCATDE(@08),B'01000000'                            1477
*          ELSE                                                    1478
*            IF ERRORTYP = ERRORLC                                 1478
*              THEN                                                1478
         B     @RC01476                                            1478
@RF01476 C     ERRORTYP,@CF00149                                   1478
         BNE   @RF01478                                            1478
*                ERCATLC = ON;                             /*@Y30SSMK*/
         L     @08,ERCNVADR                                        1479
         OI    ERCATLC(@08),B'10000000'                            1479
*              ELSE                                                1480
*                ERCATAL = ON;                             /*@Y30SSMK*/
         B     @RC01478                                            1480
@RF01478 L     @08,ERCNVADR                                        1480
         OI    ERCATAL(@08),B'00010000'                            1480
*        ERCATRC = TESTRC;                                 /*@Y30SSMK*/
@RC01478 DS    0H                                                  1481
@RC01476 L     @08,ERCNVADR                                        1481
         ST    TESTRC,ERCATRC(,@08)                                1481
*        ERCPLPT = CATPLPTR;                               /*@Y30SSMK*/
*                                                                  1482
         L     @04,CATPLPTR                                        1482
         ST    @04,ERCPLPT(,@08)                                   1482
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  WHEN A DUPLICATE ENTRY IS ENCOUNTERED, INSERT   @Y30SSMK*/
*        /*  THE ENTRY NAME IN THE UERROR PARAMETER LIST.    @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1483
*        IF TESTRC = DUPLCODE                                      1483
*          THEN                                                    1483
         C     TESTRC,@CF00175                                     1483
         BNE   @RF01483                                            1483
*            ERDSNM = ADDR(DSNAME);                        /*@Y30SSMK*/
*                                                                  1484
         LA    @15,DSNAME                                          1484
         ST    @15,ERDSNM(,@08)                                    1484
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /*  INVOKE UERROR TO PRINT OUT THE APPROPRIATE VSAM @Y30SSMK*/
*        /*  CATALOG ERROR MESSAGE.                          @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1485
*        CALL IDCTPER0 (GDTTBL,ERCNVADR);                  /*@Y30SSMK*/
*                                                                  1485
@RF01483 L     @08,@PC00001                                        1485
         ST    @08,@AL00001                                        1485
         LA    @15,ERCNVADR                                        1485
         ST    @15,@AL00001+4                                      1485
         MVI   @AL00001+4,X'80'                                    1485
         L     @15,GDTERR(,@08)                                    1485
         LA    @01,@AL00001                                        1485
         BALR  @14,@15                                             1485
*        END ERRPROC;                                      /*@Y30SSMK*/
@EL00018 DS    0H                                                  1486
@EF00018 DS    0H                                                  1486
@ER00018 LM    @14,@12,@SA00018                                    1486
         BR    @14                                                 1486
*        END CATALOG;                                      /*@YL026UD*/
*                                                                  1487
*                                                                  1487
*        END CONVERT;                                      /*@YL026UD*/
*                                                                  1488
*                                                                  1488
         B     @EL00002                                            1488
*        END IDCCC01                                       /*@YL026UD*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSCC )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*;                                                                 1489
@DATA    DS    0H
@CH00042 DC    H'4'
@CH00152 DC    H'6'
@CH00847 DC    H'14'
@CH00583 DC    H'44'
@CH01047 DC    H'120'
@SM01319 MVC   0(0,@08),CATENAME(CATPTR)
@SM01321 MVC   TRUEDSN(0),TRUENAME
@SM01323 MVC   0(0,@05),0(@07)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00003 DS    12F
@SA00004 DS    14F
@SA00005 DS    13F
@SA00011 DS    13F
@SA00006 DS    13F
@SA00007 DS    12F
@SA00008 DS    13F
@SA00009 DS    13F
@SA00010 DS    13F
@SA00013 DS    13F
@SA00012 DS    14F
@SA00014 DS    14F
@SA00015 DS    14F
@SA00018 DS    15F
@SA00016 DS    15F
@SA00017 DS    14F
@AL00001 DS    5A
@TF00001 DS    F
@AFTEMPS DS    7F
IDCCC01  CSECT
         DS    0F
@CF00113 DC    F'0'
@CF00215 DC    F'1'
@CH00215 EQU   @CF00215+2
@CF00149 DC    F'2'
@CH00149 EQU   @CF00149+2
@CF00426 DC    F'5'
@CF00175 DC    F'8'
@CH00175 EQU   @CF00175+2
@CF00037 DC    F'12'
@CH00037 EQU   @CF00037+2
@CF00224 DC    F'15'
@CH00224 EQU   @CF00224+2
@CF00894 DC    F'20'
@CF01227 DC    F'40'
@CF00948 DC    F'242'
@CF00823 DC    F'256'
@CH00823 EQU   @CF00823+2
@CF01036 DC    F'512'
@CF01297 DC    F'5632'
@CF01312 DC    F'-256'
@CF01326 DC    F'-13'
@CF01313 DC    F'-12'
@CF01317 DC    F'-10'
@CF01325 DC    F'-9'
@CF01315 DC    F'-6'
@CF01318 DC    F'-5'
@CF01314 DC    F'-4'
@CF01327 DC    F'-3'
@CF01316 DC    F'-2'
@CF01151 DC    F'-1'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CTGFLPTR DS    A
IIOCSPTR DS    A
CATPLPTR DS    A
CATPLLEN DS    F
DEVTFPL  DS    A
FSEQFPL  DS    A
ENTYPFPL DS    A
CATVLFPL DS    A
DEVTPTR  DS    A
VOLPTR   DS    A
FILEPTR  DS    A
VINFOPTR DS    A
VINFOLEN DS    F
WKAPTR   DS    A
WKASIZE  DS    F
BLKLVPTR DS    A
BLKLVLEN DS    F
BLOCKPTR DS    A
CNVTCNT  DS    F
UPDTCNT  DS    F
LISTPTR  DS    A
OIOCSPTR DS    A
LVLINDEX DS    H
TRUENLEN DS    H
CPLLEN   DS    H
FVTLEN   DS    H
DEVTLEN  DS    H
VOLLEN   DS    H
FILELEN  DS    H
VOLCNT   DS    H
BLOCKCNT DS    H
VCBINDEX DS    H
SETRC    DS    H
GDGLIMIT DS    FL1
GDGATTR  DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
PRNTLIST DS    CL20
IOPENARG DS    CL44
LASTMSG  DS    BL1
DSINFO   DS    CL52
         ORG   DSINFO
DSNAME   DS    CL44
@NM00053 DS    CL8
         ORG   DSINFO+52
TRUENAME DS    CL8
TRUEDSN  DS    CL44
ALIASDSN DS    CL44
DSCBTTR  DS    CL4
         DS    CL3
BLOCKTTR DS    CL4
SUBTITLE DS    CL120
PCARGLST DS    CL34
         ORG   PCARGLST
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    FL2
         ORG   PCARGLST+34
CVPEVOL  DS    CL6
VCBDONE  DS    BL1
ALIASFLG DS    BL1
TRUEFLG  DS    BL1
CVPEFLAG DS    BL1
ENDFLAG  DS    BL1
FOUNDFLG DS    BL1
GDGFLAG  DS    BL1
G0V0FLAG DS    BL1
CVPETEXT DS    CL14
         ORG   CVPETEXT
CVPTXTNM DS    CL8
CVPTXTVL DS    CL6
         ORG   CVPETEXT+14
         DS    CL2
DLISTBLK DS    CL49
         DS    CL3
DLISTVIL DS    CL97
         DS    CL3
DLISTCPL DS    CL129
LOCATFLG DS    BL1
MATCHFLG DS    BL1
SCANFLAG DS    BL1
ERRORTAB DS    CL32
OOPENARG DS    CL44
LVLSTACK DS    CL2
         ORG   LVLSTACK+0
LVLOFSET DS    FL2
         ORG   LVLSTACK+44
IXNLEN   DS    22H
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCCC01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC01141 DC    C'BLKLEVEL'
@CC01142 DC    C'BLOCKPTR'
@CC01167 DC    C'        '
@CC01212 DC    C'DEVTYP  '
@CC01214 DC    C'FILESEQ '
@CC01216 DC    C'ENTYPE  '
@CC01218 DC    C'CATVOL  '
@CC01241 DC    C'ENTYPPTR'
@CC01242 DC    C'ENTYPLST'
@CC01243 DC    C'CATVLPTR'
@CC01244 DC    C'CATVLLST'
@CC01265 DC    C'DEVTLIST'
@CC01269 DC    C'FILELIST'
@CC01283 DC    C'ENTYPFPL'
@CC01284 DC    C'CATVLFPL'
@CC01264 DC    C'DEVTPTR'
@CC01267 DC    C'VOLLIST'
@CC01268 DC    C'FILEPTR'
@CC01275 DC    C'DEVTFPL'
@CC01276 DC    C'FSEQPTR'
@CC01277 DC    C'FSEQFPL'
@CC01092 DC    C'VOLUME'
@CC01266 DC    C'VOLPTR'
@CC01271 DC    C'CPLPTR'
@CC01273 DC    C'FVTPTR'
@CC01144 EQU   @CC01142
@CC01207 DC    C'SYS1.'
@CC00862 DC    C'CC00'
@CC01103 DC    C'CCCV'
@CC01130 DC    C'CCSE'
@CC01131 DC    C'CCSL'
@CC01135 DC    C'CCCI'
@CC01136 DC    C'CCIC'
@CC01140 DC    C'CCVX'
@CC01145 DC    C'CCVI'
@CC01146 DC    C'CCVE'
@CC01150 DC    C'CCAP'
@CC01155 DC    C'CCIP'
@CC01165 DC    C'CCDP'
@CC01171 DC    C'CCVP'
@CC01178 DC    C'CCGP'
@CC01182 DC    C'CCCP'
@CC01190 DC    C'CCPH'
@CC01191 DC    C'CCPD'
@CC01192 DC    C'CCIE'
@CC01196 DC    C'CCCE'
@CC01197 DC    C'CCCN'
@CC01201 DC    C'CCPP'
@CC01202 DC    C'CCPU'
@CC01234 DC    C'CCCT'
@CC01237 DC    C'CCLT'
@CC01245 DC    C'CCLV'
@CC01252 DC    C'CCAT'
@CC01257 DC    C'CCDL'
@CC01270 DC    C'CCDV'
@CC01278 DC    C'CCDC'
@CC01282 DC    C'CCLL'
@CC01285 DC    C'CCLC'
@CC01289 DC    C'CCAL'
@CC01290 DC    C'CCAV'
@CC01291 DC    C'CCAC'
@CC01295 DC    C'CCER'
@CC00831 EQU   @CC00862
@CC00849 DC    C'UV0'
@CC01272 EQU   @CC01271
@CC01274 EQU   @CC01273
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'CC01'
FIXAREA  DS    CL512
         ORG   FIXAREA
@NM00046 DS    CL256
         ORG   @NM00046
@NM00047 DC    256X'00'
         ORG   FIXAREA+256
@NM00048 DS    CL256
         ORG   @NM00048
@NM00049 DC    256X'00'
         ORG   FIXAREA+512
TYPEAE   DC    X'04'
TYPEGIPE DC    X'02'
TYPEICE  DC    X'03'
TYPEILE  DC    X'00'
TYPEIPE  DC    X'00'
TYPEVCBP DC    X'01'
TYPEVICE DC    X'05'
FIRSTTTR DC    X'00000100'
ILEENAME DC    X'FFFFFFFFFFFFFFFF'
ZEROTTR  DC    X'000000'
ALLONES  DC    X'FFFFFFFF'
CATZERO  DC    X'0000000000000000'
TYPECVPE DC    X'03'
         DC    X'05'
TYPEDSPE DC    X'07'
         DC    X'0D'
         DC    X'13'
         DC    X'19'
         DC    X'1F'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ERRORTYP EQU   @02
VOLINDX  EQU   @02
CATVINDX EQU   @03
VCBVOLIM EQU   @02
DSPEINDX EQU   @02
CVEVINDX EQU   @05
CVENINDX EQU   @02
INDEX    EQU   @07
CATVLCNT EQU   @05
FPLLEN   EQU   @08
DSNLEN   EQU   @06
CATPTR   EQU   @03
CTGPLPTR EQU   @04
DMPINDEX EQU   @02
OPNPTR   EQU   @02
TESTRC   EQU   @05
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSACA0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPO0 EQU   0
IDCIOGT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMFX EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+36
OPNDSO   EQU   OPNAGL+41
OPNDSOPS EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATAL  EQU   EROPER
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
IFILE    EQU   0
IFILEVAL EQU   IFILE+1
IDS      EQU   0
IDSFLG   EQU   IDS+10
IDSVAL   EQU   IDS+21
CAT      EQU   0
CATNM    EQU   0
CATNMPLN EQU   CATNM
CATNMPAS EQU   CATNM+1
CATNMFLG EQU   CATNM+10
CATNMVAL EQU   CATNM+21
CATDN    EQU   0
CVEQU    EQU   0
CVEQUCNT EQU   0
CVECNPTR EQU   0
CVECN    EQU   0
CVECNFLG EQU   CVECN+10
CVECNVAL EQU   CVECN+21
CVEVSPTR EQU   0
CVEVS    EQU   0
CVEVSCNT EQU   CVEVS
@NM00037 EQU   CVEVS+2
CVEVSVAL EQU   @NM00037+1
MRCAT    EQU   0
MRCATPLN EQU   MRCAT
MRCATPAS EQU   MRCAT+1
MRCATFLG EQU   MRCAT+10
MRCATVAL EQU   MRCAT+21
LIST     EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFV    EQU   0
CTGFVTYP EQU   CTGFV
CTGFVPRO EQU   CTGFV+1
CTGFVNDC EQU   CTGFVPRO
CTGFVENT EQU   CTGFV+20
CTGFVVLT EQU   CTGFV+40
CTGFVDVT EQU   CTGFV+48
CTGFVSPC EQU   CTGFV+52
CTGFVTTR EQU   CTGFVSPC
CTGFVAMD EQU   CTGFV+56
CTGFVFSN EQU   CTGFVAMD
CTGFVLMT EQU   CTGFV+72
CTGFVGAT EQU   CTGFV+76
CTGFVNAM EQU   CTGFV+80
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
CATFORM  EQU   0
CATENAME EQU   CATFORM
CATETTR  EQU   CATFORM+8
CATETYPE EQU   CATFORM+11
AEFORM   EQU   0
AETRUEN  EQU   AEFORM+12
CVP1FORM EQU   0
CVP1VOL  EQU   CVP1FORM+12
CVP2FORM EQU   0
CVP2VOL  EQU   CVP2FORM+16
DSPEFORM EQU   0
DSPENAME EQU   DSPEFORM
DSPETTR  EQU   DSPEFORM+8
DSPETYPE EQU   DSPEFORM+11
DSPEVCNT EQU   DSPEFORM+12
DSPEDATA EQU   DSPEFORM+14
DSPEDEVT EQU   DSPEDATA
DSPEDVOL EQU   DSPEDATA+4
DSPEDSEQ EQU   DSPEDATA+10
GIPEFORM EQU   0
GIPENAME EQU   GIPEFORM
GIPETYPE EQU   GIPEFORM+11
GIPEFLGS EQU   GIPEFORM+12
GIPEFDEL EQU   GIPEFLGS
GIPEFEMP EQU   GIPEFLGS
GIPEMCNT EQU   GIPEFORM+13
ICEFORM  EQU   0
ILEFORM  EQU   0
ILETTR   EQU   ILEFORM+8
IPEFORM  EQU   0
VCBFORM1 EQU   0
VCBVOLCT EQU   VCBFORM1
VCBVOLS  EQU   VCBFORM1+2
VCBDEVT  EQU   VCBVOLS
VCBDVOL  EQU   VCBVOLS+4
VCBDSEQ  EQU   VCBVOLS+10
VCBFORM2 EQU   0
VCBTTR   EQU   VCBFORM2+10
VCBPFORM EQU   0
VCBPNAME EQU   VCBPFORM
VCBPTTR  EQU   VCBPFORM+8
VCBPTYPE EQU   VCBPFORM+11
VICEFORM EQU   0
CATPL    EQU   0
DEVTLIST EQU   0
DEVTUNIT EQU   DEVTLIST
DEVTCODE EQU   DEVTLIST+8
VOLLIST  EQU   0
VOLSTLEN EQU   VOLLIST
VOLSERS  EQU   VOLLIST+2
VOLZERO  EQU   VOLSERS
VOLSER   EQU   VOLSERS+2
FILELIST EQU   0
FILESEQ  EQU   FILELIST
ENTYPE   EQU   0
CATVLIST EQU   0
CVDEVTYP EQU   CATVLIST+2
CVVOLSER EQU   CATVLIST+6
CVFSEQ   EQU   CATVLIST+12
WKAREA   EQU   0
WKALEN   EQU   WKAREA
WKAREQD  EQU   WKAREA+2
BLOCK    EQU   0
BLKREAD  EQU   0
LOCINFO  EQU   0
AMSTP041 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NLIST    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
@NM00042 EQU   CTGDDNM
CTGPROB  EQU   @NM00042
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
WKADATA  EQU   WKAREA+4
CVVOLFLG EQU   CATVLIST+14
CVRELREP EQU   CATVLIST
@NM00052 EQU   VICEFORM+20
VICEZRO2 EQU   VICEFORM+19
VICEHOLE EQU   VICEFORM+16
VICEZRO1 EQU   VICEFORM+15
VICECBLK EQU   VICEFORM+12
VICETYPE EQU   VICEFORM+11
VICELBLK EQU   VICEFORM+8
VICENAME EQU   VICEFORM
VCBPZERO EQU   VCBPFORM+12
VCBZERO2 EQU   VCBFORM2+13
VCBZERO1 EQU   VCBFORM2
IPETYPE  EQU   IPEFORM+11
IPETTR   EQU   IPEFORM+8
IPENAME  EQU   IPEFORM
ILETYPE  EQU   ILEFORM+11
ILENAME  EQU   ILEFORM
@NM00051 EQU   ICEFORM+16
ICEACNT  EQU   ICEFORM+15
ICEFBLK  EQU   ICEFORM+12
ICETYPE  EQU   ICEFORM+11
ICELBLK  EQU   ICEFORM+8
ICENAME  EQU   ICEFORM
GIPECCNT EQU   GIPEFORM+14
@NM00050 EQU   GIPEFLGS
GIPETTR  EQU   GIPEFORM+8
CVP2VTYP EQU   CVP2FORM+12
CVP2TYPE EQU   CVP2FORM+11
CVP2TTR  EQU   CVP2FORM+8
CVP2NAME EQU   CVP2FORM
CVP1TYPE EQU   CVP1FORM+11
CVP1TTR  EQU   CVP1FORM+8
CVP1NAME EQU   CVP1FORM
AETYPE   EQU   AEFORM+11
AETTR    EQU   AEFORM+8
AENAME   EQU   AEFORM
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00045 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
CTGFVWKA EQU   CTGFV+88
CTGFVPWD EQU   CTGFV+84
CTGFVUPG EQU   CTGFVGAT
CTGFVEXT EQU   CTGFVLMT
CTGFVLRS EQU   CTGFV+68
CTGFVBUF EQU   CTGFV+64
CTGFVATR EQU   CTGFV+60
CTGFVRNG EQU   CTGFV+44
CTGFVCRE EQU   CTGFV+36
CTGFVEXP EQU   CTGFV+32
CTGFVOWN EQU   CTGFV+28
CTGFVSTY EQU   CTGFV+24
CTGFVIND EQU   CTGFV+16
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
CTGFVDCH EQU   CTGFV+4
@NM00044 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00043 EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
@NM00041 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00040 EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
@NM00039 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00038 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
MRCATLEN EQU   MRCAT+20
MRCATMEM EQU   MRCAT+12
MRCATMLN EQU   MRCAT+11
MRCATFUQ EQU   MRCATFLG
MRCATPOS EQU   MRCAT+9
CVEVSLEN EQU   @NM00037
CVECNLEN EQU   CVECN+20
CVECNMEM EQU   CVECN+12
CVECNMLN EQU   CVECN+11
CVECNFUQ EQU   CVECNFLG
CVECNPOS EQU   CVECN+9
CVECNPAS EQU   CVECN+1
CVECNPLN EQU   CVECN
CATDNVAL EQU   CATDN+1
CATDNLEN EQU   CATDN
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
IDSLEN   EQU   IDS+20
IDSMEM   EQU   IDS+12
IDSMLN   EQU   IDS+11
IDSFUQ   EQU   IDSFLG
IDSPOS   EQU   IDS+9
IDSPAS   EQU   IDS+1
IDSPLN   EQU   IDS
IFILELEN EQU   IFILE
@NM00036 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00035 EQU   DMPITM+15
@NM00034 EQU   ERCNVTAB+24
@NM00033 EQU   ERCNVTAB+4
@NM00032 EQU   ERCNVTAB+2
@NM00031 EQU   EROPER
ERCATDL  EQU   EROPER
@NM00030 EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGCNT  EQU   DARGLIST+14
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNPWA   EQU   OPNAGL+12
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00241 EQU   @RC00239
@RT00371 EQU   @EL00002
@RT00587 EQU   @EL00003
@RT00646 EQU   @EL00004
@RC00633 EQU   @EL00004
@RC00667 EQU   @EL00006
@RT00864 EQU   @EL00011
@RC00851 EQU   @EL00011
@RT00887 EQU   @EL00012
@RT00901 EQU   @EL00013
@RF00933 EQU   @RC00928
@RF01029 EQU   @RC01016
@RT01283 EQU   @EL00015
@RT01346 EQU   @EL00016
@RT01466 EQU   @EL00017
@PB00002 EQU   @EL00001
@RC00669 EQU   @RC00667
@ENDDATA EQU   *
         END   IDCCC01,(C'PLS0100',0602,75039)

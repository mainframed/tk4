         TITLE '******* IDCCK01:  CHECKPOINT LIST UTILITY (CHKLIST) FSR*
               R *******'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCCK01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCCK01   75.012'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @11,0                                               0002
@PSTART  LA    @12,4095(,@11)                                      0002
         USING @PSTART,@11                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0002
         USING @DATD,@10                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @10,8(,@13)                                         0002
         LR    @13,@10                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*        /************************************************************/
*        /*                                                          */
*        /* GLOBAL INITIALIZATIONS                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0201
*        OLDERID2 = NEWERID2;                                      0201
         L     @15,@PC00001                                        0201
         L     @15,GDTTR2(,@15)                                    0201
         MVC   @TS00001(95),NEWERID2(@15)                          0201
         MVC   OLDERID2(95,@15),@TS00001                           0201
*        NEWID2 = 'CKCK';                                          0202
*                                                                  0202
         MVC   NEWID2(4,@15),@CC00753                              0202
*        DDSTRU = ADDR(DARGAREA);                                  0203
         LA    @15,DARGAREA                                        0203
         ST    @15,DDSTRU                                          0203
*        DARGLIST = ZEROAREA;                                      0204
         MVC   DARGLIST(20,@15),ZEROAREA                           0204
*        SETRC = 0;                                                0205
         SLR   @15,@15                                             0205
         STH   @15,SETRC                                           0205
*        EOF = 0;                                                  0206
         STH   @15,EOF                                             0206
*        CHRFND = NO;                                              0207
         NI    CHRFND,B'01111111'                                  0207
*        NEEDCHR = YES;                                            0208
         OI    NEEDCHR,B'10000000'                                 0208
*        SYSID = ZEROAREA;                                         0209
*                                                                  0209
         MVC   SYSID(1),ZEROAREA                                   0209
*        /************************************************************/
*        /*                                                          */
*        /* PERFORM HOUSKEEPING FUCTIONS:                            */
*        /*    OPEN ALTERNATE OUTPUT IF SPECIFIED                    */
*        /*    OPEN CHECKPOINT DATA SET INPUT                        */
*        /*    SET UP HEADER LINES FOR TEXT PROCESSOR                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0210
*        CALL HSKGPROC;                                            0210
         BAL   @14,HSKGPROC                                        0210
*        RESPECIFY RTNREG RSTD;                                    0211
*        TESTRC = RTNREG;                                          0212
         LR    TESTRC,RTNREG                                       0212
*        RESPECIFY RTNREG UNRSTD;                                  0213
*        SETRC = MAX(SETRC,TESTRC);                                0214
*                                                                  0214
         LH    @02,SETRC                                           0214
         CR    @02,TESTRC                                          0214
         BNL   *+6
         LR    @02,TESTRC                                          0214
         STH   @02,SETRC                                           0214
*        /************************************************************/
*        /*                                                          */
*        /* BUILD CHECKID TABLE IF NO TERMINAL ERROR HAS OCCURED.    */
*        /* SET IDCOUNT TO CHKIDCNT WHEN CHECKID WAS SPECIFIED       */
*        /* OR TO -1 IF CHECKID WAS NOT SPECIFIED (ALL ENTRIES ARE   */
*        /* TO BE PROCESSED)                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0215
*        IF SETRC < LASTCC12                                       0215
*          THEN                                                    0215
*                                                                  0215
         C     @02,@CF00536                                        0215
         BNL   @RF00215                                            0215
*MAINCNTL:   DO;                                                   0216
*                                                                  0216
MAINCNTL DS    0H                                                  0217
*              CALL BUILDTAB (IDTABPTR,                            0217
*                             IDEOTPTR);                           0217
         LA    @15,IDTABPTR                                        0217
         ST    @15,@AL00001                                        0217
         LA    @15,IDEOTPTR                                        0217
         ST    @15,@AL00001+4                                      0217
         LA    @01,@AL00001                                        0217
         BAL   @14,BUILDTAB                                        0217
*              RESPECIFY RTNREG RSTD;                              0218
*              TESTRC = RTNREG;                                    0219
         LR    TESTRC,RTNREG                                       0219
*              RESPECIFY RTNREG UNRSTD;                            0220
*              SETRC = MAX(SETRC,TESTRC);                          0221
         LH    @02,SETRC                                           0221
         CR    @02,TESTRC                                          0221
         BNL   *+6
         LR    @02,TESTRC                                          0221
         STH   @02,SETRC                                           0221
*              /******************************************************/
*              /*                                                    */
*              /* IF NO TERMINAL ERROR HAS OCCURED, PREPARE THE      */
*              /* CHECKPOINT LIST UTILITY REPORT OF TAPE DATA        */
*              /* SETS OPEN AT THE TIME OF EACH USER-SELECTED        */
*              /* CHECKPOINT                                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0222
*              IF SETRC < LASTCC12                                 0222
*                THEN                                              0222
*                                                                  0222
         C     @02,@CF00536                                        0222
         BNL   @RF00222                                            0222
*DOCKLST:         DO;                                              0223
*                                                                  0223
DOCKLST  DS    0H                                                  0224
*                  DO WHILE(IDCOUNT ^= 0 & EOF = 0);               0224
*                                                                  0224
         B     @DE00224                                            0224
@DL00224 DS    0H                                                  0225
*                    IF GDTDBG = NULLPTR                           0225
*                      THEN;                                       0225
         L     @02,@PC00001                                        0225
         L     @02,GDTDBG(,@02)                                    0225
         LTR   @02,@02                                             0225
         BZ    @RT00225                                            0225
*                      ELSE                                        0227
*                        CALL IDCDB010 (GDTTBL,'CK10');            0227
*                                                                  0227
         L     @02,@PC00001                                        0227
         ST    @02,@AL00001                                        0227
         LA    @15,@CC00762                                        0227
         ST    @15,@AL00001+4                                      0227
         MVI   @AL00001+4,X'80'                                    0227
         L     @15,GDTDBG(,@02)                                    0227
         LA    @01,@AL00001                                        0227
         BALR  @14,@15                                             0227
*                    /************************************************/
*                    /*                                              */
*                    /* READ USER-SELECTED CHR AND DECREMENT IDCOUNT */
*                    /* WHEN USER-SELECTED CHR IS FOUND              */
*                    /*                                              */
*                    /************************************************/
*                                                                  0228
*                    CALL CHRPROC (SYSID,                          0228
*                                  NEEDCHR,                        0228
*                                  CHRFND,                         0228
*                                  EOF);                           0228
*                                                                  0228
@RT00225 LA    @02,SYSID                                           0228
         ST    @02,@AL00001                                        0228
         LA    @02,NEEDCHR                                         0228
         ST    @02,@AL00001+4                                      0228
         LA    @02,CHRFND                                          0228
         ST    @02,@AL00001+8                                      0228
         LA    @02,EOF                                             0228
         ST    @02,@AL00001+12                                     0228
         LA    @01,@AL00001                                        0228
         BAL   @14,CHRPROC                                         0228
*                    IF GDTDBG = NULLPTR                           0229
*                      THEN;                                       0229
         L     @02,@PC00001                                        0229
         L     @02,GDTDBG(,@02)                                    0229
         LTR   @02,@02                                             0229
         BZ    @RT00229                                            0229
*                      ELSE                                        0231
*                        CALL IDCDB010 (GDTTBL,'CK20');            0231
*                                                                  0231
         L     @02,@PC00001                                        0231
         ST    @02,@AL00001                                        0231
         LA    @15,@CC00764                                        0231
         ST    @15,@AL00001+4                                      0231
         MVI   @AL00001+4,X'80'                                    0231
         L     @15,GDTDBG(,@02)                                    0231
         LA    @01,@AL00001                                        0231
         BALR  @14,@15                                             0231
*                    /************************************************/
*                    /*                                              */
*                    /* IF EOF HAS NOT OCCURED, PROCESS DSDRS, IF    */
*                    /* EOF HAS OCCURED, PERFORM EXIT PROCESSING     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0232
*                    IF EOF ^= EOFCOND                             0232
*                      THEN                                        0232
@RT00229 CLC   EOF(2),@CH00213                                     0232
         BE    @RF00232                                            0232
*                        DO;                                       0233
*                                                                  0233
*                          CALL DSDRPROC (NEEDCHR,EOF);            0234
         LA    @02,NEEDCHR                                         0234
         ST    @02,@AL00001                                        0234
         LA    @02,EOF                                             0234
         ST    @02,@AL00001+4                                      0234
         LA    @01,@AL00001                                        0234
         BAL   @14,DSDRPROC                                        0234
*                          RESPECIFY RTNREG RSTD;                  0235
*                          TESTRC = RTNREG;                        0236
         LR    TESTRC,RTNREG                                       0236
*                          RESPECIFY RTNREG UNRSTD;                0237
*                          SETRC = MAX(SETRC,TESTRC);              0238
*                                                                  0238
         LH    @02,SETRC                                           0238
         CR    @02,TESTRC                                          0238
         BNL   *+6
         LR    @02,TESTRC                                          0238
         STH   @02,SETRC                                           0238
*                        END;                                      0239
*                      ELSE;                                       0240
@RF00232 DS    0H                                                  0241
*                  END;                                            0241
@DE00224 SLR   @02,@02                                             0241
         L     @01,IDTABPTR                                        0241
         CH    @02,IDCOUNT(,@01)                                   0241
         BE    @DC00224                                            0241
         CH    @02,EOF                                             0241
         BE    @DL00224                                            0241
@DC00224 DS    0H                                                  0242
*                  /**************************************************/
*                  /*                                                */
*                  /* IF CHRFND = NO, THEN NO CHRS WERE FOUND ON THE */
*                  /* CHECKPOINT DATA SET. PRINT MESSAGE WITH UPRINT.*/
*                  /* SET RETURN CODE TO 4.                          */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0242
*                  IF CHRFND = NO                                  0242
*                    THEN                                          0242
         TM    CHRFND,B'10000000'                                  0242
         BNZ   @RF00242                                            0242
*                      DO;                                         0243
*                        DARGSMOD = CK0ID;                         0244
         L     @02,DDSTRU                                          0244
         MVC   DARGSMOD(3,@02),@CC00609                            0244
*                        DARGSENT = CKST09;                        0245
*                                                                  0245
         MVI   DARGSENT(@02),X'09'                                 0245
*                        CALL AMSTP011 (GDTTBL,                    0246
*                                PRTFILE,                          0246
*                                DDSTRU);                          0246
         L     @02,@PC00001                                        0246
         ST    @02,@AL00001                                        0246
         LA    @15,@CF00111                                        0246
         ST    @15,@AL00001+4                                      0246
         LA    @15,DDSTRU                                          0246
         ST    @15,@AL00001+8                                      0246
         MVI   @AL00001+8,X'80'                                    0246
         L     @15,GDTPRT(,@02)                                    0246
         LA    @01,@AL00001                                        0246
         BALR  @14,@15                                             0246
*                        RESPECIFY RTNREG RSTD;                    0247
*                        TESTRC = RTNREG;                          0248
         LR    TESTRC,RTNREG                                       0248
*                        RESPECIFY RTNREG UNRSTD;                  0249
*                        SETRC = MAX(SETRC,TESTRC);                0250
         LH    @02,SETRC                                           0250
         CR    @02,TESTRC                                          0250
         BNL   *+6
         LR    @02,TESTRC                                          0250
         STH   @02,SETRC                                           0250
*                        DARGLIST = ZEROAREA;      /* CLEAR DARGLIST */
         L     @01,DDSTRU                                          0251
         MVC   DARGLIST(20,@01),ZEROAREA                           0251
*                        SETRC = MAX(SETRC,LASTCC04);              0252
*                                                                  0252
         LA    @03,4                                               0252
         CR    @02,@03                                             0252
         BNL   *+6
         LR    @02,@03                                             0252
         STH   @02,SETRC                                           0252
*                      END;                                        0253
*                    ELSE;                                         0254
*                                                                  0254
@RF00242 DS    0H                                                  0255
*                  /**************************************************/
*                  /*                                                */
*                  /* IF IDCOUNT IS GREATER THAN ZERO, THEN SOME     */
*                  /* SELECTED CHECKIDS WERE NOT FOUND. LIST THEM    */
*                  /* AND SET LASTCC TO 4                            */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0255
*                  IF IDCOUNT > 0                                  0255
*                    THEN                                          0255
         L     @15,IDTABPTR                                        0255
         LH    @14,IDCOUNT(,@15)                                   0255
         LTR   @14,@14                                             0255
         BNP   @RF00255                                            0255
*                      DO;                                         0256
*                        IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);    0257
         AL    @15,@CF00147                                        0257
         LR    IDTABWKP,@15                                        0257
*                        DARGSMOD = CK0ID;                         0258
         L     @03,DDSTRU                                          0258
         MVC   DARGSMOD(3,@03),@CC00609                            0258
*                        DARGSENT = CKST05;                        0259
*                                                                  0259
         MVI   DARGSENT(@03),X'05'                                 0259
*                        /********************************************/
*                        /*                                          */
*                        /* SEARCH CHECKID TABLE FOR ENTRIES WHICH   */
*                        /* HAVE NOT BEEN FOUND AND PRINT WITH UPRINT*/
*                        /*                                          */
*                        /********************************************/
*                                                                  0260
*                        DO WHILE(IDTABWKP < IDEOTPTR);            0260
         B     @DE00260                                            0260
@DL00260 DS    0H                                                  0261
*                          IF IDFOUND = NO                         0261
*                            THEN                                  0261
         TM    IDFOUND(IDTABWKP),B'10000000'                       0261
         BNZ   @RF00261                                            0261
*                              DO;                                 0262
*                                DARGDBP = ADDR(IDCHKID);          0263
         L     @15,DDSTRU                                          0263
         LA    @14,IDCHKID(,IDTABWKP)                              0263
         ST    @14,DARGDBP(,@15)                                   0263
*                                DARGILP = LENGTH(IDCHKID);        0264
*                                                                  0264
         MVC   DARGILP(2,@15),@CH00465                             0264
*                                CALL AMSTP011 (GDTTBL,            0265
*                                        PRTFILE,                  0265
*                                        DDSTRU);                  0265
         L     @15,@PC00001                                        0265
         ST    @15,@AL00001                                        0265
         LA    @14,@CF00111                                        0265
         ST    @14,@AL00001+4                                      0265
         LA    @14,DDSTRU                                          0265
         ST    @14,@AL00001+8                                      0265
         MVI   @AL00001+8,X'80'                                    0265
         L     @15,GDTPRT(,@15)                                    0265
         LA    @01,@AL00001                                        0265
         BALR  @14,@15                                             0265
*                                RESPECIFY RTNREG RSTD;            0266
*                                TESTRC = RTNREG;                  0267
         LR    TESTRC,RTNREG                                       0267
*                                RESPECIFY RTNREG UNRSTD;          0268
*                                SETRC = MAX(SETRC,TESTRC);        0269
         LH    @15,SETRC                                           0269
         CR    @15,TESTRC                                          0269
         BNL   *+6
         LR    @15,TESTRC                                          0269
         STH   @15,SETRC                                           0269
*                                /* SET LASTCC TO 4                  */
*                                SETRC = MAX(SETRC,LASTCC04);      0270
*                                                                  0270
         LA    @03,4                                               0270
         CR    @15,@03                                             0270
         BNL   *+6
         LR    @15,@03                                             0270
         STH   @15,SETRC                                           0270
*                              END;                                0271
*                            ELSE;                                 0272
@RF00261 DS    0H                                                  0273
*                          IDTABWKP = IDTABWKP + LENGTH(IDTABLE);  0273
         AL    IDTABWKP,@CF00893                                   0273
*                        END;                                      0274
@DE00260 C     IDTABWKP,IDEOTPTR                                   0274
         BL    @DL00260                                            0274
*                        DARGLIST = ZEROAREA;                      0275
         L     @01,DDSTRU                                          0275
         MVC   DARGLIST(20,@01),ZEROAREA                           0275
*                      END;                                        0276
*                                                                  0276
*                    ELSE;                                         0277
*                                                                  0277
@RF00255 DS    0H                                                  0278
*                 END DOCKLST;                                     0278
*                                                                  0278
*                ELSE;                 /* PAIRS 'THEN' AFTER BUILDTAB*/
*                                                                  0279
@RF00222 DS    0H                                                  0280
*            END MAINCNTL;                                         0280
*                                                                  0280
*          ELSE;                  /* PAIRS 'THEN' AT 'MAINCNTL' LABEL*/
@RF00215 DS    0H                                                  0282
*        /************************************************************/
*        /*                                                          */
*        /* PERFORM EXIT PROCESSING - CLOSE OPENED FILES (UCLOSE)    */
*        /* AND FREE ACQUIRED SPACE (UFPOOL). PRINT APPROPRIATE      */
*        /* TERMINATION MESSAGE.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0282
*        /************************************************************/
*        /*                                                          */
*        /* CLOSE THE CHECKPOINT DATA SET                            */
*        /* IF ERROR OCCURS IN CLOSE, LASTCC IS SET TO 8             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0282
*        CALL IDCIOCL0 (GDTTBL,                                    0282
*                INIOCP);                                          0282
         L     @02,@PC00001                                        0282
         ST    @02,@AL00001                                        0282
         LA    @15,INIOCP                                          0282
         ST    @15,@AL00001+4                                      0282
         MVI   @AL00001+4,X'80'                                    0282
         L     @15,GDTCLS(,@02)                                    0282
         LA    @01,@AL00001                                        0282
         BALR  @14,@15                                             0282
*        RESPECIFY RTNREG RSTD;                                    0283
*        TESTRC = RTNREG;                                          0284
         LR    TESTRC,RTNREG                                       0284
*        RESPECIFY RTNREG UNRSTD;                                  0285
*        IF TESTRC ^= 0                                            0286
*          THEN                                                    0286
         LTR   TESTRC,TESTRC                                       0286
         BZ    @RF00286                                            0286
*            SETRC = MAX(SETRC,LASTCC08);                          0287
         LH    @15,SETRC                                           0287
         LA    @14,8                                               0287
         CR    @15,@14                                             0287
         BNL   *+6
         LR    @15,@14                                             0287
         STH   @15,SETRC                                           0287
*          ELSE;                                                   0288
*                                                                  0288
@RF00286 DS    0H                                                  0289
*        /************************************************************/
*        /*                                                          */
*        /* SELECT APPROPRIATE END OF JOB MESSAGE AND SET UP DARGLIST*/
*        /* PRINT WITH UPRINT.                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0289
*        IF SETRC < LASTCC12                                       0289
*          THEN                                                    0289
         LH    @15,SETRC                                           0289
         C     @15,@CF00536                                        0289
         BNL   @RF00289                                            0289
*            DO;                                                   0290
*              DARGSMOD = UV0ID;                                   0291
         L     @15,DDSTRU                                          0291
         MVC   DARGSMOD(3,@15),@CC00604                            0291
*              DARGSENT = UVMSG01;                                 0292
         MVI   DARGSENT(@15),X'01'                                 0292
*              DARGDBP = ADDR(SETRC);                              0293
         LA    @14,SETRC                                           0293
         ST    @14,DARGDBP(,@15)                                   0293
*              DARGILP = LENGTH(SETRC);                            0294
         MVC   DARGILP(2,@15),@CH00147                             0294
*            END;                                                  0295
*          ELSE                                                    0296
*            DO;                                                   0296
         B     @RC00289                                            0296
@RF00289 DS    0H                                                  0297
*              DARGSMOD = UV0ID;                                   0297
         L     @15,DDSTRU                                          0297
         MVC   DARGSMOD(3,@15),@CC00604                            0297
*              DARGSENT = UVMSG03;                                 0298
         MVI   DARGSENT(@15),X'03'                                 0298
*              DARGDBP = ADDR(SETRC);                              0299
         LA    @14,SETRC                                           0299
         ST    @14,DARGDBP(,@15)                                   0299
*              DARGILP = LENGTH(SETRC);                            0300
         MVC   DARGILP(2,@15),@CH00147                             0300
*            END;                                                  0301
*                                                                  0301
*        CALL AMSTP011 (GDTTBL,                                    0302
*                PRTFILE,                                          0302
*                DDSTRU);                                          0302
@RC00289 L     @15,@PC00001                                        0302
         ST    @15,@AL00001                                        0302
         LA    @14,@CF00111                                        0302
         ST    @14,@AL00001+4                                      0302
         LA    @14,DDSTRU                                          0302
         ST    @14,@AL00001+8                                      0302
         MVI   @AL00001+8,X'80'                                    0302
         L     @15,GDTPRT(,@15)                                    0302
         LA    @01,@AL00001                                        0302
         BALR  @14,@15                                             0302
*        /************************************************************/
*        /*                                                          */
*        /* CLOSE USERS OUTPUT DATA SET IF IT IS NOT THE DEFAULT     */
*        /* AMS DATA SET. THE OUTPUT FILE IS CLOSED HERE TO ALLOW    */
*        /* FOR FINAL MESSAGES IF ERROR OCCURS IN CLOSE, LASTCC      */
*        /* IS SET TO 8                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0303
*        IF ADDR(OFILE) ^= NULLPTR & OUTIOCP ^= PRTFILE            0303
*          THEN                                                    0303
         SLR   @15,@15                                             0303
         L     @14,@PC00001+4                                      0303
         C     @15,FDTPTR+4(,@14)                                  0303
         BE    @RF00303                                            0303
         C     @15,OUTIOCP                                         0303
         BE    @RF00303                                            0303
*            DO;                                                   0304
*                                                                  0304
*              CALL IDCIOCL0 (GDTTBL,                              0305
*                      OUTIOCP);                                   0305
         L     @02,@PC00001                                        0305
         ST    @02,@AL00001                                        0305
         LA    @15,OUTIOCP                                         0305
         ST    @15,@AL00001+4                                      0305
         MVI   @AL00001+4,X'80'                                    0305
         L     @15,GDTCLS(,@02)                                    0305
         LA    @01,@AL00001                                        0305
         BALR  @14,@15                                             0305
*              RESPECIFY RTNREG RSTD;                              0306
*              TESTRC = RTNREG;                                    0307
         LR    TESTRC,RTNREG                                       0307
*              RESPECIFY RTNREG UNRSTD;                            0308
*              IF TESTRC ^= 0                                      0309
*                THEN                                              0309
         LTR   TESTRC,TESTRC                                       0309
         BZ    @RF00309                                            0309
*                  SETRC = MAX(SETRC,LASTCC08);                    0310
         LH    @15,SETRC                                           0310
         LA    @14,8                                               0310
         CR    @15,@14                                             0310
         BNL   *+6
         LR    @15,@14                                             0310
         STH   @15,SETRC                                           0310
*                ELSE;                                             0311
*                                                                  0311
@RF00309 DS    0H                                                  0312
*            END;                                                  0312
*          ELSE;                                                   0313
*                                                                  0313
@RF00303 DS    0H                                                  0314
*        /************************************************************/
*        /*                                                          */
*        /* FREE ALL STORAGE OBTAINED BY CHKLIST. SET FINAL CONDITION*/
*        /* CODE AND EXIT (UEPIL).                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0314
*        CALL IDCSAFP0 (GDTTBL,                                    0314
*                GPID00,                                           0314
*                ALL);                                             0314
         MVC   @AL00001+4(8),@AL00314                              0314
         L     @15,@PC00001                                        0314
         ST    @15,@AL00001                                        0314
         L     @15,GDTFPL(,@15)                                    0314
         LA    @01,@AL00001                                        0314
         BALR  @14,@15                                             0314
*        LASTCC = SETRC;                                           0315
*                                                                  0315
         L     @15,@PC00001+8                                      0315
         LH    @14,SETRC                                           0315
         STH   @14,LASTCC(,@15)                                    0315
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0316
*                                                                  0316
         L     @14,@PC00001                                        0316
         ST    @14,@AL00001                                        0316
         LA    @09,MODID                                           0316
         ST    @09,@AL00001+4                                      0316
         ST    @15,@AL00001+8                                      0316
         MVI   @AL00001+8,X'80'                                    0316
         L     @15,GDTEPL(,@14)                                    0316
         LA    @01,@AL00001                                        0316
         BALR  @14,@15                                             0316
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - HSKGPROC                                     */
*        /*                                                          */
*        /* FUNCTION - TO OPEN THE ALTERNATE OUTPUT FILE IF SPECIFIED*/
*        /*            TO OPEN THE CHECKPOINT DATA SET FOR INPUT     */
*        /*            TO ESTABLISH CHKLIST REPORT SUBTITLES         */
*        /*                                                          */
*        /* INPUT - CHKLIST COMMAND STATEMENT DATA                   */
*        /*                                                          */
*        /* OUTPUT - RETURN CODE TO SIGNIFY STATUS OF FUNCTIONS      */
*        /*          RCOR - FUNCTIONS WERE SUCCESSFUL                */
*        /*          LASTCC12 - OPEN ERROR                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0317
*HSKGPROC:                                                         0317
*        PROCEDURE;                                                0317
*                                                                  0317
@EL00001 L     @13,4(,@13)                                         0317
@EF00001 L     @00,@SIZDATD                                        0317
         LR    @01,@10                                             0317
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0317
         BR    @14                                                 0317
HSKGPROC STM   @14,@12,@SA00002                                    0317
*        /************************************************************/
*        /*                                                          */
*        /* SET UP OPEN ARGUMENT LIST FOR ALTERNATE OUTPUT DATA SET  */
*        /* IF SPECIFIED. IF OMITTED, THE STANDARD SYSPRINT FILE IS  */
*        /* USED. OUTPUT FILE IS OPENED IMMEDIATELY TO ALLOW FOR     */
*        /* SUBSEQUENT DIAGNOSTICS.                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0318
*        OLDERID2 = NEWERID2;                                      0318
         L     @15,@PC00001                                        0318
         L     @14,GDTTR2(,@15)                                    0318
         MVC   @TS00001(95),NEWERID2(@14)                          0318
         MVC   OLDERID2(95,@14),@TS00001                           0318
*        NEWID2 = 'CKHS';                                          0319
*                                                                  0319
         MVC   NEWID2(4,@14),@CC00769                              0319
*        IF ADDR(OFILE) ^= NULLPTR                                 0320
*          THEN                                                    0320
         L     @14,@PC00001+4                                      0320
         L     @14,FDTPTR+4(,@14)                                  0320
         LTR   @14,@14                                             0320
         BZ    @RF00320                                            0320
*            DO;                                                   0321
*              OTARGLST = ZEROAREA;                                0322
         MVC   OTARGLST(48),ZEROAREA                               0322
*              OPNPTR = ADDR(OTARGLST);                            0323
         LA    OPNPTR,OTARGLST                                     0323
*              OPNOPTOT = ON;                                      0324
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0324
*              OPNMODAC = ON;                                      0325
         OI    OPNMODAC(OPNPTR),B'01000000'                        0325
*              OPNIOC = ADDR(OUTIOCP);                             0326
         LA    @09,OUTIOCP                                         0326
         ST    @09,OPNIOC(,OPNPTR)                                 0326
*              OPNDDN = ADDR(OFILEVAL);                            0327
*                                                                  0327
         LA    @14,OFILEVAL(,@14)                                  0327
         ST    @14,OPNDDN(,OPNPTR)                                 0327
*              CALL IDCIOOP0 (GDTTBL,                              0328
*                     OTARGLST);                                   0328
         ST    @15,@AL00001                                        0328
         LA    @02,OTARGLST                                        0328
         ST    @02,@AL00001+4                                      0328
         MVI   @AL00001+4,X'80'                                    0328
         L     @15,GDTOPN(,@15)                                    0328
         LA    @01,@AL00001                                        0328
         BALR  @14,@15                                             0328
*              RESPECIFY RTNREG RSTD;                              0329
*              TESTRC = RTNREG;                                    0330
         LR    TESTRC,RTNREG                                       0330
*              RESPECIFY RTNREG UNRSTD;                            0331
*              IF TESTRC ^= 0                                      0332
*                THEN                                              0332
*                                                                  0332
         SLR   @02,@02                                             0332
         CR    TESTRC,@02                                          0332
         BE    @RF00332                                            0332
*                  /**************************************************/
*                  /*                                                */
*                  /* IF OPEN FOR ALTERNATE OUTPUT FILE FAILS  THE   */
*                  /* DEFAULT SYSPRINT IS USED                       */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0333
*                  DO;                                             0333
*                    OUTIOCP = PRTFILE;                            0334
         ST    @02,OUTIOCP                                         0334
*                    SETRC = MAX(SETRC,LASTCC04);                  0335
         LH    @15,SETRC                                           0335
         LA    @14,4                                               0335
         CR    @15,@14                                             0335
         BNL   *+6
         LR    @15,@14                                             0335
         STH   @15,SETRC                                           0335
*                  END;                                            0336
*                ELSE;                                             0337
@RF00332 DS    0H                                                  0338
*            END;                                                  0338
*                                                                  0338
*          ELSE                                                    0339
*            OUTIOCP = PRTFILE;        /* USE AMS SYSPRINT FILE      */
         B     @RC00320                                            0339
@RF00320 SLR   @15,@15                                             0339
         ST    @15,OUTIOCP                                         0339
*        /************************************************************/
*        /*                                                          */
*        /* SET UP OPEN ARGUMENT LIST FOR THE CHECKPOINT DATA SET    */
*        /* USED FOR INPUT. IT IS SET UP FOR UNDEFINED RECORDS       */
*        /* AND MAXIMUM BLOCKSIZE ONE LARGER THAN LENGTH OF CHR AND  */
*        /* DSDRS. IF PREVIOUS OPEN FAILED,TERMINATE                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0340
*        INIOCP = NULLPTR;                                         0340
@RC00320 SLR   @15,@15                                             0340
         ST    @15,INIOCP                                          0340
*        INARGLST = ZEROAREA;                                      0341
         MVC   INARGLST(48),ZEROAREA                               0341
*        OPNPTR = ADDR(INARGLST);                                  0342
         LA    OPNPTR,INARGLST                                     0342
*        OPNOPTIN = ON;                                            0343
*        OPNOPTBK = ON;                                            0344
         OI    OPNOPTIN(OPNPTR),B'10010000'                        0344
*        OPNRFMUN = ON;                                            0345
         OI    OPNRFMUN(OPNPTR),B'00100000'                        0345
*        OPNDSOPS = ON;                                            0346
         OI    OPNDSOPS(OPNPTR),B'01000000'                        0346
*        OPNIOC = ADDR(INIOCP);                                    0347
         LA    @15,INIOCP                                          0347
         ST    @15,OPNIOC(,OPNPTR)                                 0347
*        OPNDDN = ADDR(IFILEVAL);                                  0348
         L     @15,@PC00001+4                                      0348
         L     @01,FDTPTR(,@15)                                    0348
         LA    @15,IFILEVAL(,@01)                                  0348
         ST    @15,OPNDDN(,OPNPTR)                                 0348
*        OPNBLK = LENGTH(CHKPTREC) + 1; /*MAXIMUM BLOCK LENGTH PLUS 1*/
*                                                                  0349
         MVC   OPNBLK(4,OPNPTR),@CF00895                           0349
*        CALL IDCIOOP0 (GDTTBL,                                    0350
*               INARGLST);                                         0350
         L     @02,@PC00001                                        0350
         ST    @02,@AL00001                                        0350
         LA    @15,INARGLST                                        0350
         ST    @15,@AL00001+4                                      0350
         MVI   @AL00001+4,X'80'                                    0350
         L     @15,GDTOPN(,@02)                                    0350
         LA    @01,@AL00001                                        0350
         BALR  @14,@15                                             0350
*        RESPECIFY RTNREG RSTD;                                    0351
*        TESTRC = RTNREG;                                          0352
         LR    TESTRC,RTNREG                                       0352
*        RESPECIFY RTNREG UNRSTD;                                  0353
*        IF TESTRC ^= 0                                            0354
*          THEN                                                    0354
         LTR   TESTRC,TESTRC                                       0354
         BZ    @RF00354                                            0354
*            RETURN CODE (LASTCC12);                               0355
         LA    @15,12                                              0355
         L     @14,@SA00002                                        0355
         LM    @00,@12,@SA00002+8                                  0355
         BR    @14                                                 0355
*          ELSE                                                    0356
*            DO;                                                   0356
@RF00354 DS    0H                                                  0357
*              IOCSPTR = INIOCP;                                   0357
         L     @15,INIOCP                                          0357
         ST    @15,IOCSPTR                                         0357
*              SUBDSNAM = IOCDSN->INFDSNAM;      /*SAVE DSNAME       */
         L     @01,IOCDSN(,@15)                                    0358
         MVC   SUBDSNAM(44),INFDSNAM(@01)                          0358
*            END;                                                  0359
*        /************************************************************/
*        /*                                                          */
*        /* ESTABLISH SUBTITLE LINES BY READING THEM WITH UPRINT  AND*/
*        /* INITIALIZE AMS TEXT PROCESSOR WITH UESTA. TERMINATE IF   */
*        /* THERE IS PREVIOUS ERROR                                  */
*        /************************************************************/
*                                                                  0360
*        DARGSMOD = CK0ID;                                         0360
         L     @02,DDSTRU                                          0360
         MVC   DARGSMOD(3,@02),@CC00609                            0360
*        DARGSENT = CKST01;                                        0361
         MVI   DARGSENT(@02),X'01'                                 0361
*        DARGRETP = ADDR(SUBLNBUF);                                0362
         LA    @15,SUBLNBUF                                        0362
         ST    @15,DARGRETP(,@02)                                  0362
*        DARGRETL = LENGTH(SUBLNBUF);                              0363
*                                                                  0363
         MVC   DARGRETL(2,@02),@CH00896                            0363
*        /************************************************************/
*        /*                                                          */
*        /*       UPRINT TO GET HEADERS                USAVERC       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0364
*        CALL AMSTP011 (GDTTBL,                                    0364
*                OUTIOCP,                                          0364
*                DDSTRU);                                          0364
         L     @02,@PC00001                                        0364
         ST    @02,@AL00001                                        0364
         LA    @15,OUTIOCP                                         0364
         ST    @15,@AL00001+4                                      0364
         LA    @15,DDSTRU                                          0364
         ST    @15,@AL00001+8                                      0364
         MVI   @AL00001+8,X'80'                                    0364
         L     @15,GDTPRT(,@02)                                    0364
         LA    @01,@AL00001                                        0364
         BALR  @14,@15                                             0364
*        RESPECIFY RTNREG RSTD;                                    0365
*        TESTRC = RTNREG;                                          0366
         LR    TESTRC,RTNREG                                       0366
*        RESPECIFY RTNREG UNRSTD;                                  0367
*        SETRC = MAX(SETRC,TESTRC);                                0368
         LH    @02,SETRC                                           0368
         CR    @02,TESTRC                                          0368
         BNL   *+6
         LR    @02,TESTRC                                          0368
         STH   @02,SETRC                                           0368
*        DARGLIST = ZEROAREA;          /*CLEAR DARGLIST              */
*                                                                  0369
         L     @02,DDSTRU                                          0369
         MVC   DARGLIST(20,@02),ZEROAREA                           0369
*        /************************************************************/
*        /*                                                          */
*        /* SET UP PRINT CONTROL ARGUMENT LIST                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0370
*        CARRC1 = 2;                   /* SET FIRST LINE CARR CNTL   */
         MVI   CARRC1,X'02'                                        0370
*        SUBLNDS = SUBDSNAM;           /* MOVE IN DSNAME             */
         MVC   SUBLNDS(44),SUBDSNAM                                0371
*        PCARG = ZEROAREA;                                         0372
         MVC   PCARG(33),ZEROAREA                                  0372
*        PCSTLP = ADDR(SUBLINES);                                  0373
         LA    @02,SUBLINES                                        0373
         ST    @02,PCSTLP                                          0373
*        PCSTLC = 2;                                               0374
*                                                                  0374
         MVC   PCSTLC(2),@CH00147                                  0374
*        /************************************************************/
*        /*                                                          */
*        /*       UESTA TO SET UP HEADERS              USAVERC       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0375
*        CALL AMSTP042 (GDTTBL,                                    0375
*               OUTIOCP,                                           0375
*               PCARG);                                            0375
         L     @02,@PC00001                                        0375
         ST    @02,@AL00001                                        0375
         LA    @15,OUTIOCP                                         0375
         ST    @15,@AL00001+4                                      0375
         LA    @15,PCARG                                           0375
         ST    @15,@AL00001+8                                      0375
         L     @15,GDTESA(,@02)                                    0375
         LA    @01,@AL00001                                        0375
         BALR  @14,@15                                             0375
*        RESPECIFY RTNREG RSTD;                                    0376
*        TESTRC = RTNREG;                                          0377
         LR    TESTRC,RTNREG                                       0377
*        RESPECIFY RTNREG UNRSTD;                                  0378
*        SETRC = MAX(SETRC,TESTRC);                                0379
*                                                                  0379
         LH    @02,SETRC                                           0379
         CR    @02,TESTRC                                          0379
         BNL   *+6
         LR    @02,TESTRC                                          0379
         STH   @02,SETRC                                           0379
*        RETURN CODE (0);                                          0380
         SLR   @15,@15                                             0380
         L     @14,@SA00002                                        0380
         LM    @00,@12,@SA00002+8                                  0380
         BR    @14                                                 0380
*        END HSKGPROC;                                             0381
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - BUILDTAB (BDTABPTR,BDEOTPTR)                 */
*        /*                                                          */
*        /* FUNCTION - TO ACQUIRE SPACE FOR AND BUILD THE CHECKID    */
*        /*            TABLE. WHEN CHECKIDS ARE NOT SPECIFIED, SPACE */
*        /*            IS ACQUIRED FOR THE IDCOUNT AND IT IS SET     */
*        /*            TO NEGATIVE ONE TO SHOW USER WANTS ALL IDS    */
*        /*            PROCESSED.                                    */
*        /*                                                          */
*        /* INPUT - COMMAND STATEMENT DATA                           */
*        /*                                                          */
*        /* OUTPUT - CHECKID TABLE PTR AND CHECKID TABLE             */
*        /*          THE IDCOUNT FIELD OF THE CHECKID TABLE IS SET   */
*        /*          EQUAL TO CHKIDCNT IF CHECKID IS SPECIFIED OR TO */
*        /*          -1 IF CHECKID IS NOT SPECIFIED                  */
*        /*          IDCOUNT IS USED BY IDCCK01 TO CONTROL CHKLIST   */
*        /*          PROCESSING                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0382
*BUILDTAB:                                                         0382
*        PROCEDURE (BDTABPTR,                                      0382
*                   BDEOTPTR);                                     0382
*                                                                  0382
BUILDTAB STM   @14,@12,@SA00003                                    0382
         MVC   @PC00003(8),0(@01)                                  0382
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0383
*        DCL BDTABPTR  PTR(31);                  /*TABLE POINTER     */
*        DCL BDEOTPTR  PTR(31);                  /*END OF TABLE PTR  */
*        /************************************************************/
*        /*                                                          */
*        /* COMPUTE SPACE REQUIRED FOR THE CHECKID TABLE, AND BUILD  */
*        /* THE TABLE. CHECK THE TABLE FOR DUPLICATE ENTRIES. IF AN  */
*        /* ENTRY IS DUPLICATED, REMOVE THE DUPLICATE, AND ISSUE     */
*        /* A MESSAGE. TERMINATE ON PREVIOUS ERROR CONDITION.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0385
*        OLDERID2 = NEWERID2;                                      0385
         L     @15,@PC00001                                        0385
         L     @15,GDTTR2(,@15)                                    0385
         MVC   @TS00001(95),NEWERID2(@15)                          0385
         MVC   OLDERID2(95,@15),@TS00001                           0385
*        NEWID2 = 'CKBD';                                          0386
*                                                                  0386
         MVC   NEWID2(4,@15),@CC00777                              0386
*        IF ADDR(CHKID) ^= NULLPTR                                 0387
*          THEN                                                    0387
         L     @15,@PC00001+4                                      0387
         L     @15,FDTPTR+8(,@15)                                  0387
         LTR   @15,@15                                             0387
         BZ    @RF00387                                            0387
*            GPLEN = LENGTH(IDCOUNT) + LENGTH(IDTABLE) * CHKIDCNT; 0388
         LH    @15,CHKIDCNT(,@15)                                  0388
         MH    @15,@CH00893                                        0388
         AL    @15,@CF00147                                        0388
         ST    @15,GPLEN                                           0388
*          ELSE                                                    0389
*            GPLEN = LENGTH(IDCOUNT);                              0389
*                                                                  0389
         B     @RC00387                                            0389
@RF00387 MVC   GPLEN(4),@CF00147                                   0389
*        /************************************************************/
*        /*                                                          */
*        /*       UGPOOL FOR CHECKID TABLE            USAVERC        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0390
*        CALL IDCSAGP0 (GDTTBL,                                    0390
*                GPLEN,                                            0390
*                IDTABPTR,                                         0390
*                GPID00,                                           0390
*                SETZERO);                                         0390
@RC00387 L     @02,@PC00001                                        0390
         ST    @02,@AL00001                                        0390
         LA    @15,GPLEN                                           0390
         ST    @15,@AL00001+4                                      0390
         LA    @15,IDTABPTR                                        0390
         ST    @15,@AL00001+8                                      0390
         LA    @15,@CC00568                                        0390
         ST    @15,@AL00001+12                                     0390
         LA    @15,SETZERO                                         0390
         ST    @15,@AL00001+16                                     0390
         MVI   @AL00001+16,X'80'                                   0390
         L     @15,GDTGPL(,@02)                                    0390
         LA    @01,@AL00001                                        0390
         BALR  @14,@15                                             0390
*        RESPECIFY RTNREG RSTD;                                    0391
*        TESTRC = RTNREG;                                          0392
         LR    TESTRC,RTNREG                                       0392
*        RESPECIFY RTNREG UNRSTD;                                  0393
*        IF TESTRC ^= 0                                            0394
*          THEN                                                    0394
         LTR   TESTRC,TESTRC                                       0394
         BZ    @RF00394                                            0394
*            DO;                                                   0395
*                                                                  0395
*              /******************************************************/
*              /*                                                    */
*              /* PRINT INSUFFICIENT STORAGE MESSAGE AND             */
*              /* TERMINATE  UPRINT                                  */
*              /*                                                    */
*              /******************************************************/
*                                                                  0396
*                    DARGSMOD = UV0ID;                             0396
         L     @15,DDSTRU                                          0396
         MVC   DARGSMOD(3,@15),@CC00604                            0396
*                    DARGSENT = UVMSG04;                           0397
*                                                                  0397
         MVI   DARGSENT(@15),X'04'                                 0397
*              CALL AMSTP011 (GDTTBL,                              0398
*                      PRTFILE,                                    0398
*                      DDSTRU);                                    0398
*                                                                  0398
         L     @15,@PC00001                                        0398
         ST    @15,@AL00001                                        0398
         LA    @14,@CF00111                                        0398
         ST    @14,@AL00001+4                                      0398
         LA    @14,DDSTRU                                          0398
         ST    @14,@AL00001+8                                      0398
         MVI   @AL00001+8,X'80'                                    0398
         L     @15,GDTPRT(,@15)                                    0398
         LA    @01,@AL00001                                        0398
         BALR  @14,@15                                             0398
*              RETURN CODE (LASTCC12);                             0399
*                                                                  0399
         LA    @15,12                                              0399
         L     @14,@SA00003                                        0399
         LM    @00,@12,@SA00003+8                                  0399
         BR    @14                                                 0399
*            END;                                                  0400
*          ELSE                                                    0401
*            IDEOTPTR = IDTABPTR + GPLEN;   /*NOTE END OF TABLE      */
@RF00394 L     @15,IDTABPTR                                        0401
         AL    @15,GPLEN                                           0401
         ST    @15,IDEOTPTR                                        0401
*        /************************************************************/
*        /*                                                          */
*        /* IF USER HAS SELECTED CHKIDS, BUILD CHECKID TABLE AND     */
*        /* CHECK FOR DUPLICATES.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0402
*        IF ADDR(CHKID) ^= NULLPTR                                 0402
*          THEN                                                    0402
         L     @15,@PC00001+4                                      0402
         L     @15,FDTPTR+8(,@15)                                  0402
         LTR   @15,@15                                             0402
         BZ    @RF00402                                            0402
*BLDTAB:     DO;                                                   0403
BLDTAB   DS    0H                                                  0404
*              IDCOUNT = CHKIDCNT;                                 0404
         L     @03,IDTABPTR                                        0404
         L     @15,@PC00001+4                                      0404
         L     @01,FDTPTR+8(,@15)                                  0404
         LH    @15,CHKIDCNT(,@01)                                  0404
         STH   @15,IDCOUNT(,@03)                                   0404
*              IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);              0405
*                                                                  0405
         AL    @03,@CF00147                                        0405
         LR    IDTABWKP,@03                                        0405
*              /******************************************************/
*              /*                                                    */
*              /* BUILD THE TABLE                                    */
*              /*                                                    */
*              /******************************************************/
*                                                                  0406
*              DO I = 1 TO IDCOUNT;                                0406
         LA    I,1                                                 0406
         B     @DE00406                                            0406
@DL00406 DS    0H                                                  0407
*                IDFOUND = NO;                                     0407
         NI    IDFOUND(IDTABWKP),B'01111111'                       0407
*                IDCHKID = CHKIDVAL(I);                            0408
         LR    @05,I                                               0408
         MH    @05,@CH00897                                        0408
         L     @03,@PC00001+4                                      0408
         L     @03,FDTPTR+8(,@03)                                  0408
         ALR   @03,@05                                             0408
         AL    @03,@CF00905                                        0408
         MVC   IDCHKID(16,IDTABWKP),CHKIDVAL-3(@03)                0408
*                IDTABWKP = IDTABWKP + LENGTH(IDTABLE);            0409
         AL    IDTABWKP,@CF00893                                   0409
*              END;                                                0410
*                                                                  0410
         AL    I,@CF00213                                          0410
@DE00406 L     @05,IDTABPTR                                        0410
         CH    I,IDCOUNT(,@05)                                     0410
         BNH   @DL00406                                            0410
*              /******************************************************/
*              /*                                                    */
*              /* LOOK FOR DUPLICATE ENTRIES, REMOVE THE DUPLICATE   */
*              /* FROM THE TABLE, LEAVING THE FIRST FOUND IN THE     */
*              /* TABLE, AND ISSUE MESSAGE WITH UPRINT               */
*              /*                                                    */
*              /******************************************************/
*                                                                  0411
*              IF IDCOUNT > 1                                      0411
*                THEN                  /*CHK FOR DUPS FOR IDCOUNT > 1*/
         L     @01,IDTABPTR                                        0411
         LH    @15,IDCOUNT(,@01)                                   0411
         C     @15,@CF00213                                        0411
         BNH   @RF00411                                            0411
*CHKDUPS:          DO;                                             0412
CHKDUPS  DS    0H                                                  0413
*                    IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);        0413
*                                                                  0413
         LA    IDTABWKP,2                                          0413
         AL    IDTABWKP,IDTABPTR                                   0413
*                    /************************************************/
*                    /*                                              */
*                    /* LOOK FOR DUPLICATES BY MATCHING EACH TABLE   */
*                    /* ENTRY AGAINST EACH SUBSEQUENT TABLE ENTRY    */
*                    /*                                              */
*                    /************************************************/
*                                                                  0414
*CHKTAB1:            DO I = 1 TO IDCOUNT - 1;                      0414
CHKTAB1  LA    I,1                                                 0414
         B     @DE00414                                            0414
@DL00414 DS    0H                                                  0415
*                      IF IDFOUND = NO                             0415
*                        THEN                                      0415
         TM    IDFOUND(IDTABWKP),B'10000000'                       0415
         BNZ   @RF00415                                            0415
*                          DO;                                     0416
*                            IDNXTPTR = IDTABWKP + LENGTH(IDTABLE);
*                                                                  0417
         LA    IDNXTPTR,17                                         0417
         ALR   IDNXTPTR,IDTABWKP                                   0417
*                            /****************************************/
*                            /*                                      */
*                            /* MATCH ENTRY AGAINST EACH FOLLOWING   */
*                            /* TABLE ENTRY                          */
*                            /*                                      */
*                            /****************************************/
*                                                                  0418
*CHKTAB2:                    DO J = I TO IDCOUNT - 1;              0418
CHKTAB2  LR    J,I                                                 0418
         B     @DE00418                                            0418
@DL00418 DS    0H                                                  0419
*                              IF IDNXTPTR->IDFOUND ^= YES         0419
*                                THEN                              0419
         TM    IDFOUND(IDNXTPTR),B'10000000'                       0419
         BO    @RF00419                                            0419
*                                  IF IDCHKID = IDNXTPTR->IDCHKID  0420
*                                    THEN                          0420
*                                                                  0420
         CLC   IDCHKID(16,IDTABWKP),IDCHKID(IDNXTPTR)              0420
         BNE   @RF00420                                            0420
*                                      /******************************/
*                                      /*                            */
*                                      /*     * MARK ENTRY AS FOUND  */
*                                      /*       AND PRINT WITH UPRINT*/
*                                      /*                            */
*                                      /******************************/
*                                                                  0421
*                                      DO;                         0421
*                                        IDNXTPTR->IDFOUND = YES;  0422
         OI    IDFOUND(IDNXTPTR),B'10000000'                       0422
*                                        DARGSMOD = CK0ID;         0423
         L     @07,DDSTRU                                          0423
         MVC   DARGSMOD(3,@07),@CC00609                            0423
*                                        DARGSENT = CKST07;        0424
         MVI   DARGSENT(@07),X'07'                                 0424
*                                        DARGDBP = ADDR(IDCHKID);  0425
         LA    @15,IDCHKID(,IDTABWKP)                              0425
         ST    @15,DARGDBP(,@07)                                   0425
*                                        DARGILP = LENGTH(IDCHKID);
*                                                                  0426
         MVC   DARGILP(2,@07),@CH00465                             0426
*                                        CALL AMSTP011 (GDTTBL,    0427
*                                                OUTIOCP,          0427
*                                                DDSTRU);          0427
         L     @07,@PC00001                                        0427
         ST    @07,@AL00001                                        0427
         LA    @15,OUTIOCP                                         0427
         ST    @15,@AL00001+4                                      0427
         LA    @15,DDSTRU                                          0427
         ST    @15,@AL00001+8                                      0427
         MVI   @AL00001+8,X'80'                                    0427
         L     @15,GDTPRT(,@07)                                    0427
         LA    @01,@AL00001                                        0427
         BALR  @14,@15                                             0427
*                                        RESPECIFY RTNREG RSTD;    0428
*                                        TESTRC = RTNREG;          0429
         LR    TESTRC,RTNREG                                       0429
*                                        RESPECIFY RTNREG UNRSTD;  0430
*                                        SETRC = MAX(SETRC,TESTRC);
*                                                                  0431
         LH    @07,SETRC                                           0431
         CR    @07,TESTRC                                          0431
         BNL   *+6
         LR    @07,TESTRC                                          0431
         STH   @07,SETRC                                           0431
*                                      END;                        0432
*                                    ELSE;                         0433
@RF00420 DS    0H                                                  0434
*                                ELSE;                             0434
*                                                                  0434
@RF00419 DS    0H                                                  0435
*                              IDNXTPTR = IDNXTPTR + LENGTH(IDTABLE);
*                                                                  0435
         AL    IDNXTPTR,@CF00893                                   0435
*                            END CHKTAB2;        /* END INNER LOOP   */
*                                                                  0436
         AL    J,@CF00213                                          0436
@DE00418 L     @07,IDTABPTR                                        0436
         LH    @07,IDCOUNT(,@07)                                   0436
         BCTR  @07,0                                               0436
         CR    J,@07                                               0436
         BNH   @DL00418                                            0436
*                          END;                                    0437
*                        ELSE;                                     0438
*                                                                  0438
@RF00415 DS    0H                                                  0439
*                      IDTABWKP = IDTABWKP + LENGTH(IDTABLE);      0439
*                                                                  0439
         AL    IDTABWKP,@CF00893                                   0439
*                    END CHKTAB1;                /* END OUTER LOOP   */
*                                                                  0440
         AL    I,@CF00213                                          0440
@DE00414 L     @05,IDTABPTR                                        0440
         LH    @05,IDCOUNT(,@05)                                   0440
         BCTR  @05,0                                               0440
         CR    I,@05                                               0440
         BNH   @DL00414                                            0440
*                  END CHKDUPS;                                    0441
*                                                                  0441
*                ELSE;                 /*BYPASS DUP CHK FOR IDCOUNT=1*/
*                                                                  0442
@RF00411 DS    0H                                                  0443
*            END BLDTAB;                                           0443
*                                                                  0443
*          /**********************************************************/
*          /*                                                        */
*          /* WHEN NO CHECKIDS ARE SPECIFIED, IDCOUNT IS SET TO -1   */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0444
*          ELSE                                                    0444
*            IDCOUNT = -1;                                         0444
*                                                                  0444
         B     @RC00402                                            0444
@RF00402 L     @01,IDTABPTR                                        0444
         MVC   IDCOUNT(2,@01),@CH00786                             0444
*        RETURN CODE (0);                                          0445
@RC00402 SLR   @15,@15                                             0445
         L     @14,@SA00003                                        0445
         LM    @00,@12,@SA00003+8                                  0445
         BR    @14                                                 0445
*        END BUILDTAB;                                             0446
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - CHRPROC (CPSYSID,CPNEEDCH,CPCHRFND,CPEOF)    */
*        /*                                                          */
*        /* FUNCTION - TO PROCESS THE USER-SELECTED                  */
*        /*            CHR RECORDS FROM THE CHECKPOINT DATA SET. IF  */
*        /*            IDCOUNT IS NEGATIVE, ALL CHRS ARE CONSIDERED  */
*        /*            AS USER-SELECTED.                             */
*        /*                                                          */
*        /* INPUT - CHECKID TABLE                                    */
*        /*                                                          */
*        /* OUTPUT - CHRSYSID (VS1 OR VS2)                           */
*        /*          IDCOUNT IS DECREASED BY 1 WHEN USER-SELECTED    */
*        /*              CHR IS FOUND                                */
*        /*          CPEOF (EOF) IS SET TO 1 WHEN END OF FILE OCCURS */
*        /*          CHECKPOINT IDENTIFIER DETAIL LINE               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0447
*CHRPROC:                                                          0447
*        PROCEDURE (CPSYSID,                                       0447
*                   CPNEEDCH,                                      0447
*                   CPCHRFND,                                      0447
*                   CPEOF);                                        0447
*                                                                  0447
CHRPROC  STM   @14,@02,@SA00004                                    0447
         STM   @04,@12,@SA00004+20                                 0447
         MVC   @PC00004(16),0(@01)                                 0447
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0448
*        DCL CPSYSID   CHAR(1);                                    0448
*              /* CPSYSID (SYSID) IDENTIFIES THE SYSTEM ON WHICH THE */
*              /*    CHECKPOINT WAS TAKEN                            */
*        DCL CPNEEDCH  BIT(1)  BDY(BYTE);                          0449
*              /* CPNEEDCH (NEEDCHR) INDICATES WHETHER A CHR IS      */
*              /*    ALREADY IN THE BUFFER OR A READ IS NEEDED       */
*        DCL CPCHRFND  BIT(1)  BDY(BYTE);                          0450
*              /* CPCHRFND (CHRFND) IS TURNED ON WHEN A CHR IS FOUND */
*        DCL CPEOF     FIXED(15);                                  0451
*              /* CPEOF (EOF) END OF FILE CONTROL VARIABLE           */
*                                                                  0452
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLE                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0452
*        DCL USERSPEC  BIT(1) BDY(BYTE);                           0452
*        /************************************************************/
*        /*                                                          */
*        /* SET UP CONTROL SWITCH AND CHECKID TABLE WORK PTR         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0453
*        OLDERID2 = NEWERID2;                                      0453
         L     @02,@PC00001                                        0453
         L     @02,GDTTR2(,@02)                                    0453
         MVC   @TS00001(95),NEWERID2(@02)                          0453
         MVC   OLDERID2(95,@02),@TS00001                           0453
*        NEWID2 = 'CKCP';                                          0454
*                                                                  0454
         MVC   NEWID2(4,@02),@CC00799                              0454
*        USERSPEC = NO;                                            0455
         NI    USERSPEC,B'01111111'                                0455
*        /************************************************************/
*        /*                                                          */
*        /* LOOK FOR USER SPECIFIED CHR UNTIL ONE IS FOUND OR        */
*        /* END OF FILE OCCURS.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0456
*CHRPRC: DO WHILE (USERSPEC = NO & CPEOF = 0);                     0456
*                                                                  0456
CHRPRC   B     @DE00456                                            0456
@DL00456 DS    0H                                                  0457
*          /**********************************************************/
*          /*                                                        */
*          /* BYPASS READ IF CHR IS IN THE BUFFER, AND RESET         */
*          /* CPNEEDCH. CPCHRFND IS SET TO YES SINCE INDEED ONE      */
*          /* WAS FOUND.                                             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0457
*          IF CPNEEDCH = YES                                       0457
*            THEN                                                  0457
         L     @02,@PC00004+4                                      0457
         TM    CPNEEDCH(@02),B'10000000'                           0457
         BNO   @RF00457                                            0457
*              CALL GETCHR (CPCHRFND,                              0458
*                           CPEOF);                                0458
         L     @02,@PC00004+8                                      0458
         ST    @02,@AL00001                                        0458
         L     @02,@PC00004+12                                     0458
         ST    @02,@AL00001+4                                      0458
         LA    @01,@AL00001                                        0458
         BAL   @14,GETCHR                                          0458
*            ELSE                                                  0459
*              DO;                /* SET SWITCHES                    */
         B     @RC00457                                            0459
@RF00457 DS    0H                                                  0460
*                CPNEEDCH = YES;                                   0460
         L     @02,@PC00004+4                                      0460
         OI    CPNEEDCH(@02),B'10000000'                           0460
*                CPCHRFND = YES;                                   0461
         L     @02,@PC00004+8                                      0461
         OI    CPCHRFND(@02),B'10000000'                           0461
*              END;                                                0462
*                                                                  0462
*          IF CPEOF = 0                                            0463
*            THEN                                                  0463
*                                                                  0463
@RC00457 L     @02,@PC00004+12                                     0463
         LH    @02,CPEOF(,@02)                                     0463
         LTR   @02,@02                                             0463
         BNZ   @RF00463                                            0463
*DOCHRPC:     DO;                                                  0464
*                                                                  0464
DOCHRPC  DS    0H                                                  0465
*              IDTABWKP = IDTABPTR + LENGTH(IDCOUNT);              0465
         L     @15,IDTABPTR                                        0465
         LA    IDTABWKP,2                                          0465
         ALR   IDTABWKP,@15                                        0465
*              IF IDCOUNT < 0          /* USER SELECTS ALL CHECKIDS  */
*                THEN                                              0466
         LH    @15,IDCOUNT(,@15)                                   0466
         LTR   @15,@15                                             0466
         BNM   @RF00466                                            0466
*                  USERSPEC = YES;                                 0467
         OI    USERSPEC,B'10000000'                                0467
*                ELSE                                              0468
*                                                                  0468
*                  /**************************************************/
*                  /*                                                */
*                  /* SEARCH THE CHECKID TABLE FOR A MATCHING ENTRY  */
*                  /* TO THE CHECKID OF THE CHR. SET USERSPEC = YES  */
*                  /* IF A MATCH IS FOUND.                           */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0468
*CHKTAB:           DO WHILE (USERSPEC = NO & IDTABWKP < IDEOTPTR); 0468
         B     @RC00466                                            0468
@RF00466 DS    0H                                                  0468
CHKTAB   B     @DE00468                                            0468
@DL00468 DS    0H                                                  0469
*                    IF IDCHKID = CHRCHKID                         0469
*                      THEN                                        0469
*                                                                  0469
         L     @01,IOCSPTR                                         0469
         L     @15,IOCDAD(,@01)                                    0469
         CLC   IDCHKID(16,IDTABWKP),CHRCHKID(@15)                  0469
         BNE   @RF00469                                            0469
*                        DO;                                       0470
*                          USERSPEC = YES;                         0471
         OI    USERSPEC,B'10000000'                                0471
*                          IF IDFOUND = YES                        0472
*                            THEN                                  0472
*                                                                  0472
         TM    IDFOUND(IDTABWKP),B'10000000'                       0472
         BNO   @RF00472                                            0472
*                              DO;     /*PRINT DUPLICATE CHKPT ENTRY */
*                                DARGSMOD = CK0ID;                 0474
         L     @14,DDSTRU                                          0474
         MVC   DARGSMOD(3,@14),@CC00609                            0474
*                                DARGSENT = CKST08;                0475
         MVI   DARGSENT(@14),X'08'                                 0475
*                                DARGDBP  = ADDR(CHRCHKID);        0476
         LA    @15,CHRCHKID(,@15)                                  0476
         ST    @15,DARGDBP(,@14)                                   0476
*                                DARGILP  = LENGTH(CHRCHKID);      0477
*                                                                  0477
         MVC   DARGILP(2,@14),@CH00465                             0477
*                                CALL AMSTP011 (GDTTBL,            0478
*                                        PRTFILE,                  0478
*                                        DDSTRU);                  0478
         L     @15,@PC00001                                        0478
         ST    @15,@AL00001                                        0478
         LA    @14,@CF00111                                        0478
         ST    @14,@AL00001+4                                      0478
         LA    @14,DDSTRU                                          0478
         ST    @14,@AL00001+8                                      0478
         MVI   @AL00001+8,X'80'                                    0478
         L     @15,GDTPRT(,@15)                                    0478
         LA    @01,@AL00001                                        0478
         BALR  @14,@15                                             0478
*                                RESPECIFY RTNREG RSTD;            0479
*                                TESTRC = RTNREG;                  0480
         LR    TESTRC,RTNREG                                       0480
*                                RESPECIFY RTNREG UNRSTD;          0481
*                                SETRC = MAX(SETRC,TESTRC);        0482
         LH    @15,SETRC                                           0482
         CR    @15,TESTRC                                          0482
         BNL   *+6
         LR    @15,TESTRC                                          0482
         STH   @15,SETRC                                           0482
*                                DARGLIST = ZEROAREA;              0483
         L     @01,DDSTRU                                          0483
         MVC   DARGLIST(20,@01),ZEROAREA                           0483
*                              END;                                0484
*                                                                  0484
*                            ELSE                                  0485
*                              DO;     /*MARK TABLE ENTRY AS FOUND   */
         B     @RC00472                                            0485
@RF00472 DS    0H                                                  0486
*                                IDFOUND = YES;                    0486
         OI    IDFOUND(IDTABWKP),B'10000000'                       0486
*                                IDCOUNT = IDCOUNT - 1;            0487
         L     @15,IDTABPTR                                        0487
         LH    @14,IDCOUNT(,@15)                                   0487
         BCTR  @14,0                                               0487
         STH   @14,IDCOUNT(,@15)                                   0487
*                              END;                                0488
*                        END;                                      0489
*                      ELSE;                                       0490
*                                                                  0490
@RF00469 DS    0H                                                  0491
*                    IDTABWKP = IDTABWKP + LENGTH(IDTABLE);        0491
*                                                                  0491
@RC00469 AL    IDTABWKP,@CF00893                                   0491
*                  END CHKTAB;                                     0492
@DE00468 TM    USERSPEC,B'10000000'                                0492
         BNZ   @DC00468                                            0492
         C     IDTABWKP,IDEOTPTR                                   0492
         BL    @DL00468                                            0492
@DC00468 DS    0H                                                  0493
*              /******************************************************/
*              /*                                                    */
*              /* IF THIS CHR IS TO BE PROCESSED, LIST THE CHECKED   */
*              /* AND EXTRACT THE SYSTEM ID FROM THE CHR             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0493
*              IF USERSPEC = YES                                   0493
*                THEN                                              0493
@RC00466 TM    USERSPEC,B'10000000'                                0493
         BNO   @RF00493                                            0493
*                  DO;                                             0494
*                                                                  0494
*                    CPSYSID = CHRSYSID;    /*EXTRACT SYSID          */
*                                                                  0495
         L     @02,@PC00004                                        0495
         L     @01,IOCSPTR                                         0495
         L     @15,IOCDAD(,@01)                                    0495
         MVC   CPSYSID(1,@02),CHRSYSID(@15)                        0495
*                    DARGSMOD = CK0ID;      /* PRINT CHECKID         */
         L     @02,DDSTRU                                          0496
         MVC   DARGSMOD(3,@02),@CC00609                            0496
*                    DARGSENT = CKST02;                            0497
         MVI   DARGSENT(@02),X'02'                                 0497
*                    DARGDBP  = ADDR(CHRCHKID);                    0498
         LA    @15,CHRCHKID(,@15)                                  0498
         ST    @15,DARGDBP(,@02)                                   0498
*                    DARGILP  = LENGTH(CHRCHKID);                  0499
*                                                                  0499
         MVC   DARGILP(2,@02),@CH00465                             0499
*                    CALL AMSTP011 (GDTTBL,                        0500
*                            OUTIOCP,                              0500
*                            DDSTRU);                              0500
         L     @02,@PC00001                                        0500
         ST    @02,@AL00001                                        0500
         LA    @15,OUTIOCP                                         0500
         ST    @15,@AL00001+4                                      0500
         LA    @15,DDSTRU                                          0500
         ST    @15,@AL00001+8                                      0500
         MVI   @AL00001+8,X'80'                                    0500
         L     @15,GDTPRT(,@02)                                    0500
         LA    @01,@AL00001                                        0500
         BALR  @14,@15                                             0500
*                    RESPECIFY RTNREG RSTD;                        0501
*                    TESTRC = RTNREG;                              0502
         LR    TESTRC,RTNREG                                       0502
*                    RESPECIFY RTNREG UNRSTD;                      0503
*                    SETRC = MAX(SETRC,TESTRC);                    0504
         LH    @02,SETRC                                           0504
         CR    @02,TESTRC                                          0504
         BNL   *+6
         LR    @02,TESTRC                                          0504
         STH   @02,SETRC                                           0504
*                    DARGLIST = ZEROAREA;                          0505
*                                                                  0505
         L     @02,DDSTRU                                          0505
         MVC   DARGLIST(20,@02),ZEROAREA                           0505
*                  END;                                            0506
*                ELSE;                                             0507
*                                                                  0507
@RF00493 DS    0H                                                  0508
*             END DOCHRPC;                                         0508
*                                                                  0508
*            ELSE;             /*PAIRS 'THEN' AT 'DOCHRPC'           */
*                                                                  0509
@RF00463 DS    0H                                                  0510
*        END CHRPRC;                                               0510
*                                                                  0510
@DE00456 TM    USERSPEC,B'10000000'                                0510
         BNZ   @DC00456                                            0510
         L     @02,@PC00004+12                                     0510
         LH    @02,CPEOF(,@02)                                     0510
         LTR   @02,@02                                             0510
         BZ    @DL00456                                            0510
@DC00456 DS    0H                                                  0511
*        RETURN CODE (0);                                          0511
         SLR   @15,@15                                             0511
         L     @14,@SA00004                                        0511
         LM    @00,@02,@SA00004+8                                  0511
         LM    @04,@12,@SA00004+20                                 0511
         BR    @14                                                 0511
*        END CHRPROC;                                              0512
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - GETCHR (GCCHRFND,GCEOF)                      */
*        /*                                                          */
*        /* FUNCTION - TO READ THE CHECKPOINT DATA SET UNTIL A       */
*        /*            CHR IS FOUND OR END-OF-FILE OCCURS            */
*        /*                                                          */
*        /* INPUT - CHECKPOINT DATA SET                              */
*        /*                                                          */
*        /* OUTPUT - POINTER TO CHR RECORD (IN IOCSTR)               */
*        /*          GCCHRFND (CHRFND) INDICATOR THAT CHR FOUND      */
*        /*          GCEOF (EOF) END OF FILE INDICATOR               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0513
*GETCHR:                                                           0513
*        PROCEDURE (GCCHRFND,                                      0513
*                   GCEOF);                                        0513
*                                                                  0513
GETCHR   STM   @14,@02,@SA00005                                    0513
         STM   @04,@12,@SA00005+20                                 0513
         MVC   @PC00005(8),0(@01)                                  0513
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0514
*        DCL GCCHRFND  BIT(1) BDY(BYTE);                           0514
*              /* GCCHRFND (CHRFND) IS TURNED ON WHEN A CHR IS FOUND */
*        DCL GCEOF     FIXED(15);                                  0515
*              /* GCEOF (EOF) IS SET TO 1 AT END OF FILE             */
*                                                                  0516
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0516
*        DCL GCSTOP    BIT(1) BDY(BYTE);    /*READ CONTROL SWITCH    */
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE CONTROL SWITCH                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0517
*        OLDERID2 = NEWERID2;                                      0517
         L     @02,@PC00001                                        0517
         L     @02,GDTTR2(,@02)                                    0517
         MVC   @TS00001(95),NEWERID2(@02)                          0517
         MVC   OLDERID2(95,@02),@TS00001                           0517
*        NEWID2 = 'CKGC';                                          0518
*                                                                  0518
         MVC   NEWID2(4,@02),@CC00815                              0518
*        GCSTOP = NO;                                              0519
*                                                                  0519
         NI    GCSTOP,B'01111111'                                  0519
*        /************************************************************/
*        /*                                                          */
*        /* READ CHECKPOINT DATASET UNTIL A CHR IS FOUND OR          */
*        /* END OF FILE OCCURS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0520
*GETCH:  DO WHILE (GCSTOP = NO & GCEOF = 0);                       0520
*                                                                  0520
GETCH    B     @DE00520                                            0520
@DL00520 DS    0H                                                  0521
*          /**********************************************************/
*          /*                                                        */
*          /* READ CHECKPOINT DATA SET                               */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0521
*          IOCDLN = LENGTH(CHKPTREC) + 1;                          0521
*                                                                  0521
         L     @02,IOCSPTR                                         0521
         MVC   IOCDLN(4,@02),@CF00895                              0521
*          CALL IDCIOGT0 (GDTTBL,                                  0522
*                INIOCP);                                          0522
         L     @02,@PC00001                                        0522
         ST    @02,@AL00001                                        0522
         LA    @15,INIOCP                                          0522
         ST    @15,@AL00001+4                                      0522
         MVI   @AL00001+4,X'80'                                    0522
         L     @15,GDTGET(,@02)                                    0522
         LA    @01,@AL00001                                        0522
         BALR  @14,@15                                             0522
*          RESPECIFY RTNREG RSTD;                                  0523
*          TESTRC = RTNREG;                                        0524
         LR    TESTRC,RTNREG                                       0524
*          RESPECIFY RTNREG UNRSTD;                                0525
*                                                                  0525
*          IF TESTRC = 4                                           0526
*            THEN                                                  0526
         C     TESTRC,@CF00041                                     0526
         BNE   @RF00526                                            0526
*              DO;                     /*ON I/O ERROR SET EOF COND   */
*                GCEOF = EOFCOND;                                  0528
         L     @02,@PC00005+4                                      0528
         MVC   GCEOF(2,@02),@CH00213                               0528
*                RETURN CODE (LASTCC12);                           0529
         LA    @15,12                                              0529
         L     @14,@SA00005                                        0529
         LM    @00,@02,@SA00005+8                                  0529
         LM    @04,@12,@SA00005+20                                 0529
         BR    @14                                                 0529
*              END;                                                0530
*            ELSE;                                                 0531
*                                                                  0531
@RF00526 DS    0H                                                  0532
*          IF TESTRC = 16              /*CHECK FOR END OF FILE       */
*            THEN                                                  0532
         C     TESTRC,@CF00465                                     0532
         BNE   @RF00532                                            0532
*              GCEOF = EOFCOND;        /*SET EOFCOND AND DROP TO END */
         L     @02,@PC00005+4                                      0533
         MVC   GCEOF(2,@02),@CH00213                               0533
*                                      /*OF THIS LOOP                */
*            ELSE                                                  0534
*                                                                  0534
*              /******************************************************/
*              /*                                                    */
*              /* THE RECORD IS A CHR IF IT HAS THE FOLLOWING ID:    */
*              /* '$$/%@/$ CHR %@/$//%' AND IS 400 BYTES LONG        */
*              /*                                                    */
*              /******************************************************/
*                                                                  0534
*              IF IOCDLN   = LENGTH(CHR)  &                        0534
*                 CHRIDENT = CHRID                                 0534
*                THEN                                              0534
*                                                                  0534
         B     @RC00532                                            0534
@RF00532 L     @02,IOCSPTR                                         0534
         CLC   IOCDLN(4,@02),@CF00894                              0534
         BNE   @RF00534                                            0534
         L     @02,IOCDAD(,@02)                                    0534
         CLC   CHRIDENT(19,@02),@CC00644                           0534
         BNE   @RF00534                                            0534
*                  DO;                                             0535
*                    GCCHRFND = YES;   /*NOTE THAT DATA SET HAD A CHR*/
         L     @02,@PC00005                                        0536
         OI    GCCHRFND(@02),B'10000000'                           0536
*                    GCSTOP   = YES;   /*STOP THE LOOP               */
         OI    GCSTOP,B'10000000'                                  0537
*                  END;                                            0538
*                                                                  0538
*                ELSE;                                             0539
@RF00534 DS    0H                                                  0540
*        END GETCH;                                                0540
*                                                                  0540
@RC00532 DS    0H                                                  0540
@DE00520 TM    GCSTOP,B'10000000'                                  0540
         BNZ   @DC00520                                            0540
         L     @02,@PC00005+4                                      0540
         LH    @02,GCEOF(,@02)                                     0540
         LTR   @02,@02                                             0540
         BZ    @DL00520                                            0540
@DC00520 DS    0H                                                  0541
*        RETURN CODE (0);                                          0541
         SLR   @15,@15                                             0541
         L     @14,@SA00005                                        0541
         LM    @00,@02,@SA00005+8                                  0541
         LM    @04,@12,@SA00005+20                                 0541
         BR    @14                                                 0541
*        END GETCHR;                                               0542
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - DSDRPROC (DPNEEDCH,DPEOF)                    */
*        /*                                                          */
*        /* FUNCTION - TO PREPARE AND PRINT INFORMATION REGARDING    */
*        /*            OPEN TAPE DATA SETS FOR THE CURRENT CHECKPOINT*/
*        /*            ENTRY.                                        */
*        /*                                                          */
*        /*            INVOKES - GETNEXT     FOR NEXT LOGICAL RECORD */
*        /*                      DSDRVOLS    WHEN ADDITIONAL VOLUMES */
*        /*                                  ARE PRESENT             */
*        /*                      DSDRLIST    TO LIST VOLUMES         */
*        /*                                                          */
*        /* INPUT - THE SYSID                                        */
*        /*         CHECKPOINT DATA SET                              */
*        /*                                                          */
*        /* OUTPUT - TAPE DATA SET DETAIL LINE                       */
*        /*          VOLUME INFO DETAIL LINES                        */
*        /*              DETAIL LINES APPEAR ON OUTPUT PRINT FILE    */
*        /*          NEEDCHR CONTROL INFO                            */
*        /*          DPEOF (EOF) END OF FILE INDICATOR               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0543
*DSDRPROC:                                                         0543
*        PROCEDURE (DPNEEDCH,                                      0543
*                   DPEOF);                                        0543
*                                                                  0543
DSDRPROC STM   @14,@12,@SA00006                                    0543
         MVC   @PC00006(8),0(@01)                                  0543
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0544
*        DCL DPNEEDCH  BIT(1) BDY(BYTE);    /*NEEDCHR SWITCH         */
*        DCL DPEOF     FIXED(15);           /*END-OF-FILE VARIABLE   */
*                                                                  0545
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0546
*        DCL LOGRECP   PTR(31);             /*LOGICAL RECORD POINTER */
*        DCL SIZE      FIXED(31);           /*SIZE OF LAST RECORD    */
*        DCL DSDR1LNG  FIXED(31);           /*LENGTH OF DSDR-1       */
*        DCL DSDR1FND  BIT(1) BDY(BYTE);    /*SW FOR TAPE DSDR FOUND */
*        DCL VLSQMSG   BIT(1) BDY(BYTE);    /*SW FOR VOLSEQ ERR MSG  */
*        DCL GETNXTSW  BIT(1) BDY(BYTE);    /*SW FOR GET NXT LOGREC  */
*        DCL NVOLS     FIXED(15);           /*NUMBER OF VOLUMES      */
*        DCL VOLSEQ    FIXED(15);           /*VOLUME SEQUENCE NUMBER */
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE DSDR1LNG FOR VS1 OR VS2 AND CONTROL VARIABLES */
*        /*                                                          */
*        /************************************************************/
*                                                                  0554
*        OLDERID2 = NEWERID2;                                      0554
         L     @02,@PC00001                                        0554
         L     @02,GDTTR2(,@02)                                    0554
         MVC   @TS00001(95),NEWERID2(@02)                          0554
         MVC   OLDERID2(95,@02),@TS00001                           0554
*        NEWID2 = 'CKDP';                                          0555
*                                                                  0555
         MVC   NEWID2(4,@02),@CC00833                              0555
*        IF SYSIDVS1 = '1'B                                        0556
*          THEN                                                    0556
         TM    SYSIDVS1,B'00100000'                                0556
         BNO   @RF00556                                            0556
*            DSDR1LNG = VS1DSDR1;                                  0557
         LA    DSDR1LNG,191                                        0557
*          ELSE                                                    0558
*            DSDR1LNG = VS2DSDR1;                                  0558
*                                                                  0558
         B     @RC00556                                            0558
@RF00556 LA    DSDR1LNG,195                                        0558
*        SIZE = 0;                                                 0559
@RC00556 SLR   @04,@04                                             0559
         ST    @04,SIZE                                            0559
*        LOGRECP = NULLPTR;                                        0560
         ST    @04,LOGRECP                                         0560
*        DSDR1FND = NO;                                            0561
         NI    DSDR1FND,B'01111111'                                0561
*        GETNXTSW = YES;                                           0562
*                                                                  0562
         OI    GETNXTSW,B'10000000'                                0562
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS DSDR RECORDS UNTIL END OF FILE OR END OF ENTRY   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0563
*START:  DO WHILE (DPEOF = 0);                                     0563
*                                                                  0563
START    B     @DE00563                                            0563
@DL00563 DS    0H                                                  0564
*          /**********************************************************/
*          /*                                                         *
*          /* GETNXTSW IS SET TO NO BY DSDRVOLS WHEN A DSDR2 IS      */
*          /* EXPECTED BUT NOT FOUND. IT PREVENTS BYPASSING A GOOD   */
*          /* CHECKPOINT DATA SET RECORD ALREADY IN A BUFFER         */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0564
*          IF GETNXTSW = YES                                       0564
*            THEN                                                  0564
         TM    GETNXTSW,B'10000000'                                0564
         BNO   @RF00564                                            0564
*              DO;                                                 0565
*                CALL GETNEXT (LOGRECP,                            0566
*                              SIZE,                               0566
*                              DPNEEDCH,                           0566
*                              DPEOF);                             0566
         LA    @04,LOGRECP                                         0566
         ST    @04,@AL00001                                        0566
         LA    @04,SIZE                                            0566
         ST    @04,@AL00001+4                                      0566
         L     @04,@PC00006                                        0566
         ST    @04,@AL00001+8                                      0566
         L     @04,@PC00006+4                                      0566
         ST    @04,@AL00001+12                                     0566
         LA    @01,@AL00001                                        0566
         BAL   @14,GETNEXT                                         0566
*                RESPECIFY RTNREG RSTD;                            0567
*                TESTRC = RTNREG;                                  0568
         LR    TESTRC,RTNREG                                       0568
*                RESPECIFY RTNREG UNRSTD;                          0569
*                SETRC = MAX(SETRC,TESTRC);                        0570
         LH    @04,SETRC                                           0570
         CR    @04,TESTRC                                          0570
         BNL   *+6
         LR    @04,TESTRC                                          0570
         STH   @04,SETRC                                           0570
*              END;                                                0571
*            ELSE                                                  0572
*              GETNXTSW = YES;                                     0572
*                                                                  0572
         B     @RC00564                                            0572
@RF00564 OI    GETNXTSW,B'10000000'                                0572
*          /**********************************************************/
*          /*                                                        */
*          /*  IF NEXT LOGICAL RECORD IS AVAILABLE (NEITHER END OF   */
*          /*  FILE OR END OF ENTRY OCCURED) PROCEDE.                */
*          /* IN THE SEARCH FOR DSDR1 RECORDS, DDNT BLOCKS (VS2 ONLY)*/
*          /* ARE BYPASSED, AND NEW BLOCKS ARE READ WHEN EITHER THE  */
*          /* END-OF-BLOCK OR END-OF-DSDRS IS FOUND. TYPE 3 DSDR     */
*          /* RECORDS OR NON-DSDR RECORDS WILL TRIGGER END-OF-ENTRY. */
*          /*                                                        */
*          /**********************************************************/
*          IF DPEOF = 0                                            0573
*            THEN                                                  0573
*                                                                  0573
@RC00564 L     @04,@PC00006+4                                      0573
         LH    @04,DPEOF(,@04)                                     0573
         LTR   @04,@04                                             0573
         BNZ   @RF00573                                            0573
*NOEOF:        DO;                                                 0574
*                                                                  0574
NOEOF    DS    0H                                                  0575
*                IF GDTDBG = NULLPTR                               0575
*                  THEN;                                           0575
         L     @04,@PC00001                                        0575
         L     @04,GDTDBG(,@04)                                    0575
         LTR   @04,@04                                             0575
         BZ    @RT00575                                            0575
*                  ELSE                                            0577
*                    CALL IDCDB010 (GDTTBL,'CK30');                0577
*                                                                  0577
         L     @04,@PC00001                                        0577
         ST    @04,@AL00001                                        0577
         LA    @02,@CC00839                                        0577
         ST    @02,@AL00001+4                                      0577
         MVI   @AL00001+4,X'80'                                    0577
         L     @15,GDTDBG(,@04)                                    0577
         LA    @01,@AL00001                                        0577
         BALR  @14,@15                                             0577
*                DSDR1PTR = LOGRECP;        /*GET ADDRESSABILITY     */
@RT00575 L     DSDR1PTR,LOGRECP                                    0578
*                IF DSDRTYPE ^= DSDR1                              0579
*                  THEN                                            0579
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00673                       0579
         BE    @RF00579                                            0579
*                    DO;                                           0580
*                      IF DSDRTYPE = DSDREOB                      0581
*                         DSDRTYPE = DDNT                         0581
*                         DSDRTYPE = DSDREND                       0581
*                        THEN                    /*END OF BLOCK-GET  */
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00677                       0581
         BE    @RT00581                                            0581
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00671                       0581
         BE    @RT00581                                            0581
         CLC   DSDRTYPE(2,DSDR1PTR),@CB00679                       0581
         BNE   @RF00581                                            0581
@RT00581 DS    0H                                                  0582
*                          LOGRECP = NULLPTR;    /*NEXT BLOCK        */
         SLR   @04,@04                                             0582
         ST    @04,LOGRECP                                         0582
*                        ELSE                                      0583
*                          IF DSDRTYPE = DSDR2                     0583
*                            THEN                                  0583
         B     @RC00581                                            0583
@RF00581 CLC   DSDRTYPE(2,DSDR1PTR),@CB00675                       0583
         BNE   @RF00583                                            0583
*                              SIZE = LENGTH(DSDR2REC);            0584
         MVC   SIZE(4),@CF00718                                    0584
*                            ELSE                                  0585
*                              DO;                                 0585
         B     @RC00583                                            0585
@RF00583 DS    0H                                                  0586
*                                DPEOF = EOECOND;                  0586
         L     @04,@PC00006+4                                      0586
         MVC   DPEOF(2,@04),@CH00147                               0586
*                                LOGRECP = NULLPTR;                0587
         SLR   @04,@04                                             0587
         ST    @04,LOGRECP                                         0587
*                              END;                                0588
*                    END;                                          0589
*                                                                  0589
*                  ELSE                                            0590
*                                                                  0590
*                    /************************************************/
*                    /*                                              */
*                    /* TYPE 1 DSDR PROCESSING:                      */
*                    /*    EXTRACT DSNAME, DDNAME, UNIT TYPE, NUMBER */
*                    /*    OF TRACKS, VOLUME SEQUENCE NUMBER, AND    */
*                    /*    THE FIRST FIVE VOLUME SERIAL NUMBERS FROM */
*                    /*    THE DSDR1.  IF A DSDR2 (JFCBX) IS NEEDED  */
*                    /*    CALL DSDRVOLS FOR REQUIRED PROCESSING.    */
*                    /*                                              */
*                    /************************************************/
*                                                                  0590
*DSDR1PC:            DO;                                           0590
         B     @RC00579                                            0590
@RF00579 DS    0H                                                  0590
DSDR1PC  DS    0H                                                  0591
*                      SIZE = DSDR1LNG;                            0591
         ST    DSDR1LNG,SIZE                                       0591
*                      IF UCBTBYT3 = TAPECODE                      0592
*                        THEN                                      0592
         CLI   UCBTBYT3(DSDR1PTR),X'80'                            0592
         BNE   @RF00592                                            0592
*DSDR1TP:                  DO;         /*FOR TAPE DSDR1 PROCESS INFO */
*                                                                  0593
DSDR1TP  DS    0H                                                  0594
*                            IF GDTDBG = NULLPTR                   0594
*                              THEN;                               0594
         L     @04,@PC00001                                        0594
         L     @04,GDTDBG(,@04)                                    0594
         LTR   @04,@04                                             0594
         BZ    @RT00594                                            0594
*                              ELSE                                0596
*                                CALL IDCDB010 (GDTTBL,'CK40');    0596
*                                                                  0596
         L     @04,@PC00001                                        0596
         ST    @04,@AL00001                                        0596
         LA    @03,@CC00844                                        0596
         ST    @03,@AL00001+4                                      0596
         MVI   @AL00001+4,X'80'                                    0596
         L     @15,GDTDBG(,@04)                                    0596
         LA    @01,@AL00001                                        0596
         BALR  @14,@15                                             0596
*                            /****************************************/
*                            /*                                      */
*                            /* EXTRACT DATA SET INFO AND LIST. SAVE */
*                            /* DDNAME FOR POSSIBLE ERROR MSGS       */
*                            /*                                      */
*                            /****************************************/
*                                                                  0597
*                            DSDR1FND = YES;                       0597
@RT00594 OI    DSDR1FND,B'10000000'                                0597
*                            TDSNAME = JFCBDSNM;                   0598
         MVC   TDSNAME(44),JFCBDSNM(DSDR1PTR)                      0598
*                            TDDNAME = DSDRDDNM;                   0599
         MVC   TDDNAME(8),DSDRDDNM(DSDR1PTR)                       0599
*                            MSGDDNAM = DSDRDDNM;                  0600
         MVC   MSGDDNAM(8),DSDRDDNM(DSDR1PTR)                      0600
*                            IF UCBTBYT4 = U2400 /* DECODE UNIT TYPE */
*                              THEN                                0601
         CLI   UCBTBYT4(DSDR1PTR),X'01'                            0601
         BNE   @RF00601                                            0601
*                                TUNIT = T2400;                    0602
         MVC   TUNIT(4),@CC00661                                   0602
*                              ELSE                                0603
*                                IF UCBTBYT4 = U3400               0603
*                                  THEN                            0603
         B     @RC00601                                            0603
@RF00601 CLI   UCBTBYT4(DSDR1PTR),X'03'                            0603
         BNE   @RF00603                                            0603
*                                    TUNIT = T3400;                0604
         MVC   TUNIT(4),@CC00663                                   0604
*                                 ELSE                             0605
*                                    TUNIT = FILLER;  /*UNKNOWN UNIT */
         B     @RC00603                                            0605
@RF00603 MVC   TUNIT(4),@CC00665                                   0605
*                            IF UCB7TRK = '1'B                     0606
*                              THEN                                0606
@RC00603 DS    0H                                                  0606
@RC00601 TM    UCB7TRK(DSDR1PTR),B'10000000'                       0606
         BNO   @RF00606                                            0606
*                                TTRK = STRK;    /* 7 TRK            */
         MVC   TTRK(5),@CC00659                                    0607
*                              ELSE                                0608
*                                TTRK = NTRK;    /* 9 TRK            */
*                                                                  0608
         B     @RC00606                                            0608
@RF00606 MVC   TTRK(5),@CC00657                                    0608
*                            IF SYSIDVS1 = '1'B  /*GET VOLSEQ        */
*                              THEN                                0609
@RC00606 TM    SYSIDVS1,B'00100000'                                0609
         BNO   @RF00609                                            0609
*                                DO;                               0610
*                                  TVLSQ = VS1DVLSQ;               0611
         SLR   @04,@04                                             0611
         IC    @04,VS1DVLSQ(,DSDR1PTR)                             0611
         STC   @04,TVLSQ                                           0611
*                                  VOLSEQ = VS1DVLSQ;              0612
         STH   @04,VOLSEQ                                          0612
*                                END;                              0613
*                              ELSE                                0614
*                                DO;                               0614
         B     @RC00609                                            0614
@RF00609 DS    0H                                                  0615
*                                  TVLSQ = VS2DVLSQ;               0615
         SLR   @04,@04                                             0615
         IC    @04,VS2DVLSQ(,DSDR1PTR)                             0615
         STC   @04,TVLSQ                                           0615
*                                  VOLSEQ = VS2DVLSQ;              0616
         STH   @04,VOLSEQ                                          0616
*                                END;                              0617
*                                                                  0617
*                            NVOLS = JFCBNVOL;   /*GET NUM OF VOLUMES*/
@RC00609 SLR   @04,@04                                             0618
         IC    @04,JFCBNVOL(,DSDR1PTR)                             0618
         STH   @04,NVOLS                                           0618
*                            TNVOL = JFCBNVOL;                     0619
         STC   @04,TNVOL                                           0619
*                            IF NVOLS < VOLSEQ                     0620
*                              THEN                                0620
         CH    @04,VOLSEQ                                          0620
         BNL   @RF00620                                            0620
*                                VLSQMSG = YES;  /*SET SW FOR ERR MSG*/
         OI    VLSQMSG,B'10000000'                                 0621
*                              ELSE                                0622
*                                VLSQMSG = NO;                     0622
         B     @RC00620                                            0622
@RF00620 NI    VLSQMSG,B'01111111'                                 0622
*                            /****************************************/
*                            /*                                      */
*                            /* PRINT DATA SET INFO                  */
*                            /*                                      */
*                            /****************************************/
*                                                                  0623
*                            DARGSMOD = CK0ID;                     0623
@RC00620 L     @04,DDSTRU                                          0623
         MVC   DARGSMOD(3,@04),@CC00609                            0623
*                            DARGSENT = CKST03;                    0624
         MVI   DARGSENT(@04),X'03'                                 0624
*                            DARGDBP  = ADDR(TDSINFO);             0625
         LA    @15,TDSINFO                                         0625
         ST    @15,DARGDBP(,@04)                                   0625
*                            DARGILP  = LENGTH(TDSINFO);           0626
*                                                                  0626
         MVC   DARGILP(2,@04),@CH00898                             0626
*                            CALL AMSTP011 (GDTTBL,                0627
*                                    OUTIOCP,                      0627
*                                    DDSTRU);                      0627
         L     @04,@PC00001                                        0627
         ST    @04,@AL00001                                        0627
         LA    @15,OUTIOCP                                         0627
         ST    @15,@AL00001+4                                      0627
         LA    @15,DDSTRU                                          0627
         ST    @15,@AL00001+8                                      0627
         MVI   @AL00001+8,X'80'                                    0627
         L     @15,GDTPRT(,@04)                                    0627
         LA    @01,@AL00001                                        0627
         BALR  @14,@15                                             0627
*                            RESPECIFY RTNREG RSTD;                0628
*                            TESTRC = RTNREG;                      0629
         LR    TESTRC,RTNREG                                       0629
*                            RESPECIFY RTNREG UNRSTD;              0630
*                            SETRC = MAX(SETRC,TESTRC);            0631
*                                                                  0631
         LH    @04,SETRC                                           0631
         CR    @04,TESTRC                                          0631
         BNL   *+6
         LR    @04,TESTRC                                          0631
         STH   @04,SETRC                                           0631
*                            /****************************************/
*                            /*                                      */
*                            /* EXTRACT VOLUME INFO FROM DSDR1 AND   */
*                            /* PRINT THE 5 (MAX) VOLUMES FROM THE   */
*                            /* DSDR1                                */
*                            /* WHEN NO VOLUMES ARE IN THE JFCB THE  */
*                            /* PRINT BLOCK IS BYPASSED. NO VOLUMES  */
*                            /* IS INDICATED BY '00'X OR 'FF'X IN THE*/
*                            /* JFCB.                                */
*                            /*                                      */
*                            /****************************************/
*                                                                  0632
*                            IF NVOLS     > 0     &   /*BYPASS NO VOL*/
*                               JVOLBYT1(1) ^= '00'X &             0632
*                               JVOLBYT1(1) ^= 'FF'X               0632
*                              THEN                                0632
*                                                                  0632
         LH    @04,NVOLS                                           0632
         LTR   @04,@04                                             0632
         BNP   @RF00632                                            0632
         CLI   JVOLBYT1(DSDR1PTR),X'00'                            0632
         BE    @RF00632                                            0632
         CLI   JVOLBYT1(DSDR1PTR),X'FF'                            0632
         BE    @RF00632                                            0632
*GETVOLS:                        DO;                               0633
GETVOLS  DS    0H                                                  0634
*                                  TVOLINFO = BLANKS;              0634
         MVC   TVOLINFO(35),BLANKS                                 0634
*                                  DO I = 1 TO PVOLLIM             0635
*                                           WHILE(NVOLS > 0);      0635
         LA    I,1                                                 0635
@DL00635 LH    @03,NVOLS                                           0635
         LTR   @03,@03                                             0635
         BNP   @DC00635                                            0635
*                                    TVOL(I) = JFCBVOL(I);         0636
         LR    @15,I                                               0636
         MH    @15,@CH00617                                        0636
         LA    @14,TVOL-7(@15)                                     0636
         LR    @15,I                                               0636
         MH    @15,@CH00150                                        0636
         ALR   @15,DSDR1PTR                                        0636
         MVC   0(6,@14),JFCBVOL-6(@15)                             0636
*                                    NVOLS = NVOLS - 1;            0637
         BCTR  @03,0                                               0637
         STH   @03,NVOLS                                           0637
*                                  END;                            0638
*                                                                  0638
         AL    I,@CF00213                                          0638
         C     I,@CF00266                                          0638
         BNH   @DL00635                                            0638
@DC00635 DS    0H                                                  0639
*                                  CALL DSDRLIST (VOLSEQ);         0639
*                                                                  0639
         LA    @04,VOLSEQ                                          0639
         ST    @04,@AL00001                                        0639
         LA    @01,@AL00001                                        0639
         BAL   @14,DSDRLIST                                        0639
*                                  /**********************************/
*                                  /*                                */
*                                  /* IF REMAINING VOLUME ARE TO BE  */
*                                  /* PRINTED AND A DSDR2 EXISTS,    */
*                                  /* THEN PROCESS THE ADDITIONAL    */
*                                  /* VOLUMES                        */
*                                  /*                                */
*                                  /**********************************/
*                                                                  0640
*                                  IF NVOLS     > 0 &              0640
*                                     JFCBEXAD ^= 0                0640
*                                    THEN                          0640
         LH    @04,NVOLS                                           0640
         LTR   @04,@04                                             0640
         BNP   @RF00640                                            0640
         ICM   @04,7,JFCBEXAD(DSDR1PTR)                            0640
         BZ    @RF00640                                            0640
*                                     DO;                          0641
*                                                                  0641
*                                      /******************************/
*                                      /*                            */
*                                      /* CALL DSDRVOLS TO HANDLE THE*/
*                                      /* DSDR2 RECORDS              */
*                                      /*                            */
*                                      /******************************/
*                                                                  0642
*                                      CALL DSDRVOLS (NVOLS,       0642
*                                                     VOLSEQ,      0642
*                                                     SIZE,        0642
*                                                     LOGRECP,     0642
*                                                     DPNEEDCH,    0642
*                                                     GETNXTSW,    0642
*                                                     DPEOF);      0642
         LA    @04,NVOLS                                           0642
         ST    @04,@AL00001                                        0642
         LA    @04,VOLSEQ                                          0642
         ST    @04,@AL00001+4                                      0642
         LA    @04,SIZE                                            0642
         ST    @04,@AL00001+8                                      0642
         LA    @04,LOGRECP                                         0642
         ST    @04,@AL00001+12                                     0642
         L     @04,@PC00006                                        0642
         ST    @04,@AL00001+16                                     0642
         LA    @04,GETNXTSW                                        0642
         ST    @04,@AL00001+20                                     0642
         L     @04,@PC00006+4                                      0642
         ST    @04,@AL00001+24                                     0642
         LA    @01,@AL00001                                        0642
         BAL   @14,DSDRVOLS                                        0642
*                                      RESPECIFY RTNREG RSTD;      0643
*                                      TESTRC = RTNREG;            0644
         LR    TESTRC,RTNREG                                       0644
*                                      RESPECIFY RTNREG UNRSTD;    0645
*                                      SETRC = MAX(SETRC,TESTRC);  0646
         LH    @04,SETRC                                           0646
         CR    @04,TESTRC                                          0646
         BNL   *+6
         LR    @04,TESTRC                                          0646
         STH   @04,SETRC                                           0646
*                                     END;                         0647
*                                                                  0647
*                                    ELSE;                         0648
*                                                                  0648
@RF00640 DS    0H                                                  0649
*                                END GETVOLS;                      0649
*                                                                  0649
*                              ELSE;                               0650
*                                                                  0650
@RF00632 DS    0H                                                  0651
*                            /****************************************/
*                            /*                                      */
*                            /* PRINT VOLSEQ ERR MSG IF NEEDED       */
*                            /* SET LASTCC4                          */
*                            /*                                      */
*                            /****************************************/
*                                                                  0651
*                            IF VLSQMSG = YES                      0651
*                              THEN                                0651
*                                                                  0651
         TM    VLSQMSG,B'10000000'                                 0651
         BNO   @RF00651                                            0651
*                                DO;                               0652
*                                  DARGSMOD = CK0ID;               0653
         L     @04,DDSTRU                                          0653
         MVC   DARGSMOD(3,@04),@CC00609                            0653
*                                  DARGSENT = CKST12;              0654
         MVI   DARGSENT(@04),X'0C'                                 0654
*                                  DARGDBP  = ADDR(MSGDDNAM);      0655
         LA    @02,MSGDDNAM                                        0655
         ST    @02,DARGDBP(,@04)                                   0655
*                                  DARGILP  = LENGTH(MSGDDNAM);    0656
*                                                                  0656
         MVC   DARGILP(2,@04),@CH00173                             0656
*                                  CALL AMSTP011 (GDTTBL,          0657
*                                          OUTIOCP,                0657
*                                          DDSTRU);                0657
         L     @04,@PC00001                                        0657
         ST    @04,@AL00001                                        0657
         LA    @02,OUTIOCP                                         0657
         ST    @02,@AL00001+4                                      0657
         LA    @02,DDSTRU                                          0657
         ST    @02,@AL00001+8                                      0657
         MVI   @AL00001+8,X'80'                                    0657
         L     @15,GDTPRT(,@04)                                    0657
         LA    @01,@AL00001                                        0657
         BALR  @14,@15                                             0657
*                                  RESPECIFY RTNREG RSTD;          0658
*                                  TESTRC = RTNREG;                0659
         LR    TESTRC,RTNREG                                       0659
*                                  RESPECIFY RTNREG UNRSTD;        0660
*                                                                  0660
*                                  /* SET RETURN CODE FROM PRINT     */
*                                  SETRC = MAX(SETRC,TESTRC);      0661
*                                                                  0661
         LH    @04,SETRC                                           0661
         CR    @04,TESTRC                                          0661
         BNL   *+6
         LR    @04,TESTRC                                          0661
         STH   @04,SETRC                                           0661
*                                  DARGLIST = ZEROAREA;            0662
*                                                                  0662
         L     @02,DDSTRU                                          0662
         MVC   DARGLIST(20,@02),ZEROAREA                           0662
*                                  /* SET ERROR CODE LASTCC04        */
*                                  SETRC = MAX(SETRC,LASTCC04);    0663
*                                                                  0663
         LA    @02,4                                               0663
         CR    @04,@02                                             0663
         BNL   *+6
         LR    @04,@02                                             0663
         STH   @04,SETRC                                           0663
*                                END;                              0664
*                              ELSE;                               0665
*                                                                  0665
@RF00651 DS    0H                                                  0666
*                          END DSDR1TP;                            0666
*                                                                  0666
*                        ELSE;         /*DSDR1 NOT FOR TAPE-LOOP     */
*                                                                  0667
@RF00592 DS    0H                                                  0668
*                    END DSDR1PC;                                  0668
*                                                                  0668
*              END NOEOF;                                          0669
*                                                                  0669
*            ELSE;                     /* DPEOF NOT EQUAL 0          */
*                                                                  0670
@RF00573 DS    0H                                                  0671
*        END START;                                                0671
*                                                                  0671
@RC00573 DS    0H                                                  0671
@DE00563 L     @04,@PC00006+4                                      0671
         LH    @04,DPEOF(,@04)                                     0671
         LTR   @04,@04                                             0671
         BZ    @DL00563                                            0671
*        /************************************************************/
*        /*                                                          */
*        /* IF NO TAPE DATA SETS WERE FOUND FOR THIS CHECKPOINT      */
*        /* PRINT A MESSAGE TO INFORM THE USER                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0672
*        IF DSDR1FND = NO                                          0672
*          THEN                                                    0672
         TM    DSDR1FND,B'10000000'                                0672
         BNZ   @RF00672                                            0672
*            DO;                                                   0673
*              DARGSMOD = CK0ID;                                   0674
         L     @02,DDSTRU                                          0674
         MVC   DARGSMOD(3,@02),@CC00609                            0674
*              DARGSENT = CKST06;                                  0675
*                                                                  0675
         MVI   DARGSENT(@02),X'06'                                 0675
*              CALL AMSTP011 (GDTTBL,                              0676
*                      OUTIOCP,                                    0676
*                      DDSTRU);                                    0676
         L     @02,@PC00001                                        0676
         ST    @02,@AL00001                                        0676
         LA    @15,OUTIOCP                                         0676
         ST    @15,@AL00001+4                                      0676
         LA    @15,DDSTRU                                          0676
         ST    @15,@AL00001+8                                      0676
         MVI   @AL00001+8,X'80'                                    0676
         L     @15,GDTPRT(,@02)                                    0676
         LA    @01,@AL00001                                        0676
         BALR  @14,@15                                             0676
*              RESPECIFY RTNREG RSTD;                              0677
*              TESTRC = RTNREG;                                    0678
         LR    TESTRC,RTNREG                                       0678
*              RESPECIFY RTNREG UNRSTD;                            0679
*              SETRC = MAX(SETRC,TESTRC);                          0680
         LH    @02,SETRC                                           0680
         CR    @02,TESTRC                                          0680
         BNL   *+6
         LR    @02,TESTRC                                          0680
         STH   @02,SETRC                                           0680
*              DARGLIST = ZEROAREA;                                0681
*                                                                  0681
         L     @01,DDSTRU                                          0681
         MVC   DARGLIST(20,@01),ZEROAREA                           0681
*            END;                                                  0682
*          ELSE;                                                   0683
*                                                                  0683
@RF00672 DS    0H                                                  0684
*        /************************************************************/
*        /*                                                          */
*        /* RESET DPEOF TO ZERO IF END OF ENTRY WAS REPORTED         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0684
*        IF DPEOF = EOECOND                                        0684
*          THEN                                                    0684
         L     @15,@PC00006+4                                      0684
         CLC   DPEOF(2,@15),@CH00147                               0684
         BNE   @RF00684                                            0684
*            DPEOF = 0;                                            0685
         SLR   @14,@14                                             0685
         STH   @14,DPEOF(,@15)                                     0685
*          ELSE;                                                   0686
*                                                                  0686
@RF00684 DS    0H                                                  0687
*        RETURN CODE (0);                                          0687
         SLR   @15,@15                                             0687
         L     @14,@SA00006                                        0687
         LM    @00,@12,@SA00006+8                                  0687
         BR    @14                                                 0687
*        END DSDRPROC;                                             0688
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - DSDRVOLS (DVNVOLS,                           */
*        /*                       DVVOLSEQ,                          */
*        /*                       DVSIZE,                            */
*        /*                       DVLOGRCP,                          */
*        /*                       DVNEEDCH,                          */
*        /*                       DVGETNXT,                          */
*        /*                       DVEOF)                             */
*        /*                                                          */
*        /* FUNCTION - TO PREPARE AND PRINT VOLUME INFORMATION       */
*        /*            FROM THE JFCBX IN THE DSDR2 RECORDS OF THE    */
*        /*            CHECKPOINT DATA SET.                          */
*        /*                                                          */
*        /* INPUT - CHECKPOINT DATA SET                              */
*        /*         VOLUME SEQ NUMBER                                */
*        /*         NUMBER OF VOLUMES                                */
*        /*                                                          */
*        /* OUTPUT - VOLUMES DETAIL LINE FOR ADDITIONAL VOLUMES      */
*        /*          CHR READ SWITCH ( NEEDCHR )                     */
*        /*          DSDR READ SWITCH ( GETNXTSW )                   */
*        /*          END OF FILE INDICATOR ( EOF )                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0689
*DSDRVOLS:                                                         0689
*        PROCEDURE (DVNVOLS,                                       0689
*                   DVVOLSEQ,                                      0689
*                   DVSIZE,                                        0689
*                   DVLOGRCP,                                      0689
*                   DVNEEDCH,                                      0689
*                   DVGETNXT,                                      0689
*                   DVEOF);                                        0689
*                                                                  0689
DSDRVOLS STM   @14,@12,@SA00007                                    0689
         MVC   @PC00007(28),0(@01)                                 0689
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED OR ARE REQUIRED          */
*        /* FROM ANOTHER INTERNAL ROUTINE                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0690
*        DCL DVNVOLS  FIXED(15); /* NUMBER OF VOLUMES ( NVOLS )      */
*        DCL DVVOLSEQ FIXED(15); /* VOLUME SEQUENCE NUMBER ( VOLSEQ )*/
*        DCL DVSIZE   FIXED(31); /* LENGTH OF LAST LOGICAL REC (SIZE)*/
*        DCL DVLOGRCP PTR(31);   /* LOGICAL RECORD POINTER (LOGRECP) */
*        DCL DVNEEDCH BIT(1) BDY(BYTE); /* CHR READ SWITCH (NEEDCHR) */
*        DCL DVGETNXT BIT(1) BDY(BYTE); /* DSDR READ SWITCH(GETNXTSW)*/
*        DCL DVEOF    FIXED(15); /* END OF FILE INDICATOR ( EOF )    */
*                                                                  0696
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0697
*        DCL NEEDD2  BIT(1)  BDY(BYTE);                            0697
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE CONTROL SWITCH                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0698
*        OLDERID2 = NEWERID2;                                      0698
         L     @02,@PC00001                                        0698
         L     @02,GDTTR2(,@02)                                    0698
         MVC   @TS00001(95),NEWERID2(@02)                          0698
         MVC   OLDERID2(95,@02),@TS00001                           0698
*        NEWID2 = 'CKDV';                                          0699
*                                                                  0699
         MVC   NEWID2(4,@02),@CC00867                              0699
*        NEEDD2 = YES;                                             0700
*                                                                  0700
         OI    NEEDD2,B'10000000'                                  0700
*        /************************************************************/
*        /*                                                          */
*        /* GET NEXT RECORD - SHOULD BE DSDR2. IF NOT PRINT          */
*        /* ERROR MESSAGE & RETURN.                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0701
*DVOLS:  DO WHILE(NEEDD2 = YES);                                   0701
*                                                                  0701
DVOLS    B     @DE00701                                            0701
@DL00701 DS    0H                                                  0702
*          CALL GETNEXT (DVLOGRCP,     /*GET NEXT LOGICAL RECORD     */
*                        DVSIZE,                                   0702
*                        DVNEEDCH,                                 0702
*                        DVEOF);                                   0702
*                                                                  0702
         L     @02,@PC00007+12                                     0702
         ST    @02,@AL00001                                        0702
         L     @02,@PC00007+8                                      0702
         ST    @02,@AL00001+4                                      0702
         L     @02,@PC00007+16                                     0702
         ST    @02,@AL00001+8                                      0702
         L     @02,@PC00007+24                                     0702
         ST    @02,@AL00001+12                                     0702
         LA    @01,@AL00001                                        0702
         BAL   @14,GETNEXT                                         0702
*          IF DVEOF = 0          &                                 0703
*            DVLOGRCP->DSDR2TYP = DSDR2                            0703
*            THEN                                                  0703
*                                                                  0703
         L     @02,@PC00007+24                                     0703
         LH    @02,DVEOF(,@02)                                     0703
         LTR   @02,@02                                             0703
         BNZ   @RF00703                                            0703
         L     @02,@PC00007+12                                     0703
         L     @02,DVLOGRCP(,@02)                                  0703
         CLC   DSDR2TYP(2,@02),@CB00675                            0703
         BNE   @RF00703                                            0703
*        /************************************************************/
*        /*                                                          */
*        /* PROCESS VOLUMES FROM DSDR2  - JFCBX                      */
*        /* 15 (MAX) VOLUME SERIAL NUMBERS CAN BE CONTAINED IN THE   */
*        /* JFCBX.  THEY ARE PRINTED 5 PER LINE FOR A MAXIMUM OF     */
*        /* FIVE LINES.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0704
*PROCD2:       DO;                                                 0704
*                                                                  0704
PROCD2   DS    0H                                                  0705
*                IF GDTDBG = NULLPTR                               0705
*                  THEN;                                           0705
         L     @02,@PC00001                                        0705
         L     @02,GDTDBG(,@02)                                    0705
         LTR   @02,@02                                             0705
         BZ    @RT00705                                            0705
*                  ELSE                                            0707
*                    CALL IDCDB010 (GDTTBL,'CK50');                0707
*                                                                  0707
         L     @02,@PC00001                                        0707
         ST    @02,@AL00001                                        0707
         LA    @15,@CC00872                                        0707
         ST    @15,@AL00001+4                                      0707
         MVI   @AL00001+4,X'80'                                    0707
         L     @15,GDTDBG(,@02)                                    0707
         LA    @01,@AL00001                                        0707
         BALR  @14,@15                                             0707
*                DSDR2PTR = DVLOGRCP;                              0708
@RT00705 L     @15,@PC00007+12                                     0708
         L     DSDR2PTR,DVLOGRCP(,@15)                             0708
*                DVSIZE = LENGTH(DSDR2REC);                        0709
         L     @15,@PC00007+8                                      0709
         MVC   DVSIZE(4,@15),@CF00718                              0709
*                DO I = 1 TO MAXLINE WHILE (DVNVOLS > 0);          0710
         LA    I,1                                                 0710
@DL00710 L     @05,@PC00007                                        0710
         LH    @05,DVNVOLS(,@05)                                   0710
         LTR   @05,@05                                             0710
         BNP   @DC00710                                            0710
*                  TVOLINFO = BLANKS;                              0711
*                                                                  0711
         MVC   TVOLINFO(35),BLANKS                                 0711
*                  /**************************************************/
*                  /*                                                */
*                  /* MOVE TO TVOL(J) THE JFCBXVOL DETERMINED BY     */
*                  /* 5 * (I - 1) + J. THAT IS, THE JTH VOL IN THE   */
*                  /* ITH GROUP OF 5 VOLS IN THE JFCBX.              */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0712
*                  DO J = 1 TO PVOLLIM WHILE (DVNVOLS > 0);        0712
         LA    J,1                                                 0712
@DL00712 L     @07,@PC00007                                        0712
         LH    @05,DVNVOLS(,@07)                                   0712
         LTR   @05,@05                                             0712
         BNP   @DC00712                                            0712
*                    TVOL(J) = JFXVOL((I-1)*5 + J);                0713
         LR    @03,J                                               0713
         MH    @03,@CH00617                                        0713
         LA    @01,TVOL-7(@03)                                     0713
         LR    @03,I                                               0713
         BCTR  @03,0                                               0713
         MH    @03,@CH00266                                        0713
         ALR   @03,J                                               0713
         MH    @03,@CH00150                                        0713
         ALR   @03,DSDR2PTR                                        0713
         MVC   0(6,@01),JFXVOL-6(@03)                              0713
*                    DVNVOLS = DVNVOLS - 1;                        0714
         BCTR  @05,0                                               0714
         STH   @05,DVNVOLS(,@07)                                   0714
*                  END;                                            0715
*                                                                  0715
         AL    J,@CF00213                                          0715
         C     J,@CF00266                                          0715
         BNH   @DL00712                                            0715
@DC00712 DS    0H                                                  0716
*                  CALL DSDRLIST (DVVOLSEQ);                       0716
*                                                                  0716
         L     @05,@PC00007+4                                      0716
         ST    @05,@AL00001                                        0716
         LA    @01,@AL00001                                        0716
         BAL   @14,DSDRLIST                                        0716
*                END;                                              0717
*                                                                  0717
         AL    I,@CF00213                                          0717
         C     I,@CF00156                                          0717
         BNH   @DL00710                                            0717
@DC00710 DS    0H                                                  0718
*                /****************************************************/
*                /*                                                  */
*                /* IF ALL VOLS HAVE BEEN PRINTED, SET THE           */
*                /* CONTROL SWITCH TO STOP PROCESSING.               */
*                /*                                                  */
*                /****************************************************/
*                                                                  0718
*                IF DVNVOLS ^> 0                                  0718
*                   JFCBXNXT = NULLPTR                             0718
*                  THEN                                            0718
         SLR   @15,@15                                             0718
         L     @14,@PC00007                                        0718
         CH    @15,DVNVOLS(,@14)                                   0718
         BNL   @RT00718                                            0718
         ICM   @14,15,JFCBXNXT(DSDR2PTR)                           0718
         CR    @15,@14                                             0718
         BNE   @RF00718                                            0718
@RT00718 DS    0H                                                  0719
*                    NEEDD2 = NO;                                  0719
         NI    NEEDD2,B'01111111'                                  0719
*                  ELSE;                                           0720
*                                                                  0720
@RF00718 DS    0H                                                  0721
*              END PROCD2;                                         0721
*                                                                  0721
*            ELSE                                                  0722
*                                                                  0722
*              /******************************************************/
*              /*                                                    */
*              /* WHEN END OF FILE, END OF ENTRY OR A NON-DSDR2      */
*              /* RECORD OCCURS, PRINT ERROR MESSAGE AND SET         */
*              /* THE RETURN CODE TO 4                               */
*              /*                                                    */
*              /******************************************************/
*                                                                  0722
*              DO;                                                 0722
         B     @RC00703                                            0722
@RF00703 DS    0H                                                  0723
*                DVGETNXT = NO;                                    0723
         L     @02,@PC00007+20                                     0723
         NI    DVGETNXT(@02),B'01111111'                           0723
*                DARGSMOD = CK0ID;                                 0724
         L     @02,DDSTRU                                          0724
         MVC   DARGSMOD(3,@02),@CC00609                            0724
*                DARGSENT = CKST10;                                0725
         MVI   DARGSENT(@02),X'0A'                                 0725
*                DARGDBP  = ADDR(MSGDDNAM);                        0726
         LA    @15,MSGDDNAM                                        0726
         ST    @15,DARGDBP(,@02)                                   0726
*                DARGILP  = LENGTH(MSGDDNAM);                      0727
*                                                                  0727
         MVC   DARGILP(2,@02),@CH00173                             0727
*                CALL AMSTP011 (GDTTBL,                            0728
*                        OUTIOCP,                                  0728
*                        DDSTRU);                                  0728
         L     @02,@PC00001                                        0728
         ST    @02,@AL00001                                        0728
         LA    @15,OUTIOCP                                         0728
         ST    @15,@AL00001+4                                      0728
         LA    @15,DDSTRU                                          0728
         ST    @15,@AL00001+8                                      0728
         MVI   @AL00001+8,X'80'                                    0728
         L     @15,GDTPRT(,@02)                                    0728
         LA    @01,@AL00001                                        0728
         BALR  @14,@15                                             0728
*                SETRC = MAX(SETRC,TESTRC);                        0729
*                                                                  0729
         LH    @02,SETRC                                           0729
         CR    @02,TESTRC                                          0729
         BNL   *+6
         LR    @02,TESTRC                                          0729
         STH   @02,SETRC                                           0729
*                RETURN CODE (LASTCC04);                           0730
         LA    @15,4                                               0730
         L     @14,@SA00007                                        0730
         LM    @00,@12,@SA00007+8                                  0730
         BR    @14                                                 0730
*              END;                                                0731
*                                                                  0731
*        END DVOLS;                                                0732
*                                                                  0732
@RC00703 DS    0H                                                  0732
@DE00701 TM    NEEDD2,B'10000000'                                  0732
         BO    @DL00701                                            0732
*        RETURN CODE (0);                                          0733
         SLR   @15,@15                                             0733
         L     @14,@SA00007                                        0733
         LM    @00,@12,@SA00007+8                                  0733
         BR    @14                                                 0733
*        END DSDRVOLS;                                             0734
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - GETNEXT (GNLOGRCP,GNSIZE,GNNEEDCH,GNEOF)     */
*        /*                                                          */
*        /* FUNCTION - TO OBTAIN THE NEXT SEQUENTIAL LOGICAL RECORD  */
*        /*            FROM THE CHECKPOINT DATA SET. THE LOGICAL     */
*        /*            RECORD POINTER IS SET TO THE ADDRESS OF THE   */
*        /*            LOGICAL RECORD.                               */
*        /*                                                          */
*        /* INPUT - CHECKPOINT DATA SET                              */
*        /*         SIZE OF THE PREVIOUS RECORD                      */
*        /*                                                          */
*        /* OUTPUT - ADDRESS OF LOGICAL RECORD                       */
*        /*          CHR READ SWITCH (NEEDCHR)                       */
*        /*          END OF FILE INDICATOR                           */
*        /*          LOGICAL RECORD POINTER                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0735
*GETNEXT:                                                          0735
*        PROCEDURE (GNLOGRCP,                                      0735
*                   GNSIZE,                                        0735
*                   GNNEEDCH,                                      0735
*                   GNEOF);                                        0735
*                                                                  0735
GETNEXT  STM   @14,@02,@SA00008                                    0735
         STM   @04,@12,@SA00008+20                                 0735
         MVC   @PC00008(16),0(@01)                                 0735
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED, OR ARE REQUIRED FROM    */
*        /* CALLING PROGRAM                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0736
*        DCL GNLOGRCP  PTR(31);   /* LOGICAL RECORD POINTER          */
*        DCL GNSIZE    FIXED(31); /* SIZE OF LAST LOGICAL RECORD     */
*        DCL GNNEEDCH  BIT(1) BDY(BYTE); /*CHR READ SWITCH (NEEDCHR) */
*        DCL GNEOF     FIXED(15); /* END OF FILE INDICATOR ( EOF )   */
*        /************************************************************/
*        /*                                                          */
*        /* BYPASS READ IF CURRENT RECORD IS FIRST OF BLOCK, AND     */
*        /* INCREMENT LOGICAL RECORD POINTER BY THE SIZE OF THE      */
*        /* CURRENT RECORD TO POINT TO THE SECOND BLOCK              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0740
*        OLDERID2 = NEWERID2;                                      0740
         L     @02,@PC00001                                        0740
         L     @02,GDTTR2(,@02)                                    0740
         MVC   @TS00001(95),NEWERID2(@02)                          0740
         MVC   OLDERID2(95,@02),@TS00001                           0740
*        NEWID2 = 'CKGN';                                          0741
*                                                                  0741
         MVC   NEWID2(4,@02),@CC00884                              0741
*        IF GNLOGRCP = IOCDAD                                      0742
*          THEN                                                    0742
         L     @02,@PC00008                                        0742
         L     @15,GNLOGRCP(,@02)                                  0742
         L     @14,IOCSPTR                                         0742
         C     @15,IOCDAD(,@14)                                    0742
         BNE   @RF00742                                            0742
*            GNLOGRCP = GNLOGRCP + GNSIZE;  /*INCREMENT PTR BY SIZE  */
         L     @14,@PC00008+4                                      0743
         AL    @15,GNSIZE(,@14)                                    0743
         ST    @15,GNLOGRCP(,@02)                                  0743
*                                           /*DROP TO END OF PROGRAM */
*          ELSE                                                    0744
*                                                                  0744
*GETNXT:     DO;                                                   0744
         B     @RC00742                                            0744
@RF00742 DS    0H                                                  0744
GETNXT   DS    0H                                                  0745
*              IOCDLN = LENGTH(CHKPTREC);                          0745
*                                                                  0745
         L     @02,IOCSPTR                                         0745
         MVC   IOCDLN(4,@02),@CF00894                              0745
*              CALL IDCIOGT0 (GDTTBL,       /*READ NEXT BLOCK        */
*                    INIOCP);                                      0746
         L     @02,@PC00001                                        0746
         ST    @02,@AL00001                                        0746
         LA    @15,INIOCP                                          0746
         ST    @15,@AL00001+4                                      0746
         MVI   @AL00001+4,X'80'                                    0746
         L     @15,GDTGET(,@02)                                    0746
         LA    @01,@AL00001                                        0746
         BALR  @14,@15                                             0746
*              RESPECIFY RTNREG RSTD;                              0747
*              TESTRC = RTNREG;                                    0748
         LR    TESTRC,RTNREG                                       0748
*              RESPECIFY RTNREG UNRSTD;                            0749
*                                                                  0749
*              IF TESTRC ^= 0                                      0750
*                THEN                                              0750
         LTR   TESTRC,TESTRC                                       0750
         BZ    @RF00750                                            0750
*                  IF TESTRC = 16           /*CHECK FOR EOF          */
*                    THEN                                          0751
         C     TESTRC,@CF00465                                     0751
         BNE   @RF00751                                            0751
*                      DO;                  /*PRINT UNEXPECTED EOF   */
*                        GNEOF = EOFCOND;   /*MSG RETURN LASTCC04    */
         L     @02,@PC00008+12                                     0753
         MVC   GNEOF(2,@02),@CH00213                               0753
*                        DARGSMOD = CK0ID;                         0754
         L     @02,DDSTRU                                          0754
         MVC   DARGSMOD(3,@02),@CC00609                            0754
*                        DARGSENT = CKST11;                        0755
*                                                                  0755
         MVI   DARGSENT(@02),X'0B'                                 0755
*                        CALL AMSTP011 (GDTTBL,                    0756
*                                PRTFILE,                          0756
*                                DDSTRU);                          0756
*                                                                  0756
         L     @02,@PC00001                                        0756
         ST    @02,@AL00001                                        0756
         LA    @15,@CF00111                                        0756
         ST    @15,@AL00001+4                                      0756
         LA    @15,DDSTRU                                          0756
         ST    @15,@AL00001+8                                      0756
         MVI   @AL00001+8,X'80'                                    0756
         L     @15,GDTPRT(,@02)                                    0756
         LA    @01,@AL00001                                        0756
         BALR  @14,@15                                             0756
*                        RETURN CODE (LASTCC04);                   0757
         LA    @15,4                                               0757
         L     @14,@SA00008                                        0757
         LM    @00,@02,@SA00008+8                                  0757
         LM    @04,@12,@SA00008+20                                 0757
         BR    @14                                                 0757
*                      END;                                        0758
*                    ELSE                   /*SET RETURN CODE 12 FOR */
*                      DO;                  /*I/O ERROR              */
@RF00751 DS    0H                                                  0760
*                        GNEOF = EOFCOND;                          0760
         L     @02,@PC00008+12                                     0760
         MVC   GNEOF(2,@02),@CH00213                               0760
*                        RETURN CODE (LASTCC12);                   0761
         LA    @15,12                                              0761
         L     @14,@SA00008                                        0761
         LM    @00,@02,@SA00008+8                                  0761
         LM    @04,@12,@SA00008+20                                 0761
         BR    @14                                                 0761
*                      END;                                        0762
*                ELSE                                              0763
*                                                                  0763
*                  /**************************************************/
*                  /*                                                */
*                  /* WHEN READ IS OK, LOOK FOR END OF ENTRY. IF A   */
*                  /* POTENTIAL CHR IS FOUND, SET NEEDCHR TO YES.    */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0763
*                  IF IOCDLN = LENGTH(CHKPTREC)                    0763
*                    THEN                                          0763
@RF00750 L     @02,IOCSPTR                                         0763
         CLC   IOCDLN(4,@02),@CF00894                              0763
         BNE   @RF00763                                            0763
*                      IF RECTYPE ^= DDNT  &                       0764
*                         RECTYPE ^= DSDR1 &                       0764
*                         RECTYPE ^= DSDR2 &                       0764
*                         CHRIDENT ^= CHRID                        0764
*                        THEN                                      0764
         L     @02,IOCDAD(,@02)                                    0764
         CLC   RECTYPE(2,@02),@CB00671                             0764
         BE    @RF00764                                            0764
         CLC   RECTYPE(2,@02),@CB00673                             0764
         BE    @RF00764                                            0764
         CLC   RECTYPE(2,@02),@CB00675                             0764
         BE    @RF00764                                            0764
         CLC   CHRIDENT(19,@02),@CC00644                           0764
         BE    @RF00764                                            0764
*                            GNEOF = EOECOND;    /*SET END OF ENTRY  */
         L     @02,@PC00008+12                                     0765
         MVC   GNEOF(2,@02),@CH00147                               0765
*                        ELSE               /* CHECK FOR CHR         */
*                          DO;                                     0766
         B     @RC00764                                            0766
@RF00764 DS    0H                                                  0767
*                            IF CHRIDENT = CHRID                   0767
*                              THEN              /*REC IS POSSIBL CHR*/
         L     @02,IOCSPTR                                         0767
         L     @02,IOCDAD(,@02)                                    0767
         CLC   CHRIDENT(19,@02),@CC00644                           0767
         BNE   @RF00767                                            0767
*                                DO;                               0768
*                                  GNEOF = EOECOND; /*SET EOE        */
         L     @02,@PC00008+12                                     0769
         MVC   GNEOF(2,@02),@CH00147                               0769
*                                  GNNEEDCH = NO;                  0770
         L     @02,@PC00008+8                                      0770
         NI    GNNEEDCH(@02),B'01111111'                           0770
*                                END;                              0771
*                              ELSE          /* GOOD REC-SET PTR     */
*                                GNLOGRCP = IOCDAD;                0772
         B     @RC00767                                            0772
@RF00767 L     @02,@PC00008                                        0772
         L     @01,IOCSPTR                                         0772
         L     @15,IOCDAD(,@01)                                    0772
         ST    @15,GNLOGRCP(,@02)                                  0772
*                          END;                                    0773
*                    ELSE                                          0774
*                      GNEOF = EOECOND;     /*WRONG LENGTH MEANS EOE */
*                                                                  0774
         B     @RC00763                                            0774
@RF00763 L     @02,@PC00008+12                                     0774
         MVC   GNEOF(2,@02),@CH00147                               0774
*            END GETNXT;                                           0775
*                                                                  0775
@RC00763 DS    0H                                                  0776
*        RETURN CODE (0);                                          0776
@RC00742 SLR   @15,@15                                             0776
         L     @14,@SA00008                                        0776
         LM    @00,@02,@SA00008+8                                  0776
         LM    @04,@12,@SA00008+20                                 0776
         BR    @14                                                 0776
*        END GETNEXT;                                              0777
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - DSDRLIST (DLVOLSEQ)                          */
*        /*                                                          */
*        /* FUNCTION - TO DETERMINE IF THE VOLUME MOUNTED AT THE TIME*/
*        /*            OF A CHECKPOINT IS IN THE LINE TO BE PRINTED. */
*        /*            IF SO AN ASTERISK IS PLACED TO THE RIGT OF    */
*        /*            THAT VOLUME.                                  */
*        /*                                                          */
*        /* INPUT - VOLUME SEQUENCE NUMBER                           */
*        /*         VOLUME PRINT BUFFER                              */
*        /*                                                          */
*        /* OUTPUT - VOLUME DETAIL LINE                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0778
*DSDRLIST:                                                         0778
*        PROCEDURE (DLVOLSEQ);                                     0778
*                                                                  0778
DSDRLIST STM   @14,@02,@SA00009                                    0778
         STM   @04,@12,@SA00009+20                                 0778
         MVC   @PC00009(4),0(@01)                                  0778
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS THAT CAN BE MODIFIED                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0779
*        DCL DLVOLSEQ FIXED(15);                                   0779
*        /************************************************************/
*        /*                                                          */
*        /* IF THE VOLSEQ IS GREATER THAN ZERO AND LESS THAN OR      */
*        /* EQUAL TO FIVE, THE CURRENT VOLUME IS MARKED WITH AN      */
*        /* ASTERISK IF A VOLUME IS IN THE BUFFER. VOLSEQ IS SET     */
*        /* TO ZERO.                                                 */
*        /************************************************************/
*                                                                  0780
*        OLDERID2 = NEWERID2;                                      0780
         L     @15,@PC00001                                        0780
         L     @15,GDTTR2(,@15)                                    0780
         MVC   @TS00001(95),NEWERID2(@15)                          0780
         MVC   OLDERID2(95,@15),@TS00001                           0780
*        NEWID2 = 'CKDL';                                          0781
*                                                                  0781
         MVC   NEWID2(4,@15),@CC00892                              0781
*        IF DLVOLSEQ >  0       &                                  0782
*           DLVOLSEQ <= PVOLLIM                                    0782
*          THEN                                                    0782
         L     @15,@PC00009                                        0782
         LH    @15,DLVOLSEQ(,@15)                                  0782
         LTR   @15,@15                                             0782
         BNP   @RF00782                                            0782
         C     @15,@CF00266                                        0782
         BH    @RF00782                                            0782
*            DO;                                                   0783
*              IF TVOL(DLVOLSEQ) ^= BLANKS                         0784
*                THEN                                              0784
         MH    @15,@CH00617                                        0784
         LA    @14,TVOL-7(@15)                                     0784
         CLC   0(6,@14),BLANKS                                     0784
         BE    @RF00784                                            0784
*                  TASTER(DLVOLSEQ) = ASTER;                       0785
         LA    @14,TASTER-7(@15)                                   0785
         MVI   0(@14),C'*'                                         0785
*                ELSE;                                             0786
@RF00784 DS    0H                                                  0787
*              DLVOLSEQ = 0;                                       0787
         L     @15,@PC00009                                        0787
         SLR   @14,@14                                             0787
         STH   @14,DLVOLSEQ(,@15)                                  0787
*            END;                                                  0788
*          ELSE                                                    0789
*                                                                  0789
*            /********************************************************/
*            /*                                                      */
*            /* SUBTRACT PRINT LIMIT (5) FROM VOLSEQ                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  0789
*            IF DLVOLSEQ > PVOLLIM                                 0789
*              THEN                                                0789
         B     @RC00782                                            0789
@RF00782 LA    @15,5                                               0789
         L     @14,@PC00009                                        0789
         LH    @09,DLVOLSEQ(,@14)                                  0789
         CR    @09,@15                                             0789
         BNH   @RF00789                                            0789
*                DLVOLSEQ = DLVOLSEQ - PVOLLIM;                    0790
         SLR   @09,@15                                             0790
         STH   @09,DLVOLSEQ(,@14)                                  0790
*              ELSE;                                               0791
*                                                                  0791
@RF00789 DS    0H                                                  0792
*        /************************************************************/
*        /*                                                          */
*        /* PRINT VOLUME DETAIL LINE         UPRINT                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0792
*        DARGSMOD = CK0ID;                                         0792
@RC00782 L     @02,DDSTRU                                          0792
         MVC   DARGSMOD(3,@02),@CC00609                            0792
*        DARGSENT = CKST04;                                        0793
         MVI   DARGSENT(@02),X'04'                                 0793
*        DARGDBP  = ADDR(TVOLINFO);                                0794
         LA    @15,TVOLINFO                                        0794
         ST    @15,DARGDBP(,@02)                                   0794
*        DARGILP  = LENGTH(TVOLINFO);                              0795
*                                                                  0795
         MVC   DARGILP(2,@02),@CH00899                             0795
*        CALL AMSTP011 (GDTTBL,                                    0796
*                OUTIOCP,                                          0796
*                DDSTRU);                                          0796
         L     @02,@PC00001                                        0796
         ST    @02,@AL00001                                        0796
         LA    @15,OUTIOCP                                         0796
         ST    @15,@AL00001+4                                      0796
         LA    @15,DDSTRU                                          0796
         ST    @15,@AL00001+8                                      0796
         MVI   @AL00001+8,X'80'                                    0796
         L     @15,GDTPRT(,@02)                                    0796
         LA    @01,@AL00001                                        0796
         BALR  @14,@15                                             0796
*        RESPECIFY RTNREG RSTD;                                    0797
*        TESTRC = RTNREG;                                          0798
         LR    TESTRC,RTNREG                                       0798
*        RESPECIFY RTNREG UNRSTD;                                  0799
*        SETRC = MAX(SETRC,TESTRC);                                0800
         LH    @02,SETRC                                           0800
         CR    @02,TESTRC                                          0800
         BNL   *+6
         LR    @02,TESTRC                                          0800
         STH   @02,SETRC                                           0800
*        DARGLIST = ZEROAREA;                                      0801
*                                                                  0801
         L     @02,DDSTRU                                          0801
         MVC   DARGLIST(20,@02),ZEROAREA                           0801
*        RETURN CODE (0);                                          0802
         SLR   @15,@15                                             0802
         L     @14,@SA00009                                        0802
         LM    @00,@02,@SA00009+8                                  0802
         LM    @04,@12,@SA00009+20                                 0802
         BR    @14                                                 0802
*        END DSDRLIST;                                             0803
*                                                                  0803
*        END IDCCK01                                               0804
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSCK )                                        *
*;                                                                 0804
@DATA    DS    0H
@CH00150 DC    H'6'
@CH00617 DC    H'7'
@CH00173 DC    H'8'
@CH00897 DC    H'18'
@CH00899 DC    H'35'
@CH00898 DC    H'63'
@CH00896 DC    H'241'
@CH00786 DC    H'-1'
         DS    0F
@AL00314 DC    A(@CC00568)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00003 DS    15F
@PC00003 DS    2F
@SA00004 DS    14F
@PC00004 DS    4F
@SA00006 DS    15F
@PC00006 DS    2F
@SA00005 DS    14F
@PC00005 DS    2F
@SA00008 DS    14F
@PC00008 DS    4F
@SA00009 DS    14F
@PC00009 DS    1F
@SA00007 DS    15F
@PC00007 DS    7F
@AL00001 DS    7A
IDCCK01  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00213 DC    F'1'
@CH00213 EQU   @CF00213+2
@CF00147 DC    F'2'
@CH00147 EQU   @CF00147+2
@CF00156 DC    F'3'
@CF00041 DC    F'4'
@CF00266 DC    F'5'
@CH00266 EQU   @CF00266+2
@CF00536 DC    F'12'
@CF00465 DC    F'16'
@CH00465 EQU   @CF00465+2
@CF00893 DC    F'17'
@CH00893 EQU   @CF00893+2
@CF00718 DC    F'178'
@CF00894 DC    F'400'
@CF00895 DC    F'401'
@CF00905 DC    F'-15'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
DMPINDEX DS    A
GPLEN    DS    F
INIOCP   DS    A
OUTIOCP  DS    A
IDTABPTR DS    A
IDEOTPTR DS    A
LOGRECP  DS    A
SIZE     DS    F
LISTPTR  DS    A
SETRC    DS    H
EOF      DS    H
NVOLS    DS    H
VOLSEQ   DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
INARGLST DS    BL48
OTARGLST DS    BL48
PCARG    DS    CL33
         ORG   PCARG
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    AL1
         ORG   PCARG+33
SUBLINES DS    CL242
         ORG   SUBLINES
CARRC1   DS    CL1
SUBLNBUF DS    CL241
         ORG   SUBLNBUF
@NM00034 DS    CL51
SUBLNDS  DS    CL44
@NM00035 DS    CL25
CARRC2   DS    CL1
@NM00036 DS    CL120
         ORG   SUBLINES+242
SUBDSNAM DS    CL44
         DS    CL1
DARGAREA DS    CL20
TDSINFO  DS    CL63
         ORG   TDSINFO
TDSNAME  DS    CL44
TDDNAME  DS    CL8
TUNIT    DS    CL4
TTRK     DS    CL5
TVLSQ    DS    FL1
TNVOL    DS    FL1
         ORG   TDSINFO+63
TVOLINFO DS    CL35
         ORG   TVOLINFO
TVOLS    DS    CL7
         ORG   TVOLS+0
TVOL     DS    CL6
TASTER   DS    CL1
         ORG   TVOLINFO+35
SYSID    DS    CL1
         ORG   SYSID
@NM00053 DS    BL1
SYSIDVS1 EQU   SYSID+0
SYSIDVS2 EQU   SYSID+0
@NM00054 EQU   SYSID+0
         ORG   SYSID+1
CHRFND   DS    BL1
MSGDDNAM DS    CL8
NEEDCHR  DS    BL1
USERSPEC DS    BL1
GCSTOP   DS    BL1
DSDR1FND DS    BL1
VLSQMSG  DS    BL1
GETNXTSW DS    BL1
NEEDD2   DS    BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCCK01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00644 DC    C'$$/%@/$ CHR %@/$//%'
@CC00657 DC    C'-9TRK'
@CC00659 DC    C'-7TRK'
@CC00568 DC    C'CK00'
@CC00661 DC    C'2400'
@CC00663 DC    C'3400'
@CC00665 DC    C'****'
@CC00753 DC    C'CKCK'
@CC00762 DC    C'CK10'
@CC00764 DC    C'CK20'
@CC00769 DC    C'CKHS'
@CC00777 DC    C'CKBD'
@CC00799 DC    C'CKCP'
@CC00815 DC    C'CKGC'
@CC00833 DC    C'CKDP'
@CC00839 DC    C'CK30'
@CC00844 DC    C'CK40'
@CC00867 DC    C'CKDV'
@CC00872 DC    C'CK50'
@CC00884 DC    C'CKGN'
@CC00892 DC    C'CKDL'
@CC00604 DC    C'UV0'
@CC00609 EQU   @CC00568
@CB00671 DC    X'0001'
@CB00673 DC    X'0000'
@CB00675 DC    X'0004'
@CB00677 DC    X'0014'
@CB00679 DC    X'0010'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'CK01'
FIXAREA  DS    CL256
         ORG   FIXAREA
@NM00033 DC    256X'00'
         ORG   FIXAREA+256
BLANKS   DS    CL256
         ORG   BLANKS
@NM00039 DC    256CL1' '
         ORG   BLANKS+256
ZEROAREA DS    CL256
         ORG   ZEROAREA
@NM00040 DC    256X'00'
         ORG   ZEROAREA+256
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DSDR1LNG EQU   @05
J        EQU   @06
I        EQU   @04
DSDR2PTR EQU   @02
DSDR1PTR EQU   @02
IDNXTPTR EQU   @05
IDTABWKP EQU   @02
OPNPTR   EQU   @02
TESTRC   EQU   @03
REG11    EQU   @11
REG12    EQU   @12
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOGT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMUN EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNDEV   EQU   OPNAGL+24
OPNBLK   EQU   OPNAGL+36
OPNDSO   EQU   OPNAGL+41
OPNDSOPS EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
IFILE    EQU   0
IFILEVAL EQU   IFILE+1
OFILE    EQU   0
OFILEVAL EQU   OFILE+1
CHKID    EQU   0
CHKIDCNT EQU   CHKID
@NM00032 EQU   CHKID+2
CHKIDVAL EQU   @NM00032+1
INFDSNAM EQU   0
IDCOUNT  EQU   0
IDTABLE  EQU   0
@NM00037 EQU   IDTABLE
IDFOUND  EQU   @NM00037
IDCHKID  EQU   IDTABLE+1
CHR      EQU   0
CHRCHKID EQU   CHR+4
CHRSYSID EQU   CHR+60
CHRIDENT EQU   CHR+61
DSDR1REC EQU   0
DSDRTYPE EQU   DSDR1REC
DSDRJFCB EQU   DSDR1REC+2
JFCBDSNM EQU   DSDRJFCB
JFCBNVOL EQU   DSDRJFCB+117
JFCBVOLS EQU   DSDRJFCB+118
JFCBVOL  EQU   JFCBVOLS
JVOLBYT1 EQU   JFCBVOL
JFCBEXAD EQU   DSDRJFCB+149
DSDRDDNM EQU   DSDR1REC+178
DSDRUCBT EQU   DSDR1REC+186
UCBTBYT2 EQU   DSDRUCBT+1
UCB7TRK  EQU   UCBTBYT2
UCBTBYT3 EQU   DSDRUCBT+2
UCBTBYT4 EQU   DSDRUCBT+3
VS1DVLSQ EQU   DSDR1REC+190
VS2DVLSQ EQU   DSDR1REC+194
DSDR2REC EQU   0
DSDR2TYP EQU   DSDR2REC
JFCBX    EQU   DSDR2REC+2
JFCBXVOL EQU   JFCBX+4
JFXVOL   EQU   JFCBXVOL
JFCBXNXT EQU   JFCBX+172
CHKPTREC EQU   0
RECTYPE  EQU   CHKPTREC
AMSTP041 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
BDTABPTR EQU   0
BDEOTPTR EQU   0
CPSYSID  EQU   0
CPNEEDCH EQU   0
CPCHRFND EQU   0
CPEOF    EQU   0
GCCHRFND EQU   0
GCEOF    EQU   0
DPNEEDCH EQU   0
DPEOF    EQU   0
DVNVOLS  EQU   0
DVVOLSEQ EQU   0
DVSIZE   EQU   0
DVLOGRCP EQU   0
DVNEEDCH EQU   0
DVGETNXT EQU   0
DVEOF    EQU   0
GNLOGRCP EQU   0
GNSIZE   EQU   0
GNNEEDCH EQU   0
GNEOF    EQU   0
DLVOLSEQ EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00052 EQU   CHKPTREC+2
@NM00051 EQU   JFCBX+94
@NM00050 EQU   JFCBX
@NM00049 EQU   DSDR1REC+191
@NM00048 EQU   UCBTBYT2
UCBTBYT1 EQU   DSDRUCBT
@NM00047 EQU   DSDRJFCB+152
JFCBEXTL EQU   DSDRJFCB+148
@NM00046 EQU   JFCBVOL+1
@NM00045 EQU   DSDRJFCB+44
@NM00044 EQU   CHR+80
@NM00043 EQU   CHR+20
@NM00042 EQU   CHR+2
@NM00041 EQU   CHR
@NM00038 EQU   @NM00037
CHKIDLEN EQU   @NM00032
OFILELEN EQU   OFILE
IFILELEN EQU   IFILE
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGCNT  EQU   DARGLIST+14
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00472 EQU   @RC00469
@RC00579 EQU   @RC00573
@RC00764 EQU   @RC00763
@RC00767 EQU   @RC00763
@PB00009 EQU   @EL00001
@RC00583 EQU   @RC00579
@RC00581 EQU   @RC00579
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCCK01,(C'PLS0502',0602,75012)

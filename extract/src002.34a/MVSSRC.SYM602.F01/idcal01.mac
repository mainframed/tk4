         TITLE '*************** IDCAL01: IDCAMS ALTER ROUTINE **********
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCAL01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCAL01   77.271'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         LA    @08,4095(,@09)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         USING @PSTART+16380,@08                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @07,@01                                             0002
         USING @DATD,@07                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @07,8(,@13)                                         0002
         LR    @13,@07                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO IDCAL01                           @Y30SSJH*/
*        /* REMOVE THE CATALOG DNAME PTR SO THE CATALOG CAN BE       */
*        /*  DYNAMICALLY ALLOCATED BY VSAM CATALOG MGMT.     @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0325
*        OLDERID2 = NEWERID2;                                      0325
         L     @06,@PC00001                                        0325
         L     @15,GDTTR2(,@06)                                    0325
         MVC   @TS00001(95),NEWERID2(@15)                          0325
         MVC   OLDERID2(95,@15),@TS00001                           0325
*        NEWID2 = 'AL01';                                          0326
         MVC   NEWID2(4,@15),@CC01147                              0326
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/
*        RESPECIFY CIRAGL BASED(CIRPTR);                   /*@YL026UA*/
*                                                                  0328
*        /************************************************************/
*        /*                                                          */
*        /* PRELIMINARY INITIALIZATION                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0329
*        ALSTID = NORMAL;              /* SET NORMAL STATUS INDICATOR*/
         MVC   ALSTID(5),@CB01034                                  0329
*        ALSTIDLB = 'HERE I AM';       /* DUMP ID FOR ALSTID         */
         MVC   ALSTIDLB(9),@CC01394                                0330
*        CATRTNID = 'CATLGRTN';        /* DUMP ID FOR CATLG RTN CODE */
         MVC   CATRTNID(8),@CC01396                                0331
*        CATACBPT = NULLPTR;           /* ZERO CATLG ACB POINTER     */
         SLR   @15,@15                                             0332
         ST    @15,CATACBPT                                        0332
*        DALCINDX = NULLPTR;           /* SET ALLOCATION INDEX       */
         ST    @15,DALCINDX                                        0333
*        LOCTABLE = ''B;               /* INITILAIZE LOCTABLE TO ZERO*/
         XC    LOCTABLE(80),LOCTABLE                               0334
*        OPNPTR   = ADDR(ALOPNAGL);    /* SET POINTER TO OPNAGL      */
         LA    @14,ALOPNAGL                                        0335
         ST    @14,OPNPTR                                          0335
*        DDSTRU   = ADDR(DARGAREA);    /* SET POINTER TO DARGLIST    */
         LA    @14,DARGAREA                                        0336
         ST    @14,DDSTRU                                          0336
*        ERCNVADR = ADDR(ALERRTBL);    /*SET POINTER TO ERROR TABLE
*                                                            @Y30SSJH*/
         LA    @14,ALERRTBL                                        0337
         ST    @14,ERCNVADR                                        0337
*        IOCSPTR  = NULLPTR;           /* ZERO IOCSPOINTER           */
         ST    @15,IOCSPTR                                         0338
*        BYPASSSW = GO;                /* ZERO BYPASS SECURITY     0339
*                                         SWITCH             @Y30SSJH*/
         MVI   BYPASSSW,X'00'                                      0339
*        KEYRECRC = 0;                 /* INITIALIZE KEYS/RECORDSIZE
*                                         RETURN CODE        @Y30SSJH*/
         ST    @15,KEYRECRC                                        0340
*        DATACI = INITVALU;            /* INITIALIZE CI VARIABLE   0341
*                                                            @Y30SSJH*/
         MVC   DATACI(3),INITVALU                                  0341
*        INDEXCI = INITVALU;           /* INITIALIZE CI VARIABLE   0342
*                                                            @Y30SSJH*/
         MVC   INDEXCI(3),INITVALU                                 0342
*        BDATACI = INITVALU;           /* INITIALIZE CI VARIABLE   0343
*                                                            @Y30SSJH*/
         MVC   BDATACI(3),INITVALU                                 0343
*        BCLUSCI = INITVALU;           /* INITIALIZE CI VARIABLE   0344
*                                                            @Y30SSJH*/
         MVC   BCLUSCI(3),INITVALU                                 0344
*        RFY IDAAMDSB BASED(DSBCATPT); /* ESTABLISH AMDSB ADDRESS    */
*                                                                  0345
*        /************************************************************/
*        /*                                                          */
*        /* GET DYNAMIC STORAGE FOR THE PARAMETER LISTS WHICH        */
*        /* COMPRISE THE CPL-FVT-FPL COMPLEX                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0346
*        CALL IDCSAGP0(GDTTBL,                                     0346
*               (LENGTH(ALCTGPRM)),    /* LENGTH OF STORAGE REQUEST  */
*               ALPRMPTR,              /* ADDRESS OF DYNAMIC STORAGE */
*               ALGPID,                /* UGPOOL ID                  */
*                SETZERO);             /* SET AREA TO ZERO           */
*                                                                  0346
         ST    @06,@AL00001                                        0346
         LA    @15,632                                             0346
         ST    @15,@AFTEMPS+12                                     0346
         LA    @15,@AFTEMPS+12                                     0346
         ST    @15,@AL00001+4                                      0346
         LA    @15,ALPRMPTR                                        0346
         ST    @15,@AL00001+8                                      0346
         LA    @15,ALGPID                                          0346
         ST    @15,@AL00001+12                                     0346
         LA    @15,SETZERO                                         0346
         ST    @15,@AL00001+16                                     0346
         MVI   @AL00001+16,X'80'                                   0346
         L     @15,GDTGPL(,@06)                                    0346
         LA    @01,@AL00001                                        0346
         BALR  @14,@15                                             0346
*        RESPECIFY RTNREG RSTD;                                    0347
*        TESTRC = RTNREG;                                          0348
         STH   RTNREG,TESTRC                                       0348
*        RESPECIFY RTNREG UNRSTD;                                  0349
*                                                                  0349
*        /************************************************************/
*        /*                                                          */
*        /* STORAGE NOT AVAILABLE - TERMINAL ERROR                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0350
*        IF TESTRC ^= 0                                            0350
*          THEN                                                    0350
         LH    @06,TESTRC                                          0350
         LTR   @06,@06                                             0350
         BZ    @RF00350                                            0350
*            ALSTID = NOSTORAG;                                    0351
*                                                                  0351
         MVC   ALSTID(5),@CB01039                                  0351
*     IF ALSTID = NORMAL                                           0352
*       THEN                                                       0352
@RF00350 CLC   ALSTID(5),@CB01034                                  0352
         BNE   @RF00352                                            0352
*GOODCAT: DO;                                              /*@YL026UA*/
*                                                                  0353
GOODCAT  DS    0H                                                  0354
*         ENTRYVAL = NTRYVAL;                              /*@YL026UA*/
         L     @06,@PC00001+4                                      0354
         L     @06,FDTPTR(,@06)                                    0354
         MVC   ENTRYVAL(44),NTRYVAL(@06)                           0354
*         ENTRYLEN = NTRYLEN;                              /*@YL026UA*/
*                                                                  0355
         SLR   @15,@15                                             0355
         IC    @15,NTRYLEN(,@06)                                   0355
         STH   @15,ENTRYLEN                                        0355
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY IS NOT FULLY QUALIFIED - ISSUE     @YL026UA*/
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIER        */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0356
*          IF NTRYFUQ = ON                                         0356
*            THEN                                                  0356
         TM    NTRYFUQ(@06),B'10000000'                            0356
         BNO   @RF00356                                            0356
*              DO;                                         /*@YL026UA*/
*                QUALLIST = ''B;                           /*@YL026UA*/
         XC    QUALLIST(12),QUALLIST                               0358
*                QUALADDR = ADDR(ENTRYVAL);                /*@YL026UA*/
         LA    @15,ENTRYVAL                                        0359
         ST    @15,QUALADDR                                        0359
*                IF NTRYPLN ^= 0                                   0360
*                  THEN                                            0360
         CLI   NTRYPLN(@06),0                                      0360
         BE    @RF00360                                            0360
*                    QUALPAS = ADDR(NTRYPAS);              /*@YL026UA*/
         LA    @06,NTRYPAS(,@06)                                   0361
         ST    @06,QUALPAS                                         0361
*                IF ADDR(CATLG) ^= NULLPTR & CATLGLEN ^= 0         0362
*                  THEN                                            0362
@RF00360 L     @06,@PC00001+4                                      0362
         L     @06,FDTPTR+8(,@06)                                  0362
         LTR   @06,@06                                             0362
         BZ    @RF00362                                            0362
         CLI   CATLGLEN(@06),0                                     0362
         BE    @RF00362                                            0362
*                    DO;                                   /*@YL026UA*/
*                      QUALCAT = ADDR(CATLGVAL);           /*@YL026UA*/
         LA    @15,CATLGVAL(,@06)                                  0364
         ST    @15,QUALCAT                                         0364
*                      IF CATLGPLN ^= 0                            0365
*                        THEN                                      0365
         CLI   CATLGPLN(@06),0                                     0365
         BE    @RF00365                                            0365
*                          QUALPAS = ADDR(CATLGPAS);       /*@YL026UA*/
         LA    @06,CATLGPAS(,@06)                                  0366
         ST    @06,QUALPAS                                         0366
*                    END;                                  /*@YL026UA*/
*                                                                  0367
@RF00365 DS    0H                                                  0368
*                CALL IDCSAQL0(GDTTBL,QUALADDR,ENTRYLEN,QUALCAT,QUALPAS
*;                                                                 0368
@RF00362 L     @06,@PC00001                                        0368
         ST    @06,@AL00001                                        0368
         LA    @15,QUALADDR                                        0368
         ST    @15,@AL00001+4                                      0368
         LA    @15,ENTRYLEN                                        0368
         ST    @15,@AL00001+8                                      0368
         LA    @15,QUALCAT                                         0368
         ST    @15,@AL00001+12                                     0368
         LA    @15,QUALPAS                                         0368
         ST    @15,@AL00001+16                                     0368
         MVI   @AL00001+16,X'80'                                   0368
         L     @15,GDTQAL(,@06)                                    0368
         LA    @01,@AL00001                                        0368
         BALR  @14,@15                                             0368
*                                                          /*@YL026UA*/
*                RESPECIFY RTNREG RSTD;                            0369
*                TESTRC = RTNREG;                                  0370
         STH   RTNREG,TESTRC                                       0370
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/
*                IF TESTRC ^= 0                                    0372
*                  THEN                                            0372
         LH    @06,TESTRC                                          0372
         LTR   @06,@06                                             0372
         BZ    @RF00372                                            0372
*                    ALSTID = TERMERR;                     /*@YL026UA*/
         MVC   ALSTID(5),@CB01042                                  0373
*              END;                                        /*@YL026UA*/
*                                                                  0374
@RF00372 DS    0H                                                  0375
*        IF (ADDR(NEWNM)) ^= NULLPTR                               0375
*         THEN                                                     0375
@RF00356 L     @06,@PC00001+4                                      0375
         L     @15,FDTPTR+16(,@06)                                 0375
         LTR   @15,@15                                             0375
         BZ    @RF00375                                            0375
*          DO;                                             /*@YL026UA*/
*          NEWNAME = NEWNMVAL;                             /*@YL026UA*/
*                                                                  0377
         MVC   NEWNAME(44),NEWNMVAL(@15)                           0377
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE NEWNAME IS NOT FULLY QUALIFIED - USE     @YL026UA*/
*        /*  THE QUALIFIER FROM ENTRY UQUAL AS QUALIFIER     @YL026UA*/
*        /*  ALSO CHECK FOR PROPER NEWNAME GENERICS          @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0378
*          IF NEWNMFUQ = ON & ENTRYLEN ^= NTRYLEN                  0378
*            THEN                                                  0378
         TM    NEWNMFUQ(@15),B'10000000'                           0378
         BNO   @RF00378                                            0378
         L     @06,FDTPTR(,@06)                                    0378
         SLR   @14,@14                                             0378
         IC    @14,NTRYLEN(,@06)                                   0378
         CH    @14,ENTRYLEN                                        0378
         BE    @RF00378                                            0378
*              NEWNAME(NEWNMLEN + 1:44) = ENTRYVAL(NTRYLEN + 1:44);
         SLR   @06,@06                                             0379
         IC    @06,NEWNMLEN(,@15)                                  0379
         LA    @01,NEWNAME(@06)                                    0379
         LCR   @06,@06                                             0379
         AL    @06,@CF00684                                        0379
         LA    @15,ENTRYVAL(@14)                                   0379
         EX    @06,@SM01681                                        0379
*          IF NTRYPOS ^= 0 & NEWNMPOS = 0 ×                        0380
*            NTRYPOS = 0 & NEWNMPOS ^= 0                           0380
*            THEN                                                  0380
@RF00378 L     @06,@PC00001+4                                      0380
         L     @01,FDTPTR(,@06)                                    0380
         CLI   NTRYPOS(@01),0                                      0380
         BE    @GL00003                                            0380
         L     @06,FDTPTR+16(,@06)                                 0380
         CLI   NEWNMPOS(@06),0                                     0380
         BE    @RT00380                                            0380
@GL00003 L     @06,@PC00001+4                                      0380
         L     @01,FDTPTR(,@06)                                    0380
         CLI   NTRYPOS(@01),0                                      0380
         BNE   @RF00380                                            0380
         L     @06,FDTPTR+16(,@06)                                 0380
         CLI   NEWNMPOS(@06),0                                     0380
         BE    @RF00380                                            0380
@RT00380 DS    0H                                                  0381
*                DO;                                       /*@YL026UA*/
*                ALSTID = BADGENER;                        /*@YL026UA*/
         MVC   ALSTID(5),@CB01070                                  0382
*                DARGLIST = ''B;                           /*@YL026UA*/
         L     @06,DDSTRU                                          0383
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0383
*                DARGDBP = NULLPTR;                        /*@YL026UA*/
         SLR   @15,@15                                             0384
         ST    @15,DARGDBP(,@06)                                   0384
*                DARGSMOD = ALMODID;                       /*@YL026UA*/
         MVC   DARGSMOD(3,@06),ALMODID                             0385
*                DARGSENT = ALSTD;                         /*@YL026UA*/
         IC    @14,ALSTD                                           0386
         STC   @14,DARGSENT(,@06)                                  0386
*                DARGILP  = 0;                             /*@YL026UA*/
         STH   @15,DARGILP(,@06)                                   0387
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@YL026UA*/
         L     @06,@PC00001                                        0388
         ST    @06,@AL00001                                        0388
         LA    @15,@CF00117                                        0388
         ST    @15,@AL00001+4                                      0388
         LA    @15,DDSTRU                                          0388
         ST    @15,@AL00001+8                                      0388
         MVI   @AL00001+8,X'80'                                    0388
         L     @15,GDTPRT(,@06)                                    0388
         LA    @01,@AL00001                                        0388
         BALR  @14,@15                                             0388
*                ALSTID = TERMERR;                         /*@YL026UA*/
         MVC   ALSTID(5),@CB01042                                  0389
*                END;                                      /*@YL026UA*/
*          END;                                            /*@YL026UA*/
*                                                                  0391
@RF00380 DS    0H                                                  0392
*        IF ALSTID = NORMAL                                        0392
*          THEN                                                    0392
*                                                                  0392
@RF00375 CLC   ALSTID(5),@CB01034                                  0392
         BNE   @RF00392                                            0392
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY IS FOR PDS MEMBER RENAME -         @YL026UA*/
*        /*  RENAME THE MEMBER IN ITS DIRECTORY              @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0393
*          IF NTRYMLN ^= 0                                         0393
*            THEN                                                  0393
         L     @06,@PC00001+4                                      0393
         L     @06,FDTPTR(,@06)                                    0393
         CLI   NTRYMLN(@06),0                                      0393
         BE    @RF00393                                            0393
*              DO;                                         /*@YL026UA*/
*                CALL MEMRENAM;                            /*@YL026UA*/
         BAL   @14,MEMRENAM                                        0395
*                RESPECIFY RTNREG RSTD;                            0396
*                TESTRC = RTNREG;                                  0397
         STH   RTNREG,TESTRC                                       0397
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/
*                LASTCC = MAX(TESTRC,LASTCC);              /*@YL026UA*/
         L     @06,@PC00001+8                                      0399
         LH    @15,TESTRC                                          0399
         LH    @14,LASTCC(,@06)                                    0399
         CR    @15,@14                                             0399
         BNL   *+6
         LR    @15,@14                                             0399
         STH   @15,LASTCC(,@06)                                    0399
*              END;                                        /*@YL026UA*/
*            ELSE                                                  0401
*                                                                  0401
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY IS FOR PDS MEMBER RENAME -         @YL026UA*/
*        /*  PROCESSING IS COMPLETE AT THIS POINT            @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0401
*NOTPDS:   DO;                                             /*@YL026UA*/
*                                                                  0401
         B     @RC00393                                            0401
@RF00393 DS    0H                                                  0401
NOTPDS   DS    0H                                                  0402
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY IS GENERIC - ISSUE UCIR MACRO TO   @YL026UA*/
*        /*  OBTAIN THE LIST OF ENTRIES SATISFYING THE GENERIC NAME  */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0402
*          IF NTRYPOS ^= 0                                         0402
*            THEN                                                  0402
         L     @06,@PC00001+4                                      0402
         L     @06,FDTPTR(,@06)                                    0402
         CLI   NTRYPOS(@06),0                                      0402
         BE    @RF00402                                            0402
*              DO;                                         /*@YL026UA*/
*                CIRPTR = ADDR(CIRLIST);                   /*@YL026UA*/
         LA    @15,CIRLIST                                         0404
         ST    @15,CIRPTR                                          0404
*                CIRLIST = ''B;                            /*@YL026UA*/
         XC    CIRLIST(32),CIRLIST                                 0405
*                CIRTYP1Q = ON;                            /*@YL026UA*/
         OI    CIRTYP1Q(@15),B'10000000'                           0406
*                CIRHLN = NTRYPOS - 1;                     /*@YL026UA*/
         SLR   @14,@14                                             0407
         IC    @14,NTRYPOS(,@06)                                   0407
         LR    @06,@14                                             0407
         BCTR  @06,0                                               0407
         STH   @06,CIRHLN(,@15)                                    0407
*                CIRHDR = ADDR(ENTRYVAL);                  /*@YL026UA*/
         LA    @06,ENTRYVAL                                        0408
         ST    @06,CIRHDR(,@15)                                    0408
*                IF ENTRYLEN ^= NTRYPOS                            0409
*                  THEN                                            0409
         LH    @05,ENTRYLEN                                        0409
         CR    @05,@14                                             0409
         BE    @RF00409                                            0409
*                    DO;                                   /*@YL026UA*/
*                CIRTLR = CIRHDR + NTRYPOS;                /*@YL026UA*/
         ALR   @06,@14                                             0411
         ST    @06,CIRTLR(,@15)                                    0411
*                CIRTLN = ENTRYLEN - NTRYPOS;              /*@YL026UA*/
         SLR   @05,@14                                             0412
         STH   @05,CIRTLN(,@15)                                    0412
*                    END;                                  /*@YL026UA*/
*                CIRWKP = ADDR(GENWKPTR);                  /*@YL026UA*/
@RF00409 L     @06,CIRPTR                                          0414
         LA    @15,GENWKPTR                                        0414
         ST    @15,CIRWKP(,@06)                                    0414
*                IF NTRYPLN ^= 0                                   0415
*                  THEN                                            0415
         L     @15,@PC00001+4                                      0415
         L     @15,FDTPTR(,@15)                                    0415
         CLI   NTRYPLN(@15),0                                      0415
         BE    @RF00415                                            0415
*                     CIRPWD = ADDR(NTRYPAS);              /*@YL026UA*/
         LA    @15,NTRYPAS(,@15)                                   0416
         ST    @15,CIRPWD(,@06)                                    0416
*                IF ADDR(CATLG) ^= NULLPTR & CATLGLEN ^= 0         0417
*                  THEN                                            0417
@RF00415 L     @06,@PC00001+4                                      0417
         L     @06,FDTPTR+8(,@06)                                  0417
         LTR   @06,@06                                             0417
         BZ    @RF00417                                            0417
         CLI   CATLGLEN(@06),0                                     0417
         BE    @RF00417                                            0417
*                    DO;                                   /*@YL026UA*/
*                      CIRCAT = ADDR(CATLGVAL);            /*@YL026UA*/
         L     @15,CIRPTR                                          0419
         LA    @14,CATLGVAL(,@06)                                  0419
         ST    @14,CIRCAT(,@15)                                    0419
*                      IF CATLGPLN ^= 0                            0420
*                        THEN                                      0420
         CLI   CATLGPLN(@06),0                                     0420
         BE    @RF00420                                            0420
*                          CIRPWD = ADDR(CATLGPAS);        /*@YL026UA*/
         LA    @06,CATLGPAS(,@06)                                  0421
         ST    @06,CIRPWD(,@15)                                    0421
*                    END;                                  /*@YL026UA*/
@RF00420 DS    0H                                                  0423
*                CIRPID = ALGPID2;                         /*@OZ02157*/
*                                                                  0423
@RF00417 L     @06,CIRPTR                                          0423
         MVC   CIRPID(4,@06),ALGPID2                               0423
*                CALL IDCSACR0(GDTTBL,CIRAGL);             /*@YL026UA*/
*                                                                  0424
         L     @15,@PC00001                                        0424
         ST    @15,@AL00001                                        0424
         ST    @06,@AL00001+4                                      0424
         MVI   @AL00001+4,X'80'                                    0424
         L     @15,GDTCIR(,@15)                                    0424
         LA    @01,@AL00001                                        0424
         BALR  @14,@15                                             0424
*                RESPECIFY RTNREG RSTD;                            0425
*                TESTRC = RTNREG;                                  0426
         STH   RTNREG,TESTRC                                       0426
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/
*                IF TESTRC ^= 0                                    0428
*                  THEN                                            0428
         LH    @06,TESTRC                                          0428
         LTR   @06,@06                                             0428
         BZ    @RF00428                                            0428
*                    ALSTID = TERMERR;                     /*@YL026UA*/
         MVC   ALSTID(5),@CB01042                                  0429
*                  ELSE                                            0430
*                                                                  0430
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  SET LOOP CONTROL FOR GENLOOP (USED BY GENERIC   @YL026UA*/
*        /*  & NON-GENERIC) WITH ONLY 1 PASS THRU LOOP FOR NONGENERIC*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0430
*                    GENCNT = GENNUM;                      /*@YL026UA*/
         B     @RC00428                                            0430
@RF00428 L     @06,GENWKPTR                                        0430
         L     @06,GENNUM(,@06)                                    0430
         ST    @06,GENCNT                                          0430
*              END;                                        /*@YL026UA*/
*            ELSE                                                  0432
*              DO;                                         /*@YL026UA*/
         B     @RC00402                                            0432
@RF00402 DS    0H                                                  0433
*                GENCNT = 1;                               /*@YL026UA*/
         MVC   GENCNT(4),@CF00220                                  0433
*                ATYPE = 0;                                /*@YL026UA*/
         MVI   ATYPE,X'00'                                         0434
*                GENWKPTR = ADDR(ENTRIES);                 /*@YL026UA*/
         LA    @06,ENTRIES                                         0435
         ST    @06,GENWKPTR                                        0435
*              END;                                        /*@YL026UA*/
*GENLOOP: DO ENT = 1 TO GENCNT WHILE LASTCC < LASTCC12             0437
*                                   & ALSTID = NORMAL;     /*@OZ01484*/
*                                                                  0437
@RC00402 DS    0H                                                  0437
GENLOOP  LA    @06,1                                               0437
         B     @DE00437                                            0437
@DL00437 L     @15,@PC00001+8                                      0437
         LH    @15,LASTCC(,@15)                                    0437
         C     @15,@CF00035                                        0437
         BNL   @DC00437                                            0437
         CLC   ALSTID(5),@CB01034                                  0437
         BNE   @DC00437                                            0437
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY IS GENERIC - GET THE CATALOG NAME  @YL026UA*/
*        /*  FROM THE LIST TO USE IN DIRECTING THE ALTER     @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0438
*      IF ENTTYP(ENT) = '0'                                        0438
*        THEN                                                      0438
         L     @15,GENWKPTR                                        0438
         MH    @06,@CH00687                                        0438
         ST    @06,@TF00001                                        0438
         ALR   @06,@15                                             0438
         AL    @06,@CF01684                                        0438
         CLI   ENTTYP-4(@06),C'0'                                  0438
         BNE   @RF00438                                            0438
*            CATNAME = ENTVAL(ENT);                        /*@YL026UA*/
         AL    @15,@TF00001                                        0439
         AL    @15,@CF01685                                        0439
         MVC   CATNAME(44),ENTVAL-5(@15)                           0439
*        ELSE                                                      0440
*SAMECAT:  DO;                                             /*@YL026UA*/
         B     @RC00438                                            0440
@RF00438 DS    0H                                                  0440
SAMECAT  DS    0H                                                  0441
*              IF NEWNMPOS ^= 0 & ADDR(NEWNM) ^= NULLPTR           0441
*              THEN                                                0441
         L     @06,@PC00001+4                                      0441
         L     @06,FDTPTR+16(,@06)                                 0441
         CLI   NEWNMPOS(@06),0                                     0441
         BE    @RF00441                                            0441
         LTR   @06,@06                                             0441
         BZ    @RF00441                                            0441
*                DO;                                       /*@YL026UA*/
*                                                                  0442
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  BUILD A NEWNAME BY REPLACING THE * WITH THE     @YL026UA*/
*        /*  LEVEL THAT REPLACED THE * IN THE ENTRYNAME      @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0443
*                  NEWNAME = NEWNMVAL(1:NEWNMPOS);         /*@YL026UA*/
         MVI   NEWNAME+1,C' '                                      0443
         MVC   NEWNAME+2(42),NEWNAME+1                             0443
         SLR   @15,@15                                             0443
         IC    @15,NEWNMPOS(,@06)                                  0443
         BCTR  @15,0                                               0443
         EX    @15,@SM01686                                        0443
*NAMEBLD: DO I = NTRYPOS TO 44;                            /*@YL026UA*/
NAMEBLD  L     @06,@PC00001+4                                      0444
         L     @06,FDTPTR(,@06)                                    0444
         SLR   @15,@15                                             0444
         IC    @15,NTRYPOS(,@06)                                   0444
         B     @DE00444                                            0444
@DL00444 DS    0H                                                  0445
*           IF ENTVAL(ENT,I) = '.' × ENTVAL(ENT,I) = ' '           0445
*           THEN                                                   0445
         L     @06,GENWKPTR                                        0445
         L     @14,ENT                                             0445
         MH    @14,@CH00687                                        0445
         ALR   @14,@15                                             0445
         ST    @14,@TF00001                                        0445
         ALR   @14,@06                                             0445
         AL    @14,@CF01684                                        0445
         CLI   ENTVAL-5(@14),C'.'                                  0445
         BE    @RT00445                                            0445
         AL    @06,@TF00001                                        0445
         AL    @06,@CF01684                                        0445
         CLI   ENTVAL-5(@06),C' '                                  0445
         BNE   @RF00445                                            0445
@RT00445 DS    0H                                                  0446
*             IF ((NEWNMPOS - 1) + (I - NTRYPOS) +                 0446
*               (NEWNMLEN - NEWNMPOS)) ^> 44                       0446
*             THEN                                                 0446
         LA    @06,44                                              0446
         L     @15,@PC00001+4                                      0446
         L     @14,FDTPTR+16(,@15)                                 0446
         SLR   @05,@05                                             0446
         IC    @05,NEWNMPOS(,@14)                                  0446
         LR    @04,@05                                             0446
         BCTR  @04,0                                               0446
         L     @03,I                                               0446
         L     @01,FDTPTR(,@15)                                    0446
         SLR   @02,@02                                             0446
         IC    @02,NTRYPOS(,@01)                                   0446
         LR    @15,@03                                             0446
         SLR   @15,@02                                             0446
         ALR   @04,@15                                             0446
         SLR   @15,@15                                             0446
         IC    @15,NEWNMLEN(,@14)                                  0446
         SLR   @15,@05                                             0446
         ALR   @04,@15                                             0446
         CR    @04,@06                                             0446
         BH    @RF00446                                            0446
*               DO;                                        /*@YL026UA*/
*                 NEWNAME(NEWNMPOS:NEWNMPOS + I - NTRYPOS) =       0448
*                 ENTVAL(ENT,NTRYPOS:I);                   /*@YL026UA*/
         LA    @04,NEWNAME-1(@05)                                  0448
         ALR   @03,@05                                             0448
         SLR   @03,@02                                             0448
         LR    @15,@03                                             0448
         SLR   @15,@05                                             0448
         L     @01,ENT                                             0448
         MH    @01,@CH00687                                        0448
         ALR   @01,@02                                             0448
         L     @02,GENWKPTR                                        0448
         ALR   @02,@01                                             0448
         AL    @02,@CF01684                                        0448
         EX    @15,@SM01688                                        0448
*                 NEWNAME(NEWNMPOS + I - NTRYPOS:44) =             0449
*                 NEWNMVAL(NEWNMPOS + 1:44);               /*@YL026UA*/
         LA    @02,NEWNAME-1(@03)                                  0449
         SLR   @06,@03                                             0449
         ALR   @14,@05                                             0449
         EX    @06,@SM01690                                        0449
*                 I=50;                                    /*@YL026UA*/
         MVC   I(4),@CF00724                                       0450
*               END;                                       /*@YL026UA*/
*             ELSE                                                 0452
*               ALSTID = BADNEWNM;                         /*@YL026UA*/
         B     @RC00446                                            0452
@RF00446 MVC   ALSTID(5),@CB01064                                  0452
*         END NAMEBLD;                                     /*@YL026UA*/
@RC00446 DS    0H                                                  0453
@RF00445 LA    @15,1                                               0453
         AL    @15,I                                               0453
@DE00444 ST    @15,I                                               0453
         C     @15,@CF00594                                        0453
         BNH   @DL00444                                            0453
*           IF I = 45                                              0454
*             THEN                                                 0454
         L     @06,I                                               0454
         LA    @15,45                                              0454
         CR    @06,@15                                             0454
         BNE   @RF00454                                            0454
*             IF ((NEWNMPOS - 1) + (I - NTRYPOS) +                 0455
*               (NEWNMLEN - NEWNMPOS)) ^> 44                       0455
*             THEN                                                 0455
         LA    @14,44                                              0455
         L     @05,@PC00001+4                                      0455
         L     @04,FDTPTR+16(,@05)                                 0455
         SLR   @03,@03                                             0455
         IC    @03,NEWNMPOS(,@04)                                  0455
         LR    @02,@03                                             0455
         BCTR  @02,0                                               0455
         L     @01,FDTPTR(,@05)                                    0455
         SLR   @05,@05                                             0455
         IC    @05,NTRYPOS(,@01)                                   0455
         LR    @01,@06                                             0455
         SLR   @01,@05                                             0455
         ALR   @02,@01                                             0455
         SLR   @01,@01                                             0455
         IC    @01,NEWNMLEN(,@04)                                  0455
         SLR   @01,@03                                             0455
         ALR   @02,@01                                             0455
         CR    @02,@14                                             0455
         BH    @RF00455                                            0455
*               DO;                                        /*@YL026UA*/
*                 NEWNAME(NEWNMPOS:NEWNMPOS + I - NTRYPOS) =       0457
*                 ENTVAL(ENT,NTRYPOS:I);                   /*@YL026UA*/
         LA    @02,NEWNAME-1(@03)                                  0457
         ALR   @06,@03                                             0457
         SLR   @06,@05                                             0457
         LR    @01,@06                                             0457
         SLR   @01,@03                                             0457
         M     @14,ENT                                             0457
         ALR   @15,@05                                             0457
         L     @14,GENWKPTR                                        0457
         ALR   @14,@15                                             0457
         AL    @14,@CF01684                                        0457
         EX    @01,@SM01692                                        0457
*                 NEWNAME(NEWNMPOS + I - NTRYPOS:44) =             0458
*                 NEWNMVAL(NEWNMPOS + 1:44);               /*@YL026UA*/
         LA    @01,NEWNAME-1(@06)                                  0458
         LA    @05,44                                              0458
         SLR   @05,@06                                             0458
         ALR   @04,@03                                             0458
         EX    @05,@SM01694                                        0458
*               END;                                       /*@YL026UA*/
*             ELSE                                                 0460
*               ALSTID = BADNEWNM;                         /*@YL026UA*/
         B     @RC00455                                            0460
@RF00455 MVC   ALSTID(5),@CB01064                                  0460
*                  END;                                    /*@YL026UA*/
@RC00455 DS    0H                                                  0461
@RF00454 DS    0H                                                  0462
*        /************************************************************/
*        /*                                                          */
*        /* CURRENT ATTRIBUTES OF COMPLEX FIELDS MUST BE LOCATED SO  */
*        /* ALTERATIONS MAY BE DONE IN CONTEXT - VERIFY THE NEED FOR */
*        /* LOCATING THE ORIGINAL ENTRY.                             */
*        /* THIS SERIES WILL CAUSE INVOCATION OF 'LOCATPRC' IF ANY   */
*        /* ATTRIBUTE OF A COMPLEX FIELD IS TO BE ALTERED, THE ADDR  */
*        /* OF FDT VALUES MUST HAVE A NON-NULL VALUE  FOR INVOCATION */
*        /* TO OCCUR.                                                */
*        /*                                                          */
*        /************************************************************/
*        IF ALSTID = NORMAL                                        0462
*          THEN                                                    0462
@RF00441 CLC   ALSTID(5),@CB01034                                  0462
         BNE   @RF00462                                            0462
*            IF ((ADDR(MASTR)) ^= NULLPTR ×                        0463
*               (ADDR(CNTVL)) ^= NULLPTR  ×                        0463
*               (ADDR(UPDAT)) ^= NULLPTR  ×                        0463
*               (ADDR(READ))  ^= NULLPTR  ×                        0463
*               (ADDR(CODNM)) ^= NULLPTR  ×                        0463
*               (ADDR(ATTP))  ^= NULLPTR  ×                        0463
*               (ADDR(AUTH))  ^= NULLPTR  ×                        0463
*               (ADDR(NMSTR)) ^= NULLPTR  ×                        0463
*               (ADDR(NCNTV)) ^= NULLPTR  ×                        0463
*               (ADDR(NUPDT)) ^= NULLPTR  ×                        0463
*               (ADDR(NREAD)) ^= NULLPTR  ×                        0463
*               (ADDR(NCDNM)) ^= NULLPTR  ×                        0463
*               (ADDR(NAUTH)) ^= NULLPTR  ×                        0463
*               (ADDR(ERASE)) ^= NULLPTR  ×                        0463
*               (ADDR(NERAS)) ^= NULLPTR  ×                        0463
*               (ADDR(SHAR1)) ^= NULLPTR  ×                        0463
*               (ADDR(FSPAC)) ^= NULLPTR  ×                        0463
*               (ADDR(WRTCK)) ^= NULLPTR  ×                        0463
*               (ADDR(NWTCK)) ^= NULLPTR  ×                        0463
*               (ADDR(INHIB)) ^= NULLPTR  ×                        0463
*               (ADDR(UNHIB)) ^= NULLPTR  ×                        0463
*               (ADDR(GDGEM)) ^= NULLPTR  ×                        0463
*               (ADDR(GDGNE)) ^= NULLPTR  ×                        0463
*               (ADDR(GDGSC)) ^= NULLPTR  ×                        0463
*               (ADDR(GDGNS)) ^= NULLPTR  ×                        0463
*               (ADDR(UPG))   ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(UNQK))  ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(NUNQK)) ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(KEY))   ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(RECSZ)) ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(STAGE)) ^= NULLPTR  ×                /*@Y30LSJH*/
*               (ADDR(BIND))  ^= NULLPTR  ×                /*@Y30LSJH*/
*               (ADDR(CYLF))  ^= NULLPTR  ×                /*@Y30LSJH*/
*               (ADDR(NSTGW)) ^= NULLPTR  ×                /*@Y30LSJH*/
*               (ADDR(STGW))  ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(ADDVL)) ^= NULLPTR  ×                /*@Y30SSJH*/
*               (ADDR(REMVL)) ^= NULLPTR  )                /*@Y30SSJH*/
*                                                                  0463
*              THEN                                                0463
         SLR   @06,@06                                             0463
         L     @15,@PC00001+4                                      0463
         C     @06,FDTPTR+28(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+32(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+36(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+40(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+44(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+48(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+52(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+100(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+104(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+108(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+112(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+168(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+176(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+80(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+84(,@15)                                 0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+188(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+120(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+132(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+136(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+156(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+160(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+196(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+200(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+204(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+208(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+252(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+244(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+248(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+220(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+232(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+272(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+276(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+280(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+284(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+288(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+144(,@15)                                0463
         BNE   @RT00463                                            0463
         C     @06,FDTPTR+148(,@15)                                0463
         BE    @RF00463                                            0463
@RT00463 DS    0H                                                  0464
*                DO;                                       /*@Y30SSJH*/
*                                                                  0464
*                CALL LOCATPRC;                            /*@Y30SSJH*/
*                                                                  0465
         BAL   @14,LOCATPRC                                        0465
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* IF ANY PARAMETERS HAVE BEEN SPECIFIED    @Y30SSJH*/
*                /* WHICH REQUIRE FURTHER CHECKING, CAUSE    @Y30SSJH*/
*                /* INVOCATION OF 'CHECKPRC'                 @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  0466
*                IF ALSTID = NORMAL                                0466
*                  THEN                                            0466
         CLC   ALSTID(5),@CB01034                                  0466
         BNE   @RF00466                                            0466
*                    IF ((ADDR(UPG))  ^= NULLPTR ×                 0467
*                       (ADDR(UNQK))  ^= NULLPTR ×                 0467
*                       (ADDR(KEY))   ^= NULLPTR ×                 0467
*                       (ADDR(RECSZ)) ^= NULLPTR )                 0467
*                      THEN                                        0467
         SLR   @06,@06                                             0467
         L     @15,@PC00001+4                                      0467
         C     @06,FDTPTR+252(,@15)                                0467
         BNE   @RT00467                                            0467
         C     @06,FDTPTR+244(,@15)                                0467
         BNE   @RT00467                                            0467
         C     @06,FDTPTR+220(,@15)                                0467
         BNE   @RT00467                                            0467
         C     @06,FDTPTR+232(,@15)                                0467
         BE    @RF00467                                            0467
@RT00467 DS    0H                                                  0468
*                        CALL CHECKPRC;                    /*@Y30SSJH*/
*                                                                  0468
         BAL   @14,CHECKPRC                                        0468
*                /****************************************************/
*                /*                                          @OZ05940*/
*                /* CALL PARAMCHK TO VERIFY THAT PARAMETERS  @OZ05940*/
*                /* SPECIFIED ON THE ALTER COMMAND ARE VALID @OZ05940*/
*                /* FOR THE ENTRY TYPE.                      @OZ05940*/
*                /*                                          @OZ05940*/
*                /****************************************************/
*                                                                  0469
*                IF ALSTID = NORMAL                                0469
*                  THEN                                            0469
@RF00467 DS    0H                                                  0469
@RF00466 CLC   ALSTID(5),@CB01034                                  0469
         BNE   @RF00469                                            0469
*                    CALL PARAMCHK(LCETYPVL);              /*@OZ05940*/
*                                                                  0470
         L     @06,LCETYPPT                                        0470
         ST    @06,@AL00001                                        0470
         LA    @01,@AL00001                                        0470
         BAL   @14,PARAMCHK                                        0470
*                END;                                      /*@Y30SSJH*/
*                                                                  0471
@RF00469 DS    0H                                                  0472
*                                                                  0472
*        /************************************************************/
*        /*                                                          */
*        /* ALTERPRC BUILDS THE CPL/FVT/FPL INTERFACE FOR THE ALTER  */
*        /* REQUEST.  THE FDTTBL IS KNOWN TO ALTERPRC AS IS THE      */
*        /* LOCTABLE. THE INFORMATION FROM THE FDTTBL AND LOCTABLE   */
*        /* IS USED TO BUILD THE INTERFACE - THE INTERFACE STRUCTURE */
*        /* IS BUILT IN ALCTGPRM                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0472
*        IF ALSTID = NORMAL                                        0472
*          THEN                                                    0472
@RF00463 DS    0H                                                  0472
@RF00462 CLC   ALSTID(5),@CB01034                                  0472
         BNE   @RF00472                                            0472
*            CALL ALTERPRC(                                        0473
*              CATACBPT);               /* ADDRESS OF CATLG ACB      */
*                                                                  0473
         LA    @06,CATACBPT                                        0473
         ST    @06,@AL00001                                        0473
         LA    @01,@AL00001                                        0473
         BAL   @14,ALTERPRC                                        0473
*        /************************************************************/
*        /*                                                          */
*        /* THE ALTER INTERFACE HAS BEEN BUILT INVOKE VSAM CATALOG   */
*        /* MANAGEMENT. THE CPL IS REFERENCED BY THE UCATLG MACRO    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0474
*        IF GDTDBG = NULLPTR                                       0474
*          THEN;                                                   0474
@RF00472 L     @06,@PC00001                                        0474
         L     @06,GDTDBG(,@06)                                    0474
         LTR   @06,@06                                             0474
         BZ    @RT00474                                            0474
*          ELSE                                                    0476
*            CALL IDCDB010(GDTTBL,'AL01');                         0476
*                                                                  0476
         L     @06,@PC00001                                        0476
         ST    @06,@AL00001                                        0476
         LA    @15,@CC01147                                        0476
         ST    @15,@AL00001+4                                      0476
         MVI   @AL00001+4,X'80'                                    0476
         L     @15,GDTDBG(,@06)                                    0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*        IF ALSTID = NORMAL                                        0477
*          THEN                                                    0477
@RT00474 CLC   ALSTID(5),@CB01034                                  0477
         BNE   @RF00477                                            0477
*            DO;                                                   0478
*            DEFINED = ON;                                 /*@YL026UA*/
*                                                                  0479
         OI    DEFINED,B'10000000'                                 0479
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  CALL THE VSAM CATALOG WITH REGISTER 1 POINTING TO THE   */
*        /*  CATALOG PARAMETER LIST (CATALOG LOOP IS NECESSARY IF    */
*        /*  NONVSAM OR UNIQUE WERE DEFINED FOR THE ENTRY SO @YL026UA*/
*        /*  THAT IT CAN BE DYNAMICALLY ALLOCATED AND THE    @YL026UA*/
*        /*  UCATLG REISSUED                                 @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0480
*CATALOG: DO N = 1  TO  2  BY  1                           /*@YL026UA*/
*              WHILE ( DEFINED = ON );                             0480
CATALOG  LA    @06,1                                               0480
         ST    @06,N                                               0480
@DL00480 TM    DEFINED,B'10000000'                                 0480
         BNO   @DC00480                                            0480
*            DEFINED = OFF;                                /*@YL026UA*/
         NI    DEFINED,B'01111111'                                 0481
*            RENEWCPL = CTGPL;                             /*@YL026UA*/
*                                                                  0482
         L     @06,CTGPLPTR                                        0482
         MVC   RENEWCPL(28),CTGPL(@06)                             0482
*            CALL IDCSACA0 (GDTTBL,CTGPLPTR);                      0483
*                                                                  0483
         L     @06,@PC00001                                        0483
         ST    @06,@AL00001                                        0483
         LA    @15,CTGPLPTR                                        0483
         ST    @15,@AL00001+4                                      0483
         L     @15,GDTCAT(,@06)                                    0483
         LA    @01,@AL00001                                        0483
         BALR  @14,@15                                             0483
*            /********************************************************/
*            /*                                                      */
*            /* SAVE CATALOG RETURN CODE, RTNREG, THEN INTERROGATE   */
*            /* THE RETURN CODE. A NONZERO RETURN CODE CAUSES ALSTID */
*            /* TO BE SET INDICATING A CATALOG ERROR. TERMINATION    */
*            /* WILL ISSUE THE CATALOG ERROR MESSAGE, USING THE VALUE*/
*            /* SAVED IN CTGRTNCC.                                   */
*            /*                                                      */
*            /********************************************************/
*                                                                  0484
*        RESPECIFY (RTNREG) RSTD;                          /*@Y30SSJH*/
*        CTGRTNCC = RTNREG;                                /*@YL026UA*/
         ST    RTNREG,CTGRTNCC                                     0485
*        RESPECIFY (RTNREG) UNRSTD;                        /*@Y30SSJH*/
*                                                                  0486
*        IF CTGRTNCC ^= 0                                          0487
*          THEN                                                    0487
*                                                                  0487
         L     @06,CTGRTNCC                                        0487
         LTR   @06,@06                                             0487
         BZ    @RF00487                                            0487
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY NEEDED ALLOCATION - ISSUE THE      @YL026UA*/
*        /*  UALLOC TO DYNAMICALLY ALLOCATE IT               @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0488
*            IF ( CTGRTNCC = 240 ×                         /*@Y30LSJH*/
*                 CTGRTNCC = 72  ×                         /*@Y30SSJH*/
*                 CTGRTNCC = 76  ×                         /*@Y30SSJH*/
*                 ( CTGRTNCC = 136 & CTGFBFLG = 22 ))  &   /*@Y30SSJH*/
*                 N = 1                                    /*@Y30SSJH*/
*              THEN                                                0488
         C     @06,@CF01421                                        0488
         BE    @GL00049                                            0488
         C     @06,@CF00770                                        0488
         BE    @GL00049                                            0488
         C     @06,@CF01422                                        0488
         BE    @GL00049                                            0488
         C     @06,@CF01423                                        0488
         BNE   @RF00488                                            0488
         L     @06,CTGPLPTR                                        0488
         CLC   CTGFBFLG(2,@06),@CH00662                            0488
         BNE   @RF00488                                            0488
@GL00049 CLC   N(4),@CF00220                                       0488
         BNE   @RF00488                                            0488
*                DO;                                       /*@Y30SSJH*/
*                ALLPTR = ADDR(ALLLIST);                   /*@YL026UA*/
         LA    @06,ALLLIST                                         0490
         ST    @06,ALLPTR                                          0490
*                ALLAGL = ''B;                             /*@YL026UA*/
         XC    ALLAGL(31,@06),ALLAGL(@06)                          0491
*                ALLDSN = ADDR(ENTVAL(ENT));               /*@YL026UA*/
         L     @15,ENT                                             0492
         MH    @15,@CH00687                                        0492
         L     @01,GENWKPTR                                        0492
         AL    @01,@CF01685                                        0492
         LA    @15,ENTVAL-5(@15,@01)                               0492
         ST    @15,ALLDSN(,@06)                                    0492
*                IF NTRYPLN ^= 0                                   0493
*                  THEN                                            0493
         L     @15,@PC00001+4                                      0493
         L     @15,FDTPTR(,@15)                                    0493
         CLI   NTRYPLN(@15),0                                      0493
         BE    @RF00493                                            0493
*                    ALLPWD = ADDR(NTRYPAS);               /*@YL026UA*/
         LA    @15,NTRYPAS(,@15)                                   0494
         ST    @15,ALLPWD(,@06)                                    0494
*                ALLOPTVL = OFF;                           /*@YL026UA*/
@RF00493 DS    0H                                                  0496
*                ALLOPTDS = ON;                            /*@YL026UA*/
         L     @06,ALLPTR                                          0496
         OI    ALLOPTDS(@06),B'01000000'                           0496
         NI    ALLOPTVL(@06),B'01111111'                           0496
*                ALLSTSOD = ON;                            /*@YL026UA*/
         OI    ALLSTSOD(@06),B'00000001'                           0497
*                ALLDSPKP = ON;                            /*@YL026UA*/
         OI    ALLDSPKP(@06),B'00001000'                           0498
*                CALL IDCSAAL0(GDTTBL,ALLAGL);             /*@YL026UA*/
         L     @15,@PC00001                                        0499
         ST    @15,@AL00001                                        0499
         ST    @06,@AL00001+4                                      0499
         MVI   @AL00001+4,X'80'                                    0499
         L     @15,GDTALC(,@15)                                    0499
         LA    @01,@AL00001                                        0499
         BALR  @14,@15                                             0499
*                RESPECIFY RTNREG RSTD;                            0500
*                TESTRC = RTNREG;                                  0501
         STH   RTNREG,TESTRC                                       0501
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/
*                IF TESTRC = 0                                     0503
*                  THEN                                            0503
*                                                                  0503
         LH    @06,TESTRC                                          0503
         LTR   @06,@06                                             0503
         BNZ   @RF00503                                            0503
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  UPON SUCCESSFUL ALLOCATION - PUT THE ADDRESS OF @YL026UA*/
*        /*  THE DDNAME IN THE RENEWED CPL AND GO REISSUE THE UCATLG */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0504
*                    DO;                                   /*@YL026UA*/
*                    DALCINDX = DALCINDX + 1;              /*@Y30SSJH*/
         LA    @06,1                                               0505
         AL    @06,DALCINDX                                        0505
         ST    @06,DALCINDX                                        0505
*                    ALSAVPTR(DALCINDX) = ALLPTR;          /*@Y30SSJH*/
         L     @15,ALLPTR                                          0506
         SLA   @06,2                                               0506
         ST    @15,ALSAVPTR-4(@06)                                 0506
*                    CTGPL = RENEWCPL;                     /*@YL026UA*/
         L     @06,CTGPLPTR                                        0507
         MVC   CTGPL(28,@06),RENEWCPL                              0507
*                    CTGFVIND = ADDR(ALLDDN);              /*@YL026UG*/
         L     @06,CTGFVT(,@06)                                    0508
         LA    @15,ALLDDN(,@15)                                    0508
         ST    @15,CTGFVIND(,@06)                                  0508
*                    DEFINED = ON;                         /*@YL026UA*/
         OI    DEFINED,B'10000000'                                 0509
*                    END;                                  /*@YL026UA*/
*                  ELSE                                            0511
*                    ALSTID = NOENTALT;                    /*@YL026UA*/
         B     @RC00503                                            0511
@RF00503 MVC   ALSTID(5),@CB01058                                  0511
*                  END;                                    /*@YL026UA*/
*                ELSE                                              0513
*                  ALSTID = CATERROR;                      /*@YL026UA*/
*                                                                  0513
         B     @RC00488                                            0513
@RF00488 MVC   ALSTID(5),@CB01016                                  0513
*            END CATALOG;                                  /*@YL026UA*/
@RC00488 DS    0H                                                  0514
@RF00487 LA    @06,1                                               0514
         AL    @06,N                                               0514
         ST    @06,N                                               0514
         C     @06,@CF00155                                        0514
         BNH   @DL00480                                            0514
@DC00480 DS    0H                                                  0515
*            END;                                          /*@YL026UA*/
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* IF KEYS HAS BEEN SPECIFIED, THE INDEX AMDSB MUST @Y30SSJH*/
*        /* ALSO BE ALTERED. CALL INDEXPRC TO CONSTRUCT THE  @Y30SSJH*/
*        /* CATALOG PARAMETER LIST BEFORE ISSUING THE ALTER  @Y30SSJH*/
*        /* REQUEST.                                         @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0516
*        IF ALSTID = NORMAL  &                                     0516
*           KEYRECRC = 0     &                                     0516
*           (ADDR(KEY)) ^= NULLPTR                                 0516
*          THEN                                                    0516
@RF00477 CLC   ALSTID(5),@CB01034                                  0516
         BNE   @RF00516                                            0516
         SLR   @06,@06                                             0516
         C     @06,KEYRECRC                                        0516
         BNE   @RF00516                                            0516
         L     @15,@PC00001+4                                      0516
         C     @06,FDTPTR+220(,@15)                                0516
         BE    @RF00516                                            0516
*            DO;                                           /*@Y30SSJH*/
*                                                                  0517
*            CALL INDEXPRC;                                /*@Y30SSJH*/
*                                                                  0518
         BAL   @14,INDEXPRC                                        0518
*            IF GDTDBG = NULLPTR                                   0519
*              THEN;                                               0519
         L     @06,@PC00001                                        0519
         L     @06,GDTDBG(,@06)                                    0519
         LTR   @06,@06                                             0519
         BZ    @RT00519                                            0519
*              ELSE                                                0521
*                CALL IDCDB010 (GDTTBL,'AL04');                    0521
         L     @06,@PC00001                                        0521
         ST    @06,@AL00001                                        0521
         LA    @15,@CC01425                                        0521
         ST    @15,@AL00001+4                                      0521
         MVI   @AL00001+4,X'80'                                    0521
         L     @15,GDTDBG(,@06)                                    0521
         LA    @01,@AL00001                                        0521
         BALR  @14,@15                                             0521
*                                                          /*@Y30SSJH*/
*                                                                  0522
*            IF ALSTID = NORMAL                                    0522
*              THEN                                                0522
@RT00519 CLC   ALSTID(5),@CB01034                                  0522
         BNE   @RF00522                                            0522
*                DO;                                       /*@Y30SSJH*/
*                                                                  0523
*                CALL IDCSACA0 (GDTTBL,CPLSAVE);           /*@Y30SSJH*/
*                                                                  0524
         L     @06,@PC00001                                        0524
         ST    @06,@AL00001                                        0524
         LA    @15,CPLSAVE                                         0524
         ST    @15,@AL00001+4                                      0524
         L     @15,GDTCAT(,@06)                                    0524
         LA    @01,@AL00001                                        0524
         BALR  @14,@15                                             0524
*                RESPECIFY (RTNREG) RSTD;                  /*@Y30SSJH*/
*                CTGRTNCC = RTNREG;                        /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     0526
*                RESPECIFY (RTNREG) UNRSTD;                /*@Y30SSJH*/
*                                                                  0527
*                IF CTGRTNCC ^= 0                                  0528
*                  THEN                                            0528
         L     @06,CTGRTNCC                                        0528
         LTR   @06,@06                                             0528
         BZ    @RF00528                                            0528
*                    DO;                                   /*@Y30SSJH*/
*                                                                  0529
*                    ALSTID = CATERROR;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  0530
*                    CTGPLPTR = CPLSAVE;                   /*@Y30SSJH*/
*                                                                  0531
         L     @06,CPLSAVE                                         0531
         ST    @06,CTGPLPTR                                        0531
*                    END;                                  /*@Y30SSJH*/
*                                                                  0532
*                END;                                      /*@Y30SSJH*/
*                                                                  0533
@RF00528 DS    0H                                                  0534
*            END;                                          /*@Y30SSJH*/
@RF00522 DS    0H                                                  0535
*                                                                  0535
*        /************************************************************/
*        /*                                                          */
*        /* LIST THE STATUS OF VOLUMES SPECIFIED VIA THE ADD/REMOVE  */
*        /* VOLUMES PARAMETER                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0535
*        IF ALSTID = NORMAL                                        0535
*          THEN                                                    0535
@RF00516 CLC   ALSTID(5),@CB01034                                  0535
         BNE   @RF00535                                            0535
*            DO;                                           /*@Y30SSJH*/
*            /********************************************************/
*            /*                                                      */
*            /* CTGFVVLT (POINTER IN ALTER FVT) INDICATES BY A NON-  */
*            /* NULL VALUE THE PRESENCE OF AN ALTER VOLUME LIST. THE */
*            /* VOLUMES IN THIS LIST ARE LISTED WITH THEIR STATUS AS */
*            /* INDICATED BY VSAM ON RETURN FROM CATALOG MANAGEMENT  */
*            /* EACH ENTRY IN THE VOLUME LIST IS 8 BYTES LONG.       */
*            /* . BYTE 1 - ALLOCATION STATUS(SET BY VSAM)            */
*            /* . BYTE 2 - RESERVED                                  */
*            /* . BYTE 3-8 - VOLUME SERIAL NUMBER                    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0537
*            IF CTGFVVLT ^= NULLPTR                                0537
*              THEN                                                0537
         L     @06,CTGPLPTR                                        0537
         L     @06,CTGFVT(,@06)                                    0537
         L     @06,CTGFVVLT(,@06)                                  0537
         LTR   @06,@06                                             0537
         BZ    @RF00537                                            0537
*                DO;                                               0538
*                /****************************************************/
*                /*                                                  */
*                /* BUILD THE TEXT PROCESSOR DARGLIST, WHICH COMMUN- */
*                /* ICATES THE REQUEST TO PRINT OUT VOLUME ALLOCATION*/
*                /* AND DEALLOCATION STATUS.                         */
*                /*                                                  */
*                /****************************************************/
*                                                                  0539
*                DARGLIST = ''B;          /* SET DARGLIST TO ZERO    */
         L     @15,DDSTRU                                          0539
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0539
*                DARGDBP  = CTGFVVLT + 2; /* SET POINTER TO VOL LIST */
         LA    @14,2                                               0540
         ALR   @14,@06                                             0540
         ST    @14,DARGDBP(,@15)                                   0540
*                DARGILP  = VLISTLEN;     /* LENGTH OF VOLUME LIST   */
         LH    @06,VLISTLEN(,@06)                                  0541
         STH   @06,DARGILP(,@15)                                   0541
*                DARGCNT  = 1;            /* REFERENCE GROUPS        */
         LA    @14,1                                               0542
         STH   @14,DARGCNT(,@15)                                   0542
*                DARGINS(1)  = 1;         /* # OF INSERTS IN MESSAGE */
         STH   @14,DARGINS(,@15)                                   0543
*                DARGPCT(1) = DARGILP / 8;/* REDO LOOP COUNT         */
         LR    @00,@06                                             0544
         SRDA  @00,32                                              0544
         D     @00,@CF00039                                        0544
         STH   @01,DARGPCT(,@15)                                   0544
*                DARGSMOD = 'AL0';        /* STATIC TEXT MODULE ID   */
         MVC   DARGSMOD(3,@15),@CC01426                            0545
*                DARGSENT = ALVLSTID;     /* MESSAGE ID              */
*                                                                  0546
         MVI   DARGSENT(@15),X'01'                                 0546
*                /****************************************************/
*                /*                                                  */
*                /* INVOKE IDCAMS TEXT PROCESSOR FOR PRINT REQUEST   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0547
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);            0547
*                                                                  0547
         L     @06,@PC00001                                        0547
         ST    @06,@AL00001                                        0547
         LA    @15,@CF00117                                        0547
         ST    @15,@AL00001+4                                      0547
         LA    @15,DDSTRU                                          0547
         ST    @15,@AL00001+8                                      0547
         MVI   @AL00001+8,X'80'                                    0547
         L     @15,GDTPRT(,@06)                                    0547
         LA    @01,@AL00001                                        0547
         BALR  @14,@15                                             0547
*                RESPECIFY RTNREG RSTD;                            0548
*                TESTRC = RTNREG;                                  0549
         STH   RTNREG,TESTRC                                       0549
*                RESPECIFY RTNREG UNRSTD;                          0550
*                                                                  0550
*                /****************************************************/
*                /*                                                  */
*                /* UPRINT ERROR - NOTE CONDITION IN STATUS FLAG     */
*                /*                                                  */
*                /****************************************************/
*                                                                  0551
*                IF TESTRC ^= 0                                    0551
*                  THEN                                            0551
         LH    @06,TESTRC                                          0551
         LTR   @06,@06                                             0551
         BZ    @RF00551                                            0551
*                    LASTCC = MAX(LASTCC,LASTCC04);        /*@Y30SSJH*/
*                                                                  0552
         L     @06,@PC00001+8                                      0552
         LH    @15,LASTCC(,@06)                                    0552
         LA    @14,4                                               0552
         CR    @15,@14                                             0552
         BNL   *+6
         LR    @15,@14                                             0552
         STH   @15,LASTCC(,@06)                                    0552
*                END;                                              0553
*                                                                  0553
@RF00551 DS    0H                                                  0554
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* PRINT KEYS/RECORDSIZE NON-TERMINAL ERR MSG @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  0554
*                IF ((ADDR(KEY)) ^= NULLPTR   ×                    0554
*                    (ADDR(RECSZ)) ^= NULLPTR )  &                 0554
*                    KEYRECRC ^= 0                                 0554
*                  THEN                                            0554
@RF00537 SLR   @06,@06                                             0554
         L     @15,@PC00001+4                                      0554
         C     @06,FDTPTR+220(,@15)                                0554
         BNE   @GL00056                                            0554
         C     @06,FDTPTR+232(,@15)                                0554
         BE    @RF00554                                            0554
@GL00056 L     @06,KEYRECRC                                        0554
         LTR   @06,@06                                             0554
         BZ    @RF00554                                            0554
*                    DO;                                   /*@Y30SSJH*/
*                                                                  0555
*                    DARGLIST = ''B;                       /*@Y30SSJH*/
         L     @15,DDSTRU                                          0556
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0556
*                    DARGSMOD = 'AL0';                     /*@Y30SSJH*/
         MVC   DARGSMOD(3,@15),@CC01426                            0557
*                    ALSTCOND = 4;                         /*@Y30SSJH*/
         MVI   ALSTCOND,X'04'                                      0558
*                    IF KEYRECRC = 4                               0559
*                      THEN                                        0559
         C     @06,@CF00044                                        0559
         BNE   @RF00559                                            0559
*                        DARGSENT = ALDFSTID;              /*@Y30SSJH*/
         MVI   DARGSENT(@15),X'12'                                 0560
*                      ELSE                                        0561
*                        DARGSENT = ALNWSTID;              /*@Y30SSJH*/
*                                                                  0561
         B     @RC00559                                            0561
@RF00559 L     @06,DDSTRU                                          0561
         MVI   DARGSENT(@06),X'13'                                 0561
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30SSJH*/
*                                                                  0562
@RC00559 L     @06,@PC00001                                        0562
         ST    @06,@AL00001                                        0562
         LA    @15,@CF00117                                        0562
         ST    @15,@AL00001+4                                      0562
         LA    @15,DDSTRU                                          0562
         ST    @15,@AL00001+8                                      0562
         MVI   @AL00001+8,X'80'                                    0562
         L     @15,GDTPRT(,@06)                                    0562
         LA    @01,@AL00001                                        0562
         BALR  @14,@15                                             0562
*                    END;                                  /*@Y30SSJH*/
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* UPRINT THE NAME OF THE ENTRY ALTERED     @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  0564
*            DARGLIST = ''B;                               /*@Y30SSJH*/
@RF00554 L     @06,DDSTRU                                          0564
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0564
*            ALSTID = ENTRYALT;                            /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01061                                  0565
*            DARGDBP = ADDR(ENTVAL(ENT));                  /*@Y30SSJH*/
         L     @15,ENT                                             0566
         MH    @15,@CH00687                                        0566
         L     @01,GENWKPTR                                        0566
         AL    @01,@CF01685                                        0566
         LA    @15,ENTVAL-5(@15,@01)                               0566
         ST    @15,DARGDBP(,@06)                                   0566
*            DARGSMOD = ALMODID;                           /*@Y30SSJH*/
         MVC   DARGSMOD(3,@06),ALMODID                             0567
*            DARGSENT = ALSTD;                             /*@Y30SSJH*/
         IC    @15,ALSTD                                           0568
         STC   @15,DARGSENT(,@06)                                  0568
*            DARGILP  = 44;                                 /*@YL026UA*
*                                                                  0569
         MVC   DARGILP(2,@06),@CH00594                             0569
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/
*                                                                  0570
         L     @06,@PC00001                                        0570
         ST    @06,@AL00001                                        0570
         LA    @15,@CF00117                                        0570
         ST    @15,@AL00001+4                                      0570
         LA    @15,DDSTRU                                          0570
         ST    @15,@AL00001+8                                      0570
         MVI   @AL00001+8,X'80'                                    0570
         L     @15,GDTPRT(,@06)                                    0570
         LA    @01,@AL00001                                        0570
         BALR  @14,@15                                             0570
*            ALSTID = NORMAL;                              /*@Y30SSJH*/
*                                                                  0571
         MVC   ALSTID(5),@CB01034                                  0571
*            END;                                          /*@Y30SSJH*/
*      ELSE                                                /*@Y30SSJH*/
*CATERR: DO;                                               /*@OZ17504*/
*                                                                  0573
         B     @RC00535                                            0573
@RF00535 DS    0H                                                  0573
CATERR   DS    0H                                                  0574
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE TERMINATION MESSAGES AND SET LASTCC                */
*        /* . THE TEXT PROCESSOR PRINTS MESSAGES AS DIRECTED BY THE  */
*        /*   DARGLIST PARAMETER LIST                                */
*        /* . THE SETTING OF 'ALSTID' CONTROLS THE BUILDING OF THE   */
*        /*   DARGLIST.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0574
*        DARGLIST = ''B;                                           0574
*                                                                  0574
         L     @06,DDSTRU                                          0574
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0574
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* A TERMINAL VSAM CATALOG ERROR OCCURRED. A MESSAGE IS     */
*        /* PRINTED GIVING THE CATALOG ERROR CODE VIA        @Y30SSJH*/
*        /* THE UERROR MACRO                                 @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0575
*        IF ALSTID = CATERROR                                      0575
*          THEN                                                    0575
         CLC   ALSTID(5),@CB01016                                  0575
         BNE   @RF00575                                            0575
*            DO;                                           /*@Y30SSJH*/
*                                                                  0576
*            ERCNVTAB = ''B;                               /*@Y30SSJH*/
         L     @06,ERCNVADR                                        0577
         XC    ERCNVTAB(32,@06),ERCNVTAB(@06)                      0577
*            ERCATLG = ON;                                 /*@Y30SSJH*/
         OI    ERCATLG(@06),B'10000000'                            0578
*            IF CTGFUNC = CTGLOC                                   0579
*              THEN                                                0579
         L     @01,CTGPLPTR                                        0579
         TM    CTGFUNC(@01),B'00100000'                            0579
         BNO   @RF00579                                            0579
         TM    CTGFUNC(@01),B'11000000'                            0579
         BNZ   @RF00579                                            0579
*                ERCATLC = ON;                             /*@Y30SSJH*/
         OI    ERCATLC(@06),B'10000000'                            0580
*              ELSE                                                0581
*                ERCATAL = ON;                             /*@Y30SSJH*/
         B     @RC00579                                            0581
@RF00579 L     @06,ERCNVADR                                        0581
         OI    ERCATAL(@06),B'00010000'                            0581
*            ERDSNM = ADDR(ENTVAL(ENT));                   /*@Y30SSJH*/
@RC00579 L     @06,ERCNVADR                                        0582
         L     @15,ENT                                             0582
         MH    @15,@CH00687                                        0582
         L     @01,GENWKPTR                                        0582
         AL    @01,@CF01685                                        0582
         LA    @15,ENTVAL-5(@15,@01)                               0582
         ST    @15,ERDSNM(,@06)                                    0582
*            ERCATRC = CTGRTNCC;                           /*@Y30SSJH*/
         L     @15,CTGRTNCC                                        0583
         ST    @15,ERCATRC(,@06)                                   0583
*            ERCPLPT = CTGPLPTR;                           /*@Y30SSJH*/
*                                                                  0584
         L     @15,CTGPLPTR                                        0584
         ST    @15,ERCPLPT(,@06)                                   0584
*            CALL IDCTPER0 (GDTTBL,ERCNVADR);              /*@Y30SSJH*/
*                                                                  0585
         L     @06,@PC00001                                        0585
         ST    @06,@AL00001                                        0585
         LA    @15,ERCNVADR                                        0585
         ST    @15,@AL00001+4                                      0585
         MVI   @AL00001+4,X'80'                                    0585
         L     @15,GDTERR(,@06)                                    0585
         LA    @01,@AL00001                                        0585
         BALR  @14,@15                                             0585
*            RESPECIFY RTNREG RSTD;                                0586
*            TESTRC = RTNREG;                                      0587
         STH   RTNREG,TESTRC                                       0587
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/
*                                                                  0588
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* UERROR WILL RETURN A RETURN CODE OF          @Y30SSJH*/
*            /*   . 0 - SUCCESSFUL COMPLETION                @Y30SSJH*/
*            /*   . 8 - UERROR UNABLE TO PRINT MESSAGE       @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  0589
*            IF TESTRC ^= 0                                        0589
*              THEN                                                0589
         LH    @06,TESTRC                                          0589
         LTR   @06,@06                                             0589
         BZ    @RF00589                                            0589
*                LASTCC = MAX(LASTCC,LASTCC04);            /*@Y30SSJH*/
*                                                                  0590
         L     @06,@PC00001+8                                      0590
         LH    @15,LASTCC(,@06)                                    0590
         LA    @14,4                                               0590
         CR    @15,@14                                             0590
         BNL   *+6
         LR    @15,@14                                             0590
         STH   @15,LASTCC(,@06)                                    0590
*            ALSTID = TERMERR;                             /*@Y30SSJH*/
*                                                                  0591
@RF00589 MVC   ALSTID(5),@CB01042                                  0591
*            END;                                          /*@Y30SSJH*/
*                                                                  0592
*          ELSE                                                    0593
*            /********************************************************/
*            /*                                              @OZ05940*/
*            /* PARAMCHK DETECTED AN INCONSISTENCY BETWEEN THE       */
*            /* ENTRY TYPE AND ONE OF THE PARAMETERS SPECIFIED       */
*            /* ON THE ALTER COMMAND. PRINT A MESSAGE        @OZ05940*/
*            /* INDICATING WHICH PARAMETER IS IN ERROR.      @OZ05940*/
*            /*                                              @OZ05940*/
*            /********************************************************/
*                                                                  0593
*            IF ALSTID = BADPARM                                   0593
*              THEN                                                0593
         B     @RC00575                                            0593
@RF00575 CLC   ALSTID(5),@CB01098                                  0593
         BNE   @RF00593                                            0593
*                DO;                                       /*@OZ05940*/
*                                                                  0594
*                DARGSMOD = ALMODID;                       /*@OZ05940*/
         L     @06,DDSTRU                                          0595
         MVC   DARGSMOD(3,@06),ALMODID                             0595
*                DARGSENT = ALSTD;                         /*@OZ05940*/
         IC    @15,ALSTD                                           0596
         STC   @15,DARGSENT(,@06)                                  0596
*                DARGDBP = ADDR(PARMTAB(PARMINDX));        /*@OZ05940*/
         LA    @15,13                                              0597
         LR    @14,@15                                             0597
         MH    @14,PARMINDX                                        0597
         LA    @14,PARMTAB-13(@14)                                 0597
         ST    @14,DARGDBP(,@06)                                   0597
*                DARGILP = LENGTH(PARMTAB(PARMINDX));      /*@OZ05940*/
*                                                                  0598
         STH   @15,DARGILP(,@06)                                   0598
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@OZ05940*/
*                                                                  0599
         L     @06,@PC00001                                        0599
         ST    @06,@AL00001                                        0599
         LA    @15,@CF00117                                        0599
         ST    @15,@AL00001+4                                      0599
         LA    @15,DDSTRU                                          0599
         ST    @15,@AL00001+8                                      0599
         MVI   @AL00001+8,X'80'                                    0599
         L     @15,GDTPRT(,@06)                                    0599
         LA    @01,@AL00001                                        0599
         BALR  @14,@15                                             0599
*                END;                                      /*@OZ05940*/
*                                                                  0600
*              ELSE                                                0601
*                /****************************************************/
*                /*                                          @OZ05940*/
*                /* A TERMINAL NON-CATALOG ERROR OCCURRED. PRINT THE */
*                /* MESSAGE AS DIRECTED BY 'ALSTID'.         @OZ05940*/
*                /*                                          @OZ05940*/
*                /****************************************************/
*                                                                  0601
*                IF ALSTID ^= NORMAL       &                       0601
*                   ALSTID ^= NOENTALT                             0601
*                  THEN                                            0601
         B     @RC00593                                            0601
@RF00593 CLC   ALSTID(5),@CB01034                                  0601
         BE    @RF00601                                            0601
         CLC   ALSTID(5),@CB01058                                  0601
         BE    @RF00601                                            0601
*                    DO;                                   /*@OZ05940*/
*                                                                  0602
*                    DARGSMOD = ALMODID;                   /*@OZ05940*/
         L     @06,DDSTRU                                          0603
         MVC   DARGSMOD(3,@06),ALMODID                             0603
*                    DARGSENT = ALSTD;                     /*@OZ05940*/
*                                                                  0604
         IC    @15,ALSTD                                           0604
         STC   @15,DARGSENT(,@06)                                  0604
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@OZ05940*/
*                                                                  0605
         L     @06,@PC00001                                        0605
         ST    @06,@AL00001                                        0605
         LA    @15,@CF00117                                        0605
         ST    @15,@AL00001+4                                      0605
         LA    @15,DDSTRU                                          0605
         ST    @15,@AL00001+8                                      0605
         MVI   @AL00001+8,X'80'                                    0605
         L     @15,GDTPRT(,@06)                                    0605
         LA    @01,@AL00001                                        0605
         BALR  @14,@15                                             0605
*                    ALSTID = TERMERR;                     /*@OZ05940*/
*                                                                  0606
         MVC   ALSTID(5),@CB01042                                  0606
*                    END;                                  /*@OZ05940*/
*                                                                  0607
*                                                                  0607
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* PRINT MESSAGE INDICATING ALTER WAS NOT PERFORMED @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0608
*        IF ALSTID ^= NORMAL                                       0608
*          THEN                                                    0608
@RF00601 DS    0H                                                  0608
@RC00593 DS    0H                                                  0608
@RC00575 CLC   ALSTID(5),@CB01034                                  0608
         BE    @RF00608                                            0608
*            DO;                                           /*@Y30SSJH*/
*                                                                  0609
*            DARGLIST = ''B;                               /*@Y30SSJH*/
         L     @06,DDSTRU                                          0610
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0610
*            ALSTID = NOENTALT;                            /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01058                                  0611
*            DARGDBP = ADDR(ENTVAL(ENT));                  /*@Y30SSJH*/
         L     @15,ENT                                             0612
         MH    @15,@CH00687                                        0612
         L     @01,GENWKPTR                                        0612
         AL    @01,@CF01685                                        0612
         LA    @15,ENTVAL-5(@15,@01)                               0612
         ST    @15,DARGDBP(,@06)                                   0612
*            DARGSMOD = ALMODID;                           /*@Y30SSJH*/
         MVC   DARGSMOD(3,@06),ALMODID                             0613
*            DARGSENT = ALSTD;                             /*@Y30SSJH*/
         IC    @15,ALSTD                                           0614
         STC   @15,DARGSENT(,@06)                                  0614
*            DARGILP = 44;                                 /*@Y30SSJH*/
*                                                                  0615
         MVC   DARGILP(2,@06),@CH00594                             0615
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/
*                                                                  0616
         L     @06,@PC00001                                        0616
         ST    @06,@AL00001                                        0616
         LA    @15,@CF00117                                        0616
         ST    @15,@AL00001+4                                      0616
         LA    @15,DDSTRU                                          0616
         ST    @15,@AL00001+8                                      0616
         MVI   @AL00001+8,X'80'                                    0616
         L     @15,GDTPRT(,@06)                                    0616
         LA    @01,@AL00001                                        0616
         BALR  @14,@15                                             0616
*            END;                                          /*@Y30SSJH*/
*                                                                  0617
*        END CATERR;                                       /*@OZ17504*/
*                                                                  0618
@RF00608 DS    0H                                                  0619
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /*  IF THE ENTRY HAS BEEN DYNAMICALLY ALLOCATED -   @Y30SSJH*/
*        /*  ISSUE THE UDEALLOC MACRO TO DEALLOCATE IT       @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0619
*          IF DALCINDX > 0                                         0619
*            THEN                                                  0619
@RC00535 L     @06,DALCINDX                                        0619
         LTR   @06,@06                                             0619
         BNP   @RF00619                                            0619
*              DO;                                         /*@Y30SSJH*/
*                                                                  0620
*              CALL DALCPROC ('D',                                 0621
*                NULLPARM,                                         0621
*                NULLPARM,                                         0621
*                DALCINDX);                                /*@Y30SSJH*/
*                                                                  0621
         LA    @06,@CC00855                                        0621
         ST    @06,@AL00001                                        0621
         SLR   @06,@06                                             0621
         ST    @06,@AL00001+4                                      0621
         ST    @06,@AL00001+8                                      0621
         LA    @06,DALCINDX                                        0621
         ST    @06,@AL00001+12                                     0621
         LA    @01,@AL00001                                        0621
         BAL   @14,DALCPROC                                        0621
*              IF TESTRC ^= 0                                      0622
*                THEN                                              0622
         LH    @06,TESTRC                                          0622
         LTR   @06,@06                                             0622
         BZ    @RF00622                                            0622
*                  LASTCC = MAX(LASTCC,LASTCC04);          /*@Y30SSJH*/
*                                                                  0623
         L     @06,@PC00001+8                                      0623
         LH    @15,LASTCC(,@06)                                    0623
         LA    @14,4                                               0623
         CR    @15,@14                                             0623
         BNL   *+6
         LR    @15,@14                                             0623
         STH   @15,LASTCC(,@06)                                    0623
*              END;                                        /*@Y30SSJH*/
*                                                                  0624
@RF00622 DS    0H                                                  0625
*          /**********************************************************/
*          /*                                                @Y30SSJH*/
*          /*  SET THE LAST CONDITION CODE TO THE MAXIMUM CODE       */
*          /*  ENCOUNTERED FOR THIS ENTRY.                   @Y30SSJH*/
*          /*                                                @Y30SSJH*/
*          /**********************************************************/
*                                                                  0625
*          LASTCC = MAX(ALSTCOND,LASTCC);                  /*@Y30SSJH*/
@RF00619 L     @06,@PC00001+8                                      0625
         SLR   @15,@15                                             0625
         IC    @15,ALSTCOND                                        0625
         LH    @14,LASTCC(,@06)                                    0625
         CR    @15,@14                                             0625
         BNL   *+6
         LR    @15,@14                                             0625
         STH   @15,LASTCC(,@06)                                    0625
*          ALSTID = NORMAL;                                /*@Y30SSJH*/
*                                                                  0626
         MVC   ALSTID(5),@CB01034                                  0626
*        END SAMECAT;                                      /*@Y30SSJH*/
*        END GENLOOP;                                      /*@Y30SSJH*/
@RC00438 LA    @06,1                                               0628
         AL    @06,ENT                                             0628
@DE00437 ST    @06,ENT                                             0628
         C     @06,GENCNT                                          0628
         BNH   @DL00437                                            0628
@DC00437 DS    0H                                                  0629
*        END NOTPDS;                                       /*@YL026UA*/
*                                                                  0629
*        END GOODCAT;                                      /*@YL026UA*/
*                                                                  0630
@RC00393 DS    0H                                                  0630
@RF00392 DS    0H                                                  0631
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE SUMMARY MESSAGE                            @YL026UA*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0631
*        LASTCC = MAX(LASTCC,ALSTCOND);                    /*@YL026UA*/
@RF00352 L     @06,@PC00001+8                                      0631
         LH    @15,LASTCC(,@06)                                    0631
         SLR   @14,@14                                             0631
         IC    @14,ALSTCOND                                        0631
         CR    @15,@14                                             0631
         BNL   *+6
         LR    @15,@14                                             0631
         STH   @15,LASTCC(,@06)                                    0631
*        IF ALSTID = NORMAL & LASTCC = 0                   /*@YL026UA*/
*          THEN                                                    0632
         CLC   ALSTID(5),@CB01034                                  0632
         BNE   @RF00632                                            0632
         LTR   @15,@15                                             0632
         BNZ   @RF00632                                            0632
*            ALSTD = NOTCOMP;                              /*@YL026UA*/
         MVI   ALSTD,X'09'                                         0633
*        DARGLIST = ''B;                                           0634
@RF00632 L     @06,DDSTRU                                          0634
         XC    DARGLIST(20,@06),DARGLIST(@06)                      0634
*        DARGSMOD = ALMODID;                                       0635
         MVC   DARGSMOD(3,@06),ALMODID                             0635
*        IF LASTCC ^= 0     &                                      0636
*           GDTECT ^= NULLPTR                                      0636
*          THEN                                                    0636
         SLR   @15,@15                                             0636
         L     @14,@PC00001+8                                      0636
         CH    @15,LASTCC(,@14)                                    0636
         BE    @RF00636                                            0636
         L     @14,@PC00001                                        0636
         C     @15,GDTECT(,@14)                                    0636
         BE    @RF00636                                            0636
*            DARGSENT = 15;                                        0637
         MVI   DARGSENT(@06),X'0F'                                 0637
*          ELSE                                                    0638
*            IF LASTCC > LASTCC08                          /*@OZ18341*/
*              THEN                                        /*@OZ18341*/
         B     @RC00636                                            0638
@RF00636 L     @06,@PC00001+8                                      0638
         LH    @06,LASTCC(,@06)                                    0638
         C     @06,@CF00039                                        0638
         BNH   @RF00638                                            0638
*                DARGSENT = 3;                             /*@OZ18341*/
         L     @06,DDSTRU                                          0639
         MVI   DARGSENT(@06),X'03'                                 0639
*              ELSE                                        /*@OZ18431*/
*                DARGSENT = ALSTD;                         /*@OZ18341*/
         B     @RC00638                                            0640
@RF00638 IC    @06,ALSTD                                           0640
         L     @01,DDSTRU                                          0640
         STC   @06,DARGSENT(,@01)                                  0640
*        DARGDBP  = ADDR(LASTCC);                                  0641
@RC00638 DS    0H                                                  0641
@RC00636 L     @06,DDSTRU                                          0641
         L     @15,@PC00001+8                                      0641
         ST    @15,DARGDBP(,@06)                                   0641
*        DARGILP  = 2;                                             0642
*                                                                  0642
         MVC   DARGILP(2,@06),@CH00155                             0642
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     0643
*                                                                  0643
*                                                                  0643
         L     @06,@PC00001                                        0643
         ST    @06,@AL00001                                        0643
         LA    @15,@CF00117                                        0643
         ST    @15,@AL00001+4                                      0643
         LA    @15,DDSTRU                                          0643
         ST    @15,@AL00001+8                                      0643
         MVI   @AL00001+8,X'80'                                    0643
         L     @15,GDTPRT(,@06)                                    0643
         LA    @01,@AL00001                                        0643
         BALR  @14,@15                                             0643
*        IF GDTDBG = NULLPTR                                       0644
*          THEN;                                                   0644
         L     @06,@PC00001                                        0644
         L     @06,GDTDBG(,@06)                                    0644
         LTR   @06,@06                                             0644
         BZ    @RT00644                                            0644
*          ELSE                                                    0646
*            CALL IDCDB010(GDTTBL,'AL02');                         0646
*                                                                  0646
         L     @06,@PC00001                                        0646
         ST    @06,@AL00001                                        0646
         LA    @15,@CC01430                                        0646
         ST    @15,@AL00001+4                                      0646
         MVI   @AL00001+4,X'80'                                    0646
         L     @15,GDTDBG(,@06)                                    0646
         LA    @01,@AL00001                                        0646
         BALR  @14,@15                                             0646
*        CALL IDCSAFP0(GDTTBL,ALGPID,ALL);                 /*@OZ02157*/
@RT00644 MVC   @AL00001+4(8),@AL00647                              0647
         L     @06,@PC00001                                        0647
         ST    @06,@AL00001                                        0647
         L     @15,GDTFPL(,@06)                                    0647
         LA    @01,@AL00001                                        0647
         BALR  @14,@15                                             0647
*        CALL IDCSAEP0(GDTTBL,MODID);                              0648
         L     @06,@PC00001                                        0648
         ST    @06,@AL00001                                        0648
         LA    @15,MODID                                           0648
         ST    @15,@AL00001+4                                      0648
         MVI   @AL00001+4,X'80'                                    0648
         L     @15,GDTEPL(,@06)                                    0648
         LA    @01,@AL00001                                        0648
         BALR  @14,@15                                             0648
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - LOCATPRC (STAGE 2 PROCESSOR)                    */
*/*                                                                  */
*/* FUNCTION - LOCATES CATALOG FIELDS WHICH MAY BE ALTERED, BUT DUE  */
*/*            TO THEIR COMPLEX NATURE (I.E. THEY CONTAIN MORE THAN  */
*/*            ONE ATTRIBUTE), THEY MUST BE ALTERED IN THEIR ORIGINAL*/
*/*            CONTEXT.                                              */
*/*                                                                  */
*/*            THIS PROCEDURE IS ENTERED FROM IDCAL01 FOR    @Y30SSJH*/
*/*            THE FIRST, OR PRIMARY, LOCATE.  IF THE KEYS   @Y30SSJH*/
*/*            AND/OR RECORDSIZE PARAMETERS HAVE BEEN        @Y30SSJH*/
*/*            SPECIFIED, IT MAY BE ENTERED FROM CHECKPRC    @Y30SSJH*/
*/*            FOR A SECONDARY LOCATE.                       @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            THE FIELDS REQUIRING THIS CONSIDERATION ARE:          */
*/*              . PASSWALL - SECURITY COMBINATION FIELD             */
*/*              . DSATTR - DATA SET ATTRIBUTES                      */
*/*              . AMDSBCAT - RECORD MANAGEMENT COMBINATION FIELD    */
*/*              . GDGATTR - GDG ATTRIBUTES                  @YL026UA*/
*/*            IN ADDITION, THE ENTYPE, CATACB, NAMEDS,      @Y30SSJH*/
*/*            HURBADS AND RGATTR FIELDS ARE LOCATED         @Y30SSJH*/
*/*            TO BE USED IN LATER PROCESSING.               @Y30SSJH*/
*/*                                                                  */
*/*            LOCATPRC BUILDS THE CPL-FPL COMPLEX WHICH TRANSMITS   */
*/*            THE LOCATE REQUEST TO VSAM CATALOG MANAGEMENT         */
*/*              . THE CPL GIVES THE NAME OF THE OBJECT BEING LOCATED*/
*/*                AND REFERENCES THE FPLS                           */
*/*              . THE FPLS REFERENCE THE FIELDS WHICH ARE TO BE     */
*/*                LOCATED (THE LENGTH AND ADDRESS TO THE LOCATED    */
*/*                FIELD IS RETURNED TO LOCATPRC IN THE FPLS AS SET  */
*/*                BY VSAM CATALOG MANAGEMENT)                       */
*/*            THE CATALOG IS INVOKED BY THE IDCAMS UCATLG MACRO     */
*/*                                                                  */
*/* INPUT -                                                          */
*/*            THE FDTTBL IN IDCAL01 IS REFERENCED                   */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*            . LOCTABLE - DECLARED IN IDCAL01 IS INITIALIZED       */
*/*            . ALSTID   - THE GLOBAL STATUS COMMUNICATOR IS SET    */
*/*              ON ERROR DETECTION:                                 */
*/*                ALSTID = NOSTORAG                                 */
*/*                ALSTID = CATERROR                                 */
*/*                ALSTID = LOCRTNER                                 */
*/*                ALSTID = PSWDSUPR                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0649
*LOCATPRC:                                                         0649
*        PROCEDURE;                                                0649
@EL00001 L     @13,4(,@13)                                         0649
@EF00001 L     @00,@SIZDATD                                        0649
         LR    @01,@07                                             0649
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0649
         BR    @14                                                 0649
LOCATPRC STM   @14,@12,@SA00002                                    0649
*        /************************************************************/
*        /*                                                          */
*        /* UGPOOL/LOCATE CYCLE CONTROL AND DATA AREAS               */
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0650
*          CYCLEFLG    CHAR(1),        /* CYCLE CONTROL FLAG         */
*          LWKALEN     FIXED(31),      /* UGPOOL REQUEST LENGTH      */
*          CYCLECNT    FIXED(8);       /* CYCLE COUNT                */
*                                                                  0650
*                                                                  0650
*        /************************************************************/
*        /*                                                          */
*        /* OVERLAY OF LOCATE WORKAREA                       @Y30SSJH*/
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0651
*          1 LOCATWKA  BASED(CTGWKA)BDY(WORD),                     0651
*            2 MYLENGTH  FIXED(15),    /* WKA LENGTH                 */
*            2 REQDLEN   FIXED(15),    /* REQUIRED LENGTH SET BY VSAM*/
*            2 *         CHAR(*);                                  0651
*                                                                  0651
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO LOCATPRC                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0652
*        OLDERID2 = NEWERID2;                                      0652
         L     @06,@PC00001                                        0652
         L     @06,GDTTR2(,@06)                                    0652
         MVC   @TS00001(95),NEWERID2(@06)                          0652
         MVC   OLDERID2(95,@06),@TS00001                           0652
*        NEWID2 = 'AL31';                                          0653
*                                                                  0653
         MVC   NEWID2(4,@06),@CC01441                              0653
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE CPL FOR LOCATE                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0654
*        CTGPLPTR = ADDR(ALCTGPL);     /* SET POINTER TO THE CPL     */
         L     @06,ALPRMPTR                                        0654
         LA    @15,ALCTGPL(,@06)                                   0654
         ST    @15,CTGPLPTR                                        0654
*        ALCPLID = 'CPL';              /* CPL DUMP ID                */
         MVI   ALCPLID+3(@06),C' '                                 0655
         MVC   ALCPLID+4(4,@06),ALCPLID+3(@06)                     0655
         MVC   ALCPLID(3,@06),@CC01442                             0655
*        CTGNAME = ON;                 /* LOCATE BY ENTRY NAME       */
         OI    CTGNAME(@15),B'00000100'                            0656
*        CTGFUNC = CTGLOC;             /* SET NON-CMS LOCATE FUNCTION*/
         NI    CTGFUNC(@15),B'00111111'                            0657
         OI    CTGFUNC(@15),B'00100000'                            0657
*        CTGNUM = ON;                  /* SEARCH ONE CATALOG         */
*        CTGAM0 = ON;                  /* VSAM CATALOG REQUEST       */
         OI    CTGNUM(@15),B'00000011'                             0659
*        IF DATACI = INITVALU                                      0660
*          THEN                                                    0660
         CLC   DATACI(3),INITVALU                                  0660
         BNE   @RF00660                                            0660
*            CTGENT = ADDR(ENTVAL(ENT));                   /*@Y30SSJH*/
         L     @06,ENT                                             0661
         MH    @06,@CH00687                                        0661
         L     @01,GENWKPTR                                        0661
         AL    @01,@CF01685                                        0661
         LA    @06,ENTVAL-5(@06,@01)                               0661
         ST    @06,CTGENT(,@15)                                    0661
*          ELSE                                                    0662
*            DO;                                           /*@Y30SSJH*/
*                                                                  0662
         B     @RC00660                                            0662
@RF00660 DS    0H                                                  0663
*            CTGNAME = OFF;                                /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        0663
         NI    CTGNAME(@06),B'11111011'                            0663
*            CTGENT = ADDR(DATACI);                        /*@Y30SSJH*/
*                                                                  0664
         LA    @15,DATACI                                          0664
         ST    @15,CTGENT(,@06)                                    0664
*            END;                                          /*@Y30SSJH*/
*        CTGCNAME = ON;                /* CATLG NAME SUPPLIED OR NULL*/
*                                                                  0666
@RC00660 L     @06,CTGPLPTR                                        0666
         OI    CTGCNAME(@06),B'00000010'                           0666
*        /************************************************************/
*        /*                                                  @OZ24944*/
*        /* LEAVE CTGMAST OFF DURING LOCATES FOR GDG ATTRIBUTES.     */
*        /*                                                  @OZ24944*/
*        /************************************************************/
*                                                                  0667
*        IF (ADDR(GDGEM) = NULLPTR &                       /*@OZ24944*/
*           ADDR(GDGNE) = NULLPTR &                        /*@OZ24944*/
*           ADDR(GDGSC) = NULLPTR &                        /*@OZ24944*/
*           ADDR(GDGNS) = NULLPTR)                         /*@OZ24944*/
*        THEN                                              /*@OZ24944*/
         SLR   @15,@15                                             0667
         L     @14,@PC00001+4                                      0667
         C     @15,FDTPTR+196(,@14)                                0667
         BNE   @RF00667                                            0667
         C     @15,FDTPTR+200(,@14)                                0667
         BNE   @RF00667                                            0667
         C     @15,FDTPTR+204(,@14)                                0667
         BNE   @RF00667                                            0667
         C     @15,FDTPTR+208(,@14)                                0667
         BNE   @RF00667                                            0667
*          CTGMAST = ON;               /* FORCE MASTER PSWD VERIFY   */
*                                                                  0668
         OI    CTGMAST(@06),B'01000000'                            0668
*        /************************************************************/
*        /*                                                          */
*        /* SET CPL REFERENCE TO CATALOG IN WHICH ENTRY RESIDES      */
*        /* . CATACBPT IS PASSED TO THIS PROCEDURE AS AN ARGUMENT OF */
*        /*   INVOCATION IF THE CATALOG HAS BEEN OPENED IN IDCAL01.  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0669
*        IF CATACBPT ^= NULLPTR                                    0669
*          THEN                                                    0669
@RF00667 L     @06,CATACBPT                                        0669
         LTR   @06,@06                                             0669
         BZ    @RF00669                                            0669
*            DO;                                                   0670
*                                                                  0670
*            CTGCNAME = OFF;            /* INDICATE CATLG ACB GIVEN  */
         L     @15,CTGPLPTR                                        0671
         NI    CTGCNAME(@15),B'11111101'                           0671
*            CTGCAT = CATACBPT;         /* ACB ADDRESS OF CATALOG    */
*                                                                  0672
         ST    @06,CTGCAT(,@15)                                    0672
*            END;                                                  0673
*                                                                  0673
*          /**********************************************************/
*          /*                                                        */
*          /* CATLG ACB ADDRESS NOT SPECIFIED - SET PTR TO CATLG NAME*/
*          /* IF A CATALOG NAME NOR ACB IS NOT PROVIDED THE CATALOG  */
*          /* SEARCH FOLLOWS THE STEPCAT×JOBCAT, MASTERCATALOG HIER- */
*          /* ARCHY.                                                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0674
*          ELSE                                                    0674
*            IF (ADDR(CATLG)) ^= NULLPTR                           0674
*              THEN                                                0674
         B     @RC00669                                            0674
@RF00669 L     @06,@PC00001+4                                      0674
         L     @06,FDTPTR+8(,@06)                                  0674
         LTR   @06,@06                                             0674
         BZ    @RF00674                                            0674
*                CTGCAT = ADDR(CATLGVAL);                  /*@YL026UA*/
         LA    @06,CATLGVAL(,@06)                                  0675
         L     @01,CTGPLPTR                                        0675
         ST    @06,CTGCAT(,@01)                                    0675
*              ELSE                                                0676
*                IF NTRYPOS ^= 0                                   0676
*                  THEN                                            0676
         B     @RC00674                                            0676
@RF00674 L     @06,@PC00001+4                                      0676
         L     @06,FDTPTR(,@06)                                    0676
         CLI   NTRYPOS(@06),0                                      0676
         BE    @RF00676                                            0676
*                    CTGCAT = ADDR(CATNAME);               /*@YL026UA*/
*                                                                  0677
         LA    @06,CATNAME                                         0677
         L     @01,CTGPLPTR                                        0677
         ST    @06,CTGCAT(,@01)                                    0677
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE THE PASSWORD ADDRESS - EITHER CATLG OR ENTRY  */
*        /* PASSWORD. THE CATALOG PASSWORD HAS THE HIGHEST PRIORITY  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0678
*        IF (ADDR(CATLG)) ^= NULLPTR                               0678
*          THEN                                                    0678
@RF00676 DS    0H                                                  0678
@RC00674 DS    0H                                                  0678
@RC00669 L     @06,@PC00001+4                                      0678
         L     @06,FDTPTR+8(,@06)                                  0678
         LTR   @06,@06                                             0678
         BZ    @RF00678                                            0678
*            IF CATLGPLN ^= 0                                      0679
*              THEN                                                0679
         CLI   CATLGPLN(@06),0                                     0679
         BE    @RF00679                                            0679
*                CTGPSWD = ADDR(CATLGPAS);  /* CATALOG PASSWORD      */
*                                                                  0680
         LA    @06,CATLGPAS(,@06)                                  0680
         L     @01,CTGPLPTR                                        0680
         ST    @06,CTGPSWD(,@01)                                   0680
*        IF CTGPSWD = NULLPTR                                      0681
*          THEN                                                    0681
@RF00679 DS    0H                                                  0681
@RF00678 L     @06,CTGPLPTR                                        0681
         L     @15,CTGPSWD(,@06)                                   0681
         LTR   @15,@15                                             0681
         BNZ   @RF00681                                            0681
*            IF NTRYPLN ^= 0                                       0682
*              THEN                                                0682
         L     @15,@PC00001+4                                      0682
         L     @15,FDTPTR(,@15)                                    0682
         CLI   NTRYPLN(@15),0                                      0682
         BE    @RF00682                                            0682
*                CTGPSWD = ADDR(NTRYPAS);   /* ENTRY PASSWORD        */
*                                                                  0683
         LA    @15,NTRYPAS(,@15)                                   0683
         ST    @15,CTGPSWD(,@06)                                   0683
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* IF THE KEYS AND/OR RECORDSIZE PARAMETER HAS BEEN @Y30SSJH*/
*        /* SPECIFIED AND A LOCATE HAS BEEN PERFORMED AT A   @Y30SSJH*/
*        /* LEVEL HIGHER THAN DATA, SET BYPASS VERIFICATION  @Y30SSJH*/
*        /* - EFFECTIVE IN DOS ONLY                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0684
*        IF ((ADDR(KEY))   ^= NULLPTR ×                            0684
*            (ADDR(RECSZ)) ^= NULLPTR )                            0684
*          THEN                                                    0684
@RF00682 DS    0H                                                  0684
@RF00681 SLR   @06,@06                                             0684
         L     @15,@PC00001+4                                      0684
         C     @06,FDTPTR+220(,@15)                                0684
         BNE   @RT00684                                            0684
         C     @06,FDTPTR+232(,@15)                                0684
         BE    @RF00684                                            0684
@RT00684 DS    0H                                                  0685
*            IF BYPASSSW = STOP                                    0685
*              THEN                                                0685
         CLI   BYPASSSW,X'0F'                                      0685
         BNE   @RF00685                                            0685
*                CTGBYPSS = ON;                            /*@Y30SSJH*/
*                                                                  0686
         L     @06,CTGPLPTR                                        0686
         OI    CTGBYPSS(@06),B'10000000'                           0686
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE FPLS FOR FIELDS TO BE LOCATED - ENTYPE,CATACB */
*        /*    PASSWALL,DSATTR,AMDSBCAT,GDGATTR                      */
*        /* . SET CTGFLPTR TO FIRST (ENTYPE) FPL                     */
*        /* . SET DUMP ID'S FOR FPL'S                                */
*        /* . SET CTGNOFLD TO # OF FPLS IN LOCATE REQUEST            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0687
*        ALFPLLST(1:256) = ''B;                            /*@Y30SSJH*/
@RF00685 DS    0H                                                  0687
@RF00684 L     @06,ALPRMPTR                                        0687
         XC    ALFPLLST(256,@06),ALFPLLST(@06)                     0687
*        ALFPLLST(257:LENGTH(ALFPLLST)) = ''B;             /*@Y30SSJH*/
*                                                                  0688
         XC    ALFPLLST+256(192,@06),ALFPLLST+256(@06)             0688
*        CTGFLPTR = ADDR(ALFPLTYP);                                0689
         LA    @15,ALFPLTYP(,@06)                                  0689
         ST    @15,CTGFLPTR                                        0689
*        ALTYP = 'TYPE';                                           0690
         MVC   ALTYP(4,@06),@CC01444                               0690
*        ALACB = 'ACB';                                            0691
         MVI   ALACB+3(@06),C' '                                   0691
         MVC   ALACB(3,@06),@CC01445                               0691
*        ALNAM = 'NAME';                                   /*@Y30SSJH*/
         MVC   ALNAM(4,@06),@CC00205                               0692
*        ALRBA = 'RBA';                                    /*@Y30SSJH*/
         MVI   ALRBA+3(@06),C' '                                   0693
         MVC   ALRBA(3,@06),@CC01446                               0693
*        ALCRA = 'CRA';                                    /*@Y30SSJH*/
         MVI   ALCRA+3(@06),C' '                                   0694
         MVC   ALCRA(3,@06),@CC01447                               0694
*        ALPSW = 'PSWD';                                           0695
         MVC   ALPSW(4,@06),@CC01448                               0695
*        ALDAT = 'DSAT';                                   /*@Y30SSJH*/
         MVC   ALDAT(4,@06),@CC01449                               0696
*        ALAMD = 'AMDB';                                           0697
         MVC   ALAMD(4,@06),@CC01450                               0697
*        ALGDG = 'GDG';                                    /*@YL026UA*/
         MVI   ALGDG+3(@06),C' '                                   0698
         MVC   ALGDG(3,@06),@CC01451                               0698
*        ALRGA = 'RGAT';                                   /*@Y30SSJH*/
         MVC   ALRGA(4,@06),@CC01452                               0699
*        CTGNOFLD = 10;                                    /*@Y30SSJH*/
*                                                                  0700
         L     @06,CTGPLPTR                                        0700
         MVI   CTGNOFLD(@06),X'0A'                                 0700
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE EACH FPL AND REFERENCE IT IN THE CPL          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0701
*        DO N = 1 TO 10;                                   /*@Y30SSJH*/
*                                                                  0701
         LA    @06,1                                               0701
         ST    @06,N                                               0701
@DL00701 DS    0H                                                  0702
*          CTGFLDNO = 1;                                           0702
         L     @15,CTGFLPTR                                        0702
         MVI   CTGFLDNO(@15),X'01'                                 0702
*          CTGFLDNM = ADDR(ALFLDNAM(N));                           0703
         LR    @14,@06                                             0703
         SLA   @14,3                                               0703
         LA    @14,ALFLDNAM-8(@14)                                 0703
         ST    @14,CTGFLDNM(,@15)                                  0703
*          CTGFIELD(N) = CTGFLPTR;                                 0704
         LR    @14,@06                                             0704
         SLA   @14,2                                               0704
         L     @01,CTGPLPTR                                        0704
         ST    @15,CTGFIELD-4(@14,@01)                             0704
*          CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL)+8) + 4;            0705
*                                                                  0705
         AL    @15,@CF00678                                        0705
         ST    @15,CTGFLPTR                                        0705
*        END;                                                      0706
         AL    @06,@CF00220                                        0706
         ST    @06,N                                               0706
         C     @06,@CF00037                                        0706
         BNH   @DL00701                                            0706
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE NAMEDS TEST FPL AND REFERENCE IT IN   @Y30SSJH*/
*        /* THE NAMEDS FPL - THIS LIMITS THE NUMBER OF       @Y30SSJH*/
*        /* ASSOCIATIONS RETURNED TO FIVE                    @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0707
*        CTGFLPTR = ADDR(ALFPLTST);                        /*@Y30SSJH*/
         L     @06,ALPRMPTR                                        0707
         LA    @15,ALFPLTST(,@06)                                  0707
         ST    @15,CTGFLPTR                                        0707
*        ALNAMTST = 'TEST';                                /*@Y30SSJH*/
         MVC   ALNAMTST(4,@06),@CC01453                            0708
*        CTGFLDNO = 1;                                     /*@Y30SSJH*/
         MVI   CTGFLDNO(@15),X'01'                                 0709
*        CTGFLDCD = CTGFLDLE;                              /*@Y30SSJH*/
         MVI   CTGFLDCD(@15),X'C0'                                 0710
*        CTGFLDNM = ADDR(ALFLDNAM(16));                    /*@Y30SSJH*/
         LA    @14,ALFLDNAM+120                                    0711
         ST    @14,CTGFLDNM(,@15)                                  0711
*        CTGFLNG(1) = 2;                                   /*@Y30SSJH*/
         MVC   CTGFLNG(4,@15),@CF00155                             0712
*        CTGFLPT(1) = ADDR(NAMEMASK);                      /*@Y30SSJH*/
*                                                                  0713
         LA    @14,NAMEMASK                                        0713
         ST    @14,CTGFLPT(,@15)                                   0713
*        CTGFLPTR = ADDR(ALFPLNAM);                        /*@Y30SSJH*/
         LA    @06,ALFPLNAM(,@06)                                  0714
         ST    @06,CTGFLPTR                                        0714
*        CTGFLCHN = ADDR(ALFPLTST);                        /*@Y30SSJH*/
*                                                                  0715
         ST    @15,CTGFLCHN(,@06)                                  0715
*        /************************************************************/
*        /*                                                          */
*        /* UGPOOL/LOCATE CYCLE - WORKAREA SPACE IS PROCURED AND THE */
*        /* LOCATE REQUEST IS ISSUED. THIS CYCLE WILL REPEAT IF THE  */
*        /* FIRST LOCATE WAS ISSUED WITH INSUFFICIENT WORKAREA       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0716
*        LWKALEN = WKALEN1;                                /*@Y30SSJH*/
         MVC   LWKALEN(4),@CF01117                                 0716
*        CYCLEFLG = GO;                                            0717
         MVI   CYCLEFLG,X'00'                                      0717
*        CYCLECNT = 1;                                             0718
*                                                                  0718
         MVI   CYCLECNT,X'01'                                      0718
*UGPLLOC: DO WHILE CYCLEFLG = GO;                                  0719
*                                                                  0719
UGPLLOC  B     @DE00719                                            0719
@DL00719 DS    0H                                                  0720
*        CALL IDCSAGP0(GDTTBL,                                     0720
*               LWKALEN,               /* LENGTH OF STORAGE REQUEST  */
*               CTGWKA,                /* POINTER TO WORKAREA        */
*               ALGPID,                /* UGPOOL ID                  */
*               SETZERO);              /* SET AREA TO ZERO           */
*                                                                  0720
         L     @06,@PC00001                                        0720
         ST    @06,@AL00001                                        0720
         LA    @15,LWKALEN                                         0720
         ST    @15,@AL00001+4                                      0720
         L     @01,CTGPLPTR                                        0720
         LA    @15,CTGWKA(,@01)                                    0720
         ST    @15,@AL00001+8                                      0720
         LA    @15,ALGPID                                          0720
         ST    @15,@AL00001+12                                     0720
         LA    @15,SETZERO                                         0720
         ST    @15,@AL00001+16                                     0720
         MVI   @AL00001+16,X'80'                                   0720
         L     @15,GDTGPL(,@06)                                    0720
         LA    @01,@AL00001                                        0720
         BALR  @14,@15                                             0720
*        RESPECIFY RTNREG RSTD;                                    0721
*        TESTRC = RTNREG;                                          0722
         STH   RTNREG,TESTRC                                       0722
*        RESPECIFY RTNREG UNRSTD;                                  0723
*                                                                  0723
*        IF TESTRC ^= 0                                            0724
*          THEN                                                    0724
         LH    @06,TESTRC                                          0724
         LTR   @06,@06                                             0724
         BZ    @RF00724                                            0724
*            DO;                                                   0725
*                                                                  0725
*            ALSTID = NOSTORAG;                                    0726
         MVC   ALSTID(5),@CB01039                                  0726
*            RETURN;                                               0727
*                                                                  0727
@EL00002 DS    0H                                                  0727
@EF00002 DS    0H                                                  0727
@ER00002 LM    @14,@12,@SA00002                                    0727
         BR    @14                                                 0727
*            END;                                                  0728
*                                                                  0728
*        MYLENGTH = LWKALEN;                                       0729
*                                                                  0729
@RF00724 L     @06,CTGPLPTR                                        0729
         L     @06,CTGWKA(,@06)                                    0729
         L     @15,LWKALEN                                         0729
         STH   @15,MYLENGTH(,@06)                                  0729
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE CATALOG LOCATE REQUEST                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0730
*        CALL IDCSACA0 (GDTTBL,CTGPLPTR);                          0730
*                                                                  0730
         L     @06,@PC00001                                        0730
         ST    @06,@AL00001                                        0730
         LA    @15,CTGPLPTR                                        0730
         ST    @15,@AL00001+4                                      0730
         L     @15,GDTCAT(,@06)                                    0730
         LA    @01,@AL00001                                        0730
         BALR  @14,@15                                             0730
*        RESPECIFY (RTNREG) RSTD;                          /*@Y30SSJH*/
*        CTGRTNCC = RTNREG;                                        0732
         ST    RTNREG,CTGRTNCC                                     0732
*        RESPECIFY (RTNREG) UNRSTD;                        /*@Y30SSJH*/
*                                                                  0733
*        IF GDTDBG = NULLPTR                                       0734
*          THEN;                                                   0734
         L     @06,@PC00001                                        0734
         L     @06,GDTDBG(,@06)                                    0734
         LTR   @06,@06                                             0734
         BZ    @RT00734                                            0734
*          ELSE                                                    0736
*            CALL IDCDB010(GDTTBL,'AL03');                         0736
         L     @06,@PC00001                                        0736
         ST    @06,@AL00001                                        0736
         LA    @15,@CC01456                                        0736
         ST    @15,@AL00001+4                                      0736
         MVI   @AL00001+4,X'80'                                    0736
         L     @15,GDTDBG(,@06)                                    0736
         LA    @01,@AL00001                                        0736
         BALR  @14,@15                                             0736
*                                                                  0737
*        /************************************************************/
*        /*                                                          */
*        /* CHECK CATALOG RETURN CODES - INSUFFICIENT WKA WILL RESULT*/
*        /* IN REISSUANCE OF THE CYCLE  ON FIRST TIME THRU           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0737
*        IF CTGRTNCC = 0                                           0737
*          THEN                                                    0737
@RT00734 L     @06,CTGRTNCC                                        0737
         LTR   @06,@06                                             0737
         BNZ   @RF00737                                            0737
*            CYCLEFLG = STOP;                                      0738
*                                                                  0738
         MVI   CYCLEFLG,X'0F'                                      0738
*          ELSE                                                    0739
*            IF CTGRTNCC = 40          /* INSUFFICIENT WORKAREA      */
*              THEN                                                0739
         B     @RC00737                                            0739
@RF00737 CLC   CTGRTNCC(4),@CF00720                                0739
         BNE   @RF00739                                            0739
*                IF CYCLECNT = 1       /* FIRST CYCLE                */
*                  THEN                                            0740
         CLI   CYCLECNT,1                                          0740
         BNE   @RF00740                                            0740
*                    DO;                                           0741
*                                                                  0741
*                    /************************************************/
*                    /*                                              */
*                    /* INSUFFICIENT WORKAREA FOR FIRST CYCLE LOCATE */
*                    /* . BUMPCYCLECNT TO INDICATE LOCATE REISSUE    */
*                    /* . SET 'LWKALEN TO REQUIRED LENGTH AS RETURNED*/
*                    /*   BY VSAM FROM FIRST LOCATE(PLUS 8 BYTES)    */
*                    /* THE CONTROL OF UGPLLOC WILL CAUSE ANOTHER    */
*                    /* UGPOOL REQUEST WITH THE INCREASED WORKAREA   */
*                    /* AND THE REISSUANCE OF THE LOCATE REQUEST     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0742
*                    CYCLECNT = 2;                                 0742
         MVI   CYCLECNT,X'02'                                      0742
*                    LWKALEN = REQDLEN +8;                         0743
*                                                                  0743
         L     @06,CTGPLPTR                                        0743
         L     @06,CTGWKA(,@06)                                    0743
         LA    @15,8                                               0743
         AH    @15,REQDLEN(,@06)                                   0743
         ST    @15,LWKALEN                                         0743
*                    END;                                          0744
*                                                                  0744
*                  ELSE;                                           0745
*                                                                  0745
@RF00740 DS    0H                                                  0746
*              ELSE                                                0746
*                DO;                   /* CATALOG ERROR - RETURN     */
*                                                                  0746
         B     @RC00739                                            0746
@RF00739 DS    0H                                                  0747
*                CYCLEFLG = STOP;                                  0747
         MVI   CYCLEFLG,X'0F'                                      0747
*                ALSTID = CATERROR;                                0748
         MVC   ALSTID(5),@CB01016                                  0748
*                RETURN;                                           0749
*                                                                  0749
         B     @EL00002                                            0749
*                END;                                              0750
*                                                                  0750
*        END UGPLLOC;                                              0751
@RC00739 DS    0H                                                  0751
@RC00737 DS    0H                                                  0751
@DE00719 CLI   CYCLEFLG,X'00'                                      0751
         BE    @DL00719                                            0751
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE LOCTABLE WITH THE LENGTH AND ADDRESS OF NON-  */
*        /* NULL FIELDS RETRIEVED VIA LOCATE                         */
*        /* THE FIRST ENTRY PROCESSED IS THE ENTRY TYPE FIELD        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0752
*        CTGFLPTR = ADDR(ALFPLTYP);                                0752
*                                                                  0752
         L     @06,ALPRMPTR                                        0752
         LA    @06,ALFPLTYP(,@06)                                  0752
         ST    @06,CTGFLPTR                                        0752
*        IF CTGFLNG(1) ^= 0            /* IS OCCURRENCE PRESENT      */
*          THEN                                                    0753
         L     @15,CTGFLNG(,@06)                                   0753
         LTR   @15,@15                                             0753
         BZ    @RF00753                                            0753
*            DO;                                                   0754
*                                                                  0754
*            IF CTGFLPT(1) -> LCETYPVL ^= 'FF'X  /*IS IT NON-NULL    */
*              THEN                                                0755
         L     @06,CTGFLPT(,@06)                                   0755
         CLI   LCETYPVL(@06),X'FF'                                 0755
         BE    @RF00755                                            0755
*                DO;                                               0756
*                                                                  0756
*                LCETYPLN = CTGFLNG(1);                            0757
         ST    @15,LCETYPLN                                        0757
*                LCETYPPT = CTGFLPT(1);                            0758
*                                                                  0758
         ST    @06,LCETYPPT                                        0758
*                END;                                              0759
*                                                                  0759
*            END;                                                  0760
*                                                                  0760
@RF00755 DS    0H                                                  0761
*        /************************************************************/
*        /*                                                          */
*        /* A NONEXISTANT OR NULL ENTRY TYPE INDICATES A LOCATE ERROR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0761
*        IF LCETYPPT = NULLPTR                                     0761
*          THEN                                                    0761
@RF00753 L     @06,LCETYPPT                                        0761
         LTR   @06,@06                                             0761
         BNZ   @RF00761                                            0761
*            DO;                                                   0762
*                                                                  0762
*            ALSTID = LOCRTNER;                                    0763
         MVC   ALSTID(5),@CB01025                                  0763
*            RETURN;                                               0764
*                                                                  0764
         B     @EL00002                                            0764
*            END;                                                  0765
*                                                                  0765
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE LOCTABLE CATACB FIELD                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0766
*        IF CATACBPT = NULLPTR                                     0766
*          THEN                                                    0766
@RF00761 SLR   @06,@06                                             0766
         C     @06,CATACBPT                                        0766
         BNE   @RF00766                                            0766
*            DO;                                                   0767
*                                                                  0767
*            CTGFLPTR = ADDR(ALFPLACB);                            0768
         L     @01,ALPRMPTR                                        0768
         LA    @15,ALFPLACB(,@01)                                  0768
         ST    @15,CTGFLPTR                                        0768
*            IF CTGFLNG(1) ^= NULLPTR  /* DOES OCCURRENCE EXIST      */
*              THEN                                                0769
         C     @06,CTGFLNG(,@15)                                   0769
         BE    @RF00769                                            0769
*                DO;                                               0770
*                                                                  0770
*                /*   IS OCCURRENCE NON-NULL                         */
*                IF CTGFLPT(1) -> LCACBVAL ^= NULLMASK(1 : 4)      0771
*                  THEN                                            0771
         L     @06,CTGFLPT(,@15)                                   0771
         CLC   LCACBVAL(4,@06),NULLMASK                            0771
         BE    @RF00771                                            0771
*                    CATACBPT = CTGFLPT(1);                        0772
         ST    @06,CATACBPT                                        0772
*                END;                                              0773
@RF00771 DS    0H                                                  0774
*            END;                                                  0774
*                                                                  0774
@RF00769 DS    0H                                                  0775
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCTABLE NAMEDS FIELD                 @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0775
*        CTGFLPTR = ADDR(ALFPLNAM);                        /*@Y30SSJH*/
*                                                                  0775
@RF00766 L     @06,ALPRMPTR                                        0775
         LA    @06,ALFPLNAM(,@06)                                  0775
         ST    @06,CTGFLPTR                                        0775
*        IF CTGFLNG(1) ^= NULLPTR                                  0776
*          THEN                                                    0776
         L     @15,CTGFLNG(,@06)                                   0776
         LTR   @15,@15                                             0776
         BZ    @RF00776                                            0776
*            IF CTGFLPT(1) -> LCNAMEDS(1,1:4) ^= NULLMASK(1:4)     0777
*              THEN                                                0777
         L     @06,CTGFLPT(,@06)                                   0777
         CLC   LCNAMEDS(4,@06),NULLMASK                            0777
         BE    @RF00777                                            0777
*                DO;                                       /*@Y30SSJH*/
*                                                                  0778
*                LCNAMLN = CTGFLNG(1);                     /*@Y30SSJH*/
         ST    @15,LCNAMLN                                         0779
*                LCNAMPT = CTGFLPT(1);                     /*@Y30SSJH*/
*                                                                  0780
         ST    @06,LCNAMPT                                         0780
*                END;                                      /*@Y30SSJH*/
*                                                                  0781
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* A NON-EXISTANT OR NULL NAMEDS INDICATES A        @Y30SSJH*/
*        /* LOCATE ERROR                                     @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*        IF LCETYPVL ^= 'A'   &                            /*@Y30SSJH*/
*           LCETYPVL ^= 'B'                                /*@Y30SSJH*/
*          THEN                                                    0782
@RF00777 DS    0H                                                  0782
@RF00776 L     @06,LCETYPPT                                        0782
         CLI   LCETYPVL(@06),C'A'                                  0782
         BE    @RF00782                                            0782
         CLI   LCETYPVL(@06),C'B'                                  0782
         BE    @RF00782                                            0782
*            IF LCNAMPT = NULLPTR                                  0783
*              THEN                                                0783
         L     @06,LCNAMPT                                         0783
         LTR   @06,@06                                             0783
         BNZ   @RF00783                                            0783
*                DO;                                       /*@Y30SSJH*/
*                                                                  0784
*                ALSTID = LOCRTNER;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  0785
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  0786
         B     @EL00002                                            0786
*                END;                                      /*@Y30SSJH*/
*                                                                  0787
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCTABLE HURBADS FIELD                @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0788
*        CTGFLPTR = ADDR(ALFPLRBA);                        /*@Y30SSJH*/
*                                                                  0788
@RF00783 DS    0H                                                  0788
@RF00782 L     @06,ALPRMPTR                                        0788
         LA    @06,ALFPLRBA(,@06)                                  0788
         ST    @06,CTGFLPTR                                        0788
*        IF CTGFLNG(1) ^= NULLPTR                                  0789
*          THEN                                                    0789
         L     @15,CTGFLNG(,@06)                                   0789
         LTR   @15,@15                                             0789
         BZ    @RF00789                                            0789
*            IF CTGFLPT(1) -> LCHURBA ^= NULLMASK(1:4)             0790
*              THEN                                                0790
         L     @06,CTGFLPT(,@06)                                   0790
         CLC   LCHURBA(4,@06),NULLMASK                             0790
         BE    @RF00790                                            0790
*                DO;                                       /*@Y30SSJH*/
*                                                                  0791
*                LCRBALN = CTGFLNG(1);                     /*@Y30SSJH*/
         ST    @15,LCRBALN                                         0792
*                LCRBAPT = CTGFLPT(1);                     /*@Y30SSJH*/
*                                                                  0793
         ST    @06,LCRBAPT                                         0793
*                END;                                      /*@Y30SSJH*/
*                                                                  0794
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCTABLE CATALOG RECOVERY VOLUME      @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0795
*        CTGFLPTR = ADDR(ALFPLCRA);                        /*@Y30SSJH*/
*                                                                  0795
@RF00790 DS    0H                                                  0795
@RF00789 L     @06,ALPRMPTR                                        0795
         LA    @06,ALFPLCRA(,@06)                                  0795
         ST    @06,CTGFLPTR                                        0795
*        IF CTGFLNG(1) ^= NULLPTR                                  0796
*          THEN                                                    0796
         SLR   @15,@15                                             0796
         L     @14,CTGFLNG(,@06)                                   0796
         CR    @14,@15                                             0796
         BE    @RF00796                                            0796
*            IF CTGFLPT(1) -> LCCRAVOL ^= NULLCRA     &            0797
*               CTGFLPT(1) ^= NULLPTR                              0797
*              THEN                                                0797
         L     @06,CTGFLPT(,@06)                                   0797
         CLC   LCCRAVOL(6,@06),NULLCRA                             0797
         BE    @RF00797                                            0797
         CR    @06,@15                                             0797
         BE    @RF00797                                            0797
*                DO;                                       /*@Y30SSJH*/
*                                                                  0798
*                LCCRALN = CTGFLNG(1);                     /*@Y30SSJH*/
         ST    @14,LCCRALN                                         0799
*                LCCRAPT = CTGFLPT(1);                     /*@Y30SSJH*/
*                                                                  0800
         ST    @06,LCCRAPT                                         0800
*                END;                                      /*@Y30SSJH*/
*                                                                  0801
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE LOCTABLE PASSWALL FIELD                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0802
*        CTGFLPTR = ADDR(ALFPLPSW);                                0802
@RF00797 DS    0H                                                  0802
@RF00796 L     @06,ALPRMPTR                                        0802
         LA    @06,ALFPLPSW(,@06)                                  0802
         ST    @06,CTGFLPTR                                        0802
*        IF CTGFLNG(1) ^= 0                                        0803
*          THEN                                                    0803
         SLR   @15,@15                                             0803
         L     @14,CTGFLNG(,@06)                                   0803
         CR    @14,@15                                             0803
         BE    @RF00803                                            0803
*            DO;                                                   0804
*                                                                  0804
*            /********************************************************/
*            /*                                                      */
*            /* HAVE THE PASSWORDS BEEN SUPPRESSED - IF SO THERE IS  */
*            /* NOT SUFFICIENT AUTHORIZATION TO ALTER - TERMINATE    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0805
*            IF CTGFLNG(1) = 1   &                                 0805
*               CTGFLPT(1) = 0                                     0805
*              THEN                                                0805
         C     @14,@CF00220                                        0805
         BNE   @RF00805                                            0805
         C     @15,CTGFLPT(,@06)                                   0805
         BNE   @RF00805                                            0805
*                DO;                                               0806
*                                                                  0806
*                ALSTID = PSWDSUPR;                                0807
         MVC   ALSTID(5),@CB01045                                  0807
*                RETURN;                                           0808
*                                                                  0808
         B     @EL00002                                            0808
*                END;                                              0809
*                                                                  0809
*            /********************************************************/
*            /*                                                      */
*            /* IS OCCURRENCE NON-NULL                               */
*            /*                                                      */
*            /********************************************************/
*                                                                  0810
*            IF CTGFLPT(1) -> LCMSTRPW ^= NULLMASK                 0810
*              THEN                                                0810
@RF00805 L     @06,CTGFLPTR                                        0810
         L     @15,CTGFLPT(,@06)                                   0810
         CLC   LCMSTRPW(8,@15),NULLMASK                            0810
         BE    @RF00810                                            0810
*                DO;                                               0811
*                                                                  0811
*                LCPSWLN = CTGFLNG(1);                             0812
         L     @06,CTGFLNG(,@06)                                   0812
         ST    @06,LCPSWLN                                         0812
*                LCPSWPT = CTGFLPT(1);                             0813
*                                                                  0813
         ST    @15,LCPSWPT                                         0813
*                END;                                              0814
*                                                                  0814
*            END;                                                  0815
*                                                                  0815
@RF00810 DS    0H                                                  0816
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCTABLE DATASET ATTRIBUTES FIELD     @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0816
*        CTGFLPTR = ADDR(ALFPLDAT);                        /*@Y30SSJH*/
*                                                                  0816
@RF00803 L     @06,ALPRMPTR                                        0816
         LA    @06,ALFPLDAT(,@06)                                  0816
         ST    @06,CTGFLPTR                                        0816
*        IF CTGFLNG(1) ^= 0                                        0817
*          THEN                                                    0817
         L     @06,CTGFLNG(,@06)                                   0817
         LTR   @06,@06                                             0817
         BZ    @RF00817                                            0817
*            IF LCETYPVL = 'D' ×                                   0818
*               LCETYPVL = 'I'                                     0818
*              THEN                                                0818
         L     @06,LCETYPPT                                        0818
         CLI   LCETYPVL(@06),C'D'                                  0818
         BE    @RT00818                                            0818
         CLI   LCETYPVL(@06),C'I'                                  0818
         BNE   @RF00818                                            0818
@RT00818 DS    0H                                                  0819
*                DO;                                       /*@Y30SSJH*/
*                                                                  0819
*                IF CTGFLPT(1) -> LCDSATR ^= 'FFFF'X               0820
*                  THEN                                            0820
         L     @06,CTGFLPTR                                        0820
         L     @15,CTGFLPT(,@06)                                   0820
         CLC   LCDSATR(2,@15),@CB01457                             0820
         BE    @RF00820                                            0820
*                    DO;                                   /*@Y30SSJH*/
*                                                                  0821
*                    LCDATRLN = CTGFLNG(1);                /*@Y30SSJH*/
         L     @06,CTGFLNG(,@06)                                   0822
         ST    @06,LCDATRLN                                        0822
*                    LCDATRPT = CTGFLPT(1);                /*@Y30SSJH*/
*                                                                  0823
         ST    @15,LCDATRPT                                        0823
*                    END;                                  /*@Y30SSJH*/
*                                                                  0824
*                END;                                      /*@Y30SSJH*/
*                                                                  0825
@RF00820 DS    0H                                                  0826
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCTABLE AMDSB FIELD                  @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0826
*        CTGFLPTR = ADDR(ALFPLAMD);                        /*@Y30SSJH*/
*                                                                  0826
@RF00818 DS    0H                                                  0826
@RF00817 L     @06,ALPRMPTR                                        0826
         LA    @06,ALFPLAMD(,@06)                                  0826
         ST    @06,CTGFLPTR                                        0826
*        IF CTGFLNG(1) ^= 0                                        0827
*          THEN                                                    0827
         L     @15,CTGFLNG(,@06)                                   0827
         LTR   @15,@15                                             0827
         BZ    @RF00827                                            0827
*            DO;                                           /*@Y30SSJH*/
*                                                                  0828
*            IF CTGFLPT(1) -> IDAAMDSB ^= NULLMASK         /*@Y30SSJH*/
*              THEN                                                0829
         L     @06,CTGFLPT(,@06)                                   0829
         CLC   IDAAMDSB(8,@06),NULLMASK                            0829
         BE    @RF00829                                            0829
*                DO;                                       /*@Y30SSJH*/
*                                                                  0830
*                LCAMDLN = CTGFLNG(1);                     /*@Y30SSJH*/
         ST    @15,LCAMDLN                                         0831
*                LCAMDPT = CTGFLPT(1);                     /*@Y30SSJH*/
*                                                                  0832
         ST    @06,LCAMDPT                                         0832
*                END;                                      /*@Y30SSJH*/
*                                                                  0833
*            END;                                          /*@Y30SSJH*/
*                                                                  0834
@RF00829 DS    0H                                                  0835
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCATABLE RGATTR FIELD                @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0835
*        CTGFLPTR = ADDR(ALFPLRGA);                        /*@Y30SSJH*/
*                                                                  0835
@RF00827 L     @06,ALPRMPTR                                        0835
         LA    @06,ALFPLRGA(,@06)                                  0835
         ST    @06,CTGFLPTR                                        0835
*        IF CTGFLNG(1) ^= NULLPTR                                  0836
*          THEN                                                    0836
         L     @15,CTGFLNG(,@06)                                   0836
         LTR   @15,@15                                             0836
         BZ    @RF00836                                            0836
*            IF LCETYPVL = 'G'                                     0837
*              THEN                                                0837
         L     @01,LCETYPPT                                        0837
         CLI   LCETYPVL(@01),C'G'                                  0837
         BNE   @RF00837                                            0837
*                IF CTGFLPT(1) -> LCRGATTR ^= NULLMASK(1)          0838
*                  THEN                                            0838
         L     @06,CTGFLPT(,@06)                                   0838
         CLC   LCRGATTR(1,@06),NULLMASK                            0838
         BE    @RF00838                                            0838
*                    DO;                                   /*@Y30SSJH*/
*                                                                  0839
*                    LCRATRLN = CTGFLNG(1);                /*@Y30SSJH*/
         ST    @15,LCRATRLN                                        0840
*                    LCRATRPT = CTGFLPT(1);                /*@Y30SSJH*/
*                                                                  0841
         ST    @06,LCRATRPT                                        0841
*                    END;                                  /*@Y30SSJH*/
*                                                                  0842
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE LOCTABLE GDG ATTRIBUTES FIELD         @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0843
*        CTGFLPTR = ADDR(ALFPLGDG);                        /*@Y30SSJH*/
*                                                                  0843
@RF00838 DS    0H                                                  0843
@RF00837 DS    0H                                                  0843
@RF00836 L     @06,ALPRMPTR                                        0843
         LA    @06,ALFPLGDG(,@06)                                  0843
         ST    @06,CTGFLPTR                                        0843
*        IF CTGFLNG(1) ^= 0                                        0844
*          THEN                                                    0844
         L     @15,CTGFLNG(,@06)                                   0844
         LTR   @15,@15                                             0844
         BZ    @RF00844                                            0844
*            DO;                                           /*@Y30SSJH*/
*                                                                  0845
*            IF CTGFLPT(1) -> LCGDGATR ^= 'FF'X                    0846
*              THEN                                                0846
         L     @06,CTGFLPT(,@06)                                   0846
         CLI   LCGDGATR(@06),X'FF'                                 0846
         BE    @RF00846                                            0846
*                DO;                                       /*@Y30SSJH*/
*                                                                  0847
*                LCGATRLN = CTGFLNG(1);                    /*@YL026UA*/
         ST    @15,LCGATRLN                                        0848
*                LCGATRPT = CTGFLPT(1);                    /*@YL026UA*/
*                                                                  0849
         ST    @06,LCGATRPT                                        0849
*                END;                                      /*@YL026UA*/
*                                                                  0850
*            END;                                          /*@YL026UA*/
*                                                                  0851
*        /************************************************************/
*        /*                                                          */
*        /* LOCATPRC PROCESSING IS COMPLETE RETURN TO INVOKER        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0852
*        RETURN;                                                   0852
*                                                                  0852
         B     @EL00002                                            0852
*END LOCATPRC;                                                     0853
         B     @EL00002                                            0853
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - ALTERPRC (STAGE 4 PROCESSOR)            @Y30SSJH*/
*/*                                                                  */
*/* FUNCTION - ALTERPRC BUILDS THE VSAM CATALOG MANAGEMENT INTERFACE */
*/*            FOR THE ALTER REQUEST. THE INTERFACE CONSISTS OF THE  */
*/*            CPL-FVT-FPL COMPLEX.                                  */
*/*                                                                  */
*/*            LOCTABLE PROVIDES REFERENCE TO THOSE FIELDS WHICH     */
*/*            MUST BE ALTERED IN THEIR ORIGINAL CONTEXT             */
*/*                                                                  */
*/*            THE CPL CONTAINS INFORMATION WHICH INDICATES TO       */
*/*            VSAM CATALOG MANAGEMENT THE TYPE OF REQUEST, THE      */
*/*            CATALOG AND PASSWORD INFORMATION AND IF SPECIFIED THE */
*/*            NEW NAME OF THE CATALOG OBJECT                        */
*/*                                                                  */
*/*            THE FVT ORGANIZES THE REFERENCE TO THE FIELDS TO BE   */
*/*            ALTERED, AND GIVES THE ADDRESS OF THE OBJECTS NAME    */
*/*                                                                  */
*/*            THE FPLS AND 'PSEUDO FIELDS' CONTAIN THE DATA         */
*/*            NECESSARY TO ALTER THE FIELDS                         */
*/*                                                                  */
*/* INPUT -                                                          */
*/*            ACATACB - CATALOG ACB ADDRESS                         */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*            ALCTGPRM - THE CPL-FVT-FPL COMPLEX IS BUILT IN THIS   */
*/*              AREA, WHICH IS INITIALIZED IN IDCAL01               */
*/*            ALSTID   - THE GLOBAL INTERNAL STATUS COMMUNICATOR    */
*/*              IS SET ON ERROR DETECTION:                          */
*/*                ALSTID = NOSTORAG                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0854
*ALTERPRC:                                                         0854
*        PROCEDURE(ACATACB);                                       0854
ALTERPRC STM   @14,@12,@SA00003                                    0854
         MVC   @PC00003(4),0(@01)                                  0854
*        /************************************************************/
*        /*                                                          */
*        /* ARGUMENTS OF INVOCATION                                  */
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0855
*          ACATACB;                    /* CATALOG ACB ADDRESS        */
*                                                                  0855
*        /************************************************************/
*        /*                                                          */
*        /* VOLUME LIST FOR ADDING AND REMOVING VOLUMES              */
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0856
*          1 ALVLIST BDY(WORD) BASED(CTGFVVLT),                    0856
*            2 ALVLSTLN  FIXED(15),    /*LENGTH OF VOLUME LIST       */
*            2 *  (*)       CHAR(8),                               0856
*              3 ALVLSTCD  CHAR(1),    /* ADD/REMOVE VOL FLAG        */
*              3 *         CHAR(1),                                0856
*              3 ALVOLUME  CHAR(6);    /* VOLUME SERIAL NUMBER       */
*                                                                  0856
*        /************************************************************/
*        /*                                                          */
*        /* COUNT FIELD USED IN LOOP CONTROL FOR ADDING AND REMOVING */
*        /* VOLUMES FROM THE VOLSER LIST                             */
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0857
*          ADDCOUNT FIXED(15);                                     0857
*                                                                  0857
*        /************************************************************/
*        /*                                                          */
*        /* ARRAY FOR NULLIFYING PASSWORD VALUES                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0858
*        DCL                                                       0858
*          NULLPSWD(4) CHAR(8) BASED(LCPSWPT);                     0858
*                                                                  0858
*        /************************************************************/
*        /*                                                          */
*        /* COMPUTATION AREA FOR LENGTH OF VOLUME LIST FOR ADD/REMOVE*/
*        /* VOLUMES REQUEST.                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0859
*        DCL                                                       0859
*          ALVOLLEN FIXED(31);                                     0859
*                                                                  0859
*        /************************************************************/
*        /*                                                          */
*        /* DYNAMIC POINTER TO PASSWORDS, USED IN PASSWORD MIGRATION */
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0860
*          NEWPSWPT PTR(31);                                       0860
*                                                                  0860
*        DCL                                                       0861
*          PCT100 FIXED(31) CONSTANT(100);                 /*@OZ05907*/
*                                                                  0861
*        /************************************************************/
*        /*                                                          */
*        /* THIS SECTION DEFINES THOSE VALUES USED IN THE COMPUTATION*/
*        /* REQUIRED TO ALTER THE EXPIRATION DATE                    */
*        /* THE FINAL VALUE REFERENCED BY THE FPL RESIDES IN THE     */
*        /* FIRST STRUCTURE                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0862
*        DCL                                                       0862
*          1 EXPIREDT  CHAR(8) BDY(DWORD),                         0862
*            2 *       CHAR(5),                                    0862
*            2 EXPIRE  CHAR(3),                                    0862
*              3 EXPIRYR FIXED(8) BDY(BYTE),                       0862
*              3 EXPIRDAY FIXED(15) BDY(BYTE);                     0862
*                                                                  0862
*        /************************************************************/
*        /*                                                          */
*        /* LOOP CONTROL FLAG FOR YEAR/DAY CALCULATION               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0863
*        DCL                                                       0863
*          DATELOOP CHAR(1);                                       0863
*                                                                  0863
*        /************************************************************/
*        /*                                                          */
*        /* AREA FOR RETURN OF UTIME DATE AND TIME                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0864
*        DCL                                                       0864
*          1 XCURDATE CHAR(8) BDY(DWORD),                          0864
*            2 *       CHAR(1),                                    0864
*            2 XUTYEAR FIXED(8),                                   0864
*            2 XUTDAY  FIXED(15);                                  0864
*                                                                  0864
*        DCL                                                       0865
*          TIMEODAY CHAR(8) BDY(DWORD);                            0865
*                                                                  0865
*        /************************************************************/
*        /*                                                          */
*        /* DAY AND YEAR COMPUTATION WORKAREAS                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0866
*        DCL                                                       0866
*          1 DAYTOTL  CHAR(8) BDY(DWORD),                          0866
*            2 *      CHAR(6),                                     0866
*            2 DAYTOTAL FIXED(15);                                 0866
*                                                                  0866
*        DCL                                                       0867
*          NOWYEAR FIXED(15),                                      0867
*          DAYPERYR FIXED(15);                                     0867
*                                                                  0867
*        /************************************************************/
*        /*                                                          */
*        /* VARIABLES USED TO MIGRATE PASSWORDS WHEN THE MASTER      */
*        /* PASSWORD HAS BEEN NULLIFIED AND THERE IS STILL VALID     */
*        /* PASSWORDS                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0868
*        DCL                                                       0868
*          MIGRLOOP  FIXED(15),                                    0868
*          MIGRFLAG  CHAR(1);                                      0868
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO ALTERPRC                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0869
*        OLDERID2 = NEWERID2;                                      0869
         L     @06,@PC00001                                        0869
         L     @06,GDTTR2(,@06)                                    0869
         MVC   @TS00001(95),NEWERID2(@06)                          0869
         MVC   OLDERID2(95,@06),@TS00001                           0869
*        NEWID2 = 'AL41';                                          0870
*                                                                  0870
         MVC   NEWID2(4,@06),@CC01492                              0870
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE CPL FOR ALTER REQUEST                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0871
*        CTGPLPTR = ADDR(ALCTGPL);      /* SET POINTER TO THE CPL    */
         L     @06,ALPRMPTR                                        0871
         LA    @15,ALCTGPL(,@06)                                   0871
         ST    @15,CTGPLPTR                                        0871
*        ALCTGPL = ''B;                 /* SET CPL TO BINARY ZEROES  */
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        0872
*        ALCTGFLD = ''B;                                   /*@Y30SSJH*/
         XC    ALCTGFLD(40,@06),ALCTGFLD(@06)                      0873
*        ALCPLID = 'CPL';               /* CPL DUMP ID               */
         MVI   ALCPLID+3(@06),C' '                                 0874
         MVC   ALCPLID+4(4,@06),ALCPLID+3(@06)                     0874
         MVC   ALCPLID(3,@06),@CC01442                             0874
*        CTGFUNC = CTGCMS;              /* INDICATE CMS FUNCTION     */
         NI    CTGFUNC(@15),B'10011111'                            0875
         OI    CTGFUNC(@15),B'10000000'                            0875
*        CTGNAME = ON;                  /* ACCESS CATALOG BY NAME    */
         OI    CTGNAME(@15),B'00000100'                            0876
*        CTGFVT = ADDR(ALCTGFVT);       /* SET FVT ADDR IN CPL       */
         LA    @14,ALCTGFVT(,@06)                                  0877
         ST    @14,CTGFVT(,@15)                                    0877
*        CTGAM0 = ON;                   /* INDICATE VSAM REQUEST     */
         OI    CTGAM0(@15),B'00000001'                             0878
*        CTGWKA = ADDR(ALWKAREA);       /* REFERENCE ALTER WORKAREA  */
         LA    @14,ALWKAREA(,@06)                                  0879
         ST    @14,CTGWKA(,@15)                                    0879
*        CTGOPTNS = CTGALTER;           /* INDICATE ALTER REQUEST    */
         NI    CTGOPTNS(@15),B'00010111'                           0880
         OI    CTGOPTNS(@15),B'00010000'                           0880
*        ALWKAREA = ''B;                                   /*@Y30SSJH*/
*                                                                  0881
         XC    ALWKAREA(4,@06),ALWKAREA(@06)                       0881
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE ORIGINAL ENTRY NAME IN FVT                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0882
*        IF ((ADDR(KEY)) ^= NULLPTR   ×                            0882
*            (ADDR(RECSZ)) ^= NULLPTR)                             0882
*          THEN                                                    0882
         SLR   @06,@06                                             0882
         L     @15,@PC00001+4                                      0882
         C     @06,FDTPTR+220(,@15)                                0882
         BNE   @RT00882                                            0882
         C     @06,FDTPTR+232(,@15)                                0882
         BE    @RF00882                                            0882
@RT00882 DS    0H                                                  0883
*            DO;                                           /*@Y30SSJH*/
*                                                                  0883
*            CTGFVENT = ADDR(DATACI);                      /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        0884
         L     @01,CTGFVT(,@06)                                    0884
         LA    @00,DATACI                                          0884
         ST    @00,CTGFVENT(,@01)                                  0884
*            CTGNAME = OFF;                                /*@Y30SSJH*/
*                                                                  0885
         NI    CTGNAME(@06),B'11111011'                            0885
*            END;                                          /*@Y30SSJH*/
*          ELSE                                                    0887
*            CTGFVENT = ADDR(ENTVAL(ENT));                 /*@Y30SSJH*/
*                                                                  0887
         B     @RC00882                                            0887
@RF00882 L     @06,CTGPLPTR                                        0887
         L     @06,CTGFVT(,@06)                                    0887
         L     @15,ENT                                             0887
         MH    @15,@CH00687                                        0887
         L     @01,GENWKPTR                                        0887
         AL    @01,@CF01685                                        0887
         LA    @15,ENTVAL-5(@15,@01)                               0887
         ST    @15,CTGFVENT(,@06)                                  0887
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE CATALOG NAME OR ACB ADDRESS IN CATALOG        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0888
*        IF ACATACB ^= NULLPTR                                     0888
*          THEN                                                    0888
@RC00882 L     @06,@PC00003                                        0888
         L     @06,ACATACB(,@06)                                   0888
         LTR   @06,@06                                             0888
         BZ    @RF00888                                            0888
*            DO;                                                   0889
*                                                                  0889
*            CTGCNAME = OFF;                                       0890
         L     @15,CTGPLPTR                                        0890
         NI    CTGCNAME(@15),B'11111101'                           0890
*            CTGCAT = ACATACB;                                     0891
*                                                                  0891
         ST    @06,CTGCAT(,@15)                                    0891
*            END;                                                  0892
*                                                                  0892
*          ELSE                                                    0893
*            DO;                                                   0893
*                                                                  0893
         B     @RC00888                                            0893
@RF00888 DS    0H                                                  0894
*            CTGCNAME = ON;                                        0894
         L     @06,CTGPLPTR                                        0894
         OI    CTGCNAME(@06),B'00000010'                           0894
*            IF (ADDR(CATLG)) ^= NULLPTR                           0895
*              THEN                                                0895
         L     @15,@PC00001+4                                      0895
         L     @15,FDTPTR+8(,@15)                                  0895
         LTR   @15,@15                                             0895
         BZ    @RF00895                                            0895
*                CTGCAT = ADDR(CATLGVAL);                  /*@YL026UA*/
         LA    @15,CATLGVAL(,@15)                                  0896
         ST    @15,CTGCAT(,@06)                                    0896
*              ELSE                                                0897
*                IF NTRYPOS ^= 0                                   0897
*                  THEN                                            0897
         B     @RC00895                                            0897
@RF00895 L     @06,@PC00001+4                                      0897
         L     @06,FDTPTR(,@06)                                    0897
         CLI   NTRYPOS(@06),0                                      0897
         BE    @RF00897                                            0897
*                    CTGCAT = ADDR(CATNAME);               /*@YL026UA*/
*                                                                  0898
         LA    @06,CATNAME                                         0898
         L     @01,CTGPLPTR                                        0898
         ST    @06,CTGCAT(,@01)                                    0898
*            END;                                                  0899
@RF00897 DS    0H                                                  0899
@RC00895 DS    0H                                                  0900
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE PASSWORD AUTHORIZATION IN CPL - THE CATALOG   */
*        /* PASSWORD HAS PRIORITY OVER THE ENTRY PASSWORD            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0900
*        IF (ADDR(CATLG)) ^= NULLPTR                               0900
*          THEN                                                    0900
@RC00888 L     @06,@PC00001+4                                      0900
         L     @06,FDTPTR+8(,@06)                                  0900
         LTR   @06,@06                                             0900
         BZ    @RF00900                                            0900
*            IF CATLGPLN ^= 0          /* CATALOG PASSWORD           */
*              THEN                                                0901
         CLI   CATLGPLN(@06),0                                     0901
         BE    @RF00901                                            0901
*                CTGPSWD = ADDR(CATLGPAS);                         0902
*                                                                  0902
         LA    @06,CATLGPAS(,@06)                                  0902
         L     @01,CTGPLPTR                                        0902
         ST    @06,CTGPSWD(,@01)                                   0902
*        IF CTGPSWD = NULLPTR                                      0903
*          THEN                                                    0903
@RF00901 DS    0H                                                  0903
@RF00900 L     @06,CTGPLPTR                                        0903
         L     @15,CTGPSWD(,@06)                                   0903
         LTR   @15,@15                                             0903
         BNZ   @RF00903                                            0903
*            IF NTRYPLN ^= 0           /* ENTRY PASSWORD     @YL026UA*/
*              THEN                                                0904
         L     @15,@PC00001+4                                      0904
         L     @15,FDTPTR(,@15)                                    0904
         CLI   NTRYPLN(@15),0                                      0904
         BE    @RF00904                                            0904
*                CTGPSWD = ADDR(NTRYPAS);                  /*@YL026UA*/
*                                                                  0905
         LA    @15,NTRYPAS(,@15)                                   0905
         ST    @15,CTGPSWD(,@06)                                   0905
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* IF THE KEYS AND/OR RECORDSIZE PARAMETER HAS BEEN @Y30SSJH*/
*        /* SPECIFIED AND A LOCATE HAS BEEN PERFORMED AT A   @Y30SSJH*/
*        /* LEVEL HIGHER THAN DATA, SET BYPASS VERIFICATION  @Y30SSJH*/
*        /* - EFFECTIVE IN DOS ONLY                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0906
*        IF ((ADDR(KEY))   ^= NULLPTR ×                            0906
*            (ADDR(RECSZ)) ^= NULLPTR )                            0906
*          THEN                                                    0906
@RF00904 DS    0H                                                  0906
@RF00903 SLR   @06,@06                                             0906
         L     @15,@PC00001+4                                      0906
         C     @06,FDTPTR+220(,@15)                                0906
         BNE   @RT00906                                            0906
         C     @06,FDTPTR+232(,@15)                                0906
         BE    @RF00906                                            0906
@RT00906 DS    0H                                                  0907
*            IF BYPASSSW = STOP                                    0907
*              THEN                                                0907
         CLI   BYPASSSW,X'0F'                                      0907
         BNE   @RF00907                                            0907
*                CTGBYPSS = ON;                            /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        0908
         OI    CTGBYPSS(@06),B'10000000'                           0908
*        /************************************************************/
*        /*                                                          */
*        /* BEGIN CONSTRUCTION OF ALTERATIONS                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0909
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE THE NEW ENTRY NAME OF THE OBJECT              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0909
*            IF ADDR(NEWNM) ^= NULLPTR                     /*@YL026UA*/
*              THEN                                                0909
@RF00907 DS    0H                                                  0909
@RF00906 L     @06,@PC00001+4                                      0909
         L     @06,FDTPTR+16(,@06)                                 0909
         LTR   @06,@06                                             0909
         BZ    @RF00909                                            0909
*                CTGNEWNM = ADDR(NEWNAME);                 /*@YL026UA*/
*                                                                  0910
         LA    @06,NEWNAME                                         0910
         L     @01,CTGPLPTR                                        0910
         ST    @06,CTGNEWNM(,@01)                                  0910
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE FPLS WHICH COMMUNICATE ALTERATIONS            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0911
*        ALFPLLST(1:256) = ''B;                            /*@Y30SSJH*/
@RF00909 L     @06,ALPRMPTR                                        0911
         XC    ALFPLLST(256,@06),ALFPLLST(@06)                     0911
*        ALFPLLST(257:LENGTH(ALFPLLST)) = ''B;             /*@Y30SSJH*/
         XC    ALFPLLST+256(192,@06),ALFPLLST+256(@06)             0912
*        CTGFVPTR = ADDR(ALCTGFVT);                                0913
         LA    @15,ALCTGFVT(,@06)                                  0913
         ST    @15,CTGFVPTR                                        0913
*        ALFVTID = 'FVT';                                          0914
*                                                                  0914
         MVI   ALFVTID+3(@06),C' '                                 0914
         MVC   ALFVTID(3,@06),@CC01493                             0914
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ENTYPE IS SET IN FVT IF A LOCATE HAS BEEN        @Y30SSJH*/
*        /* PERFORMED OR IF UPGRADE/UPDATE ATTRIBUTES HAVE   @Y30SSJH*/
*        /* BEEN SPECIFIED                                   @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0915
*        IF LCETYPPT ^= NULLPTR                                    0915
*          THEN                                                    0915
         L     @06,LCETYPPT                                        0915
         LTR   @06,@06                                             0915
         BZ    @RF00915                                            0915
*            CTGFVTYP = LCETYPVL;                          /*@Y30SSJH*/
*                                                                  0916
         L     @01,CTGPLPTR                                        0916
         L     @01,CTGFVT(,@01)                                    0916
         MVC   CTGFVTYP(1,@01),LCETYPVL(@06)                       0916
*          ELSE                                                    0917
*            IF ((ADDR(UPG)) ^= NULLPTR ×                          0917
*               (ADDR(NUPG)) ^= NULLPTR )                          0917
*              THEN                                                0917
         B     @RC00915                                            0917
@RF00915 SLR   @06,@06                                             0917
         L     @15,@PC00001+4                                      0917
         C     @06,FDTPTR+252(,@15)                                0917
         BNE   @RT00917                                            0917
         C     @06,FDTPTR+256(,@15)                                0917
         BE    @RF00917                                            0917
@RT00917 DS    0H                                                  0918
*                CTGFVTYP = 'G';                           /*@Y30SSJH*/
*                                                                  0918
         L     @06,CTGPLPTR                                        0918
         L     @06,CTGFVT(,@06)                                    0918
         MVI   CTGFVTYP(@06),C'G'                                  0918
*              ELSE                                                0919
*                IF ((ADDR(UPD)) ^= NULLPTR ×                      0919
*                   (ADDR(NUPD)) ^= NULLPTR )                      0919
*                  THEN                                            0919
         B     @RC00917                                            0919
@RF00917 SLR   @06,@06                                             0919
         L     @15,@PC00001+4                                      0919
         C     @06,FDTPTR+260(,@15)                                0919
         BNE   @RT00919                                            0919
         C     @06,FDTPTR+264(,@15)                                0919
         BE    @RF00919                                            0919
@RT00919 DS    0H                                                  0920
*                    CTGFVTYP = 'R';                       /*@Y30SSJH*/
*                                                                  0920
         L     @06,CTGPLPTR                                        0920
         L     @06,CTGFVT(,@06)                                    0920
         MVI   CTGFVTYP(@06),C'R'                                  0920
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE STATIC PORTIONS OF ALTER FPLS                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0921
*        CTGFLPTR = ADDR(ALFPLTYP);                                0921
*                                                                  0921
@RF00919 DS    0H                                                  0921
@RC00917 DS    0H                                                  0921
@RC00915 L     @06,ALPRMPTR                                        0921
         LA    @06,ALFPLTYP(,@06)                                  0921
         ST    @06,CTGFLPTR                                        0921
*        DO N = 1 TO 15;                                   /*@Y30SSJH*/
*                                                                  0922
         LA    @06,1                                               0922
         ST    @06,N                                               0922
@DL00922 DS    0H                                                  0923
*          CTGFL = ''B;                                    /*@Y30SSJH*/
         L     @15,CTGFLPTR                                        0923
         XC    CTGFL(16,@15),CTGFL(@15)                            0923
*          CTGFLNG(1) = NULLPTR;                           /*@Y30SSJH*/
         SLR   @14,@14                                             0924
         ST    @14,CTGFLNG(,@15)                                   0924
*          CTGFLPT(1) = NULLPTR;                           /*@Y30SSJH*/
         ST    @14,CTGFLPT(,@15)                                   0925
*          CTGFLDNO = 1;                                           0926
         MVI   CTGFLDNO(@15),X'01'                                 0926
*          CTGFLDNM = ADDR(ALFLDNAM(N));                           0927
         LR    @14,@06                                             0927
         SLA   @14,3                                               0927
         LA    @14,ALFLDNAM-8(@14)                                 0927
         ST    @14,CTGFLDNM(,@15)                                  0927
*          CTGFLPTR = CTGFLPTR + (LENGTH(CTGFL) + 12);             0928
*                                                                  0928
         AL    @15,@CF00678                                        0928
         ST    @15,CTGFLPTR                                        0928
*        END;                                                      0929
*                                                                  0929
         AL    @06,@CF00220                                        0929
         ST    @06,N                                               0929
         C     @06,@CF00229                                        0929
         BNH   @DL00922                                            0929
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE POINTER TO DNAME IN FVT                      */
*        /*                                                          */
*        /************************************************************/
*        IF (ADDR(INDD)) ^= NULLPTR                                0930
*          THEN                                                    0930
         L     @06,@PC00001+4                                      0930
         L     @06,FDTPTR+20(,@06)                                 0930
         LTR   @06,@06                                             0930
         BZ    @RF00930                                            0930
*            CTGFVIND = ADDR(INDDVAL);                     /*@YL026UA*/
*                                                                  0931
         L     @01,CTGPLPTR                                        0931
         L     @01,CTGFVT(,@01)                                    0931
         LA    @06,INDDVAL(,@06)                                   0931
         ST    @06,CTGFVIND(,@01)                                  0931
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE FPLS FOR ALTERATIONS TO PROTECTION ATTRIBUTES */
*        /*                                                          */
*        /************************************************************/
*        IF LCPSWPT = NULLPTR                                      0932
*          THEN                                                    0932
@RF00930 L     @06,LCPSWPT                                         0932
         LTR   @06,@06                                             0932
         BNZ   @RF00932                                            0932
*            DO;                                                   0933
*                                                                  0933
*            /********************************************************/
*            /*                                                      */
*            /* PASSWALL OCCURRENCE DID NOT OCCUR IN ORIGINAL OBJECT */
*            /* GET SPACE FOR PASSWALL COMBINATION AND INITIALIZE    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0934
*            CALL IDCSAGP0(GDTTBL,                                 0934
*                   (LENGTH(LCPSWFXD) + 255),  /* LENGTH OF AREA     */
*                   LCPSWPT,                                       0934
*                   ALGPID,                                        0934
*                   SETZERO);                                      0934
*                                                                  0934
         L     @06,@PC00001                                        0934
         ST    @06,@AL00001                                        0934
         LA    @15,307                                             0934
         ST    @15,@AFTEMPS                                        0934
         LA    @15,@AFTEMPS                                        0934
         ST    @15,@AL00001+4                                      0934
         LA    @15,LCPSWPT                                         0934
         ST    @15,@AL00001+8                                      0934
         LA    @15,ALGPID                                          0934
         ST    @15,@AL00001+12                                     0934
         LA    @15,SETZERO                                         0934
         ST    @15,@AL00001+16                                     0934
         MVI   @AL00001+16,X'80'                                   0934
         L     @15,GDTGPL(,@06)                                    0934
         LA    @01,@AL00001                                        0934
         BALR  @14,@15                                             0934
*            RESPECIFY RTNREG RSTD;                                0935
*            TESTRC = RTNREG;                                      0936
         STH   RTNREG,TESTRC                                       0936
*            RESPECIFY RTNREG UNRSTD;                              0937
*                                                                  0937
*            /********************************************************/
*            /*                                                      */
*            /* NO STORAGE AVAILABLE - TERMINAL ERROR                */
*            /*                                                      */
*            /********************************************************/
*                                                                  0938
*            IF TESTRC ^= 0                                        0938
*              THEN                                                0938
         LH    @06,TESTRC                                          0938
         LTR   @06,@06                                             0938
         BZ    @RF00938                                            0938
*                DO;                                               0939
*                                                                  0939
*                ALSTID = NOSTORAG;                                0940
         MVC   ALSTID(5),@CB01039                                  0940
*                RETURN;                                           0941
*                                                                  0941
@EL00003 DS    0H                                                  0941
@EF00003 DS    0H                                                  0941
@ER00003 LM    @14,@12,@SA00003                                    0941
         BR    @14                                                 0941
*                END;                                              0942
*            /********************************************************/
*            /*                                                      */
*            /* INITIALIZE THE PASSWALL FIELD TO BINARY ONES         */
*            /*                                                      */
*            /********************************************************/
*                                                                  0943
*            DO N = 1 TO (LENGTH(LCPSWFXD));                       0943
*                                                                  0943
@RF00938 LA    @06,1                                               0943
         ST    @06,N                                               0943
@DL00943 DS    0H                                                  0944
*              LCPSWFXD (N) = 'FF'X;                               0944
*                                                                  0944
         L     @01,LCPSWPT                                         0944
         ALR   @01,@06                                             0944
         BCTR  @01,0                                               0944
         MVI   LCPSWFXD(@01),X'FF'                                 0944
*            END;                                                  0945
*                                                                  0945
         AL    @06,@CF00220                                        0945
         ST    @06,N                                               0945
         C     @06,@CF00728                                        0945
         BNH   @DL00943                                            0945
*            /********************************************************/
*            /*                                                      */
*            /* INITIALIZE THE PASSWORD ATTEMPTS AND USAREC LENGTH   */
*            /*                                                      */
*            /********************************************************/
*            LCPWDATP = 2;                                         0946
         L     @06,LCPSWPT                                         0946
         MVC   LCPWDATP(2,@06),@CH00155                            0946
*            LCARECLN = 0;             /* INIT USARLEN TO ZERO       */
*                                                                  0947
         SLR   @15,@15                                             0947
         STH   @15,LCARECLN(,@06)                                  0947
*            END;                                                  0948
*                                                                  0948
*        /************************************************************/
*        /*                                                          */
*        /* NULLIFY THE PROTECTION ATTRIBUTES                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0949
*        IF (ADDR(NMSTR)) ^= NULLPTR  ×                            0949
*           (ADDR(NCNTV)) ^= NULLPTR  ×                            0949
*           (ADDR(NUPDT)) ^= NULLPTR  ×                            0949
*           (ADDR(NREAD)) ^= NULLPTR                               0949
*          THEN                                                    0949
@RF00932 SLR   @06,@06                                             0949
         L     @15,@PC00001+4                                      0949
         C     @06,FDTPTR+100(,@15)                                0949
         BNE   @RT00949                                            0949
         C     @06,FDTPTR+104(,@15)                                0949
         BNE   @RT00949                                            0949
         C     @06,FDTPTR+108(,@15)                                0949
         BNE   @RT00949                                            0949
         C     @06,FDTPTR+112(,@15)                                0949
         BE    @RF00949                                            0949
@RT00949 DS    0H                                                  0950
*            DO;                                                   0950
*                                                                  0950
*            CTGFVSTY = ADDR(ALFPLPSW);                            0951
*                                                                  0951
         L     @06,CTGPLPTR                                        0951
         L     @06,CTGFVT(,@06)                                    0951
         L     @01,ALPRMPTR                                        0951
         LA    @15,ALFPLPSW(,@01)                                  0951
         ST    @15,CTGFVSTY(,@06)                                  0951
*            /********************************************************/
*            /*                                                      */
*            /* NULLIFY THE MASTER PASSWORD                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0952
*            IF (ADDR(NMSTR)) ^= NULLPTR                           0952
*              THEN                                                0952
         L     @06,@PC00001+4                                      0952
         L     @06,FDTPTR+100(,@06)                                0952
         LTR   @06,@06                                             0952
         BZ    @RF00952                                            0952
*                NULLPSWD(1) = NULLMASK;                           0953
*                                                                  0953
         L     @06,LCPSWPT                                         0953
         MVC   NULLPSWD(8,@06),NULLMASK                            0953
*            /********************************************************/
*            /*                                                      */
*            /* NULLIFY THE CONTROL INTERVAL PASSWORD                */
*            /*                                                      */
*            /********************************************************/
*                                                                  0954
*            IF (ADDR(NCNTV)) ^= NULLPTR                           0954
*              THEN                                                0954
@RF00952 L     @06,@PC00001+4                                      0954
         L     @06,FDTPTR+104(,@06)                                0954
         LTR   @06,@06                                             0954
         BZ    @RF00954                                            0954
*                NULLPSWD(2) = NULLMASK;                           0955
*                                                                  0955
         L     @06,LCPSWPT                                         0955
         MVC   NULLPSWD+8(8,@06),NULLMASK                          0955
*            /********************************************************/
*            /*                                                      */
*            /* NULLIFY THE UPDATE PASSWORD                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0956
*            IF (ADDR(NUPDT)) ^= NULLPTR                           0956
*              THEN                                                0956
@RF00954 L     @06,@PC00001+4                                      0956
         L     @06,FDTPTR+108(,@06)                                0956
         LTR   @06,@06                                             0956
         BZ    @RF00956                                            0956
*                NULLPSWD(3) = NULLMASK;                           0957
*                                                                  0957
         L     @06,LCPSWPT                                         0957
         MVC   NULLPSWD+16(8,@06),NULLMASK                         0957
*            /********************************************************/
*            /*                                                      */
*            /* NULLIFY THE READ PASSWORD                            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0958
*            IF (ADDR(NREAD)) ^= NULLPTR                           0958
*              THEN                                                0958
@RF00956 L     @06,@PC00001+4                                      0958
         L     @06,FDTPTR+112(,@06)                                0958
         LTR   @06,@06                                             0958
         BZ    @RF00958                                            0958
*                NULLPSWD(4) = NULLMASK;                           0959
*                                                                  0959
         L     @06,LCPSWPT                                         0959
         MVC   NULLPSWD+24(8,@06),NULLMASK                         0959
*            END;                                                  0960
@RF00958 DS    0H                                                  0961
*        /************************************************************/
*        /*                                                          */
*        /* NULLIFY THE PASSWORD PROMPTING CODENAME                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0961
*        IF (ADDR(NCDNM)) ^= NULLPTR                               0961
*          THEN                                                    0961
@RF00949 L     @06,@PC00001+4                                      0961
         L     @06,FDTPTR+168(,@06)                                0961
         LTR   @06,@06                                             0961
         BZ    @RF00961                                            0961
*            DO;                                                   0962
*                                                                  0962
*            CTGFVSTY = ADDR(ALFPLPSW);                            0963
         L     @06,CTGPLPTR                                        0963
         L     @06,CTGFVT(,@06)                                    0963
         L     @01,ALPRMPTR                                        0963
         LA    @15,ALFPLPSW(,@01)                                  0963
         ST    @15,CTGFVSTY(,@06)                                  0963
*            LCPWPRMT = NULLMASK;                                  0964
*                                                                  0964
         L     @06,LCPSWPT                                         0964
         MVC   LCPWPRMT(8,@06),NULLMASK                            0964
*            END;                                                  0965
*                                                                  0965
*        /************************************************************/
*        /*                                                          */
*        /* NULLIFY THE PASSWORD AUTHORIZATION INFORMATION           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0966
*        IF (ADDR(NAUTH)) ^= NULLPTR                               0966
*          THEN                                                    0966
*                                                                  0966
@RF00961 SLR   @06,@06                                             0966
         L     @15,@PC00001+4                                      0966
         C     @06,FDTPTR+176(,@15)                                0966
         BE    @RF00966                                            0966
*            /********************************************************/
*            /*                                                      */
*            /* NULLIFY THE USER AUTHORIZATION MODULE NAME -         */
*            /* THE USER AUTHORIZATION RECORD IS ALSO NULLIFIED      */
*            /*                                                      */
*            /********************************************************/
*            IF(ADDR(NMDNM)) ^= NULLPTR                            0967
*              THEN                                                0967
         C     @06,FDTPTR+180(,@15)                                0967
         BE    @RF00967                                            0967
*                DO;                                               0968
*                                                                  0968
*                LCVRMDUL = NULLMASK;                              0969
         L     @15,LCPSWPT                                         0969
         MVC   LCVRMDUL(8,@15),NULLMASK                            0969
*                LCARECLN = 0;                                     0970
         STH   @06,LCARECLN(,@15)                                  0970
*                CTGFVSTY = ADDR(ALFPLPSW);                        0971
*                                                                  0971
         L     @06,CTGPLPTR                                        0971
         L     @06,CTGFVT(,@06)                                    0971
         L     @01,ALPRMPTR                                        0971
         LA    @15,ALFPLPSW(,@01)                                  0971
         ST    @15,CTGFVSTY(,@06)                                  0971
*                END;                                              0972
*                                                                  0972
*              /******************************************************/
*              /*                                                    */
*              /* NULLIFY THE USER AUTHORIZATION RECORD ONLY         */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0973
*                IF (ADDR(NSTRG)) ^= NULLPTR                       0973
*                  THEN                                            0973
         B     @RC00967                                            0973
@RF00967 SLR   @06,@06                                             0973
         L     @15,@PC00001+4                                      0973
         C     @06,FDTPTR+184(,@15)                                0973
         BE    @RF00973                                            0973
*                    DO;                                           0974
*                                                                  0974
*                    LCARECLN = 0;                                 0975
         L     @01,LCPSWPT                                         0975
         STH   @06,LCARECLN(,@01)                                  0975
*                    CTGFVSTY = ADDR(ALFPLPSW);                    0976
*                                                                  0976
         L     @06,CTGPLPTR                                        0976
         L     @06,CTGFVT(,@06)                                    0976
         L     @01,ALPRMPTR                                        0976
         LA    @15,ALFPLPSW(,@01)                                  0976
         ST    @15,CTGFVSTY(,@06)                                  0976
*                    END;                                          0977
*                                                                  0977
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE MASTER PASSWORD                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0978
*        IF (ADDR(MASTR)) ^= NULLPTR                               0978
*          THEN                                                    0978
@RF00973 DS    0H                                                  0978
@RC00967 DS    0H                                                  0978
@RF00966 L     @06,@PC00001+4                                      0978
         L     @06,FDTPTR+28(,@06)                                 0978
         LTR   @06,@06                                             0978
         BZ    @RF00978                                            0978
*            DO;                                                   0979
*                                                                  0979
*            LCMSTRPW = MASTRVAL;                                  0980
         L     @01,LCPSWPT                                         0980
         MVC   LCMSTRPW(8,@01),MASTRVAL(@06)                       0980
*            CTGFVSTY = ADDR(ALFPLPSW);                            0981
*                                                                  0981
         L     @06,CTGPLPTR                                        0981
         L     @06,CTGFVT(,@06)                                    0981
         L     @01,ALPRMPTR                                        0981
         LA    @15,ALFPLPSW(,@01)                                  0981
         ST    @15,CTGFVSTY(,@06)                                  0981
*            END;                                                  0982
*                                                                  0982
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE CONTROL INTERVAL PASSWORD                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0983
*        IF (ADDR(CNTVL)) ^= NULLPTR                               0983
*          THEN                                                    0983
@RF00978 L     @06,@PC00001+4                                      0983
         L     @06,FDTPTR+32(,@06)                                 0983
         LTR   @06,@06                                             0983
         BZ    @RF00983                                            0983
*            DO;                                                   0984
*                                                                  0984
*            LCCINTPW = CNTVLVAL;                                  0985
         L     @01,LCPSWPT                                         0985
         MVC   LCCINTPW(8,@01),CNTVLVAL(@06)                       0985
*            CTGFVSTY = ADDR(ALFPLPSW);                            0986
*                                                                  0986
         L     @06,CTGPLPTR                                        0986
         L     @06,CTGFVT(,@06)                                    0986
         L     @01,ALPRMPTR                                        0986
         LA    @15,ALFPLPSW(,@01)                                  0986
         ST    @15,CTGFVSTY(,@06)                                  0986
*            END;                                                  0987
*                                                                  0987
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE UPDATE PASSWORD                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0988
*        IF (ADDR(UPDAT)) ^= NULLPTR                               0988
*          THEN                                                    0988
@RF00983 L     @06,@PC00001+4                                      0988
         L     @06,FDTPTR+36(,@06)                                 0988
         LTR   @06,@06                                             0988
         BZ    @RF00988                                            0988
*            DO;                                                   0989
*                                                                  0989
*            LCUPDTPW = UPDATVAL;                                  0990
         L     @01,LCPSWPT                                         0990
         MVC   LCUPDTPW(8,@01),UPDATVAL(@06)                       0990
*            CTGFVSTY = ADDR(ALFPLPSW);                            0991
*                                                                  0991
         L     @06,CTGPLPTR                                        0991
         L     @06,CTGFVT(,@06)                                    0991
         L     @01,ALPRMPTR                                        0991
         LA    @15,ALFPLPSW(,@01)                                  0991
         ST    @15,CTGFVSTY(,@06)                                  0991
*            END;                                                  0992
*                                                                  0992
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE READ PASSWORD                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0993
*        IF (ADDR(READ)) ^= NULLPTR                                0993
*          THEN                                                    0993
@RF00988 L     @06,@PC00001+4                                      0993
         L     @06,FDTPTR+40(,@06)                                 0993
         LTR   @06,@06                                             0993
         BZ    @RF00993                                            0993
*            DO;                                                   0994
*                                                                  0994
*            LCREADPW = READVAL;                                   0995
         L     @01,LCPSWPT                                         0995
         MVC   LCREADPW(8,@01),READVAL(@06)                        0995
*            CTGFVSTY = ADDR(ALFPLPSW);                            0996
*                                                                  0996
         L     @06,CTGPLPTR                                        0996
         L     @06,CTGFVT(,@06)                                    0996
         L     @01,ALPRMPTR                                        0996
         LA    @15,ALFPLPSW(,@01)                                  0996
         ST    @15,CTGFVSTY(,@06)                                  0996
*            END;                                                  0997
*                                                                  0997
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE PASSWORD PROMPTING NAME                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0998
*        IF (ADDR(CODNM)) ^= NULLPTR                               0998
*          THEN                                                    0998
@RF00993 L     @06,@PC00001+4                                      0998
         L     @06,FDTPTR+44(,@06)                                 0998
         LTR   @06,@06                                             0998
         BZ    @RF00998                                            0998
*            DO;                                                   0999
*                                                                  0999
*            LCPWPRMT = CODNMVAL;                                  1000
         L     @01,LCPSWPT                                         1000
         MVC   LCPWPRMT(8,@01),CODNMVAL(@06)                       1000
*            CTGFVSTY = ADDR(ALFPLPSW);                            1001
*                                                                  1001
         L     @06,CTGPLPTR                                        1001
         L     @06,CTGFVT(,@06)                                    1001
         L     @01,ALPRMPTR                                        1001
         LA    @15,ALFPLPSW(,@01)                                  1001
         ST    @15,CTGFVSTY(,@06)                                  1001
*            END;                                                  1002
*                                                                  1002
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE PASSWORD PROMPTING ATTEMPTS                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1003
*        IF (ADDR(ATTP)) ^= NULLPTR                                1003
*          THEN                                                    1003
@RF00998 L     @06,@PC00001+4                                      1003
         L     @06,FDTPTR+48(,@06)                                 1003
         LTR   @06,@06                                             1003
         BZ    @RF01003                                            1003
*            DO;                                                   1004
*                                                                  1004
*            LCPWDATP = ATTPVAL;                                   1005
         L     @06,ATTPVAL(,@06)                                   1005
         L     @01,LCPSWPT                                         1005
         STH   @06,LCPWDATP(,@01)                                  1005
*            CTGFVSTY = ADDR(ALFPLPSW);                            1006
*                                                                  1006
         L     @06,CTGPLPTR                                        1006
         L     @06,CTGFVT(,@06)                                    1006
         L     @01,ALPRMPTR                                        1006
         LA    @15,ALFPLPSW(,@01)                                  1006
         ST    @15,CTGFVSTY(,@06)                                  1006
*            END;                                                  1007
*                                                                  1007
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE USER VERIFICATION MODULE NAME                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1008
*        IF (ADDR(USVR)) ^= NULLPTR                                1008
*          THEN                                                    1008
@RF01003 L     @06,@PC00001+4                                      1008
         L     @06,FDTPTR+56(,@06)                                 1008
         LTR   @06,@06                                             1008
         BZ    @RF01008                                            1008
*            DO;                                                   1009
*                                                                  1009
*            LCVRMDUL = USVRVAL;                                   1010
         L     @01,LCPSWPT                                         1010
         MVC   LCVRMDUL(8,@01),USVRVAL(@06)                        1010
*            CTGFVSTY = ADDR(ALFPLPSW);                            1011
*                                                                  1011
         L     @06,CTGPLPTR                                        1011
         L     @06,CTGFVT(,@06)                                    1011
         L     @01,ALPRMPTR                                        1011
         LA    @15,ALFPLPSW(,@01)                                  1011
         ST    @15,CTGFVSTY(,@06)                                  1011
*            END;                                                  1012
*                                                                  1012
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE USER AUTHORIZATION RECORD                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1013
*        IF (ADDR(USAR)) ^= NULLPTR                                1013
*          THEN                                                    1013
@RF01008 L     @06,@PC00001+4                                      1013
         L     @06,FDTPTR+60(,@06)                                 1013
         LTR   @06,@06                                             1013
         BZ    @RF01013                                            1013
*            DO;                                                   1014
*                                                                  1014
*            /********************************************************/
*            /*                                                      */
*            /* GET NEW PASSWALL AREA IF NEW AUTH RECORD IS          */
*            /* GREATER THAN THE OLD                                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  1015
*            IF USARLEN > LCARECLN                                 1015
*              THEN                                                1015
         SLR   @15,@15                                             1015
         IC    @15,USARLEN(,@06)                                   1015
         L     @06,LCPSWPT                                         1015
         CH    @15,LCARECLN(,@06)                                  1015
         BNH   @RF01015                                            1015
*                DO;                                               1016
*                                                                  1016
*                CALL IDCSAGP0(GDTTBL,                             1017
*                       (LENGTH(LCPSWFXD) + 255), /* GPOOL LENGTH    */
*                       NEWPSWPT,             /* ADDRESS OF PASSWALL */
*                       ALGPID,               /* GETPOOL ID          */
*                       SETZERO);             /* SET AREA TO ZERO    */
*                                                                  1017
         L     @06,@PC00001                                        1017
         ST    @06,@AL00001                                        1017
         LA    @15,307                                             1017
         ST    @15,@AFTEMPS                                        1017
         LA    @15,@AFTEMPS                                        1017
         ST    @15,@AL00001+4                                      1017
         LA    @15,NEWPSWPT                                        1017
         ST    @15,@AL00001+8                                      1017
         LA    @15,ALGPID                                          1017
         ST    @15,@AL00001+12                                     1017
         LA    @15,SETZERO                                         1017
         ST    @15,@AL00001+16                                     1017
         MVI   @AL00001+16,X'80'                                   1017
         L     @15,GDTGPL(,@06)                                    1017
         LA    @01,@AL00001                                        1017
         BALR  @14,@15                                             1017
*                RESPECIFY RTNREG RSTD;                            1018
*                TESTRC = RTNREG;                                  1019
         STH   RTNREG,TESTRC                                       1019
*                RESPECIFY RTNREG UNRSTD;                          1020
*                IF TESTRC ^= 0                                    1021
*                  THEN                                            1021
         LH    @06,TESTRC                                          1021
         LTR   @06,@06                                             1021
         BZ    @RF01021                                            1021
*                    DO;                                           1022
*                                                                  1022
*                    ALSTID = NOSTORAG;                            1023
         MVC   ALSTID(5),@CB01039                                  1023
*                    RETURN;                                       1024
*                                                                  1024
         B     @EL00003                                            1024
*                    END;                                          1025
*                                                                  1025
*                /****************************************************/
*                /*                                                  */
*                /* MOVE FIXED LENGTH PORTION TO NEW AREA            */
*                /*                                                  */
*                /****************************************************/
*                                                                  1026
*                NEWPSWPT -> LCPSWFXD = LCPSWFXD;                  1026
@RF01021 L     @06,NEWPSWPT                                        1026
         L     @01,LCPSWPT                                         1026
         MVC   LCPSWFXD(52,@06),LCPSWFXD(@01)                      1026
*                LCPSWPT = NEWPSWPT;                               1027
*                                                                  1027
         ST    @06,LCPSWPT                                         1027
*                END;                                              1028
*                                                                  1028
*            /********************************************************/
*            /*                                                      */
*            /* MOVE AUTHORIZATION RECORD TO PASSWALL FIELD          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1029
*            LCARECLN = USARLEN;                                   1029
@RF01015 L     @06,LCPSWPT                                         1029
         L     @15,@PC00001+4                                      1029
         L     @15,FDTPTR+60(,@15)                                 1029
         SLR   @14,@14                                             1029
         IC    @14,USARLEN(,@15)                                   1029
         STH   @14,LCARECLN(,@06)                                  1029
*            LCUAREC(1:LCARECLN) = USARVAL(1:LCARECLN);            1030
         BCTR  @14,0                                               1030
         EX    @14,@SM01709                                        1030
*            CTGFVSTY = ADDR(ALFPLPSW);                            1031
*                                                                  1031
         L     @06,CTGPLPTR                                        1031
         L     @06,CTGFVT(,@06)                                    1031
         L     @01,ALPRMPTR                                        1031
         LA    @15,ALFPLPSW(,@01)                                  1031
         ST    @15,CTGFVSTY(,@06)                                  1031
*            END;                                                  1032
*                                                                  1032
*                                                                  1032
*        /************************************************************/
*        /*                                                          */
*        /* BUILD THE PASSWALL FPL IF CHANGES HAVE BEEN MADE -       */
*        /* THE INITIALIZATION OF CTGFVSTY INDICATES CHANGE          */
*        /* AND MIGRATE 1ST NON-NULL PASSWORD IF THE MASTER HAS      */
*        /* BEEN NULLIFIED                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1033
*        IF CTGFVSTY ^= NULLPTR                                    1033
*          THEN                                                    1033
@RF01013 SLR   @06,@06                                             1033
         L     @01,CTGPLPTR                                        1033
         L     @01,CTGFVT(,@01)                                    1033
         C     @06,CTGFVSTY(,@01)                                  1033
         BE    @RF01033                                            1033
*            DO;                                                   1034
*                                                                  1034
*            /********************************************************/
*            /*                                                      */
*            /* IF THE MASTER HAS BEEN NULLIFIED AND THERE ARE       */
*            /* VALID PASSWORDS SPECIFIED - WE MUST MIGRATE THE      */
*            /* THE FIRST NON-NULL PASSWORD VALUE IN THE HIERAR-     */
*            /* CHY UP TO THE MASTER LEVEL AND THRU THE INTER-       */
*            /* VENING LEVELS                                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  1035
*            MIGRLOOP = 0;                                         1035
         STH   @06,MIGRLOOP                                        1035
*            MIGRFLAG = GO;                                        1036
*                                                                  1036
         MVI   MIGRFLAG,X'00'                                      1036
*            IF LCMSTRPW = NULLMASK                                1037
*              THEN                                                1037
         L     @06,LCPSWPT                                         1037
         CLC   LCMSTRPW(8,@06),NULLMASK                            1037
         BNE   @RF01037                                            1037
*                DO N = 2 TO 4                                     1038
*                WHILE MIGRFLAG = GO;                              1038
*                                                                  1038
         LA    @06,2                                               1038
         ST    @06,N                                               1038
@DL01038 CLI   MIGRFLAG,X'00'                                      1038
         BNE   @DC01038                                            1038
*                  IF NULLPSWD(N) ^= NULLMASK                      1039
*                    THEN                                          1039
         LR    @15,@06                                             1039
         SLA   @15,3                                               1039
         L     @01,LCPSWPT                                         1039
         ALR   @01,@15                                             1039
         AL    @01,@CF01711                                        1039
         CLC   NULLPSWD(8,@01),NULLMASK                            1039
         BE    @RF01039                                            1039
*                      DO;                                         1040
*                                                                  1040
*                      MIGRFLAG = STOP;                            1041
         MVI   MIGRFLAG,X'0F'                                      1041
*                      MIGRLOOP = N;                               1042
*                                                                  1042
         STH   @06,MIGRLOOP                                        1042
*                      END;                                        1043
*                                                                  1043
*                END;                                              1044
*                                                                  1044
@RF01039 LA    @06,1                                               1044
         AL    @06,N                                               1044
         ST    @06,N                                               1044
         C     @06,@CF00044                                        1044
         BNH   @DL01038                                            1044
@DC01038 DS    0H                                                  1045
*            /********************************************************/
*            /*                                                      */
*            /* IF THE ABOVE LOOP HAS DETECTED A NEED FOR            */
*            /* MIGRATION - PERFORM THE MIGRATION USING THE          */
*            /* VALUES FROM THAT LOOP                                */
*            /*                                                      */
*            /********************************************************/
*            IF MIGRLOOP ^= 0                                      1045
*              THEN                                                1045
@RF01037 LH    @06,MIGRLOOP                                        1045
         LTR   @06,@06                                             1045
         BZ    @RF01045                                            1045
*                DO N = MIGRLOOP TO 2 BY -1;                       1046
*                                                                  1046
         ST    @06,N                                               1046
         B     @DE01046                                            1046
@DL01046 DS    0H                                                  1047
*                  NULLPSWD(N-1) = NULLPSWD(N);                    1047
*                                                                  1047
         L     @15,LCPSWPT                                         1047
         LR    @14,@06                                             1047
         SLA   @14,3                                               1047
         ST    @14,@TF00001                                        1047
         ALR   @14,@15                                             1047
         AL    @14,@CF01712                                        1047
         AL    @15,@TF00001                                        1047
         AL    @15,@CF01711                                        1047
         MVC   NULLPSWD(8,@14),NULLPSWD(@15)                       1047
*                END;                                              1048
*                                                                  1048
         BCTR  @06,0                                               1048
         ST    @06,N                                               1048
@DE01046 C     @06,@CF00155                                        1048
         BNL   @DL01046                                            1048
*            /********************************************************/
*            /*                                                      */
*            /* ALTERATIONS HAVE OCCURRED - NOW IF THEIR NATURE HAS  */
*            /* BEEN TO NULLIFY THE 4 PASSWORD LEVELS - THE ENTIRE   */
*            /* PASSWALL OCCURRENCE IS NULLIFIED AND PASSED IN THIS  */
*            /* FORM TO VSAM CATALOG MANAGEMENT                      */
*            /*                                                      */
*            /********************************************************/
*                                                                  1049
*            IF NULLPSWD(1) = NULLMASK                             1049
*              THEN                                                1049
@RF01045 L     @06,LCPSWPT                                         1049
         CLC   NULLPSWD(8,@06),NULLMASK                            1049
         BNE   @RF01049                                            1049
*                DO;                                               1050
*                                                                  1050
*                CTGFLPTR = ADDR(ALFPLPSW);                        1051
         L     @15,ALPRMPTR                                        1051
         LA    @14,ALFPLPSW(,@15)                                  1051
         ST    @14,CTGFLPTR                                        1051
*                CTGFLNG(1) = LENGTH(LCPSWFXD);                    1052
         MVC   CTGFLNG(4,@14),@CF00728                             1052
*                CTGFLPT(1) = LCPSWPT;                             1053
         ST    @06,CTGFLPT(,@14)                                   1053
*                ALPSW = 'PSWD';                                   1054
         MVC   ALPSW(4,@15),@CC01448                               1054
*                LCPWPRMT = NULLMASK;                              1055
         MVC   LCPWPRMT(8,@06),NULLMASK                            1055
*                LCPWDATP = 0;                                     1056
         SLR   @15,@15                                             1056
         STH   @15,LCPWDATP(,@06)                                  1056
*                LCVRMDUL = NULLMASK;                              1057
         MVC   LCVRMDUL(8,@06),NULLMASK                            1057
*                LCARECLN = 0;                                     1058
*                                                                  1058
         STH   @15,LCARECLN(,@06)                                  1058
*                END;                                              1059
*                                                                  1059
*              /******************************************************/
*              /*                                                    */
*              /* WE HAVE A VALID PASSWALL OCCURRENCE DONT NULLIFY   */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                1060
*                DO;                                               1060
*                                                                  1060
         B     @RC01049                                            1060
@RF01049 DS    0H                                                  1061
*                CTGFLPTR = ADDR(ALFPLPSW);                        1061
         L     @06,ALPRMPTR                                        1061
         LA    @15,ALFPLPSW(,@06)                                  1061
         ST    @15,CTGFLPTR                                        1061
*                ALPSW = 'PSWD';                                   1062
         MVC   ALPSW(4,@06),@CC01448                               1062
*                CTGFLNG(1) = (LENGTH(LCPSWFXD) + LCARECLN);       1063
         L     @06,LCPSWPT                                         1063
         LA    @14,52                                              1063
         AH    @14,LCARECLN(,@06)                                  1063
         ST    @14,CTGFLNG(,@15)                                   1063
*                CTGFLPT(1) = LCPSWPT;                             1064
*                                                                  1064
         ST    @06,CTGFLPT(,@15)                                   1064
*                END;                                              1065
*                                                                  1065
*            CTGFLPTR = ADDR(ALFPLPSW);                            1066
@RC01049 L     @06,ALPRMPTR                                        1066
         LA    @15,ALFPLPSW(,@06)                                  1066
         ST    @15,CTGFLPTR                                        1066
*            ALPSW = 'PSWD';                                       1067
         MVC   ALPSW(4,@06),@CC01448                               1067
*            CTGFLNG(1) = (LENGTH(LCPSWFXD)) + LCARECLN;           1068
         L     @06,LCPSWPT                                         1068
         LA    @14,52                                              1068
         AH    @14,LCARECLN(,@06)                                  1068
         ST    @14,CTGFLNG(,@15)                                   1068
*            CTGFLPT(1) = LCPSWPT;                                 1069
*                                                                  1069
         ST    @06,CTGFLPT(,@15)                                   1069
*            END;                                                  1070
*                                                                  1070
*        /************************************************************/
*        /*                                                          */
*        /* NULLIFY THE DATA SET EXPIRATION DATE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1071
*        IF (ADDR(NRETN)) ^= NULLPTR                               1071
*          THEN                                                    1071
@RF01033 L     @06,@PC00001+4                                      1071
         L     @06,FDTPTR+172(,@06)                                1071
         LTR   @06,@06                                             1071
         BZ    @RF01071                                            1071
*            DO;                                                   1072
*                                                                  1072
*            CTGFVEXP = ADDR(ALFPLEXP);                            1073
         L     @06,CTGPLPTR                                        1073
         L     @06,CTGFVT(,@06)                                    1073
         L     @01,ALPRMPTR                                        1073
         LA    @15,ALFPLEXP(,@01)                                  1073
         ST    @15,CTGFVEXP(,@06)                                  1073
*            EXPIRE = '00000F'X;                                   1074
*                                                                  1074
         MVC   EXPIRE(3),@CB01495                                  1074
*            END;                                                  1075
*                                                                  1075
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE DATA SET EXPIRATION DATE                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1076
*        IF (ADDR(TO)) ^= NULLPTR                                  1076
*          THEN                                                    1076
@RF01071 L     @06,@PC00001+4                                      1076
         L     @06,FDTPTR+68(,@06)                                 1076
         LTR   @06,@06                                             1076
         BZ    @RF01076                                            1076
*            DO;                                                   1077
*                                                                  1077
*            RFY (REG5,REG6) RESTRICTED;                           1078
*            REG6 = TOVAL;                                         1079
         ST    @06,@TF00001                                        1079
         L     @04,@TF00001                                        1079
         L     REG6,TOVAL(,@04)                                    1079
*            REG5 = ADDR(EXPIREDT);                                1080
*                                                                  1080
         LA    REG5,EXPIREDT                                       1080
*            GENERATE(CVD REG6,0(0,REG5));                         1081
*                                                                  1081
         CVD REG6,0(0,REG5)
*            RFY (REG5,REG6) UNRESTRICTED;                         1082
*            CTGFVEXP = ADDR(ALFPLEXP);                            1083
*                                                                  1083
         L     @06,CTGPLPTR                                        1083
         L     @06,CTGFVT(,@06)                                    1083
         L     @01,ALPRMPTR                                        1083
         LA    @15,ALFPLEXP(,@01)                                  1083
         ST    @15,CTGFVEXP(,@06)                                  1083
*            END;                                                  1084
*                                                                  1084
*          /**********************************************************/
*          /*                                                        */
*          /* COMPUTE THE EXPIRATION DATE VIA THE USER SUPPLIED INCR-*/
*          /* EMENT - THIS VALUE IS ADDED TO THE CURRENT DATE AS     */
*          /* SUPPLIED BY THE UTIME MACRO. THEYRDYLOOP ADJUSTS FOR   */
*          /* BOTH LEAP AND NONLEAP YEARS                            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1085
*          ELSE                                                    1085
*            IF (ADDR(FOR)) ^= NULLPTR                             1085
*              THEN                                                1085
         B     @RC01076                                            1085
@RF01076 L     @06,@PC00001+4                                      1085
         L     @06,FDTPTR+72(,@06)                                 1085
         LTR   @06,@06                                             1085
         BZ    @RF01085                                            1085
*FORLOOP:        DO;                                               1086
*                                                                  1086
FORLOOP  DS    0H                                                  1087
*                CTGFVEXP = ADDR(ALFPLEXP);                        1087
*                                                                  1087
         L     @06,CTGPLPTR                                        1087
         L     @06,CTGFVT(,@06)                                    1087
         L     @01,ALPRMPTR                                        1087
         LA    @15,ALFPLEXP(,@01)                                  1087
         ST    @15,CTGFVEXP(,@06)                                  1087
*                /****************************************************/
*                /*                                                  */
*                /* WHEN THE INCREMENT IS GREATER THAN FIVE YEARS    */
*                /* FROM THE CURRENT DATE THE MAXIMUM EXPIRATION     */
*                /* DATE IS USED                                     */
*                /*                                                  */
*                /****************************************************/
*                                                                  1088
*                IF FORVAL >= MAXEXPDT                             1088
*                  THEN                                            1088
         L     @06,@PC00001+4                                      1088
         L     @06,FDTPTR+72(,@06)                                 1088
         L     @06,FORVAL(,@06)                                    1088
         C     @06,@CF01115                                        1088
         BL    @RF01088                                            1088
*                    EXPIRE = '99999F'X;                           1089
*                                                                  1089
         MVC   EXPIRE(3),@CB01498                                  1089
*                  /**************************************************/
*                  /*                                                */
*                  /* THE INCREMENT IS NOT WITHIN THE MAXIMUM RANGE  */
*                  /* COMPUTE THE ACTUAL DATE                        */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1090
*                  ELSE                                            1090
*DAYFORLP:           DO;                                           1090
*                                                                  1090
         B     @RC01088                                            1090
@RF01088 DS    0H                                                  1090
DAYFORLP DS    0H                                                  1091
*                    DATELOOP = GO;                                1091
*                                                                  1091
         MVI   DATELOOP,X'00'                                      1091
*                    /************************************************/
*                    /*                                              */
*                    /* INVOKE UTIME MACRO TO GET CURRENT DATE       */
*                    /*                                              */
*                    /************************************************/
*                                                                  1092
*                    CALL IDCSATI0 (GDTTBL,TIMEODAY,XCURDATE);     1092
*                                                                  1092
         L     @06,@PC00001                                        1092
         ST    @06,@AL00001                                        1092
         LA    @15,TIMEODAY                                        1092
         ST    @15,@AL00001+4                                      1092
         LA    @15,XCURDATE                                        1092
         ST    @15,@AL00001+8                                      1092
         MVI   @AL00001+8,X'80'                                    1092
         L     @15,GDTTIM(,@06)                                    1092
         LA    @01,@AL00001                                        1092
         BALR  @14,@15                                             1092
*                    RFY (REG5,REG6) RESTRICTED;           /*@Y30SSJH*/
*                    DAYTOTL = ''B;                                1094
         XC    DAYTOTL(8),DAYTOTL                                  1094
*                    DAYTOTAL = XUTDAY;                            1095
         LH    @04,XUTDAY                                          1095
         STH   @04,DAYTOTAL                                        1095
*                    GEN(CVB  5,DAYTOTL);                          1096
         CVB  5,DAYTOTL
*                    REG5 = REG5 + FORVAL;                         1097
         L     @04,@PC00001+4                                      1097
         L     @04,FDTPTR+72(,@04)                                 1097
         AL    REG5,FORVAL(,@04)                                   1097
*                    NOWYEAR = XUTYEAR;                            1098
*                                                                  1098
         SLR   @04,@04                                             1098
         IC    @04,XUTYEAR                                         1098
         STH   @04,NOWYEAR                                         1098
*                    /************************************************/
*                    /*                                              */
*                    /* LOOP THRU THE DAYTOTALS 1 YEAR AT A TIME -   */
*                    /* BUMPING THE YEAR AS WE GO                    */
*                    /*                                              */
*                    /************************************************/
*                                                                  1099
*YRDYLOOP:           DO N = 1 TO 6                                 1099
*                       WHILE DATELOOP = GO;                       1099
*                                                                  1099
YRDYLOOP LA    @04,1                                               1099
         ST    @04,N                                               1099
@DL01099 CLI   DATELOOP,X'00'                                      1099
         BNE   @DC01099                                            1099
*                      IF  (NOWYEAR  // 4) = 0                     1100
*                        THEN                                      1100
         LH    @00,NOWYEAR                                         1100
         SRDA  @00,32                                              1100
         D     @00,@CF00044                                        1100
         LTR   @00,@00                                             1100
         BNZ   @RF01100                                            1100
*                          DAYPERYR = NOLEAPYR;                    1101
*                                                                  1101
         MVC   DAYPERYR(2),@CH01113                                1101
*                        ELSE                                      1102
*                          DAYPERYR = NOLEAPYR;                    1102
*                                                                  1102
         B     @RC01100                                            1102
@RF01100 MVC   DAYPERYR(2),@CH01113                                1102
*                      IF (REG5 - DAYPERYR) > 0                    1103
*                        THEN                                      1103
@RC01100 LH    @04,DAYPERYR                                        1103
         LR    @15,REG5                                            1103
         SLR   @15,@04                                             1103
         LTR   @15,@15                                             1103
         BNP   @RF01103                                            1103
*                          DO;                                     1104
*                                                                  1104
*                          REG5 = REG5 - DAYPERYR;                 1105
         SLR   REG5,@04                                            1105
*                          NOWYEAR = NOWYEAR + 1;                  1106
*                                                                  1106
         LH    @04,NOWYEAR                                         1106
         LA    @04,1(,@04)                                         1106
         STH   @04,NOWYEAR                                         1106
*                          END;                                    1107
*                                                                  1107
*                        ELSE                                      1108
*                          DATELOOP = STOP;                        1108
*                                                                  1108
         B     @RC01103                                            1108
@RF01103 MVI   DATELOOP,X'0F'                                      1108
*                    END YRDYLOOP;                                 1109
*                                                                  1109
@RC01103 LA    @04,1                                               1109
         AL    @04,N                                               1109
         ST    @04,N                                               1109
         C     @04,@CF00158                                        1109
         BNH   @DL01099                                            1109
@DC01099 DS    0H                                                  1110
*                    EXPIRYR = NOWYEAR;                            1110
         LH    @04,NOWYEAR                                         1110
         STC   @04,EXPIRYR                                         1110
*                    GEN(CVD 5,DAYTOTL);                           1111
         CVD 5,DAYTOTL
*                    EXPIRDAY = DAYTOTAL;                          1112
         LH    @04,DAYTOTAL                                        1112
         STH   @04,EXPIRDAY                                        1112
*                    RFY (REG5,REG6) UNRESTRICTED;                 1113
*                                                                  1113
*                    END DAYFORLP;                                 1114
*                                                                  1114
*                END FORLOOP;                                      1115
*                                                                  1115
@RC01088 DS    0H                                                  1116
*        /************************************************************/
*        /*                                                          */
*        /* A NEW EXPIRATION DATE HAS BEEN COMPUTED BUILD THE FPL    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1116
*        IF CTGFVEXP ^= NULLPTR                                    1116
*          THEN                                                    1116
@RF01085 DS    0H                                                  1116
@RC01076 L     @06,CTGPLPTR                                        1116
         L     @06,CTGFVT(,@06)                                    1116
         L     @06,CTGFVEXP(,@06)                                  1116
         LTR   @06,@06                                             1116
         BZ    @RF01116                                            1116
*            DO;                                                   1117
*                                                                  1117
*            CTGFLPTR = CTGFVEXP;                                  1118
         ST    @06,CTGFLPTR                                        1118
*            CTGFLNG(1) = 3;                                       1119
         MVC   CTGFLNG(4,@06),@CF00164                             1119
*            CTGFLPT(1) = ADDR(EXPIRE);                            1120
*                                                                  1120
         LA    @15,EXPIRE                                          1120
         ST    @15,CTGFLPT(,@06)                                   1120
*            END;                                                  1121
*                                                                  1121
*        /************************************************************/
*        /*                                                          */
*        /* ALTER OR NULLIFY THE OWNER ID                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1122
*        IF (ADDR(OWNER)) ^= NULLPTR   ×                           1122
*           (ADDR(NOWNR)) ^= NULLPTR                               1122
*          THEN                                                    1122
@RF01116 SLR   @06,@06                                             1122
         L     @15,@PC00001+4                                      1122
         C     @06,FDTPTR+76(,@15)                                 1122
         BNE   @RT01122                                            1122
         C     @06,FDTPTR+164(,@15)                                1122
         BE    @RF01122                                            1122
@RT01122 DS    0H                                                  1123
*            DO;                                                   1123
*                                                                  1123
*            CTGFLPTR = ADDR(ALFPLOWN);                            1124
         L     @06,ALPRMPTR                                        1124
         LA    @15,ALFPLOWN(,@06)                                  1124
         ST    @15,CTGFLPTR                                        1124
*            ALOWN = 'OWNR';                                       1125
         MVC   ALOWN(4,@06),@CC01503                               1125
*            CTGFLNG(1) = 8;                                       1126
         MVC   CTGFLNG(4,@15),@CF00039                             1126
*            CTGFVOWN = CTGFLPTR;                                  1127
*                                                                  1127
         L     @06,CTGPLPTR                                        1127
         L     @06,CTGFVT(,@06)                                    1127
         ST    @15,CTGFVOWN(,@06)                                  1127
*            /********************************************************/
*            /*                                                      */
*            /* SET FPL POINTER TO NULLVALUE OR NEW OWNER ID         */
*            /*                                                      */
*            /********************************************************/
*                                                                  1128
*            IF (ADDR(NOWNR)) ^= NULLPTR                           1128
*              THEN                                                1128
         L     @06,@PC00001+4                                      1128
         L     @06,FDTPTR+164(,@06)                                1128
         LTR   @06,@06                                             1128
         BZ    @RF01128                                            1128
*                CTGFLPT(1) = ADDR(NULLMASK);                      1129
*                                                                  1129
         LA    @06,NULLMASK                                        1129
         ST    @06,CTGFLPT(,@15)                                   1129
*            IF (ADDR(OWNER)) ^= NULLPTR                           1130
*              THEN                                                1130
@RF01128 L     @06,@PC00001+4                                      1130
         L     @06,FDTPTR+76(,@06)                                 1130
         LTR   @06,@06                                             1130
         BZ    @RF01130                                            1130
*                CTGFLPT(1) = ADDR(OWNERVAL);                      1131
*                                                                  1131
         LA    @06,OWNERVAL(,@06)                                  1131
         L     @01,CTGFLPTR                                        1131
         ST    @06,CTGFLPT(,@01)                                   1131
*            END;                                                  1132
*                                                                  1132
@RF01130 DS    0H                                                  1133
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ALTER OR NULLIFY THE EXCEPTIONEXIT NAME          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1133
*        IF (ADDR(EEXT))  ^= NULLPTR ×                             1133
*           (ADDR(NEEXT)) ^= NULLPTR                               1133
*          THEN                                                    1133
@RF01122 SLR   @06,@06                                             1133
         L     @15,@PC00001+4                                      1133
         C     @06,FDTPTR+216(,@15)                                1133
         BNE   @RT01133                                            1133
         C     @06,FDTPTR+268(,@15)                                1133
         BE    @RF01133                                            1133
@RT01133 DS    0H                                                  1134
*            DO;                                           /*@Y30SSJH*/
*                                                                  1134
*            CTGFLPTR = ADDR(ALFPLEEX);                    /*@Y30SSJH*/
         L     @06,ALPRMPTR                                        1135
         LA    @15,ALFPLEEX(,@06)                                  1135
         ST    @15,CTGFLPTR                                        1135
*            ALEEX = 'EEXT';                               /*@Y30SSJH*/
         MVC   ALEEX(4,@06),@CC01504                               1136
*            CTGFLNG(1) = 8;                               /*@Y30SSJH*/
         MVC   CTGFLNG(4,@15),@CF00039                             1137
*            CTGFVEXT = CTGFLPTR;                          /*@Y30SSJH*/
*                                                                  1138
         L     @06,CTGPLPTR                                        1138
         L     @06,CTGFVT(,@06)                                    1138
         ST    @15,CTGFVEXT(,@06)                                  1138
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* SET FPL POINTER TO NULL VALUE OR NEW         @Y30SSJH*/
*            /* EXCEPTIONEXIT NAME                           @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1139
*            IF (ADDR(NEEXT)) ^= NULLPTR                           1139
*              THEN                                                1139
         L     @06,@PC00001+4                                      1139
         L     @06,FDTPTR+268(,@06)                                1139
         LTR   @06,@06                                             1139
         BZ    @RF01139                                            1139
*                CTGFLPT(1) = ADDR(NULLMASK);              /*@Y30SSJH*/
*                                                                  1140
         LA    @06,NULLMASK                                        1140
         ST    @06,CTGFLPT(,@15)                                   1140
*            IF (ADDR(EEXT)) ^= NULLPTR                            1141
*              THEN                                                1141
@RF01139 L     @06,@PC00001+4                                      1141
         L     @06,FDTPTR+216(,@06)                                1141
         LTR   @06,@06                                             1141
         BZ    @RF01141                                            1141
*                CTGFLPT(1) = ADDR(EEXTVAL);               /*@Y30SSJH*/
*                                                                  1142
         LA    @06,EEXTVAL(,@06)                                   1142
         L     @01,CTGFLPTR                                        1142
         ST    @06,CTGFLPT(,@01)                                   1142
*            END;                                          /*@Y30SSJH*/
@RF01141 DS    0H                                                  1144
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE DATA SET ATTRIBUTES                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1144
*        IF LCDATRPT ^= NULLPTR                                    1144
*          THEN                                                    1144
@RF01133 L     @06,LCDATRPT                                        1144
         SLR   @15,@15                                             1144
         CR    @06,@15                                             1144
         BE    @RF01144                                            1144
*            DO;                                                   1145
*                                                                  1145
*            IF (ADDR(ERASE)) ^= NULLPTR    /* ERASE OPTION          */
*              THEN                                                1146
         L     @14,@PC00001+4                                      1146
         C     @15,FDTPTR+80(,@14)                                 1146
         BE    @RF01146                                            1146
*                DO;                                               1147
*                                                                  1147
*                CTGFVATR = ADDR(ALFPLDAT);                        1148
         L     @01,CTGPLPTR                                        1148
         L     @01,CTGFVT(,@01)                                    1148
         L     @15,ALPRMPTR                                        1148
         LA    @00,ALFPLDAT(,@15)                                  1148
         ST    @00,CTGFVATR(,@01)                                  1148
*                LCERASE = ON;                                     1149
*                                                                  1149
         OI    LCERASE(@06),B'00010000'                            1149
*                END;                                              1150
*                                                                  1150
*              ELSE                                                1151
*                IF (ADDR(NERAS)) ^= NULLPTR /* NOREASE OPTION       */
*                  THEN                                            1151
         B     @RC01146                                            1151
@RF01146 L     @06,@PC00001+4                                      1151
         L     @06,FDTPTR+84(,@06)                                 1151
         LTR   @06,@06                                             1151
         BZ    @RF01151                                            1151
*                    DO;                                           1152
*                                                                  1152
*                    CTGFVATR = ADDR(ALFPLDAT);                    1153
         L     @06,CTGPLPTR                                        1153
         L     @06,CTGFVT(,@06)                                    1153
         L     @01,ALPRMPTR                                        1153
         LA    @15,ALFPLDAT(,@01)                                  1153
         ST    @15,CTGFVATR(,@06)                                  1153
*                    LCERASE = OFF;                                1154
*                                                                  1154
         L     @06,LCDATRPT                                        1154
         NI    LCERASE(@06),B'11101111'                            1154
*                    END;                                          1155
*                                                                  1155
*            /********************************************************/
*            /*                                                      */
*            /* ALTER THE SHARE OPTIONS                              */
*            /*                                                      */
*            /********************************************************/
*            IF (ADDR(SHAR1)) ^= NULLPTR                           1156
*              THEN                                                1156
@RF01151 DS    0H                                                  1156
@RC01146 L     @06,@PC00001+4                                      1156
         L     @06,FDTPTR+188(,@06)                                1156
         LTR   @06,@06                                             1156
         BZ    @RF01156                                            1156
*ALTSHARE:       DO;                                               1157
*                                                                  1157
ALTSHARE DS    0H                                                  1158
*                CTGFVATR = ADDR(ALFPLDAT);                        1158
*                                                                  1158
         L     @06,CTGPLPTR                                        1158
         L     @06,CTGFVT(,@06)                                    1158
         L     @01,ALPRMPTR                                        1158
         LA    @15,ALFPLDAT(,@01)                                  1158
         ST    @15,CTGFVATR(,@06)                                  1158
*                /****************************************************/
*                /*                                                  */
*                /* ALTER CROSS REGION SHARE OPTIONS                 */
*                /*                                                  */
*                /****************************************************/
*                IF SHAR1VAL = 1                                   1159
*                  THEN                                            1159
         L     @06,@PC00001+4                                      1159
         L     @06,FDTPTR+188(,@06)                                1159
         CLC   SHAR1VAL(4,@06),@CF00220                            1159
         BNE   @RF01159                                            1159
*                    SHAROPT1 = SHROPT1;                           1160
*                                                                  1160
         L     @06,LCDATRPT                                        1160
         NI    SHAROPT1(@06),B'00111111'                           1160
*                  ELSE                                            1161
*                    IF SHAR1VAL = 2                               1161
*                      THEN                                        1161
         B     @RC01159                                            1161
@RF01159 L     @06,@PC00001+4                                      1161
         L     @06,FDTPTR+188(,@06)                                1161
         CLC   SHAR1VAL(4,@06),@CF00155                            1161
         BNE   @RF01161                                            1161
*                        SHAROPT1 = SHROPT2;                       1162
*                                                                  1162
         L     @06,LCDATRPT                                        1162
         NI    SHAROPT1(@06),B'01111111'                           1162
         OI    SHAROPT1(@06),B'01000000'                           1162
*                      ELSE                                        1163
*                        IF SHAR1VAL = 3                           1163
*                          THEN                                    1163
         B     @RC01161                                            1163
@RF01161 L     @06,@PC00001+4                                      1163
         L     @06,FDTPTR+188(,@06)                                1163
         CLC   SHAR1VAL(4,@06),@CF00164                            1163
         BNE   @RF01163                                            1163
*                            SHAROPT1 = SHROPT3;                   1164
*                                                                  1164
         L     @06,LCDATRPT                                        1164
         NI    SHAROPT1(@06),B'10111111'                           1164
         OI    SHAROPT1(@06),B'10000000'                           1164
*                          ELSE                                    1165
*                            IF SHAR1VAL = 4                       1165
*                            THEN                                  1165
         B     @RC01163                                            1165
@RF01163 L     @06,@PC00001+4                                      1165
         L     @06,FDTPTR+188(,@06)                                1165
         CLC   SHAR1VAL(4,@06),@CF00044                            1165
         BNE   @RF01165                                            1165
*                            SHAROPT1 = SHROPT4;                   1166
*                                                                  1166
         L     @06,LCDATRPT                                        1166
         OI    SHAROPT1(@06),B'11000000'                           1166
*                            ELSE;                                 1167
*                                                                  1167
@RF01165 DS    0H                                                  1168
*                /****************************************************/
*                /*                                                  */
*                /* ALTER THE CROSS SYSTEM SHARE OPTIONS             */
*                /*                                                  */
*                /****************************************************/
*                IF (ADDR(SHAR2)) ^= NULLPTR                       1168
*                  THEN                                            1168
@RC01163 DS    0H                                                  1168
@RC01161 DS    0H                                                  1168
@RC01159 L     @06,@PC00001+4                                      1168
         L     @06,FDTPTR+192(,@06)                                1168
         LTR   @06,@06                                             1168
         BZ    @RF01168                                            1168
*                    DO;                                           1169
*                                                                  1169
*                    IF SHAR2VAL = 3                               1170
*                      THEN                                        1170
         CLC   SHAR2VAL(4,@06),@CF00164                            1170
         BNE   @RF01170                                            1170
*                        SHAROPT2 = SHROPT3;                       1171
*                                                                  1171
         L     @06,LCDATRPT                                        1171
         NI    SHAROPT2(@06),B'11101111'                           1171
         OI    SHAROPT2(@06),B'00100000'                           1171
*                      ELSE                                        1172
*                        IF SHAR2VAL = 4                           1172
*                          THEN                                    1172
         B     @RC01170                                            1172
@RF01170 L     @06,@PC00001+4                                      1172
         L     @06,FDTPTR+192(,@06)                                1172
         CLC   SHAR2VAL(4,@06),@CF00044                            1172
         BNE   @RF01172                                            1172
*                            SHAROPT2 = SHROPT4;                   1173
*                                                                  1173
         L     @06,LCDATRPT                                        1173
         OI    SHAROPT2(@06),B'00110000'                           1173
*                          ELSE;                                   1174
*                                                                  1174
@RF01172 DS    0H                                                  1175
*                    END;                                          1175
*                                                                  1175
@RC01170 DS    0H                                                  1176
*                END ALTSHARE;                                     1176
*                                                                  1176
@RF01168 DS    0H                                                  1177
*            IF (ADDR(UNHIB)) ^= NULLPTR                           1177
*              THEN                                                1177
@RF01156 L     @06,@PC00001+4                                      1177
         L     @06,FDTPTR+160(,@06)                                1177
         LTR   @06,@06                                             1177
         BZ    @RF01177                                            1177
*                DO;                                               1178
*                                                                  1178
*                CTGFVATR = ADDR(ALFPLDAT);                        1179
         L     @06,CTGPLPTR                                        1179
         L     @06,CTGFVT(,@06)                                    1179
         L     @01,ALPRMPTR                                        1179
         LA    @15,ALFPLDAT(,@01)                                  1179
         ST    @15,CTGFVATR(,@06)                                  1179
*                LCINHIB = OFF;                                    1180
*                                                                  1180
         L     @06,LCDATRPT                                        1180
         NI    LCINHIB(@06),B'11111011'                            1180
*                END;                                              1181
*                                                                  1181
*              ELSE                                                1182
*                IF (ADDR(INHIB)) ^= NULLPTR                       1182
*                  THEN                                            1182
         B     @RC01177                                            1182
@RF01177 L     @06,@PC00001+4                                      1182
         L     @06,FDTPTR+156(,@06)                                1182
         LTR   @06,@06                                             1182
         BZ    @RF01182                                            1182
*                    DO;                                           1183
*                                                                  1183
*                    CTGFVATR = ADDR(ALFPLDAT);                    1184
         L     @06,CTGPLPTR                                        1184
         L     @06,CTGFVT(,@06)                                    1184
         L     @01,ALPRMPTR                                        1184
         LA    @15,ALFPLDAT(,@01)                                  1184
         ST    @15,CTGFVATR(,@06)                                  1184
*                    LCINHIB  = ON;                                1185
*                                                                  1185
         L     @06,LCDATRPT                                        1185
         OI    LCINHIB(@06),B'00000100'                            1185
*                    END;                                          1186
*            /********************************************************/
*            /*                                                      */
*            /* BUILD THE DSATTR FPL IN ALTERATIONS HAVE BEEN MADE   */
*            /* THE INITIALIZATION OF CTGFVATR INDICATES CHANGES     */
*            /*                                                      */
*            /********************************************************/
*                                                                  1187
*            IF CTGFVATR ^= NULLPTR                                1187
*              THEN                                                1187
@RF01182 DS    0H                                                  1187
@RC01177 L     @06,CTGPLPTR                                        1187
         L     @06,CTGFVT(,@06)                                    1187
         L     @06,CTGFVATR(,@06)                                  1187
         LTR   @06,@06                                             1187
         BZ    @RF01187                                            1187
*                DO;                                               1188
*                                                                  1188
*                CTGFLPTR = ADDR(ALFPLDAT);                        1189
         L     @06,ALPRMPTR                                        1189
         LA    @15,ALFPLDAT(,@06)                                  1189
         ST    @15,CTGFLPTR                                        1189
*                ALDAT = 'DSAT';                           /*@Y30SSJH*/
         MVC   ALDAT(4,@06),@CC01449                               1190
*                CTGFLNG(1) = 2;                                   1191
         MVC   CTGFLNG(4,@15),@CF00155                             1191
*                CTGFLPT(1) = LCDATRPT;                            1192
*                                                                  1192
         L     @06,LCDATRPT                                        1192
         ST    @06,CTGFLPT(,@15)                                   1192
*                END;                                              1193
*                                                                  1193
*            END;                                                  1194
*                                                                  1194
@RF01187 DS    0H                                                  1195
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ALTER THE RG ATTRIBUTES                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1195
*        ALRGATTR = ''B;                                   /*@Y30SSJH*/
*                                                                  1195
@RF01144 XC    ALRGATTR(2),ALRGATTR                                1195
*        IF LCRATRPT ^= NULLPTR                                    1196
*          THEN                                                    1196
         L     @06,LCRATRPT                                        1196
         LTR   @06,@06                                             1196
         BZ    @RF01196                                            1196
*            ALRGATTR(1) = LCRGATTR;                       /*@Y30SSJH*/
*                                                                  1197
         MVC   ALRGATTR(1),LCRGATTR(@06)                           1197
*        IF (ADDR(UPG))  ^= NULLPTR ×                              1198
*           (ADDR(NUPG)) ^= NULLPTR ×                              1198
*           (ADDR(UPD))  ^= NULLPTR ×                              1198
*           (ADDR(NUPD)) ^= NULLPTR                                1198
*          THEN                                                    1198
@RF01196 SLR   @06,@06                                             1198
         L     @15,@PC00001+4                                      1198
         C     @06,FDTPTR+252(,@15)                                1198
         BNE   @RT01198                                            1198
         C     @06,FDTPTR+256(,@15)                                1198
         BNE   @RT01198                                            1198
         C     @06,FDTPTR+260(,@15)                                1198
         BNE   @RT01198                                            1198
         C     @06,FDTPTR+264(,@15)                                1198
         BE    @RF01198                                            1198
@RT01198 DS    0H                                                  1199
*            DO;                                           /*@Y30SSJH*/
*                                                                  1199
*            CTGFVUPG = ADDR(ALFPLRGA);                    /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1200
         L     @06,CTGFVT(,@06)                                    1200
         L     @01,ALPRMPTR                                        1200
         LA    @15,ALFPLRGA(,@01)                                  1200
         ST    @15,CTGFVUPG(,@06)                                  1200
*            ALUPSPEC = ON;                                /*@Y30SSJH*/
*                                                                  1201
         OI    ALUPSPEC,B'10000000'                                1201
*            IF (ADDR(UPG)) ^= NULLPTR ×                           1202
*               (ADDR(UPD)) ^= NULLPTR                             1202
*              THEN                                                1202
         SLR   @06,@06                                             1202
         L     @15,@PC00001+4                                      1202
         C     @06,FDTPTR+252(,@15)                                1202
         BNE   @RT01202                                            1202
         C     @06,FDTPTR+260(,@15)                                1202
         BE    @RF01202                                            1202
@RT01202 DS    0H                                                  1203
*                ALUPGUPD = ON;                            /*@Y30SSJH*/
*                                                                  1203
         OI    ALUPGUPD,B'10000000'                                1203
*              ELSE                                                1204
*                ALUPGUPD = OFF;                           /*@Y30SSJH*/
*                                                                  1204
         B     @RC01202                                            1204
@RF01202 NI    ALUPGUPD,B'01111111'                                1204
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* BUILD THE RGATTR FPL                       @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1205
*              CTGFLPTR = ADDR(ALFPLRGA);                  /*@Y30SSJH*/
@RC01202 L     @06,ALPRMPTR                                        1205
         LA    @15,ALFPLRGA(,@06)                                  1205
         ST    @15,CTGFLPTR                                        1205
*              ALRGA = 'RGAT';                             /*@Y30SSJH*/
         MVC   ALRGA(4,@06),@CC01452                               1206
*              CTGFLNG(1) = 2;                             /*@Y30SSJH*/
         MVC   CTGFLNG(4,@15),@CF00155                             1207
*              CTGFLPT(1) = ADDR(ALRGATTR);                /*@Y30SSJH*/
*                                                                  1208
         LA    @06,ALRGATTR                                        1208
         ST    @06,CTGFLPT(,@15)                                   1208
*              END;                                        /*@Y30SSJH*/
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ALTER THE GDG ATTRIBUTES                         @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1210
*        IF LCGATRPT ^= NULLPTR                                    1210
*          THEN                                                    1210
@RF01198 L     @06,LCGATRPT                                        1210
         SLR   @15,@15                                             1210
         CR    @06,@15                                             1210
         BE    @RF01210                                            1210
*            DO;                                           /*@Y30SSJH*/
*                                                                  1211
*            IF (ADDR(GDGEM)) ^= NULLPTR    /* EMPTY OPTION  @Y30SSJH*/
*              THEN                                                1212
         L     @14,@PC00001+4                                      1212
         C     @15,FDTPTR+196(,@14)                                1212
         BE    @RF01212                                            1212
*                DO;                                       /*@Y30SSJH*/
*                                                                  1213
*                CTGFVGAT = LCGATRPT;                        /*YM6404*/
         L     @01,CTGPLPTR                                        1214
         L     @01,CTGFVT(,@01)                                    1214
         ST    @06,CTGFVGAT(,@01)                                  1214
*                LCEMPTY = ON;                             /*@Y30SSJH*/
*                                                                  1215
         OI    LCEMPTY(@06),B'10000000'                            1215
*                END;                                      /*@Y30SSJH*/
*                                                                  1216
*              ELSE                                                1217
*                IF (ADDR(GDGNE)) ^= NULLPTR /* NOEMPTY OPTION       */
*                  THEN                                            1217
         B     @RC01212                                            1217
@RF01212 L     @06,@PC00001+4                                      1217
         L     @06,FDTPTR+200(,@06)                                1217
         LTR   @06,@06                                             1217
         BZ    @RF01217                                            1217
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1218
*                    CTGFVGAT = LCGATRPT;                    /*YM6404*/
         L     @06,LCGATRPT                                        1219
         L     @01,CTGPLPTR                                        1219
         L     @01,CTGFVT(,@01)                                    1219
         ST    @06,CTGFVGAT(,@01)                                  1219
*                    LCEMPTY = OFF;                        /*@Y30SSJH*/
*                                                                  1220
         NI    LCEMPTY(@06),B'01111111'                            1220
*                    END;                                  /*@Y30SSJH*/
*                                                                  1221
*            IF (ADDR(GDGNS)) ^= NULLPTR                           1222
*              THEN                                                1222
@RF01217 DS    0H                                                  1222
@RC01212 L     @06,@PC00001+4                                      1222
         L     @06,FDTPTR+208(,@06)                                1222
         LTR   @06,@06                                             1222
         BZ    @RF01222                                            1222
*                DO;                                       /*@YL026UA*/
*                                                                  1223
*                CTGFVGAT = LCGATRPT;                        /*YM6404*/
         L     @06,LCGATRPT                                        1224
         L     @01,CTGPLPTR                                        1224
         L     @01,CTGFVT(,@01)                                    1224
         ST    @06,CTGFVGAT(,@01)                                  1224
*                LCSCRTCH = OFF;                           /*@YL026UA*/
*                                                                  1225
         NI    LCSCRTCH(@06),B'10111111'                           1225
*                END;                                      /*@YL026UA*/
*                                                                  1226
*              ELSE                                                1227
*                IF (ADDR(GDGSC)) ^= NULLPTR                       1227
*                  THEN                                            1227
         B     @RC01222                                            1227
@RF01222 L     @06,@PC00001+4                                      1227
         L     @06,FDTPTR+204(,@06)                                1227
         LTR   @06,@06                                             1227
         BZ    @RF01227                                            1227
*                    DO;                                   /*@YL026UA*/
*                                                                  1228
*                    CTGFVGAT = LCGATRPT;                    /*YM6404*/
         L     @06,LCGATRPT                                        1229
         L     @01,CTGPLPTR                                        1229
         L     @01,CTGFVT(,@01)                                    1229
         ST    @06,CTGFVGAT(,@01)                                  1229
*                    LCSCRTCH  = ON;                       /*@YL026UA*/
*                                                                  1230
         OI    LCSCRTCH(@06),B'01000000'                           1230
*                    END;                                  /*@YL026UA*/
*                                                                  1231
*            END;                                          /*@YL026UA*/
@RF01227 DS    0H                                                  1232
@RC01222 DS    0H                                                  1233
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE AMDSBCAT FIELD AS SPECIFIED                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1233
*        IF LCAMDPT ^= NULLPTR                                     1233
*          THEN                                                    1233
@RF01210 L     @06,LCAMDPT                                         1233
         SLR   @15,@15                                             1233
         CR    @06,@15                                             1233
         BE    @RF01233                                            1233
*            DO;                                                   1234
*                                                                  1234
*            RFY IDAAMDSB BASED(LCAMDPT);                          1235
*                                                                  1235
*            /********************************************************/
*            /*                                              @Y30LSJH*/
*            /* ALTER THE SS/1 ATTRIBUTES                    @Y30LSJH*/
*            /*                                              @Y30LSJH*/
*            /********************************************************/
*                                                                  1236
*            IF (ADDR(STAGE)) ^= NULLPTR                           1236
*              THEN                                                1236
         L     @14,@PC00001+4                                      1236
         C     @15,FDTPTR+272(,@14)                                1236
         BE    @RF01236                                            1236
*                DO;                                       /*@Y30LSJH*/
*                                                                  1237
*                AMDFAULT = OFF;                           /*@Y30LSJH*/
*                AMDBIND  = OFF;                           /*@Y30LSJH*/
         NI    AMDFAULT(@06),B'10011111'                           1239
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/
*                                                                  1240
         L     @06,CTGPLPTR                                        1240
         L     @06,CTGFVT(,@06)                                    1240
         L     @01,ALPRMPTR                                        1240
         LA    @15,ALFPLAMD(,@01)                                  1240
         ST    @15,CTGFVAMD(,@06)                                  1240
*                END;                                      /*@Y30LSJH*/
*                                                                  1241
*            IF (ADDR(BIND)) ^= NULLPTR                            1242
*              THEN                                                1242
@RF01236 L     @06,@PC00001+4                                      1242
         L     @06,FDTPTR+276(,@06)                                1242
         LTR   @06,@06                                             1242
         BZ    @RF01242                                            1242
*                DO;                                       /*@Y30LSJH*/
*                                                                  1243
*                AMDFAULT = OFF;                           /*@Y30LSJH*/
*                AMDBIND = ON;                             /*@Y30LSJH*/
         L     @06,LCAMDPT                                         1245
         OI    AMDBIND(@06),B'00100000'                            1245
         NI    AMDFAULT(@06),B'10111111'                           1245
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/
*                                                                  1246
         L     @06,CTGPLPTR                                        1246
         L     @06,CTGFVT(,@06)                                    1246
         L     @01,ALPRMPTR                                        1246
         LA    @15,ALFPLAMD(,@01)                                  1246
         ST    @15,CTGFVAMD(,@06)                                  1246
*                END;                                      /*@Y30LSJH*/
*                                                                  1247
*            IF (ADDR(CYLF)) ^= NULLPTR                            1248
*              THEN                                                1248
@RF01242 L     @06,@PC00001+4                                      1248
         L     @06,FDTPTR+280(,@06)                                1248
         LTR   @06,@06                                             1248
         BZ    @RF01248                                            1248
*                DO;                                       /*@Y30LSJH*/
*                                                                  1249
*                AMDFAULT = ON;                            /*@Y30LSJH*/
*                AMDBIND = OFF;                            /*@Y30LSJH*/
         L     @06,LCAMDPT                                         1251
         OI    AMDFAULT(@06),B'01000000'                           1251
         NI    AMDBIND(@06),B'11011111'                            1251
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/
*                                                                  1252
         L     @06,CTGPLPTR                                        1252
         L     @06,CTGFVT(,@06)                                    1252
         L     @01,ALPRMPTR                                        1252
         LA    @15,ALFPLAMD(,@01)                                  1252
         ST    @15,CTGFVAMD(,@06)                                  1252
*                END;                                      /*@Y30LSJH*/
*                                                                  1253
*            IF (ADDR(NSTGW)) ^= NULLPTR                           1254
*              THEN                                                1254
@RF01248 L     @06,@PC00001+4                                      1254
         L     @06,FDTPTR+284(,@06)                                1254
         LTR   @06,@06                                             1254
         BZ    @RF01254                                            1254
*                DO;                                       /*@Y30LSJH*/
*                                                                  1255
*                AMDWAIT = OFF;                            /*@Y30LSJH*/
         L     @06,LCAMDPT                                         1256
         NI    AMDWAIT(@06),B'11101111'                            1256
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/
*                                                                  1257
         L     @06,CTGPLPTR                                        1257
         L     @06,CTGFVT(,@06)                                    1257
         L     @01,ALPRMPTR                                        1257
         LA    @15,ALFPLAMD(,@01)                                  1257
         ST    @15,CTGFVAMD(,@06)                                  1257
*                END;                                      /*@Y30LSJH*/
*                                                                  1258
*            IF (ADDR(STGW)) ^= NULLPTR                            1259
*              THEN                                                1259
@RF01254 L     @06,@PC00001+4                                      1259
         L     @06,FDTPTR+288(,@06)                                1259
         LTR   @06,@06                                             1259
         BZ    @RF01259                                            1259
*                DO;                                       /*@Y30LSJH*/
*                                                                  1260
*                AMDWAIT = ON;                             /*@Y30LSJH*/
         L     @06,LCAMDPT                                         1261
         OI    AMDWAIT(@06),B'00010000'                            1261
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30LSJH*/
*                                                                  1262
         L     @06,CTGPLPTR                                        1262
         L     @06,CTGFVT(,@06)                                    1262
         L     @01,ALPRMPTR                                        1262
         LA    @15,ALFPLAMD(,@01)                                  1262
         ST    @15,CTGFVAMD(,@06)                                  1262
*                END;                                      /*@Y30LSJH*/
*                                                                  1263
*            /********************************************************/
*            /*                                                      */
*            /* ALTER CI AND CA FREESPACE PERCENTAGES                */
*            /*                                                      */
*            /********************************************************/
*                                                                  1264
*            IF (ADDR(FSPCI)) ^= NULLPTR                           1264
*              THEN                                                1264
@RF01259 SLR   @06,@06                                             1264
         L     @15,@PC00001+4                                      1264
         L     @14,FDTPTR+124(,@15)                                1264
         CR    @14,@06                                             1264
         BE    @RF01264                                            1264
*                DO;                                               1265
*                                                                  1265
*                CTGFVAMD = ADDR(ALFPLAMD);                        1266
         L     @01,CTGPLPTR                                        1266
         L     @01,CTGFVT(,@01)                                    1266
         L     @05,ALPRMPTR                                        1266
         LA    @00,ALFPLAMD(,@05)                                  1266
         ST    @00,CTGFVAMD(,@01)                                  1266
*                AMDPCTCI = FSPCIVAL;                              1267
         L     @05,LCAMDPT                                         1267
         L     @04,FSPCIVAL(,@14)                                  1267
         STC   @04,AMDPCTCI(,@05)                                  1267
*                AMDFSCI = (AMDCINV * AMDPCTCI) / PCT100;  /*@OZ05907*/
*                                                                  1268
         LA    @14,100                                             1268
         LR    @01,@04                                             1268
         M     @00,AMDCINV(,@05)                                   1268
         DR    @00,@14                                             1268
         ST    @01,AMDFSCI(,@05)                                   1268
*                IF (ADDR(FSPCA)) ^= NULLPTR                       1269
*                  THEN                                            1269
         L     @15,FDTPTR+128(,@15)                                1269
         CR    @15,@06                                             1269
         BE    @RF01269                                            1269
*                    DO;                                           1270
*                      AMDPCTCA = FSPCAVAL;                        1271
         L     @06,FSPCAVAL(,@15)                                  1271
         STC   @06,AMDPCTCA(,@05)                                  1271
*                      AMDFSCA = (AMDPCTCA * AMDCIPCA) / PCT100;   1272
         LR    @01,@06                                             1272
         LH    @06,AMDCIPCA(,@05)                                  1272
         MR    @00,@06                                             1272
         DR    @00,@14                                             1272
         STH   @01,AMDFSCA(,@05)                                   1272
*                    END;                                  /*@OZ05907*/
*                END;                                              1274
*                                                                  1274
@RF01269 DS    0H                                                  1275
*            /********************************************************/
*            /*                                                      */
*            /* ALTER THE WRITECHECK/NOWRITECHECK OPTION             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1275
*            IF (ADDR(WRTCK)) ^= NULLPTR                           1275
*              THEN                                                1275
@RF01264 L     @06,@PC00001+4                                      1275
         L     @06,FDTPTR+132(,@06)                                1275
         LTR   @06,@06                                             1275
         BZ    @RF01275                                            1275
*                DO;                                               1276
*                                                                  1276
*                CTGFVAMD = ADDR(ALFPLAMD);                        1277
         L     @06,CTGPLPTR                                        1277
         L     @06,CTGFVT(,@06)                                    1277
         L     @01,ALPRMPTR                                        1277
         LA    @15,ALFPLAMD(,@01)                                  1277
         ST    @15,CTGFVAMD(,@06)                                  1277
*                AMDWCK = ON;                                      1278
*                                                                  1278
         L     @06,LCAMDPT                                         1278
         OI    AMDWCK(@06),B'01000000'                             1278
*                END;                                              1279
*                                                                  1279
*              ELSE                                                1280
*                IF(ADDR(NWTCK)) ^= NULLPTR                        1280
*                  THEN                                            1280
         B     @RC01275                                            1280
@RF01275 L     @06,@PC00001+4                                      1280
         L     @06,FDTPTR+136(,@06)                                1280
         LTR   @06,@06                                             1280
         BZ    @RF01280                                            1280
*                    DO;                                           1281
*                                                                  1281
*                    CTGFVAMD = ADDR(ALFPLAMD);                    1282
         L     @06,CTGPLPTR                                        1282
         L     @06,CTGFVT(,@06)                                    1282
         L     @01,ALPRMPTR                                        1282
         LA    @15,ALFPLAMD(,@01)                                  1282
         ST    @15,CTGFVAMD(,@06)                                  1282
*                    AMDWCK = OFF;                                 1283
*                                                                  1283
         L     @06,LCAMDPT                                         1283
         NI    AMDWCK(@06),B'10111111'                             1283
*                    END;                                          1284
*                                                                  1284
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* ALTER THE UNIQUEKEY/NONUNIQUEKEY OPTION      @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1285
*            IF (ADDR(UNQK)) ^= NULLPTR                            1285
*              THEN                                                1285
@RF01280 DS    0H                                                  1285
@RC01275 L     @06,@PC00001+4                                      1285
         L     @06,FDTPTR+244(,@06)                                1285
         LTR   @06,@06                                             1285
         BZ    @RF01285                                            1285
*                DO;                                       /*@Y30SSJH*/
*                                                                  1286
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1287
         L     @06,CTGFVT(,@06)                                    1287
         L     @01,ALPRMPTR                                        1287
         LA    @15,ALFPLAMD(,@01)                                  1287
         ST    @15,CTGFVAMD(,@06)                                  1287
*                AMDUNQ = OFF;                             /*@Y30SSJH*/
*                                                                  1288
         L     @06,LCAMDPT                                         1288
         NI    AMDUNQ(@06),B'01111111'                             1288
*                END;                                      /*@Y30SSJH*/
*                                                                  1289
*              ELSE                                                1290
*                IF (ADDR(NUNQK)) ^= NULLPTR                       1290
*                  THEN                                            1290
         B     @RC01285                                            1290
@RF01285 L     @06,@PC00001+4                                      1290
         L     @06,FDTPTR+248(,@06)                                1290
         LTR   @06,@06                                             1290
         BZ    @RF01290                                            1290
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1291
*                    CTGFVAMD = ADDR(ALFPLAMD);            /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1292
         L     @06,CTGFVT(,@06)                                    1292
         L     @01,ALPRMPTR                                        1292
         LA    @15,ALFPLAMD(,@01)                                  1292
         ST    @15,CTGFVAMD(,@06)                                  1292
*                    AMDUNQ = ON;                          /*@Y30SSJH*/
*                                                                  1293
         L     @06,LCAMDPT                                         1293
         OI    AMDUNQ(@06),B'10000000'                             1293
*                    END;                                  /*@Y30SSJH*/
*                                                                  1294
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* ALTER THE KEY POSITION AND LENGTH            @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1295
*            IF (ADDR(KEY)) ^= NULLPTR   &                         1295
*                KEYRECRC = 0                                      1295
*              THEN                                                1295
@RF01290 DS    0H                                                  1295
@RC01285 SLR   @06,@06                                             1295
         L     @15,@PC00001+4                                      1295
         C     @06,FDTPTR+220(,@15)                                1295
         BE    @RF01295                                            1295
         C     @06,KEYRECRC                                        1295
         BNE   @RF01295                                            1295
*                DO;                                       /*@Y30SSJH*/
*                                                                  1296
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1297
         L     @06,CTGFVT(,@06)                                    1297
         L     @01,ALPRMPTR                                        1297
         LA    @14,ALFPLAMD(,@01)                                  1297
         ST    @14,CTGFVAMD(,@06)                                  1297
*                IF CKTYPE ^= 'G'                                  1298
*                  THEN                                            1298
         CLI   CKTYPE,C'G'                                         1298
         BE    @RF01298                                            1298
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1299
*                    AMDRKP = KEYPSVAL;                    /*@Y30SSJH*/
         L     @06,FDTPTR+228(,@15)                                1300
         L     @06,KEYPSVAL(,@06)                                  1300
         L     @01,LCAMDPT                                         1300
         STH   @06,AMDRKP(,@01)                                    1300
*                    IXAMDPT -> AMDRKP = KEYPSVAL;         /*@Y30SSJH*/
*                                                                  1301
         L     @01,IXAMDPT                                         1301
         STH   @06,AMDRKP(,@01)                                    1301
*                    END;                                  /*@Y30SSJH*/
*                  ELSE                                            1303
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1303
         B     @RC01298                                            1303
@RF01298 DS    0H                                                  1304
*                    AMDAXRKP = KEYPSVAL;                  /*@Y30SSJH*/
         L     @06,@PC00001+4                                      1304
         L     @06,FDTPTR+228(,@06)                                1304
         L     @06,KEYPSVAL(,@06)                                  1304
         L     @01,LCAMDPT                                         1304
         STH   @06,AMDAXRKP(,@01)                                  1304
*                    IXAMDPT -> AMDAXRKP = KEYPSVAL;       /*@Y30SSJH*/
*                                                                  1305
         L     @01,IXAMDPT                                         1305
         STH   @06,AMDAXRKP(,@01)                                  1305
*                    END;                                  /*@Y30SSJH*/
*                                                                  1306
*                AMDKEYLN = KEYLNVAL;                      /*@Y30SSJH*/
@RC01298 L     @06,@PC00001+4                                      1307
         L     @06,FDTPTR+224(,@06)                                1307
         L     @06,KEYLNVAL(,@06)                                  1307
         L     @01,LCAMDPT                                         1307
         STH   @06,AMDKEYLN(,@01)                                  1307
*                IXAMDPT -> AMDKEYLN = KEYLNVAL;           /*@Y30SSJH*/
*                                                                  1308
         L     @01,IXAMDPT                                         1308
         STH   @06,AMDKEYLN(,@01)                                  1308
*                END;                                      /*@Y30SSJH*/
*                                                                  1309
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* ALTER THE MAXIMUM RECORDSIZE VALUE           @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1310
*            IF (ADDR(RECSZ)) ^= NULLPTR  &                        1310
*                KEYRECRC = 0                                      1310
*              THEN                                                1310
@RF01295 SLR   @06,@06                                             1310
         L     @15,@PC00001+4                                      1310
         C     @06,FDTPTR+232(,@15)                                1310
         BE    @RF01310                                            1310
         C     @06,KEYRECRC                                        1310
         BNE   @RF01310                                            1310
*                DO;                                       /*@Y30SSJH*/
*                                                                  1311
*                CTGFVAMD = ADDR(ALFPLAMD);                /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1312
         L     @06,CTGFVT(,@06)                                    1312
         L     @01,ALPRMPTR                                        1312
         LA    @14,ALFPLAMD(,@01)                                  1312
         ST    @14,CTGFVAMD(,@06)                                  1312
*                AMDLRECL = MRECVAL;                       /*@Y30SSJH*/
*                                                                  1313
         L     @06,FDTPTR+240(,@15)                                1313
         L     @06,MRECVAL(,@06)                                   1313
         L     @01,LCAMDPT                                         1313
         ST    @06,AMDLRECL(,@01)                                  1313
*                END;                                      /*@Y30SSJH*/
*                                                                  1314
*            /********************************************************/
*            /*                                                      */
*            /* BUILD THE AMDSBCAT FPL IF ALTERATIONS HAVE BEEN MADE */
*            /* INITIALIZATION OF CTGFVAMD INDICATES CHANGES         */
*            /*                                                      */
*            /********************************************************/
*                                                                  1315
*            IF CTGFVAMD ^= NULLPTR                                1315
*              THEN                                                1315
@RF01310 L     @06,CTGPLPTR                                        1315
         L     @06,CTGFVT(,@06)                                    1315
         L     @06,CTGFVAMD(,@06)                                  1315
         LTR   @06,@06                                             1315
         BZ    @RF01315                                            1315
*                DO;                                               1316
*                                                                  1316
*                CTGFLPTR = ADDR(ALFPLAMD);                        1317
         L     @06,ALPRMPTR                                        1317
         LA    @15,ALFPLAMD(,@06)                                  1317
         ST    @15,CTGFLPTR                                        1317
*                ALAMD = 'AMDB';                                   1318
         MVC   ALAMD(4,@06),@CC01450                               1318
*                CTGFLNG(1) = LCAMDLN;                             1319
         L     @06,LCAMDLN                                         1319
         ST    @06,CTGFLNG(,@15)                                   1319
*                CTGFLPT(1) = LCAMDPT;                             1320
*                                                                  1320
         L     @06,LCAMDPT                                         1320
         ST    @06,CTGFLPT(,@15)                                   1320
*                END;                                              1321
*                                                                  1321
*            END;                                                  1322
@RF01315 DS    0H                                                  1323
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ALTER THE AVERAGE RECORD SIZE                    @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1323
*        IF LCAMDPT ^= NULLPTR        &                            1323
*           (ADDR(RECSZ)) ^= NULLPTR  &                            1323
*           KEYRECRC = 0                                           1323
*          THEN                                                    1323
@RF01233 SLR   @06,@06                                             1323
         C     @06,LCAMDPT                                         1323
         BE    @RF01323                                            1323
         L     @15,@PC00001+4                                      1323
         C     @06,FDTPTR+232(,@15)                                1323
         BE    @RF01323                                            1323
         C     @06,KEYRECRC                                        1323
         BNE   @RF01323                                            1323
*            DO;                                           /*@Y30SSJH*/
*                                                                  1324
*            CTGFLPTR = ADDR(ALFPLLRC);                    /*@Y30SSJH*/
         L     @06,ALPRMPTR                                        1325
         LA    @14,ALFPLLRC(,@06)                                  1325
         ST    @14,CTGFLPTR                                        1325
*            ALLRC = 'LREC';                               /*@Y30SSJH*/
         MVC   ALLRC(4,@06),@CC01508                               1326
*            CTGFLNG(1) = 4;                               /*@Y30SSJH*/
         MVC   CTGFLNG(4,@14),@CF00044                             1327
*            CTGFVLRS = CTGFLPTR;                          /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1328
         L     @06,CTGFVT(,@06)                                    1328
         ST    @14,CTGFVLRS(,@06)                                  1328
*            CTGFLPT(1) = ADDR(ARECVAL);                   /*@Y30SSJH*/
*                                                                  1329
         L     @06,FDTPTR+236(,@15)                                1329
         ST    @06,CTGFLPT(,@14)                                   1329
*            END;                                          /*@Y30SSJH*/
*                                                                  1330
*        /************************************************************/
*        /*                                                          */
*        /* ALTER THE OBJECTS BUFFERSIZE                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1331
*        IF (ADDR(BUFSZ)) ^= NULLPTR                               1331
*          THEN                                                    1331
@RF01323 L     @06,@PC00001+4                                      1331
         L     @06,FDTPTR+140(,@06)                                1331
         LTR   @06,@06                                             1331
         BZ    @RF01331                                            1331
*            DO;                                                   1332
*                                                                  1332
*            CTGFVBUF = ADDR(ALFPLBUF);                            1333
         L     @01,CTGPLPTR                                        1333
         L     @01,CTGFVT(,@01)                                    1333
         L     @15,ALPRMPTR                                        1333
         LA    @14,ALFPLBUF(,@15)                                  1333
         ST    @14,CTGFVBUF(,@01)                                  1333
*            CTGFLPTR = ADDR(ALFPLBUF);                            1334
         ST    @14,CTGFLPTR                                        1334
*            ALBUF = 'BUFS';                                       1335
         MVC   ALBUF(4,@15),@CC01509                               1335
*            CTGFLNG(1) = 4;                                       1336
         MVC   CTGFLNG(4,@14),@CF00044                             1336
*            CTGFLPT(1) = ADDR(BUFSZVAL);                          1337
*                                                                  1337
         ST    @06,CTGFLPT(,@14)                                   1337
*            END;                                                  1338
*                                                                  1338
*        /************************************************************/
*        /*                                                          */
*        /* SPECIFY THE VOLUMES TO BE ADDED OR REMOVED FROM THE      */
*        /* OBJECTS VOLUME LIST                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1339
*        IF (ADDR(ADDVL)) ^= NULLPTR  ×                            1339
*          (ADDR(REMVL)) ^= NULLPTR                                1339
*          THEN                                                    1339
@RF01331 SLR   @06,@06                                             1339
         L     @15,@PC00001+4                                      1339
         C     @06,FDTPTR+144(,@15)                                1339
         BNE   @RT01339                                            1339
         C     @06,FDTPTR+148(,@15)                                1339
         BE    @RF01339                                            1339
@RT01339 DS    0H                                                  1340
*            DO;                                                   1340
*                                                                  1340
*            ADDCOUNT = 0;                                         1341
         SLR   @06,@06                                             1341
         STH   @06,ADDCOUNT                                        1341
*            ALVOLLEN = 0;                                         1342
*                                                                  1342
         ST    @06,ALVOLLEN                                        1342
*            /********************************************************/
*            /*                                                      */
*            /* GET SPACE FOR THE VOLUME LIST                        */
*            /* FOR BOTH ADDVOLUMES AND REMOVEVOLUMES                */
*            /*                                                      */
*            /********************************************************/
*                                                                  1343
*            IF (ADDR(ADDVL)) ^= NULLPTR                           1343
*              THEN                                                1343
         L     @15,@PC00001+4                                      1343
         L     @15,FDTPTR+144(,@15)                                1343
         CR    @15,@06                                             1343
         BE    @RF01343                                            1343
*                DO;                                               1344
*                                                                  1344
*                ALVOLLEN = ADDVLCNT;                              1345
         LH    @06,ADDVLCNT(,@15)                                  1345
         ST    @06,ALVOLLEN                                        1345
*                CTGFVAVL = ON;                                    1346
*                                                                  1346
         L     @06,CTGPLPTR                                        1346
         L     @06,CTGFVT(,@06)                                    1346
         OI    CTGFVAVL(@06),B'10000000'                           1346
*                END;                                              1347
*                                                                  1347
*            IF (ADDR(REMVL)) ^= NULLPTR                           1348
*              THEN                                                1348
@RF01343 L     @06,@PC00001+4                                      1348
         L     @06,FDTPTR+148(,@06)                                1348
         LTR   @06,@06                                             1348
         BZ    @RF01348                                            1348
*                DO;                                               1349
*                                                                  1349
*                ALVOLLEN = ALVOLLEN + REMVLCNT;                   1350
         LH    @06,REMVLCNT(,@06)                                  1350
         AL    @06,ALVOLLEN                                        1350
         ST    @06,ALVOLLEN                                        1350
*                CTGFVRVL = ON;                                    1351
*                                                                  1351
         L     @06,CTGPLPTR                                        1351
         L     @06,CTGFVT(,@06)                                    1351
         OI    CTGFVRVL(@06),B'01000000'                           1351
*                END;                                              1352
*                                                                  1352
*            CALL IDCSAGP0(GDTTBL,                                 1353
*                   ((ALVOLLEN * 8) + 2),   /*LENGTH OF VOLUME LIST  */
*                   CTGFVVLT,               /* POINTER TO VOLUME LIST*/
*                   ALGPID,                 /* UGPOOL ID FOR VOL LIST*/
*                   SETZERO);               /* SET AREA TO ZERO      */
*                                                                  1353
@RF01348 L     @06,@PC00001                                        1353
         ST    @06,@AL00001                                        1353
         L     @15,ALVOLLEN                                        1353
         SLA   @15,3                                               1353
         AL    @15,@CF00155                                        1353
         ST    @15,@AFTEMPS                                        1353
         LA    @15,@AFTEMPS                                        1353
         ST    @15,@AL00001+4                                      1353
         L     @01,CTGPLPTR                                        1353
         L     @01,CTGFVT(,@01)                                    1353
         LA    @15,CTGFVVLT(,@01)                                  1353
         ST    @15,@AL00001+8                                      1353
         LA    @15,ALGPID                                          1353
         ST    @15,@AL00001+12                                     1353
         LA    @15,SETZERO                                         1353
         ST    @15,@AL00001+16                                     1353
         MVI   @AL00001+16,X'80'                                   1353
         L     @15,GDTGPL(,@06)                                    1353
         LA    @01,@AL00001                                        1353
         BALR  @14,@15                                             1353
*            RESPECIFY RTNREG RSTD;                                1354
*            TESTRC = RTNREG;                                      1355
         STH   RTNREG,TESTRC                                       1355
*            RESPECIFY RTNREG UNRSTD;                              1356
*            IF TESTRC ^= 0                                        1357
*              THEN                                                1357
         LH    @06,TESTRC                                          1357
         LTR   @06,@06                                             1357
         BZ    @RF01357                                            1357
*                DO;                                               1358
*                                                                  1358
*                ALSTID = NOSTORAG;                                1359
         MVC   ALSTID(5),@CB01039                                  1359
*                RETURN;                                           1360
*                                                                  1360
         B     @EL00003                                            1360
*                END;                                              1361
*                                                                  1361
*            ALVLSTLN = (ALVOLLEN * 8 );                           1362
*                                                                  1362
@RF01357 L     @06,CTGPLPTR                                        1362
         L     @06,CTGFVT(,@06)                                    1362
         L     @06,CTGFVVLT(,@06)                                  1362
         L     @15,ALVOLLEN                                        1362
         SLA   @15,3                                               1362
         STH   @15,ALVLSTLN(,@06)                                  1362
*            /********************************************************/
*            /*                                                      */
*            /* PLACE VOLUMES TO BE ADDED ON THE VOLUME LIST         */
*            /*                                                      */
*            /********************************************************/
*                                                                  1363
*            IF (ADDR(ADDVL)) ^= NULLPTR                           1363
*              THEN                                                1363
         L     @06,@PC00001+4                                      1363
         L     @06,FDTPTR+144(,@06)                                1363
         LTR   @06,@06                                             1363
         BZ    @RF01363                                            1363
*                DO;                                               1364
*                                                                  1364
*                ADDCOUNT = ADDVLCNT;                              1365
*                                                                  1365
         LH    @06,ADDVLCNT(,@06)                                  1365
         STH   @06,ADDCOUNT                                        1365
*                DO N = 1 TO ADDVLCNT;                             1366
*                                                                  1366
         LA    @06,1                                               1366
         B     @DE01366                                            1366
@DL01366 DS    0H                                                  1367
*                  ALVOLUME(N) = ADDVLVAL(N);                      1367
*                                                                  1367
         LR    @15,@06                                             1367
         SLA   @15,3                                               1367
         L     @01,CTGPLPTR                                        1367
         L     @01,CTGFVT(,@01)                                    1367
         L     @01,CTGFVVLT(,@01)                                  1367
         ALR   @01,@15                                             1367
         AL    @01,@CF01717                                        1367
         L     @14,@PC00001+4                                      1367
         L     @14,FDTPTR+144(,@14)                                1367
         ALR   @14,@15                                             1367
         AL    @14,@CF01718                                        1367
         MVC   ALVOLUME-4(6,@01),ADDVLVAL-3(@14)                   1367
*                END;                                              1368
*                                                                  1368
         AL    @06,@CF00220                                        1368
@DE01366 ST    @06,N                                               1368
         L     @15,@PC00001+4                                      1368
         L     @01,FDTPTR+144(,@15)                                1368
         CH    @06,ADDVLCNT(,@01)                                  1368
         BNH   @DL01366                                            1368
*                END;                                              1369
*                                                                  1369
*            /********************************************************/
*            /*                                                      */
*            /* PLACE VOLUMES TO BE REMOVED ON THE VOLUME LIST       */
*            /* REMOVED VOLUMES ARE PRECEEDED BY BINARY ONES IN      */
*            /* ALVLSTCD                                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1370
*            J = 0;                                                1370
*                                                                  1370
@RF01363 SLR   @06,@06                                             1370
         STH   @06,J                                               1370
*            IF (ADDR(REMVL)) ^= NULLPTR                           1371
*              THEN                                                1371
         L     @15,@PC00001+4                                      1371
         C     @06,FDTPTR+148(,@15)                                1371
         BE    @RF01371                                            1371
*                DO N = (ADDCOUNT + 1) TO (ADDCOUNT + REMVLCNT);   1372
*                                                                  1372
         LA    @06,1                                               1372
         AH    @06,ADDCOUNT                                        1372
         B     @DE01372                                            1372
@DL01372 DS    0H                                                  1373
*                J= J+1;                                           1373
         LA    @15,1                                               1373
         AH    @15,J                                               1373
         STH   @15,J                                               1373
*                ALVLSTCD(N) = 'FF'X;                              1374
         LR    @14,@06                                             1374
         SLA   @14,3                                               1374
         L     @01,CTGPLPTR                                        1374
         L     @01,CTGFVT(,@01)                                    1374
         L     @05,CTGFVVLT(,@01)                                  1374
         ST    @14,@TF00001                                        1374
         ALR   @14,@05                                             1374
         AL    @14,@CF01719                                        1374
         MVI   ALVLSTCD-2(@14),X'FF'                               1374
*                ALVOLUME(N) = REMVLVAL(J);                        1375
*                                                                  1375
         AL    @05,@TF00001                                        1375
         AL    @05,@CF01717                                        1375
         SLA   @15,3                                               1375
         L     @14,@PC00001+4                                      1375
         L     @01,FDTPTR+148(,@14)                                1375
         ALR   @01,@15                                             1375
         AL    @01,@CF01718                                        1375
         MVC   ALVOLUME-4(6,@05),REMVLVAL-3(@01)                   1375
*                END;                                              1376
*                                                                  1376
         AL    @06,@CF00220                                        1376
@DE01372 ST    @06,N                                               1376
         L     @15,@PC00001+4                                      1376
         L     @01,FDTPTR+148(,@15)                                1376
         LH    @00,ADDCOUNT                                        1376
         AH    @00,REMVLCNT(,@01)                                  1376
         CR    @06,@00                                             1376
         BNH   @DL01372                                            1376
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* ALLOCATE ALL VOLUMES AND THE CATALOG RECOVERY VOLUME */
*            /* IF THE COMPONENT IS IN A RECOVERABLE CATALOG.        */
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1377
*            IF CTGFVIND = NULLPTR     &                           1377
*               LCCRALN ^= NULLPTR                                 1377
*              THEN                                                1377
@RF01371 SLR   @06,@06                                             1377
         L     @01,CTGPLPTR                                        1377
         L     @15,CTGFVT(,@01)                                    1377
         C     @06,CTGFVIND(,@15)                                  1377
         BNE   @RF01377                                            1377
         C     @06,LCCRALN                                         1377
         BE    @RF01377                                            1377
*                CALL DALCPROC ('A',                               1378
*                  CTGFVVLT,                                       1378
*                  CTGFVIND,                                       1378
*                  DALCINDX);                              /*@Y30SSJH*/
*                                                                  1378
         LA    @06,@CC00859                                        1378
         ST    @06,@AL00001                                        1378
         LA    @06,CTGFVVLT(,@15)                                  1378
         ST    @06,@AL00001+4                                      1378
         LA    @06,CTGFVIND(,@15)                                  1378
         ST    @06,@AL00001+8                                      1378
         LA    @06,DALCINDX                                        1378
         ST    @06,@AL00001+12                                     1378
         LA    @01,@AL00001                                        1378
         BAL   @14,DALCPROC                                        1378
*            END;                                                  1379
*        /************************************************************/
*        /*                                                          */
*        /* ALTERPRC PROCESSING IS COMPLETE - RETURN TO INVOKER      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1380
*        RETURN;                                                   1380
*                                                                  1380
         B     @EL00003                                            1380
*END ALTERPRC;                                                     1381
         B     @EL00003                                            1381
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  PROCEDURE NAME - MEMRENAM                       @YL026UA*/
*        /*                                                  @YL026UA*/
*        /*  FUNCTION - INVOKE THE USTOW MACRO TO RENAME THE @YL026UA*/
*        /*  SPECIFIED MEMBER IN THE DIRECTORY OF THE        @YL026UA*/
*        /*  PDS AND ISSUE APPROPRIATE ALTER MESSAGES.       @YL026UA*/
*        /*                                                  @YL026UA*/
*        /*  INPUT - NONE                                    @YL026UA*/
*        /*                                                  @YL026UA*/
*        /*  OUTPUT - IF AN ERROR IS FOUND, THE RETURN CODE IS SET   */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1382
*MEMRENAM: PROCEDURE;                                      /*@YL026UA*/
*                                                                  1382
MEMRENAM STM   @14,@12,@SA00004                                    1382
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  LOCAL DECLARATIONS                              @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1383
*        DCL RENAMMEM CHAR(1) STATIC INIT('R'); /*USTOW RENAME CODE  */
*        DCL PDSIOCS PTR(31);                /*PDS IOCS PTR  @YL026UA*/
*        DCL OPNDSVAL CHAR(44) BASED;        /*OPENED PDS    @YL026UA*/
*        DCL PDSLIST BIT(LENGTH(OPNAGL)) BDY(WORD); /*STORAGE FOR    */
*                                      /*THE PDS OPNAGL      @YL026UA*/
*                                                                  1387
*        OLDERID2 = NEWERID2;                                      1387
         L     @06,@PC00001                                        1387
         L     @06,GDTTR2(,@06)                                    1387
         MVC   @TS00001(95),NEWERID2(@06)                          1387
         MVC   OLDERID2(95,@06),@TS00001                           1387
*        NEWID2 = 'ALMR';                                  /*@YL026UA*/
         MVC   NEWID2(4,@06),@CC01517                              1388
*        SETRC = 0;                                        /*@YL026UA*/
         SLR   @06,@06                                             1389
         STH   @06,SETRC                                           1389
*        ALSTID = MEMALTNM;                                /*@YL026UA*/
*                                                                  1390
         MVC   ALSTID(5),@CB01055                                  1390
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF A MEMBER WAS SPECIFIED WITH A GENERIC NAME   @YL026UA*/
*        /*  THEN ISSUE BOTH AN ERROR MESSAGE TO THAT        @YL026UA*/
*        /*  AFFECT AND A MEMBER NOT RENAMED MESSAGE         @YL026UA*/
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1391
*        IF NTRYPOS ^= 0                                           1391
*          THEN                                                    1391
         L     @06,@PC00001+4                                      1391
         L     @06,FDTPTR(,@06)                                    1391
         CLI   NTRYPOS(@06),0                                      1391
         BE    @RF01391                                            1391
*            ALSTID = GENERMEM;                            /*@YL026UA*/
         MVC   ALSTID(5),@CB01067                                  1392
*          ELSE                                                    1393
*                                                                  1393
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF A MEMBER WAS SPECIFIED WITH A PDS NAME       @YL026UA*/
*        /*  THAT DOES NOT MATCH THE NEWNAME SPECIFIED - ISSUE AN    */
*        /*  ERROR MESSAGE AND MEMBER NOT RENAMED MESSAGE    @YL026UA*/
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1393
*            IF ENTRYVAL ^= NEWNAME                                1393
*              THEN                                                1393
         B     @RC01391                                            1393
@RF01391 CLC   ENTRYVAL(44),NEWNAME                                1393
         BE    @RF01393                                            1393
*                ALSTID = NSAMEPDS;                        /*@YL026UA*/
*                                                                  1394
         MVC   ALSTID(5),@CB01073                                  1394
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  OPEN THE PDS FOR UPDATE AND DYNAMICALLY ALLOCATE IT     */
*        /*  VIA THE UOPEN MACRO IF IT WERE NOT ALREADY      @YL026UA*/
*        /*  ALLOCATED VIA JCL                               @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1395
*        IF ALSTID = MEMALTNM                                      1395
*          THEN                                                    1395
@RF01393 DS    0H                                                  1395
@RC01391 CLC   ALSTID(5),@CB01055                                  1395
         BNE   @RF01395                                            1395
*           DO;                                            /*@YL026UA*/
*        OPNPTR = ADDR(PDSLIST);                           /*@YL026UA*/
         LA    @06,PDSLIST                                         1397
         ST    @06,OPNPTR                                          1397
*        PDSLIST = ''B;                                    /*@YL026UA*/
         XC    PDSLIST(48),PDSLIST                                 1398
*        OPNOPTOT = ON;                                    /*@YL026UA*/
*        OPNOPTBK = ON;                                    /*@YL026UA*/
         OI    OPNOPTOT(@06),B'01010000'                           1400
*        OPNDSOPO = ON;                                    /*@YL026UA*/
         OI    OPNDSOPO(@06),B'00010000'                           1401
*        OPNIOC = ADDR(PDSIOCS);                           /*@YL026UA*/
         LA    @15,PDSIOCS                                         1402
         ST    @15,OPNIOC(,@06)                                    1402
*        IF ADDR(INDD) ^= NULLPTR                                  1403
*          THEN                                                    1403
         L     @15,@PC00001+4                                      1403
         L     @15,FDTPTR+20(,@15)                                 1403
         LTR   @15,@15                                             1403
         BZ    @RF01403                                            1403
*            OPNDDN = ADDR(INDDVAL);                       /*@YL026UA*/
         LA    @15,INDDVAL(,@15)                                   1404
         ST    @15,OPNDDN(,@06)                                    1404
*          ELSE                                                    1405
*            DO;                                           /*@YL026UA*/
         B     @RC01403                                            1405
@RF01403 DS    0H                                                  1406
*              OPNDSN = ADDR(ENTRYVAL);                    /*@YL026UA*/
         L     @06,OPNPTR                                          1406
         LA    @15,ENTRYVAL                                        1406
         ST    @15,OPNDSN(,@06)                                    1406
*              IF NTRYPLN ^= 0                                     1407
*                THEN                                              1407
         L     @15,@PC00001+4                                      1407
         L     @15,FDTPTR(,@15)                                    1407
         CLI   NTRYPLN(@15),0                                      1407
         BE    @RF01407                                            1407
*                  OPNPWA = ADDR(NTRYPAS);                 /*@YL026UA*/
         LA    @15,NTRYPAS(,@15)                                   1408
         ST    @15,OPNPWA(,@06)                                    1408
*            END;                                          /*@YL026UA*/
@RF01407 DS    0H                                                  1410
*        CALL IDCIOOP0(GDTTBL,OPNAGL);                     /*@YL026UA*/
@RC01403 L     @06,@PC00001                                        1410
         ST    @06,@AL00001                                        1410
         L     @01,OPNPTR                                          1410
         ST    @01,@AL00001+4                                      1410
         MVI   @AL00001+4,X'80'                                    1410
         L     @15,GDTOPN(,@06)                                    1410
         LA    @01,@AL00001                                        1410
         BALR  @14,@15                                             1410
*        RESPECIFY RTNREG RSTD;                                    1411
*        TESTRC = RTNREG;                                          1412
         STH   RTNREG,TESTRC                                       1412
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UA*/
*        IF TESTRC ^= 0                                    /*@YL026UA*/
*          THEN                                            /*@YL026UA*/
         LH    @06,TESTRC                                          1414
         LTR   @06,@06                                             1414
         BZ    @RF01414                                            1414
*            ALSTID = NOMEMALT;                            /*@YL026UA*/
         MVC   ALSTID(5),@CB01052                                  1415
*           END;                                           /*@YL026UA*/
*                                                                  1416
@RF01414 DS    0H                                                  1417
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE OPEN WAS SUCCESSFUL - RENAME THE MEMBER  @YL026UA*/
*        /*  FROM ITS DIRECTORY VIA THE USTOW MACRO          @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1417
*        IF TESTRC = 0 & ALSTID = MEMALTNM                         1417
*          THEN                                                    1417
@RF01395 LH    @06,TESTRC                                          1417
         LTR   @06,@06                                             1417
         BNZ   @RF01417                                            1417
         CLC   ALSTID(5),@CB01055                                  1417
         BNE   @RF01417                                            1417
*            DO;                                           /*@YL026UA*/
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF A MEMBER WAS SPECIFIED WITH A PDS NAME       @YL026UA*/
*        /*  THAT DOES NOT MATCH THE OPENED PDS - ISSUE AN   @YL026UA*/
*        /*  ERROR MESSAGE AND MEMBER NOT RENAMED MESSAGE    @YL026UA*/
*        /*  AND RETURN WITH AN 8 RETURN CODE                @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1419
*        IF ENTRYVAL ^= PDSIOCS -> IOCDSN -> OPNDSVAL              1419
*          THEN                                                    1419
         L     @06,PDSIOCS                                         1419
         L     @06,IOCDSN(,@06)                                    1419
         CLC   ENTRYVAL(44),OPNDSVAL(@06)                          1419
         BE    @RF01419                                            1419
*            ALSTID = NSAMEPDS;                            /*@YL026UA*/
         MVC   ALSTID(5),@CB01073                                  1420
*          ELSE                                                    1421
*            DO;                                           /*@YL026UA*/
         B     @RC01419                                            1421
@RF01419 DS    0H                                                  1422
*              PDSIOCS -> IOCMEM = ADDR(NTRYMEM);          /*@YL026UA*/
         L     @06,PDSIOCS                                         1422
         L     @15,@PC00001+4                                      1422
         L     @01,FDTPTR(,@15)                                    1422
         LA    @14,NTRYMEM(,@01)                                   1422
         ST    @14,IOCMEM(,@06)                                    1422
*              PDSIOCS -> IOCNWM = ADDR(NEWNMMEM);         /*@YL026UA*/
         L     @01,FDTPTR+16(,@15)                                 1423
         LA    @15,NEWNMMEM(,@01)                                  1423
         ST    @15,IOCNWM(,@06)                                    1423
*              CALL IDCIOST0(GDTTBL,PDSIOCS,RENAMMEM);     /*@YL026UA*/
         L     @06,@PC00001                                        1424
         ST    @06,@AL00001                                        1424
         LA    @15,PDSIOCS                                         1424
         ST    @15,@AL00001+4                                      1424
         LA    @15,RENAMMEM                                        1424
         ST    @15,@AL00001+8                                      1424
         MVI   @AL00001+8,X'80'                                    1424
         L     @15,GDTSTW(,@06)                                    1424
         LA    @01,@AL00001                                        1424
         BALR  @14,@15                                             1424
*              RESPECIFY RTNREG RSTD;                              1425
*              TESTRC = RTNREG;                                    1426
         STH   RTNREG,TESTRC                                       1426
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UA*/
*                                                                  1427
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE RENAME WAS SUCCESSFUL - ISSUE A MESSAGE  @YL026UA*/
*        /*  INDICATING THE MEMBER WAS RENAMED               @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1428
*              IF TESTRC ^= 0                                      1428
*                THEN                                              1428
         LH    @06,TESTRC                                          1428
         LTR   @06,@06                                             1428
         BZ    @RF01428                                            1428
*                  ALSTID = NOMEMALT;                      /*@YL026UA*/
*                                                                  1429
         MVC   ALSTID(5),@CB01052                                  1429
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  CLOSE THE DATA SET IF IT WAS SUCCESSFULLY OPENED@YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1430
*              CALL IDCIOCL0(GDTTBL,PDSIOCS);              /*@YL026UA*/
@RF01428 L     @06,@PC00001                                        1430
         ST    @06,@AL00001                                        1430
         LA    @15,PDSIOCS                                         1430
         ST    @15,@AL00001+4                                      1430
         MVI   @AL00001+4,X'80'                                    1430
         L     @15,GDTCLS(,@06)                                    1430
         LA    @01,@AL00001                                        1430
         BALR  @14,@15                                             1430
*              RESPECIFY RTNREG RSTD;                              1431
*              TESTRC = RTNREG;                                    1432
         STH   RTNREG,TESTRC                                       1432
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UA*/
*              SETRC = MAX(SETRC,TESTRC);                  /*@YL026UA*/
         LH    @06,TESTRC                                          1434
         LH    @15,SETRC                                           1434
         CR    @15,@06                                             1434
         BNL   *+6
         LR    @15,@06                                             1434
         STH   @15,SETRC                                           1434
*            END;                                          /*@YL026UA*/
*          END;                                            /*@YL026UA*/
*                                                                  1436
@RC01419 DS    0H                                                  1437
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE MEMBER WAS NOT SUCCESSFULLY DELETED      @YL026UA*/
*        /*  ISSUE A PRIMARY MSG FOR EXPLANATION IF ONE      @YL026UA*/
*        /*  HAS NOT PREVIOUSLY BEEN ISSUED AND              @YL026UA*/
*        /*  ISSUE THE SECONDARY MEMBER NOT DELETED MESSAGE  @YL026UA*/
*        /*  AND RETURN WITH A CODE OF 8                     @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  1437
*        IF ALSTID = GENERMEM × ALSTID = NSAMEPDS                  1437
*          THEN                                                    1437
@RF01417 CLC   ALSTID(5),@CB01067                                  1437
         BE    @RT01437                                            1437
         CLC   ALSTID(5),@CB01073                                  1437
         BNE   @RF01437                                            1437
@RT01437 DS    0H                                                  1438
*            DO;                                           /*@YL026UA*/
*              DARGLIST = ''B;                             /*@YL026UA*/
         L     @06,DDSTRU                                          1439
         XC    DARGLIST(20,@06),DARGLIST(@06)                      1439
*              DARGSMOD = ALMODID;                         /*@YL026UA*/
         MVC   DARGSMOD(3,@06),ALMODID                             1440
*              DARGSENT = ALSTD;                           /*@YL026UA*/
*                                                                  1441
         IC    @15,ALSTD                                           1441
         STC   @15,DARGSENT(,@06)                                  1441
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UA*/
*                                                                  1442
         L     @06,@PC00001                                        1442
         ST    @06,@AL00001                                        1442
         LA    @15,@CF00117                                        1442
         ST    @15,@AL00001+4                                      1442
         LA    @15,DDSTRU                                          1442
         ST    @15,@AL00001+8                                      1442
         MVI   @AL00001+8,X'80'                                    1442
         L     @15,GDTPRT(,@06)                                    1442
         LA    @01,@AL00001                                        1442
         BALR  @14,@15                                             1442
*              ALSTID = NOMEMALT;                          /*@YL026UA*/
         MVC   ALSTID(5),@CB01052                                  1443
*            END;                                          /*@YL026UA*/
*          IF ALSTID ^= MEMALTNM                                   1445
*            THEN                                                  1445
@RF01437 CLC   ALSTID(5),@CB01055                                  1445
         BE    @RF01445                                            1445
*              SETRC = LASTCC08;                           /*@YL026UA*/
         MVC   SETRC(2),@CH00039                                   1446
*          DARGLIST = ''B;                                 /*@YL026UA*/
@RF01445 L     @06,DDSTRU                                          1447
         XC    DARGLIST(20,@06),DARGLIST(@06)                      1447
*          DARGSMOD = ALMODID;                             /*@YL026UA*/
         MVC   DARGSMOD(3,@06),ALMODID                             1448
*          DARGSENT = ALSTD;                               /*@YL026UA*/
         IC    @15,ALSTD                                           1449
         STC   @15,DARGSENT(,@06)                                  1449
*          DARGDBP = ADDR(NTRYMEM);                        /*@YL026UA*/
         L     @15,@PC00001+4                                      1450
         L     @15,FDTPTR(,@15)                                    1450
         LA    @14,NTRYMEM(,@15)                                   1450
         ST    @14,DARGDBP(,@06)                                   1450
*          DARGILP = NTRYMLN;                              /*@YL026UA*/
*                                                                  1451
         SLR   @14,@14                                             1451
         IC    @14,NTRYMLN(,@15)                                   1451
         STH   @14,DARGILP(,@06)                                   1451
*          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);           /*@YL026UA*/
*                                                                  1452
         L     @06,@PC00001                                        1452
         ST    @06,@AL00001                                        1452
         LA    @15,@CF00117                                        1452
         ST    @15,@AL00001+4                                      1452
         LA    @15,DDSTRU                                          1452
         ST    @15,@AL00001+8                                      1452
         MVI   @AL00001+8,X'80'                                    1452
         L     @15,GDTPRT(,@06)                                    1452
         LA    @01,@AL00001                                        1452
         BALR  @14,@15                                             1452
*          ALSTID = NORMAL;                                /*@YL026UA*/
         MVC   ALSTID(5),@CB01034                                  1453
*        RETURN CODE (SETRC);                              /*@YL026UA*/
         LH    @15,SETRC                                           1454
         L     @14,@SA00004                                        1454
         LM    @00,@12,@SA00004+8                                  1454
         BR    @14                                                 1454
*END MEMRENAM;                                             /*@YL026UA*/
*/********************************************************************/
*/*                                                          @Y30SSJH*/
*/* PROCEDURE NAME - CHECKPRC (STAGE 3 PROCESSOR)            @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* FUNCTION - PERFORMS SPECIAL VERIFICATION IF ANY OF THE   @Y30SSJH*/
*/*            FOLLOWING PARAMETERS HAVE BEEN SPECIFIED:     @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            UPGRADE - LOCATES THE AIX DATA HIGH-USED RBA  @Y30SSJH*/
*/*                      AND VERIFIES THAT IT IS ZERO        @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            UNIQUEKEY - VERIFIES THAT THE HIGH-USED RBA   @Y30SSJH*/
*/*                        OF THE AIX DATA OBJECT BEING      @Y30SSJH*/
*/*                        ALTERED IS ZERO                   @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            KEYS AND/OR                                   @Y30SSJH*/
*/*             RECORDSIZE - LOCATES THE DATA AND INDEX (IF  @Y30SSJH*/
*/*                          KSDS) AMDSB AND HIGH-USED RBA   @Y30SSJH*/
*/*                          OF THE ENTRY NAMED IN THE       @Y30SSJH*/
*/*                          ALTER COMMAND AND VERIFIES      @Y30SSJH*/
*/*                          THAT THE DATA SET IS EMPTY AND  @Y30SSJH*/
*/*                          THAT THE NEW VALUES DO NOT      @Y30SSJH*/
*/*                          CONFLICT WITH PREVIOUSLY        @Y30SSJH*/
*/*                          DEFINED VALUES                  @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            CHECKPRC INTERFACES WITH LOCATPRC TO PERFORM  @Y30SSJH*/
*/*            THE SECONDARY LOCATES REQUIRED IN VERIFICA-   @Y30SSJH*/
*/*            TION OF KEYS AND/OR RECORDSIZE.  IN SPECIFY-  @Y30SSJH*/
*/*            ING KEYS AND/OR RECORDSIZE, THE ENTRY NAME    @Y30SSJH*/
*/*            MAY BE THAT OF A PATH, AIX, CLUSTER OR DATA   @Y30SSJH*/
*/*            OBJECT.  IF EITHER OF THESE PARAMETERS ARE    @Y30SSJH*/
*/*            SPECIFIED, ALL PARAMETERS SPECIFIED APPLY TO  @Y30SSJH*/
*/*            THE DATA OBJECT LOCATED ON THE SECONDARY      @Y30SSJH*/
*/*            LOCATE.                                       @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* INPUT - THE FDTTBL IN IDCAL01 IS REFERENCED.             @Y30SSJH*/
*/*         THE LOCTABLE BUILT BY LOCATPRC IS REFERENCED.    @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* OUTPUT -                                                 @Y30SSJH*/
*/*          ALSTID - THE GLOBAL STATUS COMMUNICATOR IS SET  @Y30SSJH*/
*/*                   ON ERROR DETECTION:                    @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*                   INVAIXER - INVALID AIX PARAMETERS      @Y30SSJH*/
*/*                   UNQUPGER - UNIQUEKEY/UPGRADE SPECIFIED @Y30SSJH*/
*/*                              FOR NON-EMPTY AIX           @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/********************************************************************/
*                                                                  1456
*CHECKPRC:                                                         1456
*        PROCEDURE;                                        /*@Y30SSJH*/
CHECKPRC STM   @14,@12,@SA00005                                    1456
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* WORKAREA FOR RETURN OF HURBADS IF UPGRADE        @Y30SSJH*/
*        /* SPECIFIED                                        @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1457
*        DCL                                                       1457
*          1 HURBAWKA BDY(WORD),                                   1457
*            2 HURTOTLN FIXED(15),                                 1457
*            2 HURRETLN FIXED(15),                                 1457
*            2 HURBADS  FIXED(31);                         /*@Y30SSJH*/
*                                                                  1457
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* WORKAREA FOR RETURN OF NAME ASSOCIATIONS. A      @Y30SSJH*/
*        /* MAXIMUM OF FIVE CAN BE RETURNED.                 @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1458
*        DCL                                                       1458
*          1 ASSOCWKA  BDY(WORD),                                  1458
*            2 ASSTOTLN  FIXED(15),                                1458
*            2 ASSRETLN  FIXED(15),                                1458
*            2 * CHAR(28);                                 /*@Y30SSJH*/
*                                                                  1458
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* WORKAREA FOR RETURN OF AMDSB IF KEYS/RECORDSIZE  @Y30SSJH*/
*        /* SPECIFIED FOR AN INDEXED DATA SET                @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1459
*        DCL                                                       1459
*          1 AMDSBWKA  BDY(WORD),                                  1459
*            2 AMDTOTLN  FIXED(15),                                1459
*            2 AMDRETLN  FIXED(15),                                1459
*            2 *         CHAR(LENGTH(IDAAMDSB)),           /*@Y30SSJH*/
*            2 *         CHAR(40);                         /*@Y30SSJH*/
*                                                                  1459
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VARIABLES USED IN CALCULATING THE SQUARE ROOT    @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1460
*        DCL                                                       1460
*          SQRTINC FIXED(31),                                      1460
*          SQRTVALU FIXED(31),        /* SQUARE ROOT VALUE   @Y30SSJH*/
*          SQRTSW   BIT(1);            /* LOOP SWITCH        @Y30SSJH*/
*                                                                  1460
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VARIABLES USED IN INDEX VALIDITY CHECKING        @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1461
*        DCL                                                       1461
*          XVAL     FIXED(31),                                     1461
*          YVAL     FIXED(31),                                     1461
*          MAXVALU  FIXED(31),         /* MAXIMUM OF XVAL AND      1461
*                                         YVAL               @Y30SSJH*/
*          KYPOSIT  FIXED(31),        /* KEY POSITION        @Y30SSJH*/
*          PASSWORD CHAR(8) INIT('PASSWORD');              /*@Y30SSJH*/
*                                                                  1461
*                                                                  1461
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ENTRY POINT TO CHECKPRC                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1462
*        OLDERID2 = NEWERID2;                                      1462
         L     @06,@PC00001                                        1462
         L     @06,GDTTR2(,@06)                                    1462
         MVC   @TS00001(95),NEWERID2(@06)                          1462
         MVC   OLDERID2(95,@06),@TS00001                           1462
*        NEWID2 = 'AL51';                                  /*@Y30SSJH*/
*                                                                  1463
         MVC   NEWID2(4,@06),@CC01543                              1463
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VERIFICATION OF THE UPGRADE PARAMETER            @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1464
*        IF (ADDR(UPG)) ^= NULLPTR                                 1464
*          THEN                                                    1464
         L     @06,@PC00001+4                                      1464
         L     @06,FDTPTR+252(,@06)                                1464
         LTR   @06,@06                                             1464
         BZ    @RF01464                                            1464
*UPGLOOP:    DO;                                           /*@Y30SSJH*/
*                                                                  1465
UPGLOOP  DS    0H                                                  1466
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* VERIFY THAT THE OBJECT LOCATED ON THE        @Y30SSJH*/
*            /* PRIMARY (FIRST) LOCATE IS A 'G'              @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1466
*            IF LCETYPVL ^= 'G'                                    1466
*              THEN                                                1466
         L     @06,LCETYPPT                                        1466
         CLI   LCETYPVL(@06),C'G'                                  1466
         BE    @RF01466                                            1466
*                DO;                                       /*@Y30SSJH*/
*                                                                  1467
*                ALSTID = INVAIXER;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01028                                  1468
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  1469
@EL00005 DS    0H                                                  1469
@EF00005 DS    0H                                                  1469
@ER00005 LM    @14,@12,@SA00005                                    1469
         BR    @14                                                 1469
*                END;                                      /*@Y30SSJH*/
*                                                                  1470
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* INSURE THAT A VALID RGATTR FIELD WAS         @Y30SSJH*/
*            /* RETURNED ON THE PRIMARY LOCATE               @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1471
*            IF LCRATRPT = NULLPTR                                 1471
*              THEN                                                1471
@RF01466 L     @06,LCRATRPT                                        1471
         LTR   @06,@06                                             1471
         BNZ   @RF01471                                            1471
*                DO;                                       /*@Y30SSJH*/
*                                                                  1472
*                ALSTID = LOCRTNER;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1473
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  1474
         B     @EL00005                                            1474
*                END;                                      /*@Y30SSJH*/
*                                                                  1475
*              ELSE                                                1476
*UPGVERF:        DO;                                       /*@Y30SSJH*/
*                                                                  1476
@RF01471 DS    0H                                                  1476
UPGVERF  DS    0H                                                  1477
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* ENSURE THAT A VALID ASSOCIATION WAS      @Y30SSJH*/
*                /* RETURNED BY THE PRIMARY LOCATE           @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1477
*                IF LCNAMID(1) ^= 'D'                              1477
*                  THEN                                            1477
         L     @06,LCNAMPT                                         1477
         CLI   LCNAMID(@06),C'D'                                   1477
         BE    @RF01477                                            1477
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1478
*                    ALSTID = LOCRTNER;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1479
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1480
         B     @EL00005                                            1480
*                    END;                                  /*@Y30SSJH*/
*                                                                  1481
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* INITIALIZE THE CPL TO LOCATE THE HIGH-   @Y30SSJH*/
*                /* USED RBA OF THE AIX DATA OBJECT          @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1482
*                CTGPLPTR = ADDR(ALCTGPL);                 /*@Y30SSJH*/
@RF01477 L     @06,ALPRMPTR                                        1482
         LA    @15,ALCTGPL(,@06)                                   1482
         ST    @15,CTGPLPTR                                        1482
*                ALCTGPL = ''B;                            /*@Y30SSJH*/
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        1483
*                CTGENT  = ADDR(LCNAMCI(1));               /*@Y30SSJH*/
         L     @06,LCNAMPT                                         1484
         LA    @06,LCNAMCI(,@06)                                   1484
         ST    @06,CTGENT(,@15)                                    1484
*                CTGCNAME = ON;                            /*@Y30SSJH*/
         OI    CTGCNAME(@15),B'00000010'                           1485
*                CTGFUNC  = CTGLOC;                        /*@Y30SSJH*/
         NI    CTGFUNC(@15),B'00111111'                            1486
         OI    CTGFUNC(@15),B'00100000'                            1486
*                CTGNUM   = ON;                            /*@Y30SSJH*/
*                CTGAM0   = ON;                            /*@Y30SSJH*/
*                                                                  1488
         OI    CTGNUM(@15),B'00000011'                             1488
*                HURBAWKA = ''B;                           /*@Y30SSJH*/
         XC    HURBAWKA(8),HURBAWKA                                1489
*                CTGWKA = ADDR(HURBAWKA);                  /*@Y30SSJH*/
         LA    @06,HURBAWKA                                        1490
         ST    @06,CTGWKA(,@15)                                    1490
*                HURTOTLN = 8;                             /*@Y30SSJH*/
*                                                                  1491
         MVC   HURTOTLN(2),@CH00039                                1491
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* SET THE CPL TO REFERENCE THE CATALOG IN  @Y30SSJH*/
*                /* WHICH THE ENTRY RESIDES                  @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1492
*                IF CATACBPT ^= NULLPTR                            1492
*                  THEN                                            1492
         L     @06,CATACBPT                                        1492
         LTR   @06,@06                                             1492
         BZ    @RF01492                                            1492
*                    DO;                         /* CATALOG OPENED IN
*                                                   IDCAL01  @Y30SSJH*/
*                                                                  1493
*                    CTGCNAME = OFF;                       /*@Y30SSJH*/
         NI    CTGCNAME(@15),B'11111101'                           1494
*                    CTGCAT   = CATACBPT;                  /*@Y30SSJH*/
*                                                                  1495
         ST    @06,CTGCAT(,@15)                                    1495
*                    END;                                  /*@Y30SSJH*/
*                                                                  1496
*                  ELSE                                            1497
*                    IF (ADDR(CATLG)) ^= NULLPTR                   1497
*                      THEN                                        1497
         B     @RC01492                                            1497
@RF01492 L     @06,@PC00001+4                                      1497
         L     @06,FDTPTR+8(,@06)                                  1497
         LTR   @06,@06                                             1497
         BZ    @RF01497                                            1497
*                        CTGCAT = ADDR(CATLGVAL); /* CATALOG SPECI-
*                                                    FIED BUT NOT  1498
*                                                    OPENED  @Y30SSJH*/
*                                                                  1498
         LA    @06,CATLGVAL(,@06)                                  1498
         L     @01,CTGPLPTR                                        1498
         ST    @06,CTGCAT(,@01)                                    1498
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* INITIALIZE THE PASSWORD ADDRESS - THE    @Y30SSJH*/
*                /* CATALOG PASSWORD HAS THE HIGHEST         @Y30SSJH*/
*                /* PRIORITY                                 @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1499
*                IF (ADDR(CATLG)) ^= NULLPTR                       1499
*                  THEN                                            1499
@RF01497 DS    0H                                                  1499
@RC01492 L     @06,@PC00001+4                                      1499
         L     @06,FDTPTR+8(,@06)                                  1499
         LTR   @06,@06                                             1499
         BZ    @RF01499                                            1499
*                    IF CATLGPLN ^= 0                              1500
*                      THEN                                        1500
         CLI   CATLGPLN(@06),0                                     1500
         BE    @RF01500                                            1500
*                        CTGPSWD = ADDR(CATLGPAS);         /*@Y30SSJH*/
*                                                                  1501
         LA    @06,CATLGPAS(,@06)                                  1501
         L     @01,CTGPLPTR                                        1501
         ST    @06,CTGPSWD(,@01)                                   1501
*                IF CTGPSWD = NULLPTR                              1502
*                  THEN                                            1502
@RF01500 DS    0H                                                  1502
@RF01499 L     @06,CTGPLPTR                                        1502
         L     @15,CTGPSWD(,@06)                                   1502
         LTR   @15,@15                                             1502
         BNZ   @RF01502                                            1502
*                    IF NTRYPLN ^= 0                               1503
*                      THEN                                        1503
         L     @15,@PC00001+4                                      1503
         L     @15,FDTPTR(,@15)                                    1503
         CLI   NTRYPLN(@15),0                                      1503
         BE    @RF01503                                            1503
*                        CTGPSWD = ADDR(NTRYPAS);          /*@Y30SSJH*/
*                                                                  1504
         LA    @15,NTRYPAS(,@15)                                   1504
         ST    @15,CTGPSWD(,@06)                                   1504
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* INITIALIZE THE FPL AND REFERENCE IT IN   @Y30SSJH*/
*                /* THE CPL                                  @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1505
*                CTGNOFLD = 1;                             /*@Y30SSJH*/
@RF01503 DS    0H                                                  1505
@RF01502 L     @06,CTGPLPTR                                        1505
         MVI   CTGNOFLD(@06),X'01'                                 1505
*                CTGFLPTR = ADDR(ALFPLRBA);                /*@Y30SSJH*/
         L     @15,ALPRMPTR                                        1506
         LA    @14,ALFPLRBA(,@15)                                  1506
         ST    @14,CTGFLPTR                                        1506
*                ALFPLRBA = ''B;                           /*@Y30SSJH*/
         XC    ALFPLRBA(16,@15),ALFPLRBA(@15)                      1507
*                CTGFLNG(1) = NULLPTR;                     /*@Y30SSJH*/
         SLR   @15,@15                                             1508
         ST    @15,CTGFLNG(,@14)                                   1508
*                CTGFLPT(1) = NULLPTR;                     /*@Y30SSJH*/
         ST    @15,CTGFLPT(,@14)                                   1509
*                CTGFIELD(1) = CTGFLPTR;                   /*@Y30SSJH*/
*                                                                  1510
         ST    @14,CTGFIELD(,@06)                                  1510
*                CTGFLDNO = 1;                             /*@Y30SSJH*/
         MVI   CTGFLDNO(@14),X'01'                                 1511
*                CTGFLDNM = ADDR(ALFLDNAM(4));             /*@Y30SSJH*/
*                                                                  1512
         LA    @06,ALFLDNAM+24                                     1512
         ST    @06,CTGFLDNM(,@14)                                  1512
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* ISSUE THE CATALOG LOCATE REQUEST         @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1513
*                CALL IDCSACA0 (GDTTBL,CTGPLPTR);          /*@Y30SSJH*/
*                                                                  1513
         L     @06,@PC00001                                        1513
         ST    @06,@AL00001                                        1513
         LA    @15,CTGPLPTR                                        1513
         ST    @15,@AL00001+4                                      1513
         L     @15,GDTCAT(,@06)                                    1513
         LA    @01,@AL00001                                        1513
         BALR  @14,@15                                             1513
*                RESPECIFY (RTNREG) RSTD;                  /*@Y30SSJH*/
*                CTGRTNCC = RTNREG;                        /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     1515
*                RESPECIFY (RTNREG) UNRSTD;                /*@Y30SSJH*/
*                                                                  1516
*                IF GDTDBG = NULLPTR                               1517
*                  THEN;                                           1517
         L     @06,@PC00001                                        1517
         L     @06,GDTDBG(,@06)                                    1517
         LTR   @06,@06                                             1517
         BZ    @RT01517                                            1517
*                  ELSE                                            1519
*                    CALL IDCDB010 (GDTTBL,'AL51');                1519
         L     @06,@PC00001                                        1519
         ST    @06,@AL00001                                        1519
         LA    @15,@CC01543                                        1519
         ST    @15,@AL00001+4                                      1519
         MVI   @AL00001+4,X'80'                                    1519
         L     @15,GDTDBG(,@06)                                    1519
         LA    @01,@AL00001                                        1519
         BALR  @14,@15                                             1519
*                                                          /*@Y30SSJH*/
*                                                                  1520
*                IF CTGRTNCC ^= 0                                  1520
*                  THEN                                            1520
@RT01517 L     @06,CTGRTNCC                                        1520
         LTR   @06,@06                                             1520
         BZ    @RF01520                                            1520
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1521
*                    ALSTID = CATERROR;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  1522
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1523
         B     @EL00005                                            1523
*                    END;                                  /*@Y30SSJH*/
*                                                                  1524
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* CHECK THE HIGH-USED RBA OF THE AIX DATA  @Y30SSJH*/
*                /* OBJECT - IF IT IS NON-ZERO, RETURN WITH  @Y30SSJH*/
*                /* ERROR INDICATED                          @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1525
*                IF CTGFLNG(1) = NULLPTR ×                         1525
*                   HURBADS ^= NULLPTR                             1525
*                  THEN                                            1525
@RF01520 SLR   @06,@06                                             1525
         L     @01,CTGFLPTR                                        1525
         C     @06,CTGFLNG(,@01)                                   1525
         BE    @RT01525                                            1525
         C     @06,HURBADS                                         1525
         BE    @RF01525                                            1525
@RT01525 DS    0H                                                  1526
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1526
*                    ALSTID = UNQUPGER;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01031                                  1527
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1528
         B     @EL00005                                            1528
*                    END;                                  /*@Y30SSJH*/
*                                                                  1529
*                END UPGVERF;                              /*@Y30SSJH*/
*                                                                  1530
@RF01525 DS    0H                                                  1531
*            END UPGLOOP;                                  /*@Y30SSJH*/
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VERIFICATION OF KEYS AND RECORDSIZE PARAMETERS   @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1532
*        IF (ADDR(KEY)) ^= NULLPTR   ×                             1532
*           (ADDR(RECSZ)) ^= NULLPTR                               1532
*          THEN                                                    1532
@RF01464 SLR   @06,@06                                             1532
         L     @15,@PC00001+4                                      1532
         C     @06,FDTPTR+220(,@15)                                1532
         BNE   @RT01532                                            1532
         C     @06,FDTPTR+232(,@15)                                1532
         BE    @RF01532                                            1532
@RT01532 DS    0H                                                  1533
*KEYRECLP:   DO;                                           /*@Y30SSJH*/
*                                                                  1533
KEYRECLP DS    0H                                                  1534
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* VERIFY KEYS/RECORDSIZE SPECIFIED FOR VALID   @Y30SSJH*/
*            /* OBJECT                                       @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1534
*            IF LCETYPVL ^= 'R' &                                  1534
*               LCETYPVL ^= 'G' &                                  1534
*               LCETYPVL ^= 'C' &                                  1534
*               LCETYPVL ^= 'D'                                    1534
*              THEN                                                1534
         L     @06,LCETYPPT                                        1534
         CLI   LCETYPVL(@06),C'R'                                  1534
         BE    @RF01534                                            1534
         CLI   LCETYPVL(@06),C'G'                                  1534
         BE    @RF01534                                            1534
         CLI   LCETYPVL(@06),C'C'                                  1534
         BE    @RF01534                                            1534
         CLI   LCETYPVL(@06),C'D'                                  1534
         BE    @RF01534                                            1534
*                DO;                                       /*@Y30SSJH*/
*                                                                  1535
*                KEYRECRC = 12;                            /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1536
*                ALSTID = INVKYREC;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01076                                  1537
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  1538
         B     @EL00005                                            1538
*                END;                                      /*@Y30SSJH*/
*                                                                  1539
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* PRIMARY LOCATE WAS FOR A CLUSTER OBJECT.     @Y30SSJH*/
*            /* STORE ASSOCIATIONS AND ENTRY TYPE FOR FUTURE @Y30SSJH*/
*            /* REFERENCE.                                   @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1540
*            CKTYPE = LCETYPVL;                            /*@Y30SSJH*/
@RF01534 L     @06,LCETYPPT                                        1540
         MVC   CKTYPE(1),LCETYPVL(@06)                             1540
*            BYPASSSW = STOP;                              /*@Y30SSJH*/
         MVI   BYPASSSW,X'0F'                                      1541
*            IF CKTYPE = 'C'                                       1542
*              THEN                                                1542
         CLI   CKTYPE,C'C'                                         1542
         BNE   @RF01542                                            1542
*                DO;                                       /*@Y30SSJH*/
*                                                                  1543
*                DATACI = LCNAMCI(1);                      /*@Y30SSJH*/
         L     @06,LCNAMPT                                         1544
         MVC   DATACI(3),LCNAMCI(@06)                              1544
*                IF LCNAMLN    >= 8   &                            1545
*                   LCNAMID(2) = 'I'                               1545
*                  THEN                                            1545
         L     @15,LCNAMLN                                         1545
         C     @15,@CF00039                                        1545
         BL    @RF01545                                            1545
         CLI   LCNAMID+4(@06),C'I'                                 1545
         BNE   @RF01545                                            1545
*                    INDEXCI = LCNAMCI(2);                 /*@Y30SSJH*/
*                                                                  1546
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1546
*                END;                                      /*@Y30SSJH*/
*                                                                  1547
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* THE PRIMARY LOCATE WAS FOR A               @Y30SSJH*/
*              /* PATH  OBJECT. STORE ASSOCIATIONS FOR       @Y30SSJH*/
*              /* FUTURE REFERENCE.                          @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1548
*              ELSE                                                1548
*                IF CKTYPE = 'R'                                   1548
*                  THEN                                            1548
         B     @RC01542                                            1548
@RF01542 CLI   CKTYPE,C'R'                                         1548
         BNE   @RF01548                                            1548
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1549
*                    IF LCNAMID(1) = 'G'                           1550
*                      THEN                                        1550
         L     @06,LCNAMPT                                         1550
         CLI   LCNAMID(@06),C'G'                                   1550
         BNE   @RF01550                                            1550
*                        DO;                               /*@Y30SSJH*/
*                                                                  1551
*                        DATACI = LCNAMCI(2);              /*@Y30SSJH*/
         MVC   DATACI(3),LCNAMCI+4(@06)                            1552
*                        INDEXCI = LCNAMCI(3);             /*@Y30SSJH*/
         MVC   INDEXCI(3),LCNAMCI+8(@06)                           1553
*                        BDATACI = LCNAMCI(4);             /*@Y30SSJH*/
         MVC   BDATACI(3),LCNAMCI+12(@06)                          1554
*                        CKTYPE = 'G';                     /*@Y30SSJH*/
*                                                                  1555
         MVI   CKTYPE,C'G'                                         1555
*                        END;                              /*@Y30SSJH*/
*                      ELSE                                        1557
*                        DO;                               /*@Y30SSJH*/
*                                                                  1557
         B     @RC01550                                            1557
@RF01550 DS    0H                                                  1558
*                        DATACI = LCNAMCI(2);              /*@Y30SSJH*/
         L     @06,LCNAMPT                                         1558
         MVC   DATACI(3),LCNAMCI+4(@06)                            1558
*                        IF LCNAMLN >= 12  &                       1559
*                           LCNAMID(3) = 'I'                       1559
*                          THEN                                    1559
         L     @15,LCNAMLN                                         1559
         C     @15,@CF00035                                        1559
         BL    @RF01559                                            1559
         CLI   LCNAMID+8(@06),C'I'                                 1559
         BNE   @RF01559                                            1559
*                            INDEXCI = LCNAMCI(3);         /*@Y30SSJH*/
         MVC   INDEXCI(3),LCNAMCI+8(@06)                           1560
*                        CKTYPE = 'C';                     /*@Y30SSJH*/
*                                                                  1561
@RF01559 MVI   CKTYPE,C'C'                                         1561
*                        END;                              /*@Y30SSJH*/
*                    END;                                  /*@Y30SSJH*/
*                                                                  1563
*                  /**************************************************/
*                  /*                                        @Y30SSJH*/
*                  /* THE PRIMARY LOCATE WAS FOR AN ALTERNATE        */
*                  /* INDEX OBJECT. STORE ASSOCIATIONS       @Y30SSJH*/
*                  /* FOR FUTURE REFERENCE.                  @Y30SSJH*/
*                  /*                                        @Y30SSJH*/
*                  /**************************************************/
*                                                                  1564
*                  ELSE                                            1564
*                    IF CKTYPE = 'G'                               1564
*                      THEN                                        1564
         B     @RC01548                                            1564
@RF01548 CLI   CKTYPE,C'G'                                         1564
         BNE   @RF01564                                            1564
*                        DO;                               /*@Y30SSJH*/
*                                                                  1565
*                        DATACI = LCNAMCI(1);              /*@Y30SSJH*/
         L     @06,LCNAMPT                                         1566
         MVC   DATACI(3),LCNAMCI(@06)                              1566
*                        INDEXCI = LCNAMCI(2);             /*@Y30SSJH*/
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1567
*                        BCLUSCI = LCNAMCI(3);             /*@Y30SSJH*/
*                                                                  1568
         MVC   BCLUSCI(3),LCNAMCI+8(@06)                           1568
*                        END;                              /*@Y30SSJH*/
*                                                                  1570
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /* PRIMARY LOCATE WAS FOR A DATA OBJECT.      */
*                      /* ENSURE DATA OBJECT ASSOCIATED WITH A       */
*                      /* AIX OR CLUSTER.                    @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1570
*                      ELSE                                        1570
*                        DO;                               /*@Y30SSJH*/
*                                                                  1570
         B     @RC01564                                            1570
@RF01564 DS    0H                                                  1571
*                        CKTYPE = LCNAMID(1);              /*@Y30SSJH*/
         L     @06,LCNAMPT                                         1571
         MVC   CKTYPE(1),LCNAMID(@06)                              1571
*                        IF CKTYPE ^= 'C'   &                      1572
*                           CKTYPE ^= 'G'                          1572
*                          THEN                                    1572
         CLI   CKTYPE,C'C'                                         1572
         BE    @RF01572                                            1572
         CLI   CKTYPE,C'G'                                         1572
         BE    @RF01572                                            1572
*                            DO;                           /*@Y30SSJH*/
*                            KEYRECRC = 12;                /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1574
*                            ALSTID = INVKYREC;            /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01076                                  1575
*                            RETURN;                       /*@Y30SSJH*/
         B     @EL00005                                            1576
*                            END;                          /*@Y30SSJH*/
*                                                                  1577
*                        END;                              /*@Y30SSJH*/
@RF01572 DS    0H                                                  1579
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* CALL LOCATPRC TO LOCATE DATA OBJECT TO BE    @Y30SSJH*/
*            /* ALTERED                                      @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1579
*            IF LCETYPVL ^= 'D'                                    1579
*              THEN                                                1579
@RC01564 DS    0H                                                  1579
@RC01548 DS    0H                                                  1579
@RC01542 L     @06,LCETYPPT                                        1579
         CLI   LCETYPVL(@06),C'D'                                  1579
         BE    @RF01579                                            1579
*                DO;                                       /*@Y30SSJH*/
*                                                                  1580
*                LOCTABLE = ''B;                           /*@Y30SSJH*/
         XC    LOCTABLE(80),LOCTABLE                               1581
*                CALL LOCATPRC;                            /*@Y30SSJH*/
         BAL   @14,LOCATPRC                                        1582
*                IF ALSTID ^= NORMAL                               1583
*                  THEN                                            1583
         CLC   ALSTID(5),@CB01034                                  1583
         BE    @RF01583                                            1583
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1584
*                    KEYRECRC = 12;                        /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1585
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1586
         B     @EL00005                                            1586
*                    END;                                  /*@Y30SSJH*/
*                                                                  1587
*                END;                                      /*@Y30SSJH*/
*                                                                  1588
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* DATA OBJECT TO BE ALTERED HAS ALREADY BEEN @Y30SSJH*/
*              /* LOCATED. LOCATE C OR G ASSOCIATION FOR     @Y30SSJH*/
*              /* OBJECT.                                    @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1589
*              ELSE                                                1589
*DATALOOP:       DO;                                       /*@Y30SSJH*/
*                                                                  1589
         B     @RC01579                                            1589
@RF01579 DS    0H                                                  1589
DATALOOP DS    0H                                                  1590
*                CTGPLPTR = ADDR(ALCTGPL);                 /*@Y30SSJH*/
         L     @06,ALPRMPTR                                        1590
         LA    @15,ALCTGPL(,@06)                                   1590
         ST    @15,CTGPLPTR                                        1590
*                ALCTGPL = ''B;                            /*@Y30SSJH*/
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        1591
*                CTGENT = ADDR(LCNAMCI(1));                /*@Y30SSJH*/
         L     @06,LCNAMPT                                         1592
         LA    @06,LCNAMCI(,@06)                                   1592
         ST    @06,CTGENT(,@15)                                    1592
*                CTGCNAME = ON;                            /*@Y30SSJH*/
         OI    CTGCNAME(@15),B'00000010'                           1593
*                CTGFUNC = CTGLOC;                         /*@Y30SSJH*/
         NI    CTGFUNC(@15),B'00111111'                            1594
         OI    CTGFUNC(@15),B'00100000'                            1594
*                CTGNUM = ON;                              /*@Y30SSJH*/
*                CTGAM0 = ON;                              /*@Y30SSJH*/
         OI    CTGNUM(@15),B'00000011'                             1596
*                CTGBYPSS = ON;                            /*@Y30SSJH*/
         OI    CTGBYPSS(@15),B'10000000'                           1597
*                ASSOCWKA = ''B;                           /*@Y30SSJH*/
         XC    ASSOCWKA(32),ASSOCWKA                               1598
*                CTGWKA = ADDR(ASSOCWKA);                  /*@Y30SSJH*/
         LA    @06,ASSOCWKA                                        1599
         ST    @06,CTGWKA(,@15)                                    1599
*                ASSTOTLN = LENGTH(ASSOCWKA);              /*@Y30SSJH*/
*                                                                  1600
         MVC   ASSTOTLN(2),@CH00222                                1600
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* SET THE CPL TO REFERENCE THE CATALOG IN  @Y30SSJH*/
*                /* WHICH THE ENTRY RESIDES.                 @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1601
*                IF CATACBPT ^= NULLPTR                            1601
*                  THEN                                            1601
         L     @06,CATACBPT                                        1601
         LTR   @06,@06                                             1601
         BZ    @RF01601                                            1601
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1602
*                    CTGCNAME = OFF;                       /*@Y30SSJH*/
         NI    CTGCNAME(@15),B'11111101'                           1603
*                    CTGCAT = CATACBPT;                    /*@Y30SSJH*/
*                                                                  1604
         ST    @06,CTGCAT(,@15)                                    1604
*                    END;                                  /*@Y30SSJH*/
*                  ELSE                                            1606
*                    IF (ADDR(CATLG)) ^= NULLPTR                   1606
*                      THEN                                        1606
         B     @RC01601                                            1606
@RF01601 L     @06,@PC00001+4                                      1606
         L     @06,FDTPTR+8(,@06)                                  1606
         LTR   @06,@06                                             1606
         BZ    @RF01606                                            1606
*                        CTGCAT = ADDR(CATLGVAL);          /*@Y30SSJH*/
*                                                                  1607
         LA    @06,CATLGVAL(,@06)                                  1607
         L     @01,CTGPLPTR                                        1607
         ST    @06,CTGCAT(,@01)                                    1607
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* INITIALIZE THE PASSWORD ADDRESS          @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1608
*                IF (ADDR(CATLG)) ^= NULLPTR                       1608
*                  THEN                                            1608
@RF01606 DS    0H                                                  1608
@RC01601 L     @06,@PC00001+4                                      1608
         L     @06,FDTPTR+8(,@06)                                  1608
         LTR   @06,@06                                             1608
         BZ    @RF01608                                            1608
*                    IF CATLGPLN ^= 0                              1609
*                      THEN                                        1609
         CLI   CATLGPLN(@06),0                                     1609
         BE    @RF01609                                            1609
*                        CTGPSWD = ADDR(CATLGPAS);         /*@Y30SSJH*/
         LA    @06,CATLGPAS(,@06)                                  1610
         L     @01,CTGPLPTR                                        1610
         ST    @06,CTGPSWD(,@01)                                   1610
*                IF CTGPSWD = NULLPTR                              1611
*                  THEN                                            1611
@RF01609 DS    0H                                                  1611
@RF01608 L     @06,CTGPLPTR                                        1611
         L     @15,CTGPSWD(,@06)                                   1611
         LTR   @15,@15                                             1611
         BNZ   @RF01611                                            1611
*                    IF NTRYPLN ^= 0                               1612
*                      THEN                                        1612
         L     @15,@PC00001+4                                      1612
         L     @15,FDTPTR(,@15)                                    1612
         CLI   NTRYPLN(@15),0                                      1612
         BE    @RF01612                                            1612
*                        CTGPSWD = ADDR(NTRYPAS);          /*@Y30SSJH*/
*                                                                  1613
         LA    @15,NTRYPAS(,@15)                                   1613
         ST    @15,CTGPSWD(,@06)                                   1613
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* INITIALIZE THE FPL AND REFERENCE IT IN   @Y30SSJH*/
*                /* THE CPL                                  @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1614
*                CTGNOFLD = 1;                             /*@Y30SSJH*/
@RF01612 DS    0H                                                  1614
@RF01611 L     @06,CTGPLPTR                                        1614
         MVI   CTGNOFLD(@06),X'01'                                 1614
*                CTGFLPTR = ADDR(ALFPLNAM);                /*@Y30SSJH*/
         L     @15,ALPRMPTR                                        1615
         LA    @14,ALFPLNAM(,@15)                                  1615
         ST    @14,CTGFLPTR                                        1615
*                ALFPLNAM = ''B;                           /*@Y30SSJH*/
         XC    ALFPLNAM(16,@15),ALFPLNAM(@15)                      1616
*                CTGFLNG(1) = NULLPTR;                     /*@Y30SSJH*/
         SLR   @05,@05                                             1617
         ST    @05,CTGFLNG(,@14)                                   1617
*                CTGFLPT(1) = NULLPTR;                     /*@Y30SSJH*/
         ST    @05,CTGFLPT(,@14)                                   1618
*                CTGFIELD(1) = CTGFLPTR;                   /*@Y30SSJH*/
         ST    @14,CTGFIELD(,@06)                                  1619
*                CTGFLDNO = 1;                             /*@Y30SSJH*/
         MVI   CTGFLDNO(@14),X'01'                                 1620
*                CTGFLDNM = ADDR(ALFLDNAM(3));             /*@Y30SSJH*/
*                                                                  1621
         LA    @06,ALFLDNAM+16                                     1621
         ST    @06,CTGFLDNM(,@14)                                  1621
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* INITIALIZE NAMEDS TEST FPL AND REFERENCE @Y30SSJH*/
*                /* IT IN THE NAMEDS FPL - THIS LIMITS THE   @Y30SSJH*/
*                /* NUMBER OF ASSOCIATIONS RETURNED TO FIVE. @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1622
*                CTGFLPTR = ADDR(ALFPLTST);                /*@Y30SSJH*/
         LA    @06,ALFPLTST(,@15)                                  1622
         ST    @06,CTGFLPTR                                        1622
*                ALFPLTST = ''B;                           /*@Y30SSJH*/
         XC    ALFPLTST(16,@15),ALFPLTST(@15)                      1623
*                CTGFLDNO = 1;                             /*@Y30SSJH*/
         MVI   CTGFLDNO(@06),X'01'                                 1624
*                CTGFLDCD = CTGFLDLE;                      /*@Y30SSJH*/
         MVI   CTGFLDCD(@06),X'C0'                                 1625
*                CTGFLDNM = ADDR(ALFLDNAM(16));            /*@Y30SSJH*/
         LA    @14,ALFLDNAM+120                                    1626
         ST    @14,CTGFLDNM(,@06)                                  1626
*                CTGFLNG(1) = 2;                           /*@Y30SSJH*/
         MVC   CTGFLNG(4,@06),@CF00155                             1627
*                CTGFLPT(1) = ADDR(NAMEMASK);              /*@Y30SSJH*/
         LA    @14,NAMEMASK                                        1628
         ST    @14,CTGFLPT(,@06)                                   1628
*                CTGFLPTR = ADDR(ALFPLNAM);                /*@Y30SSJH*/
         LA    @06,ALFPLNAM(,@15)                                  1629
         ST    @06,CTGFLPTR                                        1629
*                CTGFLCHN = ADDR(ALFPLTST);                /*@Y30SSJH*/
*                                                                  1630
         LA    @15,ALFPLTST(,@15)                                  1630
         ST    @15,CTGFLCHN(,@06)                                  1630
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* ISSUE CATALOG LOCATE REQUEST             @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1631
*                CALL IDCSACA0 (GDTTBL,CTGPLPTR);          /*@Y30SSJH*/
*                                                                  1631
         L     @06,@PC00001                                        1631
         ST    @06,@AL00001                                        1631
         LA    @15,CTGPLPTR                                        1631
         ST    @15,@AL00001+4                                      1631
         L     @15,GDTCAT(,@06)                                    1631
         LA    @01,@AL00001                                        1631
         BALR  @14,@15                                             1631
*                RESPECIFY (RTNREG) RSTD;                  /*@Y30SSJH*/
*                CTGRTNCC = RTNREG;                        /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     1633
*                RESPECIFY (RTNREG) UNRSTD;                /*@Y30SSJH*/
*                                                                  1634
*                IF GDTDBG = NULLPTR                               1635
*                  THEN;                                           1635
         L     @06,@PC00001                                        1635
         L     @06,GDTDBG(,@06)                                    1635
         LTR   @06,@06                                             1635
         BZ    @RT01635                                            1635
*                  ELSE                                            1637
*                    CALL IDCDB010 (GDTTBL,'AL52');                1637
         L     @06,@PC00001                                        1637
         ST    @06,@AL00001                                        1637
         LA    @15,@CC01552                                        1637
         ST    @15,@AL00001+4                                      1637
         MVI   @AL00001+4,X'80'                                    1637
         L     @15,GDTDBG(,@06)                                    1637
         LA    @01,@AL00001                                        1637
         BALR  @14,@15                                             1637
*                                                          /*@Y30SSJH*/
*                                                                  1638
*                IF CTGRTNCC ^= 0                                  1638
*                  THEN                                            1638
@RT01635 L     @06,CTGRTNCC                                        1638
         LTR   @06,@06                                             1638
         BZ    @RF01638                                            1638
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1639
*                    KEYRECRC = 12;                        /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1640
*                    ALSTID = CATERROR;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  1641
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1642
         B     @EL00005                                            1642
*                    END;                                  /*@Y30SSJH*/
*                                                                  1643
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* SAVE THE ASSOCIATIONS                    @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1644
*                CTGFLPTR = ADDR(ALFPLNAM);                /*@Y30SSJH*/
@RF01638 L     @06,ALPRMPTR                                        1644
         LA    @06,ALFPLNAM(,@06)                                  1644
         ST    @06,CTGFLPTR                                        1644
*                IF CTGFLNG(1) = NULLPTR        ×                  1645
*                   CTGFLPT(1) -> LCNAMEDS(1,1:4) = NULLMASK(1:4)  1645
*                  THEN                                            1645
         L     @15,CTGFLNG(,@06)                                   1645
         LTR   @15,@15                                             1645
         BZ    @RT01645                                            1645
         L     @06,CTGFLPT(,@06)                                   1645
         CLC   LCNAMEDS(4,@06),NULLMASK                            1645
         BNE   @RF01645                                            1645
@RT01645 DS    0H                                                  1646
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1646
*                    KEYRECRC = 12;                        /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1647
*                    ALSTID = LOCRTNER;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1648
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1649
         B     @EL00005                                            1649
*                    END;                                  /*@Y30SSJH*/
*                                                                  1650
*                DATACI = CTGFLPT(1) -> LCNAMCI(1);        /*@Y30SSJH*/
@RF01645 L     @06,CTGFLPTR                                        1651
         L     @06,CTGFLPT(,@06)                                   1651
         MVC   DATACI(3),LCNAMCI(@06)                              1651
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* THIS SECONDARY LOCATE WAS FOR A 'G'      @Y30SSJH*/
*                /* OBJECT. SAVE ITS ASSOCIATIONS FOR FUTURE @Y30SSJH*/
*                /* USE.                                     @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1652
*                IF CKTYPE = 'G'                                   1652
*                  THEN                                            1652
         CLI   CKTYPE,C'G'                                         1652
         BNE   @RF01652                                            1652
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1653
*                    INDEXCI = CTGFLPT(1) -> LCNAMCI(2);   /*@Y30SSJH*/
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1654
*                    BCLUSCI = CTGFLPT(1) -> LCNAMCI(3);   /*@Y30SSJH*/
*                                                                  1655
         MVC   BCLUSCI(3),LCNAMCI+8(@06)                           1655
*                    END;                                  /*@Y30SSJH*/
*                                                                  1656
*                  /**************************************************/
*                  /*                                        @Y30SSJH*/
*                  /* THIS SECONDARY LOCATE WAS FOR 'C'      @Y30SSJH*/
*                  /* OBJECT .SAVE ITS ASSOCIATIONS FOR      @Y30SSJH*/
*                  /* FUTURE USE.                            @Y30SSJH*/
*                  /*                                        @Y30SSJH*/
*                  /**************************************************/
*                                                                  1657
*                  ELSE                                            1657
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1657
         B     @RC01652                                            1657
@RF01652 DS    0H                                                  1658
*                    IF CTGFLNG(1) >= 8  &                         1658
*                       CTGFLPT(1) -> LCNAMID(2) = 'I'             1658
*                      THEN                                        1658
         L     @06,CTGFLPTR                                        1658
         L     @15,CTGFLNG(,@06)                                   1658
         C     @15,@CF00039                                        1658
         BL    @RF01658                                            1658
         L     @06,CTGFLPT(,@06)                                   1658
         CLI   LCNAMID+4(@06),C'I'                                 1658
         BNE   @RF01658                                            1658
*                        INDEXCI = CTGFLPT(1) -> LCNAMCI(2);       1659
*                                                                  1659
         MVC   INDEXCI(3),LCNAMCI+4(@06)                           1659
*                    END;                                  /*@Y30SSJH*/
@RF01658 DS    0H                                                  1661
*                END DATALOOP;                             /*@Y30SSJH*/
*                                                                  1661
@RC01652 DS    0H                                                  1662
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* KEYS/RECORDSIZE PARAMETERS VALID ONLY FOR AN @Y30SSJH*/
*            /* EMPTY DATA SET                               @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1662
*            IF LCRBAPT = NULLPTR  ×                               1662
*               LCHURBA ^= 0                                       1662
*              THEN                                                1662
@RC01579 L     @06,LCRBAPT                                         1662
         SLR   @15,@15                                             1662
         CR    @06,@15                                             1662
         BE    @RT01662                                            1662
         ICM   @14,15,LCHURBA(@06)                                 1662
         CLR   @15,@14                                             1662
         BE    @RF01662                                            1662
@RT01662 DS    0H                                                  1663
*                DO;                                       /*@Y30SSJH*/
*                                                                  1663
*                KEYRECRC = 12;                            /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1664
*                ALSTID = KEYRECER;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01079                                  1665
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  1666
         B     @EL00005                                            1666
*                END;                                      /*@Y30SSJH*/
*                                                                  1667
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* AVERAGE AND MAXIMUM RECORDSIZES MUST BE      @Y30SSJH*/
*            /* EQUAL FOR A RELATIVE RECORD DATA SET         @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1668
*            IF (ADDR(RECSZ)) ^= NULLPTR  &                        1668
*               LCAMDPT -> AMDRRDS = ON                            1668
*              THEN                                                1668
@RF01662 L     @06,@PC00001+4                                      1668
         L     @15,FDTPTR+232(,@06)                                1668
         LTR   @15,@15                                             1668
         BZ    @RF01668                                            1668
         L     @01,LCAMDPT                                         1668
         TM    AMDRRDS(@01),B'00000010'                            1668
         BNO   @RF01668                                            1668
*                IF ARECVAL ^= MRECVAL                             1669
*                  THEN                                            1669
         L     @01,FDTPTR+236(,@06)                                1669
         L     @06,FDTPTR+240(,@06)                                1669
         CLC   ARECVAL(4,@01),MRECVAL(@06)                         1669
         BE    @RF01669                                            1669
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1670
*                    KEYRECRC = 12;                        /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1671
*                    ALSTID = RRDSERR;                     /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01082                                  1672
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1673
         B     @EL00005                                            1673
*                    END;                                  /*@Y30SSJH*/
*                                                                  1674
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* DETERMINE WHETHER OR NOT THE DATA SET IS     @Y30SSJH*/
*            /* SPANNED AND SET THE DATA RECORD HEADER SIZE  @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1675
*            RFY IDAAMDSB BASED(LCAMDPT);                  /*@Y30SSJH*/
*                                                                  1675
@RF01669 DS    0H                                                  1675
@RF01668 DS    0H                                                  1676
*            DRHS = NSPDRHS;                               /*@Y30SSJH*/
         LA    @06,7                                               1676
         STH   @06,DRHS                                            1676
*            IF AMDSPAN = ON                                       1677
*              THEN                                                1677
         L     @15,LCAMDPT                                         1677
         TM    AMDSPAN(@15),B'00000001'                            1677
         BNO   @RF01677                                            1677
*                IF (ADDR(RECSZ)) ^= NULLPTR                       1678
*                  THEN                                            1678
         L     @14,@PC00001+4                                      1678
         L     @05,FDTPTR+232(,@14)                                1678
         LTR   @05,@05                                             1678
         BZ    @RF01678                                            1678
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1679
*                    IF (MRECVAL + NSPDRHS) > AMDCINV              1680
*                      THEN                                        1680
         L     @01,FDTPTR+240(,@14)                                1680
         AL    @06,MRECVAL(,@01)                                   1680
         C     @06,AMDCINV(,@15)                                   1680
         BNH   @RF01680                                            1680
*                        DRHS = SPDRHS;                    /*@Y30SSJH*/
         MVC   DRHS(2),@CH00037                                    1681
*                      ELSE                                        1682
*                        DRHS = NSPDRHS;                   /*@Y30SSJH*/
*                                                                  1682
         B     @RC01680                                            1682
@RF01680 MVC   DRHS(2),@CH00467                                    1682
*                    END;                                  /*@Y30SSJH*/
*              ELSE                                                1684
*                IF (AMDLRECL + NSPDRHS) > AMDCINV                 1684
*                  THEN                                            1684
         B     @RC01678                                            1684
@RF01678 L     @06,LCAMDPT                                         1684
         LA    @15,7                                               1684
         AL    @15,AMDLRECL(,@06)                                  1684
         C     @15,AMDCINV(,@06)                                   1684
         BNH   @RF01684                                            1684
*                    DRHS = SPDRHS;                        /*@Y30SSJH*/
         MVC   DRHS(2),@CH00037                                    1685
*                  ELSE                                            1686
*                    DRHS = NSPDRHS;                       /*@Y30SSJH*/
*                                                                  1686
         B     @RC01684                                            1686
@RF01684 MVC   DRHS(2),@CH00467                                    1686
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* ENSURE NEW MAXIMUM RECORDSIZE IS VALID       @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*             /********************************************************
*                                                                  1687
*            IF (ADDR(RECSZ)) ^= NULLPTR                           1687
*               THEN                                               1687
@RC01684 DS    0H                                                  1687
@RC01678 DS    0H                                                  1687
@RF01677 L     @06,@PC00001+4                                      1687
         L     @06,FDTPTR+232(,@06)                                1687
         LTR   @06,@06                                             1687
         BZ    @RF01687                                            1687
*RECLOOP:         DO;                                      /*@Y30SSJH*/
*                                                                  1688
RECLOOP  DS    0H                                                  1689
*                IF MRECVAL > AMDCIPCA * (AMDCINV - DRHS)          1689
*                   THEN                                           1689
         L     @06,@PC00001+4                                      1689
         L     @06,FDTPTR+240(,@06)                                1689
         L     @15,LCAMDPT                                         1689
         L     @14,AMDCINV(,@15)                                   1689
         SH    @14,DRHS                                            1689
         MH    @14,AMDCIPCA(,@15)                                  1689
         C     @14,MRECVAL(,@06)                                   1689
         BNL   @RF01689                                            1689
*                     DO;                                  /*@Y30SSJH*/
*                                                                  1690
*                    KEYRECRC = 12;                        /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1691
*                    ALSTID = CINVERR;                     /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01086                                  1692
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  1693
         B     @EL00005                                            1693
*                    END;                                  /*@Y30SSJH*/
*                                                                  1695
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* ENSURE PREVIOUS RECORDSIZE VALUES ARE    @Y30SSJH*/
*                /* NOT EQUAL TO NEW VALUES                  @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1695
*                IF MRECVAL = AMDLRECL                             1695
*                   THEN                                           1695
@RF01689 L     @06,@PC00001+4                                      1695
         L     @06,FDTPTR+240(,@06)                                1695
         L     @15,LCAMDPT                                         1695
         L     @14,AMDLRECL(,@15)                                  1695
         C     @14,MRECVAL(,@06)                                   1695
         BNE   @RF01695                                            1695
*                     DO;                                  /*@Y30SSJH*/
*                                                                  1696
*                     IF AMDSPAN = ON                              1697
*                       THEN                                       1697
         TM    AMDSPAN(@15),B'00000001'                            1697
         BNO   @RF01697                                            1697
*                         IF AMDLRECL = SPMDEF                     1698
*                           THEN                                   1698
         C     @14,@CF01135                                        1698
         BNE   @RF01698                                            1698
*                             KEYRECRC = 4;                /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00044                                1699
*                           ELSE                                   1700
*                             KEYRECRC = 5;                /*@Y30SSJH*/
         B     @RC01698                                            1700
@RF01698 MVC   KEYRECRC(4),@CF00287                                1700
*                       ELSE                                       1701
*                         IF AMDLRECL = NSPDEF                     1701
*                           THEN                                   1701
         B     @RC01697                                            1701
@RF01697 L     @06,LCAMDPT                                         1701
         CLC   AMDLRECL(4,@06),@CF01137                            1701
         BNE   @RF01701                                            1701
*                             KEYRECRC = 4;                /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00044                                1702
*                           ELSE                                   1703
*                             KEYRECRC = 5;                /*@Y30SSJH*/
*                                                                  1703
         B     @RC01701                                            1703
@RF01701 MVC   KEYRECRC(4),@CF00287                                1703
*                     END;                                 /*@Y30SSJH*/
*                                                                  1704
@RC01701 DS    0H                                                  1704
@RC01697 DS    0H                                                  1705
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* IN ORDER FOR ALTER TO BE VALID ,PREVIOUS @Y30SSJH*/
*                /* RECORDSIZE VALUES MUST BE DEFAULT VALUES @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  1705
*                IF KEYRECRC = 0                                   1705
*                  THEN                                            1705
@RF01695 L     @06,KEYRECRC                                        1705
         LTR   @06,@06                                             1705
         BNZ   @RF01705                                            1705
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1706
*                    IF AMDSPAN = OFF                              1707
*                      THEN                                        1707
         L     @06,LCAMDPT                                         1707
         TM    AMDSPAN(@06),B'00000001'                            1707
         BNZ   @RF01707                                            1707
*                        IF AMDLRECL = NSPDEF                      1708
*                          THEN ;                          /*@Y30SSJH*/
         CLC   AMDLRECL(4,@06),@CF01137                            1708
         BE    @RT01708                                            1708
*                          ELSE                                    1710
*                            DO;                           /*@Y30SSJH*/
*                                                                  1710
*                            KEYRECRC = 8;                 /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00039                                1711
*                            ALSTID = NEWVALER;            /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01092                                  1712
*                            RETURN;                       /*@Y30SSJH*/
*                                                                  1713
         B     @EL00005                                            1713
*                            END;                          /*@Y30SSJH*/
*                      ELSE                                        1715
*                        IF AMDLRECL = SPMDEF                      1715
*                          THEN  ;                         /*@Y30SSJH*/
         B     @RC01707                                            1715
@RF01707 L     @06,LCAMDPT                                         1715
         CLC   AMDLRECL(4,@06),@CF01135                            1715
         BE    @RT01715                                            1715
*                          ELSE                                    1717
*                            DO;                           /*@Y30SSJH*/
*                                                                  1717
*                            KEYRECRC = 8;                 /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00039                                1718
*                            ALSTID = NEWVALER;            /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01092                                  1719
*                            RETURN;                       /*@Y30SSJH*/
*                                                                  1720
         B     @EL00005                                            1720
*                            END;                          /*@Y30SSJH*/
*                                                                  1721
*                      END;                                /*@Y30SSJH*/
@RT01715 DS    0H                                                  1722
@RC01707 DS    0H                                                  1723
*                END RECLOOP;                              /*@Y30SSJH*/
*                                                                  1723
@RF01705 DS    0H                                                  1724
*          /**********************************************************/
*          /*                                                @Y30SSJH*/
*          /* THIS ENDS PROCESSING FOR A NONINDEXED CLUSTER  @Y30SSJH*/
*          /*                                                @Y30SSJH*/
*          /**********************************************************/
*                                                                  1724
*                                                                  1724
*          /**********************************************************/
*          /*                                                @Y30SSJH*/
*          /* LOCATE THE ASSOCIATED INDEX AMDSB FOR MORE     @Y30SSJH*/
*          /* VALIDITY CHECKING                              @Y30SSJH*/
*          /*                                                @Y30SSJH*/
*          /**********************************************************/
*                                                                  1724
*          IF INDEXCI ^= INITVALU                                  1724
*            THEN                                                  1724
@RF01687 CLC   INDEXCI(3),INITVALU                                 1724
         BE    @RF01724                                            1724
*INDXLOOP:     DO;                                         /*@Y30SSJH*/
*                                                                  1725
INDXLOOP DS    0H                                                  1726
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* INITIALIZE THE CPL                         @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1726
*              CTGPLPTR = ADDR(ALCTGPL);                   /*@Y30SSJH*/
         L     @06,ALPRMPTR                                        1726
         LA    @15,ALCTGPL(,@06)                                   1726
         ST    @15,CTGPLPTR                                        1726
*              ALCTGPL = ''B;                              /*@Y30SSJH*/
         XC    ALCTGPL(28,@06),ALCTGPL(@06)                        1727
*              CTGENT = ADDR(INDEXCI);                     /*@Y30SSJH*/
         LA    @06,INDEXCI                                         1728
         ST    @06,CTGENT(,@15)                                    1728
*              CTGCNAME = ON;                              /*@Y30SSJH*/
         OI    CTGCNAME(@15),B'00000010'                           1729
*              CTGFUNC = CTGLOC;                           /*@Y30SSJH*/
         NI    CTGFUNC(@15),B'00111111'                            1730
         OI    CTGFUNC(@15),B'00100000'                            1730
*              CTGNUM = ON;                                /*@Y30SSJH*/
*              CTGAM0 = ON;                                /*@Y30SSJH*/
         OI    CTGNUM(@15),B'00000011'                             1732
*              CTGBYPSS = ON;                              /*@Y30SSJH*/
*                                                                  1733
         OI    CTGBYPSS(@15),B'10000000'                           1733
*              AMDSBWKA = ''B;                             /*@Y30SSJH*/
         XC    AMDSBWKA(140),AMDSBWKA                              1734
*              CTGWKA = ADDR(AMDSBWKA);                    /*@Y30SSJH*/
         LA    @06,AMDSBWKA                                        1735
         ST    @06,CTGWKA(,@15)                                    1735
*              AMDTOTLN = LENGTH(AMDSBWKA);                /*@Y30SSJH*/
*                                                                  1736
         MVC   AMDTOTLN(2),@CH01673                                1736
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* SET THE CPL TO REFERENCE THE CATALOG IN    @Y30SSJH*/
*              /* WHICH THE ENTRY RESIDES                    @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1737
*              IF CATACBPT ^= NULLPTR                              1737
*                THEN                                              1737
         L     @06,CATACBPT                                        1737
         LTR   @06,@06                                             1737
         BZ    @RF01737                                            1737
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1738
*                  CTGCNAME = OFF;                         /*@Y30SSJH*/
         NI    CTGCNAME(@15),B'11111101'                           1739
*                  CTGCAT = CATACBPT;                      /*@Y30SSJH*/
*                                                                  1740
         ST    @06,CTGCAT(,@15)                                    1740
*                  END;                                    /*@Y30SSJH*/
*                ELSE                                              1742
*                  IF (ADDR(CATLG)) ^= NULLPTR                     1742
*                    THEN                                          1742
         B     @RC01737                                            1742
@RF01737 L     @06,@PC00001+4                                      1742
         L     @06,FDTPTR+8(,@06)                                  1742
         LTR   @06,@06                                             1742
         BZ    @RF01742                                            1742
*                      CTGCAT = ADDR(CATLGVAL);            /*@Y30SSJH*/
         LA    @06,CATLGVAL(,@06)                                  1743
         L     @01,CTGPLPTR                                        1743
         ST    @06,CTGCAT(,@01)                                    1743
*                                                                  1744
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* INITIALIZE THE PASSWORD ADDRESS            @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1744
*              IF (ADDR(CATLG)) ^= NULLPTR                         1744
*                THEN                                              1744
@RF01742 DS    0H                                                  1744
@RC01737 L     @06,@PC00001+4                                      1744
         L     @06,FDTPTR+8(,@06)                                  1744
         LTR   @06,@06                                             1744
         BZ    @RF01744                                            1744
*                  IF CATLGPLN ^= 0                                1745
*                    THEN                                          1745
         CLI   CATLGPLN(@06),0                                     1745
         BE    @RF01745                                            1745
*                      CTGPSWD = ADDR(CATLGPAS);           /*@Y30SSJH*/
         LA    @06,CATLGPAS(,@06)                                  1746
         L     @01,CTGPLPTR                                        1746
         ST    @06,CTGPSWD(,@01)                                   1746
*              IF CTGPSWD = NULLPTR                                1747
*                THEN                                              1747
@RF01745 DS    0H                                                  1747
@RF01744 L     @06,CTGPLPTR                                        1747
         L     @15,CTGPSWD(,@06)                                   1747
         LTR   @15,@15                                             1747
         BNZ   @RF01747                                            1747
*                  IF NTRYPLN ^= 0                                 1748
*                    THEN                                          1748
         L     @15,@PC00001+4                                      1748
         L     @15,FDTPTR(,@15)                                    1748
         CLI   NTRYPLN(@15),0                                      1748
         BE    @RF01748                                            1748
*                      CTGPSWD = ADDR(NTRYPAS);            /*@Y30SSJH*/
*                                                                  1749
         LA    @15,NTRYPAS(,@15)                                   1749
         ST    @15,CTGPSWD(,@06)                                   1749
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* INITIALIZE THE FPL AND REFERENCE IT IN THE @Y30SSJH*/
*              /* CPL                                        @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1750
*              CTGNOFLD = 1;                               /*@Y30SSJH*/
@RF01748 DS    0H                                                  1750
@RF01747 L     @06,CTGPLPTR                                        1750
         MVI   CTGNOFLD(@06),X'01'                                 1750
*              CTGFLPTR = ADDR(ALFPLAMD);                  /*@Y30SSJH*/
         L     @15,ALPRMPTR                                        1751
         LA    @14,ALFPLAMD(,@15)                                  1751
         ST    @14,CTGFLPTR                                        1751
*              ALFPLAMD = ''B;                             /*@Y30SSJH*/
         XC    ALFPLAMD(16,@15),ALFPLAMD(@15)                      1752
*              CTGFLNG(1) = NULLPTR;                       /*@Y30SSJH*/
         SLR   @05,@05                                             1753
         ST    @05,CTGFLNG(,@14)                                   1753
*              CTGFLPT(1) = NULLPTR;                       /*@Y30SSJH*/
         ST    @05,CTGFLPT(,@14)                                   1754
*              CTGFIELD(1) = CTGFLPTR;                     /*@Y30SSJH*/
*                                                                  1755
         ST    @14,CTGFIELD(,@06)                                  1755
*              CTGFLDNO = 1;                               /*@Y30SSJH*/
         MVI   CTGFLDNO(@14),X'01'                                 1756
*              CTGFLDNM = ADDR(ALFLDNAM(8));               /*@Y30SSJH*/
*                                                                  1757
         LA    @04,ALFLDNAM+56                                     1757
         ST    @04,CTGFLDNM(,@14)                                  1757
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* IF KEYS IS SPECIFIED, VERIFY THAT THERE IS @Y30SSJH*/
*              /* SUFFICIENT PASSWORD AUTHORIZATION TO ALTER @Y30SSJH*/
*              /* ASSOCIATED INDEX. THIS IS DONE BY LOCATING @Y30SSJH*/
*              /* THE PASSWORDS OF THE INDEX WHICH REQUIRES  @Y30SSJH*/
*              /* THE CLUSTER/INDEX MASTER PASSWORD.         @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*              IF (ADDR(KEY)) ^= NULLPTR                           1758
*                THEN                                              1758
         L     @04,@PC00001+4                                      1758
         C     @05,FDTPTR+220(,@04)                                1758
         BE    @RF01758                                            1758
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1759
*                  CTGNOFLD = 2;                           /*@Y30SSJH*/
         MVI   CTGNOFLD(@06),X'02'                                 1760
*                  CTGFLPTR = ADDR(ALFPLPSW);              /*@Y30SSJH*/
         LA    @14,ALFPLPSW(,@15)                                  1761
         ST    @14,CTGFLPTR                                        1761
*                  ALFPLPSW = ''B;                         /*@Y30SSJH*/
         XC    ALFPLPSW(16,@15),ALFPLPSW(@15)                      1762
*                  CTGFLNG(1) = NULLPTR;                   /*@Y30SSJH*/
         ST    @05,CTGFLNG(,@14)                                   1763
*                  CTGFLPT(1) = NULLPTR;                   /*@Y30SSJH*/
         ST    @05,CTGFLPT(,@14)                                   1764
*                  CTGFIELD(2) = CTGFLPTR;                 /*@Y30SSJH*/
         ST    @14,CTGFIELD+4(,@06)                                1765
*                  CTGFLDNO = 1;                           /*@Y30SSJH*/
         MVI   CTGFLDNO(@14),X'01'                                 1766
*                  CTGFLDNM = ADDR(PASSWORD);              /*@Y30SSJH*/
         LA    @06,PASSWORD                                        1767
         ST    @06,CTGFLDNM(,@14)                                  1767
*                                                                  1768
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ISSUE THE CATALOG LOCATE REQUEST           @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1768
*              CALL IDCSACA0(GDTTBL,CTGPLPTR);             /*@Y30SSJH*/
*                                                                  1768
         L     @06,@PC00001                                        1768
         ST    @06,@AL00001                                        1768
         LA    @15,CTGPLPTR                                        1768
         ST    @15,@AL00001+4                                      1768
         L     @15,GDTCAT(,@06)                                    1768
         LA    @01,@AL00001                                        1768
         BALR  @14,@15                                             1768
*              RESPECIFY (RTNREG) RSTD;                    /*@Y30SSJH*/
*              CTGRTNCC = RTNREG;                          /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     1770
*              RESPECIFY (RTNREG) UNRSTD;                  /*@Y30SSJH*/
*                                                                  1771
*              IF GDTDBG = NULLPTR                                 1772
*                THEN;                                             1772
         L     @06,@PC00001                                        1772
         L     @06,GDTDBG(,@06)                                    1772
         LTR   @06,@06                                             1772
         BZ    @RT01772                                            1772
*                ELSE                                              1774
*                  CALL IDCDB010 (GDTTBL,'AL53');                  1774
         L     @06,@PC00001                                        1774
         ST    @06,@AL00001                                        1774
         LA    @15,@CC01558                                        1774
         ST    @15,@AL00001+4                                      1774
         MVI   @AL00001+4,X'80'                                    1774
         L     @15,GDTDBG(,@06)                                    1774
         LA    @01,@AL00001                                        1774
         BALR  @14,@15                                             1774
*                                                          /*@Y30SSJH*/
*                                                                  1775
*              IF CTGRTNCC ^= 0                                    1775
*                THEN                                              1775
@RT01772 L     @06,CTGRTNCC                                        1775
         LTR   @06,@06                                             1775
         BZ    @RF01775                                            1775
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1776
*                  KEYRECRC =12;                           /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1777
*                  ALSTID = CATERROR;                      /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  1778
*                  RETURN;                                 /*@Y30SSJH*/
         B     @EL00005                                            1779
*                  END;                                    /*@Y30SSJH*/
*                                                                  1780
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* IF THE KEYS PARAMETER HAS BEEN SPECIFIED,  @Y30SSJH*/
*              /* VERIFY THAT PASSWORDS WERE SUCCESSFULLY    @Y30SSJH*/
*              /* LOCATED.                                   @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1781
*              IF (ADDR(KEY)) ^= NULLPTR                           1781
*                THEN                                              1781
@RF01775 SLR   @06,@06                                             1781
         L     @15,@PC00001+4                                      1781
         C     @06,FDTPTR+220(,@15)                                1781
         BE    @RF01781                                            1781
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1782
*                  CTGFIELD(2) = NULLPTR;                  /*@Y30SSJH*/
         L     @15,CTGPLPTR                                        1783
         ST    @06,CTGFIELD+4(,@15)                                1783
*                  CTGNOFLD = 1;                           /*@Y30SSJH*/
         MVI   CTGNOFLD(@15),X'01'                                 1784
*                  CTGFLPTR = ADDR(ALFPLPSW);              /*@Y30SSJH*/
         L     @01,ALPRMPTR                                        1785
         LA    @15,ALFPLPSW(,@01)                                  1785
         ST    @15,CTGFLPTR                                        1785
*                  IF CTGFLNG(1) = 1   &                           1786
*                     CTGFLPT(1) = 0                               1786
*                    THEN                                          1786
         CLC   CTGFLNG(4,@15),@CF00220                             1786
         BNE   @RF01786                                            1786
         C     @06,CTGFLPT(,@15)                                   1786
         BNE   @RF01786                                            1786
*                      DO;                                 /*@Y30SSJH*/
*                                                                  1787
*                      ALSTID = PSWDERR;                   /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01048                                  1788
*                      KEYRECRC = 12;                      /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1789
*                      RETURN;                             /*@Y30SSJH*/
*                                                                  1790
         B     @EL00005                                            1790
*                      END;                                /*@Y30SSJH*/
*                                                                  1791
*                  END;                                    /*@Y30SSJH*/
@RF01786 DS    0H                                                  1793
*                                                                  1793
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ENSURE THAT THE AMDSB WAS SUCCESSFULLY     @Y30SSJH*/
*              /* LOCATED                                    @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1793
*              CTGFLPTR = ADDR(ALFPLAMD);                  /*@Y30SSJH*/
@RF01781 L     @06,ALPRMPTR                                        1793
         LA    @06,ALFPLAMD(,@06)                                  1793
         ST    @06,CTGFLPTR                                        1793
*              IF CTGFLNG(1) = NULLPTR  ×                          1794
*                 CTGFLPT(1) -> IDAAMDSB = NULLMASK                1794
*                THEN                                              1794
         L     @15,CTGFLNG(,@06)                                   1794
         LTR   @15,@15                                             1794
         BZ    @RT01794                                            1794
         L     @06,CTGFLPT(,@06)                                   1794
         CLC   IDAAMDSB(8,@06),NULLMASK                            1794
         BNE   @RF01794                                            1794
@RT01794 DS    0H                                                  1795
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1795
*                  KEYRECRC =12;                           /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1796
*                  ALSTID = LOCRTNER;                      /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1797
*                  RETURN;                                 /*@Y30SSJH*/
*                                                                  1798
         B     @EL00005                                            1798
*                  END;                                    /*@Y30SSJH*/
*                                                                  1799
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* SAVE THE ADDRESS AND LENGTH OF THE INDEX @Y30SSJH*/
*                /* AMDSB FOR FUTURE REFERENCE               @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                ELSE                                              1800
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1800
@RF01794 DS    0H                                                  1801
*                  IXAMDPT = CTGFLPT(1);                   /*@Y30SSJH*/
         L     @06,CTGFLPTR                                        1801
         L     @15,CTGFLPT(,@06)                                   1801
         ST    @15,IXAMDPT                                         1801
*                  IXAMDLEN = CTGFLNG(1);                  /*@Y30SSJH*/
*                                                                  1802
         L     @06,CTGFLNG(,@06)                                   1802
         ST    @06,IXAMDLEN                                        1802
*                  END;                                    /*@Y30SSJH*/
*                                                                  1804
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* DETERMINE KEY VALUES FOR VALIDITY CHECKING @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1804
*              IF (ADDR(KEY)) ^= NULLPTR                           1804
*                THEN                                              1804
         L     @06,@PC00001+4                                      1804
         L     @15,FDTPTR+220(,@06)                                1804
         LTR   @15,@15                                             1804
         BZ    @RF01804                                            1804
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1805
*                  KEYPVALU = KEYPSVAL;                    /*@Y30SSJH*/
         L     @01,FDTPTR+228(,@06)                                1806
         L     @15,KEYPSVAL(,@01)                                  1806
         ST    @15,KEYPVALU                                        1806
*                  KEYLVALU = KEYLNVAL;                    /*@Y30SSJH*/
*                                                                  1807
         L     @06,FDTPTR+224(,@06)                                1807
         L     @06,KEYLNVAL(,@06)                                  1807
         ST    @06,KEYLVALU                                        1807
*                  END;                                    /*@Y30SSJH*/
*                ELSE                                              1809
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1809
         B     @RC01804                                            1809
@RF01804 DS    0H                                                  1810
*                  KEYPVALU = AMDRKP;                      /*@Y30SSJH*/
         L     @06,LCAMDPT                                         1810
         LH    @15,AMDRKP(,@06)                                    1810
         ST    @15,KEYPVALU                                        1810
*                  KEYLVALU = AMDKEYLN;                    /*@Y30SSJH*/
*                                                                  1811
         LH    @06,AMDKEYLN(,@06)                                  1811
         ST    @06,KEYLVALU                                        1811
*                  END;                                    /*@Y30SSJH*/
*                                                                  1812
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* DETERMINE RECORDSIZE VALUE FOR VALIDITY    @Y30SSJH*/
*              /* CHECKING                                   @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1813
*              IF (ADDR(RECSZ)) ^= NULLPTR                         1813
*                THEN                                              1813
@RC01804 L     @06,@PC00001+4                                      1813
         L     @15,FDTPTR+232(,@06)                                1813
         LTR   @15,@15                                             1813
         BZ    @RF01813                                            1813
*                  MAXRECSZ = MRECVAL;                     /*@Y30SSJH*/
         L     @06,FDTPTR+240(,@06)                                1814
         L     @06,MRECVAL(,@06)                                   1814
         ST    @06,MAXRECSZ                                        1814
*                ELSE                                              1815
*                  MAXRECSZ = AMDLRECL;                    /*@Y30SSJH*/
*                                                                  1815
         B     @RC01813                                            1815
@RF01813 L     @06,LCAMDPT                                         1815
         L     @06,AMDLRECL(,@06)                                  1815
         ST    @06,MAXRECSZ                                        1815
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ENSURE NEW KEY AND RECORDSIZE VALUES ARE   @Y30SSJH*/
*              /* COMPATIBLE WITH MAXIMUM RECORDSIZE         @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1816
*              IF (KEYPVALU + KEYLVALU) > MAXRECSZ                 1816
*                THEN                                              1816
@RC01813 L     @06,KEYPVALU                                        1816
         AL    @06,KEYLVALU                                        1816
         C     @06,MAXRECSZ                                        1816
         BNH   @RF01816                                            1816
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1817
*                  KEYRECRC = 12;                          /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1818
*                  ALSTID = KEYVALER;                      /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01095                                  1819
*                  RETURN;                                 /*@Y30SSJH*/
*                                                                  1820
         B     @EL00005                                            1820
*                  END;                                    /*@Y30SSJH*/
*                                                                  1821
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ENSURE NEW VALUES ALLOW THE KEY TO BE      @Y30SSJH*/
*              /* CONTAINED IN A CONTROL INTERVAL            @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1822
*              IF AMDCINV < (KEYPVALU + KEYLVALU + DRHS)           1822
*                THEN                                              1822
@RF01816 L     @06,KEYPVALU                                        1822
         AL    @06,KEYLVALU                                        1822
         AH    @06,DRHS                                            1822
         L     @01,LCAMDPT                                         1822
         C     @06,AMDCINV(,@01)                                   1822
         BNH   @RF01822                                            1822
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1823
*                  KEYRECRC = 12;                          /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1824
*                  ALSTID = CINVERR;                       /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01086                                  1825
*                  RETURN;                                 /*@Y30SSJH*/
*                                                                  1826
         B     @EL00005                                            1826
*                  END;                                    /*@Y30SSJH*/
*                                                                  1827
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ENSURE THAT THERE NO CONTROL INTERVAL SIZE @Y30SSJH*/
*              /* CONFLICTS                                  @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1828
*              XVAL = IRHS + (2 * (KEYLVALU + 2)) + (3 * AMDCIPCA) 1828
*                          + DRHS;                         /*@Y30SSJH*/
@RF01822 LA    @06,2                                               1828
         AL    @06,KEYLVALU                                        1828
         ALR   @06,@06                                             1828
         AL    @06,@CF00311                                        1828
         L     @01,LCAMDPT                                         1828
         LH    @15,AMDCIPCA(,@01)                                  1828
         MH    @15,@CH00164                                        1828
         ALR   @06,@15                                             1828
         AH    @06,DRHS                                            1828
         ST    @06,XVAL                                            1828
*              SQRTSW = ON;                                /*@Y30SSJH*/
*                                                                  1829
         OI    SQRTSW,B'10000000'                                  1829
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* CALCULATE THE SQUARE ROOT OF THE NUMBER OF @Y30SSJH*/
*              /* THE NUMBER OF CI'S PER CA                  @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1830
*              DO SQRTINC = 1 BY 1 WHILE SQRTSW = ON;      /*@Y30SSJH*/
         LA    @06,1                                               1830
         ST    @06,SQRTINC                                         1830
         B     @DE01830                                            1830
@DL01830 DS    0H                                                  1831
*                IF AMDCIPCA / (SQRTINC * SQRTINC) = 0             1831
*                  THEN                                            1831
         L     @06,SQRTINC                                         1831
         LR    @01,@06                                             1831
         MR    @00,@06                                             1831
         L     @15,LCAMDPT                                         1831
         LH    @02,AMDCIPCA(,@15)                                  1831
         SRDA  @02,32                                              1831
         DR    @02,@01                                             1831
         LTR   @03,@03                                             1831
         BNZ   @RF01831                                            1831
*                    DO;                                   /*@Y30SSJH*/
*                                                                  1832
*                    SQRTVALU = SQRTINC - 1;               /*@Y30SSJH*/
         BCTR  @06,0                                               1833
         ST    @06,SQRTVALU                                        1833
*                    SQRTSW = OFF;                         /*@Y30SSJH*/
*                                                                  1834
         NI    SQRTSW,B'01111111'                                  1834
*                    END;                                  /*@Y30SSJH*/
*                  ELSE ;                                  /*@Y30SSJH*/
@RF01831 DS    0H                                                  1837
*              END;                                        /*@Y30SSJH*/
*                                                                  1837
         LA    @06,1                                               1837
         AL    @06,SQRTINC                                         1837
         ST    @06,SQRTINC                                         1837
@DE01830 TM    SQRTSW,B'10000000'                                  1837
         BO    @DL01830                                            1837
*              YVAL = IRHS + (8 * AMDCIPCA) + (2 * SQRTVALU) + DRHS;
         L     @06,LCAMDPT                                         1838
         LH    @06,AMDCIPCA(,@06)                                  1838
         SLA   @06,3                                               1838
         AL    @06,@CF00311                                        1838
         L     @15,SQRTVALU                                        1838
         ALR   @15,@15                                             1838
         ALR   @06,@15                                             1838
         AH    @06,DRHS                                            1838
         ST    @06,YVAL                                            1838
*              MAXVALU = MAX(XVAL,YVAL);                   /*@Y30SSJH*/
         L     @15,XVAL                                            1839
         CR    @15,@06                                             1839
         BNL   *+6
         LR    @15,@06                                             1839
         ST    @15,MAXVALU                                         1839
*              IF CTGFLPT(1) -> AMDCINV < MAXVALU                  1840
*                THEN                                              1840
         L     @06,CTGFLPTR                                        1840
         L     @06,CTGFLPT(,@06)                                   1840
         C     @15,AMDCINV(,@06)                                   1840
         BNH   @RF01840                                            1840
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1841
*                  KEYRECRC = 12;                          /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1842
*                  ALSTID = CINVERR;                       /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01086                                  1843
*                  RETURN;                                 /*@Y30SSJH*/
*                                                                  1844
         B     @EL00005                                            1844
*                  END;                                    /*@Y30SSJH*/
*             END INDXLOOP;                                /*@Y30SSJH*/
@RF01840 DS    0H                                                  1847
@RF01758 DS    0H                                                  1848
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* THIS ENDS PROCESSING FOR INDEXED CLUSTERS    @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1848
*                                                                  1848
*           /*********************************************************/
*           /*                                               @Y30SSJH*/
*           /* IF KEYS SPECIFIED FOR DATA OBJECT OF AN       @Y30SSJH*/
*           /* ALTERNATE INDEX, MORE VALIDITY CHECKING IS    @Y30SSJH*/
*           /* NEEDED                                        @Y30SSJH*/
*           /*                                               @Y30SSJH*/
*           /*********************************************************/
*                                                                  1848
*           IF CKTYPE = 'G'   &                                    1848
*              (ADDR(KEY)) ^= NULLPTR  &                           1848
*              KEYRECRC = 0                                        1848
*             THEN                                                 1848
@RF01724 CLI   CKTYPE,C'G'                                         1848
         BNE   @RF01848                                            1848
         SLR   @06,@06                                             1848
         L     @15,@PC00001+4                                      1848
         C     @06,FDTPTR+220(,@15)                                1848
         BE    @RF01848                                            1848
         C     @06,KEYRECRC                                        1848
         BNE   @RF01848                                            1848
*AIXKEYLP:      DO;                                        /*@Y30SSJH*/
*                                                                  1849
AIXKEYLP DS    0H                                                  1850
*               IF BDATACI ^= INITVALU                             1850
*                 THEN                                             1850
         CLC   BDATACI(3),INITVALU                                 1850
         BE    @RF01850                                            1850
*                   DO;                                    /*@Y30SSJH*/
*                                                                  1851
*                   CTGENT = ADDR(BDATACI);                /*@Y30SSJH*/
         LA    @06,BDATACI                                         1852
         L     @01,CTGPLPTR                                        1852
         ST    @06,CTGENT(,@01)                                    1852
*                   AMDSBWKA = ''B;                        /*@Y30SSJH*/
         XC    AMDSBWKA(140),AMDSBWKA                              1853
*                   AMDTOTLN = LENGTH(AMDSBWKA);           /*@Y30SSJH*/
         MVC   AMDTOTLN(2),@CH01673                                1854
*                   CTGFLNG(1) = NULLPTR;                  /*@Y30SSJH*/
         SLR   @06,@06                                             1855
         L     @15,CTGFLPTR                                        1855
         ST    @06,CTGFLNG(,@15)                                   1855
*                   CTGFLPT(1) = NULLPTR;                  /*@Y30SSJH*/
*                                                                  1856
         ST    @06,CTGFLPT(,@15)                                   1856
*                   /*************************************************/
*                   /*                                       @Y30SSJH*/
*                   /* ISSUE THE CATALOG LOCATE REQUEST      @Y30SSJH*/
*                   /*                                       @Y30SSJH*/
*                   /*************************************************/
*                                                                  1857
*                   CALL IDCSACA0 (GDTTBL,CTGPLPTR);       /*@Y30SSJH*/
*                                                                  1857
         L     @06,@PC00001                                        1857
         ST    @06,@AL00001                                        1857
         LA    @15,CTGPLPTR                                        1857
         ST    @15,@AL00001+4                                      1857
         L     @15,GDTCAT(,@06)                                    1857
         LA    @01,@AL00001                                        1857
         BALR  @14,@15                                             1857
*                   RESPECIFY (RTNREG) RSTD;               /*@Y30SSJH*/
*                   CTGRTNCC = RTNREG;                     /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     1859
*                   RESPECIFY (RTNREG) UNRSTD;             /*@Y30SSJH*/
*                                                                  1860
*                   IF GDTDBG = NULLPTR                            1861
*                     THEN;                                        1861
         L     @06,@PC00001                                        1861
         L     @06,GDTDBG(,@06)                                    1861
         LTR   @06,@06                                             1861
         BZ    @RT01861                                            1861
*                     ELSE                                         1863
*                       CALL IDCDB010 (GDTTBL,'AL54');             1863
         L     @06,@PC00001                                        1863
         ST    @06,@AL00001                                        1863
         LA    @15,@CC01561                                        1863
         ST    @15,@AL00001+4                                      1863
         MVI   @AL00001+4,X'80'                                    1863
         L     @15,GDTDBG(,@06)                                    1863
         LA    @01,@AL00001                                        1863
         BALR  @14,@15                                             1863
*                                                          /*@Y30SSJH*/
*                                                                  1864
*                   IF CTGRTNCC ^= 0                               1864
*                     THEN                                         1864
@RT01861 L     @06,CTGRTNCC                                        1864
         LTR   @06,@06                                             1864
         BZ    @RF01864                                            1864
*                       DO;                                /*@Y30SSJH*/
*                                                                  1865
*                       KEYRECRC = 12;                     /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1866
*                       ALSTID = CATERROR;                 /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  1867
*                       RETURN;                            /*@Y30SSJH*/
*                                                                  1868
         B     @EL00005                                            1868
*                       END;                               /*@Y30SSJH*/
*                                                                  1870
*                   /*************************************************/
*                   /*                                       @Y30SSJH*/
*                   /* ENSURE THAT THE AMDSB WAS SUCCESSFULLY        */
*                   /* LOCATED                               @Y30SSJH*/
*                   /*                                       @Y30SSJH*/
*                   /*************************************************/
*                                                                  1870
*                   IF CTGFLNG(1) = NULLPTR  ×                     1870
*                      CTGFLPT(1) -> IDAAMDSB = NULLMASK           1870
*                     THEN                                         1870
@RF01864 L     @06,CTGFLPTR                                        1870
         L     @15,CTGFLNG(,@06)                                   1870
         LTR   @15,@15                                             1870
         BZ    @RT01870                                            1870
         L     @06,CTGFLPT(,@06)                                   1870
         CLC   IDAAMDSB(8,@06),NULLMASK                            1870
         BNE   @RF01870                                            1870
@RT01870 DS    0H                                                  1871
*                       DO;                                /*@Y30SSJH*/
*                                                                  1871
*                       KEYRECRC = 12;                     /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1872
*                       ALSTID = LOCRTNER;                 /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1873
*                       RETURN;                            /*@Y30SSJH*/
*                                                                  1874
         B     @EL00005                                            1874
*                       END;                               /*@Y30SSJH*/
*                   END;                                   /*@Y30SSJH*/
*                 /***************************************************/
*                 /*                                         @Y30SSJH*/
*                 /* THE BASE CLUSTER MUST BE LOCATED IN     @Y30SSJH*/
*                 /* ORDER TO RETRIEVE ITS DATA ASSOCIATION  @Y30SSJH*/
*                 /*                                         @Y30SSJH*/
*                 /***************************************************/
*                                                                  1877
*                 ELSE                                             1877
*                   IF BCLUSCI = INITVALU                          1877
*                     THEN                                         1877
         B     @RC01850                                            1877
@RF01850 CLC   BCLUSCI(3),INITVALU                                 1877
         BNE   @RF01877                                            1877
*                       DO;                                /*@Y30SSJH*/
*                                                                  1878
*                       KEYRECRC = 12;                     /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1879
*                       ALSTID = LOCRTNER;                 /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1880
*                       RETURN;                            /*@Y30SSJH*/
*                                                                  1881
         B     @EL00005                                            1881
*                       END;                               /*@Y30SSJH*/
*                    ELSE                                          1883
*                      DO;                                 /*@Y30SSJH*/
*                                                                  1883
@RF01877 DS    0H                                                  1884
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /*  RESET THE CPL AND FPL             @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1884
*                      CTGENT = ADDR(BCLUSCI);             /*@Y30SSJH*/
         L     @06,CTGPLPTR                                        1884
         LA    @15,BCLUSCI                                         1884
         ST    @15,CTGENT(,@06)                                    1884
*                      CTGBYPSS = ON;                      /*@Y30SSJH*/
         OI    CTGBYPSS(@06),B'10000000'                           1885
*                      ASSOCWKA = ''B;                     /*@Y30SSJH*/
         XC    ASSOCWKA(32),ASSOCWKA                               1886
*                      CTGWKA = ADDR(ASSOCWKA);            /*@Y30SSJH*/
         LA    @15,ASSOCWKA                                        1887
         ST    @15,CTGWKA(,@06)                                    1887
*                      ASSTOTLN = LENGTH(ASSOCWKA);        /*@Y30SSJH*/
*                                                                  1888
         MVC   ASSTOTLN(2),@CH00222                                1888
*                      CTGFLPTR = ADDR(ALFPLNAM);          /*@Y30SSJH*/
         L     @15,ALPRMPTR                                        1889
         LA    @14,ALFPLNAM(,@15)                                  1889
         ST    @14,CTGFLPTR                                        1889
*                      ALFPLNAM = ''B;                     /*@Y30SSJH*/
         XC    ALFPLNAM(16,@15),ALFPLNAM(@15)                      1890
*                      CTGFLNG(1) = NULLPTR;               /*@Y30SSJH*/
         SLR   @05,@05                                             1891
         ST    @05,CTGFLNG(,@14)                                   1891
*                      CTGFLPT(1) = NULLPTR;               /*@Y30SSJH*/
         ST    @05,CTGFLPT(,@14)                                   1892
*                      CTGFIELD(1) = CTGFLPTR;             /*@Y30SSJH*/
         ST    @14,CTGFIELD(,@06)                                  1893
*                      CTGFLDNO = 1;                       /*@Y30SSJH*/
         MVI   CTGFLDNO(@14),X'01'                                 1894
*                      CTGFLDNM = ADDR(ALFLDNAM(3));       /*@Y30SSJH*/
*                                                                  1895
         LA    @06,ALFLDNAM+16                                     1895
         ST    @06,CTGFLDNM(,@14)                                  1895
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /*INITIALIZE NAMEDS TEST FPL AND      @Y30SSJH*/
*                      /* REFERENCE IT IN THE NAMEDS FPL - THIS      */
*                      /* LIMITS THE NUMBER THE NUMBER OF    @Y30SSJH*/
*                      /* ASSOCIATIONS RETURNED TO FIVE      @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1896
*                      CTGFLPTR = ADDR(ALFPLTST);          /*@Y30SSJH*/
         LA    @06,ALFPLTST(,@15)                                  1896
         ST    @06,CTGFLPTR                                        1896
*                      ALFPLTST = ''B;                     /*@Y30SSJH*/
         XC    ALFPLTST(16,@15),ALFPLTST(@15)                      1897
*                      CTGFLDNO = 1;                       /*@Y30SSJH*/
         MVI   CTGFLDNO(@06),X'01'                                 1898
*                      CTGFLDCD = CTGFLDLE;                /*@Y30SSJH*/
         MVI   CTGFLDCD(@06),X'C0'                                 1899
*                      CTGFLDNM = ADDR(ALFLDNAM(16));      /*@Y30SSJH*/
         LA    @14,ALFLDNAM+120                                    1900
         ST    @14,CTGFLDNM(,@06)                                  1900
*                      CTGFLNG(1) = 2;                     /*@Y30SSJH*/
         MVC   CTGFLNG(4,@06),@CF00155                             1901
*                      CTGFLPT(1) = ADDR(NAMEMASK);        /*@Y30SSJH*/
         LA    @14,NAMEMASK                                        1902
         ST    @14,CTGFLPT(,@06)                                   1902
*                      CTGFLPTR = ADDR(ALFPLNAM);          /*@Y30SSJH*/
         LA    @06,ALFPLNAM(,@15)                                  1903
         ST    @06,CTGFLPTR                                        1903
*                      CTGFLCHN = ADDR(ALFPLTST);          /*@Y30SSJH*/
*                                                                  1904
         LA    @15,ALFPLTST(,@15)                                  1904
         ST    @15,CTGFLCHN(,@06)                                  1904
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /* ISSUE THE CATALOG LOCATE REQUEST   @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1905
*                      CALL IDCSACA0 (GDTTBL,CTGPLPTR);    /*@Y30SSJH*/
*                                                                  1905
         L     @06,@PC00001                                        1905
         ST    @06,@AL00001                                        1905
         LA    @15,CTGPLPTR                                        1905
         ST    @15,@AL00001+4                                      1905
         L     @15,GDTCAT(,@06)                                    1905
         LA    @01,@AL00001                                        1905
         BALR  @14,@15                                             1905
*                      RESPECIFY (RTNREG) RSTD;            /*@Y30SSJH*/
*                      CTGRTNCC = RTNREG;                  /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     1907
*                      RESPECIFY (RTNREG) UNRSTD;          /*@Y30SSJH*/
*                                                                  1908
*                      IF GDTDBG = NULLPTR                         1909
*                        THEN;                                     1909
         L     @06,@PC00001                                        1909
         L     @06,GDTDBG(,@06)                                    1909
         LTR   @06,@06                                             1909
         BZ    @RT01909                                            1909
*                        ELSE                                      1911
*                          CALL IDCDB010(GDTTBL,'AL55');           1911
         L     @06,@PC00001                                        1911
         ST    @06,@AL00001                                        1911
         LA    @15,@CC01562                                        1911
         ST    @15,@AL00001+4                                      1911
         MVI   @AL00001+4,X'80'                                    1911
         L     @15,GDTDBG(,@06)                                    1911
         LA    @01,@AL00001                                        1911
         BALR  @14,@15                                             1911
*                                                          /*@Y30SSJH*/
*                                                                  1912
*                      IF CTGRTNCC ^= 0                            1912
*                        THEN                                      1912
@RT01909 L     @06,CTGRTNCC                                        1912
         LTR   @06,@06                                             1912
         BZ    @RF01912                                            1912
*                          DO;                             /*@Y30SSJH*/
*                                                                  1913
*                          KEYRECRC = 12;                  /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1914
*                          ALSTID = CATERROR;              /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  1915
*                          RETURN;                         /*@Y30SSJH*/
*                                                                  1916
         B     @EL00005                                            1916
*                          END;                            /*@Y30SSJH*/
*                                                                  1917
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /* PICK UP DATA ASSOCIATION           @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1918
*                      CTGFLPTR = ADDR(ALFPLNAM);          /*@Y30SSJH*/
@RF01912 L     @06,ALPRMPTR                                        1918
         LA    @06,ALFPLNAM(,@06)                                  1918
         ST    @06,CTGFLPTR                                        1918
*                      IF CTGFLNG(1) ^= NULLPTR  &                 1919
*                         CTGFLPT(1) -> LCNAMEDS(1,1:4) ^=         1919
*                            NULLMASK(1:4)  &                      1919
*                         CTGFLPT(1) -> LCNAMID(1) = 'D'           1919
*                        THEN                                      1919
         L     @15,CTGFLNG(,@06)                                   1919
         LTR   @15,@15                                             1919
         BZ    @RF01919                                            1919
         L     @06,CTGFLPT(,@06)                                   1919
         CLC   LCNAMEDS(4,@06),NULLMASK                            1919
         BE    @RF01919                                            1919
         CLI   LCNAMID(@06),C'D'                                   1919
         BNE   @RF01919                                            1919
*                          BDATACI = CTGFLPT(1) -> LCNAMCI(1);     1920
         MVC   BDATACI(3),LCNAMCI(@06)                             1920
*                        ELSE                                      1921
*                          DO;                             /*@Y30SSJH*/
*                                                                  1921
         B     @RC01919                                            1921
@RF01919 DS    0H                                                  1922
*                          KEYRECRC = 12;                  /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1922
*                          ALSTID = LOCRTNER;              /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1923
*                          RETURN;                         /*@Y30SSJH*/
*                                                                  1924
         B     @EL00005                                            1924
*                          END;                            /*@Y30SSJH*/
*                                                                  1925
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /* RESET CPL AND FPL TO LOCATE AMDSB  @Y30SSJH*/
*                      /* OF DATA OBJECT                     @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1926
*                      CTGENT = ADDR(BDATACI);             /*@Y30SSJH*/
@RC01919 L     @06,CTGPLPTR                                        1926
         LA    @15,BDATACI                                         1926
         ST    @15,CTGENT(,@06)                                    1926
*                      CTGWKA = ADDR(AMDSBWKA);            /*@Y30SSJH*/
         LA    @15,AMDSBWKA                                        1927
         ST    @15,CTGWKA(,@06)                                    1927
*                      AMDSBWKA = ''B;                     /*@Y30SSJH*/
         XC    AMDSBWKA(140),AMDSBWKA                              1928
*                      AMDTOTLN = LENGTH(AMDSBWKA);        /*@Y30SSJH*/
         MVC   AMDTOTLN(2),@CH01673                                1929
*                      CTGFLPTR = ADDR(ALFPLAMD);          /*@Y30SSJH*/
         L     @15,ALPRMPTR                                        1930
         LA    @14,ALFPLAMD(,@15)                                  1930
         ST    @14,CTGFLPTR                                        1930
*                      ALFPLAMD = ''B;                     /*@Y30SSJH*/
         XC    ALFPLAMD(16,@15),ALFPLAMD(@15)                      1931
*                      CTGFLNG(1) = NULLPTR;               /*@Y30SSJH*/
         SLR   @15,@15                                             1932
         ST    @15,CTGFLNG(,@14)                                   1932
*                      CTGFLPT(1) = NULLPTR;               /*@Y30SSJH*/
         ST    @15,CTGFLPT(,@14)                                   1933
*                      CTGFIELD(1) = CTGFLPTR;             /*@Y30SSJH*/
         ST    @14,CTGFIELD(,@06)                                  1934
*                      CTGFLDNO = 1;                       /*@Y30SSJH*/
         MVI   CTGFLDNO(@14),X'01'                                 1935
*                      CTGFLDNM = ADDR(ALFLDNAM(8));       /*@Y30SSJH*/
*                                                                  1936
         LA    @06,ALFLDNAM+56                                     1936
         ST    @06,CTGFLDNM(,@14)                                  1936
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /* ISSUE THE CATALOG LOCATE REQUEST   @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                      CALL IDCSACA0(GDTTBL,CTGPLPTR);     /*@Y30SSJH*/
*                                                                  1937
         L     @06,@PC00001                                        1937
         ST    @06,@AL00001                                        1937
         LA    @15,CTGPLPTR                                        1937
         ST    @15,@AL00001+4                                      1937
         L     @15,GDTCAT(,@06)                                    1937
         LA    @01,@AL00001                                        1937
         BALR  @14,@15                                             1937
*                      RESPECIFY (RTNREG) RSTD;            /*@Y30SSJH*/
*                      CTGRTNCC = RTNREG;                  /*@Y30SSJH*/
         ST    RTNREG,CTGRTNCC                                     1939
*                      RESPECIFY (RTNREG) UNRSTD;          /*@Y30SSJH*/
*                                                                  1940
*                      IF GDTDBG = NULLPTR                         1941
*                        THEN;                                     1941
         L     @06,@PC00001                                        1941
         L     @06,GDTDBG(,@06)                                    1941
         LTR   @06,@06                                             1941
         BZ    @RT01941                                            1941
*                        ELSE                                      1943
*                          CALL IDCDB010 (GDTTBL,'AL56');          1943
         L     @06,@PC00001                                        1943
         ST    @06,@AL00001                                        1943
         LA    @15,@CC01563                                        1943
         ST    @15,@AL00001+4                                      1943
         MVI   @AL00001+4,X'80'                                    1943
         L     @15,GDTDBG(,@06)                                    1943
         LA    @01,@AL00001                                        1943
         BALR  @14,@15                                             1943
*                                                          /*@Y30SSJH*/
*                      IF CTGRTNCC ^= 0                            1944
*                        THEN                                      1944
@RT01941 L     @06,CTGRTNCC                                        1944
         LTR   @06,@06                                             1944
         BZ    @RF01944                                            1944
*                          DO;                             /*@Y30SSJH*/
*                                                                  1945
*                          KEYRECRC = 12;                  /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1946
*                          ALSTID = CATERROR;              /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01016                                  1947
*                          RETURN;                         /*@Y30SSJH*/
*                                                                  1948
         B     @EL00005                                            1948
*                          END;                            /*@Y30SSJH*/
*                                                                  1949
*                      /**********************************************/
*                      /*                                    @Y30SSJH*/
*                      /* ENSURE THAT THE AMDSB WAS SUCCESSFULLY     */
*                      /* LOCATED                            @Y30SSJH*/
*                      /*                                    @Y30SSJH*/
*                      /**********************************************/
*                                                                  1950
*                      IF CTGFLNG(1) = NULLPTR  ×                  1950
*                         CTGFLPT(1) -> IDAAMDSB = NULLMASK        1950
*                        THEN                                      1950
@RF01944 L     @06,CTGFLPTR                                        1950
         L     @15,CTGFLNG(,@06)                                   1950
         LTR   @15,@15                                             1950
         BZ    @RT01950                                            1950
         L     @06,CTGFLPT(,@06)                                   1950
         CLC   IDAAMDSB(8,@06),NULLMASK                            1950
         BNE   @RF01950                                            1950
@RT01950 DS    0H                                                  1951
*                          DO;                             /*@Y30SSJH*/
*                                                                  1951
*                          KEYRECRC = 12;                  /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1952
*                          ALSTID = LOCRTNER;              /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01025                                  1953
*                          RETURN;                         /*@Y30SSJH*/
*                                                                  1954
         B     @EL00005                                            1954
*                          END;                            /*@Y30SSJH*/
*                      END;                                /*@Y30SSJH*/
*                                                                  1956
@RF01950 DS    0H                                                  1957
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ENSURE NEW KEY VALUES FOR THE ALTERNATE INDEX      */
*              /* DO NOT CONFLICT WITH THE BASE CLUSTER'S    @Y30SSJH*/
*              /* RECORDSIZE OR CONTROL INTERVAL SIZE        @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1957
*              IF KEYPSVAL + KEYLNVAL > CTGFLPT(1) -> AMDLRECL     1957
*                THEN                                              1957
@RC01850 L     @06,@PC00001+4                                      1957
         L     @01,FDTPTR+228(,@06)                                1957
         L     @06,FDTPTR+224(,@06)                                1957
         L     @15,KEYPSVAL(,@01)                                  1957
         AL    @15,KEYLNVAL(,@06)                                  1957
         L     @06,CTGFLPTR                                        1957
         L     @06,CTGFLPT(,@06)                                   1957
         C     @15,AMDLRECL(,@06)                                  1957
         BNH   @RF01957                                            1957
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1958
*                  KEYRECRC = 12;                          /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1959
*                  ALSTID = AIXCLSER;                      /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01089                                  1960
*                  RETURN;                                 /*@Y30SSJH*/
*                                                                  1961
         B     @EL00005                                            1961
*                  END;                                    /*@Y30SSJH*/
*                                                                  1962
*              IF CTGFLPT(1) -> AMDSPAN = ON                       1963
*                THEN                                              1963
@RF01957 L     @06,CTGFLPTR                                        1963
         L     @06,CTGFLPT(,@06)                                   1963
         TM    AMDSPAN(@06),B'00000001'                            1963
         BNO   @RF01963                                            1963
*                  IF KEYPSVAL + KEYLNVAL > CTGFLPT(1) -> AMDCINV  1964
*                                         - SPDRHS                 1964
*                    THEN                                          1964
         L     @15,@PC00001+4                                      1964
         L     @01,FDTPTR+228(,@15)                                1964
         L     @15,FDTPTR+224(,@15)                                1964
         L     @14,KEYPSVAL(,@01)                                  1964
         AL    @14,KEYLNVAL(,@15)                                  1964
         L     @06,AMDCINV(,@06)                                   1964
         SL    @06,@CF00037                                        1964
         CR    @14,@06                                             1964
         BNH   @RF01964                                            1964
*                      DO;                                 /*@Y30SSJH*/
*                                                                  1965
*                      KEYRECRC = 12;                      /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00035                                1966
*                      ALSTID = AIXCLSER;                  /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01089                                  1967
*                      RETURN;                             /*@Y30SSJH*/
*                                                                  1968
         B     @EL00005                                            1968
*                      END;                                /*@Y30SSJH*/
*                                                                  1969
*              END AIXKEYLP;                               /*@Y30SSJH*/
*                                                                  1970
@RF01964 DS    0H                                                  1970
@RF01963 DS    0H                                                  1971
*                                                                  1971
*          IF (ADDR(KEY)) ^= NULLPTR    &                          1971
*             KEYRECRC = 0                                         1971
*            THEN                                                  1971
@RF01848 SLR   @06,@06                                             1971
         L     @15,@PC00001+4                                      1971
         C     @06,FDTPTR+220(,@15)                                1971
         BE    @RF01971                                            1971
         C     @06,KEYRECRC                                        1971
         BNE   @RF01971                                            1971
*              DO;                                         /*@Y30SSJH*/
*                                                                  1972
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* DETERMINE OLD KEY POSITION                 @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  1973
*              IF CKTYPE = 'G'                                     1973
*                THEN                                              1973
         CLI   CKTYPE,C'G'                                         1973
         BNE   @RF01973                                            1973
*                  KYPOSIT = AMDAXRKP;                     /*@Y30SSJH*/
         L     @06,LCAMDPT                                         1974
         LH    @06,AMDAXRKP(,@06)                                  1974
         ST    @06,KYPOSIT                                         1974
*                ELSE                                              1975
*                  KYPOSIT = AMDRKP;                       /*@Y30SSJH*/
*                                                                  1975
         B     @RC01973                                            1975
@RF01973 L     @06,LCAMDPT                                         1975
         LH    @06,AMDRKP(,@06)                                    1975
         ST    @06,KYPOSIT                                         1975
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ENSURE PREVIOUS KEY VALUES ARE NOT         @Y30SSJH*/
*              /* EQUAL TO NEW VALUES                        @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************** @Y30SSJH*/
*                                                                  1976
*              IF KYPOSIT = KEYPSVAL  &                            1976
*                 AMDKEYLN = KEYLNVAL                              1976
*                THEN                                              1976
@RC01973 L     @06,KYPOSIT                                         1976
         L     @15,@PC00001+4                                      1976
         L     @01,FDTPTR+228(,@15)                                1976
         C     @06,KEYPSVAL(,@01)                                  1976
         BNE   @RF01976                                            1976
         L     @01,LCAMDPT                                         1976
         LH    @14,AMDKEYLN(,@01)                                  1976
         L     @15,FDTPTR+224(,@15)                                1976
         C     @14,KEYLNVAL(,@15)                                  1976
         BNE   @RF01976                                            1976
*                  DO;                                     /*@Y30SSJH*/
*                                                                  1977
*                  IF KYPOSIT = KEYPSDEF   &                       1978
*                     AMDKEYLN = KEYLNDEF                          1978
*                    THEN                                          1978
         LTR   @06,@06                                             1978
         BNZ   @RF01978                                            1978
         C     @14,@CF00756                                        1978
         BNE   @RF01978                                            1978
*                      KEYRECRC = 4;                       /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00044                                1979
*                    ELSE                                          1980
*                      KEYRECRC = 5;                       /*@Y30SSJH*/
*                                                                  1980
         B     @RC01978                                            1980
@RF01978 MVC   KEYRECRC(4),@CF00287                                1980
*                  END;                                    /*@Y30SSJH*/
*                ELSE                                              1982
*                  IF KYPOSIT = KEYPSDEF  &                        1982
*                     AMDKEYLN = KEYLNDEF                          1982
*                    THEN                                          1982
         B     @RC01976                                            1982
@RF01976 L     @06,KYPOSIT                                         1982
         LTR   @06,@06                                             1982
         BNZ   @RF01982                                            1982
         L     @06,LCAMDPT                                         1982
         CLC   AMDKEYLN(2,@06),@CH00756                            1982
         BE    @RT01982                                            1982
*                      ;                                   /*@Y30SSJH*/
*                    ELSE                                          1984
*                      DO;                                 /*@Y30SSJH*/
*                                                                  1984
@RF01982 DS    0H                                                  1985
*                      KEYRECRC = 8;                       /*@Y30SSJH*/
         MVC   KEYRECRC(4),@CF00039                                1985
*                      ALSTID = NEWVALER;                  /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01092                                  1986
*                      RETURN;                             /*@Y30SSJH*/
*                                                                  1987
         B     @EL00005                                            1987
*                      END;                                /*@Y30SSJH*/
*               END;                                       /*@Y30SSJH*/
@RT01982 DS    0H                                                  1989
@RC01976 DS    0H                                                  1990
*          END KEYRECLP;                                   /*@Y30SSJH*/
@RF01971 DS    0H                                                  1991
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VERIFICATION OF THE UNIQUEKEY PARAMETER -        @Y30SSJH*/
*        /* VERIFICATION TAKES PLACE AGAINST THE DATA OBJECT @Y30SSJH*/
*        /* LOCATED ON EITHER THE PRIMARY LOCATE OR, IF KEYS @Y30SSJH*/
*        /* AND/OR RECORDSIZE WAS SPECIFIED, THE SECONDARY   @Y30SSJH*/
*        /* LOCATE PERFORMED DURING THE VERIFICATION OF      @Y30SSJH*/
*        /* THOSE PARAMETERS                                 @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  1991
*        IF (ADDR(UNQK)) ^= NULLPTR                                1991
*          THEN                                                    1991
@RF01532 L     @06,@PC00001+4                                      1991
         L     @06,FDTPTR+244(,@06)                                1991
         LTR   @06,@06                                             1991
         BZ    @RF01991                                            1991
*UNQKLOOP:   DO;                                           /*@Y30SSJH*/
*                                                                  1992
UNQKLOOP DS    0H                                                  1993
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* VERIFY THAT THE DATA OBJECT IS OF AN AIX     @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1993
*            IF LCNAMID(1) ^= 'G'                                  1993
*              THEN                                                1993
         L     @06,LCNAMPT                                         1993
         CLI   LCNAMID(@06),C'G'                                   1993
         BE    @RF01993                                            1993
*                DO;                                       /*@Y30SSJH*/
*                                                                  1994
*                ALSTID = INVAIXER;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01028                                  1995
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  1996
         B     @EL00005                                            1996
*                END;                                      /*@Y30SSJH*/
*                                                                  1997
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* IF THE ATTRIBUTE WAS PREVIOUSLY NONUNIQUEKEY @Y30SSJH*/
*            /* PROCEED WITH VERIFICATION                    @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  1998
*            IF AMDUNQ = ON                                        1998
*              THEN                                                1998
@RF01993 L     @06,LCAMDPT                                         1998
         TM    AMDUNQ(@06),B'10000000'                             1998
         BNO   @RF01998                                            1998
*UNQKVERF:       DO;                                       /*@Y30SSJH*/
*                                                                  1999
UNQKVERF DS    0H                                                  2000
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* VERIFY THAT THE HIGH-USED RBA OF THIS    @Y30SSJH*/
*                /* DATA OBJECT IS ZERO                      @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  2000
*                IF LCRBAPT = NULLPTR ×                            2000
*                   LCHURBA ^= '00000000'X                         2000
*                  THEN                                            2000
         L     @06,LCRBAPT                                         2000
         LTR   @06,@06                                             2000
         BZ    @RT02000                                            2000
         CLC   LCHURBA(4,@06),@CB01568                             2000
         BE    @RF02000                                            2000
@RT02000 DS    0H                                                  2001
*                    DO;                                   /*@Y30SSJH*/
*                                                                  2001
*                    ALSTID = UNQUPGER;                    /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01031                                  2002
*                    RETURN;                               /*@Y30SSJH*/
*                                                                  2003
         B     @EL00005                                            2003
*                    END;                                  /*@Y30SSJH*/
*                                                                  2004
*                END UNQKVERF;                             /*@Y30SSJH*/
*                                                                  2005
*            END UNQKLOOP;                                 /*@Y30SSJH*/
*                                                                  2006
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* CHECKPRC PROCESSING IS COMPLETE - RETURN         @Y30SSJH*/
*        /* TO INVOKER                                       @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2007
*        RETURN;                                           /*@Y30SSJH*/
*                                                                  2007
         B     @EL00005                                            2007
*END CHECKPRC;                                             /*@Y30SSJH*/
         B     @EL00005                                            2008
*/********************************************************************/
*/*                                                          @Y30SSJH*/
*/* PROCEDURE NAME - INDEXPRC                                @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* FUNCTION - INDEXPRC IS NEW FOR RELEASE 2 OF VSAM. ITS    @Y30SSJH*/
*/*            PURPOSE IS TO ALTER THE INDEX AMDSB KEY       @Y30SSJH*/
*/*            VALUES. THE CORRESPONDING DATA                @Y30SSJH*/
*/*            AMDSB IS ALTERED IN AL01.                     @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            THIS PROCEDURE IS INVOKED ONLY IF             @Y30SSJH*/
*/*            KEYS IS SPECIFIED FOR A KEY                   @Y30SSJH*/
*/*            SEQUENCED CLUSTER OR AN ALTERNATE INDEX.      @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*            THE CPL-FVT-FPL COMPLEX IS CONSTRUCTED TO     @Y30SSJH*/
*/*            COMMUNICATE THE ALTER REQUEST.                @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* INPUT -                                                  @Y30SSJH*/
*/*         INDEXPRC USES THE INDEX CONTROL INTERVAL NUMBER  @Y30SSJH*/
*/*         (INDEXCI),AND THE INDEX AMDSB LOCATED IN         @Y30SSJH*/
*/*         CHECKPRC (IXAMDSB).                              @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* OUTPUT -                                                 @Y30SSJH*/
*/*          ALSTID - THE GLOBAL INTERNAL STATUS COMMUNICATOR        */
*/*          IS SET ON ERROR DETECTION.                      @Y30SSJH*/
*/*          CREATION OF THE CATALOG PARAMETER LIST TO       @Y30SSJH*/
*/*          COMMUNICATE THE ALTER REQUEST.                  @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/********************************************************************/
*                                                                  2009
*INDEXPRC:                                                         2009
*        PROCEDURE;                                        /*@Y30SSJH*/
INDEXPRC STM   @14,@12,@SA00006                                    2009
*                                                                  2010
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* CPL-FVT-FPL COMPLEX USED IN INDEX ALTER          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2010
*        DCL                                                       2010
*          1 IXCTGPRM   BASED(IXPRMPTR),                           2010
*            2 IXCPLID  CHAR(8),                                   2010
*            2 IXCTGPL  CHAR(LENGTH(CTGPL) + 32),                  2010
*            2 IXFVTID  CHAR(4),                                   2010
*            2 IXCTGFVT CHAR(LENGTH(CTGFV) + 8),           /*@Y30SSJH*/
*            2 IXAMD    CHAR(4),                                   2010
*            2 IXFPLAMD CHAR(LENGTH(CTGFL) + 8),                   2010
*                                                                  2010
*            2 IXWKAREA CHAR(4);                           /*@Y30SSJH*/
*                                                                  2010
*        DCL                                                       2011
*          IXPRMPTR PTR(31);                               /*@Y30SSJH*/
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ENTRY POINT TO INDEXPRC                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2012
*        OLDERID2 = NEWERID2;                                      2012
         L     @06,@PC00001                                        2012
         L     @15,GDTTR2(,@06)                                    2012
         MVC   @TS00001(95),NEWERID2(@15)                          2012
         MVC   OLDERID2(95,@15),@TS00001                           2012
*        NEWID2 = 'AL61';                                  /*@Y30SSJH*/
*                                                                  2013
         MVC   NEWID2(4,@15),@CC01581                              2013
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* GET DYNAMIC STORAGE FOR THE PARAMETER LISTS WHICH        */
*        /* COMPRISE THE CPL-FVT-FPL COMPLEX                 @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2014
*        CALL IDCSAGP0(GDTTBL,                                     2014
*               (LENGTH(IXCTGPRM)),    /* LENGTH OF STORAGE REQUEST  */
*               IXPRMPTR,              /* ADDRESS OF DYNAMIC STORAGE */
*               ALGPID,                /* UGPOOL ID          @Y30SSJH*/
*                SETZERO);             /* SET AREA TO ZERO   @Y30SSJH*/
*                                                                  2014
         ST    @06,@AL00001                                        2014
         LA    @15,204                                             2014
         ST    @15,@AFTEMPS+4                                      2014
         LA    @15,@AFTEMPS+4                                      2014
         ST    @15,@AL00001+4                                      2014
         LA    @15,IXPRMPTR                                        2014
         ST    @15,@AL00001+8                                      2014
         LA    @15,ALGPID                                          2014
         ST    @15,@AL00001+12                                     2014
         LA    @15,SETZERO                                         2014
         ST    @15,@AL00001+16                                     2014
         MVI   @AL00001+16,X'80'                                   2014
         L     @15,GDTGPL(,@06)                                    2014
         LA    @01,@AL00001                                        2014
         BALR  @14,@15                                             2014
*        RESPECIFY RTNREG RSTD;                                    2015
*        TESTRC = RTNREG;                                          2016
         STH   RTNREG,TESTRC                                       2016
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSJH*/
*                                                                  2017
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* STORAGE NOT AVAILABLE - TERMINAL ERROR           @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2018
*        IF TESTRC ^= 0                                            2018
*          THEN                                                    2018
         LH    @06,TESTRC                                          2018
         LTR   @06,@06                                             2018
         BZ    @RF02018                                            2018
*            ALSTID = NOSTORAG;                            /*@Y30SSJH*/
*                                                                  2019
         MVC   ALSTID(5),@CB01039                                  2019
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* PRELIMINARY INITIALIZATION                       @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2020
*        IXCPLID = 'IXCPL';                                /*@Y30SSJH*/
@RF02018 L     @06,IXPRMPTR                                        2020
         MVI   IXCPLID+5(@06),C' '                                 2020
         MVC   IXCPLID+6(2,@06),IXCPLID+5(@06)                     2020
         MVC   IXCPLID(5,@06),@CC01582                             2020
*        IXFVTID = 'IFVT';                                 /*@Y30SSJH*/
         MVC   IXFVTID(4,@06),@CC01583                             2021
*        IXAMD = 'AMDB';                                   /*@Y30SSJH*/
         MVC   IXAMD(4,@06),@CC01450                               2022
*        CPLSAVE = IXPRMPTR + 8;                           /*@Y30SSJH*/
*                                                                  2023
         LA    @15,8                                               2023
         ALR   @15,@06                                             2023
         ST    @15,CPLSAVE                                         2023
*        RFY CTGPL BASED(CPLSAVE);                         /*@Y30SSJH*/
*        CTGFLPTR = ADDR(IXFPLAMD);                        /*@Y30SSJH*/
*                                                                  2025
         LA    @14,IXFPLAMD(,@06)                                  2025
         ST    @14,CTGFLPTR                                        2025
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE CPL FOR ALTER REQUEST                 @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2026
*        CTGFUNC = CTGCMS;                                 /*@Y30SSJH*/
         NI    CTGFUNC(@15),B'10011111'                            2026
         OI    CTGFUNC(@15),B'10000000'                            2026
*        CTGFVT = ADDR(IXCTGFVT);                          /*@Y30SSJH*/
         LA    @14,IXCTGFVT(,@06)                                  2027
         ST    @14,CTGFVT(,@15)                                    2027
*        CTGBYPSS = ON;                                    /*@Y30SSJH*/
         OI    CTGBYPSS(@15),B'10000000'                           2028
*        CTGAM0 = ON;                                      /*@Y30SSJH*/
         OI    CTGAM0(@15),B'00000001'                             2029
*        CTGWKA = ADDR(IXWKAREA);                          /*@Y30SSJH*/
         LA    @06,IXWKAREA(,@06)                                  2030
         ST    @06,CTGWKA(,@15)                                    2030
*        CTGOPTNS = CTGALTER;                              /*@Y30SSJH*/
         NI    CTGOPTNS(@15),B'00010111'                           2031
         OI    CTGOPTNS(@15),B'00010000'                           2031
*        CTGCNAME = ON;                                    /*@Y30SSJH*/
         OI    CTGCNAME(@15),B'00000010'                           2032
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* SET CPL REFERENCE TO CATALOG IN WHICH ENTRY RESIDES      */
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2033
*        IF CATACBPT ^= NULLPTR                                    2033
*          THEN                                                    2033
         L     @06,CATACBPT                                        2033
         LTR   @06,@06                                             2033
         BZ    @RF02033                                            2033
*            DO;                                           /*@Y30SSJH*/
*                                                                  2034
*            CTGCNAME = OFF;            /* INDICATE CATLG ACB GIVEN  */
         NI    CTGCNAME(@15),B'11111101'                           2035
*            CTGCAT = CATACBPT;         /* ACB ADDRESS OF CATALOG    */
*                                                                  2036
         ST    @06,CTGCAT(,@15)                                    2036
*            END;                                          /*@Y30SSJH*/
*                                                                  2037
*          /**********************************************************/
*          /*                                                @Y30SSJH*/
*          /* CATLG ACB ADDRESS NOT SPECIFIED - SET PTR TO CATLG NAME*/
*          /* IF A CATALOG NAME NOR ACB IS NOT PROVIDED THE CATALOG  */
*          /* SEARCH FOLLOWS THE STEPCAT×JOBCAT, MASTERCATALOG HIER- */
*          /* ARCHY.                                         @Y30SSJH*/
*          /*                                                @Y30SSJH*/
*          /**********************************************************/
*                                                                  2038
*          ELSE                                                    2038
*            IF (ADDR(CATLG)) ^= NULLPTR                           2038
*              THEN                                                2038
         B     @RC02033                                            2038
@RF02033 L     @06,@PC00001+4                                      2038
         L     @06,FDTPTR+8(,@06)                                  2038
         LTR   @06,@06                                             2038
         BZ    @RF02038                                            2038
*                CTGCAT = ADDR(CATLGVAL);                  /*@Y30SSJH*/
*                                                                  2039
         LA    @06,CATLGVAL(,@06)                                  2039
         L     @01,CPLSAVE                                         2039
         ST    @06,CTGCAT(,@01)                                    2039
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE THE PASSWORD ADDRESS - EITHER CATLG OR ENTRY  */
*        /* PASSWORD. THE CATALOG PASSWORD HAS THE HIGHEST PRIORITY  */
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2040
*        IF (ADDR(CATLG)) ^= NULLPTR                               2040
*          THEN                                                    2040
@RF02038 DS    0H                                                  2040
@RC02033 L     @06,@PC00001+4                                      2040
         L     @06,FDTPTR+8(,@06)                                  2040
         LTR   @06,@06                                             2040
         BZ    @RF02040                                            2040
*            IF CATLGPLN ^= 0                                      2041
*              THEN                                                2041
         CLI   CATLGPLN(@06),0                                     2041
         BE    @RF02041                                            2041
*                CTGPSWD = ADDR(CATLGPAS);  /* CATALOG PASSWORD      */
*                                                                  2042
         LA    @06,CATLGPAS(,@06)                                  2042
         L     @01,CPLSAVE                                         2042
         ST    @06,CTGPSWD(,@01)                                   2042
*        IF CTGPSWD = NULLPTR                                      2043
*          THEN                                                    2043
@RF02041 DS    0H                                                  2043
@RF02040 L     @06,CPLSAVE                                         2043
         L     @15,CTGPSWD(,@06)                                   2043
         LTR   @15,@15                                             2043
         BNZ   @RF02043                                            2043
*            IF NTRYPLN ^= 0                                       2044
*              THEN                                                2044
         L     @15,@PC00001+4                                      2044
         L     @15,FDTPTR(,@15)                                    2044
         CLI   NTRYPLN(@15),0                                      2044
         BE    @RF02044                                            2044
*                CTGPSWD = ADDR(NTRYPAS);   /* ENTRY PASSWORD        */
         LA    @15,NTRYPAS(,@15)                                   2045
         ST    @15,CTGPSWD(,@06)                                   2045
*                                                                  2046
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE INDEX CI NUMBER IN FVT                @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2046
*        CTGFVENT = ADDR(INDEXCI);                         /*@Y30SSJH*/
*                                                                  2046
@RF02044 DS    0H                                                  2046
@RF02043 L     @06,CPLSAVE                                         2046
         L     @06,CTGFVT(,@06)                                    2046
         LA    @15,INDEXCI                                         2046
         ST    @15,CTGFVENT(,@06)                                  2046
*         /***********************************************************/
*         /*                                                 @Y30SSJH*/
*         /* INITIALIZE POINTER TO DNAME IN FVT              @Y30SSJH*/
*         /*                                                 @Y30SSJH*/
*         /***********************************************************/
*                                                                  2047
*         IF CTGPLPTR -> CTGFVT -> CTGFVIND ^= NULLPTR             2047
*           THEN                                                   2047
         L     @01,CTGPLPTR                                        2047
         L     @01,CTGFVT(,@01)                                    2047
         L     @15,CTGFVIND(,@01)                                  2047
         LTR   @15,@15                                             2047
         BZ    @RF02047                                            2047
*             CTGFVIND = CTGPLPTR -> CTGFVT -> CTGFVIND;   /*@Y30SSJH*/
*                                                                  2048
         ST    @15,CTGFVIND(,@06)                                  2048
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* INITIALIZE AMDSB FPL TO COMMUNICATE ALTERATION   @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2049
*        CTGFLNG(1) = IXAMDLEN;                            /*@Y30SSJH*/
@RF02047 L     @06,CTGFLPTR                                        2049
         L     @15,IXAMDLEN                                        2049
         ST    @15,CTGFLNG(,@06)                                   2049
*        CTGFLPT(1) = IXAMDPT;                             /*@Y30SSJH*/
         L     @15,IXAMDPT                                         2050
         ST    @15,CTGFLPT(,@06)                                   2050
*        CTGFLDNO = 1;                                     /*@Y30SSJH*/
         MVI   CTGFLDNO(@06),X'01'                                 2051
*        CTGFLDNM = ADDR(ALFLDNAM(8));                     /*@Y30SSJH*/
*                                                                  2052
         LA    @15,ALFLDNAM+56                                     2052
         ST    @15,CTGFLDNM(,@06)                                  2052
*        CTGFVAMD = ADDR(IXFPLAMD);                        /*@Y30SSJH*/
         L     @06,CPLSAVE                                         2053
         L     @06,CTGFVT(,@06)                                    2053
         L     @01,IXPRMPTR                                        2053
         LA    @15,IXFPLAMD(,@01)                                  2053
         ST    @15,CTGFVAMD(,@06)                                  2053
*        CTGFVTYP = 'I';                                   /*@Y30SSJH*/
*                                                                  2054
         MVI   CTGFVTYP(@06),C'I'                                  2054
*        RETURN;                                           /*@Y30SSJH*/
@EL00006 DS    0H                                                  2055
@EF00006 DS    0H                                                  2055
@ER00006 LM    @14,@12,@SA00006                                    2055
         BR    @14                                                 2055
*END INDEXPRC;                                             /*@Y30SSJH*/
*/********************************************************************/
*/*                                                          @OZ05940*/
*/* PROCEDURE NAME - PARAMCHK                                @OZ05940*/
*/*                                                          @OZ05940*/
*/* FUNCTION - TO DETERMINE WHETHER THE PARAMETERS SPECIFIED @OZ05940*/
*/*            ON THE ALTER COMMAND ARE CONSISTENT WITH THE  @OZ05940*/
*/*            TYPE OF THE ENTRY NAME. BECAUSE THE ENTRY     @OZ05940*/
*/*            TYPE MUST BE KNOWN, A PRIOR CALL TO LOCATPRC  @OZ05940*/
*/*            IS ASSUMED.                                   @OZ05940*/
*/*                                                          @OZ05940*/
*/* INPUT -                                                  @OZ05940*/
*/*           . ALSTID - GLOBAL INTERNAL STATUS COMMUNICATOR @OZ05940*/
*/*           . (SEE ARGUMENT OF INVOCATION BELOW)           @OZ05940*/
*/*                                                          @OZ05940*/
*/* OUTPUT -                                                 @OZ05940*/
*/*           . ALSTID - STATUS INDICATOR, SET ON ERROR      @OZ05940*/
*/*           . PARMINDX - INDEX IN  PARAMETER TABLE OF PARAMETER    */
*/*               IN ERROR                                   @OZ05940*/
*/*                                                          @OZ05940*/
*/********************************************************************/
*PARAMCHK:                                                         2057
*        PROCEDURE (ETYPE);                                /*@OZ05940*/
*                                                                  2057
PARAMCHK STM   @14,@12,12(@13)                                     2057
         MVC   @PC00007(4),0(@01)                                  2057
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* ARGUMENT OF INVOCATION                           @OZ05940*/
*        /*                                                  @OZ05940*/
*        /************************************************************/
*        DCL                                                       2058
*          ETYPE CHAR(1);               /* TYPE OF OBJECT BEING    2058
*                                           ALTERED          @OZ05940*/
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* ENTRY POINT TO PARAMCHK                          @OZ05940*/
*        /*                                                  @OZ05940*/
*        /************************************************************/
*                                                                  2059
*        PARMINDX = 0;                                     /*@Z40WSJH*/
*                                                                  2059
         SLR   @06,@06                                             2059
         STH   @06,PARMINDX                                        2059
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* TEST FOR DATA ONLY PARAMETERS SPECIFIED INCORRECTLY.     */
*        /* DATA PARAMETERS THAT CAN BE CHECKED HERE ARE     @OZ05940*/
*        /* ERASE, NOERASE, FREESPACE AND NONUNIQUEKEY.      @OZ05940*/
*        /*                                                  @OZ05940*/
*        /************************************************************/
*                                                                  2060
*        IF ETYPE ^= CTGTDATA                                      2060
*          THEN                                                    2060
         L     @15,@PC00007                                        2060
         CLI   ETYPE(@15),C'D'                                     2060
         BE    @RF02060                                            2060
*            DO;                                           /*@OZ05940*/
*                                                                  2061
*            IF (ADDR(ERASE)) ^= NULLPTR                           2062
*              THEN                                                2062
         L     @15,@PC00001+4                                      2062
         C     @06,FDTPTR+80(,@15)                                 2062
         BE    @RF02062                                            2062
*                PARMINDX = 11;                            /*@OZ05940*/
         MVC   PARMINDX(2),@CH00036                                2063
*              ELSE                                                2064
*                IF (ADDR(NERAS)) ^= NULLPTR                       2064
*                  THEN                                            2064
         B     @RC02062                                            2064
@RF02062 L     @06,@PC00001+4                                      2064
         L     @06,FDTPTR+84(,@06)                                 2064
         LTR   @06,@06                                             2064
         BZ    @RF02064                                            2064
*                    PARMINDX = 12;                        /*@OZ05940*/
         MVC   PARMINDX(2),@CH00035                                2065
*                  ELSE                                            2066
*                    IF (ADDR(FSPAC)) ^= NULLPTR                   2066
*                      THEN                                        2066
         B     @RC02064                                            2066
@RF02064 L     @06,@PC00001+4                                      2066
         L     @06,FDTPTR+120(,@06)                                2066
         LTR   @06,@06                                             2066
         BZ    @RF02066                                            2066
*                        PARMINDX= 8;                      /*@OZ05940*/
         MVC   PARMINDX(2),@CH00039                                2067
*                      ELSE                                        2068
*                        IF (ADDR(NUNQK)) ^= NULLPTR               2068
*                          THEN                                    2068
         B     @RC02066                                            2068
@RF02066 L     @06,@PC00001+4                                      2068
         L     @06,FDTPTR+248(,@06)                                2068
         LTR   @06,@06                                             2068
         BZ    @RF02068                                            2068
*                            PARMINDX = 10;                /*@OZ05940*/
*                                                                  2069
         MVC   PARMINDX(2),@CH00037                                2069
*            END;                                          /*@OZ05940*/
*                                                                  2070
@RF02068 DS    0H                                                  2070
@RC02066 DS    0H                                                  2070
@RC02064 DS    0H                                                  2070
@RC02062 DS    0H                                                  2071
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* TEST FOR DATA OR INDEX PARAMETERS SPECIFIED INCORRECTLY. */
*        /* DATA/INDEX PARAMETERS THAT CAN BE CHECKED HERE   @OZ05940*/
*        /* ARE STAGE, BIND, CYLINDERFAULT, DESTAGEWAIT,     @OZ05940*/
*        /* NODESTAGEWAIT, WRITECHECK, NOWRITECHECK,         @OZ05940*/
*        /* SHAREOPTIONS, INHIBIT AND UNINHIBIT.             @OZ05940*/
*        /*                                                  @OZ05940*/
*        /************************************************************/
*                                                                  2071
*        IF ETYPE ^= CTGTDATA    &                                 2071
*           ETYPE ^= CTGTINDX    &                                 2071
*           PARMINDX = NULLPTR                                     2071
*          THEN                                                    2071
@RF02060 L     @06,@PC00007                                        2071
         CLI   ETYPE(@06),C'D'                                     2071
         BE    @RF02071                                            2071
         CLI   ETYPE(@06),C'I'                                     2071
         BE    @RF02071                                            2071
         SLR   @06,@06                                             2071
         CH    @06,PARMINDX                                        2071
         BNE   @RF02071                                            2071
*            DO;                                           /*@OZ05940*/
*                                                                  2072
*            IF (ADDR(STAGE)) ^= NULLPTR                           2073
*              THEN                                                2073
         L     @15,@PC00001+4                                      2073
         C     @06,FDTPTR+272(,@15)                                2073
         BE    @RF02073                                            2073
*                PARMINDX = 1;                             /*@OZ05940*/
         MVC   PARMINDX(2),@CH00220                                2074
*              ELSE                                                2075
*                IF (ADDR(BIND)) ^= NULLPTR                        2075
*                  THEN                                            2075
         B     @RC02073                                            2075
@RF02073 L     @06,@PC00001+4                                      2075
         L     @06,FDTPTR+276(,@06)                                2075
         LTR   @06,@06                                             2075
         BZ    @RF02075                                            2075
*                    PARMINDX = 2;                         /*@OZ05940*/
         MVC   PARMINDX(2),@CH00155                                2076
*                  ELSE                                            2077
*                    IF (ADDR(CYLF)) ^= NULLPTR                    2077
*                      THEN                                        2077
         B     @RC02075                                            2077
@RF02075 L     @06,@PC00001+4                                      2077
         L     @06,FDTPTR+280(,@06)                                2077
         LTR   @06,@06                                             2077
         BZ    @RF02077                                            2077
*                        PARMINDX = 3;                     /*@OZ05940*/
         MVC   PARMINDX(2),@CH00164                                2078
*                      ELSE                                        2079
*                        IF (ADDR(STGW)) ^= NULLPTR                2079
*                          THEN                                    2079
         B     @RC02077                                            2079
@RF02077 L     @06,@PC00001+4                                      2079
         L     @06,FDTPTR+288(,@06)                                2079
         LTR   @06,@06                                             2079
         BZ    @RF02079                                            2079
*                            PARMINDX = 4;                 /*@OZ05940*/
         MVC   PARMINDX(2),@CH00044                                2080
*                          ELSE                                    2081
*                            IF (ADDR(NSTGW)) ^= NULLPTR           2081
*                              THEN                                2081
         B     @RC02079                                            2081
@RF02079 L     @06,@PC00001+4                                      2081
         L     @06,FDTPTR+284(,@06)                                2081
         LTR   @06,@06                                             2081
         BZ    @RF02081                                            2081
*                                PARMINDX = 5;             /*@OZ05940*/
         MVC   PARMINDX(2),@CH00287                                2082
*                              ELSE                                2083
*                                IF (ADDR(WRTCK)) ^= NULLPTR       2083
*                                  THEN                            2083
         B     @RC02081                                            2083
@RF02081 L     @06,@PC00001+4                                      2083
         L     @06,FDTPTR+132(,@06)                                2083
         LTR   @06,@06                                             2083
         BZ    @RF02083                                            2083
*                                    PARMINDX = 6;         /*@OZ05940*/
         MVC   PARMINDX(2),@CH00158                                2084
*                                  ELSE                            2085
*                                    IF (ADDR(NWTCK)) ^= NULLPTR   2085
*                                      THEN                        2085
         B     @RC02083                                            2085
@RF02083 L     @06,@PC00001+4                                      2085
         L     @06,FDTPTR+136(,@06)                                2085
         LTR   @06,@06                                             2085
         BZ    @RF02085                                            2085
*                                        PARMINDX =7;      /*@OZ05940*/
*                                                                  2086
         MVC   PARMINDX(2),@CH00467                                2086
*            IF (ADDR(SHARE)) ^= NULLPTR                           2087
*              THEN                                                2087
@RF02085 DS    0H                                                  2087
@RC02083 DS    0H                                                  2087
@RC02081 DS    0H                                                  2087
@RC02079 DS    0H                                                  2087
@RC02077 DS    0H                                                  2087
@RC02075 DS    0H                                                  2087
@RC02073 L     @06,@PC00001+4                                      2087
         L     @06,FDTPTR+88(,@06)                                 2087
         LTR   @06,@06                                             2087
         BZ    @RF02087                                            2087
*                PARMINDX = 13;                            /*@OZ05940*/
         MVC   PARMINDX(2),@CH00638                                2088
*              ELSE                                                2089
*                IF (ADDR(INHIB)) ^= NULLPTR                       2089
*                  THEN                                            2089
         B     @RC02087                                            2089
@RF02087 L     @06,@PC00001+4                                      2089
         L     @06,FDTPTR+156(,@06)                                2089
         LTR   @06,@06                                             2089
         BZ    @RF02089                                            2089
*                    PARMINDX = 14;                        /*@OZ05940*/
         MVC   PARMINDX(2),@CH00641                                2090
*                  ELSE                                            2091
*                    IF (ADDR(UNHIB)) ^= NULLPTR                   2091
*                      THEN                                        2091
         B     @RC02089                                            2091
@RF02089 L     @06,@PC00001+4                                      2091
         L     @06,FDTPTR+160(,@06)                                2091
         LTR   @06,@06                                             2091
         BZ    @RF02091                                            2091
*                        PARMINDX = 15;                    /*@OZ05940*/
*                                                                  2092
         MVC   PARMINDX(2),@CH00229                                2092
*            END;                                          /*@OZ05940*/
@RF02091 DS    0H                                                  2093
@RC02089 DS    0H                                                  2093
@RC02087 DS    0H                                                  2094
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* TEST FOR GDG PARAMETERS SPECIFIED INCORRECTLY.   @OZ05940*/
*        /* GDG PARAMETERS THAT CAN BE CHECKED HERE ARE      @OZ05940*/
*        /* EMPTY, NOEMPTY, SCRATCH AND NOSCRATCH.           @OZ05940*/
*        /*                                                  @OZ05940*/
*        /************************************************************/
*                                                                  2094
*        IF ETYPE ^= CTGTGBS     &                                 2094
*           PARMINDX = NULLPTR                                     2094
*          THEN                                                    2094
@RF02071 L     @06,@PC00007                                        2094
         CLI   ETYPE(@06),C'B'                                     2094
         BE    @RF02094                                            2094
         SLR   @06,@06                                             2094
         CH    @06,PARMINDX                                        2094
         BNE   @RF02094                                            2094
*            DO;                                           /*@OZ05940*/
*                                                                  2095
*            IF (ADDR(GDGEM)) ^= NULLPTR                           2096
*              THEN                                                2096
         L     @15,@PC00001+4                                      2096
         C     @06,FDTPTR+196(,@15)                                2096
         BE    @RF02096                                            2096
*                PARMINDX = 16;                            /*@OZ05940*/
         MVC   PARMINDX(2),@CH00477                                2097
*              ELSE                                                2098
*                IF (ADDR(GDGNE)) ^= NULLPTR                       2098
*                  THEN                                            2098
         B     @RC02096                                            2098
@RF02096 L     @06,@PC00001+4                                      2098
         L     @06,FDTPTR+200(,@06)                                2098
         LTR   @06,@06                                             2098
         BZ    @RF02098                                            2098
*                    PARMINDX = 17;                        /*@OZ05940*/
         MVC   PARMINDX(2),@CH01590                                2099
*                  ELSE                                            2100
*                    IF (ADDR(GDGSC)) ^= NULLPTR                   2100
*                      THEN                                        2100
         B     @RC02098                                            2100
@RF02098 L     @06,@PC00001+4                                      2100
         L     @06,FDTPTR+204(,@06)                                2100
         LTR   @06,@06                                             2100
         BZ    @RF02100                                            2100
*                        PARMINDX = 18;                    /*@OZ05940*/
         MVC   PARMINDX(2),@CH00650                                2101
*                      ELSE                                        2102
*                        IF (ADDR(GDGNS)) ^= NULLPTR               2102
*                          THEN                                    2102
         B     @RC02100                                            2102
@RF02100 L     @06,@PC00001+4                                      2102
         L     @06,FDTPTR+208(,@06)                                2102
         LTR   @06,@06                                             2102
         BZ    @RF02102                                            2102
*                            PARMINDX = 19;                /*@OZ05940*/
*                                                                  2103
         MVC   PARMINDX(2),@CH00653                                2103
*            END;                                          /*@OZ05940*/
*                                                                  2104
@RF02102 DS    0H                                                  2104
@RC02100 DS    0H                                                  2104
@RC02098 DS    0H                                                  2104
@RC02096 DS    0H                                                  2105
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* AN ERROR COMBINATION HAS BEEN DETECTED. SET      @OZ05940*/
*        /* ALSTID TO INDICATE THE APPROPRIATE ERROR MESSAGE.        */
*        /*                                                  @OZ05940*/
*        /************************************************************/
*                                                                  2105
*        IF PARMINDX ^= NULLPTR                                    2105
*          THEN                                                    2105
@RF02094 LH    @06,PARMINDX                                        2105
         LTR   @06,@06                                             2105
         BZ    @RF02105                                            2105
*            ALSTID = BADPARM;                             /*@OZ05940*/
*                                                                  2106
         MVC   ALSTID(5),@CB01098                                  2106
*        /************************************************************/
*        /*                                                  @OZ05940*/
*        /* RETURN TO INVOKER                                @OZ05940*/
*        /*                                                  @OZ05940*/
*        /************************************************************/
*                                                                  2107
*        RETURN;                                           /*@OZ05940*/
*                                                                  2107
@EL00007 DS    0H                                                  2107
@EF00007 DS    0H                                                  2107
@ER00007 LM    @14,@12,12(@13)                                     2107
         BR    @14                                                 2107
*END PARAMCHK;                                             /*@OZ05940*/
         B     @EL00007                                            2108
*/********************************************************************/
*/*                                                          @Y30SSJH*/
*/* PROCEDURE NAME - DALCPROC (SERVICE ROUTINE)              @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* FUNCTION - DALCPROC PERFORMS THE NECESSARY PROCESSING    @Y30SSJH*/
*/*          TO INVOKE THE AMS UALLOC ROUTINE WHICH PERFORMS @Y30SSJH*/
*/*          DYNAMIC ALLOCATION AND THE AMS UDEALLOC ROUTINE @Y30SSJH*/
*/*          WHICH PERFORMS DEALLOCATION.                    @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*          AN ALLOCATION REQUEST IS RECOGNIZED BY AN 'A'   @Y30SSJH*/
*/*          SETTING OF REQTYPE. DALCPROC BUILDS THE ALLAGL  @Y30SSJH*/
*/*          WHICH IS PASSED TO THE AMS SYSTEM ADAPTER VIA   @Y30SSJH*/
*/*          THE UALLOC MACRO. THE ALLAGL REFERENCES THE     @Y30SSJH*/
*/*          LIST OF VOLUMES TO BE MOUNTED. THE ADDRESS OF   @Y30SSJH*/
*/*          THE DD STATEMENT BUILT IS PLACED IN THE FVT     @Y30SSJH*/
*/*          FIELD AS REFERENCED BY DALDNMPT.                @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/*          A DEALLOCATION REQUEST IS RECOGNIZED BY A 'D'   @Y30SSJH*/
*/*          SETTING OF REQTYPE. DALCPROC PASSES THE ALLAGL  @Y30SSJH*/
*/*          USED IN ALLOCATION TO THE SYSTEM ADAPTER VIA    @Y30SSJH*/
*/*          THE UDEALLOC MACRO. A LIST OF POINTERS TO       @Y30SSJH*/
*/*          ALLAGLS IS ESTABLISHED WHEN ALLOCATING THE      @Y30SSJH*/
*/*          VOLUMES.                                        @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* INPUT -                                                  @Y30SSJH*/
*/*          . DEFSTID - GLOBAL INTERNAL STATUS COMMUNICATOR @Y30SSJH*/
*/*          . (SEE ARGUMENTS OF INVOCATION, BELOW)          @Y30SSJH*/
*/*                                                          @Y30SSJH*/
*/* OUTPUT -                                                 @Y30SSJH*/
*/*          .DEFSTID - STATUS INDICATOR, SET ON ERROR       @Y30SSJH*/
*/*          . DALDNMPT - ADDRESS OF DDNAME ALLOCATED        @Y30SSJH*/
*/*            DALINDEX - INDEX TO ALLAGLS, BUMPED EACH TIME @Y30SSJH*/
*/*            AN ALLOCATION REQUEST IS MADE.                @Y30SSJH*/
*/*********************************************************************
*                                                                  2109
*DALCPROC:                                                         2109
*        PROCEDURE (REQTYPE,DALVLPTR,DALDNMPT,DALINDEX);   /*@Y30SSJH*/
*                                                                  2109
DALCPROC STM   @14,@12,@SA00008                                    2109
         MVC   @PC00008(16),0(@01)                                 2109
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ARGUMENTS OF INVOCATION                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*        DCL                                                       2110
*          REQTYPE CHAR(1),            /* TYPE OF REQUEST    @Y30SSJH*/
*          DALVLPTR,                   /* ADDR OF DNAME      @Y30SSJH*/
*          DALDNMPT,                   /* ADDR OF DNAME      @Y30SSJH*/
*          DALINDEX;                   /* INDEX OF ALLAGLS   @Y30SSJH*/
*                                                                  2110
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* UNIT DESCRIPTOR LIST REFERENCED BY ALLAGL        @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*        DCL                                                       2111
*          1 DALCUNIT STATIC LOCAL,                                2111
*            2 DL#UNIT   FIXED(15) INIT(2),                        2111
*            2 DUNITLN1  FIXED(15) INIT(8),                /*@Y30SSJH*/
*            2 DLUNIT1   CHAR(8)   INIT('SYSALLDA'),       /*@Y30SSJH*/
*            2 DUNITLN2  FIXED(15) INIT(8),                /*@Y30SSJH*/
*            2 DLUNIT2   CHAR(8)   INIT('SYSALLDA');       /*@Y30SSJH*/
*                                                                  2111
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* MAPPING STRUCTURE FOR VOLUME LIST TO BE DYNAMICALLY      */
*        /* ALLOCATED, THIS LIST IS RECONSTRUCTED IN A FORM  @Y30SSJH*/
*        /* COMPATIBLE TO DYNAMIC ALLOCATION IN A NEW AREA   @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2112
*        DCL                                                       2112
*          1 FVTVLIST BASED(DALVLPTR),                             2112
*            2 FVTVLEN FIXED(15),                                  2112
*            2 * (*),                                              2112
*              3 *       FIXED(15),                                2112
*              3 FVTVSER CHAR(6);                          /*@Y30SSJH*/
*                                                                  2112
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* MAPPING STRUCTURE FOR VOLUME LIST CONSTRUCTED IN DALCPROC*/
*        /* AND PASSED TO DYNAMIC ALLOCATION VIA THE ALLAGL PARAMETER*/
*        /* LIST                                             @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2113
*        DCL                                                       2113
*          1 ALCVLIST BASED(ALLVLP),                               2113
*            2 ALC#ENT FIXED(15),                                  2113
*            2 * (*),                                              2113
*              3 ALCVLEN FIXED(15),                                2113
*              3 ALCVSER CHAR(6);                          /*@Y30SSJH*/
*                                                                  2113
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* POINTER TO ALLAGL PARAMETERLIST                  @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*        DCL                                                       2114
*          DALGLPTR  PTR(31);                              /*@Y30SSJH*/
*                                                                  2114
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* ENTRY POINT TO DALCPROC                          @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2115
*        OLDERID2 = NEWERID2;                                      2115
         L     @06,@PC00001                                        2115
         L     @06,GDTTR2(,@06)                                    2115
         MVC   @TS00001(95),NEWERID2(@06)                          2115
         MVC   OLDERID2(95,@06),@TS00001                           2115
*        NEWID2 = 'AL71';                                  /*@Y30SSJH*/
*                                                                  2116
         MVC   NEWID2(4,@06),@CC01620                              2116
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* CHECK REQUEST TYPE FOR ALLOCATION OR DEALLOCATION        */
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  2117
*        IF REQTYPE = 'A'                                          2117
*          THEN                                                    2117
         L     @06,@PC00008                                        2117
         CLI   REQTYPE(@06),C'A'                                   2117
         BNE   @RF02117                                            2117
*DALOOP0:    DO;                                           /*@Y30SSJH*/
*                                                                  2118
DALOOP0  DS    0H                                                  2119
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* THIS IS AN ALLOCATION REQUEST - GET SPACE FOR THE    */
*            /* VOLUME LIST TO BE BUILT AND PASSED TO THE AMS        */
*            /* SYSTEM ADAPTER VIA THE ALLAGL PARAMETERLIST  @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2119
*            CALL IDCSAGP0 (GDTTBL,                                2119
*              ((FVTVLEN + 16) + (LENGTH(ALLAGL) +4 )),            2119
*              DALGLPTR,                                           2119
*              ALGPID,                                             2119
*              SETZERO);                                   /*@Y30SSJH*/
*                                                                  2119
         L     @06,@PC00001                                        2119
         ST    @06,@AL00001                                        2119
         L     @15,@PC00008+4                                      2119
         L     @01,DALVLPTR(,@15)                                  2119
         LA    @00,51                                              2119
         AH    @00,FVTVLEN(,@01)                                   2119
         ST    @00,@AFTEMPS+8                                      2119
         LA    @15,@AFTEMPS+8                                      2119
         ST    @15,@AL00001+4                                      2119
         LA    @15,DALGLPTR                                        2119
         ST    @15,@AL00001+8                                      2119
         LA    @15,ALGPID                                          2119
         ST    @15,@AL00001+12                                     2119
         LA    @15,SETZERO                                         2119
         ST    @15,@AL00001+16                                     2119
         MVI   @AL00001+16,X'80'                                   2119
         L     @15,GDTGPL(,@06)                                    2119
         LA    @01,@AL00001                                        2119
         BALR  @14,@15                                             2119
*            RESPECIFY RTNREG RSTD;                                2120
*            TESTRC = RTNREG;                                      2121
         STH   RTNREG,TESTRC                                       2121
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/
*            IF TESTRC ^= 0                                        2123
*              THEN                                                2123
         LH    @06,TESTRC                                          2123
         LTR   @06,@06                                             2123
         BZ    @RF02123                                            2123
*                DO;                                       /*@Y30SSJH*/
*                                                                  2124
*                ALSTID = NOSTORAG;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01039                                  2125
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  2126
@EL00008 DS    0H                                                  2126
@EF00008 DS    0H                                                  2126
@ER00008 LM    @14,@12,@SA00008                                    2126
         BR    @14                                                 2126
*                END;                                      /*@Y30SSJH*/
*                                                                  2127
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* SET ADDRESSABILITY TO ALLAGL AND INITIALIZE ALLVLP   */
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2128
*            RFY ALLAGL BASED(DALGLPTR);                   /*@Y30SSJH*/
@RF02123 DS    0H                                                  2129
*            ALLVLP = DALGLPTR + (LENGTH(ALLAGL) +4);      /*@Y30SSJH*/
*                                                                  2129
         L     @06,DALGLPTR                                        2129
         LA    @15,35                                              2129
         ALR   @15,@06                                             2129
         ST    @15,ALLVLP(,@06)                                    2129
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* COMPUTE THE NUMBER OF ENTRIES IN THE UALLOC VOLUME   */
*            /* LIST                                         @Y30SSJH*/
*            /********************************************************/
*                                                                  2130
*            ALC#ENT = (FVTVLEN / 8) + 1;                  /*@Y30SSJH*/
*                                                                  2130
         LA    @06,1                                               2130
         L     @14,@PC00008+4                                      2130
         L     @01,DALVLPTR(,@14)                                  2130
         LH    @00,FVTVLEN(,@01)                                   2130
         SRDA  @00,32                                              2130
         D     @00,@CF00039                                        2130
         ALR   @01,@06                                             2130
         STH   @01,ALC#ENT(,@15)                                   2130
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* CHECK FOR UNREASONABLE VALUE IN ALC#ENT TO PREVENT   */
*            /* ALLOPING PROBLEM IN DALOOP1                  @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*            IF ALC#ENT  < 1  ×                                    2131
*               ALC#ENT  > 255                                     2131
*              THEN                                                2131
         CR    @01,@06                                             2131
         BL    @RT02131                                            2131
         C     @01,@CF00648                                        2131
         BNH   @RF02131                                            2131
@RT02131 DS    0H                                                  2132
*                DO;                                       /*@Y30SSJH*/
*                                                                  2132
*                ALSTID = NOENTALT;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01058                                  2133
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  2134
         B     @EL00008                                            2134
*                END;                                      /*@Y30SSJH*/
*                                                                  2135
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* PUT THE CATALOG RECOVERY VOLUME IN THE LIST OF       */
*            /* VOLUMES TO BE DYNAMICALLY ALLOCATED.         @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2136
*            DO J = 1 TO 6                                         2136
*              WHILE LCCRAVOL(J) ^= ' ';                   /*@Y30SSJH*/
@RF02131 LA    @06,1                                               2136
         STH   @06,J                                               2136
@DL02136 L     @01,LCCRAPT                                         2136
         ALR   @01,@06                                             2136
         BCTR  @01,0                                               2136
         CLI   LCCRAVOL(@01),C' '                                  2136
         BE    @DC02136                                            2136
*            END;                                          /*@Y30SSJH*/
*                                                                  2137
         AL    @06,@CF00220                                        2137
         STH   @06,J                                               2137
         C     @06,@CF00158                                        2137
         BNH   @DL02136                                            2137
@DC02136 DS    0H                                                  2138
*            ALCVLEN(1) = (J-1);                           /*@Y30SSJH*/
         L     @06,DALGLPTR                                        2138
         L     @06,ALLVLP(,@06)                                    2138
         LH    @15,J                                               2138
         BCTR  @15,0                                               2138
         STH   @15,ALCVLEN(,@06)                                   2138
*            ALCVSER(1) = LCCRAVOL;                        /*@Y30SSJH*/
*                                                                  2139
         L     @01,LCCRAPT                                         2139
         MVC   ALCVSER(6,@06),LCCRAVOL(@01)                        2139
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* LOOP THRU THE LIST OF VOLUMES REFERENCED BY DALVLPTR */
*            /* MOVING EACH VOLSER INTO THE LIST PASSED VIA THE      */
*            /* ALLAGL AND COMPUTE THE LENGTH OF THE NON-BLANK       */
*            /* PORTION OF THE VOLSER, THIS LENGTH PRECEEDES EACH    */
*            /* VOLSER IN THE ALLAGL VOLUME LIST             @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2140
*DALOOP1:    DO N = 1 TO (ALC#ENT - 1);                    /*@Y30SSJH*/
*                                                                  2140
DALOOP1  LA    @06,1                                               2140
         B     @DE02140                                            2140
@DL02140 DS    0H                                                  2141
*              DO J = 1 TO 6                                       2141
*                WHILE FVTVSER (N,J) ^= ' ';               /*@Y30SSJH*/
         LA    @06,1                                               2141
         STH   @06,J                                               2141
@DL02141 L     @15,N                                               2141
         SLA   @15,3                                               2141
         ALR   @15,@06                                             2141
         L     @14,@PC00008+4                                      2141
         L     @01,DALVLPTR(,@14)                                  2141
         ALR   @01,@15                                             2141
         AL    @01,@CF01718                                        2141
         CLI   FVTVSER-4(@01),C' '                                 2141
         BE    @DC02141                                            2141
*              END;                                        /*@Y30SSJH*/
*                                                                  2142
         AL    @06,@CF00220                                        2142
         STH   @06,J                                               2142
         C     @06,@CF00158                                        2142
         BNH   @DL02141                                            2142
@DC02141 DS    0H                                                  2143
*              /******************************************************/
*              /*                                            @Y30SSJH*/
*              /* ON EXIT FROM ABOVE LOOP J HAS THE LENGTH OF THE    */
*              /* NONBLANK PORTION OF THE VOLSER + 1         @Y30SSJH*/
*              /*                                            @Y30SSJH*/
*              /******************************************************/
*                                                                  2143
*              ALCVLEN(N + 1) = (J - 1);                   /*@Y30SSJH*/
         L     @06,N                                               2143
         LR    @15,@06                                             2143
         SLA   @15,3                                               2143
         L     @01,DALGLPTR                                        2143
         L     @14,ALLVLP(,@01)                                    2143
         LH    @05,J                                               2143
         BCTR  @05,0                                               2143
         STH   @05,ALCVLEN(@15,@14)                                2143
*              ALCVSER(N + 1) = FVTVSER(N);                /*@Y30SSJH*/
*                                                                  2144
         ALR   @14,@15                                             2144
         L     @05,@PC00008+4                                      2144
         L     @01,DALVLPTR(,@05)                                  2144
         ALR   @01,@15                                             2144
         AL    @01,@CF01717                                        2144
         MVC   ALCVSER(6,@14),FVTVSER-4(@01)                       2144
*            END DALOOP1;                                  /*@Y30SSJH*/
*                                                                  2145
         AL    @06,@CF00220                                        2145
@DE02140 ST    @06,N                                               2145
         L     @01,DALGLPTR                                        2145
         L     @01,ALLVLP(,@01)                                    2145
         LH    @15,ALC#ENT(,@01)                                   2145
         BCTR  @15,0                                               2145
         CR    @06,@15                                             2145
         BNH   @DL02140                                            2145
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* INITIALIZE REMAINING ALLAGL FIELDS           @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2146
*            ALLULP = ADDR(DALCUNIT);                      /*@Y30SSJH*/
         L     @06,DALGLPTR                                        2146
         LA    @15,DALCUNIT                                        2146
         ST    @15,ALLULP(,@06)                                    2146
*            ALLOPTVL = ON;                                /*@Y30SSJH*/
*                                                                  2147
         OI    ALLOPTVL(@06),B'10000000'                           2147
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /*  INVOKE DYNAMIC ALLOCATION VIA AMS UALLOC MACRO      */
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2148
*            CALL IDCSAAL0 (GDTTBL,ALLAGL);                /*@Y30SSJH*/
*                                                                  2148
         L     @15,@PC00001                                        2148
         ST    @15,@AL00001                                        2148
         ST    @06,@AL00001+4                                      2148
         MVI   @AL00001+4,X'80'                                    2148
         L     @15,GDTALC(,@15)                                    2148
         LA    @01,@AL00001                                        2148
         BALR  @14,@15                                             2148
*            RESPECIFY RTNREG RSTD;                                2149
*            TESTRC = RTNREG;                                      2150
         STH   RTNREG,TESTRC                                       2150
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/
*            IF TESTRC = 4                                         2152
*              THEN                                                2152
         LH    @06,TESTRC                                          2152
         C     @06,@CF00044                                        2152
         BNE   @RF02152                                            2152
*                DO;                                       /*@Y30SSJH*/
*                                                                  2153
*                ALSTID = NOENTALT;                        /*@Y30SSJH*/
         MVC   ALSTID(5),@CB01058                                  2154
*                RETURN;                                   /*@Y30SSJH*/
*                                                                  2155
         B     @EL00008                                            2155
*                END;                                      /*@Y30SSJH*/
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* MAINTAIN A LIST OF POINTERS TO ALLAGLS - THERE IS A  */
*            /* POSSIBILITY OF TWO ALLAGLS                   @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2157
*            DALINDEX = DALINDEX + 1;                      /*@Y30SSJH*/
@RF02152 L     @06,@PC00008+12                                     2157
         LA    @15,1                                               2157
         AL    @15,DALINDEX(,@06)                                  2157
         ST    @15,DALINDEX(,@06)                                  2157
*            ALSAVPTR(DALINDEX) = DALGLPTR;                /*@Y30SSJH*/
*                                                                  2158
         L     @06,DALGLPTR                                        2158
         SLA   @15,2                                               2158
         ST    @06,ALSAVPTR-4(@15)                                 2158
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* SET POINTER TO DDNAME BUILT BY UALLOC        @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  2159
*            DALDNMPT = ADDR(ALLDDN);                      /*@Y30SSJH*/
*                                                                  2159
         L     @15,@PC00008+8                                      2159
         LA    @06,ALLDDN(,@06)                                    2159
         ST    @06,DALDNMPT(,@15)                                  2159
*            END DALOOP0;                                  /*@Y30SSJH*/
*                                                                  2160
*          /**********************************************************/
*          /* THIS IS A DEALLOCATE REQUEST                   @Y30SSJH*/
*          /**********************************************************/
*          ELSE                                                    2161
*            DO;                                           /*@OZ17504*/
         B     @RC02117                                            2161
@RF02117 DS    0H                                                  2162
*              DO N = 1 TO DALINDEX;                       /*@Y30SSJH*/
*                                                                  2162
         LA    @06,1                                               2162
         B     @DE02162                                            2162
@DL02162 DS    0H                                                  2163
*                RFY ALLAGL BASED(ALSAVPTR(N));              /*YM5040*/
*                                                                  2163
*                CALL IDCSADL0 (GDTTBL,ALLAGL);            /*@Y30SSJH*/
*                                                                  2164
         L     @15,@PC00001                                        2164
         ST    @15,@AL00001                                        2164
         SLA   @06,2                                               2164
         L     @06,ALSAVPTR-4(@06)                                 2164
         ST    @06,@AL00001+4                                      2164
         MVI   @AL00001+4,X'80'                                    2164
         L     @15,GDTDLC(,@15)                                    2164
         LA    @01,@AL00001                                        2164
         BALR  @14,@15                                             2164
*                RESPECIFY RTNREG RSTD;                            2165
*                TESTRC = RTNREG;                                  2166
         STH   RTNREG,TESTRC                                       2166
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSJH*/
*                                                                  2167
*              END;                                        /*@Y30SSJH*/
*                                                                  2168
         LA    @06,1                                               2168
         AL    @06,N                                               2168
@DE02162 ST    @06,N                                               2168
         L     @15,@PC00008+12                                     2168
         C     @06,DALINDEX(,@15)                                  2168
         BNH   @DL02162                                            2168
*              DALINDEX = 0;                               /*@OZ17504*/
         L     @06,@PC00008+12                                     2169
         SLR   @15,@15                                             2169
         ST    @15,DALINDEX(,@06)                                  2169
*            END;                                          /*@OZ17504*/
*                                                                  2170
*        RETURN;                                           /*@Y30SSJH*/
         B     @EL00008                                            2171
*END DALCPROC;                                             /*@Y30SSJH*/
         B     @EL00008                                            2172
*END IDCAL01                                               /*@Y30SSJH*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSAL )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*;                                                                 2173
@DATA    DS    0H
@CH00467 DC    H'7'
@CH00036 DC    H'11'
@CH00638 DC    H'13'
@CH00641 DC    H'14'
@CH00477 DC    H'16'
@CH01590 DC    H'17'
@CH00650 DC    H'18'
@CH00653 DC    H'19'
@CH00662 DC    H'22'
@CH00222 DC    H'32'
@CH00687 DC    H'45'
@CH01673 DC    H'140'
@CH01113 DC    H'365'
@SM01681 MVC   0(0,@01),0(@15)
@SM01686 MVC   NEWNAME(0),NEWNMVAL(@06)
@SM01688 MVC   0(0,@04),ENTVAL-5(@02)
@SM01690 MVC   0(0,@02),NEWNMVAL(@14)
@SM01692 MVC   0(0,@02),ENTVAL-5(@14)
@SM01694 MVC   0(0,@01),NEWNMVAL(@04)
@SM01709 MVC   LCUAREC(0,@06),USARVAL(@15)
         DS    0F
@AL00647 DC    A(ALGPID)               LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00004 DS    15F
@SA00002 DS    15F
@SA00005 DS    15F
@PC00007 DS    1F
@SA00003 DS    15F
@PC00003 DS    1F
@SA00006 DS    15F
@SA00008 DS    15F
@PC00008 DS    4F
@AL00001 DS    5A
@TF00001 DS    F
@AFTEMPS DS    4F
IDCAL01  CSECT
         DS    0F
@CF00117 DC    F'0'
@CF00220 DC    F'1'
@CH00220 EQU   @CF00220+2
@CF00155 DC    F'2'
@CH00155 EQU   @CF00155+2
@CF00164 DC    F'3'
@CH00164 EQU   @CF00164+2
@CF00044 DC    F'4'
@CH00044 EQU   @CF00044+2
@CF00287 DC    F'5'
@CH00287 EQU   @CF00287+2
@CF00158 DC    F'6'
@CH00158 EQU   @CF00158+2
@CF00039 DC    F'8'
@CH00039 EQU   @CF00039+2
@CF00037 DC    F'10'
@CH00037 EQU   @CF00037+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00229 DC    F'15'
@CH00229 EQU   @CF00229+2
@CF00311 DC    F'24'
@CF00678 DC    F'28'
@CF00720 DC    F'40'
@CF00684 DC    F'43'
@CF00594 DC    F'44'
@CH00594 EQU   @CF00594+2
@CF00724 DC    F'50'
@CF00728 DC    F'52'
@CF00756 DC    F'64'
@CH00756 EQU   @CF00756+2
@CF00770 DC    F'72'
@CF01422 DC    F'76'
@CF01423 DC    F'136'
@CF01421 DC    F'240'
@CF00648 DC    F'255'
@CF01117 DC    F'512'
@CF01115 DC    F'1830'
@CF01137 DC    F'4089'
@CF01135 DC    F'32600'
@CF01684 DC    F'-41'
@CF01685 DC    F'-40'
@CF01712 DC    F'-16'
@CF01711 DC    F'-8'
@CF01719 DC    F'-6'
@CF01718 DC    F'-5'
@CF01717 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CTGPLPTR DS    A
CTGFLPTR DS    A
DSBCATPT DS    A
CTGFVPTR DS    A
ALPRMPTR DS    A
CATACBPT DS    A
DALCINDX DS    F
N        DS    F
I        DS    F
ENT      DS    F
ALLPTR   DS    A
CIRPTR   DS    A
GENWKPTR DS    A
GENCNT   DS    F
KEYRECRC DS    F
KEYPVALU DS    F
KEYLVALU DS    F
MAXRECSZ DS    F
CPLSAVE  DS    A
IXAMDPT  DS    A
IXAMDLEN DS    F
LWKALEN  DS    F
ALVOLLEN DS    F
NEWPSWPT DS    A
PDSIOCS  DS    A
SQRTINC  DS    F
SQRTVALU DS    F
XVAL     DS    F
YVAL     DS    F
MAXVALU  DS    F
KYPOSIT  DS    F
IXPRMPTR DS    A
DALGLPTR DS    A
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
PARMINDX DS    H
J        DS    H
DRHS     DS    H
ADDCOUNT DS    H
NOWYEAR  DS    H
DAYPERYR DS    H
MIGRLOOP DS    H
CYCLECNT DS    FL1
LISTLN   DS    FL1
@TS00001 DS    CL95
DEFINED  DS    BL1
NEWNAME  DS    CL44
@NM00054 DS    CL14
         ORG   @NM00054
ALSTIDLB DS    CL9
ALSTID   DS    CL5
         ORG   ALSTID
ALMODID  DS    CL3
ALSTCOND DS    AL1
ALSTD    DS    AL1
         ORG   @NM00054+14
         DS    CL2
@NM00055 DS    CL12
         ORG   @NM00055
CATRTNID DS    CL8
CTGRTNCC DS    FL4
         ORG   @NM00055+12
LOCTABLE DS    CL80
         ORG   LOCTABLE
LCETYPLN DS    FL4
LCETYPPT DS    AL4
LCACBLN  DS    FL4
LCACBPT  DS    AL4
LCNAMLN  DS    FL4
LCNAMPT  DS    AL4
LCRBALN  DS    FL4
LCRBAPT  DS    AL4
LCCRALN  DS    FL4
LCCRAPT  DS    AL4
LCPSWLN  DS    FL4
LCPSWPT  DS    AL4
LCDATRLN DS    FL4
LCDATRPT DS    AL4
LCAMDLN  DS    FL4
LCAMDPT  DS    AL4
LCRATRLN DS    FL4
LCRATRPT DS    AL4
LCGATRLN DS    FL4
LCGATRPT DS    AL4
         ORG   LOCTABLE+80
ALRGATTR DS    CL2
         ORG   ALRGATTR
ALRGPARM DS    BL1
         ORG   ALRGPARM
ALUPGUPD DS    BL1
@NM00077 EQU   ALRGPARM+0
         ORG   ALRGATTR+1
ALRGSPEC DS    BL1
         ORG   ALRGSPEC
ALUPSPEC DS    BL1
@NM00078 EQU   ALRGSPEC+0
         ORG   ALRGATTR+2
ALOPNAGL DS    BL48
         DS    CL2
DARGAREA DS    CL60
ALGLSAVE DS    CL20
         ORG   ALGLSAVE
ALSAVPTR DS    0A
         ORG   ALGLSAVE+20
ALERRTBL DS    CL32
ALLLIST  DS    CL31
RENEWCPL DS    CL28
CIRLIST  DS    CL32
CATNAME  DS    CL44
         DS    CL1
ENTRIES  DS    CL49
         ORG   ENTRIES
ENTRYLEN DS    FL2
@NM00080 DS    CL2
ATYPE    DS    CL1
ENTRYVAL DS    CL44
         ORG   ENTRIES+49
         DS    CL3
QUALLIST DS    CL12
         ORG   QUALLIST
QUALADDR DS    AL4
QUALCAT  DS    AL4
QUALPAS  DS    AL4
         ORG   QUALLIST+12
BYPASSSW DS    BL1
DATACI   DS    CL3
INDEXCI  DS    CL3
BDATACI  DS    CL3
BCLUSCI  DS    CL3
CKTYPE   DS    CL1
CYCLEFLG DS    CL1
         DS    CL5
EXPIREDT DS    CL8
         ORG   EXPIREDT
@NM00084 DS    CL5
EXPIRE   DS    CL3
         ORG   EXPIRE
EXPIRYR  DS    FL1
EXPIRDAY DS    FL2
         ORG   EXPIREDT+8
DATELOOP DS    CL1
         DS    CL7
XCURDATE DS    CL8
         ORG   XCURDATE
@NM00085 DS    CL1
XUTYEAR  DS    FL1
XUTDAY   DS    FL2
         ORG   XCURDATE+8
TIMEODAY DS    CL8
DAYTOTL  DS    CL8
         ORG   DAYTOTL
@NM00086 DS    CL6
DAYTOTAL DS    FL2
         ORG   DAYTOTL+8
MIGRFLAG DS    CL1
         DS    CL3
PDSLIST  DS    BL48
HURBAWKA DS    CL8
         ORG   HURBAWKA
HURTOTLN DS    FL2
HURRETLN DS    FL2
HURBADS  DS    FL4
         ORG   HURBAWKA+8
ASSOCWKA DS    CL32
         ORG   ASSOCWKA
ASSTOTLN DS    FL2
ASSRETLN DS    FL2
@NM00087 DS    CL28
         ORG   ASSOCWKA+32
AMDSBWKA DS    CL140
         ORG   AMDSBWKA
AMDTOTLN DS    FL2
AMDRETLN DS    FL2
@NM00088 DS    CL96
@NM00089 DS    CL40
         ORG   AMDSBWKA+140
SQRTSW   DS    BL1
NEWNAMLN DS    CL44
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCAL01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
NAMEMASK DC    H'5'
@CC01394 DC    C'HERE I AM'
@CC01396 DC    C'CATLGRTN'
@CC01582 DC    C'IXCPL'
@CC00205 DC    C'NAME'
@CC01147 DC    C'AL01'
@CC01425 DC    C'AL04'
@CC01430 DC    C'AL02'
@CC01441 DC    C'AL31'
@CC01444 DC    C'TYPE'
@CC01448 DC    C'PSWD'
@CC01449 DC    C'DSAT'
@CC01450 DC    C'AMDB'
@CC01452 DC    C'RGAT'
@CC01453 DC    C'TEST'
@CC01456 DC    C'AL03'
@CC01492 DC    C'AL41'
@CC01503 DC    C'OWNR'
@CC01504 DC    C'EEXT'
@CC01508 DC    C'LREC'
@CC01509 DC    C'BUFS'
@CC01517 DC    C'ALMR'
@CC01543 DC    C'AL51'
@CC01552 DC    C'AL52'
@CC01558 DC    C'AL53'
@CC01561 DC    C'AL54'
@CC01562 DC    C'AL55'
@CC01563 DC    C'AL56'
@CC01581 DC    C'AL61'
@CC01583 DC    C'IFVT'
@CC01620 DC    C'AL71'
@CC01426 EQU   @CC01147
@CC01442 DC    C'CPL'
@CC01445 DC    C'ACB'
@CC01446 DC    C'RBA'
@CC01447 DC    C'CRA'
@CC01451 DC    C'GDG'
@CC01493 DC    C'FVT'
@CC00855 EQU   @CC01449
@CC00859 EQU   @CC01147
@CB01016 DC    X'E4E5F00807'
@CB01025 DC    X'C1D3F00803'
@CB01028 DC    X'C1D3F00C0C'
@CB01031 DC    X'C1D3F00C0D'
@CB01034 DC    X'E4E5F00001'
@CB01039 DC    X'E4E5F00C04'
@CB01042 DC    X'E4E5F00C03'
@CB01045 DC    X'C1D3F00C04'
@CB01048 DC    X'C1D3F00C17'
@CB01052 DC    X'C1D3F0080A'
@CB01055 DC    X'C1D3F0080B'
@CB01058 DC    X'C1D3F00808'
@CB01061 DC    X'C1D3F00007'
@CB01064 DC    X'C1D3F00C05'
@CB01067 DC    X'C1D3F00C09'
@CB01070 DC    X'C1D3F00C02'
@CB01073 DC    X'C1D3F00C06'
@CB01076 DC    X'C1D3F00C16'
@CB01079 DC    X'C1D3F00C0E'
@CB01082 DC    X'C1D3F00C11'
@CB01086 DC    X'C1D3F00C0F'
@CB01089 DC    X'C1D3F00C10'
@CB01092 DC    X'C1D3F00C14'
@CB01095 DC    X'C1D3F00C15'
@CB01098 DC    X'C1D3F00C18'
@CB01568 DC    X'00000000'
@CB01495 DC    X'00000F'
@CB01498 DC    X'99999F'
@CB01457 DC    X'FFFF'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
NULLMASK DC    X'FFFFFFFFFFFFFFFF'
INITVALU DC    X'FFFFFF'
NULLCRA  DC    X'000000000000'
MODID    DC    CL4'AL01'
FIXAREA  DS    CL512
         ORG   FIXAREA
@NM00050 DS    CL256
         ORG   @NM00050
@NM00051 DC    256X'00'
         ORG   FIXAREA+256
@NM00052 DS    CL256
         ORG   @NM00052
@NM00053 DC    256X'00'
         ORG   FIXAREA+512
ALGPID   DC    CL4'AL00'
ALGPID2  DC    CL4'AL77'
RENAMMEM DC    CL1'R'
PASSWORD DC    CL8'PASSWORD'
DALCUNIT DS    CL22
         ORG   DALCUNIT
DL#UNIT  DC    H'2'
DUNITLN1 DC    H'8'
DLUNIT1  DC    CL8'SYSALLDA'
DUNITLN2 DC    H'8'
DLUNIT2  DC    CL8'SYSALLDA'
         ORG   DALCUNIT+22
ALFLDNAM DC    CL8'ENTYPE'
         DC    CL8'CATACB'
         DC    CL8'NAMEDS'
         DC    CL8'HURBADS'
         DC    CL8'CRAVOL'
         DC    CL8'PASSWALL'
         DC    CL8'DSATTR'
         DC    CL8'AMDSBCAT'
         DC    CL8'RGATTR'
         DC    CL8'GDGATTR'
         DC    CL8'DSETEXDT'
         DC    CL8'OWNERID'
         DC    CL8'BUFSIZE'
         DC    CL8'EXCPEXIT'
         DC    CL8'LRECL'
         DC    CL8'CNTREPNO'
PARMTAB  DC    CL13'STAGE'
         DC    CL13'BIND'
         DC    CL13'CYLINDERFAULT'
         DC    CL13'DESTAGEWAIT'
         DC    CL13'NODESTAGEWAIT'
         DC    CL13'WRITECHECK'
         DC    CL13'NOWRITECHECK'
         DC    CL13'FREESPACE'
         DC    CL13'UNIQUEKEY'
         DC    CL13'NONUNIQUEKEY'
         DC    CL13'ERASE'
         DC    CL13'NOERASE'
         DC    CL13'SHAREOPTIONS'
         DC    CL13'INHIBIT'
         DC    CL13'UNINHIBIT'
         DC    CL13'EMPTY'
         DC    CL13'NOEMPTY'
         DC    CL13'SCRATCH'
         DC    CL13'NOSCRATCH'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RTNREG   EQU   @15
REG5     EQU   @05
REG6     EQU   @06
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSAQL0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
CIRTYP1Q EQU   CIRTYPE
CIRHLN   EQU   CIRAGL+4
CIRTLN   EQU   CIRAGL+6
CIRHDR   EQU   CIRAGL+8
CIRTLR   EQU   CIRAGL+12
CIRWKP   EQU   CIRAGL+16
CIRCAT   EQU   CIRAGL+20
CIRPWD   EQU   CIRAGL+24
CIRPID   EQU   CIRAGL+28
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLPWD   EQU   ALLAGL+20
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOST0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTOT EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNDSOPO EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
ERCATAL  EQU   EROPER
EROSOPER EQU   ERCNVTAB+2
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
NTRY     EQU   0
NTRYPLN  EQU   NTRY
NTRYPAS  EQU   NTRY+1
NTRYPOS  EQU   NTRY+9
NTRYFLG  EQU   NTRY+10
NTRYFUQ  EQU   NTRYFLG
NTRYMLN  EQU   NTRY+11
NTRYMEM  EQU   NTRY+12
NTRYLEN  EQU   NTRY+20
NTRYVAL  EQU   NTRY+21
CATLG    EQU   0
CATLGPLN EQU   CATLG
CATLGPAS EQU   CATLG+1
CATLGFLG EQU   CATLG+10
CATLGLEN EQU   CATLG+20
CATLGVAL EQU   CATLG+21
CATDN    EQU   0
NEWNM    EQU   0
NEWNMPOS EQU   NEWNM+9
NEWNMFLG EQU   NEWNM+10
NEWNMFUQ EQU   NEWNMFLG
NEWNMMEM EQU   NEWNM+12
NEWNMLEN EQU   NEWNM+20
NEWNMVAL EQU   NEWNM+21
INDD     EQU   0
INDDVAL  EQU   INDD+1
MASTR    EQU   0
MASTRVAL EQU   MASTR+1
CNTVL    EQU   0
CNTVLVAL EQU   CNTVL+1
UPDAT    EQU   0
UPDATVAL EQU   UPDAT+1
READ     EQU   0
READVAL  EQU   READ+1
CODNM    EQU   0
CODNMVAL EQU   CODNM+1
ATTP     EQU   0
ATTPVAL  EQU   ATTP
AUTH     EQU   0
USVR     EQU   0
USVRVAL  EQU   USVR+1
USAR     EQU   0
USARLEN  EQU   USAR
USARVAL  EQU   USAR+1
TO       EQU   0
TOVAL    EQU   TO
FOR      EQU   0
FORVAL   EQU   FOR
OWNER    EQU   0
OWNERVAL EQU   OWNER+1
ERASE    EQU   0
NERAS    EQU   0
SHARE    EQU   0
SHAR1    EQU   0
SHAR1VAL EQU   SHAR1
SHAR2    EQU   0
SHAR2VAL EQU   SHAR2
NMSTR    EQU   0
NCNTV    EQU   0
NUPDT    EQU   0
NREAD    EQU   0
NOWNR    EQU   0
NCDNM    EQU   0
NRETN    EQU   0
NAUTH    EQU   0
NMDNM    EQU   0
NSTRG    EQU   0
NEEXT    EQU   0
FSPAC    EQU   0
FSPCI    EQU   0
FSPCIVAL EQU   FSPCI
FSPCA    EQU   0
FSPCAVAL EQU   FSPCA
WRTCK    EQU   0
NWTCK    EQU   0
BUFSZ    EQU   0
BUFSZVAL EQU   BUFSZ
ADDVL    EQU   0
ADDVLCNT EQU   ADDVL
@NM00037 EQU   ADDVL+2
ADDVLVAL EQU   @NM00037+1
REMVL    EQU   0
REMVLCNT EQU   REMVL
@NM00038 EQU   REMVL+2
REMVLVAL EQU   @NM00038+1
INHIB    EQU   0
UNHIB    EQU   0
GDGEM    EQU   0
GDGNE    EQU   0
GDGSC    EQU   0
GDGNS    EQU   0
EEXT     EQU   0
EEXTVAL  EQU   EEXT+1
KEY      EQU   0
KEYLN    EQU   0
KEYLNVAL EQU   KEYLN
KEYPS    EQU   0
KEYPSVAL EQU   KEYPS
RECSZ    EQU   0
AREC     EQU   0
ARECVAL  EQU   AREC
MREC     EQU   0
MRECVAL  EQU   MREC
UNQK     EQU   0
NUNQK    EQU   0
UPG      EQU   0
NUPG     EQU   0
UPD      EQU   0
NUPD     EQU   0
STAGE    EQU   0
BIND     EQU   0
CYLF     EQU   0
NSTGW    EQU   0
STGW     EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGBYPSS EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDCD EQU   CTGFL+1
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLCHN EQU   CTGFL+12
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDWCK   EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDSPAN  EQU   AMDATTR
AMDNEST  EQU   IDAAMDSB+4
AMDAXRKP EQU   AMDNEST
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDPCTCA EQU   IDAAMDSB+10
AMDPCTCI EQU   IDAAMDSB+11
AMDCIPCA EQU   IDAAMDSB+12
AMDFSCA  EQU   IDAAMDSB+14
AMDFSCI  EQU   IDAAMDSB+16
AMDCINV  EQU   IDAAMDSB+20
AMDLRECL EQU   IDAAMDSB+24
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDUNQ   EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDSTAT  EQU   IDAAMDSB+48
CTGFV    EQU   0
CTGFVTYP EQU   CTGFV
CTGFVPRO EQU   CTGFV+1
CTGFVAVL EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVIND EQU   CTGFV+16
CTGFVENT EQU   CTGFV+20
CTGFVSTY EQU   CTGFV+24
CTGFVOWN EQU   CTGFV+28
CTGFVEXP EQU   CTGFV+32
CTGFVVLT EQU   CTGFV+40
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVATR EQU   CTGFV+60
CTGFVBUF EQU   CTGFV+64
CTGFVLRS EQU   CTGFV+68
CTGFVLMT EQU   CTGFV+72
CTGFVEXT EQU   CTGFVLMT
CTGFVGAT EQU   CTGFV+76
CTGFVUPG EQU   CTGFVGAT
NULLPARM EQU   0
ALCTGPRM EQU   0
ALCPLID  EQU   ALCTGPRM
ALCTGPL  EQU   ALCTGPRM+8
ALCTGFLD EQU   ALCTGPRM+36
ALFVTID  EQU   ALCTGPRM+76
ALCTGFVT EQU   ALCTGPRM+80
ALFPLLST EQU   ALCTGPRM+180
ALTYP    EQU   ALFPLLST
ALFPLTYP EQU   ALFPLLST+4
ALACB    EQU   ALFPLLST+28
ALFPLACB EQU   ALFPLLST+32
ALNAM    EQU   ALFPLLST+56
ALFPLNAM EQU   ALFPLLST+60
ALRBA    EQU   ALFPLLST+84
ALFPLRBA EQU   ALFPLLST+88
ALCRA    EQU   ALFPLLST+112
ALFPLCRA EQU   ALFPLLST+116
ALPSW    EQU   ALFPLLST+140
ALFPLPSW EQU   ALFPLLST+144
ALDAT    EQU   ALFPLLST+168
ALFPLDAT EQU   ALFPLLST+172
ALAMD    EQU   ALFPLLST+196
ALFPLAMD EQU   ALFPLLST+200
ALRGA    EQU   ALFPLLST+224
ALFPLRGA EQU   ALFPLLST+228
ALGDG    EQU   ALFPLLST+252
ALFPLGDG EQU   ALFPLLST+256
ALFPLEXP EQU   ALFPLLST+284
ALOWN    EQU   ALFPLLST+308
ALFPLOWN EQU   ALFPLLST+312
ALBUF    EQU   ALFPLLST+336
ALFPLBUF EQU   ALFPLLST+340
ALEEX    EQU   ALFPLLST+364
ALFPLEEX EQU   ALFPLLST+368
ALLRC    EQU   ALFPLLST+392
ALFPLLRC EQU   ALFPLLST+396
ALNAMTST EQU   ALFPLLST+420
ALFPLTST EQU   ALFPLLST+424
ALWKAREA EQU   ALCTGPRM+628
LCETYPVL EQU   0
LCACBVAL EQU   0
LCNAMEDS EQU   0
LCNAMID  EQU   LCNAMEDS
LCNAMCI  EQU   LCNAMEDS+1
LCHURBA  EQU   0
LCCRAVOL EQU   0
LCPSWALL EQU   0
LCPSWFXD EQU   LCPSWALL
LCMSTRPW EQU   LCPSWFXD
LCCINTPW EQU   LCPSWFXD+8
LCUPDTPW EQU   LCPSWFXD+16
LCREADPW EQU   LCPSWFXD+24
LCPWPRMT EQU   LCPSWFXD+32
LCPWATTP EQU   LCPSWFXD+40
LCPWDATP EQU   LCPWATTP
LCVRMDUL EQU   LCPSWFXD+42
LCARECLN EQU   LCPSWFXD+50
LCUAREC  EQU   LCPSWALL+52
LCDSATR  EQU   0
@NM00073 EQU   LCDSATR
LCERASE  EQU   @NM00073
LCINHIB  EQU   @NM00073
@NM00074 EQU   LCDSATR+1
SHAROPT1 EQU   @NM00074
SHAROPT2 EQU   @NM00074
LCRGATTR EQU   0
@NM00075 EQU   LCRGATTR
LCGDGATR EQU   0
LCEMPTY  EQU   LCGDGATR
LCSCRTCH EQU   LCGDGATR
VLISTLEN EQU   0
GENLIST  EQU   0
GENNUM   EQU   GENLIST
GENENTRY EQU   GENLIST+4
ENTTYP   EQU   GENENTRY
ENTVAL   EQU   GENENTRY+1
LOCATWKA EQU   0
MYLENGTH EQU   LOCATWKA
REQDLEN  EQU   LOCATWKA+2
ALVLIST  EQU   0
ALVLSTLN EQU   ALVLIST
@NM00082 EQU   ALVLIST+2
ALVLSTCD EQU   @NM00082
ALVOLUME EQU   @NM00082+2
NULLPSWD EQU   0
OPNDSVAL EQU   0
IXCTGPRM EQU   0
IXCPLID  EQU   IXCTGPRM
IXFVTID  EQU   IXCTGPRM+68
IXCTGFVT EQU   IXCTGPRM+72
IXAMD    EQU   IXCTGPRM+172
IXFPLAMD EQU   IXCTGPRM+176
IXWKAREA EQU   IXCTGPRM+200
FVTVLIST EQU   0
FVTVLEN  EQU   FVTVLIST
@NM00090 EQU   FVTVLIST+2
FVTVSER  EQU   @NM00090+2
ALCVLIST EQU   0
ALC#ENT  EQU   ALCVLIST
@NM00092 EQU   ALCVLIST+2
ALCVLEN  EQU   @NM00092
ALCVSER  EQU   @NM00092+2
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CAT      EQU   0
DMPTRM   EQU   0
DSNAME   EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACL0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NULLF    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
ACATACB  EQU   0
ETYPE    EQU   0
REQTYPE  EQU   0
DALVLPTR EQU   0
DALDNMPT EQU   0
DALINDEX EQU   0
@NM00044 EQU   CTGDDNM
CTGPROB  EQU   @NM00044
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00091 EQU   @NM00090
IXCTGPL  EQU   IXCTGPRM+8
@NM00083 EQU   @NM00082+1
@NM00081 EQU   LOCATWKA+4
@NM00079 EQU   LCGDGATR
@NM00076 EQU   @NM00075
LCUPGUPD EQU   @NM00075
LCRVBL   EQU   @NM00073
LCRUS    EQU   @NM00073
LCUNIQ   EQU   @NM00073
LCSPEED  EQU   @NM00073
@NM00072 EQU   ALFPLLST+440
@NM00071 EQU   ALFPLLST+412
@NM00070 EQU   ALFPLLST+384
@NM00069 EQU   ALFPLLST+356
@NM00068 EQU   ALFPLLST+328
@NM00067 EQU   ALFPLLST+300
ALEXP    EQU   ALFPLLST+280
@NM00066 EQU   ALFPLLST+272
@NM00065 EQU   ALFPLLST+244
@NM00064 EQU   ALFPLLST+216
@NM00063 EQU   ALFPLLST+188
@NM00062 EQU   ALFPLLST+160
@NM00061 EQU   ALFPLLST+132
@NM00060 EQU   ALFPLLST+104
@NM00059 EQU   ALFPLLST+76
@NM00058 EQU   ALFPLLST+48
@NM00057 EQU   ALFPLLST+20
@NM00056 EQU   ALCTGPRM+172
CTGFVWKA EQU   CTGFV+88
CTGFVPWD EQU   CTGFV+84
CTGFVNAM EQU   CTGFV+80
CTGFVFSN EQU   CTGFVAMD
CTGFVTTR EQU   CTGFVSPC
CTGFVDVT EQU   CTGFV+48
CTGFVRNG EQU   CTGFV+44
CTGFVCRE EQU   CTGFV+36
CTGFVVCH EQU   CTGFV+12
CTGFVICH EQU   CTGFV+8
CTGFVDCH EQU   CTGFV+4
@NM00049 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00048 EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00047 EQU   IDAAMDSB+41
@NM00046 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLEN   EQU   IDAAMDSB+2
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00045 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
@NM00043 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00042 EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
@NM00041 EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
@NM00040 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00039 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
EEXTLEN  EQU   EEXT
REMVLLEN EQU   @NM00038
ADDVLLEN EQU   @NM00037
OWNERLEN EQU   OWNER
USVRLEN  EQU   USVR
CODNMLEN EQU   CODNM
READLEN  EQU   READ
UPDATLEN EQU   UPDAT
CNTVLLEN EQU   CNTVL
MASTRLEN EQU   MASTR
INDDLEN  EQU   INDD
NEWNMMLN EQU   NEWNM+11
NEWNMPAS EQU   NEWNM+1
NEWNMPLN EQU   NEWNM
CATDNVAL EQU   CATDN+1
CATDNLEN EQU   CATDN
CATLGMEM EQU   CATLG+12
CATLGMLN EQU   CATLG+11
CATLGFUQ EQU   CATLGFLG
CATLGPOS EQU   CATLG+9
@NM00036 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00035 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00034 EQU   ERCNVTAB+24
@NM00033 EQU   ERCNVTAB+4
@NM00032 EQU   ERCNVTAB+3
@NM00031 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00030 EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
@NM00029 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
@NM00028 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00027 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00026 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGREP  EQU   DARGINS
@NM00025 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00024 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00023 EQU   OPNAGL+43
@NM00022 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00428 EQU   @RC00402
@RC00503 EQU   @RC00488
@RF00844 EQU   @EL00002
@RF00846 EQU   @EL00002
@RF01339 EQU   @EL00003
@RF01377 EQU   @EL00003
@RF01545 EQU   @RC01542
@RC01550 EQU   @RC01548
@RF01583 EQU   @RC01579
@RC01680 EQU   @RC01678
@RC01698 EQU   @RC01697
@RT01708 EQU   @RC01707
@RF01870 EQU   @RC01850
@RC01978 EQU   @RC01976
@RF01991 EQU   @EL00005
@RF01998 EQU   @EL00005
@RF02000 EQU   @EL00005
@RF02105 EQU   @EL00007
@RC02117 EQU   @EL00008
@PB00008 EQU   @EL00001
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCAL01,(C'PLS1034',0701,77271)

         TITLE '****** IDCRC02: EXPORTRA/EXPORT FUNCTION SUPPORT ROUTIN*
               NE ******'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRC02  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRC02   77.235'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(8),0(@01)                                  0002
*                                                                  0260
*                                                                  0260
*        /************************************************************/
*        /*                                                          */
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */
*        /*   EXPORT ROUTINE.  THIS SECTION DETERMINES WHETHER A     */
*        /*   NON VSAM OR A GDG OR A CLUSTER OR AIX IS TO BE EXPORTED*/
*        /*   AND CALLS THE CORRESPONDING OBJECT PROCESSOR.          */
*        /*   TERMINATION PROCESSING IS ALSO HANDLED IN THIS SECTION,*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0260
*        OLDERID2 = NEWERID2;                                      0260
         L     @15,@PC00001                                        0260
         L     @14,GDTTR2(,@15)                                    0260
         MVC   @TS00001(95),NEWERID2(@14)                          0260
         MVC   OLDERID2(95,@14),@TS00001                           0260
*        NEWID2 = 'RC01';                                          0261
*                                                                  0261
         MVC   NEWID2(4,@14),@CC01043                              0261
*        IF GDTDBG = NULLPTR                                       0262
*          THEN;                                                   0262
         L     @15,GDTDBG(,@15)                                    0262
         LTR   @15,@15                                             0262
         BZ    @RT00262                                            0262
*          ELSE                                                    0264
*            CALL IDCDB010 (GDTTBL,'RC02');                        0264
*                                                                  0264
         L     @15,@PC00001                                        0264
         ST    @15,@AL00001                                        0264
         LA    @14,@CC00814                                        0264
         ST    @14,@AL00001+4                                      0264
         MVI   @AL00001+4,X'80'                                    0264
         L     @15,GDTDBG(,@15)                                    0264
         LA    @01,@AL00001                                        0264
         BALR  @14,@15                                             0264
*        SETRC = 0;                                                0265
*                                                                  0265
@RT00262 SLR   SETRC,SETRC                                         0265
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE STORAGE AREA FOR UPRINT ARGUMENT LISTS       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0266
*        DO I= 1 TO 9;                                             0266
         LA    I,1                                                 0266
@DL00266 DS    0H                                                  0267
*          PRINTTAB(I) = NULLPTR;                                  0267
         LR    @05,I                                               0267
         SLA   @05,2                                               0267
         SLR   @02,@02                                             0267
         ST    @02,PRINTTAB-4(@05)                                 0267
*        END;                                                      0268
*                                                                  0268
         AL    I,@CF00218                                          0268
         C     I,@CF00037                                          0268
         BNH   @DL00266                                            0268
*        DDSTRU = ADDR(PRINTTAB);                                  0269
         LA    @02,PRINTTAB                                        0269
         ST    @02,DDSTRU                                          0269
*        DARGLIST = ''B;                                           0270
*                                                                  0270
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0270
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE THE MAXIMUM RECORDSIZE AND INPUT IOCS POINTER */
*        /*                                                          */
*        /************************************************************/
*                                                                  0271
*        RECSZ = OUTLEN;                                           0271
         L     @02,@PC00001+4                                      0271
         L     @02,INPPTR(,@02)                                    0271
         L     @02,INPTBL+4(,@02)                                  0271
         L     @15,OUTLEN(,@02)                                    0271
         ST    @15,RECSZ                                           0271
*        PINIOCS = NULLPTR;                                        0272
*                                                                  0272
         SLR   @15,@15                                             0272
         ST    @15,PINIOCS                                         0272
*        /************************************************************/
*        /*                                                          */
*        /*  DETERMINE IF FIRST REQUEST.                             */
*        /*  OPEN OUTPUT DATA SET ON FIRST REQUEST ONLY,             */
*        /*   AND INITIALIZE OUTPUT BLOCKSIZE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0273
*        IF OPNFLG = OFF                                           0273
*          THEN                                                    0273
         TM    OPNFLG(@02),B'10000000'                             0273
         BNZ   @RF00273                                            0273
*FSTREQ:     DO;                                                   0274
*                                                                  0274
FSTREQ   DS    0H                                                  0275
*            POUTIOCS = NULLPTR;                                   0275
         SLR   @02,@02                                             0275
         ST    @02,POUTIOCS                                        0275
*            BLKSZ = USBKSZ;                                       0276
*                                                                  0276
         L     @02,@PC00001+4                                      0276
         L     @02,INPPTR(,@02)                                    0276
         L     @01,INPTBL+4(,@02)                                  0276
         L     @15,USBKSZ(,@01)                                    0276
         ST    @15,BLKSZ                                           0276
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN OUTPUT DATA SET - THE PORTABILITY DATA SET     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0277
*            CALL OPENPROC('O',ADDR(OUTDDNM),NULLPARM,RECSZ,BLKSZ, 0277
*             ADDR(POUTIOCS));                                     0277
*                                                                  0277
         LA    @15,@CC01048                                        0277
         ST    @15,@AL00001                                        0277
         LA    @02,INPTBL+12(,@02)                                 0277
         ST    @02,@AL00001+4                                      0277
         LA    @02,NULLPARM                                        0277
         ST    @02,@AL00001+8                                      0277
         LA    @02,RECSZ                                           0277
         ST    @02,@AL00001+12                                     0277
         LA    @02,BLKSZ                                           0277
         ST    @02,@AL00001+16                                     0277
         LA    @02,POUTIOCS                                        0277
         ST    @02,@AFTEMPS+16                                     0277
         LA    @02,@AFTEMPS+16                                     0277
         ST    @02,@AL00001+20                                     0277
         LA    @01,@AL00001                                        0277
         BAL   @14,OPENPROC                                        0277
*            /********************************************************/
*            /*                                                      */
*            /* TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL      */
*            /* RETURN TO CALLING PROCESSOR WITH ERROR INDICATED     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0278
*            RESPECIFY RTNREG RSTD;                                0278
*            TESTRC = RTNREG;                                      0279
         LR    TESTRC,RTNREG                                       0279
*            RESPECIFY RTNREG UNRSTD;                              0280
*            IF TESTRC ^= 0                                        0281
*              THEN                                                0281
         LTR   TESTRC,TESTRC                                       0281
         BZ    @RF00281                                            0281
*                SETRC = LASTCC16;                                 0282
         LA    SETRC,16                                            0282
*              ELSE                                                0283
*                DO;                                               0283
*                                                                  0283
         B     @RC00281                                            0283
@RF00281 DS    0H                                                  0284
*                /****************************************************/
*                /*                                                  */
*                /* SAVE POINTER TO IOCS FOR THE OUTPUT DATA SET     */
*                /*                                                  */
*                /****************************************************/
*                                                                  0284
*                SAVOIOCS = POUTIOCS;                              0284
*                                                                  0284
         L     @15,@PC00001+4                                      0284
         L     @01,INPPTR(,@15)                                    0284
         L     @01,INPTBL+4(,@01)                                  0284
         L     @00,POUTIOCS                                        0284
         ST    @00,SAVOIOCS(,@01)                                  0284
*                /****************************************************/
*                /*                                                  */
*                /* WRITE SPECIAL HEADER CONTAINING RECORDSIZE       */
*                /*                                                  */
*                /****************************************************/
*                                                                  0285
*                /****************************************************/
*                /*                                                  */
*                /*GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER  */
*                /* IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR*/
*                /*                                                  */
*                /****************************************************/
*                                                                  0285
*                CALL IDCSAGP0 (GDTTBL,LENGTH(HEADER),CONRCPTR,GPID,
*                  SETZERO);                                       0285
*                                                                  0285
         MVC   @AL00001+4(16),@AL00285                             0285
         L     @15,@PC00001                                        0285
         ST    @15,@AL00001                                        0285
         LA    @14,CONRCPTR                                        0285
         ST    @14,@AL00001+8                                      0285
         L     @15,GDTGPL(,@15)                                    0285
         LA    @01,@AL00001                                        0285
         BALR  @14,@15                                             0285
*                RESPECIFY RTNREG RSTD;                            0286
*                TESTRC = RTNREG;                                  0287
         LR    TESTRC,RTNREG                                       0287
*                RESPECIFY RTNREG UNRSTD;                          0288
*                IF TESTRC ^= 0                                    0289
*                  THEN                                            0289
         LTR   TESTRC,TESTRC                                       0289
         BZ    @RF00289                                            0289
*                    DO;                                           0290
*                    DARGSMOD = UNIVMSG;                           0291
         L     @02,DDSTRU                                          0291
         MVC   DARGSMOD(3,@02),@CC00847                            0291
*                    DARGSENT = NOSTORAG;                          0292
         MVI   DARGSENT(@02),X'04'                                 0292
*                    SETRC = LASTCC16;                             0293
         LA    SETRC,16                                            0293
*                    END;                                          0294
*                                                                  0294
*                  ELSE                                            0295
*                    DO;                                           0295
         B     @RC00289                                            0295
@RF00289 DS    0H                                                  0296
*                    HEADLN = LENGTH(HEADER);                      0296
         L     @02,CONRCPTR                                        0296
         LA    @15,8                                               0296
         STH   @15,HEADLN(,@02)                                    0296
*                    HEADFLG1 = HDFL1HED;                          0297
         MVI   HEADFLG1(@02),X'03'                                 0297
*                    HEADFLG2 = HDFL2HED;                          0298
         MVI   HEADFLG2(@02),X'FF'                                 0298
*                    RECORDSZ = OUTLEN;                            0299
         L     @14,@PC00001+4                                      0299
         L     @01,INPPTR(,@14)                                    0299
         L     @01,INPTBL+4(,@01)                                  0299
         L     @14,OUTLEN(,@01)                                    0299
         ST    @14,RECORDSZ(,@02)                                  0299
*                    TOTLEN = HEADLN;                              0300
*                                                                  0300
         ST    @15,TOTLEN                                          0300
*                    CALL  PUTPROC(TOTLEN,CONRCPTR);               0301
*                                                                  0301
         LA    @02,TOTLEN                                          0301
         ST    @02,@AL00001                                        0301
         LA    @02,CONRCPTR                                        0301
         ST    @02,@AL00001+4                                      0301
         LA    @01,@AL00001                                        0301
         BAL   @14,PUTPROC                                         0301
*                    RESPECIFY RTNREG RSTD;                        0302
*                    TESTRC = RTNREG;                              0303
         LR    TESTRC,RTNREG                                       0303
*                    RESPECIFY RTNREG UNRSTD;                      0304
*                    IF TESTRC ^= 0                                0305
*                      THEN                                        0305
         LTR   TESTRC,TESTRC                                       0305
         BZ    @RF00305                                            0305
*                        SETRC = LASTCC16;                         0306
         LA    SETRC,16                                            0306
*                      ELSE                                        0307
*                        OPNFLG = ON;  /* OPEN PROCESSING FOR OUTPUT */
         B     @RC00305                                            0307
@RF00305 L     @02,@PC00001+4                                      0307
         L     @02,INPPTR(,@02)                                    0307
         L     @02,INPTBL+4(,@02)                                  0307
         OI    OPNFLG(@02),B'10000000'                             0307
*                                      /* NOT REQUIRED AFTER FIRST   */
*                                      /* CALL.                      */
*                    END;                                          0308
@RC00305 DS    0H                                                  0309
*                END;                                              0309
@RC00289 DS    0H                                                  0310
*            END  FSTREQ;                                          0310
@RC00281 DS    0H                                                  0311
*                                                                  0311
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK FOR SUCCESSFUL OPENING OF OUTPUT DATA SET AND     */
*        /*  LAST REQUEST FLAG                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0311
*        IF SETRC = 0 & ENDFLG = OFF                               0311
*          THEN                                                    0311
@RF00273 LTR   SETRC,SETRC                                         0311
         BNZ   @RF00311                                            0311
         L     @02,@PC00001+4                                      0311
         L     @02,INPPTR(,@02)                                    0311
         L     @02,INPTBL+4(,@02)                                  0311
         TM    ENDFLG(@02),B'01000000'                             0311
         BNZ   @RF00311                                            0311
*            DO;                                                   0312
*                                                                  0312
*            /********************************************************/
*            /*                                                      */
*            /*  INITIALIZE POINTERS TO CPL'S YET TO BE CONSTRUCTED  */
*            /*                                                      */
*            /********************************************************/
*                                                                  0313
*            DO I = 1 TO 5;                                        0313
         LA    I,1                                                 0313
@DL00313 DS    0H                                                  0314
*              PTRCPL(I) = NULLPTR;                                0314
         LR    @05,I                                               0314
         SLA   @05,2                                               0314
         SLR   @15,@15                                             0314
         ST    @15,PTRCPL-4(@05)                                   0314
*            END;                                                  0315
*                                                                  0315
         AL    I,@CF00218                                          0315
         C     I,@CF00285                                          0315
         BNH   @DL00313                                            0315
*            /********************************************************/
*            /*                                                      */
*            /*  INITIALIZE CATALOG ACB POINTER,                     */
*            /*  PROCESSING FLAGS,                                   */
*            /*  RESET POINTER TO IOCS FOR OUTPUT                    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0316
*            FLGTWO = FLGOFF;                                      0316
         IC    @05,FLGOFF                                          0316
         STC   @05,FLGTWO                                          0316
*            FLGS = FLGOFF;                                        0317
         IC    @05,FLGOFF                                          0317
         STC   @05,FLGS                                            0317
*            PTRCTACB = NULLPTR;                                   0318
         SLR   @05,@05                                             0318
         ST    @05,PTRCTACB                                        0318
*            POUTIOCS = SAVOIOCS;                                  0319
*                                                                  0319
         L     @05,@PC00001+4                                      0319
         L     @05,INPPTR(,@05)                                    0319
         L     @01,INPTBL+4(,@05)                                  0319
         L     @15,SAVOIOCS(,@01)                                  0319
         ST    @15,POUTIOCS                                        0319
*            /********************************************************/
*            /*                                                      */
*            /*  DETERMINE TYPE OF OBJECT TO BE PROCESSED            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0320
*            IF OBJTYP = CTGTCL × OBJTYP = CTGTAIX                 0320
*              THEN                                                0320
         L     @05,INPTBL(,@05)                                    0320
         CLI   OBJTYP(@05),C'C'                                    0320
         BE    @RT00320                                            0320
         CLI   OBJTYP(@05),C'G'                                    0320
         BNE   @RF00320                                            0320
@RT00320 DS    0H                                                  0321
*                DO;                                               0321
*                /****************************************************/
*                /*                                                  */
*                /*  PROCESS EXPORTATION OF VSAM OBJECT              */
*                /*                                                  */
*                /****************************************************/
*                                                                  0322
*                CALL CLUSPROC;                                    0322
*                                                                  0322
         BAL   @14,CLUSPROC                                        0322
*                RESPECIFY RTNREG RSTD;                            0323
*                TESTRC = RTNREG;                                  0324
         LR    TESTRC,RTNREG                                       0324
*                RESPECIFY RTNREG UNRSTD;                          0325
*                SETRC = TESTRC;                                   0326
         LR    SETRC,TESTRC                                        0326
*                END;                                              0327
*                                                                  0327
*              ELSE                                                0328
*                DO;                                               0328
         B     @RC00320                                            0328
@RF00320 DS    0H                                                  0329
*                /****************************************************/
*                /*                                                  */
*                /*  DETERMINE TYPE OF NON VSAM OBJECT               */
*                /*                                                  */
*                /****************************************************/
*                                                                  0329
*                IF OBJTYP = CTGTALIN × OBJTYP = CTGTUCAT          0329
*                  THEN                                            0329
         L     @05,@PC00001+4                                      0329
         L     @05,INPPTR(,@05)                                    0329
         L     @05,INPTBL(,@05)                                    0329
         CLI   OBJTYP(@05),C'A'                                    0329
         BE    @RT00329                                            0329
         CLI   OBJTYP(@05),C'U'                                    0329
         BNE   @RF00329                                            0329
@RT00329 DS    0H                                                  0330
*                    DO;                                           0330
*                    /************************************************/
*                    /*                                              */
*                    /* PROCESS EXPORTATION OF A NON VSAM OBJECT     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0331
*                    CALL NVSMPROC;                                0331
*                                                                  0331
         BAL   @14,NVSMPROC                                        0331
*                    RESPECIFY RTNREG RSTD;                        0332
*                    TESTRC = RTNREG;                              0333
         LR    TESTRC,RTNREG                                       0333
*                    RESPECIFY RTNREG UNRSTD;                      0334
*                    SETRC = TESTRC;                               0335
         LR    SETRC,TESTRC                                        0335
*                    END;                                          0336
*                                                                  0336
*                  ELSE                                            0337
*                    DO;                                           0337
         B     @RC00329                                            0337
@RF00329 DS    0H                                                  0338
*                    /************************************************/
*                    /*                                              */
*                    /*PROCESS EXPORTATION OF A GENERATION DATA GROUP*/
*                    /*                                              */
*                    /************************************************/
*                                                                  0338
*                    CALL GDGPROC;                                 0338
*                                                                  0338
         BAL   @14,GDGPROC                                         0338
*                    RESPECIFY RTNREG RSTD;                        0339
*                    TESTRC = RTNREG;                              0340
         LR    TESTRC,RTNREG                                       0340
*                    RESPECIFY RTNREG UNRSTD;                      0341
*                    SETRC = TESTRC;                               0342
         LR    SETRC,TESTRC                                        0342
*                    END;                                          0343
*                END;                                              0344
@RC00329 DS    0H                                                  0345
*            END;                                                  0345
@RC00320 DS    0H                                                  0346
*                                                                  0346
*        OLDERID2 = NEWERID2;                                      0346
@RF00311 L     @02,@PC00001                                        0346
         L     @15,GDTTR2(,@02)                                    0346
         MVC   @TS00001(95),NEWERID2(@15)                          0346
         MVC   OLDERID2(95,@15),@TS00001                           0346
*        NEWID2 = 'RC03';                                          0347
         MVC   NEWID2(4,@15),@CC01053                              0347
*        IF GDTDBG = NULLPTR                                       0348
*          THEN;                                                   0348
         L     @02,GDTDBG(,@02)                                    0348
         LTR   @02,@02                                             0348
         BZ    @RT00348                                            0348
*          ELSE                                                    0350
*            CALL IDCDB010 (GDTTBL,'RC04');                        0350
*                                                                  0350
         L     @02,@PC00001                                        0350
         ST    @02,@AL00001                                        0350
         LA    @15,@CC01054                                        0350
         ST    @15,@AL00001+4                                      0350
         MVI   @AL00001+4,X'80'                                    0350
         L     @15,GDTDBG(,@02)                                    0350
         LA    @01,@AL00001                                        0350
         BALR  @14,@15                                             0350
*        /************************************************************/
*        /*                                                          */
*        /*           CHECK FOR ANY MESSAGE TO PRINT                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0351
*        IF DARGSENT ^= NORMSTAT                                   0351
*          THEN                                                    0351
*                                                                  0351
@RT00348 L     @02,DDSTRU                                          0351
         CLI   DARGSENT(@02),0                                     0351
         BE    @RF00351                                            0351
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0352
*                                                                  0352
         L     @02,@PC00001                                        0352
         ST    @02,@AL00001                                        0352
         LA    @15,@CF00114                                        0352
         ST    @15,@AL00001+4                                      0352
         LA    @15,DDSTRU                                          0352
         ST    @15,@AL00001+8                                      0352
         MVI   @AL00001+8,X'80'                                    0352
         L     @15,GDTPRT(,@02)                                    0352
         LA    @01,@AL00001                                        0352
         BALR  @14,@15                                             0352
*        /************************************************************/
*        /*                                                          */
*        /*IF THIS WAS THE LAST REQUEST, CLOSE THE OUTPUT DATA SET   */
*        /*  CLOSE THE OUTPUT DATA SET.                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0353
*        IF ENDFLG = ON                                            0353
*          THEN                                                    0353
@RF00351 L     @02,@PC00001+4                                      0353
         L     @02,INPPTR(,@02)                                    0353
         L     @02,INPTBL+4(,@02)                                  0353
         TM    ENDFLG(@02),B'01000000'                             0353
         BNO   @RF00353                                            0353
*            DO;                                                   0354
*                                                                  0354
         ST    @02,@TF00001                                        0354
*            POUTIOCS = SAVOIOCS;                                  0355
*                                                                  0355
         L     @01,@TF00001                                        0355
         L     @15,SAVOIOCS(,@01)                                  0355
         ST    @15,POUTIOCS                                        0355
*            CALL IDCIOCL0(GDTTBL,POUTIOCS);                       0356
*                                                                  0356
         L     @15,@PC00001                                        0356
         ST    @15,@AL00001                                        0356
         LA    @14,POUTIOCS                                        0356
         ST    @14,@AL00001+4                                      0356
         MVI   @AL00001+4,X'80'                                    0356
         L     @15,GDTCLS(,@15)                                    0356
         LA    @01,@AL00001                                        0356
         BALR  @14,@15                                             0356
*            RESPECIFY RTNREG RSTD;                                0357
*            TESTRC = RTNREG;                                      0358
         LR    TESTRC,RTNREG                                       0358
*            RESPECIFY RTNREG UNRSTD;                              0359
*                                                                  0359
*            IF TESTRC ^= 0                                        0360
*              THEN                                                0360
         LTR   TESTRC,TESTRC                                       0360
         BZ    @RF00360                                            0360
*                SETRC = LASTCC16;                                 0361
*                                                                  0361
         LA    SETRC,16                                            0361
*            END;                                                  0362
*                                                                  0362
@RF00360 DS    0H                                                  0363
*        /************************************************************/
*        /*                                                          */
*        /* RETURN COMPLETION CODE AND FREE CORE FOR THIS REQUEST    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0363
*                                                                  0363
*        CALL  IDCSAFP0 (GDTTBL,GPID);                             0363
*                                                                  0363
@RF00353 L     @02,@PC00001                                        0363
         ST    @02,@AL00001                                        0363
         LA    @15,GPID                                            0363
         ST    @15,@AL00001+4                                      0363
         MVI   @AL00001+4,X'80'                                    0363
         L     @15,GDTFPL(,@02)                                    0363
         LA    @01,@AL00001                                        0363
         BALR  @14,@15                                             0363
*        /************************************************************/
*        /*                                                          */
*        /* CLOSE THE INPUT DATA SET IF IT'S STILL OPEN              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0364
*        IF PINIOCS ^= NULLPTR                                     0364
*          THEN                                                    0364
*                                                                  0364
         L     @02,PINIOCS                                         0364
         LTR   @02,@02                                             0364
         BZ    @RF00364                                            0364
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0365
*                                                                  0365
         L     @02,@PC00001                                        0365
         ST    @02,@AL00001                                        0365
         LA    @15,PINIOCS                                         0365
         ST    @15,@AL00001+4                                      0365
         MVI   @AL00001+4,X'80'                                    0365
         L     @15,GDTCLS(,@02)                                    0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*        /************************************************************/
*        /*                                                          */
*        /*CHECK FOR SUCCESSFUL PROCESSING OF OBJECT AND ASSOCIATIONS*/
*        /* IF ALL PATHS OR ALIAS'S NOT PROCESSED THEN ERROR FLAG SET*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0366
*        IF ERRSAVFL = ON & SETRC = 0                              0366
*          THEN                                                    0366
@RF00364 TM    ERRSAVFL,B'00100000'                                0366
         BNO   @RF00366                                            0366
         LTR   SETRC,SETRC                                         0366
         BNZ   @RF00366                                            0366
*            LASTCC = LASTCC04;                                    0367
*                                                                  0367
         MVC   LASTCC(2),@CH00041                                  0367
*          ELSE                                                    0368
*            LASTCC = SETRC;                                       0368
*                                                                  0368
         B     @RC00366                                            0368
@RF00366 STH   SETRC,LASTCC                                        0368
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0369
*                                                                  0369
@RC00366 L     @15,@PC00001                                        0369
         ST    @15,@AL00001                                        0369
         LA    @14,MODID                                           0369
         ST    @14,@AL00001+4                                      0369
         LA    @14,LASTCC                                          0369
         ST    @14,@AL00001+8                                      0369
         MVI   @AL00001+8,X'80'                                    0369
         L     @15,GDTEPL(,@15)                                    0369
         LA    @01,@AL00001                                        0369
         BALR  @14,@15                                             0369
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - CLUSPROC                               */
*        /*                                                          */
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */
*        /*  THE OBJECT BEING EXPORTED AND ANY PATHS DEFINED         */
*        /*  OVER IT.  BUILDS CONTROL AND DATA RECORDS, AND          */
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */
*        /*  PROCEDURES TO WRITE THE RECORDS OF THE DATA             */
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA              */
*        /*  SET.                                                    */
*        /*                                                          */
*        /* INPUT - INPUT PARAMETER LIST                             */
*        /*                                                          */
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */
*        /*  THE IMPORT FSR TO RECONSTRUCT THE VSAM OBJECT ON THE    */
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0370
*CLUSPROC: PROCEDURE;                                              0370
*                                                                  0370
@EL00001 L     @13,4(,@13)                                         0370
@EF00001 L     @00,@SIZDATD                                        0370
         LR    @01,@08                                             0370
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0370
         BR    @14                                                 0370
CLUSPROC STM   @14,@12,@SA00002                                    0370
*        OLDERID2 = NEWERID2;                                      0371
         L     @15,@PC00001                                        0371
         L     @14,GDTTR2(,@15)                                    0371
         MVC   @TS00001(95),NEWERID2(@14)                          0371
         MVC   OLDERID2(95,@14),@TS00001                           0371
*        NEWID2 = 'RC05';                                          0372
         MVC   NEWID2(4,@14),@CC01058                              0372
*        IF GDTDBG = NULLPTR                                       0373
*          THEN;                                                   0373
         L     @15,GDTDBG(,@15)                                    0373
         LTR   @15,@15                                             0373
         BZ    @RT00373                                            0373
*          ELSE                                                    0375
*            CALL IDCDB010 (GDTTBL,'RC06');                        0375
*                                                                  0375
         L     @15,@PC00001                                        0375
         ST    @15,@AL00001                                        0375
         LA    @14,@CC01059                                        0375
         ST    @14,@AL00001+4                                      0375
         MVI   @AL00001+4,X'80'                                    0375
         L     @15,GDTDBG(,@15)                                    0375
         LA    @01,@AL00001                                        0375
         BALR  @14,@15                                             0375
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE NUMBER OF FIELDS FOR CATALOG LOCATE           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0376
*        CNUM = (DIM(FIELDLST));       /*FIELD LIST FOR FIRST LOCATE */
@RT00373 MVI   CNUM,X'17'                                          0376
*        ONUM = (DIM(FIELDLST)-2);     /*FIELD LIST FOR LOCATES WITH */
         MVI   ONUM,X'15'                                          0377
*                                      /*NO CATACB AND NAMEDS FIELD  */
*                                                                  0378
*        /************************************************************/
*        /*                                                          */
*        /*  PERFORM LOCATE ON THE CLUSTER OR AIX NAME.              */
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0378
*        CALL LOCPROC(OBJVAL,NULLPARM,FIELDLST,CNUM,PTRCPL(1));    0378
*                                                                  0378
         L     @15,@PC00001+4                                      0378
         L     @01,INPPTR(,@15)                                    0378
         L     @01,INPTBL(,@01)                                    0378
         LA    @15,OBJVAL(,@01)                                    0378
         ST    @15,@AL00001                                        0378
         LA    @15,NULLPARM                                        0378
         ST    @15,@AL00001+4                                      0378
         LA    @15,FIELDLST                                        0378
         ST    @15,@AL00001+8                                      0378
         LA    @15,CNUM                                            0378
         ST    @15,@AL00001+12                                     0378
         LA    @15,PTRCPL                                          0378
         ST    @15,@AL00001+16                                     0378
         LA    @01,@AL00001                                        0378
         BAL   @14,LOCPROC                                         0378
*        /************************************************************/
*        /*                                                          */
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0379
*        RESPECIFY RTNREG RSTD;                                    0379
*        TESTRC = RTNREG;                                          0380
         LR    TESTRC,RTNREG                                       0380
*        RESPECIFY RTNREG UNRSTD;                                  0381
*        IF TESTRC ^= 0                                            0382
*          THEN                                                    0382
         LTR   TESTRC,TESTRC                                       0382
         BZ    @RF00382                                            0382
*            RETURN CODE(LASTCC16);                                0383
*                                                                  0383
         LA    @15,16                                              0383
         L     @14,@SA00002                                        0383
         LM    @00,@12,@SA00002+8                                  0383
         BR    @14                                                 0383
*        CALL CTLGPROC(PTRCPL(1));                                 0384
*                                                                  0384
@RF00382 LA    @15,PTRCPL                                          0384
         ST    @15,@AL00001                                        0384
         LA    @01,@AL00001                                        0384
         BAL   @14,CTLGPROC                                        0384
*        /************************************************************/
*        /*                                                          */
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */
*        /* THIS REQUEST                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0385
*        RESPECIFY RTNREG RSTD;                                    0385
*        TESTRC = RTNREG;                                          0386
         LR    TESTRC,RTNREG                                       0386
*        RESPECIFY RTNREG UNRSTD;                                  0387
*        IF TESTRC ^= 0                                            0388
*          THEN                                                    0388
         LTR   TESTRC,TESTRC                                       0388
         BZ    @RF00388                                            0388
*            /********************************************************/
*            /*                                                      */
*            /* IF SEVERE ERROR RETURN IS WITH TERMINATION CODE ELSE */
*            /*  RETURN INDICATES THIS REQUEST COULD NOT BE PROCESSED*/
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC = LASTCC16                                  0389
*              THEN                                                0389
         LA    @03,16                                              0389
         CR    TESTRC,@03                                          0389
         BNE   @RF00389                                            0389
*                RETURN CODE(LASTCC16);                            0390
         LR    @15,@03                                             0390
         L     @14,@SA00002                                        0390
         LM    @00,@12,@SA00002+8                                  0390
         BR    @14                                                 0390
*              ELSE                                                0391
*                RETURN CODE(LASTCC08);                            0391
@RF00389 LA    @15,8                                               0391
         L     @14,@SA00002                                        0391
         LM    @00,@12,@SA00002+8                                  0391
         BR    @14                                                 0391
*          ELSE;                                                   0392
@RF00388 DS    0H                                                  0393
*        /************************************************************/
*        /*                                                          */
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A CLUSTER OR AIX     */
*        /*  NAME                                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0393
*        CTGPLPTR = PTRCPL(1);                                     0393
         L     @03,PTRCPL                                          0393
         ST    @03,CTGPLPTR                                        0393
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0394
         L     CTGFLPTR,CTGFIELD(,@03)                             0394
*        IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                      0395
*          THEN                                                    0395
         SLR   @03,@03                                             0395
         C     @03,CTGFLNG(,CTGFLPTR)                              0395
         BE    @RF00395                                            0395
         L     @15,CTGFLPT(,CTGFLPTR)                              0395
         CR    @15,@03                                             0395
         BE    @RF00395                                            0395
*            IF FENTYPE = CTGTAIX                                  0396
*              THEN                                                0396
*                                                                  0396
         CLI   FENTYPE(@15),C'G'                                   0396
         BNE   @RF00396                                            0396
*                /****************************************************/
*                /*                                                  */
*                /*  HAVE AN AIX.  SET AIXFLAG TO ON.                */
*                /*                                                  */
*                /****************************************************/
*                                                                  0397
*                AIXFLAG = ON;                                     0397
*                                                                  0397
         OI    AIXFLAG,B'10000000'                                 0397
*              ELSE                                                0398
*                                                                  0398
*                IF FENTYPE ^= CTGTCL                              0398
*                    THEN                                          0398
         B     @RC00396                                            0398
@RF00396 L     @03,CTGFLPT(,CTGFLPTR)                              0398
         CLI   FENTYPE(@03),C'C'                                   0398
         BE    @RF00398                                            0398
*                      DO;                                         0399
*                      DARGSMOD = EXPMSG;                          0400
         L     @15,DDSTRU                                          0400
         MVC   DARGSMOD(3,@15),@CC00834                            0400
*                      DARGSENT = NOVALOBJ;                        0401
         MVI   DARGSENT(@15),X'03'                                 0401
*                      RETURN CODE(LASTCC08);                      0402
         LA    @15,8                                               0402
         L     @14,@SA00002                                        0402
         LM    @00,@12,@SA00002+8                                  0402
         BR    @14                                                 0402
*                      END;                                        0403
*                    ELSE;                                         0404
@RF00398 DS    0H                                                  0405
*          ELSE                                                    0405
*            /********************************************************/
*            /*                                                      */
*            /*  NO ENTYPE FIELD -IMPOSSIBLE - TERMINATE             */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0405
         B     @RC00395                                            0405
@RF00395 DS    0H                                                  0406
*            DARGSMOD = CEXPMSG;                                   0406
         L     @15,DDSTRU                                          0406
         MVC   DARGSMOD(3,@15),@CC00836                            0406
*            DARGSENT = NOCTFLD;                                   0407
         MVI   DARGSENT(@15),X'04'                                 0407
*            RETURN CODE(LASTCC08);                                0408
         LA    @15,8                                               0408
         L     @14,@SA00002                                        0408
         LM    @00,@12,@SA00002+8                                  0408
         BR    @14                                                 0408
*            END;                                                  0409
*                                                                  0409
*        /************************************************************/
*        /*                                                          */
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0410
*        CTGFLPTR = CTGFIELD(ICATACB);                             0410
@RC00395 L     @15,CTGPLPTR                                        0410
         L     CTGFLPTR,CTGFIELD+88(,@15)                          0410
*        PTRCTACB = FCATACB;                                       0411
*                                                                  0411
*                                                                  0411
*                                                                  0411
*                                                                  0411
         L     @03,CTGFLPT(,CTGFLPTR)                              0411
         L     @03,FCATACB(,@03)                                   0411
         ST    @03,PTRCTACB                                        0411
*        /************************************************************/
*        /*                                                          */
*        /*  GET NAMEDS FPL FOR DATA AND POSSIBLY INDEX.             */
*        /*  CALL LOCPROC TO BUILD CPL AND FPLS AND ISSUE A          */
*        /*  LOCATE.                                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0412
*        CTGFLPTR = CTGFIELD(INAMEDS);                             0412
*                                                                  0412
*                                                                  0412
*                                                                  0412
         L     CTGFLPTR,CTGFIELD+84(,@15)                          0412
*        /************************************************************/
*        /*                                                          */
*        /*TEST FOR DATA AND INDEX COMPONENT                         */
*        /*RETURN IF UNAVAILABLE                                     */
*        /*  THE STRUCTURE OF THE NAMEDS AREA RETURNED BY            */
*        /*  CATALOG MANAGEMENT IS USED EXPLICITLY IN ALL            */
*        /*  OF THE CODE IN THIS MODULE THAT REFERENCES              */
*        /*  NAMEDS.  FOR A CLUSTER OBJECT THE STRUCTURE             */
*        /*  IS DATA, INDEX (IF EXISTANT), AND A MIXTURE OF          */
*        /*  PATHS AND ALTERNATE INDEXES.  IN THE CASE OF            */
*        /*  AN AIX, THE ORDER OF ASSOCIATED OBJECTS IS              */
*        /*  DATA, INDEX, BASE CLUSTER, AND ANY PATHS.  FOR          */
*        /*  PATHS IDCRC02 ASSUMES ONLY THAT THE PATHENTRY           */
*        /*  OBJECT APPEARS FIRST IN THE NAMEDS AREA.                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0413
*        IF CTGFLNG(1) = 0                                         0413
*          THEN                                                    0413
         L     @03,CTGFLNG(,CTGFLPTR)                              0413
         LTR   @03,@03                                             0413
         BNZ   @RF00413                                            0413
*            DO;                                                   0414
*            DARGSMOD = CEXPMSG;                                   0415
         L     @15,DDSTRU                                          0415
         MVC   DARGSMOD(3,@15),@CC00836                            0415
*            DARGSENT = NOCTFLD;                                   0416
         MVI   DARGSENT(@15),X'04'                                 0416
*            RETURN CODE(LASTCC08);                                0417
         LA    @15,8                                               0417
         L     @14,@SA00002                                        0417
         LM    @00,@12,@SA00002+8                                  0417
         BR    @14                                                 0417
*            END;                                                  0418
*                                                                  0418
*                                                                  0418
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE LOCATES FOR EITHER DATA AND INDEX OR JUST         */
*        /*  DATA.  THE INFORMATION RETURNED BY CATALOG WILL         */
*        /*  BE WRITTEN TO THE PORTABILITY DATA SET.                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0419
*        FNMPTR = CTGFLPT(1);                                      0419
@RF00413 L     @04,CTGFLPT(,CTGFLPTR)                              0419
         ST    @04,FNMPTR                                          0419
*        NUMOBJ = CTGFLNG(1) / LNAMEDS;                            0420
         L     @00,CTGFLNG(,CTGFLPTR)                              0420
         SRDA  @00,32                                              0420
         D     @00,@CF00041                                        0420
         LR    NUMOBJ,@01                                          0420
*        NUMOBJCT = NUMOBJ;                                        0421
         LR    NUMOBJCT,NUMOBJ                                     0421
*        NUMASSOC = NUMOBJ;                                        0422
*                                                                  0422
         STH   NUMOBJ,NUMASSOC                                     0422
*ASSOCLP: DO I = 1 TO NUMOBJ;                                      0423
*                                                                  0423
ASSOCLP  LA    I,1                                                 0423
         B     @DE00423                                            0423
@DL00423 DS    0H                                                  0424
*          OLDERID2 = NEWERID2;                                    0424
         L     @02,@PC00001                                        0424
         L     @02,GDTTR2(,@02)                                    0424
         MVC   @TS00001(95),NEWERID2(@02)                          0424
         MVC   OLDERID2(95,@02),@TS00001                           0424
*          NEWID2 = 'RC07';                                        0425
*                                                                  0425
         MVC   NEWID2(4,@02),@CC01065                              0425
*          /**********************************************************/
*          /*                                                        */
*          /*  IF DATA OR INDEX, CALL LOCPROC TO BUILD CPL,          */
*          /*  FPL'S.  THEN CALL CTLGPROC TO ISSUE A UCATLG.         */
*          /*  IF EITHER PROCEDURE SHOULD FAIL, RETURN.              */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0426
*          IF FTYPE = CTGTINDX × FTYPE = CTGTDATA                  0426
*             × (FTYPE = CTGTCL & AIXFLAG = ON)                    0426
*            THEN                                                  0426
         L     @02,FNMPTR                                          0426
         CLI   FTYPE(@02),C'I'                                     0426
         BE    @RT00426                                            0426
         CLI   FTYPE(@02),C'D'                                     0426
         BE    @RT00426                                            0426
         CLI   FTYPE(@02),C'C'                                     0426
         BNE   @RF00426                                            0426
         TM    AIXFLAG,B'10000000'                                 0426
         BNO   @RF00426                                            0426
@RT00426 DS    0H                                                  0427
*LOCCOMP:      DO;                                                 0427
*                                                                  0427
LOCCOMP  DS    0H                                                  0428
*              CALL LOCPROC(FNAME,PTRCTACB,FIELDLST,ONUM,PTRCPL(I+1));
*                                                                  0428
         L     @02,FNMPTR                                          0428
         LA    @02,FNAME(,@02)                                     0428
         ST    @02,@AL00001                                        0428
         LA    @02,PTRCTACB                                        0428
         ST    @02,@AL00001+4                                      0428
         LA    @02,FIELDLST                                        0428
         ST    @02,@AL00001+8                                      0428
         LA    @02,ONUM                                            0428
         ST    @02,@AL00001+12                                     0428
         LR    @02,I                                               0428
         SLA   @02,2                                               0428
         LA    @02,PTRCPL(@02)                                     0428
         ST    @02,@AL00001+16                                     0428
         LA    @01,@AL00001                                        0428
         BAL   @14,LOCPROC                                         0428
*              /******************************************************/
*              /*                                                    */
*              /*  IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -       */
*              /*  TERMINATE                                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0429
*              RESPECIFY RTNREG RSTD;                              0429
*              TESTRC = RTNREG;                                    0430
         LR    TESTRC,RTNREG                                       0430
*              RESPECIFY RTNREG UNRSTD;                            0431
*                                                                  0431
*              IF TESTRC ^= 0                                      0432
*                THEN                                              0432
         LTR   TESTRC,TESTRC                                       0432
         BZ    @RF00432                                            0432
*                  RETURN CODE(LASTCC16);                          0433
*                                                                  0433
         LA    @15,16                                              0433
         L     @14,@SA00002                                        0433
         LM    @00,@12,@SA00002+8                                  0433
         BR    @14                                                 0433
*              /******************************************************/
*              /*                                                    */
*              /*  INVOKE CATALOG MANAGEMENT TO LOCATE RELATED       */
*              /*  CLUSTER OR AIX OBJECT.                            */
*              /*  TERMINATE IF LOCATE UNSUCCESSFUL                  */
*              /*                                                    */
*              /******************************************************/
*                                                                  0434
*                                                                  0434
*              CALL CTLGPROC(PTRCPL(I+1));                         0434
*                                                                  0434
*                                                                  0434
@RF00432 LR    @02,I                                               0434
         SLA   @02,2                                               0434
         LA    @02,PTRCPL(@02)                                     0434
         ST    @02,@AL00001                                        0434
         LA    @01,@AL00001                                        0434
         BAL   @14,CTLGPROC                                        0434
*              RESPECIFY RTNREG RSTD;                              0435
*              TESTRC = RTNREG;                                    0436
         LR    TESTRC,RTNREG                                       0436
*              RESPECIFY RTNREG UNRSTD;                            0437
*                                                                  0437
*                                                                  0437
*              IF TESTRC ^= 0                                      0438
*                                                                  0438
*                THEN                                              0438
*                                                                  0438
         LTR   TESTRC,TESTRC                                       0438
         BZ    @RF00438                                            0438
*                  /**************************************************/
*                  /*                                                */
*                  /*IF SEVERE ERROR RETURN IS WITH TERMINATION CODE */
*                  /*ELSE RETURN INDICATES THIS REQUEST COULD NOT BE */
*                  /*PROCESSED                                       */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0439
*                  IF TESTRC = LASTCC16                            0439
*                    THEN                                          0439
         LA    @03,16                                              0439
         CR    TESTRC,@03                                          0439
         BNE   @RF00439                                            0439
*                      RETURN CODE(LASTCC16);                      0440
*                                                                  0440
         LR    @15,@03                                             0440
         L     @14,@SA00002                                        0440
         LM    @00,@12,@SA00002+8                                  0440
         BR    @14                                                 0440
*                    ELSE                                          0441
*                      RETURN CODE(LASTCC08);                      0441
*                                                                  0441
*                                                                  0441
@RF00439 LA    @15,8                                               0441
         L     @14,@SA00002                                        0441
         LM    @00,@12,@SA00002+8                                  0441
         BR    @14                                                 0441
*                ELSE;                                             0442
*                                                                  0442
@RF00438 DS    0H                                                  0443
*              CTGPLPTR = PTRCPL(I+1);                             0443
*                                                                  0443
         LR    @02,I                                               0443
         SLA   @02,2                                               0443
         L     @02,PTRCPL(@02)                                     0443
         ST    @02,CTGPLPTR                                        0443
*              /******************************************************/
*              /*                                                    */
*              /*  IF WE ARE LOCATING A CLUSTER ASSOCIATED           */
*              /*  OBJECT FOR AN AIX, SAVE THE NAME OF THE           */
*              /*  CLUSTER.  ALSO DECREMENT THE NUMBER OF            */
*              /*  THINGS TO BE EXPORTED.                            */
*              /*                                                    */
*              /******************************************************/
*                                                                  0444
*              IF FTYPE = CTGTCL & AIXFLAG = ON                    0444
*                THEN                                              0444
         L     @01,FNMPTR                                          0444
         CLI   FTYPE(@01),C'C'                                     0444
         BNE   @RF00444                                            0444
         TM    AIXFLAG,B'10000000'                                 0444
         BNO   @RF00444                                            0444
*                  DO;                                             0445
*                  CTGFLPTR = CTGFIELD(IENTNAME);                  0446
         L     @15,CTGPLPTR                                        0446
         L     CTGFLPTR,CTGFIELD+4(,@15)                           0446
*                  RELNAME = FENTNAME;                             0447
         L     @01,CTGFLPT(,CTGFLPTR)                              0447
         MVC   RELNAME(44),FENTNAME(@01)                           0447
*                  NUMOBJCT = NUMOBJCT - 1;                        0448
         BCTR  NUMOBJCT,0                                          0448
*                  END;                                            0449
*                                                                  0449
*              /******************************************************/
*              /*                                                    */
*              /*  TEST TO BE CERTAIN THAT AN ENTYPE FIELD           */
*              /*  HAS BEEN LOCATED.                                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0450
*              CTGFLPTR = CTGFIELD(IENTYPE);                       0450
@RF00444 L     @01,CTGPLPTR                                        0450
         L     CTGFLPTR,CTGFIELD(,@01)                             0450
*              IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                0451
*                THEN                                              0451
*                                                                  0451
         SLR   @15,@15                                             0451
         C     @15,CTGFLNG(,CTGFLPTR)                              0451
         BE    @RF00451                                            0451
         L     @14,CTGFLPT(,CTGFLPTR)                              0451
         CR    @14,@15                                             0451
         BE    @RF00451                                            0451
*                  /**************************************************/
*                  /*                                                */
*                  /*  TEST FOR THE PRESENCE OF AN INDEX             */
*                  /*  COMPONENT.  IF THIS IS ONE, THEN              */
*                  /*  SET THE KSDSFLAG TO ON.                       */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0452
*                  IF FENTYPE = CTGTINDX                           0452
*                    THEN                                          0452
         CLI   FENTYPE(@14),C'I'                                   0452
         BNE   @RF00452                                            0452
*                      KSDSFLAG = ON;                              0453
         OI    KSDSFLAG,B'01000000'                                0453
*                    ELSE ;                                        0454
*                                                                  0454
@RF00452 DS    0H                                                  0455
*              END LOCCOMP;                                        0455
*                                                                  0455
*            ELSE                                                  0456
*                                                                  0456
*            /********************************************************/
*            /*                                                      */
*            /*  TEST TO SEE IF THE ENTRY TYPE IS PATH.  IF          */
*            /*  SO, SET A FLAG INDICATING PATH ASSOCIATIONS         */
*            /*  OTHERWISE TEST FOR AN AIX.  IF ONE IS               */
*            /*  PRESENT, SUBTRACT ONE FROM THE TOTAL                */
*            /*  NUMBER OF THINGS TO BE EXPORTED.                    */
*            /*  AIX'S OVER CLUSTERS DO NOT GET EXPORTED.            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0456
*              IF FTYPE = CTGTPTH                                  0456
*                THEN                                              0456
         B     @RC00426                                            0456
@RF00426 L     @02,FNMPTR                                          0456
         CLI   FTYPE(@02),C'R'                                     0456
         BNE   @RF00456                                            0456
*                  PATHFLAG = ON;                                  0457
         OI    PATHFLAG,B'00100000'                                0457
*                ELSE                                              0458
*                  IF FTYPE = CTGTAIX                              0458
*                    THEN                                          0458
         B     @RC00456                                            0458
@RF00456 L     @02,FNMPTR                                          0458
         CLI   FTYPE(@02),C'G'                                     0458
         BNE   @RF00458                                            0458
*                      NUMOBJCT = NUMOBJCT - 1;                    0459
         BCTR  NUMOBJCT,0                                          0459
*                    ELSE ;                                        0460
*                                                                  0460
@RF00458 DS    0H                                                  0461
*          FNMPTR = FNMPTR + LNAMEDS;                              0461
@RC00456 DS    0H                                                  0461
@RC00426 LA    @02,4                                               0461
         AL    @02,FNMPTR                                          0461
         ST    @02,FNMPTR                                          0461
*        END ASSOCLP;                                              0462
         AL    I,@CF00218                                          0462
@DE00423 CR    I,NUMOBJ                                            0462
         BNH   @DL00423                                            0462
*                                                                  0463
*        /************************************************************/
*        /*                                                          */
*        /*  SET THE NUMBER OF OBJECTS TO BE EXPORTED TO BE          */
*        /*  THE NUMBER OF OBJECTS ASSOCIATED WITH THE ENTRY         */
*        /*  MINUS THE NUMBER OF AIX'S ASSOCIATED.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0463
*        NUMOBJ = NUMOBJCT;                                        0463
*                                                                  0463
         LR    NUMOBJ,NUMOBJCT                                     0463
*        /************************************************************/
*        /*                                                          */
*        /*  INDICATE HOW MANY CPL'S HAVE BEEN BUILT AND             */
*        /*  ARE TO BE WRITTEN TO THE PORTABILITY DATA               */
*        /*  SET.                                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0464
*        IF KSDSFLAG = ON                                          0464
*          THEN                                                    0464
         TM    KSDSFLAG,B'01000000'                                0464
         BNO   @RF00464                                            0464
*            NUMCPL = 3;                                           0465
         LA    NUMCPL,3                                            0465
*          ELSE                                                    0466
*            NUMCPL = 2;                                           0466
         B     @RC00464                                            0466
@RF00464 LA    NUMCPL,2                                            0466
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */
*        /*  AREA RETURNED BY LOCATE                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0467
*        OLDERID2 = NEWERID2;                                      0467
@RC00464 L     @04,@PC00001                                        0467
         L     @15,GDTTR2(,@04)                                    0467
         MVC   @TS00001(95),NEWERID2(@15)                          0467
         MVC   OLDERID2(95,@15),@TS00001                           0467
*        NEWID2 = 'RC09';                                          0468
*                                                                  0468
*                                                                  0468
         MVC   NEWID2(4,@15),@CC01068                              0468
*        /************************************************************/
*        /*                                                          */
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0469
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);
*                                                                  0469
         MVC   @AL00001+4(16),@AL00469                             0469
         ST    @04,@AL00001                                        0469
         LA    @15,CONRCPTR                                        0469
         ST    @15,@AL00001+8                                      0469
         L     @15,GDTGPL(,@04)                                    0469
         LA    @01,@AL00001                                        0469
         BALR  @14,@15                                             0469
*        RESPECIFY RTNREG RSTD;                                    0470
*        TESTRC = RTNREG;                                          0471
         LR    TESTRC,RTNREG                                       0471
*        RESPECIFY RTNREG UNRSTD;                                  0472
*        IF TESTRC ^= 0                                            0473
*          THEN                                                    0473
         LTR   TESTRC,TESTRC                                       0473
         BZ    @RF00473                                            0473
*            DO;                                                   0474
*            DARGSMOD = UNIVMSG;                                   0475
         L     @15,DDSTRU                                          0475
         MVC   DARGSMOD(3,@15),@CC00847                            0475
*            DARGSENT = NOSTORAG;                                  0476
         MVI   DARGSENT(@15),X'04'                                 0476
*            RETURN CODE(LASTCC16);                                0477
         LA    @15,16                                              0477
         L     @14,@SA00002                                        0477
         LM    @00,@12,@SA00002+8                                  0477
         BR    @14                                                 0477
*            END;                                                  0478
*                                                                  0478
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          0479
@RF00473 L     @04,@PC00001                                        0479
         ST    @04,@AL00001                                        0479
         LA    @02,8                                               0479
         AL    @02,CONRCPTR                                        0479
         LA    @15,TIMEODAY(,@02)                                  0479
         ST    @15,@AL00001+4                                      0479
         LA    @02,TIMEDATE(,@02)                                  0479
         ST    @02,@AL00001+8                                      0479
         LA    @02,FORMAT                                          0479
         ST    @02,@AL00001+12                                     0479
         MVI   @AL00001+12,X'80'                                   0479
         L     @15,GDTTIM(,@04)                                    0479
         LA    @01,@AL00001                                        0479
         BALR  @14,@15                                             0479
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               0480
         L     @04,CONRCPTR                                        0480
         MVC   HEADLN(2,@04),@CH01286                              0480
*        HEADFLG1 = HDFL1CAT;                                      0481
         MVI   HEADFLG1(@04),X'FF'                                 0481
*        HEADFLG2 = HDFL2TSP;                                      0482
*                                                                  0482
         MVI   HEADFLG2(@04),X'FF'                                 0482
*        NUMOBJ = NUMOBJ + 1;          /* ADD CLUSTER TO COUNT       */
         AL    NUMOBJ,@CF00218                                     0483
*        TEXOJCT = NUMOBJ;             /* SET COUNT IN TIMESTAMP     */
*                                                                  0484
         AL    @04,@CF00178                                        0484
         STC   NUMOBJ,TEXOJCT(,@04)                                0484
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE PATHFLAG IS ON, SET THE TEXASSOC BIT, AND        */
*        /*  TEST THE KSDSFLAG.  IF THAT FLAG IS ALSO ON,            */
*        /*  SET THE TEXBASE BIT.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0485
*        IF PATHFLAG = ON                                          0485
*          THEN                                                    0485
         TM    PATHFLAG,B'00100000'                                0485
         BNO   @RF00485                                            0485
*            DO;                                                   0486
*            TEXASSOC = ON;                                        0487
         OI    TEXASSOC(@04),B'00100000'                           0487
*            IF KSDSFLAG = ON                                      0488
*              THEN                                                0488
         TM    KSDSFLAG,B'01000000'                                0488
         BNO   @RF00488                                            0488
*                TEXBASE = ON;                                     0489
         OI    TEXBASE(@04),B'00010000'                            0489
*            END;                                                  0490
*                                                                  0490
@RF00488 DS    0H                                                  0491
*        TEXFLG2 = EXPTYPE1;                                       0491
@RF00485 L     @04,CONRCPTR                                        0491
         LA    @15,8                                               0491
         ALR   @15,@04                                             0491
         MVC   TEXFLG2(1,@15),EXPTYPE1                             0491
*        TEXRCVY = ON;                                             0492
         OI    TEXRCVY(@15),B'00001000'                            0492
*        SAVLEN = HEADLN;                                          0493
*                                                                  0493
         LH    @04,HEADLN(,@04)                                    0493
         STH   @04,SAVLEN                                          0493
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */
*        /*  IF AN ERROR IS ENCOUNTERED, RETURN TO THE CALLING       */
*        /*  PROCESSOR.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0494
*        CALL SAVEPROC(SAVLEN,CONRCPTR,'H');                       0494
*                                                                  0494
         LA    @04,SAVLEN                                          0494
         ST    @04,@AL00001                                        0494
         LA    @04,CONRCPTR                                        0494
         ST    @04,@AL00001+4                                      0494
         LA    @04,@CC01070                                        0494
         ST    @04,@AL00001+8                                      0494
         LA    @01,@AL00001                                        0494
         BAL   @14,SAVEPROC                                        0494
*        RESPECIFY RTNREG RSTD;                                    0495
*        TESTRC = RTNREG;                                          0496
         LR    TESTRC,RTNREG                                       0496
*        RESPECIFY RTNREG UNRSTD;                                  0497
*        IF TESTRC ^= 0                                            0498
*          THEN                                                    0498
         LTR   TESTRC,TESTRC                                       0498
         BZ    @RF00498                                            0498
*            RETURN CODE(LASTCC16);                                0499
         LA    @15,16                                              0499
         L     @14,@SA00002                                        0499
         LM    @00,@12,@SA00002+8                                  0499
         BR    @14                                                 0499
*                                                                  0500
*        /************************************************************/
*        /*                                                          */
*        /*  NOW SELECT EACH CPL AND INTERROGATE FPL'S FOR FIELD     */
*        /*  INFORMATION                                             */
*        /*                                                          */
*        /************************************************************/
*        DO INDXCPL = 1 TO NUMCPL;                                 0500
*                                                                  0500
@RF00498 LA    @04,1                                               0500
         B     @DE00500                                            0500
@DL00500 DS    0H                                                  0501
*          /**********************************************************/
*          /*                                                        */
*          /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,           */
*          /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.                 */
*          /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN           */
*          /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE            */
*          /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY            */
*          /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO            */
*          /*  THE PORTABILITY DATA SET.                             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0501
*          IF AIXFLAG = ON & INDXCPL =1                            0501
*            THEN                                                  0501
         TM    AIXFLAG,B'10000000'                                 0501
         BNO   @RF00501                                            0501
         C     @04,@CF00218                                        0501
         BNE   @RF00501                                            0501
*              DO;                                                 0502
*                                                                  0502
*              CALL CONTRBL(INDXCPL,CTGTAIX);                      0503
*                                                                  0503
         LA    @04,INDXCPL                                         0503
         ST    @04,@AL00001                                        0503
         LA    @04,@CC00685                                        0503
         ST    @04,@AL00001+4                                      0503
         LA    @01,@AL00001                                        0503
         BAL   @14,CONTRBL                                         0503
*              RESPECIFY RTNREG RSTD;                              0504
*              TESTRC = RTNREG;                                    0505
         LR    TESTRC,RTNREG                                       0505
*              RESPECIFY RTNREG UNRSTD;                            0506
*                                                                  0506
*              IF TESTRC ^= 0                                      0507
*               THEN                                               0507
         LTR   TESTRC,TESTRC                                       0507
         BZ    @RF00507                                            0507
*                 /***************************************************/
*                 /*                                                 */
*                 /*IF SEVERE ERROR RETURN IS WITH TERMINATION CODE  */
*                 /*ELSE RETURN INDICATES THIS REQUEST COULD NOT BE  */
*                 /*PROCESSED                                        */
*                 /*                                                 */
*                 /***************************************************/
*                 IF TESTRC = LASTCC16                             0508
*                   THEN                                           0508
         LA    @03,16                                              0508
         CR    TESTRC,@03                                          0508
         BNE   @RF00508                                            0508
*                     RETURN CODE(LASTCC16);                       0509
         LR    @15,@03                                             0509
         L     @14,@SA00002                                        0509
         LM    @00,@12,@SA00002+8                                  0509
         BR    @14                                                 0509
*                   ELSE                                           0510
*                     RETURN CODE(LASTCC08);                       0510
@RF00508 LA    @15,8                                               0510
         L     @14,@SA00002                                        0510
         LM    @00,@12,@SA00002+8                                  0510
         BR    @14                                                 0510
*               ELSE;                                              0511
*                                                                  0511
@RF00507 DS    0H                                                  0512
*              END;                                                0512
*                                                                  0512
*            ELSE                                                  0513
*              DO;                                                 0513
*                                                                  0513
         B     @RC00501                                            0513
@RF00501 DS    0H                                                  0514
*              CALL CONTRBL(INDXCPL,'N');                          0514
*                                                                  0514
         LA    @04,INDXCPL                                         0514
         ST    @04,@AL00001                                        0514
         LA    @04,@CC01072                                        0514
         ST    @04,@AL00001+4                                      0514
         LA    @01,@AL00001                                        0514
         BAL   @14,CONTRBL                                         0514
*              RESPECIFY RTNREG RSTD;                              0515
*              TESTRC = RTNREG;                                    0516
         LR    TESTRC,RTNREG                                       0516
*              RESPECIFY RTNREG UNRSTD;                            0517
*                                                                  0517
*              IF TESTRC ^= 0                                      0518
*                THEN                                              0518
         LTR   TESTRC,TESTRC                                       0518
         BZ    @RF00518                                            0518
*                  /**************************************************/
*                  /*                                                */
*                  /*IF SEVERE ERROR RETURN IS WITH TERMINATION CODE */
*                  /*ELSE RETURN INDICATES THIS REQUEST COULD NOT BE */
*                  /*PROCESSED                                       */
*                  /*                                                */
*                  /**************************************************/
*                  IF TESTRC = LASTCC16                            0519
*                    THEN                                          0519
         LA    @03,16                                              0519
         CR    TESTRC,@03                                          0519
         BNE   @RF00519                                            0519
*                      RETURN CODE(LASTCC16);                      0520
         LR    @15,@03                                             0520
         L     @14,@SA00002                                        0520
         LM    @00,@12,@SA00002+8                                  0520
         BR    @14                                                 0520
*                    ELSE                                          0521
*                      RETURN CODE(LASTCC08);                      0521
@RF00519 LA    @15,8                                               0521
         L     @14,@SA00002                                        0521
         LM    @00,@12,@SA00002+8                                  0521
         BR    @14                                                 0521
*                ELSE;                                             0522
*                                                                  0522
@RF00518 DS    0H                                                  0523
*              END;                                                0523
*                                                                  0523
*        END;                                                      0524
*                                                                  0524
@RC00501 LA    @04,1                                               0524
         AL    @04,INDXCPL                                         0524
@DE00500 ST    @04,INDXCPL                                         0524
         CR    @04,NUMCPL                                          0524
         BNH   @DL00500                                            0524
*                                                                  0525
*        /************************************************************/
*        /*                                                          */
*        /*  TEST TO DETERMINE IF THERE ARE PATH                     */
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING                */
*        /*  LOCATES FOR THE PATHS, AND WRITING OUT THE              */
*        /*  CATALOG INFORMATION TO THE PORTABILITY                  */
*        /*  DATA SET.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0525
*        IF PATHFLAG = ON                                          0525
*          THEN                                                    0525
         TM    PATHFLAG,B'00100000'                                0525
         BNO   @RF00525                                            0525
*PTHDEF:     DO;                                                   0526
*                                                                  0526
PTHDEF   DS    0H                                                  0527
*            /********************************************************/
*            /*                                                      */
*            /*  SET A FLAG TO INDICATE THAT WE ARE PROCESS-         */
*            /*  ING THE FIRST PATH.  LOOP THROUGH THE PATHS         */
*            /*  DOING LOCATES AND WRITING CATALOG                   */
*            /*  INFORMATION TO THE PORTABILITY DATA SET.            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0527
*            OLDERID2 = NEWERID2;                                  0527
         L     @04,@PC00001                                        0527
         L     @04,GDTTR2(,@04)                                    0527
         MVC   @TS00001(95),NEWERID2(@04)                          0527
         MVC   OLDERID2(95,@04),@TS00001                           0527
*            NEWID2 = 'RC11';                                      0528
*                                                                  0528
         MVC   NEWID2(4,@04),@CC01075                              0528
*            FIRFLAG = ON;                                         0529
*                                                                  0529
         OI    FIRFLAG,B'00001000'                                 0529
*PATHREC:    DO I = NUMCPL+1 TO NUMASSOC+1;                        0530
PATHREC  LA    I,1                                                 0530
         ALR   I,NUMCPL                                            0530
         B     @DE00530                                            0530
@DL00530 DS    0H                                                  0531
*              CTGPLPTR = PTRCPL(1);                               0531
         L     @03,PTRCPL                                          0531
         ST    @03,CTGPLPTR                                        0531
*              CTGFLPTR = CTGFIELD(INAMEDS);                       0532
         L     CTGFLPTR,CTGFIELD+84(,@03)                          0532
*              FNMPTR = CTGFLPT(1) + LNAMEDS * (I - 2);            0533
*                                                                  0533
         LR    @03,I                                               0533
         BCTR  @03,0                                               0533
         BCTR  @03,0                                               0533
         SLA   @03,2                                               0533
         AL    @03,CTGFLPT(,CTGFLPTR)                              0533
         ST    @03,FNMPTR                                          0533
*              /******************************************************/
*              /*                                                    */
*              /*  TEST TO DETERMINE IF THE ASSOCIATED               */
*              /*  OBJECT IS A PATH.                                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0534
*              IF FTYPE = CTGTPTH                                  0534
*                THEN                                              0534
*                                                                  0534
         CLI   FTYPE(@03),C'R'                                     0534
         BNE   @RF00534                                            0534
*                  /**************************************************/
*                  /*                                                */
*                  /*  TEST TO DETERMINE WHETHER THIS IS THE         */
*                  /*  FIRST PATH TO BE PROCESSED.                   */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0535
*                  IF FIRFLAG = ON                                 0535
*                    THEN                                          0535
         TM    FIRFLAG,B'00001000'                                 0535
         BNO   @RF00535                                            0535
*FIRPATH:              DO;                                         0536
*                                                                  0536
FIRPATH  DS    0H                                                  0537
*                      FIRFLAG = OFF;                              0537
*                                                                  0537
         NI    FIRFLAG,B'11110111'                                 0537
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF THIS IS THE FIRST PATH TO BE           */
*                      /*  PROCESSED CALL LOCPROC TO BUILD           */
*                      /*  THE CPL AND FPL'S.                        */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0538
*                      CALL LOCPROC(FNAME,PTRCTACB,                0538
*                        FIELDLST,ONUM,PTRCPL(PTHCPLNO));          0538
*                                                                  0538
         L     @01,FNMPTR                                          0538
         LA    @15,FNAME(,@01)                                     0538
         ST    @15,@AL00001                                        0538
         LA    @15,PTRCTACB                                        0538
         ST    @15,@AL00001+4                                      0538
         LA    @15,FIELDLST                                        0538
         ST    @15,@AL00001+8                                      0538
         LA    @15,ONUM                                            0538
         ST    @15,@AL00001+12                                     0538
         LA    @15,PTRCPL+16                                       0538
         ST    @15,@AL00001+16                                     0538
         LA    @01,@AL00001                                        0538
         BAL   @14,LOCPROC                                         0538
*                      RESPECIFY RTNREG RSTD;                      0539
*                      TESTRC = RTNREG;                            0540
         LR    TESTRC,RTNREG                                       0540
*                      RESPECIFY RTNREG UNRSTD;                    0541
*                                                                  0541
*                      IF TESTRC ^= 0                              0542
*                        THEN                                      0542
         LTR   TESTRC,TESTRC                                       0542
         BZ    @RF00542                                            0542
*                          RETURN CODE(LASTCC16);                  0543
*                                                                  0543
         LA    @15,16                                              0543
         L     @14,@SA00002                                        0543
         LM    @00,@12,@SA00002+8                                  0543
         BR    @14                                                 0543
*                      /**********************************************/
*                      /*                                            */
*                      /*  SAVE THE CPL AND FPL'S JUST               */
*                      /*  CONSTRUCTED FOR USE WITH OTHER            */
*                      /*  PATHS.                                    */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0544
*                      SAPLLEN = LENGTH(SAVEPL);                   0544
*                                                                  0544
@RF00542 MVC   SAPLLEN(2),@CH01287                                 0544
*                      CALL MVDAPROC(SAPLLEN,PTRCPL(PTHCPLNO),     0545
*                        ADDR(SAVEPL),NULLPARM);                   0545
*                                                                  0545
         LA    @15,SAPLLEN                                         0545
         ST    @15,@AL00001                                        0545
         LA    @15,PTRCPL+16                                       0545
         ST    @15,@AL00001+4                                      0545
         LA    @15,SAVEPL                                          0545
         ST    @15,@AFTEMPS                                        0545
         LA    @15,@AFTEMPS                                        0545
         ST    @15,@AL00001+8                                      0545
         LA    @15,NULLPARM                                        0545
         ST    @15,@AL00001+12                                     0545
         LA    @01,@AL00001                                        0545
         BAL   @14,MVDAPROC                                        0545
*                      /**********************************************/
*                      /*                                            */
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG           */
*                      /*  TO DO THE ACTUAL LOCATE.                  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0546
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));            0546
*                                                                  0546
         LA    @15,PTRCPL+16                                       0546
         ST    @15,@AL00001                                        0546
         LA    @01,@AL00001                                        0546
         BAL   @14,CTLGPROC                                        0546
*                      RESPECIFY RTNREG RSTD;                      0547
*                      TESTRC = RTNREG;                            0548
         LR    TESTRC,RTNREG                                       0548
*                      RESPECIFY RTNREG UNRSTD;                    0549
*                                                                  0549
*                      IF TESTRC ^= 0                              0550
*                        THEN                                      0550
         LTR   TESTRC,TESTRC                                       0550
         BZ    @RF00550                                            0550
*                          DO;                                     0551
*                          /******************************************/
*                          /*                                        */
*                          /*IF SEVERE ERROR RETURNS WITH TERMINATION*/
*                          /*CODE ELSE THIS PATH IS BYPASSED AND     */
*                          /*AND PROCESSING CONTINUES AFTER PRINTING */
*                          /*WARNING MESSAGE AND SETTING ERROR FLAG  */
*                          /*                                        */
*                          /******************************************/
*                          IF TESTRC = LASTCC16                    0552
*                            THEN                                  0552
         LA    @04,16                                              0552
         CR    TESTRC,@04                                          0552
         BNE   @RF00552                                            0552
*                              RETURN CODE(LASTCC16);              0553
         LR    @15,@04                                             0553
         L     @14,@SA00002                                        0553
         LM    @00,@12,@SA00002+8                                  0553
         BR    @14                                                 0553
*                            ELSE                                  0554
*                              DO;                                 0554
@RF00552 DS    0H                                                  0555
*                              ERRSAVFL = ON;                      0555
*                                                                  0555
         OI    ERRSAVFL,B'00100000'                                0555
*                              CALL  PRNTPROC(WARNMSG1,PTHCPLMG);  0556
*                                                                  0556
         LA    @01,@AL00556                                        0556
         BAL   @14,PRNTPROC                                        0556
*                              END;                                0557
*                          END;                                    0558
*                                                                  0558
*                                                                  0558
*                        ELSE                                      0559
*                          DO;                                     0559
         B     @RC00550                                            0559
@RF00550 DS    0H                                                  0560
*                          /******************************************/
*                          /*                                        */
*                          /*  CALL CONTRBL TO BUILD THE CONTROL     */
*                          /*  RECORD FOR THE CURRENT PATH AND       */
*                          /*  TO WRITE IT AND THE CATALOG WORK      */
*                          /*  AREA OUT THE PORTABILITY DATA SET     */
*                          /*                                        */
*                          /******************************************/
*                                                                  0560
*                          CALL CONTRBL(PTHCPLNO,CTGTPTH);         0560
*                                                                  0560
*                                                                  0560
         LA    @01,@AL00560                                        0560
         BAL   @14,CONTRBL                                         0560
*                          RESPECIFY RTNREG RSTD;                  0561
*                          TESTRC = RTNREG;                        0562
         LR    TESTRC,RTNREG                                       0562
*                          RESPECIFY RTNREG UNRSTD;                0563
*                                                                  0563
*                          IF TESTRC ^= 0                          0564
*                            THEN                                  0564
         LTR   TESTRC,TESTRC                                       0564
         BZ    @RF00564                                            0564
*                              DO;                                 0565
*                              /**************************************/
*                              /*                                    */
*                              /* IF SEVERE ERROR RETURNS WITH       */
*                              /* TERMINATION CODE ELSE BYPASSES     */
*                              /* THIS PATH AND PRINTS WARNING       */
*                              /* MESSAGE                            */
*                              /*                                    */
*                              /**************************************/
*                              IF TESTRC = LASTCC16                0566
*                                THEN                              0566
         LA    @04,16                                              0566
         CR    TESTRC,@04                                          0566
         BNE   @RF00566                                            0566
*                                  RETURN CODE(LASTCC16);          0567
         LR    @15,@04                                             0567
         L     @14,@SA00002                                        0567
         LM    @00,@12,@SA00002+8                                  0567
         BR    @14                                                 0567
*                                ELSE                              0568
*                                  DO;                             0568
@RF00566 DS    0H                                                  0569
*                                  ERRSAVFL = ON;                  0569
*                                                                  0569
         OI    ERRSAVFL,B'00100000'                                0569
*                                  CALL  PRNTPROC(WARNMSG1,PTHCPLMG);
*                                                                  0570
         LA    @01,@AL00570                                        0570
         BAL   @14,PRNTPROC                                        0570
*                                  END;                            0571
*                              END;                                0572
*                           END;                                   0573
*                      END FIRPATH;                                0574
*                    ELSE                                          0575
*                      /**********************************************/
*                      /*                                            */
*                      /*  THIS IS NOT THE FIRST PATH TO BE          */
*                      /*  PROCESSED.  RESTORE THE CPL AND           */
*                      /*  FPL'S, MODIFY THE CPL TO DO A             */
*                      /*  LOCATE ON THE APPROPRIATE PATH            */
*                      /*  AND CALL CATALOG.                         */
*                      /*                                            */
*                      /**********************************************/
*NFIRPATH:             DO;                                         0575
         B     @RC00535                                            0575
@RF00535 DS    0H                                                  0575
NFIRPATH DS    0H                                                  0576
*                      CTGPLPTR = PTRCPL(PTHCPLNO);                0576
*                                                                  0576
         L     @15,PTRCPL+16                                       0576
         ST    @15,CTGPLPTR                                        0576
*                      CALL MVDAPROC(SAPLLEN,ADDR(SAVEPL),         0577
*                        PTRCPL(PTHCPLNO),NULLPARM);               0577
*                                                                  0577
         LA    @15,SAPLLEN                                         0577
         ST    @15,@AL00001                                        0577
         LA    @15,SAVEPL                                          0577
         ST    @15,@AFTEMPS                                        0577
         LA    @15,@AFTEMPS                                        0577
         ST    @15,@AL00001+4                                      0577
         LA    @15,PTRCPL+16                                       0577
         ST    @15,@AL00001+8                                      0577
         LA    @15,NULLPARM                                        0577
         ST    @15,@AL00001+12                                     0577
         LA    @01,@AL00001                                        0577
         BAL   @14,MVDAPROC                                        0577
*                      CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),     0578
*                        NULLPARM,CTGWKA,SETZERO);                 0578
*                                                                  0578
         MVC   @AL00001(16),@AL00578                               0578
         L     @01,CTGPLPTR                                        0578
         LA    @15,CTGWKA(,@01)                                    0578
         ST    @15,@AL00001+8                                      0578
         LA    @01,@AL00001                                        0578
         BAL   @14,MVDAPROC                                        0578
*                      AREALN = WKAREALN;                          0579
         L     @15,CTGPLPTR                                        0579
         L     @01,CTGWKA(,@15)                                    0579
         MVC   AREALN(2,@01),@CH00812                              0579
*                      CTGENT = ADDR(FNAME);                       0580
*                                                                  0580
         L     @01,FNMPTR                                          0580
         LA    @14,FNAME(,@01)                                     0580
         ST    @14,CTGENT(,@15)                                    0580
*                      /**********************************************/
*                      /*                                            */
*                      /*  CLEAR THE FPL POINTERS SET BY             */
*                      /*  THE PREVIOUS LOCATE.                      */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0581
*                      DO CLRFDCTR = 1 TO ONUM;                    0581
         LA    CLRFDCTR,1                                          0581
         B     @DE00581                                            0581
@DL00581 DS    0H                                                  0582
*                        CTGFLPTR = CTGFIELD(CLRFDCTR);            0582
         LR    @15,CLRFDCTR                                        0582
         SLA   @15,2                                               0582
         L     @01,CTGPLPTR                                        0582
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        0582
*                        CTGFLNG(1) = 0;                           0583
         SLR   @15,@15                                             0583
         ST    @15,CTGFLNG(,CTGFLPTR)                              0583
*                        CTGFLPT(1) = NULLPTR;                     0584
         ST    @15,CTGFLPT(,CTGFLPTR)                              0584
*                      END;                                        0585
*                                                                  0585
         AL    CLRFDCTR,@CF00218                                   0585
@DE00581 SLR   @02,@02                                             0585
         IC    @02,ONUM                                            0585
         CR    CLRFDCTR,@02                                        0585
         BNH   @DL00581                                            0585
*                      /**********************************************/
*                      /*                                            */
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG           */
*                      /*  TO DO THE ACTUAL LOCATE.                  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0586
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));            0586
*                                                                  0586
         LA    @15,PTRCPL+16                                       0586
         ST    @15,@AL00001                                        0586
         LA    @01,@AL00001                                        0586
         BAL   @14,CTLGPROC                                        0586
*                      RESPECIFY RTNREG RSTD;                      0587
*                      TESTRC = RTNREG;                            0588
         LR    TESTRC,RTNREG                                       0588
*                      RESPECIFY RTNREG UNRSTD;                    0589
*                                                                  0589
*                      IF TESTRC ^= 0                              0590
*                        THEN                                      0590
         LTR   TESTRC,TESTRC                                       0590
         BZ    @RF00590                                            0590
*                          DO;                                     0591
*                          /******************************************/
*                          /*                                        */
*                          /*IF SEVERE ERROR RETURNS WITH TERMINATION*/
*                          /*ELSE BYPASSES THIS PATH AND PRINTS      */
*                          /*WARNING MESSAGE                         */
*                          /*                                        */
*                          /******************************************/
*                          IF TESTRC = LASTCC16                    0592
*                            THEN                                  0592
         LA    @04,16                                              0592
         CR    TESTRC,@04                                          0592
         BNE   @RF00592                                            0592
*                              RETURN CODE(LASTCC16);              0593
         LR    @15,@04                                             0593
         L     @14,@SA00002                                        0593
         LM    @00,@12,@SA00002+8                                  0593
         BR    @14                                                 0593
*                            ELSE                                  0594
*                              DO;                                 0594
@RF00592 DS    0H                                                  0595
*                              ERRSAVFL = ON;                      0595
*                                                                  0595
         OI    ERRSAVFL,B'00100000'                                0595
*                              CALL  PRNTPROC(WARNMSG1,PTHCPLMG);  0596
*                                                                  0596
         LA    @01,@AL00596                                        0596
         BAL   @14,PRNTPROC                                        0596
*                              END;                                0597
*                          END;                                    0598
*                        ELSE                                      0599
*                          DO;                                     0599
         B     @RC00590                                            0599
@RF00590 DS    0H                                                  0600
*                          /******************************************/
*                          /*                                        */
*                          /*  CALL CONTRBL TO BUILD THE CONTROL     */
*                          /*  RECORD FOR THE CURRENT PATH AND       */
*                          /*  TO WRITE IT AND THE CATALOG WORK      */
*                          /*  AREA OUT THE PORTABILITY DATA SET     */
*                          /*                                        */
*                          /******************************************/
*                                                                  0600
*                          CALL CONTRBL(PTHCPLNO,CTGTPTH);         0600
*                                                                  0600
         LA    @01,@AL00600                                        0600
         BAL   @14,CONTRBL                                         0600
*                          RESPECIFY RTNREG RSTD;                  0601
*                          TESTRC = RTNREG;                        0602
         LR    TESTRC,RTNREG                                       0602
*                          RESPECIFY RTNREG UNRSTD;                0603
*                                                                  0603
*                          IF TESTRC ^= 0                          0604
*                            THEN                                  0604
         LTR   TESTRC,TESTRC                                       0604
         BZ    @RF00604                                            0604
*                              DO;                                 0605
*                              /**************************************/
*                              /*                                    */
*                              /* IF SEVERE ERROR RETURNS WITH       */
*                              /* TERMINATION CODE ELSE BYPASSES     */
*                              /* THIS PATH AND PRINTS MESSAGE TO    */
*                              /* INDICATE THE ERROR                 */
*                              /*                                    */
*                              /**************************************/
*                              IF TESTRC = LASTCC16                0606
*                                THEN                              0606
         LA    @04,16                                              0606
         CR    TESTRC,@04                                          0606
         BNE   @RF00606                                            0606
*                                  RETURN CODE(LASTCC16);          0607
         LR    @15,@04                                             0607
         L     @14,@SA00002                                        0607
         LM    @00,@12,@SA00002+8                                  0607
         BR    @14                                                 0607
*                                ELSE                              0608
*                                  DO;                             0608
@RF00606 DS    0H                                                  0609
*                                  ERRSAVFL = ON;                  0609
*                                                                  0609
         OI    ERRSAVFL,B'00100000'                                0609
*                                  CALL  PRNTPROC(WARNMSG1,PTHCPLMG);
*                                                                  0610
         LA    @01,@AL00610                                        0610
         BAL   @14,PRNTPROC                                        0610
*                                  END;                            0611
*                              END;                                0612
*                          END;                                    0613
*                                                                  0613
*                      END NFIRPATH;                               0614
*                                                                  0614
*                ELSE ;                                            0615
*                                                                  0615
@RF00534 DS    0H                                                  0616
*            END PATHREC;                                          0616
*                                                                  0616
@RC00534 AL    I,@CF00218                                          0616
@DE00530 LA    @15,1                                               0616
         AH    @15,NUMASSOC                                        0616
         CR    I,@15                                               0616
         BNH   @DL00530                                            0616
*          END PTHDEF;                                             0617
*                                                                  0617
*          ELSE  ;                                                 0618
*                                                                  0618
@RF00525 DS    0H                                                  0619
*        /************************************************************/
*        /*                                                          */
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */
*        /*  IF THE OPEN FAILS, RETURN TO THE CALLING PROCESSOR WITH */
*        /*  FAILURE INDICATED                                       */
*        /*  IF THE VSAM CLUSTER CONTAINS NO DATA RECORDS BYPASS OPEN*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0619
*        IF EMPTYDS = OFF                                          0619
*          THEN                                                    0619
         L     @15,@PC00001+4                                      0619
         L     @15,INPPTR(,@15)                                    0619
         L     @01,INPTBL+4(,@15)                                  0619
         TM    EMPTYDS(@01),B'00100000'                            0619
         BNZ   @RF00619                                            0619
*            DO;                                                   0620
*                                                                  0620
*            CALL OPENPROC('I',ADDR(INDDNM),NULLPARM,0,0,          0621
*              ADDR(PINIOCS));                                     0621
*                                                                  0621
         MVC   @AL00001(20),@AL00621                               0621
         LA    @15,INPTBL+8(,@15)                                  0621
         ST    @15,@AL00001+4                                      0621
         LA    @15,PINIOCS                                         0621
         ST    @15,@AFTEMPS                                        0621
         LA    @15,@AFTEMPS                                        0621
         ST    @15,@AL00001+20                                     0621
         LA    @01,@AL00001                                        0621
         BAL   @14,OPENPROC                                        0621
*        RESPECIFY RTNREG RSTD;                                    0622
*        TESTRC = RTNREG;                                          0623
         LR    TESTRC,RTNREG                                       0623
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ05916*/
*        IF TESTRC ^= 0                                            0625
*          THEN                                                    0625
         LTR   TESTRC,TESTRC                                       0625
         BZ    @RF00625                                            0625
*            RETURN CODE(LASTCC08);                                0626
         LA    @15,8                                               0626
         L     @14,@SA00002                                        0626
         LM    @00,@12,@SA00002+8                                  0626
         BR    @14                                                 0626
*            END;                                                  0627
*                                                                  0627
@RF00625 DS    0H                                                  0628
*        /************************************************************/
*        /*                                                          */
*        /*  CALL SAVEPROC TO WRITE THE CONTROL RECORDS TO THE       */
*        /*  PORTABILITY DATA SET, RECORD BY RECORD                  */
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */
*        /*  CALLING PROCESSOR.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0628
*        CALL SAVEPROC(NULLPARM,NULLPARM,'W');                     0628
*                                                                  0628
@RF00619 LA    @01,@AL00628                                        0628
         BAL   @14,SAVEPROC                                        0628
*        RESPECIFY RTNREG RSTD;                                    0629
*        TESTRC = RTNREG;                                          0630
         LR    TESTRC,RTNREG                                       0630
*        RESPECIFY RTNREG UNRSTD;                                  0631
*        IF TESTRC ^= 0                                            0632
*          THEN                                                    0632
         LTR   TESTRC,TESTRC                                       0632
         BZ    @RF00632                                            0632
*            RETURN CODE(LASTCC16);                                0633
*                                                                  0633
         LA    @15,16                                              0633
         L     @14,@SA00002                                        0633
         LM    @00,@12,@SA00002+8                                  0633
         BR    @14                                                 0633
*        /************************************************************/
*        /*                                                          */
*        /*  CALL RECPROC TO COPY THE CLUSTER DATA SET TO THE        */
*        /*  PORTABILITY DATA SET, RECORD BY RECORD                  */
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */
*        /*  CALLING PROCESSOR.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0634
*        CALL RECPROC;                                             0634
*                                                                  0634
@RF00632 BAL   @14,RECPROC                                         0634
*        RESPECIFY RTNREG RSTD;                                    0635
*        TESTRC = RTNREG;                                          0636
         LR    TESTRC,RTNREG                                       0636
*        RESPECIFY RTNREG UNRSTD;                                  0637
*        IF TESTRC ^= 0                                            0638
*          THEN                                                    0638
         LTR   TESTRC,TESTRC                                       0638
         BZ    @RF00638                                            0638
*            /********************************************************/
*            /*                                                      */
*            /* IF SEVERE ERROR RETURNS WITH TERMINATION CODE        */
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC ^= LASTCC08                                 0639
*              THEN                                                0639
         C     TESTRC,@CF00178                                     0639
         BE    @RF00639                                            0639
*                IF TESTRC = LASTCC12                              0640
*                  THEN                                            0640
         LA    @03,12                                              0640
         CR    TESTRC,@03                                          0640
         BNE   @RF00640                                            0640
*                    RETURN CODE(LASTCC12);                        0641
         LR    @15,@03                                             0641
         L     @14,@SA00002                                        0641
         LM    @00,@12,@SA00002+8                                  0641
         BR    @14                                                 0641
*                  ELSE                                            0642
*                    RETURN CODE(LASTCC16);                        0642
@RF00640 LA    @15,16                                              0642
         L     @14,@SA00002                                        0642
         LM    @00,@12,@SA00002+8                                  0642
         BR    @14                                                 0642
*              ELSE                                                0643
*                /****************************************************/
*                /*                                                  */
*                /* ERROR CLOSING INPUT DATA SET -- CONTINUE         */
*                /*                                                  */
*                /****************************************************/
*                ERRSAVFL = ON;                                    0643
*                                                                  0643
@RF00639 OI    ERRSAVFL,B'00100000'                                0643
*        /************************************************************/
*        /*                                                          */
*        /*WRITE A SOFTWARE END OF FILE ON THE PORTABILITY DATA SET  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0644
*        CALL  PUTPROC(NULLPARM,NULLPARM);                         0644
*                                                                  0644
@RF00638 LA    @01,@AL00644                                        0644
         BAL   @14,PUTPROC                                         0644
*        RESPECIFY RTNREG RSTD;                                    0645
*        TESTRC = RTNREG;                                          0646
         LR    TESTRC,RTNREG                                       0646
*        RESPECIFY RTNREG UNRSTD;                                  0647
*        IF TESTRC ^= 0                                            0648
*          THEN                                                    0648
         LTR   TESTRC,TESTRC                                       0648
         BZ    @RF00648                                            0648
*            RETURN CODE(LASTCC16);                                0649
*                                                                  0649
         LA    @15,16                                              0649
         L     @14,@SA00002                                        0649
         LM    @00,@12,@SA00002+8                                  0649
         BR    @14                                                 0649
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO MAIN PROCEDURE WITH SUCCESS INDICATED         */
*        /*                                                          */
*        /************************************************************/
*        RETURN CODE(0);                                           0650
*                                                                  0650
@RF00648 SLR   @15,@15                                             0650
         L     @14,@SA00002                                        0650
         LM    @00,@12,@SA00002+8                                  0650
         BR    @14                                                 0650
*END CLUSPROC;                                                     0651
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - LOCPROC                                 */
*        /*                                                          */
*        /*  FUNCTION - BUILD A CPL AND A MULTITUDE OF FPL'S FOR     */
*        /*  USE BY CATALOG LOCATE                                   */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    . LCINUM - CONTROL INTERVAL NUMBER (LOCATE BY         */
*        /*      CONTROL INTERVAL)                                   */
*        /*    . LCATACB - CATALOG ACB ADDRESS                       */
*        /*    . LFLDLST - LIST OF CATALOG FIELD NAMES. AN FPL IS    */
*        /*      CONSTRUCTED FOR EACH ONE.                           */
*        /*    . LFLDNUM - NUMBER OF NAMES IN FIELD LIST             */
*        /*    . LCPLPTR - RETURN CELL FOR CPL ADDRESS               */
*        /*    . IVOLSER - INDEX TO VOLUME SERIAL FPL                */
*        /*                                                          */
*        /*  OUTPUT- CPL ADDRESS                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0652
*LOCPROC:  PROCEDURE(LCINUM,           /*CONTROL INTERVAL NUMBER     */
*                    LCATACB,          /*CATALOG ACB ADDRESS         */
*                    LFLDLST,          /*LIST OF CATALOG FIELD NAMES */
*                    LFLDNUM,          /*NUMBER OF FIELDS IN LIST    */
*                    LCPLPTR);         /*RETURN CELL FOR CPL POINTER */
*                                                                  0652
LOCPROC  STM   @14,@12,@SA00003                                    0652
         MVC   @PC00003(20),0(@01)                                 0652
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0653
*        DCL                                                       0653
*          LCINUM     FIXED(24),                                   0653
*          LCATACB    PTR(31),                                     0653
*          LFLDLST(*) CHAR(8),                                     0653
*          LFLDNUM    PTR(8),                                      0653
*          LCPLPTR    PTR(31);                                     0653
*                                                                  0653
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL DECLARATIONS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0654
*        DCL CITYPEXT CHAR(8) INIT('ITYPEXT ');                    0654
*        DCL SSFLAG   CHAR(1) INIT('80'X);                         0655
*                                                                  0655
*        /************************************************************/
*        /*                                                          */
*        /*  COMPUTE HOW MUCH CORE NECESSARY FOR ONE CPL AND THE     */
*        /*  NUMBER OF FPL'S SPECIFIED BY FLDNUM, AND GET A CHUNK    */
*        /*  OF CORE.  GET A SEPARATE CHUNK OF CORE FOR THE WORK AREA*/
*        /*  IF CORE IS NOT OBTAINED, CONTROL IS RETURNED TO THE     */
*        /*  CALLING PROCESSOR WITH FAILURE INDICATED                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0656
*        OLDERID2 = NEWERID2;                                      0656
         L     @03,@PC00001                                        0656
         L     @15,GDTTR2(,@03)                                    0656
         MVC   @TS00001(95),NEWERID2(@15)                          0656
         MVC   OLDERID2(95,@15),@TS00001                           0656
*        NEWID2 = 'RC13';                                          0657
*                                                                  0657
         MVC   NEWID2(4,@15),@CC01102                              0657
*        TOTLEN = LENGTH(CTGPL) + LFLDNUM*4                        0658
*                  + (LENGTH(CTGFL) + 8) * (LFLDNUM + 1);          0658
*                                                                  0658
         L     @15,@PC00003+12                                     0658
         SLR   @14,@14                                             0658
         IC    @14,LFLDNUM(,@15)                                   0658
         LR    @15,@14                                             0658
         SLA   @15,2                                               0658
         AL    @15,@CF01286                                        0658
         AL    @14,@CF00218                                        0658
         MH    @14,@CH00309                                        0658
         ALR   @15,@14                                             0658
         ST    @15,TOTLEN                                          0658
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,LCPLPTR,GPID,SETZERO);       0659
*                                                                  0659
         ST    @03,@AL00001                                        0659
         LA    @15,TOTLEN                                          0659
         ST    @15,@AL00001+4                                      0659
         L     @15,@PC00003+16                                     0659
         ST    @15,@AL00001+8                                      0659
         LA    @15,GPID                                            0659
         ST    @15,@AL00001+12                                     0659
         LA    @15,SETZERO                                         0659
         ST    @15,@AL00001+16                                     0659
         MVI   @AL00001+16,X'80'                                   0659
         L     @15,GDTGPL(,@03)                                    0659
         LA    @01,@AL00001                                        0659
         BALR  @14,@15                                             0659
*        RESPECIFY RTNREG RSTD;                                    0660
*        TESTRC = RTNREG;                                          0661
         LR    TESTRC,RTNREG                                       0661
*        RESPECIFY RTNREG UNRSTD;                                  0662
*        IF TESTRC ^= 0                                            0663
*          THEN                                                    0663
         LTR   TESTRC,TESTRC                                       0663
         BZ    @RF00663                                            0663
*            DO;                                                   0664
*            DARGSMOD = UNIVMSG;                                   0665
         L     @15,DDSTRU                                          0665
         MVC   DARGSMOD(3,@15),@CC00847                            0665
*            DARGSENT = NOSTORAG;                                  0666
         MVI   DARGSENT(@15),X'04'                                 0666
*            RETURN CODE(LASTCC16);                                0667
         LA    @15,16                                              0667
         L     @14,@SA00003                                        0667
         LM    @00,@12,@SA00003+8                                  0667
         BR    @14                                                 0667
*            END;                                                  0668
*                                                                  0668
*        CTGPLPTR = LCPLPTR;                                       0669
*                                                                  0669
@RF00663 L     @03,@PC00003+16                                     0669
         L     @03,LCPLPTR(,@03)                                   0669
         ST    @03,CTGPLPTR                                        0669
*        /************************************************************/
*        /*                                                          */
*        /*  GET WORK AREA CORE FOR CATALOG MANAGEMENT LOCATE        */
*        /*  IF CORE NOT OBTAINED - TERMINATE                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0670
*        CALL IDCSAGP0 (GDTTBL,WKAREALN+LENGTH(PATHREL),           0670
*          CTGWKA,GPID,SETZERO);                                   0670
*                                                                  0670
         MVC   @AL00001+4(16),@AL00670                             0670
         L     @15,@PC00001                                        0670
         ST    @15,@AL00001                                        0670
         LA    @03,CTGWKA(,@03)                                    0670
         ST    @03,@AL00001+8                                      0670
         L     @15,GDTGPL(,@15)                                    0670
         LA    @01,@AL00001                                        0670
         BALR  @14,@15                                             0670
*        RESPECIFY RTNREG RSTD;                                    0671
*        TESTRC = RTNREG;                                          0672
         LR    TESTRC,RTNREG                                       0672
*        RESPECIFY RTNREG UNRSTD;                                  0673
*                                                                  0673
*        IF TESTRC ^= 0                                            0674
*          THEN                                                    0674
         LTR   TESTRC,TESTRC                                       0674
         BZ    @RF00674                                            0674
*            DO;                                                   0675
*            DARGSMOD = UNIVMSG;                                   0676
         L     @15,DDSTRU                                          0676
         MVC   DARGSMOD(3,@15),@CC00847                            0676
*            DARGSENT = NOSTORAG;                                  0677
         MVI   DARGSENT(@15),X'04'                                 0677
*            RETURN CODE(LASTCC16);                                0678
         LA    @15,16                                              0678
         L     @14,@SA00003                                        0678
         LM    @00,@12,@SA00003+8                                  0678
         BR    @14                                                 0678
*            END;                                                  0679
*                                                                  0679
*        AREALN = WKAREALN;                                        0680
*                                                                  0680
@RF00674 L     @15,CTGPLPTR                                        0680
         L     @01,CTGWKA(,@15)                                    0680
         MVC   AREALN(2,@01),@CH00812                              0680
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE CPL POINTER TO CATALOG NAME OR ACB PTR OR 0  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0681
*        IF LCATACB ^= NULLPTR                                     0681
*          THEN                                                    0681
         L     @14,@PC00003+4                                      0681
         L     @07,LCATACB(,@14)                                   0681
         LTR   @07,@07                                             0681
         BZ    @RF00681                                            0681
*            CTGCAT = ADDR(LCATACB);                               0682
         ST    @14,CTGCAT(,@15)                                    0682
*          ELSE                                                    0683
*            CTGCNAME = ON;                                        0683
*                                                                  0683
         B     @RC00681                                            0683
@RF00681 L     @01,CTGPLPTR                                        0683
         OI    CTGCNAME(@01),B'00000010'                           0683
*        /************************************************************/
*        /*                                                          */
*        /*  SET OPTIONS FLAGS IN CPL FOR LOCATE                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0684
*        CTGAM0 = ON;                                              0684
@RC00681 DS    0H                                                  0685
*        CTGNUM = ON;                                              0685
         L     @15,CTGPLPTR                                        0685
         OI    CTGAM0(@15),B'00000011'                             0685
*        CTGFUNC = CTGLOC;                                         0686
         NI    CTGFUNC(@15),B'00111111'                            0686
         OI    CTGFUNC(@15),B'00100000'                            0686
*        CTGENT = ADDR(LCINUM);                                    0687
*                                                                  0687
         L     @14,@PC00003                                        0687
         ST    @14,CTGENT(,@15)                                    0687
*        /************************************************************/
*        /*                                                          */
*        /*  SET PASSWORD IF SPECIFIED IN AMS COMMAND                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0688
*        IF OBJPLN > 0                                             0688
*          THEN                                                    0688
         L     @14,@PC00001+4                                      0688
         L     @01,INPPTR(,@14)                                    0688
         L     @14,INPTBL(,@01)                                    0688
         CLI   OBJPLN(@14),0                                       0688
         BNH   @RF00688                                            0688
*            CTGPSWD = ADDR(OBJPAS);                               0689
         LA    @14,OBJPAS(,@14)                                    0689
         ST    @14,CTGPSWD(,@15)                                   0689
*        /************************************************************/
*        /*                                                          */
*        /*  BUILD A FPL FOR EACH CATALOG FIELD NAME IN THE FIELD    */
*        /*  LIST.  THE FPLS WILL BE BUILT FOLLOWING THE CPL         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0690
*        CTGFLPTR = CTGPLPTR + LENGTH(CTGPL) + LFLDNUM*4;          0690
@RF00688 L     @15,CTGPLPTR                                        0690
         LA    CTGFLPTR,28                                         0690
         ALR   CTGFLPTR,@15                                        0690
         L     @03,@PC00003+12                                     0690
         SLR   @14,@14                                             0690
         IC    @14,LFLDNUM(,@03)                                   0690
         LR    @03,@14                                             0690
         SLA   @03,2                                               0690
         ALR   CTGFLPTR,@03                                        0690
*        CTGNOFLD = LFLDNUM;                                       0691
*                                                                  0691
         STC   @14,CTGNOFLD(,@15)                                  0691
*          /**********************************************************/
*          /*                                                        */
*          /*  LFLDNUM CONTAINS THE NUMBER OF FIELDNAMES, HENCE      */
*          /*  THE NUMBER OF FPLS TO BE CONSTRUCTED.  THE CPL        */
*          /*  CONTAINS A POINTER TO EACH FPL IN THE ARRAY CTGFIELD  */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0692
*        DO INDX = 1 TO LFLDNUM;                                   0692
         LA    INDX,1                                              0692
         B     @DE00692                                            0692
@DL00692 DS    0H                                                  0693
*          CTGFIELD(INDX) = CTGFLPTR;                              0693
         LR    @05,INDX                                            0693
         SLA   @05,2                                               0693
         L     @03,CTGPLPTR                                        0693
         ST    CTGFLPTR,CTGFIELD-4(@05,@03)                        0693
*          CTGFLDNO = '00000001'B;                                 0694
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0694
*          CTGFLDNM = ADDR(LFLDLST(INDX));                         0695
         LR    @05,INDX                                            0695
         SLA   @05,3                                               0695
         L     @03,@PC00003+8                                      0695
         AL    @03,@CF01313                                        0695
         LA    @05,LFLDLST(@05,@03)                                0695
         ST    @05,CTGFLDNM(,CTGFLPTR)                             0695
*          CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;                0696
*                                                                  0696
         LA    @05,24                                              0696
         ALR   CTGFLPTR,@05                                        0696
*          /**********************************************************/
*          /*                                                        */
*          /*  IF CONSTRUCTING A VOLSER FPL, CONSTRUCT AN ADDITIONAL */
*          /*  FPL TO BE CHAINED TO THE VOLSER FPL FOR THE TEST      */
*          /*  SO THAT CATALOG MANAGEMENT WILL NOT RETURN SEQUENCE   */
*          /*  SET VOLUMES(IMBED FEATURE)                            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0697
*          IF INDX = IVOLSR                                        0697
*            THEN                                                  0697
         C     INDX,@CF00893                                       0697
         BNE   @RF00697                                            0697
*              DO;                                                 0698
*              CTGFIELD(INDX) -> CTGFLCHN = CTGFLPTR;              0699
         LR    @03,INDX                                            0699
         SLA   @03,2                                               0699
         L     @01,CTGPLPTR                                        0699
         L     @03,CTGFIELD-4(@03,@01)                             0699
         ST    CTGFLPTR,CTGFLCHN(,@03)                             0699
*              CTGFLDNO = '00000001'B;                             0700
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0700
*              CTGFLDCD = CTGFLDZ;                                 0701
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            0701
*              CTGFLDNM = ADDR(CITYPEXT);                          0702
         LA    @03,CITYPEXT                                        0702
         ST    @03,CTGFLDNM(,CTGFLPTR)                             0702
*              CTGFLNG(1) = 1;                                     0703
         MVC   CTGFLNG(4,CTGFLPTR),@CF00218                        0703
*              CTGFLPT(1) = ADDR(SSFLAG);                          0704
         LA    @03,SSFLAG                                          0704
         ST    @03,CTGFLPT(,CTGFLPTR)                              0704
*              CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;            0705
         ALR   CTGFLPTR,@05                                        0705
*              END;                                                0706
*        END;                                                      0707
*                                                                  0707
@RF00697 AL    INDX,@CF00218                                       0707
@DE00692 L     @05,@PC00003+12                                     0707
         SLR   @03,@03                                             0707
         IC    @03,LFLDNUM(,@05)                                   0707
         CR    INDX,@03                                            0707
         BNH   @DL00692                                            0707
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0708
*        RETURN CODE(0);                                           0708
*                                                                  0708
         SLR   @15,@15                                             0708
         L     @14,@SA00003                                        0708
         LM    @00,@12,@SA00003+8                                  0708
         BR    @14                                                 0708
*END LOCPROC;                                                      0709
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - CTLGPROC                                */
*        /*                                                          */
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/
*        /*  THE OPERATION INDICATED IN THE CPL (LOCATE)             */
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */
*        /*  INDICATORS                                              */
*        /*                                                          */
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */
*        /*                                                          */
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */
*        /*  FAILURE.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0710
*CTLGPROC:  PROCEDURE(SCPLPTR);         /*CPL POINTER                */
*                                                                  0710
CTLGPROC STM   @14,@12,@SA00004                                    0710
         MVC   @PC00004(4),0(@01)                                  0710
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0711
*        DCL SCPLPTR PTR(31);                                      0711
*                                                                  0711
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL DECLARATIONS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0712
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */
*                                      /*VSAM CATALOG MANAGEMENT     */
*                                                                  0713
*        /************************************************************/
*        /*                                                          */
*        /*  INVOKE CATALOG MANAGEMENT                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0713
*        OLDERID2 = NEWERID2;                                      0713
         L     @15,@PC00001                                        0713
         L     @14,GDTTR2(,@15)                                    0713
         MVC   @TS00001(95),NEWERID2(@14)                          0713
         MVC   OLDERID2(95,@14),@TS00001                           0713
*        NEWID2 = 'RC15';                                          0714
         MVC   NEWID2(4,@14),@CC01110                              0714
*        IF GDTDBG = NULLPTR                                       0715
*          THEN;                                                   0715
         L     @15,GDTDBG(,@15)                                    0715
         LTR   @15,@15                                             0715
         BZ    @RT00715                                            0715
*          ELSE                                                    0717
*            CALL IDCDB010 (GDTTBL,'RC16');                        0717
*                                                                  0717
         L     @15,@PC00001                                        0717
         ST    @15,@AL00001                                        0717
         LA    @14,@CC01111                                        0717
         ST    @14,@AL00001+4                                      0717
         MVI   @AL00001+4,X'80'                                    0717
         L     @15,GDTDBG(,@15)                                    0717
         LA    @01,@AL00001                                        0717
         BALR  @14,@15                                             0717
*        CATRTNID = 'CATLGRTN';                                    0718
*                                                                  0718
@RT00715 MVC   CATRTNID(8),@CC01112                                0718
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           0719
*                                                                  0719
         L     @15,@PC00001                                        0719
         ST    @15,@AL00001                                        0719
         L     @14,@PC00004                                        0719
         ST    @14,@AL00001+4                                      0719
         L     @15,GDTCAT(,@15)                                    0719
         LA    @01,@AL00001                                        0719
         BALR  @14,@15                                             0719
*        RESPECIFY REG15 RSTD;                                     0720
*        CATLGRC = REG15;                                          0721
         STH   REG15,CATLGRC                                       0721
*        RESPECIFY REG15 UNRSTD;                                   0722
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0723
*        IF CATLGRC ^= 0                                           0723
*          THEN                                                    0723
         LH    @15,CATLGRC                                         0723
         LTR   @15,@15                                             0723
         BZ    @RF00723                                            0723
*            IF CATLGRC = 40                                       0724
*              THEN                                                0724
         C     @15,@CF01113                                        0724
         BNE   @RF00724                                            0724
*                DO;                                               0725
*                                                                  0725
*                /****************************************************/
*                /*                                                  */
*                /*  GET NEEDED SIZE FROM CATALOG WORKARE AT OFFSET  */
*                /*  AND OBTAIN CORE.  IF SIZE NOT RETURNED OR       */
*                /*  CORE NOT OBTAINED - TERMINATE                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0726
*                CTGPLPTR = SCPLPTR;                               0726
         L     @15,@PC00004                                        0726
         L     @15,SCPLPTR(,@15)                                   0726
         ST    @15,CTGPLPTR                                        0726
*                WSIZE = RETURNLN;                                 0727
*                                                                  0727
         L     @01,CTGWKA(,@15)                                    0727
         LH    WSIZE,RETURNLN(,@01)                                0727
*                CALL IDCSAFS0 (GDTTBL,CTGWKA);                    0728
*                                                                  0728
         L     @14,@PC00001                                        0728
         ST    @14,@AL00001                                        0728
         LA    @15,CTGWKA(,@15)                                    0728
         ST    @15,@AL00001+4                                      0728
         L     @15,GDTFSP(,@14)                                    0728
         LA    @01,@AL00001                                        0728
         BALR  @14,@15                                             0728
*                CALL IDCSAGP0 (GDTTBL,WSIZE + LENGTH(PATHREL),    0729
*                  CTGWKA,GPID,SETZERO);                           0729
         L     @15,@PC00001                                        0729
         ST    @15,@AL00001                                        0729
         LA    @14,52                                              0729
         ALR   @14,WSIZE                                           0729
         ST    @14,@AFTEMPS+4                                      0729
         LA    @14,@AFTEMPS+4                                      0729
         ST    @14,@AL00001+4                                      0729
         L     @01,CTGPLPTR                                        0729
         LA    @14,CTGWKA(,@01)                                    0729
         ST    @14,@AL00001+8                                      0729
         LA    @14,GPID                                            0729
         ST    @14,@AL00001+12                                     0729
         LA    @14,SETZERO                                         0729
         ST    @14,@AL00001+16                                     0729
         MVI   @AL00001+16,X'80'                                   0729
         L     @15,GDTGPL(,@15)                                    0729
         LA    @01,@AL00001                                        0729
         BALR  @14,@15                                             0729
*                RESPECIFY RTNREG RSTD;                            0730
*                TESTRC = RTNREG;                                  0731
         LR    TESTRC,RTNREG                                       0731
*                RESPECIFY RTNREG UNRSTD;                          0732
*                IF TESTRC ^= 0                                    0733
*                  THEN                                            0733
         LTR   TESTRC,TESTRC                                       0733
         BZ    @RF00733                                            0733
*                    DO;                                           0734
*                    DARGSMOD = UNIVMSG;                           0735
         L     @15,DDSTRU                                          0735
         MVC   DARGSMOD(3,@15),@CC00847                            0735
*                    DARGSENT = NOSTORAG;                          0736
         MVI   DARGSENT(@15),X'04'                                 0736
*                    RETURN CODE(LASTCC16);                        0737
         LA    @15,16                                              0737
         L     @14,@SA00004                                        0737
         LM    @00,@12,@SA00004+8                                  0737
         BR    @14                                                 0737
*                    END;                                          0738
*                                                                  0738
*                AREALN = WSIZE;                                   0739
*                                                                  0739
@RF00733 L     @02,CTGPLPTR                                        0739
         L     @02,CTGWKA(,@02)                                    0739
         STH   WSIZE,AREALN(,@02)                                  0739
*                /****************************************************/
*                /*                                                  */
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0740
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   0740
*                                                                  0740
         L     @15,@PC00001                                        0740
         ST    @15,@AL00001                                        0740
         L     @14,@PC00004                                        0740
         ST    @14,@AL00001+4                                      0740
         L     @15,GDTCAT(,@15)                                    0740
         LA    @01,@AL00001                                        0740
         BALR  @14,@15                                             0740
*                RESPECIFY REG15 RSTD;                             0741
*                CATLGRC = REG15;                                  0742
         STH   REG15,CATLGRC                                       0742
*                RESPECIFY REG15 UNRSTD;                           0743
*                                                                  0743
*                END;                                              0744
*        IF CATLGRC ^= 0                                           0745
*          THEN                                                    0745
@RF00724 DS    0H                                                  0745
@RF00723 LH    @15,CATLGRC                                         0745
         LTR   @15,@15                                             0745
         BZ    @RF00745                                            0745
*            IF CTGFDBK ^= 0                                       0746
*              THEN                                                0746
*                                                                  0746
         L     @15,CTGPLPTR                                        0746
         LH    @14,CTGFDBK(,@15)                                   0746
         N     @14,@CF01314                                        0746
         LTR   @14,@14                                             0746
         BZ    @RF00746                                            0746
*                /****************************************************/
*                /*                                                  */
*                /*  CATALOG MANAGEMENT HAS SET THE                  */
*                /*  PROBLEM DETERMINATION FIELDS.                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0747
*                DO;                                               0747
*                DARGSENT = PROBMSG;                               0748
         L     @14,DDSTRU                                          0748
         MVI   DARGSENT(@14),X'0A'                                 0748
*                DARGSMOD = UNIVMSG;                               0749
         MVC   DARGSMOD(3,@14),@CC00847                            0749
*                DARGCNT = 3;                                      0750
         LA    @07,3                                               0750
         STH   @07,DARGCNT(,@14)                                   0750
*                DARGINS(1) = 1;                                   0751
         MVC   DARGINS(2,@14),@CH00218                             0751
*                DARGINL(1) = 2;                                   0752
         LA    @06,2                                               0752
         STH   @06,DARGINL(,@14)                                   0752
*                DARGDTM(1) = ADDR(CATLGRC);                       0753
         LA    @05,CATLGRC                                         0753
         ST    @05,DARGDTM(,@14)                                   0753
*                DARGINS(2) = 2;                                   0754
         STH   @06,DARGINS+8(,@14)                                 0754
*                DARGINL(2) = 2;                                   0755
         STH   @06,DARGINL+8(,@14)                                 0755
*                DARGDTM(2) = ADDR(CTGFDBK);                       0756
         LA    @05,CTGFDBK(,@15)                                   0756
         ST    @05,DARGDTM+8(,@14)                                 0756
*                DARGINS(3) = 3;                                   0757
         STH   @07,DARGINS+16(,@14)                                0757
*                DARGINL(3) = 2;                                   0758
         STH   @06,DARGINL+16(,@14)                                0758
*                DARGDTM(3) = ADDR(CTGFBFLG);                      0759
         LA    @15,CTGFBFLG(,@15)                                  0759
         ST    @15,DARGDTM+16(,@14)                                0759
*                RETURN CODE(LASTCC08);                            0760
         LA    @15,8                                               0760
         L     @14,@SA00004                                        0760
         LM    @00,@12,@SA00004+8                                  0760
         BR    @14                                                 0760
*                END;                                              0761
*                                                                  0761
*              ELSE                                                0762
*                                                                  0762
*                /****************************************************/
*                /*                                                  */
*                /*  PROBLEM DETERMINATION FIELDS NOT SET            */
*                /*                                                  */
*                /****************************************************/
*                                                                  0762
*                DO;                                               0762
@RF00746 DS    0H                                                  0763
*                DARGSENT = CATLGMSG;                              0763
         L     @15,DDSTRU                                          0763
         MVI   DARGSENT(@15),X'07'                                 0763
*                DARGSMOD = UNIVMSG;                               0764
         MVC   DARGSMOD(3,@15),@CC00847                            0764
*                DARGDBP = ADDR(CATLGRC);                          0765
         LA    @14,CATLGRC                                         0765
         ST    @14,DARGDBP(,@15)                                   0765
*                DARGILP = 2;                                      0766
         MVC   DARGILP(2,@15),@CH00152                             0766
*                RETURN CODE(LASTCC08);                            0767
         LA    @15,8                                               0767
         L     @14,@SA00004                                        0767
         LM    @00,@12,@SA00004+8                                  0767
         BR    @14                                                 0767
*                END;                                              0768
*                                                                  0768
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0769
*        RETURN CODE(0);                                           0769
*                                                                  0769
@RF00745 SLR   @15,@15                                             0769
         L     @14,@SA00004                                        0769
         LM    @00,@12,@SA00004+8                                  0769
         BR    @14                                                 0769
*END CTLGPROC;                                                     0770
*                                                                  0771
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - OPENPROC                               */
*        /*                                                          */
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING AN   */
*        /*  VSAM COMPONENT FOR INPUT, OR OPENING THE PORTABILITY    */
*        /*  DATA SET FOR OUTPUT.                                    */
*        /*  WHEN OPENING THE VSAM OBJECT FOR INPUT, SETS            */
*        /*  THE EXPORT/IMPORT FLAG IN THE OPNAGL.                   */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */
*        /*           OPENED                                         */
*        /*    .ODSN - NAME OF VSAM COMPONENT                        */
*        /*    .OREC - LRECL SIZE FOR OUTPUT DATA SET                */
*        /*    .OBLK - BLKSIZE FOR OUTPUT DATA SET                   */
*        /*                                                          */
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0771
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */
*                                      /*TO CLUSTER                  */
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */
*                     OIOCS);          /*RETURN CELL FOR IOCS        */
*                                                                  0771
OPENPROC STM   @14,@12,@SA00005                                    0771
         MVC   @PC00005(24),0(@01)                                 0771
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0772
*        DCL                                                       0772
*          OTYPE CHAR(1),                                          0772
*          ODD   PTR(31),                                          0772
*          ODSN  PTR(31),                                          0772
*          OREC,                                                   0772
*          OBLK,                                                   0772
*          OIOCS PTR(31);                                          0772
*                                                                  0772
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0773
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               0773
*                                      /* STORAGE FOR OPEN ARGUMENT  */
*                                      /* LIST                       */
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        0774
*                                      /*PTR TO IOCS RETURNED BY OPEN*/
*                                                                  0775
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */
*        /*  VERSUS AN OUTPUT DATA SET                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0775
*        OLDERID2 = NEWERID2;                                      0775
         L     @02,@PC00001                                        0775
         L     @02,GDTTR2(,@02)                                    0775
         MVC   @TS00001(95),NEWERID2(@02)                          0775
         MVC   OLDERID2(95,@02),@TS00001                           0775
*        NEWID2 = 'RC17';                                          0776
         MVC   NEWID2(4,@02),@CC01131                              0776
*        OPENLIST = ''B;                                           0777
         XC    OPENLIST(48),OPENLIST                               0777
*        OPNPTR = ADDR(OPENLIST);                                  0778
*                                                                  0778
         LA    OPNPTR,OPENLIST                                     0778
*        /************************************************************/
*        /*                                                          */
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */
*        /*  INPUT                                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0779
*        OPNIOC = OIOCS;                                   /*@OZ10867*/
         L     @02,@PC00005+20                                     0779
         L     @02,OIOCS(,@02)                                     0779
         ST    @02,OPNIOC(,OPNPTR)                                 0779
*        OPNDDN = ODD;                                     /*@OZ10867*/
*                                                                  0780
         L     @02,@PC00005+4                                      0780
         L     @02,ODD(,@02)                                       0780
         ST    @02,OPNDDN(,OPNPTR)                                 0780
*        IF OTYPE = 'O'                                            0781
*          THEN                                                    0781
         L     @02,@PC00005                                        0781
         CLI   OTYPE(@02),C'O'                                     0781
         BNE   @RF00781                                            0781
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN FOR OUTPUT SPECIFIED - SET VBS  FORMAT         */
*            /*                                                      */
*            /********************************************************/
*                                                                  0782
*            DO;                                                   0782
*            OPNTYPRV = ON;                                        0783
         OI    OPNTYPRV(OPNPTR),B'00000010'                        0783
*            OPNOPTOT = ON;                                        0784
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0784
*            OPNRFMSF = ON;                                        0785
*            OPNRFMBK = ON;                                        0786
         OI    OPNRFMSF(OPNPTR),B'00011000'                        0786
*            OPNBLK = OBLK;                                        0787
         L     @02,@PC00005+16                                     0787
         L     @02,OBLK(,@02)                                      0787
         ST    @02,OPNBLK(,OPNPTR)                                 0787
*            OPNREC = OREC;                                        0788
*                                                                  0788
         L     @02,@PC00005+12                                     0788
         L     @02,OREC(,@02)                                      0788
         ST    @02,OPNREC(,OPNPTR)                                 0788
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS TO SPECIFY    */
*            /*  DEVICE TYPES ON EXPORT COMMAND                      */
*            /*                                                      */
*            /********************************************************/
*                                                                  0789
*            IF ADDR(PDEVNM) ^= NULLPTR                            0789
*              THEN                                                0789
         L     @02,@PC00001+4                                      0789
         L     @02,INPPTR(,@02)                                    0789
         L     @02,INPTBL+16(,@02)                                 0789
         LTR   @02,@02                                             0789
         BZ    @RF00789                                            0789
*                OPNDEVDT = ADDR(PDEVNM);                          0790
         ST    @02,OPNDEVDT(,OPNPTR)                               0790
*            END;                                                  0791
*                                                                  0791
@RF00789 DS    0H                                                  0792
*        IF OTYPE = 'I'                                            0792
*          THEN                                                    0792
@RF00781 L     @02,@PC00005                                        0792
         CLI   OTYPE(@02),C'I'                                     0792
         BNE   @RF00792                                            0792
*            DO;                                                   0793
*            /********************************************************/
*            /*                                                      */
*            /* INITIALIZE THE OPENAGL SO THAT THE DATASET WILL      */
*            /* OPENED FOR CI PROCESSING FPR VERIFY.                 */
*            /* SET IMPORT/EXPORT FLAG,OPTIONAL NAME FLAG    @OZ12941*/
*            /* AND DSNAME POINTER                           @OZ12941*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0794
*            OPNOPTIN = OFF;                               /*@OZ10867*/
*            OPNOPTOT = ON;                                /*@OZ10867*/
*            OPNOPTBK = ON;                                /*@OZ10867*/
*            OPNOPTCR = ON;                                /*@OZ10867*/
         OI    OPNOPTOT(OPNPTR),B'01010100'                        0797
         NI    OPNOPTIN(OPNPTR),B'01111111'                        0797
*            OPNTYPXM=ON;                                  /*@OZ12941*/
         OI    OPNTYPXM(OPNPTR),B'00010000'                        0798
*            OPNOPTNM=ON;                                  /*@OZ12941*/
         OI    OPNOPTNM(OPNPTR),B'01000000'                        0799
*            OPNDSN=ADDR(PTRCPL(1)->CTGFIELD(IENTNAME)->   /*@OZ12941*/
*                   CTGFLPT(1)->FENTNAME);                 /*@OZ12941*/
*                                                                  0800
         L     @01,PTRCPL                                          0800
         L     @01,CTGFIELD+4(,@01)                                0800
         L     @15,CTGFLPT(,@01)                                   0800
         ST    @15,OPNDSN(,OPNPTR)                                 0800
*            /********************************************************/
*            /*                                                      */
*            /* OPEN FOR CI PROCESSING                               */
*            /*                                                      */
*            /********************************************************/
*                                                                  0801
*            CALL IDCIOOP0 (GDTTBL,OPNAGL);                /*@OZ10867*/
         L     @15,@PC00001                                        0801
         ST    @15,@AL00001                                        0801
         ST    OPNPTR,@AL00001+4                                   0801
         MVI   @AL00001+4,X'80'                                    0801
         L     @15,GDTOPN(,@15)                                    0801
         LA    @01,@AL00001                                        0801
         BALR  @14,@15                                             0801
*            RESPECIFY RTNREG RSTD;                                0802
*            TESTRC = RTNREG;                                      0803
         LR    TESTRC,RTNREG                                       0803
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ10867*/
*                                                                  0804
*            IF TESTRC ^= 0                                /*@OZ10867*/
*              THEN                                        /*@OZ10867*/
         LTR   TESTRC,TESTRC                                       0805
         BZ    @RF00805                                            0805
*                RETURN CODE(LASTCC08);                    /*@OZ10867*/
*                                                                  0806
         LA    @15,8                                               0806
         L     @14,@SA00005                                        0806
         LM    @00,@12,@SA00005+8                                  0806
         BR    @14                                                 0806
*            /********************************************************/
*            /*                                                      */
*            /* VERIFY THE THE DATASET TO PREVENT LOSS OF DATA       */
*            /* (DATASETS LEFT OPEN AFTER SYSTEM FAILURE)            */
*            /*                                                      */
*            /********************************************************/
*                                                                  0807
*            CALL IDCIOVY0 (GDTTBL,OIOCSPTR);              /*@OZ10867*/
@RF00805 L     @15,@PC00001                                        0807
         ST    @15,@AL00001                                        0807
         L     @14,@PC00005+20                                     0807
         L     @01,OIOCS(,@14)                                     0807
         ST    @01,@AL00001+4                                      0807
         MVI   @AL00001+4,X'80'                                    0807
         L     @15,GDTVFY(,@15)                                    0807
         LA    @01,@AL00001                                        0807
         BALR  @14,@15                                             0807
*            RESPECIFY RTNREG RSTD;                                0808
*            TESTRC = RTNREG;                                      0809
         LR    TESTRC,RTNREG                                       0809
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ10867*/
*                                                                  0810
*            IF TESTRC ^= 0                                /*@OZ10867*/
*              THEN                                        /*@OZ10867*/
         LTR   TESTRC,TESTRC                                       0811
         BZ    @RF00811                                            0811
*                RETURN CODE(LASTCC08);                    /*@OZ10867*/
*                                                                  0812
         LA    @15,8                                               0812
         L     @14,@SA00005                                        0812
         LM    @00,@12,@SA00005+8                                  0812
         BR    @14                                                 0812
*            /********************************************************/
*            /*                                                      */
*            /* CLOSE AND RESET THE OPEN OPTIONS                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0813
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);              /*@OZ10867*/
@RF00811 L     @15,@PC00001                                        0813
         ST    @15,@AL00001                                        0813
         L     @14,@PC00005+20                                     0813
         L     @01,OIOCS(,@14)                                     0813
         ST    @01,@AL00001+4                                      0813
         MVI   @AL00001+4,X'80'                                    0813
         L     @15,GDTCLS(,@15)                                    0813
         LA    @01,@AL00001                                        0813
         BALR  @14,@15                                             0813
*            OPNOPTOT = OFF;                               /*@OZ10867*/
*            OPNOPTCR = OFF;                               /*@OZ10867*/
*            OPNOPTBK = OFF;                               /*@OZ10867*/
*                                                          /*@OZ10867*/
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN VSAM CLUSTER FOR INPUT AND RECORD PROCESSING,  */
*            /*  AND SET THE EXPORT/IMPORT FLAG AND OPTIONAL NAME    */
*            /*  FLAG AND DSNAME POINTER                     @OZ12941*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0817
*            OPNOPTIN = ON;                                        0817
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0817
         NI    OPNOPTOT(OPNPTR),B'10101011'                        0817
*            OPNTYPXM = ON;                                        0818
         OI    OPNTYPXM(OPNPTR),B'00010000'                        0818
*            OPNOPTNM=ON;                                  /*@OZ12941*/
         OI    OPNOPTNM(OPNPTR),B'01000000'                        0819
*            OPNDSN=ADDR(PTRCPL(1)->CTGFIELD(IENTNAME)->   /*@OZ12941*/
*                   CTGFLPT(1)->FENTNAME);                 /*@OZ12941*/
*                                                                  0820
         L     @15,PTRCPL                                          0820
         L     @01,CTGFIELD+4(,@15)                                0820
         L     @14,CTGFLPT(,@01)                                   0820
         ST    @14,OPNDSN(,OPNPTR)                                 0820
*            CTGFLPTR = PTRCPL(1) -> CTGFIELD(IPASSWOR);           0821
         L     CTGFLPTR,CTGFIELD+36(,@15)                          0821
*            IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR            0822
*              THEN                                                0822
         SLR   @15,@15                                             0822
         C     @15,CTGFLNG(,CTGFLPTR)                              0822
         BE    @RF00822                                            0822
         L     @14,CTGFLPT(,CTGFLPTR)                              0822
         CR    @14,@15                                             0822
         BE    @RF00822                                            0822
*                OPNPWA = CTGFLPT(1);                              0823
         ST    @14,OPNPWA(,OPNPTR)                                 0823
*              ELSE                                                0824
*                IF OBJPLN > 0                                     0824
*                  THEN                                            0824
         B     @RC00822                                            0824
@RF00822 L     @02,@PC00001+4                                      0824
         L     @02,INPPTR(,@02)                                    0824
         L     @02,INPTBL(,@02)                                    0824
         CLI   OBJPLN(@02),0                                       0824
         BNH   @RF00824                                            0824
*                    OPNPWA = ADDR(OBJPAS);                        0825
         LA    @02,OBJPAS(,@02)                                    0825
         ST    @02,OPNPWA(,OPNPTR)                                 0825
*            END;                                                  0826
*                                                                  0826
*                                                                  0826
@RF00824 DS    0H                                                  0826
@RC00822 DS    0H                                                  0827
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0827
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            0827
*                                                                  0827
@RF00792 L     @15,@PC00001                                        0827
         ST    @15,@AL00001                                        0827
         ST    OPNPTR,@AL00001+4                                   0827
         MVI   @AL00001+4,X'80'                                    0827
         L     @15,GDTOPN(,@15)                                    0827
         LA    @01,@AL00001                                        0827
         BALR  @14,@15                                             0827
*        RESPECIFY RTNREG RSTD;                                    0828
*        TESTRC = RTNREG;                                          0829
         LR    TESTRC,RTNREG                                       0829
*        RESPECIFY RTNREG UNRSTD;                                  0830
*                                                                  0830
*        /************************************************************/
*        /*                                                          */
*        /*  TEST RETURN CODE FROM OPEN.  IF INPUT DATA SET CHECK    */
*        /*  FOR EMPTY DATA SET RETURN CODE OR DATA SET ALREADY OPEN */
*        /*  CONTINUE PROCESSING IF THESE CONDITIONS EXIST.          */
*        /* IF OUTPUT RETURN WITH TERMINATION CODE.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0831
*        IF TESTRC ^= 0                                            0831
*          THEN                                                    0831
         LTR   TESTRC,TESTRC                                       0831
         BZ    @RF00831                                            0831
*            IF OTYPE = 'I'                                        0832
*              THEN                                                0832
         L     @15,@PC00005                                        0832
         CLI   OTYPE(@15),C'I'                                     0832
         BNE   @RF00832                                            0832
*                IF OIOCSPTR -> IOCMSGOP = ON  ×                   0833
*                   OIOCSPTR -> IOCVRC(4:4) = EMPDSRTN             0833
*                                                                  0833
*                  THEN                                            0833
         L     @15,@PC00005+20                                     0833
         L     @01,OIOCS(,@15)                                     0833
         L     @15,OIOCSPTR(,@01)                                  0833
         TM    IOCMSGOP(@15),B'00100000'                           0833
         BO    @RT00833                                            0833
         CLC   IOCVRC+3(1,@15),EMPDSRTN                            0833
         BNE   @RF00833                                            0833
@RT00833 DS    0H                                                  0834
*                    RETURN CODE(0);                               0834
*                                                                  0834
         SLR   @15,@15                                             0834
         L     @14,@SA00005                                        0834
         LM    @00,@12,@SA00005+8                                  0834
         BR    @14                                                 0834
*                  ELSE                                            0835
*                    DO;                                           0835
@RF00833 DS    0H                                                  0836
*                    IF OIOCSPTR -> IOCMSGOP = ON          /*@OZ10866*/
*                      THEN                                /*@OZ10866*/
*                                                                  0836
         L     @15,@PC00005+20                                     0836
         L     @15,OIOCS(,@15)                                     0836
         L     @01,OIOCSPTR(,@15)                                  0836
         TM    IOCMSGOP(@01),B'00100000'                           0836
         BNO   @RF00836                                            0836
*                         CALL IDCIOCL0 (GDTTBL,OIOCSPTR);         0837
*                                                                  0837
         L     @14,@PC00001                                        0837
         ST    @14,@AL00001                                        0837
         ST    @15,@AL00001+4                                      0837
         MVI   @AL00001+4,X'80'                                    0837
         L     @15,GDTCLS(,@14)                                    0837
         LA    @01,@AL00001                                        0837
         BALR  @14,@15                                             0837
*                    OIOCSPTR = NULLPTR;                           0838
@RF00836 L     @15,@PC00005+20                                     0838
         L     @01,OIOCS(,@15)                                     0838
         SLR   @00,@00                                             0838
         ST    @00,OIOCSPTR(,@01)                                  0838
*                    RETURN CODE(LASTCC08);                        0839
         LA    @15,8                                               0839
         L     @14,@SA00005                                        0839
         LM    @00,@12,@SA00005+8                                  0839
         BR    @14                                                 0839
*                    END;                                          0840
*                                                                  0840
*              ELSE                                                0841
*                RETURN CODE(LASTCC16);                            0841
*                                                                  0841
@RF00832 LA    @15,16                                              0841
         L     @14,@SA00005                                        0841
         LM    @00,@12,@SA00005+8                                  0841
         BR    @14                                                 0841
*          ELSE                                                    0842
*                                                                  0842
*            /********************************************************/
*            /*                                                      */
*            /*  RETURN TO CALLER INDICATING SUCCESSFUL COMPLETION   */
*            /*  OF OPEN                                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  0842
*            RETURN CODE(0);                                       0842
*                                                                  0842
@RF00831 SLR   @15,@15                                             0842
         L     @14,@SA00005                                        0842
         LM    @00,@12,@SA00005+8                                  0842
         BR    @14                                                 0842
*END OPENPROC;                                                     0843
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - PUTPROC                                */
*        /*                                                          */
*        /*  FUNCTION - OUTPUT A RECORD TO THE PORTABILITY DATA SET  */
*        /*                                                          */
*        /*  INPUT - LENGTH AND ADDRESS OF RECORD TO BE OUTPUTTED    */
*        /*                                                          */
*        /*  OUTPUT - RECORD WILL BE WRITTEN TO PORTABILITY DATA SET */
*        /*                                                          */
*        /************************************************************/
*                                                                  0844
*                                                                  0844
*PUTPROC:  PROCEDURE(PLNINIT,          /*LENGTH OF RECORD            */
*                    PADINIT);         /*ADDRESS OF RECORD           */
*                                                                  0844
*                                                                  0844
PUTPROC  STM   @14,@12,@SA00006                                    0844
         MVC   @PC00006(8),0(@01)                                  0844
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0845
*        DCL PLNINIT FIXED(31),                                    0845
*            PADINIT PTR(31);                                      0845
*                                                                  0845
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0846
*        DCL PLN FIXED(31);            /*LENGTH OF DATA YET TO OUTPUT*/
*        DCL PAD PTR(31);              /*ADDRESS OF DATA TO OUTPUT   */
*                                                                  0847
*        /************************************************************/
*        /*                                                          */
*        /*  SET UP IOCS FOR OUTPUT OF RECORD                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0848
*        OLDERID2 = NEWERID2;                                      0848
         L     @02,@PC00001                                        0848
         L     @02,GDTTR2(,@02)                                    0848
         MVC   @TS00001(95),NEWERID2(@02)                          0848
         MVC   OLDERID2(95,@02),@TS00001                           0848
*        NEWID2 = 'RC19';                                          0849
         MVC   NEWID2(4,@02),@CC01141                              0849
*        IOCSPTR = POUTIOCS;                                       0850
         L     IOCSPTR,POUTIOCS                                    0850
*        PAD = PADINIT;                                            0851
         L     @02,@PC00006+4                                      0851
         L     PAD,PADINIT(,@02)                                   0851
*        PLN = PLNINIT;                                            0852
*                                                                  0852
         L     @02,@PC00006                                        0852
         L     PLN,PLNINIT(,@02)                                   0852
*        /************************************************************/
*        /*                                                          */
*        /*  SPLIT RECORD INTO SEGMENTS IF LARGER THAN OUTPUT        */
*        /*  LRECL LENGTH                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0853
*        DOCNTRL = ON;                                             0853
         OI    DOCNTRL,B'10000000'                                 0853
*PUTLP:  DO WHILE (DOCNTRL= ON);                                   0854
PUTLP    B     @DE00854                                            0854
@DL00854 DS    0H                                                  0855
*          IF PLN > IOCTRN                                         0855
*            THEN                                                  0855
         L     @02,IOCTRN(,IOCSPTR)                                0855
         CR    PLN,@02                                             0855
         BNH   @RF00855                                            0855
*              DO;                                                 0856
*              IOCDLN = IOCTRN;                                    0857
         ST    @02,IOCDLN(,IOCSPTR)                                0857
*              IOCDAD = PAD;                                       0858
         ST    PAD,IOCDAD(,IOCSPTR)                                0858
*              PAD = PAD + IOCTRN;                                 0859
         ALR   PAD,@02                                             0859
*              PLN = PLN - IOCTRN;                                 0860
         SLR   PLN,@02                                             0860
*              END;                                                0861
*            ELSE                                                  0862
*              DO;                                                 0862
         B     @RC00855                                            0862
@RF00855 DS    0H                                                  0863
*              IOCDLN = PLN;                                       0863
         ST    PLN,IOCDLN(,IOCSPTR)                                0863
*              IOCDAD = PAD;                                       0864
         ST    PAD,IOCDAD(,IOCSPTR)                                0864
*              DOCNTRL = OFF;                                      0865
         NI    DOCNTRL,B'01111111'                                 0865
*              END;                                                0866
*                                                                  0866
*                                                                  0866
*        /************************************************************/
*        /*                                                          */
*        /*  OUTPUT RECORD BY ISSUANCE OF THE UGET I/O ADAPTER       */
*        /*  INTERFACE.  IF AN ERROR OCCURS, THE RETURN CODE WILL    */
*        /*  BE SET TO INDICATE FAILURE. OTHERWISE, A GOOD RETURN    */
*        /*  CODE WILL BE SET AND CONTROL WILL RETURN TO THE CALLING */
*        /*  PROCESSOR.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0867
*        CALL IDCIOPT0 (GDTTBL,POUTIOCS);                          0867
*                                                                  0867
@RC00855 L     @15,@PC00001                                        0867
         ST    @15,@AL00001                                        0867
         LA    @14,POUTIOCS                                        0867
         ST    @14,@AL00001+4                                      0867
         MVI   @AL00001+4,X'80'                                    0867
         L     @15,GDTPUT(,@15)                                    0867
         LA    @01,@AL00001                                        0867
         BALR  @14,@15                                             0867
*        RESPECIFY RTNREG RSTD;                                    0868
*        TESTRC = RTNREG;                                          0869
         LR    TESTRC,RTNREG                                       0869
*        RESPECIFY RTNREG UNRSTD;                                  0870
*        IF TESTRC ^= 0                                            0871
*          THEN                                                    0871
         LTR   TESTRC,TESTRC                                       0871
         BZ    @RF00871                                            0871
*            IF IOCMSGOP = OFF                                     0872
*              THEN                                                0872
         TM    IOCMSGOP(IOCSPTR),B'00100000'                       0872
         BNZ   @RF00872                                            0872
*                RETURN CODE(LASTCC16);                            0873
*                                                                  0873
         LA    @15,16                                              0873
         L     @14,@SA00006                                        0873
         LM    @00,@12,@SA00006+8                                  0873
         BR    @14                                                 0873
*        END PUTLP;                                                0874
*                                                                  0874
@RF00872 DS    0H                                                  0874
@RF00871 DS    0H                                                  0874
@DE00854 TM    DOCNTRL,B'10000000'                                 0874
         BO    @DL00854                                            0874
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0875
*        RETURN CODE(0);                                           0875
*                                                                  0875
         SLR   @15,@15                                             0875
         L     @14,@SA00006                                        0875
         LM    @00,@12,@SA00006+8                                  0875
         BR    @14                                                 0875
*END PUTPROC;                                                      0876
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - RECPROC                                */
*        /*                                                          */
*        /*  FUNCTION - COPY THE DATA FROM THE DATA SET TO BE        */
*        /*  EXPORTED TO THE PORTABILITY DATA SET, RECORD BY         */
*        /*  RECORD.  THE VSAM CLUSTER IS OPENED BY OPENPROC,        */
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */
*        /*  UCLOSE MACRO.                                           */
*        /*                                                          */
*        /*  INPUT - NONE                                            */
*        /*                                                          */
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL CONTAIN THE      */
*        /*  RECORDS THAT COMPRISE THE EXPORTED DATA SET             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0877
*RECPROC:  PROCEDURE;                                              0877
*                                                                  0877
*                                                                  0877
RECPROC  STM   @14,@12,@SA00007                                    0877
*        OLDERID2 = NEWERID2;                                      0878
         L     @15,@PC00001                                        0878
         L     @15,GDTTR2(,@15)                                    0878
         MVC   @TS00001(95),NEWERID2(@15)                          0878
         MVC   OLDERID2(95,@15),@TS00001                           0878
*        NEWID2 = 'RC21';                                          0879
*                                                                  0879
*                                                                  0879
         MVC   NEWID2(4,@15),@CC01147                              0879
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE OUT CONTROL RECORD IDENTIFYING TYPE OF EXPORT     */
*        /*  REORGANIZE OPTION, WHERE THE LOGICAL RECORDS            */
*        /*  COMPRISING THE CLUSTER ARE COPIED TO THE PORTABILITY    */
*        /*  DATA SET      ZERO FIELDS NOT USED                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0880
*        HEADFLG2 = '00'X;                                         0880
         L     @15,CONRCPTR                                        0880
         MVI   HEADFLG2(@15),X'00'                                 0880
*        ASSRECLN = 0;                                             0881
         SLR   @14,@14                                             0881
         STH   @14,ASSRECLN(,@15)                                  0881
*        ASSRECNM = 0;                                             0882
         STH   @14,ASSRECNM(,@15)                                  0882
*        HEADLN = LENGTH(HEADER);                                  0883
         LA    @14,8                                               0883
         STH   @14,HEADLN(,@15)                                    0883
*        HEADFLG1 = HDFL1REO;                                      0884
         MVI   HEADFLG1(@15),X'01'                                 0884
*        TOTLEN = HEADLN;                                          0885
*                                                                  0885
         ST    @14,TOTLEN                                          0885
*        CALL PUTPROC(TOTLEN,CONRCPTR);                            0886
*                                                                  0886
         LA    @15,TOTLEN                                          0886
         ST    @15,@AL00001                                        0886
         LA    @15,CONRCPTR                                        0886
         ST    @15,@AL00001+4                                      0886
         LA    @01,@AL00001                                        0886
         BAL   @14,PUTPROC                                         0886
*        RESPECIFY RTNREG RSTD;                                    0887
*        TESTRC = RTNREG;                                          0888
         LR    TESTRC,RTNREG                                       0888
*        RESPECIFY RTNREG UNRSTD;                                  0889
*        IF TESTRC ^= 0                                            0890
*          THEN                                                    0890
         LTR   TESTRC,TESTRC                                       0890
         BZ    @RF00890                                            0890
*            RETURN CODE(LASTCC16);                                0891
*                                                                  0891
         LA    @15,16                                              0891
         L     @14,@SA00007                                        0891
         LM    @00,@12,@SA00007+8                                  0891
         BR    @14                                                 0891
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK OPEN RETURN CODE, IF EMPTY DATA SET BYPASS COPY,  */
*        /*  IF CALLER INDICATED EMPTY DATA SET BYPASS COPY          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0892
*        RESPECIFY (RTNREG) RSTD;                                  0892
*                                                                  0892
@RF00890 DS    0H                                                  0893
*        IF PINIOCS -> IOCVRC(4:4) ^= EMPDSRTN  &                  0893
*           EMPTYDS = OFF                                          0893
*                                                                  0893
*          THEN                                                    0893
*                                                                  0893
         L     @14,PINIOCS                                         0893
         CLC   IOCVRC+3(1,@14),EMPDSRTN                            0893
         BE    @RF00893                                            0893
         L     @14,@PC00001+4                                      0893
         L     @14,INPPTR(,@14)                                    0893
         L     @14,INPTBL+4(,@14)                                  0893
         TM    EMPTYDS(@14),B'00100000'                            0893
         BNZ   @RF00893                                            0893
*            /********************************************************/
*            /*                                                      */
*            /*  COPY DATA BY RECORD FROM THE CLUSTER TO THE         */
*            /*  PORTABILITY DATA SET.  IF ANY ERRORS ARE ENCOUNTERED*/
*            /*  RETURN TO THE CALLING PROCESSOR WITH ERROR INDICATED*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0894
*            CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);              0894
*                                                                  0894
         L     @14,@PC00001                                        0894
         ST    @14,@AL00001                                        0894
         LA    @07,PINIOCS                                         0894
         ST    @07,@AL00001+4                                      0894
         LA    @07,POUTIOCS                                        0894
         ST    @07,@AL00001+8                                      0894
         MVI   @AL00001+8,X'80'                                    0894
         L     @15,GDTCPY(,@14)                                    0894
         LA    @01,@AL00001                                        0894
         BALR  @14,@15                                             0894
*        RESPECIFY (RTNREG) UNRSTD;                                0895
*                                                                  0895
@RF00893 DS    0H                                                  0896
*        RESPECIFY RTNREG RSTD;                                    0896
*        TESTRC = RTNREG;                                          0897
         LR    TESTRC,RTNREG                                       0897
*        RESPECIFY RTNREG UNRSTD;                                  0898
*        IF TESTRC ^= 0                                            0899
*          THEN                                                    0899
         LTR   TESTRC,TESTRC                                       0899
         BZ    @RF00899                                            0899
*            RETURN CODE(LASTCC12);                                0900
*                                                                  0900
         LA    @15,12                                              0900
         L     @14,@SA00007                                        0900
         LM    @00,@12,@SA00007+8                                  0900
         BR    @14                                                 0900
*        /************************************************************/
*        /*                                                          */
*        /*  CLOSE THE INPUT DATA SET (THE VSAM CLUSTER).  IF THE    */
*        /*  CLOSE FAILS, RETURN TO THE CALLING PROCESSOR WITH ERROR */
*        /*  INDICATED.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0901
*        CALL IDCIOCL0 (GDTTBL,PINIOCS);                           0901
*                                                                  0901
@RF00899 L     @03,@PC00001                                        0901
         ST    @03,@AL00001                                        0901
         LA    @15,PINIOCS                                         0901
         ST    @15,@AL00001+4                                      0901
         MVI   @AL00001+4,X'80'                                    0901
         L     @15,GDTCLS(,@03)                                    0901
         LA    @01,@AL00001                                        0901
         BALR  @14,@15                                             0901
*        RESPECIFY RTNREG RSTD;                                    0902
*        TESTRC = RTNREG;                                          0903
         LR    TESTRC,RTNREG                                       0903
*        RESPECIFY RTNREG UNRSTD;                                  0904
*        PINIOCS = NULLPTR;                                        0905
         SLR   @03,@03                                             0905
         ST    @03,PINIOCS                                         0905
*        IF TESTRC ^= 0                                            0906
*          THEN                                                    0906
         CR    TESTRC,@03                                          0906
         BE    @RF00906                                            0906
*            RETURN CODE(LASTCC08);                                0907
*                                                                  0907
         LA    @15,8                                               0907
         L     @14,@SA00007                                        0907
         LM    @00,@12,@SA00007+8                                  0907
         BR    @14                                                 0907
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */
*        /*  COMPLETION INDICATED                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0908
*        RETURN CODE(0);                                           0908
@RF00906 SLR   @15,@15                                             0908
         L     @14,@SA00007                                        0908
         LM    @00,@12,@SA00007+8                                  0908
         BR    @14                                                 0908
*END RECPROC;                                                      0909
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - MVDAPROC                               */
*        /*                                                          */
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE         */
*        /*  TO ANOTHER AS SPECIFIED BY INPUT ARGUMENTS,             */
*        /*  OR ZEROS OUT AN AREA OF CORE IF SPECIFIED BY            */
*        /*  ITS ARGUMENTS.                                          */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED                   */
*        /*    .MF1PTR- FROM LOCATION                                */
*        /*    .MT1PTR- TO LOCATION                                  */
*        /*    .ZEROOUT - FLAG TO INDICATE WHETHER MDVAPROC          */
*        /*        IS TO ZERO OUT CORE                               */
*        /*                                                          */
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */
*        /*  THE "TO" AGRUMENT (MPTR) IF IT IS SPECIFIED.            */
*        /*  IF ZEROOUT IS SET TO A NONZERO VALUE, THEN              */
*        /*  THE AREA OF CORE STARTING AT MF1PTR AND                 */
*        /*  EXTENDING A LENGTH OF MSIZE IS ZEROED OUT.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0910
*MVDAPROC: PROCEDURE(MSIZE,            /*SIZE OF DATA TO BE MOVED    */
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */
*                    MT1PTR,           /*LOCATION TO MOVE DATA INTO  */
*                    ZEROOUT);         /*FLAG INDICATING THAT        */
MVDAPROC STM   @14,@12,12(@13)                                     0910
         MVC   @PC00008(16),0(@01)                                 0910
*                                      /*THIS IS A REQUEST           */
*                                      /*ZERO OUT CORE               */
*                                                                  0911
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0911
*        DCL MSIZE    FIXED(15),                                   0911
*            MF1PTR   PTR(31),                                     0911
*            MT1PTR   PTR(31),                                     0911
*            ZEROOUT CHAR(4);                                      0911
*                                                                  0911
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0912
*        DCL MFPTR PTR(31);                                        0912
*        DCL MTPTR PTR(31);                                        0913
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                        0914
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                        0915
*        DCL M1SIZE FIXED(15);                                     0916
*        DCL CNTRL  BIT(1);                                        0917
*        DCL ZERO CHAR(256) INIT('00'X);                           0918
*                                      /*ZEROS USED TO ZERO          */
*                                      /*OUT AN AREA                 */
*                                                                  0919
*        /************************************************************/
*        /*                                                          */
*        /*  TEST TO SEE IF SETZERO HAS BEEN SPECIFIED AS            */
*        /*  LAST ARGUMENT.  IF SO, ZERO OUT THE TARGET              */
*        /*  AREA.                                                   */
*        /*                                                          */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0919
         L     @15,@PC00001                                        0919
         L     @15,GDTTR2(,@15)                                    0919
         MVC   @TS00001(95),NEWERID2(@15)                          0919
         MVC   OLDERID2(95,@15),@TS00001                           0919
*        NEWID2 = 'RC23';                                          0920
*                                                                  0920
         MVC   NEWID2(4,@15),@CC01166                              0920
*        IF ZEROOUT = SETZERO                                      0921
*          THEN                                                    0921
         L     @15,@PC00008+12                                     0921
         CLC   ZEROOUT(4,@15),SETZERO                              0921
         BNE   @RF00921                                            0921
*            DO;                                                   0922
*                                                                  0922
*            /********************************************************/
*            /*                                                      */
*            /*  SET MTPTR TO MT1PTR AND M1SIZE TO MSIZE.            */
*            /*  SET CNTRL TO ON AND LOOP.                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0923
*            MTPTR = MT1PTR;                                       0923
         L     @15,@PC00008+8                                      0923
         L     MTPTR,MT1PTR(,@15)                                  0923
*            M1SIZE = MSIZE;                                       0924
         L     @15,@PC00008                                        0924
         LH    M1SIZE,MSIZE(,@15)                                  0924
*            CNTRL = ON;                                           0925
         OI    CNTRL,B'10000000'                                   0925
*            DO WHILE (CNTRL = ON);                                0926
*                                                                  0926
         B     @DE00926                                            0926
@DL00926 DS    0H                                                  0927
*              /******************************************************/
*              /*                                                    */
*              /*  TEST M1SIZE AGAINST 256.  IF M1SIZE > 256         */
*              /*  THEN MOVE 256 BYTES OF ZEROS, AND LOOP            */
*              /*  AGAIN.  OTHERWISE, ZERO THE REMAINING             */
*              /*  AND SET CNTRL TO OFF.                             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0927
*              IF M1SIZE > 256                                     0927
*                THEN                                              0927
         LA    @15,256                                             0927
         CR    M1SIZE,@15                                          0927
         BNH   @RF00927                                            0927
*                  DO;                                             0928
*                  TOAREA(1:256) = ZERO(1:256);                    0929
         MVC   TOAREA(256,MTPTR),ZERO                              0929
*                  M1SIZE = M1SIZE - 256;                          0930
         SLR   M1SIZE,@15                                          0930
*                  MTPTR = MTPTR + 256;                            0931
         ALR   MTPTR,@15                                           0931
*                  END;                                            0932
*                ELSE                                              0933
*                  DO;                                             0933
         B     @RC00927                                            0933
@RF00927 DS    0H                                                  0934
*                  TOAREA(1:M1SIZE) = ZERO(1:M1SIZE);              0934
         LR    @15,M1SIZE                                          0934
         BCTR  @15,0                                               0934
         EX    @15,@SM01316                                        0934
*                  CNTRL = OFF;                                    0935
         NI    CNTRL,B'01111111'                                   0935
*                  END;                                            0936
*            END;                                                  0937
@RC00927 DS    0H                                                  0937
@DE00926 TM    CNTRL,B'10000000'                                   0937
         BO    @DL00926                                            0937
*            END;                                                  0938
*          ELSE                                                    0939
*                                                                  0939
*            /********************************************************/
*            /*                                                      */
*            /*  LOOP MOVING 256 BYTES AT A TIME                     */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0939
         B     @RC00921                                            0939
@RF00921 DS    0H                                                  0940
*            MFPTR = MF1PTR;                                       0940
         L     @15,@PC00008+4                                      0940
         L     MFPTR,MF1PTR(,@15)                                  0940
*            MTPTR = MT1PTR;                                       0941
         L     @05,@PC00008+8                                      0941
         L     MTPTR,MT1PTR(,@05)                                  0941
*            M1SIZE = MSIZE;                                       0942
         L     @05,@PC00008                                        0942
         LH    M1SIZE,MSIZE(,@05)                                  0942
*            DOCNTRL = ON;                                         0943
         OI    DOCNTRL,B'10000000'                                 0943
*            DO WHILE (DOCNTRL = ON);                              0944
*                                                                  0944
         B     @DE00944                                            0944
@DL00944 DS    0H                                                  0945
*              /******************************************************/
*              /*                                                    */
*              /*  CHECK FOR MORE THAN 256 BYTES TO MOVE             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0945
*              IF M1SIZE > 256                                     0945
*                THEN                                              0945
         LA    @05,256                                             0945
         CR    M1SIZE,@05                                          0945
         BNH   @RF00945                                            0945
*                  DO;                                             0946
*                  /**************************************************/
*                  /*                                                */
*                  /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND  */
*                  /*  POINTER VARIABLES FOR NEXT ITERATION          */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0947
*                  TOAREA(1:256) = FROMAREA(1:256);                0947
         MVC   TOAREA(256,MTPTR),FROMAREA(MFPTR)                   0947
*                  M1SIZE = M1SIZE - 256;                          0948
         SLR   M1SIZE,@05                                          0948
*                  MTPTR = MTPTR +256;                             0949
         ALR   MTPTR,@05                                           0949
*                  MFPTR = MFPTR + 256;                            0950
         ALR   MFPTR,@05                                           0950
*                  END;                                            0951
*                                                                  0951
*                ELSE                                              0952
*                  DO;                                             0952
         B     @RC00945                                            0952
@RF00945 DS    0H                                                  0953
*                  /**************************************************/
*                  /*                                                */
*                  /*  MOVE NUMBER OF BYTES INDICATED                */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0953
*                  TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);          0953
         LR    @05,M1SIZE                                          0953
         BCTR  @05,0                                               0953
         EX    @05,@SM01318                                        0953
*                  DOCNTRL = OFF;                                  0954
         NI    DOCNTRL,B'01111111'                                 0954
*                  END;                                            0955
*              END;                                                0956
@RC00945 DS    0H                                                  0956
@DE00944 TM    DOCNTRL,B'10000000'                                 0956
         BO    @DL00944                                            0956
*            END;                                                  0957
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0958
*        RETURN CODE(0);                                           0958
@RC00921 SLR   @15,@15                                             0958
         L     @14,12(,@13)                                        0958
         LM    @00,@12,20(@13)                                     0958
         BR    @14                                                 0958
*END MVDAPROC;                                                     0959
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - CONTRBL                                */
*        /*                                                          */
*        /*  FUNCTION - BUILD A DICTIONARY CONTROL RECORD            */
*        /*  AND WRITE IT AND THE APPROPRIATE CATALOG                */
*        /*  WORK AREA OUT THE PORTABILITY DATA SET.                 */
*        /*                                                          */
*        /*  INPUT - POINTER TO THE CPL USED TO LOCATE THE           */
*        /*  INFORMATION TO BE WRITTEN OUT AND A FLAG                */
*        /*  INDICATING WHETHER OR NOT THE OBJECT IS A PATH          */
*        /*                                                          */
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL HAVE             */
*        /*  A CATALOG DICTIONARY AND A CATALOG WORK AREA            */
*        /*  ADDED TO ITS HEADING.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0960
*CONTRBL: PROCEDURE(INDCTGPL,TYPE);                                0960
*                                                                  0960
CONTRBL  STM   @14,@12,@SA00009                                    0960
         MVC   @PC00009(8),0(@01)                                  0960
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0961
*        DCL INDCTGPL FIXED(31); /*INDEX TO A CPL                    */
*        DCL TYPE CHAR(1);    /*TYPE OF CONTROL RECORD               */
*                                                                  0962
*        DCL ICONTRBL FIXED(31);   /*INDEX FOR CLEARING              */
*                                  /*DICTIONARY AREAS                */
*                                                                  0964
*        DCL INDEXLIM FIXED(15);   /*LOOP CONTROL FOR DICTBLD@OZ12893*/
*                                                                  0964
*        OLDERID2 = NEWERID2;                                      0965
         L     @15,@PC00001                                        0965
         L     @15,GDTTR2(,@15)                                    0965
         MVC   @TS00001(95),NEWERID2(@15)                          0965
         MVC   OLDERID2(95,@15),@TS00001                           0965
*        NEWID2 = 'RC25';                                          0966
*                                                                  0966
         MVC   NEWID2(4,@15),@CC01176                              0966
*        /************************************************************/
*        /*                                                          */
*        /*  CLEAR THE CONTROL RECORD BUFFER AND INITIALIZE          */
*        /*  POINTERS.                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0967
*        CALL MVDAPROC(LENGTH(CONREC),NULLPARM,CONRCPTR,           0967
*           SETZERO);                                              0967
*                                                                  0967
         MVC   @AL00001(16),@AL00967                               0967
         LA    @15,CONRCPTR                                        0967
         ST    @15,@AL00001+8                                      0967
         LA    @01,@AL00001                                        0967
         BAL   @14,MVDAPROC                                        0967
*        CTGPLPTR = PTRCPL(INDCTGPL);                              0968
*                                                                  0968
         L     @03,@PC00009                                        0968
         L     @03,INDCTGPL(,@03)                                  0968
         SLA   @03,2                                               0968
         L     @03,PTRCPL-4(@03)                                   0968
         ST    @03,CTGPLPTR                                        0968
*        /************************************************************/
*        /*                                                          */
*        /*  SET HEADER FLAGS IN CONTROL RECORD TO INDICATE          */
*        /*  A CATALOG RECORD AND ENTYPE                             */
*        /*  ALSO SET LENGTH OF ASSOCIATED CATALOG RECORD            */
*        /*  IF NO INFORMATION AVAILABLE ON THE ENTYPE - TERMINATE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0969
*        HEADLN = LENGTH(CONREC);                                  0969
         L     @15,CONRCPTR                                        0969
         MVC   HEADLN(2,@15),@CH01285                              0969
*        HEADFLG1 = HDFL1CAT;                                      0970
         MVI   HEADFLG1(@15),X'FF'                                 0970
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0971
         L     CTGFLPTR,CTGFIELD(,@03)                             0971
*        IF CTGFLPT(1) = NULLPTR                                   0972
*          THEN                                                    0972
         L     @03,CTGFLPT(,CTGFLPTR)                              0972
         LTR   @03,@03                                             0972
         BNZ   @RF00972                                            0972
*            DO;                                                   0973
*            DARGSMOD = CEXPMSG;                                   0974
         L     @15,DDSTRU                                          0974
         MVC   DARGSMOD(3,@15),@CC00836                            0974
*            DARGSENT = NOCTFLD;                                   0975
         MVI   DARGSENT(@15),X'04'                                 0975
*            RETURN CODE(LASTCC08);                                0976
         LA    @15,8                                               0976
         L     @14,@SA00009                                        0976
         LM    @00,@12,@SA00009+8                                  0976
         BR    @14                                                 0976
*            END;                                                  0977
*                                                                  0977
*        HEADFLG2 = FENTYPE;                                       0978
*                                                                  0978
@RF00972 L     @15,CONRCPTR                                        0978
         L     @01,CTGFLPT(,CTGFLPTR)                              0978
         MVC   HEADFLG2(1,@15),FENTYPE(@01)                        0978
*        ASSRECLN = RETURNLN + LENGTH(PATHREL);                    0979
         L     @01,CTGPLPTR                                        0979
         L     @01,CTGWKA(,@01)                                    0979
         LA    @14,52                                              0979
         AH    @14,RETURNLN(,@01)                                  0979
         STH   @14,ASSRECLN(,@15)                                  0979
*        ASSRECNM = ASSRECLN / RECSZ;                              0980
         L     @07,RECSZ                                           0980
         LR    @00,@14                                             0980
         SRDA  @00,32                                              0980
         DR    @00,@07                                             0980
         STH   @01,ASSRECNM(,@15)                                  0980
*        ASSREMD = ASSRECLN // RECSZ;                              0981
         SRDA  @14,32                                              0981
         DR    @14,@07                                             0981
         LR    ASSREMD,@14                                         0981
*        IF ASSREMD > 0                                            0982
*          THEN                                                    0982
         LTR   ASSREMD,ASSREMD                                     0982
         BNP   @RF00982                                            0982
*            ASSRECNM = ASSRECNM + 1;                              0983
*                                                                  0983
         L     @03,CONRCPTR                                        0983
         AL    @01,@CF00218                                        0983
         STH   @01,ASSRECNM(,@03)                                  0983
*        /************************************************************/
*        /*                                                          */
*        /*  SET THE NUMBER OF DICTIONARY ENTRIES IN THE CONTROL     */
*        /*  RECORD                                                  */
*        /*  RGATTR WILL BE THE LAST ENTRY PROCESSED BY THE  @Z40RSSA*/
*        /*  DICTBLD PROCEDURE.                              @Z40RSSA*/
*        /*                                                  @Z40RSSA*/
*        /************************************************************/
*                                                                  0984
*        IF FENTYPE = CTGTALIN × FENTYPE = CTGTUCAT                0984
*          THEN                                                    0984
@RF00982 L     @03,CTGFLPT(,CTGFLPTR)                              0984
         CLI   FENTYPE(@03),C'A'                                   0984
         BE    @RT00984                                            0984
         CLI   FENTYPE(@03),C'U'                                   0984
         BNE   @RF00984                                            0984
@RT00984 DS    0H                                                  0985
*            DICTNM = (DIM(NVSMFLST) - 2) + 11 ;                   0985
         L     @01,CONRCPTR                                        0985
         MVC   DICTNM+8(4,@01),@CF01291                            0985
*          ELSE                                                    0986
*            DO;                                                   0986
         B     @RC00984                                            0986
@RF00984 DS    0H                                                  0987
*            IF FENTYPE =  'B'                                     0987
*              THEN                                                0987
         L     @03,CTGFLPT(,CTGFLPTR)                              0987
         CLI   FENTYPE(@03),C'B'                                   0987
         BNE   @RF00987                                            0987
*                DICTNM = (DIM(GDGFLIST) - 2) + 11;                0988
         L     @01,CONRCPTR                                        0988
         MVC   DICTNM+8(4,@01),@CF00891                            0988
*              ELSE                                                0989
*                DO;                                               0989
         B     @RC00987                                            0989
@RF00987 DS    0H                                                  0990
*                IF FENTYPE = 'X'                                  0990
*                  THEN                                            0990
         L     @03,CTGFLPT(,CTGFLPTR)                              0990
         CLI   FENTYPE(@03),C'X'                                   0990
         BNE   @RF00990                                            0990
*                    DICTNM = (DIM(ALSFLIST) - 1) + 11;            0991
         L     @01,CONRCPTR                                        0991
         MVC   DICTNM+8(4,@01),@CF01292                            0991
*                  ELSE                                            0992
*                    DICTNM = (DIM(FIELDLST) - 2) + 11;            0992
         B     @RC00990                                            0992
@RF00990 L     @01,CONRCPTR                                        0992
         MVC   DICTNM+8(4,@01),@CF00220                            0992
*                END;                                              0993
@RC00990 DS    0H                                                  0994
*            END;                                                  0994
*                                                                  0994
@RC00987 DS    0H                                                  0995
*        /************************************************************/
*        /*                                                          */
*        /*  INTERROGATE FPL FIELDS SETTING UP THE                   */
*        /*  DICTIONARY FOR EACH COMPONENT.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0995
*        DINDX = 1;                                                0995
@RC00984 LA    DINDX,1                                             0995
*         IF IRGATTR>ONUM                                  /*@OZ12893*/
*            THEN INDEXLIM=ONUM;                           /*@OZ12893*/
         CLI   ONUM,20                                             0996
         BNL   @RF00996                                            0996
         SLR   @02,@02                                             0997
         IC    @02,ONUM                                            0997
         STH   @02,INDEXLIM                                        0997
*            ELSE INDEXLIM=IRGATTR;                        /*@OZ12893*/
         B     @RC00996                                            0998
@RF00996 MVC   INDEXLIM(2),@CH00895                                0998
*DICTBLD: DO INDX = 1 TO INDEXLIM;                         /*@OZ12893*/
@RC00996 DS    0H                                                  0999
DICTBLD  LA    INDX,1                                              0999
         B     @DE00999                                            0999
@DL00999 DS    0H                                                  1000
*          CTGFLPTR = CTGFIELD(INDX);                              1000
         LR    @15,INDX                                            1000
         SLA   @15,2                                               1000
         L     @01,CTGPLPTR                                        1000
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        1000
*          LGNFLD  = CTGFLNG(1);                                   1001
*                                                                  1001
*                                                                  1001
         L     LGNFLD,CTGFLNG(,CTGFLPTR)                           1001
*          /**********************************************************/
*          /*                                                        */
*          /*  TEST FOR NON EXISTANT OR NON-INITIALIZED FIELDS       */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1002
*                                                                  1002
*                                                                  1002
*                                                                  1002
*          /**********************************************************/
*          /*                                                        */
*          /*  IF A VARIABLE LENGTH CATALOG FIELD SUCH AS LOKEYV     */
*          /*  IS BEING INTERROGATED, THE FIRST TWO BYTES OF THE     */
*          /*  THE FIELD IS A LENGTH                                 */
*          /*  VARIABLE LENGTH CATALOG FIELDS ARE USERAREC,          */
*          /*  LOKEYV, AND HIKEYV                                    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1002
*          IF (INDX = IUSRAREC ×                                   1002
*              INDX = ILOKEYV ×                                    1002
*              INDX = IHIKEYV)                                     1002
*            THEN                                                  1002
         C     INDX,@CF00887                                       1002
         BE    @RT01002                                            1002
         C     INDX,@CF00227                                       1002
         BE    @RT01002                                            1002
         C     INDX,@CF00481                                       1002
         BNE   @RF01002                                            1002
@RT01002 DS    0H                                                  1003
*              IF LGNFLD = 0 × FIELDLN = 0                         1003
*                THEN                                              1003
         SLR   @15,@15                                             1003
         CR    LGNFLD,@15                                          1003
         BE    @RT01003                                            1003
         L     @01,CTGFLPT(,CTGFLPTR)                              1003
         CH    @15,FIELDLN(,@01)                                   1003
         BNE   @RF01003                                            1003
@RT01003 DS    0H                                                  1004
*                  DO;                                             1004
*                                                                  1004
*                  /**************************************************/
*                  /*                                                */
*                  /*  IF A VARIABLE LENGTH FIELD IS NOT             */
*                  /*  INITIALIZED OR NON-EXISTANT, THE LENGTH       */
*                  /*  FIELD WITHIN THE DATA RETURNED BY LOCATE      */
*                  /*  IS ZERO.  SET THE DICTIONARY LENGTH AND       */
*                  /*  DISPLACEMENT TO ZERO.                         */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1005
*                  DICTLN(DINDX) = 0;                              1005
         SLR   @05,@05                                             1005
         LR    @02,DINDX                                           1005
         SLA   @02,3                                               1005
         LA    @15,8                                               1005
         AL    @15,CONRCPTR                                        1005
         LA    @01,0(@02,@15)                                      1005
         AL    @01,@CF01320                                        1005
         ST    @05,DICTLN-4(,@01)                                  1005
*                  DICTDL(DINDX) = NULLPTR;                        1006
         ST    @05,DICTDL-8(@02,@15)                               1006
*                  END;                                            1007
*                                                                  1007
*                ELSE                                              1008
*                  DO;                                             1008
         B     @RC01003                                            1008
@RF01003 DS    0H                                                  1009
*                  DICTLN(DINDX) = CTGFLNG(1);                     1009
         LR    @05,DINDX                                           1009
         SLA   @05,3                                               1009
         LA    @15,8                                               1009
         AL    @15,CONRCPTR                                        1009
         L     @14,CTGFLNG(,CTGFLPTR)                              1009
         LA    @01,0(@05,@15)                                      1009
         AL    @01,@CF01320                                        1009
         ST    @14,DICTLN-4(,@01)                                  1009
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;            1010
         L     @14,CTGFLPT(,CTGFLPTR)                              1010
         L     @01,CTGPLPTR                                        1010
         SL    @14,CTGWKA(,@01)                                    1010
         ST    @14,DICTDL-8(@05,@15)                               1010
*                  END;                                            1011
*                                                                  1011
*            /********************************************************/
*            /*                                                      */
*            /*  FIELDS EXAMINED HERE ARE FIXED LENGTH FIELDS.       */
*            /*  IF THE FIELDS IS NON-EXISTANT OR NOT INITIALIZED    */
*            /*  THE ENTIRE FIELD WILL HAVE BEEN SET TO BINARY FF'S  */
*            /*  BY LOCATE.  SET DICTIONARY LENGTH AND DISPLACEMENT  */
*            /*  TO ZERO FOR SUCH FIELDS                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1012
*            ELSE                                                  1012
*              DO;                                                 1012
         B     @RC01002                                            1012
@RF01002 DS    0H                                                  1013
*              IF (CTGFLNG(1) = 0 ×                                1013
*                  CTGFLPT(1) = NULLPTR ×                          1013
*                  FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))            1013
*                THEN                                              1013
         SLR   @15,@15                                             1013
         C     @15,CTGFLNG(,CTGFLPTR)                              1013
         BE    @RT01013                                            1013
         L     @14,CTGFLPT(,CTGFLPTR)                              1013
         CR    @14,@15                                             1013
         BE    @RT01013                                            1013
         LR    @15,LGNFLD                                          1013
         BCTR  @15,0                                               1013
         EX    @15,@SC01321                                        1013
         BNE   @RF01013                                            1013
@RT01013 DS    0H                                                  1014
*                  DO;                                             1014
*                  DICTLN(DINDX) = 0;                              1015
         SLR   @05,@05                                             1015
         LR    @02,DINDX                                           1015
         SLA   @02,3                                               1015
         LA    @15,8                                               1015
         AL    @15,CONRCPTR                                        1015
         LA    @01,0(@02,@15)                                      1015
         AL    @01,@CF01320                                        1015
         ST    @05,DICTLN-4(,@01)                                  1015
*                  DICTDL(DINDX) = NULLPTR;                        1016
         ST    @05,DICTDL-8(@02,@15)                               1016
*                  END;                                            1017
*                ELSE                                              1018
*                  DO;                                             1018
         B     @RC01013                                            1018
@RF01013 DS    0H                                                  1019
*                  DICTLN(DINDX) = CTGFLNG(1);                     1019
         LR    @05,DINDX                                           1019
         SLA   @05,3                                               1019
         LA    @15,8                                               1019
         AL    @15,CONRCPTR                                        1019
         L     @14,CTGFLNG(,CTGFLPTR)                              1019
         LA    @01,0(@05,@15)                                      1019
         AL    @01,@CF01320                                        1019
         ST    @14,DICTLN-4(,@01)                                  1019
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;            1020
         L     @14,CTGFLPT(,CTGFLPTR)                              1020
         L     @01,CTGPLPTR                                        1020
         SL    @14,CTGWKA(,@01)                                    1020
         ST    @14,DICTDL-8(@05,@15)                               1020
*                  END;                                            1021
*                                                                  1021
*              /******************************************************/
*              /*                                                    */
*              /*  SPECIAL HANDLING IS REQUIRED FOR AMDSBCAT FIELD   */
*              /*  FIELDS NORMALLY DEFINED (VIA CATALOG DEFINE) ARE  */
*              /*  EXTRACTED AND A DICTIONARY ENTRY IS BUILT FOR     */
*              /*  EACH FIELD.                                       */
*              /*  IF NO INFORMATION IS RETURNED OR THE FIELDS ARE   */
*              /*  INITIALIZED(SET TO ALL X'FF') THEN THE            */
*              /*  DICTIONARY ENTRIES ARE SET TO ZERO                */
*              /*                                                    */
*              /******************************************************/
*                                                                  1022
*              IF INDX = IAMDSB                                    1022
*                THEN                                              1022
@RC01013 C     INDX,@CF00891                                       1022
         BNE   @RF01022                                            1022
*                  DO;                                             1023
*                  CTGFLPTR = CTGFIELD(INDX);                      1024
         L     @07,CTGPLPTR                                        1024
         LR    @15,INDX                                            1024
         SLA   @15,2                                               1024
         L     CTGFLPTR,CTGFIELD-4(@15,@07)                        1024
*                  DSCCATPT = CTGFLPT(1);                          1025
         L     @15,CTGFLPT(,CTGFLPTR)                              1025
         LR    DSCCATPT,@15                                        1025
*                  RESPECIFY IDAAMDSB BASED(DSCCATPT);             1026
*                                                                  1026
*                  LGNFLD = CTGFLNG(1);                            1027
         L     @14,CTGFLNG(,CTGFLPTR)                              1027
         LR    LGNFLD,@14                                          1027
*                  IF (CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR  &  1028
*                      FIELD(1:LGNFLD) ^= NOTINIT(1:LGNFLD))       1028
*                    THEN                                          1028
         SLR   @01,@01                                             1028
         CR    @14,@01                                             1028
         BE    @RF01028                                            1028
         CR    @15,@01                                             1028
         BE    @RF01028                                            1028
         LR    @14,LGNFLD                                          1028
         BCTR  @14,0                                               1028
         EX    @14,@SC01323                                        1028
         BE    @RF01028                                            1028
*                      DO;                                         1029
*                      DICTLN(DINDX+1) = LENGTH(AMDATTR);          1030
         LA    @05,1                                               1030
         LR    @02,DINDX                                           1030
         SLA   @02,3                                               1030
         LA    @15,8                                               1030
         L     @14,CONRCPTR                                        1030
         ALR   @14,@15                                             1030
         ST    @05,DICTLN(@02,@14)                                 1030
*                      DICTDL(DINDX+1) = ADDR(AMDATTR) - CTGWKA;   1031
         LA    @01,AMDATTR(,DSCCATPT)                              1031
         L     @07,CTGWKA(,@07)                                    1031
         SLR   @01,@07                                             1031
         ST    @01,DICTDL(@02,@14)                                 1031
*                      DICTLN(DINDX+2) = LENGTH(AMDRKP);           1032
         LA    @01,2                                               1032
         ST    @01,DICTLN+8(@02,@14)                               1032
*                      DICTDL(DINDX+2) = ADDR(AMDRKP) - CTGWKA;    1033
         LA    @00,AMDRKP(,DSCCATPT)                               1033
         SLR   @00,@07                                             1033
         ST    @00,DICTDL+8(@02,@14)                               1033
*                      DICTLN(DINDX+3) = LENGTH(AMDKEYLN);         1034
         ST    @01,DICTLN+16(@02,@14)                              1034
*                      DICTDL(DINDX+3) = ADDR(AMDKEYLN)-CTGWKA;    1035
         LA    @00,AMDKEYLN(,DSCCATPT)                             1035
         SLR   @00,@07                                             1035
         ST    @00,DICTDL+16(@02,@14)                              1035
*                      DICTLN(DINDX+4) = LENGTH(AMDCINV);          1036
         LA    @00,4                                               1036
         ST    @00,DICTLN+24(@02,@14)                              1036
*                      DICTDL(DINDX+4) = ADDR(AMDCINV) - CTGWKA;   1037
         LA    @07,AMDCINV(,DSCCATPT)                              1037
         L     @05,CTGPLPTR                                        1037
         L     @05,CTGWKA(,@05)                                    1037
         SLR   @07,@05                                             1037
         ST    @07,DICTDL+24(@02,@14)                              1037
*                      DICTLN(DINDX+5) = LENGTH(AMDLRECL);         1038
         ST    @00,DICTLN+32(@02,@14)                              1038
*                      DICTDL(DINDX+5) = ADDR(AMDLRECL) - CTGWKA;  1039
         LA    @07,AMDLRECL(,DSCCATPT)                             1039
         SLR   @07,@05                                             1039
         ST    @07,DICTDL+32(@02,@14)                              1039
*                      DICTLN(DINDX+6) = LENGTH(AMDPCTCA);         1040
         LA    @07,1                                               1040
         ST    @07,DICTLN+40(@02,@14)                              1040
*                      DICTDL(DINDX+6) = ADDR(AMDPCTCA) - CTGWKA;  1041
         LA    @00,AMDPCTCA(,DSCCATPT)                             1041
         SLR   @00,@05                                             1041
         ST    @00,DICTDL+40(@02,@14)                              1041
*                      DICTLN(DINDX+7) = LENGTH(AMDPCTCI);         1042
         ST    @07,DICTLN+48(@02,@14)                              1042
*                      DICTDL(DINDX+7) = ADDR(AMDPCTCI) - CTGWKA;  1043
         LA    @07,AMDPCTCI(,DSCCATPT)                             1043
         SLR   @07,@05                                             1043
         ST    @07,DICTDL+48(@02,@14)                              1043
*                      DICTLN(DINDX+8) = LENGTH(AMDATTR3);         1044
         ST    @15,DICTLN+56(@02,@14)                              1044
*                      DICTDL(DINDX+8) = ADDR(AMDATTR3)-CTGWKA;    1045
         LA    @07,AMDATTR3(,DSCCATPT)                             1045
         SLR   @07,@05                                             1045
         ST    @07,DICTDL+56(@02,@14)                              1045
*                      DICTLN(DINDX+9) = LENGTH(AMDAXRKP);         1046
         ST    @01,DICTLN+64(@02,@14)                              1046
*                      DICTDL(DINDX+9) = ADDR(AMDAXRKP)-CTGWKA;    1047
         LA    @07,AMDAXRKP(,DSCCATPT)                             1047
         SLR   @07,@05                                             1047
         ST    @07,DICTDL+64(@02,@14)                              1047
*                      END;                                        1048
*                    ELSE                                          1049
*                      DO ICONTRBL = 1 TO 9;                       1049
         B     @RC01028                                            1049
@RF01028 LA    ICONTRBL,1                                          1049
@DL01049 DS    0H                                                  1050
*                        DICTLN(DINDX+ICONTRBL) = 0;               1050
         SLR   @05,@05                                             1050
         LR    @15,DINDX                                           1050
         ALR   @15,ICONTRBL                                        1050
         SLA   @15,3                                               1050
         LA    @14,8                                               1050
         AL    @14,CONRCPTR                                        1050
         LA    @01,0(@15,@14)                                      1050
         AL    @01,@CF01320                                        1050
         ST    @05,DICTLN-4(,@01)                                  1050
*                        DICTDL(DINDX+ICONTRBL) = NULLPTR;         1051
         ST    @05,DICTDL-8(@15,@14)                               1051
*                      END;                                        1052
*                                                                  1052
         AL    ICONTRBL,@CF00218                                   1052
         C     ICONTRBL,@CF00037                                   1052
         BNH   @DL01049                                            1052
*                  DINDX = DINDX + 9;                              1053
*                                                                  1053
@RC01028 AL    DINDX,@CF00037                                      1053
*                  END;                                            1054
*                                                                  1054
*               END;                                               1055
*                                                                  1055
*                                                                  1055
@RF01022 DS    0H                                                  1056
*        /************************************************************/
*        /*                                                          */
*        /*  INCREMENT INDEX INTO DICTIONARY                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1056
*          DINDX = DINDX + 1;                                      1056
@RC01002 AL    DINDX,@CF00218                                      1056
*        END DICTBLD;                                              1057
*                                                                  1057
*                                                                  1057
         AL    INDX,@CF00218                                       1057
@DE00999 CH    INDX,INDEXLIM                                       1057
         BNH   @DL00999                                            1057
*        /************************************************************/
*        /*                                                          */
*        /*  IF EXPORTING AN AIX, WRITE OUT THE RELATED              */
*        /*  NAME.                                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1058
*        IF TYPE = CTGTAIX                                         1058
*                                                                  1058
*          THEN                                                    1058
         L     @02,@PC00009+4                                      1058
         CLI   TYPE(@02),C'G'                                      1058
         BNE   @RF01058                                            1058
*            DO;                                                   1059
*            DICTLN(DINDX) = RELLEN;                               1060
         LR    @02,DINDX                                           1060
         SLA   @02,3                                               1060
         LA    @15,8                                               1060
         AL    @15,CONRCPTR                                        1060
         LA    @14,44                                              1060
         LA    @01,0(@02,@15)                                      1060
         AL    @01,@CF01320                                        1060
         ST    @14,DICTLN-4(,@01)                                  1060
*            DICTDL(DINDX) = ADDR(RELATE) - CTGWKA;                1061
         L     @01,CTGPLPTR                                        1061
         L     @14,CTGWKA(,@01)                                    1061
         LH    @07,RETURNLN(,@14)                                  1061
         ALR   @07,@14                                             1061
         LCR   @14,@14                                             1061
         ALR   @14,@07                                             1061
         ST    @14,DICTDL-8(@02,@15)                               1061
*            RELATE = RELNAME;                                     1062
         MVC   RELATE(44,@07),RELNAME                              1062
*            DICTLN(DINDX+1) = 0;                                  1063
         SLR   @14,@14                                             1063
         ST    @14,DICTLN(@02,@15)                                 1063
*            DICTDL(DINDX+1) = NULLPTR;                            1064
         ST    @14,DICTDL(@02,@15)                                 1064
*            END;                                                  1065
*                                                                  1065
*                                                                  1065
*                                                                  1065
*                                                                  1065
*          ELSE                                                    1066
*                                                                  1066
*          /**********************************************************/
*          /*                                                        */
*          /*  IF WRITING OUT A PATH RECORD, WRITE OUT THE           */
*          /*  NAME AND PASSWORD OF THE DATA SET BEING               */
*          /*  EXPORTED AS THE PATHENTRY AND PATHPASS                */
*          /*  ENTRIES IN THE DICTIONARY.                            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1066
*            IF TYPE = CTGTPTH                                     1066
*              THEN                                                1066
         B     @RC01058                                            1066
@RF01058 L     @02,@PC00009+4                                      1066
         CLI   TYPE(@02),C'R'                                      1066
         BNE   @RF01066                                            1066
*                DO;                                               1067
*                DICTLN(DINDX) = LENGTH(PATHENT);                  1068
         LR    @02,DINDX                                           1068
         SLA   @02,3                                               1068
         LA    @15,8                                               1068
         L     @14,CONRCPTR                                        1068
         ALR   @14,@15                                             1068
         LA    @07,44                                              1068
         LA    @06,0(@02,@14)                                      1068
         AL    @06,@CF01320                                        1068
         ST    @07,DICTLN-4(,@06)                                  1068
*                DICTDL(DINDX) = ADDR(PATHENT) - CTGWKA;           1069
         L     @01,CTGPLPTR                                        1069
         L     @07,CTGWKA(,@01)                                    1069
         LH    @06,RETURNLN(,@07)                                  1069
         ALR   @06,@07                                             1069
         LR    @05,@06                                             1069
         SLR   @05,@07                                             1069
         ST    @05,DICTDL-8(@02,@14)                               1069
*                PATHENT = PTRCPL(1) ->                            1070
*                   CTGFIELD(IENTNAME) -> CTGFLPT(1)               1070
*                   -> FENTNAME;                                   1070
         L     @05,PTRCPL                                          1070
         L     @01,CTGFIELD+4(,@05)                                1070
         L     @01,CTGFLPT(,@01)                                   1070
         MVC   PATHENT(44,@06),FENTNAME(@01)                       1070
*                IF (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)     1071
*                  ^= NULLPTR) &                                   1071
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLNG(1)      1071
*                  ^= 0) &                                         1071
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)      1071
*                  ->FPASSMWR) ^= NOTINIT(1:8)                     1071
*                  THEN                                            1071
         SLR   @04,@04                                             1071
         L     @05,CTGFIELD+36(,@05)                               1071
         L     @01,CTGFLPT(,@05)                                   1071
         CR    @01,@04                                             1071
         BE    @RF01071                                            1071
         C     @04,CTGFLNG(,@05)                                   1071
         BE    @RF01071                                            1071
         CLC   FPASSMWR(8,@01),NOTINIT                             1071
         BE    @RF01071                                            1071
*                    DO;                                           1072
*                    DICTLN(DINDX+1) = LENGTH(PATHPASS);           1073
         ST    @15,DICTLN(@02,@14)                                 1073
*                    DICTDL(DINDX+1) = ADDR(PATHPASS)              1074
*                       - CTGWKA;                                  1074
         LA    @15,PATHPASS(,@06)                                  1074
         SLR   @15,@07                                             1074
         ST    @15,DICTDL(@02,@14)                                 1074
*                    PATHPASS = PTRCPL(1) ->                       1075
*                       CTGFIELD(IPASSWOR) ->                      1075
*                       CTGFLPT(1) -> FPASSMWR;                    1075
         MVC   PATHPASS(8,@06),FPASSMWR(@01)                       1075
*                    END;                                          1076
*                END;                                              1077
*                                                                  1077
*              ELSE                                                1078
*                                                                  1078
*              /******************************************************/
*              /*                                                    */
*              /*  THE COMPONENT IS NEITHER AIX NOR PATH             */
*              /*  ZERO OUT THE NEXT TWO FIELDS IN THE       @Z40RSSA*/
*              /*  DICTIONARY.                                       */
*              /*                                                    */
*              /******************************************************/
*                                                                  1078
*                DO;                                               1078
         B     @RC01066                                            1078
@RF01066 DS    0H                                                  1079
*                DICTLN(DINDX) = 0;                                1079
         SLR   @02,@02                                             1079
         LR    @15,DINDX                                           1079
         SLA   @15,3                                               1079
         LA    @14,8                                               1079
         AL    @14,CONRCPTR                                        1079
         LA    @01,0(@15,@14)                                      1079
         AL    @01,@CF01320                                        1079
         ST    @02,DICTLN-4(,@01)                                  1079
*                DICTDL(DINDX) = NULLPTR;                          1080
         ST    @02,DICTDL-8(@15,@14)                               1080
*                DICTLN(DINDX+1) = 0;                              1081
         ST    @02,DICTLN(@15,@14)                                 1081
*                DICTDL(DINDX+1) = NULLPTR;                        1082
         ST    @02,DICTDL(@15,@14)                                 1082
*                END;                                              1083
*                                                                  1083
*        DINDX = DINDX + 2;                                        1084
*                                                                  1084
@RC01066 DS    0H                                                  1084
@RC01058 AL    DINDX,@CF00152                                      1084
*        /*  INSERT THE REMAINING ENTRIES INTO THE DICTIONARY.     1085
*          THESE ENTRIES WERE MADE AFTER RELEASE 2 OF VSAM.        1085
*          NOTE, THAT THE DICTIONARY ENTIRES FOLLOW THE            1085
*          PASSREL ENTRY WHILE THE WORK AREAS POINTED TO           1085
*          BY THE DICT ENTRY PRECEDE THE RELATE OR PATHENTRY @Z40RSSA*/
*MORBILD: DO INDX =  ISECFLGS TO ONUM;                     /*@Z40RSSA*/
MORBILD  LA    INDX,21                                             1085
         B     @DE01085                                            1085
@DL01085 DS    0H                                                  1086
*           CTGFLPTR = CTGFIELD(INDX);                     /*@Z40RSSA*/
         LR    @15,INDX                                            1086
         SLA   @15,2                                               1086
         L     @01,CTGPLPTR                                        1086
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        1086
*           LGNFLD = CTGFLNG(1);                           /*@Z40RSSA*/
         L     @15,CTGFLNG(,CTGFLPTR)                              1087
         LR    LGNFLD,@15                                          1087
*           IF (CTGFLNG(1) = 0 ×                           /*@Z40RSSA*/
*               CTGFLPT(1) = NULLPTR ×                     /*@Z40RSSA*/
*               FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))       /*@Z40RSSA*/
*            THEN                                          /*@Z40RSSA*/
         SLR   @14,@14                                             1088
         CR    @15,@14                                             1088
         BE    @RT01088                                            1088
         L     @15,CTGFLPT(,CTGFLPTR)                              1088
         CR    @15,@14                                             1088
         BE    @RT01088                                            1088
         LR    @14,LGNFLD                                          1088
         BCTR  @14,0                                               1088
         EX    @14,@SC01323                                        1088
         BNE   @RF01088                                            1088
@RT01088 DS    0H                                                  1089
*              DO;                                         /*@Z40RSSA*/
*              DICTLN(DINDX) = 0;                          /*@Z40RSSA*/
         SLR   @05,@05                                             1090
         LR    @02,DINDX                                           1090
         SLA   @02,3                                               1090
         LA    @15,8                                               1090
         AL    @15,CONRCPTR                                        1090
         LA    @01,0(@02,@15)                                      1090
         AL    @01,@CF01320                                        1090
         ST    @05,DICTLN-4(,@01)                                  1090
*              DICTDL(DINDX) = NULLPTR;                    /*@Z40RSSA*/
         ST    @05,DICTDL-8(@02,@15)                               1091
*              END;                                        /*@Z40RSSA*/
*            ELSE                                          /*@Z40RSSA*/
*              DO;                                         /*@Z40RSSA*/
         B     @RC01088                                            1093
@RF01088 DS    0H                                                  1094
*              DICTLN(DINDX) = CTGFLNG(1);                 /*@Z40RSSA*/
         LR    @05,DINDX                                           1094
         SLA   @05,3                                               1094
         LA    @15,8                                               1094
         AL    @15,CONRCPTR                                        1094
         L     @14,CTGFLNG(,CTGFLPTR)                              1094
         LA    @01,0(@05,@15)                                      1094
         AL    @01,@CF01320                                        1094
         ST    @14,DICTLN-4(,@01)                                  1094
*              DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;        /*@Z40RSSA*/
         L     @14,CTGFLPT(,CTGFLPTR)                              1095
         L     @01,CTGPLPTR                                        1095
         SL    @14,CTGWKA(,@01)                                    1095
         ST    @14,DICTDL-8(@05,@15)                               1095
*              END;                                        /*@Z40RSSA*/
*              DINDX = DINDX + 1;                          /*@Z40RSSA*/
@RC01088 AL    DINDX,@CF00218                                      1097
*        END   MORBILD;                                    /*@Z40RSSA*/
         AL    INDX,@CF00218                                       1098
@DE01085 SLR   @05,@05                                             1098
         IC    @05,ONUM                                            1098
         CR    INDX,@05                                            1098
         BNH   @DL01085                                            1098
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE CONTROL RECORD OUT TO PORTABILITY DATA SET        */
*        /*  THEN WRITE OUT THE WORK AREA AS A SEPARATE RECORD       */
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */
*        /*  CALLING PROCESSOR                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1099
*        SAVLEN = HEADLN;                                          1099
*                                                                  1099
         L     @01,CONRCPTR                                        1099
         LH    @15,HEADLN(,@01)                                    1099
         STH   @15,SAVLEN                                          1099
*        CALL SAVEPROC(SAVLEN,CONRCPTR,'H');                       1100
*                                                                  1100
         LA    @15,SAVLEN                                          1100
         ST    @15,@AL00001                                        1100
         LA    @15,CONRCPTR                                        1100
         ST    @15,@AL00001+4                                      1100
         LA    @15,@CC01070                                        1100
         ST    @15,@AL00001+8                                      1100
         LA    @01,@AL00001                                        1100
         BAL   @14,SAVEPROC                                        1100
*        RESPECIFY RTNREG RSTD;                                    1101
*        TESTRC = RTNREG;                                          1102
         LR    TESTRC,RTNREG                                       1102
*        RESPECIFY RTNREG UNRSTD;                                  1103
*        IF TESTRC ^= 0                                            1104
*          THEN                                                    1104
         LTR   TESTRC,TESTRC                                       1104
         BZ    @RF01104                                            1104
*            RETURN CODE(LASTCC16);                                1105
*                                                                  1105
         LA    @15,16                                              1105
         L     @14,@SA00009                                        1105
         LM    @00,@12,@SA00009+8                                  1105
         BR    @14                                                 1105
*        SAVLEN = RETURNLN + LENGTH(PATHREL);                      1106
*                                                                  1106
@RF01104 L     @15,CTGPLPTR                                        1106
         L     @01,CTGWKA(,@15)                                    1106
         LH    @01,RETURNLN(,@01)                                  1106
         LA    @01,52(,@01)                                        1106
         STH   @01,SAVLEN                                          1106
*        CALL SAVEPROC(SAVLEN,CTGWKA,'H');                         1107
*                                                                  1107
         LA    @14,SAVLEN                                          1107
         ST    @14,@AL00001                                        1107
         LA    @15,CTGWKA(,@15)                                    1107
         ST    @15,@AL00001+4                                      1107
         LA    @15,@CC01070                                        1107
         ST    @15,@AL00001+8                                      1107
         LA    @01,@AL00001                                        1107
         BAL   @14,SAVEPROC                                        1107
*        RESPECIFY RTNREG RSTD;                                    1108
*        TESTRC = RTNREG;                                          1109
         LR    TESTRC,RTNREG                                       1109
*        RESPECIFY RTNREG UNRSTD;                                  1110
*        IF TESTRC ^= 0                                            1111
*          THEN                                                    1111
         LTR   TESTRC,TESTRC                                       1111
         BZ    @RF01111                                            1111
*            RETURN CODE(LASTCC16);                                1112
*                                                                  1112
         LA    @15,16                                              1112
         L     @14,@SA00009                                        1112
         LM    @00,@12,@SA00009+8                                  1112
         BR    @14                                                 1112
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO THE CALLING PROCESSOR INDICATING              */
*        /*  SUCCESS.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1113
*        RETURN CODE(0);                                           1113
*                                                                  1113
@RF01111 SLR   @15,@15                                             1113
         L     @14,@SA00009                                        1113
         LM    @00,@12,@SA00009+8                                  1113
         BR    @14                                                 1113
*END CONTRBL;                                                      1114
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - NVSMPROC                               */
*        /*                                                          */
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */
*        /*  THE OBJECT BEING EXPORTED AND ANY ALIAS'S DEFINED       */
*        /*  OVER IT.  BUILDS CONTROL  RECORDS, AND                  */
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */
*        /*  PROCEDURES TO WRITE THE CATALOG RECORDS OF THE DATA     */
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA              */
*        /*  SET.                                                    */
*        /*                                                          */
*        /* INPUT - FDT                                              */
*        /*                                                          */
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */
*        /*  THE IMPORT FSR TO RECONSTRUCT THE NON VSAM OBJECT ON THE*/
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1115
*NVSMPROC: PROCEDURE;                                              1115
*                                                                  1115
NVSMPROC STM   @14,@12,@SA00010                                    1115
*        OLDERID2 = NEWERID2;                                      1116
         L     @05,@PC00001                                        1116
         L     @15,GDTTR2(,@05)                                    1116
         MVC   @TS00001(95),NEWERID2(@15)                          1116
         MVC   OLDERID2(95,@15),@TS00001                           1116
*        NEWID2 = 'RC27';                                          1117
         MVC   NEWID2(4,@15),@CC01185                              1117
*        IF GDTDBG = NULLPTR                                       1118
*          THEN;                                                   1118
         L     @05,GDTDBG(,@05)                                    1118
         LTR   @05,@05                                             1118
         BZ    @RT01118                                            1118
*          ELSE                                                    1120
*            CALL IDCDB010 (GDTTBL,'RC28');                        1120
*                                                                  1120
         L     @05,@PC00001                                        1120
         ST    @05,@AL00001                                        1120
         LA    @15,@CC01186                                        1120
         ST    @15,@AL00001+4                                      1120
         MVI   @AL00001+4,X'80'                                    1120
         L     @15,GDTDBG(,@05)                                    1120
         LA    @01,@AL00001                                        1120
         BALR  @14,@15                                             1120
*        /************************************************************/
*        /*                                                          */
*        /*  BUILD CPL AND FPL'S FOR CATALOG LOCATE FUNCTION         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1121
*        CNUM = (DIM(NVSMFLST));       /*FIELD LIST FOR FIRST LOCATE */
@RT01118 MVI   CNUM,X'0A'                                          1121
*        ONUM = (DIM(NVSMFLST) -2);    /*FIELD LIST WITHOUT FPL'S FOR*/
         MVI   ONUM,X'08'                                          1122
*                                      /*CATACB AND NAMEDS.          */
*                                                                  1123
*        /************************************************************/
*        /*                                                          */
*        /*  PERFORM LOCATE ON THE NON VSAM OBJECT'S CI NUMBER       */
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1123
*        CALL LOCPROC(OBJVAL,NULLPARM,NVSMFLST,CNUM,PTRCPL(NVMCPLNO));
*                                                                  1123
         L     @05,@PC00001+4                                      1123
         L     @05,INPPTR(,@05)                                    1123
         L     @05,INPTBL(,@05)                                    1123
         LA    @05,OBJVAL(,@05)                                    1123
         ST    @05,@AL00001                                        1123
         LA    @05,NULLPARM                                        1123
         ST    @05,@AL00001+4                                      1123
         LA    @05,NVSMFLST                                        1123
         ST    @05,@AL00001+8                                      1123
         LA    @05,CNUM                                            1123
         ST    @05,@AL00001+12                                     1123
         LA    @05,PTRCPL+4                                        1123
         ST    @05,@AL00001+16                                     1123
         LA    @01,@AL00001                                        1123
         BAL   @14,LOCPROC                                         1123
*        /************************************************************/
*        /*                                                          */
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1124
*        RESPECIFY RTNREG RSTD;                                    1124
*        TESTRC = RTNREG;                                          1125
         LR    TESTRC,RTNREG                                       1125
*        RESPECIFY RTNREG UNRSTD;                                  1126
*        IF TESTRC ^= 0                                            1127
*          THEN                                                    1127
         LTR   TESTRC,TESTRC                                       1127
         BZ    @RF01127                                            1127
*            RETURN CODE(LASTCC16);                                1128
*                                                                  1128
         LA    @15,16                                              1128
         L     @14,@SA00010                                        1128
         LM    @00,@12,@SA00010+8                                  1128
         BR    @14                                                 1128
*        CALL CTLGPROC(PTRCPL(NVMCPLNO));                          1129
*                                                                  1129
@RF01127 LA    @05,PTRCPL+4                                        1129
         ST    @05,@AL00001                                        1129
         LA    @01,@AL00001                                        1129
         BAL   @14,CTLGPROC                                        1129
*        /************************************************************/
*        /*                                                          */
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1130
*        RESPECIFY RTNREG RSTD;                                    1130
*        TESTRC = RTNREG;                                          1131
         LR    TESTRC,RTNREG                                       1131
*        RESPECIFY RTNREG UNRSTD;                                  1132
*                                                                  1132
*        IF TESTRC ^= 0                                            1133
*          THEN                                                    1133
*                                                                  1133
         LTR   TESTRC,TESTRC                                       1133
         BZ    @RF01133                                            1133
*            /********************************************************/
*            /*                                                      */
*            /* IF SEVERE ERROR RETURN WITH TERMINATION CODE ELSE    */
*            /*  RETURN INDICATES THIS REQUEST COULD NOT BE PROCESSED*/
*            /*                                                      */
*            /********************************************************/
*            IF TESTRC = LASTCC16                                  1134
*              THEN                                                1134
         LA    @03,16                                              1134
         CR    TESTRC,@03                                          1134
         BNE   @RF01134                                            1134
*                RETURN CODE(LASTCC16);                            1135
         LR    @15,@03                                             1135
         L     @14,@SA00010                                        1135
         LM    @00,@12,@SA00010+8                                  1135
         BR    @14                                                 1135
*              ELSE                                                1136
*                RETURN CODE(LASTCC08);                            1136
*                                                                  1136
@RF01134 LA    @15,8                                               1136
         L     @14,@SA00010                                        1136
         LM    @00,@12,@SA00010+8                                  1136
         BR    @14                                                 1136
*          ELSE;                                                   1137
*                                                                  1137
@RF01133 DS    0H                                                  1138
*        /************************************************************/
*        /*                                                          */
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A NON VSAM OBJECT    */
*        /*  OR USER CATALOG                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1138
*        CTGPLPTR = PTRCPL(NVMCPLNO);                              1138
         L     @05,PTRCPL+4                                        1138
         ST    @05,CTGPLPTR                                        1138
*        CTGFLPTR = CTGFIELD(IENTYPE);                             1139
         L     CTGFLPTR,CTGFIELD(,@05)                             1139
*        IF CTGFLNG(1) = 0 & CTGFLPT(1) = 0                        1140
*          THEN                                                    1140
         SLR   @05,@05                                             1140
         C     @05,CTGFLNG(,CTGFLPTR)                              1140
         BNE   @RF01140                                            1140
         C     @05,CTGFLPT(,CTGFLPTR)                              1140
         BNE   @RF01140                                            1140
*            DO;                                                   1141
*            DARGSMOD = CEXPMSG;                                   1142
         L     @15,DDSTRU                                          1142
         MVC   DARGSMOD(3,@15),@CC00836                            1142
*            DARGSENT = NOCTFLD;                                   1143
         MVI   DARGSENT(@15),X'04'                                 1143
*            RETURN CODE(LASTCC08);                                1144
         LA    @15,8                                               1144
         L     @14,@SA00010                                        1144
         LM    @00,@12,@SA00010+8                                  1144
         BR    @14                                                 1144
*            END;                                                  1145
*                                                                  1145
*          ELSE                                                    1146
*            IF FENTYPE ^= CTGTALIN & FENTYPE ^= CTGTUCAT          1146
*              THEN                                                1146
@RF01140 L     @05,CTGFLPT(,CTGFLPTR)                              1146
         CLI   FENTYPE(@05),C'A'                                   1146
         BE    @RF01146                                            1146
         CLI   FENTYPE(@05),C'U'                                   1146
         BE    @RF01146                                            1146
*                DO;                                               1147
*                DARGSMOD = EXPMSG;                                1148
         L     @15,DDSTRU                                          1148
         MVC   DARGSMOD(3,@15),@CC00834                            1148
*                DARGSENT = NOVALOBJ;                              1149
         MVI   DARGSENT(@15),X'03'                                 1149
*                RETURN CODE(LASTCC08);                            1150
         LA    @15,8                                               1150
         L     @14,@SA00010                                        1150
         LM    @00,@12,@SA00010+8                                  1150
         BR    @14                                                 1150
*                END;                                              1151
*                                                                  1151
*              ELSE;                                               1152
*                                                                  1152
@RF01146 DS    0H                                                  1153
*        /************************************************************/
*        /*                                                          */
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1153
*        CTGFLPTR = CTGFIELD(NCATACB);                             1153
         L     @05,CTGPLPTR                                        1153
         L     CTGFLPTR,CTGFIELD+36(,@05)                          1153
*        PTRCTACB = FCATACB;                                       1154
*                                                                  1154
         L     @03,CTGFLPT(,CTGFLPTR)                              1154
         L     @03,FCATACB(,@03)                                   1154
         ST    @03,PTRCTACB                                        1154
*        /************************************************************/
*        /*                                                          */
*        /*  GET NAMEDS FPL FOR NUMBER OF ASSOCIATIONS               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1155
*        CTGFLPTR = CTGFIELD(NNAMEDS);                             1155
         L     CTGFLPTR,CTGFIELD+32(,@05)                          1155
*        IF CTGFLNG(1) = 0                                         1156
*          THEN                                                    1156
         SLR   @05,@05                                             1156
         C     @05,CTGFLNG(,CTGFLPTR)                              1156
         BNE   @RF01156                                            1156
*            NUMASSOC = 0;                                         1157
         STH   @05,NUMASSOC                                        1157
*          ELSE                                                    1158
*            DO;                                                   1158
         B     @RC01156                                            1158
@RF01156 DS    0H                                                  1159
*            FNMPTR = CTGFLPT(1);                                  1159
         L     @05,CTGFLPT(,CTGFLPTR)                              1159
         ST    @05,FNMPTR                                          1159
*            NUMASSOC = CTGFLNG(1) / LNAMEDS;                      1160
         L     @00,CTGFLNG(,CTGFLPTR)                              1160
         SRDA  @00,32                                              1160
         D     @00,@CF00041                                        1160
         STH   @01,NUMASSOC                                        1160
*            NVSMALS = ON;                                         1161
         OI    NVSMALS,B'00000010'                                 1161
*            END;                                                  1162
*                                                                  1162
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */
*        /*  AREA RETURNED BY LOCATE                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1163
*        OLDERID2 = NEWERID2;                                      1163
@RC01156 L     @05,@PC00001                                        1163
         L     @03,GDTTR2(,@05)                                    1163
         MVC   @TS00001(95),NEWERID2(@03)                          1163
         MVC   OLDERID2(95,@03),@TS00001                           1163
*        NEWID2 = 'RC29';                                          1164
*                                                                  1164
         MVC   NEWID2(4,@03),@CC01187                              1164
*        /************************************************************/
*        /*                                                          */
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1165
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);
*                                                                  1165
         MVC   @AL00001+4(16),@AL01165                             1165
         ST    @05,@AL00001                                        1165
         LA    @03,CONRCPTR                                        1165
         ST    @03,@AL00001+8                                      1165
         L     @15,GDTGPL(,@05)                                    1165
         LA    @01,@AL00001                                        1165
         BALR  @14,@15                                             1165
*        RESPECIFY RTNREG RSTD;                                    1166
*        TESTRC = RTNREG;                                          1167
         LR    TESTRC,RTNREG                                       1167
*        RESPECIFY RTNREG UNRSTD;                                  1168
*        IF TESTRC ^= 0                                            1169
*          THEN                                                    1169
         LTR   TESTRC,TESTRC                                       1169
         BZ    @RF01169                                            1169
*            DO;                                                   1170
*            DARGSMOD = UNIVMSG;                                   1171
         L     @15,DDSTRU                                          1171
         MVC   DARGSMOD(3,@15),@CC00847                            1171
*            DARGSENT = NOSTORAG;                                  1172
         MVI   DARGSENT(@15),X'04'                                 1172
*            RETURN CODE(LASTCC16);                                1173
         LA    @15,16                                              1173
         L     @14,@SA00010                                        1173
         LM    @00,@12,@SA00010+8                                  1173
         BR    @14                                                 1173
*            END;                                                  1174
*                                                                  1174
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          1175
*                                                                  1175
*                                                                  1175
@RF01169 L     @05,@PC00001                                        1175
         ST    @05,@AL00001                                        1175
         LA    @15,8                                               1175
         AL    @15,CONRCPTR                                        1175
         LA    @14,TIMEODAY(,@15)                                  1175
         ST    @14,@AL00001+4                                      1175
         LA    @15,TIMEDATE(,@15)                                  1175
         ST    @15,@AL00001+8                                      1175
         LA    @15,FORMAT                                          1175
         ST    @15,@AL00001+12                                     1175
         MVI   @AL00001+12,X'80'                                   1175
         L     @15,GDTTIM(,@05)                                    1175
         LA    @01,@AL00001                                        1175
         BALR  @14,@15                                             1175
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               1176
         L     @05,CONRCPTR                                        1176
         MVC   HEADLN(2,@05),@CH01286                              1176
*        HEADFLG1 = HDFL1CAT;                                      1177
         MVI   HEADFLG1(@05),X'FF'                                 1177
*        HEADFLG2 = HDFL2TSP;                                      1178
*                                                                  1178
         MVI   HEADFLG2(@05),X'FF'                                 1178
*        IF OBJTYP = CTGTUCAT                                      1179
*          THEN                                                    1179
         L     @15,@PC00001+4                                      1179
         L     @01,INPPTR(,@15)                                    1179
         L     @01,INPTBL(,@01)                                    1179
         CLI   OBJTYP(@01),C'U'                                    1179
         BNE   @RF01179                                            1179
*            TEXUCT = ON;                                          1180
         OI    TEXUCT+8(@05),B'00000001'                           1180
*          ELSE                                                    1181
*            TEXNVS = ON;                                          1181
         B     @RC01179                                            1181
@RF01179 L     @05,CONRCPTR                                        1181
         OI    TEXNVS+8(@05),B'00000100'                           1181
*        TEXRCVY = ON;                                             1182
@RC01179 L     @05,CONRCPTR                                        1182
         LA    @15,8                                               1182
         ALR   @15,@05                                             1182
         OI    TEXRCVY(@15),B'00001000'                            1182
*        TEXOJCT = NUMASSOC + 1;                                   1183
         LA    @14,1                                               1183
         AH    @14,NUMASSOC                                        1183
         STC   @14,TEXOJCT(,@15)                                   1183
*        TEXFLG2 = EXPTYPE1;                                       1184
*                                                                  1184
         MVC   TEXFLG2(1,@15),EXPTYPE1                             1184
*        SAVLEN = HEADLN;                                          1185
*                                                                  1185
*                                                                  1185
         LH    @05,HEADLN(,@05)                                    1185
         STH   @05,SAVLEN                                          1185
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1186
*        CALL  SAVEPROC(SAVLEN,CONRCPTR,'H');                      1186
*                                                                  1186
         LA    @05,SAVLEN                                          1186
         ST    @05,@AL00001                                        1186
         LA    @05,CONRCPTR                                        1186
         ST    @05,@AL00001+4                                      1186
         LA    @05,@CC01070                                        1186
         ST    @05,@AL00001+8                                      1186
         LA    @01,@AL00001                                        1186
         BAL   @14,SAVEPROC                                        1186
*        RESPECIFY RTNREG RSTD;                                    1187
*        TESTRC = RTNREG;                                          1188
         LR    TESTRC,RTNREG                                       1188
*        RESPECIFY RTNREG UNRSTD;                                  1189
*        IF TESTRC ^= 0                                            1190
*          THEN                                                    1190
         LTR   TESTRC,TESTRC                                       1190
         BZ    @RF01190                                            1190
*            RETURN CODE(LASTCC16);                                1191
         LA    @15,16                                              1191
         L     @14,@SA00010                                        1191
         LM    @00,@12,@SA00010+8                                  1191
         BR    @14                                                 1191
*                                                                  1192
*        /************************************************************/
*        /*                                                          */
*        /*  BUILD AND WRITE THE CONTROL RECORD FOR THIS OBJECT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1192
*        INDXCPL = NVMCPLNO ;           /*INDEX TO CPL FOR CONTRBL   */
*                                                                  1192
@RF01190 MVC   INDXCPL(4),@CF00152                                 1192
*        /************************************************************/
*        /*                                                          */
*        /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,             */
*        /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.                   */
*        /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN             */
*        /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE              */
*        /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY              */
*        /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO              */
*        /*  THE PORTABILITY DATA SET.                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1193
*        CALL CONTRBL(INDXCPL,'N');                                1193
*                                                                  1193
         LA    @05,INDXCPL                                         1193
         ST    @05,@AL00001                                        1193
         LA    @05,@CC01072                                        1193
         ST    @05,@AL00001+4                                      1193
         LA    @01,@AL00001                                        1193
         BAL   @14,CONTRBL                                         1193
*        RESPECIFY RTNREG RSTD;                                    1194
*        TESTRC = RTNREG;                                          1195
         LR    TESTRC,RTNREG                                       1195
*        RESPECIFY RTNREG UNRSTD;                                  1196
*                                                                  1196
*        IF TESTRC ^= 0                                            1197
*          THEN                                                    1197
         LTR   TESTRC,TESTRC                                       1197
         BZ    @RF01197                                            1197
*            IF TESTRC = LASTCC16                                  1198
*              THEN                                                1198
         LA    @03,16                                              1198
         CR    TESTRC,@03                                          1198
         BNE   @RF01198                                            1198
*                RETURN CODE(LASTCC16);                            1199
         LR    @15,@03                                             1199
         L     @14,@SA00010                                        1199
         LM    @00,@12,@SA00010+8                                  1199
         BR    @14                                                 1199
*              ELSE                                                1200
*                RETURN CODE(LASTCC08);                            1200
@RF01198 LA    @15,8                                               1200
         L     @14,@SA00010                                        1200
         LM    @00,@12,@SA00010+8                                  1200
         BR    @14                                                 1200
*          ELSE;                                                   1201
*                                                                  1201
@RF01197 DS    0H                                                  1202
*        /************************************************************/
*        /*                                                          */
*        /*  TEST TO DETERMINE IF THERE ARE ALIAS'S                  */
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING                */
*        /*  LOCATES FOR THE ALIAS'S, AND WRITING OUT THE            */
*        /*  CATALOG INFORMATION TO THE PORTABILITY                  */
*        /*  DATA SET.                                               */
*        /*                                                          */
*        /************************************************************/
*        IF NVSMALS = ON                                           1202
*          THEN                                                    1202
         TM    NVSMALS,B'00000010'                                 1202
         BNO   @RF01202                                            1202
*ALSDEF:     DO;                                                   1203
*                                                                  1203
ALSDEF   DS    0H                                                  1204
*            /********************************************************/
*            /*                                                      */
*            /*  CALL ALSPROC TO PROCESS THE ASSOCIATED ALIAS'S      */
*            /*                                                      */
*            /********************************************************/
*                                                                  1204
*                                                                  1204
*            CALL  ALSPROC(FNMPTR);                                1204
*                                                                  1204
         LA    @05,FNMPTR                                          1204
         ST    @05,@AL00001                                        1204
         LA    @01,@AL00001                                        1204
         BAL   @14,ALSPROC                                         1204
*            /********************************************************/
*            /*                                                      */
*            /*  TEST RETURN FROM ALSPROC, IF RETURN CODE OF 16 THEN */
*            /*  TERMINATE THIS REQUEST -- NO CORE AVAILABLE         */
*            /*                                                      */
*            /********************************************************/
*                                                                  1205
*                                                                  1205
*            RESPECIFY RTNREG RSTD;                                1205
*            TESTRC = RTNREG;                                      1206
         LR    TESTRC,RTNREG                                       1206
*            RESPECIFY RTNREG UNRSTD;                              1207
*                                                                  1207
*            IF TESTRC = LASTCC16                                  1208
*              THEN                                                1208
         LA    @03,16                                              1208
         CR    TESTRC,@03                                          1208
         BNE   @RF01208                                            1208
*                RETURN CODE(LASTCC16);                            1209
*                                                                  1209
*                                                                  1209
         LR    @15,@03                                             1209
         L     @14,@SA00010                                        1209
         LM    @00,@12,@SA00010+8                                  1209
         BR    @14                                                 1209
*            END ALSDEF;                                           1210
*                                                                  1210
*          ELSE  ;                                                 1211
*                                                                  1211
*                                                                  1211
@RF01202 DS    0H                                                  1212
*        /************************************************************/
*        /*                                                          */
*        /*CALL SAVEPROC TO WRITE THE CONTROL AND CATALOG RECORDS    */
*        /*FOR THIS NON VSAM DATA SET TO THE PORTABILITY DATA SET    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1212
*        CALL  SAVEPROC(NULLPARM,NULLPARM,'W');                    1212
*                                                                  1212
*                                                                  1212
@RC01202 LA    @01,@AL01212                                        1212
         BAL   @14,SAVEPROC                                        1212
*        /************************************************************/
*        /*                                                          */
*        /* CHECK FOR SUCCESSFUL PROCESSING AND WRITE SOFTWARE END OF*/
*        /* FILE ON THE PORTABILITY DATA SET.                        */
*        /* IF PROCESSING FOR ALIAS'S INCOMPLETE THEN A FLAG HAS     */
*        /* BEEN SET AND A WARNING MESSAGE PRINTED.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1213
*        RESPECIFY RTNREG RSTD;                                    1213
*        TESTRC = RTNREG;                                          1214
         LR    TESTRC,RTNREG                                       1214
*        RESPECIFY RTNREG UNRSTD;                                  1215
*        IF TESTRC ^= 0                                            1216
*          THEN                                                    1216
         LTR   TESTRC,TESTRC                                       1216
         BZ    @RF01216                                            1216
*            RETURN CODE(LASTCC16);                                1217
*                                                                  1217
         LA    @15,16                                              1217
         L     @14,@SA00010                                        1217
         LM    @00,@12,@SA00010+8                                  1217
         BR    @14                                                 1217
*        CALL  PUTPROC(NULLPARM,NULLPARM);                         1218
*                                                                  1218
@RF01216 LA    @01,@AL01218                                        1218
         BAL   @14,PUTPROC                                         1218
*        RESPECIFY RTNREG RSTD;                                    1219
*        TESTRC = RTNREG;                                          1220
         LR    TESTRC,RTNREG                                       1220
*        RESPECIFY RTNREG UNRSTD;                                  1221
*        IF TESTRC ^= 0                                            1222
*          THEN                                                    1222
         LTR   TESTRC,TESTRC                                       1222
         BZ    @RF01222                                            1222
*            RETURN CODE(LASTCC16);                                1223
*                                                                  1223
         LA    @15,16                                              1223
         L     @14,@SA00010                                        1223
         LM    @00,@12,@SA00010+8                                  1223
         BR    @14                                                 1223
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO CALLER WITH SUCCESS INDICATED                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1224
*       RETURN CODE(0);                                            1224
*                                                                  1224
@RF01222 SLR   @15,@15                                             1224
         L     @14,@SA00010                                        1224
         LM    @00,@12,@SA00010+8                                  1224
         BR    @14                                                 1224
*END NVSMPROC;                                                     1225
*                                                                  1226
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - SAVEPROC                               */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE SAVES ALL THE OUTPUT CONTROL  */
*        /*             RECORDS FOR EACH OBJECT AND THEN WRITES THEM */
*        /*             TO THE PORTABILITY DATA SET WHEN PROCESSING  */
*        /*             OF CATALOG INFORMATION HAS BEEN COMPLETED.   */
*        /*                                                          */
*        /*  INPUT - LENGTH AND ADDRESS OF RECORD TO BE OUTPUTTED    */
*        /*                                                          */
*        /*  OUTPUT - RECORD WILL BE WRITTEN TO PORTABILITY DATA SET */
*        /*                                                          */
*        /************************************************************/
*                                                                  1226
*SAVEPROC: PROCEDURE(IRECLEN,          /*LENGTH OF RECORD            */
*                    IRECPTR,          /*ADDRESS OF RECORD           */
*                    IREQTPE);         /*TYPE OF REQUEST             */
*                                                                  1226
SAVEPROC STM   @14,@12,@SA00011                                    1226
         MVC   @PC00011(12),0(@01)                                 1226
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1227
*        DCL IRECLEN FIXED(15),                                    1227
*            IRECPTR PTR(31),                                      1227
*            IREQTPE CHAR(1);                                      1227
*                                                                  1227
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1228
*        DCL REQLEN   FIXED(31);       /*LENGTH OF CORE REQUIRED     */
*        DCL STRTCHN  FIXED(31);       /*START OF OUTPUT BUFFER CHAIN*/
*        DCL REQPTR   PTR(31);         /*RETURN AREA FROM UGPOOL     */
*        DCL CURPTR   PTR(31);         /*CURRENT OUTPUT BUFFER CHAIN */
*        /*  POINTERS TO SAVE AREA WHERE RECORDS ARE HELD            */
*        DCL 1  BUFCHN  BDY(WORD)  BASED(CURPTR), /*                 */
*                                      /*BUFFER CHAIN FOR SAVE AREA  */
*             2  BHRECLEN  FIXED(31),  /*LENGTH OF RECORD TO OUTPUT  */
*                3 *       FIXED(15) , /* FULLWORD NEED FOR PUTPROC  */
*                3 BRECLEN FIXED(15),  /* LENGTH SAVED               */
*             2  BRECPTR  PTR(31),     /*AREA WHERE RECORD SAVED     */
*             2  BNXTCHN  FIXED(31);   /*NEXT RECORD AREA            */
*                                                                  1232
*        DCL DOWRITE BIT(1);           /* WRITE OUTPUT CONTROL       */
*                                                                  1233
*                                                                  1233
*        OLDERID2 = NEWERID2;                                      1234
         L     @15,@PC00001                                        1234
         L     @14,GDTTR2(,@15)                                    1234
         MVC   @TS00001(95),NEWERID2(@14)                          1234
         MVC   OLDERID2(95,@14),@TS00001                           1234
*        NEWID2 = 'RC31';                                          1235
         MVC   NEWID2(4,@14),@CC01211                              1235
*        IF GDTDBG = NULLPTR                                       1236
*          THEN;                                                   1236
         L     @15,GDTDBG(,@15)                                    1236
         LTR   @15,@15                                             1236
         BZ    @RT01236                                            1236
*          ELSE                                                    1238
*            CALL IDCDB010 (GDTTBL,'RC32');                        1238
*                                                                  1238
*                                                                  1238
         L     @15,@PC00001                                        1238
         ST    @15,@AL00001                                        1238
         LA    @14,@CC01212                                        1238
         ST    @14,@AL00001+4                                      1238
         MVI   @AL00001+4,X'80'                                    1238
         L     @15,GDTDBG(,@15)                                    1238
         LA    @01,@AL00001                                        1238
         BALR  @14,@15                                             1238
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TYPE OF REQUEST, IF SAVE REQUEST THEN GET CORE AND*/
*        /*  MOVE THE INPUT RECORD INTO IT, IF WRITE REQUEST THEN    */
*        /*  WRITE ALL THE SAVED RECORDS TO THE PORTABILITY DATA SET.*/
*        /*                                                          */
*        /************************************************************/
*        IF IREQTPE = 'H'                                          1239
*          THEN                                                    1239
@RT01236 L     @15,@PC00011+8                                      1239
         CLI   IREQTPE(@15),C'H'                                   1239
         BNE   @RF01239                                            1239
*SAVR:       DO;                                                   1240
SAVR     DS    0H                                                  1241
*            IF FRSTSAV = OFF                                      1241
*              THEN                                                1241
         TM    FRSTSAV,B'01000000'                                 1241
         BNZ   @RF01241                                            1241
*                DO;                                               1242
*                /****************************************************/
*                /*                                                  */
*                /* GET CORE AND SAVE POINTER TO START OF CHAIN      */
*                /* IF REQUEST FAILS RETURN WITH TERMINATION CODE.   */
*                /*                                                  */
*                /****************************************************/
*                                                                  1243
*                CALL IDCSAGP0 (GDTTBL,LENGTH(BUFCHN),REQPTR,GPID, 1243
*                  SETZERO);                                       1243
*                                                                  1243
         MVC   @AL00001+4(16),@AL01243                             1243
         L     @03,@PC00001                                        1243
         ST    @03,@AL00001                                        1243
         LA    @15,REQPTR                                          1243
         ST    @15,@AL00001+8                                      1243
         L     @15,GDTGPL(,@03)                                    1243
         LA    @01,@AL00001                                        1243
         BALR  @14,@15                                             1243
*                RESPECIFY RTNREG RSTD;                            1244
*                TESTRC = RTNREG;                                  1245
         LR    TESTRC,RTNREG                                       1245
*                RESPECIFY RTNREG UNRSTD;                          1246
*                IF TESTRC ^= 0                                    1247
*                  THEN                                            1247
         LTR   TESTRC,TESTRC                                       1247
         BZ    @RF01247                                            1247
*                    DO;                                           1248
*                    DARGSMOD = UNIVMSG;                           1249
         L     @15,DDSTRU                                          1249
         MVC   DARGSMOD(3,@15),@CC00847                            1249
*                    DARGSENT = NOSTORAG;                          1250
         MVI   DARGSENT(@15),X'04'                                 1250
*                    RETURN  CODE(LASTCC16);                       1251
         LA    @15,16                                              1251
         L     @14,@SA00011                                        1251
         LM    @00,@12,@SA00011+8                                  1251
         BR    @14                                                 1251
*                    END;                                          1252
*                                                                  1252
*                /****************************************************/
*                /*                                                  */
*                /* SAVE POINTER TO START OF OUTPUT BUFFER CHAIN     */
*                /*                                                  */
*                /****************************************************/
*                STRTCHN = REQPTR;     /* START OF BUFFER CHAIN      */
@RF01247 L     @15,REQPTR                                          1253
         ST    @15,STRTCHN                                         1253
*                CURPTR = REQPTR;      /* POINTER TO CURRENT CHAIN   */
         ST    @15,CURPTR                                          1254
*                FRSTSAV = ON;         /* SAVE POINTER TO START OF   */
         OI    FRSTSAV,B'01000000'                                 1255
*                                      /* CHAIN FIRST TIME ONLY.     */
*                END;                                              1256
*                                                                  1256
*              ELSE                                                1257
*                /****************************************************/
*                /*                                                  */
*                /* NOT FIRST REQUEST GET ANOTHER AREA OF CORE AND   */
*                /* CHAIN PREVIOUS AREA TO IT.                       */
*                /*                                                  */
*                /****************************************************/
*                DO;                                               1257
*                                                                  1257
         B     @RC01241                                            1257
@RF01241 DS    0H                                                  1258
*                CALL IDCSAGP0 (GDTTBL,LENGTH(BUFCHN),REQPTR,GPID, 1258
*                  SETZERO);                                       1258
*                                                                  1258
*                                                                  1258
*                                                                  1258
         MVC   @AL00001+4(16),@AL01258                             1258
         L     @03,@PC00001                                        1258
         ST    @03,@AL00001                                        1258
         LA    @15,REQPTR                                          1258
         ST    @15,@AL00001+8                                      1258
         L     @15,GDTGPL(,@03)                                    1258
         LA    @01,@AL00001                                        1258
         BALR  @14,@15                                             1258
*                RESPECIFY RTNREG RSTD;                            1259
*                TESTRC = RTNREG;                                  1260
         LR    TESTRC,RTNREG                                       1260
*                RESPECIFY RTNREG UNRSTD;                          1261
*                IF TESTRC ^= 0                                    1262
*                  THEN                                            1262
         LTR   TESTRC,TESTRC                                       1262
         BZ    @RF01262                                            1262
*                    DO;                                           1263
*                    DARGSMOD = UNIVMSG;                           1264
         L     @15,DDSTRU                                          1264
         MVC   DARGSMOD(3,@15),@CC00847                            1264
*                    DARGSENT = NOSTORAG;                          1265
         MVI   DARGSENT(@15),X'04'                                 1265
*                    RETURN  CODE(LASTCC16);                       1266
         LA    @15,16                                              1266
         L     @14,@SA00011                                        1266
         LM    @00,@12,@SA00011+8                                  1266
         BR    @14                                                 1266
*                    END;                                          1267
*                                                                  1267
*                                                                  1267
*                /****************************************************/
*                /*                                                  */
*                /* SAVE POINTERS TO PREVIOUS AND NEW CHAINS         */
*                /*                                                  */
*                /****************************************************/
*                                                                  1268
*                BNXTCHN = REQPTR;     /* POINTER TO NEXT CHAIN      */
@RF01262 L     @15,REQPTR                                          1268
         L     @14,CURPTR                                          1268
         ST    @15,BNXTCHN(,@14)                                   1268
*                CURPTR = REQPTR;      /* POINTER TO CURRENT CHAIN   */
*                                                                  1269
         ST    @15,CURPTR                                          1269
*                END;                                              1270
*                                                                  1270
*            /********************************************************/
*            /*                                                      */
*            /* GET AN AREA OF CORE AND MOVE THE INPUT RECORD INTO IT*/
*            /*  IF REQUEST FAILS TERMINATE                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1271
*            REQLEN = IRECLEN;       /* LENGTH IN FULLWORD FOR UGPOOL*/
*                                                                  1271
@RC01241 L     @03,@PC00011                                        1271
         LH    @03,IRECLEN(,@03)                                   1271
         ST    @03,REQLEN                                          1271
*            CALL IDCSAGP0  (GDTTBL,REQLEN,REQPTR,GPID,SETZERO);   1272
*                                                                  1272
         L     @03,@PC00001                                        1272
         ST    @03,@AL00001                                        1272
         LA    @15,REQLEN                                          1272
         ST    @15,@AL00001+4                                      1272
         LA    @15,REQPTR                                          1272
         ST    @15,@AL00001+8                                      1272
         LA    @15,GPID                                            1272
         ST    @15,@AL00001+12                                     1272
         LA    @15,SETZERO                                         1272
         ST    @15,@AL00001+16                                     1272
         MVI   @AL00001+16,X'80'                                   1272
         L     @15,GDTGPL(,@03)                                    1272
         LA    @01,@AL00001                                        1272
         BALR  @14,@15                                             1272
*            RESPECIFY RTNREG RSTD;                                1273
*            TESTRC = RTNREG;                                      1274
         LR    TESTRC,RTNREG                                       1274
*            RESPECIFY RTNREG UNRSTD;                              1275
*            IF TESTRC ^= 0                                        1276
*              THEN                                                1276
         LTR   TESTRC,TESTRC                                       1276
         BZ    @RF01276                                            1276
*                DO;                                               1277
*                DARGSMOD = UNIVMSG;                               1278
         L     @15,DDSTRU                                          1278
         MVC   DARGSMOD(3,@15),@CC00847                            1278
*                DARGSENT = NOSTORAG;                              1279
         MVI   DARGSENT(@15),X'04'                                 1279
*                RETURN  CODE(LASTCC16);                           1280
         LA    @15,16                                              1280
         L     @14,@SA00011                                        1280
         LM    @00,@12,@SA00011+8                                  1280
         BR    @14                                                 1280
*                END;                                              1281
*                                                                  1281
*                                                                  1281
*                                                                  1281
*                                                                  1281
*            /********************************************************/
*            /*                                                      */
*            /* MOVE THE INPUT RECORD TO THE SAVE AREA               */
*            /*                                                      */
*            /********************************************************/
*                                                                  1282
*            CALL  MVDAPROC  (IRECLEN,IRECPTR,REQPTR,NULLPARM);    1282
*                                                                  1282
*                                                                  1282
@RF01276 L     @15,@PC00011                                        1282
         ST    @15,@AL00001                                        1282
         L     @15,@PC00011+4                                      1282
         ST    @15,@AL00001+4                                      1282
         LA    @15,REQPTR                                          1282
         ST    @15,@AL00001+8                                      1282
         LA    @15,NULLPARM                                        1282
         ST    @15,@AL00001+12                                     1282
         LA    @01,@AL00001                                        1282
         BAL   @14,MVDAPROC                                        1282
*            /********************************************************/
*            /*                                                      */
*            /* SAVE THE INPUT RECORD LENGTH AND LOCATION IN THE     */
*            /* BUFFER CHAIN.                                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  1283
*            BRECPTR = REQPTR;        /* POINTER TO RECORD SAVED     */
         L     @15,CURPTR                                          1283
         L     @14,REQPTR                                          1283
         ST    @14,BRECPTR(,@15)                                   1283
*            BRECLEN = IRECLEN;       /* LENGTH OF RECORD SAVED      */
*                                                                  1284
         L     @14,@PC00011                                        1284
         LH    @14,IRECLEN(,@14)                                   1284
         STH   @14,BRECLEN(,@15)                                   1284
*            END   SAVR;              /* END OF LOOP TO SAVE RECORDS */
*                                                                  1285
*          ELSE                                                    1286
*WRITR:      DO;                                                   1286
         B     @RC01239                                            1286
@RF01239 DS    0H                                                  1286
WRITR    DS    0H                                                  1287
*            /********************************************************/
*            /*                                                      */
*            /*  WRITE THE SAVED CONTROL RECORDS TO THE PORTABILITY  */
*            /*   DATA SET.                                          */
*            /*   CALL PUTPROC TO DO THE ACTUALL WRITING, IF ERROR   */
*            /*   OCCURS RETURN WITH TERMINATION CODE.               */
*            /*                                                      */
*            /********************************************************/
*                                                                  1287
*            CURPTR = STRTCHN;         /* START OF BUFFER CHAIN      */
         L     @15,STRTCHN                                         1287
         ST    @15,CURPTR                                          1287
*            DOWRITE = ON;             /* SET WRITE LOOP ON          */
         OI    DOWRITE,B'10000000'                                 1288
*WRITL:      DO WHILE (DOWRITE = ON);  /* START WRITE LOOP           */
*                                                                  1289
WRITL    B     @DE01289                                            1289
@DL01289 DS    0H                                                  1290
*            CALL  PUTPROC (BHRECLEN,BRECPTR);                     1290
*                                                                  1290
         L     @15,CURPTR                                          1290
         ST    @15,@AL00001                                        1290
         LA    @15,BRECPTR(,@15)                                   1290
         ST    @15,@AL00001+4                                      1290
         LA    @01,@AL00001                                        1290
         BAL   @14,PUTPROC                                         1290
*            RESPECIFY RTNREG RSTD;                                1291
*            TESTRC = RTNREG;                                      1292
         LR    TESTRC,RTNREG                                       1292
*            RESPECIFY RTNREG UNRSTD;                              1293
*            IF TESTRC ^= 0                                        1294
*              THEN                                                1294
         LTR   TESTRC,TESTRC                                       1294
         BZ    @RF01294                                            1294
*                RETURN CODE(LASTCC16);                            1295
*                                                                  1295
         LA    @15,16                                              1295
         L     @14,@SA00011                                        1295
         LM    @00,@12,@SA00011+8                                  1295
         BR    @14                                                 1295
*            /********************************************************/
*            /*                                                      */
*            /* CHECK FOR LAST RECORD , IF END TURN LOOP OFF, ELSE   */
*            /* SET POINTER TO NEXT RECORD.                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1296
*            IF BNXTCHN = NULLPTR                                  1296
*              THEN                                                1296
@RF01294 L     @01,CURPTR                                          1296
         L     @15,BNXTCHN(,@01)                                   1296
         LTR   @15,@15                                             1296
         BNZ   @RF01296                                            1296
*                DOWRITE = OFF;                                    1297
         NI    DOWRITE,B'01111111'                                 1297
*              ELSE                                                1298
*                CURPTR = BNXTCHN;                                 1298
*                                                                  1298
         B     @RC01296                                            1298
@RF01296 L     @01,CURPTR                                          1298
         L     @15,BNXTCHN(,@01)                                   1298
         ST    @15,CURPTR                                          1298
*            END   WRITL;              /* END WRITE LOOP             */
@RC01296 DS    0H                                                  1299
@DE01289 TM    DOWRITE,B'10000000'                                 1299
         BO    @DL01289                                            1299
*            END   WRITR;              /* END WRITE PROCEDURE        */
*                                                                  1300
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1301
*        RETURN CODE(0);                                           1301
*                                                                  1301
@RC01239 SLR   @15,@15                                             1301
         L     @14,@SA00011                                        1301
         LM    @00,@12,@SA00011+8                                  1301
         BR    @14                                                 1301
*END SAVEPROC;                         /* END OF WRITE AND SAVE PROC */
*                                                                  1302
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME -  ALSPROC                               */
*        /*                                                          */
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION FOR ALIAS        */
*        /*   ASSOCIATIONS OF NON VSAM DATA SETS.                    */
*        /*   BUILDS CONTROL AND DATA RECORDS FOR THE ASSOCIATIONS   */
*        /*   WRITES THEM TO THE PORTABILITY DATA SET.               */
*        /*                                                          */
*        /* INPUT - POINTER TO THE NAMEDS FPL FOR THE NON VSAM DATA  */
*        /*         SET.                                             */
*        /*                                                          */
*        /* OUTPUT - CONTROL AND CATALOG INFORMATION RECORDS WRITTEN */
*        /*           TO THE PORTABILITY DATA SET.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1303
*ALSPROC: PROCEDURE(ALSNMPTR);         /* NAMEDS FIELD POINTER       */
*                                                                  1303
*                                                                  1303
ALSPROC  STM   @14,@03,@SA00012                                    1303
         STM   @05,@12,@SA00012+24                                 1303
         MVC   @PC00012(4),0(@01)                                  1303
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1304
*        DCL  ALSNMPTR  PTR(31);       /* FPL POINTER TO NAMEDS FIELD*/
*                                      /* FOR NON VSAM LOCATES       */
*                                                                  1305
*        DCL 1 NMDSPTR CHAR(4) BDY(WORD)  BASED(ALSNMPTR), /*        */
*                                      /*  NAMEDS STRUCTURE          */
*              2  NMDSTYPE  CHAR(1),   /* ENTRY TYPE                 */
*              2  NMDSNAME  CHAR(3);   /* ENTRY NAME                 */
*                                                                  1305
*        /************************************************************/
*        /*                                                          */
*        /*             DECLARATIONS                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1306
*        DCL  NALSMPTR  PTR(31);       /* FPL POINTER TO NAMEDS FIELD*/
*                                      /* FOR ALIAS LOCATES          */
*                                                                  1307
*        DCL 1 ALSCHN CHAR(12) BDY(WORD)  BASED(NALSMPTR),         1307
*                                      /*  NAMEDS STRUCTURE ALIAS'S  */
*              2  GDSASOC  CHAR(4),    /* NON VSAM ASSOCIATION       */
*                                                                  1307
*              2  NXTALIS  CHAR(4),    /*NEXT ALIAS IN CHAIN         */
*                 3  NXTTPE  CHAR(1),  /*ALIAS TYPE ID               */
*                 3  NXTNAM  CHAR(3),  /*NEXT ALIAS IN CHAIN         */
*                                                                  1307
*              2  PREVALS  CHAR(4);    /* PREVIOUS ALIAS             */
*                                                                  1307
*        DCL  NXTCHN  FIXED(24);       /*NEXT ALIAS ASSOCIATION      */
*                                                                  1308
*        DCL  DOALIS  BIT(1);         /* DO LOOP FOR ALIAS PROCESSING*/
*                                                          /*@OZ10598*/
*        DCL 1 CPLFPLEN,                                   /*@OZ10598*/
*              2 *    FIXED(15),                           /*@OZ10598*/
*              2 ALSCPLEN FIXED(15);                       /*@OZ10598*/
*                                                                  1310
*        /************************************************************/
*        /*                                                          */
*        /*  LOOP THROUGH THE ALIAS'S DOING                          */
*        /*  LOCATES AND WRITING CATALOG INFORMATION TO THE          */
*        /*  PORTABILITY DATA SET.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1311
*        OLDERID2 = NEWERID2;                                      1311
         L     @05,@PC00001                                        1311
         L     @05,GDTTR2(,@05)                                    1311
         MVC   @TS00001(95),NEWERID2(@05)                          1311
         MVC   OLDERID2(95,@05),@TS00001                           1311
*        NEWID2 = 'RC33';                                          1312
         MVC   NEWID2(4,@05),@CC01239                              1312
*        DOALIS = OFF;                                             1313
*                                                                  1313
         NI    DOALIS,B'01111111'                                  1313
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE NUMBER OF FIELD LISTS FOR LOCATES             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1314
*        CNUM = (DIM(ALSFLIST));                                   1314
         MVI   CNUM,X'03'                                          1314
*        ONUM = (DIM(ALSFLIST)-1);                                 1315
*                                                                  1315
         MVI   ONUM,X'02'                                          1315
*        /************************************************************/
*        /*                                                          */
*        /* TEST TO DETERMINE IF THE ASSOCIATED OBJECT IS A GDG      */
*        /*                                                          */
*        /************************************************************/
*        IF NMDSTYPE = 'B'                                         1316
*          THEN                                                    1316
*                                                                  1316
         L     @05,@PC00012                                        1316
         L     @15,ALSNMPTR(,@05)                                  1316
         CLI   NMDSTYPE(@15),C'B'                                  1316
         BNE   @RF01316                                            1316
*            /********************************************************/
*            /*                                                      */
*            /* SET POINTER TO NEXT NON VSAM IN NAMEDS AREA          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1317
*            ALSNMPTR = ALSNMPTR + LNAMEDS;                        1317
*                                                                  1317
         AL    @15,@CF00041                                        1317
         ST    @15,ALSNMPTR(,@05)                                  1317
*            IF NMDSTYPE = 'X'                                     1318
*              THEN                                                1318
@RF01316 L     @05,@PC00012                                        1318
         L     @05,ALSNMPTR(,@05)                                  1318
         CLI   NMDSTYPE(@05),C'X'                                  1318
         BNE   @RF01318                                            1318
*ALSREC:         DO;                                               1319
ALSREC   DS    0H                                                  1320
*                /****************************************************/
*                /*                                                  */
*                /*  IF THIS IS THE FIRST ALIAS TO BE PROCESSED      */
*                /*  CALL LOCPROC TO BUILD THE CPL AND FPL'S         */
*                /*                                                  */
*                /****************************************************/
*                                                                  1320
*                  CALL LOCPROC(NMDSNAME,PTRCTACB,ALSFLIST,        1320
*                    CNUM,PTRCPL(PTHCPLNO));                       1320
*                                                                  1320
         L     @05,@PC00012                                        1320
         L     @05,ALSNMPTR(,@05)                                  1320
         LA    @05,NMDSNAME(,@05)                                  1320
         ST    @05,@AL00001                                        1320
         LA    @05,PTRCTACB                                        1320
         ST    @05,@AL00001+4                                      1320
         LA    @05,ALSFLIST                                        1320
         ST    @05,@AL00001+8                                      1320
         LA    @05,CNUM                                            1320
         ST    @05,@AL00001+12                                     1320
         LA    @05,PTRCPL+16                                       1320
         ST    @05,@AL00001+16                                     1320
         LA    @01,@AL00001                                        1320
         BAL   @14,LOCPROC                                         1320
*                  RESPECIFY RTNREG RSTD;                          1321
*                  TESTRC = RTNREG;                                1322
         LR    TESTRC,RTNREG                                       1322
*                  RESPECIFY RTNREG UNRSTD;                        1323
*                                                                  1323
*                  IF TESTRC ^= 0                                  1324
*                    THEN                                          1324
         LTR   TESTRC,TESTRC                                       1324
         BZ    @RF01324                                            1324
*                      RETURN CODE(LASTCC16);                      1325
         LA    @15,16                                              1325
         L     @14,@SA00012                                        1325
         LM    @00,@03,@SA00012+8                                  1325
         LM    @05,@12,@SA00012+24                                 1325
         BR    @14                                                 1325
*                                                          /*@OZ10598*/
*                  CPLFPLEN = TOTLEN;                      /*@OZ10598*/
@RF01324 MVC   CPLFPLEN(4),TOTLEN                                  1326
*                                                          /*@OZ10598*/
*                  /**************************************************/
*                  /*                                                */
*                  /*  SAVE THE CPL AND FPL'S JUST                   */
*                  /*  CONSTRUCTED FOR USE WITH OTHER ALIAS'S        */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1327
*                  SAPLLEN = LENGTH(SAVEPL);                       1327
*                                                                  1327
         MVC   SAPLLEN(2),@CH01287                                 1327
*                  CALL MVDAPROC(ALSCPLEN,PTRCPL(PTHCPLNO),/*@OZ10598*/
*                    ADDR(SAVEPL),NULLPARM);                       1328
*                                                                  1328
*                                                                  1328
*                                                                  1328
         LA    @05,ALSCPLEN                                        1328
         ST    @05,@AL00001                                        1328
         LA    @05,PTRCPL+16                                       1328
         ST    @05,@AL00001+4                                      1328
         LA    @05,SAVEPL                                          1328
         ST    @05,@AFTEMPS+8                                      1328
         LA    @05,@AFTEMPS+8                                      1328
         ST    @05,@AL00001+8                                      1328
         LA    @05,NULLPARM                                        1328
         ST    @05,@AL00001+12                                     1328
         LA    @01,@AL00001                                        1328
         BAL   @14,MVDAPROC                                        1328
*                  /**************************************************/
*                  /*                                                */
*                  /* CALL CTLGPROC TO ISSUE A UCATLG TO DO THE      */
*                  /* ACTUAL LOCATE.                                 */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1329
*                  CALL CTLGPROC(PTRCPL(PTHCPLNO));                1329
*                                                                  1329
         LA    @05,PTRCPL+16                                       1329
         ST    @05,@AL00001                                        1329
         LA    @01,@AL00001                                        1329
         BAL   @14,CTLGPROC                                        1329
*                  RESPECIFY RTNREG RSTD;                          1330
*                  TESTRC = RTNREG;                                1331
         LR    TESTRC,RTNREG                                       1331
*                  RESPECIFY RTNREG UNRSTD;                        1332
*                  IF TESTRC ^= 0                                  1333
*                    THEN                                          1333
         LTR   TESTRC,TESTRC                                       1333
         BZ    @RF01333                                            1333
*                      DO;                                         1334
*                      /**********************************************/
*                      /*                                            */
*                      /* IF SEVERE ERROR RETURNS WITH TERMINATION   */
*                      /* ELSE BYPASSES THIS ALIAS AND PRINTS        */
*                      /* MESSAGE TO INDICATE THE ERROR              */
*                      /*                                            */
*                      /**********************************************/
*                      IF TESTRC = LASTCC16                        1335
*                        THEN                                      1335
         LA    @05,16                                              1335
         CR    TESTRC,@05                                          1335
         BNE   @RF01335                                            1335
*                          RETURN CODE(LASTCC16);                  1336
         LR    @15,@05                                             1336
         L     @14,@SA00012                                        1336
         LM    @00,@03,@SA00012+8                                  1336
         LM    @05,@12,@SA00012+24                                 1336
         BR    @14                                                 1336
*                        ELSE                                      1337
*                          DO;                                     1337
@RF01335 DS    0H                                                  1338
*                          ERRSAVFL = ON;                          1338
*                                                                  1338
         OI    ERRSAVFL,B'00100000'                                1338
*                          CALL  PRNTPROC(WARNMSG1,ASCCPLMG);      1339
*                                                                  1339
         LA    @01,@AL01339                                        1339
         BAL   @14,PRNTPROC                                        1339
*                          END;                                    1340
*                                                                  1340
*                      END;                                        1341
*                                                                  1341
*                                                                  1341
*                    ELSE                                          1342
*                      DO;                                         1342
         B     @RC01333                                            1342
@RF01333 DS    0H                                                  1343
*                      /**********************************************/
*                      /*                                            */
*                      /*  CHECK ALIAS CHAIN FOR ADDITIONAL ALIAS'S  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  1343
*                      CTGPLPTR = PTRCPL(PTHCPLNO);                1343
         L     @05,PTRCPL+16                                       1343
         ST    @05,CTGPLPTR                                        1343
*                      CTGFLPTR = CTGFIELD(IALNMDS);               1344
         L     CTGFLPTR,CTGFIELD+8(,@05)                           1344
*                      NALSMPTR = CTGFLPT(1);                      1345
         L     NALSMPTR,CTGFLPT(,CTGFLPTR)                         1345
*                      NXTCHN = NXTNAM;                            1346
         L     @05,NXTNAM-1(,NALSMPTR)                             1346
         LA    @05,0(,@05)                                         1346
         STCM  @05,7,NXTCHN                                        1346
*                      IF NXTCHN = 0                               1347
*                        THEN;                                     1347
         LTR   @05,@05                                             1347
         BZ    @RT01347                                            1347
*                        ELSE                                      1349
*                          DOALIS = ON ;                           1349
*                                                                  1349
         OI    DOALIS,B'10000000'                                  1349
*                      /**********************************************/
*                      /*                                            */
*                      /*  CALL CONTRBL TO BUILD THE CONTROL RECORD  */
*                      /*  AND TO WRITE IT AND THE CATALOG WORK AREA */
*                      /*  OUT THE PORTABILITY DATA SET              */
*                      /*                                            */
*                      /**********************************************/
*                                                                  1350
*                      CALL CONTRBL(PTHCPLNO,'N');                 1350
*                                                                  1350
@RT01347 LA    @01,@AL01350                                        1350
         BAL   @14,CONTRBL                                         1350
*                      RESPECIFY RTNREG RSTD;                      1351
*                      TESTRC = RTNREG;                            1352
         LR    TESTRC,RTNREG                                       1352
*                      RESPECIFY RTNREG UNRSTD;                    1353
*                                                                  1353
*                      IF TESTRC ^= 0                              1354
*                        THEN                                      1354
         LTR   TESTRC,TESTRC                                       1354
         BZ    @RF01354                                            1354
*                          DO;                                     1355
*                          /******************************************/
*                          /*                                        */
*                          /* IF SEVERE ERROR RETURNS WITH           */
*                          /* TERMINATION CODE ELSE BYPASSES ALIAS'S */
*                          /* AND PRINTS MESSAGE TO INDICATE         */
*                          /* THE ERROR                              */
*                          /*                                        */
*                          /******************************************/
*                          IF TESTRC = LASTCC16                    1356
*                            THEN                                  1356
         LA    @05,16                                              1356
         CR    TESTRC,@05                                          1356
         BNE   @RF01356                                            1356
*                              RETURN CODE(LASTCC16);              1357
         LR    @15,@05                                             1357
         L     @14,@SA00012                                        1357
         LM    @00,@03,@SA00012+8                                  1357
         LM    @05,@12,@SA00012+24                                 1357
         BR    @14                                                 1357
*                            ELSE                                  1358
*                              DO;                                 1358
@RF01356 DS    0H                                                  1359
*                              ERRSAVFL = ON;                      1359
         OI    ERRSAVFL,B'00100000'                                1359
*                              DOALIS = OFF;                       1360
*                                                                  1360
         NI    DOALIS,B'01111111'                                  1360
*                              CALL  PRNTPROC(WARNMSG1,ASCCPLMG);  1361
*                                                                  1361
         LA    @01,@AL01361                                        1361
         BAL   @14,PRNTPROC                                        1361
*                              END;                                1362
*                          END;                                    1363
*                       END;                                       1364
*                                                                  1364
*                END ALSREC;                                       1365
*                                                                  1365
*              ELSE                                                1366
*                DO;                                               1366
         B     @RC01318                                            1366
@RF01318 DS    0H                                                  1367
*                /****************************************************/
*                /*                                                  */
*                /* NOT ALIAS ASSOCIATION, PRINT WARNING MESSAGE     */
*                /*                                                  */
*                /****************************************************/
*                                                                  1367
*                ERRSAVFL = ON;                                    1367
*                                                                  1367
         OI    ERRSAVFL,B'00100000'                                1367
*                CALL  PRNTPROC(WARNMSG1,ASCCPLMG);                1368
*                                                                  1368
         LA    @01,@AL01368                                        1368
         BAL   @14,PRNTPROC                                        1368
*                END;                                              1369
*                                                                  1369
*                                                                  1369
*                  /**************************************************/
*                  /*                                                */
*                  /*  IF THERE ARE ADDITIONAL ALIAS TO BE PROCESSED */
*                  /*  RESTORE THE CPL AND FPL'S MODIFY THE CPL TO   */
*                  /*  DO A LOCATE ON THE APPROPRIATE ALIAS          */
*                  /*                                                */
*                  /**************************************************/
*NFIRALS:          DO WHILE ( DOALIS = ON );                       1370
*                                                                  1370
@RC01318 DS    0H                                                  1370
NFIRALS  B     @DE01370                                            1370
@DL01370 DS    0H                                                  1371
*                  CTGPLPTR = PTRCPL(PTHCPLNO);                    1371
*                                                                  1371
         L     @05,PTRCPL+16                                       1371
         ST    @05,CTGPLPTR                                        1371
*                  CALL MVDAPROC(ALSCPLEN,ADDR(SAVEPL),    /*@OZ10598*/
*                    PTRCPL(PTHCPLNO),NULLPARM);                   1372
*                                                                  1372
         LA    @05,ALSCPLEN                                        1372
         ST    @05,@AL00001                                        1372
         LA    @05,SAVEPL                                          1372
         ST    @05,@AFTEMPS+8                                      1372
         LA    @05,@AFTEMPS+8                                      1372
         ST    @05,@AL00001+4                                      1372
         LA    @05,PTRCPL+16                                       1372
         ST    @05,@AL00001+8                                      1372
         LA    @05,NULLPARM                                        1372
         ST    @05,@AL00001+12                                     1372
         LA    @01,@AL00001                                        1372
         BAL   @14,MVDAPROC                                        1372
*                  CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),         1373
*                    NULLPARM,CTGWKA,SETZERO);                     1373
*                                                                  1373
         MVC   @AL00001(16),@AL01373                               1373
         L     @05,CTGPLPTR                                        1373
         LA    @05,CTGWKA(,@05)                                    1373
         ST    @05,@AL00001+8                                      1373
         LA    @01,@AL00001                                        1373
         BAL   @14,MVDAPROC                                        1373
*                  AREALN = WKAREALN;                              1374
         L     @05,CTGPLPTR                                        1374
         L     @01,CTGWKA(,@05)                                    1374
         MVC   AREALN(2,@01),@CH00812                              1374
*                  CTGENT = ADDR(NXTCHN);                          1375
*                                                                  1375
         LA    @15,NXTCHN                                          1375
         ST    @15,CTGENT(,@05)                                    1375
*                  /**************************************************/
*                  /*                                                */
*                  /* CLEAR THE FPL POINTERS SET BY PREVIOUS LOCATE  */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1376
*                  DO CLRFDCTR = 1 TO CNUM;                        1376
         LA    CLRFDCTR,1                                          1376
         B     @DE01376                                            1376
@DL01376 DS    0H                                                  1377
*                    CTGFLPTR = CTGFIELD(CLRFDCTR);                1377
         LR    @05,CLRFDCTR                                        1377
         SLA   @05,2                                               1377
         L     @01,CTGPLPTR                                        1377
         L     CTGFLPTR,CTGFIELD-4(@05,@01)                        1377
*                    CTGFLNG(1) = 0;                               1378
         SLR   @05,@05                                             1378
         ST    @05,CTGFLNG(,CTGFLPTR)                              1378
*                    CTGFLPT(1) = NULLPTR;                         1379
         ST    @05,CTGFLPT(,CTGFLPTR)                              1379
*                  END;                                            1380
*                                                                  1380
         AL    CLRFDCTR,@CF00218                                   1380
@DE01376 SLR   @05,@05                                             1380
         IC    @05,CNUM                                            1380
         CR    CLRFDCTR,@05                                        1380
         BNH   @DL01376                                            1380
*                  /**************************************************/
*                  /*                                                */
*                  /* CALL CTLGPROC TO ISSUE A UCATLG TO DO LOCATE   */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1381
*                  CALL CTLGPROC(PTRCPL(PTHCPLNO));                1381
*                                                                  1381
         LA    @05,PTRCPL+16                                       1381
         ST    @05,@AL00001                                        1381
         LA    @01,@AL00001                                        1381
         BAL   @14,CTLGPROC                                        1381
*                  RESPECIFY RTNREG RSTD;                          1382
*                  TESTRC = RTNREG;                                1383
         LR    TESTRC,RTNREG                                       1383
*                  RESPECIFY RTNREG UNRSTD;                        1384
*                                                                  1384
*                  IF TESTRC ^= 0                                  1385
*                    THEN                                          1385
         LTR   TESTRC,TESTRC                                       1385
         BZ    @RF01385                                            1385
*                      DO;                                         1386
*                      /**********************************************/
*                      /*                                            */
*                      /*IF SEVERE ERROR RETURNS WITH TERMINATION    */
*                      /*ELSE BYPASSES ALIAS'S AND PRINTS MESSAGE    */
*                      /*TO INDICATE THE ERROR                       */
*                      /*                                            */
*                      /**********************************************/
*                      IF TESTRC = LASTCC16                        1387
*                        THEN                                      1387
         LA    @05,16                                              1387
         CR    TESTRC,@05                                          1387
         BNE   @RF01387                                            1387
*                          RETURN CODE(LASTCC16);                  1388
         LR    @15,@05                                             1388
         L     @14,@SA00012                                        1388
         LM    @00,@03,@SA00012+8                                  1388
         LM    @05,@12,@SA00012+24                                 1388
         BR    @14                                                 1388
*                        ELSE                                      1389
*                          DO;                                     1389
@RF01387 DS    0H                                                  1390
*                          ERRSAVFL = ON;                          1390
         OI    ERRSAVFL,B'00100000'                                1390
*                          DOALIS = OFF;                           1391
*                                                                  1391
         NI    DOALIS,B'01111111'                                  1391
*                          CALL  PRNTPROC(WARNMSG1,ASCCPLMG);      1392
*                                                                  1392
         LA    @01,@AL01392                                        1392
         BAL   @14,PRNTPROC                                        1392
*                          END;                                    1393
*                      END;                                        1394
*                    ELSE                                          1395
*                      DO;                                         1395
         B     @RC01385                                            1395
@RF01385 DS    0H                                                  1396
*                      /**********************************************/
*                      /*                                            */
*                      /*  CHECK ALIAS CHAIN FOR ADDITIONAL ALIAS'S  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  1396
*                      CTGPLPTR = PTRCPL(PTHCPLNO);                1396
         L     @05,PTRCPL+16                                       1396
         ST    @05,CTGPLPTR                                        1396
*                      CTGFLPTR = CTGFIELD(IALNMDS);               1397
         L     CTGFLPTR,CTGFIELD+8(,@05)                           1397
*                      NALSMPTR = CTGFLPT(1);                      1398
         L     NALSMPTR,CTGFLPT(,CTGFLPTR)                         1398
*                      NXTCHN = NXTNAM;                            1399
         L     @05,NXTNAM-1(,NALSMPTR)                             1399
         LA    @05,0(,@05)                                         1399
         STCM  @05,7,NXTCHN                                        1399
*                      IF NXTCHN = 0                               1400
*                        THEN                                      1400
         LTR   @05,@05                                             1400
         BNZ   @RF01400                                            1400
*                          DOALIS = OFF ;                          1401
*                                                                  1401
         NI    DOALIS,B'01111111'                                  1401
*                      /**********************************************/
*                      /*                                            */
*                      /*  CALL CONTRBL TO BUILD THE CONTROL         */
*                      /*  RECORD FOR THE CURRENT ALIAS AND          */
*                      /*  TO WRITE IT AND THE CATALOG WORK          */
*                      /*  AREA OUT THE PORTABILITY DATA SET         */
*                      /*                                            */
*                      /**********************************************/
*                                                                  1402
*                      CALL CONTRBL(PTHCPLNO,'N');                 1402
*                                                                  1402
@RF01400 LA    @01,@AL01402                                        1402
         BAL   @14,CONTRBL                                         1402
*                      RESPECIFY RTNREG RSTD;                      1403
*                      TESTRC = RTNREG;                            1404
         LR    TESTRC,RTNREG                                       1404
*                      RESPECIFY RTNREG UNRSTD;                    1405
*                                                                  1405
*                      IF TESTRC ^= 0                              1406
*                        THEN                                      1406
         LTR   TESTRC,TESTRC                                       1406
         BZ    @RF01406                                            1406
*                          DO;                                     1407
*                          /******************************************/
*                          /*                                        */
*                          /* IF SEVERE ERROR RETURNS WITH           */
*                          /* TERMINATION CODE ELSE BYPASSES         */
*                          /* ALIAS'S AND PRINTS MESSAGE TO          */
*                          /* INDICATE THE ERROR                     */
*                          /*                                        */
*                          /******************************************/
*                          IF TESTRC = LASTCC16                    1408
*                            THEN                                  1408
         LA    @05,16                                              1408
         CR    TESTRC,@05                                          1408
         BNE   @RF01408                                            1408
*                              RETURN CODE(LASTCC16);              1409
         LR    @15,@05                                             1409
         L     @14,@SA00012                                        1409
         LM    @00,@03,@SA00012+8                                  1409
         LM    @05,@12,@SA00012+24                                 1409
         BR    @14                                                 1409
*                            ELSE                                  1410
*                              DO;                                 1410
@RF01408 DS    0H                                                  1411
*                              ERRSAVFL = ON;                      1411
         OI    ERRSAVFL,B'00100000'                                1411
*                              DOALIS = OFF;                       1412
*                                                                  1412
         NI    DOALIS,B'01111111'                                  1412
*                              CALL  PRNTPROC(WARNMSG1,ASCCPLMG);  1413
*                                                                  1413
         LA    @01,@AL01413                                        1413
         BAL   @14,PRNTPROC                                        1413
*                              END;                                1414
*                          END;                                    1415
*                      END;                                        1416
*                                                                  1416
@RF01406 DS    0H                                                  1417
*                  END NFIRALS;                                    1417
*                                                                  1417
@RC01385 DS    0H                                                  1417
@DE01370 TM    DOALIS,B'10000000'                                  1417
         BO    @DL01370                                            1417
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO CALLER WITH SUCCESS INDICATED                  */
*        /*  IF ALL ALIAS'S NOT PROCESSED THEN ERROR FLAG SET        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1418
*        RETURN CODE(0);                                           1418
*                                                                  1418
         SLR   @15,@15                                             1418
         L     @14,@SA00012                                        1418
         LM    @00,@03,@SA00012+8                                  1418
         LM    @05,@12,@SA00012+24                                 1418
         BR    @14                                                 1418
*END   ALSPROC;                                                    1419
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - GDGPROC                                */
*        /*                                                          */
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */
*        /*  THE OBJECT BEING EXPORTED AND ANY ASSOCIATIONS TO THE   */
*        /*  OBJECT.  BUILDS CONTROL AND DATA RECORDS, AND           */
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */
*        /*  PROCEDURES TO PROCESS ASSOCIATIONS.                     */
*        /*                                                          */
*        /*  INPUT - INPUT PARAMETER LIST                            */
*        /*                                                          */
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */
*        /*  THE IMPORT FSR TO RECONSTRUCT THE NON VSAM OBJECT ON THE*/
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1420
*GDGPROC: PROCEDURE;                                               1420
*                                                                  1420
GDGPROC  STM   @14,@12,@SA00013                                    1420
*        OLDERID2 = NEWERID2;                                      1421
         L     @15,@PC00001                                        1421
         L     @14,GDTTR2(,@15)                                    1421
         MVC   @TS00001(95),NEWERID2(@14)                          1421
         MVC   OLDERID2(95,@14),@TS00001                           1421
*        NEWID2 = 'RC35';                                          1422
         MVC   NEWID2(4,@14),@CC01247                              1422
*        IF GDTDBG = NULLPTR                                       1423
*          THEN;                                                   1423
         L     @15,GDTDBG(,@15)                                    1423
         LTR   @15,@15                                             1423
         BZ    @RT01423                                            1423
*          ELSE                                                    1425
*            CALL IDCDB010 (GDTTBL,'RC36');                        1425
*                                                                  1425
         L     @15,@PC00001                                        1425
         ST    @15,@AL00001                                        1425
         LA    @14,@CC01248                                        1425
         ST    @14,@AL00001+4                                      1425
         MVI   @AL00001+4,X'80'                                    1425
         L     @15,GDTDBG(,@15)                                    1425
         LA    @01,@AL00001                                        1425
         BALR  @14,@15                                             1425
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE NUMBER OF FIELDS FOR CATALOG LOCATE          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1426
*        CNUM = (DIM(GDGFLIST));       /*FIELD LIST FOR FIRST LOCATE */
@RT01423 MVI   CNUM,X'09'                                          1426
*        ONUM = (DIM(GDGFLIST) -2);    /*FIELD WITHOUT CATACB AND    */
         MVI   ONUM,X'07'                                          1427
*                                      /*NAMEDS FPL'S.               */
*                                                                  1428
*        /************************************************************/
*        /*                                                          */
*        /*  PERFORM LOCATE ON THE GDG CI NUMBER                     */
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1428
*        CALL LOCPROC(OBJVAL,NULLPARM,GDGFLIST,CNUM,PTRCPL(1));    1428
*                                                                  1428
         L     @15,@PC00001+4                                      1428
         L     @01,INPPTR(,@15)                                    1428
         L     @01,INPTBL(,@01)                                    1428
         LA    @15,OBJVAL(,@01)                                    1428
         ST    @15,@AL00001                                        1428
         LA    @15,NULLPARM                                        1428
         ST    @15,@AL00001+4                                      1428
         LA    @15,GDGFLIST                                        1428
         ST    @15,@AL00001+8                                      1428
         LA    @15,CNUM                                            1428
         ST    @15,@AL00001+12                                     1428
         LA    @15,PTRCPL                                          1428
         ST    @15,@AL00001+16                                     1428
         LA    @01,@AL00001                                        1428
         BAL   @14,LOCPROC                                         1428
*        /************************************************************/
*        /*                                                          */
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1429
*        RESPECIFY RTNREG RSTD;                                    1429
*        TESTRC = RTNREG;                                          1430
         LR    TESTRC,RTNREG                                       1430
*        RESPECIFY RTNREG UNRSTD;                                  1431
*        IF TESTRC ^= 0                                            1432
*          THEN                                                    1432
         LTR   TESTRC,TESTRC                                       1432
         BZ    @RF01432                                            1432
*            RETURN CODE(LASTCC16);                                1433
*                                                                  1433
         LA    @15,16                                              1433
         L     @14,@SA00013                                        1433
         LM    @00,@12,@SA00013+8                                  1433
         BR    @14                                                 1433
*        CALL CTLGPROC(PTRCPL(1));                                 1434
*                                                                  1434
@RF01432 LA    @15,PTRCPL                                          1434
         ST    @15,@AL00001                                        1434
         LA    @01,@AL00001                                        1434
         BAL   @14,CTLGPROC                                        1434
*        /************************************************************/
*        /*                                                          */
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */
*        /* THIS REQUEST                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1435
*        RESPECIFY RTNREG RSTD;                                    1435
*        TESTRC = RTNREG;                                          1436
         LR    TESTRC,RTNREG                                       1436
*        RESPECIFY RTNREG UNRSTD;                                  1437
*                                                                  1437
*        IF TESTRC ^= 0                                            1438
*          THEN                                                    1438
         LTR   TESTRC,TESTRC                                       1438
         BZ    @RF01438                                            1438
*            DO;                                                   1439
*                                                                  1439
*            /********************************************************/
*            /*                                                      */
*            /* IF SEVERE ERROR RETURN IS WITH TERMINATION CODE ELSE */
*            /*  RETURN INDICATES THIS REQUEST COULD NOT BE PROCESSED*/
*            /*                                                      */
*            /********************************************************/
*                                                                  1440
*            IF TESTRC = LASTCC16                                  1440
*              THEN                                                1440
         LA    @03,16                                              1440
         CR    TESTRC,@03                                          1440
         BNE   @RF01440                                            1440
*                RETURN CODE(LASTCC16);                            1441
         LR    @15,@03                                             1441
         L     @14,@SA00013                                        1441
         LM    @00,@12,@SA00013+8                                  1441
         BR    @14                                                 1441
*              ELSE                                                1442
*                RETURN CODE(LASTCC08);                            1442
@RF01440 LA    @15,8                                               1442
         L     @14,@SA00013                                        1442
         LM    @00,@12,@SA00013+8                                  1442
         BR    @14                                                 1442
*            END;                                                  1443
*                                                                  1443
*        /************************************************************/
*        /*                                                          */
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A GDG OBJECT         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1444
*        CTGPLPTR = PTRCPL(1);                                     1444
@RF01438 L     @03,PTRCPL                                          1444
         ST    @03,CTGPLPTR                                        1444
*        CTGFLPTR = CTGFIELD(IENTYPE);                             1445
*                                                                  1445
         L     CTGFLPTR,CTGFIELD(,@03)                             1445
*        IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                      1446
*          THEN                                                    1446
         SLR   @03,@03                                             1446
         C     @03,CTGFLNG(,CTGFLPTR)                              1446
         BE    @RF01446                                            1446
         L     @15,CTGFLPT(,CTGFLPTR)                              1446
         CR    @15,@03                                             1446
         BE    @RF01446                                            1446
*            IF FENTYPE ^= 'B'                                     1447
*              THEN                                                1447
         CLI   FENTYPE(@15),C'B'                                   1447
         BE    @RF01447                                            1447
*                DO;                                               1448
*                DARGSMOD = EXPMSG;                                1449
         L     @15,DDSTRU                                          1449
         MVC   DARGSMOD(3,@15),@CC00834                            1449
*                DARGSENT = NOVALOBJ;                              1450
         MVI   DARGSENT(@15),X'03'                                 1450
*                RETURN CODE(LASTCC08);                            1451
         LA    @15,8                                               1451
         L     @14,@SA00013                                        1451
         LM    @00,@12,@SA00013+8                                  1451
         BR    @14                                                 1451
*                END;                                              1452
*              ELSE;                                               1453
@RF01447 DS    0H                                                  1454
*          ELSE                                                    1454
*            /********************************************************/
*            /*                                                      */
*            /*  NO ENTYPE FIELD -IMPOSSIBLE - TERMINATE             */
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   1454
         B     @RC01446                                            1454
@RF01446 DS    0H                                                  1455
*            DARGSMOD = EXPMSG;                                    1455
         L     @15,DDSTRU                                          1455
         MVC   DARGSMOD(3,@15),@CC00834                            1455
*            DARGSENT = NOCTFLD;                                   1456
         MVI   DARGSENT(@15),X'04'                                 1456
*            RETURN CODE(LASTCC08);                                1457
         LA    @15,8                                               1457
         L     @14,@SA00013                                        1457
         LM    @00,@12,@SA00013+8                                  1457
         BR    @14                                                 1457
*            END;                                                  1458
*                                                                  1458
*                                                                  1458
*        /************************************************************/
*        /*                                                          */
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1459
*        CTGFLPTR = CTGFIELD(GCATACB);                             1459
@RC01446 L     @15,CTGPLPTR                                        1459
         L     CTGFLPTR,CTGFIELD+32(,@15)                          1459
*        PTRCTACB = FCATACB;                                       1460
*                                                                  1460
         L     @03,CTGFLPT(,CTGFLPTR)                              1460
         L     @03,FCATACB(,@03)                                   1460
         ST    @03,PTRCTACB                                        1460
*        /************************************************************/
*        /*                                                          */
*        /*  GET NAMEDS FPL FOR GDS ASSOCIATIONS                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1461
*        CTGFLPTR = CTGFIELD(GNAMEDS);                             1461
*                                                                  1461
         L     CTGFLPTR,CTGFIELD+28(,@15)                          1461
*        /************************************************************/
*        /*                                                          */
*        /*TEST FOR ASSOCIATIONS, IF ANY SET NUMBER OF OBJECTS TO BE */
*        /* EXPORTED                                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1462
*        IF CTGFLNG(1) = 0                                         1462
*          THEN                                                    1462
         SLR   @03,@03                                             1462
         C     @03,CTGFLNG(,CTGFLPTR)                              1462
         BNE   @RF01462                                            1462
*            NUMASSOC = 0;                                         1463
         STH   @03,NUMASSOC                                        1463
*          ELSE                                                    1464
*            DO;                                                   1464
         B     @RC01462                                            1464
@RF01462 DS    0H                                                  1465
*            FNMPTR = CTGFLPT(1);                                  1465
         L     @03,CTGFLPT(,CTGFLPTR)                              1465
         ST    @03,FNMPTR                                          1465
*            NUMASSOC = CTGFLNG(1) / LNAMEDS;                      1466
         L     @00,CTGFLNG(,CTGFLPTR)                              1466
         SRDA  @00,32                                              1466
         D     @00,@CF00041                                        1466
         STH   @01,NUMASSOC                                        1466
*            ASSOCFLG = ON;                                        1467
         OI    ASSOCFLG,B'00000001'                                1467
*            END;                                                  1468
*                                                                  1468
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */
*        /*  AREA RETURNED BY LOCATE                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1469
*        OLDERID2 = NEWERID2;                                      1469
@RC01462 L     @03,@PC00001                                        1469
         L     @15,GDTTR2(,@03)                                    1469
         MVC   @TS00001(95),NEWERID2(@15)                          1469
         MVC   OLDERID2(95,@15),@TS00001                           1469
*        NEWID2 = 'RC37';                                          1470
*                                                                  1470
         MVC   NEWID2(4,@15),@CC01249                              1470
*        /************************************************************/
*        /*                                                          */
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1471
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);
*                                                                  1471
         MVC   @AL00001+4(16),@AL01471                             1471
         ST    @03,@AL00001                                        1471
         LA    @15,CONRCPTR                                        1471
         ST    @15,@AL00001+8                                      1471
         L     @15,GDTGPL(,@03)                                    1471
         LA    @01,@AL00001                                        1471
         BALR  @14,@15                                             1471
*        RESPECIFY RTNREG RSTD;                                    1472
*        TESTRC = RTNREG;                                          1473
         LR    TESTRC,RTNREG                                       1473
*        RESPECIFY RTNREG UNRSTD;                                  1474
*        IF TESTRC ^= 0                                            1475
*          THEN                                                    1475
         LTR   TESTRC,TESTRC                                       1475
         BZ    @RF01475                                            1475
*            DO;                                                   1476
*            DARGSMOD = UNIVMSG;                                   1477
         L     @15,DDSTRU                                          1477
         MVC   DARGSMOD(3,@15),@CC00847                            1477
*            DARGSENT = NOSTORAG;                                  1478
         MVI   DARGSENT(@15),X'04'                                 1478
*            RETURN CODE(LASTCC16);                                1479
         LA    @15,16                                              1479
         L     @14,@SA00013                                        1479
         LM    @00,@12,@SA00013+8                                  1479
         BR    @14                                                 1479
*            END;                                                  1480
*                                                                  1480
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          1481
*                                                                  1481
@RF01475 L     @15,@PC00001                                        1481
         ST    @15,@AL00001                                        1481
         LA    @14,8                                               1481
         AL    @14,CONRCPTR                                        1481
         LA    @07,TIMEODAY(,@14)                                  1481
         ST    @07,@AL00001+4                                      1481
         LA    @14,TIMEDATE(,@14)                                  1481
         ST    @14,@AL00001+8                                      1481
         LA    @14,FORMAT                                          1481
         ST    @14,@AL00001+12                                     1481
         MVI   @AL00001+12,X'80'                                   1481
         L     @15,GDTTIM(,@15)                                    1481
         LA    @01,@AL00001                                        1481
         BALR  @14,@15                                             1481
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               1482
         L     @15,CONRCPTR                                        1482
         LA    @14,28                                              1482
         STH   @14,HEADLN(,@15)                                    1482
*        HEADFLG1 = HDFL1CAT;                                      1483
         MVI   HEADFLG1(@15),X'FF'                                 1483
*        HEADFLG2 = HDFL2TSP;                                      1484
*                                                                  1484
         MVI   HEADFLG2(@15),X'FF'                                 1484
*        TEXGDG = ON;                                              1485
*        TEXRCVY = ON;                                             1486
         AL    @15,@CF00178                                        1486
         OI    TEXGDG(@15),B'00001010'                             1486
*        TEXOJCT = NUMASSOC + 1;       /* ADD OBJECT TO THE COUNT    */
         LA    @07,1                                               1487
         AH    @07,NUMASSOC                                        1487
         STC   @07,TEXOJCT(,@15)                                   1487
*        TEXFLG2 = EXPTYPE1;                                       1488
*                                                                  1488
         MVC   TEXFLG2(1,@15),EXPTYPE1                             1488
*        SAVLEN = HEADLN;                                          1489
*                                                                  1489
         STH   @14,SAVLEN                                          1489
*        /************************************************************/
*        /*                                                          */
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1490
*        CALL  SAVEPROC(SAVLEN,CONRCPTR,'H');                      1490
*                                                                  1490
         LA    @15,SAVLEN                                          1490
         ST    @15,@AL00001                                        1490
         LA    @15,CONRCPTR                                        1490
         ST    @15,@AL00001+4                                      1490
         LA    @15,@CC01070                                        1490
         ST    @15,@AL00001+8                                      1490
         LA    @01,@AL00001                                        1490
         BAL   @14,SAVEPROC                                        1490
*        RESPECIFY RTNREG RSTD;                                    1491
*        TESTRC = RTNREG;                                          1492
         LR    TESTRC,RTNREG                                       1492
*        RESPECIFY RTNREG UNRSTD;                                  1493
*        IF TESTRC ^= 0                                            1494
*          THEN                                                    1494
         LTR   TESTRC,TESTRC                                       1494
         BZ    @RF01494                                            1494
*            RETURN CODE(LASTCC16);                                1495
         LA    @15,16                                              1495
         L     @14,@SA00013                                        1495
         LM    @00,@12,@SA00013+8                                  1495
         BR    @14                                                 1495
*        /************************************************************/
*        /*                                                          */
*        /*  BUILD AND WRITE THE CONTROL RECORD FOR THIS OBJECT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1496
*        INDXCPL = 1;                     /*INDEX TO CPL FOR CONTRBL */
*                                                                  1496
@RF01494 MVC   INDXCPL(4),@CF00218                                 1496
*        /************************************************************/
*        /*                                                          */
*        /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,             */
*        /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.                   */
*        /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN             */
*        /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE              */
*        /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY              */
*        /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO              */
*        /*  THE PORTABILITY DATA SET.                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1497
*        CALL CONTRBL(INDXCPL,'N');                                1497
*                                                                  1497
         LA    @15,INDXCPL                                         1497
         ST    @15,@AL00001                                        1497
         LA    @15,@CC01072                                        1497
         ST    @15,@AL00001+4                                      1497
         LA    @01,@AL00001                                        1497
         BAL   @14,CONTRBL                                         1497
*        RESPECIFY RTNREG RSTD;                                    1498
*        TESTRC = RTNREG;                                          1499
         LR    TESTRC,RTNREG                                       1499
*        RESPECIFY RTNREG UNRSTD;                                  1500
*                                                                  1500
*        IF TESTRC ^= 0                                            1501
*          THEN                                                    1501
         LTR   TESTRC,TESTRC                                       1501
         BZ    @RF01501                                            1501
*            IF TESTRC = LASTCC16                                  1502
*              THEN                                                1502
         LA    @03,16                                              1502
         CR    TESTRC,@03                                          1502
         BNE   @RF01502                                            1502
*                RETURN CODE(LASTCC16);                            1503
         LR    @15,@03                                             1503
         L     @14,@SA00013                                        1503
         LM    @00,@12,@SA00013+8                                  1503
         BR    @14                                                 1503
*              ELSE                                                1504
*                RETURN CODE(LASTCC08);                            1504
@RF01502 LA    @15,8                                               1504
         L     @14,@SA00013                                        1504
         LM    @00,@12,@SA00013+8                                  1504
         BR    @14                                                 1504
*          ELSE;                                                   1505
@RF01501 DS    0H                                                  1506
*        /************************************************************/
*        /*                                                          */
*        /*  TEST TO DETERMINE IF THERE ARE NON VSAM                 */
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING                */
*        /*  LOCATES FOR THE ASSOCIATIONS, AND WRITING OUT THE       */
*        /*  CATALOG INFORMATION TO THE PORTABILITY                  */
*        /*  DATA SET.                                               */
*        /*                                                          */
*        /************************************************************/
*        IF ASSOCFLG = ON                                          1506
*          THEN                                                    1506
         TM    ASSOCFLG,B'00000001'                                1506
         BNO   @RF01506                                            1506
*            DO;                                                   1507
*                                                                  1507
*            /********************************************************/
*            /*                                                      */
*            /*  CALL ASOCPROC TO PROCESS THE ASSOCIATIONS.          */
*            /*  ASOCPROC WILL WRITE THE CONTROL RECORDS FOR NON VSAM*/
*            /*  GENERATION DATA SETS AND THEIR ASSOCIATIONS.        */
*            /*                                                      */
*            /********************************************************/
*                                                                  1508
*                                                                  1508
*            CALL  ASOCPROC(FNMPTR,NUMASSOC);                      1508
*                                                                  1508
         LA    @15,FNMPTR                                          1508
         ST    @15,@AL00001                                        1508
         LA    @15,NUMASSOC                                        1508
         ST    @15,@AL00001+4                                      1508
         LA    @01,@AL00001                                        1508
         BAL   @14,ASOCPROC                                        1508
*            RESPECIFY RTNREG RSTD;                                1509
*            TESTRC = RTNREG;                                      1510
         LR    TESTRC,RTNREG                                       1510
*            RESPECIFY RTNREG UNRSTD;                              1511
*            /********************************************************/
*            /*                                                      */
*            /* CHECK RETURN FROM ASOCPROC, IF RETURN CODE OF 12     */
*            /* TERMINATE THIS REQUEST- NO CORE AVAILABLE.           */
*            /* IF A NON VSAM ASSOCIATION OR ALIAS COULD NOT BE      */
*            /* PROCESSED THEN A MESSAGE HAS BEEN PRINTED TO         */
*            /* INDICATE THE FAILURE                                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  1512
*                                                                  1512
*            IF TESTRC = LASTCC16                                  1512
*              THEN                                                1512
         LA    @03,16                                              1512
         CR    TESTRC,@03                                          1512
         BNE   @RF01512                                            1512
*                RETURN CODE(LASTCC16);                            1513
         LR    @15,@03                                             1513
         L     @14,@SA00013                                        1513
         LM    @00,@12,@SA00013+8                                  1513
         BR    @14                                                 1513
*            END;                                                  1514
*          ELSE;                                                   1515
*                                                                  1515
@RF01506 DS    0H                                                  1516
*        /************************************************************/
*        /*                                                          */
*        /*CALL SAVEPROC TO WRITE THE CONTROL AND CATALOG RECORDS    */
*        /*FOR THIS GENERATION DATA GROUP TO THE PORTABILITY DATA SET*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1516
*        CALL  SAVEPROC(NULLPARM,NULLPARM,'W');                    1516
*                                                                  1516
@RC01506 LA    @01,@AL01516                                        1516
         BAL   @14,SAVEPROC                                        1516
*        RESPECIFY RTNREG RSTD;                                    1517
*        TESTRC = RTNREG;                                          1518
         LR    TESTRC,RTNREG                                       1518
*        RESPECIFY RTNREG UNRSTD;                                  1519
*        IF TESTRC ^= 0                                            1520
*          THEN                                                    1520
         LTR   TESTRC,TESTRC                                       1520
         BZ    @RF01520                                            1520
*            RETURN CODE(LASTCC16);                                1521
*                                                                  1521
*                                                                  1521
         LA    @15,16                                              1521
         L     @14,@SA00013                                        1521
         LM    @00,@12,@SA00013+8                                  1521
         BR    @14                                                 1521
*        /************************************************************/
*        /*                                                          */
*        /*CALL PUTPROC TO WRITE THE SOFTWARE END OF FILE TO THE     */
*        /* PORTABILITY DATA SET                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1522
*        CALL  PUTPROC(NULLPARM,NULLPARM);                         1522
*                                                                  1522
@RF01520 LA    @01,@AL01522                                        1522
         BAL   @14,PUTPROC                                         1522
*        RESPECIFY RTNREG RSTD;                                    1523
*        TESTRC = RTNREG;                                          1524
         LR    TESTRC,RTNREG                                       1524
*        RESPECIFY RTNREG UNRSTD;                                  1525
*        IF TESTRC ^= 0                                            1526
*          THEN                                                    1526
         LTR   TESTRC,TESTRC                                       1526
         BZ    @RF01526                                            1526
*            RETURN CODE(LASTCC16);                                1527
*                                                                  1527
*                                                                  1527
         LA    @15,16                                              1527
         L     @14,@SA00013                                        1527
         LM    @00,@12,@SA00013+8                                  1527
         BR    @14                                                 1527
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*   IF PROCESSING FOR ASSOCIATIONS AND ALIAS'S INCOMPLETE  */
*        /*   THEN ERROR FLAG HAS BEEN SET                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1528
*        RETURN CODE(0);                                           1528
*                                                                  1528
@RF01526 SLR   @15,@15                                             1528
         L     @14,@SA00013                                        1528
         LM    @00,@12,@SA00013+8                                  1528
         BR    @14                                                 1528
*END  GDGPROC;                                                     1529
*                                                                  1530
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - ASOCPROC                               */
*        /*                                                          */
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */
*        /*  THE OBJECT BEING EXPORTED AND ANY ALIAS'S DEFINED       */
*        /*  OVER IT.  BUILDS CONTROL  RECORDS, AND                  */
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */
*        /*  PROCEDURES TO WRITE THE CATALOG RECORDS OF THE DATA     */
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA              */
*        /*  SET.                                                    */
*        /*                                                          */
*        /*  INPUT - POINTER TO NAMEDS FPL FOR ASSOCIATIONS AND      */
*        /*          THE NUMBER OF ASSOCIATIONS TO PROCESS.          */
*        /*                                                          */
*        /*  OUTPUT - CATALOG INFORMATION FOR GENERATION DATA SETS   */
*        /*           AND THEIR ALIAS'S WRITTEN TO THE PORTABILITY   */
*        /*           DATA SET.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1530
*ASOCPROC: PROCEDURE(PFLNMDS,          /* NAMEDS FIELD POINTER       */
*                    NUMASOC);         /* NUMBER OF FIELDS IN NAMEDS */
*                                                                  1530
ASOCPROC STM   @14,@12,@SA00014                                    1530
         MVC   @PC00014(8),0(@01)                                  1530
*        /************************************************************/
*        /*                                                          */
*        /*    ARGUMENTS OF INVOCATION                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1531
*                                                                  1531
*        DCL PFLNMDS PTR(31);          /* NAMEDS REPEATING FIELD     */
*                                                                  1531
*                                                                  1531
*        DCL NUMASOC FIXED(15);        /* NUMBER OF ASSOCIATIONS     */
*                                      /* IN NAMEDS FIELD            */
*        /* ASSOCIATION FIELD RETURNED BY CATALOG                    */
*        DCL 1  ANAMEDS  CHAR(4)  BDY(WORD)  BASED(PFLNMDS), /*      */
*                                      /*  NAMEDS STRUCTURE          */
*               2 ATYPE  CHAR(1),      /* ENTRY TYPE                 */
*               2 ANAME  CHAR(3);      /* ENTRY NAME                 */
*                                                                  1533
*                                                                  1533
*        OLDERID2 = NEWERID2;                                      1534
         L     @15,@PC00001                                        1534
         L     @14,GDTTR2(,@15)                                    1534
         MVC   @TS00001(95),NEWERID2(@14)                          1534
         MVC   OLDERID2(95,@14),@TS00001                           1534
*        NEWID2 = 'RC39';                                          1535
*                                                                  1535
         MVC   NEWID2(4,@14),@CC01261                              1535
*          IF GDTDBG = NULLPTR                                     1536
*            THEN;                                                 1536
         L     @15,GDTDBG(,@15)                                    1536
         LTR   @15,@15                                             1536
         BZ    @RT01536                                            1536
*            ELSE                                                  1538
*              CALL IDCDB010 (GDTTBL,'RC40');                      1538
*                                                                  1538
*                                                                  1538
         L     @15,@PC00001                                        1538
         ST    @15,@AL00001                                        1538
         LA    @14,@CC01262                                        1538
         ST    @14,@AL00001+4                                      1538
         MVI   @AL00001+4,X'80'                                    1538
         L     @15,GDTDBG(,@15)                                    1538
         LA    @01,@AL00001                                        1538
         BALR  @14,@15                                             1538
*          /**********************************************************/
*          /*                                                        */
*          /* SET FLAG TO INDICATE PROCESSING FIRST ASSOCIATION      */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1539
*          FRSTASOC = ON;                                          1539
*                                                                  1539
@RT01536 OI    FRSTASOC,B'10000000'                                1539
*          /**********************************************************/
*          /*                                                        */
*          /* LOOP ON NUMBER OF ASSOCIATIONS TO PROCESS              */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1540
*ASOCLP:   DO I = 1 TO NUMASOC;                                    1540
*                                                                  1540
ASOCLP   LA    I,1                                                 1540
         B     @DE01540                                            1540
@DL01540 DS    0H                                                  1541
*            /********************************************************/
*            /*                                                      */
*            /* SET NUMBER OF FIELDS FOR CATALOG LOCATE              */
*            /*                                                      */
*            /********************************************************/
*                                                                  1541
*            CNUM = ( DIM (NVSMFLST) -1 );                         1541
         MVI   CNUM,X'09'                                          1541
*            ONUM = ( DIM (NVSMFLST) -2 );                         1542
*                                                                  1542
         MVI   ONUM,X'08'                                          1542
*            NUMALS = 0;               /* RESET NUMBER OF ALIAS'S    */
*                                                                  1543
         SLR   NUMALS,NUMALS                                       1543
*            /********************************************************/
*            /*                                                      */
*            /*    TEST TO DETERMINE IF THE ASSOCIATED               */
*            /*    OBJECT IS A GENERATION DATA SET.                  */
*            /*                                                      */
*            /********************************************************/
*                                                                  1544
*            IF ATYPE = CTGTALIN                                   1544
*              THEN                                                1544
         L     @15,@PC00014                                        1544
         L     @01,PFLNMDS(,@15)                                   1544
         CLI   ATYPE(@01),C'A'                                     1544
         BNE   @RF01544                                            1544
*ASOCREC:        DO;                                               1545
ASOCREC  DS    0H                                                  1546
*                IF FRSTASOC = ON                                  1546
*                  THEN                                            1546
         TM    FRSTASOC,B'10000000'                                1546
         BNO   @RF01546                                            1546
*FRSTASC:            DO;                                           1547
*                                                                  1547
FRSTASC  DS    0H                                                  1548
*                    FRSTASOC = OFF;                               1548
*                                                                  1548
         NI    FRSTASOC,B'01111111'                                1548
*                    /************************************************/
*                    /*                                              */
*                    /*  IF THIS IS THE FIRST ASSOCIATION TO BE      */
*                    /*  PROCESSED CALL LOCPROC TO BUILD             */
*                    /*  THE CPL AND FPL'S.                          */
*                    /*                                              */
*                    /************************************************/
*                                                                  1549
*                    CALL LOCPROC(ANAME,PTRCTACB,                  1549
*                       NVSMFLST,CNUM,PTRCPL(ASCCPLNO));           1549
*                                                                  1549
         L     @15,@PC00014                                        1549
         L     @01,PFLNMDS(,@15)                                   1549
         LA    @15,ANAME(,@01)                                     1549
         ST    @15,@AL00001                                        1549
         LA    @15,PTRCTACB                                        1549
         ST    @15,@AL00001+4                                      1549
         LA    @15,NVSMFLST                                        1549
         ST    @15,@AL00001+8                                      1549
         LA    @15,CNUM                                            1549
         ST    @15,@AL00001+12                                     1549
         LA    @15,PTRCPL+4                                        1549
         ST    @15,@AL00001+16                                     1549
         LA    @01,@AL00001                                        1549
         BAL   @14,LOCPROC                                         1549
*                    RESPECIFY RTNREG RSTD;                        1550
*                    TESTRC = RTNREG;                              1551
         LR    TESTRC,RTNREG                                       1551
*                    RESPECIFY RTNREG UNRSTD;                      1552
*                                                                  1552
*                    IF TESTRC ^= 0                                1553
*                      THEN                                        1553
         LTR   TESTRC,TESTRC                                       1553
         BZ    @RF01553                                            1553
*                        RETURN CODE(LASTCC16);                    1554
*                                                                  1554
         LA    @15,16                                              1554
         L     @14,@SA00014                                        1554
         LM    @00,@12,@SA00014+8                                  1554
         BR    @14                                                 1554
*                    /************************************************/
*                    /*                                              */
*                    /*  SAVE THE CPL AND FPL'S JUST                 */
*                    /*  CONSTRUCTED FOR USE WITH OTHER              */
*                    /*  ASSOCIATIONS                                */
*                    /*                                              */
*                    /************************************************/
*                                                                  1555
*                    SAPLASC = LENGTH(SAVEPL2);                    1555
*                                                                  1555
@RF01553 MVC   SAPLASC(2),@CH01287                                 1555
*                    CALL MVDAPROC(SAPLASC,PTRCPL(ASCCPLNO),       1556
*                      ADDR(SAVEPL2),NULLPARM);                    1556
*                                                                  1556
         LA    @15,SAPLASC                                         1556
         ST    @15,@AL00001                                        1556
         LA    @15,PTRCPL+4                                        1556
         ST    @15,@AL00001+4                                      1556
         LA    @15,SAVEPL2                                         1556
         ST    @15,@AFTEMPS+12                                     1556
         LA    @15,@AFTEMPS+12                                     1556
         ST    @15,@AL00001+8                                      1556
         LA    @15,NULLPARM                                        1556
         ST    @15,@AL00001+12                                     1556
         LA    @01,@AL00001                                        1556
         BAL   @14,MVDAPROC                                        1556
*                    /************************************************/
*                    /*                                              */
*                    /*  CALL CTLGPROC TO ISSUE A UCATLG             */
*                    /*  TO DO THE ACTUAL LOCATE.                    */
*                    /*                                              */
*                    /************************************************/
*                                                                  1557
*                    CALL CTLGPROC(PTRCPL(ASCCPLNO));              1557
*                                                                  1557
         LA    @15,PTRCPL+4                                        1557
         ST    @15,@AL00001                                        1557
         LA    @01,@AL00001                                        1557
         BAL   @14,CTLGPROC                                        1557
*                    RESPECIFY RTNREG RSTD;                        1558
*                    TESTRC = RTNREG;                              1559
         LR    TESTRC,RTNREG                                       1559
*                    RESPECIFY RTNREG UNRSTD;                      1560
*                                                                  1560
*                    IF TESTRC ^= 0                                1561
*                      THEN                                        1561
         LTR   TESTRC,TESTRC                                       1561
         BZ    @RF01561                                            1561
*                        DO;                                       1562
*                        /********************************************/
*                        /*                                          */
*                        /* IF SEVERE ERROR RETURNS WITH TERMINATION */
*                        /* CODE ELSE THIS ASSOCIATION IS BYPASSED   */
*                        /* AND PROCESSING CONTINUES AFTER PRINTING  */
*                        /* WARNING MESSAGE AND SETTING ERROR FLAG   */
*                        /*                                          */
*                        /********************************************/
*                        IF TESTRC = LASTCC16                      1563
*                          THEN                                    1563
         LA    @04,16                                              1563
         CR    TESTRC,@04                                          1563
         BNE   @RF01563                                            1563
*                            RETURN CODE(LASTCC16);                1564
         LR    @15,@04                                             1564
         L     @14,@SA00014                                        1564
         LM    @00,@12,@SA00014+8                                  1564
         BR    @14                                                 1564
*                          ELSE                                    1565
*                            DO;                                   1565
@RF01563 DS    0H                                                  1566
*                            ERRSAVFL = ON;                        1566
*                                                                  1566
         OI    ERRSAVFL,B'00100000'                                1566
*                            CALL  PRNTPROC(WARNMSG1,GDGCPLMG);    1567
*                                                                  1567
         LA    @01,@AL01567                                        1567
         BAL   @14,PRNTPROC                                        1567
*                            END;                                  1568
*                        END;                                      1569
*                                                                  1569
*                                                                  1569
*                                                                  1569
*                      ELSE                                        1570
*WRITEFST:               DO;                                       1570
         B     @RC01561                                            1570
@RF01561 DS    0H                                                  1570
WRITEFST DS    0H                                                  1571
*                        /********************************************/
*                        /*                                          */
*                        /* CHECK FOR ALIAS'S FOR THIS GENERATION    */
*                        /* DATA SET. IF ANY, SET POINTER TO NAMEDS  */
*                        /* FPL AND NUMBER OF ALIAS'S TO PROCESS.    */
*                        /*                                          */
*                        /********************************************/
*                                                                  1571
*                        CTGFLPTR = CTGFIELD(NNAMEDS);             1571
         L     @01,CTGPLPTR                                        1571
         L     CTGFLPTR,CTGFIELD+32(,@01)                          1571
*                        IF CTGFLNG(1) = 0                         1572
*                          THEN                                    1572
         L     @03,CTGFLNG(,CTGFLPTR)                              1572
         LTR   @03,@03                                             1572
         BNZ   @RF01572                                            1572
*                            DO;                                   1573
*                            /****************************************/
*                            /*                                      */
*                            /* ERROR -- NO ASSOCIATION TO GDG       */
*                            /*                                      */
*                            /****************************************/
*                                                                  1574
*                            ERRSAVFL = ON;                        1574
*                                                                  1574
         OI    ERRSAVFL,B'00100000'                                1574
*                            CALL  PRNTPROC(WARNMSG2,GDGCPLMG);    1575
*                                                                  1575
         LA    @01,@AL01575                                        1575
         BAL   @14,PRNTPROC                                        1575
*                            END;                                  1576
*                                                                  1576
*                          ELSE                                    1577
*                            DO;                                   1577
         B     @RC01572                                            1577
@RF01572 DS    0H                                                  1578
*                            NUMALS = CTGFLNG(1) / LNAMEDS;        1578
         L     @00,CTGFLNG(,CTGFLPTR)                              1578
         SRDA  @00,32                                              1578
         D     @00,@CF00041                                        1578
         LR    NUMALS,@01                                          1578
*                            AFNMPTR = CTGFLPT(1);                 1579
         L     @03,CTGFLPT(,CTGFLPTR)                              1579
         ST    @03,AFNMPTR                                         1579
*                            /****************************************/
*                            /*                                      */
*                            /* CALL CONTRBL TO BUILD THE CONTROL    */
*                            /* RECORD FOR THE CURRENT ASSOCIATION   */
*                            /* AND TO WRITE IT AND THE CATALOG WORK */
*                            /* AREA TO THE PORTABILITY DATA SET.    */
*                            /*                                      */
*                            /****************************************/
*                                                                  1580
*                            CALL CONTRBL(ASCCPLNO,'N');           1580
*                                                                  1580
         LA    @01,@AL01580                                        1580
         BAL   @14,CONTRBL                                         1580
*                            RESPECIFY RTNREG RSTD;                1581
*                            TESTRC = RTNREG;                      1582
         LR    TESTRC,RTNREG                                       1582
*                            RESPECIFY RTNREG UNRSTD;              1583
*                                                                  1583
*                            IF TESTRC ^= 0                        1584
*                              THEN                                1584
         LTR   TESTRC,TESTRC                                       1584
         BZ    @RF01584                                            1584
*                                DO;                               1585
*                                /************************************/
*                                /*                                  */
*                                /* IF SEVERE ERROR RETURNS WITH     */
*                                /* TERMINATION CODE ELSE BYPASSES   */
*                                /* THIS ASSOCIATION AND PRINTS      */
*                                /* WARNING MESSAGE.                 */
*                                /*                                  */
*                                /************************************/
*                                                                  1586
*                                IF TESTRC = LASTCC16              1586
*                                  THEN                            1586
         LA    @04,16                                              1586
         CR    TESTRC,@04                                          1586
         BNE   @RF01586                                            1586
*                                    RETURN CODE(LASTCC16);        1587
         LR    @15,@04                                             1587
         L     @14,@SA00014                                        1587
         LM    @00,@12,@SA00014+8                                  1587
         BR    @14                                                 1587
*                                  ELSE                            1588
*                                    DO;                           1588
*                                                                  1588
@RF01586 DS    0H                                                  1589
*                                    ERRSAVFL = ON;                1589
*                                                                  1589
         OI    ERRSAVFL,B'00100000'                                1589
*                                    CALL  PRNTPROC(WARNMSG1,GDGCPLMG);
*                                                                  1590
         LA    @01,@AL01590                                        1590
         BAL   @14,PRNTPROC                                        1590
*                                    END;                          1591
*                                END;                              1592
*                            END;                                  1593
*                        END WRITEFST;                             1594
*                    END FRSTASC;                                  1595
*                  ELSE                                            1596
*NFRSTASC:           DO;                                           1596
         B     @RC01546                                            1596
@RF01546 DS    0H                                                  1596
NFRSTASC DS    0H                                                  1597
*                    /************************************************/
*                    /*                                              */
*                    /*THIS IS NOT THE FIRST ASSOCIATION TO BE       */
*                    /*PROCESSED RESTORE THE CPL AND FPL'S MODIFY    */
*                    /*THE CPL TO DO A LOCATE ON THE APPROPRIATE     */
*                    /*ASSOCIATION                                   */
*                    /*                                              */
*                    /************************************************/
*                                                                  1597
*                    CTGPLPTR = PTRCPL(ASCCPLNO);                  1597
*                                                                  1597
         L     @15,PTRCPL+4                                        1597
         ST    @15,CTGPLPTR                                        1597
*                    CALL MVDAPROC(SAPLASC,ADDR(SAVEPL2),          1598
*                      PTRCPL(ASCCPLNO),NULLPARM);                 1598
*                                                                  1598
         LA    @15,SAPLASC                                         1598
         ST    @15,@AL00001                                        1598
         LA    @15,SAVEPL2                                         1598
         ST    @15,@AFTEMPS+12                                     1598
         LA    @15,@AFTEMPS+12                                     1598
         ST    @15,@AL00001+4                                      1598
         LA    @15,PTRCPL+4                                        1598
         ST    @15,@AL00001+8                                      1598
         LA    @15,NULLPARM                                        1598
         ST    @15,@AL00001+12                                     1598
         LA    @01,@AL00001                                        1598
         BAL   @14,MVDAPROC                                        1598
*                    CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),       1599
*                      NULLPARM,CTGWKA,SETZERO);                   1599
*                                                                  1599
         MVC   @AL00001(16),@AL01599                               1599
         L     @01,CTGPLPTR                                        1599
         LA    @15,CTGWKA(,@01)                                    1599
         ST    @15,@AL00001+8                                      1599
         LA    @01,@AL00001                                        1599
         BAL   @14,MVDAPROC                                        1599
*                    AREALN = WKAREALN;                            1600
         L     @15,CTGPLPTR                                        1600
         L     @01,CTGWKA(,@15)                                    1600
         MVC   AREALN(2,@01),@CH00812                              1600
*                    CTGENT = ADDR(ANAME);                         1601
*                                                                  1601
         L     @14,@PC00014                                        1601
         L     @01,PFLNMDS(,@14)                                   1601
         LA    @14,ANAME(,@01)                                     1601
         ST    @14,CTGENT(,@15)                                    1601
*                    /************************************************/
*                    /*                                              */
*                    /*CLEAR THE FPL POINTERS SET BY PREVIOUS LOCATE */
*                    /*                                              */
*                    /************************************************/
*                                                                  1602
*                    DO CLRFDCTR = 1 TO CNUM;                      1602
         LA    CLRFDCTR,1                                          1602
         B     @DE01602                                            1602
@DL01602 DS    0H                                                  1603
*                      CTGFLPTR = CTGFIELD(CLRFDCTR);              1603
         LR    @15,CLRFDCTR                                        1603
         SLA   @15,2                                               1603
         L     @01,CTGPLPTR                                        1603
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        1603
*                      CTGFLNG(1) = 0;                             1604
         SLR   @15,@15                                             1604
         ST    @15,CTGFLNG(,CTGFLPTR)                              1604
*                      CTGFLPT(1) = NULLPTR;                       1605
         ST    @15,CTGFLPT(,CTGFLPTR)                              1605
*                    END;                                          1606
*                                                                  1606
         AL    CLRFDCTR,@CF00218                                   1606
@DE01602 SLR   @02,@02                                             1606
         IC    @02,CNUM                                            1606
         CR    CLRFDCTR,@02                                        1606
         BNH   @DL01602                                            1606
*                    /************************************************/
*                    /*                                              */
*                    /* CALL CTLGPROC TO ISSUE A UCATLG TO DO LOCATE */
*                    /*                                              */
*                    /************************************************/
*                                                                  1607
*                    CALL CTLGPROC(PTRCPL(ASCCPLNO));              1607
*                                                                  1607
         LA    @15,PTRCPL+4                                        1607
         ST    @15,@AL00001                                        1607
         LA    @01,@AL00001                                        1607
         BAL   @14,CTLGPROC                                        1607
*                    RESPECIFY RTNREG RSTD;                        1608
*                    TESTRC = RTNREG;                              1609
         LR    TESTRC,RTNREG                                       1609
*                    RESPECIFY RTNREG UNRSTD;                      1610
*                                                                  1610
*                    IF TESTRC ^= 0                                1611
*                      THEN                                        1611
         LTR   TESTRC,TESTRC                                       1611
         BZ    @RF01611                                            1611
*                        DO;                                       1612
*                        /********************************************/
*                        /*                                          */
*                        /*IF SEVERE ERROR RETURNS WITH TERMINATION  */
*                        /*ELSE BYPASSES THIS ASSOCIATION AND PRINTS */
*                        /*MESSAGE TO INDICATE THE ERROR             */
*                        /*                                          */
*                        /********************************************/
*                        IF TESTRC = LASTCC16                      1613
*                          THEN                                    1613
         LA    @04,16                                              1613
         CR    TESTRC,@04                                          1613
         BNE   @RF01613                                            1613
*                            RETURN CODE(LASTCC16);                1614
         LR    @15,@04                                             1614
         L     @14,@SA00014                                        1614
         LM    @00,@12,@SA00014+8                                  1614
         BR    @14                                                 1614
*                          ELSE                                    1615
*                            DO;                                   1615
@RF01613 DS    0H                                                  1616
*                            ERRSAVFL = ON;                        1616
*                                                                  1616
         OI    ERRSAVFL,B'00100000'                                1616
*                            CALL  PRNTPROC(WARNMSG1,GDGCPLMG);    1617
*                                                                  1617
         LA    @01,@AL01617                                        1617
         BAL   @14,PRNTPROC                                        1617
*                            END;                                  1618
*                        END;                                      1619
*                      ELSE                                        1620
*WRITEOTH:               DO;                                       1620
         B     @RC01611                                            1620
@RF01611 DS    0H                                                  1620
WRITEOTH DS    0H                                                  1621
*                        /********************************************/
*                        /*                                          */
*                        /*  CHECK FOR ALIAS'S FOR THIS GENERATION   */
*                        /*  DATA SET. IF ANY, SET POINTER TO        */
*                        /*  NAMEDS FPL AND NUMBER OF ALIAS'S        */
*                        /*                                          */
*                        /********************************************/
*                                                                  1621
*                        CTGFLPTR = CTGFIELD(NNAMEDS);             1621
         L     @01,CTGPLPTR                                        1621
         L     CTGFLPTR,CTGFIELD+32(,@01)                          1621
*                        IF CTGFLNG(1) = 0                         1622
*                        THEN                                      1622
         L     @03,CTGFLNG(,CTGFLPTR)                              1622
         LTR   @03,@03                                             1622
         BNZ   @RF01622                                            1622
*                          DO;                                     1623
*                          /******************************************/
*                          /*                                        */
*                          /* ERROR  -- NO ASSOCIATION TO GDG        */
*                          /*                                        */
*                          /******************************************/
*                                                                  1624
*                          ERRSAVFL = ON;                          1624
*                                                                  1624
         OI    ERRSAVFL,B'00100000'                                1624
*                          CALL  PRNTPROC(WARNMSG2,GDGCPLMG);      1625
*                                                                  1625
         LA    @01,@AL01625                                        1625
         BAL   @14,PRNTPROC                                        1625
*                          END;                                    1626
*                                                                  1626
*                        ELSE                                      1627
*                          DO;                                     1627
*                                                                  1627
         B     @RC01622                                            1627
@RF01622 DS    0H                                                  1628
*                          NUMALS = CTGFLNG(1) / LNAMEDS;          1628
         L     @00,CTGFLNG(,CTGFLPTR)                              1628
         SRDA  @00,32                                              1628
         D     @00,@CF00041                                        1628
         LR    NUMALS,@01                                          1628
*                          AFNMPTR = CTGFLPT(1);                   1629
*                                                                  1629
         L     @03,CTGFLPT(,CTGFLPTR)                              1629
         ST    @03,AFNMPTR                                         1629
*                          /******************************************/
*                          /*                                        */
*                          /*CALL CONTRBL TO BUILD THE CONTROL       */
*                          /*RECORD FOR THE CURRENT ASSOCIATION AND  */
*                          /*TO WRITE IT AND THE CATALOG WORK        */
*                          /*AREA TO THE PORTABILITY DATA SET        */
*                          /*                                        */
*                          /******************************************/
*                                                                  1630
*                          CALL CONTRBL(ASCCPLNO,'N');             1630
*                                                                  1630
         LA    @01,@AL01630                                        1630
         BAL   @14,CONTRBL                                         1630
*                          RESPECIFY RTNREG RSTD;                  1631
*                          TESTRC = RTNREG;                        1632
         LR    TESTRC,RTNREG                                       1632
*                          RESPECIFY RTNREG UNRSTD;                1633
*                                                                  1633
*                          IF TESTRC ^= 0                          1634
*                            THEN                                  1634
         LTR   TESTRC,TESTRC                                       1634
         BZ    @RF01634                                            1634
*                              DO;                                 1635
*                              /**************************************/
*                              /*                                    */
*                              /* IF SEVERE ERROR RETURNS WITH       */
*                              /* TERMINATION CODE ELSE BYPASSES     */
*                              /* THIS ASSOCIATION AND PRINTS WARNING*/
*                              /* MESSAGE.                           */
*                              /*                                    */
*                              /**************************************/
*                              IF TESTRC = LASTCC16                1636
*                                THEN                              1636
         LA    @04,16                                              1636
         CR    TESTRC,@04                                          1636
         BNE   @RF01636                                            1636
*                                  RETURN CODE(LASTCC16);          1637
         LR    @15,@04                                             1637
         L     @14,@SA00014                                        1637
         LM    @00,@12,@SA00014+8                                  1637
         BR    @14                                                 1637
*                                ELSE                              1638
*                                  DO;                             1638
@RF01636 DS    0H                                                  1639
*                                  ERRSAVFL = ON;                  1639
*                                                                  1639
         OI    ERRSAVFL,B'00100000'                                1639
*                                  CALL  PRNTPROC(WARNMSG1,GDGCPLMG);
*                                                                  1640
         LA    @01,@AL01640                                        1640
         BAL   @14,PRNTPROC                                        1640
*                                  END;                            1641
*                              END;                                1642
*                          END;                                    1643
@RF01634 DS    0H                                                  1644
*                        END  WRITEOTH;                            1644
@RC01622 DS    0H                                                  1645
*                    END  NFRSTASC;                                1645
@RC01611 DS    0H                                                  1646
*                /****************************************************/
*                /*                                                  */
*                /* CHECK IF ALIAS ASSOCIATIONS FOR THIS NON VSAM    */
*                /*                                                  */
*                /****************************************************/
*                                                                  1646
*                IF NUMALS > MINASOC                               1646
*                 THEN                                             1646
@RC01546 C     NUMALS,@CF00218                                     1646
         BNH   @RF01646                                            1646
*                   DO;                                            1647
*                   /*************************************************/
*                   /*                                               */
*                   /* CALL ALSPROC TO PROCESS THE ALIAS'S           */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1648
*                   CALL  ALSPROC(AFNMPTR);                        1648
*                                                                  1648
         LA    @05,AFNMPTR                                         1648
         ST    @05,@AL00001                                        1648
         LA    @01,@AL00001                                        1648
         BAL   @14,ALSPROC                                         1648
*                   RESPECIFY RTNREG RSTD;                         1649
*                   TESTRC = RTNREG;                               1650
         LR    TESTRC,RTNREG                                       1650
*                   RESPECIFY RTNREG UNRSTD;                       1651
*                                                                  1651
*                   /*************************************************/
*                   /*                                               */
*                   /* CHECK RETURN CODE FROM ALSPROC                */
*                   /* IF RETURN CODE IS TWELVE THEN TERMINATE       */
*                   /*  THIS REQUEST -- CORE FAILURE                 */
*                   /* IF ALIAS NOT PROCESSED THEN A FLAG HAS BEEN   */
*                   /* SET                                           */
*                   /*************************************************/
*                                                                  1652
*                   IF TESTRC = LASTCC16                           1652
*                     THEN                                         1652
         LA    @05,16                                              1652
         CR    TESTRC,@05                                          1652
         BNE   @RF01652                                            1652
*                       RETURN CODE(LASTCC16);                     1653
         LR    @15,@05                                             1653
         L     @14,@SA00014                                        1653
         LM    @00,@12,@SA00014+8                                  1653
         BR    @14                                                 1653
*                   END;                                           1654
*                                                                  1654
*                                                                  1654
*                END  ASOCREC;                                     1655
*              ELSE                                                1656
*                DO;                                               1656
         B     @RC01544                                            1656
@RF01544 DS    0H                                                  1657
*                /****************************************************/
*                /*                                                  */
*                /* ASSOCIATION TYPE NOT GENERATION DATA SET         */
*                /*                                                  */
*                /****************************************************/
*                                                                  1657
*                ERRSAVFL = ON;                                    1657
*                                                                  1657
         OI    ERRSAVFL,B'00100000'                                1657
*                CALL  PRNTPROC(WARNMSG2,GDGCPLMG);                1658
*                                                                  1658
         LA    @01,@AL01658                                        1658
         BAL   @14,PRNTPROC                                        1658
*                END;                                              1659
*                                                                  1659
*          /**********************************************************/
*          /*                                                        */
*          /* SET NAMEDS POINTER TO NEXT ASSOCIATION                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1660
*          PFLNMDS = PFLNMDS + LNAMEDS;                            1660
*                                                                  1660
@RC01544 L     @05,@PC00014                                        1660
         LA    @15,4                                               1660
         AL    @15,PFLNMDS(,@05)                                   1660
         ST    @15,PFLNMDS(,@05)                                   1660
*          END  ASOCLP;                                            1661
*                                                                  1661
*                                                                  1661
         AL    I,@CF00218                                          1661
@DE01540 L     @05,@PC00014+4                                      1661
         CH    I,NUMASOC(,@05)                                     1661
         BNH   @DL01540                                            1661
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO CALLER WITH SUCCESS INDICATED                  */
*        /* IF ANY ASSOCIATION OR ALIAS FAILURE THEN A FLAG HAS BEEN */
*        /* SET AND A WARNING MESSAGE PRINTED                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1662
*        RETURN CODE(0);                                           1662
*                                                                  1662
         SLR   @15,@15                                             1662
         L     @14,@SA00014                                        1662
         LM    @00,@12,@SA00014+8                                  1662
         BR    @14                                                 1662
*END ASOCPROC;                                                     1663
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - PRNTPROC                               */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE PRINTS WARNING MESSAGES       */
*        /*             WHENEVER AN ERROR IS DETECTED WHILE          */
*        /*             PROCESSING PATHS, ALIAS'S, AND ASSOCIATIONS  */
*        /*             FOR GDG'S.                                   */
*        /*                                                          */
*        /*  INPUT - TYPE OF MESSAGE TO PRINT                        */
*        /*          INDEX TO CPL                                    */
*        /*                                                          */
*        /*  OUTPUT - WARNING MESSAGE INDICATING THE ERROR           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1664
*PRNTPROC: PROCEDURE(PRNTMSG,          /*  MESSAGE TYPE              */
*                    ICPL);            /*  INDEX TO CPL              */
*                                                                  1664
PRNTPROC STM   @14,@03,@SA00015                                    1664
         STM   @05,@12,@SA00015+24                                 1664
         MVC   @PC00015(8),0(@01)                                  1664
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1665
*        DCL PRNTMSG FIXED(8);         /* MESSAGE TO PRINT           */
*        DCL ICPL    FIXED(8);         /* CPL FOR NAME OF OBJECT     */
*                                                                  1666
*        OLDERID2 = NEWERID2;                                      1667
         L     @03,@PC00001                                        1667
         L     @03,GDTTR2(,@03)                                    1667
         MVC   @TS00001(95),NEWERID2(@03)                          1667
         MVC   OLDERID2(95,@03),@TS00001                           1667
*        NEWID2 = 'RC42';                                          1668
*                                                                  1668
*                                                                  1668
         MVC   NEWID2(4,@03),@CC01282                              1668
*        /************************************************************/
*        /*                                                          */
*        /*  GET NAME OF RELATED OBJECT TO PRINT.                    */
*        /*  IF PATH OR GDS THEN THE NAME OF RELATED OBJECT          */
*        /*   IS OBTAINED USING THE FIRST CPL                        */
*        /*  IF ALIAS FOR NON VSAM THEN THE SECOND CPL IS USED       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1669
*        CTGPLPTR = PTRCPL(ICPL);                                  1669
         L     @03,@PC00015+4                                      1669
         SLR   @15,@15                                             1669
         IC    @15,ICPL(,@03)                                      1669
         SLA   @15,2                                               1669
         L     @03,PTRCPL-4(@15)                                   1669
         ST    @03,CTGPLPTR                                        1669
*        CTGFLPTR = CTGFIELD(IENTNAME);                            1670
         L     CTGFLPTR,CTGFIELD+4(,@03)                           1670
*        RELNAME = FENTNAME;                                       1671
*                                                                  1671
         L     @03,CTGFLPT(,CTGFLPTR)                              1671
         MVC   RELNAME(44),FENTNAME(@03)                           1671
*        /************************************************************/
*        /*                                                          */
*        /*    SET UP UPRINT ARGUMENTS AND PRINT WARNING MESSAGE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1672
*        IF PRNTMSG = WARNMSG1                                     1672
*          THEN                                                    1672
         L     @15,@PC00015                                        1672
         CLI   PRNTMSG(@15),0                                      1672
         BNE   @RF01672                                            1672
*            DARGSENT = ASOCERR;                                   1673
         L     @01,DDSTRU                                          1673
         MVI   DARGSENT(@01),X'08'                                 1673
*          ELSE                                                    1674
*            DARGSENT = NONASOC;                                   1674
*                                                                  1674
*                                                                  1674
         B     @RC01672                                            1674
@RF01672 L     @01,DDSTRU                                          1674
         MVI   DARGSENT(@01),X'09'                                 1674
*        DARGSMOD = EXPMSG;                                        1675
@RC01672 L     @15,DDSTRU                                          1675
         MVC   DARGSMOD(3,@15),@CC00834                            1675
*        DARGDBP = ADDR(RELNAME);                                  1676
         LA    @14,RELNAME                                         1676
         ST    @14,DARGDBP(,@15)                                   1676
*        DARGILP = LENGTH(RELNAME);                                1677
*                                                                  1677
         MVC   DARGILP(2,@15),@CH00907                             1677
*        CALL AMSTP011  (GDTTBL,PRTFILE,DDSTRU);                   1678
*                                                                  1678
*                                                                  1678
         L     @15,@PC00001                                        1678
         ST    @15,@AL00001                                        1678
         LA    @14,@CF00114                                        1678
         ST    @14,@AL00001+4                                      1678
         LA    @14,DDSTRU                                          1678
         ST    @14,@AL00001+8                                      1678
         MVI   @AL00001+8,X'80'                                    1678
         L     @15,GDTPRT(,@15)                                    1678
         LA    @01,@AL00001                                        1678
         BALR  @14,@15                                             1678
*        /************************************************************/
*        /*                                                          */
*        /*    CLEAR WORK AREA FOR UPRINT ARGUMENT LISTS             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1679
*        DO I = 1 TO 9;                                            1679
         LA    I,1                                                 1679
@DL01679 DS    0H                                                  1680
*          PRINTTAB(I) = NULLPTR;                                  1680
         LR    @05,I                                               1680
         SLA   @05,2                                               1680
         SLR   @15,@15                                             1680
         ST    @15,PRINTTAB-4(@05)                                 1680
*        END;                                                      1681
*                                                                  1681
         AL    I,@CF00218                                          1681
         C     I,@CF00037                                          1681
         BNH   @DL01679                                            1681
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1682
*        RETURN CODE(0);                                           1682
*                                                                  1682
         SLR   @15,@15                                             1682
         L     @14,@SA00015                                        1682
         LM    @00,@03,@SA00015+8                                  1682
         LM    @05,@12,@SA00015+24                                 1682
         BR    @14                                                 1682
*END PRNTPROC;                                                     1683
*END IDCRC02                                                       1684
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*/*%INCLUDE SYSLIB  (IDCDF63 )                                        *
*;                                                                 1684
@DATA    DS    0H
@CH00895 DC    H'20'
@CH00309 DC    H'24'
@CH00907 DC    H'44'
@CH01287 DC    H'588'
@CH00812 DC    H'1000'
@SM01316 MVC   TOAREA(0,MTPTR),ZERO
@SM01318 MVC   TOAREA(0,MTPTR),FROMAREA(MFPTR)
@SC01321 CLC   FIELD(0,@14),NOTINIT
@SC01323 CLC   FIELD(0,@15),NOTINIT
         DS    0F
@AL00285 DC    A(@CF00178)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00469 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01165 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01471 DC    A(@CF01285)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00556 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00570 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00596 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00610 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01567 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01590 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01617 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01640 DC    A(@CF00114+3)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00218+3)
@AL00560 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00600 DC    A(@CF00285)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00687)
@AL00578 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01373 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01599 DC    A(@CF01289)             LIST WITH   4 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(SETZERO)
@AL00621 DC    A(@CC00675)             LIST WITH   5 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(@CF00114)
         DC    A(@CF00114)
@AL00628 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01212 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01516 DC    A(NULLPARM)             LIST WITH   3 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(@CC01084)
@AL00670 DC    A(@CF01289)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00967 DC    A(@CF01285)             LIST WITH   4 ARGUMENT(S)
@AL00644 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01218 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01522 DC    A(NULLPARM)             LIST WITH   2 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(SETZERO)
@AL01243 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01258 DC    A(@CF00034)             LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(GPID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL01339 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01361 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01368 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01392 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01413 DC    A(@CF00114+3)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00152+3)
@AL01350 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01402 DC    A(@CF00285)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC01072)
@AL01575 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01625 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01658 DC    A(@CF00218+3)           LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00218+3)
@AL01580 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01630 DC    A(@CF00152)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC01072)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00005 DS    15F
@PC00005 DS    6F
@SA00006 DS    15F
@PC00006 DS    2F
@SA00002 DS    15F
@SA00010 DS    15F
@SA00013 DS    15F
@SA00003 DS    15F
@PC00003 DS    5F
@SA00004 DS    15F
@PC00004 DS    1F
@SA00011 DS    15F
@PC00011 DS    3F
@SA00009 DS    15F
@PC00009 DS    2F
@PC00008 DS    4F
@SA00015 DS    14F
@PC00015 DS    2F
@SA00007 DS    15F
@SA00012 DS    14F
@PC00012 DS    1F
@SA00014 DS    15F
@PC00014 DS    2F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    5F
IDCRC02  CSECT
         DS    0F
@CF00114 DC    F'0'
@CF00218 DC    F'1'
@CH00218 EQU   @CF00218+2
@CF00152 DC    F'2'
@CH00152 EQU   @CF00152+2
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00285 DC    F'5'
@CF00178 DC    F'8'
@CF00037 DC    F'9'
@CF00034 DC    F'12'
@CF01292 DC    F'13'
@CF00887 DC    F'14'
@CF00227 DC    F'15'
@CF00481 DC    F'16'
@CF00893 DC    F'17'
@CF00891 DC    F'18'
@CF01291 DC    F'19'
@CF01286 DC    F'28'
@CH01286 EQU   @CF01286+2
@CF00220 DC    F'32'
@CF01113 DC    F'40'
@CF01285 DC    F'268'
@CH01285 EQU   @CF01285+2
@CF01289 DC    F'1052'
@CF01313 DC    F'-8'
@CF01320 DC    F'-4'
@CF01314 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CTGPLPTR DS    A
RECSZ    DS    F
BLKSZ    DS    F
TOTLEN   DS    F
FNMPTR   DS    A
AFNMPTR  DS    A
PINIOCS  DS    A
POUTIOCS DS    A
PTRCTACB DS    A
CONRCPTR DS    A
INDXCPL  DS    F
REQLEN   DS    F
STRTCHN  DS    F
REQPTR   DS    A
CURPTR   DS    A
LISTPTR  DS    A
LASTCC   DS    H
SAVLEN   DS    H
NUMASSOC DS    H
SAPLLEN  DS    H
SAPLASC  DS    H
INDEXLIM DS    H
CNUM     DS    FL1
ONUM     DS    FL1
         DS    CL3
NXTCHN   DS    FL3
LISTLN   DS    FL1
@TS00001 DS    CL95
@NM00045 DS    CL10
         ORG   @NM00045
CATRTNID DS    CL8
CATLGRC  DS    FL2
         ORG   @NM00045+10
RELNAME  DS    CL44
SAVEPL   DS    CL588
         ORG   SAVEPL
@NM00050 DS    CL28
@NM00051 DS    20CL4
@NM00052 DS    20CL24
         ORG   SAVEPL+588
SAVEPL2  DS    CL588
         ORG   SAVEPL2
@NM00053 DS    CL28
@NM00054 DS    20CL4
@NM00055 DS    20CL24
         ORG   SAVEPL2+588
DOCNTRL  DS    BL1
FLGS     DS    CL1
         ORG   FLGS
AIXFLAG  DS    BL1
KSDSFLAG EQU   FLGS+0
PATHFLAG EQU   FLGS+0
RRDSFLAG EQU   FLGS+0
FIRFLAG  EQU   FLGS+0
FRSTALS  EQU   FLGS+0
NVSMALS  EQU   FLGS+0
ASSOCFLG EQU   FLGS+0
         ORG   FLGS+1
FLGTWO   DS    CL1
         ORG   FLGTWO
FRSTASOC DS    BL1
FRSTSAV  EQU   FLGTWO+0
ERRSAVFL EQU   FLGTWO+0
@NM00057 EQU   FLGTWO+0
         ORG   FLGTWO+1
         DS    CL3
OPENLIST DS    BL48
CNTRL    DS    BL1
DOWRITE  DS    BL1
DOALIS   DS    BL1
         DS    CL1
CPLFPLEN DS    CL4
         ORG   CPLFPLEN
@NM00059 DS    FL2
ALSCPLEN DS    FL2
         ORG   CPLFPLEN+4
PRINTTAB DS    9F
PTRCPL   DS    5A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRC02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
NULLPARM DC    A(0)
FLGOFF   DC    XL1'00'
@CC01112 DC    C'CATLGRTN'
@CC00814 DC    C'RC02'
@CC01043 DC    C'RC01'
@CC01053 DC    C'RC03'
@CC01054 DC    C'RC04'
@CC01058 DC    C'RC05'
@CC01059 DC    C'RC06'
@CC01065 DC    C'RC07'
@CC01068 DC    C'RC09'
@CC01075 DC    C'RC11'
@CC01102 DC    C'RC13'
@CC01110 DC    C'RC15'
@CC01111 DC    C'RC16'
@CC01131 DC    C'RC17'
@CC01141 DC    C'RC19'
@CC01147 DC    C'RC21'
@CC01166 DC    C'RC23'
@CC01176 DC    C'RC25'
@CC01185 DC    C'RC27'
@CC01186 DC    C'RC28'
@CC01187 DC    C'RC29'
@CC01211 DC    C'RC31'
@CC01212 DC    C'RC32'
@CC01239 DC    C'RC33'
@CC01247 DC    C'RC35'
@CC01248 DC    C'RC36'
@CC01249 DC    C'RC37'
@CC01261 DC    C'RC39'
@CC01262 DC    C'RC40'
@CC01282 DC    C'RC42'
@CC00834 EQU   @CC00814
@CC00836 DC    C'XP0'
@CC00847 DC    C'UV0'
@CC00675 DC    C'I'
@CC00685 DC    C'G'
@CC00687 EQU   @CC00814
@CC01048 DC    C'O'
@CC01070 DC    C'H'
@CC01072 DC    C'N'
@CC01084 DC    C'W'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'RC02'
GPID     DC    CL4'RC02'
FIXAREA  DS    CL400
         ORG   FIXAREA
@NM00041 DS    CL256
         ORG   @NM00041
@NM00042 DC    256X'00'
         ORG   FIXAREA+256
@NM00043 DS    CL144
         ORG   @NM00043
@NM00044 DC    144X'00'
         ORG   FIXAREA+400
NOTINIT  DS    CL255
         ORG   NOTINIT
@NM00048 DC    255X'FF'
         ORG   NOTINIT+255
EMPDSRTN DC    X'6E'
EXPTYPE1 DC    X'F2'
CITYPEXT DC    CL8'ITYPEXT '
SSFLAG   DC    X'80'
ZERO     DC    X'00'
         DC    XL255'0'
FIELDLST DC    CL8'ENTYPE  '
         DC    CL8'ENTNAME '
         DC    CL8'DSATTR  '
         DC    CL8'OWNERID '
         DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'BUFSIZE '
         DC    CL8'LRECL   '
         DC    CL8'SPACPARM'
         DC    CL8'PASSWORD'
         DC    CL8'PASSPRMT'
         DC    CL8'PASSATMP'
         DC    CL8'USVRMDUL'
         DC    CL8'USERAREC'
         DC    CL8'LOKEYV  '
         DC    CL8'HIKEYV  '
         DC    CL8'VOLSER  '
         DC    CL8'AMDSBCAT'
         DC    CL8'EXCPEXIT'
         DC    CL8'RGATTR  '
         DC    CL8'SECFLAGS'
         DC    CL8'NAMEDS  '
         DC    CL8'CATACB  '
NVSMFLST DC    CL8'ENTYPE  '
         DC    CL8'ENTNAME '
         DC    CL8'VOLSER  '
         DC    CL8'DEVTYP  '
         DC    CL8'FILESEQ '
         DC    CL8'OWNERID '
         DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'NAMEDS  '
         DC    CL8'CATACB  '
GDGFLIST DC    CL8'ENTYPE  '
         DC    CL8'ENTNAME '
         DC    CL8'GDGLIMIT'
         DC    CL8'GDGATTR '
         DC    CL8'OWNERID '
         DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'NAMEDS  '
         DC    CL8'CATACB  '
ALSFLIST DC    CL8'ENTYPE  '
         DC    CL8'ENTNAME '
         DC    CL8'NAMEDS  '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
NALSMPTR EQU   @03
ICONTRBL EQU   @02
M1SIZE   EQU   @02
MTPTR    EQU   @03
MFPTR    EQU   @04
PAD      EQU   @05
PLN      EQU   @04
WSIZE    EQU   @03
LGNFLD   EQU   @05
DINDX    EQU   @03
INDX     EQU   @04
I        EQU   @04
ASSREMD  EQU   @03
CLRFDCTR EQU   @03
NUMALS   EQU   @05
NUMOBJCT EQU   @05
NUMOBJ   EQU   @03
NUMCPL   EQU   @05
DSCCATPT EQU   @06
CTGFLPTR EQU   @02
OPNPTR   EQU   @03
IOCSPTR  EQU   @03
TESTRC   EQU   @02
SETRC    EQU   @03
RTNREG   EQU   @15
REG15    EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSACA0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPT0 EQU   0
IDCIOCO0 EQU   0
IDCIOVY0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCTRN   EQU   IOCSTR+8
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCVRC   EQU   IOCTTR
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMSF EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNTYPXM EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDEVDT EQU   OPNDEV
OPNREC   EQU   OPNAGL+32
OPNBLK   EQU   OPNAGL+36
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
OPNOPTNM EQU   OPNOPT2
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFDBK  EQU   CTGNEWNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDCD EQU   CTGFL+1
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLCHN EQU   CTGFL+12
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDNEST  EQU   IDAAMDSB+4
AMDAXRKP EQU   AMDNEST
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDPCTCA EQU   IDAAMDSB+10
AMDPCTCI EQU   IDAAMDSB+11
AMDCINV  EQU   IDAAMDSB+20
AMDLRECL EQU   IDAAMDSB+24
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
INPTBL   EQU   0
ENTOBJ   EQU   0
OBJTYP   EQU   ENTOBJ
OBJVAL   EQU   ENTOBJ+1
OBJPLN   EQU   ENTOBJ+8
OBJPAS   EQU   ENTOBJ+9
OUTDAT   EQU   0
OUTLEN   EQU   OUTDAT
SAVOIOCS EQU   OUTDAT+4
USBKSZ   EQU   OUTDAT+8
OUTFLGS  EQU   OUTDAT+16
OPNFLG   EQU   OUTFLGS
ENDFLG   EQU   OUTFLGS
EMPTYDS  EQU   OUTFLGS
INDDNM   EQU   0
OUTDDNM  EQU   0
PDEVNM   EQU   0
FENTYPE  EQU   0
FENTNAME EQU   0
FNAMEDS  EQU   0
FTYPE    EQU   FNAMEDS
FNAME    EQU   FNAMEDS+1
FCATACB  EQU   0
FDSATTR  EQU   0
FPASSMWR EQU   0
FIELD    EQU   0
FIELDLN  EQU   FIELD
WORKAREA EQU   0
AREALN   EQU   WORKAREA
RETURNLN EQU   WORKAREA+2
ENTLIST  EQU   WORKAREA+4
ENTITEM  EQU   ENTLIST
PATHREL  EQU   0
RELATE   EQU   PATHREL
PATHENT  EQU   RELATE
@NM00049 EQU   PATHREL+44
PATHPASS EQU   @NM00049
CONREC   EQU   0
HEADER   EQU   CONREC
HEADLN   EQU   HEADER
HEADFLG1 EQU   HEADER+2
HEADFLG2 EQU   HEADER+3
RECORDSZ EQU   HEADER+4
ASSRECLN EQU   RECORDSZ
ASSRECNM EQU   RECORDSZ+2
VARDATA  EQU   CONREC+8
DICT     EQU   0
DICTNM   EQU   DICT
DICTEN   EQU   DICT+4
DICTLN   EQU   DICTEN
DICTDL   EQU   DICTEN+4
TIMESTMP EQU   0
TEXOJCT  EQU   TIMESTMP
TEXFLG   EQU   TIMESTMP+1
TEXASSOC EQU   TEXFLG
TEXBASE  EQU   TEXFLG
TEXRCVY  EQU   TEXFLG
TEXNVS   EQU   TEXFLG
TEXGDG   EQU   TEXFLG
TEXUCT   EQU   TEXFLG
TEXFLG2  EQU   TIMESTMP+2
TIMEODAY EQU   TIMESTMP+4
TIMEDATE EQU   TIMESTMP+12
OIOCSPTR EQU   0
FROMAREA EQU   0
TOAREA   EQU   0
BUFCHN   EQU   0
BHRECLEN EQU   BUFCHN
BRECLEN  EQU   BHRECLEN+2
BRECPTR  EQU   BUFCHN+4
BNXTCHN  EQU   BUFCHN+8
NMDSPTR  EQU   0
NMDSTYPE EQU   NMDSPTR
NMDSNAME EQU   NMDSPTR+1
ALSCHN   EQU   0
NXTALIS  EQU   ALSCHN+4
NXTNAM   EQU   NXTALIS+1
ANAMEDS  EQU   0
ATYPE    EQU   ANAMEDS
ANAME    EQU   ANAMEDS+1
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
INPPTR   EQU   0
LCINUM   EQU   0
LCATACB  EQU   0
LFLDLST  EQU   0
LFLDNUM  EQU   0
LCPLPTR  EQU   0
SCPLPTR  EQU   0
OTYPE    EQU   0
ODD      EQU   0
ODSN     EQU   0
OREC     EQU   0
OBLK     EQU   0
OIOCS    EQU   0
PLNINIT  EQU   0
PADINIT  EQU   0
MSIZE    EQU   0
MF1PTR   EQU   0
MT1PTR   EQU   0
ZEROOUT  EQU   0
INDCTGPL EQU   0
TYPE     EQU   0
IRECLEN  EQU   0
IRECPTR  EQU   0
IREQTPE  EQU   0
ALSNMPTR EQU   0
PFLNMDS  EQU   0
NUMASOC  EQU   0
PRNTMSG  EQU   0
ICPL     EQU   0
@NM00036 EQU   CTGDDNM
CTGPROB  EQU   @NM00036
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
PREVALS  EQU   ALSCHN+8
NXTTPE   EQU   NXTALIS
GDSASOC  EQU   ALSCHN
@NM00058 EQU   BHRECLEN
TEXRESV  EQU   TIMESTMP+3
TEXINHTG EQU   TEXFLG
@NM00056 EQU   TEXFLG
ENTRYNM  EQU   ENTITEM+1
ENTRYTYP EQU   ENTITEM
FIELDCT  EQU   FIELD+2
FDSNTUSE EQU   FDSATTR+1
@NM00047 EQU   FDSATTR+1
@NM00046 EQU   FDSATTR
FDSTMPEX EQU   FDSATTR
FDSINHUP EQU   FDSATTR
FDSOTHER EQU   FDSATTR
@NM00040 EQU   OUTFLGS
RESOUTP  EQU   OUTDAT+12
RESINP   EQU   ENTOBJ+4
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00039 EQU   IDAAMDSB+41
@NM00038 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00037 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
@NM00035 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGTYPE  EQU   CTGPL+18
@NM00034 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00033 EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00032 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNDEVIX EQU   OPNDEV+4
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00396 EQU   @RC00395
@RF00451 EQU   @RC00426
@RC00535 EQU   @RC00534
@RC00590 EQU   @RC00534
@RF00604 EQU   @RC00534
@RC01003 EQU   @RC01002
@RF01071 EQU   @RC01066
@RF01208 EQU   @RC01202
@RC01333 EQU   @RC01318
@RF01354 EQU   @RC01318
@RF01512 EQU   @RC01506
@RC01561 EQU   @RC01546
@RC01572 EQU   @RC01546
@RF01584 EQU   @RC01546
@RF01646 EQU   @RC01544
@RF01652 EQU   @RC01544
@PB00015 EQU   @EL00001
@RC00550 EQU   @RC00535
@RF00564 EQU   @RC00535
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCRC02,(C'PLS2252',0701,77235)

         TITLE 'IDCRC04 - FIELD MANAGEMENT FOR AMS                     *
                        '
        MACRO
        DICT  &NAME,&OFF=0,&COMB='NO',&BYTE='NO',&FIELD=,&LEN=0,&GC=, **
               &SPECIAL=,&PTRS=
        LCLC  &X1
        LCLA  &X2,&X3,&X4,&X5
.*
&X1     SETC  '&NAME'(1,2)
        AIF   (K'&NAME LT 5).YY1
&X1     SETC  '&X1'.'&NAME'(5,1)
        AIF   (K'&NAME LT 6).YY1
&X1     SETC  '&X1'.'&NAME'(6,1)
.YY1    ANOP
.*
        AIF   ('&COMB' EQ 'YES').COMBN
        AIF   ('&BYTE' NE 'YES').NOBYTE
&X2     SETA  &X2+16
.NOBYTE ANOP
        AIF   (T'&FIELD EQ 'O').XX1
&X2     SETA  &X2+128
&X3     SETA  0
&X4     SETA  &FIELD
        AGO   .XX2
.XX1    ANOP
        AIF   (T'&SPECIAL EQ 'O').XX1A
&X2     SETA  65
&X3     SETA  &SPECIAL
        AGO   .XX1B
.XX1A   ANOP
        AIF   (T'&PTRS EQ 'O').XX1AA
&X2     SETA  &X2+2
.XX1AA  ANOP
&X3     SETA  &OFF
.XX1B   ANOP
&X4     SETA  &LEN
.XX2    ANOP
.*
        AIF   (T'&GC EQ 'O').XX3
&X5     SETA  &GC
        AIF   (&GC EQ 128).XX3
&X2     SETA  &X2+64
.XX3    ANOP
.*
X&X1    DC    CL4'&X1',AL1(&X2),AL1(&X3),AL1(&X4),AL1(&X5)
        SPACE 2
.*
        MEXIT
.COMBN  ANOP
        AIF   (T'&GC EQ 'O').Z1
&X5     SETA  &GC
.Z1     ANOP
        DC    CL4'&X1',AL1(32),AL1(Y&X1-Y000),AL1(L'Y&X1),AL1(&X5)
        SPACE 2
        MEND
        MACRO
        COMB &A,&B
        LCLA &X,&Y
        LCLC &N
&N      SETC  '&A'(1,2)
        AIF   (K'&A LT 5).YY2
&N      SETC  '&N'.'&A'(5,1)
        AIF   (K'&A LT 6).YY2
&N      SETC  '&N'.'&A'(6,1)
.YY2    ANOP
.*
&X      SETA N'&B
Y&N     DS   0CL&X
.*
&Y      SETA 1
.XX1    ANOP
&N      SETC  '&B(&Y)'(1,2)
        AIF   (K'&B(&Y) LT 5).YY1
&N      SETC  '&N'.'&B(&Y)'(5,1)
        AIF   (K'&B(&Y) LT 6).YY1
&N      SETC  '&N'.'&B(&Y)'(6,1)
.YY1    ANOP
        DC    AL1((8+X&N-X000)/8)
&Y      SETA &Y+1
        AIF  (&Y LE &X).XX1
        SPACE 2
        MEND
IDCRC04  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRC04   77.277'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @11,0                                               0002
@PSTART  LA    @12,4095(,@11)                                      0002
         USING @PSTART,@11                                         0002
         USING @PSTART+4095,@12                                    0002
*  FMPLAD=R1;                     /* POINT AT CALLERS FMPL           */
         LR    FMPLAD,R1                                           0049
*  RFY R1 UNRSTD;                 /* RELEASE THE REGISTER            */
*                                                                  0050
*  /******************************************************************/
*  /*                                                                */
*  /*     SET UP THE POINTER TO THE WORK AREA                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0051
*  R13->WKARSV(3)=ADDR(FMPLWKAR); /* POINT TO NEW SAVE AREA          */
         LA    @03,FMPLWKAR(,FMPLAD)                               0051
         ST    @03,WKARSV+8(,R13)                                  0051
*  FMPLWKAR->WKARSV(2)=R13;       /* SAVE THE INCOMING SAVE          */
         L     @03,FMPLWKAR(,FMPLAD)                               0052
         ST    R13,WKARSV+4(,@03)                                  0052
*                                 /* AREA REGISTER                   */
*  R13=FMPLWKAR;                  /* POINT AT WORK AREA              */
         LR    R13,@03                                             0053
*  WKACURCI='FFFFFF'X;            /* INITIALIZE THE CURRENT          */
         MVC   WKACURCI(3,R13),@CB00227                            0054
*                                 /* CI NUMBER SO THAT THE GET       */
*                                 /* RECORD ROUTINE DOES NOT         */
*                                 /* GET CONFUSED                    */
*  WKAUPTR=FMPLUPTR;              /* PLACE THE CALLERS POINTER       */
*                                                                  0055
         MVC   WKAUPTR(4,R13),FMPLUPTR(FMPLAD)                     0055
*  /******************************************************************/
*  /*                                                                */
*  /*     SET UP TO HANDLE THE PLS2 GENERATED TEMPORARIES            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0056
*  TEMPAD=ADDR(TEMPA);            /* POINT AT GENERATED TEMPS        */
         LA    TEMPAD,TEMPA(,R13)                                  0056
*  GEN(USING @DATD,TEMPAD);       /* ESTABLISH ADDRESSABILITY        */
         USING @DATD,TEMPAD
*  TEMPA=TEMPA&&TEMPA;            /* ZERO THE TEMPS                  */
*                                                                  0058
         XC    TEMPA(16,R13),TEMPA(R13)                            0058
*  /******************************************************************/
*  /*                                                                */
*  /*     CONVERT ALL THE ALPHABETIC FIELD NAMES TO THE              */
*  /*     CODES THAT ARE USED INTERNALLY                             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0059
*  CALL PSCNC;                    /* GO TO CONVERT THE FIELD         */
         BAL   @14,PSCNC                                           0059
*                                 /* NAMES TO INTERNAL CODES         */
*                                                                  0060
*  /******************************************************************/
*  /*                                                                */
*  /*     IF THE NAME CONVERTION WENT OK, THEN BUILD THE             */
*  /*     OUTPUT AREA DESIRED BY THE REQUEST.                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0060
*  IF FMPLRTCD=RTNCDNML           /* IF THE RETURN CODE IS           */
*                                 /* THE NORMAL ONE                  */
*    THEN CALL PSCNF;             /* THEN: GO TO BUILD THE           */
         CLI   FMPLRTCD(FMPLAD),0                                  0060
         BNE   @RF00060                                            0060
         BAL   @14,PSCNF                                           0061
*                                 /*       OUTPUT AREA DESIRED       */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0062
@RF00060 DS    0H                                                  0063
*  /******************************************************************/
*  /*                                                                */
*  /*    RESTORE THE INCOMING SAVE AREA ADDRESS                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0063
*  R13=FMPLWKAR->WKARSV(2);       /* RESTORE THE SAVE AREA           */
         L     @01,FMPLWKAR(,FMPLAD)                               0063
         L     R13,WKARSV+4(,@01)                                  0063
*                                 /* ADDRESS                         */
*  GEN(EJECT);                                                     0064
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PCKLC                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = CHECK LENGTH/COUNT OF FIELD                  */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS SUB-FUNCTION INSURES THAT THE REQUESTED CATALOG        */
*/*      FIELD ACTUALLY EXISTS IN THE GROUP OCCURANCE DATA           */
*/*      BEING PROCESSED. THE PROCESSING IS AS FOLLOWS:              */
*/*                                                                  */
*/*      1. CHECKS TO SEE THAT NON-REPLICATED FIELDS ARE EITHER      */
*/*         IN THE HEADER OR THAT THE CORRECT RECORD TYPE IS         */
*/*         BEING USED.                                              */
*/*                                                                  */
*/*      2. CHECKS TO SEE IF THE VARIABLE FIELD IS BEYOND THE        */
*/*         THE NUMBER OF FIELDS PRESENT IN THE OCCURANCE DATA.      */
*/*                                                                  */
*/*      3. CHECKS TO SEE IF FIXED FIELD IS CONTAINED IN THE         */
*/*         FIXED AREA.                                              */
*/*                                                                  */
*/*  ROUTINES CALLED =                                               */
*/*      NONE                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0065
*PCKLC: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0065
*                                                                  0065
         B     @PB00002                                            0065
PCKLC    DS    0H                                                  0066
*  /******************************************************************/
*  /*                                                                */
*  /*    CONSTANTS USED BY THIS ROUTINE                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0066
*  DCL LRECFSS   FIXED(8) CONSTANT(105);                           0066
*                                 /* L RECORD FIXED STORAGE SIZE     */
*  DCL FRECFSS   FIXED(8) CONSTANT(48);                            0067
*                                 /* F RECORD FIXED STORAGE SIZE     */
*                                                                  0068
*  /******************************************************************/
*  /*                                                                */
*  /*    BEGIN BY ASSUMING THAT THE FIELD DOES NOT EXIST.            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0068
*  WKAFLDNE='1'B;                 /* INDICATE THAT THE FIELD         */
         OI    WKAFLDNE(R13),B'01000000'                           0068
*                                 /* DOES NOT EXIST                  */
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THE GROUP CODE IS FOR A NON-VOLUME RECORD                */
*  /*    FIXED AREA AND THE FIELD IS FIXED AND THE OFFSET            */
*  /*    TO THE START OF THE FIELD IS CONTAINED IN THE HEADER        */
*  /*    THEN INDICATE THAT THE FIELD DOES EXIST.                    */
*  /*                                                                */
*  /*    NOTE: HEADERS ON VOLUME RECORDS AND NON-VOLUME RECORDS      */
*  /*          ARE THE SAME. THAT IS NOT TRUE FOR THE REMAINDER      */
*  /*          OF THE FIXED AREA IN THE TWO TYPES.                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0069
*  IF WKADTVAR='0'B               /* IF THE FIELD IS NOT             */
*                                 /* VARIABLE LENGTH                 */
*    THEN IF WKAGRPCD=CONHDGC     /* THEN: IF GROUP CODE IS FOR      */
         TM    WKADTVAR(R13),B'10000000'                           0069
         BNZ   @RF00069                                            0069
*                                 /*       THE NON-VOLUME            */
*                                 /*       RECORD FIXED AREA         */
*      THEN IF WKADTSTR<=LENGTH(CBKRD1)                            0070
         CLI   WKAGRPCD(R13),X'00'                                 0070
         BNE   @RF00070                                            0070
*                                 /* THEN: IF FIELD STARTS IN        */
*                                 /*       THE HEADER                */
*        THEN WKAFLDNE='0'B;      /* THEN: INDICATE THAT THE         */
         CLI   WKADTSTR(R13),49                                    0071
         BH    @RF00071                                            0071
         NI    WKAFLDNE(R13),B'10111111'                           0072
*                                 /*       FIELD EXISTS              */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00071 DS    0H                                                  0074
*      ELSE;                      /* ELSE: CONTINUE                  */
@RF00070 DS    0H                                                  0075
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0075
@RF00069 DS    0H                                                  0076
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THE FIELD IS NOT IN THE HEADER (DOES NOT YET EXIST)      */
*  /*    THEN CHECK TO SEE THAT THE GROUP CODE MATCHES THE           */
*  /*    TYPE OF RECORD THAT IS BEING PROCESSED. IF THE GROUP        */
*  /*    CODE IS OK, THEN INDICATE THAT THE FIELD EXISTS.            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0076
*  IF WKAFLDNE='1'B               /* IF THE FIELD DOES NOT           */
*                                 /* EXIST                           */
*    THEN IF WKA1BSEQ='0'B        /* THEN: IF VOLUME RECORD OR       */
         TM    WKAFLDNE(R13),B'01000000'                           0076
         BNO   @RF00076                                            0076
*                                 /*       AN EXTENSION              */
*      THEN IF WKAGRPCD>=CONVOLGC /* THEN: IF GROUP CODE VALID       */
         TM    WKA1BSEQ(R13),B'10000000'                           0077
         BNZ   @RF00077                                            0077
*                                 /*       FOR VOLUME RECORD OR      */
*                                 /*       EXTENSION                 */
*        THEN WKAFLDNE='0'B;      /* THEN: INDICATE THAT THE         */
         CLI   WKAGRPCD(R13),X'05'                                 0078
         BL    @RF00078                                            0078
         NI    WKAFLDNE(R13),B'10111111'                           0079
*                                 /*       FIELD DOES EXIST          */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00078 DS    0H                                                  0081
*      ELSE IF WKAGRPCD<=CONNVLGC /* ELSE: IF GROUP CODE VALID       */
*                                 /*       FOR OTHER THAN A          */
*                                 /*       VOLUME RECORD             */
*        THEN WKAFLDNE='0'B;      /* THEN: INDICATE THAT THE         */
         B     @RC00077                                            0081
@RF00077 CLI   WKAGRPCD(R13),X'04'                                 0081
         BH    @RF00081                                            0081
         NI    WKAFLDNE(R13),B'10111111'                           0082
*                                 /*       FIELD DOES EXIST          */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00081 DS    0H                                                  0084
*    ELSE;                        /* ELSE: CONTINUE                  */
@RF00076 DS    0H                                                  0085
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THE FIELD DOES EXIST, CHECK THAT THE VARIABLE            */
*  /*    LENGTH FIELD NUMBER IS CONTAINED IN THE GROUP               */
*  /*    OCCURANCE OR THAT THE FIXED LENGTH FIELD STARTS IN          */
*  /*    THE FIXED AREA PROVIDED.                                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0085
*  IF WKAFLDNE='0'B               /* IF THE FIELD DOES EXIST         */
*    THEN IF WKADTVAR='1'B        /* THEN: IF FIELD IS VARIABLE      */
@RC00076 TM    WKAFLDNE(R13),B'01000000'                           0085
         BNZ   @RF00085                                            0085
*                                 /*       LENGTH                    */
*      THEN IF WKAFORL='0'B       /* THEN: IF NOT F OR L RECORD      */
         TM    WKADTVAR(R13),B'10000000'                           0086
         BNO   @RF00086                                            0086
*        THEN IF WKADTLEN>CBKVARNO                                 0087
         TM    WKAFORL(R13),B'00000001'                            0087
         BNZ   @RF00087                                            0087
*                                 /* THEN: IF FIELD NUMBER           */
*                                 /*       DESIRED IS LARGER         */
*                                 /*       THAN ANY AVAILABLE        */
*          THEN WKAFLDNE='1'B;    /* THEN: INDICATE FIELD DOES       */
         CLC   WKADTLEN(1,R13),CBKVARNO(WORKD)                     0088
         BNH   @RF00088                                            0088
         OI    WKAFLDNE(R13),B'01000000'                           0089
*                                 /*       NOT EXIST                 */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00088 DS    0H                                                  0091
*        ELSE WKAFLDNE='1'B;      /* ELSE: INDICATE THE FIELD        */
         B     @RC00087                                            0091
@RF00087 OI    WKAFLDNE(R13),B'01000000'                           0091
*                                 /*       DOES NOT EXIST            */
*      ELSE IF WKAFORL='1'B       /* ELSE: IF IT IS AN F OR L        */
*                                 /*       RECORD                    */
*        THEN IF CBKID=CONFREID   /* THEN: IF F RECORD               */
         B     @RC00086                                            0092
@RF00086 TM    WKAFORL(R13),B'00000001'                            0092
         BNO   @RF00092                                            0092
*          THEN IF WKADTSTR>=FRECFSS                               0093
         L     @01,WKABLKAD(,R13)                                  0093
         CLI   CBKID(@01),C'F'                                     0093
         BNE   @RF00093                                            0093
*                                 /* THEN: IF NOT IN FIXED AREA      */
*                                 /*       OF THE F RECORD           */
*            THEN WKAFLDNE='1'B;  /* THEN: INDICATE FIELD DOES       */
         CLI   WKADTSTR(R13),48                                    0094
         BL    @RF00094                                            0094
         OI    WKAFLDNE(R13),B'01000000'                           0095
*                                 /*       NOT EXIST                 */
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00094 DS    0H                                                  0097
*          ELSE IF WKADTSTR>=LRECFSS                               0097
*                                 /* ELSE: IF NOT IN FIXED AREA      */
*                                 /*       OF THE L RECORD           */
*            THEN WKAFLDNE='1'B;  /* THEN: INDICATE FIELD DOES       */
         B     @RC00093                                            0097
@RF00093 CLI   WKADTSTR(R13),105                                   0097
         BL    @RF00097                                            0097
         OI    WKAFLDNE(R13),B'01000000'                           0098
*                                 /*       NOT EXIST                 */
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00097 DS    0H                                                  0100
*        ELSE IF WKADTSTR>=CBKFXDLN                                0100
*                                 /* ELSE: IF DISPLACEMENT TO        */
*                                 /*       FIELD IS LARGER THAN      */
*                                 /*       THE SPACE AVAILABLE       */
*          THEN WKAFLDNE='1'B;    /* THEN: INDICATE THE FIELD        */
         B     @RC00092                                            0100
@RF00092 CLC   WKADTSTR(1,R13),CBKFXDLN(WORKD)                     0100
         BL    @RF00100                                            0100
         OI    WKAFLDNE(R13),B'01000000'                           0101
*                                 /*       DOES NOT EXIST            */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00100 DS    0H                                                  0103
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0103
*                                                                  0103
@RF00085 DS    0H                                                  0104
*  END PCKLC;                     /* END OF PROCEDURE                */
@EL00002 DS    0H                                                  0104
@EF00002 DS    0H                                                  0104
@ER00002 BR    @14                                                 0104
@PB00002 DS    0H                                                  0105
*  GEN(EJECT);                                                     0105
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PEXPT                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = COLLECT EXTENSION POINTERS                   */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS SUB-FUNCTION SETS UP THE ADDRESS AND LENGTH OF         */
*/*      THE EXTENSION POINTERS AS REQUESTED VIA THE RELREPNO        */
*/*      SPECIFIED ON ENTRY. THE PROCESSING IS AS FOLLOWS:           */
*/*                                                                  */
*/*      1. RETURN THE HORIZONTAL EXTENSION POINTER ON RELREPNO      */
*/*         NUMBER 1.                                                */
*/*                                                                  */
*/*      2. RETURN EACH SUCCEEDING VERTICAL EXTENSION POINTER        */
*/*         (THAT IS NOT DELETED) ON EACH SUCCEEDING RELREPNO        */
*/*         VALUE PROVIDED.                                          */
*/*                                                                  */
*/*  ROUTINES CALLED =                                               */
*/*      NONE                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0106
*PEXPT: PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);                      0106
*                                                                  0106
         B     @PB00003                                            0106
PEXPT    DS    0H                                                  0107
*  /******************************************************************/
*  /*                                                                */
*  /*     BEGIN BY ASSUMING THAT THE FIELD IS FOUND AND THAT         */
*  /*     IT DOES EXIST. ALSO ASSUME THAT THE LENGTH OF ALL          */
*  /*     POINTERS RETURNED WILL BE THE SAME.                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0107
*  WKAFLDNE='0'B;                 /* INDICATE THAT THE FIELD         */
*                                 /* DOES EXIST                      */
*  WKAFLDNF='0'B;                 /* INDICATE THAT THE FIELD         */
         NI    WKAFLDNE(R13),B'10011111'                           0108
*                                 /* IS FOUND                        */
*  WKAFNDLN=LENGTH(CBKEXTCI);     /* INITIALIZE THE FOUND            */
         MVC   WKAFNDLN(2,R13),@CH00087                            0109
*                                 /* LENGTH                          */
*                                                                  0110
*  /******************************************************************/
*  /*                                                                */
*  /*     WHEN THE RELREPNO IS 1 THEN PROVIDE THE HORIZONTAL         */
*  /*     EXTENSION POINTER TO THE CALLER.                           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0110
*  IF WKADRRNO=1                  /* IF THIS IS THE FIRST FIELD      */
*    THEN WKAFNDAD=ADDR(CBKEXTCI);/* THEN: POINT AT THE EXTEN-       */
         CLC   WKADRRNO(2,R13),@CH00047                            0110
         BNE   @RF00110                                            0110
         MVC   WKAFNDAD(4,R13),WKAFGOP(R13)                        0111
*                                 /*       SION POINTER              */
*    /****************************************************************/
*    /*                                                              */
*    /*     WHEN THE RELREPNO IS OTHER THAN 1, ASSUME THAT           */
*    /*     THE FIELD IS NON-EXISTANT AND THAT THE GROUP CODE        */
*    /*     IS NOT FOUND.                                            */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0112
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00110                                            0112
@RF00110 DS    0H                                                  0113
*      WKAFLDNE='1'B;             /* INDICATE THAT THE FIELD         */
*                                 /* DOES NOT EXIST                  */
*      WKAFLDNF='1'B;             /* INDICATE THAT THE GROUP         */
         OI    WKAFLDNE(R13),B'01100000'                           0114
*                                 /* CODE NOT FOUND                  */
*                                                                  0115
*      /*************************************************************/
*      /*                                                            */
*      /*     LOOP THROUGH ALL THE GROUP OCCURANCE POINTERS          */
*      /*     OR UNTIL THE NEXT ONE IS FOUND. DO NOT INCLUDE         */
*      /*     DELETED POINTERS IN THE RETURNED LIST.                 */
*      /*                                                            */
*       /*************************************************************/
*                                                                  0115
*      WKAEXITG='0'B;             /* INITIALIZE THE LOOP             */
         NI    WKAEXITG(R13),B'11011111'                           0115
*                                 /* CONTROL INDICATOR               */
*      WORKA=ADDR(CBKFGOP);       /* POINT AT THE FIRST GOP          */
         L     WORKA,WKAFGOP(,R13)                                 0116
         LA    WORKA,CBKFGOP(,WORKA)                               0116
*      WORKD=1;                   /* INITIALIZE THE COUNT OF         */
         LA    @03,1                                               0117
         LR    WORKD,@03                                           0117
*                                 /* POINTERS FOUND                  */
*      DO WORKB=1 TO CBKCTGOP WHILE WKAEXITG='0'B;                 0118
         LR    WORKB,@03                                           0118
         B     @DE00118                                            0118
@DL00118 TM    WKAEXITG(R13),B'00100000'                           0118
         BNZ   @DC00118                                            0118
*                                 /* LOOP TO FIND THE CORRECT        */
*                                 /* VERTICAL EXTENSION POINTER      */
*        IF GOPEXTPT='1'B         /* IF THIS IS AN EXTENSION         */
*                                 /* POINTER                         */
*          THEN IF GOPDELET='0'B  /* THEN: IF IT IS NOT A            */
         TM    GOPEXTPT(WORKA),B'10000000'                         0119
         BNO   @RF00119                                            0119
*                                 /*       DELETED POINTER           */
*            THEN DO;             /* THEN:                           */
         TM    GOPDELET(WORKA),B'01000000'                         0120
         BNZ   @RF00120                                            0120
*              WORKD=WORKD+1;     /* INCREMENT COUNT OF              */
         AH    WORKD,@CH00047                                      0122
*                                 /* EXTENSION POINTERS              */
*              IF WORKD=WKADRRNO  /* IF THIS IS THE NEXT             */
*                                 /* EXTENSION POINTER               */
*                /****************************************************/
*                /*                                                  */
*                /*     WHEN A NEW EXTENSION POINTER IS FOUND        */
*                /*     THEN INDICATE THAT THE GROUP CODE IS         */
*                /*     FOUND AND THE FIELD DOES EXIST. ALSO         */
*                /*     RETURN THE ADDRESS OF THE POINTER.           */
*                /*                                                  */
*                /****************************************************/
*                                                                  0123
*                THEN DO;         /* THEN:                           */
         CH    WORKD,WKADRRNO(,R13)                                0123
         BNE   @RF00123                                            0123
*                  WKAFNDAD=ADDR(GOPCINO);                         0125
         ST    WORKA,WKAFNDAD(,R13)                                0125
*                                 /* POINT AT THE FOUND POINTER      */
*                  WKAFLDNE='0'B; /* INDICATE THAT THE FIELD         */
*                                 /* DOES EXIST                      */
*                  WKAFLDNF='0'B; /* INDICATE THAT THE GROUP         */
         NI    WKAFLDNE(R13),B'10011111'                           0127
*                                 /* CODE FOUND                      */
*                  WKAEXITG='1'B; /* INDICATE THAT THE LOOP IS       */
         OI    WKAEXITG(R13),B'00100000'                           0128
*                                 /* COMPLETE                        */
*                  END;           /*                                 */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00123 DS    0H                                                  0131
*              END;               /*                                 */
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00120 DS    0H                                                  0133
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00119 DS    0H                                                  0134
*        WORKA=WORKA+WKAGOPLN;    /* POINT AT THE NEXT GOP           */
         AH    WORKA,WKAGOPLN(,R13)                                0134
*        END;                     /*                                 */
         AH    WORKB,@CH00047                                      0135
@DE00118 L     @01,WKAFGOP(,R13)                                   0135
         SLR   @00,@00                                             0135
         IC    @00,CBKCTGOP(,@01)                                  0135
         CR    WORKB,@00                                           0135
         BNH   @DL00118                                            0135
@DC00118 DS    0H                                                  0136
*      END;                       /*                                 */
*                                                                  0136
*  END PEXPT;                     /* END OF PROCEDURE                */
@EL00003 DS    0H                                                  0137
@EF00003 DS    0H                                                  0137
@ER00003 BR    @14                                                 0137
@PB00003 DS    0H                                                  0138
*  GEN(EJECT);                                                     0138
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PGREC                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = GET RECORD                                   */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS SUB-FUNCTION OBTAINS ADDRESSABILITY TO THE             */
*/*      DESIRED CI NUMBER.  THE PROCESSING IS DONE AS FOLLOWS:      */
*/*                                                                  */
*/*      1. DETERMINE IF THE DESIRED BLOCK IS KNOWN TO FIELD         */
*/*         MANAGEMENT, AND INTERFACES WITH THE CALLERS GET          */
*/*         ROUTINE TO OBTAIN ADDRESSABILITY TO THE BLOCK IF         */
*/*         REQUIRED.                                                */
*/*                                                                  */
*/*      2. COMPUTES SOME INFORMATIONAL POINTERS IN THE NEWLY        */
*/*         OBTAINED BLOCK.                                          */
*/*                                                                  */
*/*  ROUTINES CALLED =                                               */
*/*      USERS ROUTINE                                               */
*/*                                                                  */
*/********************************************************************/
*PGREC: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0139
*                                                                  0139
         B     @PB00004                                            0139
PGREC    DS    0H                                                  0140
*  /******************************************************************/
*  /*                                                                */
*  /*     BEGIN BY ASSUMING THAT THE RECORD IS RETURNED.             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0140
*  WKARECFN='1'B;                 /* INDICATE RECORD RETURNED        */
         OI    WKARECFN(R13),B'10000000'                           0140
*  /******************************************************************/
*  /*                                                                */
*  /*     CHECK TO SEE IF ADDRESSABILITY TO THE DESIRED C.I.         */
*  /*     NUMBER IS ALREADY KNOWN.                                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0141
*  IF WKACURCI=WKANEXCI           /* IF THE CURRENT CI NUMBER        */
*                                 /* AND THE DESIRED CI NUMBER       */
*                                 /* ARE EQUAL                       */
*    THEN;                        /* THEN: CONTINUE                  */
*                                                                  0141
         CLC   WKACURCI(3,R13),WKANEXCI(R13)                       0141
         BE    @RT00141                                            0141
*    /****************************************************************/
*    /*                                                              */
*    /*     INTERFACE TO THE CALLERS GET ROUTINE TO OBTAIN           */
*    /*     ADDRESSABILITY TO THE DESIRED C.I. NUMBER.               */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0143
*    ELSE DO;                     /* ELSE:                           */
*      WKARTNB=R14;               /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTNB(,R13)                                   0144
*      RFY R1 RSTD;               /* RESTRICT THE REGISTER           */
*      R1=ADDR(WKAGETIF);         /* POINT AT PARAMETER LIST         */
         LA    R1,WKAGETIF(,R13)                                   0146
*                                 /* FOR THE CALLERS GET RTN.        */
*      R15=FMPLGRTN;              /* POINT AT CALLERS GET RTN.       */
         L     R15,FMPLGRTN(,FMPLAD)                               0147
*      CALL SUBR15;               /* GO TO THE CALLERS GET RTN.      */
         BALR  @14,@15                                             0148
*      RFY R1 UNRSTD;             /* RELEASE THE REGISTER            */
*      R14=WKARTNB;               /* RESTORE RETURN ADDRESS          */
*                                                                  0150
         L     R14,WKARTNB(,R13)                                   0150
*      /**************************************************************/
*      /*                                                            */
*      /*     DO THE FOLLOWING IF THE DESIRED C.I. NUMBER WAS        */
*      /*     RETURNED.                                              */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0151
*      IF WKARECFN='1'B           /* IF RECORD RETURNED              */
*        THEN DO;                 /* THEN:                           */
*                                                                  0151
         TM    WKARECFN(R13),B'10000000'                           0151
         BNO   @RF00151                                            0151
*          /**********************************************************/
*          /*                                                        */
*          /*     RECORD THE C.I. NUMBER THAT ADDRESSABILITY         */
*          /*     HAS BEEN OBTAINED FOR.                             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0153
*          WKACURCI=WKANEXCI;     /* POINT AT THE CURRENT CI         */
         MVC   WKACURCI(3,R13),WKANEXCI(R13)                       0153
*          /**********************************************************/
*          /*                                                        */
*          /*    CHECK TO SEE IF F OR L TYPE RECORD AND SKIP         */
*          /*    THE NORMAL PROCESSING FOR THEM                      */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0154
*          IF CBKID=CONFREID × CBKID=CONCCRID                      0154
*                                 /* IF THIS IS AN L OR F TYPE       */
*                                 /* RECORD                          */
*            THEN WKAFORL='1'B;   /* THEN: INDICATE F OR L TYPE      */
         L     @03,WKABLKAD(,R13)                                  0154
         CLI   CBKID(@03),C'F'                                     0154
         BE    @RT00154                                            0154
         CLI   CBKID(@03),C'L'                                     0154
         BNE   @RF00154                                            0154
@RT00154 DS    0H                                                  0155
         OI    WKAFORL(R13),B'00000001'                            0155
*            ELSE DO;             /* ELSE:                           */
         B     @RC00154                                            0156
@RF00154 DS    0H                                                  0157
*              WKAFORL='0'B;      /* INDICATE NOT F OR L             */
*                                                                  0157
         NI    WKAFORL(R13),B'11111110'                            0157
*              /******************************************************/
*              /*                                                    */
*              /*     COMPUTE THE ADDRESS OF THE EXTENSION POINTER   */
*              /*     FOR THE NEW RECORD JUST OBTAINED.              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0158
*              WORKA=ADDR(CBKRD1)+CBKLOFX;                         0158
         L     @03,WKABLKAD(,R13)                                  0158
         SLR   WORKA,WORKA                                         0158
         IC    WORKA,CBKLOFX(,@03)                                 0158
         ALR   WORKA,@03                                           0158
*                                 /* POINT AT FIRST VARIABLE         */
*                                 /* LENGTH FIELD                    */
*              DO WORKB=1 TO CBKNVLF;                              0159
         LA    WORKB,1                                             0159
         B     @DE00159                                            0159
@DL00159 DS    0H                                                  0160
*                                 /* LOOP THROUGH ALL VARIABLE       */
*                                 /* LENGTH FIELDS                   */
*                WORKA=ADDR(CBKDATA)+CBKVRLEN;                     0160
         LA    @03,CBKDATA(,WORKA)                                 0160
         AH    @03,CBKVRLEN(,WORKA)                                0160
         LR    WORKA,@03                                           0160
*                                 /* POINT AT NEXT VARIABLE          */
*                                 /* LENGTH FIELD                    */
*                END;             /*                                 */
         AH    WORKB,@CH00047                                      0161
@DE00159 L     @01,WKABLKAD(,R13)                                  0161
         SLR   @00,@00                                             0161
         IC    @00,CBKNVLF(,@01)                                   0161
         CR    WORKB,@00                                           0161
         BNH   @DL00159                                            0161
*              WKAFGOP=WORKA;     /* SAVE ADDRESS OF THE             */
         ST    WORKA,WKAFGOP(,R13)                                 0162
*                                 /* EXTENSION POINTER               */
*                                                                  0163
*              /******************************************************/
*              /*                                                    */
*              /*     SETUP THE LENGTH OF THE GROUP OCCURANCE        */
*              /*     POINTER AND THE INDICATOR FOR THE SEQUENCE     */
*              /*     NUMBER LENGTH BASED ON THE TYPE OF RECORD      */
*              /*     THAT WAS OBTAINED.                             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0163
*              IF CBKID=CONVOLID ×/* IF VOLUME BLOCK OR              */
*                 CBKID=CONVEXID  /* AN EXTENSION TO IT              */
*                THEN DO;         /* THEN:                           */
         L     @03,WKABLKAD(,R13)                                  0163
         CLI   CBKID(@03),C'V'                                     0163
         BE    @RT00163                                            0163
         CLI   CBKID(@03),C'W'                                     0163
         BNE   @RF00163                                            0163
@RT00163 DS    0H                                                  0164
*                  WKA1BSEQ='0'B; /* CLEAR 1 BYTE SEQUENCE           */
         NI    WKA1BSEQ(R13),B'01111111'                           0165
*                                 /* NUMBER INDICATOR                */
*                  WKAGOPLN=LENGTH(GOP);                           0166
         MVC   WKAGOPLN(2,R13),@CH00122                            0166
*                                 /* SET UP LENGTH OF GOP FOR        */
*                                 /* VOLUME RECORD OR EXTENSION      */
*                  END;           /*                                 */
*                ELSE DO;         /* ELSE:                           */
         B     @RC00163                                            0168
@RF00163 DS    0H                                                  0169
*                  WKA1BSEQ='1'B; /* SET 1 BYTE SEQUENCE             */
         OI    WKA1BSEQ(R13),B'10000000'                           0169
*                                 /* NUMBER INDICATOR                */
*                  WKAGOPLN=LENGTH(GOP)-1;                         0170
         MVC   WKAGOPLN(2,R13),@CH00139                            0170
*                                 /* SET UP LENGTH OF GOP FOR        */
*                                 /* NON-VOLUME RECORD OR ITS        */
*                                 /* EXTENSION RECORD                */
*                  END;           /*                                 */
*              /******************************************************/
*              /*                                                    */
*              /*     COMPUTE THE ADDRESS OF THE GROUP OCCURANCE     */
*              /*     DATA AREA FOR THIS RECORD.                     */
*              /*                                                    */
*              /******************************************************/
*                                                                  0172
*              WKAGODTA=(WKAGOPLN*CBKCTGOP)+ADDR(CBKFGOP);         0172
@RC00163 L     @03,WKAFGOP(,R13)                                   0172
         SLR   @02,@02                                             0172
         IC    @02,CBKCTGOP(,@03)                                  0172
         MH    @02,WKAGOPLN(,R13)                                  0172
         LA    @03,CBKFGOP(,@03)                                   0172
         ALR   @02,@03                                             0172
         ST    @02,WKAGODTA(,R13)                                  0172
*                                 /* COMPUTE ADDRESS OF FIRST        */
*                                 /* GROUP OCCURANCE                 */
*              END;               /*                                 */
*          END;                   /*                                 */
*                                                                  0174
*        /************************************************************/
*        /*                                                          */
*        /*     IF NO RECORD IS RETURNED THEN INDICATE THAT          */
*        /*     NO C.I. NUMBER HAS ADDRESSABILITY.                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0175
*        ELSE WKACURCI='FFFFFF'X; /* ELSE: DESTROY CURRENT CI        */
         B     @RC00151                                            0175
@RF00151 MVC   WKACURCI(3,R13),@CB00227                            0175
*                                 /*       NUMBER                    */
*      END;                       /*                                 */
*  END PGREC;                     /* END OF PROCEDURE                */
@EL00004 DS    0H                                                  0177
@EF00004 DS    0H                                                  0177
@ER00004 BR    @14                                                 0177
@PB00004 DS    0H                                                  0178
*  GEN(EJECT);                                                     0178
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PGREP                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = GET HIGHEST RELREPNO                         */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS SUB-FUNCTION FINDS THE HIGHEST NON-DELETED             */
*/*      RELREPNO WITH THE DESIRED GROUPCODE. THE PROCESSING         */
*/*      IS AS FOLLOWS:                                              */
*/*                                                                  */
*/*      1. SCAN THE BASE RECORD AND ANY HORIZONTAL EXTENSIONS FOR   */
*/*         THE DESIRED GROUP CODE. THE LAST NON-DELETED ONE IS      */
*/*         SAVED AS THE HIGHEST ONE.                                */
*/*                                                                  */
*/*      2. AFTER THE CORRECT COUNT IS DETERMINED THE ADDRESS        */
*/*         AND LENGTH OF THE FIELD IS CONSTRUCTED.                  */
*/*                                                                  */
*/*  ROUTINES CALLED =                                               */
*/*      PGREC                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0179
*PGREP: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0179
         B     @PB00005                                            0179
PGREP    DS    0H                                                  0180
*  /******************************************************************/
*  /*                                                                */
*  /*     INITIALIZE THE NEEDED VARIABLIES AND SAVE THE RETURN       */
*  /*     ADDRESS.                                                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0180
*  WKARTNA=R14;                   /* SAVE RETURN ADDRESS             */
         ST    R14,WKARTNA(,R13)                                   0180
*  WKAHREPN=0;                    /* INITIALIZE HIGHEST              */
         SLR   @03,@03                                             0181
         STH   @03,WKAHREPN(,R13)                                  0181
*                                 /* SEQUENCE NUMBER TO ZERO         */
*  WKANEXCI=FMPLBCIN;             /* PLACE GIVEN BASE CI NUMBER      */
         MVC   WKANEXCI(3,R13),FMPLBCIN(FMPLAD)                    0182
*                                 /* AS THE NEXT CI TO GET           */
*                                                                  0183
*  /******************************************************************/
*  /*                                                                */
*  /*     LOOP THROUGH ALL GROUP OCCURANCE POINTERS FOR THIS         */
*  /*     SET OF RECORDS AND GET THE SEQUENCE NUMBER OF THE          */
*  /*     HIGHEST NON-DELETED ONE.                                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0183
*  WKAEXITA='0'B;                 /* INITIALIZE LOOP EXIT            */
         NI    WKAEXITA(R13),B'11111011'                           0183
*                                 /* INDICATOR A                     */
*  DO WHILE WKAEXITA='0'B;        /* LOOP WHILE EXIT INDICATOR       */
         B     @DE00184                                            0184
@DL00184 DS    0H                                                  0185
*                                 /* A IS NOT ON                     */
*                                                                  0185
*    /****************************************************************/
*    /*                                                              */
*    /*     GET THE CORRECT RECORD SO THAT IT MAY BE SEARCHED.       */
*    /*     IF THE RECORD IS NOT OBTAINED THEN EXIT USING THE        */
*    /*     COUNT THAT HAS ACCRUED TO THIS POINT.                    */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0185
*    CALL PGREC;                  /* GO TO GET THE CI BLOCK          */
         BAL   @14,PGREC                                           0185
*                                 /* DESIRED                         */
*    IF WKARECFN='0'B             /* IF RECORD WAS NOT OBTAINED      */
*      THEN WKAEXITA='1'B;        /* THEN: INDICATE THAT THE         */
         TM    WKARECFN(R13),B'10000000'                           0186
         BNZ   @RF00186                                            0186
         OI    WKAEXITA(R13),B'00000100'                           0187
*                                 /*       LOOP IS COMPLETE          */
*                                                                  0188
*      /**************************************************************/
*      /*                                                            */
*      /*     IF THE RECORD IS RETURNED, THEN SEARCH IT FOR THE      */
*      /*     DESIRED SEQUENCE NUMBER.                               */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0188
*      ELSE DO;                   /* ELSE:                           */
         B     @RC00186                                            0188
@RF00186 DS    0H                                                  0189
*        /************************************************************/
*        /*                                                          */
*        /*     SEARCH ALL THE GROUP OCCURANCE POINTERS TO GET       */
*        /*     FIND THE HIGHEST SEQUENCE NUMBER.                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0189
*        WORKA=ADDR(CBKFGOP);     /* POINT AT THE FIRST GOP          */
         L     WORKA,WKAFGOP(,R13)                                 0189
         LA    WORKA,CBKFGOP(,WORKA)                               0189
*                                 /* AFTER THE EXTENSION POINTR      */
*        DO WORKB=1 TO CBKCTGOP;  /* LOOP WHILE THERE ARE STILL      */
         LA    WORKB,1                                             0190
         B     @DE00190                                            0190
@DL00190 DS    0H                                                  0191
*                                 /* MORE GOP'S TO CHECK             */
*                                                                  0191
*          /**********************************************************/
*          /*                                                        */
*          /*     IF THE GROUP CODE IS EQUAL TO THE DESIRED          */
*          /*     GROUP CODE AND THE GROUP OCCURANCE POINTER         */
*          /*     IS NOT DELETED THEN SAVE THE SEQUENCE NUMBER       */
*          /*     BECAUSE IT MUST BE LARGER THAN THE LAST ONE.       */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0191
*          IF WKAGRPCD=(GOPINFO&CONTRUGC)                          0191
*                                 /* IF THE GROUP CODE OF THE        */
*                                 /* GOP MATCHES THE DESIRED         */
*            THEN DO;             /* THEN:                           */
         MVC   @TS00001(1),GOPINFO(WORKA)                          0191
         NI    @TS00001,X'3F'                                      0191
         CLC   WKAGRPCD(1,R13),@TS00001                            0191
         BNE   @RF00191                                            0191
*              IF GOPDELET='0'B   /* IF GOP IS NOT DELETED           */
*                THEN DO;         /* THEN:                           */
         TM    GOPDELET(WORKA),B'01000000'                         0193
         BNZ   @RF00193                                            0193
*                  IF WKA1BSEQ='1'B                                0195
*                                 /* IF 1 BYTE SEQ NUMBERS ARE       */
*                                 /* IN THE GOP                      */
*                    THEN WKAHREPN=GOP1BSEQ;                       0195
         TM    WKA1BSEQ(R13),B'10000000'                           0195
         BNO   @RF00195                                            0195
         SLR   @03,@03                                             0196
         IC    @03,GOP1BSEQ(,WORKA)                                0196
         STH   @03,WKAHREPN(,R13)                                  0196
*                                 /* THEN: PICK UP THE 1 BYTE        */
*                                 /*       SEQUENCE NUMBER           */
*                    ELSE WKAHREPN=GOP2BSEQ;                       0197
         B     @RC00195                                            0197
@RF00195 MVC   WKAHREPN(2,R13),GOP2BSEQ(WORKA)                     0197
*                                 /* ELSE: PICK UP THE 2 BYTE        */
*                                 /*       SEQUENCE NUMBER           */
*                  END;           /*                                 */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00193 DS    0H                                                  0200
*              END;               /*                                 */
*            ELSE;                /* ELSE: CONTINUE                  */
*                                                                  0201
@RF00191 DS    0H                                                  0202
*          /**********************************************************/
*          /*                                                        */
*          /*     NOW THAT THIS GROUP OCCURANCE POINTER HAS          */
*          /*     BEEN CHECKED POINT AT THE NEXT GROUP               */
*          /*     OCCURANCE POINTER.                                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0202
*          WORKA=WORKA+WKAGOPLN;  /* POINT AT THE NEXT GOP           */
@RC00191 AH    WORKA,WKAGOPLN(,R13)                                0202
*          END;                   /*                                 */
         AH    WORKB,@CH00047                                      0203
@DE00190 L     @01,WKAFGOP(,R13)                                   0203
         SLR   @00,@00                                             0203
         IC    @00,CBKCTGOP(,@01)                                  0203
         CR    WORKB,@00                                           0203
         BNH   @DL00190                                            0203
*        /************************************************************/
*        /*                                                          */
*        /*     IF THERE IS AN EXTENSION POINTER THEN PLACE THE      */
*        /*     EXTENSION C.I. NUMBER SO THAT NEXT TIME THE NEW      */
*        /*     RECORD WILL BE SEARCHED. IF THERE IS NO EXTEN-       */
*        /*     SION POINTER THEN USE THE SEQUENCE NUMBER THAT       */
*        /*     HAS BEEN FOUND TO THIS POINT, AND INDICATE THAT      */
*        /*     THE LOOP IS COMPLETE.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0204
*        IF CBKEXTCI=0            /* IF THE EXTENSION POINTER        */
*                                 /* IS ZERO                         */
*          THEN WKAEXITA='1'B;    /* THEN: INDICATE THAT LOOP        */
         L     @01,WKAFGOP(,R13)                                   0204
         ICM   @00,7,CBKEXTCI(@01)                                 0204
         BNZ   @RF00204                                            0204
         OI    WKAEXITA(R13),B'00000100'                           0205
*                                 /*       IS COMPLETE               */
*          ELSE WKANEXCI=CBKEXTCI;/* ELSE: SET UP THE CI NUMBER      */
         B     @RC00204                                            0206
@RF00204 L     @01,WKAFGOP(,R13)                                   0206
         MVC   WKANEXCI(3,R13),CBKEXTCI(@01)                       0206
*                                 /*       OF THE NEXT BLOCK TO      */
*                                 /*       CHECK                     */
*        END;                     /*                                 */
@RC00204 DS    0H                                                  0208
*    END;                         /*                                 */
*                                                                  0208
@RC00186 DS    0H                                                  0208
@DE00184 TM    WKAEXITA(R13),B'00000100'                           0208
         BZ    @DL00184                                            0208
*  /******************************************************************/
*  /*                                                                */
*  /*     SETUP THE ADDRESS AND LENGTH SO THAT IT APPEARS THAT       */
*  /*     THE INFORMATION IS A FIXED FIELD IN A CATALOG RECORD.      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0209
*  WKAFNDLN=WKADTLEN;             /* SETUP THE LENGTH OF THE         */
         SLR   @03,@03                                             0209
         IC    @03,WKADTLEN(,R13)                                  0209
         STH   @03,WKAFNDLN(,R13)                                  0209
*                                 /* DESIRED FIELD                   */
*  WKAFNDAD=ADDR(WKAHREPN)+LENGTH(WKAHREPN)-WKADTLEN;              0210
         LA    @02,WKAHREPN(,R13)                                  0210
         AH    @02,@CH00200                                        0210
         SLR   @02,@03                                             0210
         ST    @02,WKAFNDAD(,R13)                                  0210
*                                 /* POINT AT THE FIELD OF THE       */
*                                 /* DESIRED LENGTH                  */
*                                                                  0211
*  /******************************************************************/
*  /*                                                                */
*  /*     SETUP THE RETURN ADDRESS TO ALLOW THE EXIT.                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0211
*  R14=WKARTNA;                   /* RESTORE RETURN ADDRESS          */
*                                                                  0211
         L     R14,WKARTNA(,R13)                                   0211
*  END PGREP;                     /* END OF PROCEDURE                */
@EL00005 DS    0H                                                  0212
@EF00005 DS    0H                                                  0212
@ER00005 BR    @14                                                 0212
@PB00005 DS    0H                                                  0213
*  GEN(EJECT);                                                     0213
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PGVAL                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = GET VALUE                                    */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THE DESIRED DATA IS FOUND IN PIECES AND RETURNED TO THE     */
*/*      CALLER WITH THE FOLLOWING MEANING FOR THE COMBINATION       */
*/*      OF THE RESULTANT INDICATORS:                                */
*/*                                                                  */
*/*        WKACMPLT='1'B & WKAFLDNE='0'B                             */
*/*          FIELD IS COMPLETE                                       */
*/*                                                                  */
*/*        WKACMPLT='1'B & WKAFLDNE='1'B & WKAFLDNF='0'B             */
*/*          THE SPECIFIED FIELD IS NOT FOUND                        */
*/*                                                                  */
*/*        WKACMPLT='1'B & WKAFLDNE='1'B & WKAFLDNF='1'B             */
*/*          THE SPECIFIED GROUP CODE IS NOT FOUND                   */
*/*                                                                  */
*/*        WKACMPLT='0'B                                             */
*/*          DATA IS PROVIDED FROM THE FIELD                         */
*/*                                                                  */
*/*      THE PROCESSING IS AS FOLLOWS:                               */
*/*                                                                  */
*/*      1. IF THE FIRST TIME THROUGH SET UP THE BASE CI NUMBER      */
*/*         AS THE ONE TO BEGIN THE SEARCH. IF THIS IS NOT THE       */
*/*         FIRST TIME THROUGH FOR THIS FIELD THEN USE THE           */
*/*         CI NUMBER OF THE RETURNED EXTENSION POINTER TO           */
*/*         CONTINUE THE SEARCH. IF THERE WAS NONE RETURNED          */
*/*         THEN INDICATE FIELD IS COMPLETE.                         */
*/*                                                                  */
*/*      2. WITH THE DESIRED CI NUMBER, GET THE ADDRESSABILITY       */
*/*         TO THE RECORD TO FIND THE FIELD IN.                      */
*/*                                                                  */
*/*      3. WITH THE DESIRED RECORD, FIND THE DESIRED DATA.          */
*/*                                                                  */
*/*      4. IF DATA RETURNED, THEN RETURN TO CALLER TO GIVE          */
*/*         THIS PORTION OF THE FIELD. IF NO DATA RETURNED, THEN     */
*/*         USE THE EXTENSION POINTER AND RETURN TO STEP 1.          */
*/*                                                                  */
*/*  ROUTINES CALLED =                                               */
*/*      PGREC                                                       */
*/*      PLVAL                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0214
*PGVAL: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0214
         B     @PB00006                                            0214
PGVAL    DS    0H                                                  0215
*  /******************************************************************/
*  /*                                                                */
*  /*     BEGIN BY SAVING THE RETURN ADDRESS AND ASSUMING THAT       */
*  /*     THE FIELD IS NOT COMPLETE.                                 */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0215
*  WKARTND=R14;                   /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTND(,R13)                                   0215
*  WKACMPLT='0'B;                 /* INDICATE THAT THE FIELD         */
*                                 /* VALUE IS NOT COMPLETE           */
*                                                                  0217
*  /******************************************************************/
*  /*                                                                */
*  /*     LOOP THROUGH THE CALLS TO PLVAL UNTIL THE FIELD IS         */
*  /*     COMPLETE OR SOME DATA FOR THE CALLER IS PROVIDED.          */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0217
*  WKAEXITB='0'B;                 /* INDICATE THAT THE LOOP IS       */
         NI    WKACMPLT(R13),B'11110101'                           0217
*                                 /* NOT COMPLETE                    */
*  DO WHILE WKAEXITB='0'B;        /* LOOP TO HANDLE THE FIELD        */
*                                                                  0218
         B     @DE00218                                            0218
@DL00218 DS    0H                                                  0219
*    /****************************************************************/
*    /*                                                              */
*    /*     CHECK TO SEE IF THE INCOMING CI NUMBER IS ZERO.          */
*    /*     IF IT IS THEN EITHER THE BEGINING OF THE FIELD           */
*    /*     HAS BEEN ENCOUNTERED AND THE BASE CI NUMBER SHOULD       */
*    /*     BE USED TO START THE SEARCH, OR IT IS THE END AND        */
*    /*     AN INDICATION THAT THE FIELD IS COMPLETE MUST BE         */
*    /*     SETUP.                                                   */
*    /****************************************************************/
*                                                                  0219
*    IF WKANEXCI=0                /* IF THERE IS NO CI NUMBER        */
*      THEN IF WKAGVFTS='1'B      /* THEN: IF THIS IS THE FIRST      */
         ICM   @03,7,WKANEXCI(R13)                                 0219
         BNZ   @RF00219                                            0219
*                                 /*       TIME THROUGH              */
*        THEN WKANEXCI=FMPLBCIN;  /* THEN: INITIALIZE THE CI         */
         TM    WKAGVFTS(R13),B'00000100'                           0220
         BNO   @RF00220                                            0220
         MVC   WKANEXCI(3,R13),FMPLBCIN(FMPLAD)                    0221
*                                 /*       NUMBER TO SRART THE       */
*                                 /*       SEARCH                    */
*        ELSE DO;                 /* ELSE:                           */
         B     @RC00220                                            0222
@RF00220 DS    0H                                                  0223
*          WKAEXITB='1'B;         /* INDICATE THAT THE SEARCH        */
*                                 /* FOR THE FIELD IS COMPLETE       */
*          WKACMPLT='1'B;         /* INDICATE THAT THE FIELD IS      */
*                                 /* COMPLETE                        */
*          WKAFLDNE='0'B;         /* INDICATE THAT THE FIELD         */
         OI    WKAEXITB(R13),B'00001010'                           0225
         NI    WKAFLDNE(R13),B'10111111'                           0225
*                                 /* DOES EXIST                      */
*          END;                   /*                                 */
*      ELSE;                      /* ELSE: CONTINUE                  */
@RF00219 DS    0H                                                  0228
*    /****************************************************************/
*    /*                                                              */
*    /*     CHECK TO SEE IF THE FIELD IS COMPLETE OR IF IT           */
*    /*     IS STILL BEING PROCESSED.                                */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0228
*    IF WKAEXITB='0'B             /* IF THE SEARCH IS REQUIRED       */
*      THEN DO;                   /* THEN:                           */
*                                                                  0228
@RC00219 TM    WKAEXITB(R13),B'00000010'                           0228
         BNZ   @RF00228                                            0228
*        /************************************************************/
*        /*                                                          */
*        /*     GO TO GET THE DESIRED CI NUMBERED RECORD SO          */
*        /*     THAT IT CAN BE SCANED FOR THE DESIRED FIELD.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0230
*        CALL PGREC;              /* GET THE DESIRED RECORD          */
         BAL   @14,PGREC                                           0230
*        IF WKARECFN='1'B         /* IF THE DESIRED RECORD WAS       */
*                                 /* RETURNED                        */
*          THEN CALL PLVAL;       /* THEN: LOCATE THE DESIRED        */
         TM    WKARECFN(R13),B'10000000'                           0231
         BNO   @RF00231                                            0231
         BAL   @14,PLVAL                                           0232
*                                 /*       VALUE                     */
*          ELSE DO;               /* ELSE:                           */
         B     @RC00231                                            0233
@RF00231 DS    0H                                                  0234
*            WKAFLDNE='1'B;       /* INDICATE THAT THE FIELD         */
*                                 /* DOES NOT EXIST                  */
*            WKAFLDNF='1'B;       /* INDICATE THAT THE GROUP         */
         OI    WKAFLDNE(R13),B'01100000'                           0235
*                                 /* CODE IS NOT FOUND               */
*            END;                 /*                                 */
*        IF WKAFLDNE='1'B                                          0237
*                                 /* IF THE FIELD DOES NOT           */
*                                 /* EXIST                           */
*          THEN DO;               /* THEN:                           */
@RC00231 TM    WKAFLDNE(R13),B'01000000'                           0237
         BNO   @RF00237                                            0237
*            WKAEXITB='1'B;       /* INDICATE THAT THE SEARCH        */
*                                 /* IS COMPLETE                     */
*            WKACMPLT='1'B;       /* INDICATE THAT THE FIELD         */
         OI    WKAEXITB(R13),B'00001010'                           0240
*                                 /* DOES NOT CONTINUE               */
*            END;                 /*                                 */
*          ELSE IF WKAFLDNF='1'B  /* ELSE: IF THERE IS NO DATA       */
*                                 /*       TO RETURN TO THE          */
*                                 /*       CALLER                    */
*            THEN;                /* THEN: CONTINUE                  */
         B     @RC00237                                            0242
@RF00237 TM    WKAFLDNF(R13),B'00100000'                           0242
         BO    @RT00242                                            0242
*            ELSE WKAEXITB='1'B;  /* ELSE: RETURN THE DATA TO        */
         OI    WKAEXITB(R13),B'00000010'                           0244
*                                 /*       THE CALLER                */
*        END;                     /*                                 */
*      ELSE;                      /* ELSE: CONTINUE                  */
@RF00228 DS    0H                                                  0247
*    END;                         /*                                 */
@RC00228 DS    0H                                                  0247
@DE00218 TM    WKAEXITB(R13),B'00000010'                           0247
         BZ    @DL00218                                            0247
*  WKAGVFTS='0'B;                 /* CLEAR THE FIRST TIME            */
         NI    WKAGVFTS(R13),B'11111011'                           0248
*                                 /* SWITCH                          */
*                                                                  0249
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP THE RETURN ADDRESS TO ALLOW EXIT                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0249
*  R14=WKARTND;                   /* RESTORE THE RETURN ADDRESS      */
         L     R14,WKARTND(,R13)                                   0249
*  END PGVAL;                     /* END OF PROCEDURE                */
@EL00006 DS    0H                                                  0250
@EF00006 DS    0H                                                  0250
@ER00006 BR    @14                                                 0250
@PB00006 DS    0H                                                  0251
*  GEN(EJECT);                                                     0251
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PLNRV                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = LOCATE NON-REPLICATED VALUES                 */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE LOCATES THE NON-REPLICATED DATA THAT IS        */
*/*      DESIRED BY THE CALLER.  THE PROCESSING IS AS FOLLOWS:       */
*/*                                                                  */
*/*      1. IF THE REQUEST IS FOR OTHER THAN THE FIRST SEQUENCE      */
*/*         NUMBER THE GROUP CODE IS NOT FOUND.                      */
*/*                                                                  */
*/*      2. CHECK TO SEE IF THE DESIRED IS PRESENT. IF NOT THEN      */
*/*         INDICATE FIELD NOT FOUND.                                */
*/*                                                                  */
*/*      3. RETURN THE ADDRESS AND THE LENGTH OF THE DESIRED         */
*/*         DATA.                                                    */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      PCKLC                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0252
*PLNRV: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0252
*                                                                  0252
         B     @PB00007                                            0252
PLNRV    DS    0H                                                  0253
*  /******************************************************************/
*  /*                                                                */
*  /*    SAVE THE RETURN ADDRESS ON ENTRY                            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0253
*  WKARTNH=R14;                   /* SAVE THE RETURN ADDRESS         */
*                                                                  0253
         ST    R14,WKARTNH(,R13)                                   0253
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE CASE WHERE IT IS FOR THE CORRECT RELREPNO        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0254
*  IF WKADRRNO=1                  /* IF THIS IS THE FIRST TIME       */
*                                 /* FOR THIS DATA                   */
*    THEN DO;                     /* THEN:                           */
         CLC   WKADRRNO(2,R13),@CH00047                            0254
         BNE   @RF00254                                            0254
*      WKAFLDNF='0'B;             /* INDICATE THAT THE GROUP         */
         NI    WKAFLDNF(R13),B'11011111'                           0256
*                                 /* HAS BEEN FOUND                  */
*      WORKD=ADDR(CBKNVLF);       /* POINT AT HEADER GROUP           */
         L     WORKD,WKABLKAD(,R13)                                0257
         LA    WORKD,CBKNVLF(,WORKD)                               0257
*                                 /* OCCURANCE                       */
*      CALL PCKLC;                /* GO TO CHECK THE EXISTANCE       */
         BAL   @14,PCKLC                                           0258
*                                 /* OF THE DATA                     */
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE THE CASE WHERE THE FIELD DOES NOT EXIST          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0259
*      IF WKAFLDNE='1'B           /* IF THE FIELD DOES NOT           */
*                                 /* EXIST                           */
*        THEN;                    /* THEN: CONTINUE                  */
*                                                                  0259
         TM    WKAFLDNE(R13),B'01000000'                           0259
         BO    @RT00259                                            0259
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE CASE WHERE THE DATA DOES EXIST             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0261
*        ELSE DO;                 /* ELSE:                           */
*          IF WKADTVAR='0'B       /* IF NOT VARIABLE LENGTH          */
*                                 /* FIELD                           */
*            THEN DO;             /* THEN:                           */
         TM    WKADTVAR(R13),B'10000000'                           0262
         BNZ   @RF00262                                            0262
*              WKAFNDAD=ADDR(CBKRD1)+WKADTSTR;                     0264
         SLR   @03,@03                                             0264
         IC    @03,WKADTSTR(,R13)                                  0264
         AL    @03,WKABLKAD(,R13)                                  0264
         ST    @03,WKAFNDAD(,R13)                                  0264
*                                 /* POINT AT THE FIXED FIELD        */
*              END;               /*                                 */
*            ELSE DO;             /* ELSE:                           */
         B     @RC00262                                            0266
@RF00262 DS    0H                                                  0267
*              WORKA=ADDR(CBKRD1)+CBKLOFX;                         0267
         L     @03,WKABLKAD(,R13)                                  0267
         SLR   WORKA,WORKA                                         0267
         IC    WORKA,CBKLOFX(,@03)                                 0267
         ALR   WORKA,@03                                           0267
*                                 /* POINT AT THE FIRST              */
*                                 /* VARIABLE LENGTH FIELD           */
*              DO WORKB=2 TO WKADTLEN;                             0268
         LA    WORKB,2                                             0268
         B     @DE00268                                            0268
@DL00268 DS    0H                                                  0269
*                                 /* LOOP TO FIND THE CORRECT        */
*                                 /* FIELD                           */
*                WORKA=ADDR(CBKDATA)+CBKVRLEN;                     0269
         LA    @03,CBKDATA(,WORKA)                                 0269
         AH    @03,CBKVRLEN(,WORKA)                                0269
         LR    WORKA,@03                                           0269
*                                 /* POINT AT THE NEXT FIELD         */
*                END;             /*                                 */
         AH    WORKB,@CH00047                                      0270
@DE00268 SLR   @03,@03                                             0270
         IC    @03,WKADTLEN(,R13)                                  0270
         CR    WORKB,@03                                           0270
         BNH   @DL00268                                            0270
*              WKAFNDLN=CBKVRLEN+LENGTH(CBKVRLEN);                 0271
         LA    @03,2                                               0271
         AH    @03,CBKVRLEN(,WORKA)                                0271
         STH   @03,WKAFNDLN(,R13)                                  0271
*                                 /* INDICATE THE LENGTH OF THE      */
*                                 /* DESIRED FIELD                   */
*              WKAFNDAD=WORKA;    /* POINT AT THE DESIRED FIELD      */
         ST    WORKA,WKAFNDAD(,R13)                                0272
*              END;               /*                                 */
*          END;                   /*                                 */
*        END;                     /*                                 */
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE THE CASE WHERE THIS IS NOT RELREPNO NUMBER 1       */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0276
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00254                                            0276
@RF00254 DS    0H                                                  0277
*      WKAFLDNE='1'B;             /* INDICATE THAT THE FIELD         */
*                                 /* DOES NOT EXIST                  */
*      WKAFLDNF='1'B;             /* INDICATE THAT THE GROUP         */
         OI    WKAFLDNE(R13),B'01100000'                           0278
*                                 /* CODE IS NOT FOUND               */
*      END;                       /*                                 */
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP THE RETURN ADDRESS TO ALLOW EXIT                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0280
*  R14=WKARTNH;                   /* RESTORE THE RETURN ADDRESS      */
@RC00254 L     R14,WKARTNH(,R13)                                   0280
*  END PLNRV;                     /* END OF PROCEDURE                */
@EL00007 DS    0H                                                  0281
@EF00007 DS    0H                                                  0281
@ER00007 BR    @14                                                 0281
@PB00007 DS    0H                                                  0282
*  GEN(EJECT);                                                     0282
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PLOC2                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = LOCATE FIELD                                 */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE PLACES THE DESIRED FIELD IN THE OUTPUT         */
*/*      AREA AND UPDATES THE FMFL TO INDICATE THAT IT IS            */
*/*      PRESENT. THE PROCESSING IS AS FOLLOWS:                      */
*/*                                                                  */
*/*      1. A LOOP IS BEGUN TO INSURE THAT THE FOLLOWING IS          */
*/*         DONE FOR ALL THE PORTIONS OF THE COMBINATION NAME.       */
*/*                                                                  */
*/*        1.1 IF THE FIELD IS FOR REPNO THEN THE NUMBER OF          */
*/*            THE HIGHEST NON-DELETED SEQUENCE NUMBER IS            */
*/*            OBTAINED AND PLACED IN THE OUTPUT AREA.               */
*/*                                                                  */
*/*        1.2 A LOOP IS BEGUN TO INSURE THAT THE COMPLETE FIELD     */
*/*            IS OBTAINED.                                          */
*/*                                                                  */
*/*           1.2.1 FIND THE NEXT PORTION OF THE DESIRED FIELD.      */
*/*                                                                  */
*/*           1.2.2 PLACE THAT PORTION INTO THE OUTPUT AREA.         */
*/*                                                                  */
*/*           1.2.3 UPDATE THE FMFL AS REQUIRED.                     */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      PGVAL                                                       */
*/*      PGREP                                                       */
*/*      PSHIN                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0283
*PLOC2: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0283
*                                                                  0283
         B     @PB00008                                            0283
PLOC2    DS    0H                                                  0284
*  /******************************************************************/
*  /*                                                                */
*  /*    SAVE THE RETURN ADDRESS ON ENTRY AND DO INITIALIZATION      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0284
*  WKARTNG=R14;                   /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTNG(,R13)                                   0284
*  WKACOMBC=0;                    /* INITIALIZE THE COMBINATION      */
         SLR   @03,@03                                             0285
         STH   @03,WKACOMBC(,R13)                                  0285
*                                 /* INDEX VALUE                     */
*  WKAEXITD='0'B;                 /* INDICATE THE LOOP IS NOT        */
         NI    WKAEXITD(R13),B'01111111'                           0286
*                                 /* COMPLETE                        */
*  /******************************************************************/
*  /*                                                                */
*  /*    LOOP UNTIL THE FIELD IS COMPLETELY PROCESSED                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0287
*  DO WHILE WKAEXITD='0'B;        /* LOOP UNTIL THE FIELD IS         */
         B     @DE00287                                            0287
@DL00287 DS    0H                                                  0288
*                                 /* COMPLETELY PLACED               */
*    WKADICTD=FMFLWKAR;           /* PLACE THE DICTIONARY            */
         MVC   WKADICTD(4,R13),FMFLWKAR(FMFLCUR)                   0288
*                                 /* INFORMATION IN WORK AREA        */
*                                                                  0289
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE THE CHARACTERISTICS OF THE COMBINATION FIELD       */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0289
*    IF WKADTCMB='1'B             /* IF THIS IS A COMBINATION        */
*                                 /* FIELD NAME                      */
*      THEN DO;                   /* THEN:                           */
         TM    WKADTCMB(R13),B'00100000'                           0289
         BNO   @RF00289                                            0289
*        WKACOMBC=WKACOMBC+1;     /* INCREMENT THE COMBINATION       */
         LA    @03,1                                               0291
         AH    @03,WKACOMBC(,R13)                                  0291
         STH   @03,WKACOMBC(,R13)                                  0291
*                                 /* INDEX VALUE                     */
*        IF WKACOMBC>=WKADTLEN    /* IF THE LAST FIELD HAS JUST      */
*                                 /* BEEN POINTED AT                 */
*          THEN WKAEXITD='1'B;    /* THEN: INDICATE THAT THE         */
         SLR   @02,@02                                             0292
         IC    @02,WKADTLEN(,R13)                                  0292
         CR    @03,@02                                             0292
         BL    @RF00292                                            0292
         OI    WKAEXITD(R13),B'10000000'                           0293
*                                 /*       LOOP IS COMPLETE          */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00292 DS    0H                                                  0295
*        WKASVGRC=WKAGRPCD;       /* SAVE THE GROUP CODE FOR         */
         MVC   WKASVGRC(1,R13),WKAGRPCD(R13)                       0295
*                                 /* ANY SPECIAL FIELD NAMES         */
*                                 /* THAT FOLLOW                     */
*        WORKA=ADDR(DCT(DCTCMB(WKACOMBC+WKADTSTR)));               0296
         SLR   @03,@03                                             0296
         IC    @03,WKADTSTR(,R13)                                  0296
         AH    @03,WKACOMBC(,R13)                                  0296
         L     @01,WKACOMBT(,R13)                                  0296
         BCTR  @01,0                                               0296
         SLR   @02,@02                                             0296
         IC    @02,DCTCMB(@03,@01)                                 0296
         SLA   @02,3                                               0296
         L     WORKA,WKADICTT(,R13)                                0296
         AL    WORKA,@CF00343                                      0296
         LA    WORKA,DCT(@02,WORKA)                                0296
*                                 /* POINT AT THE ENTRY TO GET       */
*                                 /* THE DESIRED INFORMATION         */
*        WKADICTD=DCTDINFO;                                        0297
         MVC   WKADICTD(4,R13),DCTDINFO(WORKA)                     0297
*                                 /* GET THE PRESENT DICTIONARY      */
*                                 /* INFORMATION FOR THIS FIELD      */
*        IF WKADTSPL='1'B         /* IF THIS IS A SPECIAL FIELD      */
*          THEN WKAGRPCD=WKASVGRC;/* THEN: GET THE GROUP CODE        */
         TM    WKADTSPL(R13),B'00000001'                           0298
         BNO   @RF00298                                            0298
         MVC   WKAGRPCD(1,R13),WKASVGRC(R13)                       0299
*                                 /*       FROM COMBINATION          */
*                                 /*       NAME                      */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00298 DS    0H                                                  0301
*        END;                     /*                                 */
*                                                                  0301
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE THE CHARACTERISTICS OF THE SIMPLE FIELD          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0302
*      ELSE WKAEXITD='1'B;        /* ELSE: INDICATE THAT THE         */
         B     @RC00289                                            0302
@RF00289 OI    WKAEXITD(R13),B'10000000'                           0302
*                                 /*       ONE FIELD IS ALL          */
*                                 /*       THAT IS NEEDED            */
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE THE REPNO FUNCTION                                 */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0303
*    IF WKADTSPL='1'B & WKADTSTR=CONREPNO                          0303
*                                 /* IF THE FIELD NAME WAS           */
*                                 /* REPNO                           */
*      THEN IF WKADRRNO=1 × FMFLTCHN^=0                            0303
@RC00289 TM    WKADTSPL(R13),B'00000001'                           0303
         BNO   @RF00303                                            0303
         CLI   WKADTSTR(R13),X'04'                                 0303
         BNE   @RF00303                                            0303
*                                 /* THEN: IF THIS IS THE FIRST      */
*                                 /*       TIME FOR THIS DATA        */
*                                 /*       OR THERE IS A TEST        */
*                                 /*       CHAIN                     */
*        THEN DO;                 /* THEN:                           */
         CLC   WKADRRNO(2,R13),@CH00047                            0304
         BE    @RT00304                                            0304
         ICM   @03,15,FMFLTCHN(FMFLCUR)                            0304
         BZ    @RF00304                                            0304
@RT00304 DS    0H                                                  0305
*          CALL PGREP;            /* GET THE HIGHEST NON-            */
         BAL   @14,PGREP                                           0306
*                                 /* DELETED RELREPNO FOR THE        */
*                                 /* DESIRED GROUP CODE              */
*          WKAFLDNE='0'B;         /* INDICATE THAT THE FIELD         */
*                                 /* DOES EXIST                      */
*          WKACMPLT='0'B;         /* INDICATE THAT THE FIELD IS      */
         NI    WKAFLDNE(R13),B'10110111'                           0308
*                                 /* IS NOT COMPLETE                 */
*          WKACONFG='0'B;         /* INDICATE THAT THIS IS THE       */
         NI    WKACONFG(R13),B'11111101'                           0309
*                                 /* FIRST TIME THROUGH PSHIN        */
*          CALL PSHIN;            /* PLACE THE RESULTANT VALUE       */
         BAL   @14,PSHIN                                           0310
*                                 /* IN THE WORK AREA                */
*          WKACMPLT='1'B;         /* INDICATE THAT THE FIELD IS      */
         OI    WKACMPLT(R13),B'00001000'                           0311
*                                 /* COMPLETE                        */
*          END;                   /*                                 */
*        ELSE DO;                 /* ELSE:                           */
         B     @RC00304                                            0313
@RF00304 DS    0H                                                  0314
*          WKACMPLT='1'B;         /* INDICATE THAT THE FIELD         */
*                                 /* IS COMPLETE                     */
*          WKAFLDNE='1'B;         /* INDICATE THAT THE FIELD         */
*                                 /* DOES NOT EXIST                  */
*          WKAFLDNF='1'B;         /* INDICATE THAT THE GROUP         */
         OI    WKACMPLT(R13),B'01101000'                           0316
*                                 /* CODE IS NOT FOUND               */
*          END;                   /*                                 */
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE THE PLACEMENT OF THE DATA FOR ALL BUT THE        */
*      /*    REPNO FUNCTION                                          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0318
*      ELSE DO;                   /* ELSE: CONTINUE                  */
         B     @RC00303                                            0318
@RF00303 DS    0H                                                  0319
*        WKANEXCI=0;              /* ZERO THE CI NUMBER SO THAT      */
         SLR   @03,@03                                             0319
         STCM  @03,7,WKANEXCI(R13)                                 0319
*                                 /* THE BASE CI NUMBER WILL BE      */
*                                 /* USED TO START THE SEARCH        */
*        WKACONFG='0'B;           /* INDICATE THAT THIS IS THE       */
*                                 /* FIRST TIME THROUGH PSHIN        */
*        WKAGVFTS='1'B;           /* INDICATE THAT THIS IS THE       */
         OI    WKAGVFTS(R13),B'00000100'                           0321
         NI    WKACONFG(R13),B'11111101'                           0321
*                                 /* FIRST TIME TO PGVAL FOR         */
*                                 /* THIS FIELD                      */
*        WKACMPLT='0'B;           /* INDICATE THAT THE FIELD         */
         NI    WKACMPLT(R13),B'11110111'                           0322
*                                 /* HAS NOT BEEN COMPLETELY         */
*                                 /* MOVED                           */
*        DO WHILE WKACMPLT='0'B;  /* LOOP UNTIL THE FIELD HAS        */
         B     @DE00323                                            0323
@DL00323 DS    0H                                                  0324
*                                 /* BEEN PLACED                     */
*          CALL PGVAL;            /* GET THIS PORTION OF THE         */
         BAL   @14,PGVAL                                           0324
*                                 /* FIELD                           */
*          IF WKACMPLT='1'B & WKAFLDNE='1'B & WKAFLDNF='1'B        0325
*                                 /* IF THE GROUP CODE COULD         */
*                                 /* NOT BE FOUND                    */
*            THEN;                /* THEN: CONTINUE                  */
         TM    WKACMPLT(R13),B'01101000'                           0325
         BO    @RT00325                                            0325
*            ELSE CALL PSHIN;     /* ELSE: PLACE THE FIELD IN        */
         BAL   @14,PSHIN                                           0327
*                                 /*       THE WORK AREA             */
*          WKACONFG='1'B;         /* INDICATE THAT THIS IS THE       */
@RT00325 OI    WKACONFG(R13),B'00000010'                           0328
*                                 /* N-TH TIME THROUGH PSHIN         */
*                                 /* FOR THIS FIELD                  */
*          END;                   /*                                 */
@DE00323 TM    WKACMPLT(R13),B'00001000'                           0329
         BZ    @DL00323                                            0329
*        END;                     /*                                 */
*    END;                         /*                                 */
*                                                                  0331
@RC00303 DS    0H                                                  0331
@DE00287 TM    WKAEXITD(R13),B'10000000'                           0331
         BZ    @DL00287                                            0331
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP THE RETURN ADDRESS TO ALLOW EXIT                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0332
*  R14=WKARTNG;                   /* RESTORE THE RETURN ADDRESS      */
         L     R14,WKARTNG(,R13)                                   0332
*  END PLOC2;                     /* END OF PROCEDURE                */
@EL00008 DS    0H                                                  0333
@EF00008 DS    0H                                                  0333
@ER00008 BR    @14                                                 0333
@PB00008 DS    0H                                                  0334
*  GEN(EJECT);                                                     0334
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PLVAL                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = LOCATE FIELD VALUE                           */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS SUB-FUNCTION LOCATES A REPEATING OR NON-REPEATING      */
*/*      FIXED LENGTH OF VARIABLE LENGTH CATALOG FIELD WITHIN        */
*/*      A GIVEN PHYSICAL RECORD AND IN A PARTICULAR GROUP           */
*/*      OCCURANCE.                                                  */
*/*                                                                  */
*/*      THE FOLLOWING IS THE MEANING OF THE COMBINATION OF THE      */
*/*      RESULTANT INDICATORS:                                       */
*/*                                                                  */
*/*        WKAFLDNE='0'B & WKAFLDNF='0'B                             */
*/*          FIELD DATA AND MAYBE AN EXTENSION POINTER               */
*/*                                                                  */
*/*        WKAFLDNE='0'B & WKAFLDNF='1'B                             */
*/*          EXTENSION POINTER                                       */
*/*                                                                  */
*/*        WKAFLDNE='1'B & WKAFLDNF='0'B                             */
*/*          SPECIFIED FIELD NOT FOUND                               */
*/*                                                                  */
*/*        WKAFLDNE='1'B & WKAFLDNF='1'B                             */
*/*          SPECIFIED GROUP CODE NOT FOUND                          */
*/*                                                                  */
*/*      THE PROCESSING IS AS FOLLOWS:                               */
*/*                                                                  */
*/*      1. IF THE FIELD IS NON-REPEATING, CALL PCKLC TO SEE IF      */
*/*         THE FIELD EXISTS. IF IT DOES THEN LOCATE THE FIELD,      */
*/*         ELSE INDICATE FIELD IS NOT EXISTENT.                     */
*/*                                                                  */
*/*      2. OTHERWISE, SCAN THE GROUP OCCURANCE POINTERS FOR         */
*/*         DESIRED OCCURANCE SEQUENCE NUMBER (DELETED SEQUENCE      */
*/*         NUMBERS ARE SKIPPED).                                    */
*/*                                                                  */
*/*         IF THE CORRECT OCCURANCE IS NOT FORND THEN SET           */
*/*         THE FIELD NOT EXISTENT INDICATOR.                        */
*/*                                                                  */
*/*         IF THE FIELD IS RELREPNO THEN PASS THE UPDATED           */
*/*         OCCURANCE SEQUENCE NUMBER.                               */
*/*                                                                  */
*/*         IF THE OCCURANCE POINTER POINTS TO ANOTHER PHYSICAL      */
*/*         RECORD, THEN PASS THE VERTICAL POINTER AND A FIELD       */
*/*         NOT FOUND INDICATOR BACK.                                */
*/*                                                                  */
*/*         OTHERWISE, CALL PCKLC TO INSURE THE FIELD DOES           */
*/*         EXIST. IF IT DOES THEN LOCATE THE FIELD ELSE             */
*/*         INDICATE FIELD DOES NOT EXIST.                           */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      PCKLC                                                       */
*/*      PEXPT                                                       */
*/*      PLNRV                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0335
*PLVAL: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0335
*                                                                  0335
         B     @PB00009                                            0335
PLVAL    DS    0H                                                  0336
*  /******************************************************************/
*  /*                                                                */
*  /*    SAVE THE RETURN ADDRESS ON ENTRY AND INITIALIZE TO          */
*  /*    PROCESS THE FIELD                                           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0336
*  WKARTNC=R14;                   /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTNC(,R13)                                   0336
*  WKANEXCI=0;                    /* ZERO THE EXTENSION CI           */
         SLR   @03,@03                                             0337
         STCM  @03,7,WKANEXCI(R13)                                 0337
*                                 /* NUMBER                          */
*  WKAFNDLN=WKADTLEN;             /* INITIALIZE THE LENGTH AS        */
         SLR   @03,@03                                             0338
         IC    @03,WKADTLEN(,R13)                                  0338
         STH   @03,WKAFNDLN(,R13)                                  0338
*                                 /* IF IT WERE FIXED LENGTH         */
*  WKAFLDNE='0'B;                 /* INDICATE THAT THE FIELD         */
         NI    WKAFLDNE(R13),B'10111111'                           0339
*                                 /* DOES EXIST                      */
*                                                                  0340
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE PROCESSING FOR REPLICATED FIELD                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0340
*  IF WKADTREP='1'B               /* IF THE FIELD IS REPLICATED      */
*    THEN DO;                     /* THEN:                           */
         TM    WKADTREP(R13),B'01000000'                           0340
         BNO   @RF00340                                            0340
*      WKAFLDNF='1'B;             /* INDICATE FIELD NOT FOUND        */
*                                                                  0342
         OI    WKAFLDNF(R13),B'00100000'                           0342
*      /**************************************************************/
*      /*                                                            */
*      /*    EXIT OUT IF THERE IS REPLICATED FIELDS NEEDED FROM      */
*      /*    FREE OR CCR RECORDS                                     */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0343
*      IF WKAFORL='1'B            /* IF RECORD IS F OR L TYPE        */
*        THEN DO;                 /* THEN:                           */
         TM    WKAFORL(R13),B'00000001'                            0343
         BNO   @RF00343                                            0343
*          WKAFLDNE='1'B;         /* INDICATE FIELD DOES NOT EXIST   */
         OI    WKAFLDNE(R13),B'01000000'                           0345
*          R14=WKARTNC;           /* RESTORE RETURN ADDRESS          */
         L     @03,WKARTNC(,R13)                                   0346
         LR    R14,@03                                             0346
*          RETURN;                /* RETURN TO CALLER                */
@EL00009 DS    0H                                                  0347
@EF00009 DS    0H                                                  0347
@ER00009 BR    @14                                                 0347
*          END;                   /*                                 */
*        ELSE;                    /* ELSE: CONTINUE                  */
*                                                                  0349
@RF00343 DS    0H                                                  0350
*      /**************************************************************/
*      /*                                                            */
*      /*    LOOP THROUGH THE GOP'S TO FIND THE CORRECT ONE          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0350
*      WORKA=ADDR(CBKFGOP);       /* POINT AT THE FIRST GOP          */
         L     WORKA,WKAFGOP(,R13)                                 0350
         LA    WORKA,CBKFGOP(,WORKA)                               0350
*      DO WORKB=1 TO CBKCTGOP     /* LOOP THROUGH ALL THE GOP'S      */
*         WHILE WKAFLDNF='1'B;    /* OR UNTIL THE SPECIFIC GOP       */
         LA    WORKB,1                                             0351
         B     @DE00351                                            0351
@DL00351 TM    WKAFLDNF(R13),B'00100000'                           0351
         BNO   @DC00351                                            0351
*                                 /* IS FOUND                        */
*        /************************************************************/
*        /*                                                          */
*        /*    PICK UP THE SEQUENCE NUMBER FOR THIS ENTRY            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0352
*        IF WKA1BSEQ='1'B         /* IF THE SEQUENCE NUMBER IS       */
*                                 /* 1 BYTE IN LENGTH                */
*          THEN WKASEQNO=GOP1BSEQ;/* THEN: PICK UP A 1 BYTE          */
         TM    WKA1BSEQ(R13),B'10000000'                           0352
         BNO   @RF00352                                            0352
         SLR   @03,@03                                             0353
         IC    @03,GOP1BSEQ(,WORKA)                                0353
         STH   @03,WKASEQNO(,R13)                                  0353
*                                 /*       SEQUENCE NUMBER           */
*          ELSE WKASEQNO=GOP2BSEQ;/* ELSE: PICK UP A 2 BYTE          */
         B     @RC00352                                            0354
@RF00352 MVC   WKASEQNO(2,R13),GOP2BSEQ(WORKA)                     0354
*                                 /*       SEQUENCE NUMBER           */
*                                                                  0355
*        /************************************************************/
*        /*                                                          */
*        /*    CHECK THIS GROUP CODE FOR THE CORRECT ONE             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0355
*        IF WKAGRPCD=(GOPINFO&CONTRUGC)                            0355
*                                 /* IF THE DESIRED GROUP CODE       */
*                                 /* IS FOUND                        */
*          THEN IF WKASEQNO=WKADRRNO                               0355
@RC00352 MVC   @TS00001(1),GOPINFO(WORKA)                          0355
         NI    @TS00001,X'3F'                                      0355
         CLC   WKAGRPCD(1,R13),@TS00001                            0355
         BNE   @RF00355                                            0355
*                                 /* THEN: IF THE DESIRED            */
*                                 /*       SEQUENCE NUMBER IS        */
*                                 /*       FOUND                     */
*            THEN IF GOPDELET='1'B                                 0356
         LH    @03,WKADRRNO(,R13)                                  0356
         CH    @03,WKASEQNO(,R13)                                  0356
         BNE   @RF00356                                            0356
*                                 /* THEN: IF GOP IS DELETED         */
*              THEN WKADRRNO=WKADRRNO+1;                           0357
         TM    GOPDELET(WORKA),B'01000000'                         0357
         BNO   @RF00357                                            0357
         AH    @03,@CH00047                                        0358
         STH   @03,WKADRRNO(,R13)                                  0358
*                                 /* THEN: SKIP TO THE NEXT          */
*                                 /*       SEQUENCE NUMBER           */
*              ELSE WKAFLDNF='0'B;/* ELSE: INDICATE THAT THE         */
         B     @RC00357                                            0359
@RF00357 NI    WKAFLDNF(R13),B'11011111'                           0359
*                                 /*       FIELD IS FOUND            */
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00356 DS    0H                                                  0361
*          ELSE;                  /* ELSE: CONTINUE                  */
*                                                                  0361
@RF00355 DS    0H                                                  0362
*        /************************************************************/
*        /*                                                          */
*        /*    IF THE GOP HAS NOT BEEN FOUND POINT AT NEXT ONE       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0362
*        IF WKAFLDNF='1'B         /* IF FIELD IS NOT FOUND           */
*          THEN WORKA=WORKA+WKAGOPLN;                              0362
@RC00355 TM    WKAFLDNF(R13),B'00100000'                           0362
         BNO   @RF00362                                            0362
         AH    WORKA,WKAGOPLN(,R13)                                0363
*                                 /* THEN: POINT AT THE NEXT         */
*                                 /*       GOP                       */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00362 DS    0H                                                  0365
*        END;                     /*                                 */
         AH    WORKB,@CH00047                                      0365
@DE00351 L     @01,WKAFGOP(,R13)                                   0365
         SLR   @00,@00                                             0365
         IC    @00,CBKCTGOP(,@01)                                  0365
         CR    WORKB,@00                                           0365
         BNH   @DL00351                                            0365
@DC00351 DS    0H                                                  0366
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE PROCESSING OF THE HORIZONTAL EXTENSION           */
*      /*    POINTER IF FIELD NOT FOUND                              */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0366
*      IF WKAFLDNF='1'B           /* IF FIELD IS NOT FOUND           */
*        THEN DO;                 /* THEN:                           */
         TM    WKAFLDNF(R13),B'00100000'                           0366
         BNO   @RF00366                                            0366
*          WKANEXCI=CBKEXTCI;     /* POINT AT THE HORIZONTIAL        */
         L     @01,WKAFGOP(,R13)                                   0368
         MVC   WKANEXCI(3,R13),CBKEXTCI(@01)                       0368
*                                 /* EXTENSION RECORD                */
*          IF WKANEXCI^=0         /* IF THE EXTENSION POINTER        */
*                                 /* IS NOT ZERO                     */
*            THEN;                /* THEN: CONTINUE                  */
         ICM   @03,7,WKANEXCI(R13)                                 0369
         BNZ   @RT00369                                            0369
*            ELSE WKAFLDNE='1'B;  /* ELSE: INDICATE THAT THE         */
         OI    WKAFLDNE(R13),B'01000000'                           0371
*                                 /*       FIELD DOES NOT EXIST      */
*          END;                   /*                                 */
*                                                                  0372
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE RELREPNO FUNCTION                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0373
*        ELSE IF WKADTSPL='1'B & WKADTSTR=CONRRPNO                 0373
*                                 /* ELSE: IF THE SEQUENCE           */
*                                 /*       NUMBER FUNCTION WAS       */
*                                 /*       SPECIFIED                 */
*          THEN DO;               /* THEN:                           */
         B     @RC00366                                            0373
@RF00366 TM    WKADTSPL(R13),B'00000001'                           0373
         BNO   @RF00373                                            0373
         CLI   WKADTSTR(R13),X'03'                                 0373
         BNE   @RF00373                                            0373
*            WKAFNDAD=ADDR(WKASEQNO)+LENGTH(WKASEQNO)-WKADTLEN;    0375
         LA    @03,WKASEQNO(,R13)                                  0375
         AH    @03,@CH00200                                        0375
         SLR   @02,@02                                             0375
         IC    @02,WKADTLEN(,R13)                                  0375
         SLR   @03,@02                                             0375
         ST    @03,WKAFNDAD(,R13)                                  0375
*                                 /* COMPUTE ADDRESS OF THE          */
*                                 /* SEQUENCE NUMBER FIELD           */
*            END;                 /*                                 */
*                                                                  0376
*          /**********************************************************/
*          /*                                                        */
*          /*    HANDLE THE VERTICAL EXTENSION POINTER               */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0377
*          ELSE IF GOPEXTPT='1'B  /* ELSE: IF GOP IS A VERTICAL      */
*                                 /*       EXTENSION POINTER         */
*            THEN DO;             /* THEN:                           */
         B     @RC00373                                            0377
@RF00373 TM    GOPEXTPT(WORKA),B'10000000'                         0377
         BNO   @RF00377                                            0377
*              WKAFLDNF='1'B;     /* INDICATE THAT THE FIELD IS      */
         OI    WKAFLDNF(R13),B'00100000'                           0379
*                                 /* NOT FOUND                       */
*              WKANEXCI=GOPCINO;  /* PICK UP THE VERTICAL            */
         MVC   WKANEXCI(3,R13),GOPCINO(WORKA)                      0380
*                                 /* EXTENSION CI NUMBER             */
*              END;               /*                                 */
*            /********************************************************/
*            /*                                                      */
*            /*    HANDLE ALL OTHER FIELDS                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0382
*            ELSE DO;             /* ELSE:                           */
         B     @RC00377                                            0382
@RF00377 DS    0H                                                  0383
*              WORKD=WKAGODTA+GOPDISP;                             0383
         LH    WORKD,GOPDISP(,WORKA)                               0383
         AL    WORKD,WKAGODTA(,R13)                                0383
*                                 /* POINT AT GROUP OCCURANCE        */
*              CALL PCKLC;        /* GO TO CHECK THE REQUESTED       */
         BAL   @14,PCKLC                                           0384
*                                 /* FIELD PRESENCE                  */
*              IF WKAFLDNE='0'B   /* IF THE FIELD EXISTS             */
*                THEN DO;         /* THEN:                           */
         TM    WKAFLDNE(R13),B'01000000'                           0385
         BNZ   @RF00385                                            0385
*                  WKANEXCI=CBKEXTCI;                              0387
         L     @01,WKAFGOP(,R13)                                   0387
         MVC   WKANEXCI(3,R13),CBKEXTCI(@01)                       0387
*                                 /* SAVE THE EXTENSION CI           */
*                                 /* NUMBER                          */
*                  IF WKADTVAR='0'B                                0388
*                                 /* IF NOT VARIABLE FIELD           */
*                    THEN DO;     /* THEN:                           */
         TM    WKADTVAR(R13),B'10000000'                           0388
         BNZ   @RF00388                                            0388
*                      WKAFNDAD=WORKD+WKADTSTR;                    0390
         LR    @03,WORKD                                           0390
         SLR   @02,@02                                             0390
         IC    @02,WKADTSTR(,R13)                                  0390
         ALR   @03,@02                                             0390
         ST    @03,WKAFNDAD(,R13)                                  0390
*                                 /* POINT AT START OF FOUND         */
*                                 /* DATA FIELD                      */
*                      WKANEXCI=0;/* ZERO THE EXTENSION CI           */
         SLR   @03,@03                                             0391
         STCM  @03,7,WKANEXCI(R13)                                 0391
*                                 /* NUMBER                          */
*                      END;       /*                                 */
*                    ELSE DO;     /* ELSE:                           */
         B     @RC00388                                            0393
@RF00388 DS    0H                                                  0394
*                      WORKA=WORKD+CBKFXDLN;                       0394
         LR    WORKA,WORKD                                         0394
         SLR   @03,@03                                             0394
         IC    @03,CBKFXDLN(,WORKD)                                0394
         ALR   WORKA,@03                                           0394
*                                 /* POINT AT FIRST VARIABLE         */
*                                 /* FIELD                           */
*                      DO WORKB=2 TO WKADTLEN;                     0395
         LA    WORKB,2                                             0395
         B     @DE00395                                            0395
@DL00395 DS    0H                                                  0396
*                                 /* LOOP TO FIND CORRECT FIELD      */
*                        WORKA=ADDR(CBKDATA)+CBKVRLEN;             0396
         LA    @03,CBKDATA(,WORKA)                                 0396
         AH    @03,CBKVRLEN(,WORKA)                                0396
         LR    WORKA,@03                                           0396
*                                 /* POINT AT NEXT FIELD             */
*                        END;     /*                                 */
         AH    WORKB,@CH00047                                      0397
@DE00395 SLR   @03,@03                                             0397
         IC    @03,WKADTLEN(,R13)                                  0397
         CR    WORKB,@03                                           0397
         BNH   @DL00395                                            0397
*                      WKAFNDLN=CBKVRLEN+LENGTH(CBKVRLEN);         0398
         LA    @03,2                                               0398
         AH    @03,CBKVRLEN(,WORKA)                                0398
         STH   @03,WKAFNDLN(,R13)                                  0398
*                                 /* COMPUTE LENGTH OF FIELD         */
*                      WKAFNDAD=WORKA;                             0399
         ST    WORKA,WKAFNDAD(,R13)                                0399
*                                 /* POINT AT FIELD                  */
*                      END;       /*                                 */
*                  END;           /*                                 */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00385 DS    0H                                                  0403
*              END;               /*                                 */
*      END;                       /*                                 */
*                                                                  0404
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE NON-REPLICATED EXTENSION POINTERS                  */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0405
*    ELSE IF WKADTEPT='1'B        /* ELSE: IF EXTENSION POINTER      */
*                                 /*       FUNCTION                  */
*      THEN CALL PEXPT;           /* THEN: GET THE EXTENSION         */
         B     @RC00340                                            0405
@RF00340 TM    WKADTEPT(R13),B'00000010'                           0405
         BNO   @RF00405                                            0405
         BAL   @14,PEXPT                                           0406
*                                 /*       CI NUMBERS                */
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE OTHER NON-REPLICATED FIELDS                      */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0407
*      ELSE CALL PLNRV;           /* ELSE: GET THE NON-REPLI-        */
         B     @RC00405                                            0407
@RF00405 BAL   @14,PLNRV                                           0407
*                                 /*       CATED VALUE               */
*                                                                  0408
*  /******************************************************************/
*  /*                                                                */
*  /*    RESTORE THE RETURN ADDRESS TO PREPARE FOR EXIT              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0408
*  R14=WKARTNC;                   /* RESTORE THE RETURN ADDRESS      */
@RC00405 DS    0H                                                  0408
@RC00340 L     R14,WKARTNC(,R13)                                   0408
*  END PLVAL;                     /* END OF PROCEDURE                */
         B     @EL00009                                            0409
@PB00009 DS    0H                                                  0410
*  GEN(EJECT);                                                     0410
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PSCNC                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME =  SCAN THE REQUEST LIST                       */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE GOES THROUGH ALL OF THE FMFL'S TO TRANSLATE    */
*/*      THE NAMES INTO THE CORRECT INDICATORS FOR FIELD             */
*/*      MANAGEMENT TO USE.                                          */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      PTRNS                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0411
*PSCNC: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0411
*                                                                  0411
         B     @PB00010                                            0411
PSCNC    DS    0H                                                  0412
*  WKARTNE=R14;                   /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTNE(,R13)                                   0412
*  FMPLRTCD=RTNCDNML;             /* INITIALIZE THE NORMAL           */
         MVI   FMPLRTCD(FMPLAD),X'00'                              0413
*                                 /* RETURN CODE                     */
*  DO WORKC = 1 TO FMPLFLNO;      /* LOOP THROUGH ALL OF THE         */
         LA    WORKC,1                                             0414
         B     @DE00414                                            0414
@DL00414 DS    0H                                                  0415
*                                 /* FMFL'S TO CONVERT THE NAME      */
*                                 /* TO INTERNAL NOTATION            */
*    WKATSTFL='0'B;               /* INDICATE THAT THIS IS NOT       */
         NI    WKATSTFL(R13),B'11110111'                           0415
*                                 /* A TEST FMFL                     */
*    FMFLCUR=FMPLFMFL(WORKC);     /* POINT AT THE NON-TEST           */
         LR    @03,WORKC                                           0416
         SLA   @03,2                                               0416
         L     FMFLCUR,FMPLFMFL-4(@03,FMPLAD)                      0416
*                                 /* FMFL                            */
*    DO WHILE FMFLCUR^=0 & FMPLRTCD=RTNCDNML;                      0417
         B     @DE00417                                            0417
@DL00417 DS    0H                                                  0418
*                                 /* LOOP THROUGH ALL FMFL'S IN      */
*                                 /* THE CHAIN INCLUDING THE         */
*                                 /* TEST FMFL'S AS LONG AS          */
*                                 /* THERE IS NO ERRORS              */
*      CALL PTRNS;                /* GO TO CONVERT THE NAME TO       */
         BAL   @14,PTRNS                                           0418
*                                 /* INTERNAL NOTATION               */
*      FMFLCUR=FMFLTCHN;          /* POINT AT THE NEXT TEST          */
         L     FMFLCUR,FMFLTCHN(,FMFLCUR)                          0419
*                                 /* FMFL                            */
*      WKATSTFL='1'B;             /* INDICATE THAT THIS FMFL IS      */
         OI    WKATSTFL(R13),B'00001000'                           0420
*                                 /* A TEST FMFL                     */
*      END;                       /*                                 */
@DE00417 LTR   FMFLCUR,FMFLCUR                                     0421
         BZ    @DC00417                                            0421
         CLI   FMPLRTCD(FMPLAD),0                                  0421
         BE    @DL00417                                            0421
@DC00417 DS    0H                                                  0422
*    END;                         /*                                 */
         AH    WORKC,@CH00047                                      0422
@DE00414 SLR   @03,@03                                             0422
         IC    @03,FMPLFLNO(,FMPLAD)                               0422
         CR    WORKC,@03                                           0422
         BNH   @DL00414                                            0422
*  R14=WKARTNE;                   /* RESTORE THE RETURN ADDRESS      */
*                                                                  0423
         L     R14,WKARTNE(,R13)                                   0423
*  END PSCNC;                     /* END OF PROCEDURE                */
@EL00010 DS    0H                                                  0424
@EF00010 DS    0H                                                  0424
@ER00010 BR    @14                                                 0424
@PB00010 DS    0H                                                  0425
*  GEN(EJECT);                                                     0425
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PSCNF                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = SCAN TO DO FUNCTION                          */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE LOOPS THROUGH ALL THE FMFL'S DOING THE         */
*/*      TESTS AND LOCATING THE FIELDS TO BE PLACED IN THEM.         */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      PLOC2                                                       */
*/*      PTSTS                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0426
*PSCNF: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0426
*                                                                  0426
         B     @PB00011                                            0426
PSCNF    DS    0H                                                  0427
*  /******************************************************************/
*  /*                                                                */
*  /*    SAVE THE RETURN ADDRESS ON ENTRY AND CHECK THE OUTPUT       */
*  /*    AREA FOR THE SIZE TO BEGIN                                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0427
*  WKARTNF=R14;                   /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTNF(,R13)                                   0427
*  WKAAREAP=FMPLOAR+LENGTH(FOALENTH);                              0428
         LA    @03,2                                               0428
         L     @02,FMPLOAR(,FMPLAD)                                0428
         LR    @01,@02                                             0428
         ALR   @01,@03                                             0428
         ST    @01,WKAAREAP(,R13)                                  0428
*                                 /* POINT AT THE FIRST BYTE IN      */
*                                 /* THE OUTPUT AREA TO USE          */
*  WKAAREAS=FMPLENTH-LENGTH(FOALENTH);                             0429
         LH    @01,FMPLENTH(,FMPLAD)                               0429
         LR    @00,@01                                             0429
         SLR   @00,@03                                             0429
         STH   @00,WKAAREAS(,R13)                                  0429
*                                 /* SETUP THE LENGTH OF THE         */
*                                 /* OUTPUT AREA STILL REMAIN-       */
*                                 /* ING TO BE USED                  */
*  IF FMPLENTH>LENGTH(FOALENTH)   /* IF THERE IS ROOM TO START       */
*    THEN DO;                     /* THEN:                           */
         CR    @01,@03                                             0430
         BNH   @RF00430                                            0430
*      FOALENTH=LENGTH(FOALENTH); /* SETUP THE LENGTH OF THE         */
         STH   @03,FOALENTH(,@02)                                  0432
*                                 /* OUTPUT AREA THAT HAS BEEN       */
*                                 /* USED                            */
*      WKAFMFLI=1;                /* INITIALIZE THE FIELD LIST       */
         MVC   WKAFMFLI(2,R13),@CH00047                            0433
*                                 /* INDEX VALUE                     */
*                                                                  0434
*      /**************************************************************/
*      /*                                                            */
*      /*    LOOP THROUGH ALL OF THE FMFL'S IN THE FMPL              */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0434
*      DO WHILE WKAFMFLI<=FMPLFLNO;                                0434
         B     @DE00434                                            0434
@DL00434 DS    0H                                                  0435
*                                 /* LOOP TO PROCESS THE FIELD       */
*                                 /* LISTS                           */
*        WKADRRNO=1;              /* INITIALIZE THE DESIRED          */
         MVC   WKADRRNO(2,R13),@CH00047                            0435
*                                 /* RELREPNO                        */
*        WKAEXITC='0'B;           /* INITIALIZE THE LOOP             */
         NI    WKAEXITC(R13),B'11111110'                           0436
*                                 /* LOOP CONTROL INDICATOR          */
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE ALL OF THE RELREPNO'S FOR THIS FMFL            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0437
*        DO WHILE WKAEXITC='0'B;  /* LOOP THROUGH THE DESIRED        */
         B     @DE00437                                            0437
@DL00437 DS    0H                                                  0438
*                                 /* RELREPNO'S FOR THE FIELD        */
*          FMFLCUR=FMPLFMFL(WKAFMFLI);                             0438
         LH    @03,WKAFMFLI(,R13)                                  0438
         SLA   @03,2                                               0438
         L     FMFLCUR,FMPLFMFL-4(@03,FMPLAD)                      0438
*                                 /* POINT AT THE APPROPIATE         */
*                                 /* FIELD LIST TO PROCESS           */
*          CALL PTSTS;            /* HANDLE ANY TEST FIELD           */
         BAL   @14,PTSTS                                           0439
*                                 /* LISTS IF THERE IS ANY           */
*          IF WKAFSUCC='1'B       /* IF THE FIELD IS A SUCCESS       */
*            THEN DO;             /* THEN:                           */
         TM    WKAFSUCC(R13),B'00010000'                           0440
         BNO   @RF00440                                            0440
*              FMFLCUR=FMPLFMFL(WKAFMFLI);                         0442
         LH    @03,WKAFMFLI(,R13)                                  0442
         SLA   @03,2                                               0442
         L     FMFLCUR,FMPLFMFL-4(@03,FMPLAD)                      0442
*                                 /* POINT AT THE APPROPIATE         */
*                                 /* FIELD LIST TO PROCESS           */
*                                 /* FOR THIS RELREPNO               */
*              CALL PLOC2;        /* PLACE THE FIELD IN THE          */
         BAL   @14,PLOC2                                           0443
*                                 /* OUTPUT AREA                     */
*              END;               /*                                 */
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00440 DS    0H                                                  0446
*          IF WKACMPLT='1'B & WKAFLDNE='1'B & WKAFLDNF='1'B        0446
*                                 /* IF THE GROUP CODE IS NOT        */
*                                 /* FOUND                           */
*            THEN WKAEXITC='1'B;  /* THEN: INDICATE THAT THE         */
         TM    WKACMPLT(R13),B'01101000'                           0446
         BNO   @RF00446                                            0446
         OI    WKAEXITC(R13),B'00000001'                           0447
*                                 /*       FMFL HAS BEEN             */
*                                 /*       COMPLETED                 */
*            ELSE WKADRRNO=WKADRRNO+1;                             0448
         B     @RC00446                                            0448
@RF00446 LA    @03,1                                               0448
         AH    @03,WKADRRNO(,R13)                                  0448
         STH   @03,WKADRRNO(,R13)                                  0448
*                                 /* ELSE: COMPUTE THE NEXT          */
*                                 /*       RELREPNO TO TRY           */
*          END;                   /*                                 */
*                                                                  0449
@RC00446 DS    0H                                                  0449
@DE00437 TM    WKAEXITC(R13),B'00000001'                           0449
         BZ    @DL00437                                            0449
*        /************************************************************/
*        /*                                                          */
*        /*    POINT AT NEXT FMFL IN FMPL                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0450
*        WKAFMFLI=WKAFMFLI+1;     /* POINT AT THE NEXT FIELD         */
         LA    @03,1                                               0450
         AH    @03,WKAFMFLI(,R13)                                  0450
         STH   @03,WKAFMFLI(,R13)                                  0450
*                                 /* LIST POINTER IN PARAMETER       */
*                                 /* LIST                            */
*        END;                     /*                                 */
@DE00434 LH    @03,WKAFMFLI(,R13)                                  0451
         SLR   @02,@02                                             0451
         IC    @02,FMPLFLNO(,FMPLAD)                               0451
         CR    @03,@02                                             0451
         BNH   @DL00434                                            0451
*      END;                       /*                                 */
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE THE BAD OUTPUT AREA LENGTH                         */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0453
*    ELSE FMPLRTCD=RTNCDISL;      /* ELSE: INDICATE THAT THE         */
         B     @RC00430                                            0453
@RF00430 MVI   FMPLRTCD(FMPLAD),X'14'                              0453
*                                 /*       OUTPUT AREA IS TOO        */
*                                 /*       SMALL                     */
*                                                                  0454
*  /******************************************************************/
*  /*                                                                */
*  /*    RESTORE THE RETURN ADDRESS TO ALLOW EXIT                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0454
*  R14=WKARTNF;                   /* RESTORE THE RETURN ADDRESS      */
@RC00430 L     R14,WKARTNF(,R13)                                   0454
*  END PSCNF;                     /* END OF PROCEDURE                */
@EL00011 DS    0H                                                  0455
@EF00011 DS    0H                                                  0455
@ER00011 BR    @14                                                 0455
@PB00011 DS    0H                                                  0456
*  GEN(EJECT);                                                     0456
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PSHIN                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = FIELD DATA INSERT                            */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE PLACES THE DATA IN THE OUTPUT AREA AND         */
*/*      UPDATES THE FMFL'S TO INDICATE THAT FACT.  THIS ROUTINE     */
*/*      TAKES INTO ACOUNT THAT THE FIELDS MAY BE BROKEN INTO        */
*/*      PIECES.                                                     */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      NONE                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0457
*PSHIN: PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);                      0457
*                                                                  0457
         B     @PB00012                                            0457
PSHIN    DS    0H                                                  0458
*  DCL CHR        CHAR(512) BASED(WKAAREAP);                       0458
*                                 /* VARIABLE USED TO RECIEVE        */
*                                 /* THE DATA INTO THE CALLERS       */
*                                 /* WORK AREA                       */
*  DCL CHRI       CHAR(512) BASED(WKAFNDAD);                       0459
*                                 /* VARIABLE USED TO SEND THE       */
*                                 /* THE CATALOG RECORD DATA         */
*                                 /* FROM IN THE RECORD IN           */
*                                 /* WHICH IT IS FOUND               */
*                                                                  0460
*                                                                  0460
*  /******************************************************************/
*  /*                                                                */
*  /*    CHECK TO SEE IF THE FIELD IS NON-EXISTENT OR IT IS          */
*  /*    THE NORMAL TERMINATION OF A SEGMENTED FIELD                 */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0460
*  IF WKACMPLT='1'B & WKAFLDNE='0'B                                0460
*                                 /* IF A PARTIAL FIELD HAS          */
*                                 /* BEEN PLACED AND THE FIELD       */
*                                 /* IS NON-EXISTENT                 */
*    THEN;                        /* THEN: CONTINUE                  */
         TM    WKACMPLT(R13),B'00001000'                           0460
         BNO   @RF00460                                            0460
         TM    WKAFLDNE(R13),B'01000000'                           0460
         BZ    @RT00460                                            0460
*    /****************************************************************/
*    /*                                                              */
*    /*     IF THE FIELD IS NON-EXISTENT THE APPROPIATE              */
*    /*     SETUP TO HANDLE THEM MUST BE DONE. FOR A VARIABLE        */
*    /*     LENGTH FIELD A COUNT FIELD OF ZERO IS SUPPLIED,          */
*    /*     AND FOR A FIXED LENGTH FIELD THE LENGTH IS SETUP         */
*    /*     AND THE FIELD IS HANDLED LATER.                          */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0462
*    ELSE DO;                     /* ELSE:                           */
@RF00460 DS    0H                                                  0463
*      IF WKACMPLT='1'B & WKAFLDNE='1'B                            0463
*                                 /* IF THE FIELD DOES NOT           */
*                                 /* EXIST                           */
*        THEN IF WKADTVAR='1'B    /* THEN: IF VARIABLE LENGTH        */
         TM    WKACMPLT(R13),B'01001000'                           0463
         BNO   @RF00463                                            0463
*                                 /*       FIELD                     */
*          THEN DO;               /* THEN:                           */
         TM    WKADTVAR(R13),B'10000000'                           0464
         BNO   @RF00464                                            0464
*            WKAFNDAD=ADDR('0000'X);                               0466
         LA    @03,@CB00283                                        0466
         ST    @03,WKAFNDAD(,R13)                                  0466
*                                 /* POINT AT A VARIABLE             */
*                                 /* LENGTH NULL FIELD               */
*            WKAFNDLN=LENGTH('0000'X);                             0467
         MVC   WKAFNDLN(2,R13),@CH00171                            0467
*                                 /* SETUP LENGTH OF VARIABLE        */
*                                 /* LENGTH NULL FIELD               */
*            END;                 /*                                 */
*          ELSE WKAFNDLN=WKADTLEN;                                 0469
         B     @RC00464                                            0469
@RF00464 SLR   @03,@03                                             0469
         IC    @03,WKADTLEN(,R13)                                  0469
         STH   @03,WKAFNDLN(,R13)                                  0469
*                                 /* ELSE: INDICATE THE LENGTH       */
*                                 /*       OF THE FIXED FIELD        */
*        ELSE;                    /* ELSE: CONTINUE                  */
*                                                                  0470
@RF00463 DS    0H                                                  0471
*      /**************************************************************/
*      /*                                                            */
*      /*     CHECK TO SEE IF THERE IS ENOUGH SPACE TO DO ANY        */
*      /*     DATA PLACEMENT IN THE WORK AREA PROVIDED BY THE        */
*      /*     USER.                                                  */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0471
*      IF WKAAREAS<LENGTH(CBKVRLEN)                                0471
*                                 /* IF THERE IS NOT ENOUGH          */
*                                 /* SPACE TO PLACE A COUNT          */
*                                 /* FIELD FOR A VARIABLE            */
*                                 /* LENGTH FIELD                    */
*        THEN;                    /* THEN: CONTINUE                  */
@RC00463 LH    @03,WKAAREAS(,R13)                                  0471
         CH    @03,@CH00200                                        0471
         BL    @RT00471                                            0471
*        /************************************************************/
*        /*                                                          */
*        /*     ENSURE THAT THE LENGTH USED DOES NOT EXTEND          */
*        /*     BEYOND THE WORK AREA PROVIDED BY THE CALLER.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0473
*        ELSE DO;                 /* ELSE:                           */
*          IF WKAAREAS<WKAFNDLN                                    0474
*                                 /* IF THERE IS NOT ENOUGH          */
*                                 /* SPACE IN THE WORK AREA          */
*            THEN IF WKADTVAR='1'B/* THEN: IF VARIABLE LENGTH        */
         LH    @03,WKAAREAS(,R13)                                  0474
         CH    @03,WKAFNDLN(,R13)                                  0474
         BNL   @RF00474                                            0474
*              THEN WKAFNDLN=WKAAREAS+LENGTH(CBKVRLEN);            0475
         TM    WKADTVAR(R13),B'10000000'                           0475
         BNO   @RF00475                                            0475
         AH    @03,@CH00200                                        0476
         STH   @03,WKAFNDLN(,R13)                                  0476
*                                 /* THEN: SET LENGTH TO             */
*                                 /*       INCLUDE THE LENGTH        */
*                                 /*       FIELD                     */
*              ELSE WKAFNDLN=WKAAREAS;                             0477
         B     @RC00475                                            0477
@RF00475 MVC   WKAFNDLN(2,R13),WKAAREAS(R13)                       0477
*                                 /* ELSE: ADJUST THE FIELD          */
*                                 /*       LENGTH TO RETURN          */
*                                 /*       ONLY THE REMAINDER        */
*                                 /*       OF THE WORK AREA          */
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00474 DS    0H                                                  0479
*        /************************************************************/
*        /*                                                          */
*        /*     CONSTRUCT THE FMFL ADDRESS AND LENGTH, MODIFY        */
*        /*     THE FIELD COUNT IF REQUIRED, AND APPEND THE          */
*        /*     CONTINUATION FIELD IF REQUIRED                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0479
*          IF FMFLADDR(1)=0       /* IF A PARTIAL FIELD HAS NOT      */
*                                 /* BEEN STARTED                    */
*            THEN DO;             /* THEN:                           */
@RC00474 ICM   @03,15,FMFLADDR(FMFLCUR)                            0479
         BNZ   @RF00479                                            0479
*              FMFLADDR(1)=WKAAREAP;                               0481
         L     @03,WKAAREAP(,R13)                                  0481
         ST    @03,FMFLADDR(,FMFLCUR)                              0481
*                                 /* SETUP THE FMFL ADDRESS TO       */
*                                 /* THE START OF THE FIELD          */
*              FMFLENTH(1)=WKAFNDLN;                               0482
         LH    @02,WKAFNDLN(,R13)                                  0482
         ST    @02,FMFLENTH(,FMFLCUR)                              0482
*                                 /* SETUP THE FMFL LENGTH TO        */
*                                 /* SPAN THE FIELD                  */
*              WKASVPOS=WKAAREAP; /* SAVE THE ADDRESS OF THE         */
         ST    @03,WKASVPOS(,R13)                                  0483
*                                 /* COUNT FIELD FOR VARIABLE        */
*                                 /* LENGTH FIELDS                   */
*              END;               /*                                 */
*            ELSE DO;             /* ELSE:                           */
         B     @RC00479                                            0485
@RF00479 DS    0H                                                  0486
*              IF WKACONFG='1'B                                    0486
*                                 /* IF THIS IS A CONTINUATION       */
*                                 /* OF THE SAME FIELD               */
*                THEN IF WKADTVAR='1'B                             0486
         TM    WKACONFG(R13),B'00000010'                           0486
         BNO   @RF00486                                            0486
*                                 /* THEN: IF THIS IS VARIABLE       */
*                                 /*       LENGTH FIELD              */
*                  THEN DO;       /* THEN:                           */
         TM    WKADTVAR(R13),B'10000000'                           0487
         BNO   @RF00487                                            0487
*                    WKAFNDLN=WKAFNDLN-LENGTH(CBKVRLEN);           0489
         LA    @03,2                                               0489
         LH    @02,WKAFNDLN(,R13)                                  0489
         SLR   @02,@03                                             0489
         STH   @02,WKAFNDLN(,R13)                                  0489
*                                 /* REMOVE THE LENGTH FIELD         */
*                                 /* FROM THE LENGTH TO MOVE         */
*                    WKAFNDAD=WKAFNDAD+LENGTH(CBKVRLEN);           0490
         AL    @03,WKAFNDAD(,R13)                                  0490
         ST    @03,WKAFNDAD(,R13)                                  0490
*                                 /* ADJUST THE ADDRESS PAST         */
*                                 /* THE LENGTH FIELD                */
*                    WKASVPOS->CBKVRLEN=WKASVPOS->CBKVRLEN         0491
*                      +WKAFNDLN;                                  0491
         L     @03,WKASVPOS(,R13)                                  0491
         AH    @02,CBKVRLEN(,@03)                                  0491
         STH   @02,CBKVRLEN(,@03)                                  0491
*                                 /* INCREMENT THE FIELD LENGTH      */
*                                 /* OF THE TOTAL VARIABLE           */
*                                 /* LENGTH FIELD                    */
*                    END;         /*                                 */
*                  ELSE;          /* ELSE: CONTINUE                  */
@RF00487 DS    0H                                                  0494
*                ELSE WKASVPOS=WKAAREAP;                           0494
         B     @RC00486                                            0494
@RF00486 MVC   WKASVPOS(4,R13),WKAAREAP(R13)                       0494
*                                 /* ELSE: SAVE THE ADDRESS OF       */
*                                 /*       COUNT FIELD               */
*              FMFLENTH(1)=FMFLENTH(1)+WKAFNDLN;                   0495
@RC00486 LH    @03,WKAFNDLN(,R13)                                  0495
         AL    @03,FMFLENTH(,FMFLCUR)                              0495
         ST    @03,FMFLENTH(,FMFLCUR)                              0495
*                                 /* ADJUST THE FMFL LENGTH TO       */
*                                 /* INCLUDE THE NEW PORTION         */
*              END;               /*                                 */
*        /************************************************************/
*        /*                                                          */
*        /*     CHECK TO SEE IF THE FIELD EXISTS TO SEE HOW          */
*        /*     TO HANDLE THE FILLING OF THE WORK AREA.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0497
*        IF WKACMPLT='1'B & WKAFLDNE='1'B & WKADTVAR='0'B          0497
*                                 /* IF FIELD DOES NOT EXIST         */
*                                 /* AND IT IS FIXED LENGTH          */
*                                                                  0497
*          /**********************************************************/
*          /*                                                        */
*          /*     THE FIXED FIELD IS NON-EXISTENT SO IT IS           */
*          /*     TO BE FILLED WITH F'S.                             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0497
*          THEN DO;               /* THEN:                           */
@RC00479 TM    WKACMPLT(R13),B'01001000'                           0497
         BNO   @RF00497                                            0497
         TM    WKADTVAR(R13),B'10000000'                           0497
         BNZ   @RF00497                                            0497
*            WORKA=WKAAREAP;      /* POINT AT THE AREA TO SET        */
         L     WORKA,WKAAREAP(,R13)                                0499
*                                 /* TO FF...FF'S                    */
*            DO WORKB=1 TO WKAFNDLN;                               0500
         LA    WORKB,1                                             0500
         B     @DE00500                                            0500
@DL00500 DS    0H                                                  0501
*                                 /* LOOP TO SET THE WHOLE           */
*                                 /* FIELD                           */
*              WORKA->CHAR1='FF'X;/* SET THE BYTE TO F'S             */
         MVI   CHAR1(WORKA),X'FF'                                  0501
*              WORKA=WORKA+LENGTH(CHAR1);                          0502
         AH    WORKA,@CH00047                                      0502
*                                 /* POINT AT THE NEXT BYTE          */
*              END;               /*                                 */
         AH    WORKB,@CH00047                                      0503
@DE00500 CH    WORKB,WKAFNDLN(,R13)                                0503
         BNH   @DL00500                                            0503
*            END;                 /*                                 */
*                                                                  0504
*          /**********************************************************/
*          /*                                                        */
*          /*     MOVE THE DATA INTO THE WORK AREA AND HANDLE        */
*          /*     THE FIELD REGARDLESS OF IF IT IS 1 TO 256, OR      */
*          /*     257 TO 512 BYTES IN SIZE.                          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0505
*          ELSE IF WKAFNDLN>256   /* ELSE: IF FIELD CAN NOT BE       */
*                                 /* MOVED WITH A SINGLE MOVE        */
*              THEN DO;           /* THEN:                           */
         B     @RC00497                                            0505
@RF00497 LH    @03,WKAFNDLN(,R13)                                  0505
         CH    @03,@CH00285                                        0505
         BNH   @RF00505                                            0505
*                CHR(1:256)=CHRI(1:256);                           0507
         L     @02,WKAAREAP(,R13)                                  0507
         L     @01,WKAFNDAD(,R13)                                  0507
         MVC   CHR(256,@02),CHRI(@01)                              0507
*                                 /* MOVE THE FIRST 256 BYTES        */
*                                 /* OF THE FIELD                    */
*                CHR(257:WKAFNDLN)=CHRI(257:WKAFNDLN);             0508
         SH    @03,@CH00286                                        0508
         EX    @03,@SM00347                                        0508
*                                 /* MOVE THE REMAINDER OF THE       */
*                                 /* FIELD                           */
*                END;             /*                                 */
*              ELSE IF WKAFNDLN^=0  /* MAKE SURE NOT NULL    @ZA05902*/
*                                   /* VARIABLE LENGTH MOVE  @ZA05902*/
*                  THEN CHR(1:WKAFNDLN)=CHRI(1:WKAFNDLN);  /*@ZA05902*/
         B     @RC00505                                            0510
@RF00505 LH    @03,WKAFNDLN(,R13)                                  0510
         LTR   @03,@03                                             0510
         BZ    @RF00510                                            0510
         L     @01,WKAAREAP(,R13)                                  0511
         BCTR  @03,0                                               0511
         L     @02,WKAFNDAD(,R13)                                  0511
         EX    @03,@SM00349                                        0511
*                                 /* THEN: MOVE THE STRING LESS      */
*                                 /*       THAN 256 BYTES            */
*                  ELSE;          /* NOTHING TO MOVE         @ZA05902*/
@RF00510 DS    0H                                                  0513
*        /************************************************************/
*        /*                                                          */
*        /*     ADJUST THE SIZE OF THE REMAINING WORK AREA           */
*        /*     SPACE AND ADJUST THE POINTER TO THE NEXT             */
*        /*     AVAILABLE AREA.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0513
*        WKAAREAS=WKAAREAS-WKAFNDLN;                               0513
@RC00505 DS    0H                                                  0513
@RC00497 LH    @03,WKAFNDLN(,R13)                                  0513
         LH    @02,WKAAREAS(,R13)                                  0513
         SLR   @02,@03                                             0513
         STH   @02,WKAAREAS(,R13)                                  0513
*                                 /* DECREMENT THE USED SPACE        */
*                                 /* FROM THE AVAILABLE              */
*        WKAAREAP=WKAAREAP+WKAFNDLN;                               0514
         L     @02,WKAAREAP(,R13)                                  0514
         ALR   @02,@03                                             0514
         ST    @02,WKAAREAP(,R13)                                  0514
*                                 /* POINT AT THE NEXT               */
*                                 /* AVAILABLE SPACE                 */
*        FOALENTH=FOALENTH+WKAFNDLN;                               0515
         L     @02,FMPLOAR(,FMPLAD)                                0515
         AH    @03,FOALENTH(,@02)                                  0515
         STH   @03,FOALENTH(,@02)                                  0515
*                                 /* INCREMENT THE LENGTH OF         */
*                                 /* THE OUTPUT DATA SUPPLIED        */
*        END;                     /*                                 */
*    END;                         /*                                 */
*  END PSHIN;                     /* END OF PROCEDURE                */
@EL00012 DS    0H                                                  0518
@EF00012 DS    0H                                                  0518
@ER00012 BR    @14                                                 0518
@PB00012 DS    0H                                                  0519
*  GEN(EJECT);                                                     0519
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PTCMP                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = TEST COMPARATION OF SUB-FIELDS               */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE DOES THE COMPARASON BETWEEN THE FIELDS TO      */
*/*      DETERMINE IF THE TEST FAILES OR NOT.                        */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      NONE                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0520
*PTCMP: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0520
*                                                                  0520
         B     @PB00013                                            0520
PTCMP    DS    0H                                                  0521
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE SETUP REQUIRED ON FIRST TIME THROUGH             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0521
*  IF WKATCFTS='1'B               /* IF FIRST TIME SWITCH IS ON      */
*    THEN DO;                     /* THEN:                           */
         TM    WKATCFTS(R13),B'00010000'                           0521
         BNO   @RF00521                                            0521
*      WKATCFTS='0'B;             /* CLEAR THE FIRST TIME            */
         NI    WKATCFTS(R13),B'11101111'                           0523
*                                 /* SWITCH                          */
*      WKAADJLN=FMFLENTH(1);      /* SETUP THE ADJUSTED LENGTH       */
         MVC   WKAADJLN(2,R13),FMFLENTH+2(FMFLCUR)                 0524
*                                 /* OF THE FIELD                    */
*      WKAADJAD=FMFLADDR(1);      /* SETUP THE ADJUSTED ADDRESS      */
         MVC   WKAADJAD(4,R13),FMFLADDR(FMFLCUR)                   0525
*                                 /* OF THE FIELD                    */
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0527
@RF00521 DS    0H                                                  0528
*  /******************************************************************/
*  /*                                                                */
*  /*    DETERMINE THE LENGTH TO USE ON THIS COMPARASON              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0528
*  IF WKAADJLN<WKAFNDLN           /* IF ADJUSTED LENGTH IS LESS      */
*                                 /* THAN THE FOUND LENGTH           */
*    THEN WORKA=WKAADJLN-1;       /* THEN: USE ADJUSTED LENGTH       */
         LH    @03,WKAADJLN(,R13)                                  0528
         CH    @03,WKAFNDLN(,R13)                                  0528
         BNL   @RF00528                                            0528
         BCTR  @03,0                                               0529
         LR    WORKA,@03                                           0529
*    ELSE WORKA=WKAFNDLN-1;       /* ELSE: USE FOUND LENGTH          */
         B     @RC00528                                            0530
@RF00528 LH    WORKA,WKAFNDLN(,R13)                                0530
         BCTR  WORKA,0                                             0530
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP THE COMMON THINGS FOR ALL COMPARISONS                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0531
*  WORKB=FMFLTSTC;                /* SETUP THE CONDITION CODE        */
@RC00528 SLR   WORKB,WORKB                                         0531
         IC    WORKB,FMFLTSTC(,FMFLCUR)                            0531
*  WORKC=WKAADJAD;                /* POINT AT INPUTED SUB-           */
         L     WORKC,WKAADJAD(,R13)                                0532
*                                 /* FIELD                           */
*  WORKD=WKAFNDAD;                /* POINT AT FOUND SUB-FIELD        */
*                                                                  0533
         L     WORKD,WKAFNDAD(,R13)                                0533
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP FOR THE CLC TYPE COMPARISONS                         */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0534
*  IF WKADTFLG='0'B               /* IF THE TEST IS NOT FOR A        */
*                                 /* FLAG BYTE                       */
*    THEN DO;                     /* THEN:                           */
         TM    WKADTFLG(R13),B'00010000'                           0534
         BNZ   @RF00534                                            0534
*      IF WKADTVAR='1'B           /* IF VARIABLE LENGTH FIELD        */
*        THEN DO;                 /* THEN:                           */
         TM    WKADTVAR(R13),B'10000000'                           0536
         BNO   @RF00536                                            0536
*          WORKA=WORKA-LENGTH(CBKVRLEN);                           0538
         LA    @03,2                                               0538
         SLR   WORKA,@03                                           0538
*                                 /* ADJUST COUNT FOR LENGTH         */
*                                 /* FIELD                           */
*          WORKC=WORKC+LENGTH(CBKVRLEN);                           0539
         ALR   WORKC,@03                                           0539
*                                 /* ADJUST INPUT SUB-FIELD FOR      */
*                                 /* LENGTH FIELD                    */
*          WORKD=WORKD+LENGTH(CBKVRLEN);                           0540
         ALR   WORKD,@03                                           0540
*                                 /* ADJUST FOUND FIELD FOR          */
*                                 /* LENGTH FIELD                    */
*          END;                   /*                                 */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00536 DS    0H                                                  0543
*      WKAADJAD=WKAADJAD+WORKA+1; /* ADJUST ADDRESS OF INPUTED       */
         LR    @03,WORKA                                           0543
         AL    @03,WKAADJAD(,R13)                                  0543
         AH    @03,@CH00047                                        0543
         ST    @03,WKAADJAD(,R13)                                  0543
*                                 /* FIELD FOR SUB-FIELD BEING       */
*                                 /* CHECKED                         */
*      WKAADJLN=WKAADJLN-WORKA-1; /* ADJUST LENGTH OF REMAINING      */
         LH    @03,WKAADJLN(,R13)                                  0544
         SLR   @03,WORKA                                           0544
         BCTR  @03,0                                               0544
         STH   @03,WKAADJLN(,R13)                                  0544
*                                 /* FIELD FOR SUB-FIELD BEING       */
*                                 /* CHECKED                         */
*      IF WKADTVAR='1'B & WKAADJLN=LENGTH(CBKVRLEN)                0545
*                                 /* IF VARIABLE LENGTH FIELD        */
*                                 /* AND LENGTH INCLUDES ONLY        */
*                                 /* THE COUNT FIELD                 */
*            THEN WKAADJLN=0;     /* THEN: IT SHOULD BE ZERO         */
         TM    WKADTVAR(R13),B'10000000'                           0545
         BNO   @RF00545                                            0545
         CH    @03,@CH00200                                        0545
         BNE   @RF00545                                            0545
         SLR   @03,@03                                             0546
         STH   @03,WKAADJLN(,R13)                                  0546
*            ELSE;                /* ELSE: CONTINUE                  */
@RF00545 DS    0H                                                  0548
*      R15=ADDR(PTCMPCM);         /* POINT AT THE COMPARE-           */
         LA    R15,PTCMPCM                                         0548
*                                 /* LOGICAL-CHARACTERS              */
*                                 /* INSTRUCTION                     */
*      END;                       /*                                 */
*    /****************************************************************/
*    /*                                                              */
*    /*    SET UP FOR TM TYPE COMPARISONS                            */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0550
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00534                                            0550
@RF00534 DS    0H                                                  0551
*      WKAADJLN=WKAADJLN-1;       /* ADJUST LENGTH FOR TEST          */
         LH    @03,WKAADJLN(,R13)                                  0551
         BCTR  @03,0                                               0551
         STH   @03,WKAADJLN(,R13)                                  0551
*      WORKA=WORKC->CHAR1;        /* PICK UP THE MASK BYTE           */
         SLR   WORKA,WORKA                                         0552
         IC    WORKA,CHAR1(,WORKC)                                 0552
*      R15=ADDR(PTCMPTM);         /* POINT AT THE TEST-UNDER-        */
         LA    R15,PTCMPTM                                         0553
*                                 /* MASK INSTRUCTION                */
*      END;                       /*                                 */
*                                                                  0554
*  /******************************************************************/
*  /*                                                                */
*  /*    DO THE ACTUAL COMPARISON AND RETURN TO THE CALLER           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0555
*  GEN(EX WORKA,0(R15))           /* DO THE TESTING                  */
*     REFS(PTCMPCM,PTCMPTM);      /*                                 */
@RC00534 DS    0H                                                  0555
         EX WORKA,0(R15)
*  GEN(EX WORKB,PTCMPBR)          /* BRANCH IF THE TEST IS           */
*     REFS(PTCMPBR,PTCMP1);       /* SUCCESSFUL                      */
         EX WORKB,PTCMPBR
*  WKAFSUCC='0'B;                 /* INDICATE THAT THE TEST IS       */
         NI    WKAFSUCC(R13),B'11101111'                           0557
*                                 /* UNSUCCESSFUL                    */
*PTCMP1:                                                           0558
*  RETURN;                        /* RETURN TO CALLER                */
*                                                                  0558
@EL00013 DS    0H                                                  0558
@EF00013 DS    0H                                                  0558
@ER00013 BR    @14                                                 0558
*/********************************************************************/
*/*                                                                  */
*/*      THESE ARE THE INSTRUCTIONS THAT ARE TO BE EXECUTED          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0559
*PTCMPCM:                                                          0559
*  GEN(CLC 0(0,WORKD),0(WORKC));  /* COMPARE TWO FIELDS              */
PTCMPCM  CLC 0(0,WORKD),0(WORKC)
*PTCMPTM:                                                          0560
*  GEN(TM  0(WORKD),0);           /* TEST BITS                       */
PTCMPTM  TM  0(WORKD),0
*PTCMPBR:                                                          0561
*  GEN(BC  0,PTCMP1);             /* BRANCH IF TEST SUCCESSFUL       */
*                                                                  0561
PTCMPBR  BC  0,PTCMP1
*  END PTCMP;                     /* END OF PROCEDURE                */
         B     @EL00013                                            0562
@PB00013 DS    0H                                                  0563
*  GEN(EJECT);                                                     0563
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PTRNS                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = TRANSLATE THE NAME TO INDICATORS             */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE LOOKS UP THE COMPRESSED NAME IN THE TABLE      */
*/*      AND SUBSTITUDES THE INDICATORS IN THE FMFL IN THE WORK      */
*/*      AREA FIELD.                                                 */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      NONE                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0564
*PTRNS: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0564
*                                                                  0564
         B     @PB00014                                            0564
PTRNS    DS    0H                                                  0565
*  /******************************************************************/
*  /*                                                                */
*  /*     FORMAT THE COMPRESSED NAME THAT IS TO BE SEARCHED          */
*  /*     FOR IN THE TABLE.                                          */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0565
*  WKANAME(1:2)=FMFLNAME(1:2);    /* PLACE THE FIRST TWO CHAR-       */
         L     @03,FMFLDNAM(,FMFLCUR)                              0565
         MVC   WKANAME(2,R13),FMFLNAME(@03)                        0565
*                                 /* ACTERS OF THE NAME              */
*  WKANAME(3:4)=FMFLNAME(5:6);    /* PLACE THE SECOND TWO CHAR-      */
         MVC   WKANAME+2(2,R13),FMFLNAME+4(@03)                    0566
*                                 /* ACTERS OF THE NAME              */
*                                                                  0567
*  /******************************************************************/
*  /*                                                                */
*  /*     SAVE THE ADDRESS OF THE COMPRESSED NAME TABLE FOR          */
*  /*     OTHER PROCEDURES TO OBTAIN.                                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0567
*  WKACOMBT=ADDR(Y000);           /* POINT AT THE COMBINATION        */
         LA    @03,Y000                                            0567
         ST    @03,WKACOMBT(,R13)                                  0567
*                                 /* TABLE FOR LATTER USE            */
*  WKADICTT=ADDR(X000);           /* POINT AT THE DICTIONARY         */
         LA    @03,X000                                            0568
         ST    @03,WKADICTT(,R13)                                  0568
*                                 /* TABLE FOR FIELD NAMES           */
*  /******************************************************************/
*  /*                                                                */
*  /*     SEARCH IN THE TABLE FOR THE FIELD NAME SPECIFIED           */
*  /*     AND PLACE THE DICTIONARY INFORMATION IN THE WKA.           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0569
*  WKADICTD=0;                    /* ZERO THE WORK AREA              */
         SLR   @02,@02                                             0569
         ST    @02,WKADICTD(,R13)                                  0569
*                                 /* DICTIONARY INFORMATION          */
*  FMPLRTCD=RTNCDIFN;             /* INITIALIZE THE RETURN CODE      */
         MVI   FMPLRTCD(FMPLAD),X'04'                              0570
*                                 /* TO FIELD NOT FOUND IN CASE      */
*                                 /* THAT THE FIELD IS NOT           */
*                                 /* FOUND                           */
*  WORKA=WKADICTT;                /* POINT AT THE START OF THE       */
         LR    WORKA,@03                                           0571
*                                 /* TABLE TO SEARCH                 */
*  WORKB=ADDR(X999);              /* POINT AT THE END OF THE         */
         LA    WORKB,X999                                          0572
*                                 /* TABLE TO SEARCH                 */
*  DO WHILE WORKA<WORKB;          /* LOOP UNTIL THE WHOLE TABLE      */
         B     @DE00573                                            0573
@DL00573 DS    0H                                                  0574
*                                 /* SEARCHED                        */
*    IF WKANAME=WORKA->DCTFNAME   /* IF THE NAME FOUND IN TABLE      */
*      THEN DO;                   /* THEN:                           */
         CLC   WKANAME(4,R13),DCTFNAME(WORKA)                      0574
         BNE   @RF00574                                            0574
*        WKADICTD=WORKA->DCTDINFO;/* PLACE THE DICTIONARY            */
         MVC   WKADICTD(4,R13),DCTDINFO(WORKA)                     0576
*                                 /* INFORMATION IN THE WKA          */
*        WORKA=WORKB;             /* INDICATE THAT THE LOOP IS       */
         LR    WORKA,WORKB                                         0577
*                                 /* IS DONE WITH THE SEARCH         */
*        FMPLRTCD=RTNCDNML;       /* INDICATE THAT THE FIELD         */
         MVI   FMPLRTCD(FMPLAD),X'00'                              0578
*                                 /* WAS FOUND                       */
*        END;                     /*                                 */
*      ELSE WORKA=WORKA+LENGTH(DCT);                               0580
         B     @RC00574                                            0580
@RF00574 AH    WORKA,@CH00053                                      0580
*                                 /* ELSE: POINT AT THE NEXT         */
*                                 /*       ENTRY IN THE TABLE        */
*    END;                         /*                                 */
*                                                                  0581
@RC00574 DS    0H                                                  0581
@DE00573 CR    WORKA,WORKB                                         0581
         BL    @DL00573                                            0581
*  /******************************************************************/
*  /*                                                                */
*  /*     FOR ALL SPECIAL FIELD NAMES THE GROUP CODE IS              */
*  /*     OBTAINED FROM THE CALLERS FMFL.                            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0582
*  IF WKADTSPL='1'B               /* IF ONE OF THE SPECIAL           */
*                                 /* FUNCTIONS                       */
*    THEN WKAGRPCD=FMFLGRPC;      /* THEN: PLACE THE USER            */
         TM    WKADTSPL(R13),B'00000001'                           0582
         BNO   @RF00582                                            0582
         MVC   WKAGRPCD(1,R13),FMFLGRPC(FMFLCUR)                   0583
*                                 /*       SUPPLIED GROUP CODE       */
*    ELSE;                        /* ELSE: CONTINUE                  */
@RF00582 DS    0H                                                  0585
*  /******************************************************************/
*  /*                                                                */
*  /*     VALIDITY CHECK THE FIELD NAME TO INSURE THAT IT HAS        */
*  /*     NOT BEEN PLACED WHERE IT SHOULD NOT HAVE BEEN, AND         */
*  /*     INSURE THAT ALL GROUP CODES IN A SINGLE CHAIN ARE          */
*  /*     THE SAME. ALSO INSURE THAT NO COMBINATION NAME IS          */
*  /*     USED IN THE TEST CHAIN.                                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0585
*  IF WKATSTFL='1'B               /* IF THIS IS A TEST FMFL          */
*    THEN DO;                     /* THEN:                           */
         TM    WKATSTFL(R13),B'00001000'                           0585
         BNO   @RF00585                                            0585
*      IF (FMFLTSTC & 'F0'X)=0 × (FMFLTSTC & '0F'X)^=0             0587
*                                 /* IF INVALID CONDITION CODE       */
*                                 /* BYTE PROVIDED                   */
*        THEN FMPLRTCD=RTNCDTCC;  /* THEN: INDICATE THE ERROR        */
         SLR   @03,@03                                             0587
         SLR   @02,@02                                             0587
         IC    @02,FMFLTSTC(,FMFLCUR)                              0587
         LA    @01,240                                             0587
         NR    @01,@02                                             0587
         CR    @01,@03                                             0587
         BE    @RT00587                                            0587
         N     @02,@CF00306                                        0587
         CR    @02,@03                                             0587
         BE    @RF00587                                            0587
@RT00587 DS    0H                                                  0588
         MVI   FMPLRTCD(FMPLAD),X'10'                              0588
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00587 DS    0H                                                  0590
*      IF WKADTCMB='1'B           /* IF A COMBINED FIELD NAME        */
*        THEN FMPLRTCD=RTNCDIFS;  /* THEN: INDICATE THE ERROR        */
         TM    WKADTCMB(R13),B'00100000'                           0590
         BNO   @RF00590                                            0590
         MVI   FMPLRTCD(FMPLAD),X'0C'                              0591
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00590 DS    0H                                                  0593
*      IF WKASVGRC=WKAGRPCD       /* IF THE GROUP CODE IS THE        */
*                                 /* SAME AS THE REST OF THE         */
*                                 /* FIELD NAMES                     */
*        THEN;                    /* THEN: CONTINUE                  */
         CLC   WKASVGRC(1,R13),WKAGRPCD(R13)                       0593
         BE    @RT00593                                            0593
*        ELSE FMPLRTCD=RTNCDIGC;  /* ELSE: INDICATE THE ERROR        */
         MVI   FMPLRTCD(FMPLAD),X'08'                              0595
*      END;                       /*                                 */
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00585                                            0597
@RF00585 DS    0H                                                  0598
*      WKASVGRC=WKAGRPCD;         /* SAVE THE GROUP CODE SO          */
         MVC   WKASVGRC(1,R13),WKAGRPCD(R13)                       0598
*                                 /* THAT ALL OTHER GROUP CODES      */
*                                 /* CAN BE CHECKED TO IT            */
*      IF WKADTSPL='1'B           /* IF THIS IS A SPECIAL FUNC-      */
*                                 /* TION                            */
*        THEN IF WKADTSTR=CONCNTRN/* THEN: IF CNTREPNO FUNCTION      */
         TM    WKADTSPL(R13),B'00000001'                           0599
         BNO   @RF00599                                            0599
*          THEN FMPLRTCD=RTNCDIFS;/* THEN: INDICATE ERROR            */
         CLI   WKADTSTR(R13),X'02'                                 0600
         BNE   @RF00600                                            0600
         MVI   FMPLRTCD(FMPLAD),X'0C'                              0601
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00600 DS    0H                                                  0603
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00599 DS    0H                                                  0604
*                                 /* CODE FOR CHECKING TO            */
*      END;                       /*                                 */
*                                                                  0604
*  /******************************************************************/
*  /*                                                                */
*  /*     PLACE THE DICTIONARY INFORMATION IN THE FMFL.              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0605
*  FMFLWKAR=WKADICTD;             /* MOVE THE DICTIONARY INFOR-      */
@RC00585 MVC   FMFLWKAR(4,FMFLCUR),WKADICTD(R13)                   0605
*                                 /* MATION FORM THE WORK AREA       */
*                                 /* TO THE FMFL                     */
*  /******************************************************************/
*  /*                                                                */
*  /*    FOR ALL NON-TEST FL'S ZERO THE ADDRESS AND LENGTH           */
*  /*    FIELDS TO BEGIN PROCESSING.                                 */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0606
*  IF WKATSTFL='0'B               /* IF THIS IS NOT A TEST FL        */
*    THEN DO;                     /* THEN:                           */
         TM    WKATSTFL(R13),B'00001000'                           0606
         BNZ   @RF00606                                            0606
*      FMFLENTH(1)=0;             /* INITIALIZE THE LENGTH           */
         SLR   @03,@03                                             0608
         ST    @03,FMFLENTH(,FMFLCUR)                              0608
*                                 /* FIELD TO ZERO                   */
*      FMFLADDR(1)=0;             /* INITIALIZE THE ADDRESS          */
         ST    @03,FMFLADDR(,FMFLCUR)                              0609
*                                 /* FIELD TO ZERO                   */
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0611
@RF00606 DS    0H                                                  0612
*  /******************************************************************/
*  /*                                                                */
*  /*     RETURN TO THE CALLER.                                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0612
*  RETURN;                        /* RETURN TO CALLING               */
@EL00014 DS    0H                                                  0612
@EF00014 DS    0H                                                  0612
@ER00014 BR    @14                                                 0612
*                                 /* PROCEDURE                       */
*/********************************************************************/
*/*                                                                  */
*/*     THIS IS THE NAME TRANSLATION TABLE TO BE USED TO             */
*/*     TRANSLATE THE NAMES IN THE FIELD MANAGEMENT FIELD            */
*/*     LISTS (FMFL'S).                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0613
*X000: ;                                                           0613
X000     DS    0H                                                  0614
*  GEN REFS(Y000);                                                 0614
        DICT  $DSDIREC,COMB=YES,GC=8       DIREC INFO FOR SYNC CK
        DICT  $DSDRIRN,COMB=YES,GC=8       DIREC AND RELREPNO @OZ25037
        DICT  $EXTDATA,COMB=YES,GC=3       VOL OCCUR INFO FOR SYNC CK
        DICT  $EXTPTRS,PTRS=YES,LEN=3      RECORD EXTENTION PTRS
        DICT  $MXLRECL,OFF=26,LEN=4,GC=1   MAXIMUM LRECL
        DICT  $SPCEHDR,COMB=YES,GC=6       INFO FOR LISTCRA
        DICT  $USEDLEN,OFF=45,LEN=2        SPACE USED LENGTH
        DICT  AMDSBCAT,OFF=2,LEN=96,GC=1   CAT COPY OF AMDSB CNTRL BLK
        DICT  ATTR1,OFF=107,LEN=1,BYTE=YES DATA SET ATTRIBUTES
        DICT  ATTR2,OFF=108,LEN=1,BYTE=YES DATA SET ATTRIBUTES
        DICT  BITMAP,FIELD=1,GC=5          VOLUME SPACE BIT MAP
        DICT  BUFSIZE,OFF=110,LEN=4        MINIMUM BUFFER SPACE
        DICT  CATVOL,COMB=YES,GC=3         VOL OCCUR FOR ALIEN
        DICT  CATTR,OFF=107,LEN=1,BYTE=YES CLUSTER ATTRIBUTES
        DICT  CNTREPNO,SPECIAL=2,LEN=2     MAX RELREPNOS TO PROCESS
        DICT  CRAIDNO,OFF=11,LEN=3         CRA CI NUMBER
        DICT  CRADEVT,OFF=14,LEN=4         CRA DEVICE TYPE
        DICT  CRADITS,OFF=22,LEN=4         D/I CREATION T.S.
        DICT  CRAVOL,OFF=5,LEN=6           CRA VOLUME SERIAL
        DICT  CRACRETS,OFF=18,LEN=4        CRA CREATION T.S.
        DICT  DATASPAC,COMB=YES,GC=6       ENTIRE DATA SPACE GROUP
        DICT  DEXTENTS,COMB=YES,GC=6       DATA SPACE GRP FOR SALL
        DICT  DEVTYP,OFF=2,LEN=4,GC=3      VOLUME OCCUR DEVICE TYPE
        DICT  DIRECTRY,COMB=YES,GC=8       ENTIRE DATA SET DIRECTORY
        DICT  DSETCRDT,OFF=101,LEN=3       DATA SET CREATION DATE
        DICT  DSCRETS,OFF=5,LEN=4,GC=8     D/I CREATION T.S.
        DICT  DSETEXDT,OFF=104,LEN=3       DATA SET EXPIRATION DATE
        DICT  DSSUMTT,OFF=9,LEN=3,GC=8     SUM OF BEGINING TRACKS
        DICT  DSIDNO,OFF=2,LEN=3,GC=8      DATA SET DIRECTORY CI NO.
        DICT  DSPSOPT,OFF=17,LEN=1,GC=6,BYTE=YES
*                                          SPACE OPTIONS FOR DATA SET
        DICT  DSTYPNAM,COMB=YES            ENTRY TYPE AND NAME
        DICT  DSCBPTR,OFF=10,LEN=5,GC=6    TTR OF DSCB FOR DATA SET
        DICT  DSATRO,COMB=YES              DATA SET ATTRIBUTES
        DICT  DSDIRSN,OFF=37,LEN=2,GC=3    DS DIR SEQ NO IN VOL OCCUR
        DICT  DSPSSQ,OFF=18,LEN=3,GC=6     SECONDARY DATA SPACE AMOUNT
        DICT  DSATTR,COMB=YES              DATA SET ATTRIBUTES
        DICT  DSCBTS,OFF=2,LEN=8,GC=6      DATA SPACE T.S.
        DICT  ENTNAME,OFF=49,LEN=44        ENTRY NAME
        DICT  ENTIDNO,OFF=1,LEN=3          ENTRY CI NO.
        DICT  ENTVOL,COMB=YES,GC=3         ENTRY VOL OCCUR
        DICT  ENTYPE,OFF=44,LEN=1          ENTRY TYPE
        DICT  ENTUPGD,COMB=YES,GC=2        UPGRADE ASSOC GROUP
        DICT  ENTASSOC,COMB=YES,GC=2       ENTIRE ASSOC GROUP
        DICT  EXCPEXIT,OFF=135,LEN=8       EXCEPTION EXIT
        DICT  EXTENT,FIELD=3,GC=3          EXTENT DESCRIPTIONS
        DICT  EXTVOL,COMB=YES,GC=3         VOL OCCUR FOR EOV
        DICT  FILESEQ,OFF=12,LEN=2,GC=3    VOL OCCUR FILE SEQ NO
        DICT  HARBA,OFF=24,LEN=4,GC=3      HIGH ALLOC RBA IN VOL OCCUR
        DICT  HARBADS,OFF=125,LEN=4        HIGH ALLOC RBA FOR DATA SET
        DICT  HIKEYV,FIELD=2,GC=3          HIGH KEY IN VOL OCCUR
        DICT  HKRBA,OFF=16,LEN=4,GC=3      HIGH KEY RBA FOR DS
        DICT  HKURBA,COMB=YES,GC=3         HIGH KEY AND USED RBA
        DICT  HURBA,OFF=20,LEN=4,GC=3      HIGH USED RBA FOR DS
        DICT  HURBADS,OFF=121,LEN=4        HIGH USED
        DICT  ITYPEXT,OFF=36,LEN=1,GC=3,BYTE=YES
*                                          IND TYPE FOR EXTENT
        DICT  LOKEYV,FIELD=1,GC=3          LOW KEY IN VOL OCCUR
        DICT  LRECL,OFF=129,LEN=4          AVER LOGICAL RCD SIZE
        DICT  MAPSPACE,COMB=YES,GC=5       ENTIRE VOL BIT MAP GROUP
        DICT  NAME,OFF=3,LEN=3,GC=2        ASSOCIATION CI NO
        DICT  NAMEDS,COMB=YES,GC=2         ENTIRE ASSOCIATION GROUP
        DICT  NAME2,OFF=7,LEN=3,GC=2       ASSOCIATION CI NO
        DICT  NOTRKAU,OFF=34,LEN=2,GC=3    NO OF TRKS PER ALLOC UNIT
        DICT  NOBLKTRK,OFF=32,LEN=2,GC=3   NO OF BLKS PER TRK
        DICT  NODSPEXT,OFF=16,LEN=1,GC=6   NO OF DATA SPACE EXTENTS
        DICT  NOEXTNT,OFF=15,LEN=1,GC=3    NO OF VOL OCCUR EXTENTS
        DICT  OPNCALL1,COMB=YES            NON-REP FIELDS FOR OPEN
        DICT  OPENCNT,OFF=109,LEN=1        OPEN COUNT
        DICT  OPENIND,OFF=109,LEN=1,BYTE=YES
*                                          OPEN INDICATOR
        DICT  OWNERID,OFF=93,LEN=8         OWNER ID
        DICT  PASSATMP,OFF=42,LEN=2,GC=4   NO OF SECURITY ATTEMPTS
        DICT  PASSPRMT,OFF=34,LEN=8,GC=4   SECURITY PROMPTING NAME
        DICT  PASSWALL,COMB=YES,GC=4       ENTIRE SECURITY GROUP
        DICT  PASSWORD,OFF=2,LEN=32,GC=4   PASSWORDS
        DICT  PHYBLKSZ,OFF=28,LEN=4,GC=3   VOL OCCUR PHYSICAL BLKSZ
        DICT  PRIMSPAC,OFF=114,LEN=3       PRIMARY SPACE
        DICT  RELREPNO,SPECIAL=3,LEN=2     RELATIVE REPITION NUMBER
        DICT  RELIND,OFF=4,LEN=1           RELEASE INDICATOR
        DICT  REPNO,SPECIAL=4,LEN=2        HIGHEST NON-DELETED SEQ NO
        DICT  RELCRA,COMB=YES              RELEASE INDICATOR AND CRA
        DICT  RGATTR,OFF=107,LEN=1,BYTE=YES
*                                          PATH/AIX ATTRIBUTES
        DICT  SCONSPAC,OFF=117,LEN=3       SECONDARY SPACE
        DICT  SECFLAGS,OFF=26,LEN=1,BYTE=YES                  @Z40RSSA
        DICT  SPHDFLG,OFF=15,LEN=1,GC=6,BYTE=YES
*                                          DATA SPACE FLAG
        DICT  SPACOPTN,OFF=120,LEN=1,BYTE=YES
*                                          SPACE OPTIONS
        DICT  SPACPARM,COMB=YES            SPACE AMOUNTS & OPTIONS
        DICT  SPEXTENT,OFF=21,LEN=64,GC=6  DATA SPACE EXTENT DESCRIP
        DICT  SYSEXTDS,OFF=122,LEN=1,GC=128
*                                          AOS ALOWED EXTENTS PER SALL
        DICT  TYPE,OFF=2,LEN=1,GC=2        ASSOCIATION ENTRY TYPE
        DICT  TYPE2,OFF=6,LEN=1,GC=2       ASSOCIATION ENTRY TYPE
        DICT  UPDVOL,COMB=YES,GC=3         VOL OCCUR FOR EXTEND
        DICT  UPGRADE,COMB=YES,GC=2        UPGRADE ASSOCIATION GROUP
        DICT  USERAREC,FIELD=1,GC=4        SECURITY AUTHORIZATION DATA
        DICT  USERINFO,OFF=133,LEN=2       IIP FIELD
        DICT  USVRMDUL,OFF=44,LEN=8,GC=4   SECURITY MODULE NAME
        DICT  VOLSER,OFF=6,LEN=6,GC=3      VOL OCCUR VOLUME SERIAL
        DICT  VOLDEV,COMB=YES,GC=3         VOL OCCUR FOR OPEN
        DICT  VOLRFLG,OFF=121,LEN=1,GC=128,BYTE=YES
*                                          VOLUME RECORD FLAGS
        DICT  VOLPHY,COMB=YES,GC=3         VOLUME OCCUR FOR OPEN
        DICT  VOLFLG,OFF=14,LEN=1,GC=3,BYTE=YES
*                                          VOLUME OCCURENCE FLAGS
        DICT  VOLTSTMP,OFF=93,LEN=8,GC=128 VOLUME ENTRY T.S.
        DICT  VOLDVCHR,OFF=101,LEN=20,GC=128
*                                          VOL ENTRY DEV CHARACTER
        DICT  VOLEXT,COMB=YES,GC=3         VOLUME OCCURRANCE
*X999: ;                                                           0615
*                                                                  0615
X999     DS    0H                                                  0616
*Y000: ;                                                           0616
Y000     DS    0H                                                  0617
*  GEN REFS(X000);                                                 0617
*                                                                  0617
        COMB   $DSDIREC,(DSIDNO,DSCRETS,DSSUMTT)
        COMB   $DSDRIRN,(DSIDNO,DSCRETS,DSSUMTT,RELREPNO)     @OZ25037
        COMB   $EXTDATA,(VOLSER,DSDIRSN,EXTENT)
        COMB   $SPCEHDR,(RELREPNO,DSCBTS,DSCBPTR,SPHDFLG,NODSPEXT,    **
               DSPSOPT,DSPSSQ)
        COMB   CATVOL,(RELREPNO,DEVTYP,VOLSER,FILESER,VOLFLG)
        COMB   DATASPAC,(RELREPNO,DSCBTS,DSCBPTR,SPHDFLG,NODSPEXT,    **
               DSPSOPT,DSPSSQ,SPEXTENT)
        COMB   DEXTENTS,(RELREPNO,SPHDFLG,NODSPEXT,SPEXTENT)
        COMB   DIRECTRY,(RELREPNO,DSIDNO)
        COMB   DSTYPNAM,(ENTYPE,ENTIDNO)
        COMB   DSATRO,(ATTR1,ATTR2,OPENIND)
        COMB   DSATTR,(ATTR1,ATTR2)
        COMB   ENTVOL,(RELREPNO,DEVTYP,VOLSER,FILESEQ,VOLFLG,NOEXTNT, **
               HKRBA,HURBA,HARBA,PHYBLKSZ,NOBLKTRK,NOTRKAU,ITYPEXT,   **
               DSDIRSN,LOKEYV,HIKEYV,EXTENT)
        COMB   ENTUPG,(RELREPNO,TYPE,NAME,TYPE2,NAME2)
        COMB   ENTASSOC,(RELREPNO,TYPE,NAME)
        COMB   EXTVOL,(RELREPNO,DEVTYP,ITYPEXT,EXTENT)
        COMB   HKURBA,(HKRBA,HURBA)
        COMB   MAPSPACE,(RELREPNO,BITMAP)
        COMB   NAMEDS,(TYPE,NAME)
        COMB   OPNCALL1,(SPACOPTN,BUFSIZE,ENTNAME,HURBADS)
        COMB   PASSWALL,(PASSWORD,PASSPRMT,PASSATMP,USVRMDUL,USERAREC)
        COMB   RELCRA,(RELIND,CRAVOL,CRAIDNO,CRADEVT)
        COMB   SPACPARM,(PRIMSPAC,SCONSPAC,SPACOPTN)
        COMB   UPDVOL,(RELREPNO,DEVTYP,VOLSER,FILESEQ,VOLFLG,NOEXTNT, **
               HKRBA,HURBA,HARBA,PHYBLKSZ,NOBLKTRK,NOTRKAU,ITYPEXT,   **
               DSDIRSN,LOKEYV,HIKEYV)
        COMB   UPGRADE,(TYPE,NAME,TYPE2,NAME2)
        COMB   VOLDEV,(DEVTYP,PHYBLKSZ,NOBLKTRK,NOTRKAU)
        COMB   VOLPHY,(RELREPNO,VOLSER,VOLFLG,NOEXTNT,HKRBA,HURBA,    **
               HARBA,ITYPEXT,LOKEYV,HIKEYV,EXTENT)
        COMB   VOLEXT,(RELREPNO,VOLSER,DSDIRSN,EXTENT)
*  END PTRNS;                     /* END OF PROCEDURE                */
         B     @EL00014                                            0618
@PB00014 DS    0H                                                  0619
*  GEN(EJECT);                                                     0619
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE NAME = PTSTS                                          */
*/*                                                                  */
*/*  DESCRIPTIVE NAME = TEST THE FMFL'S IN TEST CHAIN                */
*/*                                                                  */
*/*  FUNCTION =                                                      */
*/*      THIS ROUTINE LOOPS DOWN THE TEST CHAIN AND CHECKS OUT       */
*/*      THE DESIRED RELREPNO PROVIDED TO SEE IF THIS ONE WILL       */
*/*      SATISFY THE NEEDS OF THE TESTS AND RETURNS THE              */
*/*      APPROPIATE INDICATION.                                      */
*/*                                                                  */
*/*  ROUTINES CALLED                                                 */
*/*      PGVAL                                                       */
*/*      PTCMP                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0620
*PTSTS: PROCEDURE OPTIONS(NOSAVEAREA NOSAVE);                      0620
*                                                                  0620
         B     @PB00015                                            0620
PTSTS    DS    0H                                                  0621
*  /******************************************************************/
*  /*                                                                */
*  /*    SAVE THE RETURN ADDRESS ON ENTRY AND INITIALIZE FOR         */
*  /*    THE FOLLOWING PROCESS                                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0621
*  WKARTNI=R14;                   /* SAVE THE RETURN ADDRESS         */
         ST    R14,WKARTNI(,R13)                                   0621
*  WKAFSUCC='1'B;                 /* ASSUME THAT THE TEST WAS A      */
         OI    WKAFSUCC(R13),B'00010000'                           0622
*                                 /* SUCCESS                         */
*                                                                  0623
*  /******************************************************************/
*  /*                                                                */
*  /*    LOOP THROUGH ALL OF THE FMFL'S ON THE TEST CHAIN OR         */
*  /*    UNTIL THERE IS A FAILURE                                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0623
*  DO WHILE FMFLTCHN^=0 & WKAFSUCC='1'B;                           0623
         B     @DE00623                                            0623
@DL00623 DS    0H                                                  0624
*                                 /* LOOP WHILE THERE IS AN-         */
*                                 /* OTHER TEST FMFL TO CHECK        */
*                                 /* AND THE TESTS UNTIL NOW         */
*                                 /* HAVE BEEN SUCCESSFUL            */
*    FMFLCUR=FMFLTCHN;            /* POINT AT THE NEXT FMFL TO       */
         L     FMFLCUR,FMFLTCHN(,FMFLCUR)                          0624
*                                 /* CHECK                           */
*    WKADICTD=FMFLWKAR;           /* PLACE THE DICTIONARY            */
         MVC   WKADICTD(4,R13),FMFLWKAR(FMFLCUR)                   0625
*                                 /* INFORMATION IN THE WORK         */
*                                 /* AREA                            */
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE THE CNTREPNO FUNCTION                              */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0626
*    IF WKADTSPL='1'B & WKADTSTR=CONCNTRN                          0626
*                                 /* IF THIS IS A SPECIAL FIELD      */
*                                 /* NAME AND THAT NAME IS           */
*                                 /* CNTREPNO                        */
*      THEN DO;                   /* THEN:                           */
         TM    WKADTSPL(R13),B'00000001'                           0626
         BNO   @RF00626                                            0626
         CLI   WKADTSTR(R13),X'02'                                 0626
         BNE   @RF00626                                            0626
*        IF WKADRRNO<=FMFLCNTR    /* IF THE RELREPNO HAS NOT         */
*                                 /* EXCEEDED THE DESIRED VALUE      */
*          THEN WKAFLDNE='0'B;    /* THEN: INDICATE THAT THE         */
         L     @01,FMFLADDR(,FMFLCUR)                              0628
         LH    @00,WKADRRNO(,R13)                                  0628
         CH    @00,FMFLCNTR(,@01)                                  0628
         BH    @RF00628                                            0628
         NI    WKAFLDNE(R13),B'10111111'                           0629
*                                 /*       FIELD DOES EXIST          */
*          ELSE DO;               /* ELSE:                           */
         B     @RC00628                                            0630
@RF00628 DS    0H                                                  0631
*            WKAFSUCC='0'B;       /* INDICATE THAT THE FIELD         */
*                                 /* WAS NOT A SUCCESS               */
*            WKAFLDNE='1'B;       /* INDICATE THAT THE FIELD         */
         OI    WKAFLDNE(R13),B'01000000'                           0632
         NI    WKAFSUCC(R13),B'11101111'                           0632
*                                 /* DOES NOT EXIST                  */
*            END;                 /*                                 */
*        WKACMPLT='1'B;           /* INDICATE THAT THE FIELD         */
@RC00628 DS    0H                                                  0635
*                                 /* WAS NOT COMPLETE                */
*        WKAFLDNF='1'B;           /* INDICATE THAT THE GROUP         */
         OI    WKACMPLT(R13),B'00101000'                           0635
*                                 /* CODE WAS NOT FOUND              */
*        END;                     /*                                 */
*                                                                  0636
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE ALL OF THE OTHER FUNCTIONS                       */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0637
*      ELSE DO;                   /* ELSE:                           */
         B     @RC00626                                            0637
@RF00626 DS    0H                                                  0638
*        WKATCFTS='1'B;           /* INDICATE THAT THIS IS THE       */
*                                 /* FIRST TIME THROUGH TEST         */
*                                 /* COMPARISON FOR THIS FIELD       */
*        WKAGVFTS='1'B;           /* INDICATE THE FIRST TIME         */
*                                 /* THROUGH PGVAL                   */
*        WKAEXITF='0'B;           /* INITIALIZE THE LOOP             */
         OI    WKATCFTS(R13),B'00010100'                           0640
         NI    WKAEXITF(R13),B'10111111'                           0640
*                                 /* CONTROL FLAG                    */
*        WKANEXCI=0;              /* ZERO THE NEXT CI SO THAT        */
         SLR   @03,@03                                             0641
         STCM  @03,7,WKANEXCI(R13)                                 0641
*                                 /* THE BASE CI WILL BE USED        */
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE LOOPING THROUGH ALL OF THE PIECES OF THE       */
*        /*    FIELD TO CHECK                                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0642
*        DO WHILE WKAEXITF='0'B & WKAFSUCC='1'B;                   0642
         B     @DE00642                                            0642
@DL00642 DS    0H                                                  0643
*                                 /* LOOP UNTIL THE TOTAL            */
*                                 /* COMPARISON IS DONE OR           */
*                                 /* UNTIL A MISMATCH IS FOUND       */
*          WKAEXITF='1'B;         /* ASSUME THAT THIS TIME           */
         OI    WKAEXITF(R13),B'01000000'                           0643
*                                 /* THROUGH THE LOOP IS ENOUGH      */
*          CALL PGVAL;            /* GET THE DESIRED VALUE           */
         BAL   @14,PGVAL                                           0644
*          IF WKACMPLT='1'B       /* IF THE FIELD IS COMPLETE        */
*            THEN IF WKAFLDNE='1'B/* THEN: IF THE FIELD DOES         */
         TM    WKACMPLT(R13),B'00001000'                           0645
         BNO   @RF00645                                            0645
*                                 /*       NOT EXIST                 */
*              THEN WKAFSUCC='0'B;/* THEN: INDICATE THAT THE         */
         TM    WKAFLDNE(R13),B'01000000'                           0646
         BNO   @RF00646                                            0646
         NI    WKAFSUCC(R13),B'11101111'                           0647
*                                 /*       FIELD LIST TESTING        */
*                                 /*       WAS NOT A SUCCESS         */
*              ELSE IF WKAADJLN=0 /* ELSE: IF THE ADJUSTED           */
*                                 /*       LENGTH OF FIELD           */
*                                 /*       REMAINING IS ZERO         */
*                THEN WKAEXITF='1'B;                               0648
         B     @RC00646                                            0648
@RF00646 ICM   @03,3,WKAADJLN(R13)                                 0648
         BNZ   @RF00648                                            0648
         OI    WKAEXITF(R13),B'01000000'                           0649
*                                 /* THEN: INDICATE THE TEST         */
*                                 /*       IS COMPLETE               */
*                ELSE WKAFSUCC='0'B;                               0650
         B     @RC00648                                            0650
@RF00648 NI    WKAFSUCC(R13),B'11101111'                           0650
*                                 /* ELSE: INDICATE THAT THE         */
*                                 /*       TEST WAS NOT A            */
*                                 /*       SUCCESS                   */
*            ELSE DO;             /* ELSE:                           */
         B     @RC00645                                            0651
@RF00645 DS    0H                                                  0652
*              CALL PTCMP;        /* COMPARE THE FIELD FOUND         */
         BAL   @14,PTCMP                                           0652
*                                 /* WITH THE INPUT FIELD            */
*              IF WKAFSUCC='1'B   /* IF THE TEST IS A SUCCESS        */
*                                 /* AND THERE IS MORE TO CHECK      */
*                THEN WKAEXITF='0'B;                               0653
         TM    WKAFSUCC(R13),B'00010000'                           0653
         BNO   @RF00653                                            0653
         NI    WKAEXITF(R13),B'10111111'                           0654
*                                 /* THEN: INDICATE TO CONTINUE      */
*                ELSE DO;         /* ELSE:                           */
         B     @RC00653                                            0655
@RF00653 DS    0H                                                  0656
*                  WKAFLDNE='0'B; /* INDICATE THAT THE FIELD         */
*                                 /* DOES EXIST                      */
*                  WKACMPLT='1'B; /* INDICATE THAT THE FIELD         */
         OI    WKACMPLT(R13),B'00001000'                           0657
         NI    WKAFLDNE(R13),B'10111111'                           0657
*                                 /* IS COMPLETE                     */
*                  END;           /*                                 */
*              END;               /*                                 */
@RC00653 DS    0H                                                  0660
*          END;                   /*                                 */
@RC00645 DS    0H                                                  0660
@DE00642 TM    WKAEXITF(R13),B'01000000'                           0660
         BNZ   @DC00642                                            0660
         TM    WKAFSUCC(R13),B'00010000'                           0660
         BO    @DL00642                                            0660
@DC00642 DS    0H                                                  0661
*        END;                     /*                                 */
*    END;                         /*                                 */
@RC00626 DS    0H                                                  0662
@DE00623 ICM   @03,15,FMFLTCHN(FMFLCUR)                            0662
         BZ    @DC00623                                            0662
         TM    WKAFSUCC(R13),B'00010000'                           0662
         BO    @DL00623                                            0662
@DC00623 DS    0H                                                  0663
*  /******************************************************************/
*  /*                                                                */
*  /*    RESTORE THE RETURN ADDRESS TO ALLOW EXIT                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0663
*  R14=WKARTNI;                   /* RESTORE THE RETURN ADDRESS      */
*                                                                  0663
         L     R14,WKARTNI(,R13)                                   0663
*  END PTSTS;                     /* END OF PROCEDURE                */
@EL00015 DS    0H                                                  0664
@EF00015 DS    0H                                                  0664
@ER00015 BR    @14                                                 0664
@PB00015 DS    0H                                                  0665
*  GEN(EJECT);                                                     0665
         EJECT
*  END IDCRC04                    /* END OF PROCEDURE                */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*@INCLUDE SYSLIB  (IDCDF61 )                                        *
*;                                                                 0666
@EL00001 DS    0H                                                  0666
@EF00001 DS    0H                                                  0666
@ER00001 LM    @14,@12,12(@13)                                     0666
         BR    @14                                                 0666
@DATA    DS    0H
@CH00047 DC    H'1'
@CH00200 DC    H'2'
@CH00087 DC    H'3'
@CH00139 DC    H'5'
@CH00122 DC    H'6'
@CH00053 DC    H'8'
@CH00171 DC    H'16'
@CH00285 DC    H'256'
@CH00286 DC    H'257'
@SM00347 MVC   CHR+256(0,@02),CHRI+256(@01)
@SM00349 MVC   CHR(0,@01),CHRI(@02)
@DATD    DSECT
         DS    0F
IDCRC04  CSECT
         DS    0F
@CF00343 DC    F'-8'
@CF00306 DC    XL4'0F'
@DATD    DSECT
         DS    0D
@TS00001 DS    CL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRC04  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CB00227 DC    X'FFFFFF'
@CB00283 DC    X'0000'
         DS    CL3
PTCHROOM DC    100A(0)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R1       EQU   @01
FMFLCUR  EQU   @04
TEMPAD   EQU   @05
FMPLAD   EQU   @06
WORKA    EQU   @07
WORKB    EQU   @08
WORKC    EQU   @09
WORKD    EQU   @10
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
CHAR1    EQU   0
SUBR15   EQU   0
FMPL     EQU   0
FMPLFLNO EQU   FMPL
FMPLBCIN EQU   FMPL+1
FMPLGRTN EQU   FMPL+4
FMPLWKAR EQU   FMPL+8
FMPLUPTR EQU   FMPL+12
FMPLRTCD EQU   FMPL+16
FMPLENTH EQU   FMPL+18
FMPLOAR  EQU   FMPL+20
FMPLFMFL EQU   FMPL+24
FMFL     EQU   0
FMFLTSTC EQU   FMFL+1
FMFLGRPC EQU   FMFL+2
FMFLINDS EQU   FMFL+3
FMFLWKAR EQU   FMFL+4
FMFLDNAM EQU   FMFL+8
FMFLTCHN EQU   FMFL+12
FMFLDATA EQU   FMFL+16
FMFLENTH EQU   FMFLDATA
FMFLADDR EQU   FMFLDATA+4
FMFLNAME EQU   0
FMFLCNTR EQU   0
GOP      EQU   0
GOPCINO  EQU   GOP
GOPDISP  EQU   GOPCINO+1
GOPINFO  EQU   GOP+3
GOPEXTPT EQU   GOPINFO
GOPDELET EQU   GOPINFO
GOP2BSEQ EQU   GOP+4
GOP1BSEQ EQU   GOP2BSEQ
CBKRD1   EQU   0
CBKID    EQU   CBKRD1+44
CBKNVLF  EQU   CBKRD1+47
CBKLOFX  EQU   CBKRD1+48
CBKRD2   EQU   0
CBKVRLEN EQU   CBKRD2
CBKDATA  EQU   CBKRD2+2
CBKRD3   EQU   0
@NM00007 EQU   CBKRD3
CBKEXTCI EQU   @NM00007
CBKCTGOP EQU   CBKRD3+5
CBKFGOP  EQU   CBKRD3+6
CBKRD4   EQU   0
CBKVARNO EQU   CBKRD4
CBKFXDLN EQU   CBKRD4+1
DCTE     EQU   0
DCTFNAME EQU   DCTE
DCTDINFO EQU   DCTE+4
DCT      EQU   0
DCTCMB   EQU   0
FOA      EQU   0
FOALENTH EQU   FOA
WKA      EQU   0
WKARSV   EQU   WKA
WKAGETIF EQU   WKA+72
@NM00009 EQU   WKAGETIF
WKARECFN EQU   @NM00009
WKANEXCI EQU   WKAGETIF+1
WKABLKAD EQU   WKAGETIF+4
WKAUPTR  EQU   WKA+80
WKAFGOP  EQU   WKA+84
WKAGODTA EQU   WKA+88
WKACOMBT EQU   WKA+92
WKADICTT EQU   WKA+96
WKANAME  EQU   WKA+100
WKACOMBC EQU   WKA+104
@NM00011 EQU   WKA+106
WKA1BSEQ EQU   @NM00011
WKAFLDNE EQU   @NM00011
WKAFLDNF EQU   @NM00011
WKAFSUCC EQU   @NM00011
WKACMPLT EQU   @NM00011
WKAEXITA EQU   @NM00011
WKAEXITB EQU   @NM00011
WKAEXITC EQU   @NM00011
WKAEXITD EQU   @NM00011+1
WKAEXITF EQU   @NM00011+1
WKAEXITG EQU   @NM00011+1
WKATCFTS EQU   @NM00011+1
WKATSTFL EQU   @NM00011+1
WKAGVFTS EQU   @NM00011+1
WKACONFG EQU   @NM00011+1
WKAFORL  EQU   @NM00011+1
WKASVGRC EQU   WKA+108
WKACURCI EQU   WKA+109
WKASEQNO EQU   WKA+112
WKAFNDLN EQU   WKA+114
WKAFNDAD EQU   WKA+116
WKADICTD EQU   WKA+120
WKADICTI EQU   WKADICTD
WKADTVAR EQU   WKADICTI
WKADTREP EQU   WKADICTI
WKADTCMB EQU   WKADICTI
WKADTFLG EQU   WKADICTI
WKADTEPT EQU   WKADICTI
WKADTSPL EQU   WKADICTI
WKADTSTR EQU   WKADICTD+1
WKADTLEN EQU   WKADICTD+2
WKAGRPCD EQU   WKADICTD+3
WKAFMFLI EQU   WKA+124
WKADRRNO EQU   WKA+126
WKAHREPN EQU   WKA+128
WKAGOPLN EQU   WKA+130
WKASVPOS EQU   WKA+132
WKAAREAP EQU   WKA+136
WKAAREAS EQU   WKA+140
WKAADJLN EQU   WKA+142
WKAADJAD EQU   WKA+144
WKARTNA  EQU   WKA+148
WKARTNB  EQU   WKA+152
WKARTNC  EQU   WKA+156
WKARTND  EQU   WKA+160
WKARTNE  EQU   WKA+164
WKARTNF  EQU   WKA+168
WKARTNG  EQU   WKA+172
WKARTNH  EQU   WKA+176
WKARTNI  EQU   WKA+180
TEMPA    EQU   WKA+184
CHR      EQU   0
CHRI     EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00013 EQU   WKA+200
@NM00012 EQU   WKADICTI
@NM00010 EQU   @NM00009
@NM00008 EQU   FOA+2
@NM00006 EQU   CBKRD1+45
@NM00005 EQU   CBKRD1
@NM00004 EQU   GOPINFO
@NM00003 EQU   GOPCINO
FMFLSUCC EQU   FMFLINDS
@NM00002 EQU   FMFLINDS
FMFLDLNO EQU   FMFL
@NM00001 EQU   FMPL+17
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00077 EQU   @RC00076
@RC00085 EQU   @EL00002
@RC00110 EQU   @EL00003
@RT00141 EQU   @EL00004
@RC00151 EQU   @EL00004
@RC00193 EQU   @RC00191
@RC00220 EQU   @RC00219
@RT00242 EQU   @RC00228
@RC00237 EQU   @RC00228
@RT00259 EQU   @RC00254
@RC00262 EQU   @RC00254
@RC00304 EQU   @RC00303
@RC00356 EQU   @RC00355
@RC00377 EQU   @RC00340
@RC00373 EQU   @RC00340
@RC00366 EQU   @RC00340
@RC00385 EQU   @RC00340
@RC00464 EQU   @RC00463
@RC00475 EQU   @RC00474
@RT00460 EQU   @EL00012
@RT00471 EQU   @EL00012
PTCMP1   EQU   @EL00013
@RT00593 EQU   @RC00585
@RC00648 EQU   @RC00645
@RC00646 EQU   @RC00645
@RC00092 EQU   @RC00085
@RC00086 EQU   @RC00085
@RC00154 EQU   @RC00151
@RC00195 EQU   @RC00193
@RC00357 EQU   @RC00356
@RT00369 EQU   @RC00366
@RC00388 EQU   @RC00385
@RC00087 EQU   @RC00086
@RC00093 EQU   @RC00092
@ENDDATA EQU   *
         END   IDCRC04,(C'PLS1943',0701,77277)

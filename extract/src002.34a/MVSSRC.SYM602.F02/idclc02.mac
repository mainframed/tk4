         TITLE '***** IDCLC02: LISTCAT FSR - FORMATTING AND LISTING ****
               ***      '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
        MACRO
        FREEMAIN &MODE,&LV=,&LA=,&A=,&SP=,&MF=I
        MEND
IDCLC02  CSECT ,                                                   0003
@MAINENT DS    0H                                                  0003
         USING *,@15                                               0003
         B     @PROLOG                                             0003
         DC    AL1(16)                                             0003
         DC    C'IDCLC02   76.335'                                 0003
         DROP  @15
@PROLOG  STM   @14,@04,12(@13)                                     0003
         STM   @06,@12,44(@13)                                     0003
         BALR  @08,0                                               0003
@PSTART  LA    @09,4095(,@08)                                      0003
         LA    @10,4095(,@09)                                      0003
         LA    @11,4095(,@10)                                      0003
         LA    @12,4095(,@11)                                      0003
         USING @PSTART,@08                                         0003
         USING @PSTART+4095,@09                                    0003
         USING @PSTART+8190,@10                                    0003
         USING @PSTART+12285,@11                                   0003
         USING @PSTART+16380,@12                                   0003
         L     @00,@SIZDATD                                        0003
         GETMAIN  R,LV=(0)
         LR    @05,@01                                             0003
         USING @DATD,@05                                           0003
         ST    @13,@SA00001+4                                      0003
         LM    @00,@01,20(@13)                                     0003
         ST    @05,8(,@13)                                         0003
         LR    @13,@05                                             0003
         MVC   @PC00001(8),0(@01)                                  0003
*                                                                  0264
*        /************************************************************/
*        /************************************************************/
*        /*                                                  @ZA05939*/
*        /* MAIN ENTRY POINT IN IDCLC02.  THIS ENTRY POINT   @ZA05939*/
*        /* IS CALLED ONLY ONCE BY IDCLC01 TO ACQUIRE        @ZA05939*/
*        /* AUTOMATIC STORAGE, ESTABLISH ADDRESSABILITY AND  @ZA05939*/
*        /* INITIALIZE THE COMMON AREA POINTER STRUCTURE.    @ZA05939*/
*        /*                                                  @ZA05939*/
*        /************************************************************/
*        /************************************************************/
*                                                                  0264
*        IF GDTDBG = NULLPTR                                       0264
*          THEN;                                                   0264
         L     @04,@PC00001                                        0264
         L     @04,GDTDBG(,@04)                                    0264
         LTR   @04,@04                                             0264
         BZ    @RT00264                                            0264
*          ELSE                                                    0266
*            CALL IDCDB010 (GDTTBL,'LC02');                        0266
         L     @04,@PC00001                                        0266
         ST    @04,@AL00001                                        0266
         LA    @15,@CC01427                                        0266
         ST    @15,@AL00001+4                                      0266
         MVI   @AL00001+4,X'80'                                    0266
         L     @15,GDTDBG(,@04)                                    0266
         LA    @01,@AL00001                                        0266
         BALR  @14,@15                                             0266
*                                                          /*@ZA05939*/
*        STM(REG8,REG12,BASESAVE);     /*SAVE INTERNAL BASE REGS     */
*                                                                  0267
@RT00264 STM   REG8,REG12,BASESAVE                                 0267
*        /************************************************************/
*        /*                                                  @ZA05939*/
*        /* INITIALIZE THE COMMON AREA POINTER STRUCTURE     @ZA05939*/
*        /* TO THE ADDRESSES OF THE COMMON AREA DATA         @ZA05939*/
*        /* STRUCTURES.  RETURN TO IDCLC01 PASSING BACK      @ZA05939*/
*        /* THE ADDRESS OF THE COMMON AREA POINTER STRUCTURE @ZA05939*/
*        /* IN REGISTER 15.                                  @ZA05939*/
*        /*                                                  @ZA05939*/
*        /************************************************************/
*                                                                  0268
*        RESPECIFY DARGLIST BASED(DARGPTR);                /*@ZA05939*/
*        COMSWKPT = ADDR(SAVWKPTR);                        /*@ZA05939*/
         LA    @04,SAVWKPTR                                        0269
         ST    @04,COMSWKPT                                        0269
*        COMFPLPT = ADDR(CORRFPLS);                        /*@ZA05939*/
         LA    @04,CORRFPLS                                        0270
         ST    @04,COMFPLPT                                        0270
*        COMFLGPT = ADDR(FLAGS);                           /*@ZA05939*/
         LA    @04,FLAGS                                           0271
         ST    @04,COMFLGPT                                        0271
*        COMVARPT = ADDR(MISCVAR);                         /*@ZA05939*/
         LA    @04,MISCVAR                                         0272
         ST    @04,COMVARPT                                        0272
*        COMTOTPT = ADDR(TYPAUDIT);                        /*@ZA05939*/
         LA    @04,TYPAUDIT                                        0273
         ST    @04,COMTOTPT                                        0273
*        COMPTR = ADDR(COMAREA);                           /*@ZA05939*/
*                                                                  0274
         LA    COMPTR,COMAREA                                      0274
*        RETURN CODE(COMPTR);          /*RETURN TO IDCLC01   @ZA05939*/
*                                                                  0275
         L     @13,4(,@13)                                         0275
         L     @00,@SIZDATD                                        0275
         LR    @01,@05                                             0275
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@02                                             0275
         L     @14,12(,@13)                                        0275
         LM    @00,@04,20(@13)                                     0275
         LM    @06,@12,44(@13)                                     0275
         BR    @14                                                 0275
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - LOCPROC                                 */
*        /*                                                          */
*        /* FUNCTION - ISSUES VSAM CATALOG/DADSM LOCATE REQUEST.     */
*        /* OBTAINS ADDITIONAL CATALOG WORKSPACE IF REQUIRED.        */
*        /* ESTABLISHES THE SUBTITLE WITH CATALOG NAME AFTER THE     */
*        /* FIRST LOCATE IS ISSUED.                                  */
*        /* AND SETS THE CATALOG ACB INFORMATION IN THE CPL AFTER    */
*        /* THE FIRST SUCCESSFUL LOCATE IS ISSUED.                   */
*        /*                                                          */
*        /* INPUT - VSAM CATALOG PARM AND FIELD LISTS AND THE        */
*        /* SAVE AREAS FOR THESE LISTS.  ALSO, SWITCHES TO SIGNAL    */
*        /* REQUESTS FOR ASSOCIATED ENTRY NAME OR CATALOG ACB PTR    */
*        /* OR SUBTITLE.                                             */
*        /*                                                          */
*        /* OUTPUT - VSAM CATALOG/DADSM RETURN CODE, RETRIEVED       */
*        /* CATALOG FIELD INFORMATION, AND SWITCH SETTINGS.          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0276
*LOCPROC:  PROCEDURE (FPLLAST,                                     0276
*                     CACBSW,                                      0276
*                     ENTNMSW) OPTIONS(SAVEAREA);                  0276
*                                                                  0276
LOCPROC  STM   @14,@12,12(@13)                                     0276
         ST    @13,@SA00002+4                                      0276
         LA    @14,@SA00002                                        0276
         ST    @14,8(,@13)                                         0276
         LR    @13,@14                                             0276
         MVC   @PC00002(12),0(@01)                                 0276
*        GEN(ENTRY LOCPROC);           /*EXT ENTRY POINT     @ZA05939*/
         ENTRY LOCPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  0278
         LM    REG8,REG12,BASESAVE                                 0278
*        /************************************************************/
*        /*                                                          */
*        /* PARAMETERS WHICH MAY BE MODIFIED.                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0279
*        DCL FPLLAST   FIXED(15) UNSIGNED;                         0279
*        DCL CACBSW    BIT(1);                                     0280
*        DCL ENTNMSW   BIT(1);                                     0281
*                                                                  0281
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0282
*        DCL SAVCPL    CHAR(*) BASED;  /*OVERLAY OF CPL              */
*        DCL CACBPTR   PTR(31);        /*SAVEAREA FOR PTR TO CAT ACB */
*        DCL TEMPWKA   PTR(31);        /*GET POOL PTR FOR LARGER WKA */
*        DCL MAXMVLEN  FIXED(15) CONSTANT(256);            /*@Y30SSMK*/
*                                      /*MAX LENGTH FOR MOVE @Y30SSMK*/
*        /************************************************************/
*        /*                                                          */
*        /* ARGUMENT LISTS FOR THE AMS UDUMP MACRO TO LIST THE       */
*        /* WORKAREA USED BY LOCATE, THE CATALOG PARM LIST, AND      */
*        /* THE FIELD PARM LISTS, THE CATALOG RETURN CODE, THE KEY=  */
*        /* ENTRYNAME OR C.I.#, AND THE PASSWORD.                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0286
*        DECLARE                                                   0286
*          1 DUMPWKA,                  /*DUMP DESCRIPTOR FOR CAT WKA */
*            2 ITEM0,                  /*DUMP DESCRIPTOR FOR WKA ADDR*/
*              3 ITEM0NM   CHAR(8),                                0286
*              3 ITEM0PTR  PTR(31),                                0286
*              3 ITEM0LEN  FIXED(15),                              0286
*              3 ITEM0TYP  CHAR(1),                                0286
*              3 *         CHAR(1),                                0286
*            2 ARYFORM,                /*FOR MULTIPLES OF 256 BYTES  */
*              3 ARYNM   CHAR(8),                                  0286
*              3 ARYSZ   FIXED(15) UNSIGNED,                       0286
*              3 ARYITEM FIXED(15) UNSIGNED,                       0286
*              3 ARYEXT  FIXED(15) UNSIGNED,                       0286
*              3 ARYHDR  CHAR(1),                                  0286
*              3 *       CHAR(1),                                  0286
*            2 ITEM1,                                              0286
*              3 ITEM1NM  CHAR(8),                                 0286
*              3 ITEM1PTR PTR(31),                                 0286
*              3 ITEM1LEN FIXED(15) UNSIGNED,                      0286
*              3 ITEM1TYP CHAR(1),                                 0286
*              3 *        CHAR(1),                                 0286
*            2 ITEM2,                  /*FOR A REMAINDER LT 256 BYTES*/
*              3 ITEM2NM   CHAR(8),                                0286
*                4 LIST2END  CHAR(1),  /*LIST ENDS WHEN NO REMAINDER */
*                4 *         CHAR(7),                              0286
*              3 ITEM2PTR  PTR(31),                                0286
*              3 ITEM2LEN  FIXED(15) UNSIGNED,                     0286
*              3 ITEM2TYP  CHAR(1),                                0286
*              3 *         CHAR(1),                                0286
*            2 LISTEND   CHAR(1);                                  0286
*                                                                  0286
*        DECLARE                                                   0287
*          1 DUMPARMS,                                             0287
*            2 ITEM6,                  /*DUMP DESCRIPTOR FOR CAT R.C.*/
*              3 ITEM6NM CHAR(8),                                  0287
*              3 ITEM6PTR  PTR(31),                                0287
*              3 ITEM6LEN  FIXED(15),                              0287
*              3 ITEM6TYP  CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 ITEM7,                  /*DUMP DESCRIPTOR FOR KEY     */
*              3 ITEM7NM   CHAR(8),                                0287
*              3 ITEM7PTR  PTR(31),                                0287
*              3 ITEM7LEN  FIXED(15),                              0287
*              3 ITEM7TYP  CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 ITEM8,                  /*DUMP DESCRIPTOR FOR PASSWORD*/
*              3 ITEM8NM   CHAR(8),                                0287
*              3 ITEM8PTR  PTR(31),                                0287
*              3 ITEM8LEN  FIXED(15),                              0287
*              3 ITEM8TYP  CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 ITEM3,                  /*DUMP DESCRIPTOR FOR CPL     */
*              3 ITEM3NM   CHAR(8),                                0287
*              3 ITEM3PTR  PTR(31),                                0287
*              3 ITEM3LEN  FIXED(15) UNSIGNED,                     0287
*              3 ITEM3TYP  CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 ARY2FORM,               /*FPL ARRAY DUMP DESCRIPTOR   */
*              3 ARY2NM    CHAR(8),                                0287
*              3 ARY2SZ    FIXED(15) UNSIGNED,                     0287
*              3 ARY2ITEM  FIXED(15) UNSIGNED,                     0287
*              3 ARY2EXT   FIXED(15) UNSIGNED,                     0287
*              3 ARY2HDR   CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 ITEM4,                  /*DUMP DESCRIPTOR FOR EACH FPL*/
*              3 ITEM4NM   CHAR(8),                                0287
*              3 ITEM4PTR  PTR(31),                                0287
*              3 ITEM4LEN  FIXED(15) UNSIGNED,                     0287
*              3 ITEM4TYP  CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 ITEM9,                  /*DUMP DESC FOR MULTITYP FPL  */
*              3 ITEM9NM   CHAR(8),                                0287
*                4 LIST3END CHAR(1),                               0287
*                4 *        CHAR(7),                               0287
*              3 ITEM9PTR  PTR(31),                                0287
*              3 ITEM9LEN  FIXED(15) UNSIGNED,                     0287
*              3 ITEM9TYP  CHAR(1),                                0287
*              3 *         CHAR(1),                                0287
*            2 LIST4END    CHAR(1);                                0287
*        /************************************************************/
*        /*                                                          */
*        /* SAVE A COPY OF THE CPL SINCE IT IS NOT A READ-ONLY PARM  */
*        /* LIST AND IS NEEDED TO REINITIALIZE CPL VALUES FOR THE    */
*        /* NEXT LOCATE REQUEST.                                     */
*        /* SAVE A SECOND COPY OF THE CPL SHOULD THE LOCATE ATTEMPT  */
*        /* RESULT IN AN INSUFFICIENT-CATALOG-WORKAREA CONDITION.    */
*        /* THE SECOND LOCATE REQUEST WITH A LARGER WORKAREA         */
*        /* WILL REQUIRE THE ORIGINAL CPL VALUES, NOT THE VALUES     */
*        /* MODIFIED BY CAT/DADSM DURING THE FIRST LOCATE ATTEMPT.   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0288
*                                                                  0288
*        IF GDTDBG = NULLPTR                                       0288
*          THEN;                                                   0288
         L     @04,@PC00001                                        0288
         L     @04,GDTDBG(,@04)                                    0288
         LTR   @04,@04                                             0288
         BZ    @RT00288                                            0288
*          ELSE                                                    0290
*            DO;                                                   0290
*              DMPINDEX = ADDR(DFLAGS);                            /*@Y
*026UE*/                                                           0291
*                                                                  0291
         LA    DMPINDEX,DFLAGS                                     0291
*              DMPITMNM = 'FLAGS';                                 0292
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0292
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0292
         MVC   DMPITMNM(5,DMPINDEX),@CC01544                       0292
*              DMPITMPT = ADDR(FLAGS);                             0293
         LA    @04,FLAGS                                           0293
         ST    @04,DMPITMPT(,DMPINDEX)                             0293
*              DMPITMLN = 33;                                      0294
         MVC   DMPITMLN(2,DMPINDEX),@CH01235                       0294
*              DMPITMTP = 'H';                                     0295
         MVI   DMPITMTP(DMPINDEX),C'H'                             0295
*              DMPINDEX = DMPINDEX + DMPELEMT;                     0296
*                                                                  0296
         AL    DMPINDEX,@CF00487                                   0296
*              DMPTRM = DMPTRMVL;                                  0297
         MVI   DMPTRM(DMPINDEX),X'FF'                              0297
*            END;                                           /*@YL026UE*
*                                                                  0298
*        IF GDTDBG = NULLPTR                                       0299
*          THEN;                                                   0299
@RT00288 L     @04,@PC00001                                        0299
         L     @04,GDTDBG(,@04)                                    0299
         LTR   @04,@04                                             0299
         BZ    @RT00299                                            0299
*          ELSE                                                    0301
*            CALL IDCDB010(GDTTBL,'LCLO',ADDR(DFLAGS));            0301
         L     @04,@PC00001                                        0301
         ST    @04,@AL00001                                        0301
         LA    @15,@CC01546                                        0301
         ST    @15,@AL00001+4                                      0301
         LA    @15,DFLAGS                                          0301
         ST    @15,@AFTEMPS                                        0301
         LA    @15,@AFTEMPS                                        0301
         ST    @15,@AL00001+8                                      0301
         MVI   @AL00001+8,X'80'                                    0301
         L     @15,GDTDBG(,@04)                                    0301
         LA    @01,@AL00001                                        0301
         BALR  @14,@15                                             0301
*                                                          /*@YL026UE*/
*                                                                  0302
*        IF ENTNMSW = ON                                           0302
*          THEN                        /* CPL FOR ASSOC ENTRYNAME    */
@RT00299 L     @04,@PC00002+8                                      0302
         TM    ENTNMSW(@04),B'10000000'                            0302
         BNO   @RF00302                                            0302
*            SA#CPLPT->SAVCPL(1:LC#CPLLN) = CTGPL(1:LC#CPLLN);     0303
         L     @04,SA#CPLPT                                        0303
         LH    @15,LC#CPLLN                                        0303
         BCTR  @15,0                                               0303
         L     @01,CTGPLPTR                                        0303
         EX    @15,@SM01747                                        0303
*          ELSE                        /* MAIN CPL AND SETUP-COPY    */
*            DO;                                                   0304
         B     @RC00302                                            0304
@RF00302 DS    0H                                                  0305
*              OLDCPLPT->SAVCPL(1:LCCPLLEN) = CTGPL(1:LCCPLLEN);   0305
         L     @04,OLDCPLPT                                        0305
         SLR   @15,@15                                             0305
         IC    @15,LCCPLLEN                                        0305
         BCTR  @15,0                                               0305
         L     @14,CTGPLPTR                                        0305
         EX    @15,@SM01749                                        0305
*              SAVCPLPT->SAVCPL(1:LCCPLLEN) = CTGPL(1:LCCPLLEN);   0306
         L     @04,SAVCPLPT                                        0306
         EX    @15,@SM01749                                        0306
*            END;                                                  0307
*                                                                  0307
*        /************************************************************/
*        /*                                                          */
*        /* ZERO THE CATALOG RETURN CODE PRIOR TO ISSUING THE LOCATE.*/
*        /* THEN DURING A TEST MODE, THE SELECTIVE DUMPING BEFORE A  */
*        /* LOCATE WILL REFLECT THE PROPER INITIALIZATION.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0308
*        CATRC = 0;                                                0308
@RC00302 SLR   @04,@04                                             0308
         STH   @04,CATRC                                           0308
*        /************************************************************/
*        /*                                                          */
*        /* PRIOR TO ISSUING THE LOCATE, INITIALIZE THE UDUMP LIST   */
*        /* TO SELECTIVELY DUMP THE FOLLOWING WHEN IN A TEST MODE:   */
*        /*   1) CATALOG PARM LIST                                   */
*        /*   2) FIELD PARM LISTS                                    */
*        /*   3) CATALOG RETURN CODE                                 */
*        /*   4) LOCATE KEY = A 44-BYTE ENTRYNAME OR A 3-BYTE CI#    */
*        /*   5) PASSWORD                                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0309
*        IF GDTDBG ^= NULLPTR                                      0309
*          THEN                                                    0309
         L     @15,@PC00001                                        0309
         C     @04,GDTDBG(,@15)                                    0309
         BE    @RF00309                                            0309
*            DO;                                                   0310
*              ITEM3NM = 'CTGPL';      /*CATALOG PARM LIST           */
         MVI   ITEM3NM+5,C' '                                      0311
         MVC   ITEM3NM+6(2),ITEM3NM+5                              0311
         MVC   ITEM3NM(5),@CC01547                                 0311
*              ITEM3PTR = CTGPLPTR;                                0312
         L     @04,CTGPLPTR                                        0312
         ST    @04,ITEM3PTR                                        0312
*              ITEM3TYP = 'H';                                     0313
         MVI   ITEM3TYP,C'H'                                       0313
*              ITEM4NM = 'FPL';        /*FIELD PARM LISTS            */
         MVI   ITEM4NM+3,C' '                                      0314
         MVC   ITEM4NM+4(4),ITEM4NM+3                              0314
         MVC   ITEM4NM(3),@CC01548                                 0314
*              ITEM4LEN = LCFPLLEN;                                0315
         SLR   @15,@15                                             0315
         IC    @15,LCFPLLEN                                        0315
         STH   @15,ITEM4LEN                                        0315
*              ITEM4TYP = 'H';                                     0316
         MVI   ITEM4TYP,C'H'                                       0316
*              ARY2NM = 'CTGFL';                                   0317
         MVI   ARY2NM+5,C' '                                       0317
         MVC   ARY2NM+6(2),ARY2NM+5                                0317
         MVC   ARY2NM(5),@CC01549                                  0317
*              ARY2SZ = LCFPLLEN;                                  0318
         STH   @15,ARY2SZ                                          0318
*              ARY2HDR = 'A';                                      0319
         MVI   ARY2HDR,C'A'                                        0319
*              ARY2ITEM = 1;                                       0320
         MVC   ARY2ITEM(2),@CH00045                                0320
*              IF ENTNMSW = ON                                     0321
*                THEN                  /*REQUEST FOR ENTRYNAME ONLY  */
         L     @15,@PC00002+8                                      0321
         TM    ENTNMSW(@15),B'10000000'                            0321
         BNO   @RF00321                                            0321
*                  DO;                                             0322
*                    ITEM3LEN = LC#CPLLN;                          0323
         LH    @15,LC#CPLLN                                        0323
         STH   @15,ITEM3LEN                                        0323
*                    ITEM4PTR = CTGFIELD(1);               /*@YL026UE*/
         L     @15,CTGFIELD(,@04)                                  0324
         ST    @15,ITEM4PTR                                        0324
*                    ARY2EXT = CTGNOFLD;                   /*@YL026UE*/
         SLR   @15,@15                                             0325
         IC    @15,CTGNOFLD(,@04)                                  0325
         STH   @15,ARY2EXT                                         0325
*                    LIST3END = 'FF'X;                     /*@Y30LSMK*/
         MVI   LIST3END,X'FF'                                      0326
*                  END;                                            0327
*                ELSE                                              0328
*                  IF FPLBEGN = 1                                  0328
*                    THEN                                          0328
         B     @RC00321                                            0328
@RF00321 LH    @04,FPLBEGN                                         0328
         C     @04,@CF00045                                        0328
         BNE   @RF00328                                            0328
*                      DO;                                 /*@Y30LSMK*/
*                        ITEM9NM = 'MULTIFPL';             /*@Y30LSMK*/
         MVC   ITEM9NM(8),@CC01550                                 0330
*                        ITEM9LEN = MTFPLLEN;              /*@Y30LSMK*/
         SLR   @15,@15                                             0331
         IC    @15,MTFPLLEN                                        0331
         STH   @15,ITEM9LEN                                        0331
*                        ITEM9TYP = 'H';                   /*@Y30LSMK*/
         MVI   ITEM9TYP,C'H'                                       0332
*                        ITEM9PTR = FPLPTMAP(FPLBEGN);     /*@Y30LSMK*/
         SLA   @04,2                                               0333
         L     @15,FPLPTMAP-4(@04)                                 0333
         ST    @15,ITEM9PTR                                        0333
*                        ITEM3LEN = LCCPLLEN;              /*@Y30LSMK*/
         SLR   @15,@15                                             0334
         IC    @15,LCCPLLEN                                        0334
         STH   @15,ITEM3LEN                                        0334
*                        ITEM4PTR = FPLPTMAP(FPLBEGN + 1); /*@Y30LSMK*/
         L     @04,FPLPTMAP(@04)                                   0335
         ST    @04,ITEM4PTR                                        0335
*                        ARY2EXT = FPLCNT - 1;             /*@Y30LSMK*/
         LH    @04,FPLCNT                                          0336
         BCTR  @04,0                                               0336
         STH   @04,ARY2EXT                                         0336
*                        LIST4END = 'FF'X;                 /*@Y30LSMK*/
         MVI   LIST4END,X'FF'                                      0337
*                      END;                                /*@Y30LSMK*/
*                    ELSE              /*REQUEST FOR ALL CAT FIELDS  */
*                      DO;                                         0339
         B     @RC00328                                            0339
@RF00328 DS    0H                                                  0340
*                        ITEM3LEN = LCCPLLEN;                      0340
         SLR   @04,@04                                             0340
         IC    @04,LCCPLLEN                                        0340
         STH   @04,ITEM3LEN                                        0340
*                        ITEM4PTR = FPLPTMAP(FPLBEGN);             0341
         LH    @04,FPLBEGN                                         0341
         SLA   @04,2                                               0341
         L     @04,FPLPTMAP-4(@04)                                 0341
         ST    @04,ITEM4PTR                                        0341
*                        ARY2EXT = FPLCNT;                         0342
         LH    @04,FPLCNT                                          0342
         STH   @04,ARY2EXT                                         0342
*                        LIST3END = 'FF'X;                         0343
         MVI   LIST3END,X'FF'                                      0343
*                      END;                                        0344
*              ITEM6NM = 'CATRC';      /*CATALOG RETURN CODE         */
@RC00328 DS    0H                                                  0345
@RC00321 MVI   ITEM6NM+5,C' '                                      0345
         MVC   ITEM6NM+6(2),ITEM6NM+5                              0345
         MVC   ITEM6NM(5),@CC01551                                 0345
*              ITEM6PTR = ADDR(CATRC);                             0346
         LA    @04,CATRC                                           0346
         ST    @04,ITEM6PTR                                        0346
*              ITEM6LEN = LENGTH(CATRC);                           0347
         MVC   ITEM6LEN(2),@CH00161                                0347
*              ITEM6TYP = 'H';                                     0348
*                                                                  0348
         MVI   ITEM6TYP,C'H'                                       0348
*              ITEM7NM = 'CTGENT';     /*LOCATE KEY                  */
         MVI   ITEM7NM+6,C' '                                      0349
         MVI   ITEM7NM+7,C' '                                      0349
         MVC   ITEM7NM(6),@CC01552                                 0349
*              ITEM7PTR = CTGENT;                                  0350
         L     @04,CTGPLPTR                                        0350
         L     @15,CTGENT(,@04)                                    0350
         ST    @15,ITEM7PTR                                        0350
*              ITEM7TYP = 'H';                                     0351
         MVI   ITEM7TYP,C'H'                                       0351
*              IF CTGNAME = ON                                     0352
*                THEN                                              0352
         TM    CTGNAME(@04),B'00000100'                            0352
         BNO   @RF00352                                            0352
*                  ITEM7LEN = LENGTH(ENT44);                       0353
         MVC   ITEM7LEN(2),@CH00606                                0353
*                ELSE                                              0354
*                  ITEM7LEN = LENGTH(CI#);                         0354
*                                                                  0354
         B     @RC00352                                            0354
@RF00352 MVC   ITEM7LEN(2),@CH00170                                0354
*              ITEM8NM = 'CTGPSWD';    /*PASSWORD                    */
@RC00352 MVI   ITEM8NM+7,C' '                                      0355
         MVC   ITEM8NM(7),@CC01553                                 0355
*              IF CTGPSWD = NULLPTR                                0356
*                THEN                                              0356
         L     @04,CTGPLPTR                                        0356
         L     @15,CTGPSWD(,@04)                                   0356
         LTR   @15,@15                                             0356
         BNZ   @RF00356                                            0356
*                  DO;                                             0357
*                  ITEM8PTR = ADDR(CTGPSWD);                       0358
         LA    @04,CTGPSWD(,@04)                                   0358
         ST    @04,ITEM8PTR                                        0358
*                  ITEM8LEN = LENGTH(CTGPSWD);                     0359
         MVC   ITEM8LEN(2),@CH00050                                0359
*                  ITEM8TYP = 'H';                                 0360
         MVI   ITEM8TYP,C'H'                                       0360
*                  END;                                            0361
*                ELSE                                              0362
*                  DO;                                             0362
         B     @RC00356                                            0362
@RF00356 DS    0H                                                  0363
*                  ITEM8PTR = CTGPSWD;                             0363
         L     @04,CTGPLPTR                                        0363
         L     @04,CTGPSWD(,@04)                                   0363
         ST    @04,ITEM8PTR                                        0363
*                  ITEM8TYP = 'C';                                 0364
         MVI   ITEM8TYP,C'C'                                       0364
*                  ITEM8LEN = LENGTH(MPW);                         0365
         MVC   ITEM8LEN(2),@CH00187                                0365
*                  END;                                            0366
*              IF GDTDBG = NULLPTR                                 0367
*                THEN;                                             0367
@RC00356 L     @04,@PC00001                                        0367
         L     @04,GDTDBG(,@04)                                    0367
         LTR   @04,@04                                             0367
         BZ    @RT00367                                            0367
*                ELSE                                              0369
*                  CALL IDCDB010 (GDTTBL, 'LCBL',ADDR(DUMPARMS));  0369
         L     @04,@PC00001                                        0369
         ST    @04,@AL00001                                        0369
         LA    @15,@CC01554                                        0369
         ST    @15,@AL00001+4                                      0369
         LA    @15,DUMPARMS                                        0369
         ST    @15,@AFTEMPS                                        0369
         LA    @15,@AFTEMPS                                        0369
         ST    @15,@AL00001+8                                      0369
         MVI   @AL00001+8,X'80'                                    0369
         L     @15,GDTDBG(,@04)                                    0369
         LA    @01,@AL00001                                        0369
         BALR  @14,@15                                             0369
*            END;                                                  0370
@RT00367 DS    0H                                                  0371
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE VSAM CATALOG LOCATE REQUEST.                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0371
*        CALL IDCSACA0 (GDTTBL,                                    0371
*                CTGPLPTR);                                        0371
*                                                                  0371
@RF00309 L     @04,@PC00001                                        0371
         ST    @04,@AL00001                                        0371
         LA    @15,CTGPLPTR                                        0371
         ST    @15,@AL00001+4                                      0371
         L     @15,GDTCAT(,@04)                                    0371
         LA    @01,@AL00001                                        0371
         BALR  @14,@15                                             0371
*        RESPECIFY (CATRCREG) RSTD;                        /*@ZA05939*/
*        CATRC = CATRCREG;                                         0373
         STH   CATRCREG,CATRC                                      0373
*        RESPECIFY (CATRCREG) UNRSTD;                      /*@ZA05939*/
*                                                                  0374
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* SAVE THE CPL WITH THE VSAM INITIALIZED FIELDS    @Y30SSMK*/
*        /* FOR USE LATER IF UERROR IS INVOKED AS A RESULT   @Y30SSMK*/
*        /* OF A CATALOG LOCATE ERROR.                       @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0375
*        IF ENTNMSW = ON                                           0375
*          THEN                                                    0375
         L     @04,@PC00002+8                                      0375
         TM    ENTNMSW(@04),B'10000000'                            0375
         BNO   @RF00375                                            0375
*            DO;                                           /*@Y30SSMK*/
*              ERRCPLPT = ER#CPLPT;                        /*@Y30SSMK*/
         L     @04,ER#CPLPT                                        0377
         ST    @04,ERRCPLPT                                        0377
*              ER#CPLPT->SAVCPL(1:LC#CPLLN) = CTGPL(1:LC#CPLLN);   0378
         LH    @15,LC#CPLLN                                        0378
         BCTR  @15,0                                               0378
         L     @01,CTGPLPTR                                        0378
         EX    @15,@SM01747                                        0378
*            END;                                          /*@Y30SSMK*/
*          ELSE                                                    0380
*            DO;                                           /*@Y30SSMK*/
         B     @RC00375                                            0380
@RF00375 DS    0H                                                  0381
*              ERRCPLPT = ERMCPLPT;                        /*@Y30SSMK*/
         L     @04,ERMCPLPT                                        0381
         ST    @04,ERRCPLPT                                        0381
*              ERMCPLPT->SAVCPL(1:LCCPLLEN) = CTGPL(1:LCCPLLEN);   0382
         SLR   @15,@15                                             0382
         IC    @15,LCCPLLEN                                        0382
         BCTR  @15,0                                               0382
         L     @01,CTGPLPTR                                        0382
         EX    @15,@SM01747                                        0382
*            END;                                          /*@Y30SSMK*/
*                                                                  0383
*        /************************************************************/
*        /*                                                          */
*        /* CHECK FOR AN UNSUCCESSFUL LOCATE AND MAKE A SECOND       */
*        /* LOCATE ATTEMPT SHOULD THE VSAM CATALOG RETURN CODE       */
*        /* INDICATE AN INSUFFICIENT WORKAREA.  OTHERWISE, RETURN    */
*        /* TO THE CALLER TO PROCESS THE NON-ZERO RETURN CODE.       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0384
*        IF CATRC > CRCSUCC                                        0384
*          THEN                                                    0384
@RC00375 LH    @04,CATRC                                           0384
         LTR   @04,@04                                             0384
         BNP   @RF00384                                            0384
*            IF CATRC = CRCWKASZ                                   0385
*              THEN                                                0385
         C     @04,@CF01249                                        0385
         BNE   @RF00385                                            0385
*                IF ENTNMSW = ON                                   0386
*                  THEN                                            0386
*                                                                  0386
         L     @04,@PC00002+8                                      0386
         TM    ENTNMSW(@04),B'10000000'                            0386
         BNO   @RF00386                                            0386
*                    /************************************************/
*                    /*                                      @YL026UE*/
*                    /* INSUFFICIENT-WORKAREA CONDITION OCCURRED UPON*/
*                    /* RETRIEVAL OF ONLY AN ENTRYNAME.  EXIT WITH   */
*                    /* A TERMINATING ERROR.                 @YL026UE*/
*                    /* NOTE - THIS CONDITION SHOULD NOT OCCUR       */
*                    /* UNLESS A CHANGE IN FUNCTIONAL SPECIFICATIONS */
*                    /* WAS NOT IMPLEMENTED.                 @YL026UE*/
*                    /*                                      @YL026UE*/
*                    /************************************************/
*                                                                  0387
*                    DO;                                   /*@YL026UE*/
*                      ERRARGPT->DARGSMOD = UV0ID;         /*@YL026UE*/
         L     @04,ERRARGPT                                        0388
         MVC   DARGSMOD(3,@04),@CC01290                            0388
*                      ERRARGPT->DARGSENT = UVMSG07;       /*@YL026UE*/
         MVI   DARGSENT(@04),X'07'                                 0389
*                      SAVRC = LASTCC12;                   /*@ZA05939*/
         LA    @04,12                                              0390
         STH   @04,SAVRC                                           0390
*                      RETURN CODE (LASTCC12);             /*@YL026UE*/
         LR    @15,@04                                             0391
         L     @13,4(,@13)                                         0391
         L     @14,12(,@13)                                        0391
         LM    @00,@12,20(@13)                                     0391
         BR    @14                                                 0391
*                    END;                                  /*@YL026UE*/
*                  /**************************************************/
*                  /*                                        @YL026UE*/
*                  /* THE INSUFFICIENT WORKAREA CONDITION OCCURRED   */
*                  /* UPON RETRIEVAL OF A SUBSET OF ENTRY FIELDS.    */
*                  /* OBTAIN STORAGE FOR THE LARGER WORKAREA @YL026UE*/
*                  /* SPECIFIED BY CAT/DADSM IN THE SECOND LENGTH    */
*                  /* FIELD OF THE WORKAREA.                 @YL026UE*/
*                  /*                                        @YL026UE*/
*                  /**************************************************/
*                                                                  0393
*                  ELSE                                            0393
*MOREWKA:            DO;                                           0393
@RF00386 DS    0H                                                  0393
MOREWKA  DS    0H                                                  0394
*                      GPID = GPID08;                      /*@ZA05939*/
         MVC   GPID(4),@CC01396                                    0394
*                      GPLEN = REQWKASZ;                           0395
*                                                                  0395
         L     @04,CTGPLPTR                                        0395
         L     @04,CTGWKA(,@04)                                    0395
         LH    @04,REQWKASZ(,@04)                                  0395
         ST    @04,GPLEN                                           0395
*                      CALL IDCSAGP0 (GDTTBL,                      0396
*                              GPLEN,                              0396
*                              TEMPWKA,                            0396
*                              GPID,                               0396
*                              SETZERO);                           0396
         L     @04,@PC00001                                        0396
         ST    @04,@AL00001                                        0396
         LA    @02,GPLEN                                           0396
         ST    @02,@AL00001+4                                      0396
         LA    @02,TEMPWKA                                         0396
         ST    @02,@AL00001+8                                      0396
         LA    @02,GPID                                            0396
         ST    @02,@AL00001+12                                     0396
         LA    @02,SETZERO                                         0396
         ST    @02,@AL00001+16                                     0396
         MVI   @AL00001+16,X'80'                                   0396
         L     @15,GDTGPL(,@04)                                    0396
         LA    @01,@AL00001                                        0396
         BALR  @14,@15                                             0396
*                      RESPECIFY RTNREG RSTD;                      0397
*                      TESTRC = RTNREG;                            0398
         LR    TESTRC,RTNREG                                       0398
*                      RESPECIFY RTNREG UNRSTD;                    0399
*                      IF TESTRC ^= 0                              0400
*                        THEN                                      0400
*                                                                  0400
         LTR   TESTRC,TESTRC                                       0400
         BZ    @RF00400                                            0400
*                          /******************************************/
*                          /*                                        */
*                          /* GET STORAGE REQUEST FAILED.            */
*                          /* SETUP THE APPROPRIATE DIAGNOSTIC.      */
*                          /*                                        */
*                          /******************************************/
*                                                                  0401
*                          DO;                                     0401
*                            ERRARGPT->DARGSMOD = LC1ID;           0402
         L     @04,ERRARGPT                                        0402
         MVC   DARGSMOD(3,@04),@CC01297                            0402
*                            ERRARGPT->DARGSENT = LCMSG02;         0403
         MVI   DARGSENT(@04),X'02'                                 0403
*                            ERRARGPT->DARGDBP = ENT44FPT->CTGFLPT(1);
         L     @15,ENT44FPT                                        0404
         L     @14,CTGFLPT(,@15)                                   0404
         ST    @14,DARGDBP(,@04)                                   0404
*                            ERRARGPT->DARGILP = ENT44FPT->CTGFLNG(1);
         L     @15,CTGFLNG(,@15)                                   0405
         STH   @15,DARGILP(,@04)                                   0405
*                          END;                                    0406
*                        /********************************************/
*                        /*                                          */
*                        /* RELEASE THE SMALLER WORKAREA.            */
*                        /* PREPARE FOR THE SECOND LOCATE ATTEMPT.   */
*                        /*                                          */
*                        /********************************************/
*                                                                  0407
*                        ELSE                                      0407
*                          DO;                                     0407
         B     @RC00400                                            0407
@RF00400 DS    0H                                                  0408
*                            CALL IDCSAFP0 (GDTTBL,                0408
*                                    'LC02');                      0408
         L     @04,@PC00001                                        0408
         ST    @04,@AL00001                                        0408
         LA    @15,@CC01427                                        0408
         ST    @15,@AL00001+4                                      0408
         MVI   @AL00001+4,X'80'                                    0408
         L     @15,GDTFPL(,@04)                                    0408
         LA    @01,@AL00001                                        0408
         BALR  @14,@15                                             0408
*                            SAVCPLPT->CTGWKA = TEMPWKA;           0409
         L     @04,TEMPWKA                                         0409
         L     @01,SAVCPLPT                                        0409
         ST    @04,CTGWKA(,@01)                                    0409
*                            OLDCPLPT->CTGWKA = TEMPWKA;           0410
         L     @15,OLDCPLPT                                        0410
         ST    @04,CTGWKA(,@15)                                    0410
*                            CTGPL(1:LCCPLLEN) =                   0411
*                              OLDCPLPT->SAVCPL(1:LCCPLLEN);       0411
         L     @04,CTGPLPTR                                        0411
         SLR   @14,@14                                             0411
         IC    @14,LCCPLLEN                                        0411
         BCTR  @14,0                                               0411
         EX    @14,@SM01751                                        0411
*                            CPLWKASZ = GPLEN;                     0412
*                                                                  0412
         L     @04,CTGWKA(,@04)                                    0412
         L     @15,GPLEN                                           0412
         STH   @15,CPLWKASZ(,@04)                                  0412
*                            CALL FPLPROC;                         0413
         BAL   @14,FPLPROC                                         0413
*                            CATRC = 0;                            0414
*                                                                  0414
         SLR   @04,@04                                             0414
         STH   @04,CATRC                                           0414
*                            /****************************************/
*                            /*                                      */
*                            /* ISSUE THE SECOND LOCATE BECAUSE OF   */
*                            /* AN INSUFFICIENT WORKAREA CONDITION.  */
*                            /*                                      */
*                            /****************************************/
*                                                                  0415
*                            CALL IDCSACA0 (GDTTBL,                0415
*                                    CTGPLPTR);                    0415
*                                                                  0415
         L     @04,@PC00001                                        0415
         ST    @04,@AL00001                                        0415
         LA    @15,CTGPLPTR                                        0415
         ST    @15,@AL00001+4                                      0415
         L     @15,GDTCAT(,@04)                                    0415
         LA    @01,@AL00001                                        0415
         BALR  @14,@15                                             0415
*                            RESPECIFY (CATRCREG) RSTD;    /*@ZA05939*/
*                            CATRC = CATRCREG;                     0417
         STH   CATRCREG,CATRC                                      0417
*                            RESPECIFY (CATRCREG) UNRSTD;  /*@ZA05939*/
*                                                                  0418
*                            /****************************************/
*                            /*                              @Y30SSMK*/
*                            /* SAVE THE CPL WITH THE VSAM   @Y30SSMK*/
*                            /* INITIALIZED FIELDS FOR USE   @Y30SSMK*/
*                            /* LATER IF UERROR IS INVOKED   @Y30SSMK*/
*                            /* AS A RESULT OF A CATALOG     @Y30SSMK*/
*                            /* LOCATE ERROR.                @Y30SSMK*/
*                            /*                              @Y30SSMK*/
*                            /****************************************/
*                                                                  0419
*                            ERRCPLPT = ERMCPLPT;          /*@Y30SSMK*/
         L     @04,ERMCPLPT                                        0419
         ST    @04,ERRCPLPT                                        0419
*                            ERMCPLPT->SAVCPL(1:LCCPLLEN) =        0420
*                              CTGPL(1:LCCPLLEN);          /*@Y30SSMK*/
*                                                                  0420
         SLR   @15,@15                                             0420
         IC    @15,LCCPLLEN                                        0420
         BCTR  @15,0                                               0420
         L     @01,CTGPLPTR                                        0420
         EX    @15,@SM01747                                        0420
*                            /****************************************/
*                            /*                                      */
*                            /* IF THE LOCATE IS AGAIN UNSUCCESSFUL, */
*                            /* SETUP THE APPROPRIATE DIAGNOSTIC.    */
*                            /*                                      */
*                            /****************************************/
*                                                                  0421
*                            IF CATRC ^= CRCSUCC                   0421
*                              THEN                                0421
         LH    @04,CATRC                                           0421
         LTR   @04,@04                                             0421
         BZ    @RF00421                                            0421
*                                IF CATRC = CRCWKASZ               0422
*                                  THEN                            0422
         C     @04,@CF01249                                        0422
         BNE   @RF00422                                            0422
*                                    DO;                           0423
*                                    ERRARGPT->DARGSMOD = LC1ID;   0424
         L     @04,ERRARGPT                                        0424
         MVC   DARGSMOD(3,@04),@CC01297                            0424
*                                    ERRARGPT->DARGSENT = LCMSG02; 0425
         MVI   DARGSENT(@04),X'02'                                 0425
*                                    ERRARGPT->DARGDBP =           0426
*                                      ENT44FPT->CTGFLPT(1);       0426
         L     @15,ENT44FPT                                        0426
         L     @14,CTGFLPT(,@15)                                   0426
         ST    @14,DARGDBP(,@04)                                   0426
*                                    ERRARGPT->DARGILP =           0427
*                                      ENT44FPT->CTGFLNG(1);       0427
         L     @15,CTGFLNG(,@15)                                   0427
         STH   @15,DARGILP(,@04)                                   0427
*                                    END;                          0428
*                                  ELSE                            0429
*                                    DO;                           0429
         B     @RC00422                                            0429
@RF00422 DS    0H                                                  0430
*                                      ERRARGPT->DARGSMOD = UV0ID; 0430
         L     @04,ERRARGPT                                        0430
         MVC   DARGSMOD(3,@04),@CC01290                            0430
*                                      ERRARGPT->DARGSENT = UVMSG07;
         MVI   DARGSENT(@04),X'07'                                 0431
*                                    END;                          0432
*                          END;                                    0433
*                    END MOREWKA;                                  0434
*                                                                  0434
*              /******************************************************/
*              /*                                                    */
*              /* SETUP THE MESSAGE LISTING THE VSAM CATALOG RETURN  */
*              /* CODE FOR ALL OTHER NON-ZERO VALUES.                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0435
*              ELSE                                                0435
*                DO;                                               0435
         B     @RC00385                                            0435
@RF00385 DS    0H                                                  0436
*                  ERRARGPT->DARGSMOD = UV0ID;                     0436
         L     @04,ERRARGPT                                        0436
         MVC   DARGSMOD(3,@04),@CC01290                            0436
*                  ERRARGPT->DARGSENT = UVMSG07;                   0437
         MVI   DARGSENT(@04),X'07'                                 0437
*                END;                                              0438
*                                                                  0439
*        /************************************************************/
*        /*                                                          */
*        /* DUMP THE CATALOG PARM LIST AND THE FIELD PARM LISTS      */
*        /* FOLLOWING THE LOCATE REQUEST.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0439
*        IF GDTDBG = NULLPTR                                       0439
*          THEN;                                                   0439
@RC00385 DS    0H                                                  0439
@RF00384 L     @04,@PC00001                                        0439
         L     @04,GDTDBG(,@04)                                    0439
         LTR   @04,@04                                             0439
         BZ    @RT00439                                            0439
*          ELSE                                                    0441
*            CALL IDCDB010 (GDTTBL,'LCAL',ADDR(DUMPARMS));         0441
*                                                                  0441
         L     @04,@PC00001                                        0441
         ST    @04,@AL00001                                        0441
         LA    @15,@CC01558                                        0441
         ST    @15,@AL00001+4                                      0441
         LA    @15,DUMPARMS                                        0441
         ST    @15,@AFTEMPS                                        0441
         LA    @15,@AFTEMPS                                        0441
         ST    @15,@AL00001+8                                      0441
         MVI   @AL00001+8,X'80'                                    0441
         L     @15,GDTDBG(,@04)                                    0441
         LA    @01,@AL00001                                        0441
         BALR  @14,@15                                             0441
*        /************************************************************/
*        /*                                                          */
*        /* DUMP THE CATALOG DICTIONARY WORKAREA IN 256 BYTE BLOCKS, */
*        /* USING THE LENGTH FIELD SET BY VSAM CATALOG MGMT.         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0442
*        IF GDTDBG ^= NULLPTR                                      0442
*          THEN                                                    0442
@RT00439 SLR   @04,@04                                             0442
         L     @15,@PC00001                                        0442
         C     @04,GDTDBG(,@15)                                    0442
         BE    @RF00442                                            0442
*            DO;                                                   0443
*            ARYNM = 'CTGWKA';                                     0444
         MVI   ARYNM+6,C' '                                        0444
         MVI   ARYNM+7,C' '                                        0444
         MVC   ARYNM(6),@CC01559                                   0444
*            ARYITEM = 1;                                          0445
         LA    @15,1                                               0445
         STH   @15,ARYITEM                                         0445
*            ARYHDR = 'A';                                         0446
         MVI   ARYHDR,C'A'                                         0446
*            ITEM1NM = 'WKA';                                      0447
         MVI   ITEM1NM+3,C' '                                      0447
         MVC   ITEM1NM+4(4),ITEM1NM+3                              0447
         MVC   ITEM1NM(3),@CC01560                                 0447
*            ITEM1PTR = CTGWKA;                                    0448
         L     @14,CTGPLPTR                                        0448
         L     @07,CTGWKA(,@14)                                    0448
         ST    @07,ITEM1PTR                                        0448
*            ITEM1TYP = 'H';                                       0449
         MVI   ITEM1TYP,C'H'                                       0449
*            ITEM0NM = 'CTGWKAPT';                                 0450
         MVC   ITEM0NM(8),@CC01561                                 0450
*            ITEM0PTR = ADDR(CTGWKA);                              0451
         LA    @14,CTGWKA(,@14)                                    0451
         ST    @14,ITEM0PTR                                        0451
*            ITEM0TYP = 'H';                                       0452
         MVI   ITEM0TYP,C'H'                                       0452
*            ITEM0LEN = LENGTH(CTGWKA);                            0453
*                                                                  0453
         LA    @14,4                                               0453
         STH   @14,ITEM0LEN                                        0453
*            /********************************************************/
*            /*                                                      */
*            /* FOR AN UNSUCCESSFUL LOCATE REQUEST, THE LENGTH FIELD */
*            /* SET BY CATALOG MANAGEMENT MAY BE ZERO.  IF SO, DUMP  */
*            /* ONLY THE TWO LENGTH FIELDS OF THE WORKAREA.          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0454
*            IF REQWKASZ = 0                                       0454
*              THEN                                                0454
         CH    @04,REQWKASZ(,@07)                                  0454
         BNE   @RF00454                                            0454
*                DO;                                               0455
*                ARYSZ = LENGTH(CPLWKASZ) + LENGTH(REQWKASZ);      0456
         STH   @14,ARYSZ                                           0456
*                ITEM1LEN = ARYSZ;                                 0457
         STH   @14,ITEM1LEN                                        0457
*                ARYEXT = 1;                                       0458
         STH   @15,ARYEXT                                          0458
*                LIST2END = 'FF'X;                                 0459
         MVI   LIST2END,X'FF'                                      0459
*                END;                                              0460
*              ELSE                                                0461
*                IF ENTNMSW = ON                                   0461
*                  THEN                /*SHORT WKA FOR ENTRYNAME     */
         B     @RC00454                                            0461
@RF00454 L     @04,@PC00002+8                                      0461
         TM    ENTNMSW(@04),B'10000000'                            0461
         BNO   @RF00461                                            0461
*                    DO;                                           0462
*                    ARYSZ = ENTREQSZ;                             0463
         L     @04,ENTWKAPT                                        0463
         LH    @04,ENTREQSZ(,@04)                                  0463
         STH   @04,ARYSZ                                           0463
*                    ITEM1LEN = ENTREQSZ;                          0464
         STH   @04,ITEM1LEN                                        0464
*                    ARYEXT = 1;                                   0465
         MVC   ARYEXT(2),@CH00045                                  0465
*                    LIST2END = 'FF'X;                             0466
         MVI   LIST2END,X'FF'                                      0466
*                    END;                                          0467
*                  /**************************************************/
*                  /*                                                */
*                  /* DUMP THE FIELDS RETURNED IN THE MAIN WORKAREA. */
*                  /* TO AVOID REFERENCING OUTSIDE THE LISTC STORAGE */
*                  /* AREA, SETUP ADDITIONAL DUMP PARMS FOR THOSE    */
*                  /* TRAILING WORKAREA BYTES LESS THAN A 256 BYTE   */
*                  /* MULTIPLE.                                      */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0468
*                  ELSE                                            0468
*TOTWKA:             DO;                                           0468
         B     @RC00461                                            0468
@RF00461 DS    0H                                                  0468
TOTWKA   DS    0H                                                  0469
*                    ARYEXT = REQWKASZ/MAXMVLEN;           /*@Y30SSMK*/
         L     @04,CTGPLPTR                                        0469
         L     @04,CTGWKA(,@04)                                    0469
         LH    @04,REQWKASZ(,@04)                                  0469
         LR    @15,@04                                             0469
         SRL   @15,8                                               0469
         STH   @15,ARYEXT                                          0469
*                    ITEM2LEN = REQWKASZ//MAXMVLEN;        /*@Y30SSMK*/
         LR    @00,@04                                             0470
         SRDA  @00,32                                              0470
         D     @00,@CF00044                                        0470
         STH   @00,ITEM2LEN                                        0470
*                    IF ARYEXT = 0                                 0471
*                      THEN            /*WKA LT 256 BYTES            */
         LTR   @15,@15                                             0471
         BNZ   @RF00471                                            0471
*                        DO;                                       0472
*                          ARYSZ = ITEM2LEN;                       0473
         STH   @00,ARYSZ                                           0473
*                          ITEM1LEN = ITEM2LEN;                    0474
         STH   @00,ITEM1LEN                                        0474
*                          ARYEXT = 1;                             0475
         MVC   ARYEXT(2),@CH00045                                  0475
*                          LIST2END = 'FF'X;                       0476
         MVI   LIST2END,X'FF'                                      0476
*                        END;                                      0477
*                      ELSE            /*WKA MULTIPLE OF 256 BYTES   */
*                        DO;                                       0478
         B     @RC00471                                            0478
@RF00471 DS    0H                                                  0479
*                          ARYSZ = MAXMVLEN;               /*@Y30SSMK*/
         LA    @04,256                                             0479
         STH   @04,ARYSZ                                           0479
*                          ITEM1LEN = MAXMVLEN;            /*@Y30SSMK*/
         STH   @04,ITEM1LEN                                        0480
*                          IF ITEM2LEN > 0                         0481
*                            THEN      /*WKA REMAINDER LT 256 BYTES  */
         LH    @00,ITEM2LEN                                        0481
         LTR   @00,@00                                             0481
         BNP   @RF00481                                            0481
*                              DO;                                 0482
*                                LISTEND = 'FF'X;                  0483
         MVI   LISTEND,X'FF'                                       0483
*                                ITEM2NM = 'WKAEND';               0484
         MVI   ITEM2NM+6,C' '                                      0484
         MVI   ITEM2NM+7,C' '                                      0484
         MVC   ITEM2NM(6),@CC01564                                 0484
*                                ITEM2PTR = CTGWKA + (ARYEXT*MAXMVLEN);
         LH    @04,ARYEXT                                          0485
         SLA   @04,8                                               0485
         L     @15,CTGPLPTR                                        0485
         AL    @04,CTGWKA(,@15)                                    0485
         ST    @04,ITEM2PTR                                        0485
*                                ITEM2TYP = 'H';                   0486
         MVI   ITEM2TYP,C'H'                                       0486
*                              END;                                0487
*                            ELSE      /*NO WKA REMAINDER            */
*                              LIST2END = 'FF'X;                   0488
         B     @RC00481                                            0488
@RF00481 MVI   LIST2END,X'FF'                                      0488
*                        END;                                      0489
@RC00481 DS    0H                                                  0490
*                    END TOTWKA;                                   0490
*                                                                  0490
@RC00471 DS    0H                                                  0491
*              IF GDTDBG = NULLPTR                                 0491
*                THEN;                                             0491
@RC00461 DS    0H                                                  0491
@RC00454 L     @04,@PC00001                                        0491
         L     @04,GDTDBG(,@04)                                    0491
         LTR   @04,@04                                             0491
         BZ    @RT00491                                            0491
*                ELSE                                              0493
*                  CALL IDCDB010 (GDTTBL,'LCWA',ADDR(DUMPWKA));    0493
         L     @04,@PC00001                                        0493
         ST    @04,@AL00001                                        0493
         LA    @00,@CC01565                                        0493
         ST    @00,@AL00001+4                                      0493
         LA    @00,DUMPWKA                                         0493
         ST    @00,@AFTEMPS                                        0493
         LA    @00,@AFTEMPS                                        0493
         ST    @00,@AL00001+8                                      0493
         MVI   @AL00001+8,X'80'                                    0493
         L     @15,GDTDBG(,@04)                                    0493
         LA    @01,@AL00001                                        0493
         BALR  @14,@15                                             0493
*            END;                                                  0494
@RT00491 DS    0H                                                  0495
*        /************************************************************/
*        /*                                                          */
*        /* RESTORE THE APPROPRIATE CPL                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0495
*        IF ENTNMSW = ON                                           0495
*          THEN                        /*RESTORE ENTRYNAME CPL       */
@RF00442 L     @04,@PC00002+8                                      0495
         TM    ENTNMSW(@04),B'10000000'                            0495
         BNO   @RF00495                                            0495
*            CTGPL(1:LC#CPLLN) = SA#CPLPT->SAVCPL(1:LC#CPLLN);     0496
         L     @04,CTGPLPTR                                        0496
         LH    @15,LC#CPLLN                                        0496
         BCTR  @15,0                                               0496
         L     @14,SA#CPLPT                                        0496
         EX    @15,@SM01753                                        0496
*          ELSE                        /*RESTORE SUPERSET CPL        */
*            CTGPL(1:LCCPLLEN) = SAVCPLPT->SAVCPL(1:LCCPLLEN);     0497
         B     @RC00495                                            0497
@RF00495 L     @04,CTGPLPTR                                        0497
         SLR   @15,@15                                             0497
         IC    @15,LCCPLLEN                                        0497
         BCTR  @15,0                                               0497
         L     @14,SAVCPLPT                                        0497
         EX    @15,@SM01753                                        0497
*        /************************************************************/
*        /*                                                          */
*        /* ESTABLISH THE SUBTITLE LINE AT THIS POINT NOW THAT THE   */
*        /* CATALOG NAME IS SURELY KNOWN AFTER THE FIRST LOCATE      */
*        /* REQUEST.                                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0498
*        IF SUBTFLG = OFF & GDTECT = NULLPTR                 /*YM4128*/
*          THEN                        /*GET SUBTITLE STATIC TEXT    */
@RC00495 TM    SUBTFLG,B'10000000'                                 0498
         BNZ   @RF00498                                            0498
         L     @04,@PC00001                                        0498
         L     @04,GDTECT(,@04)                                    0498
         LTR   @04,@04                                             0498
         BNZ   @RF00498                                            0498
*            DO;                                                   0499
*              SUBTFLG = ON;                                       0500
         OI    SUBTFLG,B'10000000'                                 0500
*              DARGSENT = LCST02;                                  0501
         L     @04,DARGPTR                                         0501
         MVI   DARGSENT(@04),X'02'                                 0501
*              DARGRETP = ADDR(LCSUBTIT);                          0502
         LA    @00,LCSUBTIT                                        0502
         ST    @00,DARGRETP(,@04)                                  0502
*              DARGRETL = LENGTH(LCSUBTIT);                        0503
         MVC   DARGRETL(2,@04),@CH01743                            0503
*              DARGCNT = DRGCNT1;                          /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00045                             0504
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/
         MVC   DARGINS(2,@04),@CH00457                             0505
*              DARGINL(1) = LENGTH(CATNAME);                       0506
         MVC   DARGINL(2,@04),@CH00606                             0506
*              DARGDTM(1) = ADDR(CATNAME);                         0507
         LA    @00,CATNAME                                         0507
         ST    @00,DARGDTM(,@04)                                   0507
*              CALL LISTPROC;                                      0508
*                                                                  0508
         BAL   @14,LISTPROC                                        0508
*              /******************************************************/
*              /*                                                    */
*              /* ESTABLISH THE SUBTITLE FOR THE CATALOG LISTING VIA */
*              /* THE UESTA AMS TEXT PROCESSOR MACRO.                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0509
*              PCARG = ZEROAREA;                                   0509
         MVC   PCARG(33),ZEROAREA                                  0509
*              PCSTLP = ADDR(LCSUBTIT);                            0510
         LA    @04,LCSUBTIT                                        0510
         ST    @04,PCSTLP                                          0510
*              PCSTLC = 1;                                         0511
*                                                                  0511
         MVC   PCSTLC(2),@CH00045                                  0511
*              CALL AMSTP042 (GDTTBL, OTIOCSPT, PCARG);            0512
         L     @04,@PC00001                                        0512
         ST    @04,@AL00001                                        0512
         LA    @02,OTIOCSPT                                        0512
         ST    @02,@AL00001+4                                      0512
         LA    @02,PCARG                                           0512
         ST    @02,@AL00001+8                                      0512
         L     @15,GDTESA(,@04)                                    0512
         LA    @01,@AL00001                                        0512
         BALR  @14,@15                                             0512
*              RESPECIFY RTNREG RSTD;                              0513
*              TESTRC = RTNREG;                                    0514
         LR    TESTRC,RTNREG                                       0514
*              RESPECIFY RTNREG UNRSTD;                            0515
*              SAVRC = MAX (SAVRC, TESTRC);                /*@ZA05939*/
         LH    @04,SAVRC                                           0516
         CR    @04,TESTRC                                          0516
         BNL   *+6
         LR    @04,TESTRC                                          0516
         STH   @04,SAVRC                                           0516
*            END;                                                  0517
*        /************************************************************/
*        /*                                                          */
*        /* FOR A NON-ZERO VSAM CATALOG RETURN CODE, UPDATE THE      */
*        /* LISTC FINAL CONDITION CODE AND EXIT AT THIS POINT.       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0518
*        IF CATRC ^= CRCSUCC                                       0518
*          THEN                                                    0518
*                                                                  0518
@RF00498 LH    @04,CATRC                                           0518
         LTR   @04,@04                                             0518
         BZ    @RF00518                                            0518
*            /********************************************************/
*            /*                                                      */
*            /* UPDATE THE FINAL CONDITION CODE UNLESS AN EOF FOR    */
*            /* THE GETNEXT MODE OCCURRED.                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0519
*            IF CATRC ^= CRCNOENT   ENLVUDFG = ON                 0519
*              THEN                                                0519
         C     @04,@CF00187                                        0519
         BNE   @RT00519                                            0519
         TM    ENLVUDFG,B'10000000'                                0519
         BNO   @RF00519                                            0519
@RT00519 DS    0H                                                  0520
*                DO;                                               0520
*                                                                  0520
*                /****************************************************/
*                /*                                                  */
*                /* SHOULD PASSWORD VERIFICATION FAIL FOR EITHER THE */
*                /* NAME SUBSET REQUEST OR WHEN LISTING THE          */
*                /* ASSOCIATED NAMES OF A CLUSTER OR THE ENTRYNAMES  */
*                /* FOR THE SPACE DATASET DIRECTORY, DO NOT UPDATE   */
*                /* THE FINAL CONDITION CODE OR OUTPUT DIAGNOSTICS.  */
*                /*                                                  */
*                /****************************************************/
*                                                                  0521
*                IF CATRC = CRCBADPW  &                            0521
*                  (ENTNMSW = ON    ADDR(NAME) > NULLPTR)         0521
*                  THEN;                                           0521
         CLC   CATRC(2),@CH01280                                   0521
         BNE   @RF00521                                            0521
         L     @04,@PC00002+8                                      0521
         TM    ENTNMSW(@04),B'10000000'                            0521
         BO    @RT00521                                            0521
         L     @04,@PC00001+4                                      0521
         L     @04,FDTPTR+52(,@04)                                 0521
         LTR   @04,@04                                             0521
         BP    @RT00521                                            0521
*                  ELSE                                            0523
*                    SAVRC = MAX (SAVRC, LASTCC04);        /*@ZA05939*/
@RF00521 LH    @04,SAVRC                                           0523
         LA    @00,4                                               0523
         CR    @04,@00                                             0523
         BNL   *+6
         LR    @04,@00                                             0523
         STH   @04,SAVRC                                           0523
*                ENTNMSW = OFF;                                    0524
@RT00521 L     @04,@PC00002+8                                      0524
         NI    ENTNMSW(@04),B'01111111'                            0524
*                RETURN CODE (LASTCC04);                           0525
         LA    @15,4                                               0525
         L     @13,4(,@13)                                         0525
         L     @14,12(,@13)                                        0525
         LM    @00,@12,20(@13)                                     0525
         BR    @14                                                 0525
*                END;                                              0526
*                                                                  0526
*              /******************************************************/
*              /*                                                    */
*              /* EXIT WITHOUT UPDATING THE FINAL CONDITIONAL CODE   */
*              /* BECAUSE A VSAM CATALOG RETURN CODE OF 8 IN THE     */
*              /* GET-NEXT MODE INDICATES AN EOF.                    */
*              /*                                                    */
*              /******************************************************/
*                                                                  0527
*              ELSE                                                0527
*                DO;                                               0527
@RF00519 DS    0H                                                  0528
*                ENTNMSW = OFF;                                    0528
         L     @04,@PC00002+8                                      0528
         NI    ENTNMSW(@04),B'01111111'                            0528
*                RETURN CODE(LASTCC04);                            0529
         LA    @15,4                                               0529
         L     @13,4(,@13)                                         0529
         L     @14,12(,@13)                                        0529
         LM    @00,@12,20(@13)                                     0529
         BR    @14                                                 0529
*                END;                                              0530
*          ELSE                                                    0531
*            ENTNMSW = OFF;                                        0531
@RF00518 L     @04,@PC00002+8                                      0531
         NI    ENTNMSW(@04),B'01111111'                            0531
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE WHETHER THE CATALOG ACB POINTER WAS UNKNOWN    */
*        /* FOR FIRST LOCATE REQUEST.  IF SO, INSERT IN THE CPL      */
*        /* THE RETRIEVED ACB POINTER.                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0532
*        IF CACBSW = ON    &                               /*@YL026UE*/
*           FPLPTMAP(FPLLAST) -> CTGFLPT(1) ^= NULLPTR     /*@YL026UE*/
*          THEN                                                    0532
         L     @04,@PC00002+4                                      0532
         TM    CACBSW(@04),B'10000000'                             0532
         BNO   @RF00532                                            0532
         L     @15,@PC00002                                        0532
         LH    @14,FPLLAST(,@15)                                   0532
         LR    @07,@14                                             0532
         SLA   @07,2                                               0532
         L     @07,FPLPTMAP-4(@07)                                 0532
         L     @06,CTGFLPT(,@07)                                   0532
         LTR   @06,@06                                             0532
         BZ    @RF00532                                            0532
*            DO;                                                   0533
*              CACBSW = OFF;           /*RESET INTERNAL SWITCH       */
*                                                                  0534
         NI    CACBSW(@04),B'01111111'                             0534
*              /******************************************************/
*              /*                                                    */
*              /* LOCATE FPL ASSOCIATED WITH CATALOG ACB             */
*              /*                                                    */
*              /******************************************************/
*                                                                  0535
*              CTGFLPTR = FPLPTMAP(FPLLAST);                       0535
         ST    @07,CTGFLPTR                                        0535
*              CACBPTR = CACB;         /*MOVE CAT ACB PTR TO SAVEAREA*/
         L     @04,CTGFLPT(,@07)                                   0536
         MVC   CACBPTR(4),CACB(@04)                                0536
*              CTGCAT = ADDR(CACBPTR); /*ADDR(CAT ACB PTR) IN CPL    */
         L     @04,CTGPLPTR                                        0537
         LA    @07,CACBPTR                                         0537
         ST    @07,CTGCAT(,@04)                                    0537
*              CTGCNAME = OFF;         /*SET CPL TO INDICATE CAT ACB */
         NI    CTGCNAME(@04),B'11111101'                           0538
*              CTGNOFLD = CTGNOFLD-1;  /*RESET TOTAL FPL'S           */
*                                                                  0539
         SLR   @06,@06                                             0539
         IC    @06,CTGNOFLD(,@04)                                  0539
         BCTR  @06,0                                               0539
         STC   @06,CTGNOFLD(,@04)                                  0539
*              /******************************************************/
*              /*                                                    */
*              /*RESET ENTRYNAME-CPL VALUES                          */
*              /*                                                    */
*              /******************************************************/
*                                                                  0540
*              CI#CPLPT->CTGCAT = ADDR(CACBPTR);                   0540
         L     @04,CI#CPLPT                                        0540
         ST    @07,CTGCAT(,@04)                                    0540
*              CI#CPLPT->CTGCNAME = OFF;                           0541
*                                                                  0541
         NI    CTGCNAME(@04),B'11111101'                           0541
*              /******************************************************/
*              /*                                                    */
*              /*DROP THE SPECIAL CATACB FPL                         */
*              /*                                                    */
*              /******************************************************/
*                                                                  0542
*              FPLCNT = FPLCNT - 1;                                0542
         LH    @04,FPLCNT                                          0542
         BCTR  @04,0                                               0542
         STH   @04,FPLCNT                                          0542
*              FPLLAST = FPLLAST - 1;                              0543
         BCTR  @14,0                                               0543
         STH   @14,FPLLAST(,@15)                                   0543
*            END;                                                  0544
*                                                                  0544
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM CATALOG LOCATE ROUTINE, RETURNING TO CALLER.   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0545
*        RETURN CODE(0);                                           0545
@RF00532 SLR   @15,@15                                             0545
         L     @13,4(,@13)                                         0545
         L     @14,12(,@13)                                        0545
         LM    @00,@12,20(@13)                                     0545
         BR    @14                                                 0545
*        END LOCPROC;                                              0546
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - FPLPROC                                 */
*        /*                                                          */
*        /* FUNCTION - REINITIALIZES THE STRING OF FPLS PRIOR TO     */
*        /*            EACH CATALOG LOCATE REQUEST, BY USING THE     */
*        /*            SAVEAREA COPY STORED AT ORIGINAL FPL BUILD    */
*        /*            TIME.                                         */
*        /*                                                          */
*        /* INPUT - LENGTH OF EACH FPL AND TOTAL NUMBER OF FPLS      */
*        /*                                                          */
*        /* OUTPUT - RESTORED FPLS TO INITIALIZED STATE              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0547
*FPLPROC:                                                          0547
*        PROCEDURE OPTIONS(SAVEAREA);                              0547
*                                                                  0547
FPLPROC  STM   @14,@12,12(@13)                                     0547
         ST    @13,@SA00003+4                                      0547
         LA    @14,@SA00003                                        0547
         ST    @14,8(,@13)                                         0547
         LR    @13,@14                                             0547
*        GEN(ENTRY FPLPROC);           /*EXT ENTRY POINT     @ZA05939*/
         ENTRY FPLPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  0549
         LM    REG8,REG12,BASESAVE                                 0549
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0550
*        DCL FJJ  FIXED(15) UNSIGNED;  /*DO GROUP INDEX VARIABLE     */
*        DCL TEMPTR  PTR(31);          /*TEMP PTR FOR SAVEAREA FPL'S */
*        DCL SAFPL   CHAR(*) BASED;    /*OVERLAY OF AN FPL           */
*        DCL FPLNAME CHAR(8) BASED;    /*OVERLAY OF FPL DICT NAME  0553
*                                                            @ZA05939*/
*                                                                  0553
*        OLDERID2 = NEWERID2;                                      0554
         L     @04,@PC00001                                        0554
         L     @04,GDTTR2(,@04)                                    0554
         MVC   @TS00001(95),NEWERID2(@04)                          0554
         MVC   OLDERID2(95,@04),@TS00001                           0554
*        NEWID2 = 'LCFP';                                          0555
         MVC   NEWID2(4,@04),@CC01575                              0555
*        TEMPTR = SAVFPLPT;            /*POSITION TO 1ST SAVEAREA FPL*/
         L     TEMPTR,SAVFPLPT                                     0556
*        DO FJJ = 1 TO FPLCNT;                                     0557
*                                                                  0557
         LA    FJJ,1                                               0557
         B     @DE00557                                            0557
@DL00557 DS    0H                                                  0558
*          /**********************************************************/
*          /*                                                @Y30LSMK*/
*          /* IF A MULTITYP FPL WAS THE FIRST FPL, RESTORE   @Y30LSMK*/
*          /* IT WITH THE CORRECT LENGTH SINCE IT IS LONGER  @Y30LSMK*/
*          /* THAN NORMAL FPL'S.                             @Y30LSMK*/
*          /*                                                @Y30LSMK*/
*          /**********************************************************/
*                                                                  0558
*          IF CTGFIELD(FJJ)->CTGFLDNM->FPLNAME = MULTITNM          0558
*            THEN                                                  0558
         LR    @04,FJJ                                             0558
         SLA   @04,2                                               0558
         L     @15,CTGPLPTR                                        0558
         L     @04,CTGFIELD-4(@04,@15)                             0558
         L     @15,CTGFLDNM(,@04)                                  0558
         CLC   FPLNAME(8,@15),MULTITNM                             0558
         BNE   @RF00558                                            0558
*              DO;                                         /*@ZA05939*/
*                CTGFIELD(FJJ)->CTGFL(1:MTFPLLEN) =                0560
*                  TEMPTR->SAFPL(1:MTFPLLEN);              /*@Y30LSMK*/
         SLR   @15,@15                                             0560
         IC    @15,MTFPLLEN                                        0560
         LR    @14,@15                                             0560
         BCTR  @14,0                                               0560
         EX    @14,@SM01758                                        0560
*                TEMPTR = TEMPTR + MTFPLLEN;               /*@Y30LSMK*/
         ALR   TEMPTR,@15                                          0561
*              END;                                        /*@Y30LSMK*/
*            ELSE                                                  0563
*              DO;                                         /*@Y30LSMK*/
         B     @RC00558                                            0563
@RF00558 DS    0H                                                  0564
*                CTGFIELD(FJJ)->CTGFL(1:LCFPLLEN) =                0564
*                  TEMPTR->SAFPL(1:LCFPLLEN);              /*@Y30LSMK*/
         LR    @04,FJJ                                             0564
         SLA   @04,2                                               0564
         L     @15,CTGPLPTR                                        0564
         L     @04,CTGFIELD-4(@04,@15)                             0564
         SLR   @15,@15                                             0564
         IC    @15,LCFPLLEN                                        0564
         LR    @14,@15                                             0564
         BCTR  @14,0                                               0564
         EX    @14,@SM01758                                        0564
*                TEMPTR = TEMPTR + LCFPLLEN;               /*@Y30LSMK*/
         ALR   TEMPTR,@15                                          0565
*              END;                                        /*@Y30LSMK*/
*        END;                                              /*@Y30LSMK*/
*                                                                  0567
@RC00558 AL    FJJ,@CF00045                                        0567
@DE00557 CH    FJJ,FPLCNT                                          0567
         BNH   @DL00557                                            0567
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM FPL REINITIALIZATION ROUTINE, RETURNING TO     */
*        /* CALLER.                                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0568
*        END FPLPROC;                                              0568
@EL00003 L     @13,4(,@13)                                         0568
@EF00003 DS    0H                                                  0568
@ER00003 LM    @14,@12,12(@13)                                     0568
         BR    @14                                                 0568
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - ERRPROC                                 */
*        /*                                                          */
*        /* FUNCTION - ISSUES AMS TEXT PROCESSOR MACRO, UPRINT, AND  */
*        /* ZEROES OUT THE DYNAMIC DATA ARGUMENT LIST UPON EXITING.  */
*        /*                                                          */
*        /* INPUT - OUTPUT DATA SET POINTER, AND THE DYNAMIC DATA    */
*        /* PARM LIST FOR THE AMS TEXT PROCESSOR.                    */
*        /*                                                          */
*        /* OUTPUT - FORMATTED AND PRINTED MSGS AS DESCRIBED IN TEXT */
*        /* PROCESSOR'S PARM LIST.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0569
*ERRPROC:                                                          0569
*        PROCEDURE OPTIONS(SAVEAREA);                      /*@ZA05939*/
*                                                                  0569
ERRPROC  STM   @14,@12,12(@13)                                     0569
         ST    @13,@SA00004+4                                      0569
         LA    @14,@SA00004                                        0569
         ST    @14,8(,@13)                                         0569
         LR    @13,@14                                             0569
*        GEN(ENTRY ERRPROC);           /*EXT ENTRY POINT     @ZA05939*/
         ENTRY ERRPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  0571
         LM    REG8,REG12,BASESAVE                                 0571
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES - ARGUMENT LIST FOR THE AMS UDUMP MACRO  */
*        /* TO LIST THE AMS TEXT PROCESSOR ARGUMENT LIST PRIOR TO A  */
*        /* PRINT REQUEST.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0572
*        DECLARE                                                   0572
*          1 DUMPMARG,                                             0572
*            2 ITEMM,                                              0572
*              3 ITEMMNM   CHAR(8),                                0572
*              3 ITEMMPTR  PTR(31),                                0572
*              3 ITEMMLEN  FIXED(15) UNSIGNED,                     0572
*              3 ITEMMTYP  CHAR(1),                                0572
*              3 *         CHAR(1),                                0572
*            2 LISTMEND    CHAR(1);                                0572
*                                                                  0572
*        /************************************************************/
*        /*                                                          */
*        /* WHEN IN THE DEBUG MODE, DUMP THE AMS TEXT PROCESSOR      */
*        /* ARGUMENT LIST.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0573
*        IF GDTDBG ^= NULLPTR                                      0573
*          THEN                                                    0573
         SLR   @04,@04                                             0573
         L     @15,@PC00001                                        0573
         L     @15,GDTDBG(,@15)                                    0573
         CR    @15,@04                                             0573
         BE    @RF00573                                            0573
*            DO;                                                   0574
*              ITEMMNM = 'ERRDARG';                                0575
         MVI   ITEMMNM+7,C' '                                      0575
         MVC   ITEMMNM(7),@CC01588                                 0575
*              ITEMMPTR = ERRARGPT;                                0576
         L     @14,ERRARGPT                                        0576
         ST    @14,ITEMMPTR                                        0576
*              ITEMMTYP = 'H';                                     0577
         MVI   ITEMMTYP,C'H'                                       0577
*              ITEMMLEN = LENGTH(ERRDARG);                         0578
         MVC   ITEMMLEN(2),@CH00606                                0578
*              LISTMEND = 'FF'X;                                   0579
         MVI   LISTMEND,X'FF'                                      0579
*              IF GDTDBG = NULLPTR                                 0580
*                THEN;                                             0580
         CR    @15,@04                                             0580
         BE    @RT00580                                            0580
*                ELSE                                              0582
*                  CALL IDCDB010 (GDTTBL,'LCMG',ADDR(DUMPMARG));   0582
         L     @04,@PC00001                                        0582
         ST    @04,@AL00001                                        0582
         LA    @00,@CC01589                                        0582
         ST    @00,@AL00001+4                                      0582
         LA    @00,DUMPMARG                                        0582
         ST    @00,@AFTEMPS+4                                      0582
         LA    @00,@AFTEMPS+4                                      0582
         ST    @00,@AL00001+8                                      0582
         MVI   @AL00001+8,X'80'                                    0582
         L     @15,GDTDBG(,@04)                                    0582
         LA    @01,@AL00001                                        0582
         BALR  @14,@15                                             0582
*            END;                                                  0583
@RT00580 DS    0H                                                  0584
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE IF THE MESSAGE TO BE PRINTED REQUIRES A        */
*        /* CONDITION CODE TO COMPLETE THE MESSAGE TEXT.             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0584
*        OLDERID2 = NEWERID2;                                      0584
@RF00573 L     @04,@PC00001                                        0584
         L     @04,GDTTR2(,@04)                                    0584
         MVC   @TS00001(95),NEWERID2(@04)                          0584
         MVC   OLDERID2(95,@04),@TS00001                           0584
*        NEWID2 = 'LCER';                                          0585
         MVC   NEWID2(4,@04),@CC01590                              0585
*        IF ERRARGPT->DARGSMOD = UV0ID                             0586
*          THEN                                                    0586
         L     @04,ERRARGPT                                        0586
         CLC   DARGSMOD(3,@04),@CC01290                            0586
         BNE   @RF00586                                            0586
*            IF ERRARGPT->DARGSENT = UVMSG01                      0587
*              ERRARGPT->DARGSENT = UVMSG03                       0587
*              ERRARGPT->DARGSENT = UVMSG15                        0587
*              THEN                                                0587
         CLI   DARGSENT(@04),1                                     0587
         BE    @RT00587                                            0587
         CLI   DARGSENT(@04),3                                     0587
         BE    @RT00587                                            0587
         CLI   DARGSENT(@04),15                                    0587
         BNE   @RF00587                                            0587
@RT00587 DS    0H                                                  0588
*                DO;                                               0588
*                  ERRARGPT->DARGDBP = ADDR(SAVRC);        /*@ZA05939*/
         L     @04,ERRARGPT                                        0589
         LA    @00,SAVRC                                           0589
         ST    @00,DARGDBP(,@04)                                   0589
*                  ERRARGPT->DARGILP = LENGTH(SAVRC);      /*@ZA05939*/
         MVC   DARGILP(2,@04),@CH00161                             0590
*                END;                                              0591
*              ELSE                                                0592
*                IF ERRARGPT->DARGSENT = UVMSG07                   0592
*                  THEN                                            0592
*                                                                  0592
         B     @RC00587                                            0592
@RF00587 L     @04,ERRARGPT                                        0592
         CLI   DARGSENT(@04),7                                     0592
         BNE   @RF00592                                            0592
*                    /************************************************/
*                    /*                                      @Y30SSMK*/
*                    /* AN ERROR WAS ENCOUNTERED DURING A VSAM       */
*                    /* LOCATE, INITIALIZE THE ERROR CONVERSION      */
*                    /* TABLE AND INVOKE UERROR TO PRINT     @Y30SSMK*/
*                    /* THE APPROPRIATE ERROR MESSAGE.       @Y30SSMK*/
*                    /*                                      @Y30SSMK*/
*                    /************************************************/
*                                                                  0593
*                    DO;                                   /*@Y30SSMK*/
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Y30SSMK*/
         LA    @04,ERRORTAB                                        0594
         ST    @04,ERCNVADR                                        0594
*                      ERCNVTAB = ZEROAREA;                /*@Y30SSMK*/
         MVC   ERCNVTAB(32,@04),ZEROAREA                           0595
*                      ERCATLG = ON;                       /*@Y30SSMK*/
         OI    ERCATLG(@04),B'10000000'                            0596
*                      ERCATLC = ON;                       /*@Y30SSMK*/
         OI    ERCATLC(@04),B'10000000'                            0597
*                      ERCATRC = CATRC;                    /*@Y30SSMK*/
         LH    @15,CATRC                                           0598
         ST    @15,ERCATRC(,@04)                                   0598
*                      ERCPLPT = ERRCPLPT;                 /*@Y30SSMK*/
         L     @14,ERRCPLPT                                        0599
         ST    @14,ERCPLPT(,@04)                                   0599
*                      IF CATRC = CATRC8 & CILOCFLG = OFF          0600
*                        THEN                                      0600
         C     @15,@CF00187                                        0600
         BNE   @RF00600                                            0600
         TM    CILOCFLG,B'10000000'                                0600
         BNZ   @RF00600                                            0600
*                          ERDSNM = ADDR(OBJNM(NLST));     /*@Y30SSMK*/
*                                                                  0601
         LH    @15,NLST                                            0601
         MH    @15,@CH01258                                        0601
         L     @14,OBJNMPTR                                        0601
         AL    @14,@CF01760                                        0601
         LA    @00,OBJNM-5(@15,@14)                                0601
         ST    @00,ERDSNM(,@04)                                    0601
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Y30SSMK*/
*                                                                  0602
@RF00600 L     @04,@PC00001                                        0602
         ST    @04,@AL00001                                        0602
         LA    @02,ERCNVADR                                        0602
         ST    @02,@AL00001+4                                      0602
         MVI   @AL00001+4,X'80'                                    0602
         L     @15,GDTERR(,@04)                                    0602
         LA    @01,@AL00001                                        0602
         BALR  @14,@15                                             0602
*                      RESPECIFY RTNREG RSTD;                      0603
*                      TESTRC = RTNREG;                            0604
         LR    TESTRC,RTNREG                                       0604
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSMK*/
*                      SAVRC = MAX(SAVRC,TESTRC);          /*@ZA05939*/
         LH    @04,SAVRC                                           0606
         CR    @04,TESTRC                                          0606
         BNL   *+6
         LR    @04,TESTRC                                          0606
         STH   @04,SAVRC                                           0606
*                    END;                                  /*@Y30SSMK*/
*                                                                  0607
*        /************************************************************/
*        /*                                                          */
*        /* IF UERROR WAS NOT INVOKED TO PRINT THE ERROR MESSAGE,    */
*        /* ISSUE THE AMS UPRINT MACRO TO LIST THE MESSAGE SPECIFIED */
*        /* IN THE AMS TEXT PROCESSOR DARGLIST.                      */
*        /* UPDATE THE LISTC FINAL CONDITION CODE WITH THE RETURN    */
*        /* CODE FROM THE TEXT PROCESSOR.                            */
*        /* AND REINITIALIZE THE DARGLIST FOR THE NEXT MESSAGE.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0608
*        IF ERRARGPT->DARGSENT ^= UVMSG07                          0608
*          THEN                                                    0608
@RF00592 DS    0H                                                  0608
@RC00587 DS    0H                                                  0608
@RF00586 L     @04,ERRARGPT                                        0608
         CLI   DARGSENT(@04),7                                     0608
         BE    @RF00608                                            0608
*            DO;                                           /*@Y30SSMK*/
*              CALL AMSTP011 (GDTTBL,                              0610
*                      OTIOCSPT,                                   0610
*                      ERRARGPT);                                  0610
         L     @04,@PC00001                                        0610
         ST    @04,@AL00001                                        0610
         LA    @02,OTIOCSPT                                        0610
         ST    @02,@AL00001+4                                      0610
         LA    @02,ERRARGPT                                        0610
         ST    @02,@AL00001+8                                      0610
         MVI   @AL00001+8,X'80'                                    0610
         L     @15,GDTPRT(,@04)                                    0610
         LA    @01,@AL00001                                        0610
         BALR  @14,@15                                             0610
*              RESPECIFY RTNREG RSTD;                              0611
*              TESTRC = RTNREG;                                    0612
         LR    TESTRC,RTNREG                                       0612
*              RESPECIFY RTNREG UNRSTD;                            0613
*              SAVRC = MAX (SAVRC, TESTRC);                /*@ZA05939*/
         LH    @04,SAVRC                                           0614
         CR    @04,TESTRC                                          0614
         BNL   *+6
         LR    @04,TESTRC                                          0614
         STH   @04,SAVRC                                           0614
*            END;                                                  0615
*        ERRDARG = ZEROAREA;                                       0616
*                                                                  0616
@RF00608 L     @04,ERRARGPT                                        0616
         MVC   ERRDARG(44,@04),ZEROAREA                            0616
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM THE ERROR PRINT ROUTINE, RETURNING TO CALLER.  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0617
*        RETURN CODE (0);                                          0617
         SLR   @15,@15                                             0617
         L     @13,4(,@13)                                         0617
         L     @14,12(,@13)                                        0617
         LM    @00,@12,20(@13)                                     0617
         BR    @14                                                 0617
*        END ERRPROC;                                              0618
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - LISTPROC                                */
*        /*                                                          */
*        /* FUNCTION - ISSUES AMS TEXT PROCESSOR MACRO, UPRINT, AND  */
*        /* ZEROES OUT THE DYNAMIC DATA ARGUMENT LIST UPON EXITING.  */
*        /*                                                          */
*        /* INPUT - OUTPUT DATA SET POINTER, AND THE DYNAMIC DATA    */
*        /* PARM LIST FOR THE AMS TEXT PROCESSOR.                    */
*        /*                                                          */
*        /* OUTPUT - FORMATTED AND PRINTED DATA AS DESCRIBED IN TEXT */
*        /* PROCESSOR'S PARM LIST.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0619
*LISTPROC: PROCEDURE OPTIONS(SAVEAREA);                    /*@ZA05939*/
*                                                                  0619
LISTPROC STM   @14,@12,12(@13)                                     0619
         ST    @13,@SA00005+4                                      0619
         LA    @14,@SA00005                                        0619
         ST    @14,8(,@13)                                         0619
         LR    @13,@14                                             0619
*        GEN(ENTRY LISTPROC);          /*EXT ENTRY POINT     @ZA05939*/
         ENTRY LISTPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  0621
         LM    REG8,REG12,BASESAVE                                 0621
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES - ARGUMENT LIST FOR THE AMS UDUMP MACRO  */
*        /* TO LIST THE AMS TEXT PROCESSOR ARGUMENT LIST PRIOR TO A  */
*        /* PRINT REQUEST.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0622
*        DECLARE                                                   0622
*          1 DUMPDARG,                                             0622
*            2 ITEM5,                                              0622
*              3 ITEM5NM   CHAR(8),                                0622
*              3 ITEM5PTR  PTR(31),                                0622
*              3 ITEM5LEN  FIXED(15) UNSIGNED,                     0622
*              3 ITEM5TYP  CHAR(1),                                0622
*              3 *         CHAR(1),                                0622
*            2 LIST5END    CHAR(1);                                0622
*                                                                  0622
*        /************************************************************/
*        /*                                                          */
*        /* WHEN IN THE DEBUG MODE, DUMP THE AMS TEXT PROCESSOR      */
*        /* ARGUMENT LIST.                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0623
*        IF GDTDBG ^= NULLPTR                                      0623
*          THEN                                                    0623
         SLR   @04,@04                                             0623
         L     @15,@PC00001                                        0623
         L     @15,GDTDBG(,@15)                                    0623
         CR    @15,@04                                             0623
         BE    @RF00623                                            0623
*            DO;                                                   0624
*              ITEM5NM = 'DARGLIST';                               0625
         MVC   ITEM5NM(8),@CC01602                                 0625
*              ITEM5PTR = DARGPTR;                         /*@ZA05939*/
         L     @14,DARGPTR                                         0626
         ST    @14,ITEM5PTR                                        0626
*              ITEM5TYP = 'H';                                     0627
         MVI   ITEM5TYP,C'H'                                       0627
*              ITEM5LEN = LENGTH(DARGLIST) +                       0628
*                (DARGCNT * LENGTH(DARGARY));                      0628
         LH    @14,DARGCNT(,@14)                                   0628
         SLA   @14,3                                               0628
         LA    @14,20(,@14)                                        0628
         STH   @14,ITEM5LEN                                        0628
*              LIST5END = 'FF'X;                                   0629
         MVI   LIST5END,X'FF'                                      0629
*              IF GDTDBG = NULLPTR                                 0630
*                THEN;                                             0630
         CR    @15,@04                                             0630
         BE    @RT00630                                            0630
*                ELSE                                              0632
*                  CALL IDCDB010 (GDTTBL,'LCTP',ADDR(DUMPDARG));   0632
         L     @04,@PC00001                                        0632
         ST    @04,@AL00001                                        0632
         LA    @00,@CC01603                                        0632
         ST    @00,@AL00001+4                                      0632
         LA    @00,DUMPDARG                                        0632
         ST    @00,@AFTEMPS+8                                      0632
         LA    @00,@AFTEMPS+8                                      0632
         ST    @00,@AL00001+8                                      0632
         MVI   @AL00001+8,X'80'                                    0632
         L     @15,GDTDBG(,@04)                                    0632
         LA    @01,@AL00001                                        0632
         BALR  @14,@15                                             0632
*            END;                                                  0633
@RT00630 DS    0H                                                  0634
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE THE AMS UPRINT MACRO TO LIST THE DATA SPECIFIED IN */
*        /* THE AMS TEXT PROCESSOR DARGLIST.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0634
*        OLDERID2 = NEWERID2;                                      0634
@RF00623 L     @04,@PC00001                                        0634
         L     @02,GDTTR2(,@04)                                    0634
         MVC   @TS00001(95),NEWERID2(@02)                          0634
         MVC   OLDERID2(95,@02),@TS00001                           0634
*        NEWID2 = 'LCLT';                                          0635
*                                                                  0635
         MVC   NEWID2(4,@02),@CC01604                              0635
*        CALL AMSTP011 (GDTTBL,                                    0636
*                OTIOCSPT,                                         0636
*                DARGPTR);                                 /*@ZA05939*/
         ST    @04,@AL00001                                        0636
         LA    @02,OTIOCSPT                                        0636
         ST    @02,@AL00001+4                                      0636
         LA    @02,DARGPTR                                         0636
         ST    @02,@AL00001+8                                      0636
         MVI   @AL00001+8,X'80'                                    0636
         L     @15,GDTPRT(,@04)                                    0636
         LA    @01,@AL00001                                        0636
         BALR  @14,@15                                             0636
*        RESPECIFY RTNREG RSTD;                                    0637
*        TESTRC = RTNREG;                                          0638
         LR    TESTRC,RTNREG                                       0638
*        RESPECIFY RTNREG UNRSTD;                                  0639
*        SAVRC = MAX (SAVRC, TESTRC);                      /*@ZA05939*/
*                                                                  0640
         LH    @04,SAVRC                                           0640
         CR    @04,TESTRC                                          0640
         BNL   *+6
         LR    @04,TESTRC                                          0640
         STH   @04,SAVRC                                           0640
*        /************************************************************/
*        /*                                                          */
*        /* FOR REUSE, INITIALIZE THE DARGLIST TO ZERO AND SET THE   */
*        /* LISTC STATIC TEXT ID.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0641
*        DARGLIST = ZEROAREA;                                      0641
         L     @04,DARGPTR                                         0641
         MVC   DARGLIST(20,@04),ZEROAREA                           0641
*        DARGSMOD = LC0ID;                                         0642
*                                                                  0642
         MVC   DARGSMOD(3,@04),@CC01198                            0642
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM THE PRINT ROUTINE, RETURNING TO CALLER.        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0643
*        RETURN CODE(0);                                           0643
         SLR   @15,@15                                             0643
         L     @13,4(,@13)                                         0643
         L     @14,12(,@13)                                        0643
         LM    @00,@12,20(@13)                                     0643
         BR    @14                                                 0643
*        END LISTPROC;                                             0644
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - AUPROC                                       */
*        /*                                                          */
*        /* FUNCTION - REPETITIVELY BUILDS THE AMS TEXT PROCESSOR    */
*        /* DYNAMIC DATA ARGUMENT LIST FOR FORMATTING AND LISTING    */
*        /* THE VSAM CATALOG FIELDS FOR A NONVSAM, USERCATALOG,      */
*        /* ALIAS, OR GDG ENTRY.                             @Y30SSMK*/
*        /* LISTPROC IS REPEATEDLY INVOKED TO PRINT THE DATA.        */
*        /*                                                          */
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM CATALOG DATA    */
*        /* RETRIEVED VIA A LOCATE REQUEST.  THE VSAM CPL AND FPL'S  */
*        /* AND THE AMS GDT AND FROM STATIC TEXT THE PRE-FORMATTED   */
*        /* DESCRIPTORS FOR EDITING THE CATALOG DATA.                */
*        /*                                                          */
*        /* OUTPUT - PRINTED VSAM CATALOG DATA FOR EITHER AN NONVSAM,*/
*        /* USERCATALOG, ALIAS, OR GDG ENTRY.                @Y30SSMK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0645
*AUPROC: PROCEDURE OPTIONS(SAVEAREA);                      /*@ZA05939*/
*                                                                  0645
AUPROC   STM   @14,@12,12(@13)                                     0645
         ST    @13,@SA00006+4                                      0645
         LA    @14,@SA00006                                        0645
         ST    @14,8(,@13)                                         0645
         LR    @13,@14                                             0645
*        GEN(ENTRY AUPROC);            /*EXT ENTRY POINT     @ZA05939*/
         ENTRY AUPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  0647
         LM    REG8,REG12,BASESAVE                                 0647
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* LOCAL VARIABLES                                  @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0648
*        DCL CITYPLEN  FIXED(15) CONSTANT(4);              /*@Y30SSMK*/
*                                      /*LEN OF ONE CI & TYPE FIELD  */
*                                                                  0649
*        /************************************************************/
*        /*                                                          */
*        /* SETUP THE AMS DARGLIST TO LIST EITHER A NONVSAM, @Y30SSMK*/
*        /* USERCATALOG, ALIAS, OR GDG HEADER CONTAINING THE 44-BYTE */
*        /* ENTRY NAME. UPDATE THE APPROPRIATE ENTRY TYPE COUNTER.   */
*        /*  IF THE PROPER PASSWORD WAS NOT PROVIDED AND ONLY        */
*        /*  THE NAME SUBSET IS REQUESTED, PICK UP THE ENTRY NAME    */
*        /*  FROM THE SPECIALLY FORMATTED WORKAREA.                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0649
*        OLDERID2 = NEWERID2;                                      0649
         L     @04,@PC00001                                        0649
         L     @15,GDTTR2(,@04)                                    0649
         MVC   @TS00001(95),NEWERID2(@15)                          0649
         MVC   OLDERID2(95,@15),@TS00001                           0649
*        NEWID2 = 'LCAU';                                          0650
*                                                                  0650
*                                                                  0650
         MVC   NEWID2(4,@15),@CC01610                              0650
*        IF GDTDBG = NULLPTR                                       0651
*          THEN;                                                   0651
         L     @04,GDTDBG(,@04)                                    0651
         LTR   @04,@04                                             0651
         BZ    @RT00651                                            0651
*          ELSE                                                    0653
*            CALL IDCDB010(GDTTBL,'LCAP',DPLISTPT);                0653
         L     @04,@PC00001                                        0653
         ST    @04,@AL00001                                        0653
         LA    @00,@CC01611                                        0653
         ST    @00,@AL00001+4                                      0653
         LA    @00,DPLISTPT                                        0653
         ST    @00,@AL00001+8                                      0653
         MVI   @AL00001+8,X'80'                                    0653
         L     @15,GDTDBG(,@04)                                    0653
         LA    @01,@AL00001                                        0653
         BALR  @14,@15                                             0653
*                                                          /*@ZA05939*/
*                                                                  0654
*        ALIASCI# = 0;                                     /*@YL026UE*/
@RT00651 SLR   @04,@04                                             0654
         STCM  @04,7,ALIASCI#                                      0654
*        G0V0FLG = OFF;                                    /*@YL026UE*/
*                                                                  0655
*                                                                  0655
         NI    G0V0FLG,B'01111111'                                 0655
*        IF HOLDETYP = CTGTALIN                                    0656
*          THEN                                                    0656
         CLI   HOLDETYP,C'A'                                       0656
         BNE   @RF00656                                            0656
*            DO;                                           /*@YL026UE*/
*            ATYPCNT = ATYPCNT+1;      /*UPDATE NVSAM CTR    @YL026UE*/
         LA    @04,1                                               0658
         AL    @04,ATYPCNT                                         0658
         ST    @04,ATYPCNT                                         0658
*            IF NDENTFLG = ON                                      0659
*              THEN                                                0659
         TM    NDENTFLG,B'10000000'                                0659
         BNO   @RF00659                                            0659
*                DARGSENT = LCST44;    /*INDENTED NVSAM ENTY HEADER
*                                                            @YL026UE*/
         L     @04,DARGPTR                                         0660
         MVI   DARGSENT(@04),X'2C'                                 0660
*              ELSE                                                0661
*                DARGSENT = LCST03;    /*NON-INDENTED NVSAM HEADER 0661
*                                                            @YL026UE*/
         B     @RC00659                                            0661
@RF00659 L     @04,DARGPTR                                         0661
         MVI   DARGSENT(@04),X'03'                                 0661
*            END;                                          /*@YL026UE*/
*          ELSE                                                    0663
*            IF HOLDETYP = CTGTUCAT                                0663
*              THEN                                                0663
         B     @RC00656                                            0663
@RF00656 CLI   HOLDETYP,C'U'                                       0663
         BNE   @RF00663                                            0663
*                DO;                                       /*@YL026UE*/
*                UTYPCNT = UTYPCNT+1;  /*UPDATE UCAT COUNTER @YL026UE*/
         LA    @04,1                                               0665
         AL    @04,UTYPCNT                                         0665
         ST    @04,UTYPCNT                                         0665
*                DARGSENT = LCST04;    /*USERCAT ENTY HEADER @YL026UE*/
         L     @04,DARGPTR                                         0666
         MVI   DARGSENT(@04),X'04'                                 0666
*                END;                                      /*@YL026UE*/
*              ELSE                                                0668
*                  IF HOLDETYP = CTGTANM                           0668
*                    THEN                                          0668
         B     @RC00663                                            0668
@RF00663 CLI   HOLDETYP,C'X'                                       0668
         BNE   @RF00668                                            0668
*                      DO;                                 /*@YL026UE*/
*                      XTYPCNT=XTYPCNT+1; /*UPDT ALIAS CTR   @YL026UE*/
         LA    @04,1                                               0670
         AL    @04,XTYPCNT                                         0670
         ST    @04,XTYPCNT                                         0670
*                      DARGSENT=LCST43; /*ALIAS ENTRY HDR    @YL026UE*/
         L     @04,DARGPTR                                         0671
         MVI   DARGSENT(@04),X'2B'                                 0671
*                      END;                                /*@YL026UE*/
*                    ELSE                                          0673
*                      DO;                                 /*@YL026UE*/
         B     @RC00668                                            0673
@RF00668 DS    0H                                                  0674
*                      BTYPCNT=BTYPCNT+1; /*GDG BASE CTR     @YL026UE*/
         LA    @04,1                                               0674
         AL    @04,BTYPCNT                                         0674
         ST    @04,BTYPCNT                                         0674
*                      DARGSENT=LCST42; /*GDG BASE ENTRY HDR @YL026UE*/
         L     @04,DARGPTR                                         0675
         MVI   DARGSENT(@04),X'2A'                                 0675
*                      END;                                /*@YL026UE*/
*        IF CATRC = CRCBADPW & ADDR(NAME) > NULLPTR                0677
*          THEN                                                    0677
@RC00668 DS    0H                                                  0677
@RC00663 DS    0H                                                  0677
@RC00656 CLC   CATRC(2),@CH01280                                   0677
         BNE   @RF00677                                            0677
         L     @04,@PC00001+4                                      0677
         L     @04,FDTPTR+52(,@04)                                 0677
         LTR   @04,@04                                             0677
         BNP   @RF00677                                            0677
*            DO;                                                   0678
*            DARGDBP = ADDR(SUPPDSNM);                             0679
         L     @04,DARGPTR                                         0679
         L     @15,CTGPLPTR                                        0679
         L     @15,CTGWKA(,@15)                                    0679
         LA    @00,SUPPDSNM(,@15)                                  0679
         ST    @00,DARGDBP(,@04)                                   0679
*            DARGILP = LENGTH(SUPPDSNM);                           0680
         MVC   DARGILP(2,@04),@CH00606                             0680
*            END;                                                  0681
*          ELSE                                                    0682
*            DO;                                                   0682
         B     @RC00677                                            0682
@RF00677 DS    0H                                                  0683
*            DARGDBP = ENT44FPT->CTGFLPT(1);                       0683
         L     @04,DARGPTR                                         0683
         L     @15,ENT44FPT                                        0683
         L     @14,CTGFLPT(,@15)                                   0683
         ST    @14,DARGDBP(,@04)                                   0683
*            DARGILP = ENT44FPT->CTGFLNG(1);                       0684
         L     @00,CTGFLNG(,@15)                                   0684
         STH   @00,DARGILP(,@04)                                   0684
*            END;                                                  0685
*        CALL LISTPROC;                                            0686
*                                                                  0686
@RC00677 BAL   @14,LISTPROC                                        0686
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* IF THE CATNAME SUBTITLE IS NOT USED, IDENTIFY THE        */
*        /* CATALOG FOR EACH ENTRY VIA A CATNAME HEADER.     @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0687
*        IF NOTTLFLG = ON                                          0687
*          THEN                                                    0687
         TM    NOTTLFLG,B'10000000'                                0687
         BNO   @RF00687                                            0687
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST40;                            /*@YL026UE*/
         L     @04,DARGPTR                                         0689
         MVI   DARGSENT(@04),X'28'                                 0689
*            DARGDBP = ADDR(CATNAME);                      /*@YL026UE*/
         LA    @00,CATNAME                                         0690
         ST    @00,DARGDBP(,@04)                                   0690
*            DARGILP = LENGTH(CATNAME);                    /*@YL026UE*/
         MVC   DARGILP(2,@04),@CH00606                             0691
*            CALL LISTPROC;                                /*@YL026UE*/
         BAL   @14,LISTPROC                                        0692
*            END;                                          /*@YL026UE*/
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM NVSAM/USERCAT ROUTINE SINCE NAME ONLY SUBSET   */
*        /* LISTING WAS REQUESTED.  RETURN TO ROUTING ROUTINE.       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0694
*        IF ADDR(NAME) > NULLPTR                                   0694
*          THEN                                                    0694
@RF00687 SLR   @04,@04                                             0694
         L     @15,@PC00001+4                                      0694
         C     @04,FDTPTR+52(,@15)                                 0694
         BNL   @RF00694                                            0694
*            RETURN CODE (0);                                      0695
*                                                                  0695
         LR    @15,@04                                             0695
         L     @13,4(,@13)                                         0695
         L     @14,12(,@13)                                        0695
         LM    @00,@12,20(@13)                                     0695
         BR    @14                                                 0695
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* EXIT FROM NVSAM/UCAT ROUTINE IF A GDG BASE SPECIFIED     */
*        /* BY THE USER IS RESTRICTED BY THE USER'S TYPE     @YL026UE*/
*        /* SPECIFICATION.                                   @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0696
*        IF HOLDETYP = CTGTGBS & ENLVUDFG = ON                     0696
*           & TYPECNT > 0 & BTYPFLG = OFF                          0696
*          THEN                                                    0696
@RF00694 CLI   HOLDETYP,C'B'                                       0696
         BNE   @RF00696                                            0696
         TM    ENLVUDFG,B'10000000'                                0696
         BNO   @RF00696                                            0696
         SLR   @04,@04                                             0696
         CH    @04,TYPECNT                                         0696
         BNL   @RF00696                                            0696
         TM    BTYPFLG,B'10000000'                                 0696
         BNZ   @RF00696                                            0696
*            RETURN CODE(0);                               /*@YL026UE*/
         LR    @15,@04                                             0697
         L     @13,4(,@13)                                         0697
         L     @14,12(,@13)                                        0697
         LM    @00,@12,20(@13)                                     0697
         BR    @14                                                 0697
*        /************************************************************/
*        /*                                                          */
*        /* USER ERROR, IF ALLOCATION INFORMATION REQUESTED FOR A    */
*        /* LIST OF ENTRIES THAT CONTAINED A NONVSAM OR USERCAT      */
*        /* OR ALIAS OR GDG BASE ENTRY, OR IF VOL INFO REQUESTED     */
*        /* FOR AN ALIAS ENTRY.                              @YL026UE*/
*        /* SETUP THE ALLOC/VOL CONFLICT MESSAGE AND RETURN  @YL026UE*/
*        /* TO THE ROUTING PROCEDURE.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0698
*        IF ADDR(ALLOC) > NULLPTR  (ADDR(VOL) > NULLPTR           0698
*            & HOLDETYP = CTGTANM)                                 0698
*          THEN                                                    0698
@RF00696 SLR   @04,@04                                             0698
         L     @15,@PC00001+4                                      0698
         C     @04,FDTPTR+64(,@15)                                 0698
         BL    @RT00698                                            0698
         C     @04,FDTPTR+60(,@15)                                 0698
         BNL   @RF00698                                            0698
         CLI   HOLDETYP,C'X'                                       0698
         BNE   @RF00698                                            0698
@RT00698 DS    0H                                                  0699
*            DO;                                                   0699
*              SAVRC = MAX (SAVRC, LASTCC08);              /*@ZA05939*/
         LH    @04,SAVRC                                           0700
         LA    @00,8                                               0700
         CR    @04,@00                                             0700
         BNL   *+6
         LR    @04,@00                                             0700
         STH   @04,SAVRC                                           0700
*              ERRARGPT->DARGSMOD = LC1ID;                         0701
         L     @15,ERRARGPT                                        0701
         MVC   DARGSMOD(3,@15),@CC01297                            0701
*              ERRARGPT->DARGSENT = LCMSG04;                       0702
         MVI   DARGSENT(@15),X'04'                                 0702
*              RETURN CODE (SAVRC);                        /*@ZA05939*/
         LR    @15,@04                                             0703
         L     @13,4(,@13)                                         0703
         L     @14,12(,@13)                                        0703
         LM    @00,@12,20(@13)                                     0703
         BR    @14                                                 0703
*            END;                                                  0704
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* FOR A NONVSAM OR GDG ENTRY, PROCEED TO BUILD THE @Y30LSMK*/
*        /* DARGLIST TO PRINT OUT THE OWNER, DATE, RELEASE   @Y30SSMK*/
*        /* AND CATALOG RECOVERY FIELDS.                     @Y30SSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  0705
*        IF ADDR(NAME) = NULLPTR  &  (HOLDETYP = CTGTALIN         0705
*          HOLDETYP = CTGTGBS)                                     0705
*          THEN                                                    0705
*                                                                  0705
@RF00698 L     @04,@PC00001+4                                      0705
         L     @04,FDTPTR+52(,@04)                                 0705
         LTR   @04,@04                                             0705
         BNZ   @RF00705                                            0705
         CLI   HOLDETYP,C'A'                                       0705
         BE    @RT00705                                            0705
         CLI   HOLDETYP,C'B'                                       0705
         BNE   @RF00705                                            0705
@RT00705 DS    0H                                                  0706
*            /********************************************************/
*            /*                                              @Y30LSMK*/
*            /* BUILD THE TEXT PROCESSOR DARGLIST FOR PRINTING THE   */
*            /* OWNER AND DATE FIELDS.                       @Y30LSMK*/
*            /* NOTE - ANY FIELDS RETURNED FROM THE CATALOG PADDED   */
*            /* WITH HEX FF'S REQUIRE SPECIAL HANDLING TO SETUP A    */
*            /* PRINTABLE FORMAT.  HENCE ARITHMETIC FIELDS ARE       */
*            /* OVERLAYED WITH ZEROES AND CHARACTER FIELDS ARE       */
*            /* OVERRIDDEN WITH THE 'NULL' STATIC TEXT ENTRY.        */
*            /*                                              @Y30LSMK*/
*            /********************************************************/
*                                                                  0706
*            DO;                                           /*@Y30LSMK*/
*              DARGSENT = LCST13;      /* OWNER AND DATE HEADER      */
         L     @04,DARGPTR                                         0707
         MVI   DARGSENT(@04),X'0D'                                 0707
*              DARGCNT = DRGCNT7;                          /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00498                             0708
*              CTGFLPTR = DSIDFPT;                         /*@Y30LSMK*/
         L     @04,DSIDFPT                                         0709
         ST    @04,CTGFLPTR                                        0709
*              IF DSID = HEXFF                                     0710
*                THEN                                              0710
         L     @04,CTGFLPT(,@04)                                   0710
         CLC   DSID(8,@04),HEXFF                                   0710
         BNE   @RF00710                                            0710
*                  DSID = NULLNM;                          /*@Y30LSMK*/
         L     @15,TEXTPTR                                         0711
         MVC   DSID(8,@04),NULLNM(@15)                             0711
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/
@RF00710 L     @04,DARGPTR                                         0712
         MVC   DARGINS(2,@04),@CH00457                             0712
*              DARGINL(1) = CTGFLNG(1);                    /*@Y30LSMK*/
         L     @15,CTGFLPTR                                        0713
         L     @14,CTGFLNG(,@15)                                   0713
         STH   @14,DARGINL(,@04)                                   0713
*              DARGDTM(1) = CTGFLPT(1);                    /*@Y30LSMK*/
*                                                                  0714
         L     @00,CTGFLPT(,@15)                                   0714
         ST    @00,DARGDTM(,@04)                                   0714
*              CTGFLPTR = CRDTFPT;                         /*@Y30LSMK*/
         L     @04,CRDTFPT                                         0715
         ST    @04,CTGFLPTR                                        0715
*              IF CRDT = ARITH4FF                                  0716
*                THEN                                              0716
         L     @04,CTGFLPT(,@04)                                   0716
         CLC   CRDT(3,@04),ARITH4FF                                0716
         BNE   @RF00716                                            0716
*                  CRDT = ZEROAREA;                        /*@Y30LSMK*/
         MVC   CRDT(3,@04),ZEROAREA                                0717
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/
@RF00716 L     @04,DARGPTR                                         0718
         MVC   DARGINS+8(2,@04),@CH00649                           0718
*              DARGINL(2) = CTGFLNG(1);                    /*@Y30LSMK*/
         L     @15,CTGFLPTR                                        0719
         L     @14,CTGFLNG(,@15)                                   0719
         STH   @14,DARGINL+8(,@04)                                 0719
*              DARGDTM(2) = CTGFLPT(1);                    /*@Y30LSMK*/
*                                                                  0720
         L     @00,CTGFLPT(,@15)                                   0720
         ST    @00,DARGDTM+8(,@04)                                 0720
*              CTGFLPTR = EXDTFPT;                         /*@Y30LSMK*/
         L     @04,EXDTFPT                                         0721
         ST    @04,CTGFLPTR                                        0721
*              IF EXDT = ARITH4FF                                  0722
*                THEN                                              0722
         L     @04,CTGFLPT(,@04)                                   0722
         CLC   EXDT(3,@04),ARITH4FF                                0722
         BNE   @RF00722                                            0722
*                  EXDT = ZEROAREA;                        /*@Y30LSMK*/
         MVC   EXDT(3,@04),ZEROAREA                                0723
*              DARGINS(3) = DRGINS30;                      /*@Y30SSMK*/
@RF00722 L     @04,DARGPTR                                         0724
         MVC   DARGINS+16(2,@04),@CH01231                          0724
*              DARGINL(3) = CTGFLNG(1);                    /*@Y30LSMK*/
         L     @15,CTGFLPTR                                        0725
         L     @14,CTGFLNG(,@15)                                   0725
         STH   @14,DARGINL+16(,@04)                                0725
*              DARGDTM(3) = CTGFLPT(1);                    /*@Y30LSMK*/
*                                                                  0726
         L     @00,CTGFLPT(,@15)                                   0726
         ST    @00,DARGDTM+16(,@04)                                0726
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/
         L     @00,RELFPT                                          0727
         ST    @00,CTGFLPTR                                        0727
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/
         LR    @15,@00                                             0728
         L     @15,CTGFLPT(,@15)                                   0728
         ST    @15,DARGDBP(,@04)                                   0728
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/
         LR    @14,@00                                             0729
         L     @14,CTGFLNG(,@14)                                   0729
         STH   @14,DARGILP(,@04)                                   0729
*              DSREL = DSREL + 1;      /*CALUCATE REL NO.    @Y30SSMK*/
         LA    @14,1                                               0730
         SLR   @00,@00                                             0730
         IC    @00,DSREL(,@15)                                     0730
         ALR   @14,@00                                             0730
         STC   @14,DSREL(,@15)                                     0730
*              IF DSSER = ZEROAREA                                 0731
*                THEN                                              0731
         CLC   DSSER(6,@15),ZEROAREA                               0731
         BNE   @RF00731                                            0731
*                  DARGSENT = LCST13;  /*EXCLUDE CRA INFO    @Y30SSMK*/
         MVI   DARGSENT(@04),X'0D'                                 0732
*                ELSE                                              0733
*                  DARGSENT = LCST50;  /*INCLUDE CRA INFO    @Y30SSMK*/
         B     @RC00731                                            0733
@RF00731 L     @04,DARGPTR                                         0733
         MVI   DARGSENT(@04),X'32'                                 0733
*              CALL LISTPROC;                              /*@Y30LSMK*/
@RC00731 BAL   @14,LISTPROC                                        0734
*            END;                                          /*@Y30LSMK*/
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* FOR A USERCATALOG OR ALIAS ENTRY PROCEED TO      @Y30SSMK*/
*        /* BUILD THE TEXT PROCESSOR DARGLIST FOR PRINTING   @Y30SSMK*/
*        /* THE RELEASE AND CATALOG RECOVERY FIELDS.         @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0736
*        IF ADDR(NAME) = NULLPTR  &  (HOLDETYP = CTGTUCAT         0736
*          HOLDETYP = CTGTANM)                                     0736
*          THEN                                                    0736
@RF00705 L     @04,@PC00001+4                                      0736
         L     @04,FDTPTR+52(,@04)                                 0736
         LTR   @04,@04                                             0736
         BNZ   @RF00736                                            0736
         CLI   HOLDETYP,C'U'                                       0736
         BE    @RT00736                                            0736
         CLI   HOLDETYP,C'X'                                       0736
         BNE   @RF00736                                            0736
@RT00736 DS    0H                                                  0737
*            DO;                                           /*@Y30SSMK*/
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/
         L     @04,RELFPT                                          0738
         ST    @04,CTGFLPTR                                        0738
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/
         L     @15,DARGPTR                                         0739
         L     @14,CTGFLPT(,@04)                                   0739
         ST    @14,DARGDBP(,@15)                                   0739
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/
         L     @04,CTGFLNG(,@04)                                   0740
         STH   @04,DARGILP(,@15)                                   0740
*              DSREL = DSREL +1;       /* CALCULATE REL NO.  @Y30SSMK*/
         LA    @04,1                                               0741
         SLR   @00,@00                                             0741
         IC    @00,DSREL(,@14)                                     0741
         ALR   @04,@00                                             0741
         STC   @04,DSREL(,@14)                                     0741
*              IF DSSER = ZEROAREA                                 0742
*                THEN                                              0742
         CLC   DSSER(6,@14),ZEROAREA                               0742
         BNE   @RF00742                                            0742
*                  DARGSENT = LCST47;  /* EXCLUDE CRA INFO   @Y30SSMK*/
         MVI   DARGSENT(@15),X'2F'                                 0743
*                ELSE                                              0744
*                  DARGSENT = LCST56;  /* INCLUDE CRA INFO   @Y30SSMK*/
         B     @RC00742                                            0744
@RF00742 L     @04,DARGPTR                                         0744
         MVI   DARGSENT(@04),X'38'                                 0744
*              CALL LISTPROC;                              /*@Y30SSMK*/
@RC00742 BAL   @14,LISTPROC                                        0745
*            END;                                          /*@Y30SSMK*/
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* EXIT HERE IF THE HISTORY SUBSET WAS REQUESTED.   @Y30LSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  0747
*        IF ADDR(HIST) > NULLPTR                                   0747
*          THEN                                                    0747
@RF00736 SLR   @04,@04                                             0747
         L     @15,@PC00001+4                                      0747
         C     @04,FDTPTR+104(,@15)                                0747
         BNL   @RF00747                                            0747
*            RETURN CODE(0);                               /*@Y30LSMK*/
         LR    @15,@04                                             0748
         L     @13,4(,@13)                                         0748
         L     @14,12(,@13)                                        0748
         LM    @00,@12,20(@13)                                     0748
         BR    @14                                                 0748
*        /************************************************************/
*        /*                                                          */
*        /* LIST THE VOLUME HEADER USING THE PRE-FORMATTED   @ZA05939*/
*        /* STATIC TEXT DESCRIPTOR.                          @ZA05939*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0749
*        IF HOLDETYP = CTGTALIN  HOLDETYP = CTGTUCAT              0749
*          THEN                                                    0749
@RF00747 CLI   HOLDETYP,C'A'                                       0749
         BE    @RT00749                                            0749
         CLI   HOLDETYP,C'U'                                       0749
         BNE   @RF00749                                            0749
@RT00749 DS    0H                                                  0750
*AUOUTPUT:   DO;                                           /*@YL026UE*/
AUOUTPUT DS    0H                                                  0751
*            DARGSENT = LCST34;        /*VOL SERIAL HEADER   @ZA05939*/
*                                                                  0751
         L     @04,DARGPTR                                         0751
         MVI   DARGSENT(@04),X'22'                                 0751
*            CALL LISTPROC;                                /*@ZA05939*/
*                                                                  0752
         BAL   @14,LISTPROC                                        0752
*        /************************************************************/
*        /*                                                          */
*        /* POSITION THE FPL POINTER TO THE FPL REQUESTING THE       */
*        /* NONVSAM/USERCAT FIELDS AND LIST THE DATA IF RETURNED     */
*        /* IN THE WORKAREA.                                         */
*        /* ALSO INITIALIZE THE SERIAL NUMBER HOLD AREA TO HEX FF'S  */
*        /* SINCE THIS VALUE DETERMINES WHETHER REPETITIVE FIELDS    */
*        /* ARE LISTED.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0753
*        CTGFLPTR = AUVOLFPT;                                      0753
         L     @04,AUVOLFPT                                        0753
         ST    @04,CTGFLPTR                                        0753
*        OLDVOL# = HEXFF;                                          0754
         MVC   OLDVOL#(6),HEXFF                                    0754
*        IF CTGFLPT(1) > 0                                         0755
*          THEN                                                    0755
*                                                                  0755
         L     @04,CTGFLPT(,@04)                                   0755
         LTR   @04,@04                                             0755
         BNP   @RF00755                                            0755
*            /********************************************************/
*            /*                                                      */
*            /* LIST THE CATALOG DATA, LOOPING THROUGH THE REPETITIVE*/
*            /* FIELDS.  ONE PASS IS DETERMINED BY THE TOTAL LENGTH  */
*            /* OF THE INDIVIDUAL FIXED-LENGTH FIELDS RETRIEVED BY   */
*            /* THIS FPL REQUEST.                                    */
*            /*                                                      */
*            /********************************************************/
*                                                                  0756
*AULIST:     DO WHILE CTGFLNG(1) >= LENGTH(AUDATA);                0756
*                                                                  0756
AULIST   B     @DE00756                                            0756
@DL00756 DS    0H                                                  0757
*              /******************************************************/
*              /*                                                    */
*              /* DETERMINE IF ONLY VOLUME SUBSET INFORMATION        */
*              /* REQUESTED.  AND LIST EACH UNIQUE VOLUME SERIAL NO. */
*              /* AND ITS CORRESPONDING DEVICE TYPE.                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0757
*              IF ADDR(VOL) > NULLPTR                              0757
*                THEN                                              0757
         L     @04,@PC00001+4                                      0757
         L     @04,FDTPTR+60(,@04)                                 0757
         LTR   @04,@04                                             0757
         BNP   @RF00757                                            0757
*AUVOLFLD:         DO;                                             0758
AUVOLFLD DS    0H                                                  0759
*                    IF AUSER ^= OLDVOL#                           0759
*                      THEN                                        0759
         L     @04,CTGFLPTR                                        0759
         L     @04,CTGFLPT(,@04)                                   0759
         CLC   AUSER(6,@04),OLDVOL#                                0759
         BE    @RF00759                                            0759
*                        DO;                                       0760
*                          OLDVOL# = AUSER;                        0761
         MVC   OLDVOL#(6),AUSER(@04)                               0761
*                          DARGSENT = LCST12; /*VOL SUBSET DATA      */
         L     @15,DARGPTR                                         0762
         MVI   DARGSENT(@15),X'0C'                                 0762
*                          DARGCNT = DRGCNT2;              /*@Y30SSMK*/
         MVC   DARGCNT(2,@15),@CH00161                             0763
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/
         MVC   DARGINS(2,@15),@CH00457                             0764
*                          DARGINL(1) = LENGTH(AUSER);             0765
         MVC   DARGINL(2,@15),@CH00164                             0765
*                          DARGDTM(1) = ADDR(AUSER);               0766
         LA    @14,AUSER(,@04)                                     0766
         ST    @14,DARGDTM(,@15)                                   0766
*                          DARGINS(2) = DRGINS20;          /*@Y30SSMK*/
         MVC   DARGINS+8(2,@15),@CH00649                           0767
*                          DARGINL(2) = LENGTH(AUDEV);             0768
         MVC   DARGINL+8(2,@15),@CH00050                           0768
*                          DARGDTM(2) = ADDR(AUDEV);               0769
         LA    @04,AUDEV(,@04)                                     0769
         ST    @04,DARGDTM+8(,@15)                                 0769
*                          CALL LISTPROC;                          0770
         BAL   @14,LISTPROC                                        0770
*                        END;                                      0771
*                  END AUVOLFLD;                                   0772
*                /****************************************************/
*                /*                                                  */
*                /* LIST ALL THE CATALOG DATA FOR A NONVSAM OR UCAT  */
*                /* ENTRY.                                           */
*                /*                                                  */
*                /****************************************************/
*                                                                  0773
*                ELSE                                              0773
*AUALLFLD:         DO;                                             0773
         B     @RC00757                                            0773
@RF00757 DS    0H                                                  0773
AUALLFLD DS    0H                                                  0774
*                    DARGDBP = CTGFLPT(1);                         0774
         L     @04,DARGPTR                                         0774
         L     @15,CTGFLPTR                                        0774
         L     @14,CTGFLPT(,@15)                                   0774
         ST    @14,DARGDBP(,@04)                                   0774
*                    DARGILP = CTGFLNG(1);                         0775
         L     @15,CTGFLNG(,@15)                                   0775
         STH   @15,DARGILP(,@04)                                   0775
*                    DARGCNT = DRGCNT1;                    /*@Y30SSMK*/
*                                                                  0776
         MVC   DARGCNT(2,@04),@CH00045                             0776
*                    /************************************************/
*                    /*                                              */
*                    /* FOR A UCAT ENTRY LIST THE VOLUME FLAG VALUE  */
*                    /* BY INSERTING THE ADDRESS OF THE APPROPRIATE  */
*                    /* STATIC TEXT DESCRIPTOR INTO THE DARGLIST.    */
*                    /*                                              */
*                    /************************************************/
*                                                                  0777
*                    IF HOLDETYP = CTGTUCAT                        0777
*                      THEN                                        0777
         CLI   HOLDETYP,C'U'                                       0777
         BNE   @RF00777                                            0777
*                        DO;                                       0778
*                          DARGSENT = LCST11;              /*@ZA05939*/
         MVI   DARGSENT(@04),X'0B'                                 0779
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/
         LA    @15,10                                              0780
         STH   @15,DARGINS(,@04)                                   0780
*                          DARGINL(1) = ABBREVLN;                  0781
         STH   @15,DARGINL(,@04)                                   0781
*                          IF AUVPRIM = ON                         0782
*                            THEN                                  0782
         TM    AUVPRIM(@14),B'10000000'                            0782
         BNO   @RF00782                                            0782
*                              DARGDTM(1) = ADDR(PRIMENM);         0783
         L     @00,TEXTPTR                                         0783
         ST    @00,DARGDTM(,@04)                                   0783
*                            ELSE                                  0784
*                              IF AUVCAN = ON                      0784
*                                THEN                              0784
         B     @RC00782                                            0784
@RF00782 L     @04,CTGFLPTR                                        0784
         L     @04,CTGFLPT(,@04)                                   0784
         TM    AUVCAN(@04),B'01000000'                             0784
         BNO   @RF00784                                            0784
*                                  DARGDTM(1) = ADDR(CANNM);       0785
         L     @04,TEXTPTR                                         0785
         LA    @04,CANNM(,@04)                                     0785
         L     @15,DARGPTR                                         0785
         ST    @04,DARGDTM(,@15)                                   0785
*                                ELSE                              0786
*                                  IF AUVOVFL = ON                 0786
*                                    THEN                          0786
         B     @RC00784                                            0786
@RF00784 L     @04,CTGFLPTR                                        0786
         L     @04,CTGFLPT(,@04)                                   0786
         TM    AUVOVFL(@04),B'00100000'                            0786
         BNO   @RF00786                                            0786
*                                      DARGDTM(1) = ADDR(OVFLONM); 0787
         L     @04,TEXTPTR                                         0787
         LA    @04,OVFLONM(,@04)                                   0787
         L     @15,DARGPTR                                         0787
         ST    @04,DARGDTM(,@15)                                   0787
*                                    ELSE                          0788
*                                     DARGDTM(1) = ADDR(NULLNM);   0788
         B     @RC00786                                            0788
@RF00786 L     @04,TEXTPTR                                         0788
         LA    @04,NULLNM(,@04)                                    0788
         L     @15,DARGPTR                                         0788
         ST    @04,DARGDTM(,@15)                                   0788
*                        END;                                      0789
*                                                                  0789
*                      /**********************************************/
*                      /*                                            */
*                      /* FOR A NONVSAM ENTRY LIST THE FILE SEQ.NO.  */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0790
*                      ELSE                                        0790
*                        DO;                                       0790
         B     @RC00777                                            0790
@RF00777 DS    0H                                                  0791
*                          DARGSENT = LCST10;              /*@ZA05939*/
         L     @04,DARGPTR                                         0791
         MVI   DARGSENT(@04),X'0A'                                 0791
*                          DARGINS(1) = DRGINS10;          /*@ZA05939*/
         MVC   DARGINS(2,@04),@CH00457                             0792
*                          DARGINL(1) = LENGTH(AUFILE);    /*@ZA05939*/
         MVC   DARGINL(2,@04),@CH00161                             0793
*                          DARGDTM(1) = ADDR(AUFILE);      /*@ZA05939*/
         L     @15,CTGFLPTR                                        0794
         L     @15,CTGFLPT(,@15)                                   0794
         LA    @00,AUFILE(,@15)                                    0794
         ST    @00,DARGDTM(,@04)                                   0794
*                        END;                                      0795
*                    CALL LISTPROC;                                0796
@RC00777 BAL   @14,LISTPROC                                        0796
*                  END AUALLFLD;                                   0797
*                                                                  0797
*              /******************************************************/
*              /*                                                    */
*              /* UPDATE THE FPL POINTER TO THE NEXT OCCURRENCE AND  */
*              /* ACCORDINGLY DECREMENT THE TOTAL LENGTH BY THAT DATA*/
*              /* JUST PROCESSED.                                    */
*              /*                                                    */
*              /******************************************************/
*                                                                  0798
*              CTGFLNG(1) = CTGFLNG(1) - LENGTH(AUDATA);           0798
@RC00757 L     @04,CTGFLPTR                                        0798
         LA    @15,15                                              0798
         L     @14,CTGFLNG(,@04)                                   0798
         SLR   @14,@15                                             0798
         ST    @14,CTGFLNG(,@04)                                   0798
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(AUDATA);           0799
         AL    @15,CTGFLPT(,@04)                                   0799
         ST    @15,CTGFLPT(,@04)                                   0799
*            END AULIST;                                           0800
*                                                                  0800
@DE00756 L     @04,CTGFLPTR                                        0800
         L     @04,CTGFLNG(,@04)                                   0800
         C     @04,@CF00235                                        0800
         BNL   @DL00756                                            0800
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* EXIT HERE FROM AUPROC IF ONLY THE VOL SUBSET WAS @YL026UE*/
*        /* REQUESTED.                                       @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0801
*        IF ADDR(VOL) > NULLPTR                                    0801
*          THEN                                                    0801
@RF00755 SLR   @04,@04                                             0801
         L     @15,@PC00001+4                                      0801
         C     @04,FDTPTR+60(,@15)                                 0801
         BNL   @RF00801                                            0801
*          RETURN CODE(0);                                 /*@YL026UE*/
*                                                                  0802
         LR    @15,@04                                             0802
         L     @13,4(,@13)                                         0802
         L     @14,12(,@13)                                        0802
         LM    @00,@12,20(@13)                                     0802
         BR    @14                                                 0802
*        END AUOUTPUT;                                     /*@YL026UE*/
*                                                                  0803
@RF00801 DS    0H                                                  0804
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* LIST THE GDG BASE ATTRIBUTES - LIMIT, SCRATCH, EMPTY     */
*        /* (NOTE THAT 'FF'X IS LIMIT(255), NOT NONEXISTENT FIELD)   */
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0804
*        IF HOLDETYP = CTGTGBS & ADDR(VOL) = NULLPTR               0804
*          THEN                                                    0804
@RF00749 CLI   HOLDETYP,C'B'                                       0804
         BNE   @RF00804                                            0804
         L     @04,@PC00001+4                                      0804
         L     @04,FDTPTR+60(,@04)                                 0804
         LTR   @04,@04                                             0804
         BNZ   @RF00804                                            0804
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST45;                            /*@YL026UE*/
         L     @04,DARGPTR                                         0806
         MVI   DARGSENT(@04),X'2D'                                 0806
*            CTGFLPTR = GDGLMFPT;      /*GDG LIMIT FPL       @YL026UE*/
*                                                                  0807
         L     @00,GDGLMFPT                                        0807
         ST    @00,CTGFLPTR                                        0807
*            DARGDBP = CTGFLPT(1);                         /*@YL026UE*/
         LR    @15,@00                                             0808
         L     @15,CTGFLPT(,@15)                                   0808
         ST    @15,DARGDBP(,@04)                                   0808
*            DARGILP = CTGFLNG(1);                         /*@YL026UE*/
         LR    @15,@00                                             0809
         L     @00,CTGFLNG(,@15)                                   0809
         STH   @00,DARGILP(,@04)                                   0809
*            CTGFLPTR = GDGATFPT;      /*GDG ATTRIBUTE FPL   @YL026UE*/
         L     @00,GDGATFPT                                        0810
         ST    @00,CTGFLPTR                                        0810
*            DARGCNT = DRGCNT2;                            /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00161                             0811
*            DARGINS(1) = DRGINS10;                        /*@Y30SSMK*/
         LA    @15,10                                              0812
         STH   @15,DARGINS(,@04)                                   0812
*            DARGINL(1) = ABBREVLN;                        /*@YL026UE*/
         STH   @15,DARGINL(,@04)                                   0813
*            IF GSCRAT = ON                                        0814
*              THEN                                                0814
         LR    @15,@00                                             0814
         L     @15,CTGFLPT(,@15)                                   0814
         TM    GSCRAT(@15),B'01000000'                             0814
         BNO   @RF00814                                            0814
*                DARGDTM(1) = ADDR(SCRNM);                 /*@YL026UE*/
         L     @15,TEXTPTR                                         0815
         LA    @00,SCRNM(,@15)                                     0815
         ST    @00,DARGDTM(,@04)                                   0815
*              ELSE                                                0816
*                DARGDTM(1) = ADDR(NSCRNM);                /*@YL026UE*/
         B     @RC00814                                            0816
@RF00814 L     @04,TEXTPTR                                         0816
         LA    @04,NSCRNM(,@04)                                    0816
         L     @15,DARGPTR                                         0816
         ST    @04,DARGDTM(,@15)                                   0816
*            DARGINS(2) = DRGINS20;                        /*@Y30SSMK*/
@RC00814 L     @04,DARGPTR                                         0817
         MVC   DARGINS+8(2,@04),@CH00649                           0817
*            DARGINL(2) = ABBREVLN;                        /*@YL026UE*/
         MVC   DARGINL+8(2,@04),@CH00457                           0818
*            IF GDELET = ON                                        0819
*              THEN                                                0819
         L     @15,CTGFLPTR                                        0819
         L     @15,CTGFLPT(,@15)                                   0819
         TM    GDELET(@15),B'10000000'                             0819
         BNO   @RF00819                                            0819
*                DARGDTM(2) = ADDR(EMPTYNM);               /*@YL026UE*/
         L     @15,TEXTPTR                                         0820
         LA    @00,EMPTYNM(,@15)                                   0820
         ST    @00,DARGDTM+8(,@04)                                 0820
*              ELSE                                                0821
*                DARGDTM(2) = ADDR(NEMPTYNM);              /*@YL026UE*/
         B     @RC00819                                            0821
@RF00819 L     @04,TEXTPTR                                         0821
         LA    @04,NEMPTYNM(,@04)                                  0821
         L     @15,DARGPTR                                         0821
         ST    @04,DARGDTM+8(,@15)                                 0821
*            CALL LISTPROC;                                /*@YL026UE*/
@RC00819 BAL   @14,LISTPROC                                        0822
*            END;                                          /*@YL026UE*/
*                                                                  0823
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* LIST THE ASSOCIATED ENTRY TYPES                  @YL026UE*/
*        /* FOR A GDG, NONVSAM, UCAT, OR ALIAS ENTRY         @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0824
*        CTGFLPTR = ASSOCFPT;                              /*@YL026UE*/
@RF00804 L     @04,ASSOCFPT                                        0824
         ST    @04,CTGFLPTR                                        0824
*        IF HOLDETYP = CTGTUCAT  HOLDETYP = CTGTANM               0825
*          THEN                                                    0825
         CLI   HOLDETYP,C'U'                                       0825
         BE    @RT00825                                            0825
         CLI   HOLDETYP,C'X'                                       0825
         BNE   @RF00825                                            0825
@RT00825 DS    0H                                                  0826
*            DO;                                           /*@YL026UE*/
*                                                                  0826
*            CALL ALSPROC;                                 /*@YL026UE*/
*                                                                  0827
         BAL   @14,ALSPROC                                         0827
*            RESPECIFY RTNREG RSTD;                                0828
*            TESTRC = RTNREG;                                      0829
         LR    TESTRC,RTNREG                                       0829
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LSMK*/
*                                                                  0830
*            /********************************************************/
*            /*                                              @Y30SSMK*/
*            /* RETURN WHEN ANY NON-ZERO RETURN CODE IS      @Y30SSMK*/
*            /* ENCOUNTERED WHILE PROCESSING THE UCAT AND    @Y30SSMK*/
*            /* ALIAS ASSOCIATIONS.  USE THE RETURN CODE     @Y30SSMK*/
*            /* 'SAVRC' WHICH WAS SET IN ALSPROC.            @ZA05939*/
*            /*                                              @Y30SSMK*/
*            /********************************************************/
*                                                                  0831
*            IF TESTRC ^= 0                                        0831
*              THEN                                                0831
         LTR   TESTRC,TESTRC                                       0831
         BZ    @RF00831                                            0831
*                RETURN CODE(SAVRC);                       /*@ZA05939*/
         LH    @15,SAVRC                                           0832
         L     @13,4(,@13)                                         0832
         L     @14,12(,@13)                                        0832
         LM    @00,@12,20(@13)                                     0832
         BR    @14                                                 0832
*            END;                                          /*@YL026UE*/
*                                                                  0833
@RF00831 DS    0H                                                  0834
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* RETRIEVE AND LIST THE ASSOCIATIONS FOR THE       @Y30SSMK*/
*        /* NONVSAM ENTRIES.                                 @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  0834
*        IF HOLDETYP = CTGTALIN                                    0834
*          THEN                                                    0834
@RF00825 CLI   HOLDETYP,C'A'                                       0834
         BNE   @RF00834                                            0834
*NVSAMENT:   DO;                                           /*@YL026UE*/
*                                                                  0835
NVSAMENT DS    0H                                                  0836
*            /********************************************************/
*            /*                                              @Y30SSMK*/
*            /* FOR A NONVSAM ENTRY OF A GDG, CHECK FOR      @Y30SSMK*/
*            /* ALIAS ASSOCIATIONS.                          @Y30SSMK*/
*            /*                                              @Y30SSMK*/
*            /********************************************************/
*                                                                  0836
*            IF KIND(1) = CTGTGBS                                  0836
*              THEN                                                0836
         L     @04,CTGFLPTR                                        0836
         L     @04,CTGFLPT(,@04)                                   0836
         CLI   KIND(@04),C'B'                                      0836
         BNE   @RF00836                                            0836
*NVSMG0V0:       DO;                                       /*@Y30LSMK*/
NVSMG0V0 DS    0H                                                  0838
*                IF CTGFLNG(1) > CITYPLEN                          0838
*                  THEN                                            0838
         L     @04,CTGFLPTR                                        0838
         L     @00,CTGFLNG(,@04)                                   0838
         C     @00,@CF00050                                        0838
         BNH   @RF00838                                            0838
*                    DO;                                   /*@YL026UE*/
*                    ALIASCI# = CI#(2);                    /*@YL026UE*/
         L     @04,CTGFLPT(,@04)                                   0840
         MVC   ALIASCI#(3),CI#+4(@04)                              0840
*                    ALIASKND = KIND(2);                   /*@YL026UE*/
         MVC   ALIASKND(1),KIND+4(@04)                             0841
*                    G0V0FLG = ON;                         /*@YL026UE*/
         OI    G0V0FLG,B'10000000'                                 0842
*                    END;                                  /*@YL026UE*/
*                CALL ANSVPROC;                            /*@YL026UE*/
*                                                                  0844
@RF00838 BAL   @14,ANSVPROC                                        0844
*                RESPECIFY RTNREG RSTD;                            0845
*                TESTRC = RTNREG;                                  0846
         LR    TESTRC,RTNREG                                       0846
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LSMK*/
*                                                                  0847
*                /****************************************************/
*                /*                                          @Y30SSMK*/
*                /* RETURN WHEN ANY NON-ZERO RETURN CODE IS  @Y30SSMK*/
*                /* ENCOUNTERED WHILE RETRIEVING THE NONVSAM @Y30SSMK*/
*                /* ASSOCIATIONS.  USE THE RETURN CODE       @Y30SSMK*/
*                /* 'SAVRC' WHICH WAS SET IN ANSVPROC.       @ZA05939*/
*                /*                                          @Y30SSMK*/
*                /****************************************************/
*                                                                  0848
*                IF TESTRC ^= 0                                    0848
*                  THEN                                            0848
         LTR   TESTRC,TESTRC                                       0848
         BZ    @RF00848                                            0848
*                    RETURN CODE(SAVRC);                   /*@ZA05939*/
         LH    @15,SAVRC                                           0849
         L     @13,4(,@13)                                         0849
         L     @14,12(,@13)                                        0849
         LM    @00,@12,20(@13)                                     0849
         BR    @14                                                 0849
*                CALL ANLTPROC;                            /*@YL026UE*/
*                                                                  0850
@RF00848 BAL   @14,ANLTPROC                                        0850
*                RESPECIFY RTNREG RSTD;                            0851
*                TESTRC = RTNREG;                                  0852
         LR    TESTRC,RTNREG                                       0852
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LSMK*/
*                                                                  0853
*                /****************************************************/
*                /*                                          @Y30SSMK*/
*                /* RETURN WHEN ANY NON-ZERO RETURN CODE IS  @Y30SSMK*/
*                /* ENCOUNTERED WHILE PROCESSING THE NONVSAM @Y30SSMK*/
*                /* ASSOCIATIONS.  USE THE RETURN CODE       @Y30SSMK*/
*                /* 'SAVRC' WHICH WAS SET IN ANLTPROC.       @ZA05939*/
*                /*                                          @Y30SSMK*/
*                /****************************************************/
*                                                                  0854
*                IF TESTRC ^= 0                                    0854
*                  THEN                                            0854
         LTR   TESTRC,TESTRC                                       0854
         BZ    @RF00854                                            0854
*                    RETURN CODE(SAVRC);                   /*@ZA05939*/
         LH    @15,SAVRC                                           0855
         L     @13,4(,@13)                                         0855
         L     @14,12(,@13)                                        0855
         LM    @00,@12,20(@13)                                     0855
         BR    @14                                                 0855
*                IF G0V0FLG = ON                                   0856
*                  THEN                                            0856
@RF00854 TM    G0V0FLG,B'10000000'                                 0856
         BNO   @RF00856                                            0856
*                    DO;                                   /*@YL026UE*/
*                    CALL ALSPROC;                         /*@YL026UE*/
*                                                                  0858
         BAL   @14,ALSPROC                                         0858
*                    RESPECIFY RTNREG RSTD;                        0859
*                    TESTRC = RTNREG;                              0860
         LR    TESTRC,RTNREG                                       0860
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30LSMK*/
*                                                                  0861
*                    /************************************************/
*                    /*                                      @Y30SSMK*/
*                    /* RETURN WHEN ANY NON-ZERO RETURN CODE @Y30SSMK*/
*                    /* IS ENCOUNTERED WHILE PROCESSING THE  @Y30SSMK*/
*                    /* NONVSAM ALIAS ASSOCIATIONS.  USE THE @Y30SSMK*/
*                    /* RETURN CODE 'SAVRC' WHICH WAS SET    @ZA05939*/
*                    /* IN ALSPROC.                          @Y30SSMK*/
*                    /*                                      @Y30SSMK*/
*                    /************************************************/
*                                                                  0862
*                    IF TESTRC ^= 0                                0862
*                      THEN                                        0862
         LTR   TESTRC,TESTRC                                       0862
         BZ    @RF00862                                            0862
*                        RETURN CODE(SAVRC);               /*@ZA05939*/
         LH    @15,SAVRC                                           0863
         L     @13,4(,@13)                                         0863
         L     @14,12(,@13)                                        0863
         LM    @00,@12,20(@13)                                     0863
         BR    @14                                                 0863
*                    END;                                  /*@YL026UE*/
*                END NVSMG0V0;                             /*@Y30LSMK*/
*              ELSE                                                0866
*                DO;                                       /*@YL026UE*/
         B     @RC00836                                            0866
@RF00836 DS    0H                                                  0867
*                CALL ALSPROC;                             /*@YL026UE*/
*                                                                  0867
         BAL   @14,ALSPROC                                         0867
*                RESPECIFY RTNREG RSTD;                            0868
*                TESTRC = RTNREG;                                  0869
         LR    TESTRC,RTNREG                                       0869
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LSMK*/
*                                                                  0870
*                /****************************************************/
*                /*                                          @Y30SSMK*/
*                /* RETURN WHEN ANY NON-ZERO RETURN CODE     @Y30SSMK*/
*                /* IS ENCOUNTERED WHILE PROCESSING THE      @Y30SSMK*/
*                /* NONVSAM ALIAS ASSOCIATIONS.  USE THE     @Y30SSMK*/
*                /* RETURN CODE 'SAVRC' WHICH WAS SET        @ZA05939*/
*                /* IN ALSPROC.                              @Y30SSMK*/
*                /*                                          @Y30SSMK*/
*                /****************************************************/
*                                                                  0871
*                IF TESTRC ^= 0                                    0871
*                  THEN                                            0871
         LTR   TESTRC,TESTRC                                       0871
         BZ    @RF00871                                            0871
*                    RETURN CODE(SAVRC);                   /*@ZA05939*/
         LH    @15,SAVRC                                           0872
         L     @13,4(,@13)                                         0872
         L     @14,12(,@13)                                        0872
         LM    @00,@12,20(@13)                                     0872
         BR    @14                                                 0872
*                END;                                      /*@YL026UE*/
@RF00871 DS    0H                                                  0874
*            END NVSAMENT;                                 /*@YL026UE*/
*                                                                  0874
@RC00836 DS    0H                                                  0875
*          /**********************************************************/
*          /*                                                @Y30SSMK*/
*          /* RETRIEVE AND LIST THE ASSOCIATIONS OF A GDG    @Y30SSMK*/
*          /* ENTRY.                                         @Y30SSMK*/
*          /*                                                @Y30SSMK*/
*          /**********************************************************/
*                                                                  0875
*          IF HOLDETYP = CTGTGBS                                   0875
*            THEN                                                  0875
@RF00834 CLI   HOLDETYP,C'B'                                       0875
         BNE   @RF00875                                            0875
*              DO;                                         /*@YL026UE*/
*              CALL ANSVPROC;                              /*@YL026UE*/
*                                                                  0877
         BAL   @14,ANSVPROC                                        0877
*              RESPECIFY RTNREG RSTD;                              0878
*              TESTRC = RTNREG;                                    0879
         LR    TESTRC,RTNREG                                       0879
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30LSMK*/
*                                                                  0880
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* RETURN WHEN ANY NON-ZERO RETURN CODE IS    @Y30SSMK*/
*              /* ENCOUNTERED WHILE RETRIEVING THE GDG       @Y30SSMK*/
*              /* ASSOCIATIONS.  USE THE RETURN CODE         @Y30SSMK*/
*              /* 'SAVRC' WHICH WAS SET IN ANSVPROC.         @ZA05939*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  0881
*              IF TESTRC ^= 0                                      0881
*                THEN                                              0881
         LTR   TESTRC,TESTRC                                       0881
         BZ    @RF00881                                            0881
*                  RETURN CODE(SAVRC);                     /*@ZA05939*/
         LH    @15,SAVRC                                           0882
         L     @13,4(,@13)                                         0882
         L     @14,12(,@13)                                        0882
         LM    @00,@12,20(@13)                                     0882
         BR    @14                                                 0882
*              IF ADDR(VOL) = NULLPTR                              0883
*                THEN                                              0883
@RF00881 L     @04,@PC00001+4                                      0883
         L     @04,FDTPTR+60(,@04)                                 0883
         LTR   @04,@04                                             0883
         BNZ   @RF00883                                            0883
*                  DO;                                     /*@YL026UE*/
*                  CALL ANLTPROC;                          /*@YL026UE*/
*                                                                  0885
         BAL   @14,ANLTPROC                                        0885
*                  RESPECIFY RTNREG RSTD;                          0886
*                  TESTRC = RTNREG;                                0887
         LR    TESTRC,RTNREG                                       0887
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LSMK*/
*                                                                  0888
*                  /**************************************************/
*                  /*                                        @Y30SSMK*/
*                  /* RETURN WHEN ANY NON-ZERO RETURN CODE   @Y30SSMK*/
*                  /* IS ENCOUNTERED WHILE PROCESSING THE    @Y30SSMK*/
*                  /* GDG ASSOCIATIONS.  USE THE RETURN      @Y30SSMK*/
*                  /* CODE 'SAVRC' WHICH WAS SET IN ANLTPROC.@ZA05939*/
*                  /*                                        @Y30SSMK*/
*                  /**************************************************/
*                                                                  0889
*                  IF TESTRC ^= 0                                  0889
*                    THEN                                          0889
         LTR   TESTRC,TESTRC                                       0889
         BZ    @RF00889                                            0889
*                      RETURN CODE(SAVRC);                 /*@ZA05939*/
         LH    @15,SAVRC                                           0890
         L     @13,4(,@13)                                         0890
         L     @14,12(,@13)                                        0890
         LM    @00,@12,20(@13)                                     0890
         BR    @14                                                 0890
*                  END;                                    /*@YL026UE*/
@RF00889 DS    0H                                                  0892
*              END;                                        /*@YL026UE*/
@RF00883 DS    0H                                                  0893
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM THE NONVSAM/USERCAT ROUTINE, RETURNING TO THE  */
*        /* ROUTING PROCEDURE.                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0893
*        RETURN CODE(0);                                           0893
@RF00875 SLR   @15,@15                                             0893
         L     @13,4(,@13)                                         0893
         L     @14,12(,@13)                                        0893
         LM    @00,@12,20(@13)                                     0893
         BR    @14                                                 0893
*        END AUPROC;                                               0894
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - CDIPROC                                      */
*        /*                                                          */
*        /* FUNCTION - FORMATS THE VSAM CATALOG DATA FOR CLUSTER,    */
*        /* AIX, PGSPC, DATA, INDEX OR PATH ENTRIES.         @Y30SSMK*/
*        /* THEN PROCESSING ALL CATALOG INFORMATION,         @Y30SSMK*/
*        /* ISSUES THE LOCATE REQUEST TO OBTAIN THE          @Y30SSMK*/
*        /* OTHER ASSOCIATED ENTRYNAMES OF THE ENTRY BEING CURRENTLY */
*        /* PROCESSED.  REPETITIVELY BUILDS THE AMS TEXT PROCESSOR   */
*        /* ARGUMENT LIST AND INVOKES LISTPROC TO ISSUE THE AMS      */
*        /* UPRINT MACRO TO OUTPUT THE CATALOG DATA.                 */
*        /*                                                          */
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM CATALOG DATA    */
*        /* RETRIEVED VIA A LOCATE REQUEST.  THE VSAM CPL AND FPL'S  */
*        /* AND THE AMS GDT AND THE PREFORMATTED DESCRIPTORS FROM    */
*        /* STATIC TEXT FOR EDITING THE CATALOG DATA.                */
*        /*                                                          */
*        /* OUTPUT - PRINTED VSAM CATALOG DATA FOR EITHER A CLUSTER, */
*        /* AIX, PGSPC, DATA, INDEX OR PATH ENTRY.           @Y30SSMK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0895
*CDIPROC: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA05939*/
*                                                                  0895
CDIPROC  STM   @14,@12,12(@13)                                     0895
         ST    @13,@SA00007+4                                      0895
         LA    @14,@SA00007                                        0895
         ST    @14,8(,@13)                                         0895
         LR    @13,@14                                             0895
*        GEN(ENTRY CDIPROC);           /*EXT ENTRY POINT     @ZA05939*/
         ENTRY CDIPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  0897
         LM    REG8,REG12,BASESAVE                                 0897
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0898
*        DCL CKK       FIXED(15);      /*DO GROUP CONTROL VAR        */
*        DCL CLENGTH1  FIXED(15)       /*SHR OPTN STATIC TEXT VAR    */
*                      CONSTANT(1);                                0899
*        DCL CVARPTR   PTR(31);        /*WORK POINTER FOR ENTVOL INFO*/
*        DCL CURRLEN   FIXED(31);      /*WKA FOR ENTVOL LENGTH       */
*        DCL PGPTR     PTR(31);        /*FOR REPETITIVE NOBYTTRK INFO
*                                                            @YL026UE*/
*        DCL DALLOCNM  PTR(31);        /* RETAINS PTR TO DATA NAME 0903
*                                        FOR ALLOC LOCATE    @YL026UE*/
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE THE PROPER PREFORMATTED STATIC TEXT DESCRIPTOR */
*        /* TO IDENTIFY THE ENTRY AS A CLUSTER OR AIX OR     @Y30SSMK*/
*        /* PGSPC OR DATA OR INDEX OR PATH.  ALSO UPDATE THE @Y30SSMK*/
*        /* APPROPRIATE ENTRY TYPE COUNTER.                  @Y30SSMK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0904
*        OLDERID2 = NEWERID2;                                      0904
         L     @04,@PC00001                                        0904
         L     @15,GDTTR2(,@04)                                    0904
         MVC   @TS00001(95),NEWERID2(@15)                          0904
         MVC   OLDERID2(95,@15),@TS00001                           0904
*        NEWID2 = 'LCCL';                                          0905
*                                                                  0905
*                                                                  0905
         MVC   NEWID2(4,@15),@CC01637                              0905
*        IF GDTDBG = NULLPTR                                       0906
*          THEN;                                                   0906
         L     @04,GDTDBG(,@04)                                    0906
         LTR   @04,@04                                             0906
         BZ    @RT00906                                            0906
*          ELSE                                                    0908
*            CALL IDCDB010(GDTTBL,'LCCD',DPLISTPT);                0908
         L     @04,@PC00001                                        0908
         ST    @04,@AL00001                                        0908
         LA    @00,@CC01638                                        0908
         ST    @00,@AL00001+4                                      0908
         LA    @00,DPLISTPT                                        0908
         ST    @00,@AL00001+8                                      0908
         MVI   @AL00001+8,X'80'                                    0908
         L     @15,GDTDBG(,@04)                                    0908
         LA    @01,@AL00001                                        0908
         BALR  @14,@15                                             0908
*                                                          /*@ZA05939*/
*                                                                  0909
*                                                                  0909
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* IF THE TYPE VALUE  PASSED TO CDIPROC IS A CLUSTER,       */
*        /* IT MUST BE DETERMINED VIA THE CATTR FPL WHETHER  @YL026UE*/
*        /* THIS ENTRY IS A CLUSTER OR PAGESPACE.            @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0909
*        IF HOLDETYP = CTGTCL                                      0909
*          THEN                                                    0909
@RT00906 CLI   HOLDETYP,C'C'                                       0909
         BNE   @RF00909                                            0909
*            DO;                                           /*@YL026UE*/
*              IF PGSPCFLG = OFF                                   0911
*                THEN                                              0911
         TM    PGSPCFLG,B'10000000'                                0911
         BNZ   @RF00911                                            0911
*                  DO;                                     /*@YL026UE*/
*                  CTYPCNT = CTYPCNT + 1;                  /*@YL026UE*/
         LA    @04,1                                               0913
         AL    @04,CTYPCNT                                         0913
         ST    @04,CTYPCNT                                         0913
*                  DARGSENT = LCST06;                      /*@YL026UE*/
         L     @04,DARGPTR                                         0914
         MVI   DARGSENT(@04),X'06'                                 0914
*                  END;                                    /*@YL026UE*/
*                ELSE                                              0916
*                  DO;                                     /*@YL026UE*/
         B     @RC00911                                            0916
@RF00911 DS    0H                                                  0917
*                  PTYPCNT = PTYPCNT + 1;                  /*@YL026UE*/
         LA    @04,1                                               0917
         AL    @04,PTYPCNT                                         0917
         ST    @04,PTYPCNT                                         0917
*                  DARGSENT = LCST41;                      /*@YL026UE*/
         L     @04,DARGPTR                                         0918
         MVI   DARGSENT(@04),X'29'                                 0918
*                  END;                                    /*@YL026UE*/
*            END;                                          /*@YL026UE*/
*          ELSE                                                    0921
*            IF HOLDETYP = CTGTAIX                                 0921
*              THEN                                                0921
         B     @RC00909                                            0921
@RF00909 CLI   HOLDETYP,C'G'                                       0921
         BNE   @RF00921                                            0921
*                DO;                                       /*@Y30SSMK*/
*                  GTYPCNT = GTYPCNT + 1;                  /*@Y30SSMK*/
         LA    @04,1                                               0923
         AL    @04,GTYPCNT                                         0923
         ST    @04,GTYPCNT                                         0923
*                  DARGSENT = LCST48;                      /*@Y30SSMK*/
         L     @04,DARGPTR                                         0924
         MVI   DARGSENT(@04),X'30'                                 0924
*                END;                                      /*@Y30SSMK*/
*              ELSE                                                0926
*                IF HOLDETYP = CTGTDATA                            0926
*                  THEN                                            0926
         B     @RC00921                                            0926
@RF00921 CLI   HOLDETYP,C'D'                                       0926
         BNE   @RF00926                                            0926
*                    DO;                                           0927
*                      DTYPCNT = DTYPCNT + 1;                      0928
         LA    @04,1                                               0928
         AL    @04,DTYPCNT                                         0928
         ST    @04,DTYPCNT                                         0928
*                      DENTAFLG = OFF;                     /*@YL026UE*/
*                                                                  0929
         NI    DENTAFLG,B'01111111'                                0929
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* DETERMINE IF DATA ENTRY IS PART OF A       */
*                      /* PAGESPACE BY CHECKING ASSOCIATION. @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  0930
*                      IF ADDR(ALLOC) > NULLPTR & CATRC ^= CRCBADPW
*                         & ENTCLFLG = OFF                         0930
*                        THEN                                      0930
         L     @04,@PC00001+4                                      0930
         L     @04,FDTPTR+64(,@04)                                 0930
         LTR   @04,@04                                             0930
         BNP   @RF00930                                            0930
         CLC   CATRC(2),@CH01280                                   0930
         BE    @RF00930                                            0930
         TM    ENTCLFLG,B'10000000'                                0930
         BNZ   @RF00930                                            0930
*                          DO;                             /*@YL026UE*/
*                                                                  0931
*                          CALL ANSVPROC;                  /*@YL026UE*/
*                                                                  0932
         BAL   @14,ANSVPROC                                        0932
*                          RESPECIFY RTNREG RSTD;                  0933
*                          TESTRC = RTNREG;                        0934
         LR    TESTRC,RTNREG                                       0934
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30LSMK*/
*                                                                  0935
*                          /******************************************/
*                          /*                                @Y30SSMK*/
*                          /* RETURN WHEN ANY NON-ZERO       @Y30SSMK*/
*                          /* RETURN CODE IS ENCOUNTERED     @Y30SSMK*/
*                          /* WHILE RETRIEVING THE DATA      @Y30SSMK*/
*                          /* ASSOCIATIONS.  USE THE         @Y30SSMK*/
*                          /* RETURN CODE 'SAVRC' WHICH WAS  @ZA05939*/
*                          /* SET IN ANSVPROC.               @Y30SSMK*/
*                          /*                                @Y30SSMK*/
*                          /******************************************/
*                                                                  0936
*                          IF TESTRC ^= 0                          0936
*                            THEN                                  0936
         LTR   TESTRC,TESTRC                                       0936
         BZ    @RF00936                                            0936
*                              RETURN CODE(SAVRC);         /*@ZA05939*/
         LH    @15,SAVRC                                           0937
         L     @13,4(,@13)                                         0937
         L     @14,12(,@13)                                        0937
         LM    @00,@12,20(@13)                                     0937
         BR    @14                                                 0937
*                          DENTAFLG = ON;                  /*@YL026UE*/
@RF00936 OI    DENTAFLG,B'10000000'                                0938
*                          CTGFLPTR = ENT44FPT;            /*@YL026UE*/
         L     @04,ENT44FPT                                        0939
         ST    @04,CTGFLPTR                                        0939
*                          DALLOCNM = CTGFLPT(1);          /*@YL026UE*/
*                                                                  0940
         L     DALLOCNM,CTGFLPT(,@04)                              0940
*                          CALL ANLTPROC;                  /*@YL026UE*/
*                                                                  0941
         BAL   @14,ANLTPROC                                        0941
*                          DENTAFLG = OFF;                 /*@YL026UE*/
         NI    DENTAFLG,B'01111111'                                0942
*                          CTGFLPTR = ENT44FPT;            /*@YL026UE*/
         L     @04,ENT44FPT                                        0943
         ST    @04,CTGFLPTR                                        0943
*                          CTGFLPT(1) = DALLOCNM;          /*@YL026UE*/
         ST    DALLOCNM,CTGFLPT(,@04)                              0944
*                          CTGNOFLD = 1;                   /*@YL026UE*/
         L     @04,CTGPLPTR                                        0945
         MVI   CTGNOFLD(@04),X'01'                                 0945
*                          CTGPLPTR = TYPCPLPT;            /*@YL026UE*/
         L     @04,TYPCPLPT                                        0946
         ST    @04,CTGPLPTR                                        0946
*                          RESPECIFY ASSOC                         0947
*                            BASED(CTGFLPT(1));            /*@YL026UE*/
*                          ENTNMFLG = OFF;                 /*@YL026UE*/
         NI    ENTNMFLG,B'01111111'                                0948
*                          DARGLIST = ZEROAREA;            /*@YL026UE*/
         L     @04,DARGPTR                                         0949
         MVC   DARGLIST(20,@04),ZEROAREA                           0949
*                          DARGSMOD = LC0ID;               /*@YL026UE*/
         MVC   DARGSMOD(3,@04),@CC01198                            0950
*                          END;                            /*@YL026UE*/
*                                                                  0951
*                      /**********************************************/
*                      /*                                            */
*                      /* THE DATA, INDEX, AND PATH OBJECTS ARE      */
*                      /* LISTED INDENTED UNDER THE CLUSTER  @Y30SSMK*/
*                      /* AND AIX ENTRY ONLY WHEN THE LISTCAT        */
*                      /* REQUEST HAS NOT BEEN RESTRICTED TO @Y30SSMK*/
*                      /* A PARTICULAR TYPE.                 @Y30SSMK*/
*                      /*                                    @Y30SSMK*/
*                      /**********************************************/
*                                                                  0952
*                      IF NDENTFLG = ON                            0952
*                        THEN                                      0952
@RF00930 TM    NDENTFLG,B'10000000'                                0952
         BNO   @RF00952                                            0952
*                          DARGSENT = LCST07; /*INDENTED DATA HDR    */
         L     @04,DARGPTR                                         0953
         MVI   DARGSENT(@04),X'07'                                 0953
*                        ELSE                                      0954
*                          DARGSENT = LCST38; /*NON-INDENTED DATA HDR*/
         B     @RC00952                                            0954
@RF00952 L     @04,DARGPTR                                         0954
         MVI   DARGSENT(@04),X'26'                                 0954
*                    END;                                  /*@Y30SSMK*/
*                  ELSE                                            0956
*                    IF HOLDETYP = CTGTINDX                        0956
*                      THEN                                        0956
         B     @RC00926                                            0956
@RF00926 CLI   HOLDETYP,C'I'                                       0956
         BNE   @RF00956                                            0956
*                        DO;                                       0957
*                          ITYPCNT = ITYPCNT + 1;                  0958
         LA    @04,1                                               0958
         AL    @04,ITYPCNT                                         0958
         ST    @04,ITYPCNT                                         0958
*                          IF NDENTFLG = ON                        0959
*                            THEN                                  0959
         TM    NDENTFLG,B'10000000'                                0959
         BNO   @RF00959                                            0959
*                              /*INDENTED INDEX HDR                  */
*                              DARGSENT = LCST08;                  0960
         L     @04,DARGPTR                                         0960
         MVI   DARGSENT(@04),X'08'                                 0960
*                            ELSE                                  0961
*                              /*NON-INDENTED INDEX HDR              */
*                              DARGSENT = LCST39;                  0961
         B     @RC00959                                            0961
@RF00959 L     @04,DARGPTR                                         0961
         MVI   DARGSENT(@04),X'27'                                 0961
*                        END;                                      0962
*                      ELSE                                        0963
*                        DO;                               /*@Y30SSMK*/
         B     @RC00956                                            0963
@RF00956 DS    0H                                                  0964
*                          RTYPCNT = RTYPCNT + 1;          /*@Y30SSMK*/
         LA    @04,1                                               0964
         AL    @04,RTYPCNT                                         0964
         ST    @04,RTYPCNT                                         0964
*                          IF NDENTFLG = ON                        0965
*                            THEN                                  0965
         TM    NDENTFLG,B'10000000'                                0965
         BNO   @RF00965                                            0965
*                              /*INDENTED PATH HDR           @Y30SSMK*/
*                              DARGSENT = LCST09;          /*@Y30SSMK*/
         L     @04,DARGPTR                                         0966
         MVI   DARGSENT(@04),X'09'                                 0966
*                            ELSE                                  0967
*                              /*NON-INDENTED PATH HDR       @Y30SSMK*/
*                              DARGSENT = LCST53;          /*@Y30SSMK*/
         B     @RC00965                                            0967
@RF00965 L     @04,DARGPTR                                         0967
         MVI   DARGSENT(@04),X'35'                                 0967
*                        END;                              /*@Y30SSMK*/
@RC00965 DS    0H                                                  0969
*        /************************************************************/
*        /*                                                          */
*        /* LIST THE ENTRY TYPE HEADER WITH THE 44-BYTE ENTRYNAME.   */
*        /*  IF THE PROPER PASSWORD WAS NOT PROVIDED AND ONLY THE    */
*        /*  NAME SUBSET IS REQUESTED, PICK UP THE ENTRY NAME FROM   */
*        /* THE SPECIALLY FORMATTED WORKAREA.                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0969
*        IF CATRC = CRCBADPW & ADDR(NAME) > NULLPTR                0969
*          THEN                                                    0969
@RC00956 DS    0H                                                  0969
@RC00926 DS    0H                                                  0969
@RC00921 DS    0H                                                  0969
@RC00909 CLC   CATRC(2),@CH01280                                   0969
         BNE   @RF00969                                            0969
         L     @04,@PC00001+4                                      0969
         L     @04,FDTPTR+52(,@04)                                 0969
         LTR   @04,@04                                             0969
         BNP   @RF00969                                            0969
*            DO;                                                   0970
*            DARGDBP = ADDR(SUPPDSNM);                             0971
         L     @04,DARGPTR                                         0971
         L     @15,CTGPLPTR                                        0971
         L     @15,CTGWKA(,@15)                                    0971
         LA    @00,SUPPDSNM(,@15)                                  0971
         ST    @00,DARGDBP(,@04)                                   0971
*            DARGILP = LENGTH(SUPPDSNM);                           0972
         MVC   DARGILP(2,@04),@CH00606                             0972
*            END;                                                  0973
*          ELSE                                                    0974
*            DO;                                                   0974
         B     @RC00969                                            0974
@RF00969 DS    0H                                                  0975
*            CTGFLPTR = ENT44FPT;                                  0975
         L     @04,ENT44FPT                                        0975
         ST    @04,CTGFLPTR                                        0975
*            DARGDBP = CTGFLPT(1);                                 0976
         L     @15,DARGPTR                                         0976
         L     @14,CTGFLPT(,@04)                                   0976
         ST    @14,DARGDBP(,@15)                                   0976
*            DARGILP = CTGFLNG(1);                                 0977
         L     @04,CTGFLNG(,@04)                                   0977
         STH   @04,DARGILP(,@15)                                   0977
*            END;                                                  0978
*        CALL LISTPROC;                                            0979
*                                                                  0979
@RC00969 BAL   @14,LISTPROC                                        0979
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* IF THE CATNAME SUBTITLE IS NOT USED, IDENTIFY THE        */
*        /* CATALOG FOR EACH ENTRY VIA A CATNAME HEADER.     @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  0980
*        IF NOTTLFLG = ON                                          0980
*          THEN                                                    0980
         TM    NOTTLFLG,B'10000000'                                0980
         BNO   @RF00980                                            0980
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST40;                            /*@YL026UE*/
         L     @04,DARGPTR                                         0982
         MVI   DARGSENT(@04),X'28'                                 0982
*            DARGDBP = ADDR(CATNAME);                      /*@YL026UE*/
         LA    @00,CATNAME                                         0983
         ST    @00,DARGDBP(,@04)                                   0983
*            DARGILP = LENGTH(CATNAME);                    /*@YL026UE*/
         MVC   DARGILP(2,@04),@CH00606                             0984
*            CALL LISTPROC;                                /*@YL026UE*/
         BAL   @14,LISTPROC                                        0985
*            END;                                          /*@YL026UE*/
*        /************************************************************/
*        /*                                                          */
*        /* EXIT HERE FROM CDIPROC IF:                       @Y30SSMK*/
*        /*   1) ONLY THE ENTRYNAME SUBSET WAS REQUESTED, AND        */
*        /*   2) A DATA OR INDEX OR PATH ENTRY IS BEING      @Y30SSMK*/
*        /*      PROCESSED RATHER THAN A CLUSTER OR AIX      @Y30SSMK*/
*        /*      SINCE IT REQUIRES ADDITIONAL PROCESSING TO RETRIEVE */
*        /*      THE LIST OF ASSOCIATIONS FOR LOGICAL FORMATTING     */
*        /*      OF ALL ASSOCIATIONS UNDER THE CLUSTER OR    @Y30SSMK*/
*        /*      AIX INFORMATION, OR                         @Y30SSMK*/
*        /*   3) PASSWORD VERIFICATION FAILED FOR THIS ENTRY, IN     */
*        /*      WHICH CASE ONLY THE HEADER FOR THE ENTRY TYPE AND   */
*        /*      NAME WAS TO BE LISTED.                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0987
*        IF ADDR(NAME) > NULLPTR  &                                0987
*          (CATRC=CRCBADPW    HOLDETYP = CTGTDATA                0987
*          HOLDETYP = CTGTINDX    HOLDETYP = CTGTPTH)             0987
*          THEN                                                    0987
@RF00980 L     @04,@PC00001+4                                      0987
         L     @04,FDTPTR+52(,@04)                                 0987
         LTR   @04,@04                                             0987
         BNP   @RF00987                                            0987
         CLC   CATRC(2),@CH01280                                   0987
         BE    @RT00987                                            0987
         CLI   HOLDETYP,C'D'                                       0987
         BE    @RT00987                                            0987
         CLI   HOLDETYP,C'I'                                       0987
         BE    @RT00987                                            0987
         CLI   HOLDETYP,C'R'                                       0987
         BNE   @RF00987                                            0987
@RT00987 DS    0H                                                  0988
*            DO;                                                   0988
*                                                                  0988
*            /********************************************************/
*            /*                                                      */
*            /* IF PASSWORD VERIFICATION FAILED FOR A CLUSTER        */
*            /* OR AIX ENTRY IS BEING PROCESSED, SET TO      @Y30SSMK*/
*            /* ZERO THE NUMBER OF ASSOCIATIONS TO BE PROCESSED      */
*            /* LATER BY THE ROUTING ROUTINE                 @Y30SSMK*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0989
*            IF HOLDETYP = CTGTCL    HOLDETYP = CTGTAIX           0989
*              THEN                                                0989
         CLI   HOLDETYP,C'C'                                       0989
         BE    @RT00989                                            0989
         CLI   HOLDETYP,C'G'                                       0989
         BNE   @RF00989                                            0989
@RT00989 DS    0H                                                  0990
*                ASSOC# = 0;                                       0990
         SLR   @04,@04                                             0990
         STH   @04,ASSOC#                                          0990
*            RETURN CODE (0);                                      0991
@RF00989 SLR   @15,@15                                             0991
         L     @13,4(,@13)                                         0991
         L     @14,12(,@13)                                        0991
         LM    @00,@12,20(@13)                                     0991
         BR    @14                                                 0991
*            END;                                                  0992
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* PROCEED TO PROCESS THE OWNER, DATE, RELEASE, AND @Y30SSMK*/
*        /* CATALOG RECOVERY FIELDS FOR EITHER THE CLUSTER   @Y30SSMK*/
*        /* OR AIX OR DATA OR INDEX OR PATH ENTRY.           @Y30SSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  0993
*        IF ADDR(NAME) = NULLPTR                                   0993
*          THEN                                                    0993
*                                                                  0993
@RF00987 L     @04,@PC00001+4                                      0993
         L     @04,FDTPTR+52(,@04)                                 0993
         LTR   @04,@04                                             0993
         BNZ   @RF00993                                            0993
*            /********************************************************/
*            /*                                              @Y30LSMK*/
*            /* BUILD THE TEXT PROCESSOR DARGLIST.           @Y30LSMK*/
*            /* NOTE - ANY FIELDS RETURNED FROM THE CATALOG PADDED   */
*            /* WITH HEX FF'S REQUIRE SPECIAL HANDLING TO SETUP A    */
*            /* PRINTABLE FORMAT.  HENCE ARITHMETIC FIELDS ARE       */
*            /* OVERLAYED WITH ZEROES AND CHARACTER FIELDS ARE       */
*            /* OVERRIDDEN WITH THE 'NULL' STATIC TEXT ENTRY.        */
*            /*                                              @Y30LSMK*/
*            /********************************************************/
*                                                                  0994
*            DO;                                           /*@Y30LSMK*/
*              DARGSENT = LCST13;      /* OWNER AND DATE HEADER      */
         L     @04,DARGPTR                                         0995
         MVI   DARGSENT(@04),X'0D'                                 0995
*              DARGCNT = DRGCNT7;                          /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00498                             0996
*              CTGFLPTR = DSIDFPT;                         /*@Y30LSMK*/
         L     @04,DSIDFPT                                         0997
         ST    @04,CTGFLPTR                                        0997
*              IF DSID = HEXFF                                     0998
*                THEN                                              0998
         L     @04,CTGFLPT(,@04)                                   0998
         CLC   DSID(8,@04),HEXFF                                   0998
         BNE   @RF00998                                            0998
*                  DSID = NULLNM;                          /*@Y30LSMK*/
         L     @15,TEXTPTR                                         0999
         MVC   DSID(8,@04),NULLNM(@15)                             0999
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/
@RF00998 L     @04,DARGPTR                                         1000
         MVC   DARGINS(2,@04),@CH00457                             1000
*              DARGINL(1) = CTGFLNG(1);                    /*@Y30LSMK*/
         L     @15,CTGFLPTR                                        1001
         L     @14,CTGFLNG(,@15)                                   1001
         STH   @14,DARGINL(,@04)                                   1001
*              DARGDTM(1) = CTGFLPT(1);                    /*@Y30LSMK*/
*                                                                  1002
         L     @00,CTGFLPT(,@15)                                   1002
         ST    @00,DARGDTM(,@04)                                   1002
*              CTGFLPTR = CRDTFPT;                         /*@Y30LSMK*/
         L     @04,CRDTFPT                                         1003
         ST    @04,CTGFLPTR                                        1003
*              IF CRDT = ARITH4FF                                  1004
*                THEN                                              1004
         L     @04,CTGFLPT(,@04)                                   1004
         CLC   CRDT(3,@04),ARITH4FF                                1004
         BNE   @RF01004                                            1004
*                  CRDT = ZEROAREA;                        /*@Y30LSMK*/
         MVC   CRDT(3,@04),ZEROAREA                                1005
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/
@RF01004 L     @04,DARGPTR                                         1006
         MVC   DARGINS+8(2,@04),@CH00649                           1006
*              DARGINL(2) = CTGFLNG(1);                    /*@Y30LSMK*/
         L     @15,CTGFLPTR                                        1007
         L     @14,CTGFLNG(,@15)                                   1007
         STH   @14,DARGINL+8(,@04)                                 1007
*              DARGDTM(2) = CTGFLPT(1);                    /*@Y30LSMK*/
*                                                                  1008
         L     @00,CTGFLPT(,@15)                                   1008
         ST    @00,DARGDTM+8(,@04)                                 1008
*              CTGFLPTR = EXDTFPT;                         /*@Y30LSMK*/
         L     @04,EXDTFPT                                         1009
         ST    @04,CTGFLPTR                                        1009
*              IF EXDT = ARITH4FF                                  1010
*                THEN                                              1010
         L     @04,CTGFLPT(,@04)                                   1010
         CLC   EXDT(3,@04),ARITH4FF                                1010
         BNE   @RF01010                                            1010
*                  EXDT = ZEROAREA;                        /*@Y30LSMK*/
         MVC   EXDT(3,@04),ZEROAREA                                1011
*              DARGINS(3) = DRGINS30;                      /*@Y30SSMK*/
@RF01010 L     @04,DARGPTR                                         1012
         MVC   DARGINS+16(2,@04),@CH01231                          1012
*              DARGINL(3) = CTGFLNG(1);                    /*@Y30LSMK*/
         L     @15,CTGFLPTR                                        1013
         L     @14,CTGFLNG(,@15)                                   1013
         STH   @14,DARGINL+16(,@04)                                1013
*              DARGDTM(3) = CTGFLPT(1);                    /*@Y30LSMK*/
*                                                                  1014
         L     @00,CTGFLPT(,@15)                                   1014
         ST    @00,DARGDTM+16(,@04)                                1014
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/
         L     @00,RELFPT                                          1015
         ST    @00,CTGFLPTR                                        1015
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/
         LR    @15,@00                                             1016
         L     @15,CTGFLPT(,@15)                                   1016
         ST    @15,DARGDBP(,@04)                                   1016
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/
         LR    @14,@00                                             1017
         L     @14,CTGFLNG(,@14)                                   1017
         STH   @14,DARGILP(,@04)                                   1017
*              DSREL = DSREL + 1;      /*CALUCATE REL NO.    @Y30SSMK*/
         LA    @14,1                                               1018
         SLR   @00,@00                                             1018
         IC    @00,DSREL(,@15)                                     1018
         ALR   @14,@00                                             1018
         STC   @14,DSREL(,@15)                                     1018
*              IF DSSER = ZEROAREA                                 1019
*                THEN                                              1019
         CLC   DSSER(6,@15),ZEROAREA                               1019
         BNE   @RF01019                                            1019
*                  DARGSENT = LCST13;  /*EXCLUDE CRA INFO    @Y30SSMK*/
         MVI   DARGSENT(@04),X'0D'                                 1020
*                ELSE                                              1021
*                  DARGSENT = LCST50;  /*INCLUDE CRA INFO    @Y30SSMK*/
         B     @RC01019                                            1021
@RF01019 L     @04,DARGPTR                                         1021
         MVI   DARGSENT(@04),X'32'                                 1021
*              CALL LISTPROC;                              /*@Y30LSMK*/
@RC01019 BAL   @14,LISTPROC                                        1022
*            END;                                          /*@Y30LSMK*/
*        /************************************************************/
*        /*                                                  @Y30LSMK*/
*        /* EXIT HERE FROM CDIPROC IF                        @Y30SSMK*/
*        /*   1) ONLY THE HISTORY SUBSET WAS REQUESTED, AND  @Y30LSMK*/
*        /*   2) A DATA OR INDEX OR PATH ENTRY IS BEING PROCESSED    */
*        /*      RATHER THAN A CL OR AIX SINCE IT REQUIRES ADDITIONAL*/
*        /*      PROCESSING TO RETRIEVE THE LIST OF ASSOCIATIONS     */
*        /*      FOR LOGICAL FORMATTING OF ALL ASSOCIATIONS UNDER    */
*        /*      THE CLUSTER OR AIX INFORMATION.             @Y30SSMK*/
*        /*                                                  @Y30LSMK*/
*        /************************************************************/
*                                                                  1024
*        IF ADDR(HIST) > NULLPTR  &  (HOLDETYP = CTGTDATA         1024
*          HOLDETYP = CTGTINDX    HOLDETYP = CTGTPTH)             1024
*          THEN                                                    1024
@RF00993 L     @04,@PC00001+4                                      1024
         L     @04,FDTPTR+104(,@04)                                1024
         LTR   @04,@04                                             1024
         BNP   @RF01024                                            1024
         CLI   HOLDETYP,C'D'                                       1024
         BE    @RT01024                                            1024
         CLI   HOLDETYP,C'I'                                       1024
         BE    @RT01024                                            1024
         CLI   HOLDETYP,C'R'                                       1024
         BNE   @RF01024                                            1024
@RT01024 DS    0H                                                  1025
*            RETURN CODE (0);                              /*@Y30LSMK*/
         SLR   @15,@15                                             1025
         L     @13,4(,@13)                                         1025
         L     @14,12(,@13)                                        1025
         LM    @00,@12,20(@13)                                     1025
         BR    @14                                                 1025
*        /************************************************************/
*        /*                                                  @X04SVMK*/
*        /* EXIT HERE IF A PATH IS BEING PROCESSED AND ALL   @X04SVMK*/
*        /* CATALOG DATA HAS NOT BEEN SPECIFIED              @X04SVMK*/
*        /*                                                  @X04SVMK*/
*        /************************************************************/
*                                                                  1026
*        IF ADDR(FALL) = NULLPTR  &  HOLDETYP = CTGTPTH            1026
*          THEN                                                    1026
@RF01024 SLR   @04,@04                                             1026
         L     @15,@PC00001+4                                      1026
         C     @04,FDTPTR+56(,@15)                                 1026
         BNE   @RF01026                                            1026
         CLI   HOLDETYP,C'R'                                       1026
         BNE   @RF01026                                            1026
*            RETURN CODE(0);                               /*@X04SVMK*/
         LR    @15,@04                                             1027
         L     @13,4(,@13)                                         1027
         L     @14,12(,@13)                                        1027
         LM    @00,@12,20(@13)                                     1027
         BR    @14                                                 1027
*        /************************************************************/
*        /*                                                          */
*        /* IF THIS IS A VOLUME SUBSET REQUEST AND THE ENTRY IS A    */
*        /* DATA OR INDEX TYPE, LIST THE VOLUME SERIAL NUMBER AND    */
*        /* DEVICE TYPE FIELDS.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1028
*        IF ADDR(VOL) > NULLPTR  &                                 1028
*          (HOLDETYP = CTGTDATA    HOLDETYP = CTGTINDX)           1028
*          THEN                                                    1028
*                                                                  1028
@RF01026 L     @04,@PC00001+4                                      1028
         L     @04,FDTPTR+60(,@04)                                 1028
         LTR   @04,@04                                             1028
         BNP   @RF01028                                            1028
         CLI   HOLDETYP,C'D'                                       1028
         BE    @RT01028                                            1028
         CLI   HOLDETYP,C'I'                                       1028
         BNE   @RF01028                                            1028
@RT01028 DS    0H                                                  1029
*            /********************************************************/
*            /*                                                      */
*            /* SET THE FPL POINTER TO THE FPL REQUESTING VOLUME     */
*            /* INFORMATION.  INITIALIZE THE SERIAL NO. HOLD AREA    */
*            /* TO HEX FF'S SINCE THIS VALUE DETERMINES THE LISTING  */
*            /* OF UNIQUE VOLUME DATA.  THEN LIST THE VOLUME HEADER  */
*            /* USING THE APPROPRIATE PRE-FORMATTED STATIC TEXT      */
*            /* DESCRIPTOR.                                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1029
*            DO;                                                   1029
*              CTGFLPTR = AUVOLFPT;                                1030
         L     @04,AUVOLFPT                                        1030
         ST    @04,CTGFLPTR                                        1030
*              OLDVOL# = HEXFF;                                    1031
         MVC   OLDVOL#(6),HEXFF                                    1031
*              DARGSENT = LCST34;                                  1032
         L     @04,DARGPTR                                         1032
         MVI   DARGSENT(@04),X'22'                                 1032
*              CALL LISTPROC;                                      1033
*                                                                  1033
         BAL   @14,LISTPROC                                        1033
*              /******************************************************/
*              /*                                                    */
*              /* LIST THE CATALOG DATA, LOOPING THROUGH THE         */
*              /* REPETITIVE FIELDS.  ONE PASS IS DETERMINED BY THE  */
*              /* THE TOTAL LENGTH OF THE INDIVIDUAL FIXED LENGTH    */
*              /* FIELDS RETRIEVED BY THIS FPL REQUEST.              */
*              /*                                                    */
*              /******************************************************/
*                                                                  1034
*              DO WHILE CTGFLNG(1) >= LENGTH(AUDATA);              1034
         B     @DE01034                                            1034
@DL01034 DS    0H                                                  1035
*                IF AUSER ^= OLDVOL#                               1035
*                  THEN                                            1035
*                                                                  1035
         L     @04,CTGFLPTR                                        1035
         L     @04,CTGFLPT(,@04)                                   1035
         CLC   AUSER(6,@04),OLDVOL#                                1035
         BE    @RF01035                                            1035
*                      /**********************************************/
*                      /*                                            */
*                      /* LIST EACH UNIQUE VOLUME SERIAL NUMBER AND  */
*                      /* ITS CORRESPONDING DEVICE TYPE              */
*                      /*                                            */
*                      /**********************************************/
*                                                                  1036
*                      DO;                                         1036
*                        OLDVOL# = AUSER;                          1037
         MVC   OLDVOL#(6),AUSER(@04)                               1037
*                        DARGSENT = LCST12;                /*@ZA05939*/
         L     @15,DARGPTR                                         1038
         MVI   DARGSENT(@15),X'0C'                                 1038
*                        DARGCNT = DRGCNT2;                /*@Y30SSMK*/
         MVC   DARGCNT(2,@15),@CH00161                             1039
*                        DARGINS(1) = DRGINS10;            /*@Y30SSMK*/
         MVC   DARGINS(2,@15),@CH00457                             1040
*                        DARGINL(1) = LENGTH(AUSER);               1041
         MVC   DARGINL(2,@15),@CH00164                             1041
*                        DARGDTM(1) = ADDR(AUSER);                 1042
         LA    @14,AUSER(,@04)                                     1042
         ST    @14,DARGDTM(,@15)                                   1042
*                        DARGINS(2) = DRGINS20;            /*@Y30SSMK*/
         MVC   DARGINS+8(2,@15),@CH00649                           1043
*                        DARGINL(2) = LENGTH(AUDEV);               1044
         MVC   DARGINL+8(2,@15),@CH00050                           1044
*                        DARGDTM(2) = ADDR(AUDEV);                 1045
         LA    @04,AUDEV(,@04)                                     1045
         ST    @04,DARGDTM+8(,@15)                                 1045
*                        CALL LISTPROC;                            1046
         BAL   @14,LISTPROC                                        1046
*                      END;                                        1047
*                                                                  1047
*                /****************************************************/
*                /*                                                  */
*                /* UPDATE THE FPL POINTER TO THE NEXT OCCURRENCE AND*/
*                /* ACCORDINGLY DECREMENT THE TOTAL LENGTH BY THAT   */
*                /* JUST PROCESSED.                                  */
*                /*                                                  */
*                /****************************************************/
*                                                                  1048
*                CTGFLNG(1) = CTGFLNG(1) - LENGTH(AUDATA);         1048
@RF01035 L     @04,CTGFLPTR                                        1048
         LA    @15,15                                              1048
         L     @14,CTGFLNG(,@04)                                   1048
         SLR   @14,@15                                             1048
         ST    @14,CTGFLNG(,@04)                                   1048
*                CTGFLPT(1) = CTGFLPT(1) + LENGTH(AUDATA);         1049
         AL    @15,CTGFLPT(,@04)                                   1049
         ST    @15,CTGFLPT(,@04)                                   1049
*              END;                                                1050
*                                                                  1050
@DE01034 L     @04,CTGFLPTR                                        1050
         L     @04,CTGFLNG(,@04)                                   1050
         C     @04,@CF00235                                        1050
         BNL   @DL01034                                            1050
*              /******************************************************/
*              /*                                                    */
*              /* EXIT WHEN THE PROCESSING OF ENTRY FIELDS FOR A     */
*              /* VOLUME SUBSET REQUEST IS COMPLETED.                */
*              /*                                                    */
*              /******************************************************/
*                                                                  1051
*              RETURN CODE (0);                                    1051
         SLR   @15,@15                                             1051
         L     @13,4(,@13)                                         1051
         L     @14,12(,@13)                                        1051
         LM    @00,@12,20(@13)                                     1051
         BR    @14                                                 1051
*            END;                                                  1052
*        /************************************************************/
*        /*                                                          */
*        /* WHEN ALL ENTRY DATA IS REQUESTED, PROCEED TO PROCESS THE */
*        /* CATALOG PASSWORD FIELDS FOR EITHER THE CLUSTER   @X04SVMK*/
*        /* OR AIX OR DATA OR INDEX OR PATH ENTRY.           @X04SVMK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1053
*        IF ADDR(FALL) > NULLPTR                                   1053
*          THEN                                                    1053
*                                                                  1053
@RF01028 L     @04,@PC00001+4                                      1053
         L     @04,FDTPTR+56(,@04)                                 1053
         LTR   @04,@04                                             1053
         BNP   @RF01053                                            1053
*            /********************************************************/
*            /*                                                      */
*            /* BUILD THE DARGLIST TO PRINT THE SECURITY STATUS--    */
*            /*   THIS IS OUTPUT IN 2 PARTS, PASSWORD PROTECTION     */
*            /*   INFORMATION AND THE RACF INDICATOR.  THE RACF      */
*            /*   INDICATOR CAN ALWAYS BE RETRIEVED AND OUTPUT.      */
*            /*                                                      */
*            /*    PASSWORD PROTECTION STATUS WILL BE ONE OF THE     */
*            /*      FOLLOWING.                                      */
*            /*   1) NULL IF SECURITY WAS NEVER INITIALIZED          */
*            /*           (POINTER AND LENGTH BOTH ZERO), OR         */
*            /*           IF SECURITY WAS NULLIFIED VIA AN ALTER     */
*            /*           (MASTER PSWD PADDED WITH HEX FF'S).        */
*            /*   2) SUPPRESSED WHEN THE FPL POINTER IS ZERO BUT     */
*            /*           THE LENGTH IS NOT.                         */
*            /*   3) EXISTS IF THE FPL PTR AND LENGTH ARE NOT ZERO   */
*            /*           AND THE MASTER PASSWORD IS NOT HEX FF'S.   */
*            /*                                                      */
*            /********************************************************/
*                                                                  1054
*ALLONLY:    DO;                                           /*@Y30LSMK*/
ALLONLY  DS    0H                                                  1055
*              CTGFLPTR = RACFPT;     /*  SECFLAGS           @Z40RSSA*/
         L     @04,RACFPT                                          1055
         ST    @04,CTGFLPTR                                        1055
*              DARGCNT = DRGCNT1;                          /*@Z40RSSA*/
         L     @15,DARGPTR                                         1056
         MVC   DARGCNT(2,@15),@CH00045                             1056
*              DARGINS(1) = DRGINS10;                      /*@Z40RSSA*/
         LA    @14,10                                              1057
         STH   @14,DARGINS(,@15)                                   1057
*              DARGINL(1) = ABBREVLN;                      /*@Z40RSRC*/
         STH   @14,DARGINL(,@15)                                   1058
*              IF RACIND = ON THEN                         /*@Z40RSSA*/
         L     @04,CTGFLPT(,@04)                                   1059
         TM    RACIND(@04),B'10000000'                             1059
         BNO   @RF01059                                            1059
*                DARGDTM(1) = ADDR(YESNM);    /* RACF INDICATOR ON   */
         L     @04,TEXTPTR                                         1060
         LA    @04,YESNM(,@04)                                     1060
         ST    @04,DARGDTM(,@15)                                   1060
*              ELSE                                        /*@Z40RSSA*/
*                DARGDTM(1) = ADDR(NONM);     /* RACF INDICATOR ON   */
         B     @RC01059                                            1061
@RF01059 L     @04,TEXTPTR                                         1061
         LA    @04,NONM(,@04)                                      1061
         L     @15,DARGPTR                                         1061
         ST    @04,DARGDTM(,@15)                                   1061
*              CTGFLPTR = SECURFPT;                                1062
@RC01059 L     @04,SECURFPT                                        1062
         ST    @04,CTGFLPTR                                        1062
*              IF CTGFLPT(1) = 0    MPW = HEXFF                   1063
*                THEN        /* NO PASSWORD DATA                     */
         L     @04,CTGFLPT(,@04)                                   1063
         LTR   @04,@04                                             1063
         BZ    @RT01063                                            1063
         CLC   MPW(8,@04),HEXFF                                    1063
         BNE   @RF01063                                            1063
@RT01063 DS    0H                                                  1064
*                  DO;                                             1064
*                    DARGSENT = LCST14;                    /*@ZA05939*/
         L     @04,DARGPTR                                         1065
         MVI   DARGSENT(@04),X'0E'                                 1065
*                    DARGCNT = DRGCNT2;                    /*@Z40RSSA*/
         MVC   DARGCNT(2,@04),@CH00161                             1066
*                    DARGINS(2) = DRGINS20;                /*@Z40RSSA*/
         MVC   DARGINS+8(2,@04),@CH00649                           1067
*                    DARGINL(2) = ABBREVLN;                /*@Z40RSSA*/
         MVC   DARGINL+8(2,@04),@CH00457                           1068
*                    IF CTGFLNG(1) > 0  &  CTGFLPT(1) = 0          1069
*                      THEN           /*SECURITY DATA WAS SUPPRESSED */
         SLR   @15,@15                                             1069
         L     @14,CTGFLPTR                                        1069
         C     @15,CTGFLNG(,@14)                                   1069
         BNL   @RF01069                                            1069
         C     @15,CTGFLPT(,@14)                                   1069
         BNE   @RF01069                                            1069
*                        DARGDTM(2) = ADDR(SUPPNM);        /*@Z40RSSA*/
         L     @15,TEXTPTR                                         1070
         LA    @00,SUPPNM(,@15)                                    1070
         ST    @00,DARGDTM+8(,@04)                                 1070
*                      ELSE           /*SECURITY NOT INITIALIZED     */
*                        DARGDTM(2) = ADDR(NULLNM);        /*@Z40RSSA*/
*                                                                  1071
         B     @RC01069                                            1071
@RF01069 L     @04,TEXTPTR                                         1071
         LA    @04,NULLNM(,@04)                                    1071
         L     @15,DARGPTR                                         1071
         ST    @04,DARGDTM+8(,@15)                                 1071
*                    CALL LISTPROC;                        /*@ZA05939*/
@RC01069 BAL   @14,LISTPROC                                        1072
*                    END;                                          1073
*              /******************************************************/
*              /*                                                    */
*              /* IF SECURITY DATA EXISTS AND HAS NOT BEEN NULLIFIED */
*              /* BUILD THE DARGLIST TO PRINT IT.                    */
*              /* TO INSURE PRINTABILITY OVERRIDE ANY NON-INITIALIZED*/
*              /* ARITHMETIC FIELDS WITH ZEROES AND ANY NON-INIT     */
*              /* CHARACTER FIELDS WITH THE 'NULL' STATIC TEXT ENTRY.*/
*              /*                                                    */
*              /******************************************************/
*                                                                  1074
*                ELSE                                              1074
*                  DO;                                             1074
         B     @RC01063                                            1074
@RF01063 DS    0H                                                  1075
*                    DARGSENT = LCST15;                            1075
         L     @04,DARGPTR                                         1075
         MVI   DARGSENT(@04),X'0F'                                 1075
*                    DARGDBP = CTGFLPT(1);                         1076
         L     @15,CTGFLPTR                                        1076
         L     @14,CTGFLPT(,@15)                                   1076
         ST    @14,DARGDBP(,@04)                                   1076
*                    DARGILP = CTGFLNG(1);                         1077
         L     @15,CTGFLNG(,@15)                                   1077
         STH   @15,DARGILP(,@04)                                   1077
*                    IF ATMP = ARITH4FF                            1078
*                      THEN                                        1078
         CLC   ATMP(2,@14),ARITH4FF                                1078
         BNE   @RF01078                                            1078
*                        ATMP = ZEROAREA;                          1079
         MVC   ATMP(2,@14),ZEROAREA                                1079
*                    IF MPW = HEXFF                                1080
*                      THEN                                        1080
@RF01078 L     @04,CTGFLPTR                                        1080
         L     @04,CTGFLPT(,@04)                                   1080
         CLC   MPW(8,@04),HEXFF                                    1080
         BNE   @RF01080                                            1080
*                        MPW = NULLNM;                             1081
         L     @15,TEXTPTR                                         1081
         MVC   MPW(8,@04),NULLNM(@15)                              1081
*                    IF CPW = HEXFF                                1082
*                      THEN                                        1082
@RF01080 L     @04,CTGFLPTR                                        1082
         L     @04,CTGFLPT(,@04)                                   1082
         CLC   CPW(8,@04),HEXFF                                    1082
         BNE   @RF01082                                            1082
*                        CPW = NULLNM;                             1083
         L     @15,TEXTPTR                                         1083
         MVC   CPW(8,@04),NULLNM(@15)                              1083
*                    IF UPW = HEXFF                                1084
*                      THEN                                        1084
@RF01082 L     @04,CTGFLPTR                                        1084
         L     @04,CTGFLPT(,@04)                                   1084
         CLC   UPW(8,@04),HEXFF                                    1084
         BNE   @RF01084                                            1084
*                        UPW = NULLNM;                             1085
         L     @15,TEXTPTR                                         1085
         MVC   UPW(8,@04),NULLNM(@15)                              1085
*                    IF RPW = HEXFF                                1086
*                      THEN                                        1086
@RF01084 L     @04,CTGFLPTR                                        1086
         L     @04,CTGFLPT(,@04)                                   1086
         CLC   RPW(8,@04),HEXFF                                    1086
         BNE   @RF01086                                            1086
*                        RPW = NULLNM;                             1087
         L     @15,TEXTPTR                                         1087
         MVC   RPW(8,@04),NULLNM(@15)                              1087
*                    IF PRMT = HEXFF                               1088
*                      THEN                                        1088
@RF01086 L     @04,CTGFLPTR                                        1088
         L     @04,CTGFLPT(,@04)                                   1088
         CLC   PRMT(8,@04),HEXFF                                   1088
         BNE   @RF01088                                            1088
*                        PRMT = NULLNM;                            1089
         L     @15,TEXTPTR                                         1089
         MVC   PRMT(8,@04),NULLNM(@15)                             1089
*                    IF SMOD = HEXFF                               1090
*                      THEN                                        1090
@RF01088 L     @04,CTGFLPTR                                        1090
         L     @04,CTGFLPT(,@04)                                   1090
         CLC   SMOD(8,@04),HEXFF                                   1090
         BNE   @RF01090                                            1090
*                        SMOD = NULLNM;                            1091
         L     @15,TEXTPTR                                         1091
         MVC   SMOD(8,@04),NULLNM(@15)                             1091
*                    CALL LISTPROC;                                1092
@RF01090 BAL   @14,LISTPROC                                        1092
*                    /************************************************/
*                    /*                                              */
*                    /* IF A USER-SECURITY-AUTHORIZATION-RECORD      */
*                    /* EXISTS, BUILD THE DARGLIST TO PRINT IT.      */
*                    /*                                              */
*                    /************************************************/
*                                                                  1093
*                    DARGSENT = LCST16;                            1093
         L     @04,DARGPTR                                         1093
         MVI   DARGSENT(@04),X'10'                                 1093
*                    IF SRECLEN > 0                                1094
*                      THEN                                        1094
         L     @15,CTGFLPTR                                        1094
         L     @15,CTGFLPT(,@15)                                   1094
         SLR   @14,@14                                             1094
         ICM   @14,3,SRECLEN(@15)                                  1094
         LTR   @14,@14                                             1094
         BNP   @RF01094                                            1094
*                        DO;                                       1095
*                          DARGCNT = DRGCNT1;              /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00045                             1096
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/
         MVC   DARGINS(2,@04),@CH00457                             1097
*                          DARGDTM(1) = ADDR(SREC);                1098
         LA    @15,SREC(,@15)                                      1098
         ST    @15,DARGDTM(,@04)                                   1098
*                          DARGINL(1) = SRECLEN;                   1099
         STH   @14,DARGINL(,@04)                                   1099
*                        END;                                      1100
*                    CALL LISTPROC;                                1101
@RF01094 BAL   @14,LISTPROC                                        1101
*                  END;                                            1102
*            END ALLONLY;                                          1103
@RC01063 DS    0H                                                  1104
*        /************************************************************/
*        /*                                                          */
*        /* IF THE CATALOG FIELDS FOR THIS ENTRY WERE NOT SUPPRESSED */
*        /* BECAUSE OF PASSWORD VERIFICATION FAILURE AND IF THE      */
*        /* LISTC REQUEST IS FOR ALL CATALOG DATA OR ELSE THE TYPE   */
*        /* BEING PROCESSED IS A CLUSTER OR AIX RETRIEVE     @X04SVMK*/
*        /* THE LIST OF ASSOCIATED TYPES AND C.I.NOS. FROM   @X04SVMK*/
*        /* THE WORKAREA. AND BECAUSE THE WORKAREA WILL SUBSEQUENTLY */
*        /* BE REUSED, DESTROYING THE LIST CREATE A SAVEAREA COPY    */
*        /* PROCESSING LATER.                                @X04SVMK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1104
*                                                                  1104
*        IF (ADDR(FALL) > NULLPTR    HOLDETYP = CTGTCL           1104
*          HOLDETYP = CTGTAIX)                                     1104
*          & CATRC ^= CRCBADPW                                     1104
*          THEN                                                    1104
@RF01053 L     @04,@PC00001+4                                      1104
         L     @04,FDTPTR+56(,@04)                                 1104
         LTR   @04,@04                                             1104
         BP    @GL00038                                            1104
         CLI   HOLDETYP,C'C'                                       1104
         BE    @GL00038                                            1104
         CLI   HOLDETYP,C'G'                                       1104
         BNE   @RF01104                                            1104
@GL00038 CLC   CATRC(2),@CH01280                                   1104
         BE    @RF01104                                            1104
*ALLORNM:    DO;                                           /*@YL026UE*/
ALLORNM  DS    0H                                                  1106
*              CALL ANSVPROC;                              /*@YL026UE*/
*                                                                  1106
         BAL   @14,ANSVPROC                                        1106
*              RESPECIFY RTNREG RSTD;                              1107
*              TESTRC = RTNREG;                                    1108
         LR    TESTRC,RTNREG                                       1108
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UE*/
*                                                                  1109
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* RETURN WHEN ANY NON-ZERO RETURN CODE IS    @Y30SSMK*/
*              /* ENCOUNTERED WHILE RETRIEVING THE           @Y30SSMK*/
*              /* ASSOCIATED ENTRIES.  USE THE RETURN CODE   @Y30SSMK*/
*              /* 'SAVRC' WHICH WAS SET IN ANSVPROC.         @ZA05939*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1110
*              IF TESTRC ^= 0                                      1110
*                THEN                                              1110
         LTR   TESTRC,TESTRC                                       1110
         BZ    @RF01110                                            1110
*                  RETURN CODE(SAVRC);                     /*@ZA05939*/
         LH    @15,SAVRC                                           1111
         L     @13,4(,@13)                                         1111
         L     @14,12(,@13)                                        1111
         LM    @00,@12,20(@13)                                     1111
         BR    @14                                                 1111
*        /************************************************************/
*        /*                                                          */
*        /* THE LIST OF ASSOCIATIONS IS NOW RETRIEVED.  EXIT HERE    */
*        /* UNLESS PROCESSING A LISTC REQUEST FOR ALL CATALOG DATA.  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1112
*        IF ADDR(FALL) = NULLPTR                                   1112
*          THEN                                                    1112
@RF01110 SLR   @04,@04                                             1112
         L     @15,@PC00001+4                                      1112
         C     @04,FDTPTR+56(,@15)                                 1112
         BNE   @RF01112                                            1112
*            DO;                                                   1113
*              RETURN CODE (0);                                    1114
         LR    @15,@04                                             1114
         L     @13,4(,@13)                                         1114
         L     @14,12(,@13)                                        1114
         LM    @00,@12,20(@13)                                     1114
         BR    @14                                                 1114
*            END;                                                  1115
*                                                                  1115
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* OUTPUT THE ASSOCIATION HEADER WITH THE ASSOCIATED ENTRY  */
*        /* TYPES AND NAMES FOR A CLUSTER, AIX, DATA, INDEX OR       */
*        /* PATH ENTRY.                                              */
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1116
*        CALL ANLTPROC;                                    /*@YL026UE*/
*                                                                  1116
@RF01112 BAL   @14,ANLTPROC                                        1116
*        RESPECIFY RTNREG RSTD;                                    1117
*        TESTRC = RTNREG;                                          1118
         LR    TESTRC,RTNREG                                       1118
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UE*/
*                                                                  1119
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* RETURN WHEN ANY NON-ZERO RETURN CODE IS          @Y30SSMK*/
*        /* ENCOUNTERED WHILE PROCESSING THE ASSOCIATED      @Y30SSMK*/
*        /* ENTRIES.  USE THE RETURN CODE 'SAVRC' WHICH WAS  @ZA05939*/
*        /* SET IN ANLTPROC.                                 @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1120
*        IF TESTRC ^= 0                                            1120
*          THEN                                                    1120
         LTR   TESTRC,TESTRC                                       1120
         BZ    @RF01120                                            1120
*            RETURN CODE(SAVRC);                           /*@ZA05939*/
         LH    @15,SAVRC                                           1121
         L     @13,4(,@13)                                         1121
         L     @14,12(,@13)                                        1121
         LM    @00,@12,20(@13)                                     1121
         BR    @14                                                 1121
*        /************************************************************/
*        /*                                                          */
*        /* EXIT HERE IF A CLUSTER ENTRY IS BEING PROCESSED, FOR ALL */
*        /* CLUSTER FIELDS HAVE BEEN LISTED.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1122
*        IF HOLDETYP = CTGTCL                                      1122
*          THEN                                                    1122
@RF01120 CLI   HOLDETYP,C'C'                                       1122
         BNE   @RF01122                                            1122
*            DO;                                                   1123
*              RETURN CODE(0);                                     1124
         SLR   @15,@15                                             1124
         L     @13,4(,@13)                                         1124
         L     @14,12(,@13)                                        1124
         LM    @00,@12,20(@13)                                     1124
         BR    @14                                                 1124
*            END;                                                  1125
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* BUILD THE DARGLIST TO PRINT THE AIX AND PATH     @Y30SSMK*/
*        /* ATTRIBUTES.                                      @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1126
*        IF HOLDETYP = CTGTAIX    HOLDETYP = CTGTPTH              1126
*          THEN                                                    1126
@RF01122 CLI   HOLDETYP,C'G'                                       1126
         BE    @RT01126                                            1126
         CLI   HOLDETYP,C'R'                                       1126
         BNE   @RF01126                                            1126
@RT01126 DS    0H                                                  1127
*            DO;                                           /*@Y30SSMK*/
*              CTGFLPTR = RGATRFPT;                        /*@Y30SSMK*/
         L     @04,RGATRFPT                                        1128
         ST    @04,CTGFLPTR                                        1128
*              DARGSENT = LCST51;                          /*@Y30SSMK*/
         L     @15,DARGPTR                                         1129
         MVI   DARGSENT(@15),X'33'                                 1129
*              DARGCNT = DRGCNT1;                          /*@Y30SSMK*/
         MVC   DARGCNT(2,@15),@CH00045                             1130
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/
         LA    @14,10                                              1131
         STH   @14,DARGINS(,@15)                                   1131
*              DARGINL(1) = ABBREVLN;                      /*@Y30SSMK*/
         STH   @14,DARGINL(,@15)                                   1132
*              IF HOLDETYP = CTGTAIX                               1133
*                THEN                                              1133
*                                                                  1133
         CLI   HOLDETYP,C'G'                                       1133
         BNE   @RF01133                                            1133
*                  /**************************************************/
*                  /*                                        @Y30SSMK*/
*                  /* CHECK FOR UPGRADE/NOUPGRADE            @Y30SSMK*/
*                  /* ATTRIBUTES FOR AN AIX ENTRY.           @Y30SSMK*/
*                  /*                                        @Y30SSMK*/
*                  /**************************************************/
*                                                                  1134
*                  IF RGUPG = ON                                   1134
*                    THEN                                          1134
         L     @04,CTGFLPT(,@04)                                   1134
         TM    RGUPG(@04),B'10000000'                              1134
         BNO   @RF01134                                            1134
*                      DARGDTM(1) = ADDR(UPGNM);           /*@Y30SSMK*/
         L     @04,TEXTPTR                                         1135
         LA    @04,UPGNM(,@04)                                     1135
         ST    @04,DARGDTM(,@15)                                   1135
*                    ELSE                                          1136
*                      DARGDTM(1) = ADDR(NUPGNM);          /*@Y30SSMK*/
         B     @RC01134                                            1136
@RF01134 L     @04,TEXTPTR                                         1136
         LA    @04,NUPGNM(,@04)                                    1136
         L     @15,DARGPTR                                         1136
         ST    @04,DARGDTM(,@15)                                   1136
*                ELSE                                              1137
*                                                                  1137
*                  /**************************************************/
*                  /*                                        @Y30SSMK*/
*                  /* CHECK FOR UPDATE/NOUPDATE              @Y30SSMK*/
*                  /* ATTRIBUTES FOR AN PATH ENTRY.          @Y30SSMK*/
*                  /*                                        @Y30SSMK*/
*                  /**************************************************/
*                                                                  1137
*                  IF RGUPD = ON                                   1137
*                    THEN                                          1137
         B     @RC01133                                            1137
@RF01133 L     @04,CTGFLPTR                                        1137
         L     @04,CTGFLPT(,@04)                                   1137
         TM    RGUPD(@04),B'10000000'                              1137
         BNO   @RF01137                                            1137
*                      DARGDTM(1) = ADDR(UPDNM);           /*@Y30SSMK*/
         L     @04,TEXTPTR                                         1138
         LA    @04,UPDNM(,@04)                                     1138
         L     @15,DARGPTR                                         1138
         ST    @04,DARGDTM(,@15)                                   1138
*                    ELSE                                          1139
*                      DARGDTM(1) = ADDR(NUPDNM);          /*@Y30SSMK*/
         B     @RC01137                                            1139
@RF01137 L     @04,TEXTPTR                                         1139
         LA    @04,NUPDNM(,@04)                                    1139
         L     @15,DARGPTR                                         1139
         ST    @04,DARGDTM(,@15)                                   1139
*              CALL LISTPROC;                              /*@Y30SSMK*/
*                                                                  1140
@RC01137 DS    0H                                                  1140
@RC01133 BAL   @14,LISTPROC                                        1140
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* EXIT HERE SINCE ALL THE AIX OR PATH FIELDS @Y30SSMK*/
*              /* HAVE BEEN LISTED.                          @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1141
*              RETURN CODE(0);                             /*@Y30SSMK*/
         SLR   @15,@15                                             1141
         L     @13,4(,@13)                                         1141
         L     @14,12(,@13)                                        1141
         LM    @00,@12,20(@13)                                     1141
         BR    @14                                                 1141
*            END;                                          /*@Y30SSMK*/
*        /************************************************************/
*        /*                                                          */
*        /* PRINT THE DATASET SIZE ATTRIBUTES FOR A DATA OR INDEX    */
*        /* ENTRY.  INITIALIZE THE POINTER TO THE CONTROL BLOCK,     */
*        /* CATALOG AMDSB, CONTAINING SOME OF THE ATTRIBUTES.        */
*        /* DETERMINE IF THE FPL REQUESTING THIS CONTROL BLOCK HAS   */
*        /* A VALID WORKAREA POINTER.                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1143
*        DARGSENT = LCST20;                                        1143
@RF01126 L     @04,DARGPTR                                         1143
         MVI   DARGSENT(@04),X'14'                                 1143
*        RESPECIFY IDAAMDSB BASED(DSBCATPT);                       1144
*        IF DSBFPT->CTGFLPT(1) > NULLPTR                           1145
*          THEN                                                    1145
         L     @04,DSBFPT                                          1145
         L     @04,CTGFLPT(,@04)                                   1145
         LTR   @04,@04                                             1145
         BNP   @RF01145                                            1145
*            DSBCATPT = DSBFPT->CTGFLPT(1);                        1146
         ST    @04,DSBCATPT                                        1146
*          ELSE                                                    1147
*            DSBCATPT = NULLPTR;                                   1147
*                                                                  1147
         B     @RC01145                                            1147
@RF01145 SLR   @04,@04                                             1147
         ST    @04,DSBCATPT                                        1147
*        /************************************************************/
*        /*                                                          */
*        /* IF THE CATALOG AMDSB CONTROL BLOCK WAS RETURNED FROM     */
*        /* THE CATALOG, LIST THE DATASET SIZE ATTRIBUTES FROM IT.   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1148
*        IF DSBCATPT > NULLPTR                                     1148
*          THEN                                                    1148
@RC01145 L     @04,DSBCATPT                                        1148
         SLR   @15,@15                                             1148
         CR    @04,@15                                             1148
         BNH   @RF01148                                            1148
*            DO;                                                   1149
*            DARGSENT = LCST20;                                    1150
         L     @14,DARGPTR                                         1150
         MVI   DARGSENT(@14),X'14'                                 1150
*            CTGFLPTR = DSBFPT;                                    1151
         L     @00,DSBFPT                                          1151
         ST    @00,CTGFLPTR                                        1151
*            DARGDBP = CTGFLPT(1);                                 1152
         LR    @07,@00                                             1152
         L     @07,CTGFLPT(,@07)                                   1152
         ST    @07,DARGDBP(,@14)                                   1152
*            DARGILP = CTGFLNG(1);                                 1153
         LR    @07,@00                                             1153
         L     @00,CTGFLNG(,@07)                                   1153
         STH   @00,DARGILP(,@14)                                   1153
*            IF AMDRKP = ARITH4FF      /* RKP                        */
*              THEN                                                1154
         LH    @14,AMDRKP(,@04)                                    1154
         CL    @14,ARITH4FF                                        1154
         BNE   @RF01154                                            1154
*                AMDRKP = 0;                                       1155
         STH   @15,AMDRKP(,@04)                                    1155
*            IF AMDKEYLN = ARITH4FF    /* KEY LENGTH                 */
*              THEN                                                1156
@RF01154 L     @04,DSBCATPT                                        1156
         LH    @00,AMDKEYLN(,@04)                                  1156
         CL    @00,ARITH4FF                                        1156
         BNE   @RF01156                                            1156
*                AMDKEYLN = 0;                                     1157
         SLR   @00,@00                                             1157
         STH   @00,AMDKEYLN(,@04)                                  1157
*            IF AMDLRECL = ARITH4FF    /* MAX RECORD SIZE            */
*              THEN                                                1158
@RF01156 L     @04,DSBCATPT                                        1158
         CLC   AMDLRECL(4,@04),ARITH4FF                            1158
         BNE   @RF01158                                            1158
*                AMDLRECL = 0;                                     1159
         SLR   @00,@00                                             1159
         ST    @00,AMDLRECL(,@04)                                  1159
*            IF AMDCINV = ARITH4FF     /* C.I. SIZE                  */
*              THEN                                                1160
@RF01158 L     @04,DSBCATPT                                        1160
         CLC   AMDCINV(4,@04),ARITH4FF                             1160
         BNE   @RF01160                                            1160
*                AMDCINV = 0;                                      1161
         SLR   @00,@00                                             1161
         ST    @00,AMDCINV(,@04)                                   1161
*            IF AMDCIPCA = ARITH4FF    /* C.I.'S PER C.A.            */
*              THEN                                                1162
@RF01160 L     @04,DSBCATPT                                        1162
         LH    @00,AMDCIPCA(,@04)                                  1162
         CL    @00,ARITH4FF                                        1162
         BNE   @RF01162                                            1162
*                AMDCIPCA = 0;                                     1163
         SLR   @00,@00                                             1163
         STH   @00,AMDCIPCA(,@04)                                  1163
*            END;                                                  1164
@RF01162 DS    0H                                                  1165
*        DARGCNT = DRGCNT3;                                /*@Y30SSMK*/
*                                                                  1165
@RF01148 L     @04,DARGPTR                                         1165
         MVC   DARGCNT(2,@04),@CH00170                             1165
*        /************************************************************/
*        /*                                                          */
*        /* INCLUDE IN THE DARGLIST THOSE DATASET SIZE ATTRIBUTES    */
*        /* RETURNED IN THE WORKAREA AS INDIVIDUAL FIELDS.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1166
*        CTGFLPTR = RECLFPT;                                       1166
         L     @00,RECLFPT                                         1166
         ST    @00,CTGFLPTR                                        1166
*        DARGINS(1) = DRGINS10;                            /*@Y30SSMK*/
         MVC   DARGINS(2,@04),@CH00457                             1167
*        DARGINL(1) = CTGFLNG(1);                                  1168
         LR    @15,@00                                             1168
         L     @15,CTGFLNG(,@15)                                   1168
         STH   @15,DARGINL(,@04)                                   1168
*        DARGDTM(1) = CTGFLPT(1);                                  1169
         LR    @15,@00                                             1169
         L     @15,CTGFLPT(,@15)                                   1169
         ST    @15,DARGDTM(,@04)                                   1169
*        IF RECL = ARITH4FF            /*AVERAGE LOGICAL REC SIZE    */
*          THEN                                                    1170
         CLC   RECL(4,@15),ARITH4FF                                1170
         BNE   @RF01170                                            1170
*            RECL = ZEROAREA;                                      1171
         MVC   RECL(4,@15),ZEROAREA                                1171
*        CTGFLPTR = BUFFFPT;                                       1172
@RF01170 L     @04,BUFFFPT                                         1172
         ST    @04,CTGFLPTR                                        1172
*        DARGINS(2) = DRGINS20;                            /*@Y30SSMK*/
         L     @15,DARGPTR                                         1173
         MVC   DARGINS+8(2,@15),@CH00649                           1173
*        DARGINL(2) = CTGFLNG(1);                                  1174
         L     @14,CTGFLNG(,@04)                                   1174
         STH   @14,DARGINL+8(,@15)                                 1174
*        DARGDTM(2) = CTGFLPT(1);                                  1175
         L     @04,CTGFLPT(,@04)                                   1175
         ST    @04,DARGDTM+8(,@15)                                 1175
*        IF BUFF = ARITH4FF            /*MINIMUM BUFFER              */
*          THEN                                                    1176
         CLC   BUFF(4,@04),ARITH4FF                                1176
         BNE   @RF01176                                            1176
*            BUFF = ZEROAREA;                                      1177
         MVC   BUFF(4,@04),ZEROAREA                                1177
*        CTGFLPTR = EXITFPT;                               /*@Y30SSMK*/
@RF01176 L     @04,EXITFPT                                         1178
         ST    @04,CTGFLPTR                                        1178
*        DARGINS(3) = DRGINS30;                            /*@Y30SSMK*/
         L     @15,DARGPTR                                         1179
         MVC   DARGINS+16(2,@15),@CH01231                          1179
*        DARGINL(3) = CTGFLNG(1);                          /*@Y30SSMK*/
         L     @14,CTGFLNG(,@04)                                   1180
         STH   @14,DARGINL+16(,@15)                                1180
*        DARGDTM(3) = CTGFLPT(1);                          /*@Y30SSMK*/
         L     @04,CTGFLPT(,@04)                                   1181
         ST    @04,DARGDTM+16(,@15)                                1181
*        IF EXIT = HEXFF               /*EXECPTION EXIT NAME @Y30SSMK*/
*          THEN                                                    1182
         CLC   EXIT(8,@04),HEXFF                                   1182
         BNE   @RF01182                                            1182
*            EXIT = NULLNM;                                /*@Y30SSMK*/
         L     @15,TEXTPTR                                         1183
         MVC   EXIT(8,@04),NULLNM(@15)                             1183
*        CALL LISTPROC;                                            1184
*                                                                  1184
@RF01182 BAL   @14,LISTPROC                                        1184
*        IF DSBCATPT > NULLPTR                                     1185
*          THEN                                                    1185
*                                                                  1185
         L     @04,DSBCATPT                                        1185
         SLR   @15,@15                                             1185
         CR    @04,@15                                             1185
         BNH   @RF01185                                            1185
*            /********************************************************/
*            /*                                              @ZA05939*/
*            /* FOR THE DATA ENTRY OF AN AIX, BUILD THE      @ZA05939*/
*            /* DARGLIST TO PRINT THE AXRKP DATA INFO.       @ZA05939*/
*            /*                                              @ZA05939*/
*            /********************************************************/
*                                                                  1186
*            IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA  &  GASSOCSW = ON
*              THEN                                                1186
         L     @14,ETYPFPT                                         1186
         L     @14,CTGFLPT(,@14)                                   1186
         CLI   ETYP(@14),C'D'                                      1186
         BNE   @RF01186                                            1186
         TM    GASSOCSW,B'10000000'                                1186
         BNO   @RF01186                                            1186
*                DO;                                       /*@ZA05939*/
*                  CTGFLPTR = DSBFPT;                      /*@ZA05939*/
         L     @14,DSBFPT                                          1188
         ST    @14,CTGFLPTR                                        1188
*                  DARGSENT = LCST49;                      /*@ZA05939*/
         L     @07,DARGPTR                                         1189
         MVI   DARGSENT(@07),X'31'                                 1189
*                  DARGDBP = CTGFLPT(1);                   /*@ZA05939*/
         L     @06,CTGFLPT(,@14)                                   1190
         ST    @06,DARGDBP(,@07)                                   1190
*                  DARGILP = CTGFLNG(1);                   /*@ZA05939*/
         L     @06,CTGFLNG(,@14)                                   1191
         STH   @06,DARGILP(,@07)                                   1191
*                  IF AMDAXRKP = ARITH4FF                          1192
*                    THEN                                          1192
         LH    @14,AMDAXRKP(,@04)                                  1192
         CL    @14,ARITH4FF                                        1192
         BNE   @RF01192                                            1192
*                      AMDAXRKP = 0;                       /*@ZA05939*/
*                                                                  1193
         STH   @15,AMDAXRKP(,@04)                                  1193
*                  CALL LISTPROC;                          /*@ZA05939*/
@RF01192 BAL   @14,LISTPROC                                        1194
*                END;                                      /*@ZA05939*/
*                                                                  1195
*        IF DSBCATPT > NULLPTR                                     1196
*          THEN                                                    1196
*                                                                  1196
@RF01186 DS    0H                                                  1196
@RF01185 L     @04,DSBCATPT                                        1196
         SLR   @15,@15                                             1196
         CR    @04,@15                                             1196
         BNH   @RF01196                                            1196
*            /********************************************************/
*            /*                                              @ZA05939*/
*            /* FOR THE DATA ENTRY OF A RELATIVE RECORD      @ZA05939*/
*            /* DATA SET, BUILD THE DARGLIST TO PRINT THE    @ZA05939*/
*            /* RECORDS/CI AND MAXRECS DATA INFORMATION.     @ZA05939*/
*            /*                                              @ZA05939*/
*            /********************************************************/
*                                                                  1197
*            IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA               1197
*              THEN                                                1197
         L     @14,ETYPFPT                                         1197
         L     @14,CTGFLPT(,@14)                                   1197
         CLI   ETYP(@14),C'D'                                      1197
         BNE   @RF01197                                            1197
*                IF AMDRRDS = ON                                   1198
*                  THEN                                            1198
         TM    AMDRRDS(@04),B'00000010'                            1198
         BNO   @RF01198                                            1198
*                    DO;                                   /*@ZA05939*/
*                      CTGFLPTR = DSBFPT;                  /*@ZA05939*/
         L     @14,DSBFPT                                          1200
         ST    @14,CTGFLPTR                                        1200
*                      DARGSENT = LCST52;                  /*@ZA05939*/
         L     @07,DARGPTR                                         1201
         MVI   DARGSENT(@07),X'34'                                 1201
*                      DARGDBP = CTGFLPT(1);               /*@ZA05939*/
         L     @06,CTGFLPT(,@14)                                   1202
         ST    @06,DARGDBP(,@07)                                   1202
*                      DARGILP = CTGFLNG(1);               /*@ZA05939*/
         L     @06,CTGFLNG(,@14)                                   1203
         STH   @06,DARGILP(,@07)                                   1203
*                      IF AMDNSLOT = ARITH4FF                      1204
*                        THEN                                      1204
         CLC   AMDNSLOT(4,@04),ARITH4FF                            1204
         BNE   @RF01204                                            1204
*                          AMDNSLOT = 0;                   /*@ZA05939*/
         ST    @15,AMDNSLOT(,@04)                                  1205
*                      IF AMDMAXRR = ARITH4FF                      1206
*                        THEN                                      1206
@RF01204 L     @04,DSBCATPT                                        1206
         CLC   AMDMAXRR(4,@04),ARITH4FF                            1206
         BNE   @RF01206                                            1206
*                          AMDMAXRR = 0;                   /*@ZA05939*/
*                                                                  1207
         SLR   @00,@00                                             1207
         ST    @00,AMDMAXRR(,@04)                                  1207
*                      CALL LISTPROC;                      /*@ZA05939*/
@RF01206 BAL   @14,LISTPROC                                        1208
*                    END;                                  /*@ZA05939*/
*        /************************************************************/
*        /*                                                          */
*        /* THE DATASET ATTRIBUTES TO BE LISTED ARE STORED AS EIGHT- */
*        /* BYTE ENTRIES IN A STATIC TEXT TABLE.  A MAXIMUM OF 11    */
*        /* ATTRIBUTES (10 PRINT POSITIONS EACH) CAN BE OUTPUT TO    */
*        /* THE 120-POSITION DEFAULT PRINT LINE.                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1210
*                                                                  1210
*        IF ATTRFPT->CTGFLPT(1) > NULLPTR                          1210
*          THEN                                                    1210
@RF01198 DS    0H                                                  1210
@RF01197 DS    0H                                                  1210
@RF01196 L     @04,ATTRFPT                                         1210
         L     @04,CTGFLPT(,@04)                                   1210
         LTR   @04,@04                                             1210
         BNP   @RF01210                                            1210
*DATATTR:    DO;                                                   1211
*                                                                  1211
DATATTR  DS    0H                                                  1212
*              DARGSENT = LCST19;                                  1212
         L     @04,DARGPTR                                         1212
         MVI   DARGSENT(@04),X'13'                                 1212
*              CTGFLPTR = ATTRFPT;                                 1213
*                                                                  1213
         L     @00,ATTRFPT                                         1213
         ST    @00,CTGFLPTR                                        1213
*              /******************************************************/
*              /*                                                    */
*              /* THE SHAREOPTIONS ATTRIBUTE, SHR(N,N), IS ALWAYS    */
*              /* LISTED FIRST SINCE 3 INSERT STRUCTURES ARE REQUIRED*/
*              /* FOR THE AMS TEXT PROCESSOR INTERFACE TO FORMAT IT. */
*              /*                                                    */
*              /******************************************************/
*                                                                  1214
*              DARGCNT = DRGCNT4;                          /*@ZA05939*/
         MVC   DARGCNT(2,@04),@CH00050                             1214
*              DARGDTM(1) = ADDR(SHRNM);                           1215
         L     @15,TEXTPTR                                         1215
         LA    @14,SHRNM(,@15)                                     1215
         ST    @14,DARGDTM(,@04)                                   1215
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/
         LA    @14,10                                              1216
         STH   @14,DARGINS(,@04)                                   1216
*              DARGINL(1) = ABBREVLN;                              1217
         STH   @14,DARGINL(,@04)                                   1217
*              DARGDTM(2) = ADDR(SHRPRNM);                 /*@ZA05939*/
         LA    @07,SHRPRNM(,@15)                                   1218
         ST    @07,DARGDTM+8(,@04)                                 1218
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/
         MVC   DARGINS+8(2,@04),@CH00649                           1219
*              DARGINL(2) = ABBREVLN;                      /*@ZA05939*/
         STH   @14,DARGINL+8(,@04)                                 1220
*              DARGINS(3) = DRGINS30;                      /*@ZA05939*/
*                                                                  1221
         MVC   DARGINS+16(2,@04),@CH01231                          1221
*              /******************************************************/
*              /*                                                    */
*              /* INTERPRET THE FIRST SHAREOPTION RECORDING CROSS-   */
*              /* REGION DATA.                                       */
*              /*                                                    */
*              /******************************************************/
*                                                                  1222
*              DARGINL(3) = CLENGTH1;                      /*@ZA05939*/
         MVC   DARGINL+16(2,@04),@CH00045                          1222
*              IF INTRASHR = SHROPTN1                              1223
*                THEN                                              1223
         LR    @14,@00                                             1223
         L     @14,CTGFLPT(,@14)                                   1223
         TM    INTRASHR(@14),B'11000000'                           1223
         BNZ   @RF01223                                            1223
*                  DARGDTM(3) = ADDR(SHR1NM);              /*@ZA05939*/
         LA    @00,SHR1NM(,@15)                                    1224
         ST    @00,DARGDTM+16(,@04)                                1224
*                ELSE                                              1225
*                  IF INTRASHR = SHROPTN2                          1225
*                    THEN                                          1225
         B     @RC01223                                            1225
@RF01223 L     @04,CTGFLPTR                                        1225
         L     @04,CTGFLPT(,@04)                                   1225
         TM    INTRASHR(@04),B'01000000'                           1225
         BNO   @RF01225                                            1225
         TM    INTRASHR(@04),B'10000000'                           1225
         BNZ   @RF01225                                            1225
*                      DARGDTM(3) = ADDR(SHR2NM);          /*@ZA05939*/
         L     @04,TEXTPTR                                         1226
         LA    @04,SHR2NM(,@04)                                    1226
         L     @15,DARGPTR                                         1226
         ST    @04,DARGDTM+16(,@15)                                1226
*                    ELSE                                          1227
*                        IF INTRASHR = SHROPTN3                    1227
*                          THEN                                    1227
         B     @RC01225                                            1227
@RF01225 L     @04,CTGFLPTR                                        1227
         L     @04,CTGFLPT(,@04)                                   1227
         TM    INTRASHR(@04),B'10000000'                           1227
         BNO   @RF01227                                            1227
         TM    INTRASHR(@04),B'01000000'                           1227
         BNZ   @RF01227                                            1227
*                            DARGDTM(3) = ADDR(SHR3NM);    /*@ZA05939*/
         L     @04,TEXTPTR                                         1228
         LA    @04,SHR3NM(,@04)                                    1228
         L     @15,DARGPTR                                         1228
         ST    @04,DARGDTM+16(,@15)                                1228
*                          ELSE                                    1229
*                            DARGDTM(3) = ADDR(SHR4NM);    /*@ZA05939*/
*                                                                  1229
         B     @RC01227                                            1229
@RF01227 L     @04,TEXTPTR                                         1229
         LA    @04,SHR4NM(,@04)                                    1229
         L     @15,DARGPTR                                         1229
         ST    @04,DARGDTM+16(,@15)                                1229
*              /******************************************************/
*              /*                                                    */
*              /* INTERPRET THE SECOND SHAREOPTION RECORDING CROSS-  */
*              /* SYSTEM DATA.                                       */
*              /*                                                    */
*              /******************************************************/
*                                                                  1230
*              DARGINS(4) = DRGINS40;                      /*@ZA05939*/
@RC01227 DS    0H                                                  1230
@RC01225 DS    0H                                                  1230
@RC01223 L     @04,DARGPTR                                         1230
         MVC   DARGINS+24(2,@04),@CH01249                          1230
*              DARGINL(4) = CLENGTH1;                      /*@ZA05939*/
         MVC   DARGINL+24(2,@04),@CH00045                          1231
*              IF INTERSHR = SHROPTN1                              1232
*                THEN                                              1232
         L     @15,CTGFLPTR                                        1232
         L     @15,CTGFLPT(,@15)                                   1232
         TM    INTERSHR(@15),B'00110000'                           1232
         BNZ   @RF01232                                            1232
*                  DARGDTM(4) = ADDR(SHR1NM);              /*@ZA05939*/
         L     @15,TEXTPTR                                         1233
         LA    @00,SHR1NM(,@15)                                    1233
         ST    @00,DARGDTM+24(,@04)                                1233
*                ELSE                                              1234
*                  IF INTERSHR = SHROPTN2                          1234
*                    THEN                                          1234
         B     @RC01232                                            1234
@RF01232 L     @04,CTGFLPTR                                        1234
         L     @04,CTGFLPT(,@04)                                   1234
         TM    INTERSHR(@04),B'00010000'                           1234
         BNO   @RF01234                                            1234
         TM    INTERSHR(@04),B'00100000'                           1234
         BNZ   @RF01234                                            1234
*                      DARGDTM(4) = ADDR(SHR2NM);          /*@ZA05939*/
         L     @04,TEXTPTR                                         1235
         LA    @04,SHR2NM(,@04)                                    1235
         L     @15,DARGPTR                                         1235
         ST    @04,DARGDTM+24(,@15)                                1235
*                    ELSE                                          1236
*                      IF INTERSHR = SHROPTN3                      1236
*                        THEN                                      1236
         B     @RC01234                                            1236
@RF01234 L     @04,CTGFLPTR                                        1236
         L     @04,CTGFLPT(,@04)                                   1236
         TM    INTERSHR(@04),B'00100000'                           1236
         BNO   @RF01236                                            1236
         TM    INTERSHR(@04),B'00010000'                           1236
         BNZ   @RF01236                                            1236
*                          DARGDTM(4) = ADDR(SHR3NM);      /*@ZA05939*/
         L     @04,TEXTPTR                                         1237
         LA    @04,SHR3NM(,@04)                                    1237
         L     @15,DARGPTR                                         1237
         ST    @04,DARGDTM+24(,@15)                                1237
*                        ELSE                                      1238
*                          DARGDTM(4) = ADDR(SHR4NM);      /*@ZA05939*/
         B     @RC01236                                            1238
@RF01236 L     @04,TEXTPTR                                         1238
         LA    @04,SHR4NM(,@04)                                    1238
         L     @15,DARGPTR                                         1238
         ST    @04,DARGDTM+24(,@15)                                1238
*              /******************************************************/
*              /*                                                    */
*              /* NOW INCLUDE IN THE DARGLIST THOSE ATTRIBUTED ALWAYS*/
*              /* INITIALIZED FOR A DATA OR INDEX DATASET.           */
*              /* NOTE - THE DARGLIST INSERT COUNTER IS INCREMENTED  */
*              /* FOR EACH SUBSEQUENT ATTRIBUTE.  WHEN PROCESSING    */
*              /* OF THE DATASET ATTRIBUTES IS FINISHED, THE DARGLIST*/
*              /* INSERT PARAMETERS ARE COMPLETED BASED UPON THE     */
*              /* INSERT COUNTER.                                    */
*              /*                                                    */
*              /******************************************************/
*                                                                  1239
*              DARGCNT = DARGCNT + 1;                              1239
@RC01236 DS    0H                                                  1239
@RC01234 DS    0H                                                  1239
@RC01232 L     @04,DARGPTR                                         1239
         LA    @00,1                                               1239
         AH    @00,DARGCNT(,@04)                                   1239
         STH   @00,DARGCNT(,@04)                                   1239
*              IF DSSPEED = ON                                     1240
*                THEN                                              1240
         L     @15,CTGFLPTR                                        1240
         L     @15,CTGFLPT(,@15)                                   1240
         TM    DSSPEED(@15),B'10000000'                            1240
         BNO   @RF01240                                            1240
*                  DARGDTM(DARGCNT) = ADDR(SPEEDNM);               1241
         SLA   @00,3                                               1241
         L     @15,TEXTPTR                                         1241
         LA    @15,SPEEDNM(,@15)                                   1241
         LR    @14,@00                                             1241
         ST    @15,DARGDTM-8(@14,@04)                              1241
*                ELSE                                              1242
*                  DARGDTM(DARGCNT) = ADDR(RCVYNM);                1242
         B     @RC01240                                            1242
@RF01240 L     @04,DARGPTR                                         1242
         LH    @15,DARGCNT(,@04)                                   1242
         SLA   @15,3                                               1242
         L     @14,TEXTPTR                                         1242
         LA    @14,RCVYNM(,@14)                                    1242
         ST    @14,DARGDTM-8(@15,@04)                              1242
*              DARGCNT = DARGCNT + 1;                              1243
@RC01240 L     @04,DARGPTR                                         1243
         LA    @00,1                                               1243
         AH    @00,DARGCNT(,@04)                                   1243
         STH   @00,DARGCNT(,@04)                                   1243
*              IF DSUNQ = ON                                       1244
*                THEN                                              1244
         L     @15,CTGFLPTR                                        1244
         L     @15,CTGFLPT(,@15)                                   1244
         TM    DSUNQ(@15),B'01000000'                              1244
         BNO   @RF01244                                            1244
*                  DARGDTM(DARGCNT) = ADDR(UNQNM);                 1245
         SLA   @00,3                                               1245
         L     @15,TEXTPTR                                         1245
         LA    @15,UNQNM(,@15)                                     1245
         LR    @14,@00                                             1245
         ST    @15,DARGDTM-8(@14,@04)                              1245
*                ELSE                                              1246
*                  DARGDTM(DARGCNT) = ADDR(SUBALNM);               1246
         B     @RC01244                                            1246
@RF01244 L     @04,DARGPTR                                         1246
         LH    @15,DARGCNT(,@04)                                   1246
         SLA   @15,3                                               1246
         L     @14,TEXTPTR                                         1246
         LA    @14,SUBALNM(,@14)                                   1246
         ST    @14,DARGDTM-8(@15,@04)                              1246
*              DARGCNT = DARGCNT + 1;                              1247
@RC01244 L     @04,DARGPTR                                         1247
         LA    @00,1                                               1247
         AH    @00,DARGCNT(,@04)                                   1247
         STH   @00,DARGCNT(,@04)                                   1247
*              IF DSERAS = ON                                      1248
*                THEN                                              1248
         L     @15,CTGFLPTR                                        1248
         L     @15,CTGFLPT(,@15)                                   1248
         TM    DSERAS(@15),B'00010000'                             1248
         BNO   @RF01248                                            1248
*                  DARGDTM(DARGCNT) = ADDR(ERASNM);                1249
         SLA   @00,3                                               1249
         L     @15,TEXTPTR                                         1249
         LA    @15,ERASNM(,@15)                                    1249
         LR    @14,@00                                             1249
         ST    @15,DARGDTM-8(@14,@04)                              1249
*                ELSE                                              1250
*                  DARGDTM(DARGCNT) = ADDR(NERASNM);               1250
         B     @RC01248                                            1250
@RF01248 L     @04,DARGPTR                                         1250
         LH    @15,DARGCNT(,@04)                                   1250
         SLA   @15,3                                               1250
         L     @14,TEXTPTR                                         1250
         LA    @14,NERASNM(,@14)                                   1250
         ST    @14,DARGDTM-8(@15,@04)                              1250
*        /************************************************************/
*        /*                                                          */
*        /* ADD TO THE DARGLIST THOSE DATASET ATTRIBUTED RECORDED IN */
*        /* THE CATALOG AMDSB CONTROL BLOCK RETURNED IN THE WORKAREA.*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1251
*        IF DSBCATPT > NULLPTR                                     1251
*          THEN                                                    1251
@RC01248 L     @04,DSBCATPT                                        1251
         LTR   @04,@04                                             1251
         BNP   @RF01251                                            1251
*            DO;                                                   1252
*                                                                  1252
*              /******************************************************/
*              /*                                                    */
*              /* ONLY FOR DATA ENTRIES IS THE               @Y30SSMK*/
*              /* INDEXED/NONINDEXED/NUMBERED                @Y30SSMK*/
*              /* DESCRIPTOR TO BE INCLUDED IN THE DARGLIST.         */
*              /*                                                    */
*              /******************************************************/
*                                                                  1253
*              IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA             1253
*                THEN                                              1253
         L     @15,ETYPFPT                                         1253
         L     @15,CTGFLPT(,@15)                                   1253
         CLI   ETYP(@15),C'D'                                      1253
         BNE   @RF01253                                            1253
*                  DO;                                             1254
*                    DARGCNT = DARGCNT + 1;                        1255
         L     @15,DARGPTR                                         1255
         LA    @14,1                                               1255
         AH    @14,DARGCNT(,@15)                                   1255
         STH   @14,DARGCNT(,@15)                                   1255
*                    IF AMDRRDS = ON                               1256
*                      THEN                                        1256
         TM    AMDRRDS(@04),B'00000010'                            1256
         BNO   @RF01256                                            1256
*                        DARGDTM(DARGCNT) = ADDR(NUMDNM);  /*@Y30SSMK*/
         SLA   @14,3                                               1257
         L     @04,TEXTPTR                                         1257
         LA    @04,NUMDNM(,@04)                                    1257
         ST    @04,DARGDTM-8(@14,@15)                              1257
*                      ELSE                                        1258
*                        IF AMDDST = ON                            1258
*                          THEN                                    1258
         B     @RC01256                                            1258
@RF01256 L     @04,DSBCATPT                                        1258
         TM    AMDDST(@04),B'10000000'                             1258
         BNO   @RF01258                                            1258
*                            DARGDTM(DARGCNT) = ADDR(IXDNM);       1259
         L     @04,DARGPTR                                         1259
         LH    @15,DARGCNT(,@04)                                   1259
         SLA   @15,3                                               1259
         L     @14,TEXTPTR                                         1259
         LA    @14,IXDNM(,@14)                                     1259
         ST    @14,DARGDTM-8(@15,@04)                              1259
*                          ELSE                                    1260
*                            DARGDTM(DARGCNT) = ADDR(NIXDNM);      1260
         B     @RC01258                                            1260
@RF01258 L     @04,DARGPTR                                         1260
         LH    @15,DARGCNT(,@04)                                   1260
         SLA   @15,3                                               1260
         L     @14,TEXTPTR                                         1260
         LA    @14,NIXDNM(,@14)                                    1260
         ST    @14,DARGDTM-8(@15,@04)                              1260
*                  END;                                            1261
@RC01258 DS    0H                                                  1261
@RC01256 DS    0H                                                  1262
*              DARGCNT = DARGCNT + 1;                              1262
@RF01253 L     @04,DARGPTR                                         1262
         LA    @00,1                                               1262
         AH    @00,DARGCNT(,@04)                                   1262
         STH   @00,DARGCNT(,@04)                                   1262
*              IF AMDWCK = ON                                      1263
*                THEN                                              1263
         L     @15,DSBCATPT                                        1263
         TM    AMDWCK(@15),B'01000000'                             1263
         BNO   @RF01263                                            1263
*                  DARGDTM(DARGCNT) = ADDR(WCKNM);                 1264
         SLA   @00,3                                               1264
         L     @15,TEXTPTR                                         1264
         LA    @15,WCKNM(,@15)                                     1264
         LR    @14,@00                                             1264
         ST    @15,DARGDTM-8(@14,@04)                              1264
*                ELSE                                              1265
*                  DARGDTM(DARGCNT) = ADDR(NWCKNM);                1265
         B     @RC01263                                            1265
@RF01263 L     @04,DARGPTR                                         1265
         LH    @15,DARGCNT(,@04)                                   1265
         SLA   @15,3                                               1265
         L     @14,TEXTPTR                                         1265
         LA    @14,NWCKNM(,@14)                                    1265
         ST    @14,DARGDTM-8(@15,@04)                              1265
*              DARGCNT = DARGCNT + 1;                              1266
@RC01263 L     @04,DARGPTR                                         1266
         LA    @00,1                                               1266
         AH    @00,DARGCNT(,@04)                                   1266
         STH   @00,DARGCNT(,@04)                                   1266
*              IF AMDSDT = ON                                      1267
*                THEN                                              1267
         L     @15,DSBCATPT                                        1267
         TM    AMDSDT(@15),B'00100000'                             1267
         BNO   @RF01267                                            1267
*                  DARGDTM(DARGCNT) = ADDR(IMBDNM);                1268
         SLA   @00,3                                               1268
         L     @15,TEXTPTR                                         1268
         LA    @15,IMBDNM(,@15)                                    1268
         LR    @14,@00                                             1268
         ST    @15,DARGDTM-8(@14,@04)                              1268
*                ELSE                                              1269
*                  DARGDTM(DARGCNT) = ADDR(NIMBDNM);               1269
         B     @RC01267                                            1269
@RF01267 L     @04,DARGPTR                                         1269
         LH    @15,DARGCNT(,@04)                                   1269
         SLA   @15,3                                               1269
         L     @14,TEXTPTR                                         1269
         LA    @14,NIMBDNM(,@14)                                   1269
         ST    @14,DARGDTM-8(@15,@04)                              1269
*              DARGCNT = DARGCNT + 1;                              1270
@RC01267 L     @04,DARGPTR                                         1270
         LA    @00,1                                               1270
         AH    @00,DARGCNT(,@04)                                   1270
         STH   @00,DARGCNT(,@04)                                   1270
*              IF AMDREPL = ON                                     1271
*                THEN                                              1271
         L     @15,DSBCATPT                                        1271
         TM    AMDREPL(@15),B'00010000'                            1271
         BNO   @RF01271                                            1271
*                  DARGDTM(DARGCNT) = ADDR(REPLNM);                1272
         SLA   @00,3                                               1272
         L     @15,TEXTPTR                                         1272
         LA    @15,REPLNM(,@15)                                    1272
         LR    @14,@00                                             1272
         ST    @15,DARGDTM-8(@14,@04)                              1272
*                ELSE                                              1273
*                  DARGDTM(DARGCNT) = ADDR(NREPLNM);               1273
         B     @RC01271                                            1273
@RF01271 L     @04,DARGPTR                                         1273
         LH    @15,DARGCNT(,@04)                                   1273
         SLA   @15,3                                               1273
         L     @14,TEXTPTR                                         1273
         LA    @14,NREPLNM(,@14)                                   1273
         ST    @14,DARGDTM-8(@15,@04)                              1273
*              DARGCNT = DARGCNT + 1;                              1274
@RC01271 L     @04,DARGPTR                                         1274
         LA    @00,1                                               1274
         AH    @00,DARGCNT(,@04)                                   1274
         STH   @00,DARGCNT(,@04)                                   1274
*              IF AMDORDER = ON                                    1275
*                THEN                                              1275
         L     @15,DSBCATPT                                        1275
         TM    AMDORDER(@15),B'00001000'                           1275
         BNO   @RF01275                                            1275
*                  DARGDTM(DARGCNT) = ADDR(ORDNM);                 1276
         SLA   @00,3                                               1276
         L     @15,TEXTPTR                                         1276
         LA    @15,ORDNM(,@15)                                     1276
         LR    @14,@00                                             1276
         ST    @15,DARGDTM-8(@14,@04)                              1276
*                ELSE                                              1277
*                  DARGDTM(DARGCNT) = ADDR(UNORDNM);               1277
         B     @RC01275                                            1277
@RF01275 L     @04,DARGPTR                                         1277
         LH    @15,DARGCNT(,@04)                                   1277
         SLA   @15,3                                               1277
         L     @14,TEXTPTR                                         1277
         LA    @14,UNORDNM(,@14)                                   1277
         ST    @14,DARGDTM-8(@15,@04)                              1277
*            END;                                                  1278
@RC01275 DS    0H                                                  1279
*                                                                  1279
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* IF THE DATA ENTRY IS A PAGESPACE, LIST THE TRACK-        */
*        /* OVERFLOW OR NO-TRACK-OVERFLOW ATTRIBUTES.        @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1279
*        IF PGSPCFLG = ON                                          1279
*          THEN                                                    1279
@RF01251 TM    PGSPCFLG,B'10000000'                                1279
         BNO   @RF01279                                            1279
*            DO;                                           /*@YL026UE*/
*            DARGCNT = DARGCNT + 1;                        /*@YL026UE*/
         L     @04,DARGPTR                                         1281
         LA    @00,1                                               1281
         AH    @00,DARGCNT(,@04)                                   1281
         STH   @00,DARGCNT(,@04)                                   1281
*            DARGINS(DARGCNT) = DARGCNT*DRGINS10;          /*@Y30SSMK*/
         LR    @15,@00                                             1282
         SLA   @15,3                                               1282
         LA    @14,10                                              1282
         LR    @03,@00                                             1282
         MR    @02,@14                                             1282
         STH   @03,DARGINS-8(@15,@04)                              1282
*            DARGINL(DARGCNT) = ABBREVLN;                  /*@YL026UE*/
         STH   @14,DARGINL-8(@15,@04)                              1283
*            IF DSTKOV = ON                                        1284
*              THEN                                                1284
         L     @14,CTGFLPTR                                        1284
         L     @14,CTGFLPT(,@14)                                   1284
         TM    DSTKOV(@14),B'00000001'                             1284
         BNO   @RF01284                                            1284
*                DARGDTM(DARGCNT) = ADDR(TOVFLNM);         /*@YL026UE*/
         L     @14,TEXTPTR                                         1285
         LA    @14,TOVFLNM(,@14)                                   1285
         ST    @14,DARGDTM-8(@15,@04)                              1285
*              ELSE                                                1286
*                DARGDTM(DARGCNT) = ADDR(NTOVFLNM);        /*@YL026UE*/
*                                                                  1286
         B     @RC01284                                            1286
@RF01284 L     @04,DARGPTR                                         1286
         LH    @15,DARGCNT(,@04)                                   1286
         SLA   @15,3                                               1286
         L     @14,TEXTPTR                                         1286
         LA    @14,NTOVFLNM(,@14)                                  1286
         ST    @14,DARGDTM-8(@15,@04)                              1286
*            /********************************************************/
*            /*                                              @Z40WSMK*/
*            /* FOR THE DATA COMPONENT OF A PAGESPACE,       @Z40WSMK*/
*            /* CONTINUE TO LIST THE SWAP OR NOSWAP          @Z40WSMK*/
*            /* ATTRIBUTES.                                  @Z40WSMK*/
*            /*                                              @Z40WSMK*/
*            /********************************************************/
*                                                                  1287
*            DARGCNT = DARGCNT + 1;                        /*@Z40WSMK*/
@RC01284 L     @04,DARGPTR                                         1287
         LA    @00,1                                               1287
         AH    @00,DARGCNT(,@04)                                   1287
         STH   @00,DARGCNT(,@04)                                   1287
*            DARGINS(DARGCNT) = DARGCNT * DRGINS10;        /*@Z40WSMK*/
         LR    @15,@00                                             1288
         SLA   @15,3                                               1288
         LA    @14,10                                              1288
         LR    @03,@00                                             1288
         MR    @02,@14                                             1288
         STH   @03,DARGINS-8(@15,@04)                              1288
*            DARGINL(DARGCNT) = ABBREVLN;                  /*@Z40WSMK*/
         STH   @14,DARGINL-8(@15,@04)                              1289
*            IF CATTRFPT->CTGFLPT(1)->PGSWAP = ON                  1290
*              THEN                                                1290
         L     @14,CATTRFPT                                        1290
         L     @14,CTGFLPT(,@14)                                   1290
         TM    PGSWAP(@14),B'00000010'                             1290
         BNO   @RF01290                                            1290
*                DARGDTM(DARGCNT) = ADDR(SWAPNM);          /*@Z40WSMK*/
         L     @14,TEXTPTR                                         1291
         LA    @14,SWAPNM(,@14)                                    1291
         ST    @14,DARGDTM-8(@15,@04)                              1291
*              ELSE                                                1292
*                DARGDTM(DARGCNT) = ADDR(NSWAPNM);         /*@Z40WSMK*/
         B     @RC01290                                            1292
@RF01290 L     @04,DARGPTR                                         1292
         LH    @15,DARGCNT(,@04)                                   1292
         SLA   @15,3                                               1292
         L     @14,TEXTPTR                                         1292
         LA    @14,NSWAPNM(,@14)                                   1292
         ST    @14,DARGDTM-8(@15,@04)                              1292
*            END;                                          /*#YL026UE*/
*          ELSE                                                    1294
*XPDATA:     DO;                                           /*@YL026UE*/
*                                                                  1294
         B     @RC01279                                            1294
@RF01279 DS    0H                                                  1294
XPDATA   DS    0H                                                  1295
*              /******************************************************/
*              /*                                                    */
*              /* DETERMINE WHETHER THE OPTIONAL ATTRIBUTES -        */
*              /* INHIBIT UPDATE, TEMPORARY EXPORT - ARE TO BE       */
*              /* LISTED. NOTE - A PAGESPACE DATA ENTRY CAN NOT      */
*              /* BE EXPORTED.                               @YL026UE*/
*              /*                                                    */
*              /******************************************************/
*                                                                  1295
*              IF DSINH = ON                                       1295
*                THEN                                              1295
         L     @04,CTGFLPTR                                        1295
         L     @04,CTGFLPT(,@04)                                   1295
         TM    DSINH(@04),B'00000100'                              1295
         BNO   @RF01295                                            1295
*                  DO;                                             1296
*                    DARGCNT = DARGCNT + 1;                        1297
         L     @04,DARGPTR                                         1297
         LA    @00,1                                               1297
         AH    @00,DARGCNT(,@04)                                   1297
         STH   @00,DARGCNT(,@04)                                   1297
*                    DARGINS(DARGCNT) = DARGCNT * DRGINS10;/*@Y30SSMK*/
         LR    @15,@00                                             1298
         SLA   @15,3                                               1298
         LA    @14,10                                              1298
         LR    @03,@00                                             1298
         MR    @02,@14                                             1298
         STH   @03,DARGINS-8(@15,@04)                              1298
*                    DARGINL(DARGCNT) = ABBREVLN;                  1299
         STH   @14,DARGINL-8(@15,@04)                              1299
*                    DARGDTM(DARGCNT) = ADDR(INHUPDNM);            1300
         L     @14,TEXTPTR                                         1300
         LA    @14,INHUPDNM(,@14)                                  1300
         ST    @14,DARGDTM-8(@15,@04)                              1300
*                  END;                                            1301
*              IF DSTEXP = ON                                      1302
*                THEN                                              1302
@RF01295 L     @04,CTGFLPTR                                        1302
         L     @04,CTGFLPT(,@04)                                   1302
         TM    DSTEXP(@04),B'00000010'                             1302
         BNO   @RF01302                                            1302
*                  DO;                                             1303
*                    DARGCNT = DARGCNT + 1;                        1304
         L     @04,DARGPTR                                         1304
         LA    @00,1                                               1304
         AH    @00,DARGCNT(,@04)                                   1304
         STH   @00,DARGCNT(,@04)                                   1304
*                    DARGINS(DARGCNT) = DARGCNT * DRGINS10;/*@Y30SSMK*/
         LR    @15,@00                                             1305
         SLA   @15,3                                               1305
         LA    @14,10                                              1305
         LR    @03,@00                                             1305
         MR    @02,@14                                             1305
         STH   @03,DARGINS-8(@15,@04)                              1305
*                    DARGINL(DARGCNT) = ABBREVLN;                  1306
         STH   @14,DARGINL-8(@15,@04)                              1306
*                    DARGDTM(DARGCNT) = ADDR(TEMEXPNM);            1307
         L     @14,TEXTPTR                                         1307
         LA    @14,TEMEXPNM(,@14)                                  1307
         ST    @14,DARGDTM-8(@15,@04)                              1307
*                  END;                                            1308
*            END XPDATA;                                   /*@YL026UE*/
@RF01302 DS    0H                                                  1310
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* DETERMINE WHETHER THE DATA SET IS REUSABLE @Y30SSMK*/
*              /* AND INCLUDE THIS ATTRIBUTE IN THE DARGLIST @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1310
*              DARGCNT = DARGCNT + 1;                      /*@Y30SSMK*/
@RC01279 L     @04,DARGPTR                                         1310
         LA    @00,1                                               1310
         AH    @00,DARGCNT(,@04)                                   1310
         STH   @00,DARGCNT(,@04)                                   1310
*              IF DSREUSE = ON                                     1311
*                THEN                                              1311
         L     @15,CTGFLPTR                                        1311
         L     @15,CTGFLPT(,@15)                                   1311
         TM    DSREUSE(@15),B'00100000'                            1311
         BNO   @RF01311                                            1311
*                  DARGDTM(DARGCNT) = ADDR(RUSNM);         /*@Y30SSMK*/
         SLA   @00,3                                               1312
         L     @15,TEXTPTR                                         1312
         LA    @15,RUSNM(,@15)                                     1312
         LR    @14,@00                                             1312
         ST    @15,DARGDTM-8(@14,@04)                              1312
*                ELSE                                              1313
*                  DARGDTM(DARGCNT) = ADDR(NRUSNM);        /*@Y30SSMK*/
*                                                                  1313
         B     @RC01311                                            1313
@RF01311 L     @04,DARGPTR                                         1313
         LH    @15,DARGCNT(,@04)                                   1313
         SLA   @15,3                                               1313
         L     @14,TEXTPTR                                         1313
         LA    @14,NRUSNM(,@14)                                    1313
         ST    @14,DARGDTM-8(@15,@04)                              1313
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* ADD TO THE DARGLIST THOSE DATA SET         @Y30SSMK*/
*              /* ATTRIBUTES RECORDED IN THE CATALOG AMDSB   @Y30SSMK*/
*              /* CONTROL BLOCK RETURNED IN THE WORKAREA.    @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1314
*              IF DSBCATPT > NULLPTR                               1314
*                THEN                                              1314
@RC01311 L     @04,DSBCATPT                                        1314
         LTR   @04,@04                                             1314
         BNP   @RF01314                                            1314
*                  DO;                                     /*@Y30SSMK*/
*                    IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA       1316
*                      THEN                                        1316
         L     @15,ETYPFPT                                         1316
         L     @15,CTGFLPT(,@15)                                   1316
         CLI   ETYP(@15),C'D'                                      1316
         BNE   @RF01316                                            1316
*                        DO;                               /*@Y30SSMK*/
*                                                                  1317
*                          /******************************************/
*                          /*                                @Y30SSMK*/
*                          /* ONLY FOR THE DATA ENTRY IS     @Y30SSMK*/
*                          /* THE SPANNED/NONSPANNED         @Y30SSMK*/
*                          /* DESCRIPTOR TO BE INCLUDED      @Y30SSMK*/
*                          /* IN THE DARGLIST.               @Y30SSMK*/
*                          /*                                @Y30SSMK*/
*                          /******************************************/
*                                                                  1318
*                          DARGCNT = DARGCNT + 1;          /*@Y30SSMK*/
         L     @15,DARGPTR                                         1318
         LA    @14,1                                               1318
         AH    @14,DARGCNT(,@15)                                   1318
         STH   @14,DARGCNT(,@15)                                   1318
*                          IF AMDSPAN = ON                         1319
*                            THEN                                  1319
         TM    AMDSPAN(@04),B'00000001'                            1319
         BNO   @RF01319                                            1319
*                              DARGDTM(DARGCNT) =                  1320
*                                ADDR(SPNDNM);             /*@Y30SSMK*/
         SLA   @14,3                                               1320
         L     @04,TEXTPTR                                         1320
         LA    @04,SPNDNM(,@04)                                    1320
         ST    @04,DARGDTM-8(@14,@15)                              1320
*                            ELSE                                  1321
*                              DARGDTM(DARGCNT) =                  1321
*                                ADDR(NSPNDNM);            /*@Y30SSMK*/
*                                                                  1321
         B     @RC01319                                            1321
@RF01319 L     @04,DARGPTR                                         1321
         LH    @15,DARGCNT(,@04)                                   1321
         SLA   @15,3                                               1321
         L     @14,TEXTPTR                                         1321
         LA    @14,NSPNDNM(,@14)                                   1321
         ST    @14,DARGDTM-8(@15,@04)                              1321
*                          /******************************************/
*                          /*                                @Y30SSMK*/
*                          /* ONLY FOR THE DATA ENTRY OF AN  @Y30SSMK*/
*                          /* AIX IS THE UNIQUEKEY/NONUNIQUEKEY      */
*                          /* DESCRIPTOR TO BE INCLUDED IN   @Y30SSMK*/
*                          /* THE DARGLIST.                  @Y30SSMK*/
*                          /*                                @Y30SSMK*/
*                          /******************************************/
*                                                                  1322
*                          IF GASSOCSW = ON                        1322
*                            THEN                                  1322
@RC01319 TM    GASSOCSW,B'10000000'                                1322
         BNO   @RF01322                                            1322
*                              DO;                         /*@Y30SSMK*/
*                                DARGCNT = DARGCNT + 1;    /*@Y30SSMK*/
         L     @04,DARGPTR                                         1324
         LA    @00,1                                               1324
         AH    @00,DARGCNT(,@04)                                   1324
         STH   @00,DARGCNT(,@04)                                   1324
*                                IF AMDUNQ = ON                    1325
*                                  THEN                            1325
         L     @15,DSBCATPT                                        1325
         TM    AMDUNQ(@15),B'10000000'                             1325
         BNO   @RF01325                                            1325
*                                    DARGDTM(DARGCNT) =            1326
*                                      ADDR(NUNQKNM);      /*@Y30SSMK*/
         SLA   @00,3                                               1326
         L     @15,TEXTPTR                                         1326
         LA    @15,NUNQKNM(,@15)                                   1326
         LR    @14,@00                                             1326
         ST    @15,DARGDTM-8(@14,@04)                              1326
*                                  ELSE                            1327
*                                    DARGDTM(DARGCNT) =            1327
*                                      ADDR(UNQKNM);       /*@Y30SSMK*/
         B     @RC01325                                            1327
@RF01325 L     @04,DARGPTR                                         1327
         LH    @15,DARGCNT(,@04)                                   1327
         SLA   @15,3                                               1327
         L     @14,TEXTPTR                                         1327
         LA    @14,UNQKNM(,@14)                                    1327
         ST    @14,DARGDTM-8(@15,@04)                              1327
*                              END;                        /*@Y30SSMK*/
@RC01325 DS    0H                                                  1329
*                        END;                              /*@Y30SSMK*/
*                                                                  1329
@RF01322 DS    0H                                                  1330
*                    /************************************************/
*                    /*                                      @Y30LSMK*/
*                    /* ADD TO THE DARGLIST THOSE DATA SET   @Y30LSMK*/
*                    /* ATTRIBUTES CYLINDERFAULT,BIND, AND   @Y30LSMK*/
*                    /* DESTAGEWAIT THAT ARE RECORDED IN THE @Y30LSMK*/
*                    /* CATALOG AMDSB CONTROL BLOCK RETURNED @Y30LSMK*/
*                    /* IN THE WORKAREA.                     @Y30LSMK*/
*                    /*                                      @Y30LSMK*/
*                    /************************************************/
*                                                                  1330
*                    IF AMDFAULT = ON                              1330
*                      THEN                                        1330
@RF01316 L     @04,DSBCATPT                                        1330
         TM    AMDFAULT(@04),B'01000000'                           1330
         BNO   @RF01330                                            1330
*                        DO;                               /*@Y30LSMK*/
*                          DARGCNT = DARGCNT + 1;          /*@Y30LSMK*/
         L     @04,DARGPTR                                         1332
         LA    @00,1                                               1332
         AH    @00,DARGCNT(,@04)                                   1332
         STH   @00,DARGCNT(,@04)                                   1332
*                          DARGDTM(DARGCNT) = ADDR(CYLFNM);/*@Y30LSMK*/
         SLA   @00,3                                               1333
         L     @15,TEXTPTR                                         1333
         LA    @15,CYLFNM(,@15)                                    1333
         LR    @14,@00                                             1333
         ST    @15,DARGDTM-8(@14,@04)                              1333
*                        END;                              /*@Y30LSMK*/
*                    IF AMDBIND = ON                               1335
*                      THEN                                        1335
@RF01330 L     @04,DSBCATPT                                        1335
         TM    AMDBIND(@04),B'00100000'                            1335
         BNO   @RF01335                                            1335
*                        DO;                               /*@Y30LSMK*/
*                          DARGCNT = DARGCNT + 1;          /*@Y30LSMK*/
         L     @04,DARGPTR                                         1337
         LA    @00,1                                               1337
         AH    @00,DARGCNT(,@04)                                   1337
         STH   @00,DARGCNT(,@04)                                   1337
*                          DARGDTM(DARGCNT) = ADDR(BINDNM);/*@Y30LSMK*/
         SLA   @00,3                                               1338
         L     @15,TEXTPTR                                         1338
         LA    @15,BINDNM(,@15)                                    1338
         LR    @14,@00                                             1338
         ST    @15,DARGDTM-8(@14,@04)                              1338
*                        END;                              /*@Y30LSMK*/
*                    IF AMDWAIT = ON                               1340
*                      THEN                                        1340
@RF01335 L     @04,DSBCATPT                                        1340
         TM    AMDWAIT(@04),B'00010000'                            1340
         BNO   @RF01340                                            1340
*                        DO;                               /*@Y30LSMK*/
*                          DARGCNT = DARGCNT + 1;          /*@Y30LSMK*/
         L     @04,DARGPTR                                         1342
         LA    @00,1                                               1342
         AH    @00,DARGCNT(,@04)                                   1342
         STH   @00,DARGCNT(,@04)                                   1342
*                          DARGDTM(DARGCNT) = ADDR(DSTGWNM);       1343
         SLA   @00,3                                               1343
         L     @15,TEXTPTR                                         1343
         LA    @15,DSTGWNM(,@15)                                   1343
         LR    @14,@00                                             1343
         ST    @15,DARGDTM-8(@14,@04)                              1343
*                        END;                              /*@Y30LSMK*/
*                  END;                                            1345
*                                                                  1345
@RF01340 DS    0H                                                  1346
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* ONLY FOR THE DATA ENTRY OF A RECOVERABLE   @Y30SSMK*/
*              /* CATALOG IS THE RECOVERABLE DESCRIPTOR      @Y30SSMK*/
*              /* TO BE INCLUDED IN THE DARGLIST.            @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1346
*              IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA             1346
*                THEN                                              1346
@RF01314 L     @04,ETYPFPT                                         1346
         L     @04,CTGFLPT(,@04)                                   1346
         CLI   ETYP(@04),C'D'                                      1346
         BNE   @RF01346                                            1346
*                  IF DSRCVR = ON                                  1347
*                    THEN                                          1347
         L     @04,CTGFLPTR                                        1347
         L     @04,CTGFLPT(,@04)                                   1347
         TM    DSRCVR(@04),B'00001000'                             1347
         BNO   @RF01347                                            1347
*                      DO;                                 /*@Y30SSMK*/
*                        DARGCNT = DARGCNT + 1;            /*@Y30SSMK*/
         L     @04,DARGPTR                                         1349
         LA    @00,1                                               1349
         AH    @00,DARGCNT(,@04)                                   1349
         STH   @00,DARGCNT(,@04)                                   1349
*                        DARGDTM(DARGCNT) = ADDR(RVBLNM);  /*@Y30SSMK*/
         SLA   @00,3                                               1350
         L     @15,TEXTPTR                                         1350
         LA    @15,RVBLNM(,@15)                                    1350
         LR    @14,@00                                             1350
         ST    @15,DARGDTM-8(@14,@04)                              1350
*                      END;                                /*@Y30SSMK*/
*                                                                  1351
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* DETERMINE WHETHER THE OPTIONAL ATTRIBUTE   @Y30SSMK*/
*              /* NOTUSABLE IS TO BE LISTED.                 @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  1352
*              IF DSNUSE = ON                                      1352
*                THEN                                              1352
@RF01347 DS    0H                                                  1352
@RF01346 L     @04,CTGFLPTR                                        1352
         L     @04,CTGFLPT(,@04)                                   1352
         TM    DSNUSE(@04),B'00000001'                             1352
         BNO   @RF01352                                            1352
*                  DO;                                     /*@Y30SSMK*/
*                    DARGCNT = DARGCNT + 1;                /*@Y30SSMK*/
         L     @04,DARGPTR                                         1354
         LA    @00,1                                               1354
         AH    @00,DARGCNT(,@04)                                   1354
         STH   @00,DARGCNT(,@04)                                   1354
*                    DARGDTM(DARGCNT) = ADDR(NUSNM);       /*@Y30SSMK*/
         SLA   @00,3                                               1355
         L     @15,TEXTPTR                                         1355
         LA    @15,NUSNM(,@15)                                     1355
         LR    @14,@00                                             1355
         ST    @15,DARGDTM-8(@14,@04)                              1355
*                  END;                                    /*@Y30SSMK*/
*                                                                  1356
*              /******************************************************/
*              /*                                                    */
*              /* SETUP THE COMMON DATA FOR THE AMS TEXT PROCESSOR   */
*              /* INSERT STRUCTURES, EXCLUDING SHAREOPTIONS.         */
*              /* THEN PRINT THE DATASET CHARACTERISTICS.            */
*              /*                                                    */
*              /******************************************************/
*                                                                  1357
*              DO CKK = DRGCNT5 TO DARGCNT;                /*@ZA05939*/
@RF01352 LA    CKK,5                                               1357
         B     @DE01357                                            1357
@DL01357 DS    0H                                                  1358
*                DARGINS(CKK) = CKK * DRGINS10;            /*@Y30SSMK*/
         L     @07,DARGPTR                                         1358
         LR    @04,CKK                                             1358
         SLA   @04,3                                               1358
         LA    @15,10                                              1358
         LR    @03,CKK                                             1358
         MR    @02,@15                                             1358
         STH   @03,DARGINS-8(@04,@07)                              1358
*                DARGINL(CKK) = ABBREVLN;                          1359
         STH   @15,DARGINL-8(@04,@07)                              1359
*              END;                                                1360
*                                                                  1360
         AL    CKK,@CF00045                                        1360
@DE01357 L     @07,DARGPTR                                         1360
         CH    CKK,DARGCNT(,@07)                                   1360
         BNH   @DL01357                                            1360
*              CALL LISTPROC;                                      1361
         BAL   @14,LISTPROC                                        1361
*            END DATATTR;                                  /*@Y30LSMK*/
*        /************************************************************/
*        /*                                                          */
*        /* FOR A DATA OR INDEX ENTRY, BUILD THE DARGLIST    @ZA05939*/
*        /* TO PROCESS THE STATISTICS RECORDED IN THE        @ZA05939*/
*        /* CATALOG AMDSB CONTROL BLOCK.                     @ZA05939*/
*        /* ZERO-OUT ANY NON-INITIALIZED ARITHMETIC VALUES   @ZA05939*/
*        /* TO INSURE PRINTABILITY.                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1363
*        DARGSENT = LCST21;            /*STATISTICS HEADER           */
@RF01210 L     @04,DARGPTR                                         1363
         MVI   DARGSENT(@04),X'15'                                 1363
*        CTGFLPTR = DSBFPT;                                        1364
         L     @00,DSBFPT                                          1364
         ST    @00,CTGFLPTR                                        1364
*        DARGDBP = CTGFLPT(1);                                     1365
         LR    @15,@00                                             1365
         L     @15,CTGFLPT(,@15)                                   1365
         ST    @15,DARGDBP(,@04)                                   1365
*        DARGILP = CTGFLNG(1);                                     1366
         LR    @15,@00                                             1366
         L     @00,CTGFLNG(,@15)                                   1366
         STH   @00,DARGILP(,@04)                                   1366
*        IF AMDPCTCI = ARITH4FF        /* PERCENT FREE BYTES IN C.I. */
*          THEN                                                    1367
         L     @04,DSBCATPT                                        1367
         SLR   @00,@00                                             1367
         IC    @00,AMDPCTCI(,@04)                                  1367
         CL    @00,ARITH4FF                                        1367
         BNE   @RF01367                                            1367
*            AMDPCTCI = 0;                                         1368
         MVI   AMDPCTCI(@04),X'00'                                 1368
*        IF AMDPCTCA = ARITH4FF        /* PERCENT FREE C.I. IN C.A.  */
*          THEN                                                    1369
@RF01367 L     @04,DSBCATPT                                        1369
         SLR   @00,@00                                             1369
         IC    @00,AMDPCTCA(,@04)                                  1369
         CL    @00,ARITH4FF                                        1369
         BNE   @RF01369                                            1369
*            AMDPCTCA = 0;                                         1370
         MVI   AMDPCTCA(@04),X'00'                                 1370
*        IF AMDASPA = ARITH4FF         /* NO. OF FREE BYTES IN D.S.  */
*          THEN                                                    1371
@RF01369 L     @04,DSBCATPT                                        1371
         CLC   AMDASPA(4,@04),ARITH4FF                             1371
         BNE   @RF01371                                            1371
*            AMDASPA = 0;                                          1372
         SLR   @00,@00                                             1372
         ST    @00,AMDASPA(,@04)                                   1372
*        IF AMDNLR = ARITH4FF          /*NO. OF TOTAL RECORDS        */
*          THEN                                                    1373
@RF01371 L     @04,DSBCATPT                                        1373
         CLC   AMDNLR(4,@04),ARITH4FF                              1373
         BNE   @RF01373                                            1373
*            AMDNLR = 0;                                           1374
         SLR   @00,@00                                             1374
         ST    @00,AMDNLR(,@04)                                    1374
*        IF AMDDELR = ARITH4FF         /*NO. OF DELETED RECORDS      */
*          THEN                                                    1375
@RF01373 L     @04,DSBCATPT                                        1375
         CLC   AMDDELR(4,@04),ARITH4FF                             1375
         BNE   @RF01375                                            1375
*            AMDDELR = 0;                                          1376
         SLR   @00,@00                                             1376
         ST    @00,AMDDELR(,@04)                                   1376
*        IF AMDIREC = ARITH4FF         /*NO. OF INSERTED RECORDS     */
*          THEN                                                    1377
@RF01375 L     @04,DSBCATPT                                        1377
         CLC   AMDIREC(4,@04),ARITH4FF                             1377
         BNE   @RF01377                                            1377
*            AMDIREC = 0;                                          1378
         SLR   @00,@00                                             1378
         ST    @00,AMDIREC(,@04)                                   1378
*        IF AMDUPR = ARITH4FF          /*NO. OF UPDATED RECORDS      */
*          THEN                                                    1379
@RF01377 L     @04,DSBCATPT                                        1379
         CLC   AMDUPR(4,@04),ARITH4FF                              1379
         BNE   @RF01379                                            1379
*            AMDUPR = 0;                                           1380
         SLR   @00,@00                                             1380
         ST    @00,AMDUPR(,@04)                                    1380
*        IF AMDRETR = ARITH4FF         /*NO. OF RETRIEVED RECORDS    */
*          THEN                                                    1381
@RF01379 L     @04,DSBCATPT                                        1381
         CLC   AMDRETR(4,@04),ARITH4FF                             1381
         BNE   @RF01381                                            1381
*            AMDRETR = 0;                                          1382
         SLR   @00,@00                                             1382
         ST    @00,AMDRETR(,@04)                                   1382
*        IF AMDNCIS = ARITH4FF         /*NO. OF C.I. SPLITS          */
*          THEN                                                    1383
@RF01381 L     @04,DSBCATPT                                        1383
         CLC   AMDNCIS(4,@04),ARITH4FF                             1383
         BNE   @RF01383                                            1383
*            AMDNCIS = 0;                                          1384
         SLR   @00,@00                                             1384
         ST    @00,AMDNCIS(,@04)                                   1384
*        IF AMDNCAS = ARITH4FF         /*NO. OF C.A. SPLITS          */
*          THEN                                                    1385
@RF01383 L     @04,DSBCATPT                                        1385
         CLC   AMDNCAS(4,@04),ARITH4FF                             1385
         BNE   @RF01385                                            1385
*            AMDNCAS = 0;                                          1386
         SLR   @00,@00                                             1386
         ST    @00,AMDNCAS(,@04)                                   1386
*        IF AMDEXCP = ARITH4FF         /*NO. OF EXCPS                */
*          THEN                                                    1387
@RF01385 L     @04,DSBCATPT                                        1387
         CLC   AMDEXCP(4,@04),ARITH4FF                             1387
         BNE   @RF01387                                            1387
*            AMDEXCP = 0;                                          1388
         SLR   @00,@00                                             1388
         ST    @00,AMDEXCP(,@04)                                   1388
*        IF AMDNEXT = ARITH4FF         /*NO. OF EXTENTS              */
*          THEN                                                    1389
@RF01387 L     @04,DSBCATPT                                        1389
         LH    @00,AMDNEXT(,@04)                                   1389
         CL    @00,ARITH4FF                                        1389
         BNE   @RF01389                                            1389
*            AMDNEXT = 0;                                          1390
         SLR   @00,@00                                             1390
         STH   @00,AMDNEXT(,@04)                                   1390
*        /************************************************************/
*        /*                                                          */
*        /* IF AN INDEX ENTRY IS BEING PROCESSED, CONTINUE   @ZA05939*/
*        /* BUILDING THE DARGLIST TO PRINT THOSE ADDITIONAL  @ZA05939*/
*        /* CATALOG AMDSB STATISTICS WHICH ARE RELEVANT TO   @ZA05939*/
*        /* AN INDEX DATASET ONLY.                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1391
*        IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTINDX                   1391
*          THEN                                                    1391
@RF01389 L     @04,ETYPFPT                                         1391
         L     @04,CTGFLPT(,@04)                                   1391
         CLI   ETYP(@04),C'I'                                      1391
         BNE   @RF01391                                            1391
*            DO;                                                   1392
*              DARGSENT = LCST22;      /*INDEX STATISTICS HEADER     */
         L     @04,DARGPTR                                         1393
         MVI   DARGSENT(@04),X'16'                                 1393
*              IF AMDNIL = ARITH4FF    /*NO. OF INDEX LEVELS         */
*                THEN                                              1394
         L     @04,DSBCATPT                                        1394
         LH    @00,AMDNIL(,@04)                                    1394
         CL    @00,ARITH4FF                                        1394
         BNE   @RF01394                                            1394
*                  AMDNIL = 0;                                     1395
         SLR   @00,@00                                             1395
         STH   @00,AMDNIL(,@04)                                    1395
*              IF AMDNEST = ARITH4FF   /*NO. OF ENTRIES IN IX SECTION*/
*                THEN                                              1396
@RF01394 L     @04,DSBCATPT                                        1396
         LH    @00,AMDNEST(,@04)                                   1396
         CL    @00,ARITH4FF                                        1396
         BNE   @RF01396                                            1396
*                  AMDNEST = 0;                                    1397
         SLR   @00,@00                                             1397
         STH   @00,AMDNEST(,@04)                                   1397
*              IF AMDSSRBA = ARITH4FF  /*RBA OF FIRST SEQ SET REC    */
*                THEN                                              1398
@RF01396 L     @04,DSBCATPT                                        1398
         CLC   AMDSSRBA(4,@04),ARITH4FF                            1398
         BNE   @RF01398                                            1398
*                  AMDSSRBA = 0;                                   1399
         SLR   @00,@00                                             1399
         ST    @00,AMDSSRBA(,@04)                                  1399
*              IF AMDHLRBA = ARITH4FF  /*RBA OF HIGH LEVEL IX REC    */
*                THEN                                              1400
@RF01398 L     @04,DSBCATPT                                        1400
         CLC   AMDHLRBA(4,@04),ARITH4FF                            1400
         BNE   @RF01400                                            1400
*                  AMDHLRBA = 0;                                   1401
         SLR   @00,@00                                             1401
         ST    @00,AMDHLRBA(,@04)                                  1401
*            END;                                                  1402
*                                                                  1402
@RF01400 DS    0H                                                  1403
*        CALL LISTPROC;                                    /*@ZA05939*/
@RF01391 BAL   @14,LISTPROC                                        1403
*        END ALLORNM;                                              1404
*        /************************************************************/
*        /*                                                          */
*        /* IF THE LISTC REQUEST IS FOR EITHER ALLOCATION INFORMATION*/
*        /* OR ALL THE CATALOG DATA, CONTINUE PROCESSING.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1405
*        IF ADDR(FALL) > NULLPTR    ADDR(ALLOC) > NULLPTR         1405
*          THEN                                                    1405
@RF01104 SLR   @04,@04                                             1405
         L     @15,@PC00001+4                                      1405
         C     @04,FDTPTR+56(,@15)                                 1405
         BL    @RT01405                                            1405
         C     @04,FDTPTR+64(,@15)                                 1405
         BNL   @RF01405                                            1405
@RT01405 DS    0H                                                  1406
*ALLORSP:    DO;                                                   1406
ALLORSP  DS    0H                                                  1407
*        DARGSENT = LCST24;            /*SPACE ALLOCATION HEADERS    */
         L     @04,DARGPTR                                         1407
         MVI   DARGSENT(@04),X'18'                                 1407
*        CTGFLPTR = DSSPFPT;                                       1408
         L     @04,DSSPFPT                                         1408
         ST    @04,CTGFLPTR                                        1408
*        IF PRIM = ARITH4FF            /* PRIMARY ALLOC              */
*          THEN                                                    1409
         L     @04,CTGFLPT(,@04)                                   1409
         CLC   PRIM(3,@04),ARITH4FF                                1409
         BNE   @RF01409                                            1409
*            PRIM = ZEROAREA;                                      1410
         MVC   PRIM(3,@04),ZEROAREA                                1410
*        IF SCON = ARITH4FF            /* SECONDARY ALLOC            */
*          THEN                                                    1411
@RF01409 L     @04,CTGFLPTR                                        1411
         L     @04,CTGFLPT(,@04)                                   1411
         CLC   SCON(3,@04),ARITH4FF                                1411
         BNE   @RF01411                                            1411
*            SCON = ZEROAREA;                                      1412
         MVC   SCON(3,@04),ZEROAREA                                1412
*        DARGDBP = CTGFLPT(1);                                     1413
@RF01411 L     @04,DARGPTR                                         1413
         L     @15,CTGFLPTR                                        1413
         L     @14,CTGFLPT(,@15)                                   1413
         ST    @14,DARGDBP(,@04)                                   1413
*        DARGILP = CTGFLNG(1);                                     1414
         L     @15,CTGFLNG(,@15)                                   1414
         STH   @15,DARGILP(,@04)                                   1414
*        DARGCNT = DRGCNT3;                                /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00170                             1415
*        DARGINS(1) = DRGINS10;                            /*@Y30SSMK*/
         LA    @15,10                                              1416
         STH   @15,DARGINS(,@04)                                   1416
*        DARGINL(1) = ABBREVLN;                                    1417
*                                                                  1417
         STH   @15,DARGINL(,@04)                                   1417
*        /************************************************************/
*        /*                                                          */
*        /* INTERPRET THE SPACE OPTION FLAG TO DETERMINE THE TYPE OF */
*        /* ALLOCATION REQUEST.  THEN SETUP THE DARGLIST POINTER TO  */
*        /* THE CORRESPONDING STATIC TEXT ENTRY.                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1418
*        IF SFLG = CANOPTN                                         1418
*          THEN                                                    1418
         TM    SFLG(@14),B'11000000'                               1418
         BNZ   @RF01418                                            1418
*            DARGDTM(1) = ADDR(CANNM); /* CANDIDATE REQUEST          */
         L     @15,TEXTPTR                                         1419
         LA    @00,CANNM(,@15)                                     1419
         ST    @00,DARGDTM(,@04)                                   1419
*          ELSE                                                    1420
*            IF SFLG = RSZOPTN                                     1420
*              THEN                                                1420
         B     @RC01418                                            1420
@RF01418 L     @04,CTGFLPTR                                        1420
         L     @04,CTGFLPT(,@04)                                   1420
         TM    SFLG(@04),B'01000000'                               1420
         BNO   @RF01420                                            1420
         TM    SFLG(@04),B'10000000'                               1420
         BNZ   @RF01420                                            1420
*                DARGDTM(1) = ADDR(RECSZNM); /* RECORD REQUEST       */
         L     @04,TEXTPTR                                         1421
         LA    @04,RECSZNM(,@04)                                   1421
         L     @15,DARGPTR                                         1421
         ST    @04,DARGDTM(,@15)                                   1421
*              ELSE                                                1422
*                IF SFLG = TRKOPTN                                 1422
*                  THEN                                            1422
         B     @RC01420                                            1422
@RF01420 L     @04,CTGFLPTR                                        1422
         L     @04,CTGFLPT(,@04)                                   1422
         TM    SFLG(@04),B'10000000'                               1422
         BNO   @RF01422                                            1422
         TM    SFLG(@04),B'01000000'                               1422
         BNZ   @RF01422                                            1422
*                    DARGDTM(1) = ADDR(TRKNM); /* TRACK REQUEST      */
         L     @04,TEXTPTR                                         1423
         LA    @04,TRKNM(,@04)                                     1423
         L     @15,DARGPTR                                         1423
         ST    @04,DARGDTM(,@15)                                   1423
*                  ELSE                                            1424
*                    IF SFLG = CYLOPTN                             1424
*                      THEN                                        1424
         B     @RC01422                                            1424
@RF01422 L     @04,CTGFLPTR                                        1424
         L     @04,CTGFLPT(,@04)                                   1424
         TM    SFLG(@04),B'11000000'                               1424
         BNO   @RF01424                                            1424
*                        DARGDTM(1) = ADDR(CYLNM); /*CYLINDER REQUEST*/
         L     @04,TEXTPTR                                         1425
         LA    @04,CYLNM(,@04)                                     1425
         L     @15,DARGPTR                                         1425
         ST    @04,DARGDTM(,@15)                                   1425
*                      ELSE                                        1426
*                        DARGDTM(1) = ADDR(NULLNM); /*NOT-INITIALIZED*/
*                                                                  1426
         B     @RC01424                                            1426
@RF01424 L     @04,TEXTPTR                                         1426
         LA    @04,NULLNM(,@04)                                    1426
         L     @15,DARGPTR                                         1426
         ST    @04,DARGDTM(,@15)                                   1426
*        /************************************************************/
*        /*                                                          */
*        /* INCLUDE IN THE DARGLIST INSERT STRUCTURES FOR THE        */
*        /* DATASET HIGH ALLOCATED AND HIGH USED RBA'S.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1427
*        CTGFLPTR = DSHAFPT;                                       1427
@RC01424 DS    0H                                                  1427
@RC01422 DS    0H                                                  1427
@RC01420 DS    0H                                                  1427
@RC01418 L     @04,DSHAFPT                                         1427
         ST    @04,CTGFLPTR                                        1427
*        DARGINS(2) = DRGINS20;                            /*@Y30SSMK*/
         L     @15,DARGPTR                                         1428
         MVC   DARGINS+8(2,@15),@CH00649                           1428
*        DARGINL(2) = CTGFLNG(1);                                  1429
         L     @14,CTGFLNG(,@04)                                   1429
         STH   @14,DARGINL+8(,@15)                                 1429
*        IF DSHA = ARITH4FF                                        1430
*          THEN                                                    1430
         L     @04,CTGFLPT(,@04)                                   1430
         CLC   DSHA(4,@04),ARITH4FF                                1430
         BNE   @RF01430                                            1430
*            DSHA = ZEROAREA;                                      1431
         MVC   DSHA(4,@04),ZEROAREA                                1431
*        DARGDTM(2) = CTGFLPT(1);                                  1432
@RF01430 L     @04,DARGPTR                                         1432
         L     @15,CTGFLPTR                                        1432
         L     @00,CTGFLPT(,@15)                                   1432
         ST    @00,DARGDTM+8(,@04)                                 1432
*        CTGFLPTR = DSHUFPT;                                       1433
         L     @00,DSHUFPT                                         1433
         ST    @00,CTGFLPTR                                        1433
*        DARGINS(3) = DRGINS30;                            /*@Y30SSMK*/
         MVC   DARGINS+16(2,@04),@CH01231                          1434
*        DARGINL(3) = CTGFLNG(1);                                  1435
         LR    @15,@00                                             1435
         L     @15,CTGFLNG(,@15)                                   1435
         STH   @15,DARGINL+16(,@04)                                1435
*        IF DSHU = ARITH4FF                                        1436
*          THEN                                                    1436
         LR    @04,@00                                             1436
         L     @04,CTGFLPT(,@04)                                   1436
         CLC   DSHU(4,@04),ARITH4FF                                1436
         BNE   @RF01436                                            1436
*            DSHU = ZEROAREA;                                      1437
         MVC   DSHU(4,@04),ZEROAREA                                1437
*        DARGDTM(3) = CTGFLPT(1);                                  1438
@RF01436 L     @04,CTGFLPTR                                        1438
         L     @04,CTGFLPT(,@04)                                   1438
         L     @15,DARGPTR                                         1438
         ST    @04,DARGDTM+16(,@15)                                1438
*        CALL LISTPROC;                                            1439
         BAL   @14,LISTPROC                                        1439
*        /************************************************************/
*        /*                                                          */
*        /* NEXT PROCESS THE ALLOCATION INFORMATION COVERING VOLUME  */
*        /* CHARACTERISTICS.  THIS VOLUME OCCURRENCE DATA MAY BE     */
*        /* REPETITIVE.  THE FORMAT OF ONE VOLUME OCCURRENCE IS A    */
*        /* COMBINATION OF FIXED FIELDS FOLLOWED BY VARIABLE LENGTH  */
*        /* KEYS AND EXTENT DATA, EACH PRECEDED BY A LENGTH          */
*        /* DESCRIPTOR.  THEREFORE, A SEPARATE POINTER AND LENGTH    */
*        /* VARIABLE ARE USED TO TRACK THE FIELDS AS THEY ARE        */
*        /* PROCESSED.                                               */
*        /* IF AT LEAST ONE OCCURRENCE OF THE FIXED FIELDS WAS       */
*        /* RETURNED IN THE WORKAREA, BEGIN THE VOLUME ALLOCATION    */
*        /* PROCESSING.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1440
*        CTGFLPTR = DSVLFPT;                                       1440
         L     @06,DSVLFPT                                         1440
         ST    @06,CTGFLPTR                                        1440
*        PGPTR=PGBYTFPT->CTGFLPT(1);                       /*@ZA05939*/
*                                                                  1441
         L     @04,PGBYTFPT                                        1441
         L     PGPTR,CTGFLPT(,@04)                                 1441
*        /************************************************************/
*        /*                                                  @ZA05939*/
*        /* START PROCESSING THE VOLUME ALLOCATION.          @ZA05939*/
*        /*                                                  @ZA05939*/
*        /************************************************************/
*                                                                  1442
*ENTVLOOP:                                                         1442
*        DO WHILE CTGFLNG(1) >= LENGTH(FIXFLDS);                   1442
*                                                                  1442
ENTVLOOP B     @DE01442                                            1442
@DL01442 DS    0H                                                  1443
*          DARGSENT = LCST25;          /*VOL OCCURRENCES HEADER      */
         L     @06,DARGPTR                                         1443
         MVI   DARGSENT(@06),X'19'                                 1443
*          DARGDBP = CTGFLPT(1);                                   1444
         L     @04,CTGFLPTR                                        1444
         L     @15,CTGFLPT(,@04)                                   1444
         ST    @15,DARGDBP(,@06)                                   1444
*          DARGILP = CTGFLNG(1);                                   1445
         L     @04,CTGFLNG(,@04)                                   1445
         STH   @04,DARGILP(,@06)                                   1445
*          IF VEXT = ARITH4FF          /* NUMBER OF EXTENTS          */
*            THEN                                                  1446
         CLC   VEXT(1,@15),ARITH4FF                                1446
         BNE   @RF01446                                            1446
*              VEXT = ZEROAREA;                                    1447
         MVC   VEXT(1,@15),ZEROAREA                                1447
*          IF VHA = ARITH4FF           /* HIGH ALLOCATED RBA         */
*            THEN                                                  1448
@RF01446 L     @06,CTGFLPTR                                        1448
         L     @06,CTGFLPT(,@06)                                   1448
         CLC   VHA(4,@06),ARITH4FF                                 1448
         BNE   @RF01448                                            1448
*              VHA = ZEROAREA;                                     1449
         MVC   VHA(4,@06),ZEROAREA                                 1449
*          IF VHU = ARITH4FF           /*HIGH USED RBA               */
*            THEN                                                  1450
@RF01448 L     @06,CTGFLPTR                                        1450
         L     @06,CTGFLPT(,@06)                                   1450
         CLC   VHU(4,@06),ARITH4FF                                 1450
         BNE   @RF01450                                            1450
*              VHU = ZEROAREA;                                     1451
         MVC   VHU(4,@06),ZEROAREA                                 1451
*          IF BLK = ARITH4FF           /* PHYSICAL RECORD SIZE       */
*            THEN                                                  1452
@RF01450 L     @06,CTGFLPTR                                        1452
         L     @06,CTGFLPT(,@06)                                   1452
         CLC   BLK(4,@06),ARITH4FF                                 1452
         BNE   @RF01452                                            1452
*              BLK = ZEROAREA;                                     1453
         MVC   BLK(4,@06),ZEROAREA                                 1453
*          IF BPT = ARITH4FF           /* PHYRECS PER TRACK          */
*            THEN                                                  1454
@RF01452 L     @06,CTGFLPTR                                        1454
         L     @06,CTGFLPT(,@06)                                   1454
         CLC   BPT(2,@06),ARITH4FF                                 1454
         BNE   @RF01454                                            1454
*              BPT = ARITH4FF;                                     1455
         MVC   BPT(2,@06),ARITH4FF                                 1455
*          IF TPCA = ARITH4FF          /* TRACKS PER C.A.            */
*            THEN                                                  1456
@RF01454 L     @06,CTGFLPTR                                        1456
         L     @06,CTGFLPT(,@06)                                   1456
         CLC   TPCA(2,@06),ARITH4FF                                1456
         BNE   @RF01456                                            1456
*              TPCA = ZEROAREA;                                    1457
         MVC   TPCA(2,@06),ZEROAREA                                1457
*          DARGCNT = DRGCNT1;                              /*@Y30SSMK*/
@RF01456 L     @06,DARGPTR                                         1458
         MVC   DARGCNT(2,@06),@CH00045                             1458
*          DARGINS(1) = DRGINS10;                          /*@Y30SSMK*/
         LA    @04,10                                              1459
         STH   @04,DARGINS(,@06)                                   1459
*          DARGINL(1) = ABBREVLN;                                  1460
*                                                                  1460
         STH   @04,DARGINL(,@06)                                   1460
*          /**********************************************************/
*          /*                                                        */
*          /* INTERPRET THE VOLUME FLAG AND INCLUDE IN THE DARGLIST  */
*          /* THE POINTER TO THE CORRESPONDING STATIC TEXT ENTRY.    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1461
*          IF VPRIM = ON                                           1461
*            THEN                                                  1461
         L     @04,CTGFLPTR                                        1461
         L     @04,CTGFLPT(,@04)                                   1461
         TM    VPRIM(@04),B'10000000'                              1461
         BNO   @RF01461                                            1461
*              DARGDTM(1) = ADDR(PRIMENM); /* PRIME                  */
         L     @04,TEXTPTR                                         1462
         ST    @04,DARGDTM(,@06)                                   1462
*            ELSE                                                  1463
*              IF VCAN = ON                                        1463
*                THEN                                              1463
         B     @RC01461                                            1463
@RF01461 L     @06,CTGFLPTR                                        1463
         L     @06,CTGFLPT(,@06)                                   1463
         TM    VCAN(@06),B'01000000'                               1463
         BNO   @RF01463                                            1463
*                  DARGDTM(1) = ADDR(CANNM); /* CANDIDATE            */
         L     @06,TEXTPTR                                         1464
         LA    @06,CANNM(,@06)                                     1464
         L     @04,DARGPTR                                         1464
         ST    @06,DARGDTM(,@04)                                   1464
*                ELSE                                              1465
*                  IF VOVFL = ON                                   1465
*                    THEN                                          1465
         B     @RC01463                                            1465
@RF01463 L     @06,CTGFLPTR                                        1465
         L     @06,CTGFLPT(,@06)                                   1465
         TM    VOVFL(@06),B'00100000'                              1465
         BNO   @RF01465                                            1465
*                      DARGDTM(1) = ADDR(OVFLONM); /* OVERFLOW       */
         L     @06,TEXTPTR                                         1466
         LA    @06,OVFLONM(,@06)                                   1466
         L     @04,DARGPTR                                         1466
         ST    @06,DARGDTM(,@04)                                   1466
*                    ELSE                                          1467
*                      DARGDTM(1) = ADDR(NULLNM); /* NOT-INITIALIZED */
         B     @RC01465                                            1467
@RF01465 L     @06,TEXTPTR                                         1467
         LA    @06,NULLNM(,@06)                                    1467
         L     @04,DARGPTR                                         1467
         ST    @06,DARGDTM(,@04)                                   1467
*          CALL LISTPROC;                                          1468
*                                                                  1468
@RC01465 DS    0H                                                  1468
@RC01463 DS    0H                                                  1468
@RC01461 BAL   @14,LISTPROC                                        1468
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* OUTPUT THE NO. OF BYTES/TRACK FOR A PAGESPACE DATA ENTRY */
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1469
*        IF PGSPCFLG = ON &           /* IF PAGE SPACE AND   @ZA13553*/
*        CATTRFPT -> CTGFLPT(1) -> PGSWAP=OFF /* NOT SWAP    @ZA13553*/
*          THEN                                                    1469
         TM    PGSPCFLG,B'10000000'                                1469
         BNO   @RF01469                                            1469
         L     @06,CATTRFPT                                        1469
         L     @06,CTGFLPT(,@06)                                   1469
         TM    PGSWAP(@06),B'00000010'                             1469
         BNZ   @RF01469                                            1469
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST46;                            /*@YL026UE*/
         L     @06,DARGPTR                                         1471
         MVI   DARGSENT(@06),X'2E'                                 1471
*            DARGDBP = PGPTR;                              /*@YL026UE*/
         ST    PGPTR,DARGDBP(,@06)                                 1472
*            DARGILP = LENGTH(PGBYTTRK);                   /*@YL026UE*/
         MVC   DARGILP(2,@06),@CH00050                             1473
*            CALL LISTPROC;                                /*@YL026UE*/
         BAL   @14,LISTPROC                                        1474
*            PGPTR = PGPTR + LENGTH(PGBYTTRK);             /*@YL026UE*/
         AL    PGPTR,@CF00050                                      1475
*            END;                                          /*@YL026UE*/
*          /**********************************************************/
*          /*                                                        */
*          /* PROCESS THE FIRST VARIABLE-LENGTH FIELD IN THE VOLUME  */
*          /* OCCURRENCE DATA.  INITIALIZE THE CURRENT LENGTH VALUE  */
*          /* TO THE LENGTH OF THE FIXED FIELDS JUST PROCESSED.      */
*          /* USE THIS VALUE TO UPDATE THE CURRENT POINTER TO THE    */
*          /* FIRST VARIABLE LENGTH FIELD.                           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1477
*          CURRLEN = LENGTH(FIXFLDS);                              1477
@RF01469 LA    CURRLEN,39                                          1477
*          CVARPTR = CTGFLPT(1) + CURRLEN;                         1478
         LR    CVARPTR,CURRLEN                                     1478
         L     @06,CTGFLPTR                                        1478
         AL    CVARPTR,CTGFLPT(,@06)                               1478
*          RESPECIFY VLOWKEY BASED(CVARPTR);                       1479
*                                                                  1479
*          /**********************************************************/
*          /*                                                        */
*          /* IF A LOW KEY EXISTS, BUILD THE DARGLIST TO PRINT IT.   */
*          /* AND UPDATE THE PROCESSED-DATA LENGTH BY THE SIZE       */
*          /* OF THE KEY PLUS THE SIZE OF ITS LENGTH DESCRIPTOR.     */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1480
*          IF VLKYLEN > 0                                          1480
*            THEN                                                  1480
         SLR   @06,@06                                             1480
         ICM   @06,3,VLKYLEN(CVARPTR)                              1480
         LTR   @06,@06                                             1480
         BNP   @RF01480                                            1480
*              DO;                                                 1481
*                CURRLEN = CURRLEN + VLKYLEN + LENGTH(VLKYLEN);    1482
         LR    @04,CURRLEN                                         1482
         ALR   @04,@06                                             1482
         AL    @04,@CF00161                                        1482
         LR    CURRLEN,@04                                         1482
*                DARGSENT = LCST26;                                1483
         L     @04,DARGPTR                                         1483
         MVI   DARGSENT(@04),X'1A'                                 1483
*                DARGDBP = ADDR(VLKY);                             1484
         LA    @00,VLKY(,CVARPTR)                                  1484
         ST    @00,DARGDBP(,@04)                                   1484
*                DARGILP = VLKYLEN;                                1485
         STH   @06,DARGILP(,@04)                                   1485
*                CALL LISTPROC;                                    1486
         BAL   @14,LISTPROC                                        1486
*              END;                                                1487
*            ELSE                                                  1488
*                                                                  1488
*              /******************************************************/
*              /*                                                    */
*              /* NO LOW KEY TO PRINT.  UPDATE THE PROCESSED-DATA    */
*              /* LENGTH BY THE SIZE OF THE LOW KEY LENGTH           */
*              /* DESCRIPTOR.                                        */
*              /*                                                    */
*              /******************************************************/
*                                                                  1488
*              CURRLEN = CURRLEN + LENGTH(VLKYLEN);                1488
         B     @RC01480                                            1488
@RF01480 AL    CURRLEN,@CF00161                                    1488
*          /**********************************************************/
*          /*                                                        */
*          /* PROCESS THE HIGH KEY, THE NEXT VARIABLE-LENGTH FIELD   */
*          /* IN THE VOLUME OCCURRENCE DATA.                         */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1489
*          CVARPTR = CTGFLPT(1) + CURRLEN;                         1489
@RC01480 LR    CVARPTR,CURRLEN                                     1489
         L     @06,CTGFLPTR                                        1489
         AL    CVARPTR,CTGFLPT(,@06)                               1489
*          RESPECIFY VHIKEY BASED(CVARPTR);                        1490
*          IF VHKYLEN > 0                                          1491
*            THEN                                                  1491
         SLR   @06,@06                                             1491
         ICM   @06,3,VHKYLEN(CVARPTR)                              1491
         LTR   @06,@06                                             1491
         BNP   @RF01491                                            1491
*              DO;                                                 1492
*                CURRLEN = CURRLEN + VHKYLEN + LENGTH(VHKYLEN);    1493
         LR    @04,CURRLEN                                         1493
         ALR   @04,@06                                             1493
         AL    @04,@CF00161                                        1493
         LR    CURRLEN,@04                                         1493
*                DARGSENT = LCST27;                                1494
         L     @04,DARGPTR                                         1494
         MVI   DARGSENT(@04),X'1B'                                 1494
*                DARGDBP = ADDR(VHKY);                             1495
         LA    @00,VHKY(,CVARPTR)                                  1495
         ST    @00,DARGDBP(,@04)                                   1495
*                DARGILP = VHKYLEN;                                1496
         STH   @06,DARGILP(,@04)                                   1496
*                CALL LISTPROC;                                    1497
*                                                                  1497
         BAL   @14,LISTPROC                                        1497
*                /****************************************************/
*                /*                                                  */
*                /* WHEN A HIGH KEY EXISTS AND THE ENTRY BEING       */
*                /* PROCESSED IS TYPE DATA, PRINT THE RBA OF THE     */
*                /* CONTROL INTERVAL CONTAINING THE HIGH KEY.        */
*                /* NOTE - THIS IS A FIXED FIELD THAT PRECEDES ALL   */
*                /* VARIALBE LENGTH DATA AND IS NOT INCLUDED IN THE  */
*                /* CURRENT POINTER AND LENGTH UPDATES.              */
*                /*                                                  */
*                /****************************************************/
*                                                                  1498
*                IF ETYPFPT->CTGFLPT(1)->ETYP = CTGTDATA  &        1498
*                  VHKR ^= ARITH4FF                                1498
*                  THEN                                            1498
         L     @06,ETYPFPT                                         1498
         L     @06,CTGFLPT(,@06)                                   1498
         CLI   ETYP(@06),C'D'                                      1498
         BNE   @RF01498                                            1498
         L     @06,CTGFLPTR                                        1498
         L     @06,CTGFLPT(,@06)                                   1498
         CLC   VHKR(4,@06),ARITH4FF                                1498
         BE    @RF01498                                            1498
*                    DO;                                           1499
*                    DARGSENT = LCST28;                            1500
         L     @04,DARGPTR                                         1500
         MVI   DARGSENT(@04),X'1C'                                 1500
*                    DARGDBP = ADDR(VHKR);                         1501
         LA    @06,VHKR(,@06)                                      1501
         ST    @06,DARGDBP(,@04)                                   1501
*                    DARGILP = LENGTH(VHKR);                       1502
         MVC   DARGILP(2,@04),@CH00050                             1502
*                    CALL LISTPROC;                                1503
         BAL   @14,LISTPROC                                        1503
*                    END;                                          1504
*              END;                                                1505
*            ELSE                                                  1506
*              CURRLEN = CURRLEN + LENGTH(VHKYLEN);                1506
         B     @RC01491                                            1506
@RF01491 AL    CURRLEN,@CF00161                                    1506
*          /**********************************************************/
*          /*                                                        */
*          /* PROCESS THE LAST VARIABLE-LENGTH FIELD COVERING        */
*          /* PHYSICAL AND LOGICAL EXTENT INFORMATION.               */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1507
*          CVARPTR = CTGFLPT(1) + CURRLEN;                         1507
@RC01491 LR    CVARPTR,CURRLEN                                     1507
         L     @06,CTGFLPTR                                        1507
         AL    CVARPTR,CTGFLPT(,@06)                               1507
*          RESPECIFY CCHHS BASED(CVARPTR);                         1508
*          IF CCHHLEN >= LENGTH(CCHH)                              1509
*            THEN                                                  1509
         LA    @06,20                                              1509
         SLR   @04,@04                                             1509
         ICM   @04,3,CCHHLEN(CVARPTR)                              1509
         CR    @04,@06                                             1509
         BL    @RF01509                                            1509
*              DO;                                                 1510
*                CURRLEN = CURRLEN + CCHHLEN + LENGTH(CCHHLEN);    1511
         LR    @00,CURRLEN                                         1511
         ALR   @00,@04                                             1511
         AL    @00,@CF00161                                        1511
         LR    CURRLEN,@00                                         1511
*                DARGSENT = LCST29;    /*EXTENT STATISTICS HEADER    */
         L     @15,DARGPTR                                         1512
         MVI   DARGSENT(@15),X'1D'                                 1512
*                DARGDBP = ADDR(CCHH);                             1513
         LA    @14,CCHH(,CVARPTR)                                  1513
         ST    @14,DARGDBP(,@15)                                   1513
*                DARGILP = CCHHLEN;                                1514
         STH   @04,DARGILP(,@15)                                   1514
*                DARGCNT = DRGCNT1;                        /*@Y30SSMK*/
*                                                                  1515
         LA    @14,1                                               1515
         STH   @14,DARGCNT(,@15)                                   1515
*                /****************************************************/
*                /*                                                  */
*                /* BECASUE THE EXTENT INFORMATION IS REPLICATED IN  */
*                /* A CONTIGUOUS AREA, THE TEXT PROCESSOR REPLICATION*/
*                /* FEATURE IS USED TO FORMAT AND PRINT THE EXTENT   */
*                /* FIELDS IN A REPETITIVE MANNER.                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  1516
*                DARGREP(1) = DRGREP10;                    /*@Y30SSMK*/
         MVC   DARGREP(2,@15),@CH00457                             1516
*                DARGPCT(1) = CCHHLEN/LENGTH(CCHH);                1517
         LR    @01,@04                                             1517
         SLR   @00,@00                                             1517
         DR    @00,@06                                             1517
         STH   @01,DARGPCT(,@15)                                   1517
*                DARGDTM(1) = 0;                                   1518
*                                                                  1518
         SLR   @06,@06                                             1518
         ST    @06,DARGDTM(,@15)                                   1518
*                /****************************************************/
*                /*                                                  */
*                /* ZERO-OUT ANY NON-INITIALIZED ARITHMETIC FIELDS   */
*                /* BEFORE PRINTING TO INSURE PRINTABILITY.          */
*                /*                                                  */
*                /****************************************************/
*                                                                  1519
*                DO CKK = 1 TO DARGPCT(1);                         1519
         LR    CKK,@14                                             1519
         B     @DE01519                                            1519
@DL01519 DS    0H                                                  1520
*                  IF TT(CKK) = ARITH4FF                           1520
*                    THEN                                          1520
         LR    @04,CKK                                             1520
         MH    @04,@CH00649                                        1520
         ST    @04,@TF00001                                        1520
         ALR   @04,CVARPTR                                         1520
         AL    @04,@CF01761                                        1520
         CLC   TT-12(2,@04),ARITH4FF                               1520
         BNE   @RF01520                                            1520
*                      TT(CKK) = ZEROAREA;                         1521
         LR    @04,CVARPTR                                         1521
         AL    @04,@TF00001                                        1521
         AL    @04,@CF01761                                        1521
         MVC   TT-12(2,@04),ZEROAREA                               1521
*                  IF DDDD1(CKK) = ARITH4FF                        1522
*                    THEN                                          1522
@RF01520 LR    @04,CKK                                             1522
         MH    @04,@CH00649                                        1522
         ST    @04,@TF00001                                        1522
         ALR   @04,CVARPTR                                         1522
         AL    @04,@CF01762                                        1522
         CLC   DDDD1-14(4,@04),ARITH4FF                            1522
         BNE   @RF01522                                            1522
*                      DDDD1(CKK) = ZEROAREA;                      1523
         LR    @04,CVARPTR                                         1523
         AL    @04,@TF00001                                        1523
         AL    @04,@CF01762                                        1523
         MVC   DDDD1-14(4,@04),ZEROAREA                            1523
*                  IF DDDD2(CKK) = ARITH4FF                        1524
*                    THEN                                          1524
@RF01522 LR    @04,CKK                                             1524
         MH    @04,@CH00649                                        1524
         ST    @04,@TF00001                                        1524
         ALR   @04,CVARPTR                                         1524
         BCTR  @04,0                                               1524
         BCTR  @04,0                                               1524
         CLC   DDDD2-18(4,@04),ARITH4FF                            1524
         BNE   @RF01524                                            1524
*                      DDDD2(CKK) = ZEROAREA;                      1525
         LR    @04,CVARPTR                                         1525
         AL    @04,@TF00001                                        1525
         BCTR  @04,0                                               1525
         BCTR  @04,0                                               1525
         MVC   DDDD2-18(4,@04),ZEROAREA                            1525
*                END;                                              1526
@RF01524 AL    CKK,@CF00045                                        1526
@DE01519 L     @04,DARGPTR                                         1526
         CH    CKK,DARGPCT(,@04)                                   1526
         BNH   @DL01519                                            1526
*                CALL LISTPROC;                                    1527
         BAL   @14,LISTPROC                                        1527
*              END;                                                1528
*            ELSE                                                  1529
*              CURRLEN = CURRLEN + LENGTH(CCHHLEN);                1529
         B     @RC01509                                            1529
@RF01509 AL    CURRLEN,@CF00161                                    1529
*          /**********************************************************/
*          /*                                                        */
*          /* ONE VOLUME OCCURRENCE HAS BEEN PROCESSED.  UPDATE THE  */
*          /* FPL POINTER TO THE NEXT OCCURRENCE IN THE WORKAREA.    */
*          /* AND DECREMENT THE FPL LENGTH BY THE AMOUNT OF DATA     */
*          /* JUST PROCESSED.  UPON THE NEXT PASS THROUGH THE VOLUME */
*          /* ALLOCATION INFORMATION, THIS FPL LENGTH WILL BE CHECKED*/
*          /* TO ASSURE THAT THE NEXT VOLUME OCCURRENCE CONTAINS AT  */
*          /* LEAST ALL FIXED-FIELD DATA FOR PROCESSING.             */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1530
*          CTGFLPT(1) = CTGFLPT(1) + CURRLEN;                      1530
@RC01509 L     @06,CTGFLPTR                                        1530
         LR    @04,CURRLEN                                         1530
         AL    @04,CTGFLPT(,@06)                                   1530
         ST    @04,CTGFLPT(,@06)                                   1530
*          CTGFLNG(1) = CTGFLNG(1) - CURRLEN;                      1531
         L     @04,CTGFLNG(,@06)                                   1531
         SLR   @04,CURRLEN                                         1531
         ST    @04,CTGFLNG(,@06)                                   1531
*        END ENTVLOOP;                                             1532
@DE01442 L     @06,CTGFLPTR                                        1532
         L     @06,CTGFLNG(,@06)                                   1532
         C     @06,@CF01247                                        1532
         BNL   @DL01442                                            1532
*        END ALLORSP;                                              1533
*        /************************************************************/
*        /*                                                          */
*        /* PROCESSING OF A DATA OR INDEX ENTRY IS COMPLETED.        */
*        /* EXIT FROM THE CLUSTER/DATA/INDEX FORMATTING ROUTINE.     */
*        /* RETURN TO THE ROUTING PROCEDURE.                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1534
*        RETURN CODE(0);                                           1534
@RF01405 SLR   @15,@15                                             1534
         L     @13,4(,@13)                                         1534
         L     @14,12(,@13)                                        1534
         LM    @00,@12,20(@13)                                     1534
         BR    @14                                                 1534
*        END CDIPROC;                                              1535
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE - VPROC                                        */
*        /*                                                          */
*        /* FUNCTION - REPETITIVELY BUILDS THE AMS TEXT PROCESSOR    */
*        /*            DYNAMIC DATA ARGUMENT LIST FOR FORMATTING AND */
*        /*            LISTING THE VSAM CATALOG FIELDS FOR A VOLUME  */
*        /*            RECORD ENTRY.  LISTPROC IS REPEATEDLY INVOKED */
*        /*            TO PRINT THE DATA.                            */
*        /*                                                          */
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM CATALOG DATA    */
*        /*         RETRIEVED VIA A LOCATE REQUEST, THE VSAM CPL     */
*        /*         AND FPL'S AND THE AMS GDT AND FDT                */
*        /*         AND FROM STATIC TEXT                             */
*        /*         THE PRE-FORMATTED DESCRIPTORS FOR EDITING THE    */
*        /*         CATALOG DATA.                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1536
*VPROC:  PROCEDURE OPTIONS(SAVEAREA);                      /*@ZA05939*/
*                                                                  1536
VPROC    STM   @14,@12,12(@13)                                     1536
         ST    @13,@SA00008+4                                      1536
         LA    @14,@SA00008                                        1536
         ST    @14,8(,@13)                                         1536
         LR    @13,@14                                             1536
*        GEN(ENTRY VPROC);             /*EXT ENTRY POINT     @ZA05939*/
         ENTRY VPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  1538
         LM    REG8,REG12,BASESAVE                                 1538
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL VARIABLES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1539
*        DCL VHDRLEN   FIXED(31);      /*LEN OF REPEATING DSP INFO   */
*        DCL VXDESLEN  FIXED(31);      /*LEN OF REPEATING EXTENT INFO*/
*        DCL VDIRLEN   FIXED(31);      /*LEN OF REPEATING DS INFO    */
*        DCL VWKA      FIXED(31);      /*FOR LENGTH CALCULATIONS     */
*        DCL VSER#LEN  FIXED(8) CONSTANT(6); /*VOL SUBSET INFO       */
*        DCL VXTITLSW  BIT(1);         /*CONTROLS EXTENT TITLE O/P   */
*        DCL VDSHDRSW  BIT(1);         /*CONTROLS DS DIRECT TITLE O/P*/
*        DCL VMM       FIXED(15);      /*DO GROUP CONTROL VARIABLE   */
*        DCL VDSFPL    CHAR(*) BASED;  /*OVERLAY OF ENTRYNAME FPL    */
*        /************************************************************/
*        /*                                                          */
*        /* LIST THE ENTRYNAME AND TYPE.  EXIT IF NAME OR HISTORY    */
*        /* SUBSET WAS REQUESTED.                            @Y30LSMK*/
*        /* IF THE PROPER PASSWORD WAS NOT PROVIDED, PICK UP THE     */
*        /* ENTRY NAME FROM THE WORK AREA.                   @Y30LSMK*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1548
*        OLDERID2 = NEWERID2;                                      1548
         L     @04,@PC00001                                        1548
         L     @04,GDTTR2(,@04)                                    1548
         MVC   @TS00001(95),NEWERID2(@04)                          1548
         MVC   OLDERID2(95,@04),@TS00001                           1548
*        NEWID2 = 'LCVL';                                          1549
*                                                                  1549
         MVC   NEWID2(4,@04),@CC01670                              1549
*        VTYPCNT = VTYPCNT + 1;                                    1550
         LA    @04,1                                               1550
         AL    @04,VTYPCNT                                         1550
         ST    @04,VTYPCNT                                         1550
*        DARGSENT = LCST05;            /*VOLUME ENTRY HEADER         */
         L     @04,DARGPTR                                         1551
         MVI   DARGSENT(@04),X'05'                                 1551
*        IF CATRC = CRCBADPW & ADDR(NAME) > NULLPTR                1552
*          THEN                                                    1552
         CLC   CATRC(2),@CH01280                                   1552
         BNE   @RF01552                                            1552
         L     @15,@PC00001+4                                      1552
         L     @15,FDTPTR+52(,@15)                                 1552
         LTR   @15,@15                                             1552
         BNP   @RF01552                                            1552
*            DO;                                                   1553
*            DARGDBP = ADDR(SUPPDSNM);                             1554
         L     @01,CTGPLPTR                                        1554
         L     @01,CTGWKA(,@01)                                    1554
         LA    @15,SUPPDSNM(,@01)                                  1554
         ST    @15,DARGDBP(,@04)                                   1554
*            DARGILP = LENGTH(SUPPDSNM);                           1555
         MVC   DARGILP(2,@04),@CH00606                             1555
*            END;                                                  1556
*          ELSE                                                    1557
*            DO;                                                   1557
         B     @RC01552                                            1557
@RF01552 DS    0H                                                  1558
*            DARGDBP = ENT44FPT->CTGFLPT(1);                       1558
         L     @04,DARGPTR                                         1558
         L     @01,ENT44FPT                                        1558
         L     @15,CTGFLPT(,@01)                                   1558
         ST    @15,DARGDBP(,@04)                                   1558
*            DARGILP = VSER#LEN;                                   1559
         MVC   DARGILP(2,@04),@CH00164                             1559
*            END;                                                  1560
*        CALL LISTPROC;                                            1561
*                                                                  1561
@RC01552 BAL   @14,LISTPROC                                        1561
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* IF THE CATNAME SUBTITLE IS NOT USED, IDENTIFY THE        */
*        /* CATALOG FOR EACH ENTRY VIA A CATNAME HEADER.     @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1562
*        IF NOTTLFLG = ON                                          1562
*          THEN                                                    1562
         TM    NOTTLFLG,B'10000000'                                1562
         BNO   @RF01562                                            1562
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST40;                            /*@YL026UE*/
         L     @04,DARGPTR                                         1564
         MVI   DARGSENT(@04),X'28'                                 1564
*            DARGDBP = ADDR(CATNAME);                      /*@YL026UE*/
         LA    @15,CATNAME                                         1565
         ST    @15,DARGDBP(,@04)                                   1565
*            DARGILP = LENGTH(CATNAME);                    /*@YL026UE*/
         MVC   DARGILP(2,@04),@CH00606                             1566
*            CALL LISTPROC;                                /*@YL026UE*/
         BAL   @14,LISTPROC                                        1567
*            END;                                          /*@YL026UE*/
*                                                                  1568
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* EXIT HERE IF ONLY THE NAME SUBSET WAS REQUESTED. @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1569
*        IF ADDR(NAME) > NULLPTR                                   1569
*          THEN                                                    1569
@RF01562 SLR   @04,@04                                             1569
         L     @15,@PC00001+4                                      1569
         C     @04,FDTPTR+52(,@15)                                 1569
         BNL   @RF01569                                            1569
*            RETURN CODE (0);                                      1570
         LR    @15,@04                                             1570
         L     @13,4(,@13)                                         1570
         L     @14,12(,@13)                                        1570
         LM    @00,@12,20(@13)                                     1570
         BR    @14                                                 1570
*        /************************************************************/
*        /*                                                          */
*        /* EXIT UPON USER ERROR WHEN PROCESSING AN ENTRIES LIST AND */
*        /* THIS RETRIEVED ENTRY TYPE CONFLICTS WITH THE ALLOCATION  */
*        /* SUBSET REQUEST.                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1571
*        IF ADDR(ALLOC) > NULLPTR                                  1571
*          THEN                                                    1571
@RF01569 L     @04,@PC00001+4                                      1571
         L     @04,FDTPTR+64(,@04)                                 1571
         LTR   @04,@04                                             1571
         BNP   @RF01571                                            1571
*            DO;                                                   1572
*              ERRARGPT->DARGSMOD = LC1ID;                         1573
         L     @04,ERRARGPT                                        1573
         MVC   DARGSMOD(3,@04),@CC01297                            1573
*              ERRARGPT->DARGSENT = LCMSG04;                       1574
         MVI   DARGSENT(@04),X'04'                                 1574
*              SAVRC = MAX (SAVRC, LASTCC08);              /*@ZA05939*/
         LH    @04,SAVRC                                           1575
         LA    @15,8                                               1575
         CR    @04,@15                                             1575
         BNL   *+6
         LR    @04,@15                                             1575
         STH   @04,SAVRC                                           1575
*              RETURN CODE (SAVRC);                        /*@ZA05939*/
         LR    @15,@04                                             1576
         L     @13,4(,@13)                                         1576
         L     @14,12(,@13)                                        1576
         LM    @00,@12,20(@13)                                     1576
         BR    @14                                                 1576
*            END;                                                  1577
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* BUILD THE TEXT PROCESSOR DARGLIST FOR PRINTING   @Y30SSMK*/
*        /* THE RELEASE AND CATALOG RECOVERY FIELDS.         @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1578
*        IF ADDR(NAME) = NULLPTR                                   1578
*          THEN                                                    1578
@RF01571 L     @04,@PC00001+4                                      1578
         L     @04,FDTPTR+52(,@04)                                 1578
         LTR   @04,@04                                             1578
         BNZ   @RF01578                                            1578
*            DO;                                           /*@Y30SSMK*/
*              CTGFLPTR = RELFPT;                          /*@Y30SSMK*/
         L     @04,RELFPT                                          1580
         ST    @04,CTGFLPTR                                        1580
*              DARGDBP = CTGFLPT(1);                       /*@Y30SSMK*/
         L     @15,DARGPTR                                         1581
         L     @14,CTGFLPT(,@04)                                   1581
         ST    @14,DARGDBP(,@15)                                   1581
*              DARGILP = CTGFLNG(1);                       /*@Y30SSMK*/
         L     @04,CTGFLNG(,@04)                                   1582
         STH   @04,DARGILP(,@15)                                   1582
*              DSREL = DSREL +1;       /* CALCULATE REL NO.  @Y30SSMK*/
         LA    @04,1                                               1583
         SLR   @03,@03                                             1583
         IC    @03,DSREL(,@14)                                     1583
         ALR   @04,@03                                             1583
         STC   @04,DSREL(,@14)                                     1583
*              IF DSSER = ZEROAREA                                 1584
*                THEN                                              1584
         CLC   DSSER(6,@14),ZEROAREA                               1584
         BNE   @RF01584                                            1584
*                  DARGSENT = LCST47;  /*EXCLUDE CRA         @ZA05939*/
         MVI   DARGSENT(@15),X'2F'                                 1585
*                ELSE                                              1586
*                  DARGSENT = LCST56;  /*INCLUDE CRA         @ZA05939*/
         B     @RC01584                                            1586
@RF01584 L     @04,DARGPTR                                         1586
         MVI   DARGSENT(@04),X'38'                                 1586
*              CALL LISTPROC;                              /*@Y30SSMK*/
@RC01584 BAL   @14,LISTPROC                                        1587
*            END;                                          /*@Y30SSMK*/
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* EXIT HERE IF ONLY THE HISTORY SUBSET WAS REQUESTED.      */
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  1589
*        IF ADDR(HIST) > NULLPTR                                   1589
*          THEN                                                    1589
@RF01578 SLR   @04,@04                                             1589
         L     @15,@PC00001+4                                      1589
         C     @04,FDTPTR+104(,@15)                                1589
         BNL   @RF01589                                            1589
*            RETURN CODE(0);                               /*@Y30SSMK*/
         LR    @15,@04                                             1590
         L     @13,4(,@13)                                         1590
         L     @14,12(,@13)                                        1590
         LM    @00,@12,20(@13)                                     1590
         BR    @14                                                 1590
*        /************************************************************/
*        /*                                                          */
*        /* FOR A VOLUME SUBSET REQUEST, LIST THE VOLUME SERIAL AND  */
*        /* DEVICE TYPE DATA.  EXIT.                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1591
*        IF ADDR(VOL) > NULLPTR                                    1591
*          THEN                                                    1591
@RF01589 L     @04,@PC00001+4                                      1591
         L     @04,FDTPTR+60(,@04)                                 1591
         LTR   @04,@04                                             1591
         BNP   @RF01591                                            1591
*            DO;                                                   1592
*              DARGSENT = LCST34;      /*VOL SERIAL AND DEVICE HEADER*/
         L     @04,DARGPTR                                         1593
         MVI   DARGSENT(@04),X'22'                                 1593
*              CALL LISTPROC;                                      1594
*                                                                  1594
         BAL   @14,LISTPROC                                        1594
*              DARGSENT = LCST12;      /*VOL SERIAL AND DEVICE DATA  */
         L     @04,DARGPTR                                         1595
         MVI   DARGSENT(@04),X'0C'                                 1595
*              DARGCNT = DRGCNT2;                          /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00161                             1596
*              DARGINS(1) = DRGINS10;                      /*@Y30SSMK*/
         MVC   DARGINS(2,@04),@CH00457                             1597
*              DARGINL(1) = VSER#LEN;                              1598
*                                                                  1598
         MVC   DARGINL(2,@04),@CH00164                             1598
*              /*REPEAT VOL SER NO. FROM VOL ENTRYNAME               */
*              DARGDTM(1) = ENT44FPT->CTGFLPT(1);                  1599
*                                                                  1599
         L     @01,ENT44FPT                                        1599
         L     @15,CTGFLPT(,@01)                                   1599
         ST    @15,DARGDTM(,@04)                                   1599
*              /*OBTAIN DEVICE TYPE                                  */
*              CTGFLPTR = VCHARFPT;                                1600
         L     @15,VCHARFPT                                        1600
         ST    @15,CTGFLPTR                                        1600
*              DARGINS(2) = DRGINS20;                      /*@Y30SSMK*/
         MVC   DARGINS+8(2,@04),@CH00649                           1601
*              DARGINL(2) = LENGTH(VDEV);                          1602
         MVC   DARGINL+8(2,@04),@CH00050                           1602
*              DARGDTM(2) = ADDR(VDEV);                            1603
*                                                                  1603
         L     @15,CTGFLPT(,@15)                                   1603
         ST    @15,DARGDTM+8(,@04)                                 1603
*              CALL LISTPROC;                                      1604
         BAL   @14,LISTPROC                                        1604
*              RETURN CODE (0);                                    1605
         SLR   @15,@15                                             1605
         L     @13,4(,@13)                                         1605
         L     @14,12(,@13)                                        1605
         LM    @00,@12,20(@13)                                     1605
         BR    @14                                                 1605
*            END;                                                  1606
*        /************************************************************/
*        /*                                                          */
*        /* LIST THE NON-REPEATING VOLUME CHARACTERISTICS AND        */
*        /* STATISTICS.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1607
*        DARGSENT = LCST30;            /*VOLUME CHARACTERISTICS HDR  */
@RF01591 L     @04,DARGPTR                                         1607
         MVI   DARGSENT(@04),X'1E'                                 1607
*        DARGDBP = VCHARFPT->CTGFLPT(1); /*VOL CHAR DATA             */
         L     @15,VCHARFPT                                        1608
         L     @14,CTGFLPT(,@15)                                   1608
         ST    @14,DARGDBP(,@04)                                   1608
*        DARGILP = VCHARFPT->CTGFLNG(1);                           1609
         L     @15,CTGFLNG(,@15)                                   1609
         STH   @15,DARGILP(,@04)                                   1609
*        DARGCNT = DRGCNT4;                                /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00050                             1610
*        CTGFLPTR = VTIMEFPT;                                      1611
         L     @15,VTIMEFPT                                        1611
         ST    @15,CTGFLPTR                                        1611
*        DARGINS(1) = DRGINS10;        /*VOL TIMESTAMP       @Y30SSMK*/
         MVC   DARGINS(2,@04),@CH00457                             1612
*        DARGINL(1) = CTGFLNG(1);                                  1613
         L     @14,CTGFLNG(,@15)                                   1613
         STH   @14,DARGINL(,@04)                                   1613
*        DARGDTM(1) = CTGFLPT(1);                                  1614
         L     @15,CTGFLPT(,@15)                                   1614
         ST    @15,DARGDTM(,@04)                                   1614
*        CTGFLPTR = VSYSXFPT;                                      1615
         L     @15,VSYSXFPT                                        1615
         ST    @15,CTGFLPTR                                        1615
*        DARGINS(2) = DRGINS20;        /*MAX. DS EXTENTS ALLOWABLE   */
         MVC   DARGINS+8(2,@04),@CH00649                           1616
*        DARGINL(2) = CTGFLNG(1);                                  1617
         L     @14,CTGFLNG(,@15)                                   1617
         STH   @14,DARGINL+8(,@04)                                 1617
*        DARGDTM(2) = CTGFLPT(1);                                  1618
         L     @15,CTGFLPT(,@15)                                   1618
         ST    @15,DARGDTM+8(,@04)                                 1618
*        IF VSYSX = ARITH4FF                                       1619
*          THEN                                                    1619
         CLC   VSYSX(1,@15),ARITH4FF                               1619
         BNE   @RF01619                                            1619
*            VSYSX = ZEROAREA;                                     1620
         MVC   VSYSX(1,@15),ZEROAREA                               1620
*        CTGFLPTR = V#DSFPT;                                       1621
@RF01619 L     @04,V#DSFPT                                         1621
         ST    @04,CTGFLPTR                                        1621
*        IF V#DS = ARITH4FF                                        1622
*          THEN                                                    1622
         L     @04,CTGFLPT(,@04)                                   1622
         CLC   V#DS(2,@04),ARITH4FF                                1622
         BNE   @RF01622                                            1622
*            V#DS = ZEROAREA;                                      1623
         MVC   V#DS(2,@04),ZEROAREA                                1623
*        DARGINS(3) = DRGINS30;        /*DATA SETS ON VOL    @Y30SSMK*/
@RF01622 L     @04,DARGPTR                                         1624
         MVC   DARGINS+16(2,@04),@CH01231                          1624
*        DARGINL(3) = CTGFLNG(1);                                  1625
         L     @15,CTGFLPTR                                        1625
         L     @14,CTGFLNG(,@15)                                   1625
         STH   @14,DARGINL+16(,@04)                                1625
*        DARGDTM(3) = CTGFLPT(1);                                  1626
         L     @15,CTGFLPT(,@15)                                   1626
         ST    @15,DARGDTM+16(,@04)                                1626
*        CTGFLPTR = V#DSPFPT;                                      1627
         L     @04,V#DSPFPT                                        1627
         ST    @04,CTGFLPTR                                        1627
*        IF V#DSP = ARITH4FF                                       1628
*          THEN                                                    1628
         L     @04,CTGFLPT(,@04)                                   1628
         CLC   V#DSP(2,@04),ARITH4FF                               1628
         BNE   @RF01628                                            1628
*            V#DSP = ZEROAREA;                                     1629
         MVC   V#DSP(2,@04),ZEROAREA                               1629
*        DARGINS(4) = DRGINS40;        /*DATA SPACES ON VOL  @Y30SSMK*/
@RF01628 L     @04,DARGPTR                                         1630
         MVC   DARGINS+24(2,@04),@CH01249                          1630
*        DARGINL(4) = CTGFLNG(1);                                  1631
         L     @15,CTGFLPTR                                        1631
         L     @14,CTGFLNG(,@15)                                   1631
         STH   @14,DARGINL+24(,@04)                                1631
*        DARGDTM(4) = CTGFLPT(1);                                  1632
         L     @15,CTGFLPT(,@15)                                   1632
         ST    @15,DARGDTM+24(,@04)                                1632
*        CALL LISTPROC;                                            1633
         BAL   @14,LISTPROC                                        1633
*        /************************************************************/
*        /*                                                          */
*        /* FOR A CANDIDATE VOLUME, NO DATASPACE INFORMATION EXISTS. */
*        /* FOR A NON-CANDIDATE VOLUME LOGICALLY LIST FOR EACH       */
*        /* DATASPACE ON THE VOLUME, THE EXTENT AND DATASET INFOR-   */
*        /* MATION.                                                  */
*        /* INITIALIZE WORKAREA LENGTHS AND POINTERS FOR ADVANCING   */
*        /* THROUGH THIS VARIABLE LENGTH, REPEATING DATA.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  1634
*        CTGFLPTR = VHDRFPT;           /*POSITION TO THE DSP FPL     */
         L     @04,VHDRFPT                                         1634
         ST    @04,CTGFLPTR                                        1634
*        IF CTGFLNG(1) > 0  &  CTGFLPT(1) > NULLPTR                1635
*          THEN                                                    1635
         SLR   @15,@15                                             1635
         L     @14,CTGFLNG(,@04)                                   1635
         CR    @14,@15                                             1635
         BNH   @RF01635                                            1635
         L     @04,CTGFLPT(,@04)                                   1635
         CR    @04,@15                                             1635
         BNH   @RF01635                                            1635
*            DO;                                                   1636
         ST    @04,@TF00001                                        1636
*              VHDRPTR = CTGFLPT(1);                               1637
         L     @03,@TF00001                                        1637
         ST    @03,VHDRPTR                                         1637
*              VHDRLEN = CTGFLNG(1);                               1638
*                                                                  1638
         LR    VHDRLEN,@14                                         1638
*              CTGFLPTR = VXDESFPT;    /*POSITION TO DSP EXTENT FPL  */
         L     @14,VXDESFPT                                        1639
         ST    @14,CTGFLPTR                                        1639
*              IF CTGFLNG(1) > 0  &  CTGFLPT(1) > NULLPTR          1640
*                THEN                                              1640
         L     @03,CTGFLNG(,@14)                                   1640
         CR    @03,@15                                             1640
         BNH   @RF01640                                            1640
         L     @14,CTGFLPT(,@14)                                   1640
         CR    @14,@15                                             1640
         BNH   @RF01640                                            1640
*                  DO;                                             1641
*                    VXDESPTR = CTGFLPT(1);                        1642
         LR    VXDESPTR,@14                                        1642
*                    VXDESLEN = CTGFLNG(1);                        1643
         ST    @03,VXDESLEN                                        1643
*                  END;                                            1644
*                ELSE                  /*NO DATASPACE EXTENT INFO    */
*                  VXDESLEN = 0;                                   1645
         B     @RC01640                                            1645
@RF01640 SLR   @15,@15                                             1645
         ST    @15,VXDESLEN                                        1645
*            END;                                                  1646
*          ELSE                        /*NO DATASPACES ON VOL        */
*            VHDRLEN = 0;                                          1647
         B     @RC01635                                            1647
@RF01635 SLR   VHDRLEN,VHDRLEN                                     1647
*        /************************************************************/
*        /*                                                          */
*        /* ALL SUBSEQUENT PROCESSING OF THE SPACE ENTRY INFORMATION */
*        /* INVOLVES THE FORMATTING OF                               */
*        /*  1) A DATASPACE DESCRIPTOR FROM THE DATASPACE-HEADER     */
*        /*     FIELDS, AND                                          */
*        /*  2) THE EXTENT FIELDS SIGNIFICANT TO THE DATASPACE-HEADER*/
*        /*     JUST PROCESSED, AND                                  */
*        /*  3) THE DATASET DIRECTORY FIELDS SIGNIFICANT TO THE      */
*        /*     DATASPACE JUST PROCESSED.                            */
*        /* THIS CYCLE IS REPEATED UNTIL ALL DATASPACES HAVE BEEN    */
*        /* LISTED WITH THEIR CORRESPONDING EXTENTS AND DATASETS.    */
*        /* IF AT LEAST ONE GROUP OF DATASPACE-HEADER FIELDS WAS     */
*        /* RETURNED IN THE WORKAREA, BEGIN PROCESSING.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1648
*VHDR:   DO WHILE VHDRLEN >= LENGTH(VDSPHDR);                      1648
*                                                                  1648
@RC01635 DS    0H                                                  1648
VHDR     B     @DE01648                                            1648
@DL01648 DS    0H                                                  1649
*          /**********************************************************/
*          /*                                                        */
*          /* BUILD THE DARGLIST TO PRINT THE DATASPACE-HEADER FIELDS*/
*          /* AND TO INSURE PRINTABILITY, ZERO ANY NON-INITIALIZED   */
*          /* ARITHMETIC FIELDS.                                     */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1649
*          DARGSENT = LCST31;          /*DATASPACE TITLE             */
         L     @15,DARGPTR                                         1649
         MVI   DARGSENT(@15),X'1F'                                 1649
*          DARGDBP = VHDRPTR;                                      1650
         L     @14,VHDRPTR                                         1650
         ST    @14,DARGDBP(,@15)                                   1650
*          DARGILP = LENGTH(VDSPHDR);                              1651
         MVC   DARGILP(2,@15),@CH00653                             1651
*          IF VDSPDS# = ARITH4FF       /*NO. DATASETS IN DATASPACE   */
*            THEN                                                  1652
         CLC   VDSPDS#(2,@14),ARITH4FF                             1652
         BNE   @RF01652                                            1652
*              VDSPDS# = ZEROAREA;                                 1653
         MVC   VDSPDS#(2,@14),ZEROAREA                             1653
*          IF VDSPXT = ARITH4FF        /*NO. DATASPACE EXTENTS       */
*            THEN                                                  1654
@RF01652 L     @15,VHDRPTR                                         1654
         CLC   VDSPXT(1,@15),ARITH4FF                              1654
         BNE   @RF01654                                            1654
*              VDSPXT = ZEROAREA;                                  1655
         MVC   VDSPXT(1,@15),ZEROAREA                              1655
*          IF VDSPSCON = ARITH4FF      /*DATASPACE SECONDARY SPACE   */
*            THEN                                                  1656
@RF01654 L     @15,VHDRPTR                                         1656
         CLC   VDSPSCON(3,@15),ARITH4FF                            1656
         BNE   @RF01656                                            1656
*              VDSPSCON = ZEROAREA;                                1657
*                                                                  1657
         MVC   VDSPSCON(3,@15),ZEROAREA                            1657
*          /**********************************************************/
*          /*                                                        */
*          /* INTERPRET THE DATASPACE SPACE CREATION OPTION AND      */
*          /* SELECT THE APPROPRIATE STATIC TEXT DESCRIPTOR.         */
*          /* NOTE - THE FORMAT IS THE SAME AS THE JFCB SPACE OPTION */
*          /* FIELD FOR A DATA OR INDEX ENTRY.                       */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1658
*          DARGCNT = DRGCNT3;                              /*@Y30SSMK*/
@RF01656 L     @15,DARGPTR                                         1658
         MVC   DARGCNT(2,@15),@CH00170                             1658
*          DARGINS(1) = DRGINS10;                          /*@Y30SSMK*/
         LA    @14,10                                              1659
         STH   @14,DARGINS(,@15)                                   1659
*          DARGINL(1) = ABBREVLN;                                  1660
         STH   @14,DARGINL(,@15)                                   1660
*          IF VDSPOPT = RSZOPTN                                    1661
*            THEN                                                  1661
         L     @01,VHDRPTR                                         1661
         TM    VDSPOPT(@01),B'01000000'                            1661
         BNO   @RF01661                                            1661
         TM    VDSPOPT(@01),B'10000000'                            1661
         BNZ   @RF01661                                            1661
*              DARGDTM(1) = ADDR(RECSZNM);                         1662
         L     @01,TEXTPTR                                         1662
         LA    @14,RECSZNM(,@01)                                   1662
         ST    @14,DARGDTM(,@15)                                   1662
*            ELSE                                                  1663
*              IF VDSPOPT = TRKOPTN                                1663
*                THEN                                              1663
         B     @RC01661                                            1663
@RF01661 L     @01,VHDRPTR                                         1663
         TM    VDSPOPT(@01),B'10000000'                            1663
         BNO   @RF01663                                            1663
         TM    VDSPOPT(@01),B'01000000'                            1663
         BNZ   @RF01663                                            1663
*                  DARGDTM(1) = ADDR(TRKNM);                       1664
         L     @01,TEXTPTR                                         1664
         LA    @15,TRKNM(,@01)                                     1664
         L     @14,DARGPTR                                         1664
         ST    @15,DARGDTM(,@14)                                   1664
*                ELSE                                              1665
*                  IF VDSPOPT = CYLOPTN                            1665
*                    THEN                                          1665
         B     @RC01663                                            1665
@RF01663 L     @01,VHDRPTR                                         1665
         TM    VDSPOPT(@01),B'11000000'                            1665
         BNO   @RF01665                                            1665
*                      DARGDTM(1) = ADDR(CYLNM);                   1666
         L     @01,TEXTPTR                                         1666
         LA    @15,CYLNM(,@01)                                     1666
         L     @14,DARGPTR                                         1666
         ST    @15,DARGDTM(,@14)                                   1666
*                    ELSE                                          1667
*                      DARGDTM(1) = ADDR(NULLNM);                  1667
*                                                                  1667
         B     @RC01665                                            1667
@RF01665 L     @01,TEXTPTR                                         1667
         LA    @15,NULLNM(,@01)                                    1667
         L     @14,DARGPTR                                         1667
         ST    @15,DARGDTM(,@14)                                   1667
*          /**********************************************************/
*          /*                                                        */
*          /* INTERPRET THE DATASPACE ATTRIBUTE FLAG AND SELECT THE  */
*          /* APPROPRIATE STATIC TEXT DESCRIPTOR.                    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1668
*          DARGINS(2) = DRGINS20;                          /*@Y30SSMK*/
@RC01665 DS    0H                                                  1668
@RC01663 DS    0H                                                  1668
@RC01661 L     @15,DARGPTR                                         1668
         MVC   DARGINS+8(2,@15),@CH00649                           1668
*          DARGINL(2) = ABBREVLN;                                  1669
         MVC   DARGINL+8(2,@15),@CH00457                           1669
*          IF VDSPUNQ = ON                                         1670
*            THEN                                                  1670
         L     @01,VHDRPTR                                         1670
         TM    VDSPUNQ(@01),B'10000000'                            1670
         BNO   @RF01670                                            1670
*              DARGDTM(2) = ADDR(UNQNM);                           1671
         L     @01,TEXTPTR                                         1671
         LA    @14,UNQNM(,@01)                                     1671
         ST    @14,DARGDTM+8(,@15)                                 1671
*            ELSE                                                  1672
*              DARGDTM(2) = ADDR(SUBALNM);                         1672
         B     @RC01670                                            1672
@RF01670 L     @01,TEXTPTR                                         1672
         LA    @15,SUBALNM(,@01)                                   1672
         L     @14,DARGPTR                                         1672
         ST    @15,DARGDTM+8(,@14)                                 1672
*          DARGINS(3) = DRGINS30;                          /*@Y30SSMK*/
@RC01670 L     @15,DARGPTR                                         1673
         MVC   DARGINS+16(2,@15),@CH01231                          1673
*          DARGINL(3) = ABBREVLN;                                  1674
         MVC   DARGINL+16(2,@15),@CH00457                          1674
*          IF VDSPAUTO = ON                                        1675
*            THEN                                                  1675
         L     @01,VHDRPTR                                         1675
         TM    VDSPAUTO(@01),B'01000000'                           1675
         BNO   @RF01675                                            1675
*              DARGDTM(3) = ADDR(AUTONM);                          1676
         L     @01,TEXTPTR                                         1676
         LA    @14,AUTONM(,@01)                                    1676
         ST    @14,DARGDTM+16(,@15)                                1676
*            ELSE                                                  1677
*              DARGDTM(3) = ADDR(EXPLNM);                          1677
*                                                                  1677
         B     @RC01675                                            1677
@RF01675 L     @01,TEXTPTR                                         1677
         LA    @15,EXPLNM(,@01)                                    1677
         L     @14,DARGPTR                                         1677
         ST    @15,DARGDTM+16(,@14)                                1677
*          /**********************************************************/
*          /*                                                        */
*          /* DETERMINE IF EITHER THE USERCAT OR MASTERCAT INDICATOR */
*          /* IS SET IN THE DATASPACE ATTRIBUTE FLAG.  IF SO, BUILD  */
*          /* A DARGLIST INSERT STRUCTURE FOR IT.                    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1678
*          IF VDSPUCAT = ON    VDSPMCAT = ON                      1678
*            THEN                                                  1678
@RC01675 L     @15,VHDRPTR                                         1678
         TM    VDSPUCAT(@15),B'00110000'                           1678
         BZ    @RF01678                                            1678
*              DO;                                                 1679
*                DARGCNT = DARGCNT + 1;                            1680
         L     @14,DARGPTR                                         1680
         LA    @03,1                                               1680
         AH    @03,DARGCNT(,@14)                                   1680
         STH   @03,DARGCNT(,@14)                                   1680
*                DARGINS(DARGCNT) = DARGCNT * DRGINS10;    /*@Y30SSMK*/
         LR    @02,@03                                             1681
         SLA   @02,3                                               1681
         LA    @01,10                                              1681
         ST    @02,@TF00001                                        1681
         MR    @02,@01                                             1681
         L     @02,@TF00001                                        1681
         STH   @03,DARGINS-8(@02,@14)                              1681
*                DARGINL(DARGCNT) = ABBREVLN;                      1682
*                                                                  1682
         L     @03,@TF00001                                        1682
         STH   @01,DARGINL-8(@03,@14)                              1682
*                /****************************************************/
*                /*                                                  */
*                /* THE USERCAT INDICATOR AND THE MASTERCAT INDICATOR*/
*                /* CANNOT BOTH BE SIGNIFICANT FOR THE SAME DATASPACE*/
*                /* THEREFORE, ONLY ONE OR THE OTHER ATTRIBUTE IS    */
*                /* LISTED.                                          */
*                /*                                                  */
*                /****************************************************/
*                                                                  1683
*                IF VDSPUCAT = ON                                  1683
*                  THEN                                            1683
         TM    VDSPUCAT(@15),B'00100000'                           1683
         BNO   @RF01683                                            1683
*                    DARGDTM(DARGCNT) = ADDR(UCATNM);              1684
         L     @01,TEXTPTR                                         1684
         LA    @15,UCATNM(,@01)                                    1684
         L     @01,@TF00001                                        1684
         ST    @15,DARGDTM-8(@01,@14)                              1684
*                  ELSE                                            1685
*                    DARGDTM(DARGCNT) = ADDR(MCATNM);              1685
         B     @RC01683                                            1685
@RF01683 L     @15,DARGPTR                                         1685
         LH    @14,DARGCNT(,@15)                                   1685
         SLA   @14,3                                               1685
         L     @01,TEXTPTR                                         1685
         LA    @03,MCATNM(,@01)                                    1685
         ST    @03,DARGDTM-8(@14,@15)                              1685
*              END;                                                1686
*                                                                  1686
@RC01683 DS    0H                                                  1687
*          /**********************************************************/
*          /*                                                        */
*          /* PRINT THE DATASPACE-HEADER INFORMATION SETUP IN THE    */
*          /* DARGLIST.                                              */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1687
*          CALL LISTPROC;                                          1687
@RF01678 BAL   @14,LISTPROC                                        1687
*          /**********************************************************/
*          /*                                                        */
*          /* IF AT LEAST ONE GROUP OF DATASPACE EXTENT FIELDS WAS   */
*          /* RETURNED FROM THE CATALOG AND IF THIS EXTENT GROUP IS  */
*          /* ASSOCIATED WITH THE DATASPACE-HEADER JUST PROCESSED,   */
*          /* BUILD THE DARGLIST TO PRINT THE INFORMATION.  AND SET  */
*          /* AN INDICATOR TO PRINT AN EXTENT DESCRIPTOR TITLE AFTER */
*          /* EACH DATASPACE.                                        */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1688
*          VXTITLSW = YES;                                         1688
*                                                                  1688
         OI    VXTITLSW,B'10000000'                                1688
*VXDES:    DO WHILE (VXDESLEN >= LENGTH(VDSPDES)  &  VXSS#=VHDRREPN);
*                                                                  1689
VXDES    B     @DE01689                                            1689
@DL01689 DS    0H                                                  1690
*            /********************************************************/
*            /*                                                      */
*            /* PRINT THE EXTENT TITLE IF THIS IS THE FIRST EXTENT   */
*            /* GROUP TO BE LISTED FOR THIS DATASPACE.               */
*            /* NOTE - MORE THAN ONE EXTENT GROUP MAY BE ASSOCIATED  */
*            /* WITH THE SAME DATASPACE.                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1690
*            IF VXTITLSW = YES                                     1690
*              THEN                                                1690
         TM    VXTITLSW,B'10000000'                                1690
         BNO   @RF01690                                            1690
*                DO;                                               1691
*                  VXTITLSW = NO;                                  1692
         NI    VXTITLSW,B'01111111'                                1692
*                  DARGSENT = LCST32;  /*DATASPACE EXTENT TITLE      */
         L     @01,DARGPTR                                         1693
         MVI   DARGSENT(@01),X'20'                                 1693
*                  CALL LISTPROC;                                  1694
         BAL   @14,LISTPROC                                        1694
*                END;                                              1695
*                                                                  1695
*            /********************************************************/
*            /*                                                      */
*            /* BUILD THE DARGLIST TO PRINT THE EXTENT FIELDS.  AND  */
*            /* TO INSURE PRINTABILITY, ZERO ANY NON-INITIALIZED     */
*            /* ARITHMETIC FIELDS.                                   */
*            /*                                                      */
*            /********************************************************/
*                                                                  1696
*            DARGSENT = LCST36;        /*DATASPACE EXTENT DESCRIPTOR */
@RF01690 L     @15,DARGPTR                                         1696
         MVI   DARGSENT(@15),X'24'                                 1696
*            DARGDBP = VXDESPTR;                                   1697
         ST    VXDESPTR,DARGDBP(,@15)                              1697
*            DARGILP = LENGTH(VDSPDES);                            1698
         MVC   DARGILP(2,@15),@CH00664                             1698
*            IF VTRKPX = ARITH4FF                                  1699
*              THEN                                                1699
         CLC   VTRKPX(2,VXDESPTR),ARITH4FF                         1699
         BNE   @RF01699                                            1699
*                VTRKPX = ZEROAREA;                                1700
         MVC   VTRKPX(2,VXDESPTR),ZEROAREA                         1700
*            IF VTRKUSED = ARITH4FF                                1701
*              THEN                                                1701
@RF01699 CLC   VTRKUSED(2,VXDESPTR),ARITH4FF                       1701
         BNE   @RF01701                                            1701
*                VTRKUSED = ZEROAREA;                              1702
*                                                                  1702
*                                                                  1702
         MVC   VTRKUSED(2,VXDESPTR),ZEROAREA                       1702
*            /********************************************************/
*            /*                                                      */
*            /* DETERMINE IF A VARIABLE LENGTH SPACEMAP, SHOWING THE */
*            /* FREE AND USED TRACKS OF THE EXTENT, IS TO BE @ZA05939*/
*            /* LISTED.                                      @ZA05939*/
*            /*                                                      */
*            /********************************************************/
*                                                                  1703
*            IF VSPMAPLN > 0                                       1703
*              THEN                                                1703
@RF01701 ICM   @15,12,VSPMAPLN(VXDESPTR)                           1703
         SRA   @15,16                                              1703
         LTR   @15,@15                                             1703
         BNP   @RF01703                                            1703
*                DO;                                               1704
*                  DARGCNT = DRGCNT1;                      /*@Y30SSMK*/
         L     @14,DARGPTR                                         1705
         MVC   DARGCNT(2,@14),@CH00045                             1705
*                  DARGINS(1) = DRGINS10;                  /*@Y30SSMK*/
         MVC   DARGINS(2,@14),@CH00457                             1706
*                  DARGINL(1) = VSPMAPLN;                          1707
         STH   @15,DARGINL(,@14)                                   1707
*                  DARGDTM(1) = ADDR(VSPMAP);                      1708
         LA    @15,VSPMAP(,VXDESPTR)                               1708
         ST    @15,DARGDTM(,@14)                                   1708
*                END;                                      /*@ZA05939*/
*                                                                  1709
*            CALL LISTPROC;                                /*@ZA05939*/
*                                                                  1710
@RF01703 BAL   @14,LISTPROC                                        1710
*            /********************************************************/
*            /*                                                      */
*            /* COMPUTE THE TOTAL LENGTH OF THE ONE EXTENT GROUP JUST*/
*            /* PROCESSED.   UPDATE THE POINTER TO THE NEXT EXTENT   */
*            /* GROUP AND ADJUST THE EXTENT LENGTH USED AS A CONTROL */
*            /* VARIABLE TO DETERMINE WHETHER OR NOT ANOTHER EXTENT  */
*            /* GROUP EXISTS THAT MAY BE ASSOCIATED WITH THIS        */
*            /* DATASPACE.                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1711
*            VWKA = LENGTH(VDSPDES) + VSPMAPLN;                    1711
         LA    VWKA,14                                             1711
         ICM   @03,12,VSPMAPLN(VXDESPTR)                           1711
         SRA   @03,16                                              1711
         ALR   VWKA,@03                                            1711
*            VXDESLEN = VXDESLEN - VWKA;                           1712
         L     @03,VXDESLEN                                        1712
         SLR   @03,VWKA                                            1712
         ST    @03,VXDESLEN                                        1712
*            VXDESPTR = VXDESPTR + VWKA;                           1713
         ALR   VXDESPTR,VWKA                                       1713
*          END VXDES;                                              1714
@DE01689 L     @15,VXDESLEN                                        1714
         C     @15,@CF00664                                        1714
         BL    @DC01689                                            1714
         L     @01,VHDRPTR                                         1714
         CLC   VXSS#(2,VXDESPTR),VHDRREPN(@01)                     1714
         BE    @DL01689                                            1714
@DC01689 DS    0H                                                  1715
*          /**********************************************************/
*          /*                                                        */
*          /* DETERMINE IF ANY DATASET DIRECTORY INFORMATION WAS     */
*          /* RETURNED IN THE WORKAREA.  IF YES, INITIALIZE A POINTER*/
*          /* AND LENGTH TO BE USED IN STEPPING THROUGH THE REPEATING*/
*          /* GROUPS OF FIXED AND VARIABLE LENGTH DIRECTORY FIELDS.  */
*          /* IF NOT, ZERO THE LENGTH INDICATOR FOR NO DIRECTORY DATA*/
*          /*                                                        */
*          /**********************************************************/
*                                                                  1715
*          CTGFLPTR = VDIRFPT;         /*POSITION TO DS DIRECTORY FPL*/
         L     @15,VDIRFPT                                         1715
         ST    @15,CTGFLPTR                                        1715
*          IF CTGFLNG(1) > 0  &  CTGFLPT(1) > NULLPTR              1716
*            THEN                      /*DATASETS ARE IN DATASPACE   */
         SLR   @14,@14                                             1716
         L     @03,CTGFLNG(,@15)                                   1716
         CR    @03,@14                                             1716
         BNH   @RF01716                                            1716
         L     @15,CTGFLPT(,@15)                                   1716
         CR    @15,@14                                             1716
         BNH   @RF01716                                            1716
*              DO;                                                 1717
*                VDIRPTR = CTGFLPT(1);                             1718
         LR    VDIRPTR,@15                                         1718
*                VDIRLEN = CTGFLNG(1);                             1719
         ST    @03,VDIRLEN                                         1719
*                VDSHDRSW = YES;                                   1720
         OI    VDSHDRSW,B'10000000'                                1720
*              END;                                                1721
*            ELSE                                                  1722
*              VDIRLEN = 0;                                        1722
         B     @RC01716                                            1722
@RF01716 SLR   @15,@15                                             1722
         ST    @15,VDIRLEN                                         1722
*          /**********************************************************/
*          /*                                                        */
*          /* IF AT LEAST ONE GROUP OF DATASET DIRECTORY FIELDS WAS  */
*          /* RETURNED FROM THE CATALOG, PROCESS THE DIRECTORY DATA. */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1723
*VDIR:     DO WHILE VDIRLEN >= LENGTH(VDSDIR);                     1723
*                                                                  1723
@RC01716 DS    0H                                                  1723
VDIR     B     @DE01723                                            1723
@DL01723 DS    0H                                                  1724
*            /********************************************************/
*            /*                                                      */
*            /* COMPUTE THE NUMBER OF ASSOCIATED DATASPACE           */
*            /* IDENTIFIERS IN THIS PARTICULAR DATASET DIRECTORY,    */
*            /* SINCE A GIVEN DATASET MAY BE ASSOCIATED WITH MORE    */
*            /* THAN ONE DATASPACE.  THEN CHECK EACH IDENTIFIER TO   */
*            /* DETERMINE IF THIS DATASET DIRECTORY IS ASSOCIATED    */
*            /* WITH THE DATASPACE CURRENTLY BEING PROCESSED.        */
*            /*                                                      */
*            /********************************************************/
*                                                                  1724
*SS#CK:      DO VMM = 1 TO VSS#LEN/LENGTH(VSS#INFO);               1724
SS#CK    LA    @15,1                                               1724
         B     @DE01724                                            1724
@DL01724 DS    0H                                                  1725
*              IF VDIRSS#(VMM) = VHDRREPN                          1725
*                THEN                                              1725
         MH    @15,@CH00170                                        1725
         ALR   @15,VDIRPTR                                         1725
         L     @14,VHDRPTR                                         1725
         CLC   VDIRSS#-3(2,@15),VHDRREPN(@14)                      1725
         BNE   @RF01725                                            1725
*LISTDIR:          DO;                                             1726
*                                                                  1726
*                                                                  1726
LISTDIR  DS    0H                                                  1727
*                    /************************************************/
*                    /*                                              */
*                    /* PRINT THE DATASET DIRECTORY TITLE IF THIS IS */
*                    /* THE FIRST PASS.                              */
*                    /*                                              */
*                    /************************************************/
*                                                                  1727
*                    IF VDSHDRSW = YES                             1727
*                      THEN                                        1727
         TM    VDSHDRSW,B'10000000'                                1727
         BNO   @RF01727                                            1727
*                        DO;                                       1728
*                          VDSHDRSW = NO;                          1729
         NI    VDSHDRSW,B'01111111'                                1729
*                          DARGSENT = LCST33;                      1730
         L     @01,DARGPTR                                         1730
         MVI   DARGSENT(@01),X'21'                                 1730
*                          CALL LISTPROC;                          1731
         BAL   @14,LISTPROC                                        1731
*                        END;                                      1732
*                                                                  1732
*                    /************************************************/
*                    /*                                              */
*                    /* RESET THE CPL POINTER TO THE CPL SETUP       */
*                    /* ESPECIALLY FOR ENTRYNAME RETRIEVAL VIA A     */
*                    /* C.I.NO.  SET THE INDICATOR FOR IDENTIFYING   */
*                    /* WHICH SAVEAREA IS TO BE USED DURING THE      */
*                    /* LOCATE REQUEST.  AND INITIALIZE AN FPL TO    */
*                    /* BE USED IN THE ENTRYNAME REQUEST.            */
*                    /* NOTE - THE FPL IS NOT A READ ONLY PARM LIST  */
*                    /* AND IS THEREFORE REINITIALIZED FOR EACH      */
*                    /* LOCATE REQUEST.                              */
*                    /*                                              */
*                    /************************************************/
*                                                                  1733
*                    CTGPLPTR = CI#CPLPT;                          1733
@RF01727 L     @15,CI#CPLPT                                        1733
         ST    @15,CTGPLPTR                                        1733
*                    ENTNMFLG = ON;                                1734
         OI    ENTNMFLG,B'10000000'                                1734
*                    CTGFLPTR = ENT44FPT;                          1735
         L     @14,ENT44FPT                                        1735
         ST    @14,CTGFLPTR                                        1735
*                    CTGFLPTR->VDSFPL(1:LCFPLLEN) =                1736
*                      ZEROAREA(1:LCFPLLEN);                       1736
         SLR   @03,@03                                             1736
         IC    @03,LCFPLLEN                                        1736
         BCTR  @03,0                                               1736
         EX    @03,@SM01763                                        1736
*                    CTGFLDNO = 1;                                 1737
         MVI   CTGFLDNO(@14),X'01'                                 1737
*                    CTGFLDNM = ADDR(ENT44NM);                     1738
*                                                                  1738
         LA    @03,ENT44NM                                         1738
         ST    @03,CTGFLDNM(,@14)                                  1738
*                    /************************************************/
*                    /*                                              */
*                    /* IN THE SPECIAL CPL, SET THE C.I.NO. ADDRESS  */
*                    /* FROM THE DATASET DIRECTORY.  AND SET THE SAME*/
*                    /* PASSWORD VALUE THAT WAS USED FOR THE SPACE   */
*                    /* ENTRY LOCATE.                                */
*                    /*                                              */
*                    /************************************************/
*                                                                  1739
*                    CTGENT = ADDR(VDSCI#);                        1739
         LA    @14,VDSCI#(,VDIRPTR)                                1739
         ST    @14,CTGENT(,@15)                                    1739
*                    CTGPSWD = TYPCPLPT->CTGPSWD;                  1740
         L     @01,TYPCPLPT                                        1740
         L     @14,CTGPSWD(,@01)                                   1740
         ST    @14,CTGPSWD(,@15)                                   1740
*                    /************************************************/
*                    /*                                              */
*                    /* ISSUE  THE LOCATE FOR THE DATASET NAME       */
*                    /* ASSOCIATED WITH THE CURRENT DATASPACE.       */
*                    /*                                              */
*                    /************************************************/
*                                                                  1741
*                    CALL LOCPROC (FPLEND,                         1741
*                                  CACBFLG,                        1741
*                                  ENTNMFLG);                      1741
         LA    @15,FPLEND                                          1741
         ST    @15,@AL00001                                        1741
         LA    @15,CACBFLG                                         1741
         ST    @15,@AL00001+4                                      1741
         LA    @15,ENTNMFLG                                        1741
         ST    @15,@AL00001+8                                      1741
         LA    @01,@AL00001                                        1741
         BAL   @14,LOCPROC                                         1741
*                    RESPECIFY RTNREG RSTD;                        1742
*                    TESTRC = RTNREG;                              1743
         LR    TESTRC,RTNREG                                       1743
*                    RESPECIFY RTNREG UNRSTD;                      1744
*                                                                  1744
*                    /************************************************/
*                    /*                                              */
*                    /* IF THE LOCATE WAS UNSUCCESSFUL BUT NOT DUE TO*/
*                    /* PASSWORD VERIFICATION FAILURE, PROCESS THE   */
*                    /* ERROR CONDITION.                             */
*                    /*                                              */
*                    /************************************************/
*                                                                  1745
*                    IF TESTRC ^= 0  &  CATRC ^= CRCBADPW          1745
*                      THEN                                        1745
         LTR   TESTRC,TESTRC                                       1745
         BZ    @RF01745                                            1745
         LH    @02,CATRC                                           1745
         C     @02,@CF01280                                        1745
         BE    @RF01745                                            1745
*                        IF CATRC = CRCNOENT                       1746
*                                                                  1746
*                          /******************************************/
*                          /*                                        */
*                          /* IF AN ENTRY NOT FOUND CONDITION        */
*                          /* OCCURRED FOR THIS LOCATE VIA A C.I.NO.,*/
*                          /* PRINT THE VSAM CONDITION CODE MESSAGE  */
*                          /* AND THE INVALID C.I.NO. MESSAGE.       */
*                          /* UPDATE THE LISTC FINAL CONDITION CODE. */
*                          /* CONTINUE PROCESSING THE OTHER DATASET  */
*                          /* DIRECTORIES.                           */
*                          /*                                        */
*                          /******************************************/
*                                                                  1746
*                          THEN                                    1746
         C     @02,@CF00187                                        1746
         BNE   @RF01746                                            1746
*                            DO;                                   1747
*                              CILOCFLG = ON;              /*@OZ09407*/
         OI    CILOCFLG,B'10000000'                                1748
*                              CALL ERRPROC;                       1749
         BAL   @14,ERRPROC                                         1749
*                              CILOCFLG = OFF;             /*@OZ09407*/
         NI    CILOCFLG,B'01111111'                                1750
*                              ERRARGPT->DARGSMOD = LC1ID;         1751
         L     @15,ERRARGPT                                        1751
         MVC   DARGSMOD(3,@15),@CC01297                            1751
*                              ERRARGPT->DARGSENT = LCMSG09;       1752
         MVI   DARGSENT(@15),X'09'                                 1752
*                              ERRARGPT->DARGDBP  = ADDR(VDSCI#);  1753
         LA    @14,VDSCI#(,VDIRPTR)                                1753
         ST    @14,DARGDBP(,@15)                                   1753
*                              ERRARGPT->DARGILP = LENGTH(VDSCI#); 1754
         MVC   DARGILP(2,@15),@CH00170                             1754
*                              CALL ERRPROC;                       1755
         BAL   @14,ERRPROC                                         1755
*                              SAVRC = MAX (SAVRC, LASTCC04);      1756
         LH    @15,SAVRC                                           1756
         LA    @14,4                                               1756
         CR    @15,@14                                             1756
         BNL   *+6
         LR    @15,@14                                             1756
         STH   @15,SAVRC                                           1756
*                            END;                                  1757
*                                                                  1757
*                          /******************************************/
*                          /*                                        */
*                          /* FOR ALL OTHER UNRECOVERABLE LOCATE     */
*                          /* ERROR CONDITIONS, TERMINATE PROCESSING */
*                          /* OF THE SPACE ENTRY.  CLEAR THE SPECIAL */
*                          /* CPL SAVEAREA INDICATOR AND RESET THE   */
*                          /* CPL POINTER TO THE CPL FOR SUBSET      */
*                          /* REQUESTS.  EXIT, RETURNING TO THE      */
*                          /* ROUTING PROCEDURE.                     */
*                          /*                                        */
*                          /******************************************/
*                                                                  1758
*                          ELSE                                    1758
*                            DO;                                   1758
         B     @RC01746                                            1758
@RF01746 DS    0H                                                  1759
*                              ENTNMFLG = OFF;                     1759
         NI    ENTNMFLG,B'01111111'                                1759
*                              CTGPLPTR = TYPCPLPT;                1760
         L     @04,TYPCPLPT                                        1760
         ST    @04,CTGPLPTR                                        1760
*                              RETURN CODE (SAVRC);        /*@ZA05939*/
         LH    @15,SAVRC                                           1761
         L     @13,4(,@13)                                         1761
         L     @14,12(,@13)                                        1761
         LM    @00,@12,20(@13)                                     1761
         BR    @14                                                 1761
*                            END;                                  1762
*                      /**********************************************/
*                      /*                                            */
*                      /* THE LOCATE FOR THE DATASET NAME WAS        */
*                      /* SUCCESSFUL.  BUILD THE DARGLIST TO LIST    */
*                      /* THE NAME, INCLUDING FROM THE DIRECTORY     */
*                      /* FIELDS, WHETHER THE DATASET IS A CANDIDATE */
*                      /* AND THE NUMBER OF DATASET EXTENTS ASSIGNED */
*                      /* IN THIS DATASPACE.                         */
*                      /*                                            */
*                      /**********************************************/
*                                                                  1763
*                      ELSE                                        1763
*                        DO;                                       1763
         B     @RC01745                                            1763
@RF01745 DS    0H                                                  1764
*                          DARGSENT = LCST37;                      1764
         L     @15,DARGPTR                                         1764
         MVI   DARGSENT(@15),X'25'                                 1764
*                          DARGCNT = DRGCNT3;              /*@Y30SSMK*/
         MVC   DARGCNT(2,@15),@CH00170                             1765
*                          DARGINS(1) = DRGINS10;          /*@Y30SSMK*/
         LA    @14,10                                              1766
         STH   @14,DARGINS(,@15)                                   1766
*                          DARGINS(2) = DRGINS20;          /*@Y30SSMK*/
         MVC   DARGINS+8(2,@15),@CH00649                           1767
*                          DARGINL(2) = ABBREVLN;                  1768
         STH   @14,DARGINL+8(,@15)                                 1768
*                          DARGINS(3) = DRGINS30;          /*@Y30SSMK*/
         MVC   DARGINS+16(2,@15),@CH01231                          1769
*                          IF VDSCAN = ON                          1770
*                            THEN                                  1770
         TM    VDSCAN(VDIRPTR),B'10000000'                         1770
         BNO   @RF01770                                            1770
*                              DARGDTM(2) = ADDR(CANNM);           1771
         L     @01,TEXTPTR                                         1771
         LA    @14,CANNM(,@01)                                     1771
         ST    @14,DARGDTM+8(,@15)                                 1771
*                            ELSE                                  1772
*                              DARGDTM(2) = ADDR(NULLNM);          1772
         B     @RC01770                                            1772
@RF01770 L     @01,TEXTPTR                                         1772
         LA    @15,NULLNM(,@01)                                    1772
         L     @14,DARGPTR                                         1772
         ST    @15,DARGDTM+8(,@14)                                 1772
*                          DARGINL(3) = LENGTH(VX#(1));            1773
@RC01770 L     @15,DARGPTR                                         1773
         MVC   DARGINL+16(2,@15),@CH00045                          1773
*                          DARGDTM(3) = ADDR(VX#(VMM));            1774
*                                                                  1774
         LH    @14,VMM                                             1774
         MH    @14,@CH00170                                        1774
         LA    @14,VX#-3(@14,VDIRPTR)                              1774
         ST    @14,DARGDTM+16(,@15)                                1774
*                          /******************************************/
*                          /*                                        */
*                          /* DETERMINE IF THE DATASET NAME TO BE    */
*                          /* LISTED WAS RETURNED IN THE SPECIALLY   */
*                          /* FORMATTED WORKAREA.                    */
*                          /*                                        */
*                          /******************************************/
*                                                                  1775
*                          IF CATRC ^= CRCBADPW                    1775
*                            THEN                                  1775
         CLC   CATRC(2),@CH01280                                   1775
         BE    @RF01775                                            1775
*                              DO;                                 1776
*                                DARGINL(1) = CTGFLNG(1);          1777
         L     @14,CTGFLPTR                                        1777
         L     @03,CTGFLNG(,@14)                                   1777
         STH   @03,DARGINL(,@15)                                   1777
*                                DARGDTM(1) = CTGFLPT(1);          1778
         L     @14,CTGFLPT(,@14)                                   1778
         ST    @14,DARGDTM(,@15)                                   1778
*                              END;                                1779
*                            ELSE                                  1780
*                              DO;                                 1780
         B     @RC01775                                            1780
@RF01775 DS    0H                                                  1781
*                                DARGINL(1) = LENGTH(SUPPDSNM);    1781
         L     @15,DARGPTR                                         1781
         MVC   DARGINL(2,@15),@CH00606                             1781
*                                DARGDTM(1) = ADDR(SUPPDSNM);      1782
         L     @01,CTGPLPTR                                        1782
         L     @01,CTGWKA(,@01)                                    1782
         LA    @14,SUPPDSNM(,@01)                                  1782
         ST    @14,DARGDTM(,@15)                                   1782
*                              END;                                1783
*                          CALL LISTPROC;                          1784
@RC01775 BAL   @14,LISTPROC                                        1784
*                        END;                                      1785
*                  END LISTDIR;                                    1786
@RC01745 DS    0H                                                  1787
*            END SS#CK;                                            1787
*                                                                  1787
@RF01725 LA    @15,1                                               1787
         AH    @15,VMM                                             1787
@DE01724 STH   @15,VMM                                             1787
         SLR   @01,@01                                             1787
         ICM   @01,3,VSS#LEN(VDIRPTR)                              1787
         SLR   @00,@00                                             1787
         D     @00,@CF00170                                        1787
         CR    @15,@01                                             1787
         BNH   @DL01724                                            1787
*            /********************************************************/
*            /*                                                      */
*            /* COMPUTE THE TOTAL LENGTH OF THE DATASET DIRECTORY    */
*            /* JUST PROCESSED.  UPDATE THE POINTER TO THE NEXT      */
*            /* DIRECTORY AND ADJUST THE DIRECTORY LENGTH USED AS A  */
*            /* CONTROL VARIABLE TO DETERMINE IF THERE IS ANOTHER    */
*            /* DIRECTORY TO BE PROCESSED.                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1788
*            VWKA = LENGTH(VDSDIR) + VSS#LEN;                      1788
         LA    VWKA,9                                              1788
         SLR   @03,@03                                             1788
         ICM   @03,3,VSS#LEN(VDIRPTR)                              1788
         ALR   VWKA,@03                                            1788
*            VDIRLEN = VDIRLEN - VWKA;                             1789
         L     @03,VDIRLEN                                         1789
         SLR   @03,VWKA                                            1789
         ST    @03,VDIRLEN                                         1789
*            VDIRPTR = VDIRPTR + VWKA;                             1790
         ALR   VDIRPTR,VWKA                                        1790
*          END VDIR;                                               1791
*                                                                  1791
@DE01723 L     @15,VDIRLEN                                         1791
         C     @15,@CF00642                                        1791
         BNL   @DL01723                                            1791
*          /**********************************************************/
*          /*                                                        */
*          /* DATASET DIRECTORY PROCESSING IS COMPLETED.  CLEAR THE  */
*          /* SPECIAL CPL SAVEAREA INDICATOR AND RESET THE CPL       */
*          /* POINTER TO THE MAIN CPL SETUP FOR SUBSET REQUESTS.     */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1792
*          ENTNMFLG = OFF;                                         1792
         NI    ENTNMFLG,B'01111111'                                1792
*          CTGPLPTR = TYPCPLPT;                                    1793
         L     @15,TYPCPLPT                                        1793
         ST    @15,CTGPLPTR                                        1793
*          /**********************************************************/
*          /*                                                        */
*          /* UPDATE THE DATASPACE-HEADER POINTER TO THE NEXT GROUP  */
*          /* OF DATASPACE FIELDS.  AND ADJUST THE DATASPACE-HEADER  */
*          /* LENGTH USED AS A CONTROL VARIABLE TO DETERMINE IF      */
*          /* THERE IS ANOTHER DATASPACE TO BE PROCESSED.            */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1794
*          VHDRLEN = VHDRLEN - LENGTH(VDSPHDR);                    1794
         LA    @15,23                                              1794
         SLR   VHDRLEN,@15                                         1794
*          VHDRPTR = VHDRPTR + LENGTH(VDSPHDR);                    1795
         AL    @15,VHDRPTR                                         1795
         ST    @15,VHDRPTR                                         1795
*        END VHDR;                                                 1796
*                                                                  1796
@DE01648 C     VHDRLEN,@CF00653                                    1796
         BNL   @DL01648                                            1796
*        /************************************************************/
*        /*                                                          */
*        /* EXIT FROM THE VOLUME ENTRY FORMATTING PROCEDURE.         */
*        /* PROCESSING OF THE SPACE ENTRY IS COMPLETED.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1797
*        RETURN CODE (0);                                          1797
         SLR   @15,@15                                             1797
         L     @13,4(,@13)                                         1797
         L     @14,12(,@13)                                        1797
         LM    @00,@12,20(@13)                                     1797
         BR    @14                                                 1797
*        END VPROC;                                                1798
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* PROCEDURE - ANSVPROC                             @YL026UE*/
*        /* FUNCTION - RETRIEVES THE LIST OF ASSOCIATED TYPES AND    */
*        /* C.I. NUMBERS FROM THE WORKAREA AND CREATES A SAVE AREA   */
*        /* COPY SINCE THE WORK AREA IS REUSED.              @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* INPUT - THE FPL IDENTIFYING THE ASSOCIATIONS OF A        */
*        /* CATALOG ENTRY.                                   @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* OUTPUT - SAVEAREA COPY OF THE ASSOCIATED TYPES AND       */
*        /* C.I. NUMBERS OR AN ERROR MESSAGE.                @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1799
*ANSVPROC: PROCEDURE OPTIONS(SAVEAREA);                    /*@ZA05939*/
*                                                                  1799
ANSVPROC STM   @14,@12,12(@13)                                     1799
         ST    @13,@SA00009+4                                      1799
         LA    @14,@SA00009                                        1799
         ST    @14,8(,@13)                                         1799
         LR    @13,@14                                             1799
*        GEN(ENTRY ANSVPROC);          /*EXT ENTRY POINT     @ZA05939*/
         ENTRY ANSVPROC
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  1801
         LM    REG8,REG12,BASESAVE                                 1801
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* LOCAL VARIABLES                                  @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1802
*        DCL CASTRING  CHAR(*) BASED;  /*OVERLAY FOR STRING DATA     */
*        DCL TEMPSAPT  PTR(31);        /*TEMP PTR FOR ASSOC SAVEAREA
*                                                            @Y30SSMK*/
*        DCL TEMPSALN  FIXED(31);      /*TEMP LEN FOR ASSOC SAVEAREA
*                                                            @Y30SSMK*/
*        DCL FLOFFSET  FIXED(31);                          /*@ZA00951*/
*        DCL FLENGTH   FIXED(31);                          /*@ZA00951*/
*        DCL MVLEN     FIXED(15) CONSTANT(256);            /*@Y30SSMK*/
*                                      /*MAX MOVE LENGTH     @Y30SSMK*/
*        DCL MVPOS     FIXED(15) CONSTANT(255);            /*@Y30SSMK*/
*                                      /*MAX MOVE POSITION   @Y30SSMK*/
*                                                                  1809
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* POSITION TEMPORARY POINTER TO THE SAVEAREA AND   @Y30SSMK*/
*        /* OBTAIN A LARGER STORAGE AREA SHOULD THE          @Y30SSMK*/
*        /* STRING OF C.I. NUMBERS BE GREATER THAN THE       @Y30SSMK*/
*        /* PRESENT SAVEAREA.                                @Y30SSMK*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1809
*        OLDERID2 = NEWERID2;                                      1809
         L     @04,@PC00001                                        1809
         L     @04,GDTTR2(,@04)                                    1809
         MVC   @TS00001(95),NEWERID2(@04)                          1809
         MVC   OLDERID2(95,@04),@TS00001                           1809
*        NEWID2 = 'LCSA';                                  /*@YL026UE*/
*                                                                  1810
         MVC   NEWID2(4,@04),@CC01691                              1810
*        CTGFLPTR = ASSOCFPT;                              /*@YL026UE*/
         L     @04,ASSOCFPT                                        1811
         ST    @04,CTGFLPTR                                        1811
*        IF CTGFLPT(1) = NULLPTR                                   1812
*          THEN                                                    1812
         SLR   @15,@15                                             1812
         C     @15,CTGFLPT(,@04)                                   1812
         BNE   @RF01812                                            1812
*            DO;                       /*NO ASSOC RETURNED   @YL026UE*/
*            ASSOC# = 0;                                   /*@YL026UE*/
         STH   @15,ASSOC#                                          1814
*            RETURN CODE(0);                               /*@YL026UE*/
         L     @13,4(,@13)                                         1815
         L     @14,12(,@13)                                        1815
         LM    @00,@12,20(@13)                                     1815
         BR    @14                                                 1815
*            END;                                          /*@YL026UE*/
*        ASSOC# = CTGFLNG(1)/LENGTH(ASSOC);                /*@YL026UE*/
@RF01812 L     @04,CTGFLPTR                                        1817
         L     @00,CTGFLNG(,@04)                                   1817
         SRDA  @00,32                                              1817
         D     @00,@CF00050                                        1817
         STH   @01,ASSOC#                                          1817
*        IF HOLDETYP = CTGTCL    HOLDETYP = CTGTAIX              1818
*          HOLDETYP = CTGTGBS                                      1818
*          THEN                                                    1818
         CLI   HOLDETYP,C'C'                                       1818
         BE    @RT01818                                            1818
         CLI   HOLDETYP,C'G'                                       1818
         BE    @RT01818                                            1818
         CLI   HOLDETYP,C'B'                                       1818
         BNE   @RF01818                                            1818
@RT01818 DS    0H                                                  1819
*            DO;                                           /*@Y30SSMK*/
*              TEMPSAPT = CILSTPTR;                        /*@Y30SSMK*/
         L     @04,CILSTPTR                                        1820
         ST    @04,TEMPSAPT                                        1820
*              TEMPSALN = CILSTLEN;                        /*@Y30SSMK*/
         L     TEMPSALN,CILSTLEN                                   1821
*            END;                                          /*@Y30SSMK*/
*          ELSE                                                    1823
*            DO;                                           /*@Y30SSMK*/
         B     @RC01818                                            1823
@RF01818 DS    0H                                                  1824
*              TEMPSAPT = CIASOCPT;                        /*@Y30SSMK*/
         L     @04,CIASOCPT                                        1824
         ST    @04,TEMPSAPT                                        1824
*              TEMPSALN = CIASOCLN;                        /*@Y30SSMK*/
         L     TEMPSALN,CIASOCLN                                   1825
*            END;                                          /*@Y30SSMK*/
*        IF CTGFLNG(1) > TEMPSALN                                  1827
*          THEN                                                    1827
@RC01818 L     @04,CTGFLPTR                                        1827
         L     @04,CTGFLNG(,@04)                                   1827
         CR    @04,TEMPSALN                                        1827
         BNH   @RF01827                                            1827
*            DO;                                           /*@YL026UE*/
*              GPID = GPID09;                              /*@YL026UE*/
         MVC   GPID(4),@CC01398                                    1829
*              GPLEN = CTGFLNG(1);                         /*@YL026UE*/
         ST    @04,GPLEN                                           1830
*              CALL IDCSAGP0 (GDTTBL,                              1831
*                      GPLEN,                                      1831
*                      TEMPSAPT,                                   1831
*                      GPID,                                       1831
*                      SETZERO);                           /*@YL026UE*/
         L     @04,@PC00001                                        1831
         ST    @04,@AL00001                                        1831
         LA    @02,GPLEN                                           1831
         ST    @02,@AL00001+4                                      1831
         LA    @02,TEMPSAPT                                        1831
         ST    @02,@AL00001+8                                      1831
         LA    @02,GPID                                            1831
         ST    @02,@AL00001+12                                     1831
         LA    @02,SETZERO                                         1831
         ST    @02,@AL00001+16                                     1831
         MVI   @AL00001+16,X'80'                                   1831
         L     @15,GDTGPL(,@04)                                    1831
         LA    @01,@AL00001                                        1831
         BALR  @14,@15                                             1831
*              RESPECIFY RTNREG RSTD;                              1832
*              TESTRC = RTNREG;                                    1833
         LR    TESTRC,RTNREG                                       1833
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UE*/
*              IF TESTRC ^= 0                                      1835
*                THEN                                              1835
*                                                                  1835
         SLR   @04,@04                                             1835
         CR    TESTRC,@04                                          1835
         BE    @RF01835                                            1835
*                  /**************************************************/
*                  /*                                        @YL026UE*/
*                  /* THE REQUEST FOR A LARGER STORAGE AREA FAILED.  */
*                  /* SETUP THE LACKING WORKSPACE MSG.  SET THE NO.  */
*                  /* OF ASSOCIATIONS TO ZERO.  UPDATE THE FINAL     */
*                  /* LISTC CONDITION CODE.  BYPASS FURTHER  @YL026UE*/
*                  /* PROCESSING OF THIS ENTRY AND EXIT FROM THE     */
*                  /* PROCEDURE.  RETURN TO TTHE ROUTING PROCEDURE.  */
*                  /*                                        @YL026UE*/
*                  /**************************************************/
*                                                                  1836
*                  DO;                                     /*@YL026UE*/
*                    ASSOC# = 0;                           /*@YL026UE*/
         STH   @04,ASSOC#                                          1837
*                    ERRARGPT->DARGSMOD = LC1ID;           /*@YL026UE*/
         L     @04,ERRARGPT                                        1838
         MVC   DARGSMOD(3,@04),@CC01297                            1838
*                    ERRARGPT->DARGSENT = LCMSG02;         /*@YL026UE*/
         MVI   DARGSENT(@04),X'02'                                 1839
*                    ERRARGPT->DARGDBP = ENT44FPT->CTGFLPT(1);     1840
         L     @15,ENT44FPT                                        1840
         L     @14,CTGFLPT(,@15)                                   1840
         ST    @14,DARGDBP(,@04)                                   1840
*                    ERRARGPT->DARGILP = ENT44FPT->CTGFLNG(1);     1841
         L     @15,CTGFLNG(,@15)                                   1841
         STH   @15,DARGILP(,@04)                                   1841
*                    SAVRC = MAX (SAVRC, LASTCC04);        /*@ZA05939*/
         LH    @04,SAVRC                                           1842
         LA    @15,4                                               1842
         CR    @04,@15                                             1842
         BNL   *+6
         LR    @04,@15                                             1842
         STH   @04,SAVRC                                           1842
*                    RETURN CODE (SAVRC);                  /*@ZA05939*/
         LR    @15,@04                                             1843
         L     @13,4(,@13)                                         1843
         L     @14,12(,@13)                                        1843
         LM    @00,@12,20(@13)                                     1843
         BR    @14                                                 1843
*                  END;                                    /*@YL026UE*/
*                ELSE                                              1845
*                                                                  1845
*                  /**************************************************/
*                  /*                                        @YL026UE*/
*                  /* THE STORAGE REQUEST WAS SUCCESSFUL.    @YL026UE*/
*                  /* UPDATE THE SAVEAREA LENGTH TO THE LARGER       */
*                  /* STORAGE SIZE AND RELEASE THE SMALLER AREA.     */
*                  /*                                        @YL026UE*/
*                  /**************************************************/
*                                                                  1845
*                  DO;                                     /*@YL026UE*/
@RF01835 DS    0H                                                  1846
*                    IF HOLDETYP = CTGTCL    HOLDETYP = CTGTAIX  
*                      HOLDETYP = CTGTGBS                          1846
*                      THEN                                        1846
         CLI   HOLDETYP,C'C'                                       1846
         BE    @RT01846                                            1846
         CLI   HOLDETYP,C'G'                                       1846
         BE    @RT01846                                            1846
         CLI   HOLDETYP,C'B'                                       1846
         BNE   @RF01846                                            1846
@RT01846 DS    0H                                                  1847
*                        DO;                               /*@Y30SSMK*/
*                          CILSTLEN = GPLEN;               /*@Y30SSMK*/
         L     @04,GPLEN                                           1848
         ST    @04,CILSTLEN                                        1848
*                          CILSTPTR = TEMPSAPT;            /*@Y30SSMK*/
         L     @04,TEMPSAPT                                        1849
         ST    @04,CILSTPTR                                        1849
*                          CALL IDCSAFP0 (GDTTBL,                  1850
*                                 'LC05');                 /*@Y30SSMK*/
         L     @04,@PC00001                                        1850
         ST    @04,@AL00001                                        1850
         LA    @15,@CC01692                                        1850
         ST    @15,@AL00001+4                                      1850
         MVI   @AL00001+4,X'80'                                    1850
         L     @15,GDTFPL(,@04)                                    1850
         LA    @01,@AL00001                                        1850
         BALR  @14,@15                                             1850
*                        END;                              /*@Y30SSMK*/
*                      ELSE                                        1852
*                        DO;                               /*@Y30SSMK*/
         B     @RC01846                                            1852
@RF01846 DS    0H                                                  1853
*                          CIASOCLN = GPLEN;               /*@Y30SSMK*/
         L     @04,GPLEN                                           1853
         ST    @04,CIASOCLN                                        1853
*                          CIASOCPT = TEMPSAPT;            /*@Y30SSMK*/
         L     @04,TEMPSAPT                                        1854
         ST    @04,CIASOCPT                                        1854
*                          CALL IDCSAFP0 (GDTTBL,                  1855
*                                 'LC11');                 /*@Y30SSMK*/
         L     @04,@PC00001                                        1855
         ST    @04,@AL00001                                        1855
         LA    @15,@CC01693                                        1855
         ST    @15,@AL00001+4                                      1855
         MVI   @AL00001+4,X'80'                                    1855
         L     @15,GDTFPL(,@04)                                    1855
         LA    @01,@AL00001                                        1855
         BALR  @14,@15                                             1855
*                        END;                              /*@Y30SSMK*/
*                  END;                                    /*@YL026UE*/
@RC01846 DS    0H                                                  1858
*            END;                                          /*@YL026UE*/
*                                                                  1858
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* SAVE THE LIST OF ASSOCIATED C.I.NOS. AND TYPES RETURNED  */
*        /* IN THE WORKAREA.                                 @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1859
*        FLOFFSET = 1;                                     /*@ZA00951*/
@RF01827 LA    FLOFFSET,1                                          1859
*        FLENGTH = CTGFLNG(1);                             /*@ZA00951*/
         L     @04,CTGFLPTR                                        1860
         L     FLENGTH,CTGFLNG(,@04)                               1860
*        DO WHILE FLENGTH > 0;                             /*@ZA00951*/
         B     @DE01861                                            1861
@DL01861 DS    0H                                                  1862
*          IF FLENGTH >= MVLEN                             /*@ZA00951*/
*            THEN                                          /*@ZA00951*/
         LA    @04,256                                             1862
         CR    FLENGTH,@04                                         1862
         BL    @RF01862                                            1862
*              TEMPSAPT -> CASTRING(FLOFFSET:FLOFFSET+MVPOS) =     1863
*                CTGFLPT(1) -> CASTRING(FLOFFSET:MVLEN);   /*@ZA00951*/
         L     @01,TEMPSAPT                                        1863
         ALR   @01,FLOFFSET                                        1863
         BCTR  @01,0                                               1863
         MVI   CASTRING+1(@01),C' '                                1863
         MVC   CASTRING+2(254,@01),CASTRING+1(@01)                 1863
         SLR   @04,FLOFFSET                                        1863
         L     @15,CTGFLPTR                                        1863
         L     @15,CTGFLPT(,@15)                                   1863
         ALR   @15,FLOFFSET                                        1863
         BCTR  @15,0                                               1863
         EX    @04,@SM01765                                        1863
*            ELSE                                          /*@ZA00951*/
*              TEMPSAPT -> CASTRING(FLOFFSET:FLOFFSET+FLENGTH-1) = 1864
*                CTGFLPT(1) -> CASTRING(FLOFFSET:FLENGTH); /*@ZA00951*/
         B     @RC01862                                            1864
@RF01862 L     @04,TEMPSAPT                                        1864
         ALR   @04,FLOFFSET                                        1864
         BCTR  @04,0                                               1864
         LR    @15,FLENGTH                                         1864
         BCTR  @15,0                                               1864
         L     @01,CTGFLPTR                                        1864
         L     @01,CTGFLPT(,@01)                                   1864
         ALR   @01,FLOFFSET                                        1864
         BCTR  @01,0                                               1864
         EX    @15,@SM01767                                        1864
*          FLOFFSET = FLOFFSET + MVLEN;                    /*@ZA00951*/
@RC01862 LA    @04,256                                             1865
         ALR   FLOFFSET,@04                                        1865
*          FLENGTH  = FLENGTH - MVLEN;                     /*@ZA00951*/
         SLR   FLENGTH,@04                                         1866
*        END;                                              /*@ZA00951*/
*                                                                  1867
@DE01861 SLR   @04,@04                                             1867
         CR    FLENGTH,@04                                         1867
         BH    @DL01861                                            1867
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* THE LIST OF ASSOCIATIONS IS NOW RETRIEVED. EXIT FROM     */
*        /* THE ANSVPROC ROUTINE, RETURNING TO THE CALLING   @YL026UE*/
*        /* PROCEDURE.                                       @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1868
*        RETURN CODE(0);                                   /*@YL026UE*/
         LR    @15,@04                                             1868
         L     @13,4(,@13)                                         1868
         L     @14,12(,@13)                                        1868
         LM    @00,@12,20(@13)                                     1868
         BR    @14                                                 1868
*        END ANSVPROC;                                     /*@YL026UE*/
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* PROCEDURE - ANLTPROC                             @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* FUNCTION - RETRIEVES FROM THE CATALOG THE ASSOCIATED     */
*        /* ENTRYNAMES VIA C.I. NOS., AND LISTS THESE ASSOCIATED     */
*        /* ENTRYNAMES AND TYPES FOLLOWING THE ASSOCIATIONS  @YL026UE*/
*        /* HEADER.                                          @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* INPUT - SEPARATE CPL AND WORKAREA FOR RETREIVING AN      */
*        /* ASSOCIATED ENTRYNAME, THE SAVEAREA LIST OF C.I. NOS.     */
*        /* AND THE NUMBER OF ASSOCIATIONS.                  @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* OUTPUT - A LISTING OF THE 44-BYTE ASSOCIATED ENTRYNAMES  */
*        /* AND TYPES.                                       @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1870
*ANLTPROC: PROCEDURE;                                      /*@YL026UE*/
*                                                                  1870
ANLTPROC STM   @14,@12,@SA00010                                    1870
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* LOCAL VARIABLES                                  @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1871
*        DCL CLSTRING  CHAR(*) BASED;  /*OVERLAY FOR STRING  @YL026UE*/
*        DCL CLT       FIXED(15);      /*DO GRP CONTROL VAR  @YL026UE*/
*        DCL ASOCSAPT  PTR(31);        /*PTR TO ASSOC SAVEAREA     1873
*                                                            @Y30SSMK*/
*        DCL CLFLDNO   FIXED(15) CONSTANT(2);              /*@Y30SSMK*/
*                                      /*NO. OF FPL'S FOR CL ASSOC   */
*                                                                  1875
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* SETUP THE DARGLIST TO PRINT THE ASSOCIATIONS HEADER.     */
*        /* IF NO ASSOCIATED C.I.NOS. WERE RETURNED FROM THE @YL026UE*/
*        /* CATALOG, PRINT THE 'NULL' STATIC TEXT ENTRY WITH THE     */
*        /* ASSOCIATIONS HEADER. OTHERWISE, PRINT THE ASSOCIATED     */
*        /* ENTRYNAMES FOLLOWING THE ASSOCIATIONS HEADER.    @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1875
*        DARGSENT = LCST35;                                /*@ZA05939*/
         L     @04,DARGPTR                                         1875
         MVI   DARGSENT(@04),X'23'                                 1875
*        OLDERID2 = NEWERID2;                                      1876
         L     @15,@PC00001                                        1876
         L     @15,GDTTR2(,@15)                                    1876
         MVC   @TS00001(95),NEWERID2(@15)                          1876
         MVC   OLDERID2(95,@15),@TS00001                           1876
*        NEWID2 = 'LCLA';                                  /*@YL026UE*/
         MVC   NEWID2(4,@15),@CC01701                              1877
*        IF ASSOC# <= 0                                            1878
*          THEN                                                    1878
         LH    @15,ASSOC#                                          1878
         LTR   @15,@15                                             1878
         BP    @RF01878                                            1878
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST17;                            /*@ZA05939*/
         MVI   DARGSENT(@04),X'11'                                 1880
*            DARGCNT = DRGCNT1;                            /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00045                             1881
*            DARGINS(1) = DRGINS10;                        /*@Y30SSMK*/
         LA    @15,10                                              1882
         STH   @15,DARGINS(,@04)                                   1882
*            DARGINL(1) = ABBREVLN;                        /*@YL026UE*/
         STH   @15,DARGINL(,@04)                                   1883
*            DARGDTM(1) = ADDR(NULLNM);                    /*@YL026UE*/
         L     @01,TEXTPTR                                         1884
         LA    @15,NULLNM(,@01)                                    1884
         ST    @15,DARGDTM(,@04)                                   1884
*            CALL LISTPROC;                                /*@YL026UE*/
         BAL   @14,LISTPROC                                        1885
*            RETURN CODE(0);                               /*@YL026UE*/
         SLR   @15,@15                                             1886
         L     @14,@SA00010                                        1886
         LM    @00,@12,@SA00010+8                                  1886
         BR    @14                                                 1886
*            END;                                          /*@YL026UE*/
*          ELSE                                                    1888
*            IF DENTAFLG = OFF                                     1888
*              THEN                                                1888
@RF01878 TM    DENTAFLG,B'10000000'                                1888
         BNZ   @RF01888                                            1888
*                CALL LISTPROC;                            /*@YL026UE*/
*                                                                  1889
         BAL   @14,LISTPROC                                        1889
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* IF THE ASSOCIATION IS RELATED TO A NON-VSAM G0000V00     */
*        /* ENTRY, THEN JUST LIST THE GDG BASE ASSOCIATION USING     */
*        /* THIS PROCEDURE                                   @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  1890
*        IF ASSOC# > 0                                             1890
*          THEN                                                    1890
@RF01888 LH    @04,ASSOC#                                          1890
         LTR   @04,@04                                             1890
         BNP   @RF01890                                            1890
*            IF G0V0FLG = ON                                       1891
*              THEN                                                1891
         TM    G0V0FLG,B'10000000'                                 1891
         BNO   @RF01891                                            1891
*                ASSOC# = 1;                               /*@YL026UE*/
*                                                                  1892
         MVC   ASSOC#(2),@CH00045                                  1892
*            /********************************************************/
*            /*                                              @YL026UE*/
*            /* INITIALIZE THE CPL POINTER TO ANOTHER CPL SETUP      */
*            /* ESPECIALLY FOR ENTRYNAME REQUESTS VIA C.I.NOS.       */
*            /*                                              @YL026UE*/
*            /********************************************************/
*                                                                  1893
*              CTGPLPTR = CI#CPLPT;                        /*@YL026UE*/
@RF01891 DS    0H                                                  1893
@RF01890 L     @04,CI#CPLPT                                        1893
         ST    @04,CTGPLPTR                                        1893
*              IF HOLDETYP = CTGTCL    HOLDETYP = CTGTAIX        1894
*                HOLDETYP = CTGTGBS                                1894
*                THEN                                              1894
         CLI   HOLDETYP,C'C'                                       1894
         BE    @RT01894                                            1894
         CLI   HOLDETYP,C'G'                                       1894
         BE    @RT01894                                            1894
         CLI   HOLDETYP,C'B'                                       1894
         BNE   @RF01894                                            1894
@RT01894 DS    0H                                                  1895
*                  ASOCSAPT = CILSTPTR;                    /*@Y30SSMK*/
         L     ASOCSAPT,CILSTPTR                                   1895
*                ELSE                                              1896
*                  ASOCSAPT = CIASOCPT;                    /*@Y30SSMK*/
         B     @RC01894                                            1896
@RF01894 L     ASOCSAPT,CIASOCPT                                   1896
*              RESPECIFY ASSOC BASED(ASOCSAPT);            /*@Y30SSMK*/
@RC01894 DS    0H                                                  1898
*              GASSOCSW = OFF;                             /*@Y30SSMK*/
         NI    GASSOCSW,B'01111111'                                1898
*ASSOCS:       DO CLT = 1 TO ASSOC#;                       /*@YL026UE*/
ASSOCS   LA    CLT,1                                               1899
         B     @DE01899                                            1899
@DL01899 DS    0H                                                  1900
*                IF KIND(CLT) ^= CTGTUPG                           1900
*                  THEN                                            1900
*                                                                  1900
         LR    @04,CLT                                             1900
         SLA   @04,2                                               1900
         ST    @04,@TF00001                                        1900
         ALR   @04,ASOCSAPT                                        1900
         AL    @04,@CF01769                                        1900
         CLI   KIND(@04),C'Y'                                      1900
         BE    @RF01900                                            1900
*                    /************************************************/
*                    /*                                      @YL026UE*/
*                    /* INITIALIZE AN FPL TO REQUEST THE     @YL026UE*/
*                    /* 44-BYTE ASSOCIATED ENTRYNAME.        @YL026UE*/
*                    /*                                      @YL026UE*/
*                    /************************************************/
*                                                                  1901
*                    DO;                                   /*@Y30SSMK*/
*                      CTGFLPTR = ENT44FPT;                /*@YL026UE*/
         L     @04,ENT44FPT                                        1902
         ST    @04,CTGFLPTR                                        1902
*                      CTGFLPTR->CLSTRING(1:LCFPLLEN) =            1903
*                        ZEROAREA(1:LCFPLLEN);                     1903
         SLR   @15,@15                                             1903
         IC    @15,LCFPLLEN                                        1903
         BCTR  @15,0                                               1903
         EX    @15,@SM01770                                        1903
*                      CTGFLDNO = 1;                       /*@YL026UE*/
         MVI   CTGFLDNO(@04),X'01'                                 1904
*                      CTGFLDNM = ADDR(ENT44NM);           /*@YL026UE*/
*                                                                  1905
*                                                                  1905
         LA    @14,ENT44NM                                         1905
         ST    @14,CTGFLDNM(,@04)                                  1905
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* FOR A CLUSTER ASSOCIATION, THE PAGESPACE   */
*                      /* ATTRIBUTE AS WELL AS THE ENTRY NAME WILL BE*/
*                      /* LOCATED FROM THE CATALOG IN ORDER TO       */
*                      /* DETERMINE IF THE ASSOCIATED TYPE SHOULD BE */
*                      /* LISTED AS A CLUSTER OR PAGESPACE. THEREFORE*/
*                      /* MODIFY THE CPL AND INITIALIZE THE          */
*                      /* APPROPRIATE FPL.                   @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  1906
*                      IF KIND(CLT) = CTGTCL                       1906
*                        THEN                                      1906
         LR    @04,ASOCSAPT                                        1906
         AL    @04,@TF00001                                        1906
         AL    @04,@CF01769                                        1906
         CLI   KIND(@04),C'C'                                      1906
         BNE   @RF01906                                            1906
*                          DO;                             /*@YL026UE*/
*                          CTGNOFLD = CLFLDNO;             /*@Y30SSMK*/
         L     @04,CTGPLPTR                                        1908
         MVI   CTGNOFLD(@04),X'02'                                 1908
*                          CTGFIELD(2) = CATTRFPT;         /*@YL026UE*/
         L     @14,CATTRFPT                                        1909
         ST    @14,CTGFIELD+4(,@04)                                1909
*                          CTGFLPTR = CATTRFPT;            /*@YL026UE*/
         ST    @14,CTGFLPTR                                        1910
*                          CTGFLPTR->CLSTRING(1:LCFPLLEN)=         1911
*                            ZEROAREA(1:LCFPLLEN);         /*@YL026UE*/
         EX    @15,@SM01772                                        1911
*                          CTGFLDNO = 1;                   /*@YL026UE*/
         MVI   CTGFLDNO(@14),X'01'                                 1912
*                          CTGFLDNM=ADDR(CATTRNM);         /*@YL026UE*/
         LA    @04,CATTRNM                                         1913
         ST    @04,CTGFLDNM(,@14)                                  1913
*                          END;                            /*@YL026UE*/
*                        ELSE                                      1915
*                          CTGNOFLD=1;                     /*@YL026UE*/
*                                                                  1915
         B     @RC01906                                            1915
@RF01906 L     @04,CTGPLPTR                                        1915
         MVI   CTGNOFLD(@04),X'01'                                 1915
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* INSERT THE ASSOCIATED C.I.NO. ADDRESS AND  */
*                      /* TYPE IN THE CPL.  ALSO SET AN INDICATOR TO */
*                      /* IDENTIFY WHICH CPL SAVEAREA IS TO USED     */
*                      /* DURING THE LOCATE REQUEST OF AN    @YL026UE*/
*                      /* ENTRYNAME ONLY.                    @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  1916
*                      CTGENT = ADDR(CI#(CLT));            /*@YL026UE*/
@RC01906 L     @04,CTGPLPTR                                        1916
         LR    @15,CLT                                             1916
         SLA   @15,2                                               1916
         AL    @15,@CF01774                                        1916
         LA    @15,CI#-1(@15,ASOCSAPT)                             1916
         ST    @15,CTGENT(,@04)                                    1916
*                      CTGPSWD = TYPCPLPT->CTGPSWD;        /*@YL026UE*/
         L     @01,TYPCPLPT                                        1917
         L     @15,CTGPSWD(,@01)                                   1917
         ST    @15,CTGPSWD(,@04)                                   1917
*                      ENTNMFLG = ON;  /*LOCATE ENTRYNAME ONLY       */
*                                                                  1918
         OI    ENTNMFLG,B'10000000'                                1918
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* ISSUE THE LOCATE REQUEST FOR THE ASSOCIATED*/
*                      /* ENTRYNAME.                         @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  1919
*                      CALL LOCPROC (FPLEND,CACBFLG,ENTNMFLG);     1919
         LA    @04,FPLEND                                          1919
         ST    @04,@AL00001                                        1919
         LA    @04,CACBFLG                                         1919
         ST    @04,@AL00001+4                                      1919
         LA    @04,ENTNMFLG                                        1919
         ST    @04,@AL00001+8                                      1919
         LA    @01,@AL00001                                        1919
         BAL   @14,LOCPROC                                         1919
*                      RESPECIFY RTNREG RSTD;                      1920
*                      TESTRC = RTNREG;                            1921
         LR    TESTRC,RTNREG                                       1921
*                      RESPECIFY RTNREG UNRSTD;            /*@YL026UE*/
*                                                                  1922
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* IF THERE IS A NON-ZERO CATALOG RETURN CODE,*/
*                      /* DETERMINE IF PASSWORD VERIFICATION FAILED. */
*                      /* THIS IS NOT CONSIDERED AN ERROR WHEN       */
*                      /* LISTING JUST ASSOCIATED ENTRYNAMES SINCE   */
*                      /* THE NAME AND TYPE ARE STILL RETURNED IN THE*/
*                      /* WORKAREA.                          @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  1923
*                      IF TESTRC ^= 0 & CATRC ^= CRCBADPW          1923
*                        THEN                                      1923
         LTR   TESTRC,TESTRC                                       1923
         BZ    @RF01923                                            1923
         LH    @04,CATRC                                           1923
         C     @04,@CF01280                                        1923
         BE    @RF01923                                            1923
*                          IF CATRC = CRCNOENT                     1924
*                                                                  1924
*                            /****************************************/
*                            /*                              @YL026UE*/
*                            /* FOR AN ENTRY NOT FOUND CONDITION,    */
*                            /* PRINT THE VSAM CAT CONDITION CODE MSG*/
*                            /* AND THE INVALID C.I.NO. MSG.  UPDATE */
*                            /* THE LISTC FINAL CONDITIONAL CODE.    */
*                            /* BLANK THE INVALID ASSOCIATED ENTRY   */
*                            /* IN THE SAVEAREA LIST. AND CONTINUE   */
*                            /* PROCESSING THE LIST.         @YL026UE*/
*                            /*                              @YL026UE*/
*                            /****************************************/
*                                                                  1924
*                            THEN                                  1924
         C     @04,@CF00187                                        1924
         BNE   @RF01924                                            1924
*                              DO;                         /*@YL026UE*/
*                                CILOCFLG = ON;            /*@OZ09407*/
         OI    CILOCFLG,B'10000000'                                1926
*                                CALL ERRPROC;             /*@YL026UE*/
         BAL   @14,ERRPROC                                         1927
*                                CILOCFLG = OFF;           /*@OZ09407*/
         NI    CILOCFLG,B'01111111'                                1928
*                                ERRARGPT->DARGSMOD = LC1ID;       1929
         L     @04,ERRARGPT                                        1929
         MVC   DARGSMOD(3,@04),@CC01297                            1929
*                                ERRARGPT->DARGSENT = LCMSG09;     1930
         MVI   DARGSENT(@04),X'09'                                 1930
*                                ERRARGPT->DARGDBP = ADDR(CI#(CLT));
         LR    @15,CLT                                             1931
         SLA   @15,2                                               1931
         AL    @15,@CF01774                                        1931
         LA    @15,CI#-1(@15,ASOCSAPT)                             1931
         ST    @15,DARGDBP(,@04)                                   1931
*                                ERRARGPT->DARGILP = LENGTH(CI#(CLT));
         MVC   DARGILP(2,@04),@CH00170                             1932
*                                CALL ERRPROC;             /*@YL026UE*/
         BAL   @14,ERRPROC                                         1933
*                                SAVRC = MAX (SAVRC, LASTCC04);    1934
         LH    @04,SAVRC                                           1934
         LA    @15,4                                               1934
         CR    @04,@15                                             1934
         BNL   *+6
         LR    @04,@15                                             1934
         STH   @04,SAVRC                                           1934
*                                ASSOC(CLT) = BLANK;       /*@YL026UE*/
         LR    @04,CLT                                             1935
         SLA   @04,2                                               1935
         ALR   @04,ASOCSAPT                                        1935
         AL    @04,@CF01769                                        1935
         MVI   ASSOC+1(@04),C' '                                   1935
         MVC   ASSOC+2(2,@04),ASSOC+1(@04)                         1935
         MVI   ASSOC(@04),C' '                                     1935
*                              END;                        /*@YL026UE*/
*                                                                  1936
*                            /****************************************/
*                            /*                              @YL026UE*/
*                            /* EXIT FOR ALL OTHER NON-ZERO CATALOG  */
*                            /* RETURN CODES.  RESET THE CPL POINTER */
*                            /* TO THE MAIN CPL SETUP FOR SUBSET     */
*                            /* REQUEST.                     @YL026UE*/
*                            /*                              @YL026UE*/
*                            /****************************************/
*                                                                  1937
*                            ELSE                                  1937
*                              DO;                         /*@YL026UE*/
         B     @RC01924                                            1937
@RF01924 DS    0H                                                  1938
*                                CTGPLPTR = TYPCPLPT;      /*@YL026UE*/
         L     @04,TYPCPLPT                                        1938
         ST    @04,CTGPLPTR                                        1938
*                                ENTNMFLG = OFF;           /*@YL026UE*/
         NI    ENTNMFLG,B'01111111'                                1939
*                                RETURN CODE (SAVRC);      /*@ZA05939*/
         LH    @15,SAVRC                                           1940
         L     @14,@SA00010                                        1940
         LM    @00,@12,@SA00010+8                                  1940
         BR    @14                                                 1940
*                              END;                        /*@YL026UE*/
*                        /********************************************/
*                        /*                                  @YL026UE*/
*                        /* BUILD THE DARGLIST TO PRINT THE  @YL026UE*/
*                        /* ASSOCIATED TYPE AND NAME.        @YL026UE*/
*                        /*                                  @YL026UE*/
*                        /********************************************/
*                                                                  1942
*                        ELSE                                      1942
*                          DO;                             /*@YL026UE*/
         B     @RC01923                                            1942
@RF01923 DS    0H                                                  1943
*                            DARGSENT = LCST18;            /*@YL026UE*/
         L     @04,DARGPTR                                         1943
         MVI   DARGSENT(@04),X'12'                                 1943
*                            DARGCNT = DRGCNT2;            /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00161                             1944
*                            DARGINS(1) = DRGINS10;        /*@Y30SSMK*/
         LA    @15,10                                              1945
         STH   @15,DARGINS(,@04)                                   1945
*                            DARGINL(1) = ABBREVLN;        /*@YL026UE*/
*                                                                  1946
         STH   @15,DARGINL(,@04)                                   1946
*                            /****************************************/
*                            /*                              @YL026UE*/
*                            /* NOTE: THE TYPE, PAGESPACE, IS        */
*                            /* RETURNED THE WORKAREA IF THE PASSWORD*/
*                            /* VERIFICATION FAILED. OTHERWISE, THE  */
*                            /* PAGESPACE ATTRIBUTE IS RETURNED      */
*                            /* VIA THE CATTR FPL.           @YL026UE*/
*                            /*                              @YL026UE*/
*                            /****************************************/
*                                                                  1947
*                            IF KIND(CLT) = CTGTCL                 1947
*                              THEN                                1947
         LR    @15,CLT                                             1947
         SLA   @15,2                                               1947
         ALR   @15,ASOCSAPT                                        1947
         AL    @15,@CF01769                                        1947
         CLI   KIND(@15),C'C'                                      1947
         BNE   @RF01947                                            1947
*                                DO;                       /*@YL026UE*/
*                                IF CATRC ^= CRCBADPW              1949
*                                  THEN                            1949
         CLC   CATRC(2),@CH01280                                   1949
         BE    @RF01949                                            1949
*                                    IF CATTRFPT->CTGFLPT(1)->PGSPAC
*                                       ^= 'FF'X &           /*YM6557*/
*                                       CATTRFPT->CTGFLPT(1)->PGSP=ON
*                                      THEN                        1950
         L     @01,CATTRFPT                                        1950
         L     @15,CTGFLPT(,@01)                                   1950
         CLI   PGSPAC(@15),X'FF'                                   1950
         BE    @RF01950                                            1950
         TM    PGSP(@15),B'00000001'                               1950
         BNO   @RF01950                                            1950
*                                        DO;               /*@YL026UE*/
*                                        DARGDTM(1)= ADDR(PGSPCNM);
         L     @01,TEXTPTR                                         1952
         LA    @15,PGSPCNM(,@01)                                   1952
         ST    @15,DARGDTM(,@04)                                   1952
*                                        PGSPCFLG = ON;    /*@YL026UE*/
         OI    PGSPCFLG,B'10000000'                                1953
*                                        END;              /*@YL026UE*/
*                                      ELSE                        1955
*                                        DARGDTM(1)= ADDR(CLNM);   1955
         B     @RC01950                                            1955
@RF01950 L     @04,TEXTPTR                                         1955
         LA    @04,CLNM(,@04)                                      1955
         L     @01,DARGPTR                                         1955
         ST    @04,DARGDTM(,@01)                                   1955
*                                  ELSE                            1956
*                                    IF SUPPTYPE=CTGTPGSP          1956
*                                      THEN                        1956
         B     @RC01949                                            1956
@RF01949 L     @04,CTGPLPTR                                        1956
         L     @04,CTGWKA(,@04)                                    1956
         CLI   SUPPTYPE(@04),C'P'                                  1956
         BNE   @RF01956                                            1956
*                                        DO;               /*@YL026UE*/
*                                        DARGDTM(1)= ADDR(PGSPCNM);
         L     @04,TEXTPTR                                         1958
         LA    @04,PGSPCNM(,@04)                                   1958
         L     @01,DARGPTR                                         1958
         ST    @04,DARGDTM(,@01)                                   1958
*                                        PGSPCFLG = ON;    /*@YL026UE*/
         OI    PGSPCFLG,B'10000000'                                1959
*                                        END;              /*@YL026UE*/
*                                      ELSE                        1961
*                                        DARGDTM(1)=ADDR(CLNM);    1961
         B     @RC01956                                            1961
@RF01956 L     @04,TEXTPTR                                         1961
         LA    @04,CLNM(,@04)                                      1961
         L     @01,DARGPTR                                         1961
         ST    @04,DARGDTM(,@01)                                   1961
*                                IF DENTAFLG = ON                  1962
*                                  THEN                            1962
@RC01956 DS    0H                                                  1962
@RC01949 TM    DENTAFLG,B'10000000'                                1962
         BNO   @RF01962                                            1962
*                                    RETURN CODE(SAVRC);   /*@ZA05939*/
         LH    @15,SAVRC                                           1963
         L     @14,@SA00010                                        1963
         LM    @00,@12,@SA00010+8                                  1963
         BR    @14                                                 1963
*                                END;                      /*@YL026UE*/
*                              ELSE                                1965
*                                IF KIND(CLT) = CTGTAIX            1965
*                                  THEN                            1965
         B     @RC01947                                            1965
@RF01947 LR    @04,CLT                                             1965
         SLA   @04,2                                               1965
         ALR   @04,ASOCSAPT                                        1965
         AL    @04,@CF01769                                        1965
         CLI   KIND(@04),C'G'                                      1965
         BNE   @RF01965                                            1965
*                                    DO;                   /*@Y30SSMK*/
*                                      DARGDTM(1) =                1967
*                                        ADDR(AIXNM);      /*@Y30SSMK*/
         L     @04,TEXTPTR                                         1967
         LA    @04,AIXNM(,@04)                                     1967
         L     @01,DARGPTR                                         1967
         ST    @04,DARGDTM(,@01)                                   1967
*                                      GASSOCSW = ON;      /*@Y30SSMK*/
         OI    GASSOCSW,B'10000000'                                1968
*                                    END;                  /*@Y30SSMK*/
*                                  ELSE                            1970
*                                    IF KIND(CLT) = CTGTDATA       1970
*                                      THEN                        1970
         B     @RC01965                                            1970
@RF01965 LR    @04,CLT                                             1970
         SLA   @04,2                                               1970
         ALR   @04,ASOCSAPT                                        1970
         AL    @04,@CF01769                                        1970
         CLI   KIND(@04),C'D'                                      1970
         BNE   @RF01970                                            1970
*                                        DARGDTM(1) =              1971
*                                          ADDR(DATANM);   /*@YL026UE*/
         L     @04,TEXTPTR                                         1971
         LA    @04,DATANM(,@04)                                    1971
         L     @01,DARGPTR                                         1971
         ST    @04,DARGDTM(,@01)                                   1971
*                                      ELSE                        1972
*                                        IF KIND(CLT) = CTGTINDX   1972
*                                          THEN                    1972
         B     @RC01970                                            1972
@RF01970 LR    @04,CLT                                             1972
         SLA   @04,2                                               1972
         ALR   @04,ASOCSAPT                                        1972
         AL    @04,@CF01769                                        1972
         CLI   KIND(@04),C'I'                                      1972
         BNE   @RF01972                                            1972
*                                            DARGDTM(1) =          1973
*                                              ADDR(INDEXNM);      1973
         L     @04,TEXTPTR                                         1973
         LA    @04,INDEXNM(,@04)                                   1973
         L     @01,DARGPTR                                         1973
         ST    @04,DARGDTM(,@01)                                   1973
*                                      ELSE                        1974
*                                        IF KIND(CLT) = CTGTALIN   1974
*                                          THEN                    1974
         B     @RC01972                                            1974
@RF01972 LR    @04,CLT                                             1974
         SLA   @04,2                                               1974
         ALR   @04,ASOCSAPT                                        1974
         AL    @04,@CF01769                                        1974
         CLI   KIND(@04),C'A'                                      1974
         BNE   @RF01974                                            1974
*                                            DARGDTM(1) =          1975
*                                              ADDR(NVSAMNM);      1975
         L     @04,TEXTPTR                                         1975
         LA    @04,NVSAMNM(,@04)                                   1975
         L     @01,DARGPTR                                         1975
         ST    @04,DARGDTM(,@01)                                   1975
*                                      ELSE                        1976
*                                        IF KIND(CLT) = CTGTGBS    1976
*                                          THEN                    1976
         B     @RC01974                                            1976
@RF01974 LR    @04,CLT                                             1976
         SLA   @04,2                                               1976
         ALR   @04,ASOCSAPT                                        1976
         AL    @04,@CF01769                                        1976
         CLI   KIND(@04),C'B'                                      1976
         BNE   @RF01976                                            1976
*                                            DARGDTM(1) =          1977
*                                              ADDR(GDGNM);        1977
         L     @04,TEXTPTR                                         1977
         LA    @04,GDGNM(,@04)                                     1977
         L     @01,DARGPTR                                         1977
         ST    @04,DARGDTM(,@01)                                   1977
*                                      ELSE                        1978
*                                        IF KIND(CLT) = CTGTUCAT   1978
*                                          THEN                    1978
         B     @RC01976                                            1978
@RF01976 LR    @04,CLT                                             1978
         SLA   @04,2                                               1978
         ALR   @04,ASOCSAPT                                        1978
         AL    @04,@CF01769                                        1978
         CLI   KIND(@04),C'U'                                      1978
         BNE   @RF01978                                            1978
*                                            DARGDTM(1) =          1979
*                                              ADDR(UCATNM);       1979
         L     @04,TEXTPTR                                         1979
         LA    @04,UCATNM(,@04)                                    1979
         L     @01,DARGPTR                                         1979
         ST    @04,DARGDTM(,@01)                                   1979
*                                      ELSE                        1980
*                                        IF KIND(CLT) = CTGTANM    1980
*                                          THEN                    1980
         B     @RC01978                                            1980
@RF01978 LR    @04,CLT                                             1980
         SLA   @04,2                                               1980
         ALR   @04,ASOCSAPT                                        1980
         AL    @04,@CF01769                                        1980
         CLI   KIND(@04),C'X'                                      1980
         BNE   @RF01980                                            1980
*                                            DARGDTM(1) =          1981
*                                              ADDR(ALIASNM);      1981
         L     @04,TEXTPTR                                         1981
         LA    @04,ALIASNM(,@04)                                   1981
         L     @01,DARGPTR                                         1981
         ST    @04,DARGDTM(,@01)                                   1981
*                                      ELSE                        1982
*                                        IF KIND(CLT) = CTGTPTH    1982
*                                          THEN                    1982
         B     @RC01980                                            1982
@RF01980 LR    @04,CLT                                             1982
         SLA   @04,2                                               1982
         ALR   @04,ASOCSAPT                                        1982
         AL    @04,@CF01769                                        1982
         CLI   KIND(@04),C'R'                                      1982
         BNE   @RF01982                                            1982
*                                            DARGDTM(1) =          1983
*                                              ADDR(PATHNM);       1983
         L     @04,TEXTPTR                                         1983
         LA    @04,PATHNM(,@04)                                    1983
         L     @01,DARGPTR                                         1983
         ST    @04,DARGDTM(,@01)                                   1983
*                                          ELSE                    1984
*                                            DARGDTM(1)=           1984
*                                              ADDR(NULLNM);       1984
         B     @RC01982                                            1984
@RF01982 L     @04,TEXTPTR                                         1984
         LA    @04,NULLNM(,@04)                                    1984
         L     @01,DARGPTR                                         1984
         ST    @04,DARGDTM(,@01)                                   1984
*                            DARGINS(2) = DRGINS20;        /*@Y30SSMK*/
*                                                                  1985
@RC01982 DS    0H                                                  1985
@RC01980 DS    0H                                                  1985
@RC01978 DS    0H                                                  1985
@RC01976 DS    0H                                                  1985
@RC01974 DS    0H                                                  1985
@RC01972 DS    0H                                                  1985
@RC01970 DS    0H                                                  1985
@RC01965 DS    0H                                                  1985
@RC01947 L     @04,DARGPTR                                         1985
         MVC   DARGINS+8(2,@04),@CH00649                           1985
*                            /****************************************/
*                            /*                              @YL026UE*/
*                            /* INSERT IN THE DARGLIST THE ASSOCIATED*/
*                            /* NAME FROM THE SPECIALLY FORMATTED    */
*                            /* WORKAREA DUE TO PASSWORD VERIFICATION*/
*                            /* FAILURE.                     @YL026UE*/
*                            /*                              @YL026UE*/
*                            /****************************************/
*                                                                  1986
*                            IF CATRC = CRCBADPW                   1986
*                              THEN                                1986
         CLC   CATRC(2),@CH01280                                   1986
         BNE   @RF01986                                            1986
*                                DO;                       /*@YL026UE*/
*                                  ERRDARG = ZEROAREA;     /*@YL026UE*/
         L     @01,ERRARGPT                                        1988
         MVC   ERRDARG(44,@01),ZEROAREA                            1988
*                                  DARGINL(2) = LENGTH(SUPPDSNM);  1989
         MVC   DARGINL+8(2,@04),@CH00606                           1989
*                                  DARGDTM(2) = ADDR(SUPPDSNM);    1990
         L     @01,CTGPLPTR                                        1990
         L     @01,CTGWKA(,@01)                                    1990
         LA    @15,SUPPDSNM(,@01)                                  1990
         ST    @15,DARGDTM+8(,@04)                                 1990
*                                END;                      /*@YL026UE*/
*                              ELSE                                1992
*                                DO;                       /*@YL026UE*/
         B     @RC01986                                            1992
@RF01986 DS    0H                                                  1993
*                                  CTGFLPTR = ENT44FPT;    /*@YL026UE*/
         L     @04,ENT44FPT                                        1993
         ST    @04,CTGFLPTR                                        1993
*                                  DARGINL(2) = CTGFLNG(1);        1994
         L     @15,DARGPTR                                         1994
         L     @14,CTGFLNG(,@04)                                   1994
         STH   @14,DARGINL+8(,@15)                                 1994
*                                  DARGDTM(2) = CTGFLPT(1);        1995
         L     @04,CTGFLPT(,@04)                                   1995
         ST    @04,DARGDTM+8(,@15)                                 1995
*                                END;                      /*@YL026UE*/
*                            CALL LISTPROC;                /*@YL026UE*/
@RC01986 BAL   @14,LISTPROC                                        1997
*                          END;                            /*@YL026UE*/
*                        END;                              /*@Y30SSMK*/
@RC01923 DS    0H                                                  2000
*                    END ASSOCS;                           /*@YL026UE*/
*                                                                  2000
@RF01900 AL    CLT,@CF00045                                        2000
@DE01899 CH    CLT,ASSOC#                                          2000
         BNH   @DL01899                                            2000
*                    /************************************************/
*                    /*                                      @YL026UE*/
*                    /* PROCESSING THE LIST OF ASSOCIATIONS IS       */
*                    /* COMPLETED. RESTORE THE CPL POINTER TO THE    */
*                    /* MAIN CPL SETUP FOR SUBSET REQUESTS.  CLEAR   */
*                    /* THE ENTRYNAME LOCATE INDICATOR.      @YL026UE*/
*                    /*                                      @YL026UE*/
*                    /************************************************/
*                                                                  2001
*                    CTGNOFLD = 1;                         /*@YL026UE*/
         L     @04,CTGPLPTR                                        2001
         MVI   CTGNOFLD(@04),X'01'                                 2001
*                    CTGPLPTR = TYPCPLPT;                  /*@YL026UE*/
         L     @04,TYPCPLPT                                        2002
         ST    @04,CTGPLPTR                                        2002
*                    RESPECIFY ASSOC BASED(CTGFLPT(1));    /*@YL026UE*/
*                    ENTNMFLG = OFF;                       /*@YL026UE*/
         NI    ENTNMFLG,B'01111111'                                2004
*                RETURN CODE(0);                           /*@YL026UE*/
         SLR   @15,@15                                             2005
         L     @14,@SA00010                                        2005
         LM    @00,@12,@SA00010+8                                  2005
         BR    @14                                                 2005
*              END ANLTPROC;                               /*@YL026UE*/
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* PROCEDURE - ALSPROC                              @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* FUNCTION - RETRIEVES FROM THE CATALOG THE ASSOCIATED     */
*        /* ENTRYNAMES VIA C.I. NOS., AND LISTS THESE ASSOCIATED     */
*        /* ENTRYNAMES AND TYPES FOLLOWING THE ASSOCIATIONS  @YL026UE*/
*        /* HEADER FOR ALIAS ENTRIES                         @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* INPUT - SEPARATE CPL AND WORKAREA FOR RETREIVING AN      */
*        /* ASSOCIATED ENTRYNAME, AND THE FIRST CI# AND TYPE OF      */
*        /* THE ALIAS ASSOCIATION STRING OR REAL NAME.       @YL026UE*/
*        /*                                                  @YL026UE*/
*        /* OUTPUT - A LISTING OF THE 44-BYTE ASSOCIATED ENTRYNAMES  */
*        /* AND TYPES.                                       @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  2007
*ALSPROC: PROCEDURE;                                       /*@YL026UE*/
*                                                                  2007
ALSPROC  STM   @14,@12,@SA00011                                    2007
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* LOCAL VARIABLES                                  @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  2008
*        DCL ALSTRING  CHAR(*) BASED;  /*OVERLAY FOR STRING  @YL026UE*/
*        DCL INITFLG   BIT(1) BDY(BYTE); /*INITIAL ENTRY TO DO LOOP
*                                                            @YL026UE*/
*        DCL NXTNAMFG  BIT(1) BDY(BYTE); /*ALIAS NAME STRING CONTINUES
*                                                            @YL026UE*/
*        DCL ASFLDNO   FIXED(15) CONSTANT(3);              /*@Y30SSMK*/
*                                        /*NO. OF FPLS FOR ALIAS ASSOC
*                                                            @Y30SSMK*/
*                                                                  2012
*        /************************************************************/
*        /*                                                  @YL026UE*/
*        /* SETUP THE DARGLIST TO PRINT THE ASSOCIATIONS HEADER.     */
*        /* IF NO ASSOCIATED C.I.NOS. WERE RETURNED FROM THE @YL026UE*/
*        /* CATALOG, PRINT THE 'NULL' STATIC TEXT ENTRY WITH THE     */
*        /* ASSOCIATIONS HEADER. OTHERWISE, PRINT THE ASSOCIATED     */
*        /* ENTRYNAMES FOLLOWING THE ASSOCIATIONS HEADER.    @YL026UE*/
*        /*                                                  @YL026UE*/
*        /************************************************************/
*                                                                  2012
*        DARGSENT = LCST35;                                /*@ZA05939*/
         L     @04,DARGPTR                                         2012
         MVI   DARGSENT(@04),X'23'                                 2012
*        OLDERID2 = NEWERID2;                                      2013
         L     @15,@PC00001                                        2013
         L     @15,GDTTR2(,@15)                                    2013
         MVC   @TS00001(95),NEWERID2(@15)                          2013
         MVC   OLDERID2(95,@15),@TS00001                           2013
*        NEWID2 = 'LCAS';                                  /*@YL026UE*/
         MVC   NEWID2(4,@15),@CC01714                              2014
*        NXTNAMFG = ON;                                    /*@YL026UE*/
         OI    NXTNAMFG,B'10000000'                                2015
*        INITFLG = ON;                                     /*@YL026UE*/
         OI    INITFLG,B'10000000'                                 2016
*        CTGFLPTR = ASSOCFPT;                              /*@YL026UE*/
         L     @15,ASSOCFPT                                        2017
         ST    @15,CTGFLPTR                                        2017
*        IF CTGFLNG(1) <= 0 & G0V0FLG = OFF                        2018
*          THEN                                                    2018
         L     @15,CTGFLNG(,@15)                                   2018
         LTR   @15,@15                                             2018
         BP    @RF02018                                            2018
         TM    G0V0FLG,B'10000000'                                 2018
         BNZ   @RF02018                                            2018
*            DO;                                           /*@YL026UE*/
*            DARGSENT = LCST17;                            /*@ZA05939*/
         MVI   DARGSENT(@04),X'11'                                 2020
*            DARGCNT = DRGCNT1;                            /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00045                             2021
*            DARGINS(1) = DRGINS10;                        /*@Y30SSMK*/
         LA    @15,10                                              2022
         STH   @15,DARGINS(,@04)                                   2022
*            DARGINL(1) = ABBREVLN;                        /*@YL026UE*/
         STH   @15,DARGINL(,@04)                                   2023
*            DARGDTM(1) = ADDR(NULLNM);                    /*@YL026UE*/
         L     @01,TEXTPTR                                         2024
         LA    @15,NULLNM(,@01)                                    2024
         ST    @15,DARGDTM(,@04)                                   2024
*            CALL LISTPROC;                                /*@YL026UE*/
         BAL   @14,LISTPROC                                        2025
*            RETURN CODE(0);                               /*@YL026UE*/
         SLR   @15,@15                                             2026
         L     @14,@SA00011                                        2026
         LM    @00,@12,@SA00011+8                                  2026
         BR    @14                                                 2026
*            END;                                          /*@YL026UE*/
*          ELSE                                                    2028
*            IF G0V0FLG = OFF                                      2028
*              THEN                                                2028
@RF02018 TM    G0V0FLG,B'10000000'                                 2028
         BNZ   @RF02028                                            2028
*                CALL LISTPROC;                            /*@YL026UE*/
*                                                                  2029
         BAL   @14,LISTPROC                                        2029
*            /********************************************************/
*            /*                                              @YL026UE*/
*            /* INITIALIZE THE CPL POINTER TO ANOTHER CPL SETUP      */
*            /* ESPECIALLY FOR ENTRYNAME REQUESTS VIA C.I.NOS.       */
*            /*                                              @YL026UE*/
*            /********************************************************/
*                                                                  2030
*              IF G0V0FLG = OFF                                    2030
*                THEN                                              2030
@RF02028 TM    G0V0FLG,B'10000000'                                 2030
         BNZ   @RF02030                                            2030
*                  DO;                                     /*@YL026UE*/
*                  ALIASCI# = CI#(1);                      /*@YL026UE*/
         L     @04,CTGFLPTR                                        2032
         L     @04,CTGFLPT(,@04)                                   2032
         MVC   ALIASCI#(3),CI#(@04)                                2032
*                  ALIASKND = KIND(1);                     /*@YL026UE*/
         MVC   ALIASKND(1),KIND(@04)                               2033
*                  END;                                    /*@YL026UE*/
*              IF HOLDETYP = CTGTANM                               2035
*                THEN                                              2035
@RF02030 CLI   HOLDETYP,C'X'                                       2035
         BNE   @RF02035                                            2035
*                  NXTNAMFG = OFF;                         /*@YL026UE*/
         NI    NXTNAMFG,B'01111111'                                2036
*              CTGPLPTR = CI#CPLPT;                        /*@YL026UE*/
@RF02035 L     @04,CI#CPLPT                                        2037
         ST    @04,CTGPLPTR                                        2037
*ALIASLP:      DO WHILE(NXTNAMFG = ON  INITFLG = ON);     /*@YL026UE*/
*                                                                  2038
ALIASLP  B     @DE02038                                            2038
@DL02038 DS    0H                                                  2039
*                INITFLG = OFF;                            /*@YL026UE*/
         NI    INITFLG,B'01111111'                                 2039
*                /****************************************************/
*                /*                                          @YL026UE*/
*                /* INSERT THE ASSOCIATED C.I.NO. ADDRESS AND TYPE   */
*                /* IN THE CPL.  ALSO SET AN INDICATOR TO IDENTIFY   */
*                /* WHICH CPL SAVEAREA IS TO USED DURING THE LOCATE  */
*                /* REQUEST OF AN ENTRYNAME ONLY.            @YL026UE*/
*                /*                                          @YL026UE*/
*                /****************************************************/
*                                                                  2040
*                CTGPSWD = TYPCPLPT->CTGPSWD;              /*@YL026UE*/
         L     @04,CTGPLPTR                                        2040
         L     @01,TYPCPLPT                                        2040
         L     @15,CTGPSWD(,@01)                                   2040
         ST    @15,CTGPSWD(,@04)                                   2040
*                CTGENT = ADDR(ALIASCI#);                  /*@YL026UE*/
         LA    @15,ALIASCI#                                        2041
         ST    @15,CTGENT(,@04)                                    2041
*                ENTNMFLG = ON;        /*LOCATE ENTRYNAME ONLY       */
*                                                                  2042
         OI    ENTNMFLG,B'10000000'                                2042
*                /****************************************************/
*                /*                                          @YL026UE*/
*                /* INITIALIZE THE REQUIRED FPLS             @YL026UE*/
*                /*                                          @YL026UE*/
*                /****************************************************/
*                                                                  2043
*                CTGFLPTR = ENT44FPT;                      /*@YL026UE*/
         L     @15,ENT44FPT                                        2043
         ST    @15,CTGFLPTR                                        2043
*                CTGFLPTR->ALSTRING(1:LCFPLLEN) = ZEROAREA(1:LCFPLLEN);
         SLR   @14,@14                                             2044
         IC    @14,LCFPLLEN                                        2044
         BCTR  @14,0                                               2044
         EX    @14,@SM01775                                        2044
*                CTGFLDNO = 1;                             /*@YL026UE*/
         MVI   CTGFLDNO(@15),X'01'                                 2045
*                CTGFLDNM = ADDR(ENT44NM);                 /*@YL026UE*/
*                                                                  2046
*                                                                  2046
*                                                                  2046
         LA    @07,ENT44NM                                         2046
         ST    @07,CTGFLDNM(,@15)                                  2046
*                CTGFIELD(2) = CATTRFPT;                   /*@YL026UE*/
         L     @15,CATTRFPT                                        2047
         ST    @15,CTGFIELD+4(,@04)                                2047
*                CTGFLPTR = CATTRFPT;                      /*@YL026UE*/
         ST    @15,CTGFLPTR                                        2048
*                CTGFLPTR->ALSTRING(1:LCFPLLEN)=                   2049
*                  ZEROAREA(1:LCFPLLEN);                   /*@YL026UE*/
         EX    @14,@SM01775                                        2049
*                CTGFLDNO = 1;                             /*@YL026UE*/
         MVI   CTGFLDNO(@15),X'01'                                 2050
*                CTGFLDNM=ADDR(CATTRNM);                   /*@YL026UE*/
*                                                                  2051
         LA    @07,CATTRNM                                         2051
         ST    @07,CTGFLDNM(,@15)                                  2051
*                CTGNOFLD = ASFLDNO;                       /*@Y30SSMK*/
         MVI   CTGNOFLD(@04),X'03'                                 2052
*                CTGFIELD(3) = ASSOCFPT;                   /*@YL026UE*/
         L     @15,ASSOCFPT                                        2053
         ST    @15,CTGFIELD+8(,@04)                                2053
*                CTGFLPTR = ASSOCFPT;                      /*@YL026UE*/
         ST    @15,CTGFLPTR                                        2054
*                CTGFLPTR ->ALSTRING(1:LCFPLLEN)=                  2055
*                  ZEROAREA(1:LCFPLLEN);                   /*@YL026UE*/
         EX    @14,@SM01775                                        2055
*                CTGFLDNO = 1;                             /*@YL026UE*/
         MVI   CTGFLDNO(@15),X'01'                                 2056
*                CTGFLDNM = ADDR(ASSOCNM);                 /*@YL026UE*/
*                                                                  2057
         LA    @04,ASSOCNM                                         2057
         ST    @04,CTGFLDNM(,@15)                                  2057
*                /****************************************************/
*                /*                                          @YL026UE*/
*                /* ISSUE THE LOCATE REQUEST FOR THE ASSOCIATED      */
*                /* ENTRYNAME.                               @YL026UE*/
*                /*                                          @YL026UE*/
*                /****************************************************/
*                                                                  2058
*                CALL LOCPROC (FPLEND,CACBFLG,ENTNMFLG);   /*@YL026UE*/
         LA    @04,FPLEND                                          2058
         ST    @04,@AL00001                                        2058
         LA    @04,CACBFLG                                         2058
         ST    @04,@AL00001+4                                      2058
         LA    @04,ENTNMFLG                                        2058
         ST    @04,@AL00001+8                                      2058
         LA    @01,@AL00001                                        2058
         BAL   @14,LOCPROC                                         2058
*                RESPECIFY RTNREG RSTD;                            2059
*                TESTRC = RTNREG;                                  2060
         LR    TESTRC,RTNREG                                       2060
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UE*/
*                                                                  2061
*                /****************************************************/
*                /*                                          @YL026UE*/
*                /* IF THERE IS A NON-ZERO CATALOG RETURN CODE,      */
*                /* PROCESS AS INDICATED BELOW, NO MORE      @YL026UE*/
*                /* ASSOCIATIONS CAN BE LISTED.              @YL026UE*/
*                /*                                          @YL026UE*/
*                /****************************************************/
*                                                                  2062
*                IF TESTRC ^= 0                                    2062
*                  THEN                                            2062
         LTR   TESTRC,TESTRC                                       2062
         BZ    @RF02062                                            2062
*                    IF CATRC = CRCNOENT                           2063
*                                                                  2063
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* FOR AN ENTRY NOT FOUND CONDITION, PRINT    */
*                      /* THE VSAM CAT CONDITION CODE MSG AND THE    */
*                      /* INVALID C.I.NO. MSG.  UPDATE THE LISTC     */
*                      /* FINAL CONDITIONAL CODE.            @YL026UE*/
*                      /* NO MORE ASSOCIATIONS CAN BE OBTAINED.      */
*                      /* STOP PROCESSING ASSOCIATION OF THIS        */
*                      /* ENTRY NAME.                        @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  2063
*                      THEN                                        2063
         CLC   CATRC(2),@CH00187                                   2063
         BNE   @RF02063                                            2063
*                        DO;                               /*@YL026UE*/
*                          CILOCFLG = ON;                  /*@OZ09407*/
         OI    CILOCFLG,B'10000000'                                2065
*                          CALL ERRPROC;                   /*@YL026UE*/
         BAL   @14,ERRPROC                                         2066
*                          CILOCFLG = OFF;                 /*@OZ09407*/
         NI    CILOCFLG,B'01111111'                                2067
*                          ERRARGPT->DARGSMOD = LC1ID;     /*@YL026UE*/
         L     @04,ERRARGPT                                        2068
         MVC   DARGSMOD(3,@04),@CC01297                            2068
*                          ERRARGPT->DARGSENT = LCMSG09;   /*@YL026UE*/
         MVI   DARGSENT(@04),X'09'                                 2069
*                          ERRARGPT->DARGDBP = ADDR(ALIASCI#);     2070
         LA    @15,ALIASCI#                                        2070
         ST    @15,DARGDBP(,@04)                                   2070
*                          ERRARGPT->DARGILP = LENGTH(ALIASCI#);   2071
         MVC   DARGILP(2,@04),@CH00170                             2071
*                          CALL ERRPROC;                   /*@YL026UE*/
         BAL   @14,ERRPROC                                         2072
*                          SAVRC = MAX (SAVRC, LASTCC04);  /*@ZA05939*/
         LH    @04,SAVRC                                           2073
         LA    @15,4                                               2073
         CR    @04,@15                                             2073
         BNL   *+6
         LR    @04,@15                                             2073
         STH   @04,SAVRC                                           2073
*                          CTGNOFLD = 1;                   /*@YL026UE*/
         L     @01,CTGPLPTR                                        2074
         MVI   CTGNOFLD(@01),X'01'                                 2074
*                          CTGPLPTR = TYPCPLPT;            /*@YL026UE*/
         L     @15,TYPCPLPT                                        2075
         ST    @15,CTGPLPTR                                        2075
*                          ENTNMFLG = OFF;                 /*@YL026UE*/
         NI    ENTNMFLG,B'01111111'                                2076
*                          RETURN CODE(SAVRC);             /*@ZA05939*/
         LR    @15,@04                                             2077
         L     @14,@SA00011                                        2077
         LM    @00,@12,@SA00011+8                                  2077
         BR    @14                                                 2077
*                        END;                              /*@YL026UE*/
*                                                                  2078
*                      /**********************************************/
*                      /*                                    @YL026UE*/
*                      /* EXIT FOR ALL OTHER NON-ZERO CATALOG RETURN */
*                      /* CODES.  RESET THE CPL POINTER TO THE MAIN  */
*                      /* CPL SETUP FOR SUBSET REQUESTS.     @YL026UE*/
*                      /*                                    @YL026UE*/
*                      /**********************************************/
*                                                                  2079
*                      ELSE                                        2079
*                        DO;                               /*@YL026UE*/
@RF02063 DS    0H                                                  2080
*                          CTGPLPTR = TYPCPLPT;            /*@YL026UE*/
         L     @04,TYPCPLPT                                        2080
         ST    @04,CTGPLPTR                                        2080
*                          ENTNMFLG = OFF;                 /*@YL026UE*/
         NI    ENTNMFLG,B'01111111'                                2081
*                          RETURN CODE (SAVRC);            /*@ZA05939*/
         LH    @15,SAVRC                                           2082
         L     @14,@SA00011                                        2082
         LM    @00,@12,@SA00011+8                                  2082
         BR    @14                                                 2082
*                        END;                              /*@YL026UE*/
*                  /**************************************************/
*                  /*                                        @YL026UE*/
*                  /* BUILD THE DARGLIST TO PRINT THE ASSOCIATED TYPE*/
*                  /* AND NAME.                              @YL026UE*/
*                  /*                                        @YL026UE*/
*                  /**************************************************/
*                                                                  2084
*                  ELSE                                            2084
*                    DO;                                   /*@YL026UE*/
@RF02062 DS    0H                                                  2085
*                      DARGSENT = LCST18;                  /*@YL026UE*/
         L     @04,DARGPTR                                         2085
         MVI   DARGSENT(@04),X'12'                                 2085
*                      DARGCNT = DRGCNT2;                  /*@Y30SSMK*/
         MVC   DARGCNT(2,@04),@CH00161                             2086
*                      DARGINS(1) = DRGINS10;              /*@Y30SSMK*/
         LA    @15,10                                              2087
         STH   @15,DARGINS(,@04)                                   2087
*                      DARGINL(1) = ABBREVLN;              /*@YL026UE*/
         STH   @15,DARGINL(,@04)                                   2088
*                      IF ALIASKND = CTGTALIN                      2089
*                        THEN                                      2089
         CLI   ALIASKND,C'A'                                       2089
         BNE   @RF02089                                            2089
*                          DARGDTM(1) = ADDR(NVSAMNM);     /*@YL026UE*/
         L     @01,TEXTPTR                                         2090
         LA    @15,NVSAMNM(,@01)                                   2090
         ST    @15,DARGDTM(,@04)                                   2090
*                        ELSE                                      2091
*                          IF ALIASKND = CTGTGBS                   2091
*                            THEN                                  2091
         B     @RC02089                                            2091
@RF02089 CLI   ALIASKND,C'B'                                       2091
         BNE   @RF02091                                            2091
*                              DARGDTM(1) = ADDR(GDGNM);   /*@YL026UE*/
         L     @04,TEXTPTR                                         2092
         LA    @04,GDGNM(,@04)                                     2092
         L     @01,DARGPTR                                         2092
         ST    @04,DARGDTM(,@01)                                   2092
*                            ELSE                                  2093
*                              IF ALIASKND=CTGTUCAT                2093
*                                THEN                              2093
         B     @RC02091                                            2093
@RF02091 CLI   ALIASKND,C'U'                                       2093
         BNE   @RF02093                                            2093
*                                  DARGDTM(1)=ADDR(UCATNM);/*@YL026UE*/
         L     @04,TEXTPTR                                         2094
         LA    @04,UCATNM(,@04)                                    2094
         L     @01,DARGPTR                                         2094
         ST    @04,DARGDTM(,@01)                                   2094
*                                ELSE                              2095
*                                  IF ALIASKND=CTGTANM             2095
*                                    THEN                          2095
         B     @RC02093                                            2095
@RF02093 CLI   ALIASKND,C'X'                                       2095
         BNE   @RF02095                                            2095
*                                      DARGDTM(1)=                 2096
*                                        ADDR(ALIASNM);    /*@YL026UE*/
         L     @04,TEXTPTR                                         2096
         LA    @04,ALIASNM(,@04)                                   2096
         L     @01,DARGPTR                                         2096
         ST    @04,DARGDTM(,@01)                                   2096
*                                    ELSE                          2097
*                                      DARGDTM(1)=                 2097
*                                        ADDR(NULLNM);     /*@YL026UE*/
         B     @RC02095                                            2097
@RF02095 L     @04,TEXTPTR                                         2097
         LA    @04,NULLNM(,@04)                                    2097
         L     @01,DARGPTR                                         2097
         ST    @04,DARGDTM(,@01)                                   2097
*                      DARGINS(2) = DRGINS20;              /*@Y30SSMK*/
@RC02095 DS    0H                                                  2098
@RC02093 DS    0H                                                  2098
@RC02091 DS    0H                                                  2098
@RC02089 L     @04,DARGPTR                                         2098
         MVC   DARGINS+8(2,@04),@CH00649                           2098
*                      CTGFLPTR = ENT44FPT;                /*@YL026UE*/
         L     @15,ENT44FPT                                        2099
         ST    @15,CTGFLPTR                                        2099
*                      DARGINL(2) = CTGFLNG(1);            /*@YL026UE*/
         L     @14,CTGFLNG(,@15)                                   2100
         STH   @14,DARGINL+8(,@04)                                 2100
*                      DARGDTM(2) = CTGFLPT(1);            /*@YL026UE*/
         L     @15,CTGFLPT(,@15)                                   2101
         ST    @15,DARGDTM+8(,@04)                                 2101
*                      CALL LISTPROC;                      /*@YL026UE*/
         BAL   @14,LISTPROC                                        2102
*                      IF NXTNAMFG = ON                            2103
*                        THEN                                      2103
         TM    NXTNAMFG,B'10000000'                                2103
         BNO   @RF02103                                            2103
*                          DO;                             /*@YL026UE*/
*                          CTGFLPTR = ASSOCFPT;            /*@YL026UE*/
         L     @04,ASSOCFPT                                        2105
         ST    @04,CTGFLPTR                                        2105
*                          ALIASCI# = NXTNMPTR;            /*@YL026UE*/
         L     @04,CTGFLPT(,@04)                                   2106
         MVC   ALIASCI#(3),NXTNMPTR(@04)                           2106
*                          ALIASKND = NXTNMTY;             /*@YL026UE*/
         MVC   ALIASKND(1),NXTNMTY(@04)                            2107
*                          IF NXTNMPTR = 0                         2108
*                            THEN                                  2108
         ICM   @15,7,NXTNMPTR(@04)                                 2108
         BNZ   @RF02108                                            2108
*                              NXTNAMFG = OFF;             /*@YL026UE*/
         NI    NXTNAMFG,B'01111111'                                2109
*                          END;                            /*@YL026UE*/
@RF02108 DS    0H                                                  2111
*                    END;                                  /*@YL026UE*/
@RF02103 DS    0H                                                  2112
*              END ALIASLP;                                /*@YL026UE*/
*                                                                  2112
@DE02038 TM    NXTNAMFG,B'10000000'                                2112
         BO    @DL02038                                            2112
         TM    INITFLG,B'10000000'                                 2112
         BO    @DL02038                                            2112
*              /******************************************************/
*              /*                                            @YL026UE*/
*              /* PROCESSING THE LIST OF ASSOCIATIONS IS COMPLETED.  */
*              /* RESTORE THE CPL POINTER TO THE MAIN CPL SETUP FOR  */
*              /* SUBSET REQUESTS.  CLEAR THE ENTRYNAME LOCATE       */
*              /* INDICATOR.                                 @YL026UE*/
*              /*                                            @YL026UE*/
*              /******************************************************/
*                                                                  2113
*              CTGNOFLD = 1;                               /*@YL026UE*/
         L     @04,CTGPLPTR                                        2113
         MVI   CTGNOFLD(@04),X'01'                                 2113
*              CTGPLPTR = TYPCPLPT;                        /*@YL026UE*/
         L     @04,TYPCPLPT                                        2114
         ST    @04,CTGPLPTR                                        2114
*              RESPECIFY ASSOC BASED(CTGFLPT(1));          /*@YL026UE*/
*              ENTNMFLG = OFF;                             /*@YL026UE*/
         NI    ENTNMFLG,B'01111111'                                2116
*          RETURN CODE(0);                                 /*@YL026UE*/
         SLR   @15,@15                                             2117
         L     @14,@SA00011                                        2117
         LM    @00,@12,@SA00011+8                                  2117
         BR    @14                                                 2117
*        END ALSPROC;                                      /*@YL026UE*/
*        /************************************************************/
*        /*                                                  @ZA01484*/
*        /* PROCEDURE  NAME - SHORTLST                       @ZA01484*/
*        /*                                                  @ZA01484*/
*        /*                                                  @ZA01484*/
*        /* FUNCTION - PRODUCES AN ABBREVIATED LISTING OF    @ZA01484*/
*        /*            CATALOG ENTRY NAMES THAT ARE IN THE   @ZA01484*/
*        /*            WORK AREA.                            @ZA01484*/
*        /*                                                  @ZA01484*/
*        /* INPUT - IMPLICIT WORK AREA CONTAINING CATALOG    @ZA01484*/
*        /*         NAMES AND DATA SET NAMES RETURNED        @ZA01484*/
*        /*         FROM A UCIR GENERIC LOCATE.              @ZA01484*/
*        /*                                                  @ZA01484*/
*        /* OUTPUT - A PRINTED LIST CONSISTING OF A CATALOG  @ZA01484*/
*        /*          NAME HEADER LINE FOLLOW BY THE          @ZA01484*/
*        /*          DATA SET NAMES.                         @ZA01484*/
*        /*                                                  @ZA01484*/
*        /************************************************************/
*                                                                  2119
*SHORTLST: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA0148*/
*                                                                  2119
SHORTLST STM   @14,@12,12(@13)                                     2119
         ST    @13,@SA00012+4                                      2119
         LA    @14,@SA00012                                        2119
         ST    @14,8(,@13)                                         2119
         LR    @13,@14                                             2119
*        GEN(ENTRY SHORTLST);          /*EXT ENTRY POINT     @ZA05939*/
         ENTRY SHORTLST
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  2121
         LM    REG8,REG12,BASESAVE                                 2121
*        /************************************************************/
*        /*                                                  @ZA01484*/
*        /* SET UP A SEPARATE TEXT PROCESSOR PARM LIST FOR   @ZA01484*/
*        /* THE MINIMUM PARAMETERS NEEDED.                   @ZA01484*/
*        /*                                                  @ZA01484*/
*        /************************************************************/
*                                                                  2122
*             DCL SRTDARG    CHAR(LENGTH(DARGLIST) +               2122
*                             LENGTH(DARGARY))  BDY(WORD); /*@ZA01484*/
*             DCL SRTARGPT   PTR(31);                      /*@ZA01484*/
*                                                                  2123
*        /************************************************************/
*        /*                                                  @ZA01484*/
*        /* LOCAL VARIABLES                                  @ZA01484*/
*        /*                                                  @ZA01484*/
*        /************************************************************/
*                                                                  2124
*             DCL LSTCNT    FIXED(15); /*NO. OF ENT FOR LIST @ZA01484*/
*             DCL REPCNT    FIXED(15) CONSTANT(1);         /*@ZA01484*/
*                                /* NO. OF REPITITION ELEM   @ZA01484*/
*             DCL PRTCOL    FIXED(8) CONSTANT(0);          /*@ZA01484*/
*                                       /*PRINT COL OFFSET   @ZA01484*/
*             DCL REDOREF   FIXED(15) CONSTANT(10);        /*@ZA01484*/
*                                        /*REP ELEM REF NO.  @ZA01484*/
*                                                                  2128
*        /************************************************************/
*        /*                                                  @ZA01484*/
*        /* INITIALIZE TEXT PROCESSOR PARM LIST AND LOCAL    @ZA01484*/
*        /* SWITCHES.                                        @ZA01484*/
*        /*                                                  @ZA01484*/
*        /************************************************************/
*                                                                  2128
*        OLDERID2 = NEWERID2;                                      2128
         L     @04,@PC00001                                        2128
         L     @04,GDTTR2(,@04)                                    2128
         MVC   @TS00001(95),NEWERID2(@04)                          2128
         MVC   OLDERID2(95,@04),@TS00001                           2128
*        NEWID2 = 'LCSH';                                  /*@Y30LSMK*/
*                                                                  2129
         MVC   NEWID2(4,@04),@CC01729                              2129
*        SRTARGPT = ADDR(SRTDARG);                         /*@ZA01484*/
         LA    @04,SRTDARG                                         2130
         ST    @04,SRTARGPT                                        2130
*        SRTARGPT->DARGRETP = 0; /*NULL FORMAT AREA          @ZA01484*/
         SLR   @02,@02                                             2131
         ST    @02,DARGRETP(,@04)                                  2131
*        SRTARGPT->DARGSMOD = LC0ID;   /*LISTC STATIC TEXT   @ZA01484*/
         MVC   DARGSMOD(3,@04),@CC01198                            2132
*        SRTARGPT->DARGSENT = LCST57;  /* TEXT STRUC NO.     @ZA01484*/
         MVI   DARGSENT(@04),X'39'                                 2133
*        SRTARGPT->DARGCNT = REPCNT;  /* NO. OF REP ELEM     @ZA01484*/
         MVC   DARGCNT(2,@04),@CH00045                             2134
*        SRTARGPT->DARGIND = PRTCOL;  /* PRINT COL OFFSET    @ZA01484*/
         MVI   DARGIND(@04),X'00'                                  2135
*        SRTARGPT->DARGREP(1) = REDOREF;  /* REP ELEM REF NO. */   2136
         MVC   DARGREP(2,@04),@CH00457                             2136
*        SRTARGPT->DARGDTM(1) = 0;  /* NULL INSERT DATA ADDR @ZA01484*/
*                                                                  2137
         ST    @02,DARGDTM(,@04)                                   2137
*        LSTCNT = 0;                                       /*@ZA01484*/
*                                                                  2138
         SLR   LSTCNT,LSTCNT                                       2138
*        /************************************************************/
*        /*                                                  @ZA01484*/
*        /* PROCESS SHORT LIST LOOP.                         @ZA01484*/
*        /*                                                  @ZA01484*/
*        /************************************************************/
*                                                                  2139
*NAMELST:     DO NLST = 1 TO OBJCNT;                       /*@ZA01484*/
*                                                                  2139
NAMELST  LA    @04,1                                               2139
         B     @DE02139                                            2139
@DL02139 DS    0H                                                  2140
*               IF OBJTYP(NLST) = 'F0'X       /* CHECK FOR CAT NAME  */
*                 THEN                                             2140
*                                                                  2140
         LA    @02,45                                              2140
         LR    @01,@04                                             2140
         MR    @00,@02                                             2140
         L     @04,OBJNMPTR                                        2140
         ALR   @04,@01                                             2140
         AL    @04,@CF01777                                        2140
         CLI   OBJTYP-4(@04),X'F0'                                 2140
         BNE   @RF02140                                            2140
*                       IF LSTCNT > 0                              2141
*                         THEN                                     2141
         LTR   LSTCNT,LSTCNT                                       2141
         BNP   @RF02141                                            2141
*                           DO;                            /*@ZA01484*/
*                           SRTARGPT->DARGPCT(1) = LSTCNT; /*@ZA01484*/
         L     @04,SRTARGPT                                        2143
         STH   LSTCNT,DARGPCT(,@04)                                2143
*                           SRTARGPT->DARGILP = LSTCNT*45+45;      2144
         LR    @01,LSTCNT                                          2144
         MR    @00,@02                                             2144
         ALR   @01,@02                                             2144
         STH   @01,DARGILP(,@04)                                   2144
*                                                          /*@ZA01484*/
*                           CALL AMSTP011(GDTTBL,OTIOCSPT,SRTARGPT);
         L     @04,@PC00001                                        2145
         ST    @04,@AL00001                                        2145
         LA    @02,OTIOCSPT                                        2145
         ST    @02,@AL00001+4                                      2145
         LA    @02,SRTARGPT                                        2145
         ST    @02,@AL00001+8                                      2145
         MVI   @AL00001+8,X'80'                                    2145
         L     @15,GDTPRT(,@04)                                    2145
         LA    @01,@AL00001                                        2145
         BALR  @14,@15                                             2145
*                           RESPECIFY RTNREG RSTD;                 2146
*                           TESTRC = RTNREG;                       2147
         LR    TESTRC,RTNREG                                       2147
*                           RESPECIFY RTNREG UNRSTD;       /*@ZA01484*/
*                           SAVRC = MAX(SAVRC, TESTRC);    /*@ZA01484*/
         LH    @04,SAVRC                                           2149
         CR    @04,TESTRC                                          2149
         BNL   *+6
         LR    @04,TESTRC                                          2149
         STH   @04,SAVRC                                           2149
*                           SRTARGPT->DARGDBP = ADDR(OBJTYP(NLST));
         LH    @04,NLST                                            2150
         MH    @04,@CH01258                                        2150
         L     @02,OBJNMPTR                                        2150
         AL    @02,@CF01777                                        2150
         LA    @04,OBJTYP-4(@04,@02)                               2150
         L     @02,SRTARGPT                                        2150
         ST    @04,DARGDBP(,@02)                                   2150
*                           LSTCNT = 0;                    /*@ZA01484*/
         SLR   LSTCNT,LSTCNT                                       2151
*                           END;                           /*@ZA01484*/
*                         ELSE                                     2153
*                           DO;                            /*@ZA01484*/
         B     @RC02141                                            2153
@RF02141 DS    0H                                                  2154
*                           SRTARGPT->DARGDBP = ADDR(OBJTYP(NLST));
         LH    @04,NLST                                            2154
         MH    @04,@CH01258                                        2154
         L     @02,OBJNMPTR                                        2154
         AL    @02,@CF01777                                        2154
         LA    @04,OBJTYP-4(@04,@02)                               2154
         L     @02,SRTARGPT                                        2154
         ST    @04,DARGDBP(,@02)                                   2154
*                           END;                           /*@ZA01484*/
*                                                                  2155
*                 ELSE      /* COUNT DATA SET NAMES          @ZA01484*/
*                   LSTCNT = LSTCNT + 1;                   /*@ZA01484*/
         B     @RC02140                                            2156
@RF02140 AL    LSTCNT,@CF00045                                     2156
*        END NAMELST;                                      /*@ZA01484*/
*                                                                  2157
@RC02140 LA    @04,1                                               2157
         AH    @04,NLST                                            2157
@DE02139 STH   @04,NLST                                            2157
         L     @02,OBJNMPTR                                        2157
         C     @04,OBJCNT(,@02)                                    2157
         BNH   @DL02139                                            2157
*        /************************************************************/
*        /*                                                  @ZA01484*/
*        /* PROCESS BALANCE OF DATA SET NAMES.               @ZA01484*/
*        /* IF THERE ARE NO NAMES SKIP ANY PRINTOUT.         @ZA01484*/
*        /*                                                  @ZA01484*/
*        /************************************************************/
*                                                                  2158
*        IF LSTCNT > 0                                             2158
*             THEN                                                 2158
         LTR   LSTCNT,LSTCNT                                       2158
         BNP   @RF02158                                            2158
*                  DO;                                     /*@ZA01484*/
*                  SRTARGPT->DARGPCT(1) = LSTCNT;          /*@ZA01484*/
         L     @04,SRTARGPT                                        2160
         STH   LSTCNT,DARGPCT(,@04)                                2160
*                  SRTARGPT->DARGILP = LSTCNT*45+45;       /*@ZA01484*/
         LA    @02,45                                              2161
         LR    @01,LSTCNT                                          2161
         MR    @00,@02                                             2161
         ALR   @01,@02                                             2161
         STH   @01,DARGILP(,@04)                                   2161
*                  CALL AMSTP011(GDTTBL,OTIOCSPT,SRTARGPT);/*@ZA01484*/
         L     @04,@PC00001                                        2162
         ST    @04,@AL00001                                        2162
         LA    @02,OTIOCSPT                                        2162
         ST    @02,@AL00001+4                                      2162
         LA    @02,SRTARGPT                                        2162
         ST    @02,@AL00001+8                                      2162
         MVI   @AL00001+8,X'80'                                    2162
         L     @15,GDTPRT(,@04)                                    2162
         LA    @01,@AL00001                                        2162
         BALR  @14,@15                                             2162
*                  RESPECIFY RTNREG RSTD;                          2163
*                  TESTRC = RTNREG;                                2164
         LR    TESTRC,RTNREG                                       2164
*                  RESPECIFY RTNREG UNRSTD;                /*@ZA01484*/
*                  SAVRC = MAX (SAVRC, TESTRC);            /*@ZA01484*/
         LH    @04,SAVRC                                           2166
         CR    @04,TESTRC                                          2166
         BNL   *+6
         LR    @04,TESTRC                                          2166
         STH   @04,SAVRC                                           2166
*                  END;                                    /*@ZA01484*/
*                                                                  2167
*        RETURN CODE(0);                                   /*@ZA01484*/
@RF02158 SLR   @15,@15                                             2168
         L     @13,4(,@13)                                         2168
         L     @14,12(,@13)                                        2168
         LM    @00,@12,20(@13)                                     2168
         BR    @14                                                 2168
*      END SHORTLST;                                       /*@ZA01484*/
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* PROCEDURE - VOLLIST                              @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /* FUNCTION - PRODUCES AN ABBREVIATED LISTING OF    @Y30SSMK*/
*        /* CATALOG ENTRY NAMES AND VOLUME INFORMATION.      @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /* INPUT - THE WORKAREA CONTAINING THE VSAM DATA    @Y30SSMK*/
*        /* RETRIEVED VIA A LOCATE REQUEST.                  @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /* OUTPUT - A PRINTED LIST CONSISTING OF THE DATA   @Y30SSMK*/
*        /* SET NAME AND, FOR ENTRIES CONTAINING VOLUME      @Y30SSMK*/
*        /* INFORMATION, THE VOLUME SERIAL NUMBERS.          @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  2170
*VOLLIST: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA05939*/
*                                                                  2170
VOLLIST  STM   @14,@12,12(@13)                                     2170
         ST    @13,@SA00013+4                                      2170
         LA    @14,@SA00013                                        2170
         ST    @14,8(,@13)                                         2170
         LR    @13,@14                                             2170
*        GEN(ENTRY VOLLIST);           /*EXT ENTRY POINT     @ZA05939*/
         ENTRY VOLLIST
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  2172
         LM    REG8,REG12,BASESAVE                                 2172
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* BUILD THE DARGLIST TO PRINT THE CATALOG ENTRY    @Y30SSMK*/
*        /* NAME.                                            @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  2173
*        OLDERID2 = NEWERID2;                                      2173
         L     @04,@PC00001                                        2173
         L     @04,GDTTR2(,@04)                                    2173
         MVC   @TS00001(95),NEWERID2(@04)                          2173
         MVC   OLDERID2(95,@04),@TS00001                           2173
*        NEWID2 = 'LCVO';                                  /*@Y30SSMK*/
*                                                                  2174
         MVC   NEWID2(4,@04),@CC01737                              2174
*        DARGSENT = LCST58;                                /*@Y30SSMK*/
         L     @04,DARGPTR                                         2175
         MVI   DARGSENT(@04),X'3A'                                 2175
*        DARGDBP = ENT44FPT->CTGFLPT(1);                   /*@Y30SSMK*/
         L     @15,ENT44FPT                                        2176
         L     @14,CTGFLPT(,@15)                                   2176
         ST    @14,DARGDBP(,@04)                                   2176
*        DARGILP = ENT44FPT->CTGFLNG(1);                   /*@Y30SSMK*/
*                                                                  2177
         L     @15,CTGFLNG(,@15)                                   2177
         STH   @15,DARGILP(,@04)                                   2177
*        CALL LISTPROC;                                    /*@Y30SSMK*/
*                                                                  2178
         BAL   @14,LISTPROC                                        2178
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* IF THE ENTRY CONTAINS VOLUME INFORMATION, LIST   @Y30SSMK*/
*        /* THE VOLUME SERIAL NUMBERS.                       @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  2179
*        IF HOLDETYP = CTGTDATA                                   2179
*          HOLDETYP = CTGTINDX                                    2179
*          HOLDETYP = CTGTALIN                                    2179
*          HOLDETYP = CTGTUCAT                                     2179
*          THEN                                                    2179
*                                                                  2179
         CLI   HOLDETYP,C'D'                                       2179
         BE    @RT02179                                            2179
         CLI   HOLDETYP,C'I'                                       2179
         BE    @RT02179                                            2179
         CLI   HOLDETYP,C'A'                                       2179
         BE    @RT02179                                            2179
         CLI   HOLDETYP,C'U'                                       2179
         BNE   @RF02179                                            2179
@RT02179 DS    0H                                                  2180
*            /********************************************************/
*            /*                                              @Y30SSMK*/
*            /* SET THE FPL POINTER TO THE FPL REQUESTING    @Y30SSMK*/
*            /* VOLUME INFORMATION.  INITIALIZE THE SERIAL   @Y30SSMK*/
*            /* NO. HOLD AREA TO HEX FF'S SINCE THIS VALUE   @Y30SSMK*/
*            /* DETERMINES THE LISTING OF UNIQUE VOLUME      @Y30SSMK*/
*            /* DATA. THEN LIST THE VOLUME HEADER            @Y30SSMK*/
*            /* USING THE APPROPRIATE PRE-FORMATTED STATIC   @Y30SSMK*/
*            /* TEXT DESCRIPTOR.                             @Y30SSMK*/
*            /*                                              @Y30SSMK*/
*            /********************************************************/
*                                                                  2180
*            DO;                                           /*@Y30SSMK*/
*              CTGFLPTR = AUVOLFPT;                        /*@Y30SSMK*/
         L     @04,AUVOLFPT                                        2181
         ST    @04,CTGFLPTR                                        2181
*              OLDVOL# = HEXFF;                            /*@Y30SSMK*/
         MVC   OLDVOL#(6),HEXFF                                    2182
*              DARGSENT = LCST59;                          /*@Y30SSMK*/
         L     @04,DARGPTR                                         2183
         MVI   DARGSENT(@04),X'3B'                                 2183
*              CALL LISTPROC;                              /*@Y30SSMK*/
*                                                                  2184
         BAL   @14,LISTPROC                                        2184
*              /******************************************************/
*              /*                                            @Y30SSMK*/
*              /* LIST THE CATALOG DATA, LOOPING THROUGH THE @Y30SSMK*/
*              /* REPETITIVE FIELDS.  ONE PASS IS DETERMINED @Y30SSMK*/
*              /* BY THE THE TOTAL LENGTH OF THE INDIVIDUAL  @Y30SSMK*/
*              /* FIXED LENGTH FIELDS RETRIEVED BY THIS FPL  @Y30SSMK*/
*              /* REQUEST.                                   @Y30SSMK*/
*              /*                                            @Y30SSMK*/
*              /******************************************************/
*                                                                  2185
*              DO WHILE CTGFLNG(1) >= LENGTH(AUDATA);      /*@Y30SSMK*/
         B     @DE02185                                            2185
@DL02185 DS    0H                                                  2186
*                IF AUSER ^= OLDVOL#                               2186
*                  THEN                                            2186
*                                                                  2186
         L     @04,CTGFLPTR                                        2186
         L     @04,CTGFLPT(,@04)                                   2186
         CLC   AUSER(6,@04),OLDVOL#                                2186
         BE    @RF02186                                            2186
*                      /**********************************************/
*                      /*                                    @Y30SSMK*/
*                      /* LIST EACH UNIQUE VOLUME SERIAL     @Y30SSMK*/
*                      /* NUMBER.                            @Y30SSMK*/
*                      /*                                    @Y30SSMK*/
*                      /**********************************************/
*                                                                  2187
*                      DO;                                 /*@Y30SSMK*/
*                        OLDVOL# = AUSER;                  /*@Y30SSMK*/
         MVC   OLDVOL#(6),AUSER(@04)                               2188
*                        DARGSENT = LCST60;                /*@Y30SSMK*/
         L     @15,DARGPTR                                         2189
         MVI   DARGSENT(@15),X'3C'                                 2189
*                        DARGILP = LENGTH(AUSER);          /*@Y30SSMK*/
         MVC   DARGILP(2,@15),@CH00164                             2190
*                        DARGDBP = ADDR(AUSER);            /*@Y30SSMK*/
         LA    @04,AUSER(,@04)                                     2191
         ST    @04,DARGDBP(,@15)                                   2191
*                        CALL LISTPROC;                    /*@Y30SSMK*/
         BAL   @14,LISTPROC                                        2192
*                      END;                                /*@Y30SSMK*/
*                                                                  2193
*                /****************************************************/
*                /*                                          @Y30SSMK*/
*                /* UPDATE THE FPL POINTER TO THE NEXT       @Y30SSMK*/
*                /* OCCURRENCE AND ACCORDINGLY DECREMENT     @Y30SSMK*/
*                /* THE TOTAL LENGTH BY THAT JUST PROCESSED. @Y30SSMK*/
*                /*                                          @Y30SSMK*/
*                /****************************************************/
*                                                                  2194
*                CTGFLNG(1) = CTGFLNG(1) - LENGTH(AUDATA); /*@Y30SSMK*/
@RF02186 L     @04,CTGFLPTR                                        2194
         LA    @15,15                                              2194
         L     @14,CTGFLNG(,@04)                                   2194
         SLR   @14,@15                                             2194
         ST    @14,CTGFLNG(,@04)                                   2194
*                CTGFLPT(1) = CTGFLPT(1) + LENGTH(AUDATA); /*@Y30SSMK*/
         AL    @15,CTGFLPT(,@04)                                   2195
         ST    @15,CTGFLPT(,@04)                                   2195
*              END;                                        /*@Y30SSMK*/
@DE02185 L     @04,CTGFLPTR                                        2196
         L     @04,CTGFLNG(,@04)                                   2196
         C     @04,@CF00235                                        2196
         BNL   @DL02185                                            2196
*            END;                                          /*@Y30SSMK*/
*                                                                  2197
*        /************************************************************/
*        /*                                                  @Y30SSMK*/
*        /* EXIT WHEN THE PROCESSING OF ENTRY FIELDS IS      @Y30SSMK*/
*        /* COMPLETED.                                       @Y30SSMK*/
*        /*                                                  @Y30SSMK*/
*        /************************************************************/
*                                                                  2198
*        RETURN CODE (0);                                  /*@Y30SSMK*/
@RF02179 SLR   @15,@15                                             2198
         L     @13,4(,@13)                                         2198
         L     @14,12(,@13)                                        2198
         LM    @00,@12,20(@13)                                     2198
         BR    @14                                                 2198
*        END VOLLIST;                                      /*@Y30SSMK*/
*                                                                  2200
*        /************************************************************/
*        /*                                                  @ZA05939*/
*        /* PROCEDURE - FREESTG                              @ZA05939*/
*        /*                                                  @ZA05939*/
*        /* FUNCTION - FREESTG HAS A SINGLE PURPOSE, TO FREE @ZA05939*/
*        /*            AUTOMATIC STORAGE GOTTEN BY IDCLC02.  @ZA05939*/
*        /*            IT DOES THIS BY INVOKING THE SYSTEM   @ZA05939*/
*        /*            ADAPTER VIA THE UEPIL MACRO.  UPON    @ZA05939*/
*        /*            COMPLETION, THE SYSTEM ADAPTER        @ZA05939*/
*        /*            RETURNS CONTROL TO IDCLC02'S CALLER,  @ZA05939*/
*        /*            IDCLC01.                              @ZA05939*/
*        /*                                                  @ZA05939*/
*        /* INPUT - NONE                                     @ZA05939*/
*        /*                                                  @ZA05939*/
*        /* OUTPUT - IDCLC02'S AUTOMATIC STORAGE IS          @ZA05939*/
*        /*          RELEASED.                               @ZA05939*/
*        /*                                                  @ZA05939*/
*        /************************************************************/
*                                                                  2200
*FREESTG: PROCEDURE OPTIONS(SAVEAREA);                     /*@ZA05939*/
*                                                                  2200
FREESTG  STM   @14,@12,12(@13)                                     2200
         ST    @13,@SA00014+4                                      2200
         LA    @14,@SA00014                                        2200
         ST    @14,8(,@13)                                         2200
         LR    @13,@14                                             2200
*        GEN(ENTRY FREESTG);           /*EXT ENTRY POINT     @ZA05939*/
         ENTRY FREESTG
*        LM(REG8,REG12,BASESAVE);      /*LOAD PROC BASE REGS @ZA05939*/
*                                                                  2202
         LM    REG8,REG12,BASESAVE                                 2202
*        /************************************************************/
*        /*                                                  @ZA05939*/
*        /* ISSUE THE UEPIL MACRO                            @ZA05939*/
*        /*                                                  @ZA05939*/
*        /************************************************************/
*                                                                  2203
*        IF GDTDBG = NULLPTR                                       2203
*          THEN;                                                   2203
         L     @04,@PC00001                                        2203
         L     @04,GDTDBG(,@04)                                    2203
         LTR   @04,@04                                             2203
         BZ    @RT02203                                            2203
*          ELSE                                                    2205
*            CALL IDCDB010 (GDTTBL,'LC98');                        2205
         L     @04,@PC00001                                        2205
         ST    @04,@AL00001                                        2205
         LA    @15,@CC01742                                        2205
         ST    @15,@AL00001+4                                      2205
         MVI   @AL00001+4,X'80'                                    2205
         L     @15,GDTDBG(,@04)                                    2205
         LA    @01,@AL00001                                        2205
         BALR  @14,@15                                             2205
*                                                          /*@ZA05939*/
*                                                                  2206
*        RFY(REG13,REG5) RSTD;                             /*@ZA05939*/
@RT02203 DS    0H                                                  2207
*        REG13 = REG5;                                     /*@ZA05939*/
*                                                                  2207
         LR    REG13,REG5                                          2207
*        CALL IDCSAEP0(GDTTBL,MODID);                              2208
         L     @04,@PC00001                                        2208
         ST    @04,@AL00001                                        2208
         LA    @15,MODID                                           2208
         ST    @15,@AL00001+4                                      2208
         MVI   @AL00001+4,X'80'                                    2208
         L     @15,GDTEPL(,@04)                                    2208
         LA    @01,@AL00001                                        2208
         BALR  @14,@15                                             2208
*                                                          /*@ZA05939*/
*        RFY(REG13,REG5) UNRSTD;                           /*@ZA05939*/
*        END FREESTG;                                      /*@ZA05939*/
@EL00014 L     @13,4(,@13)                                         2210
@EF00014 DS    0H                                                  2210
@ER00014 LM    @14,@12,12(@13)                                     2210
         BR    @14                                                 2210
*        /************************************************************/
*        /*                                                  @ZA05939*/
*        /* LISTCAT IDCLC02 EOJ.                             @ZA05939*/
*        /*                                                  @ZA05939*/
*        /************************************************************/
*                                                                  2211
*        END IDCLC02                                       /*@ZA05939*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF03 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSLC )                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*;                                                                 2211
@DATA    DS    0H
@CH00164 DC    H'6'
@CH00498 DC    H'7'
@CH00457 DC    H'10'
@CH00649 DC    H'20'
@CH01231 DC    H'30'
@CH01235 DC    H'33'
@CH00606 DC    H'44'
@CH01258 DC    H'45'
@CH01743 DC    H'121'
@SM01747 MVC   SAVCPL(0,@04),CTGPL(@01)
@SM01749 MVC   SAVCPL(0,@04),CTGPL(@14)
@SM01751 MVC   CTGPL(0,@04),SAVCPL(@15)
@SM01753 MVC   CTGPL(0,@04),SAVCPL(@14)
@SM01758 MVC   CTGFL(0,@04),SAFPL(TEMPTR)
@SM01763 MVC   VDSFPL(0,@14),ZEROAREA
@SM01765 MVC   CASTRING(0,@01),CASTRING(@15)
@SM01767 MVC   CASTRING(0,@04),CASTRING(@01)
@SM01770 MVC   CLSTRING(0,@04),ZEROAREA
@SM01772 MVC   CLSTRING(0,@14),ZEROAREA
@SM01775 MVC   ALSTRING(0,@15),ZEROAREA
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00002 DS    18F
@PC00002 DS    3F
@SA00003 DS    18F
@SA00005 DS    18F
@SA00004 DS    18F
@SA00006 DS    18F
@SA00011 DS    15F
@SA00009 DS    18F
@SA00010 DS    15F
@SA00007 DS    18F
@SA00008 DS    18F
@SA00012 DS    18F
@SA00013 DS    18F
@SA00014 DS    18F
@AL00001 DS    5A
@TF00001 DS    F
@AFTEMPS DS    3F
IDCLC02  CSECT
         DS    0F
@CF00045 DC    F'1'
@CH00045 EQU   @CF00045+2
@CF00161 DC    F'2'
@CH00161 EQU   @CF00161+2
@CF00170 DC    F'3'
@CH00170 EQU   @CF00170+2
@CF00050 DC    F'4'
@CH00050 EQU   @CF00050+2
@CF00187 DC    F'8'
@CH00187 EQU   @CF00187+2
@CF00642 DC    F'9'
@CF00664 DC    F'14'
@CH00664 EQU   @CF00664+2
@CF00235 DC    F'15'
@CF00487 DC    F'16'
@CF00653 DC    F'23'
@CH00653 EQU   @CF00653+2
@CF01247 DC    F'39'
@CF01249 DC    F'40'
@CH01249 EQU   @CF01249+2
@CF01280 DC    F'56'
@CH01280 EQU   @CF01280+2
@CF00044 DC    F'256'
@CF01777 DC    F'-41'
@CF01760 DC    F'-40'
@CF01761 DC    F'-8'
@CF01762 DC    F'-6'
@CF01769 DC    F'-4'
@CF01774 DC    F'-3'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
GPLEN    DS    F
CACBPTR  DS    A
TEMPWKA  DS    A
VXDESLEN DS    F
VDIRLEN  DS    F
TEMPSAPT DS    A
SRTARGPT DS    A
LISTPTR  DS    A
VMM      DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
COMAREA  DS    CL20
         ORG   COMAREA
COMSWKPT DS    AL4
COMFPLPT DS    AL4
COMFLGPT DS    AL4
COMVARPT DS    AL4
COMTOTPT DS    AL4
         ORG   COMAREA+20
SAVWKPTR DS    CL104
         ORG   SAVWKPTR
DSBCATPT DS    AL4
CTGPLPTR DS    AL4
TYPCPLPT DS    AL4
SAVCPLPT DS    AL4
OLDCPLPT DS    AL4
ERMCPLPT DS    AL4
LCCPLLEN DS    FL1
         DS    CL3
CI#CPLPT DS    AL4
SA#CPLPT DS    AL4
ER#CPLPT DS    AL4
LC#CPLLN DS    FL2
LCFPLLEN DS    FL1
MTFPLLEN DS    FL1
CTGFLPTR DS    AL4
SAVFPLPT DS    AL4
CILSTLEN DS    FL4
CILSTPTR DS    AL4
CIASOCLN DS    FL4
CIASOCPT DS    AL4
ERRCPLPT DS    AL4
ERRARGPT DS    AL4
DARGPTR  DS    AL4
OTIOCSPT DS    AL4
OBJNMPTR DS    AL4
ENTWKAPT DS    AL4
DPLISTPT DS    AL4
TEXTPTR  DS    AL4
VHDRPTR  DS    AL4
         ORG   SAVWKPTR+104
CORRFPLS DS    CL136
         ORG   CORRFPLS
FIRSTFPL DS    CL4
         ORG   FIRSTFPL
MULTIFPT DS    AL4
         ORG   CORRFPLS+4
SUBSETS  DS    CL128
         ORG   SUBSETS
ETYPFPT  DS    AL4
ENT44FPT DS    AL4
CATTRFPT DS    AL4
ASSOCFPT DS    AL4
EXDTFPT  DS    AL4
         ORG   EXDTFPT
CACBFPT1 DS    AL4
         ORG   SUBSETS+20
CRDTFPT  DS    AL4
DSIDFPT  DS    AL4
RELFPT   DS    AL4
AUVOLFPT DS    AL4
         ORG   AUVOLFPT
CACBFPT2 DS    AL4
         ORG   SUBSETS+36
VCHARFPT DS    AL4
DSSPFPT  DS    AL4
         ORG   DSSPFPT
CACBFPT3 DS    AL4
         ORG   SUBSETS+44
DSHUFPT  DS    AL4
DSHAFPT  DS    AL4
DSVLFPT  DS    AL4
PGBYTFPT DS    AL4
VTIMEFPT DS    AL4
         ORG   VTIMEFPT
CACBFPT4 DS    AL4
         ORG   SUBSETS+64
VSYSXFPT DS    AL4
V#DSPFPT DS    AL4
V#DSFPT  DS    AL4
VHDRFPT  DS    AL4
VDIRFPT  DS    AL4
VXDESFPT DS    AL4
SECURFPT DS    AL4
DSBFPT   DS    AL4
ATTRFPT  DS    AL4
BUFFFPT  DS    AL4
RECLFPT  DS    AL4
GDGATFPT DS    AL4
GDGLMFPT DS    AL4
RGATRFPT DS    AL4
EXITFPT  DS    AL4
RACFPT   DS    AL4
         ORG   CORRFPLS+132
LASTFPT  DS    CL4
         ORG   LASTFPT
CACBFPT5 DS    AL4
         ORG   CORRFPLS+136
FLAGS    DS    CL34
         ORG   FLAGS
CACBFLG  DS    BL1
CLENTFLG DS    BL1
ENTNMFLG DS    BL1
LISTCFLG DS    BL1
NOMSGFLG DS    BL1
CMDERRSW DS    BL1
SUBTFLG  DS    BL1
NOTTLFLG DS    BL1
ATYPFLG  DS    BL1
BTYPFLG  DS    BL1
DTYPFLG  DS    BL1
ITYPFLG  DS    BL1
NDENTFLG DS    BL1
ENLVUDFG DS    BL1
PGSPCFLG DS    BL1
DENTAFLG DS    BL1
ENTCLFLG DS    BL1
G0V0FLG  DS    BL1
NUSEFLG  DS    BL1
GTYPFLG  DS    BL1
RTYPFLG  DS    BL1
ATFPLFLG DS    BL1
GASSOCSW DS    BL1
DATEFLG  DS    BL1
CRDTSW   DS    BL1
EXDTSW   DS    BL1
VTYPFLG  DS    BL1
VTFPLFLG DS    BL1
EXFPLFLG DS    BL1
CRFPLFLG DS    BL1
CTYPFLG  DS    BL1
PTYPFLG  DS    BL1
NOGENFLG DS    BL1
CILOCFLG DS    BL1
         ORG   FLAGS+34
         DS    CL2
MISCVAR  DS    CL72
         ORG   MISCVAR
FPLBEGN  DS    FL2
FPLEND   DS    FL2
FPLCNT   DS    FL2
CATRC    DS    FL2
ASSOC#   DS    FL2
NLST     DS    FL2
SAVRC    DS    FL2
CATNAME  DS    CL44
TYPMULTI DS    CL13
         ORG   TYPMULTI
TYPECNT  DS    FL2
TYPELIST DS    CL11
         ORG   MISCVAR+71
HOLDETYP DS    CL1
         ORG   MISCVAR+72
TYPAUDIT DS    CL48
         ORG   TYPAUDIT
CTYPCNT  DS    FL4
DTYPCNT  DS    FL4
ITYPCNT  DS    FL4
ATYPCNT  DS    FL4
UTYPCNT  DS    FL4
VTYPCNT  DS    FL4
XTYPCNT  DS    FL4
BTYPCNT  DS    FL4
PTYPCNT  DS    FL4
GTYPCNT  DS    FL4
RTYPCNT  DS    FL4
TOTLCNT  DS    FL4
         ORG   TYPAUDIT+48
PCARG    DS    CL33
         ORG   PCARG
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    AL1
         ORG   PCARG+33
LCSUBTIT DS    CL121
         ORG   LCSUBTIT
CARRC    DS    CL1
@NM00059 DS    CL120
         ORG   LCSUBTIT+121
GPID     DS    CL4
ALIASLOC DS    CL4
         ORG   ALIASLOC
ALIASKND DS    CL1
ALIASCI# DS    CL3
         ORG   ALIASLOC+4
         DS    CL2
ERRORTAB DS    CL32
BASESAVE DS    CL20
OLDVOL#  DS    CL6
         DS    CL2
DFLAGS   DS    CL17
         DS    CL3
DUMPWKA  DS    CL65
         ORG   DUMPWKA
ITEM0    DS    CL16
         ORG   ITEM0
ITEM0NM  DS    CL8
ITEM0PTR DS    AL4
ITEM0LEN DS    FL2
ITEM0TYP DS    CL1
@NM00066 DS    CL1
         ORG   DUMPWKA+16
ARYFORM  DS    CL16
         ORG   ARYFORM
ARYNM    DS    CL8
ARYSZ    DS    FL2
ARYITEM  DS    FL2
ARYEXT   DS    FL2
ARYHDR   DS    CL1
@NM00067 DS    CL1
         ORG   DUMPWKA+32
ITEM1    DS    CL16
         ORG   ITEM1
ITEM1NM  DS    CL8
ITEM1PTR DS    AL4
ITEM1LEN DS    FL2
ITEM1TYP DS    CL1
@NM00068 DS    CL1
         ORG   DUMPWKA+48
ITEM2    DS    CL16
         ORG   ITEM2
ITEM2NM  DS    CL8
         ORG   ITEM2NM
LIST2END DS    CL1
@NM00069 DS    CL7
         ORG   ITEM2+8
ITEM2PTR DS    AL4
ITEM2LEN DS    FL2
ITEM2TYP DS    CL1
@NM00070 DS    CL1
         ORG   DUMPWKA+64
LISTEND  DS    CL1
         ORG   DUMPWKA+65
         DS    CL3
DUMPARMS DS    CL113
         ORG   DUMPARMS
ITEM6    DS    CL16
         ORG   ITEM6
ITEM6NM  DS    CL8
ITEM6PTR DS    AL4
ITEM6LEN DS    FL2
ITEM6TYP DS    CL1
@NM00071 DS    CL1
         ORG   DUMPARMS+16
ITEM7    DS    CL16
         ORG   ITEM7
ITEM7NM  DS    CL8
ITEM7PTR DS    AL4
ITEM7LEN DS    FL2
ITEM7TYP DS    CL1
@NM00072 DS    CL1
         ORG   DUMPARMS+32
ITEM8    DS    CL16
         ORG   ITEM8
ITEM8NM  DS    CL8
ITEM8PTR DS    AL4
ITEM8LEN DS    FL2
ITEM8TYP DS    CL1
@NM00073 DS    CL1
         ORG   DUMPARMS+48
ITEM3    DS    CL16
         ORG   ITEM3
ITEM3NM  DS    CL8
ITEM3PTR DS    AL4
ITEM3LEN DS    FL2
ITEM3TYP DS    CL1
@NM00074 DS    CL1
         ORG   DUMPARMS+64
ARY2FORM DS    CL16
         ORG   ARY2FORM
ARY2NM   DS    CL8
ARY2SZ   DS    FL2
ARY2ITEM DS    FL2
ARY2EXT  DS    FL2
ARY2HDR  DS    CL1
@NM00075 DS    CL1
         ORG   DUMPARMS+80
ITEM4    DS    CL16
         ORG   ITEM4
ITEM4NM  DS    CL8
ITEM4PTR DS    AL4
ITEM4LEN DS    FL2
ITEM4TYP DS    CL1
@NM00076 DS    CL1
         ORG   DUMPARMS+96
ITEM9    DS    CL16
         ORG   ITEM9
ITEM9NM  DS    CL8
         ORG   ITEM9NM
LIST3END DS    CL1
@NM00077 DS    CL7
         ORG   ITEM9+8
ITEM9PTR DS    AL4
ITEM9LEN DS    FL2
ITEM9TYP DS    CL1
@NM00078 DS    CL1
         ORG   DUMPARMS+112
LIST4END DS    CL1
         ORG   DUMPARMS+113
         DS    CL3
DUMPMARG DS    CL17
         ORG   DUMPMARG
ITEMM    DS    CL16
         ORG   ITEMM
ITEMMNM  DS    CL8
ITEMMPTR DS    AL4
ITEMMLEN DS    FL2
ITEMMTYP DS    CL1
@NM00079 DS    CL1
         ORG   DUMPMARG+16
LISTMEND DS    CL1
         ORG   DUMPMARG+17
         DS    CL3
DUMPDARG DS    CL17
         ORG   DUMPDARG
ITEM5    DS    CL16
         ORG   ITEM5
ITEM5NM  DS    CL8
ITEM5PTR DS    AL4
ITEM5LEN DS    FL2
ITEM5TYP DS    CL1
@NM00080 DS    CL1
         ORG   DUMPDARG+16
LIST5END DS    CL1
         ORG   DUMPDARG+17
VXTITLSW DS    BL1
VDSHDRSW DS    BL1
INITFLG  DS    BL1
NXTNAMFG DS    BL1
         DS    CL3
SRTDARG  DS    CL28
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCLC02  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC01550 DC    C'MULTIFPL'
@CC01561 DC    C'CTGWKAPT'
@CC01602 DC    C'DARGLIST'
@CC01553 DC    C'CTGPSWD'
@CC01588 DC    C'ERRDARG'
@CC01552 DC    C'CTGENT'
@CC01559 EQU   @CC01561
@CC01564 DC    C'WKAEND'
@CC01544 DC    C'FLAGS'
@CC01547 DC    C'CTGPL'
@CC01549 DC    C'CTGFL'
@CC01551 DC    C'CATRC'
@CC01396 DC    C'LC08'
@CC01398 DC    C'LC09'
@CC01427 DC    C'LC02'
@CC01546 DC    C'LCLO'
@CC01554 DC    C'LCBL'
@CC01558 DC    C'LCAL'
@CC01565 DC    C'LCWA'
@CC01575 DC    C'LCFP'
@CC01589 DC    C'LCMG'
@CC01590 DC    C'LCER'
@CC01603 DC    C'LCTP'
@CC01604 DC    C'LCLT'
@CC01610 DC    C'LCAU'
@CC01611 DC    C'LCAP'
@CC01637 DC    C'LCCL'
@CC01638 DC    C'LCCD'
@CC01670 DC    C'LCVL'
@CC01691 DC    C'LCSA'
@CC01692 DC    C'LC05'
@CC01693 DC    C'LC11'
@CC01701 DC    C'LCLA'
@CC01714 DC    C'LCAS'
@CC01729 DC    C'LCSH'
@CC01737 DC    C'LCVO'
@CC01742 DC    C'LC98'
@CC01198 EQU   @CC01396
@CC01290 DC    C'UV0'
@CC01297 EQU   @CC01693
@CC01548 DC    C'FPL'
@CC01560 EQU   @CC01564
FIXAREA  DS    CL768
         ORG   FIXAREA
@NM00001 DC    256X'00'
@NM00002 DC    256X'00'
@NM00003 DC    256X'00'
         ORG   FIXAREA+768
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
ASSOCNM  DC    CL8'NAMEDS  '
CATTRNM  DC    CL8'CATTR   '
ENT44NM  DC    CL8'ENTNAME '
MULTITNM DC    CL8'MULTITYP'
MODID    DC    CL4'LC02'
         DS    CL1
ARITH4FF DC    X'FFFFFFFF'
HEXFF    DS    CL256
         ORG   HEXFF
@NM00064 DC    256X'FF'
         ORG   HEXFF+256
ZEROAREA DS    CL256
         ORG   ZEROAREA
@NM00065 DC    256X'00'
         ORG   ZEROAREA+256
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
LSTCNT   EQU   @03
ASOCSAPT EQU   @06
CLT      EQU   @07
FLENGTH  EQU   @03
FLOFFSET EQU   @02
TEMPSALN EQU   @02
VWKA     EQU   @02
VHDRLEN  EQU   @04
DALLOCNM EQU   @02
PGPTR    EQU   @07
CURRLEN  EQU   @03
CVARPTR  EQU   @02
CKK      EQU   @06
TEMPTR   EQU   @02
FJJ      EQU   @03
COMPTR   EQU   @02
VDIRPTR  EQU   @07
VXDESPTR EQU   @06
DMPINDEX EQU   @02
TESTRC   EQU   @03
REG5     EQU   @05
REG8     EQU   @08
REG9     EQU   @09
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
RTNREG   EQU   @15
REG13    EQU   @13
CATRCREG EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG6     EQU   @06
REG7     EQU   @07
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSACA0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00013 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGIND  EQU   DARGLIST+18
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGREP  EQU   DARGINS
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
EROSOPER EQU   ERCNVTAB+2
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CATNM    EQU   0
CATNMFLG EQU   CATNM+10
CATDD    EQU   0
OUTDD    EQU   0
ENT      EQU   0
@NM00035 EQU   ENT+2
ENTFLG   EQU   @NM00035+10
LVL      EQU   0
LVLFLG   EQU   LVL+10
CREAT    EQU   0
EXPIR    EQU   0
HIST     EQU   0
NAME     EQU   0
FALL     EQU   0
VOL      EQU   0
ALLOC    EQU   0
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDDST   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDSPAN  EQU   AMDATTR
AMDNEST  EQU   IDAAMDSB+4
AMDAXRKP EQU   AMDNEST
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDPCTCA EQU   IDAAMDSB+10
AMDPCTCI EQU   IDAAMDSB+11
AMDCIPCA EQU   IDAAMDSB+12
AMDCINV  EQU   IDAAMDSB+20
AMDLRECL EQU   IDAAMDSB+24
AMDHLRBA EQU   IDAAMDSB+28
AMDNSLOT EQU   AMDHLRBA
AMDSSRBA EQU   IDAAMDSB+32
AMDMAXRR EQU   AMDSSRBA
AMDATTR3 EQU   IDAAMDSB+40
AMDUNQ   EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDSTAT  EQU   IDAAMDSB+48
AMDNIL   EQU   AMDSTAT+8
AMDNEXT  EQU   AMDSTAT+10
AMDNLR   EQU   AMDSTAT+12
AMDDELR  EQU   AMDSTAT+16
AMDIREC  EQU   AMDSTAT+20
AMDUPR   EQU   AMDSTAT+24
AMDRETR  EQU   AMDSTAT+28
AMDASPA  EQU   AMDSTAT+32
AMDNCIS  EQU   AMDSTAT+36
AMDNCAS  EQU   AMDSTAT+40
AMDEXCP  EQU   AMDSTAT+44
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGOPTN3 EQU   CTGPL+2
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
SECURE   EQU   0
PSWD     EQU   SECURE
MPW      EQU   PSWD
CPW      EQU   PSWD+8
UPW      EQU   PSWD+16
RPW      EQU   PSWD+24
PRMT     EQU   SECURE+32
ATMP     EQU   SECURE+40
SMOD     EQU   SECURE+42
@NM00045 EQU   SECURE+50
SRECLEN  EQU   @NM00045
SREC     EQU   @NM00045+2
ASSOC    EQU   0
KIND     EQU   ASSOC
CI#      EQU   ASSOC+1
ALIASASC EQU   0
NXTNMTY  EQU   ALIASASC+4
NXTNMPTR EQU   ALIASASC+5
DSRELCRA EQU   0
DSREL    EQU   DSRELCRA
DSSER    EQU   DSRELCRA+1
RGCHARS  EQU   0
RGATTR   EQU   RGCHARS
RGUPG    EQU   RGATTR
RGUPD    EQU   RGUPG
DSCHARS  EQU   0
ATTR#1   EQU   DSCHARS
DSSPEED  EQU   ATTR#1
DSUNQ    EQU   ATTR#1
DSREUSE  EQU   ATTR#1
DSERAS   EQU   ATTR#1
DSRCVR   EQU   ATTR#1
DSINH    EQU   ATTR#1
DSTEXP   EQU   ATTR#1
DSTKOV   EQU   ATTR#1
ATTR#2   EQU   DSCHARS+1
INTRASHR EQU   ATTR#2
INTERSHR EQU   ATTR#2
DSNUSE   EQU   ATTR#2
PGSPAC   EQU   0
PGSWAP   EQU   PGSPAC
PGSP     EQU   PGSPAC
RACFIELD EQU   0
RACIND   EQU   RACFIELD
DSETSP   EQU   0
PRIM     EQU   DSETSP
SCON     EQU   DSETSP+3
@NM00050 EQU   DSETSP+6
SFLG     EQU   @NM00050
DSETVL   EQU   0
FIXFLDS  EQU   DSETVL
VFLG     EQU   FIXFLDS+14
VPRIM    EQU   VFLG
VCAN     EQU   VFLG
VOVFL    EQU   VFLG
VEXT     EQU   FIXFLDS+15
VHKR     EQU   FIXFLDS+16
VHU      EQU   FIXFLDS+20
VHA      EQU   FIXFLDS+24
BLK      EQU   FIXFLDS+28
BPT      EQU   FIXFLDS+32
TPCA     EQU   FIXFLDS+34
VLOWKEY  EQU   0
VLKYLEN  EQU   VLOWKEY
VLKY     EQU   VLOWKEY+2
VHIKEY   EQU   0
VHKYLEN  EQU   VHIKEY
VHKY     EQU   VHIKEY+2
CCHHS    EQU   0
CCHHLEN  EQU   CCHHS
CCHH     EQU   CCHHS+2
TT       EQU   CCHH+10
DDDD1    EQU   CCHH+12
DDDD2    EQU   CCHH+16
PGBYTTRK EQU   0
ETYP     EQU   0
ENT44    EQU   0
DSID     EQU   0
BUFF     EQU   0
DSHU     EQU   0
DSHA     EQU   0
RECL     EQU   0
CRDT     EQU   0
EXDT     EQU   0
EXIT     EQU   0
CACB     EQU   0
VDSPHDR  EQU   0
VHDRREPN EQU   VDSPHDR
VDSPFLG  EQU   VDSPHDR+15
VDSPUNQ  EQU   VDSPFLG
VDSPAUTO EQU   VDSPFLG
VDSPUCAT EQU   VDSPFLG
VDSPMCAT EQU   VDSPFLG
VDSPDS#  EQU   VDSPHDR+16
VDSPXT   EQU   VDSPHDR+18
@NM00054 EQU   VDSPHDR+19
VDSPOPT  EQU   @NM00054
VDSPSCON EQU   VDSPHDR+20
VDSPDES  EQU   0
VTRKUSED EQU   VDSPDES+2
VTRKPX   EQU   VDSPDES+8
VXSS#    EQU   VDSPDES+10
VSPMAPLN EQU   VDSPDES+12
VSPMAP   EQU   VDSPDES+14
VDSDIR   EQU   0
VDSCI#   EQU   VDSDIR+3
VDSFLG   EQU   VDSDIR+6
VDSCAN   EQU   VDSFLG
VSS#LEN  EQU   VDSDIR+7
VSS#INFO EQU   VDSDIR+9
VDIRSS#  EQU   VSS#INFO
VX#      EQU   VSS#INFO+2
VCHAR    EQU   0
VDEV     EQU   VCHAR
VSYSX    EQU   0
V#DSP    EQU   0
V#DS     EQU   0
AUDATA   EQU   0
AUDEV    EQU   AUDATA+2
AUSER    EQU   AUDATA+6
AUFILE   EQU   AUDATA+12
AUVFLG   EQU   AUDATA+14
AUVPRIM  EQU   AUVFLG
AUVCAN   EQU   AUVFLG
AUVOVFL  EQU   AUVFLG
GDGATR   EQU   0
GDELET   EQU   GDGATR
GSCRAT   EQU   GDGATR
ERRDARG  EQU   0
LCTEXT   EQU   0
PRIMENM  EQU   LCTEXT
CANNM    EQU   LCTEXT+10
OVFLONM  EQU   LCTEXT+20
AUTONM   EQU   LCTEXT+30
EXPLNM   EQU   LCTEXT+40
DATANM   EQU   LCTEXT+50
INDEXNM  EQU   LCTEXT+60
CLNM     EQU   LCTEXT+70
SPEEDNM  EQU   LCTEXT+80
RCVYNM   EQU   LCTEXT+90
UNQNM    EQU   LCTEXT+100
SUBALNM  EQU   LCTEXT+110
ERASNM   EQU   LCTEXT+120
NERASNM  EQU   LCTEXT+130
IXDNM    EQU   LCTEXT+140
NIXDNM   EQU   LCTEXT+150
WCKNM    EQU   LCTEXT+160
NWCKNM   EQU   LCTEXT+170
IMBDNM   EQU   LCTEXT+180
NIMBDNM  EQU   LCTEXT+190
REPLNM   EQU   LCTEXT+200
NREPLNM  EQU   LCTEXT+210
ORDNM    EQU   LCTEXT+220
UNORDNM  EQU   LCTEXT+230
RECSZNM  EQU   LCTEXT+240
TRKNM    EQU   LCTEXT+250
CYLNM    EQU   LCTEXT+260
SUPPNM   EQU   LCTEXT+270
NULLNM   EQU   LCTEXT+280
INHUPDNM EQU   LCTEXT+290
TEMEXPNM EQU   LCTEXT+300
UCATNM   EQU   LCTEXT+310
MCATNM   EQU   LCTEXT+320
SHRNM    EQU   LCTEXT+330
SHRPRNM  EQU   LCTEXT+340
SHR1NM   EQU   LCTEXT+350
SHR2NM   EQU   LCTEXT+360
SHR3NM   EQU   LCTEXT+370
SHR4NM   EQU   LCTEXT+380
TOVFLNM  EQU   LCTEXT+390
NTOVFLNM EQU   LCTEXT+400
SCRNM    EQU   LCTEXT+410
NSCRNM   EQU   LCTEXT+420
EMPTYNM  EQU   LCTEXT+430
NEMPTYNM EQU   LCTEXT+440
NVSAMNM  EQU   LCTEXT+450
GDGNM    EQU   LCTEXT+460
ALIASNM  EQU   LCTEXT+470
PGSPCNM  EQU   LCTEXT+480
NUMDNM   EQU   LCTEXT+490
RUSNM    EQU   LCTEXT+500
NRUSNM   EQU   LCTEXT+510
PATHNM   EQU   LCTEXT+520
SPNDNM   EQU   LCTEXT+530
NSPNDNM  EQU   LCTEXT+540
AIXNM    EQU   LCTEXT+550
UPGNM    EQU   LCTEXT+560
NUPGNM   EQU   LCTEXT+570
UPDNM    EQU   LCTEXT+580
NUPDNM   EQU   LCTEXT+590
UNQKNM   EQU   LCTEXT+600
NUNQKNM  EQU   LCTEXT+610
RVBLNM   EQU   LCTEXT+620
NUSNM    EQU   LCTEXT+630
CYLFNM   EQU   LCTEXT+640
BINDNM   EQU   LCTEXT+650
DSTGWNM  EQU   LCTEXT+660
SWAPNM   EQU   LCTEXT+670
NSWAPNM  EQU   LCTEXT+680
YESNM    EQU   LCTEXT+690
NONM     EQU   LCTEXT+700
OBJOVR   EQU   0
OBJCNT   EQU   OBJOVR
@NM00060 EQU   OBJOVR+4
OBJTYP   EQU   @NM00060
OBJNM    EQU   @NM00060+1
CPLWKA   EQU   0
CPLWKASZ EQU   CPLWKA
REQWKASZ EQU   CPLWKA+2
ENT44WKA EQU   0
ENTREQSZ EQU   ENT44WKA+2
SUPPWKA  EQU   0
SUPPTYPE EQU   SUPPWKA+4
SUPPDSNM EQU   SUPPWKA+5
SAVCPL   EQU   0
SAFPL    EQU   0
FPLNAME  EQU   0
VDSFPL   EQU   0
CASTRING EQU   0
CLSTRING EQU   0
ALSTRING EQU   0
AIX      EQU   0
ALIAS    EQU   0
ALIEN    EQU   0
AMSTP041 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CAT      EQU   0
CLUST    EQU   0
DATUM    EQU   0
DSB      EQU   0
GDG      EQU   0
GDGLMT   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
INDEX    EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NUSE     EQU   0
PATH     EQU   0
PGSPC    EQU   0
SPACE    EQU   0
UCAT     EQU   0
VTIME    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
FPLLAST  EQU   0
CACBSW   EQU   0
ENTNMSW  EQU   0
@NM00043 EQU   CTGDDNM
CTGPROB  EQU   @NM00043
CTGREASN EQU   CTGPROB+2
FPLPTMAP EQU   CORRFPLS
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00004 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00063 EQU   SUPPWKA
@NM00062 EQU   ENT44WKA+4
ENTSETSZ EQU   ENT44WKA
@NM00061 EQU   CPLWKA+4
@NM00058 EQU   GDGATR
@NM00057 EQU   AUVFLG
AUREPN   EQU   AUDATA
VTOL     EQU   VCHAR+14
VTRKSZ   EQU   VCHAR+12
V#TRK    EQU   VCHAR+10
V#CYL    EQU   VCHAR+8
VMXBLK   EQU   VCHAR+4
@NM00056 EQU   VDSFLG
VXPDS    EQU   VDSDIR+2
VDIRREPN EQU   VDSDIR
SPRLCX   EQU   VSPMAP+1
SPRLC    EQU   VSPMAP
VXBEGN   EQU   VDSPDES+4
VDESREPN EQU   VDSPDES
@NM00055 EQU   @NM00054
@NM00053 EQU   VDSPFLG
VDSCBPTR EQU   VDSPHDR+10
VDSCBTIM EQU   VDSPHDR+2
CCHH2    EQU   CCHH+6
CCHH1    EQU   CCHH+2
SS       EQU   CCHH
DIR#     EQU   FIXFLDS+37
EFLG     EQU   FIXFLDS+36
@NM00052 EQU   VFLG
FILE     EQU   FIXFLDS+12
SER      EQU   FIXFLDS+6
DEV      EQU   FIXFLDS+2
REPN     EQU   FIXFLDS
@NM00051 EQU   @NM00050
@NM00049 EQU   RACFIELD
@NM00048 EQU   PGSPAC
@NM00047 EQU   ATTR#2
@NM00046 EQU   RGATTR
DSDEV    EQU   DSRELCRA+10
DSCINO   EQU   DSRELCRA+7
LASTNMPT EQU   ALIASASC+9
LASTNMTY EQU   ALIASASC+8
REALNMPT EQU   ALIASASC+1
REALNMTY EQU   ALIASASC
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00044 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
@NM00042 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGTYPE  EQU   CTGPL+18
@NM00041 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00040 EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00039 EQU   CTGOPTN4
CTGNPROF EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGAM0   EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
CTGFUNC  EQU   CTGOPTN3
@NM00038 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
AMDSTSP  EQU   AMDSTAT
@NM00037 EQU   IDAAMDSB+41
@NM00036 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDLEN   EQU   IDAAMDSB+2
AMDRANGE EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
EXPIRVAL EQU   EXPIR
CREATVAL EQU   CREAT
LVLVAL   EQU   LVL+21
LVLLEN   EQU   LVL+20
LVLMEM   EQU   LVL+12
LVLMLN   EQU   LVL+11
LVLFUQ   EQU   LVLFLG
LVLPOS   EQU   LVL+9
LVLPAS   EQU   LVL+1
LVLPLN   EQU   LVL
ENTVAL   EQU   @NM00035+21
ENTLEN   EQU   @NM00035+20
ENTMEM   EQU   @NM00035+12
ENTMLN   EQU   @NM00035+11
ENTFUQ   EQU   ENTFLG
ENTPOS   EQU   @NM00035+9
ENTPAS   EQU   @NM00035+1
ENTPLN   EQU   @NM00035
ENTCNT   EQU   ENT
OUTDDVAL EQU   OUTDD+1
OUTDDLEN EQU   OUTDD
CATDDVAL EQU   CATDD+1
CATDDLEN EQU   CATDD
CATNMVAL EQU   CATNM+21
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
CATNMPAS EQU   CATNM+1
CATNMPLN EQU   CATNM
@NM00034 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00033 EQU   DMPITM+15
@NM00032 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
@NM00031 EQU   ERCNVTAB+4
@NM00030 EQU   ERCNVTAB+3
@NM00029 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00028 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
@NM00027 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
@NM00026 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00025 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00024 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
@NM00023 EQU   DARGLIST+19
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00022 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00021 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00020 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00017 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00016 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00015 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00014 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00013+1
UNITCHA  EQU   @NM00013
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00012 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00011 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00010 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00009 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00008 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00007 EQU   CIRAGL+1
@NM00006 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00005 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00400 EQU   @RC00385
@RC00422 EQU   @RC00385
@RF00421 EQU   @RC00385
@RC00659 EQU   @RC00656
@RF00759 EQU   @RC00757
@RC00786 EQU   @RC00777
@RC00784 EQU   @RC00777
@RC00782 EQU   @RC00777
@RF00856 EQU   @RC00836
@RF00862 EQU   @RC00836
@RC00911 EQU   @RC00909
@RC00952 EQU   @RC00926
@RC00959 EQU   @RC00956
@RC01134 EQU   @RC01133
@RC01290 EQU   @RC01279
@RF01498 EQU   @RC01491
@RC01640 EQU   @RC01635
@RC01746 EQU   @RC01745
@RC01924 EQU   @RC01923
@RC01950 EQU   @RC01949
@RF01962 EQU   @RC01947
@RC02141 EQU   @RC02140
@ENDDATA EQU   *
         END   IDCLC02,(C'PLS2157',0701,76335)

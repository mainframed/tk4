         TITLE '*********** IDCMP01:  IMPORT FUNCTION SUPPORT ROUTINE **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCMP01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCMP01   78.177'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         LA    @08,4095(,@09)                                      0002
         LA    @07,4095(,@08)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         USING @PSTART+16380,@08                                   0002
         USING @PSTART+20475,@07                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @06,@01                                             0002
         USING @DATD,@06                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @06,8(,@13)                                         0002
         LR    @13,@06                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                      /*MAPPING OF THE PART @Y30SSFR*/
*                                      /*OF THE BUFFER TO BE @Y30SSFR*/
*                                      /*CLEARED             @Y30SSFR*/
*        /************************************************************/
*        /*                                                          */
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */
*        /*   IMPORT ROUTINE.  THIS SECTION DETERMINES WHETHER A     */
*        /*   USER CATALOG OR A CLUSTER OBJECT IS TO BE IMPORTED,    */
*        /*   AND CALLS THE CORRESPONDING OBJECT PROCESSOR.          */
*        /*   TERMINATION PROCESSING IS ALSO HANDLED IN THIS SECTION.*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0351
*        OLDERID2 = NEWERID2;                                      0351
         L     @15,@PC00001                                        0351
         L     @15,GDTTR2(,@15)                                    0351
         MVC   @TS00001(95),NEWERID2(@15)                          0351
         MVC   OLDERID2(95,@15),@TS00001                           0351
*        NEWID2 = 'MPBG';                                          0352
*                                                                  0352
         MVC   NEWID2(4,@15),@CC01277                              0352
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE FIELDS FOR MESSAGE OUTPUT                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0353
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/
*        DEALLOC = OFF;                                    /*@YL026UA*/
         NI    DEALLOC,B'01111111'                                 0354
*        UNIQD = OFF;                                      /*@YL026UA*/
         NI    UNIQD,B'01111111'                                   0355
*        UNIQI = OFF;                                      /*@YL026UA*/
         NI    UNIQI,B'01111111'                                   0356
*        DDSTRU = ADDR(PRINTTAB);                                  0357
         LA    @15,PRINTTAB                                        0357
         ST    @15,DDSTRU                                          0357
*        DARGLIST = ''B;                                           0358
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0358
*        DEFSTID = 0;                                              0359
         MVI   DEFSTID,X'00'                                       0359
*        DALCINDX = 0;                                     /*@YL026UA*/
         SLR   @14,@14                                             0360
         ST    @14,DALCINDX                                        0360
*        DARGSMOD = 'MP0';                                         0361
*                                                                  0361
         MVC   DARGSMOD(3,@15),@CC01000                            0361
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE POINTERS TO INPUT IOCS AND OUTPUT IOCS,      */
*        /*  CATALOG IOCS, PASSWORD, AND ZERO IMPORT FLAGS           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0362
*        POUTIOCS = NULLPTR;           /* OUTPUT IOCS                */
         ST    @14,POUTIOCS                                        0362
*        PINIOCS = NULLPTR;            /*INPUT IOCS                  */
         ST    @14,PINIOCS                                         0363
*        PTRCTACB = NULLPTR;           /*CATALOG ACB POINTER         */
         ST    @14,PTRCTACB                                        0364
*        PTRCTIOC = NULLPTR;           /*CATALOG IOCS POINTER        */
         ST    @14,PTRCTIOC                                        0365
*        IMPFLG2 = '00'X;              /*IMPORT FLAGS                */
         MVI   IMPFLG2,X'00'                                       0366
*        CPSWD = NULLPTR;              /*CLUSTER PASSWORD POINTER    */
         ST    @14,CPSWD                                           0367
*        CATRCVWK = ''B;               /*ZERO WORK AREA FOR  @Y30SSFR*/
         XC    CATRCVWK(10),CATRCVWK                               0368
*                                      /*RECOVERY VOLSER     @Y30SSFR*/
*        RCVLN = LENGTH(CATRCVWK);     /*SET THE LENGTH OF   @Y30SSFR*/
         MVC   RCVLN(2),@CH00037                                   0369
*                                      /*THE RECOVERY WORK   @Y30SSFR*/
*                                      /*AREA IN THE FIRST   @Y30SSFR*/
*                                      /*TWO BYTES           @Y30SSFR*/
*        SETRC = 0;                    /*SET FINAL RETURN    @Y30SSFR*/
         STH   @14,SETRC                                           0370
*                                      /*CODE TO 0           @Y30SSFR*/
*                                                                  0371
*        /************************************************************/
*        /*                                                          */
*        /* DETERMINE WHETHER A USERCATALOG IS TO BE         @Y30SSFR*/
*        /*   IMPORTED -- TEST FOR CONNECT PARAMETER SPECIFIED       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0371
*        IF ADDR(CON) ^= NULLPTR                                   0371
*          THEN                                                    0371
         L     @15,@PC00001+4                                      0371
         C     @14,FDTPTR+52(,@15)                                 0371
         BE    @RF00371                                            0371
*            DO;                                                   0372
*                                                                  0372
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS CONNECT OF USER CATALOG                     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0373
*            CALL CNCTPROC;                                        0373
         BAL   @14,CNCTPROC                                        0373
*            RESPECIFY RTNREG RSTD;                                0374
*            TESTRC = RTNREG;                                      0375
         LR    TESTRC,RTNREG                                       0375
*            RESPECIFY RTNREG UNRSTD;                              0376
*            SETRC = TESTRC;                                       0377
         STH   TESTRC,SETRC                                        0377
*            END;                                                  0378
*                                                                  0378
*          ELSE                                                    0379
*            DO;                                                   0379
*                                                                  0379
         B     @RC00371                                            0379
@RF00371 DS    0H                                                  0380
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS IMPORTATION OF A CLUSTER OR AN AIX  @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0380
*            CALL CLUSPROC;                                        0380
         BAL   @14,CLUSPROC                                        0380
*            RESPECIFY RTNREG RSTD;                                0381
*            TESTRC = RTNREG;                                      0382
         LR    TESTRC,RTNREG                                       0382
*            RESPECIFY RTNREG UNRSTD;                              0383
*            SETRC = MAX(TESTRC,SETRC);                    /*@Y30SSFR*/
         LH    @03,SETRC                                           0384
         CR    @03,TESTRC                                          0384
         BNL   *+6
         LR    @03,TESTRC                                          0384
         STH   @03,SETRC                                           0384
*            END;                                                  0385
*                                                                  0385
*                                                                  0385
*        /************************************************************/
*        /*                                                          */
*        /*   TERMINATION PROCESSING WILL LIST APPROPRIATE ERROR     */
*        /*   MESSAGES, AND INDICATE THE FINAL STATUS OF IMPORT      */
*        /*   IN LASTCC.                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0386
*        IF GDTDBG = NULLPTR                                       0386
*          THEN;                                                   0386
@RC00371 L     @15,@PC00001                                        0386
         L     @15,GDTDBG(,@15)                                    0386
         LTR   @15,@15                                             0386
         BZ    @RT00386                                            0386
*          ELSE                                                    0388
*            CALL IDCDB010 (GDTTBL,'MPFN');                        0388
*                                                                  0388
         L     @15,@PC00001                                        0388
         ST    @15,@AL00001                                        0388
         LA    @14,@CC01283                                        0388
         ST    @14,@AL00001+4                                      0388
         MVI   @AL00001+4,X'80'                                    0388
         L     @15,GDTDBG(,@15)                                    0388
         LA    @01,@AL00001                                        0388
         BALR  @14,@15                                             0388
*        /************************************************************/
*        /*                                                          */
*        /*  TEST FOR ANY SPECIAL MESSAGES TO BE LISTED - ERROR OR   */
*        /*  INFORMATIONAL                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0389
*        IF DEFSTID ^= NORMSTAT                                    0389
*          THEN                                                    0389
@RT00386 CLI   DEFSTID,0                                           0389
         BE    @RF00389                                            0389
*            DO;                                                   0390
*            DARGSENT = DEFSTID;                                   0391
*                                                                  0391
         L     @15,DDSTRU                                          0391
         IC    @14,DEFSTID                                         0391
         STC   @14,DARGSENT(,@15)                                  0391
*            /********************************************************/
*            /*                                                      */
*            /*  TEST FOR CATALOG RETURN CODE MESSAGE TO BE LISTED   */
*            /*  IF SO, SET POINTER TO RETURN CODE                   */
*            /*                                                      */
*            /********************************************************/
*                                                                  0392
*            IF DEFSTID = CATLGMSG & DARGSMOD = UNIVMSG            0392
*              THEN                                                0392
         CLI   DEFSTID,7                                           0392
         BNE   @RF00392                                            0392
         CLC   DARGSMOD(3,@15),@CC01023                            0392
         BNE   @RF00392                                            0392
*                DO;                                               0393
*                DARGDBP = ADDR(CATLGRC);                          0394
         LA    @14,CATLGRC                                         0394
         ST    @14,DARGDBP(,@15)                                   0394
*                DARGILP = LENGTH(CATLGRC);                        0395
         MVC   DARGILP(2,@15),@CH00156                             0395
*                END;                                              0396
*                                                                  0396
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0397
*                                                                  0397
@RF00392 L     @15,@PC00001                                        0397
         ST    @15,@AL00001                                        0397
         LA    @14,@CF00118                                        0397
         ST    @14,@AL00001+4                                      0397
         LA    @14,DDSTRU                                          0397
         ST    @14,@AL00001+8                                      0397
         MVI   @AL00001+8,X'80'                                    0397
         L     @15,GDTPRT(,@15)                                    0397
         LA    @01,@AL00001                                        0397
         BALR  @14,@15                                             0397
*            END;                                                  0398
*                                                                  0398
*                                                                  0398
*        /************************************************************/
*        /*                                                          */
*        /*  CLOSE ANY OPEN DATA SETS                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0399
*        IF POUTIOCS ^= NULLPTR                                    0399
*          THEN                                                    0399
@RF00389 L     @15,POUTIOCS                                        0399
         LTR   @15,@15                                             0399
         BZ    @RF00399                                            0399
*            CALL IDCIOCL0 (GDTTBL,POUTIOCS);/*                    0400
*                                        OUTPUT - THE CLUSTER        */
*                                                                  0400
         L     @15,@PC00001                                        0400
         ST    @15,@AL00001                                        0400
         LA    @14,POUTIOCS                                        0400
         ST    @14,@AL00001+4                                      0400
         MVI   @AL00001+4,X'80'                                    0400
         L     @15,GDTCLS(,@15)                                    0400
         LA    @01,@AL00001                                        0400
         BALR  @14,@15                                             0400
*        IF PINIOCS ^= NULLPTR         /*INPUT - PORTABLE DATA SET   */
*          THEN                                                    0401
@RF00399 L     @15,PINIOCS                                         0401
         LTR   @15,@15                                             0401
         BZ    @RF00401                                            0401
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0402
*                                                                  0402
         L     @15,@PC00001                                        0402
         ST    @15,@AL00001                                        0402
         LA    @14,PINIOCS                                         0402
         ST    @14,@AL00001+4                                      0402
         MVI   @AL00001+4,X'80'                                    0402
         L     @15,GDTCLS(,@15)                                    0402
         LA    @01,@AL00001                                        0402
         BALR  @14,@15                                             0402
*        /************************************************************/
*        /*                                                          */
*        /*  IF IMPORT FAILED AFTER DEFINE, BUT PRIOR TO COPYING DATA*/
*        /*  A FLAG WILL BE SET.  IF SET, DELETE THE DEFINED OBJECT  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0403
*        IF IMPF2DEL = ON                                          0403
*          THEN                                                    0403
@RF00401 TM    IMPF2DEL,B'01000000'                                0403
         BNO   @RF00403                                            0403
*            DO;                                                   0404
*            CTGPLPTR= PTRCPL;                                     0405
         L     @15,PTRCPL                                          0405
         ST    @15,CTGPLPTR                                        0405
*            CTGFVPTR = CTGFVT;                                    0406
*                                                                  0406
         L     @15,CTGFVT(,@15)                                    0406
         ST    @15,CTGFVPTR                                        0406
*            /********************************************************/
*            /*                                                      */
*            /*  ISSUE MESSAGE--DELETE ATTEMPTED FOR CLUSTER @Y30SSFR*/
*            /*  OR AIX THAT WAS UNSUCCESSFULLY IMPORTED     @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0407
*            DARGSMOD = IMPMSG;                                    0407
         L     @15,DDSTRU                                          0407
         MVC   DARGSMOD(3,@15),@CC01000                            0407
*            DARGSENT = IDELFAIL;                                  0408
*                                                                  0408
         MVI   DARGSENT(@15),X'09'                                 0408
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0409
*                                                                  0409
*                                                                  0409
         L     @15,@PC00001                                        0409
         ST    @15,@AL00001                                        0409
         LA    @14,@CF00118                                        0409
         ST    @14,@AL00001+4                                      0409
         LA    @14,DDSTRU                                          0409
         ST    @14,@AL00001+8                                      0409
         MVI   @AL00001+8,X'80'                                    0409
         L     @15,GDTPRT(,@15)                                    0409
         LA    @01,@AL00001                                        0409
         BALR  @14,@15                                             0409
*            /********************************************************/
*            /*                                                      */
*            /*  CONSTRUCT CPL FOR DELETE OF CLUSTER OR AIX  @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0410
*            CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);    0410
*                                                                  0410
         LA    @15,@CC00807                                        0410
         ST    @15,@AL00001                                        0410
         LA    @15,DCPLPTR                                         0410
         ST    @15,@AL00001+4                                      0410
         L     @01,CTGPLPTR                                        0410
         L     @01,CTGFVT(,@01)                                    0410
         LA    @15,CTGFVENT(,@01)                                  0410
         ST    @15,@AL00001+8                                      0410
         LA    @15,NULLPARM                                        0410
         ST    @15,@AL00001+12                                     0410
         LA    @15,CPSWD                                           0410
         ST    @15,@AL00001+16                                     0410
         LA    @01,@AL00001                                        0410
         BAL   @14,CPLPROC                                         0410
*            /********************************************************/
*            /*                                                      */
*            /*  SET PURGE FLAG IN CPL SO THAT CLUSTER OR    @Y30SSFR*/
*            /*  AIX WILL BE DELETED EVEN IF RETENTION       @Y30SSFR*/
*            /*  PERIOD NOT EXPIRED.                         @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0411
*            DCPLPTR -> CTGPURG = ON;                              0411
*                                                                  0411
         L     @01,DCPLPTR                                         0411
         OI    CTGPURG(@01),B'00100000'                            0411
*            /********************************************************/
*            /*                                                      */
*            /*  INVOKE CATALOG MANAGEMENT TO DELETE CLUSTER         */
*            /*                                                      */
*            /********************************************************/
*                                                                  0412
*            CALL DELTPROC(DCPLPTR);                       /*@Y30SSFR*/
         LA    @15,DCPLPTR                                         0412
         ST    @15,@AL00001                                        0412
         LA    @01,@AL00001                                        0412
         BAL   @14,DELTPROC                                        0412
*            END;                                                  0413
*                                                                  0413
*        /************************************************************/
*        /*                                                          */
*        /*  IF VSAM CATALOG WAS OPENED BY IMPORT, CLOSE IT          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0414
*        IF PTRCTIOC ^= NULLPTR                                    0414
*          THEN                                                    0414
@RF00403 L     @15,PTRCTIOC                                        0414
         LTR   @15,@15                                             0414
         BZ    @RF00414                                            0414
*            CALL IDCIOCL0 (GDTTBL,PTRCTIOC);                      0415
*                                                                  0415
*                                                                  0415
         L     @15,@PC00001                                        0415
         ST    @15,@AL00001                                        0415
         LA    @14,PTRCTIOC                                        0415
         ST    @14,@AL00001+4                                      0415
         MVI   @AL00001+4,X'80'                                    0415
         L     @15,GDTCLS(,@15)                                    0415
         LA    @01,@AL00001                                        0415
         BALR  @14,@15                                             0415
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE FINAL COMPLETION MESSAGE INDICATING WHETHER       */
*        /*  IMPORT WAS SUCCESSFUL OR NOT.                           */
*        /*  SET LASTCC TO INDICATE SUCCESS OR FAILURE TO THE        */
*        /*  AMS EXECUTIVE                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0416
*        IF (SETRC > LASTCC00) & (GDTECT ^= NULLPTR)       /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RF00414 SLR   @15,@15                                             0416
         CH    @15,SETRC                                           0416
         BNL   @RF00416                                            0416
         L     @14,@PC00001                                        0416
         C     @15,GDTECT(,@14)                                    0416
         BE    @RF00416                                            0416
*            DARGSENT = TSOFAIL;       /*IMPORT FAILED       @Y30SSFR*/
         L     @01,DDSTRU                                          0417
         MVI   DARGSENT(@01),X'0F'                                 0417
*          ELSE                                            /*@Y30SSFR*/
*            IF SETRC < LASTCC12                           /*@ZA16093*/
*              THEN                                        /*@Y30SSFR*/
         B     @RC00416                                            0418
@RF00416 LH    @15,SETRC                                           0418
         C     @15,@CF00035                                        0418
         BNL   @RF00418                                            0418
*                DARGSENT = IMPTGOOD;  /*IMPORT SUCCESSFUL   @Y30SSFR*/
         L     @01,DDSTRU                                          0419
         MVI   DARGSENT(@01),X'01'                                 0419
*              ELSE                                        /*@Y30SSFR*/
*                DARGSENT = IMPTFAIL;                      /*@Y30SSFR*/
*                                                                  0420
         B     @RC00418                                            0420
@RF00418 L     @01,DDSTRU                                          0420
         MVI   DARGSENT(@01),X'03'                                 0420
*        LASTCC = SETRC;                                   /*@Y30SSFR*/
@RC00418 DS    0H                                                  0421
@RC00416 L     @15,@PC00001+8                                      0421
         LH    @14,SETRC                                           0421
         STH   @14,LASTCC(,@15)                                    0421
*        DARGSMOD = UNIVMSG;                                       0422
         L     @14,DDSTRU                                          0422
         MVC   DARGSMOD(3,@14),@CC01023                            0422
*        DARGDBP = ADDR(LASTCC);                                   0423
         ST    @15,DARGDBP(,@14)                                   0423
*        DARGILP = LENGTH(LASTCC);                                 0424
*                                                                  0424
         MVC   DARGILP(2,@14),@CH00156                             0424
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0425
*                                                                  0425
         L     @15,@PC00001                                        0425
         ST    @15,@AL00001                                        0425
         LA    @14,@CF00118                                        0425
         ST    @14,@AL00001+4                                      0425
         LA    @14,DDSTRU                                          0425
         ST    @14,@AL00001+8                                      0425
         MVI   @AL00001+8,X'80'                                    0425
         L     @15,GDTPRT(,@15)                                    0425
         LA    @01,@AL00001                                        0425
         BALR  @14,@15                                             0425
*        IF DEALLOC = ON                                           0426
*          THEN                                                    0426
         TM    DEALLOC,B'10000000'                                 0426
         BNO   @RF00426                                            0426
*            CALL IDCSADL0(GDTTBL,ALLAGL);                 /*@YL026UA*/
*                                                                  0427
         L     @15,@PC00001                                        0427
         ST    @15,@AL00001                                        0427
         L     @01,ALLPTR                                          0427
         ST    @01,@AL00001+4                                      0427
         MVI   @AL00001+4,X'80'                                    0427
         L     @15,GDTDLC(,@15)                                    0427
         LA    @01,@AL00001                                        0427
         BALR  @14,@15                                             0427
*        /************************************************************/
*        /*                                                          */
*        /*  FREE STORAGE OBTAINED BY IMPORT AND RETURN TO THE       */
*        /*  AMS EXECUTIVE                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0428
*        CALL IDCSAFP0 (GDTTBL,GPID);                              0428
*                                                                  0428
@RF00426 L     @15,@PC00001                                        0428
         ST    @15,@AL00001                                        0428
         LA    @14,GPID                                            0428
         ST    @14,@AL00001+4                                      0428
         MVI   @AL00001+4,X'80'                                    0428
         L     @15,GDTFPL(,@15)                                    0428
         LA    @01,@AL00001                                        0428
         BALR  @14,@15                                             0428
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0429
         L     @15,@PC00001                                        0429
         ST    @15,@AL00001                                        0429
         LA    @14,MODID                                           0429
         ST    @14,@AL00001+4                                      0429
         L     @14,@PC00001+8                                      0429
         ST    @14,@AL00001+8                                      0429
         MVI   @AL00001+8,X'80'                                    0429
         L     @15,GDTEPL(,@15)                                    0429
         LA    @01,@AL00001                                        0429
         BALR  @14,@15                                             0429
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - CLUSPROC                               */
*        /*                                                          */
*        /*  FUNCTION - READ CATALOG AND DATA RECORDS FROM THE       */
*        /*  PORTABILITY VOLUME, USE CATALOG INFORMATION FROM THE    */
*        /*  FROM CATALOG RECORDS PLUS INFORMATION FROM THE AMS      */
*        /*  COMMAND TO PERFORM A CATALOG DEFINE FOR THE     @Y30SSFR*/
*        /*  OBJECT, COPY DATA INTO THE DATA SET AFTER SUCCESSFUL    */
*        /*  DEFINITION IN THE CATALOG                               */
*        /*  CLUSPROC PROCESSES EXPORTED KSDS'S, RRDS'S,     @Y30SSFR*/
*        /*  ESDS'S, AND AIX'S AS WELL AS THEIR ASSOCIATED   @Y30SSFR*/
*        /*  PATHS.                                          @Y30SSFR*/
*        /*                                                          */
*        /*  INPUT - FUNCTION DEFINITION TABLE                       */
*        /*                                                          */
*        /*  OUTPUT- A RECREATED CLUSTER OR AIX              @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*CLUSPROC: PROCEDURE;                                              0430
*                                                                  0430
@EL00001 L     @13,4(,@13)                                         0430
@EF00001 L     @00,@SIZDATD                                        0430
         LR    @01,@06                                             0430
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0430
         BR    @14                                                 0430
CLUSPROC STM   @14,@12,@SA00002                                    0430
*        /************************************************************/
*        /*                                                          */
*        /*  PERFORM INITIALIZATION                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0431
*        OLDERID2 = NEWERID2;                                      0431
         L     @15,@PC00001                                        0431
         L     @15,GDTTR2(,@15)                                    0431
         MVC   @TS00001(95),NEWERID2(@15)                          0431
         MVC   OLDERID2(95,@15),@TS00001                           0431
*        NEWID2 = 'MPCP';                                          0432
*                                                                  0432
         MVC   NEWID2(4,@15),@CC01289                              0432
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SET AN INITIAL VALUE FOR THE BLOCKSIZE OF THE   @Y30SSFR*/
*        /*  PORTABLE DATA SET.                              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0433
*        BLKSIZ = 2048;                                    /*@Y30SSFR*/
*                                                                  0433
         MVC   BLKSIZ(4),@CF01290                                  0433
*        DO I = 1 TO CMPNUM;                                       0434
         LA    I,1                                                 0434
@DL00434 DS    0H                                                  0435
*          FVTPTR(I) = NULLPTR;        /*ZERO FVT POINTERS           */
         LR    @02,I                                               0435
         SLA   @02,2                                               0435
         SLR   @15,@15                                             0435
         ST    @15,FVTPTR-4(@02)                                   0435
*        END;                                                      0436
*                                                                  0436
         AL    I,@CF00221                                          0436
         C     I,@CF00165                                          0436
         BNH   @DL00434                                            0436
*        PFVTPTR = NULLPTR;            /*ZERO PATH FVT       @Y30SSFR*/
         SLR   @15,@15                                             0437
         ST    @15,PFVTPTR                                         0437
*                                      /*POINTER             @Y30SSFR*/
*        RANGPORT = NULLPTR;           /*KEYRANGE LIST- MODELED      */
         ST    @15,RANGPORT                                        0438
*        RANGINPT = NULLPTR;           /*KEYRANGE LIST- AMS INPUT    */
         ST    @15,RANGINPT                                        0439
*        RESPECIFY IDAAMDSB BASED(DSCCATPT);               /*@Y30SSFR*/
*                                                                  0440
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INITIALIZE THE EMPTY DATA SET FLAG TO OFF.      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0441
*        EMPTYDS = OFF;                                    /*@Y30SSFR*/
*                                                                  0441
         NI    EMPTYDS,B'01111111'                                 0441
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK THAT THE IN PARAMETER WAS SPECIFIED ON THE        */
*        /*  AMS COMMAND. IF NOT, RETURN.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0442
*        IF ADDR(IN) = NULLPTR & ADDR(INDS) = NULLPTR              0442
*          THEN                                                    0442
         L     @14,@PC00001+4                                      0442
         C     @15,FDTPTR(,@14)                                    0442
         BNE   @RF00442                                            0442
         C     @15,FDTPTR+92(,@14)                                 0442
         BNE   @RF00442                                            0442
*            DO;                                                   0443
*            DEFSTID = NOINPARM;                                   0444
         MVI   DEFSTID,X'03'                                       0444
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0445
         L     @15,@PC00001                                        0445
         ST    @15,@AL00001                                        0445
         LA    @14,@CF00118                                        0445
         ST    @14,@AL00001+4                                      0445
         LA    @14,DDSTRU                                          0445
         ST    @14,@AL00001+8                                      0445
         MVI   @AL00001+8,X'80'                                    0445
         L     @15,GDTPRT(,@15)                                    0445
         LA    @01,@AL00001                                        0445
         BALR  @14,@15                                             0445
*            RETURN CODE(LASTCC12);                        /*@YL026UA*/
         LA    @15,12                                              0446
         L     @14,@SA00002                                        0446
         LM    @00,@12,@SA00002+8                                  0446
         BR    @14                                                 0446
*            END;                                                  0447
*                                                                  0447
*                                                                  0447
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK THAT THE OUT PARAMETER WAS SPECIFIED ON THE       */
*        /*  AMS COMMAND. IF NOT, RETURN.                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0448
*        IF ADDR(OUTDD) = NULLPTR & ADDR(OUTDS) = NULLPTR          0448
*          THEN                                                    0448
@RF00442 SLR   @15,@15                                             0448
         L     @14,@PC00001+4                                      0448
         C     @15,FDTPTR+4(,@14)                                  0448
         BNE   @RF00448                                            0448
         C     @15,FDTPTR+96(,@14)                                 0448
         BNE   @RF00448                                            0448
*            DO;                                                   0449
*            DEFSTID = NOOUPARM;                                   0450
         MVI   DEFSTID,X'04'                                       0450
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0451
         L     @15,@PC00001                                        0451
         ST    @15,@AL00001                                        0451
         LA    @14,@CF00118                                        0451
         ST    @14,@AL00001+4                                      0451
         LA    @14,DDSTRU                                          0451
         ST    @14,@AL00001+8                                      0451
         MVI   @AL00001+8,X'80'                                    0451
         L     @15,GDTPRT(,@15)                                    0451
         LA    @01,@AL00001                                        0451
         BALR  @14,@15                                             0451
*            RETURN CODE(LASTCC12);                        /*@YL026UA*/
         LA    @15,12                                              0452
         L     @14,@SA00002                                        0452
         LM    @00,@12,@SA00002+8                                  0452
         BR    @14                                                 0452
*            END;                                                  0453
*                                                                  0453
*           ENTNAM = INDSVAL;                              /*@YL026UA*/
@RF00448 L     @15,@PC00001+4                                      0454
         L     @14,FDTPTR+92(,@15)                                 0454
         MVC   ENTNAM(44),INDSVAL(@14)                             0454
*           ENTNLN = INDSLEN;                              /*@YL026UA*/
         SLR   @05,@05                                             0455
         IC    @05,INDSLEN(,@14)                                   0455
         STH   @05,ENTNLN                                          0455
*           OUTDSNAM = OUTDSVAL;                           /*@YL026UA*/
         L     @15,FDTPTR+96(,@15)                                 0456
         MVC   OUTDSNAM(44),OUTDSVAL(@15)                          0456
*           OUTDSNLN = OUTDSLEN;                           /*@YL026UA*/
*                                                                  0457
         SLR   @05,@05                                             0457
         IC    @05,OUTDSLEN(,@15)                                  0457
         STH   @05,OUTDSNLN                                        0457
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRIES ARE NOT FULLY QUALIFIED - ISSUE  @YL026UA*/
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIERS       */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0458
*          IF INDSFUQ = ON & ADDR(INDS) ^= NULLPTR                 0458
*            THEN                                                  0458
         TM    INDSFUQ(@14),B'10000000'                            0458
         BNO   @RF00458                                            0458
         LTR   @14,@14                                             0458
         BZ    @RF00458                                            0458
*              DO;                                         /*@YL026UA*/
*                QUALLIST = ''B;                           /*@YL026UA*/
         XC    QUALLIST(12),QUALLIST                               0460
*                QUALADDR = ADDR(ENTNAM);                   /*@YL026UA*
         LA    @15,ENTNAM                                          0461
         ST    @15,QUALADDR                                        0461
*                IF INDSPLN ^= 0                                   0462
*                  THEN                                            0462
         CLI   INDSPLN(@14),0                                      0462
         BE    @RF00462                                            0462
*                    QUALPAS = ADDR(INDSPAS);              /*@YL026UA*/
*                                                                  0463
         LA    @15,INDSPAS(,@14)                                   0463
         ST    @15,QUALPAS                                         0463
*                CALL IDCSAQL0(GDTTBL,QUALADDR,ENTNLN,QUALCAT,QUALPAS);
@RF00462 L     @03,@PC00001                                        0464
         ST    @03,@AL00001                                        0464
         LA    @15,QUALADDR                                        0464
         ST    @15,@AL00001+4                                      0464
         LA    @15,ENTNLN                                          0464
         ST    @15,@AL00001+8                                      0464
         LA    @15,QUALCAT                                         0464
         ST    @15,@AL00001+12                                     0464
         LA    @15,QUALPAS                                         0464
         ST    @15,@AL00001+16                                     0464
         MVI   @AL00001+16,X'80'                                   0464
         L     @15,GDTQAL(,@03)                                    0464
         LA    @01,@AL00001                                        0464
         BALR  @14,@15                                             0464
*                                                          /*@YL026UA*/
*                RESPECIFY RTNREG RSTD;                            0465
*                TESTRC = RTNREG;                                  0466
         LR    TESTRC,RTNREG                                       0466
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/
*                IF TESTRC ^= 0                                    0468
*                  THEN                                            0468
         LTR   TESTRC,TESTRC                                       0468
         BZ    @RF00468                                            0468
*                    RETURN CODE(LASTCC12);                /*@YL026UA*/
         LA    @15,12                                              0469
         L     @14,@SA00002                                        0469
         LM    @00,@12,@SA00002+8                                  0469
         BR    @14                                                 0469
*              END;                                        /*@YL026UA*/
*                                                                  0470
@RF00468 DS    0H                                                  0471
*        /************************************************************/
*        /*                                                          */
*        /*  OPEN INPUT DATA SET - THE PORTABILITY VOLUME AS         */
*        /*  SPECIFIED IN THE IN PARAMETER                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0471
*        IF ADDR(IN) ^= NULLPTR                            /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RF00458 L     @15,@PC00001+4                                      0471
         L     @14,FDTPTR(,@15)                                    0471
         LTR   @14,@14                                             0471
         BZ    @RF00471                                            0471
*            CALL OPENPROC('I',ADDR(INDDVAL),NULLPARM,0,   /*@Y30SSFR*/
*              BLKSIZ,ADDR(PINIOCS));                      /*@Y30SSFR*/
         LA    @02,@CC00809                                        0472
         ST    @02,@AL00001                                        0472
         L     @02,FDTPTR+56(,@15)                                 0472
         LA    @02,INDDVAL(,@02)                                   0472
         ST    @02,@AFTEMPS                                        0472
         LA    @02,@AFTEMPS                                        0472
         ST    @02,@AL00001+4                                      0472
         LA    @02,NULLPARM                                        0472
         ST    @02,@AL00001+8                                      0472
         LA    @02,@CF00118                                        0472
         ST    @02,@AL00001+12                                     0472
         LA    @02,BLKSIZ                                          0472
         ST    @02,@AL00001+16                                     0472
         LA    @02,PINIOCS                                         0472
         ST    @02,@AFTEMPS+4                                      0472
         LA    @02,@AFTEMPS+4                                      0472
         ST    @02,@AL00001+20                                     0472
         LA    @01,@AL00001                                        0472
         BAL   @14,OPENPROC                                        0472
*          ELSE                                            /*@Y30SSFR*/
*            CALL OPENPROC('I',NULLPARM,ADDR(INDSVAL),0,   /*@Y30SSFR*/
*              BLKSIZ,ADDR(PINIOCS));                      /*@Y30SSFR*/
*                                                                  0473
         B     @RC00471                                            0473
@RF00471 LA    @02,@CC00809                                        0473
         ST    @02,@AL00001                                        0473
         LA    @02,NULLPARM                                        0473
         ST    @02,@AL00001+4                                      0473
         L     @02,@PC00001+4                                      0473
         L     @02,FDTPTR+92(,@02)                                 0473
         LA    @02,INDSVAL(,@02)                                   0473
         ST    @02,@AFTEMPS                                        0473
         LA    @02,@AFTEMPS                                        0473
         ST    @02,@AL00001+8                                      0473
         LA    @02,@CF00118                                        0473
         ST    @02,@AL00001+12                                     0473
         LA    @02,BLKSIZ                                          0473
         ST    @02,@AL00001+16                                     0473
         LA    @02,PINIOCS                                         0473
         ST    @02,@AFTEMPS+4                                      0473
         LA    @02,@AFTEMPS+4                                      0473
         ST    @02,@AL00001+20                                     0473
         LA    @01,@AL00001                                        0473
         BAL   @14,OPENPROC                                        0473
*        /************************************************************/
*        /*                                                          */
*        /*  TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL         */
*        /*  RETURN TO CALLING PROCESSOR                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0474
*        RESPECIFY RTNREG RSTD;                                    0474
@RC00471 DS    0H                                                  0475
*        TESTRC = RTNREG;                                          0475
         LR    TESTRC,RTNREG                                       0475
*        RESPECIFY RTNREG UNRSTD;                                  0476
*        IF TESTRC ^= 0                                            0477
*          THEN                                                    0477
         LTR   TESTRC,TESTRC                                       0477
         BZ    @RF00477                                            0477
*            DO;                                                   0478
*            DEFSTID = ERROPENP;                                   0479
         MVI   DEFSTID,X'0E'                                       0479
*            RETURN CODE(LASTCC12);                                0480
         LA    @15,12                                              0480
         L     @14,@SA00002                                        0480
         LM    @00,@12,@SA00002+8                                  0480
         BR    @14                                                 0480
*            END;                                                  0481
*                                                                  0481
*        /***********************************************************/
*        /*                                                          */
*        /*  PROCESS THE TIME STAMP RECORD WHICH IS THE FIRST        */
*        /*  RECORD ON THE PORTABILITY VOLUME  THIS RECORD GIVES     */
*        /*  THE TIME AND DATE THE DATA SET WAS EXPORTED.            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0482
*        /************************************************************/
*        /*                                                          */
*        /*  READ THE TIME STAMP RECORD FROM THE PORTABLE DATA SET   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0482
*        IOCSPTR = PINIOCS;                                        0482
*                                                                  0482
@RF00477 L     @03,PINIOCS                                         0482
         ST    @03,IOCSPTR                                         0482
*        CALL IDCIOGT0 (GDTTBL,IOCSPTR);                           0483
*                                                                  0483
         L     @03,@PC00001                                        0483
         ST    @03,@AL00001                                        0483
         LA    @15,IOCSPTR                                         0483
         ST    @15,@AL00001+4                                      0483
         MVI   @AL00001+4,X'80'                                    0483
         L     @15,GDTGET(,@03)                                    0483
         LA    @01,@AL00001                                        0483
         BALR  @14,@15                                             0483
*        RESPECIFY RTNREG RSTD;                                    0484
*        TESTRC = RTNREG;                                          0485
         LR    TESTRC,RTNREG                                       0485
*        RESPECIFY RTNREG UNRSTD;                                  0486
*        IF TESTRC ^= 0                                            0487
*          THEN                                                    0487
         LTR   TESTRC,TESTRC                                       0487
         BZ    @RF00487                                            0487
*            /********************************************************/
*            /*                                                      */
*            /*  COULD NOT READ RECORD FROM PORTABILITY VOLUME.      */
*            /*  INDICATE ERROR  AND RETURN TO CALLING PROCESSOR     */
*            /*                                                      */
*            /********************************************************/
*                                                                  0488
*            RETURN CODE(LASTCC12);                                0488
*                                                                  0488
         LA    @15,12                                              0488
         L     @14,@SA00002                                        0488
         LM    @00,@12,@SA00002+8                                  0488
         BR    @14                                                 0488
*        /************************************************************/
*        /*                                                          */
*        /*  SAVE INFORMATION PASSED BY EXPORT GIVING NUMBER OF      */
*        /*  COMPONENTS IN CLUSTER AND FLAG BYTE INDICATING          */
*        /*  WHETHER INHIBITTARGET WAS SPECIFIED AT EXPORT TIME      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0489
*        CONRCPTR = IOCDAD;                                        0489
*                                                                  0489
@RF00487 L     @01,IOCSPTR                                         0489
         L     @15,IOCDAD(,@01)                                    0489
         ST    @15,CONRCPTR                                        0489
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO SEE THAT THIS IS A PORTABLE DATA SET -         */
*        /*  CHECK FOR TIME STAMP FLAGS SET IN FIRST RECORD.         */
*        /*  IF FLAGS INCORRECT, RETURN WITH ERROR                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0490
*        IF HEADFLG1 ^= HDFL1CAT  HEADFLG2 ^=HDFL2TSP     /*@Y30SSFR*/
*          THEN                                                    0490
         CLI   HEADFLG1(@15),X'FF'                                 0490
         BNE   @RT00490                                            0490
         CLI   HEADFLG2(@15),X'FF'                                 0490
         BE    @RF00490                                            0490
@RT00490 DS    0H                                                  0491
*            DO;                                                   0491
*            DEFSTID = PORTERR;                                    0492
         MVI   DEFSTID,X'01'                                       0492
*            RETURN CODE(LASTCC12);                                0493
         LA    @15,12                                              0493
         L     @14,@SA00002                                        0493
         LM    @00,@12,@SA00002+8                                  0493
         BR    @14                                                 0493
*            END;                                                  0494
*                                                                  0494
*        NUMOBJ = TEXOJCT;                                         0495
@RF00490 LA    @15,8                                               0495
         AL    @15,CONRCPTR                                        0495
         SLR   @14,@14                                             0495
         IC    @14,TEXOJCT(,@15)                                   0495
         STH   @14,NUMOBJ                                          0495
*        IMPFLG = TEXFLG;                                          0496
*                                                                  0496
         MVC   IMPFLG(1),TEXFLG(@15)                               0496
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  COMPUTE HOW MANY OBJECTS THERE ARE TO BE        @Y30SSFR*/
*        /*  IMPORTED EXCLUSIVE OF PATHS AND SET THE         @Y30SSFR*/
*        /*  KSDSFLAG ACCORDINGLY.                           @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0497
*        IF IMPASSOC = OFF                                 /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
*                                                                  0497
         TM    IMPASSOC,B'00100000'                                0497
         BNZ   @RF00497                                            0497
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  THERE ARE NO PATH ASSOCIATIONS PRESENT.     @Y30SSFR*/
*            /*  THE NUMBER OF COMPONENTS IS EQUAL TO        @Y30SSFR*/
*            /*  THE NUMBER OF OBJECTS PRESENT IN THE        @Y30SSFR*/
*            /*  PORTABILITY DATA SET.                       @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0498
*            NUMCOMP = NUMOBJ;                             /*@Y30SSFR*/
*                                                                  0498
         STH   @14,NUMCOMP                                         0498
*          ELSE                                            /*@Y30SSFR*/
*                                                                  0499
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  THERE ARE PATH ASSOCIATIONS PRESENT.  USE   @Y30SSFR*/
*            /*  THE IMPBASE BIT TO DETERMINE IF AN INDEX    @Y30SSFR*/
*            /*  COMPONENT HAS BEEN EXPORTED.                @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0499
*            IF IMPBASE = ON                               /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
*                                                                  0499
         B     @RC00497                                            0499
@RF00497 TM    IMPBASE,B'00010000'                                 0499
         BNO   @RF00499                                            0499
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  THERE IS AN INDEX COMPONENT ON THE      @Y30SSFR*/
*                /*  PORTABILITY DATA SET.  SET THE VALUE    @Y30SSFR*/
*                /*  OF NUMCOMP TO BE THREE.                 @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0500
*                NUMCOMP = 3;                              /*@Y30SSFR*/
*                                                                  0500
         MVC   NUMCOMP(2),@CH00165                                 0500
*              ELSE                                                0501
*                                                                  0501
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  IMPBASE IS OFF, INDICATING THAT THERE   @Y30SSFR*/
*                /*  IS NO INDEX COMPONENT.  SET NUMCOMP TO  @Y30SSFR*/
*                /*  BE TWO.                                 @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0501
*                NUMCOMP = 2;                              /*@Y30SSFR*/
*                                                                  0501
         B     @RC00499                                            0501
@RF00499 MVC   NUMCOMP(2),@CH00156                                 0501
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF NUMCOMP IS 3, WE ARE IMPORTING A KSDS, SO    @Y30SSFR*/
*        /*  THE KSDSFLAG IS SET TO ON.  OTHERWISE           @Y30SSFR*/
*        /*  THE OBJECT BEING IMPORTED IS NOT A KSDS, AND    @Y30SSFR*/
*        /*  THE KSDSFLAG MUST BE SET TO OFF.                @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0502
*        IF NUMCOMP = 3                                    /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RC00499 DS    0H                                                  0502
@RC00497 CLC   NUMCOMP(2),@CH00165                                 0502
         BNE   @RF00502                                            0502
*            KSDSFLAG = ON;                                /*@Y30SSFR*/
         OI    KSDSFLAG,B'10000000'                                0503
*          ELSE                                            /*@Y30SSFR*/
*            KSDSFLAG = OFF;                               /*@Y30SSFR*/
*                                                                  0504
*                                                                  0504
         B     @RC00502                                            0504
@RF00502 NI    KSDSFLAG,B'01111111'                                0504
*        /************************************************************/
*        /*                                                          */
*        /*  LIST EXPORT TIME STAMP INFORMATION USING TEXT PROCESSOR */
*        /*  INTERFACE                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0505
*        DARGCNT = 2;                                              0505
@RC00502 LA    @15,2                                               0505
         L     @14,DDSTRU                                          0505
         STH   @15,DARGCNT(,@14)                                   0505
*        DARGINS(1) = 1;                                           0506
         MVC   DARGINS(2,@14),@CH00221                             0506
*        DARGINL(1) = LENGTH(TIMEDATE);                            0507
         LA    @05,8                                               0507
         STH   @05,DARGINL(,@14)                                   0507
*        DARGDTM(1) = ADDR(TIMEDATE);                              0508
         L     @04,CONRCPTR                                        0508
         ALR   @04,@05                                             0508
         LA    @03,TIMEDATE(,@04)                                  0508
         ST    @03,DARGDTM(,@14)                                   0508
*        DARGINS(2) = 2;                                           0509
         STH   @15,DARGINS+8(,@14)                                 0509
*        DARGINL(2) = LENGTH(TIMEODAY);                            0510
         STH   @05,DARGINL+8(,@14)                                 0510
*        DARGDTM(2) = ADDR(TIMEODAY);                              0511
         LA    @15,TIMEODAY(,@04)                                  0511
         ST    @15,DARGDTM+8(,@14)                                 0511
*        CALL MSGPROC(TIMEMSG);                                    0512
*                                                                  0512
         LA    @01,@AL00512                                        0512
         BAL   @14,MSGPROC                                         0512
*        /************************************************************/
*        /*                                                          */
*        /*  SET ADDRESS OF  CONTROL RECORD BUFFER WHICH WILL        */
*        /*  CONTAIN DICTIONARY FOR CATALOG RECORDS                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0513
*        CONRCPTR = ADDR(CONRCARE);                                0513
*                                                                  0513
         LA    @15,CONRCARE                                        0513
         ST    @15,CONRCPTR                                        0513
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORD @Y30SSFR*/
*        /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR @Y30SSFR*/
*        /*  AND ZCNTRL.                                     @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0514
*        ZSIZE = LENGTH(CONRCARE);                         /*@Y30SSFR*/
         LA    ZSIZE,268                                           0514
*        ZPTR = CONRCPTR;                                  /*@Y30SSFR*/
         LR    ZPTR,@15                                            0515
*        ZCNTRL = ON;                                      /*@Y30SSFR*/
*                                                                  0516
         OI    ZCNTRL,B'10000000'                                  0516
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  LOOP CLEARING OUT THE BUFFER FOR THE CONTROL    @Y30SSFR*/
*        /*  RECORD.                                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0517
*        DO WHILE (ZCNTRL = ON);                           /*@Y30SSFR*/
         B     @DE00517                                            0517
@DL00517 DS    0H                                                  0518
*          IF ZSIZE > 256                                  /*@Y30SSFR*/
*            THEN                                          /*@Y30SSFR*/
         LA    @15,256                                             0518
         CR    ZSIZE,@15                                           0518
         BNH   @RF00518                                            0518
*              DO;                                         /*@Y30SSFR*/
*              ZAREA(1:256) = ZER(1:256);                  /*@Y30SSFR*/
         MVC   ZAREA(256,ZPTR),ZER                                 0520
*              ZSIZE = ZSIZE - 256;                        /*@Y30SSFR*/
         SLR   ZSIZE,@15                                           0521
*              ZPTR = ZPTR + 256;                          /*@Y30SSFR*/
         ALR   ZPTR,@15                                            0522
*              END;                                        /*@Y30SSFR*/
*            ELSE                                          /*@Y30SSFR*/
*              DO;                                         /*@Y30SSFR*/
         B     @RC00518                                            0524
@RF00518 DS    0H                                                  0525
*              ZAREA(1:ZSIZE) = ZER(1:ZSIZE);              /*@Y30SSFR*/
         LR    @15,ZSIZE                                           0525
         BCTR  @15,0                                               0525
         EX    @15,@SM01687                                        0525
*              ZCNTRL = OFF;                               /*@Y30SSFR*/
         NI    ZCNTRL,B'01111111'                                  0526
*              END;                                        /*@Y30SSFR*/
*        END;                                              /*@Y30SSFR*/
*                                                                  0528
@RC00518 DS    0H                                                  0528
@DE00517 TM    ZCNTRL,B'10000000'                                  0528
         BO    @DL00517                                            0528
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESS CATALOG INFORMATION FROM THE PORTABILITY VOLUME */
*        /*                                                          */
*        /************************************************************/
*                                                                  0529
*        OLDERID2 = NEWERID2;                                      0529
         L     @15,@PC00001                                        0529
         L     @15,GDTTR2(,@15)                                    0529
         MVC   @TS00001(95),NEWERID2(@15)                          0529
         MVC   OLDERID2(95,@15),@TS00001                           0529
*        NEWID2 = 'MPCT';                                          0530
*                                                                  0530
         MVC   NEWID2(4,@15),@CC01294                              0530
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT THE CPL TO BE EMPLOYED FOR THE DEFINE         */
*        /*  FUNCTION.  IF NOT CONSTRUCTED SUCCESSFULLY, RETURN TO   */
*        /*  THE CALLING PROCESSOR WITH AN ERROR INDICATOR           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0531
*        CALL CPLPROC('F',PTRCPL,NULLPARM,NULLPARM,NULLPARM);      0531
         MVC   @AL00001(20),@AL00531                               0531
         LA    @15,PTRCPL                                          0531
         ST    @15,@AL00001+4                                      0531
         LA    @01,@AL00001                                        0531
         BAL   @14,CPLPROC                                         0531
*        RESPECIFY RTNREG RSTD;                                    0532
*        TESTRC = RTNREG;                                          0533
         LR    TESTRC,RTNREG                                       0533
*        RESPECIFY RTNREG UNRSTD;                                  0534
*        IF TESTRC ^= 0                                            0535
*          THEN                                                    0535
         LTR   TESTRC,TESTRC                                       0535
         BZ    @RF00535                                            0535
*            RETURN CODE(LASTCC12);                                0536
         LA    @15,12                                              0536
         L     @14,@SA00002                                        0536
         LM    @00,@12,@SA00002+8                                  0536
         BR    @14                                                 0536
*        CTGPLPTR = PTRCPL;                                        0537
*                                                                  0537
*                                                                  0537
@RF00535 L     @15,PTRCPL                                          0537
         ST    @15,CTGPLPTR                                        0537
*CATLOOP:  DO I = 1 TO NUMCOMP;                            /*@Y30SSFR*/
*                                                                  0538
CATLOOP  LA    I,1                                                 0538
         B     @DE00538                                            0538
@DL00538 DS    0H                                                  0539
*        /************************************************************/
*        /*                                                          */
*        /*  READ CONTROL RECORD FROM PORTABLE DATA SET, CONTAINING  */
*        /*  DICTIONARY FOR CATALOG INFORMATION.                     */
*        /*  IF UNSUCCESSFUL, RETURN TO CALLING PROCESSOR.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0539
*        CALL IDCIOGT0 (GDTTBL,PINIOCS);                           0539
*                                                                  0539
         L     @15,@PC00001                                        0539
         ST    @15,@AL00001                                        0539
         LA    @14,PINIOCS                                         0539
         ST    @14,@AL00001+4                                      0539
         MVI   @AL00001+4,X'80'                                    0539
         L     @15,GDTGET(,@15)                                    0539
         LA    @01,@AL00001                                        0539
         BALR  @14,@15                                             0539
*        RESPECIFY RTNREG RSTD;                                    0540
*        TESTRC = RTNREG;                                          0541
         LR    TESTRC,RTNREG                                       0541
*        RESPECIFY RTNREG UNRSTD;                                  0542
*        IF TESTRC ^= 0                                            0543
*          THEN                                                    0543
         LTR   TESTRC,TESTRC                                       0543
         BZ    @RF00543                                            0543
*            RETURN CODE(LASTCC12);                                0544
*                                                                  0544
         LA    @15,12                                              0544
         L     @14,@SA00002                                        0544
         LM    @00,@12,@SA00002+8                                  0544
         BR    @14                                                 0544
*        /************************************************************/
*        /*                                                          */
*        /*  MOVE CONTROL RECORD JUST READ INTO BUFFER               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0545
*        TFVTLEN = IOCDAD -> HEADLN;                               0545
*                                                                  0545
@RF00543 L     @02,IOCSPTR                                         0545
         L     @01,IOCDAD(,@02)                                    0545
         LH    @15,HEADLN(,@01)                                    0545
         STH   @15,TFVTLEN                                         0545
*        CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                   0546
*                                                                  0546
         LA    @15,TFVTLEN                                         0546
         ST    @15,@AL00001                                        0546
         ST    @02,@AL00001+4                                      0546
         LA    @02,CONRCPTR                                        0546
         ST    @02,@AL00001+8                                      0546
         LA    @01,@AL00001                                        0546
         BAL   @14,MVDAPROC                                        0546
*        IF HEADFLG1 = HDFL1CAT                                    0547
*          THEN                                                    0547
         L     @02,CONRCPTR                                        0547
         CLI   HEADFLG1(@02),X'FF'                                 0547
         BNE   @RF00547                                            0547
*            DO;                                                   0548
*                                                                  0548
*            /********************************************************/
*            /*                                                      */
*            /*  GET A BUFFER FOR THE NEXT RECORD WHICH WILL BE      */
*            /*  A DATA RECORD CONTAINING CATALOG LOCATE WORK AREA   */
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */
*            /*  THE CALLING PROCEDURE                               */
*            /*                                                      */
*            /********************************************************/
*                                                                  0549
*                                                                  0549
*            TOTLEN = ASSRECLN;                                    0549
*                                                                  0549
         L     @15,CONRCPTR                                        0549
         LH    @15,ASSRECLN(,@15)                                  0549
         ST    @15,TOTLEN                                          0549
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,WORKAR(I),GPID,SETZERO); 0550
*                                                                  0550
         L     @15,@PC00001                                        0550
         ST    @15,@AL00001                                        0550
         LA    @14,TOTLEN                                          0550
         ST    @14,@AL00001+4                                      0550
         LR    @14,I                                               0550
         SLA   @14,2                                               0550
         LA    @14,WORKAR-4(@14)                                   0550
         ST    @14,@AL00001+8                                      0550
         LA    @14,GPID                                            0550
         ST    @14,@AL00001+12                                     0550
         LA    @14,SETZERO                                         0550
         ST    @14,@AL00001+16                                     0550
         MVI   @AL00001+16,X'80'                                   0550
         L     @15,GDTGPL(,@15)                                    0550
         LA    @01,@AL00001                                        0550
         BALR  @14,@15                                             0550
*            RESPECIFY RTNREG RSTD;                                0551
*            TESTRC = RTNREG;                                      0552
         LR    TESTRC,RTNREG                                       0552
*            RESPECIFY RTNREG UNRSTD;                              0553
*            IF TESTRC ^= 0                                        0554
*              THEN                                                0554
         LTR   TESTRC,TESTRC                                       0554
         BZ    @RF00554                                            0554
*                DO;                                               0555
*                DEFSTID = NOSTORAG;                               0556
         MVI   DEFSTID,X'04'                                       0556
*                DARGSMOD = UNIVMSG;                               0557
         L     @01,DDSTRU                                          0557
         MVC   DARGSMOD(3,@01),@CC01023                            0557
*                RETURN CODE(LASTCC12);                            0558
         LA    @15,12                                              0558
         L     @14,@SA00002                                        0558
         LM    @00,@12,@SA00002+8                                  0558
         BR    @14                                                 0558
*                END;                                              0559
*                                                                  0559
*            /********************************************************/
*            /*                                                      */
*            /*  NOW READ A DATA RECORD WHICH WILL CONTAIN THE       */
*            /*  CATALOG FIELD INFORMATION WHICH IS REFERENCED BY    */
*            /*  THE DICTIONARY CONTAINED IN THE CONTROL RECORD      */
*            /*  IF AN ERROR IS ENCOUNTERED, RETURN TO CALLING       */
*            /*  PROCESSOR                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0560
*            CALL GETPROC(WORKAR(I),ASSRECLN);                     0560
*                                                                  0560
@RF00554 LR    @02,I                                               0560
         SLA   @02,2                                               0560
         LA    @02,WORKAR-4(@02)                                   0560
         ST    @02,@AL00001                                        0560
         L     @02,CONRCPTR                                        0560
         LA    @02,ASSRECLN(,@02)                                  0560
         ST    @02,@AL00001+4                                      0560
         LA    @01,@AL00001                                        0560
         BAL   @14,GETPROC                                         0560
*            RESPECIFY RTNREG RSTD;                                0561
*            TESTRC = RTNREG;                                      0562
         LR    TESTRC,RTNREG                                       0562
*            RESPECIFY RTNREG UNRSTD;                              0563
*            IF TESTRC ^= 0                                        0564
*              THEN                                                0564
         LTR   TESTRC,TESTRC                                       0564
         BZ    @RF00564                                            0564
*                RETURN CODE(LASTCC12);                            0565
*                                                                  0565
         LA    @15,12                                              0565
         L     @14,@SA00002                                        0565
         LM    @00,@12,@SA00002+8                                  0565
         BR    @14                                                 0565
*            /********************************************************/
*            /*                                                      */
*            /*  BUILD AN FVT TO CORRESPOND TO THIS RECORD OF        */
*            /*  CATALOG INFORMATION.  FVTPROC WILL GET CORE         */
*            /*  AND BUILD FPLS FROM INFORMATION IN THE DICTIONARY   */
*            /*  AND WORK AREA.                                      */
*            /*  IF AN ERROR IS ENCOUNTERED, RETURN TO CALLING       */
*            /*  PROCESSOR                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  0566
*            DICTPTR = ADDR(VARDATA);                              0566
*                                                                  0566
@RF00564 L     @02,CONRCPTR                                        0566
         LA    @02,VARDATA(,@02)                                   0566
         ST    @02,DICTPTR                                         0566
*            CALL FVTPROC(DICTPTR,WORKAR(I),FVTPTR(I));            0567
*                                                                  0567
         LA    @02,DICTPTR                                         0567
         ST    @02,@AL00001                                        0567
         LR    @02,I                                               0567
         SLA   @02,2                                               0567
         LA    @15,WORKAR-4(@02)                                   0567
         ST    @15,@AL00001+4                                      0567
         LA    @02,FVTPTR-4(@02)                                   0567
         ST    @02,@AL00001+8                                      0567
         LA    @01,@AL00001                                        0567
         BAL   @14,FVTPROC                                         0567
*            RESPECIFY RTNREG RSTD;                                0568
*            TESTRC = RTNREG;                                      0569
         LR    TESTRC,RTNREG                                       0569
*            RESPECIFY RTNREG UNRSTD;                              0570
*            IF TESTRC ^= 0                                        0571
*              THEN                                                0571
         LTR   TESTRC,TESTRC                                       0571
         BZ    @RF00571                                            0571
*                RETURN CODE(LASTCC12);                            0572
*                                                                  0572
         LA    @15,12                                              0572
         L     @14,@SA00002                                        0572
         LM    @00,@12,@SA00002+8                                  0572
         BR    @14                                                 0572
*            /********************************************************/
*            /*                                                      */
*            /*  PLACE THE FVT POINTER IN   PROPER FIELD.THE CLUSTER */
*            /*  FVT POINTER WILL BE PLACED IN THE CPL.  THE DATA OR */
*            /*  INDEX OBJECT FVT POINTERS WILL BE PLACED IN CLUSTER */
*            /*  OR AIX FVT.                                 @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0573
*            RESPECIFY CTGFV BASED(CTGFVPTR);                      0573
@RF00571 DS    0H                                                  0574
*            CTGFVPTR = FVTPTR(I);                                 0574
         LR    @02,I                                               0574
         SLA   @02,2                                               0574
         L     @02,FVTPTR-4(@02)                                   0574
         ST    @02,CTGFVPTR                                        0574
*            IF CTGFVTYP = CTGTCL  CTGFVTYP = CTGTAIX     /*@Y30SSFR*/
*              THEN                                                0575
         CLI   CTGFVTYP(@02),C'C'                                  0575
         BE    @RT00575                                            0575
         CLI   CTGFVTYP(@02),C'G'                                  0575
         BNE   @RF00575                                            0575
@RT00575 DS    0H                                                  0576
*                DO;                                               0576
*                CTGFVT = FVTPTR(I);                               0577
*                                                                  0577
         LR    @02,I                                               0577
         SLA   @02,2                                               0577
         L     @02,FVTPTR-4(@02)                                   0577
         L     @01,CTGPLPTR                                        0577
         ST    @02,CTGFVT(,@01)                                    0577
*                /****************************************************/
*                /*                                                  */
*                /*  SET POINTER TO MASTER PASSWORD FOR CLUSTER IF   */
*                /*  PROTECTION INFORMATION EXISTS.                  */
*                /*                                                  */
*                /****************************************************/
*                                                                  0578
*                IF CTGFVSTY ^= NULLPTR                            0578
*                  THEN                                            0578
         L     @02,CTGFVPTR                                        0578
         L     @02,CTGFVSTY(,@02)                                  0578
         LTR   @02,@02                                             0578
         BZ    @RF00578                                            0578
*                    CPSWD = CTGFVSTY -> CTGFLPT(1);               0579
*                                                                  0579
         L     @02,CTGFLPT(,@02)                                   0579
         ST    @02,CPSWD                                           0579
*                END;                                              0580
*              ELSE                                                0581
*                DO;                                               0581
         B     @RC00575                                            0581
@RF00575 DS    0H                                                  0582
*                IF CTGFVTYP = CTGTDATA                            0582
*                  THEN                                            0582
         L     @02,CTGFVPTR                                        0582
         CLI   CTGFVTYP(@02),C'D'                                  0582
         BNE   @RF00582                                            0582
*                    DO;                                           0583
*                    CTGFVPTR = CTGFVT;                            0584
         L     @02,CTGPLPTR                                        0584
         L     @02,CTGFVT(,@02)                                    0584
         ST    @02,CTGFVPTR                                        0584
*                    CTGFVDCH = FVTPTR(I);                         0585
         LR    @15,I                                               0585
         SLA   @15,2                                               0585
         L     @15,FVTPTR-4(@15)                                   0585
         ST    @15,CTGFVDCH(,@02)                                  0585
*                    END;                                          0586
*                  ELSE                                            0587
*                    DO;                                           0587
         B     @RC00582                                            0587
@RF00582 DS    0H                                                  0588
*                    CTGFVPTR = CTGFVT;                            0588
         L     @02,CTGPLPTR                                        0588
         L     @02,CTGFVT(,@02)                                    0588
         ST    @02,CTGFVPTR                                        0588
*                    CTGFVICH = FVTPTR(I);                         0589
         LR    @15,I                                               0589
         SLA   @15,2                                               0589
         L     @15,FVTPTR-4(@15)                                   0589
         ST    @15,CTGFVICH(,@02)                                  0589
*                    END;                                          0590
*                END;                                              0591
@RC00582 DS    0H                                                  0592
*        END;                                                      0592
@RC00575 DS    0H                                                  0593
*        END CATLOOP;                                      /*@Y30SSFR*/
*                                                                  0593
@RF00547 AL    I,@CF00221                                          0593
@DE00538 CH    I,NUMCOMP                                           0593
         BNH   @DL00538                                            0593
*        /************************************************************/
*        /*                                                          */
*        /*  IF A DATA SET WAS A UNIQUE DATA SET (HAVING ITS OWN     */
*        /*  DATA SPACE) PRIOR TO EXPORT, IT WILL AGAIN BE DEFINED   */
*        /*  AS A UNIQUE DATA SET.    IUNIQPRC WILL DETERMINE IF THE */
*        /*  DATA SET WAS UNIQUE AND IF SO, CONSTRUCT THE NULL SPACE */
*        /*  FVT REQUIRED FOR DEFINE                                 */
*        /*  IF IUNIQPRC DOES NOT COMPLETE SUCCESSFULLY, CONTROL     */
*        /*  WILL BE RETURNED TO THE CALLING PROCESSOR               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0594
*        CALL IUNIQPRC;                                            0594
*                                                                  0594
         BAL   @14,IUNIQPRC                                        0594
*        RESPECIFY RTNREG RSTD;                                    0595
*        TESTRC = RTNREG;                                          0596
         LR    TESTRC,RTNREG                                       0596
*        RESPECIFY RTNREG UNRSTD;                                  0597
*        IF TESTRC ^= 0                                            0598
*          THEN                                                    0598
         LTR   TESTRC,TESTRC                                       0598
         BZ    @RF00598                                            0598
*            RETURN CODE(LASTCC12);                                0599
         LA    @15,12                                              0599
         L     @14,@SA00002                                        0599
         LM    @00,@12,@SA00002+8                                  0599
         BR    @14                                                 0599
*        /************************************************************/
*        /*                                                          */
*        /*  MODIFY FVT'S WITH INFORMATION FROM THE AMS COMMAND      */
*        /*  PARAMETER - OBJECT.  THE ENTRYNAME MAY BE MODIFIED VIA  */
*        /*  THE NEWNAME PARAMETER. LISTVOLS AND DNAME  ARE          */
*        /*  CONSTRUCTED FROM INFORMATION IN THE AMS COMMAND.        */
*        /*  PROCESS FVTS IN THE CLUSTER, DATA AND INDEX ORDER.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0600
*        CTGFVPTR = CTGFVT;                                        0600
*                                                                  0600
@RF00598 L     @01,CTGPLPTR                                        0600
         L     @15,CTGFVT(,@01)                                    0600
         ST    @15,CTGFVPTR                                        0600
*        /************************************************************/
*        /*                                                          */
*        /*  MATCH OBJECT PARAMETER WITH CORRECT FVT BY MATCHING     */
*        /*  ENTRYNAME FROM ENTNAME FPL WITH OBJECTNAME              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0601
*        IF ADDR(OBJTS) ^= NULLPTR                                 0601
*          THEN                                                    0601
         L     @15,@PC00001+4                                      0601
         L     @15,FDTPTR+8(,@15)                                  0601
         LTR   @15,@15                                             0601
         BZ    @RF00601                                            0601
*OBJCTLP:  DO FX = 1 TO NUMCOMP;                                   0602
OBJCTLP  LA    FX,1                                                0602
         B     @DE00602                                            0602
@DL00602 DS    0H                                                  0603
*            CTGFVPTR = FVTPTR(FX);                                0603
         LR    @02,FX                                              0603
         SLA   @02,2                                               0603
         L     @02,FVTPTR-4(@02)                                   0603
         ST    @02,CTGFVPTR                                        0603
*OBJENTLP:   DO IX = 1 TO OBJTSCNT;                        /*@OZ32365*/
*                                                                  0604
OBJENTLP LA    @02,1                                               0604
         B     @DE00604                                            0604
@DL00604 DS    0H                                                  0605
*              /******************************************************/
*              /*                                                    */
*              /*  IF A MATCH IS FOUND BETWEEN THE FVT AND THE       */
*              /*  NAME IN THE OBJECTS PARAMETER, PROCESS THE        */
*              /*  INPUT INFORMATION SPECIFIED FOR THAT OBJECT.      */
*              /*                                                    */
*              /******************************************************/
*                                                                  0605
*              IF OBJNMPTR(IX)->OBJNMVAL(1:44) = FENTNAME(1:44)    0605
*                THEN                                              0605
         SLA   @02,2                                               0605
         L     @15,@PC00001+4                                      0605
         L     @01,FDTPTR+12(,@15)                                 0605
         AL    @01,@CF01689                                        0605
         L     @02,OBJNMPTR(@02,@01)                               0605
         L     @01,CTGFVPTR                                        0605
         L     @01,CTGFVENT(,@01)                                  0605
         CLC   OBJNMVAL(44,@02),FENTNAME(@01)                      0605
         BNE   @RF00605                                            0605
*OBJMATCH:         DO;                                             0606
OBJMATCH DS    0H                                                  0607
*                  IMPF2OBJ = ON;                                  0607
*                                                                  0607
         OI    IMPF2OBJ,B'00100000'                                0607
*              /******************************************************/
*              /*                                                    */
*              /*       PROCESS  THE FILE PARAMETER                  */
*              /*                                                    */
*              /******************************************************/
*                                                                  0608
*                IF OBJFLPTR(IX) ^= NULLPTR                        0608
*                  THEN CTGFVIND=ADDR(OBJFLPTR(IX) -> OBJFLVAL);   0608
*                                                                  0608
         L     @02,IX                                              0608
         SLA   @02,2                                               0608
         L     @15,@PC00001+4                                      0608
         L     @01,FDTPTR+20(,@15)                                 0608
         AL    @01,@CF01689                                        0608
         L     @02,OBJFLPTR(@02,@01)                               0608
         LTR   @02,@02                                             0608
         BZ    @RF00608                                            0608
         LA    @02,OBJFLVAL(,@02)                                  0609
         L     @01,CTGFVPTR                                        0609
         ST    @02,CTGFVIND(,@01)                                  0609
*                  /**************************************************/
*                  /*                                                */
*                  /*  IF THE NEWNAME PARAMETER HAS BEEN SPECIFIED,  */
*                  /*  SET A POINTER TO THE CHANGED NAME IN THE      */
*                  /*  ENTNAME FPL                                   */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0610
*                  IF NEWNMPTR(IX) ^= NULLPTR                      0610
*                    THEN                                          0610
@RF00608 L     @02,IX                                              0610
         SLA   @02,2                                               0610
         L     @15,@PC00001+4                                      0610
         L     @01,FDTPTR+16(,@15)                                 0610
         AL    @01,@CF01689                                        0610
         L     @02,NEWNMPTR(@02,@01)                               0610
         LTR   @02,@02                                             0610
         BZ    @RF00610                                            0610
*                      CTGFVENT = ADDR(NEWNMPTR(IX)->      /*@Y30SSFR*/
*                                  NEWNMVAL);              /*@Y30SSFR*/
*                                                                  0611
         LA    @02,NEWNMVAL(,@02)                                  0611
         L     @01,CTGFVPTR                                        0611
         ST    @02,CTGFVENT(,@01)                                  0611
*                  /**************************************************/
*                  /*                                                */
*                  /*  PROCESS THE ORDERED OPTION                    */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0612
*                  IF ORDPTR(IX) ^= NULLPTR                /*@Y30SSFR*/
*                    THEN                                          0612
*                                                                  0612
@RF00610 SLR   @02,@02                                             0612
         L     @15,IX                                              0612
         SLA   @15,2                                               0612
         L     @14,@PC00001+4                                      0612
         L     @01,FDTPTR+36(,@14)                                 0612
         AL    @01,@CF01689                                        0612
         C     @02,ORDPTR(@15,@01)                                 0612
         BE    @RF00612                                            0612
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF ORDERED WAS SPECIFIED AT THE CLUSTER   */
*                      /*  LEVEL, SET THE ORDERED ATTRIBUTE AT THE   */
*                      /*  DATA AND INDEX LEVEL(IF EXISTANT).        */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0613
*                      IF FX = 1                           /*@Y30SSFR*/
*                        THEN                                      0613
         C     FX,@CF00221                                         0613
         BNE   @RF00613                                            0613
*                          DO;                                     0614
*                          CTGFLPTR = FVTPTR(2) -> CTGFVAMD;       0615
         L     @01,FVTPTR+4                                        0615
         L     CTGFLPTR,CTGFVAMD(,@01)                             0615
*                          CTGFLPT(1) -> AMDORDER = ON;            0616
         L     @05,CTGFLPT(,CTGFLPTR)                              0616
         OI    AMDORDER(@05),B'00001000'                           0616
*                          IF FVTPTR(3) ^= NULLPTR                 0617
*                            THEN                                  0617
         L     @15,FVTPTR+8                                        0617
         CR    @15,@02                                             0617
         BE    @RF00617                                            0617
*                              DO;                                 0618
*                              CTGFLPTR = FVTPTR(3) -> CTGFVAMD;   0619
         L     CTGFLPTR,CTGFVAMD(,@15)                             0619
*                              CTGFLPT(1) -> AMDORDER = ON;        0620
         L     @05,CTGFLPT(,CTGFLPTR)                              0620
         OI    AMDORDER(@05),B'00001000'                           0620
*                              END;                                0621
*                          END;                                    0622
*                        ELSE                                      0623
*                                                                  0623
*                          /******************************************/
*                          /*                                        */
*                          /*  IF ORDERED WAS SPECIFIED AT THE DATA  */
*                          /*  OR INDEX LEVEL, SET THE ORDERED       */
*                          /*  ATTRIBUTE ONLY AT THAT LEVEL          */
*                          /*                                        */
*                          /******************************************/
*                                                                  0623
*                          DO;                                     0623
         B     @RC00613                                            0623
@RF00613 DS    0H                                                  0624
*                          CTGFLPTR = CTGFVAMD;                    0624
         L     @02,CTGFVPTR                                        0624
         L     CTGFLPTR,CTGFVAMD(,@02)                             0624
*                          CTGFLPT(1) -> AMDORDER = ON;            0625
         L     @05,CTGFLPT(,CTGFLPTR)                              0625
         OI    AMDORDER(@05),B'00001000'                           0625
*                          END;                                    0626
*                                                                  0626
*                  /**************************************************/
*                  /*                                                */
*                  /*  PROCESS THE UNORDERED OPTION                  */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0627
*                  IF UNORDPTR(IX) ^= NULLPTR                      0627
*                    THEN                                          0627
*                                                                  0627
@RC00613 DS    0H                                                  0627
@RF00612 SLR   @02,@02                                             0627
         L     @15,IX                                              0627
         SLA   @15,2                                               0627
         L     @14,@PC00001+4                                      0627
         L     @01,FDTPTR+40(,@14)                                 0627
         AL    @01,@CF01689                                        0627
         C     @02,UNORDPTR(@15,@01)                               0627
         BE    @RF00627                                            0627
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF UNORDERED WAS SPECIFIED AT THE CLUSTER */
*                      /*  LEVEL, SET THE UNORDERED ATTRIBUTE AT THE */
*                      /*  DATA AND INDEX LEVEL(IF EXISTANT).        */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0628
*                      IF FX = 1                           /*@Y30SSFR*/
*                        THEN                                      0628
         C     FX,@CF00221                                         0628
         BNE   @RF00628                                            0628
*                          DO;                                     0629
*                          CTGFLPTR = FVTPTR(2) -> CTGFVAMD;       0630
         L     @01,FVTPTR+4                                        0630
         L     CTGFLPTR,CTGFVAMD(,@01)                             0630
*                          CTGFLPT(1) -> AMDORDER = OFF;           0631
         L     @05,CTGFLPT(,CTGFLPTR)                              0631
         NI    AMDORDER(@05),B'11110111'                           0631
*                          IF FVTPTR(3) ^= NULLPTR                 0632
*                            THEN                                  0632
         L     @15,FVTPTR+8                                        0632
         CR    @15,@02                                             0632
         BE    @RF00632                                            0632
*                              DO;                                 0633
*                              CTGFLPTR = FVTPTR(3) -> CTGFVAMD;   0634
         L     CTGFLPTR,CTGFVAMD(,@15)                             0634
*                              CTGFLPT(1) -> AMDORDER = OFF;       0635
         L     @05,CTGFLPT(,CTGFLPTR)                              0635
         NI    AMDORDER(@05),B'11110111'                           0635
*                              END;                                0636
*                          END;                                    0637
*                        ELSE                                      0638
*                                                                  0638
*                          /******************************************/
*                          /*                                        */
*                          /*  IF UNORDERED WAS SPECIFIED AT THE DATA*/
*                          /*  OR INDEX LEVEL, SET THE ORDERED       */
*                          /*  ATTRIBUTE ONLY AT THAT LEVEL          */
*                          /*                                        */
*                          /******************************************/
*                                                                  0638
*                          DO;                                     0638
         B     @RC00628                                            0638
@RF00628 DS    0H                                                  0639
*                          CTGFLPTR = CTGFVAMD;                    0639
         L     @02,CTGFVPTR                                        0639
         L     CTGFLPTR,CTGFVAMD(,@02)                             0639
*                          CTGFLPT(1) -> AMDORDER = OFF;           0640
         L     @05,CTGFLPT(,CTGFLPTR)                              0640
         NI    AMDORDER(@05),B'11110111'                           0640
*                          END;                                    0641
*                                                                  0641
*                  /**************************************************/
*                  /*                                                */
*                  /*  CALL LVLRPROC TO CONSTRUCT THE LIST OF VOLUME */
*                  /*  SERIAL NUMBERS IF VOLUMES SPECIFIED IN THE    */
*                  /*  AMS COMMAND FOR THIS OBJECT                   */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0642
*                  IF LISTVPTR(IX) ^= NULLPTR                      0642
*                    THEN                                          0642
@RC00628 DS    0H                                                  0642
@RF00627 SLR   @02,@02                                             0642
         L     @15,IX                                              0642
         SLA   @15,2                                               0642
         L     @14,@PC00001+4                                      0642
         L     @01,FDTPTR+24(,@14)                                 0642
         AL    @01,@CF01689                                        0642
         C     @02,LISTVPTR(@15,@01)                               0642
         BE    @RF00642                                            0642
*                      DO;                                         0643
*                                                                  0643
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF VOLUMES IS SPECIFIED AT THE CLUSTER    */
*                      /*  LEVEL, REMOVE THE DATA AND IF APPLICABLE  */
*                      /*  INDEX FVT VOLUME LIST POINTERS(S).  THIS  */
*                      /*  WILL ALLOW PROPAGATION OF THE CLUSTER      /
*                      /*  LEVEL VOLUME LIST.  IF VOLUMES IS NOT     */
*                      /*  SPECIFIED ATH THE DATA/INDEX LEVEL(S).    */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0644
*                      IF FX = 1                           /*@OZ32365*/
*                        THEN                              /*@OZ32365*/
         C     FX,@CF00221                                         0644
         BNE   @RF00644                                            0644
*                          DO;                             /*@OZ32365*/
*                          FVTPTR(2)->CTGFVVLT = NULLPTR;  /*@OZ32365*/
         L     @01,FVTPTR+4                                        0646
         ST    @02,CTGFVVLT(,@01)                                  0646
*                          IF FVTPTR(3) ^= NULLPTR         /*@OZ32365*/
*                            THEN                          /*@OZ32365*/
         L     @15,FVTPTR+8                                        0647
         CR    @15,@02                                             0647
         BE    @RF00647                                            0647
*                              FVTPTR(3)->CTGFVVLT=NULLPTR;/*@OZ32365*/
         ST    @02,CTGFVVLT(,@15)                                  0648
*                            ELSE;                         /*@OZ32365*/
@RF00647 DS    0H                                                  0650
*                          END;                            /*@OZ32365*/
*                        ELSE;                             /*@OZ32365*/
*                                                                  0651
@RF00644 DS    0H                                                  0652
*                      /**********************************************/
*                      /*                                            */
*                      /*  CONSTRUCT VOLUMES SERIAL LIST.  IF        */
*                      /*  UNSUCCESSFUL, RETURN TO CALLING PROCESSOR */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0652
*                      CALL LVLRPROC(IX,NULLPARM,NULLPARM,FVTPTR(FX));
         LA    @02,IX                                              0652
         ST    @02,@AL00001                                        0652
         LA    @02,NULLPARM                                        0652
         ST    @02,@AL00001+4                                      0652
         LA    @02,NULLPARM                                        0652
         ST    @02,@AL00001+8                                      0652
         LR    @02,FX                                              0652
         SLA   @02,2                                               0652
         LA    @02,FVTPTR-4(@02)                                   0652
         ST    @02,@AL00001+12                                     0652
         LA    @01,@AL00001                                        0652
         BAL   @14,LVLRPROC                                        0652
*                      RESPECIFY RTNREG RSTD;                      0653
*                      TESTRC = RTNREG;                            0654
         LR    TESTRC,RTNREG                                       0654
*                      RESPECIFY RTNREG UNRSTD;                    0655
*                      IF TESTRC ^= 0                              0656
*                        THEN                                      0656
         LTR   TESTRC,TESTRC                                       0656
         BZ    @RF00656                                            0656
*                          RETURN CODE(LASTCC12);                  0657
*                                                                  0657
         LA    @15,12                                              0657
         L     @14,@SA00002                                        0657
         LM    @00,@12,@SA00002+8                                  0657
         BR    @14                                                 0657
*                      END;                                        0658
*                                                                  0658
@RF00656 DS    0H                                                  0659
*                  /**************************************************/
*                  /*                                                */
*                  /*  IF THE KEYRANGES PARAMETER HAS BEEN SPECIFIED */
*                  /*  IN THE AMS COMMAND, CALL RANGPROC TO CONSTRUCT*/
*                  /*  THE KEYRANGES LIST FOR DEFINE                 */
*                  /*                                                */
*                 /**************************************************/
*                                                                  0659
*                  IF RANGEPTR(IX) ^= NULLPTR                      0659
*                    THEN                                          0659
@RF00642 SLR   @02,@02                                             0659
         L     @15,IX                                              0659
         SLA   @15,2                                               0659
         L     @14,@PC00001+4                                      0659
         L     @01,FDTPTR+28(,@14)                                 0659
         AL    @01,@CF01689                                        0659
         C     @02,RANGEPTR(@15,@01)                               0659
         BE    @RF00659                                            0659
*                      DO;                                         0660
*                                                                  0660
*                      /**********************************************/
*                      /*                                            */
*                      /*  IF KEYRANGES IS SPECIFIED IN THE AMS      */
*                      /*  IMPORT COMMAND BOTH AT THE DATA AND INDEX */
*                      /*  LEVELS, IGNORE THE INDEX LEVEL            */
*                      /*  SPECIFICATION                             */
*                      /*  IF LIST NOT CONSTRUCTED SUCCESSFULLY,     */
*                      /*  RETURN WITH ERROR INDICATED               */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0661
*                      IF FX = 3 & RANGINPT ^= NULLPTR             0661
*                        THEN;                                     0661
         C     FX,@CF00165                                         0661
         BNE   @RF00661                                            0661
         C     @02,RANGINPT                                        0661
         BNE   @RT00661                                            0661
*                        ELSE                                      0663
*                          DO;                                     0663
*                                                                  0663
@RF00661 DS    0H                                                  0664
*                          CALL RANGPROC(IX,NULLPARM,NULLPARM,     0664
*                            RANGINPT);                            0664
*                                                                  0664
         LA    @02,IX                                              0664
         ST    @02,@AL00001                                        0664
         LA    @02,NULLPARM                                        0664
         ST    @02,@AL00001+4                                      0664
         LA    @02,NULLPARM                                        0664
         ST    @02,@AL00001+8                                      0664
         LA    @02,RANGINPT                                        0664
         ST    @02,@AL00001+12                                     0664
         LA    @01,@AL00001                                        0664
         BAL   @14,RANGPROC                                        0664
*                          RESPECIFY RTNREG RSTD;                  0665
*                          TESTRC = RTNREG;                        0666
         LR    TESTRC,RTNREG                                       0666
*                          RESPECIFY RTNREG UNRSTD;                0667
*                          IF TESTRC ^= 0                          0668
*                            THEN                                  0668
         LTR   TESTRC,TESTRC                                       0668
         BZ    @RF00668                                            0668
*                              RETURN CODE(LASTCC12);              0669
         LA    @15,12                                              0669
         L     @14,@SA00002                                        0669
         LM    @00,@12,@SA00002+8                                  0669
         BR    @14                                                 0669
*                          END;                                    0670
@RF00668 DS    0H                                                  0671
*                      END;                                        0671
@RT00661 DS    0H                                                  0672
*                  END OBJMATCH;                                   0672
@RF00659 DS    0H                                                  0673
*              END OBJENTLP;                                       0673
*                                                                  0673
@RF00605 LA    @02,1                                               0673
         AL    @02,IX                                              0673
@DE00604 ST    @02,IX                                              0673
         L     @15,@PC00001+4                                      0673
         LA    @15,FDTPTR+8(,@15)                                  0673
         C     @02,OBJTSCNT(,@15)                                  0673
         BNH   @DL00604                                            0673
*        END OBJCTLP;                                              0674
*                                                                  0674
         AL    FX,@CF00221                                         0674
@DE00602 CH    FX,NUMCOMP                                          0674
         BNH   @DL00602                                            0674
*        /************************************************************/
*        /*                                                          */
*        /*  IF A VOLUMES LIST HAS NOT BEEN BUILT (VOLUMES           */
*        /*  WASN'T EXPORTED AND VOLUMES NOT SPECIFIED)              */
*        /*  THEN TERMINATE.                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0675
*        IF IMPF2VOL ^= ON                                         0675
*          THEN                                                    0675
@RF00601 TM    IMPF2VOL,B'10000000'                                0675
         BO    @RF00675                                            0675
*            DO;                                                   0676
*            DARGILP = LENGTH(FENTNAME);                   /*@Y30SSFR*/
         L     @15,DDSTRU                                          0677
         MVC   DARGILP(2,@15),@CH00605                             0677
*            DARGDBP = FVTPTR(1) -> CTGFVENT;              /*@Y30SSFR*/
         L     @01,FVTPTR                                          0678
         L     @14,CTGFVENT(,@01)                                  0678
         ST    @14,DARGDBP(,@15)                                   0678
*            DEFSTID = NOLISTPM;                                   0679
         MVI   DEFSTID,X'05'                                       0679
*            RETURN CODE(LASTCC12);                                0680
         LA    @15,12                                              0680
         L     @14,@SA00002                                        0680
         LM    @00,@12,@SA00002+8                                  0680
         BR    @14                                                 0680
*            END;                                                  0681
*                                                                  0681
*        /************************************************************/
*        /*                                                          */
*        /*  SET POINTER TO KEYRANGES LIST IN THE FVT IF KEYRANGES   */
*        /*  WAS SPECIFIED AS INPUT IN THE AMS IMPORT COMMAND OR     */
*        /*  IF IT WAS MODELED FROM THE EXPORTED DATA SET.  THE LIST */
*        /*  BUILT FROM AMS COMMAND INPUT WILL OVERRIDE THE LIST     */
*        /*  MODELED FROM THE EXPORTED DATA SET.                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0682
*        IF RANGINPT ^= NULLPTR                                    0682
*          THEN                                                    0682
@RF00675 L     @15,RANGINPT                                        0682
         LTR   @15,@15                                             0682
         BZ    @RF00682                                            0682
*            FVTPTR(2) -> CTGFVRNG = RANGINPT;                     0683
         L     @01,FVTPTR+4                                        0683
         ST    @15,CTGFVRNG(,@01)                                  0683
*          ELSE                                                    0684
*            IF RANGPORT ^= NULLPTR                                0684
*              THEN                                                0684
         B     @RC00682                                            0684
@RF00682 L     @15,RANGPORT                                        0684
         LTR   @15,@15                                             0684
         BZ    @RF00684                                            0684
*                FVTPTR(2) -> CTGFVRNG = RANGPORT;                 0685
*                                                                  0685
         L     @01,FVTPTR+4                                        0685
         ST    @15,CTGFVRNG(,@01)                                  0685
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  MIGRATE THE FILE INFORMATION JUST OBTAINED      @Y30SSFR*/
*        /*  FROM THE SCAN OF THE OBJECTS LIST TO THE PROPER @Y30SSFR*/
*        /*  LEVEL.  BEGIN BY TESTING TO DETERMINE IF THERE  @Y30SSFR*/
*        /*  IS FILE INFORMATION AT THE CLUSTER OR AIX       @Y30SSFR*/
*        /*  LEVEL.                                          @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0686
*        IF (FVTPTR(1) -> CTGFVIND) ^= NULLPTR             /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RF00684 DS    0H                                                  0686
@RC00682 SLR   @15,@15                                             0686
         L     @01,FVTPTR                                          0686
         L     @14,CTGFVIND(,@01)                                  0686
         CR    @14,@15                                             0686
         BE    @RF00686                                            0686
*            DO;                                           /*@Y30SSFR*/
*                                                                  0687
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  FILE INFORMATION WAS SPECIFIED AT THE       @Y30SSFR*/
*            /*  CLUSTER OR AIX LEVEL.  TEST TO DETERMINE    @Y30SSFR*/
*            /*  IF THIS INFORMATION NEEDS TO BE MIGRATED    @Y30SSFR*/
*            /*  TO THE DATA OR INDEX LEVEL.                 @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0688
*            IF (FVTPTR(2) -> CTGFVIND) = NULLPTR          /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         L     @05,FVTPTR+4                                        0688
         C     @15,CTGFVIND(,@05)                                  0688
         BNE   @RF00688                                            0688
*                FVTPTR(2) -> CTGFVIND = FVTPTR(1) ->      /*@Y30SSFR*/
*                   CTGFVIND;                              /*@Y30SSFR*/
*                                                                  0689
         ST    @14,CTGFVIND(,@05)                                  0689
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  TEST FOR THE EXISTENCE OF AN INDEX PRIOR    @Y30SSFR*/
*            /*  TO TESTING FOR THE PRESENCE OF FILE INFOR-  @Y30SSFR*/
*            /*  MATION.                                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0690
*            IF FVTPTR(3) ^= NULLPTR                       /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
@RF00688 SLR   @15,@15                                             0690
         L     @14,FVTPTR+8                                        0690
         CR    @14,@15                                             0690
         BE    @RF00690                                            0690
*                IF (FVTPTR(3) -> CTGFVIND) = NULLPTR      /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         C     @15,CTGFVIND(,@14)                                  0691
         BNE   @RF00691                                            0691
*                    FVTPTR(3) -> CTGFVIND =               /*@Y30SSFR*/
*                       FVTPTR(1) -> CTGFVIND;             /*@Y30SSFR*/
         L     @01,FVTPTR                                          0692
         L     @15,CTGFVIND(,@01)                                  0692
         ST    @15,CTGFVIND(,@14)                                  0692
*            END;                                          /*@Y30SSFR*/
*                                                                  0693
@RF00691 DS    0H                                                  0693
@RF00690 DS    0H                                                  0694
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF THERE IS STILL NO FILE INFORMATION AT THE    @Y30SSFR*/
*        /*  DATA AND INDEX LEVELS, ATTEMPT TO SUPPLY        @Y30SSFR*/
*        /*  DEFAULT INFORMATION USING THE OUTFILE PARAMETER @Y30SSFR*/
*        /*  IF THAT WAS SPECIFIED BY THE USER.              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0694
*        IF FVTPTR(2) -> CTGFVIND = NULLPTR                /*@Y30SSFR*/
*           & ADDR(OUTDD) ^= NULLPTR                       /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RF00686 SLR   @15,@15                                             0694
         L     @14,FVTPTR+4                                        0694
         C     @15,CTGFVIND(,@14)                                  0694
         BNE   @RF00694                                            0694
         L     @05,@PC00001+4                                      0694
         L     @05,FDTPTR+4(,@05)                                  0694
         CR    @05,@15                                             0694
         BE    @RF00694                                            0694
*            FVTPTR(2) -> CTGFVIND = ADDR(OUTDDVAL);       /*@Y30SSFR*/
*                                                                  0695
         LA    @15,OUTDDVAL(,@05)                                  0695
         ST    @15,CTGFVIND(,@14)                                  0695
*        IF FVTPTR(3) ^= NULLPTR                           /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RF00694 SLR   @15,@15                                             0696
         L     @14,FVTPTR+8                                        0696
         CR    @14,@15                                             0696
         BE    @RF00696                                            0696
*            IF FVTPTR(3) -> CTGFVIND = NULLPTR            /*@Y30SSFR*/
*               & ADDR(OUTDD) ^= NULLPTR                   /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         C     @15,CTGFVIND(,@14)                                  0697
         BNE   @RF00697                                            0697
         L     @05,@PC00001+4                                      0697
         L     @05,FDTPTR+4(,@05)                                  0697
         CR    @05,@15                                             0697
         BE    @RF00697                                            0697
*                FVTPTR(3) -> CTGFVIND = ADDR(OUTDDVAL);   /*@Y30SSFR*/
         LA    @15,OUTDDVAL(,@05)                                  0698
         ST    @15,CTGFVIND(,@14)                                  0698
*                                                                  0699
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  PUT THE VOLUME INFORMATION INTO THE FVTS AT     #Y30SSFR*/
*        /*  THE PROPER LEVEL--DATA AND POSSIBLY INDEX.      #Y30SSFR*/
*        /* FIRST CHECK THE DATA FVT TO SEE IF CTGFVVLT IS ZERO      */
*        /* IF IT IS- REPRODUCE THE VOLUME LIST REFERENCED FROM      */
*        /* THE CLUSTER FVT AND POINT TO IT FROM THE DATA FVT        */
*        /* IF AN INDEX FVT ALSO EXISTS DO THE SAME.         #Y30SSFR*/
*        /* IN EITHER CASE, IF THE DATA OR INDEX FVT HAS NO VOL      */
*        /* POINTER AND THERE ARE NO CLUSTER VOLUMES THIS IS A       */
*        /* TERMINAL ERROR, SET DEFSTID AND TERMINATE        #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  0699
*        IF FVTPTR(2) -> CTGFVVLT = NULLPTR                        0699
*          THEN                                                    0699
@RF00697 DS    0H                                                  0699
@RF00696 SLR   @15,@15                                             0699
         L     @01,FVTPTR+4                                        0699
         C     @15,CTGFVVLT(,@01)                                  0699
         BNE   @RF00699                                            0699
*            IF FVTPTR(1) -> CTGFVVLT = NULLPTR                    0700
*              THEN                                                0700
         L     @14,FVTPTR                                          0700
         C     @15,CTGFVVLT(,@14)                                  0700
         BNE   @RF00700                                            0700
*                DO;                                       /*@Y30SSFR*/
*                                                                  0701
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /* THERE IS NO VOL LIST FROM DATA FVT NOR IS        */
*                /* THERE ONE WE CAN MOVE DOWN FROM THE CLUSTER      */
*                /* THIS IS A TERMINAL ERROR.                #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  0702
*                DARGILP = LENGTH(FENTNAME);               /*#Y30SSFR*/
         L     @15,DDSTRU                                          0702
         MVC   DARGILP(2,@15),@CH00605                             0702
*                DARGDBP = FVTPTR(1) -> CTGFVENT;          /*#Y30SSFR*/
         L     @14,CTGFVENT(,@14)                                  0703
         ST    @14,DARGDBP(,@15)                                   0703
*                DEFSTID = NOLISTPM;                       /*#Y30SSFR*/
         MVI   DEFSTID,X'05'                                       0704
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/
*                                                                  0705
         LA    @15,12                                              0705
         L     @14,@SA00002                                        0705
         LM    @00,@12,@SA00002+8                                  0705
         BR    @14                                                 0705
*                END;                                      /*#Y30SSFR*/
*                                                                  0706
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /* THERE IS NO VOLLIST FROM DATA SO MOVE THAT AT      */
*              /* THE CLUSTER.                               @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  0707
*              ELSE                                                0707
*                DO;                                       /*@Y30SSFR*/
*                                                                  0707
@RF00700 DS    0H                                                  0708
*                TOTLEN = (FVTPTR(1) -> CTGFVVLT->FLISTLN) + 2;    0708
*                                                                  0708
         L     @03,FVTPTR                                          0708
         L     @03,CTGFVVLT(,@03)                                  0708
         LA    @15,2                                               0708
         AH    @15,FLISTLN(,@03)                                   0708
         ST    @15,TOTLEN                                          0708
*                CTGFVPTR = FVTPTR(2);                     /*@Y30SSFR*/
*                                                                  0709
         L     @03,FVTPTR+4                                        0709
         ST    @03,CTGFVPTR                                        0709
*                CALL IDCSAGP0(                                    0710
*                 GDTTBL,                                          0710
*                 TOTLEN,               /* LENGTH OF STORAGE @Y30SSFR*/
*                 CTGFVVLT,             /* ADDRESS OF STORAGE        */
*                 GPID,                                            0710
*                 SETZERO);                                /*@Y30SSFR*/
*                                                                  0710
         L     @15,@PC00001                                        0710
         ST    @15,@AL00001                                        0710
         LA    @14,TOTLEN                                          0710
         ST    @14,@AL00001+4                                      0710
         LA    @03,CTGFVVLT(,@03)                                  0710
         ST    @03,@AL00001+8                                      0710
         LA    @03,GPID                                            0710
         ST    @03,@AL00001+12                                     0710
         LA    @03,SETZERO                                         0710
         ST    @03,@AL00001+16                                     0710
         MVI   @AL00001+16,X'80'                                   0710
         L     @15,GDTGPL(,@15)                                    0710
         LA    @01,@AL00001                                        0710
         BALR  @14,@15                                             0710
*                RESPECIFY RTNREG RSTD;                            0711
*                TESTRC = RTNREG;                                  0712
         LR    TESTRC,RTNREG                                       0712
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/
*                                                                  0713
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /* STORAGE REQUEST FAILED FOR VOL LIST      @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0714
*                IF TESTRC ^= 0                                    0714
*                  THEN                                            0714
         LTR   TESTRC,TESTRC                                       0714
         BZ    @RF00714                                            0714
*                    DO;                                   /*@Y30SSFR*/
*                                                                  0715
*                    DEFSTID = NOSTORAG;                   /*@Y30SSFR*/
         MVI   DEFSTID,X'04'                                       0716
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/
         L     @01,DDSTRU                                          0717
         MVC   DARGSMOD(3,@01),@CC01023                            0717
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/
*                                                                  0718
         LA    @15,12                                              0718
         L     @14,@SA00002                                        0718
         LM    @00,@12,@SA00002+8                                  0718
         BR    @14                                                 0718
*                    END;                                  /*@Y30SSFR*/
*                                                                  0719
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /* MOVE THE VOLUME LIST FROM THE CLUSTER TO THE     */
*                /* DATA FVT VOLUME LIST CREATED BY ABOVE UGPOOL     */
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  0720
*                FVTPTR(2)->CTGFVVLT->FLISTVOL(1 : TOTLEN) =       0720
*                  FVTPTR(1) -> CTGFVVLT->FLISTVOL(1 : TOTLEN);    0720
*                                                                  0720
@RF00714 L     @15,FVTPTR+4                                        0720
         L     @01,CTGFVVLT(,@15)                                  0720
         L     @14,TOTLEN                                          0720
         BCTR  @14,0                                               0720
         L     @05,FVTPTR                                          0720
         L     @05,CTGFVVLT(,@05)                                  0720
         EX    @14,@SM01692                                        0720
*                  IF FVTPTR(2) -> CTGFVIND = NULLPTR & UNIQD = ON 0721
*                    THEN                                          0721
         L     @14,CTGFVIND(,@15)                                  0721
         LTR   @14,@14                                             0721
         BNZ   @RF00721                                            0721
         TM    UNIQD,B'10000000'                                   0721
         BNO   @RF00721                                            0721
*                      DO;                                 /*@Y30SSFR*/
*                                                                  0722
*                      /**********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* DYNAMICALLY ALLOCATE THE DATA COMPONENT  */
*                        /* VOLUMES AS REFERENCED FROM DATA FVT      */
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0723
*                        CALL DALCPROC ('A',                       0723
*                          FVTPTR(2)->CTGFVVLT,                    0723
*                          FVTPTR(2)->CTGFVIND,                    0723
*                          DALCINDX);                      /*@Y30SSFR*/
*                                                                  0723
         LA    @14,@CC00811                                        0723
         ST    @14,@AL00001                                        0723
         LA    @14,CTGFVVLT(,@15)                                  0723
         ST    @14,@AL00001+4                                      0723
         LA    @15,CTGFVIND(,@15)                                  0723
         ST    @15,@AL00001+8                                      0723
         LA    @15,DALCINDX                                        0723
         ST    @15,@AL00001+12                                     0723
         LA    @01,@AL00001                                        0723
         BAL   @14,DALCPROC                                        0723
*                        IF DEFSTID ^= NORMSTAT                    0724
*                          THEN                                    0724
         CLI   DEFSTID,0                                           0724
         BE    @RF00724                                            0724
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /* ALLOCATION FAILED FOR DATA VOLUMES   */
*                            /* LIST.                        @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                            DO;                           /*@Y30SSFR*/
*                                                                  0725
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/
         L     @01,DDSTRU                                          0726
         MVC   DARGSMOD(3,@01),@CC01038                            0726
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/
*                                                                  0727
         LA    @15,12                                              0727
         L     @14,@SA00002                                        0727
         LM    @00,@12,@SA00002+8                                  0727
         BR    @14                                                 0727
*                            END;                          /*@Y30SSFR*/
*                        END;                              /*@Y30SSFR*/
*                    END;                                  /*@Y30SSFR*/
*                ELSE                                      /*@Y30SSFR*/
*                                                                  0731
*                IF UNIQD = ON                                     0731
*                  THEN                                            0731
         B     @RC00699                                            0731
@RF00699 TM    UNIQD,B'10000000'                                   0731
         BNO   @RF00731                                            0731
*                    IF FVTPTR(2) -> CTGFVIND = NULLPTR            0732
*                      THEN                                        0732
         L     @15,FVTPTR+4                                        0732
         L     @14,CTGFVIND(,@15)                                  0732
         LTR   @14,@14                                             0732
         BNZ   @RF00732                                            0732
*                        DO;                               /*@Y30SSFR*/
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* DYNAMICALLY ALLOCATE THE DATA COMPONENT  */
*                        /* VOLUMES AS REFERENCED FROM DATA FVT      */
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0734
*                        CALL DALCPROC ('A',                       0734
*                          FVTPTR(2)->CTGFVVLT,                    0734
*                          FVTPTR(2)->CTGFVIND,                    0734
*                          DALCINDX);                      /*@Y30SSFR*/
*                                                                  0734
         LA    @14,@CC00811                                        0734
         ST    @14,@AL00001                                        0734
         LA    @14,CTGFVVLT(,@15)                                  0734
         ST    @14,@AL00001+4                                      0734
         LA    @15,CTGFVIND(,@15)                                  0734
         ST    @15,@AL00001+8                                      0734
         LA    @15,DALCINDX                                        0734
         ST    @15,@AL00001+12                                     0734
         LA    @01,@AL00001                                        0734
         BAL   @14,DALCPROC                                        0734
*                        IF DEFSTID ^= NORMSTAT                    0735
*                          THEN                                    0735
         CLI   DEFSTID,0                                           0735
         BE    @RF00735                                            0735
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /* ALLOCATION FAILED FOR DATA VOLUMES   */
*                            /* LIST.                        @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                            DO;                           /*@Y30SSFR*/
*                                                                  0736
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/
         L     @01,DDSTRU                                          0737
         MVC   DARGSMOD(3,@01),@CC01038                            0737
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/
*                                                                  0738
         LA    @15,12                                              0738
         L     @14,@SA00002                                        0738
         LM    @00,@12,@SA00002+8                                  0738
         BR    @14                                                 0738
*                            END;                          /*@Y30SSFR*/
*                        END;                              /*@Y30SSFR*/
@RF00735 DS    0H                                                  0741
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /* INDEX FVT MIGRATION - MOVE CLUSTER VOL LIST IF THERE */
*            /* IS NONE AT INDEX FVT - IF THERE IS AN INDEX FVT      */
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  0741
*            IF FVTPTR(3) ^= NULLPTR                               0741
*              THEN                                                0741
@RF00732 DS    0H                                                  0741
@RF00731 DS    0H                                                  0741
@RC00699 SLR   @15,@15                                             0741
         L     @14,FVTPTR+8                                        0741
         CR    @14,@15                                             0741
         BE    @RF00741                                            0741
*                DO;                                       /*@Y30SSFR*/
*                                                                  0742
*                IF FVTPTR(3) -> CTGFVVLT = NULLPTR                0743
*                  THEN                                            0743
         C     @15,CTGFVVLT(,@14)                                  0743
         BNE   @RF00743                                            0743
*                    IF FVTPTR(1) -> CTGFVVLT = NULLPTR            0744
*                      THEN                                        0744
*                                                                  0744
         L     @14,FVTPTR                                          0744
         C     @15,CTGFVVLT(,@14)                                  0744
         BNE   @RF00744                                            0744
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* THERE IS NO VOL LIST  AT INDEX FVT, NOR  */
*                        /* IS THERE ONE TO MOVE FROM CLUSTER. THIS  */
*                        /* IS A TERMINAL ERROR.             @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0745
*                        DO;                               /*@Y30SSFR*/
*                                                                  0745
*                        DARGILP = LENGTH(FENTNAME);       /*@OZ32365*/
         L     @15,DDSTRU                                          0746
         MVC   DARGILP(2,@15),@CH00605                             0746
*                        DARGDBP = FVTPTR(1) -> CTGFVENT;  /*@OZ32365*/
         L     @14,CTGFVENT(,@14)                                  0747
         ST    @14,DARGDBP(,@15)                                   0747
*                        DEFSTID = NOLISTPM;               /*@Y30SSFR*/
         MVI   DEFSTID,X'05'                                       0748
*                        RETURN CODE(LASTCC12);            /*@OZ32365*/
*                                                                  0749
         LA    @15,12                                              0749
         L     @14,@SA00002                                        0749
         LM    @00,@12,@SA00002+8                                  0749
         BR    @14                                                 0749
*                        END;                              /*@Y30SSFR*/
*                                                                  0750
*                      ELSE                                        0751
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* THE INDEX FVT HAS NO VOL LIST MOVE IT    */
*                        /* FROM THE CLUSTER .               @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                        DO;                               /*@Y30SSFR*/
*                                                                  0751
@RF00744 DS    0H                                                  0752
*                        TOTLEN = (FVTPTR(1)->CTGFVVLT->FLISTLN) + 2;
         L     @03,FVTPTR                                          0752
         L     @03,CTGFVVLT(,@03)                                  0752
         LA    @15,2                                               0752
         AH    @15,FLISTLN(,@03)                                   0752
         ST    @15,TOTLEN                                          0752
*                        CTGFVPTR = FVTPTR(3);             /*@Y30SSFR*/
*                                                                  0753
         L     @03,FVTPTR+8                                        0753
         ST    @03,CTGFVPTR                                        0753
*                        CALL IDCSAGP0 (GDTTBL,                    0754
*                         TOTLEN,                                  0754
*                         CTGFVVLT,                                0754
*                         GPID,                                    0754
*                         SETZERO);                        /*@Y30SSFR*/
*                                                                  0754
         L     @15,@PC00001                                        0754
         ST    @15,@AL00001                                        0754
         LA    @14,TOTLEN                                          0754
         ST    @14,@AL00001+4                                      0754
         LA    @03,CTGFVVLT(,@03)                                  0754
         ST    @03,@AL00001+8                                      0754
         LA    @03,GPID                                            0754
         ST    @03,@AL00001+12                                     0754
         LA    @03,SETZERO                                         0754
         ST    @03,@AL00001+16                                     0754
         MVI   @AL00001+16,X'80'                                   0754
         L     @15,GDTGPL(,@15)                                    0754
         LA    @01,@AL00001                                        0754
         BALR  @14,@15                                             0754
*                        RESPECIFY RTNREG RSTD;                    0755
*                        TESTRC = RTNREG;                          0756
         LR    TESTRC,RTNREG                                       0756
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSFR*/
*                                                                  0757
*                        IF TESTRC ^= 0                            0758
*                          THEN                                    0758
         LTR   TESTRC,TESTRC                                       0758
         BZ    @RF00758                                            0758
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /* STORAGE REQUEST FAILED FOR INDEX VOL */
*                            /* LIST.                        @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                            DO;                           /*@Y30SSFR*/
*                                                                  0759
*                            DEFSTID = NOSTORAG;           /*@Y30SSFR*/
         MVI   DEFSTID,X'04'                                       0760
*                            DARGSMOD = UNIVMSG;           /*@Y30SSFR*/
         L     @01,DDSTRU                                          0761
         MVC   DARGSMOD(3,@01),@CC01023                            0761
*                            RETURN CODE(LASTCC);          /*@Y30SSFR*/
*                                                                  0762
         L     @14,@PC00001+8                                      0762
         LH    @15,LASTCC(,@14)                                    0762
         L     @14,@SA00002                                        0762
         LM    @00,@12,@SA00002+8                                  0762
         BR    @14                                                 0762
*                            END;                          /*@Y30SSFR*/
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* MOVE THE VOL LIST FROM THE CLUSTER TO THE*/
*                        /* INDEX FVT VOL LIST CREATED BY ABOVE      */
*                        /* UGPOOL                           @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0764
*                        FVTPTR(3)->CTGFVVLT->FLISTVOL(1 : TOTLEN)=
*                         FVTPTR(1)->CTGFVVLT->FLISTVOL(1:TOTLEN); 0764
*                                                                  0764
@RF00758 L     @15,FVTPTR+8                                        0764
         L     @01,CTGFVVLT(,@15)                                  0764
         L     @14,TOTLEN                                          0764
         BCTR  @14,0                                               0764
         L     @05,FVTPTR                                          0764
         L     @05,CTGFVVLT(,@05)                                  0764
         EX    @14,@SM01692                                        0764
*                    IF FVTPTR(3) -> CTGFVIND = NULLPTR & UNIQI = ON
*                      THEN                                        0765
         L     @14,CTGFVIND(,@15)                                  0765
         LTR   @14,@14                                             0765
         BNZ   @RF00765                                            0765
         TM    UNIQI,B'10000000'                                   0765
         BNO   @RF00765                                            0765
*                        DO;                               /*@Y30SSFR*/
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* DYNAMICALLY ALLOCATE THE INDEX COMPONENT */
*                        /* VOLUMES AS REFERENCED FROM INDEX FVT     */
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0767
*                        CALL DALCPROC ('A',                       0767
*                          FVTPTR(3)->CTGFVVLT,                    0767
*                          FVTPTR(3)->CTGFVIND,                    0767
*                          DALCINDX);                      /*@Y30SSFR*/
*                                                                  0767
         LA    @14,@CC00811                                        0767
         ST    @14,@AL00001                                        0767
         LA    @14,CTGFVVLT(,@15)                                  0767
         ST    @14,@AL00001+4                                      0767
         LA    @15,CTGFVIND(,@15)                                  0767
         ST    @15,@AL00001+8                                      0767
         LA    @15,DALCINDX                                        0767
         ST    @15,@AL00001+12                                     0767
         LA    @01,@AL00001                                        0767
         BAL   @14,DALCPROC                                        0767
*                        IF DEFSTID ^= NORMSTAT                    0768
*                          THEN                                    0768
         CLI   DEFSTID,0                                           0768
         BE    @RF00768                                            0768
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /* ALLOCATION FAILED FOR INDEX VOLUMES  */
*                            /* LIST.                        @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                            DO;                           /*@Y30SSFR*/
*                                                                  0769
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/
         L     @01,DDSTRU                                          0770
         MVC   DARGSMOD(3,@01),@CC01038                            0770
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/
*                                                                  0771
         LA    @15,12                                              0771
         L     @14,@SA00002                                        0771
         LM    @00,@12,@SA00002+8                                  0771
         BR    @14                                                 0771
*                            END;                          /*@Y30SSFR*/
*                        END;                              /*@Y30SSFR*/
*                    END;                                  /*@Y30SSFR*/
*                  ELSE                                    /*@Y30SSFR*/
*                    IF FVTPTR(3) -> CTGFVIND = NULLPTR & UNIQI = ON
*                      THEN                                        0775
         B     @RC00743                                            0775
@RF00743 L     @15,FVTPTR+8                                        0775
         L     @14,CTGFVIND(,@15)                                  0775
         LTR   @14,@14                                             0775
         BNZ   @RF00775                                            0775
         TM    UNIQI,B'10000000'                                   0775
         BNO   @RF00775                                            0775
*                        DO;                               /*@Y30SSFR*/
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /* DYNAMICALLY ALLOCATE THE INDEX COMPONENT */
*                        /* VOLUMES AS REFERENCED FROM INDEX FVT     */
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  0777
*                        CALL DALCPROC ('A',                       0777
*                          FVTPTR(3)->CTGFVVLT,                    0777
*                          FVTPTR(3)->CTGFVIND,                    0777
*                          DALCINDX);                      /*@Y30SSFR*/
*                                                                  0777
         LA    @14,@CC00811                                        0777
         ST    @14,@AL00001                                        0777
         LA    @14,CTGFVVLT(,@15)                                  0777
         ST    @14,@AL00001+4                                      0777
         LA    @15,CTGFVIND(,@15)                                  0777
         ST    @15,@AL00001+8                                      0777
         LA    @15,DALCINDX                                        0777
         ST    @15,@AL00001+12                                     0777
         LA    @01,@AL00001                                        0777
         BAL   @14,DALCPROC                                        0777
*                        IF DEFSTID ^= NORMSTAT                    0778
*                          THEN                                    0778
         CLI   DEFSTID,0                                           0778
         BE    @RF00778                                            0778
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /* ALLOCATION FAILED FOR INDEX VOLUMES  */
*                            /* LIST.                        @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                            DO;                           /*@Y30SSFR*/
*                                                                  0779
*                            DARGSMOD = DEFMODID;          /*@Y30SSFR*/
         L     @01,DDSTRU                                          0780
         MVC   DARGSMOD(3,@01),@CC01038                            0780
*                            RETURN CODE(LASTCC12);        /*@Y30SSFR*/
*                                                                  0781
         LA    @15,12                                              0781
         L     @14,@SA00002                                        0781
         LM    @00,@12,@SA00002+8                                  0781
         BR    @14                                                 0781
*                            END;                          /*@Y30SSFR*/
*                        END;                              /*@Y30SSFR*/
@RF00778 DS    0H                                                  0784
*                END;                                      /*@Y30SSFR*/
*                                                                  0784
@RF00775 DS    0H                                                  0784
@RC00743 DS    0H                                                  0785
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /* ZERO OUT THE VOLUME LIST POINTER AT CLUSTER FVT  @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0785
*        FVTPTR(1) -> CTGFVVLT = NULLPTR;                  /*@Y30SSFR*/
*                                                                  0785
*                                                                  0785
@RF00741 L     @15,FVTPTR                                          0785
         SLR   @14,@14                                             0785
         ST    @14,CTGFVVLT(,@15)                                  0785
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SET CTGFVWKA TO POINT TO A WORK AREA FOR THE    @Y30SSFR*/
*        /*  VOLUME SERIAL NUMBER OF THE CATALOG RECOVERY    @Y30SSFR*/
*        /*  VOLUME.                                         @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0786
*        FVTPTR(1) -> CTGFVWKA = ADDR(CATRCVWK);           /*@Y30SSFR*/
*                                                                  0786
         LA    @14,CATRCVWK                                        0786
         ST    @14,CTGFVWKA(,@15)                                  0786
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  SAVE CPL, FVTS, AND FPLS PRIOR TO INVOKING CATALOG      */
*        /*  MANAGEMENT BECAUSE THESE CONTROL BLOCKS MAY BE ALTERED  */
*        /*  BY CATALOG MANAGEMENT.  IF THE OBJECT NAME IS A @Y30SSFR*/
*        /*  DUPLICATE, IT MAY BE DELETED THEN REDEFINED, IN WHICH   */
*        /*  CASE IT WILL BE NECESSARY TO RESTORE THE CONTROL BLOCKS */
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0787
*        TFVTLEN = LENGTH(CTGFV) + (LENGTH(CTGFL) + 8) * CFPLNUM + 0787
*          LENGTH(IDAAMDSB);                               /*@Y30SSFR*/
*                                                                  0787
         LH    @15,CFPLNUM                                         0787
         MH    @15,@CH00312                                        0787
         LA    @15,188(,@15)                                       0787
         STH   @15,TFVTLEN                                         0787
*        SAVCPL = PTRCPL -> FIELDR(1:LENGTH(CTGPL) + 16);  /*@Y30SSFR*/
*                                                                  0788
         L     @01,PTRCPL                                          0788
         MVC   SAVCPL(28),FIELDR(@01)                              0788
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  WHEN THE FVT'S WERE CONSTRUCTED, DOUBLE THE AREA NEEDED */
*        /*  WAS OBTAINED FOR THE FVT SAVE AREA              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0789
*        DO I = 1 TO NUMCOMP;                              /*@Y30SSFR*/
         LA    I,1                                                 0789
         B     @DE00789                                            0789
@DL00789 DS    0H                                                  0790
*          SAVFVT(I) = FVTPTR(I) + TFVTLEN;                /*@Y30SSFR*/
*                                                                  0790
         LR    @02,I                                               0790
         SLA   @02,2                                               0790
         LH    @15,TFVTLEN                                         0790
         AL    @15,FVTPTR-4(@02)                                   0790
         ST    @15,SAVFVT-4(@02)                                   0790
*          CALL MVDAPROC(TFVTLEN,FVTPTR(I),SAVFVT(I));     /*@Y30SSFR*/
*                                                                  0791
         LA    @15,TFVTLEN                                         0791
         ST    @15,@AL00001                                        0791
         LA    @15,FVTPTR-4(@02)                                   0791
         ST    @15,@AL00001+4                                      0791
         LA    @02,SAVFVT-4(@02)                                   0791
         ST    @02,@AL00001+8                                      0791
         LA    @01,@AL00001                                        0791
         BAL   @14,MVDAPROC                                        0791
*        END;                                              /*@Y30SSFR*/
*                                                                  0792
         AL    I,@CF00221                                          0792
@DE00789 CH    I,NUMCOMP                                           0792
         BNH   @DL00789                                            0792
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INVOKE CATALOG MANAGEMENT TO DEFINE THE CLUSTER @Y30SSFR*/
*        /*  OR AIX AND ITS COMPONENTS.                      @Y30SSFR*/
*        /*  SET IMPF2NER TO BE ON TO INDICATE THAT CTLGPROC @Y30SSFR*/
*        /*  IS NOT TO PRINT ANY MESSAGES FOR A VSAM         @Y30SSFR*/
*        /*  CATALOG RETURN CODE OF 8.                       @Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  0793
*        IMPF2NER = ON;                                    /*@Y30SSFR*/
         OI    IMPF2NER,B'00001000'                                0793
*        CALL CTLGPROC(PTRCPL);                            /*#Y30SSFR*/
         LA    @15,PTRCPL                                          0794
         ST    @15,@AL00001                                        0794
         LA    @01,@AL00001                                        0794
         BAL   @14,CTLGPROC                                        0794
*        RESPECIFY RTNREG RSTD;                                    0795
*        TESTRC = RTNREG;                                          0796
         LR    TESTRC,RTNREG                                       0796
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/
*                                                                  0797
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RESET IMPF2NER TO BE OFF.  ALL CATALOG ERROR    @Y30SSFR*/
*        /*  MESSAGES ARE TO BE PRINTED ON ALL OTHER CALLS   @Y30SSFR*/
*        /*  TO VSAM CATALOG MANAGEMENT.                     @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0798
*        IMPF2NER = OFF;                                   /*@Y30SSFR*/
         NI    IMPF2NER,B'11110111'                                0798
*        IF TESTRC ^= 0                                            0799
*          THEN                                                    0799
         LTR   TESTRC,TESTRC                                       0799
         BZ    @RF00799                                            0799
*DEFERR:     DO;                                           /*#Y30SSFR*/
*                                                                  0800
DEFERR   DS    0H                                                  0801
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  IF THE CATALOG RETURN CODE INDICATES A DUPLICATE    */
*            /*  ENTRY NAME EXISTS, GO INVOKE THE PROCEDURE DUPNPROC */
*            /*  TO SEE IF THE DUPLICATE ENTRY HAS THE TEMPORARY     */
*            /*  EXPORT ATTRIBUTE OR IS EMPTY.               #Y30SSFR*/
*            /*  IF THE CATALOG DEFINE FAILED FOR ANY OTHER REASON,  */
*            /*  RETURN TO THE CALLING PROCESSOR             #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0801
*            IF CATLGRC ^= DUPNAME                                 0801
*              THEN                                                0801
         CLC   CATLGRC(2),@CH00039                                 0801
         BE    @RF00801                                            0801
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/
         LA    @15,12                                              0802
         L     @14,@SA00002                                        0802
         LM    @00,@12,@SA00002+8                                  0802
         BR    @14                                                 0802
*              ELSE                                                0803
*DUPENT:         DO;                                       /*#Y30SSFR*/
*                                                                  0803
@RF00801 DS    0H                                                  0803
DUPENT   DS    0H                                                  0804
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  CALL DUPNPROC TO HANDLE DUPLICATE ENTRY #Y30SSFR*/
*                /*  PROCESSING.                             #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  0804
*                CALL DUPNPROC;                            /*#Y30SSFR*/
*                                                                  0804
         BAL   @14,DUPNPROC                                        0804
*                RESPECIFY RTNREG RSTD;                            0805
*                TESTRC = RTNREG;                                  0806
         LR    TESTRC,RTNREG                                       0806
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/
*                IF TESTRC ^= 0                                    0808
*                  THEN                                            0808
*                                                                  0808
         LTR   TESTRC,TESTRC                                       0808
         BZ    @RF00808                                            0808
*                    /************************************************/
*                    /*                                      #Y30SSFR*/
*                    /*  THE LOCATE OR DELETE OF THE DUPLICATE ENTRY */
*                    /*  HAS FAILED.  RETURN WITH ERROR INDICATED.   */
*                    /*                                      #Y30SSFR*/
*                    /************************************************/
*                                                                  0809
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/
*                                                                  0809
         LA    @15,12                                              0809
         L     @14,@SA00002                                        0809
         LM    @00,@12,@SA00002+8                                  0809
         BR    @14                                                 0809
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  TEST TO DETERMINE IF DUPNPROC FOUND A   #Y30SSFR*/
*                /*  DEFINED EMPTY DATA SET WITH ATTRIBUTES  #Y30SSFR*/
*                /*  CONSISTENT WITH THOSE OF THE DATA SET   #Y30SSFR*/
*                /*  BEING IMPORTED.  IF NOT, THEN PROCEED   #Y30SSFR*/
*                /*  TO CALL CATALOG AGAIN TO ATTEMPT        #Y30SSFR*/
*                /*  ANOTHER DEFINE.                         #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  0810
*                IF EMPTYDS = OFF                          /*#Y30SSFR*/
*                  THEN                                    /*#Y30SSFR*/
@RF00808 TM    EMPTYDS,B'10000000'                                 0810
         BNZ   @RF00810                                            0810
*DUPNM:              DO;                                   /*#Y30SSFR*/
*                                                                  0811
DUPNM    DS    0H                                                  0812
*                    /************************************************/
*                    /*                                      #Y30SSFR*/
*                    /*  THE PREVIOUSLY EXISTING ENTRY HAS   #Y30SSFR*/
*                    /*  BEEN DELETED.  RESTORE THE CPL TO   #Y30SSFR*/
*                    /*  ITS STATE PRIOR TO INVOKING         #Y30SSFR*/
*                    /*  CATALOG MANAGEMENT DEFINE.          #Y30SSFR*/
*                    /*                                      #Y30SSFR*/
*                    /************************************************/
*                                                                  0812
*                    PTRCPL -> FIELDR(1:LENGTH(CTGPL)+16)  /*#Y30SSFR*/
*                       = SAVCPL;                          /*#Y30SSFR*/
*                                                                  0812
         L     @01,PTRCPL                                          0812
         MVI   FIELDR+28(@01),C' '                                 0812
         MVC   FIELDR+29(15,@01),FIELDR+28(@01)                    0812
         MVC   FIELDR(28,@01),SAVCPL                               0812
*                    DO I = 1 TO NUMCOMP;                  /*#Y30SSFR*/
*                                                                  0813
         LA    I,1                                                 0813
         B     @DE00813                                            0813
@DL00813 DS    0H                                                  0814
*                      CALL MVDAPROC(TFVTLEN,SAVFVT(I),    /*#Y30SSFR*/
*                          FVTPTR(I));                     /*#Y30SSFR*/
*                                                                  0814
         LA    @02,TFVTLEN                                         0814
         ST    @02,@AL00001                                        0814
         LR    @02,I                                               0814
         SLA   @02,2                                               0814
         LA    @15,SAVFVT-4(@02)                                   0814
         ST    @15,@AL00001+4                                      0814
         LA    @02,FVTPTR-4(@02)                                   0814
         ST    @02,@AL00001+8                                      0814
         LA    @01,@AL00001                                        0814
         BAL   @14,MVDAPROC                                        0814
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  REINITIALIZE VOLUME SERIAL LIST   #Y30SSFR*/
*                      /*  RETURN CODE FIELDS FOR DATA AND   #Y30SSFR*/
*                      /*  INDEX COMPONENTS (IF EXISTANT).   #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  0815
*                      CTGFVPTR = FVTPTR(I);               /*#Y30SSFR*/
         LR    @02,I                                               0815
         SLA   @02,2                                               0815
         L     @02,FVTPTR-4(@02)                                   0815
         ST    @02,CTGFVPTR                                        0815
*                      IF  CTGFVVLT ^= NULLPTR             /*#Y30SSFR*/
*                        THEN                              /*#Y30SSFR*/
         L     @02,CTGFVVLT(,@02)                                  0816
         LTR   @02,@02                                             0816
         BZ    @RF00816                                            0816
*                          DO J = 1 TO                     /*#Y30SSFR*/
*                             (FLISTLN/LENGTH(FVOLSERL));  /*#Y30SSFR*/
         LA    J,1                                                 0817
         B     @DE00817                                            0817
@DL00817 DS    0H                                                  0818
*                            FVOLRTN(J) = 0;               /*#Y30SSFR*/
         LR    @15,J                                               0818
         SLA   @15,3                                               0818
         L     @01,CTGFVPTR                                        0818
         L     @01,CTGFVVLT(,@01)                                  0818
         ALR   @01,@15                                             0818
         AL    @01,@CF01694                                        0818
         SLR   @00,@00                                             0818
         STCM  @00,3,FVOLRTN-2(@01)                                0818
*                          END;                            /*#Y30SSFR*/
*                                                                  0819
         AL    J,@CF00221                                          0819
@DE00817 L     @01,CTGFVPTR                                        0819
         L     @01,CTGFVVLT(,@01)                                  0819
         LH    @00,FLISTLN(,@01)                                   0819
         SRDA  @00,32                                              0819
         D     @00,@CF00039                                        0819
         CR    J,@01                                               0819
         BNH   @DL00817                                            0819
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  IF A UNIQUE DATA SET DEFINED,     #Y30SSFR*/
*                      /*  RESTORE THE VOLUME FVT.           #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  0820
*                      IF (FVTPTR(1) -> CTGFVVCH) ^= NULLPTR       0820
*                        THEN                                      0820
@RF00816 L     @02,FVTPTR                                          0820
         L     @02,CTGFVVCH(,@02)                                  0820
         LTR   @02,@02                                             0820
         BZ    @RF00820                                            0820
*                          DO;                             /*#Y30SSFR*/
*                          IUNIQFVT = ''B;                 /*#Y30SSFR*/
         XC    IUNIQFVT(92),IUNIQFVT                               0822
*                          FVTPTR(1) -> CTGFVVCH -> CTGFVTYP       0823
*                             = CTGFVVOL;                  /*#Y30SSFR*/
         MVI   CTGFVTYP(@02),C'V'                                  0823
*                          END;                            /*#Y30SSFR*/
*                                                                  0824
*                    END;                                  /*#Y30SSFR*/
*                                                                  0825
@RF00820 AL    I,@CF00221                                          0825
@DE00813 CH    I,NUMCOMP                                           0825
         BNH   @DL00813                                            0825
*                    /************************************************/
*                    /*                                      #Y30SSFR*/
*                    /*  INVOKE CATALOG MANAGEMENT TO DEFINE #Y30SSFR*/
*                    /*  THE OBJECT.  IF DEFINE FAILS RETURN #Y30SSFR*/
*                    /*  TO CALLING PROCESSOR.               #Y30SSFR*/
*                    /*                                      #Y30SSFR*/
*                    /************************************************/
*                                                                  0826
*                    CTGPLPTR = PTRCPL;                    /*#Y30SSFR*/
*                                                                  0826
         L     @15,PTRCPL                                          0826
         ST    @15,CTGPLPTR                                        0826
*                    CALL CTLGPROC(PTRCPL);                /*#Y30SSFR*/
*                                                                  0827
         LA    @15,PTRCPL                                          0827
         ST    @15,@AL00001                                        0827
         LA    @01,@AL00001                                        0827
         BAL   @14,CTLGPROC                                        0827
*                    RESPECIFY RTNREG RSTD;                        0828
*                    TESTRC = RTNREG;                              0829
         LR    TESTRC,RTNREG                                       0829
*                    RESPECIFY RTNREG UNRSTD;              /*#Y30SSFR*/
*                    IF TESTRC ^= 0                        /*#Y30SSFR*/
*                      THEN                                /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0831
         BZ    @RF00831                                            0831
*                        RETURN CODE(LASTCC12);            /*#Y30SSFR*/
         LA    @15,12                                              0832
         L     @14,@SA00002                                        0832
         LM    @00,@12,@SA00002+8                                  0832
         BR    @14                                                 0832
*                    END DUPNM;                            /*#Y30SSFR*/
@RF00831 DS    0H                                                  0834
*              END DUPENT;                                 /*#Y30SSFR*/
@RF00810 DS    0H                                                  0835
*            END DEFERR;                                   /*#Y30SSFR*/
*                                                                  0835
*        IF EMPTYDS = OFF                                  /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
@RF00799 TM    EMPTYDS,B'10000000'                                 0836
         BNZ   @RF00836                                            0836
*NEMPDS:     DO;                                           /*#Y30SSFR*/
*                                                                  0837
NEMPDS   DS    0H                                                  0838
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  CHECK TO SEE IF A RECOVERY VOLSER HAS BEEN  #Y30SSFR*/
*            /*  RETURNED BY CATALOG.  IF SO, PRINT IT.      #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0838
*            DARGSMOD = DEFMODID;                          /*#Y30SSFR*/
         L     @15,DDSTRU                                          0838
         MVC   DARGSMOD(3,@15),@CC01038                            0838
*            IF CATRCWKA ^= ZEROS                          /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         CLC   CATRCWKA(6),ZEROS                                   0839
         BE    @RF00839                                            0839
*                DO;                                       /*#Y30SSFR*/
*                DARGSENT = RCVYVOLM;                      /*#Y30SSFR*/
         MVI   DARGSENT(@15),X'15'                                 0841
*                DARGILP = LENGTH(CATRCWKA);               /*#Y30SSFR*/
         MVC   DARGILP(2,@15),@CH00159                             0842
*                DARGDBP = ADDR(CATRCWKA);                 /*#Y30SSFR*/
*                                                                  0843
         LA    @14,CATRCWKA                                        0843
         ST    @14,DARGDBP(,@15)                                   0843
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*#Y30SSFR*/
*                                                                  0844
         L     @15,@PC00001                                        0844
         ST    @15,@AL00001                                        0844
         LA    @14,@CF00118                                        0844
         ST    @14,@AL00001+4                                      0844
         LA    @14,DDSTRU                                          0844
         ST    @14,@AL00001+8                                      0844
         MVI   @AL00001+8,X'80'                                    0844
         L     @15,GDTPRT(,@15)                                    0844
         LA    @01,@AL00001                                        0844
         BALR  @14,@15                                             0844
*                END;                                      /*#Y30SSFR*/
*                                                                  0845
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  CLUSTER HAS BEEN DEFINED SUCCESSFULLY.      #Y30SSFR*/
*            /*  ISSUE ALLOCATION MESSAGES                   #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0846
*            DARGSENT = VOLDATA;                           /*#Y30SSFR*/
@RF00839 L     @01,DDSTRU                                          0846
         MVI   DARGSENT(@01),X'09'                                 0846
*            CTGFVPTR = CTGFVT -> CTGFVDCH;                /*#Y30SSFR*/
*                                                                  0847
         L     @01,CTGPLPTR                                        0847
         L     @01,CTGFVT(,@01)                                    0847
         L     @15,CTGFVDCH(,@01)                                  0847
         ST    @15,CTGFVPTR                                        0847
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  FIRST ISSUE THE VOLUME ALLOCATION MESSAGE   #Y30SSFR*/
*            /*  FOR THE DATA COMPONENT AND THEN FOR THE     #Y30SSFR*/
*            /*  INDEX IF ANY EXISTS.  ONE CALL TO THE TEXT  #Y30SSFR*/
*            /*  PROCESSOR WILL PRINT THE ENTIRE VOLUME      #Y30SSFR*/
*            /*  FOR ONE COMPONENT.                          #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0848
*            DO I = 2 TO NUMCOMP;                          /*#Y30SSFR*/
         LA    I,2                                                 0848
         B     @DE00848                                            0848
@DL00848 DS    0H                                                  0849
*              IF CTGFVVLT ^= NULLPTR                              0849
*                THEN                                              0849
         L     @02,CTGFVPTR                                        0849
         L     @02,CTGFVVLT(,@02)                                  0849
         LTR   @02,@02                                             0849
         BZ    @RF00849                                            0849
*                  DO;                                     /*#Y30SSFR*/
*                  DARGDBP = CTGFVVLT + 2;                 /*#Y30SSFR*/
         L     @15,DDSTRU                                          0851
         LA    @14,2                                               0851
         ALR   @14,@02                                             0851
         ST    @14,DARGDBP(,@15)                                   0851
*                  DARGILP = CTGFVVLT -> FLISTLN;          /*#Y30SSFR*/
         LH    @02,FLISTLN(,@02)                                   0852
         STH   @02,DARGILP(,@15)                                   0852
*                  DARGCNT = 1;                            /*#Y30SSFR*/
         LA    @14,1                                               0853
         STH   @14,DARGCNT(,@15)                                   0853
*                  DARGINS(1) = 1;                         /*#Y30SSFR*/
         STH   @14,DARGINS(,@15)                                   0854
*                  DARGPCT(1) = DARGILP/8;                 /*#Y30SSFR*/
*                                                                  0855
         LR    @00,@02                                             0855
         SRDA  @00,32                                              0855
         D     @00,@CF00039                                        0855
         STH   @01,DARGPCT(,@15)                                   0855
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   /*#Y30SSFR*/
*                                                                  0856
         L     @02,@PC00001                                        0856
         ST    @02,@AL00001                                        0856
         LA    @15,@CF00118                                        0856
         ST    @15,@AL00001+4                                      0856
         LA    @15,DDSTRU                                          0856
         ST    @15,@AL00001+8                                      0856
         MVI   @AL00001+8,X'80'                                    0856
         L     @15,GDTPRT(,@02)                                    0856
         LA    @01,@AL00001                                        0856
         BALR  @14,@15                                             0856
*                  END;                                    /*#Y30SSFR*/
*              CTGFVPTR = CTGFVT -> CTGFVICH;              /*#Y30SSFR*/
@RF00849 L     @02,CTGPLPTR                                        0858
         L     @02,CTGFVT(,@02)                                    0858
         L     @02,CTGFVICH(,@02)                                  0858
         ST    @02,CTGFVPTR                                        0858
*              DARGSENT = VOLINDEX;                        /*#Y30SSFR*/
         L     @02,DDSTRU                                          0859
         MVI   DARGSENT(@02),X'0A'                                 0859
*            END;                                          /*#Y30SSFR*/
*                                                                  0860
         AL    I,@CF00221                                          0860
@DE00848 CH    I,NUMCOMP                                           0860
         BNH   @DL00848                                            0860
*            END NEMPDS;                                   /*#Y30SSFR*/
*                                                                  0861
*        DARGSMOD=IMPMSG;                                  /*#Y30SSFR*/
*                                                                  0862
@RF00836 L     @01,DDSTRU                                          0862
         MVC   DARGSMOD(3,@01),@CC01000                            0862
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /* DEALLOCATE VOLUMES WHICH HAVE BEEN DYNAMICALLY ALLOCATED */
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  0863
*        IF DALCINDX > 0                                           0863
*          THEN                                                    0863
*                                                                  0863
         L     @15,DALCINDX                                        0863
         LTR   @15,@15                                             0863
         BNP   @RF00863                                            0863
*            CALL DALCPROC ('D',                                   0864
*                            NULLPARM,NULLPARM,DALCINDX);  /*#Y30SSFR*/
*                                                                  0864
         MVC   @AL00001(12),@AL00864                               0864
         LA    @15,DALCINDX                                        0864
         ST    @15,@AL00001+12                                     0864
         LA    @01,@AL00001                                        0864
         BAL   @14,DALCPROC                                        0864
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  ATTEMPT TO QUALIFY THE OUTPUT DATA SET NAME,    @Y30SSFR*/
*        /*  IF NECESSARY.                                   @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  0865
*        IF OUTDSFUQ = ON & ADDR(OUTDS) ^= NULLPTR                 0865
*          THEN                                                    0865
@RF00863 L     @15,@PC00001+4                                      0865
         L     @15,FDTPTR+96(,@15)                                 0865
         TM    OUTDSFUQ(@15),B'10000000'                           0865
         BNO   @RF00865                                            0865
         LTR   @15,@15                                             0865
         BZ    @RF00865                                            0865
*            DO;                                           /*@Y30SSFR*/
*            QUALLIST = ''B;                               /*@Y30SSFR*/
         XC    QUALLIST(12),QUALLIST                               0867
*            QUALADDR = ADDR(OUTDSNAM);                    /*@Y30SSFR*/
         LA    @14,OUTDSNAM                                        0868
         ST    @14,QUALADDR                                        0868
*            IF OUTDSPLN ^= NULLPTR                                0869
*              THEN                                                0869
         CLI   OUTDSPLN(@15),0                                     0869
         BE    @RF00869                                            0869
*                QUALPAS = ADDR(OUTDSPAS);                 /*@Y30SSFR*/
*                                                                  0870
         LA    @15,OUTDSPAS(,@15)                                  0870
         ST    @15,QUALPAS                                         0870
*            CALL IDCSAQL0(GDTTBL,QUALADDR,OUTDSNLN,QUALCAT,QUALPAS);
@RF00869 L     @03,@PC00001                                        0871
         ST    @03,@AL00001                                        0871
         LA    @15,QUALADDR                                        0871
         ST    @15,@AL00001+4                                      0871
         LA    @15,OUTDSNLN                                        0871
         ST    @15,@AL00001+8                                      0871
         LA    @15,QUALCAT                                         0871
         ST    @15,@AL00001+12                                     0871
         LA    @15,QUALPAS                                         0871
         ST    @15,@AL00001+16                                     0871
         MVI   @AL00001+16,X'80'                                   0871
         L     @15,GDTQAL(,@03)                                    0871
         LA    @01,@AL00001                                        0871
         BALR  @14,@15                                             0871
*                                                          /*@Y30SSFR*/
*            RESPECIFY RTNREG RSTD;                                0872
*            TESTRC = RTNREG;                                      0873
         LR    TESTRC,RTNREG                                       0873
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*            IF TESTRC ^= 0                                        0875
*              THEN                                                0875
         LTR   TESTRC,TESTRC                                       0875
         BZ    @RF00875                                            0875
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
         LA    @15,12                                              0876
         L     @14,@SA00002                                        0876
         LM    @00,@12,@SA00002+8                                  0876
         BR    @14                                                 0876
*            END;                                          /*@Y30SSFR*/
*                                                                  0877
@RF00875 DS    0H                                                  0878
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  ALLOCATE THE CLUSTER IF                         #Y30SSFR*/
*        /*  IT WAS NOT ALLOCATED BY JCL                     #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  0878
*        IF ADDR(OUTDS) ^= NULLPTR                                 0878
*          THEN                                                    0878
@RF00865 L     @15,@PC00001+4                                      0878
         L     @15,FDTPTR+96(,@15)                                 0878
         LTR   @15,@15                                             0878
         BZ    @RF00878                                            0878
*            DO;                                           /*#Y30SSFR*/
*              ALLPTR = ADDR(ALLLIST);                     /*#Y30SSFR*/
         LA    @14,ALLLIST                                         0880
         ST    @14,ALLPTR                                          0880
*              ALLAGL = ''B;                               /*#Y30SSFR*/
         XC    ALLAGL(31,@14),ALLAGL(@14)                          0881
*              ALLDSN = ADDR(OUTDSNAM);                    /*#Y30SSFR*/
         LA    @05,OUTDSNAM                                        0882
         ST    @05,ALLDSN(,@14)                                    0882
*              IF OUTDSPLN ^= 0                                    0883
*                THEN                                              0883
         CLI   OUTDSPLN(@15),0                                     0883
         BE    @RF00883                                            0883
*                  ALLPWD = ADDR(OUTDSPAS);                /*#Y30SSFR*/
         LA    @15,OUTDSPAS(,@15)                                  0884
         ST    @15,ALLPWD(,@14)                                    0884
*              ALLOPTVL = OFF;                             /*#Y30SSFR*/
@RF00883 DS    0H                                                  0886
*              ALLOPTDS = ON;                              /*#Y30SSFR*/
         L     @03,ALLPTR                                          0886
         OI    ALLOPTDS(@03),B'01000000'                           0886
         NI    ALLOPTVL(@03),B'01111111'                           0886
*              ALLSTSOD = ON;                              /*#Y30SSFR*/
         OI    ALLSTSOD(@03),B'00000001'                           0887
*              ALLDSPKP = ON;                              /*#Y30SSFR*/
         OI    ALLDSPKP(@03),B'00001000'                           0888
*              CALL IDCSAAL0(GDTTBL,ALLAGL);               /*#Y30SSFR*/
         L     @15,@PC00001                                        0889
         ST    @15,@AL00001                                        0889
         ST    @03,@AL00001+4                                      0889
         MVI   @AL00001+4,X'80'                                    0889
         L     @15,GDTALC(,@15)                                    0889
         LA    @01,@AL00001                                        0889
         BALR  @14,@15                                             0889
*              RESPECIFY RTNREG RSTD;                              0890
*              TESTRC = RTNREG;                                    0891
         LR    TESTRC,RTNREG                                       0891
*              RESPECIFY RTNREG UNRSTD;                    /*#Y30SSFR*/
*              IF TESTRC = 0                                       0893
*                THEN                                              0893
         LTR   TESTRC,TESTRC                                       0893
         BNZ   @RF00893                                            0893
*                    DEALLOC = ON;                         /*#Y30SSFR*/
         OI    DEALLOC,B'10000000'                                 0894
*                ELSE                                              0895
*                  RETURN CODE(LASTCC12);                  /*#Y30SSFR*/
         B     @RC00893                                            0895
@RF00893 LA    @15,12                                              0895
         L     @14,@SA00002                                        0895
         LM    @00,@12,@SA00002+8                                  0895
         BR    @14                                                 0895
*            END;                                          /*#Y30SSFR*/
*                                                                  0896
@RC00893 DS    0H                                                  0897
*        /*                                                  @Z40RSSA*/
*        /*  IF DUPNPROC FOUND AN EMPTY DATA SET, DETERMINE  @Z40RSSA*/
*        /* IF THE 'INTOEMPTY' PARAMETER WAS USED.  IF NOT   @Z40RSSA*/
*        /*  ISSUE AN ERROR MESSAGE.                         @Z40RSSA*/
*        /*                                                  @Z40RSSA*/
*        IF EMPTYDS = ON & ADDR (IMPTY) = 0 THEN           /*@Z40RSSA*/
@RF00878 TM    EMPTYDS,B'10000000'                                 0897
         BNO   @RF00897                                            0897
         L     @15,@PC00001+4                                      0897
         L     @15,FDTPTR+132(,@15)                                0897
         LTR   @15,@15                                             0897
         BNZ   @RF00897                                            0897
*              DO;                                         /*@Z40RSSA*/
*                DARGLIST = ''B;                           /*@Z40RSSA*/
         L     @15,DDSTRU                                          0899
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0899
*                DARGSMOD = IMPMSG;                        /*@Z40RSSA*/
         MVC   DARGSMOD(3,@15),@CC01000                            0900
*                DARGSENT = NEMPTYKW;                      /*@Z40RSSA*/
         MVI   DARGSENT(@15),X'19'                                 0901
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Z40RSSA*/
         L     @15,@PC00001                                        0902
         ST    @15,@AL00001                                        0902
         LA    @14,@CF00118                                        0902
         ST    @14,@AL00001+4                                      0902
         LA    @14,DDSTRU                                          0902
         ST    @14,@AL00001+8                                      0902
         MVI   @AL00001+8,X'80'                                    0902
         L     @15,GDTPRT(,@15)                                    0902
         LA    @01,@AL00001                                        0902
         BALR  @14,@15                                             0902
*                RETURN CODE(LASTCC12);                    /*@Z40RSSA*/
         LA    @15,12                                              0903
         L     @14,@SA00002                                        0903
         LM    @00,@12,@SA00002+8                                  0903
         BR    @14                                                 0903
*              END;                                        /*@Z40RSSA*/
*                                                                  0904
*        /************************************************************/
*        /*  LOOP DEFINING THE PATHS THAT WERE EXPORTED WITH #Y30SSFR*/
*        /*  THE DATA SET.  SHOULD ANY CMS DEFINE FAIL,      #Y30SSFR*/
*        /*  SIMPLY GO ON TO THE NEXT PATH.                  #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  0905
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  TEST FOR THE PRESENCE OF PATH ASSOCIATIONS ON   #Y30SSFR*/
*        /*  THE PORTABILITY DATA SET.                       #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  0905
*        IF IMPASSOC = ON                                  /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
@RF00897 TM    IMPASSOC,B'00100000'                                0905
         BNO   @RF00905                                            0905
*PATHDEF:    DO;                                           /*#Y30SSFR*/
*                                                                  0906
PATHDEF  DS    0H                                                  0907
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  BUILD AND SAVE THE CPL USED TO DEFINE       #Y30SSFR*/
*            /*  ALL OF THE PATHS ON THE PORTABILITY         #Y30SSFR*/
*            /*  DATA SET.                                   #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0907
*            CALL CPLPROC('F',PPTRCPL,NULLPARM,NULLPARM,   /*#Y30SSFR*/
*               NULLPARM);                                 /*#Y30SSFR*/
*                                                                  0907
         MVC   @AL00001(20),@AL00907                               0907
         LA    @15,PPTRCPL                                         0907
         ST    @15,@AL00001+4                                      0907
         LA    @01,@AL00001                                        0907
         BAL   @14,CPLPROC                                         0907
*            RESPECIFY RTNREG RSTD;                                0908
*            TESTRC = RTNREG;                                      0909
         LR    TESTRC,RTNREG                                       0909
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/
*                                                                  0910
*            IF TESTRC ^= 0                                /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0911
         BZ    @RF00911                                            0911
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/
*                                                                  0912
         LA    @15,12                                              0912
         L     @14,@SA00002                                        0912
         LM    @00,@12,@SA00002+8                                  0912
         BR    @14                                                 0912
*            CTGPLPTR = PPTRCPL;                           /*#Y30SSFR*/
@RF00911 L     @15,PPTRCPL                                         0913
         ST    @15,CTGPLPTR                                        0913
*            PSAVCPL = CTGPL;                              /*#Y30SSFR*/
*                                                                  0914
         MVC   PSAVCPL(28),CTGPL(@15)                              0914
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET THE TOTAL LENGTH OF THE WORK AREA TO 0, #Y30SSFR*/
*            /*  AND TURN OFF THE FLAG INDICATING THAT CORE  #Y30SSFR*/
*            /*  HAS BEEN GOTTEN FOR IT.                     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0915
*            TOTLEN = 0;                                   /*#Y30SSFR*/
         SLR   @15,@15                                             0915
         ST    @15,TOTLEN                                          0915
*            PCOREFLG = OFF;                               /*#Y30SSFR*/
*                                                                  0916
         NI    PCOREFLG,B'01111111'                                0916
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  DEFINE EACH PATH FROM THE PORTABILITY DATA  #Y30SSFR*/
*            /*  SET.  SHOULD ANY DEFINE FAIL, GO ON TO THE  #Y30SSFR*/
*            /*  NEXT PATH.                                  #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  0917
*PATHLOOP:   DO I = NUMCOMP+1 TO NUMOBJ;                   /*#Y30SSFR*/
*                                                                  0917
PATHLOOP LA    I,1                                                 0917
         AH    I,NUMCOMP                                           0917
         B     @DE00917                                            0917
@DL00917 DS    0H                                                  0918
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  RESET THE FLAG THAT INDICATES THE CATALOG #Y30SSFR*/
*              /*  DEFINE OPERATION IS TO BE SKIPPED         #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  0918
*              IMPF2NOD = OFF;                             /*#Y30SSFR*/
*                                                                  0918
         NI    IMPF2NOD,B'11101111'                                0918
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  RESTORE THE CPL AND READ IN THE CONTROL   #Y30SSFR*/
*              /*  RECORD FOR THE PATH TO BE DEFINED.        #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  0919
*              CTGPL = PSAVCPL;                            /*#Y30SSFR*/
*                                                                  0919
         L     @01,CTGPLPTR                                        0919
         MVC   CTGPL(28,@01),PSAVCPL                               0919
*              CALL IDCIOGT0(GDTTBL,PINIOCS);              /*#Y30SSFR*/
*                                                                  0920
         L     @15,@PC00001                                        0920
         ST    @15,@AL00001                                        0920
         LA    @14,PINIOCS                                         0920
         ST    @14,@AL00001+4                                      0920
         MVI   @AL00001+4,X'80'                                    0920
         L     @15,GDTGET(,@15)                                    0920
         LA    @01,@AL00001                                        0920
         BALR  @14,@15                                             0920
*              RESPECIFY RTNREG RSTD;                              0921
*              TESTRC = RTNREG;                                    0922
         LR    TESTRC,RTNREG                                       0922
*              RESPECIFY RTNREG UNRSTD;                    /*#Y30SSFR*/
*                                                                  0923
*              IF TESTRC ^= 0                              /*#Y30SSFR*/
*                THEN                                      /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0924
         BZ    @RF00924                                            0924
*                  RETURN CODE(LASTCC12);                  /*#Y30SSFR*/
*                                                                  0925
         LA    @15,12                                              0925
         L     @14,@SA00002                                        0925
         LM    @00,@12,@SA00002+8                                  0925
         BR    @14                                                 0925
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  MOVE THE CONTROL RECORD                   #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  0926
*              TFVTLEN = IOCDAD -> HEADLN;                 /*#Y30SSFR*/
*                                                                  0926
@RF00924 L     @02,IOCSPTR                                         0926
         L     @01,IOCDAD(,@02)                                    0926
         LH    @15,HEADLN(,@01)                                    0926
         STH   @15,TFVTLEN                                         0926
*              CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);     /*#Y30SSFR*/
*                                                                  0927
         LA    @15,TFVTLEN                                         0927
         ST    @15,@AL00001                                        0927
         ST    @02,@AL00001+4                                      0927
         LA    @02,CONRCPTR                                        0927
         ST    @02,@AL00001+8                                      0927
         LA    @01,@AL00001                                        0927
         BAL   @14,MVDAPROC                                        0927
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  TEST THE HEADER FLAG TO MAKE SURE THAT    #Y30SSFR*/
*              /*  WE HAVE A CATALOG RECORD.                 #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  0928
*              IF HEADFLG1 = HDFL1CAT                      /*#Y30SSFR*/
*                THEN                                      /*#Y30SSFR*/
         L     @02,CONRCPTR                                        0928
         CLI   HEADFLG1(@02),X'FF'                                 0928
         BNE   @RF00928                                            0928
*CATHDFLG:         DO;                                     /*#Y30SSFR*/
*                                                                  0929
CATHDFLG DS    0H                                                  0930
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  GET STORAGE FOR THE CATALOG WORK AREA #Y30SSFR*/
*                  /*  IF THE CURRENT WORK AREA IS TOO SMALL #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  0930
*                  IF ASSRECLN > TOTLEN                            0930
*                    THEN                                          0930
         L     @02,CONRCPTR                                        0930
         LH    @02,ASSRECLN(,@02)                                  0930
         C     @02,TOTLEN                                          0930
         BNH   @RF00930                                            0930
*                      DO;                                 /*#Y30SSFR*/
*                                                                  0931
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  IF CORE HAS BEEN GOTTEN FOR THE   #Y30SSFR*/
*                      /*  WORK AREA PREVIOUSLY, FREE IT.    #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  0932
*                      IF PCOREFLG = ON                            0932
*                        THEN                                      0932
         TM    PCOREFLG,B'10000000'                                0932
         BNO   @RF00932                                            0932
*                          CALL IDCSAFS0(GDTTBL,PWORKAR);  /*#Y30SSFR*/
*                                                                  0933
         L     @02,@PC00001                                        0933
         ST    @02,@AL00001                                        0933
         LA    @15,PWORKAR                                         0933
         ST    @15,@AL00001+4                                      0933
         L     @15,GDTFSP(,@02)                                    0933
         LA    @01,@AL00001                                        0933
         BALR  @14,@15                                             0933
*                      PCOREFLG = ON;                      /*#Y30SSFR*/
@RF00932 OI    PCOREFLG,B'10000000'                                0934
*                      TOTLEN = ASSRECLN;                  /*#Y30SSFR*/
*                                                                  0935
         L     @01,CONRCPTR                                        0935
         LH    @15,ASSRECLN(,@01)                                  0935
         ST    @15,TOTLEN                                          0935
*                      CALL IDCSAGP0(GDTTBL,TOTLEN,PWORKAR,GPID,/* 0936
*                                                            #Y30SSFR*/
*                       SETZERO);                          /*#Y30SSFR*/
*                                                                  0936
         L     @15,@PC00001                                        0936
         ST    @15,@AL00001                                        0936
         LA    @14,TOTLEN                                          0936
         ST    @14,@AL00001+4                                      0936
         LA    @14,PWORKAR                                         0936
         ST    @14,@AL00001+8                                      0936
         LA    @14,GPID                                            0936
         ST    @14,@AL00001+12                                     0936
         LA    @14,SETZERO                                         0936
         ST    @14,@AL00001+16                                     0936
         MVI   @AL00001+16,X'80'                                   0936
         L     @15,GDTGPL(,@15)                                    0936
         LA    @01,@AL00001                                        0936
         BALR  @14,@15                                             0936
*                      RESPECIFY RTNREG RSTD;                      0937
*                      TESTRC = RTNREG;                            0938
         LR    TESTRC,RTNREG                                       0938
*                      RESPECIFY RTNREG UNRSTD;            /*#Y30SSFR*/
*                                                                  0939
*                      IF TESTRC ^= 0                      /*#Y30SSFR*/
*                        THEN                              /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0940
         BZ    @RF00940                                            0940
*                          DO;                             /*#Y30SSFR*/
*                          DARGSMOD = UNIVMSG;             /*#Y30SSFR*/
         L     @01,DDSTRU                                          0942
         MVC   DARGSMOD(3,@01),@CC01023                            0942
*                          DEFSTID = NOSTORAG;             /*#Y30SSFR*/
         MVI   DEFSTID,X'04'                                       0943
*                          RETURN CODE(LASTCC12);          /*#Y30SSFR*/
         LA    @15,12                                              0944
         L     @14,@SA00002                                        0944
         LM    @00,@12,@SA00002+8                                  0944
         BR    @14                                                 0944
*                          END;                            /*#Y30SSFR*/
*                                                                  0945
*                      END;                                /*#Y30SSFR*/
*                                                                  0946
@RF00940 DS    0H                                                  0947
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  READ IN THE CATALOG WORK AREA AND     #Y30SSFR*/
*                  /*  CALL FVTPROC TO BUILD THE FVT AND     #Y30SSFR*/
*                  /*  FPL'S NEEDED TO DO THE DEFINE.        #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  0947
*                  CALL GETPROC(PWORKAR,ASSRECLN);         /*#Y30SSFR*/
*                                                                  0947
@RF00930 LA    @02,PWORKAR                                         0947
         ST    @02,@AL00001                                        0947
         L     @02,CONRCPTR                                        0947
         LA    @02,ASSRECLN(,@02)                                  0947
         ST    @02,@AL00001+4                                      0947
         LA    @01,@AL00001                                        0947
         BAL   @14,GETPROC                                         0947
*                  RESPECIFY RTNREG RSTD;                          0948
*                  TESTRC = RTNREG;                                0949
         LR    TESTRC,RTNREG                                       0949
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/
*                                                                  0950
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0951
         BZ    @RF00951                                            0951
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/
*                                                                  0952
         LA    @15,12                                              0952
         L     @14,@SA00002                                        0952
         LM    @00,@12,@SA00002+8                                  0952
         BR    @14                                                 0952
*                  DICTPTR = ADDR(VARDATA);                /*#Y30SSFR*/
*                                                                  0953
@RF00951 L     @02,CONRCPTR                                        0953
         LA    @02,VARDATA(,@02)                                   0953
         ST    @02,DICTPTR                                         0953
*                  CALL FVTPROC(DICTPTR,PWORKAR,PFVTPTR);  /*#Y30SSFR*/
*                                                                  0954
         LA    @02,DICTPTR                                         0954
         ST    @02,@AL00001                                        0954
         LA    @02,PWORKAR                                         0954
         ST    @02,@AL00001+4                                      0954
         LA    @02,PFVTPTR                                         0954
         ST    @02,@AL00001+8                                      0954
         LA    @01,@AL00001                                        0954
         BAL   @14,FVTPROC                                         0954
*                  RESPECIFY RTNREG RSTD;                          0955
*                  TESTRC = RTNREG;                                0956
         LR    TESTRC,RTNREG                                       0956
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/
*                                                                  0957
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0958
         BZ    @RF00958                                            0958
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/
*                                                                  0959
         LA    @15,12                                              0959
         L     @14,@SA00002                                        0959
         LM    @00,@12,@SA00002+8                                  0959
         BR    @14                                                 0959
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  SET THE POINTER TO FVT IN THE CPL     #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  0960
*                  CTGFVT = PFVTPTR;                       /*#Y30SSFR*/
@RF00958 L     @02,PFVTPTR                                         0960
         L     @01,CTGPLPTR                                        0960
         ST    @02,CTGFVT(,@01)                                    0960
*                  CTGFVPTR = PFVTPTR;                     /*#Y30SSFR*/
*                                                                  0961
         ST    @02,CTGFVPTR                                        0961
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  SCAN THE OBJECTS LIST FOR A MATCH TO  #Y30SSFR*/
*                  /*  THE PATH BEING DEFINED.               #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  0962
*POBJLOOP:         DO IX = 1 TO OBJTSCNT;                  /*#Y30SSFR*/
*                                                                  0962
POBJLOOP LA    @02,1                                               0962
         B     @DE00962                                            0962
@DL00962 DS    0H                                                  0963
*                    IF OBJNMPTR(IX) -> OBJNMVAL(1:44) =   /*#Y30SSFR*/
*                       FENTNAME(1:44)                     /*#Y30SSFR*/
*                      THEN                                /*#Y30SSFR*/
         SLA   @02,2                                               0963
         L     @15,@PC00001+4                                      0963
         L     @01,FDTPTR+12(,@15)                                 0963
         AL    @01,@CF01689                                        0963
         L     @01,OBJNMPTR(@02,@01)                               0963
         L     @14,CTGFVPTR                                        0963
         L     @05,CTGFVENT(,@14)                                  0963
         CLC   OBJNMVAL(44,@01),FENTNAME(@05)                      0963
         BNE   @RF00963                                            0963
*                        DO;                               /*#Y30SSFR*/
*                                                                  0964
*                        /********************************************/
*                        /*                                  #Y30SSFR*/
*                        /*  TEST FOR A NEWNAME AND SET THE  #Y30SSFR*/
*                        /*  APPROPRIATE POINTER IF ONE IS   #Y30SSFR*/
*                        /*  PRESENT.                        #Y30SSFR*/
*                        /*                                  #Y30SSFR*/
*                        /********************************************/
*                                                                  0965
*                        IF NEWNMPTR(IX) ^= NULLPTR        /*#Y30SSFR*/
*                          THEN                            /*#Y30SSFR*/
         L     @01,FDTPTR+16(,@15)                                 0965
         AL    @01,@CF01689                                        0965
         L     @02,NEWNMPTR(@02,@01)                               0965
         LTR   @02,@02                                             0965
         BZ    @RF00965                                            0965
*                            CTGFVENT = ADDR(NEWNMPTR(IX)->/*#Y30SSFR*/
*                               NEWNMVAL);                 /*#Y30SSFR*/
         LA    @02,NEWNMVAL(,@02)                                  0966
         ST    @02,CTGFVENT(,@14)                                  0966
*                          ELSE                            /*#Y30SSFR*/
*                                                                  0967
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /*  TEST FOR THE PRESENCE OF    @Y30SSFR*/
*                            /*  THE FILE PARAMETER.  IF     @Y30SSFR*/
*                            /*  SPECIFIED, SET A POINTER    @Y30SSFR*/
*                            /*  TO IT IN THE FVT.           @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                                                                  0967
*                            IF OBJFLPTR(IX) ^= NULLPTR    /*@Y30SSFR*/
*                              THEN                        /*@Y30SSFR*/
         B     @RC00965                                            0967
@RF00965 L     @02,IX                                              0967
         SLA   @02,2                                               0967
         L     @15,@PC00001+4                                      0967
         L     @01,FDTPTR+20(,@15)                                 0967
         AL    @01,@CF01689                                        0967
         L     @02,OBJFLPTR(@02,@01)                               0967
         LTR   @02,@02                                             0967
         BZ    @RF00967                                            0967
*                                CTGFVIND = ADDR(          /*@Y30SSFR*/
*                                  OBJFLPTR(IX)->OBJFLVAL);/*@Y30SSFR*/
*                                                                  0968
         LA    @02,OBJFLVAL(,@02)                                  0968
         L     @01,CTGFVPTR                                        0968
         ST    @02,CTGFVIND(,@01)                                  0968
*                              ELSE                        /*@Y30SSFR*/
*                                DO;                       /*#Y30SSFR*/
*                                                                  0969
         B     @RC00967                                            0969
@RF00967 DS    0H                                                  0970
*                                /************************************/
*                                /*                          @Y30SSFR*/
*                                /*  THE PRESENCE OF ANY     @Y30SSFR*/
*                                /*  OTHER OBJECTS SUBPARA-  @Y30SSFR*/
*                                /*  METER IS AN ERROR.      @Y30SSFR*/
*                                /*  PRINT A MESSAGE, AND    @Y30SSFR*/
*                                /*  INDICATE THAT NO        @Y30SSFR*/
*                                /*  ATTEMPT WILL BE MADE    @Y30SSFR*/
*                                /*  TO DEFINE THE PATH.     @Y30SSFR*/
*                                /*                          @Y30SSFR*/
*                                /************************************/
*                                                                  0970
*                                IMPF2NOD = ON;            /*#Y30SSFR*/
         OI    IMPF2NOD,B'00010000'                                0970
*                                DARGSENT = BADOBJPM;      /*#Y30SSFR*/
         L     @02,DDSTRU                                          0971
         MVI   DARGSENT(@02),X'12'                                 0971
*                                DARGSMOD = IMPMSG;        /*#Y30SSFR*/
         MVC   DARGSMOD(3,@02),@CC01000                            0972
*                                DARGILP =                 /*#Y30SSFR*/
*                                  LENGTH(FENTNAME);       /*#Y30SSFR*/
         MVC   DARGILP(2,@02),@CH00605                             0973
*                                DARGDBP =                 /*#Y30SSFR*/
*                                  ADDR(FENTNAME);         /*#Y30SSFR*/
*                                                                  0974
         L     @01,CTGFVPTR                                        0974
         L     @15,CTGFVENT(,@01)                                  0974
         ST    @15,DARGDBP(,@02)                                   0974
*                                CALL AMSTP011(GDTTBL,PRTFILE,/*   0975
*                                                            #Y30SSFR*/
*                                  DDSTRU);                /*#Y30SSFR*/
*                                                                  0975
         L     @02,@PC00001                                        0975
         ST    @02,@AL00001                                        0975
         LA    @15,@CF00118                                        0975
         ST    @15,@AL00001+4                                      0975
         LA    @15,DDSTRU                                          0975
         ST    @15,@AL00001+8                                      0975
         MVI   @AL00001+8,X'80'                                    0975
         L     @15,GDTPRT(,@02)                                    0975
         LA    @01,@AL00001                                        0975
         BALR  @14,@15                                             0975
*                                SETRC = LASTCC08;         /*#Y30SSFR*/
         MVC   SETRC(2),@CH00039                                   0976
*                                DEFSTID = 0;              /*#Y30SSFR*/
         MVI   DEFSTID,X'00'                                       0977
*                                END;                      /*#Y30SSFR*/
*                        END;                              /*#Y30SSFR*/
*                                                                  0979
@RC00967 DS    0H                                                  0979
@RC00965 DS    0H                                                  0980
*                  END POBJLOOP;                           /*@Y30SSFR*/
*                                                                  0980
@RF00963 LA    @02,1                                               0980
         AL    @02,IX                                              0980
@DE00962 ST    @02,IX                                              0980
         L     @15,@PC00001+4                                      0980
         LA    @15,FDTPTR+8(,@15)                                  0980
         C     @02,OBJTSCNT(,@15)                                  0980
         BNH   @DL00962                                            0980
*                  /**************************************************/
*                  /*                                        @Y30SSFR*/
*                  /*  IF THE USER SPECIFIED OUTFILE AND     @Y30SSFR*/
*                  /*  DID NOT EXPLICITLY GIVE A FILE        @Y30SSFR*/
*                  /*  PARAMETER FOR THE PATH, SET           @Y30SSFR*/
*                  /*  CTGFVIND TO POINT THE OUTFILE DD      @Y30SSFR*/
*                  /*  STATEMENT.                            @Y30SSFR*/
*                  /*                                        @Y30SSFR*/
*                  /**************************************************/
*                                                                  0981
*                  IF CTGFVIND = NULLPTR &                         0981
*                     ADDR(OUTDD) ^= NULLPTR                       0981
*                    THEN                                          0981
         SLR   @02,@02                                             0981
         L     @15,CTGFVPTR                                        0981
         C     @02,CTGFVIND(,@15)                                  0981
         BNE   @RF00981                                            0981
         L     @14,@PC00001+4                                      0981
         L     @14,FDTPTR+4(,@14)                                  0981
         CR    @14,@02                                             0981
         BE    @RF00981                                            0981
*                      CTGFVIND = ADDR(OUTDDVAL);          /*@Y30SSFR*/
*                                                                  0982
         LA    @02,OUTDDVAL(,@14)                                  0982
         ST    @02,CTGFVIND(,@15)                                  0982
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  SET THE CTGFVWKA FIELD OF THE FVT     #Y30SSFR*/
*                  /*  TO POINT THE WORK AREA FOR THE        #Y30SSFR*/
*                  /*  RECOVERY VOLUME SERIAL NUMBER.        #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  0983
*                  PFVTPTR -> CTGFVWKA = ADDR(CATRCVWK);   /*#Y30SSFR*/
*                                                                  0983
@RF00981 LA    @02,CATRCVWK                                        0983
         L     @01,PFVTPTR                                         0983
         ST    @02,CTGFVWKA(,@01)                                  0983
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  TEST TO DETERMINE IF IMPF2NOD IS SET  #Y30SSFR*/
*                  /*  IF IT IS, THEN SKIP THE DEFINE OF     #Y30SSFR*/
*                  /*  THE PRESENT PATH, AND PROCEED TO THE  #Y30SSFR*/
*                  /*  NEXT.  OTHERWISE, DO A CMS DEFINE.    #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  0984
*                  IF IMPF2NOD ^= ON                       /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         TM    IMPF2NOD,B'00010000'                                0984
         BO    @RF00984                                            0984
*                      DO;                                 /*#Y30SSFR*/
*                                                                  0985
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  CALL CATALOG MANAGEMENT TO DO     #Y30SSFR*/
*                      /*  A CMS DEFINE                      #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  0986
*                      CALL CTLGPROC(PPTRCPL);             /*#Y30SSFR*/
*                                                                  0986
         LA    @02,PPTRCPL                                         0986
         ST    @02,@AL00001                                        0986
         LA    @01,@AL00001                                        0986
         BAL   @14,CTLGPROC                                        0986
*                      RESPECIFY RTNREG RSTD;                      0987
*                      TESTRC = RTNREG;                            0988
         LR    TESTRC,RTNREG                                       0988
*                      RESPECIFY RTNREG UNRSTD;            /*#Y30SSFR*/
*                                                                  0989
*                      IF TESTRC ^= 0                      /*#Y30SSFR*/
*                        THEN                              /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       0990
         BZ    @RF00990                                            0990
*                          DO;                             /*#Y30SSFR*/
*                                                                  0991
*                          /******************************************/
*                          /*                                #Y30SSFR*/
*                          /*  THE DEFINE OF THE PATH HAS    #Y30SSFR*/
*                          /*  FAILED.  PRINT AN ERROR       #Y30SSFR*/
*                          /*  MESSAGE, BUT CONTINUE         #Y30SSFR*/
*                          /*  PROCESSING WITH THE NEXT      #Y30SSFR*/
*                          /*  PATH.                         #Y30SSFR*/
*                          /*                                #Y30SSFR*/
*                          /******************************************/
*                                                                  0992
*                          DARGSMOD = IMPMSG;              /*#Y30SSFR*/
         L     @02,DDSTRU                                          0992
         MVC   DARGSMOD(3,@02),@CC01000                            0992
*                          DARGSENT = BADPTMP;             /*#Y30SSFR*/
         MVI   DARGSENT(@02),X'10'                                 0993
*                          DARGILP = LENGTH(FENTNAME);     /*#Y30SSFR*/
         MVC   DARGILP(2,@02),@CH00605                             0994
*                          DARGDBP = ADDR(FENTNAME);       /*#Y30SSFR*/
*                                                                  0995
         L     @01,CTGFVPTR                                        0995
         L     @15,CTGFVENT(,@01)                                  0995
         ST    @15,DARGDBP(,@02)                                   0995
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* 0996
*                                                            #Y30SSFR*/
*                                                                  0996
         L     @02,@PC00001                                        0996
         ST    @02,@AL00001                                        0996
         LA    @15,@CF00118                                        0996
         ST    @15,@AL00001+4                                      0996
         LA    @15,DDSTRU                                          0996
         ST    @15,@AL00001+8                                      0996
         MVI   @AL00001+8,X'80'                                    0996
         L     @15,GDTPRT(,@02)                                    0996
         LA    @01,@AL00001                                        0996
         BALR  @14,@15                                             0996
*                          SETRC = LASTCC08;               /*#Y30SSFR*/
         MVC   SETRC(2),@CH00039                                   0997
*                          DEFSTID = 0;                    /*#Y30SSFR*/
         MVI   DEFSTID,X'00'                                       0998
*                          END;                            /*#Y30SSFR*/
*                                                                  0999
*                  END;                                    /*#Y30SSFR*/
*                                                                  1000
@RF00990 DS    0H                                                  1001
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  FREE CORE GOTTEN BY FVTPROC FOR THE   #Y30SSFR*/
*                  /*  FVT AND FPL'S USED TO DEFINE THE      #Y30SSFR*/
*                  /*  PATH.                                 #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1001
*                  CALL IDCSAFS0(GDTTBL,PFVTPTR);          /*#Y30SSFR*/
*                                                                  1001
@RF00984 L     @02,@PC00001                                        1001
         ST    @02,@AL00001                                        1001
         LA    @15,PFVTPTR                                         1001
         ST    @15,@AL00001+4                                      1001
         L     @15,GDTFSP(,@02)                                    1001
         LA    @01,@AL00001                                        1001
         BALR  @14,@15                                             1001
*                  END CATHDFLG;                           /*#Y30SSFR*/
*                                                                  1002
*            END PATHLOOP;                                 /*#Y30SSFR*/
*                                                                  1003
@RF00928 AL    I,@CF00221                                          1003
@DE00917 CH    I,NUMOBJ                                            1003
         BNH   @DL00917                                            1003
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  FREE UP ANY CORE USED BY THE WORKAREA       #Y30SSFR*/
*            /*  EMPLOYED TO DO THE PATH DEFINES.            #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1004
*            IF PCOREFLG = ON                              /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         TM    PCOREFLG,B'10000000'                                1004
         BNO   @RF01004                                            1004
*                CALL IDCSAFS0(GDTTBL,PWORKAR);            /*#Y30SSFR*/
*                                                                  1005
         L     @15,@PC00001                                        1005
         ST    @15,@AL00001                                        1005
         LA    @14,PWORKAR                                         1005
         ST    @14,@AL00001+4                                      1005
         L     @15,GDTFSP(,@15)                                    1005
         LA    @01,@AL00001                                        1005
         BALR  @14,@15                                             1005
*            END PATHDEF;                                  /*#Y30SSFR*/
@RF01004 DS    0H                                                  1007
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  GET THE RECORD FROM THE PORTABLE DATA SET WHICH #Y30SSFR*/
*        /*  DESCRIBES THE FORMAT OF THE DATA TO BE WRITTEN INTO     */
*        /*  THE CLUSTER.                                    #Y30SSFR*/
*        /*  IF THE GET FAILS, RETURN TO THE CALLING PROCESSOR.      */
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1007
*        CALL IDCIOGT0(GDTTBL,PINIOCS);                    /*#Y30SSFR*/
*                                                                  1007
@RF00905 L     @03,@PC00001                                        1007
         ST    @03,@AL00001                                        1007
         LA    @15,PINIOCS                                         1007
         ST    @15,@AL00001+4                                      1007
         MVI   @AL00001+4,X'80'                                    1007
         L     @15,GDTGET(,@03)                                    1007
         LA    @01,@AL00001                                        1007
         BALR  @14,@15                                             1007
*        RESPECIFY RTNREG RSTD;                                    1008
*        TESTRC = RTNREG;                                          1009
         LR    TESTRC,RTNREG                                       1009
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/
*        IF TESTRC ^= 0                                            1011
*          THEN                                                    1011
         LTR   TESTRC,TESTRC                                       1011
         BZ    @RF01011                                            1011
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/
*                                                                  1012
         LA    @15,12                                              1012
         L     @14,@SA00002                                        1012
         LM    @00,@12,@SA00002+8                                  1012
         BR    @14                                                 1012
*        CONRCPTR = IOCDAD;                                /*#Y30SSFR*/
*                                                                  1013
@RF01011 L     @01,IOCSPTR                                         1013
         L     @15,IOCDAD(,@01)                                    1013
         ST    @15,CONRCPTR                                        1013
*        IF  HEADFLG1 ^= HDFL1REO                                  1014
*          THEN                                                    1014
         CLI   HEADFLG1(@15),X'01'                                 1014
         BE    @RF01014                                            1014
*            DO;                                           /*#Y30SSFR*/
*                                                                  1015
*            /*******************************************************/
*            /*                                              #Y30SSFR*/
*            /*  IF THE CONTROL RECORD IS NOT FOR A DATA RECORD,     */
*            /*  THEN THE PORTABILITY VOLUME IS IN ERROR     #Y30SSFR*/
*            /*  RETURN TO THE CALLING PROCESSOR.            #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1016
*            DEFSTID = PORTERR;                            /*#Y30SSFR*/
         MVI   DEFSTID,X'01'                                       1016
*            IF EMPTYDS ^= ON                              /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         TM    EMPTYDS,B'10000000'                                 1017
         BO    @RF01017                                            1017
*                IMPF2DEL = ON;                            /*#Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                1018
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/
@RF01017 LA    @15,12                                              1019
         L     @14,@SA00002                                        1019
         LM    @00,@12,@SA00002+8                                  1019
         BR    @14                                                 1019
*            END;                                          /*#Y30SSFR*/
*                                                                  1020
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  CALL RECPROC TO OPEN THE VSAM CLUSTER JUST DEFINED, AND */
*        /*  COPY THE DATA INTO IT RECORD BY RECORD FROM THE #Y30SSFR*/
*        /*  PORTABILITY DATA SET.                           #Y30SSFR*/
*        /*  IF ANY ERRORS ARE ENCOUNTERED, RETURN TO THE CALLING    */
*        /*  PROCESSOR,AFTER SETTING THE DELETE CLUSTER FLAG.        */
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1021
*        CALL RECPROC;                                     /*#Y30SSFR*/
*                                                                  1021
@RF01014 BAL   @14,RECPROC                                         1021
*        RESPECIFY RTNREG RSTD;                                    1022
*        TESTRC = RTNREG;                                          1023
         LR    TESTRC,RTNREG                                       1023
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/
*        IF TESTRC ^= 0                                            1025
*          THEN                                                    1025
         LTR   TESTRC,TESTRC                                       1025
         BZ    @RF01025                                            1025
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/
         LA    @15,12                                              1026
         L     @14,@SA00002                                        1026
         LM    @00,@12,@SA00002+8                                  1026
         BR    @14                                                 1026
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  ALL INPUT FROM THE PORTABILITY VOLUME HAS BEEN COPIED.  */
*        /*  SO CLOSE THE PORTABLE DATA SET.                 #Y30SSFR*/
*        /*  IF THE CLOSE FAILS, RETURN TO THE CALLING PROCESSOR     */
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1027
*        OLDERID2 = NEWERID2;                                      1027
@RF01025 L     @03,@PC00001                                        1027
         L     @15,GDTTR2(,@03)                                    1027
         MVC   @TS00001(95),NEWERID2(@15)                          1027
         MVC   OLDERID2(95,@15),@TS00001                           1027
*        NEWID2 = 'MPPT';                                  /*#Y30SSFR*/
*                                                                  1028
         MVC   NEWID2(4,@15),@CC01330                              1028
*        CALL IDCIOCL0 (GDTTBL,PINIOCS);                   /*#Y30SSFR*/
*                                                                  1029
         ST    @03,@AL00001                                        1029
         LA    @15,PINIOCS                                         1029
         ST    @15,@AL00001+4                                      1029
         MVI   @AL00001+4,X'80'                                    1029
         L     @15,GDTCLS(,@03)                                    1029
         LA    @01,@AL00001                                        1029
         BALR  @14,@15                                             1029
*        RESPECIFY RTNREG RSTD;                                    1030
*        TESTRC = RTNREG;                                          1031
         LR    TESTRC,RTNREG                                       1031
*        RESPECIFY RTNREG UNRSTD;                          /*#Y30SSFR*/
*        PINIOCS = NULLPTR;                                /*#Y30SSFR*/
         SLR   @03,@03                                             1033
         ST    @03,PINIOCS                                         1033
*        IF TESTRC ^= 0                                            1034
*          THEN                                                    1034
         CR    TESTRC,@03                                          1034
         BE    @RF01034                                            1034
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/
*                                                                  1035
         LA    @15,12                                              1035
         L     @14,@SA00002                                        1035
         LM    @00,@12,@SA00002+8                                  1035
         BR    @14                                                 1035
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  IF THE INHIBITTARGET WAS INDICATED AT EXPORT TIME, A    */
*        /*  CATALOG ALTER MUST BE PERFORMED TO SET THE ATTRIBUTES   */
*        /*  CATALOG FIELD                                   #Y30SSFR*/
*        /*  IF THE ALTER FAILS, RETURN TO THE CALLING PROCESSOR     */
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1036
*        IF IMPINHTG = ON                                          1036
*          THEN                                                    1036
@RF01034 TM    IMPINHTG,B'01000000'                                1036
         BNO   @RF01036                                            1036
*            DO;                                           /*#Y30SSFR*/
*                                                                  1037
*            CALL ALTRPROC;                                /*#Y30SSFR*/
*                                                                  1038
         BAL   @14,ALTRPROC                                        1038
*            RESPECIFY RTNREG RSTD;                                1039
*            TESTRC = RTNREG;                                      1040
         LR    TESTRC,RTNREG                                       1040
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/
*            IF TESTRC ^= 0                                        1042
*              THEN                                                1042
         LTR   TESTRC,TESTRC                                       1042
         BZ    @RF01042                                            1042
*                RETURN CODE(LASTCC08);                    /*#Y30SSFR*/
         LA    @15,8                                               1043
         L     @14,@SA00002                                        1043
         LM    @00,@12,@SA00002+8                                  1043
         BR    @14                                                 1043
*                END;                                      /*#Y30SSFR*/
*                                                                  1044
*                                                                  1044
@RF01042 DS    0H                                                  1045
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  RETURN TO MAIN PROCEDURE, INDICATING THAT ENTIRE        */
*        /*  FUNCTION COMPLETED SUCCESSFULLY                 #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1045
*        RETURN CODE(0);                                   /*#Y30SSFR*/
@RF01036 SLR   @15,@15                                             1045
         L     @14,@SA00002                                        1045
         LM    @00,@12,@SA00002+8                                  1045
         BR    @14                                                 1045
*END CLUSPROC;                                             /*#Y30SSFR*/
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  PROCEDURE NAME - CNCTPROC                       #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /*  FUNCTION -  THIS PROCESSOR WILL CONNECT A USER CATALOG  */
*        /*  OR SEVERAL USER CATALOGS                        #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /*  OUTPUT - THE USER CATALOG NAME WILL HAVE BEEN PLACED    */
*        /*  IN THE MASTER CATALOG                           #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1047
*CNCTPROC: PROCEDURE;                                              1047
*                                                                  1047
CNCTPROC STM   @14,@12,@SA00003                                    1047
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1048
*        DCL 1 CNCTBLKS BDY(WORD),                                 1048
*          2 CNCTCPL    CHAR(LENGTH(CTGPL)),                       1048
*                                      /*CATALOG PARAMETER LIST      */
*          2 CNCTFVT    CHAR(LENGTH(CTGFV));                       1048
*                                      /*CATALOG FIELD VECTOR TABLE  */
*        /***********************************************************/
*        /*                                                          */
*        /*  FOR EACH OBJECT PARAMETER SPECIFIED IN THE AMS COMMAND  */
*        /*  PERFORM A USER CATALOG CONNECT.  THE FVT MUST CONTAIN   */
*        /*  A POINTER TO AN ENTNAME FPL, A DEVTYPE FPL, AND A       */
*        /*  POINTER TO A LIST OF VOLUME SERIALS ON WHICH THE USER   */
*        /*  CATALOG IS LOCATED.  IF NO OBJECT PARAMETER SPECIFIED,  */
*        /*  SEND MESSAGE AND SKIP THE CONNECT.              @OZ14834*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1049
*        OLDERID2 = NEWERID2;                                      1049
         L     @15,@PC00001                                        1049
         L     @15,GDTTR2(,@15)                                    1049
         MVC   @TS00001(95),NEWERID2(@15)                          1049
         MVC   OLDERID2(95,@15),@TS00001                           1049
*        NEWID2 = 'MPUC';                                          1050
*                                                                  1050
         MVC   NEWID2(4,@15),@CC01338                              1050
*        CTGPLPTR = ADDR(CNCTCPL);                                 1051
         LA    @15,CNCTCPL                                         1051
         ST    @15,CTGPLPTR                                        1051
*        PTRCPL = CTGPLPTR;                                        1052
         ST    @15,PTRCPL                                          1052
*        CTGFVPTR = ADDR(CNCTFVT);                                 1053
*                                                                  1053
         LA    @15,CNCTFVT                                         1053
         ST    @15,CTGFVPTR                                        1053
*        IF OBJTSCNT = NULLPTR                             /*@OZ14834*/
*           THEN                                           /*@OZ14834*/
         L     @15,@PC00001+4                                      1054
         LA    @15,FDTPTR+8(,@15)                                  1054
         L     @15,OBJTSCNT(,@15)                                  1054
         LTR   @15,@15                                             1054
         BNZ   @RF01054                                            1054
*             DO;                                          /*@OZ14834*/
*             DEFSTID = NODEVLST;                          /*@OZ14834*/
         MVI   DEFSTID,X'06'                                       1056
*             RETURN CODE(LASTCC12);                       /*@OZ14834*/
         LA    @15,12                                              1057
         L     @14,@SA00003                                        1057
         LM    @00,@12,@SA00003+8                                  1057
         BR    @14                                                 1057
*             END;                                         /*@OZ14834*/
*                                                                  1058
*OBJLOOP:DO INDX = 1 TO OBJTSCNT;                                  1059
*                                                                  1059
@RF01054 DS    0H                                                  1059
OBJLOOP  LA    @15,1                                               1059
         B     @DE01059                                            1059
@DL01059 DS    0H                                                  1060
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT A CPL FOR USE BY CATALOG DEFINE               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1060
*        CNCTBLKS = ''B;                                           1060
         XC    CNCTBLKS(120),CNCTBLKS                              1060
*        CTGFUNC = CTGCMS;             /*CMS FUNCTION                */
         L     @15,CTGPLPTR                                        1061
         NI    CTGFUNC(@15),B'10011111'                            1061
         OI    CTGFUNC(@15),B'10000000'                            1061
*        CTGAM0 = ON;                  /*VSAM REQUEST                */
         OI    CTGAM0(@15),B'00000001'                             1062
*        CTGCNAME = ON;                /*CATALOG ACB ADDR NOT PASSED */
*        CTGNAME = ON;                 /*ENTRY NAME PASSED           */
         OI    CTGCNAME(@15),B'00000110'                           1064
*        CTGOPTNS = CTGDEFIN;          /*DEFINE OPERATION            */
         NI    CTGOPTNS(@15),B'00001111'                           1065
         OI    CTGOPTNS(@15),B'00001000'                           1065
*        CTGTYPE = CTGTUCAT;           /*TYPE = USER CATALOG         */
         MVI   CTGTYPE(@15),C'U'                                   1066
*        CTGFVT = ADDR(CNCTFVT);       /*SET FVT ADDRESS             */
*                                                                  1067
         LA    @14,CNCTFVT                                         1067
         ST    @14,CTGFVT(,@15)                                    1067
*        /************************************************************/
*        /*                                                          */
*        /*  TEST FOR CATALOG PARAMETER SPECIFIED IN AMS COMMAND.    */
*        /*  IF IT IS, SET THE CATALOG NAME.  IF THE CATALOG PASSWORD*/
*        /*  IS SPECIFIED, SET A POINTER TO IT ALSO IN THE CPL.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1068
*        IF ADDR(CAT) ^= NULLPTR                                   1068
*          THEN                                                    1068
         L     @14,@PC00001+4                                      1068
         L     @14,FDTPTR+128(,@14)                                1068
         LTR   @14,@14                                             1068
         BZ    @RF01068                                            1068
*            DO;                                                   1069
*            CTGCAT = ADDR(CATVAL);    /*CATALOG NAME POINTER        */
         LA    @05,CATVAL(,@14)                                    1070
         ST    @05,CTGCAT(,@15)                                    1070
*            IF CATPLN > 0                                         1071
*              THEN                                                1071
         CLI   CATPLN(@14),0                                       1071
         BNH   @RF01071                                            1071
*              CTGPSWD = ADDR(CATPAS);                             1072
         LA    @14,CATPAS(,@14)                                    1072
         ST    @14,CTGPSWD(,@15)                                   1072
*                                      /*CATALOG PASSWORD POINTER    */
*            END;                                                  1073
*                                                                  1073
*                                                                  1073
@RF01071 DS    0H                                                  1074
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT A FIELD VECTOR TABLE (FVT)                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1074
*        CTGFVPTR = ADDR(CNCTFVT);                                 1074
*                                                                  1074
@RF01068 LA    @15,CNCTFVT                                         1074
         ST    @15,CTGFVPTR                                        1074
*        /************************************************************/
*        /*                                                          */
*        /*  TEST TO BE SURE LIST AND DEVICETYPES PARAMETERS HAVE    */
*        /*  BEEN SPECIFIED IN THE AMS COMMAND                       */
*        /*  IF NOT, RETURN TO THE CALLING PROCESSOR WITH THE        */
*        /*  ERROR INDICATED                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1075
*        IF LISTVPTR(INDX) = NULLPTR  DEVTPTR(INDX) = NULLPTR     1075
*          THEN                                                    1075
         SLR   @15,@15                                             1075
         L     @14,INDX                                            1075
         SLA   @14,2                                               1075
         L     @05,@PC00001+4                                      1075
         L     @01,FDTPTR+24(,@05)                                 1075
         AL    @01,@CF01689                                        1075
         C     @15,LISTVPTR(@14,@01)                               1075
         BE    @RT01075                                            1075
         L     @01,FDTPTR+32(,@05)                                 1075
         AL    @01,@CF01689                                        1075
         C     @15,DEVTPTR(@14,@01)                                1075
         BNE   @RF01075                                            1075
@RT01075 DS    0H                                                  1076
*            DO;                                                   1076
*            DEFSTID = NODEVLST;                                   1077
         MVI   DEFSTID,X'06'                                       1077
*            RETURN CODE(LASTCC12);                                1078
         LA    @15,12                                              1078
         L     @14,@SA00003                                        1078
         LM    @00,@12,@SA00003+8                                  1078
         BR    @14                                                 1078
*            END;                                                  1079
*                                                                  1079
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT DEVTYP FPL FROM DEVICETYPES PARAMETER ON AMS  */
*        /*  COMMAND AND LISTVOLS LIST FROM LIST OF VOLUME SERIALS   */
*        /*  FROM LIST PARAMETER ON AMS COMMAND                      */
*        /*  IF NOT CONSTRUCTED SUCCESSFULLY, RETURN TO THE CALLING  */
*        /*  PROCESSOR                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1080
*          CALL LVLRPROC(INDX,NULLPARM,NULLPARM,CTGFVPTR);         1080
*                                                                  1080
@RF01075 LA    @15,INDX                                            1080
         ST    @15,@AL00001                                        1080
         LA    @15,NULLPARM                                        1080
         ST    @15,@AL00001+4                                      1080
         LA    @15,NULLPARM                                        1080
         ST    @15,@AL00001+8                                      1080
         LA    @15,CTGFVPTR                                        1080
         ST    @15,@AL00001+12                                     1080
         LA    @01,@AL00001                                        1080
         BAL   @14,LVLRPROC                                        1080
*          RESPECIFY RTNREG RSTD;                                  1081
*          TESTRC = RTNREG;                                        1082
         LR    TESTRC,RTNREG                                       1082
*          RESPECIFY RTNREG UNRSTD;                                1083
*          IF TESTRC ^= 0                                          1084
*            THEN                                                  1084
         LTR   TESTRC,TESTRC                                       1084
         BZ    @RF01084                                            1084
*              RETURN CODE(LASTCC12);                              1085
*                                                                  1085
         LA    @15,12                                              1085
         L     @14,@SA00003                                        1085
         LM    @00,@12,@SA00003+8                                  1085
         BR    @14                                                 1085
*        /************************************************************/
*        /*                                                          */
*        /*  SET POINTER TO ENTRY NAME FROM OBJECTS PARAMETER        */
*        /*  ON AMS COMMAND                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1086
*          CTGFVENT = ADDR(OBJNMPTR(INDX)->OBJNMVAL);      /*@Y30SSFR*/
*                                                                  1086
@RF01084 L     @15,CTGFVPTR                                        1086
         L     @14,INDX                                            1086
         SLA   @14,2                                               1086
         L     @05,@PC00001+4                                      1086
         L     @01,FDTPTR+12(,@05)                                 1086
         AL    @01,@CF01689                                        1086
         L     @01,OBJNMPTR(@14,@01)                               1086
         LA    @14,OBJNMVAL(,@01)                                  1086
         ST    @14,CTGFVENT(,@15)                                  1086
*        /************************************************************/
*        /*                                                          */
*        /*  THE COMBINATION OF THE TYPE FIELD IN THE FVT SET TO     */
*        /*  NON VSAM AND THE TYPE FIELD IN THE CPL SET TO USER      */
*        /*  CATALOG WILL SIGNAL CATALOG MANAGEMENT TO PERFORM       */
*        /*  THE USER CATALOG CONNECT OPERATION.                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1087
*        CTGFVTYP = CTGTALIN;                                      1087
*                                                                  1087
         MVI   CTGFVTYP(@15),C'A'                                  1087
*          /**********************************************************/
*          /*                                                        */
*          /*  INVOKE CATALOG MANAGEMENT TO PERFORM THE USER CATALOG */
*          /*  CONNECT. IF THE CONNECT FAILS, ISSUE THE MESSAGE      */
*          /*  INDICATED BY THE CATALOG RETURN CODE.                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1088
*          CALL CTLGPROC (PTRCPL);                                 1088
*                                                                  1088
         LA    @15,PTRCPL                                          1088
         ST    @15,@AL00001                                        1088
         LA    @01,@AL00001                                        1088
         BAL   @14,CTLGPROC                                        1088
*          RESPECIFY RTNREG RSTD;                                  1089
*          TESTRC = RTNREG;                                        1090
         LR    TESTRC,RTNREG                                       1090
*          RESPECIFY RTNREG UNRSTD;                                1091
*          IF TESTRC ^= 0                                          1092
*            THEN                                                  1092
         LTR   TESTRC,TESTRC                                       1092
         BZ    @RF01092                                            1092
*              DO;                                                 1093
*                                                                  1093
*              /******************************************************/
*              /*                                                    */
*              /*  ISSUE MESSAGE THAT CONNECT FAILED FOR USERCATALOG */
*              /*                                                    */
*              /******************************************************/
*                                                                  1094
*              DARGILP = LENGTH(FENTNAME);                         1094
         L     @15,DDSTRU                                          1094
         MVC   DARGILP(2,@15),@CH00605                             1094
*              DARGDBP = ADDR(OBJNMPTR(INDX) -> OBJNMVAL); /*@Y30SSFR*/
*                                                                  1095
         L     @14,INDX                                            1095
         SLA   @14,2                                               1095
         L     @05,@PC00001+4                                      1095
         L     @01,FDTPTR+12(,@05)                                 1095
         AL    @01,@CF01689                                        1095
         L     @01,OBJNMPTR(@14,@01)                               1095
         LA    @14,OBJNMVAL(,@01)                                  1095
         ST    @14,DARGDBP(,@15)                                   1095
*              CALL MSGPROC(BADCNCT);                              1096
*                                                                  1096
         LA    @01,@AL01096                                        1096
         BAL   @14,MSGPROC                                         1096
*              RETURN CODE(LASTCC12);                              1097
         LA    @15,12                                              1097
         L     @14,@SA00003                                        1097
         LM    @00,@12,@SA00003+8                                  1097
         BR    @14                                                 1097
*              END;                                                1098
*            ELSE                                                  1099
*              DO;                                                 1099
*                                                                  1099
*                                                                  1099
@RF01092 DS    0H                                                  1100
*              /******************************************************/
*              /*                                                    */
*              /*  ISSUE MESSAGE - GOOD CONNECT FOR USERCATALOG      */
*              /*                                                    */
*              /******************************************************/
*                                                                  1100
*              DARGILP = LENGTH(FENTNAME);                         1100
         L     @15,DDSTRU                                          1100
         MVC   DARGILP(2,@15),@CH00605                             1100
*              DARGDBP = ADDR(OBJNMPTR(INDX) -> OBJNMVAL); /*@Y30SSFR*/
*                                                                  1101
         L     @14,INDX                                            1101
         SLA   @14,2                                               1101
         L     @05,@PC00001+4                                      1101
         L     @01,FDTPTR+12(,@05)                                 1101
         AL    @01,@CF01689                                        1101
         L     @01,OBJNMPTR(@14,@01)                               1101
         LA    @14,OBJNMVAL(,@01)                                  1101
         ST    @14,DARGDBP(,@15)                                   1101
*              CALL MSGPROC(GOODCNCT);                             1102
*                                                                  1102
         LA    @01,@AL01102                                        1102
         BAL   @14,MSGPROC                                         1102
*              END;                                                1103
*                                                                  1103
*        END OBJLOOP;                                              1104
*                                                                  1104
         LA    @15,1                                               1104
         AL    @15,INDX                                            1104
@DE01059 ST    @15,INDX                                            1104
         L     @14,@PC00001+4                                      1104
         LA    @14,FDTPTR+8(,@14)                                  1104
         C     @15,OBJTSCNT(,@14)                                  1104
         BNH   @DL01059                                            1104
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO MAIN PROCESSOR, INDICATING SUCCESSFUL         */
*        /*  COMPLETION OF ENTIRE FUNCTION                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1105
*        RETURN CODE(0);                                           1105
         SLR   @15,@15                                             1105
         L     @14,@SA00003                                        1105
         LM    @00,@12,@SA00003+8                                  1105
         BR    @14                                                 1105
*END CNCTPROC;                                                     1106
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - DUPNPROC                               */
*        /*                                                          */
*        /*  FUNCTION - THIS PROCEDURE IS CALLED WHEN A DUPLICATE    */
*        /*  ENTRYNAME IS FOUND IN THE CATALOG WHEN TRYING TO        */
*        /*  DEFINE THE DATA SET TO BE IMPORTED.  A LOCATE WILL BE   */
*        /*  PERFORMED TO SEE IF THE ENTRY HAS THE TEMPORARY EXPORT  */
*        /*  FLAG SET IN THE ATTRIBUTES FIELD.  IF SO, A DELETE IS   */
*        /*  THEN PERFORMED SO THAT THE IMPORTED DATA SET MAY BE     */
*        /*  DEFINED.                                                */
*        /*  THE SAME LOCATE WILL ALSO LOCATE THE HIGH USED  @Y30SSFR*/
*        /*  RBA VALUE.  IF THIS IS 0, TESTS ARE MADE TO     @Y30SSFR*/
*        /*  COMPARE THE ATTRIBUTES OF THE EMPTY DATA SET    @Y30SSFR*/
*        /*  WITH THOSE OF THE EXPORTED OBJECT.  IF THEY     @Y30SSFR*/
*        /*  ARE COMPARABLE, THEN THE IMPORT IS DONE BY      @Y30SSFR*/
*        /*  LOADING EMPTY DATA SET FROM THE PORTABILITY     @Y30SSFR*/
*        /*  VOLUME.                                         @Y30SSFR*/
*        /*                                                          */
*        /*  INPUT- ENTRYNAME OF DUPLICATE CLUSTER (FROM FVT)        */
*        /*                                                          */
*        /*  OUTPUT - THE CATALOG NO LONGER CONTAINS THE DUPLICATE   */
*        /*  ENTRY OR THE EMPTYDS BIT IS TURNED ON           @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1107
*DUPNPROC: PROCEDURE;                                              1107
*                                                                  1107
DUPNPROC STM   @14,@12,@SA00004                                    1107
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1108
*        DCL LCPLPTR(3)  PTR(31);      /*POINTER TO CPLS FOR LOCATE  */
*        DCL LPSWD       PTR(31);      /*POINTER TO OBJECT PASSWORD  */
*        DCL LDOCNTRL    BIT(1);       /*FOR CONTROLLING DO LOOPS    */
*        DCL LOOPCTR     FIXED(31);    /*USED AS A COUNTER   @Y30SSFR*/
*                                      /*IN CONTROLLING      @Y30SSFR*/
*                                      /*DO LOOP             @Y30SSFR*/
*        DCL ILDSATTR    FIXED(8) CONSTANT(1);                     1112
*        DCL ILHURBAD    FIXED(8) CONSTANT(2);             /*@Y30SSFR*/
*        DCL ILAMDSB     FIXED(8) CONSTANT(3);             /*@Y30SSFR*/
*        DCL ILCATACB    FIXED(8) CONSTANT(1);                     1115
*        DCL ILNAMEDS    FIXED(8) CONSTANT(2);                     1116
*        DCL ILENTYPE    FIXED(8) CONSTANT(3);             /*@Y30SSFR*/
*                                      /*INDEXES TO FPLS USED BY     */
*                                      /*LOCATE                      */
*        DCL EXPMSG   CHAR(3) CONSTANT('XP0');                     1118
*                                      /*EXPORT STATIC TEXT MODULE ID *
*        DCL NOCTFLD  FIXED(8) CONSTANT(4);                        1119
*                                      /*STATIC TEXT MESSAGE ID FOR  */
*                                      /*A MISSING CATALOG FIELD     */
*                                                                  1120
*        DCL FHURBADS FIXED(31) BASED(CTGFLPT(1));         /*@Y30SSFR*/
*                                      /*MAPPING OF HIGH     @Y30SSFR*/
*                                      /*USED RBA            @Y30SSFR*/
*                                                                  1121
*        DCL AMDSBPTR PTR(31);         /*POINTER USED TO     @Y30SSFR*/
*                                      /*POINT TO THE AMDSB  @Y30SSFR*/
*                                      /*USED IN THE CATALOG @Y30SSFR*/
*                                      /*DEFINE OPERATION    @Y30SSFR*/
*                                                                  1122
*        /************************************************************/
*        /*                                                          */
*        /*  TO DETERMINE IF THE DUPLICATE NAME IN THE CATALOG IS AN */
*        /*  OBJECT WITH THE TEMPORARY EXPORT ATTRIBUTE,     @Y30SSFR*/
*        /*  OR A PRE-DEFINED EMPTY DATA SET, SEVERAL        @Y30SSFR*/
*        /*  CATALOG LOCATES MUST BE PERFORMED.  FIRST THE CLUSTER   */
*        /*  MUST BE LOCATED.  A CLUSTER OBJECT DOES NOT HAVE THE    */
*        /*  ATTRIBUTES FIELD(DSATTR) IN WHICH THE TEMPORARY EXPORT  */
*        /*  FLAG IS SET, BUT IT MUST BE LOCATED IN ORDER TO LOCATE  */
*        /*  THE DATA AND INDEX OBJECTS.  THE NAMEDS CATALOG FIELD   */
*        /*  PROVIDES THE CONTROL INTERVAL NUMBER IN THE CATALOG     */
*        /*  WHICH IS USED TO LOCATE THE DATA AND INDEX OBJECT.      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1122
*        OLDERID2 = NEWERID2;                                      1122
         L     @15,@PC00001                                        1122
         L     @15,GDTTR2(,@15)                                    1122
         MVC   @TS00001(95),NEWERID2(@15)                          1122
         MVC   OLDERID2(95,@15),@TS00001                           1122
*        NEWID2 = 'MPDN';                                          1123
*                                                                  1123
         MVC   NEWID2(4,@15),@CC01359                              1123
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT THE CPL REQUIRED TO LOCATE THE CLUSTER.  THE  */
*        /*  ENTRYNAME OF THE CLUSTER IS OBTAINED FROM THE FVT       */
*        /*  EMPLOYED BY THE CATALOG DEFINE OPERATION.               */
*        /*  IF THE CPL IS NOT CONSTRUCTED SUCCESSFULLY, RETURN      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1124
*        CTGPLPTR = PTRCPL;            /*SET CPL BASE TO DEFINE CPL  */
*                                                                  1124
         L     @15,PTRCPL                                          1124
         ST    @15,CTGPLPTR                                        1124
*        CALL CPLPROC('L',LCPLPTR(1),FVTPTR(1)->CTGFVENT,NULLPARM, 1125
*              CPSWD);                                             1125
*                                                                  1125
         LA    @15,@CC01360                                        1125
         ST    @15,@AL00001                                        1125
         LA    @15,LCPLPTR                                         1125
         ST    @15,@AL00001+4                                      1125
         L     @01,FVTPTR                                          1125
         LA    @15,CTGFVENT(,@01)                                  1125
         ST    @15,@AL00001+8                                      1125
         LA    @15,NULLPARM                                        1125
         ST    @15,@AL00001+12                                     1125
         LA    @15,CPSWD                                           1125
         ST    @15,@AL00001+16                                     1125
         LA    @01,@AL00001                                        1125
         BAL   @14,CPLPROC                                         1125
*        RESPECIFY RTNREG RSTD;                                    1126
*        TESTRC = RTNREG;                                          1127
         LR    TESTRC,RTNREG                                       1127
*        RESPECIFY RTNREG UNRSTD;                                  1128
*        IF TESTRC ^= 0                                            1129
*          THEN                                                    1129
         LTR   TESTRC,TESTRC                                       1129
         BZ    @RF01129                                            1129
*            RETURN CODE(LASTCC12);                                1130
*                                                                  1130
         LA    @15,12                                              1130
         L     @14,@SA00004                                        1130
         LM    @00,@12,@SA00004+8                                  1130
         BR    @14                                                 1130
*        CTGPLPTR = LCPLPTR(1);        /*SET CPL BASE TO LOCATE CPL  */
@RF01129 L     @15,LCPLPTR                                         1131
         ST    @15,CTGPLPTR                                        1131
*        CTGNOFLD = 3;                 /*SET FPL COUNT IN CPL        */
*                                                                  1132
         MVI   CTGNOFLD(@15),X'03'                                 1132
*        /************************************************************/
*        /*                                                          */
*        /*      CONSTRUCT FPLS FOR THE FIELDS TO BE LOCATED WHICH   */
*        /*      ARE -  ENTYPE, NAMEDS, AND CATACB.                  */
*        /*      IF THE FPL IS NOT CONSTRUCTED SUCCESSFULLY, CONTROL */
*        /*      IS RETURNED TO THE CALLING PROCESSOR                */
*        /*                                                          */
*        /***********************************************************/
*                                                                  1133
*        /************************************************************/
*        /*                                                          */
*        /*  THE FPL FOR THE CATACB FIELD WILL RETURN THE CATALOG    */
*        /*  ACB ADDRESS FOR THE CATALOG IN WHICH THE ENTRYNAME IS   */
*        /*  FOUND                                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1133
*        CALL BFPLPROC(ADDR(FIELDLST),ICATACB,             /*@Y30SSFR*/
*          CTGFIELD(ILCATACB),NULLPARM,NULLPARM,NULLPARM); /*@Y30SSFR*/
         MVC   @AL00001+4(20),@AL01133                             1133
         LA    @14,FIELDLST                                        1133
         ST    @14,@AFTEMPS+8                                      1133
         LA    @14,@AFTEMPS+8                                      1133
         ST    @14,@AL00001                                        1133
         LA    @15,CTGFIELD(,@15)                                  1133
         ST    @15,@AL00001+8                                      1133
         LA    @01,@AL00001                                        1133
         BAL   @14,BFPLPROC                                        1133
*        RESPECIFY RTNREG RSTD;                                    1134
*        TESTRC = RTNREG;                                          1135
         LR    TESTRC,RTNREG                                       1135
*        RESPECIFY RTNREG UNRSTD;                                  1136
*        IF TESTRC ^= 0                                            1137
*          THEN                                                    1137
         LTR   TESTRC,TESTRC                                       1137
         BZ    @RF01137                                            1137
*            RETURN CODE(LASTCC12);                                1138
*                                                                  1138
         LA    @15,12                                              1138
         L     @14,@SA00004                                        1138
         LM    @00,@12,@SA00004+8                                  1138
         BR    @14                                                 1138
*        /************************************************************/
*        /*                                                          */
*        /*  THE FPL FOR THE NAMEDS FIELD WILL RETURN INFORMATION    */
*        /*  ABOUT THE COMPONENTS OF THIS CLUSTER.  FROM THIS        */
*        /*  INFORMATION THE DATA AND INDEX COMPONENTS CAN BE        */
*        /*  LOCATED.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  1139
*        CALL BFPLPROC(ADDR(FIELDLST),INAMEDS,             /*@Y30SSFR*/
*          CTGFIELD(ILNAMEDS),NULLPARM,NULLPARM,NULLPARM); /*@Y30SSFR*/
@RF01137 MVC   @AL00001+4(20),@AL01139                             1139
         LA    @15,FIELDLST                                        1139
         ST    @15,@AFTEMPS+8                                      1139
         LA    @15,@AFTEMPS+8                                      1139
         ST    @15,@AL00001                                        1139
         L     @01,CTGPLPTR                                        1139
         LA    @15,CTGFIELD+4(,@01)                                1139
         ST    @15,@AL00001+8                                      1139
         LA    @01,@AL00001                                        1139
         BAL   @14,BFPLPROC                                        1139
*        RESPECIFY RTNREG RSTD;                                    1140
*        TESTRC = RTNREG;                                          1141
         LR    TESTRC,RTNREG                                       1141
*        RESPECIFY RTNREG UNRSTD;                                  1142
*        IF TESTRC ^= 0                                            1143
*          THEN                                                    1143
         LTR   TESTRC,TESTRC                                       1143
         BZ    @RF01143                                            1143
*            RETURN CODE(LASTCC12);                                1144
*                                                                  1144
         LA    @15,12                                              1144
         L     @14,@SA00004                                        1144
         LM    @00,@12,@SA00004+8                                  1144
         BR    @14                                                 1144
*        /************************************************************/
*        /*                                                          */
*        /*  THE ENTYPE CATALOG FIELD WILL RETURN THE ENTRY TYPE     */
*        /*  OF THE COMPONENT BEING LOCATED.  THIS INFORMATION WILL  */
*        /*  WILL BE USED TO INSURE THAT THE DUPLICATE IN THE        */
*        /*  CATALOG IS INDEED A CLUSTER OR AN AIX.          @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1145
*        CALL BFPLPROC(ADDR(FIELDLST),IENTYPE,             /*@Y30SSFR*/
*          CTGFIELD(ILENTYPE),NULLPARM,NULLPARM,NULLPARM); /*@Y30SSFR*/
@RF01143 MVC   @AL00001+4(20),@AL01145                             1145
         LA    @15,FIELDLST                                        1145
         ST    @15,@AFTEMPS+8                                      1145
         LA    @15,@AFTEMPS+8                                      1145
         ST    @15,@AL00001                                        1145
         L     @01,CTGPLPTR                                        1145
         LA    @15,CTGFIELD+8(,@01)                                1145
         ST    @15,@AL00001+8                                      1145
         LA    @01,@AL00001                                        1145
         BAL   @14,BFPLPROC                                        1145
*        RESPECIFY RTNREG RSTD;                                    1146
*        TESTRC = RTNREG;                                          1147
         LR    TESTRC,RTNREG                                       1147
*        RESPECIFY RTNREG UNRSTD;                                  1148
*        IF TESTRC ^= 0                                            1149
*          THEN                                                    1149
         LTR   TESTRC,TESTRC                                       1149
         BZ    @RF01149                                            1149
*            RETURN CODE(LASTCC12);                                1150
*                                                                  1150
         LA    @15,12                                              1150
         L     @14,@SA00004                                        1150
         LM    @00,@12,@SA00004+8                                  1150
         BR    @14                                                 1150
*        /************************************************************/
*        /*                                                          */
*        /*      INVOKE CATALOG MANAGEMENT TO ISSUE CATALOG LOCATE   */
*        /*      FOR THE CLUSTER OR AIX.                     @Y30SSFR*/
*        /*      IF LOCATE FAILS, RETURN TO CALLING PROCESSOR        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1151
*        CALL CTLGPROC(LCPLPTR(1));                        /*@Y30SSFR*/
*                                                                  1151
@RF01149 LA    @15,LCPLPTR                                         1151
         ST    @15,@AL00001                                        1151
         LA    @01,@AL00001                                        1151
         BAL   @14,CTLGPROC                                        1151
*        RESPECIFY RTNREG RSTD;                                    1152
*        TESTRC = RTNREG;                                          1153
         LR    TESTRC,RTNREG                                       1153
*        RESPECIFY RTNREG UNRSTD;                                  1154
*        IF TESTRC ^= 0                                            1155
*          THEN                                                    1155
         LTR   TESTRC,TESTRC                                       1155
         BZ    @RF01155                                            1155
*            RETURN CODE(LASTCC12);                                1156
*                                                                  1156
         LA    @15,12                                              1156
         L     @14,@SA00004                                        1156
         LM    @00,@12,@SA00004+8                                  1156
         BR    @14                                                 1156
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO SEE THAT THE DUPLICATE ENTRY IS INDEED @Y30SSFR*/
*        /*  A CLUSTER OR AN AIX.  IF NOT, INDICATE ERROR    @Y30SSFR*/
*        /*  AND RETURN TO THE CALLING PROCESSOR.            @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1157
*        CTGFLPTR = CTGFIELD(ILENTYPE);                            1157
*                                                                  1157
@RF01155 L     @01,CTGPLPTR                                        1157
         L     CTGFLPTR,CTGFIELD+8(,@01)                           1157
*        /************************************************************/
*        /*                                                          */
*        /*        BE SURE ENTYPE INFORMATION WAS RETURNED           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1158
*        IF CTGFLNG(1) ^= 0                                        1158
*          THEN                                                    1158
         L     @05,CTGFLNG(,CTGFLPTR)                              1158
         LTR   @05,@05                                             1158
         BZ    @RF01158                                            1158
*            IF FENTYPE ^= CTGTCL & FENTYPE ^= CTGTAIX     /*@Y30SSFR*/
*              THEN                                                1159
*                                                                  1159
         L     @05,CTGFLPT(,CTGFLPTR)                              1159
         CLI   FENTYPE(@05),C'C'                                   1159
         BE    @RF01159                                            1159
         CLI   FENTYPE(@05),C'G'                                   1159
         BE    @RF01159                                            1159
*                /****************************************************/
*                /*                                                  */
*                /*  ENTYPE NOT VALID - RETURN WITH ERROR    @Y30SSFR*/
*                /*                                                  */
*                /****************************************************/
*                                                                  1160
*                DO;                                               1160
*                DARGSMOD = IMPMSG;                        /*@Y30SSFR*/
         L     @01,DDSTRU                                          1161
         MVC   DARGSMOD(3,@01),@CC01000                            1161
*                DEFSTID = NOCLUSNM;                               1162
         MVI   DEFSTID,X'08'                                       1162
*                RETURN CODE(LASTCC12);                            1163
         LA    @15,12                                              1163
         L     @14,@SA00004                                        1163
         LM    @00,@12,@SA00004+8                                  1163
         BR    @14                                                 1163
*                END;                                              1164
*              ELSE;                                               1165
*                                                                  1165
@RF01159 DS    0H                                                  1166
*            /********************************************************/
*            /*                                                      */
*            /*  IF ENTYPE INFORMATION NOT RETURNED, THEN    @Y30SSFR*/
*            /*  CATALOG IS IN ERROR. RETURN TO CALLING PROCESSOR    */
*            /*                                                      */
*            /********************************************************/
*                                                                  1166
*          ELSE                                                    1166
*            DO;                                                   1166
         B     @RC01158                                            1166
@RF01158 DS    0H                                                  1167
*            DEFSTID = NOCTFLD;                                    1167
         MVI   DEFSTID,X'04'                                       1167
*            DARGSMOD = EXPMSG;                                    1168
         L     @01,DDSTRU                                          1168
         MVC   DARGSMOD(3,@01),@CC01355                            1168
*            RETURN CODE(LASTCC12);                                1169
         LA    @15,12                                              1169
         L     @14,@SA00004                                        1169
         LM    @00,@12,@SA00004+8                                  1169
         BR    @14                                                 1169
*            END;                                                  1170
*                                                                  1170
*        /************************************************************/
*        /*                                                          */
*        /*  GET CONTROL INTERVALS FOR THE CLUSTER OR AIX    @Y30SSFR*/
*        /*  COMPONENTS FROM THE NAMEDS CATALOG FIELD.       @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1171
*        CTGPLPTR = LCPLPTR(1);                                    1171
@RC01158 L     @05,LCPLPTR                                         1171
         ST    @05,CTGPLPTR                                        1171
*        CTGFLPTR = CTGFIELD(ILNAMEDS);                            1172
         L     CTGFLPTR,CTGFIELD+4(,@05)                           1172
*        IF CTGFLNG(1) ^= 0                                        1173
*          THEN                                                    1173
         L     @05,CTGFLNG(,CTGFLPTR)                              1173
         LTR   @05,@05                                             1173
         BZ    @RF01173                                            1173
*            IF CTGFLNG(1) = LNAMEDS                       /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         CH    @05,LNAMEDS                                         1174
         BNE   @RF01174                                            1174
*                DO;                                       /*@Y30SSFR*/
*                LOOPCTR = 1;                              /*@Y30SSFR*/
         MVC   LOOPCTR(4),@CF00221                                 1176
*                FNMPTR = CTGFLPT(1);                      /*@Y30SSFR*/
         L     @05,CTGFLPT(,CTGFLPTR)                              1177
         ST    @05,FNMPTR                                          1177
*                END;                                      /*@Y30SSFR*/
*              ELSE                                        /*@Y30SSFR*/
*                DO;                                       /*@Y30SSFR*/
         B     @RC01174                                            1179
@RF01174 DS    0H                                                  1180
*                FNMPTR = CTGFLPT(1) + LNAMEDS;            /*@Y30SSFR*/
         LH    @05,LNAMEDS                                         1180
         AL    @05,CTGFLPT(,CTGFLPTR)                              1180
         ST    @05,FNMPTR                                          1180
*                IF FTYPE = CTGTINDX                       /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         CLI   FTYPE(@05),C'I'                                     1181
         BNE   @RF01181                                            1181
*                    LOOPCTR = 2;                          /*@Y30SSFR*/
         MVC   LOOPCTR(4),@CF00156                                 1182
*                  ELSE                                    /*@Y30SSFR*/
*                    LOOPCTR = 1;                          /*@Y30SSFR*/
         B     @RC01181                                            1183
@RF01181 MVC   LOOPCTR(4),@CF00221                                 1183
*                FNMPTR = CTGFLPT(1);                      /*@Y30SSFR*/
@RC01181 L     @05,CTGFLPT(,CTGFLPTR)                              1184
         ST    @05,FNMPTR                                          1184
*                END;                                      /*@Y30SSFR*/
*                                                                  1185
*          /**********************************************************/
*          /*                                                        */
*          /*  IF NO CLUSTER OR AIX COMPONENTS, RETURN TO    @Y30SSFR*/
*          /*  CALLING PROCESSOR                             @Y30SSFR*/
*          /*                                                        */
*          /**********************************************************/
*                                                                  1186
*          ELSE                                                    1186
*            DO;                                                   1186
         B     @RC01173                                            1186
@RF01173 DS    0H                                                  1187
*            DEFSTID = NOCTFLD;                                    1187
         MVI   DEFSTID,X'04'                                       1187
*            DARGSMOD = EXPMSG;                                    1188
         L     @01,DDSTRU                                          1188
         MVC   DARGSMOD(3,@01),@CC01355                            1188
*            RETURN CODE(LASTCC12);                                1189
         LA    @15,12                                              1189
         L     @14,@SA00004                                        1189
         LM    @00,@12,@SA00004+8                                  1189
         BR    @14                                                 1189
*            END;                                                  1190
*                                                                  1190
*        /************************************************************/
*        /*                                                          */
*        /*      IF CATALOG ACB IS NOT ALREADY KNOWN DUE TO OPEN     */
*        /*      OF CATALOG, THEN PICK ADDRESS UP FROM CATACB FIELD  */
*        /*      WHICH WAS RETURNED BY CATALOG MANAGEMENT LOCATE     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1191
*        IF  PTRCTACB = NULLPTR                                    1191
*          THEN                                                    1191
@RC01173 L     @15,PTRCTACB                                        1191
         LTR   @15,@15                                             1191
         BNZ   @RF01191                                            1191
*            DO;                                                   1192
*            CTGFLPTR = CTGFIELD(ILCATACB);                        1193
         L     @01,CTGPLPTR                                        1193
         L     CTGFLPTR,CTGFIELD(,@01)                             1193
*            PTRCTACB = FCATACB;                                   1194
         L     @05,CTGFLPT(,CTGFLPTR)                              1194
         L     @05,FCATACB(,@05)                                   1194
         ST    @05,PTRCTACB                                        1194
*            END;                                                  1195
*                                                                  1195
*        /************************************************************/
*        /*                                                          */
*        /*      NOW DO LOCATE ON EACH OF ASSOCIATED COMPONENTS OF   */
*        /*      THE CLUSTER, WHOSE CONTROL INTERVAL NUMBERS ARE     */
*        /*      INDICATED FROM THE NAMEDS FPL                       */
*        /*      THE LOOP CONTROL FLAG WILL BE TURNED OFF IF THE     */
*        /*  TEMPORARY EXPORT ATTRIBUTE IS PRESENT OR IF THE @Y30SSFR*/
*        /*  THE DATA SET IS EMPTY.  OTHERWISE THE LOOP WILL @Y30SSFR*/
*        /*  TERMINATE WHEN ALL COMPONENTS HAVE BEEN LOCATED @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1196
*        LDOCNTRL = ON;                                            1196
@RF01191 OI    LDOCNTRL,B'10000000'                                1196
*LOCLOOP:DO I = 1 TO LOOPCTR WHILE LDOCNTRL = ON;                  1197
*                                                                  1197
LOCLOOP  LA    I,1                                                 1197
         B     @DE01197                                            1197
@DL01197 TM    LDOCNTRL,B'10000000'                                1197
         BNO   @DC01197                                            1197
*          /**********************************************************/
*          /*                                                        */
*          /*      CONSTRUCT CPL FOR LOCATE OF COMPONENT             */
*          /*      IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1198
*          CALL CPLPROC('L',LCPLPTR(I+1),NULLPARM,FNAME,CPSWD);    1198
*                                                                  1198
         LA    @02,@CC01360                                        1198
         ST    @02,@AL00001                                        1198
         LR    @02,I                                               1198
         SLA   @02,2                                               1198
         LA    @02,LCPLPTR(@02)                                    1198
         ST    @02,@AL00001+4                                      1198
         LA    @02,NULLPARM                                        1198
         ST    @02,@AL00001+8                                      1198
         L     @02,FNMPTR                                          1198
         LA    @02,FNAME(,@02)                                     1198
         ST    @02,@AL00001+12                                     1198
         LA    @02,CPSWD                                           1198
         ST    @02,@AL00001+16                                     1198
         LA    @01,@AL00001                                        1198
         BAL   @14,CPLPROC                                         1198
*          RESPECIFY RTNREG RSTD;                                  1199
*          TESTRC = RTNREG;                                        1200
         LR    TESTRC,RTNREG                                       1200
*          RESPECIFY RTNREG UNRSTD;                                1201
*          IF TESTRC ^= 0                                          1202
*            THEN                                                  1202
         LTR   TESTRC,TESTRC                                       1202
         BZ    @RF01202                                            1202
*              RETURN CODE(LASTCC12);                              1203
*                                                                  1203
         LA    @15,12                                              1203
         L     @14,@SA00004                                        1203
         LM    @00,@12,@SA00004+8                                  1203
         BR    @14                                                 1203
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  SET THE CTGPLPTR TO POINT TO THE CPL JUST     @Y30SSFR*/
*          /*  CONSTRUCTED.                                  @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1204
*          CTGPLPTR = LCPLPTR(I+1);                        /*@Y30SSFR*/
*                                                                  1204
@RF01202 LR    @02,I                                               1204
         SLA   @02,2                                               1204
         L     @02,LCPLPTR(@02)                                    1204
         ST    @02,CTGPLPTR                                        1204
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*  SET THE VALUE OF CTGNOFLD TO 3 TO INDICATE    @Y30SSFR*/
*          /*  THAT THE LOCATE IS ON 3 CATALOG FIELDS.       @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1205
*                                                                  1205
*          CTGNOFLD = 3;                                   /*@Y30SSFR*/
*                                                                  1205
         MVI   CTGNOFLD(@02),X'03'                                 1205
*          /**********************************************************/
*          /*                                                        */
*          /*      CONSTRUCT DSATTR, HURBADS, AND AMDSBCAT   @Y30SSFR*/
*          /*      FPLS.  PLACE POINTERS IN THE CPL.         @Y30SSFR*/
*          /*      IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1206
*          CALL BFPLPROC(ADDR(FIELDLST),IDSATTR,           /*@Y30SSFR*/
*            CTGFIELD(ILDSATTR),NULLPARM,NULLPARM,         /*@Y30SSFR*/
*            NULLPARM);                                    /*@Y30SSFR*/
*                                                                  1206
         MVC   @AL00001+4(20),@AL01206                             1206
         LA    @15,FIELDLST                                        1206
         ST    @15,@AFTEMPS+8                                      1206
         LA    @15,@AFTEMPS+8                                      1206
         ST    @15,@AL00001                                        1206
         LA    @02,CTGFIELD(,@02)                                  1206
         ST    @02,@AL00001+8                                      1206
         LA    @01,@AL00001                                        1206
         BAL   @14,BFPLPROC                                        1206
*          RESPECIFY RTNREG RSTD;                                  1207
*          TESTRC = RTNREG;                                        1208
         LR    TESTRC,RTNREG                                       1208
*          RESPECIFY RTNREG UNRSTD;                                1209
*          IF TESTRC ^= 0                                          1210
*            THEN                                                  1210
         LTR   TESTRC,TESTRC                                       1210
         BZ    @RF01210                                            1210
*              RETURN CODE(LASTCC12);                              1211
*                                                                  1211
         LA    @15,12                                              1211
         L     @14,@SA00004                                        1211
         LM    @00,@12,@SA00004+8                                  1211
         BR    @14                                                 1211
*          CALL BFPLPROC(ADDR(FIELDLST),IHURBAD,          /*@Y30SSFR*/
*             CTGFIELD(ILHURBAD),NULLPARM,NULLPARM,        /*@Y30SSFR*/
*             NULLPARM);                                   /*@Y30SSFR*/
*                                                                  1212
@RF01210 MVC   @AL00001+4(20),@AL01212                             1212
         LA    @02,FIELDLST                                        1212
         ST    @02,@AFTEMPS+8                                      1212
         LA    @02,@AFTEMPS+8                                      1212
         ST    @02,@AL00001                                        1212
         L     @02,CTGPLPTR                                        1212
         LA    @02,CTGFIELD+4(,@02)                                1212
         ST    @02,@AL00001+8                                      1212
         LA    @01,@AL00001                                        1212
         BAL   @14,BFPLPROC                                        1212
*          RESPECIFY RTNREG RSTD;                                  1213
*          TESTRC = RTNREG;                                        1214
         LR    TESTRC,RTNREG                                       1214
*          RESPECIFY RTNREG UNRSTD;                        /*@Y30SSFR*/
*                                                                  1215
*          IF TESTRC ^= 0                                          1216
*            THEN                                                  1216
         LTR   TESTRC,TESTRC                                       1216
         BZ    @RF01216                                            1216
*              RETURN CODE(LASTCC12);                      /*@Y30SSFR*/
*                                                                  1217
         LA    @15,12                                              1217
         L     @14,@SA00004                                        1217
         LM    @00,@12,@SA00004+8                                  1217
         BR    @14                                                 1217
*          CALL BFPLPROC(ADDR(FIELDLST),IAMDSB,                    1218
*             CTGFIELD(ILAMDSB),NULLPARM,NULLPARM,                 1218
*             NULLPARM);                                   /*@Y30SSFR*/
*                                                                  1218
@RF01216 MVC   @AL00001+4(20),@AL01218                             1218
         LA    @02,FIELDLST                                        1218
         ST    @02,@AFTEMPS+8                                      1218
         LA    @02,@AFTEMPS+8                                      1218
         ST    @02,@AL00001                                        1218
         L     @02,CTGPLPTR                                        1218
         LA    @02,CTGFIELD+8(,@02)                                1218
         ST    @02,@AL00001+8                                      1218
         LA    @01,@AL00001                                        1218
         BAL   @14,BFPLPROC                                        1218
*          RESPECIFY RTNREG RSTD;                                  1219
*          TESTRC = RTNREG;                                        1220
         LR    TESTRC,RTNREG                                       1220
*          RESPECIFY RTNREG UNRSTD;                        /*@Y30SSFR*/
*                                                                  1221
*          IF TESTRC ^= 0                                          1222
*            THEN                                                  1222
         LTR   TESTRC,TESTRC                                       1222
         BZ    @RF01222                                            1222
*              RETURN CODE(LASTCC12);                      /*@Y30SSFR*/
*                                                                  1223
         LA    @15,12                                              1223
         L     @14,@SA00004                                        1223
         LM    @00,@12,@SA00004+8                                  1223
         BR    @14                                                 1223
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*      INVOKE CATALOG MANAGEMENT TO LOCATE DATA OR INDEX */
*          /*    COMPONENT.                                  @Y30SSFR*/
*          /*      IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR    */
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1224
*          CALL CTLGPROC(LCPLPTR(I+1));                    /*@Y30SSFR*/
*                                                                  1224
@RF01222 LR    @02,I                                               1224
         SLA   @02,2                                               1224
         LA    @02,LCPLPTR(@02)                                    1224
         ST    @02,@AL00001                                        1224
         LA    @01,@AL00001                                        1224
         BAL   @14,CTLGPROC                                        1224
*          RESPECIFY RTNREG RSTD;                                  1225
*          TESTRC = RTNREG;                                        1226
         LR    TESTRC,RTNREG                                       1226
*          RESPECIFY RTNREG UNRSTD;                        /*@Y30SSFR*/
*          IF TESTRC ^= 0                                          1228
*            THEN                                                  1228
         LTR   TESTRC,TESTRC                                       1228
         BZ    @RF01228                                            1228
*              RETURN CODE(LASTCC12);                      /*@Y30SSFR*/
*                                                                  1229
         LA    @15,12                                              1229
         L     @14,@SA00004                                        1229
         LM    @00,@12,@SA00004+8                                  1229
         BR    @14                                                 1229
*          /**********************************************************/
*          /*                                                @Y30SSFR*/
*          /*      CHECK DSATTR FIELD FOR TEMPORARY EXPORT FLAG      */
*          /*    CHECK HURBADS FIELD FOR AN EMPTY DATA SET.  @Y30SSFR*/
*          /*                                                @Y30SSFR*/
*          /**********************************************************/
*                                                                  1230
*          CTGPLPTR = LCPLPTR(I+1);                        /*@Y30SSFR*/
@RF01228 LR    @05,I                                               1230
         SLA   @05,2                                               1230
         L     @05,LCPLPTR(@05)                                    1230
         ST    @05,CTGPLPTR                                        1230
*          CTGFLPTR = CTGFIELD(1);                         /*@Y30SSFR*/
         L     CTGFLPTR,CTGFIELD(,@05)                             1231
*          IF FDSTMPEX = ON                                        1232
*            THEN                                                  1232
         L     @05,CTGFLPT(,CTGFLPTR)                              1232
         TM    FDSTMPEX(@05),B'00000010'                           1232
         BNO   @RF01232                                            1232
*              LDOCNTRL = OFF;                             /*@Y30SSFR*/
         NI    LDOCNTRL,B'01111111'                                1233
*            ELSE                                                  1234
*              DO;                                         /*@Y30SSFR*/
         B     @RC01232                                            1234
@RF01232 DS    0H                                                  1235
*              CTGFLPTR = CTGFIELD(ILHURBAD);              /*@Y30SSFR*/
         L     @02,CTGPLPTR                                        1235
         L     CTGFLPTR,CTGFIELD+4(,@02)                           1235
*              IF FHURBADS = 0 & I = 1                     /*@Y30SSFR*/
*                THEN                                      /*@Y30SSFR*/
         L     @05,CTGFLPT(,CTGFLPTR)                              1236
         L     @05,FHURBADS(,@05)                                  1236
         LTR   @05,@05                                             1236
         BNZ   @RF01236                                            1236
         C     I,@CF00221                                          1236
         BNE   @RF01236                                            1236
*                  DO;                                     /*@Y30SSFR*/
*                  LDOCNTRL = OFF;                         /*@Y30SSFR*/
         NI    LDOCNTRL,B'01111111'                                1238
*                  EMPTYDS = ON;                           /*@Y30SSFR*/
         OI    EMPTYDS,B'10000000'                                 1239
*                  END;                                    /*@Y30SSFR*/
*                ELSE                                      /*@Y30SSFR*/
*                  FNMPTR = FNMPTR + LNAMEDS;              /*@Y30SSFR*/
         B     @RC01236                                            1241
@RF01236 LH    @02,LNAMEDS                                         1241
         AL    @02,FNMPTR                                          1241
         ST    @02,FNMPTR                                          1241
*              END;                                        /*@Y30SSFR*/
*                                                                  1242
@RC01236 DS    0H                                                  1243
*        END LOCLOOP;                                      /*@Y30SSFR*/
*                                                                  1243
@RC01232 AL    I,@CF00221                                          1243
@DE01197 C     I,LOOPCTR                                           1243
         BNH   @DL01197                                            1243
@DC01197 DS    0H                                                  1244
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*        IF THE DUPLICATE ENTRY DOES NOT HAVE THE TEMPORARY*/
*        /*        EXPORT ATTRIBUTE OR IS NOT EMPTY,         @Y30SSFR*/
*        /*        RETURN TO CALLING PROCESSOR               @Y30SSFR*/
*        /*        WITH AN ERROR INDICATED                   @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1244
*        IF LDOCNTRL = ON                                          1244
*          THEN                                                    1244
         TM    LDOCNTRL,B'10000000'                                1244
         BNO   @RF01244                                            1244
*            DO;                                           /*@Y30SSFR*/
*            DARGSMOD = IMPMSG;                            /*@Y30SSFR*/
         L     @01,DDSTRU                                          1246
         MVC   DARGSMOD(3,@01),@CC01000                            1246
*            DEFSTID = DELNTEMP;                           /*@Y30SSFR*/
         MVI   DEFSTID,X'0D'                                       1247
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/
         LA    @15,12                                              1248
         L     @14,@SA00004                                        1248
         LM    @00,@12,@SA00004+8                                  1248
         BR    @14                                                 1248
*            END;                                          /*@Y30SSFR*/
*                                                                  1249
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF WE HAVE AN EMPTY DATA SET TO IMPORT INTO,    @Y30SSFR*/
*        /*  TEST TO BE CERTAIN THAT THE ATTRIBUTES OF THAT  @Y30SSFR*/
*        /*  DATA SET ARE CONSISTENT WITH THOSE OF THE       @Y30SSFR*/
*        /*  PORTABLE DATA SET.                              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1250
*        IF EMPTYDS = ON                                           1250
*          THEN                                                    1250
*                                                                  1250
@RF01244 TM    EMPTYDS,B'10000000'                                 1250
         BNO   @RF01250                                            1250
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CHECK TO BE SURE THAT THE DATA SETS HAVE    @Y30SSFR*/
*            /*  THE SAME NUMBER OF NON-PATH COMPONENTS.     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1251
*            IF NUMCOMP ^= LOOPCTR + 1                     /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LA    @15,1                                               1251
         AL    @15,LOOPCTR                                         1251
         CH    @15,NUMCOMP                                         1251
         BE    @RF01251                                            1251
*                DO;                                       /*@Y30SSFR*/
*                DEFSTID = INCOMPAR;                       /*@Y30SSFR*/
         MVI   DEFSTID,X'11'                                       1253
*                DARGSMOD = IMPMSG;                        /*@Y30SSFR*/
         L     @01,DDSTRU                                          1254
         MVC   DARGSMOD(3,@01),@CC01000                            1254
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
         LA    @15,12                                              1255
         L     @14,@SA00004                                        1255
         LM    @00,@12,@SA00004+8                                  1255
         BR    @14                                                 1255
*                END;                                      /*@Y30SSFR*/
*                                                                  1256
*              /******************************************************/
*              /*                                            @Y30SSFR*/
*              /*  BOTH DATA SETS HAVE THE SAME NUMBER OF    @Y30SSFR*/
*              /*  COMPONENTS.  TEST TO MAKE SURE THAT BOTH  @Y30SSFR*/
*              /*  ARE RRDS'S OR NEITHER IS.  ALSO CHECK FOR @Y30SSFR*/
*              /*  EQUALITY OF KEY LENGTH AND RELATIVE KEY   @Y30SSFR*/
*              /*  POSITION.  MAKE SURE THAT THE MAXIMUM     @Y30SSFR*/
*              /*  LRECL OF THE EMPTY DATA SET IS GREATER    @Y30SSFR*/
*              /*  THAN OR EQUAL TO THAT OF THE PORTABILITY  @Y30SSFR*/
*              /*  DATA SET.                                 @Y30SSFR*/
*              /*                                            @Y30SSFR*/
*              /******************************************************/
*                                                                  1257
*              ELSE                                        /*@Y30SSFR*/
*                DO;                                       /*@Y30SSFR*/
@RF01251 DS    0H                                                  1258
*                CTGPLPTR = LCPLPTR(2);                    /*@Y30SSFR*/
         L     @05,LCPLPTR+4                                       1258
         ST    @05,CTGPLPTR                                        1258
*                CTGFLPTR = CTGFIELD(ILAMDSB);             /*@Y30SSFR*/
         L     CTGFLPTR,CTGFIELD+8(,@05)                           1259
*                DSCCATPT = CTGFLPT(1);                    /*@Y30SSFR*/
         L     DSCCATPT,CTGFLPT(,CTGFLPTR)                         1260
*                AMDSBPTR = FVTPTR(2) -> CTGFVAMD ->       /*@Y30SSFR*/
*                   CTGFLPT(1);                            /*@Y30SSFR*/
         L     @01,FVTPTR+4                                        1261
         L     @01,CTGFVAMD(,@01)                                  1261
         L     AMDSBPTR,CTGFLPT(,@01)                              1261
*                IF (AMDKEYLN ^= AMDSBPTR ->               /*@Y30SSFR*/
*                   AMDKEYLN)                             /*@Y30SSFR*/
*                   (AMDRKP ^= AMDSBPTR ->                 /*@Y30SSFR*/
*                   AMDRKP)                               /*@Y30SSFR*/
*                   (AMDLRECL < AMDSBPTR ->                /*@Y30SSFR*/
*                   AMDLRECL)                              /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         CLC   AMDKEYLN(2,DSCCATPT),AMDKEYLN(AMDSBPTR)             1262
         BNE   @RT01262                                            1262
         CLC   AMDRKP(2,DSCCATPT),AMDRKP(AMDSBPTR)                 1262
         BNE   @RT01262                                            1262
         L     @15,AMDLRECL(,DSCCATPT)                             1262
         C     @15,AMDLRECL(,AMDSBPTR)                             1262
         BNL   @RF01262                                            1262
@RT01262 DS    0H                                                  1263
*                    DO;                                   /*@Y30SSFR*/
*                    DEFSTID = INCOMPAR;                   /*@Y30SSFR*/
         MVI   DEFSTID,X'11'                                       1264
*                    DARGSMOD = IMPMSG;                    /*@Y30SSFR*/
         L     @01,DDSTRU                                          1265
         MVC   DARGSMOD(3,@01),@CC01000                            1265
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/
         LA    @15,12                                              1266
         L     @14,@SA00004                                        1266
         LM    @00,@12,@SA00004+8                                  1266
         BR    @14                                                 1266
*                    END;                                  /*@Y30SSFR*/
*                IF (AMDRRDS = ON & AMDSBPTR ->            /*@Y30SSFR*/
*                    AMDRRDS = OFF)                       /*@Y30SSFR*/
*                   (AMDRRDS = OFF & AMDSBPTR ->           /*@Y30SSFR*/
*                    AMDRRDS = ON)                         /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
@RF01262 TM    AMDRRDS(DSCCATPT),B'00000010'                       1268
         BNO   @GL00022                                            1268
         TM    AMDRRDS(AMDSBPTR),B'00000010'                       1268
         BZ    @RT01268                                            1268
@GL00022 TM    AMDRRDS(DSCCATPT),B'00000010'                       1268
         BNZ   @RF01268                                            1268
         TM    AMDRRDS(AMDSBPTR),B'00000010'                       1268
         BNO   @RF01268                                            1268
@RT01268 DS    0H                                                  1269
*                    DO;                                   /*@Y30SSFR*/
*                    DEFSTID = INCOMPAR;                   /*@Y30SSFR*/
         MVI   DEFSTID,X'11'                                       1270
*                    DARGSMOD = IMPMSG;                    /*@Y30SSFR*/
         L     @01,DDSTRU                                          1271
         MVC   DARGSMOD(3,@01),@CC01000                            1271
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/
         LA    @15,12                                              1272
         L     @14,@SA00004                                        1272
         LM    @00,@12,@SA00004+8                                  1272
         BR    @14                                                 1272
*                    END;                                  /*@Y30SSFR*/
*                END;                                      /*@Y30SSFR*/
*          ELSE                                            /*@Y30SSFR*/
*                                                                  1275
*DUP:        DO;                                           /*@Y30SSFR*/
*                                                                  1275
         B     @RC01250                                            1275
@RF01250 DS    0H                                                  1275
DUP      DS    0H                                                  1276
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  THE TEMPORARY EXPORT FLAG WAS ON- SET UP TO DELETE  */
*            /*  THE EXISTANT CLUSTER ENTRY, AND THEN REDEFINE IT    */
*            /*  USING THE CATALOG INFORMATION SUPPLIED THRO IMPORT  */
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1276
*            CTGPLPTR = PTRCPL;                            /*@Y30SSFR*/
         L     @15,PTRCPL                                          1276
         ST    @15,CTGPLPTR                                        1276
*            CTGFVPTR = CTGFVT;                            /*@Y30SSFR*/
*                                                                  1277
         L     @15,CTGFVT(,@15)                                    1277
         ST    @15,CTGFVPTR                                        1277
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT THE CPL TO BE EMPLOYED FOR THE    @Y30SSFR*/
*            /*  CATALOG MANAGEMENT DELETE FUNCTION.         @Y30SSFR*/
*            /*  IF THE CONSTRUCTION OF THE CPL FAILS, RETURN TO THE */
*            /*  CALLING PROCESSOR INDICATING FAILURE        @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1278
*            CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);    1278
*                                                                  1278
         LA    @14,@CC00807                                        1278
         ST    @14,@AL00001                                        1278
         LA    @14,DCPLPTR                                         1278
         ST    @14,@AL00001+4                                      1278
         LA    @15,CTGFVENT(,@15)                                  1278
         ST    @15,@AL00001+8                                      1278
         LA    @15,NULLPARM                                        1278
         ST    @15,@AL00001+12                                     1278
         LA    @15,CPSWD                                           1278
         ST    @15,@AL00001+16                                     1278
         LA    @01,@AL00001                                        1278
         BAL   @14,CPLPROC                                         1278
*            RESPECIFY RTNREG RSTD;                                1279
*            TESTRC = RTNREG;                                      1280
         LR    TESTRC,RTNREG                                       1280
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*            IF TESTRC ^= 0                                        1282
*              THEN                                                1282
         LTR   TESTRC,TESTRC                                       1282
         BZ    @RF01282                                            1282
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  1283
         LA    @15,12                                              1283
         L     @14,@SA00004                                        1283
         LM    @00,@12,@SA00004+8                                  1283
         BR    @14                                                 1283
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*      CALL DELTPROC TO DELETE THE CLUSTER.    @Y30SSFR*/
*            /*      IF THE DELETE FAILS, RETURN TO THE      @Y30SSFR*/
*            /*    CALLING PROCESSOR.                        @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1284
*            CALL DELTPROC(DCPLPTR);                       /*@Y30SSFR*/
@RF01282 LA    @15,DCPLPTR                                         1284
         ST    @15,@AL00001                                        1284
         LA    @01,@AL00001                                        1284
         BAL   @14,DELTPROC                                        1284
*            RESPECIFY RTNREG RSTD;                                1285
*            TESTRC = RTNREG;                                      1286
         LR    TESTRC,RTNREG                                       1286
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*            IF TESTRC ^= 0                                        1288
*              THEN                                                1288
         LTR   TESTRC,TESTRC                                       1288
         BZ    @RF01288                                            1288
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  1289
         LA    @15,12                                              1289
         L     @14,@SA00004                                        1289
         LM    @00,@12,@SA00004+8                                  1289
         BR    @14                                                 1289
*            END DUP;                                      /*@Y30SSFR*/
*                                                                  1290
@RF01288 DS    0H                                                  1291
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RESET THE VALUE OF DEFSTID TO NORMSTAT TO       @Y30SSFR*/
*        /*  INDICATE THAT ERROR FOUND IN THE FIRST DEFINE   @Y30SSFR*/
*        /*  HAS BEEN RESOLVED.                              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1291
*        DEFSTID = NORMSTAT;                               /*@Y30SSFR*/
*                                                                  1291
@RC01250 MVI   DEFSTID,X'00'                                       1291
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESS    @Y30SSFR*/
*        /*  INDICATED.                                      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1292
*        RETURN CODE(0);                                   /*@Y30SSFR*/
*                                                                  1292
         SLR   @15,@15                                             1292
         L     @14,@SA00004                                        1292
         LM    @00,@12,@SA00004+8                                  1292
         BR    @14                                                 1292
*END DUPNPROC;                                             /*@Y30SSFR*/
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - CPLPROC                                */
*        /*                                                          */
*        /*  FUNCTION - CONSTRUCT A CATALOG PARAMETER LIST (CPL)     */
*        /*  WHICH IS THE PRIMARY CONTROL BLOCK FOR ORGANIZING A     */
*        /*  REQUEST FOR CATALOG MANAGEMENT SERVICES         @Y30SSFR*/
*        /*  THE CPL CONSTRUCTED IN THIS PROCEDURE WILL BE USED FOR  */
*        /*  A CATALOG DEFINE, ALTER, DELETE OR LOCATE OPERATION.    */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    CTYPE - TYPE INDICATOR (DELETE,ALTER,LOCATE,DEFINE    */
*        /*    CPTRCPL - RETURN CELL FOR CPL CONSTRUCTED             */
*        /*    CNAME - NAME OF CLUSTER FOR DELETE OR LOCATE          */
*        /*    CINUM - CONTROL INTERVAL NUMBER FOR LOCATE OF         */
*        /*            CLUSTER COMPONENT                             */
*        /*    CPSWD - OBJECT PASSWORD OR ZERO                       */
*        /*                                                          */
*        /*  OUTPUT - AN INITIALIZED CPL                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1294
*CPLPROC: PROCEDURE(CTYPE,             /*TYPE OF CPL TO BE BUILT     */
*                   CPTRCPL,           /*RETURN CELL FOR CPL POINTER */
*                   CNAME,             /*ADDRESS OF ENTRYNAME OR 0   */
*                   CINUM,             /*CONTROL INTERVAL NUMBER OR 0*/
*                   CCPSWD);           /*ADDRESS OF 8-BYTE PASSWORD  */
*                                                                  1294
CPLPROC  STM   @14,@12,@SA00005                                    1294
         MVC   @PC00005(20),0(@01)                                 1294
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1295
*        DCL                                                       1295
*          CTYPE    CHAR(1),                                       1295
*          CPTRCPL  PTR(31),                                       1295
*          CNAME    PTR(31),                                       1295
*          CINUM    CHAR(3),                                       1295
*          CCPSWD    PTR(31);                                      1295
*                                                                  1295
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL DECLARATIONS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1296
*        DCL LENWKA FIXED(15) CONSTANT(24);                        1296
*                                      /*LENGTH WORK AREA NEEDED FOR */
*                                      /*ALTER, LOCATE, DEFINE       */
*        DCL 1 DELTWKA BDY(WORD),                          /*@Y30SSFR*/
*          2 *     FIXED(15),                              /*@Y30SSFR*/
*          2 *     FIXED(15),                              /*@Y30SSFR*/
*          2 *(12) CHAR(45);                               /*@Y30SSFR*/
*                                      /*WORK AREA FOR DELETE        */
*                                                                  1298
*        DCL CPLPROCI FIXED(31);       /*INDEX USED TO CLEAR @Y30SSFR*/
*                                      /*CATALOG WORK AREA   @Y30SSFR*/
*                                                                  1299
*        /************************************************************/
*        /*                                                          */
*        /*  GET CORE FOR CATALOG PARAMETER LIST(CPL)                */
*        /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO THE     */
*        /*  CALLING PROCEDURE                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1299
*        CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGPL)+16+LENWKA),CPTRCPL,GPID,S
*TZERO);                                                           1299
*                                                                  1299
         L     @03,@PC00001                                        1299
         ST    @03,@AL00001                                        1299
         LA    @15,68                                              1299
         ST    @15,@AFTEMPS+12                                     1299
         LA    @15,@AFTEMPS+12                                     1299
         ST    @15,@AL00001+4                                      1299
         L     @15,@PC00005+4                                      1299
         ST    @15,@AL00001+8                                      1299
         LA    @15,GPID                                            1299
         ST    @15,@AL00001+12                                     1299
         LA    @15,SETZERO                                         1299
         ST    @15,@AL00001+16                                     1299
         MVI   @AL00001+16,X'80'                                   1299
         L     @15,GDTGPL(,@03)                                    1299
         LA    @01,@AL00001                                        1299
         BALR  @14,@15                                             1299
*        RESPECIFY RTNREG RSTD;                                    1300
*        TESTRC = RTNREG;                                          1301
         LR    TESTRC,RTNREG                                       1301
*        RESPECIFY RTNREG UNRSTD;                                  1302
*        IF TESTRC ^= 0                                            1303
*          THEN                                                    1303
         LTR   TESTRC,TESTRC                                       1303
         BZ    @RF01303                                            1303
*            DO;                                                   1304
*            DARGSMOD = UNIVMSG;                                   1305
         L     @01,DDSTRU                                          1305
         MVC   DARGSMOD(3,@01),@CC01023                            1305
*            DEFSTID = NOSTORAG;                                   1306
         MVI   DEFSTID,X'04'                                       1306
*            RETURN CODE(LASTCC12);                                1307
         LA    @15,12                                              1307
         L     @14,@SA00005                                        1307
         LM    @00,@12,@SA00005+8                                  1307
         BR    @14                                                 1307
*            END;                                                  1308
*                                                                  1308
*        /************************************************************/
*        /*                                                          */
*        /*  INITIALIZE CPL WITH INFORMATION COMMON TO ALL 4 CATALOG */
*        /*  MANAGEMENT FUNCTIONS                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1309
*        CTGPLPTR = CPTRCPL;           /*SET CPL BASE POINTER        */
@RF01303 L     @15,@PC00005+4                                      1309
         L     @15,CPTRCPL(,@15)                                   1309
         ST    @15,CTGPLPTR                                        1309
*        CTGWKA = CTGPLPTR + (LENGTH(CTGPL)+16);                   1310
         LA    @14,44                                              1310
         ALR   @14,@15                                             1310
         ST    @14,CTGWKA(,@15)                                    1310
*                                      /*SET WORK AREA ADDRESS       */
*        AREALN = LENWKA;              /*SET WORK AREA LENGTH        */
         MVC   AREALN(2,@14),@CH00312                              1311
*        CTGAM0 = ON;                  /*VSAM REQUEST                */
         OI    CTGAM0(@15),B'00000001'                             1312
*        IF CTYPE ^= 'L'                                           1313
*          THEN                                                    1313
         L     @14,@PC00005                                        1313
         CLI   CTYPE(@14),C'L'                                     1313
         BE    @RF01313                                            1313
*            CTGFUNC = CTGCMS;         /*CMS FUNCTION                */
         NI    CTGFUNC(@15),B'10011111'                            1314
         OI    CTGFUNC(@15),B'10000000'                            1314
*        IF PTRCTACB ^= NULLPTR                                    1315
*          THEN                                                    1315
@RF01313 L     @15,PTRCTACB                                        1315
         LTR   @15,@15                                             1315
         BZ    @RF01315                                            1315
*            CTGCAT = ADDR(PTRCTACB);  /*SET CATALOG ACB ADDR        */
         LA    @15,PTRCTACB                                        1316
         L     @14,CTGPLPTR                                        1316
         ST    @15,CTGCAT(,@14)                                    1316
*          ELSE                                                    1317
*            CTGCNAME = ON;            /*NO CATALOG ACB PASSED       */
*                                                                  1317
         B     @RC01315                                            1317
@RF01315 L     @01,CTGPLPTR                                        1317
         OI    CTGCNAME(@01),B'00000010'                           1317
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE CATALOG PASSWORD IS SPECIFIED IN THE AMS COMMAND,*/
*        /*  PASS IT TO CATALOG MANAGEMENT.  OTHERWISE SEE IF AN     */
*        /*  OBJECT PASSWORD HAS BEEN SUPPLIED BY THE CALLER OF THE  */
*        /*  PROCEDURE                                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1318
*        IF ADDR(CAT) ^= NULLPTR & CATPLN > 0                      1318
*          THEN                                                    1318
@RC01315 L     @15,@PC00001+4                                      1318
         L     @15,FDTPTR+128(,@15)                                1318
         LTR   @15,@15                                             1318
         BZ    @RF01318                                            1318
         CLI   CATPLN(@15),0                                       1318
         BNH   @RF01318                                            1318
*            CTGPSWD = ADDR(CATPAS);                               1319
         LA    @15,CATPAS(,@15)                                    1319
         L     @14,CTGPLPTR                                        1319
         ST    @15,CTGPSWD(,@14)                                   1319
*          ELSE                                                    1320
*            IF CPSWD ^= NULLPTR                                   1320
*              THEN                                                1320
         B     @RC01318                                            1320
@RF01318 L     @15,CPSWD                                           1320
         LTR   @15,@15                                             1320
         BZ    @RF01320                                            1320
*                CTGPSWD = CPSWD;                                  1321
*                                                                  1321
         L     @14,CTGPLPTR                                        1321
         ST    @15,CTGPSWD(,@14)                                   1321
*        /************************************************************/
*        /*                                                          */
*        /*  SET THE APPROPRIATE FLAGS FOR EACH PARTICULAR FUNCTION  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1322
*        /************************************************************/
*        /*                                                          */
*        /*  CATALOG DEFINE FUNCTION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1322
*        IF CTYPE = 'F'                                            1322
*          THEN                                                    1322
@RF01320 DS    0H                                                  1322
@RC01318 L     @15,@PC00005                                        1322
         CLI   CTYPE(@15),C'F'                                     1322
         BNE   @RF01322                                            1322
*            DO;                                                   1323
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */
         L     @15,CTGPLPTR                                        1324
         OI    CTGNAME(@15),B'00000100'                            1324
*            CTGOPTNS = CTGDEFIN;      /*DEFINE FUNCTION             */
         NI    CTGOPTNS(@15),B'00001111'                           1325
         OI    CTGOPTNS(@15),B'00001000'                           1325
*            /* IF SAVRAC DONT RACF-DEFINE PROFILES          @Z40RSSA*/
*            IF ADDR(SRAC) ^= 0 THEN                       /*@Z40RSSA*/
         L     @14,@PC00001+4                                      1326
         L     @14,FDTPTR+136(,@14)                                1326
         LTR   @14,@14                                             1326
         BZ    @RF01326                                            1326
*              CTGNPROF = ON;                              /*@Z40RSSA*/
         OI    CTGNPROF(@15),B'00100000'                           1327
*            END;                                                  1328
*                                                                  1328
@RF01326 DS    0H                                                  1329
*        /************************************************************/
*        /*                                                          */
*        /*  CATALOG LOCATE FUNCTION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1329
*        IF CTYPE = 'L'                                            1329
*          THEN                                                    1329
@RF01322 L     @15,@PC00005                                        1329
         CLI   CTYPE(@15),C'L'                                     1329
         BNE   @RF01329                                            1329
*            CTGFUNC = CTGLOC;         /*CATALOG LOCATE FUNCTION     */
*                                                                  1330
         L     @01,CTGPLPTR                                        1330
         NI    CTGFUNC(@01),B'00111111'                            1330
         OI    CTGFUNC(@01),B'00100000'                            1330
*        /************************************************************/
*        /*                                                          */
*        /*  CATALOG ALTER  FUNCTION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1331
*        IF CTYPE = 'A'                                            1331
*          THEN                                                    1331
@RF01329 L     @15,@PC00005                                        1331
         CLI   CTYPE(@15),C'A'                                     1331
         BNE   @RF01331                                            1331
*            DO;                                                   1332
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */
         L     @15,CTGPLPTR                                        1333
         OI    CTGNAME(@15),B'00000100'                            1333
*            CTGOPTNS = CTGALTER;      /*ALTER FUNCTION              */
         NI    CTGOPTNS(@15),B'00010111'                           1334
         OI    CTGOPTNS(@15),B'00010000'                           1334
*            CTGNUM = ON;              /*SEARCH ONE CATALOG          */
         OI    CTGNUM(@15),B'00000010'                             1335
*            END;                                                  1336
*                                                                  1336
*        /************************************************************/
*        /*                                                          */
*        /*  CATALOG DELETE FUNCTION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1337
*        IF CTYPE = 'D'                                            1337
*          THEN                                                    1337
@RF01331 L     @15,@PC00005                                        1337
         CLI   CTYPE(@15),C'D'                                     1337
         BNE   @RF01337                                            1337
*            DO;                                                   1338
*            /* IF SAVRAC DONT RACF-DELETE PROFILES          @Z40RSSA*/
*            IF ADDR(SRAC) ^= 0 THEN                       /*@Z40RSSA*/
         L     @15,@PC00001+4                                      1339
         L     @15,FDTPTR+136(,@15)                                1339
         LTR   @15,@15                                             1339
         BZ    @RF01339                                            1339
*              CTGNPROF = ON;                              /*@Z40RSSA*/
         L     @01,CTGPLPTR                                        1340
         OI    CTGNPROF(@01),B'00100000'                           1340
*            CTGOPTNS = CTGDELET;      /*DELETE FUNCTION             */
@RF01339 L     @15,CTGPLPTR                                        1341
         NI    CTGOPTNS(@15),B'00011111'                           1341
         OI    CTGOPTNS(@15),B'00011000'                           1341
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */
         OI    CTGNAME(@15),B'00000100'                            1342
*            CTGTYPE = FVTPTR(1) -> CTGFVTYP;              /*@Y30SSFR*/
         L     @14,FVTPTR                                          1343
         MVC   CTGTYPE(1,@15),CTGFVTYP(@14)                        1343
*                                      /*TYPE = CLUSTER OR   @Y30SSFR*/
*                                      /*TYPE = AIX          @Y30SSFR*/
*            IF ADDR(OUTDD) ^= NULLPTR                             1344
*              THEN                                                1344
         L     @14,@PC00001+4                                      1344
         L     @14,FDTPTR+4(,@14)                                  1344
         LTR   @14,@14                                             1344
         BZ    @RF01344                                            1344
*                CTGDDNM = ADDR(OUTDDVAL); /*DDNAME POINTER  @YL026UA*/
         LA    @14,OUTDDVAL(,@14)                                  1345
         ST    @14,CTGDDNM(,@15)                                   1345
*            CTGWKA = ADDR(DELTWKA);   /*SET WORK AREA ADDRESS       */
@RF01344 LA    @15,DELTWKA                                         1346
         L     @14,CTGPLPTR                                        1346
         ST    @15,CTGWKA(,@14)                                    1346
*            AREALN = LENGTH(DELTWKA); /*WORK AREA LENGTH            */
         MVC   AREALN(2,@15),@CH01662                              1347
*            RETURNLN = 0;             /*RETURN LENGTH FROM  @Y30SSFR*/
         SLR   @14,@14                                             1348
         STH   @14,RETURNLN(,@15)                                  1348
*                                      /*CATALOG MANAGEMENT  @Y30SSFR*/
*                                                                  1349
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CLEAR THE REST OF THE WORK AREA FOR VSAM    @Y30SSFR*/
*            /*  CATALOG MANAGEMENT DELETE                   @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1349
*            DO CPLPROCI = 1 TO 12;                        /*@Y30SSFR*/
         LA    CPLPROCI,1                                          1349
@DL01349 DS    0H                                                  1350
*              ENTITEM(CPLPROCI) = ''B;                    /*@Y30SSFR*/
         LR    @03,CPLPROCI                                        1350
         MH    @03,@CH01384                                        1350
         L     @01,CTGPLPTR                                        1350
         L     @01,CTGWKA(,@01)                                    1350
         ALR   @01,@03                                             1350
         AL    @01,@CF01706                                        1350
         XC    ENTITEM-4(45,@01),ENTITEM-4(@01)                    1350
*            END;                                          /*@Y30SSFR*/
*                                                                  1351
         AL    CPLPROCI,@CF00221                                   1351
         C     CPLPROCI,@CF00035                                   1351
         BNH   @DL01349                                            1351
*              /******************************************************/
*              /*                                                    */
*              /*  IF IT IS A TEMPORARY EXPORT ONLY          @Y30SSFR*/
*              /*  CHECK FOR NOERASE ERASE PURGE                     */
*              /*  IF ERASE IS SPECIFIED THEN THE ERASE OVERRIDE     */
*              /*  AND THE ERASE BITS ARE TURNED ON.                 */
*              /*  IF  NOERASE IS SPECIFIED THEN THE ERASE OVERRIDE  */
*              /*  BIT IS ON AND THE ERASE BIT IS TURNED OFF.        */
*              /*  IF NOTHING IS SPECIFIED THEN BOTH ERASE OVERRIDE  */
*              /*  AND ERASE BITS ARE TURNED OFF.                    */
*              /*  IF PRG IS SPECIFIED THEN THE PRG BIT IS TURNED ON.*/
*              /*                                                    */
*              /******************************************************/
*                                                                  1352
*                   IF  ADDR(ERAS)  ^= 0                           1352
*                     THEN DO;                                     1352
         L     @15,@PC00001+4                                      1352
         L     @15,FDTPTR+72(,@15)                                 1352
         LTR   @15,@15                                             1352
         BZ    @RF01352                                            1352
*                           CTGERASE='1'B;                         1354
*                           CTGOVRID='1'B;                         1355
         L     @01,CTGPLPTR                                        1355
         OI    CTGERASE(@01),B'01000100'                           1355
*                           END;                                   1356
*                   IF ADDR(NERAS)  ^=0                            1357
*                     THEN DO;                                     1357
@RF01352 L     @15,@PC00001+4                                      1357
         L     @15,FDTPTR+76(,@15)                                 1357
         LTR   @15,@15                                             1357
         BZ    @RF01357                                            1357
*                           CTGERASE='0'B;                         1359
*                           CTGOVRID='1'B;                         1360
         L     @01,CTGPLPTR                                        1360
         OI    CTGOVRID(@01),B'00000100'                           1360
         NI    CTGERASE(@01),B'10111111'                           1360
*                           END;                                   1361
*                   IF ADDR (PRG)  ^=0                             1362
*                     THEN CTGPURG='1'B;                           1362
*                                                                  1362
@RF01357 L     @15,@PC00001+4                                      1362
         L     @15,FDTPTR+64(,@15)                                 1362
         LTR   @15,@15                                             1362
         BZ    @RF01362                                            1362
         L     @01,CTGPLPTR                                        1363
         OI    CTGPURG(@01),B'00100000'                            1363
*             END;                                                 1364
*                                                                  1364
@RF01362 DS    0H                                                  1365
*        /************************************************************/
*        /*                                                          */
*        /*  FOR DELETE OR LOCATE, SUPPLY ENTRYNAME                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1365
*        IF CTYPE = 'L'  CTYPE ='D'                               1365
*          THEN                                                    1365
@RF01337 L     @15,@PC00005                                        1365
         CLI   CTYPE(@15),C'L'                                     1365
         BE    @RT01365                                            1365
         CLI   CTYPE(@15),C'D'                                     1365
         BNE   @RF01365                                            1365
@RT01365 DS    0H                                                  1366
*            DO;                                                   1366
*            IF CNAME ^= NULLPTR                                   1367
*              THEN                                                1367
         L     @15,@PC00005+8                                      1367
         L     @15,CNAME(,@15)                                     1367
         LTR   @15,@15                                             1367
         BZ    @RF01367                                            1367
*                DO;                                               1368
*                CTGENT = CNAME;       /*SET POINTER TO ENTRY NAME   */
         L     @14,CTGPLPTR                                        1369
         ST    @15,CTGENT(,@14)                                    1369
*                CTGNAME = ON;         /*ENTRY NAME SUPPLIED         */
         OI    CTGNAME(@14),B'00000100'                            1370
*                END;                                              1371
*              ELSE                                                1372
*                CTGENT = ADDR(CINUM); /*SET CONTROL INTERVAL NUMBER */
         B     @RC01367                                            1372
@RF01367 L     @15,@PC00005+12                                     1372
         L     @14,CTGPLPTR                                        1372
         ST    @15,CTGENT(,@14)                                    1372
*            END;                                                  1373
*                                                                  1373
@RC01367 DS    0H                                                  1374
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1374
*        RETURN CODE(0);                                           1374
@RF01365 SLR   @15,@15                                             1374
         L     @14,@SA00005                                        1374
         LM    @00,@12,@SA00005+8                                  1374
         BR    @14                                                 1374
*END CPLPROC;                                                      1375
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - IUNIQPRC                               */
*        /*                                                          */
*        /*  FUNCTION - CHECK THE DSATTR FIELDS TO SEE IF THE DATA   */
*        /*  SET BEING DEFINED IS A UNIQUE DATA SET.  IF SO, A NULL  */
*        /*  SPACE(VOLUME) FVT MUST BE SUPPLIED FOR CATALOG DEFINE   */
*        /*                                                          */
*        /*  INPUT - NONE                                            */
*        /*                                                          */
*        /*  OUTPUT - FOR A UNIQUE DATA SET, A NULL VOLUME FVT WILL  */
*        /*  HAVE BEEN CONSTRUCTED AND A POINTER TO IT PLACED IN THE */
*        /*  CLUSTER FVT                                             */
*        /*  UNIQD AND UNIQI ARE SET TO INDICATE THAT THE    @VS06407*/
*        /*  DATA AND OR INDEX COMPONENTS ARE UNIQUE. THIS   @VS06407*/
*        /*  SETTING IS CHECKED IN CLUSPROC(VOLSMIGR) TO SEE @VS06407*/
*        /*  IF DYNAMIC ALLOCATION OF VOLUMES IS REQUIRED    @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1376
*                                                                  1376
*IUNIQPRC: PROCEDURE;                                              1376
*                                                                  1376
IUNIQPRC STM   @14,@12,12(@13)                                     1376
*        /************************************************************/
*        /*                                                          */
*        /*  GET THE DATA FVT AND CHECK THE DSATTR FIELD FOR UNIQUE  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1377
*        CTGPLPTR = PTRCPL;                                        1377
         L     @15,PTRCPL                                          1377
         ST    @15,CTGPLPTR                                        1377
*        CTGFVPTR = CTGFVT;            /*FVT BASE- CLUSTER           */
         L     @15,CTGFVT(,@15)                                    1378
         ST    @15,CTGFVPTR                                        1378
*        CTGFVPTR = CTGFVDCH;          /*FVT BASE - DATA COMPONENT   */
         L     @15,CTGFVDCH(,@15)                                  1379
         ST    @15,CTGFVPTR                                        1379
*        IF CTGFVATR ^= NULLPTR                                    1380
*          THEN                                                    1380
         L     @15,CTGFVATR(,@15)                                  1380
         LTR   @15,@15                                             1380
         BZ    @RF01380                                            1380
*            DO;                                                   1381
*            CTGFLPTR = CTGFVATR;      /*SET FPL BASE TO DSATTR FPL  */
         LR    CTGFLPTR,@15                                        1382
*            IF FDSUNIQ = ON                                       1383
*              THEN                                                1383
         L     @05,CTGFLPT(,CTGFLPTR)                              1383
         TM    FDSUNIQ(@05),B'01000000'                            1383
         BNO   @RF01383                                            1383
*                DO;                                       /*@VS06407*/
*                UNIQD = ON;           /* INDICATE UNIQUE    @VS06407*/
         OI    UNIQD,B'10000000'                                   1385
*                IMPUNIQ = ON;         /*SET IMPORT UNIQUE FLAG      */
         OI    IMPUNIQ,B'10000000'                                 1386
*                END;                                      /*@VS06407*/
*            END;                                                  1388
*                                                                  1388
@RF01383 DS    0H                                                  1389
*        /************************************************************/
*        /*                                                          */
*        /*  IF AN INDEX FVT IS EXISTANT, CHECK IT ITS DSATTR FIELD  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1389
*        CTGFVPTR = CTGFVT;            /*SET FVT BASE- CLUSTER FVT   */
@RF01380 L     @01,CTGPLPTR                                        1389
         L     @15,CTGFVT(,@01)                                    1389
         ST    @15,CTGFVPTR                                        1389
*        IF CTGFVICH ^= NULLPTR                                    1390
*          THEN                                                    1390
         SLR   @14,@14                                             1390
         L     @15,CTGFVICH(,@15)                                  1390
         CR    @15,@14                                             1390
         BE    @RF01390                                            1390
*            DO;                                                   1391
*            CTGFVPTR = CTGFVICH;      /*SET FVT BASE- INDEX FVT     */
         ST    @15,CTGFVPTR                                        1392
*            IF CTGFVATR ^= NULLPTR                                1393
*              THEN                                                1393
         L     @15,CTGFVATR(,@15)                                  1393
         CR    @15,@14                                             1393
         BE    @RF01393                                            1393
*                DO;                                               1394
*                CTGFLPTR = CTGFVATR;  /*SET FPL BASE- DSATTR FPL    */
         LR    CTGFLPTR,@15                                        1395
*                IF FDSUNIQ = ON                                   1396
*                  THEN                                            1396
         L     @05,CTGFLPT(,CTGFLPTR)                              1396
         TM    FDSUNIQ(@05),B'01000000'                            1396
         BNO   @RF01396                                            1396
*                    DO;                                   /*@VS06407*/
*                    UNIQI = ON;       /* INDICATE UNIQUE    @VS06407*/
         OI    UNIQI,B'10000000'                                   1398
*                    IMPUNIQ = ON;     /*SET IMPORT UNIQUE FLAG      */
         OI    IMPUNIQ,B'10000000'                                 1399
*                    END;                                  /*@VS06407*/
*                END;                                              1401
@RF01396 DS    0H                                                  1402
*            END;                                                  1402
*                                                                  1402
@RF01393 DS    0H                                                  1403
*        /***********************************************************/
*        /*                                                          */
*        /*  IF A DATA SET WAS A UNIQUE DATA SET (HAVING ITS OWN     */
*        /*  DATA SPACE) PRIOR TO EXPORT, IT WILL AGAIN BE DEFINED   */
*        /*  AS A UNIQUE DATA SET.  THIS ENTAILS SUPPLYING A NULL    */
*        /*  SPACE (VOLUME) FVT FOR CATALOG DEFINE                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1403
*        IF IMPUNIQ = ON                                           1403
*          THEN                                                    1403
@RF01390 TM    IMPUNIQ,B'10000000'                                 1403
         BNO   @RF01403                                            1403
*            DO;                                                   1404
*            OLDERID2 = NEWERID2;                                  1405
         L     @15,@PC00001                                        1405
         L     @15,GDTTR2(,@15)                                    1405
         MVC   @TS00001(95),NEWERID2(@15)                          1405
         MVC   OLDERID2(95,@15),@TS00001                           1405
*            NEWID2 = 'MPUQ';                                      1406
         MVC   NEWID2(4,@15),@CC01389                              1406
*            CTGFVPTR = CTGFVT;        /*SET FVT BASE - CLUSTER FVT  */
         L     @01,CTGPLPTR                                        1407
         L     @15,CTGFVT(,@01)                                    1407
         ST    @15,CTGFVPTR                                        1407
*            CTGFVVCH = ADDR(IUNIQFVT);/*SET VOLUME FVT ADDRESS      */
         LA    @14,IUNIQFVT                                        1408
         ST    @14,CTGFVVCH(,@15)                                  1408
*            IUNIQFVT = ''B;           /*ZERO VOLUME FVT             */
*                                                                  1409
         XC    IUNIQFVT(92),IUNIQFVT                               1409
*            /********************************************************/
*            /*                                                      */
*            /*  SET VOLUME INDICATOR IN VOLUME FVT                  */
*            /*                                                      */
*            /********************************************************/
*                                                                  1410
*            CTGFVPTR = CTGFVVCH;      /*SET FVT BASE - VOLUME FVT   */
         ST    @14,CTGFVPTR                                        1410
*            CTGFVTYP = CTGFVVOL;      /*SET TYPE FLAG = VOLUME      */
         MVI   CTGFVTYP(@14),C'V'                                  1411
*            END;                                                  1412
*                                                                  1412
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1413
*        RETURN CODE(0);                                           1413
@RF01403 SLR   @15,@15                                             1413
         L     @14,12(,@13)                                        1413
         LM    @00,@12,20(@13)                                     1413
         BR    @14                                                 1413
*END IUNIQPRC;                                                     1414
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - ALTRPROC                               */
*        /*                                                          */
*        /*  FUNCTION - ALTRPROC WILL CONSTRUCT A CPL AND FVT TO BE  */
*        /*  EMPLOYED BY THE CATALOG ALTER INTERFACE TO ALTER THE    */
*        /*  DSATTR CATALOG FIELDS IF INHIBITTARGET WAS SPECIFIED    */
*        /*  AT THE TIME OF EXPORT OF THE DATA SET.  CTLGPROC WILL   */
*        /*  BE EMPLOYED TO INVOKE CATALOG MANAGEMENT.               */
*        /*                                                          */
*        /*  INPUT - NONE                                            */
*        /*                                                          */
*        /*  OUTPUT - THE ATTRIBUTES CATALOG FIELDS WILL HAVE BEEN   */
*        /*  ALTERED TO PREVENT UPDATING OF THE SOURCE.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1415
*ALTRPROC: PROCEDURE;                                              1415
ALTRPROC STM   @14,@12,@SA00007                                    1415
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1416
*        DCL AFVT CHAR(LENGTH(CTGFV));  /*ALTER FVT                   *
*        DCL APSWD PTR(31);            /*POINTER TO PASSWORD         */
*                                                                  1417
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT CPL AND FVT FOR ALTER INTERFACE IN ORDER TO   */
*        /*  ALTER DSATTR (ATTRIBUTES) CATALOG FIELD FOR DATA        */
*        /*  COMPONENT AND INDEX COMPONENT,IF EXISTANT.              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1418
*        CTGPLPTR = PTRCPL;            /*SET CPL BASE -DEFINE CLUSTER*/
         L     @15,PTRCPL                                          1418
         ST    @15,CTGPLPTR                                        1418
*        CTGFVPTR = CTGFVT;            /*SET FVT BASE - CLUSTER FVT  */
         L     @15,CTGFVT(,@15)                                    1419
         ST    @15,CTGFVPTR                                        1419
*        CTGFVPTR = CTGFVDCH;          /*SET FVT BASE - DATA FVT     */
*                                                                  1420
         L     @15,CTGFVDCH(,@15)                                  1420
         ST    @15,CTGFVPTR                                        1420
*ALTRLP: DO I = 2 TO NUMCOMP;                              /*@Y30SSFR*/
ALTRLP   LA    I,2                                                 1421
         B     @DE01421                                            1421
@DL01421 DS    0H                                                  1422
*        IF CTGFVATR ^= NULLPTR                                    1422
*          THEN                                                    1422
         SLR   @02,@02                                             1422
         L     @15,CTGFVPTR                                        1422
         L     @14,CTGFVATR(,@15)                                  1422
         CR    @14,@02                                             1422
         BE    @RF01422                                            1422
*            DO;                                                   1423
*                                                                  1423
*            /********************************************************/
*            /*                                                      */
*            /*  IF THERE IS AN EXISTANT DSATTR FIELD, TURN ON THE   */
*            /*  TEMPORARY EXPORT FLAG.                              */
*            /*  SINCE THE FPL HAS BEEN EMPLOYED FOR DEFINE,         */
*            /*  IT MUST BE REINITIALIZED.                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1424
*            CTGFLPTR = CTGFVATR;      /*SET FPL BASE - DSATTR FPL   */
         LR    CTGFLPTR,@14                                        1424
*            FDSINHUP = ON;            /*SET INHIBIT UPDATE          */
         L     @05,CTGFLPT(,CTGFLPTR)                              1425
         OI    FDSINHUP(@05),B'00000100'                           1425
*            CTGFLDWA = ''B;           /*ZERO FPL WORK AREA          */
         XC    CTGFLDWA(4,CTGFLPTR),CTGFLDWA(CTGFLPTR)             1426
*            CTGFLCHN = NULLPTR;       /*ZERO CHAIN FIELD            */
*                                                                  1427
         ST    @02,CTGFLCHN(,CTGFLPTR)                             1427
*            /********************************************************/
*            /*                                                      */
*            /*  SET POINTER TO FVT. SET THE TYPE FIELD IN THE FVT,  */
*            /*  THE ENTNAME FIELD TO THE ENTNAME FPL, AND THE       */
*            /*  ATTRIBUTES FIELD TO THE DSATTR FPL                  */
*            /*                                                      */
*            /********************************************************/
*                                                                  1428
*            AFVTPTR = ADDR(AFVT);                                 1428
         LA    AFVTPTR,AFVT                                        1428
*            AFVT = ''B;                                           1429
*                                                                  1429
         XC    AFVT(92),AFVT                                       1429
*            /********************************************************/
*            /*                                                      */
*            /*  SET TYPE FIELD, ENTNAME FPL POINTER AND DSATTR FPL  */
*            /*                                                      */
*            /********************************************************/
*                                                                  1430
*            AFVTPTR -> CTGFVTYP = CTGFVTYP;  /*SET TYPE FIELD       */
         MVC   CTGFVTYP(1,AFVTPTR),CTGFVTYP(@15)                   1430
*            AFVTPTR -> CTGFVENT = CTGFVENT;  /*ENTNAME - ENTRY NAME */
         L     @05,CTGFVENT(,@15)                                  1431
         ST    @05,CTGFVENT(,AFVTPTR)                              1431
*            AFVTPTR -> CTGFVATR = CTGFVATR;  /*SET PTR TO DSATTR FPL*/
         ST    @14,CTGFVATR(,AFVTPTR)                              1432
*            AFVTPTR -> CTGFVIND = ADDR(OUTDDVAL);         /*@Y30SSFR*/
*                                                                  1433
         L     @05,@PC00001+4                                      1433
         L     @05,FDTPTR+4(,@05)                                  1433
         LA    @05,OUTDDVAL(,@05)                                  1433
         ST    @05,CTGFVIND(,AFVTPTR)                              1433
*            /********************************************************/
*            /*                                                      */
*            /*  DETERMINE IF THE DATA OR INDEX COMPONENT IS         */
*            /*  UNIQUELY PASSWORD PROTECTED.  IF SO, SET PASSWORD   */
*            /*  POINTER TO DATA OR INDEX MASTER PASSWORD.           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1434
*            IF CTGFVSTY ^= NULLPTR                                1434
*              THEN                                                1434
         L     @05,CTGFVSTY(,@15)                                  1434
         CR    @05,@02                                             1434
         BE    @RF01434                                            1434
*                APSWD = CTGFVSTY -> CTGFLPT(1);                   1435
         L     @05,CTGFLPT(,@05)                                   1435
         ST    @05,APSWD                                           1435
*              ELSE                                                1436
*                APSWD = CPSWD;                                    1436
*                                                                  1436
         B     @RC01434                                            1436
@RF01434 L     @05,CPSWD                                           1436
         ST    @05,APSWD                                           1436
*            /********************************************************/
*            /*                                                      */
*            /*  NOW BUILD CPL FOR THE CATALOG ALTER                 */
*            /*  IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR      */
*            /*                                                      */
*            /********************************************************/
*                                                                  1437
*            CALL CPLPROC('A',ACPLPTR,NULLPARM,NULLPARM,APSWD);    1437
@RC01434 MVC   @AL00001(16),@AL01437                               1437
         LA    @05,ACPLPTR                                         1437
         ST    @05,@AL00001+4                                      1437
         LA    @05,APSWD                                           1437
         ST    @05,@AL00001+16                                     1437
         LA    @01,@AL00001                                        1437
         BAL   @14,CPLPROC                                         1437
*                                                          /*@OZ33267*/
*                                                                  1438
*            RESPECIFY RTNREG RSTD;                                1438
*            TESTRC = RTNREG;                                      1439
         LR    TESTRC,RTNREG                                       1439
*            RESPECIFY RTNREG UNRSTD;                              1440
*            IF TESTRC ^= 0                                        1441
*              THEN                                                1441
         LTR   TESTRC,TESTRC                                       1441
         BZ    @RF01441                                            1441
*                RETURN CODE(LASTCC12);                            1442
         LA    @15,12                                              1442
         L     @14,@SA00007                                        1442
         LM    @00,@12,@SA00007+8                                  1442
         BR    @14                                                 1442
*            ACPLPTR -> CTGFVT = AFVTPTR;                  /*@Y30SSFR*/
*                                                                  1443
@RF01441 L     @05,ACPLPTR                                         1443
         ST    AFVTPTR,CTGFVT(,@05)                                1443
*            /********************************************************/
*            /*                                                      */
*            /*  INVOKE CATALOG MANAGEMENT  TO ALTER ATTRIBUTES FIELD*/
*            /*  IF ALTER FAILS, RETURN TO CALLER WITH FAILURE       */
*            /*  INDICATED.                                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1444
*            CALL CTLGPROC(ACPLPTR);                               1444
*                                                                  1444
         LA    @02,ACPLPTR                                         1444
         ST    @02,@AL00001                                        1444
         LA    @01,@AL00001                                        1444
         BAL   @14,CTLGPROC                                        1444
*            RESPECIFY RTNREG RSTD;                                1445
*            TESTRC = RTNREG;                                      1446
         LR    TESTRC,RTNREG                                       1446
*            RESPECIFY RTNREG UNRSTD;                              1447
*            IF TESTRC ^= 0                                        1448
*              THEN                                                1448
         LTR   TESTRC,TESTRC                                       1448
         BZ    @RF01448                                            1448
*                RETURN CODE(LASTCC12);                            1449
*                                                                  1449
         LA    @15,12                                              1449
         L     @14,@SA00007                                        1449
         LM    @00,@12,@SA00007+8                                  1449
         BR    @14                                                 1449
*            /********************************************************/
*            /*                                                      */
*            /*  SET POINTERS FOR ALTER OF INDEX FVT.  IF NO INDEX   */
*            /*  CLUSTER COMPONENT, RETURN TO CALLING PROCESSOR      */
*            /*                                                      */
*            /********************************************************/
*                                                                  1450
*            CTGFVPTR =PTRCPL -> CTGFVT;                           1450
@RF01448 L     @02,PTRCPL                                          1450
         L     @02,CTGFVT(,@02)                                    1450
         ST    @02,CTGFVPTR                                        1450
*            IF CTGFVICH = NULLPTR                                 1451
*              THEN                                                1451
         SLR   @15,@15                                             1451
         C     @15,CTGFVICH(,@02)                                  1451
         BNE   @RF01451                                            1451
*                RETURN CODE(0);                                   1452
         L     @14,@SA00007                                        1452
         LM    @00,@12,@SA00007+8                                  1452
         BR    @14                                                 1452
*            CTGFVPTR = CTGFVICH;                                  1453
@RF01451 L     @02,CTGFVPTR                                        1453
         L     @02,CTGFVICH(,@02)                                  1453
         ST    @02,CTGFVPTR                                        1453
*            END;                                                  1454
*        END ALTRLP;                                               1455
*                                                                  1455
@RF01422 AL    I,@CF00221                                          1455
@DE01421 CH    I,NUMCOMP                                           1455
         BNH   @DL01421                                            1455
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1456
*        RETURN CODE(0);                                           1456
         SLR   @15,@15                                             1456
         L     @14,@SA00007                                        1456
         LM    @00,@12,@SA00007+8                                  1456
         BR    @14                                                 1456
*END ALTRPROC;                                                     1457
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - LVLRPROC                               */
*        /*                                                          */
*        /*  FUNCTION - CONSTRUCT FIELD PARAMETER LISTS (FPL'S)      */
*        /*  FOR DEVTYPE (FROM DEVICETYPES PARAMETER IN AMS COMMAND  */
*        /*  OR LISTS FOR LISTVOLS OR LISTRNGS FROM THE LIST         */
*        /*  PARAMETER IN THE AMS COMMAND OR THE RANGES PARAMETER    */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .LX - INDEX TO CORRECT OBJECT PARAMETER IN FDTTBL     */
*        /*    .LFVTPTR - POINTER TO FVT WHERE FPL OR LIST POINTERS  */
*        /*     ARE TO BE INSERTED                                   */
*        /*                                                          */
*        /*  OUTPUT - FPL AND LISTS WILL BE CONSTRUCTED              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1458
*LVLRPROC: PROCEDURE (LX,              /*INDEX TO OBJECT PARAMETER   */
*                    LISTDICT,         /*POINTER TO DICTIONARY FROM  */
*                    LISTWKA,          /*FVT POINTER                 */
*                    LFVTPTR);         /*WORK AREA CONTAINED CATALOG */
LVLRPROC STM   @14,@12,@SA00008                                    1458
         MVC   @PC00008(16),0(@01)                                 1458
*                                      /*FIELD INFORMATION           */
*                                                                  1459
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1459
*        DCL LX       FIXED(31),                                   1459
*            LISTDICT PTR(31),                                     1459
*            LISTWKA  PTR(31),                                     1459
*            LFVTPTR  PTR(31);                                     1459
*                                                                  1459
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  1460
*        DCL FLISTPTR PTR(31);         /*POINTER TO VOL SER LIST     */
*                                                                  1460
*        DCL FDEVTPTR PTR(31);         /*POINTER TO DEVICETYPE FPL   */
*        DCL 1 FDEV BASED(FDEVTPTR),                               1462
*              2 FDEVTYP (*),                                      1462
*                3 FDEVT CHAR(8),      /*DEVICE TYPE                 */
*                3 FDRESV CHAR(4);     /*RESERVED                    */
*        DCL NUMVOL FIXED(15);         /*NUMBER OF VOLUMES   @Y30SSFR*/
*                                                                  1463
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO BE SURE THE VOLUME PARAMETER WAS SPECIFIED     */
*        /*  IN THE AMS COMMAND                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1464
*        OLDERID2 = NEWERID2;                                      1464
         L     @15,@PC00001                                        1464
         L     @14,GDTTR2(,@15)                                    1464
         MVC   @TS00001(95),NEWERID2(@14)                          1464
         MVC   OLDERID2(95,@14),@TS00001                           1464
*        NEWID2 = 'MPLV';                                          1465
*                                                                  1465
         MVC   NEWID2(4,@14),@CC01415                              1465
*        CTGFVPTR = LFVTPTR;                                       1466
*                                                                  1466
         L     @14,@PC00008+12                                     1466
         L     @14,LFVTPTR(,@14)                                   1466
         ST    @14,CTGFVPTR                                        1466
*        /************************************************************/
*        /*                                                          */
*        /*             CONSTRUCT LIST OF VOLUME SERIALS             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1467
*        IF LISTDICT ^= NULLPTR                                    1467
*          THEN                                                    1467
         SLR   @05,@05                                             1467
         L     @04,@PC00008+4                                      1467
         L     @04,LISTDICT(,@04)                                  1467
         CR    @04,@05                                             1467
         BE    @RF01467                                            1467
*            DO;                                                   1468
*                                                                  1468
*            /********************************************************/
*            /*                                                      */
*            /*  PICK UP POINTER TO DICTIONARY ENTRY AND SEE IF A    */
*            /*  VOLUME SERIAL LIST WAS PASSED FOR THIS COMPONENT    */
*            /*                                                      */
*            /********************************************************/
*                                                                  1469
*            DICTPTR = LISTDICT;                                   1469
         ST    @04,DICTPTR                                         1469
*            IF DICTLN(IVOLSER) ^= 0                               1470
*              THEN                                                1470
         L     @04,DICTLN+128(,@04)                                1470
         CR    @04,@05                                             1470
         BE    @RF01470                                            1470
*                DO;                                               1471
*                                                                  1471
         ST    @04,@TF00001                                        1471
*                /****************************************************/
*                /*                                                  */
*                /*  A VOLUME SERIAL LIST WAS PASSED. COMPUTE LENGTH */
*                /*  OF LIST TO BE CONSTRUCTED FOR DEFINE            */
*                /*                                                  */
*                /****************************************************/
*                                                                  1472
*                NUMVOL = DICTLN(IVOLSER) / 6;                     1472
         L     @00,@TF00001                                        1472
         SRDA  @00,32                                              1472
         D     @00,@CF00159                                        1472
         LR    NUMVOL,@01                                          1472
*                TOTLEN = LENGTH(FVOLSERL) * NUMVOL + 2;           1473
*                                                                  1473
         LR    @05,NUMVOL                                          1473
         SLA   @05,3                                               1473
         AL    @05,@CF00156                                        1473
         ST    @05,TOTLEN                                          1473
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVVLT,GPID,SETZERO);
*                                                                  1474
         ST    @15,@AL00001                                        1474
         LA    @05,TOTLEN                                          1474
         ST    @05,@AL00001+4                                      1474
         LA    @05,CTGFVVLT(,@14)                                  1474
         ST    @05,@AL00001+8                                      1474
         LA    @05,GPID                                            1474
         ST    @05,@AL00001+12                                     1474
         LA    @05,SETZERO                                         1474
         ST    @05,@AL00001+16                                     1474
         MVI   @AL00001+16,X'80'                                   1474
         L     @15,GDTGPL(,@15)                                    1474
         LA    @01,@AL00001                                        1474
         BALR  @14,@15                                             1474
*                RESPECIFY RTNREG RSTD;                            1475
*                TESTRC = RTNREG;                                  1476
         LR    TESTRC,RTNREG                                       1476
*                RESPECIFY RTNREG UNRSTD;                          1477
*                                                                  1477
*                /****************************************************/
*                /*                                                  */
*                /*  IF CORE IS NOT OBTAINED SUCCESSFULLY FOR THE    */
*                /*  RETURN TO CALLER WITH AN ERROR INDICATED        */
*                /*                                                  */
*                /****************************************************/
*                                                                  1478
*                IF TESTRC ^= 0                                    1478
*                  THEN                                            1478
         LTR   TESTRC,TESTRC                                       1478
         BZ    @RF01478                                            1478
*                    DO;                                           1479
*                    DEFSTID = NOSTORAG;                           1480
         MVI   DEFSTID,X'04'                                       1480
*                    DARGSMOD = UNIVMSG;                           1481
         L     @01,DDSTRU                                          1481
         MVC   DARGSMOD(3,@01),@CC01023                            1481
*                    RETURN CODE(LASTCC12);                        1482
         LA    @15,12                                              1482
         L     @14,@SA00008                                        1482
         LM    @00,@12,@SA00008+8                                  1482
         BR    @14                                                 1482
*                    END;                                          1483
*                                                                  1483
*                /****************************************************/
*                /*                                                  */
*                /*  CONSTRUCT LISTVOLS VOLUME SERIAL LIST           */
*                /*                                                  */
*                /****************************************************/
*                                                                  1484
*                DO N = 1 TO NUMVOL;                               1484
@RF01478 LA    N,1                                                 1484
         B     @DE01484                                            1484
@DL01484 DS    0H                                                  1485
*                  FVOLSER(N) = (DICTDL(IVOLSER) +LISTWKA + (N-1)  1485
*                    * 6) -> FLVOLSER;                             1485
         LR    @05,N                                               1485
         SLA   @05,3                                               1485
         L     @02,CTGFVPTR                                        1485
         L     @02,CTGFVVLT(,@02)                                  1485
         ALR   @02,@05                                             1485
         AL    @02,@CF01689                                        1485
         L     @05,@PC00008+8                                      1485
         L     @01,DICTPTR                                         1485
         L     @15,DICTDL+128(,@01)                                1485
         AL    @15,LISTWKA(,@05)                                   1485
         LR    @05,N                                               1485
         BCTR  @05,0                                               1485
         MH    @05,@CH00159                                        1485
         ALR   @15,@05                                             1485
         MVC   FVOLSER-4(6,@02),FLVOLSER(@15)                      1485
*                END;                                              1486
         AL    N,@CF00221                                          1486
@DE01484 CR    N,NUMVOL                                            1486
         BNH   @DL01484                                            1486
*                FLISTLN = TOTLEN - 2;                             1487
         L     @01,CTGFVPTR                                        1487
         L     @01,CTGFVVLT(,@01)                                  1487
         L     @00,TOTLEN                                          1487
         BCTR  @00,0                                               1487
         BCTR  @00,0                                               1487
         STH   @00,FLISTLN(,@01)                                   1487
*                IMPF2VOL= ON;                                     1488
         OI    IMPF2VOL,B'10000000'                                1488
*                END;                                              1489
*                                                                  1489
*            /********************************************************/
*            /*                                                      */
*            /*  RETURN TO CALLER WITH A GOOD RETURN CODE            */
*            /*                                                      */
*            /********************************************************/
*                                                                  1490
*            RETURN CODE(0);                                       1490
@RF01470 SLR   @15,@15                                             1490
         L     @14,@SA00008                                        1490
         LM    @00,@12,@SA00008+8                                  1490
         BR    @14                                                 1490
*            END;                                                  1491
*                                                                  1491
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT LIST OF VOLUME SERIALS IF LIST PARAMETER      */
*        /*  WAS SPECIFIED IN THE AMS COMMAND                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  1492
*        IF LISTVPTR(LX) ^= NULLPTR                                1492
*          THEN                                                    1492
@RF01467 L     @15,@PC00008                                        1492
         L     @15,LX(,@15)                                        1492
         SLA   @15,2                                               1492
         L     @14,@PC00001+4                                      1492
         L     @01,FDTPTR+24(,@14)                                 1492
         AL    @01,@CF01689                                        1492
         L     @15,LISTVPTR(@15,@01)                               1492
         LTR   @15,@15                                             1492
         BZ    @RF01492                                            1492
*            DO;                                                   1493
*            TOTLEN = LENGTH(FVOLSERL) * (LISTVPTR(LX)->LISTVCNT) +2;
*                                                                  1494
         LH    @03,LISTVCNT(,@15)                                  1494
         SLA   @03,3                                               1494
         AL    @03,@CF00156                                        1494
         ST    @03,TOTLEN                                          1494
*            /*******************************************************/
*            /*                                                      */
*            /*  GET CORE FOR THE VOLUME SERIAL LIST. IF CORE IS     */
*            /*  NOT OBTAINED SUCCESSFULLY, RETURN TO THE CALLING    */
*            /*  PROCESSOR                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1495
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVVLT,GPID,SETZERO);  1495
*                                                                  1495
         L     @03,@PC00001                                        1495
         ST    @03,@AL00001                                        1495
         LA    @15,TOTLEN                                          1495
         ST    @15,@AL00001+4                                      1495
         L     @01,CTGFVPTR                                        1495
         LA    @15,CTGFVVLT(,@01)                                  1495
         ST    @15,@AL00001+8                                      1495
         LA    @15,GPID                                            1495
         ST    @15,@AL00001+12                                     1495
         LA    @15,SETZERO                                         1495
         ST    @15,@AL00001+16                                     1495
         MVI   @AL00001+16,X'80'                                   1495
         L     @15,GDTGPL(,@03)                                    1495
         LA    @01,@AL00001                                        1495
         BALR  @14,@15                                             1495
*            RESPECIFY RTNREG RSTD;                                1496
*            TESTRC = RTNREG;                                      1497
         LR    TESTRC,RTNREG                                       1497
*            RESPECIFY RTNREG UNRSTD;                              1498
*            IF TESTRC ^= 0                                        1499
*              THEN                                                1499
         LTR   TESTRC,TESTRC                                       1499
         BZ    @RF01499                                            1499
*                DO;                                               1500
*                DARGSMOD = UNIVMSG;                               1501
         L     @01,DDSTRU                                          1501
         MVC   DARGSMOD(3,@01),@CC01023                            1501
*                DEFSTID = NOSTORAG;                               1502
         MVI   DEFSTID,X'04'                                       1502
*                RETURN CODE(LASTCC12);                            1503
         LA    @15,12                                              1503
         L     @14,@SA00008                                        1503
         LM    @00,@12,@SA00008+8                                  1503
         BR    @14                                                 1503
*                END;                                              1504
*                                                                  1504
*            /********************************************************/
*            /*                                                      */
*            /*  CONSTRUCT LIST OF VOLUME SERIAL NUMBERS             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1505
*            DO N = 1 TO (LISTVPTR(LX)->LISTVCNT);                 1505
@RF01499 LA    N,1                                                 1505
         B     @DE01505                                            1505
@DL01505 DS    0H                                                  1506
*              FVOLSER(N) = LISTVPTR(LX) -> LISTVVAL(N);           1506
         LR    @02,N                                               1506
         SLA   @02,3                                               1506
         L     @01,CTGFVPTR                                        1506
         L     @01,CTGFVVLT(,@01)                                  1506
         ALR   @01,@02                                             1506
         AL    @01,@CF01689                                        1506
         L     @15,@PC00008                                        1506
         L     @15,LX(,@15)                                        1506
         SLA   @15,2                                               1506
         L     @14,@PC00001+4                                      1506
         L     @14,FDTPTR+24(,@14)                                 1506
         AL    @14,@CF01689                                        1506
         L     @15,LISTVPTR(@15,@14)                               1506
         ALR   @15,@02                                             1506
         AL    @15,@CF01707                                        1506
         MVC   FVOLSER-4(6,@01),LISTVVAL-3(@15)                    1506
*              END;                                                1507
         AL    N,@CF00221                                          1507
@DE01505 L     @02,@PC00008                                        1507
         L     @02,LX(,@02)                                        1507
         SLA   @02,2                                               1507
         L     @15,@PC00001+4                                      1507
         L     @01,FDTPTR+24(,@15)                                 1507
         AL    @01,@CF01689                                        1507
         L     @02,LISTVPTR(@02,@01)                               1507
         CH    N,LISTVCNT(,@02)                                    1507
         BNH   @DL01505                                            1507
*            FLISTLN = TOTLEN -2;                                  1508
         L     @01,CTGFVPTR                                        1508
         L     @01,CTGFVVLT(,@01)                                  1508
         L     @00,TOTLEN                                          1508
         BCTR  @00,0                                               1508
         BCTR  @00,0                                               1508
         STH   @00,FLISTLN(,@01)                                   1508
*            IMPF2VOL = ON;                                        1509
         OI    IMPF2VOL,B'10000000'                                1509
*            END;                                                  1510
*                                                                  1510
*        /************************************************************/
*        /*                                                          */
*        /*  IF DEVICETYPES WAS SPECIFIED IN THE AMS COMMAND, SET    */
*        /*  UP THE DEVTYP FPL AND FIELD INFORMATION.  THIS          */
*        /*  PARAMETER MAY ONLY BE SPECIFIED FOR  A USER CATALOG     */
*        /*  CONNECT OPERATION.                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1511
*        IF DEVTPTR(LX) ^= NULLPTR & ADDR(CON) ^= NULLPTR          1511
*          THEN                                                    1511
@RF01492 SLR   @15,@15                                             1511
         L     @14,@PC00008                                        1511
         L     @14,LX(,@14)                                        1511
         SLA   @14,2                                               1511
         L     @05,@PC00001+4                                      1511
         L     @01,FDTPTR+32(,@05)                                 1511
         AL    @01,@CF01689                                        1511
         L     @14,DEVTPTR(@14,@01)                                1511
         CR    @14,@15                                             1511
         BE    @RF01511                                            1511
         C     @15,FDTPTR+52(,@05)                                 1511
         BE    @RF01511                                            1511
*            DO;                                                   1512
*                                                                  1512
*            /********************************************************/
*            /*                                                      */
*            /*  GET CORE FOR THE FPL PLUS THE FIELD INFORMATION     */
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  1513
*            TOTLEN = (LENGTH(CTGFL) + 8) + DEVTPTR(LX)->DEVTCNT * 1513
*               LENGTH(FDEVTYP);                                   1513
*                                                                  1513
         LH    @03,DEVTCNT(,@14)                                   1513
         MH    @03,@CH00035                                        1513
         AL    @03,@CF00312                                        1513
         ST    @03,TOTLEN                                          1513
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVDVT,GPID,SETZERO);  1514
*                                                                  1514
         L     @03,@PC00001                                        1514
         ST    @03,@AL00001                                        1514
         LA    @15,TOTLEN                                          1514
         ST    @15,@AL00001+4                                      1514
         L     @01,CTGFVPTR                                        1514
         LA    @15,CTGFVDVT(,@01)                                  1514
         ST    @15,@AL00001+8                                      1514
         LA    @15,GPID                                            1514
         ST    @15,@AL00001+12                                     1514
         LA    @15,SETZERO                                         1514
         ST    @15,@AL00001+16                                     1514
         MVI   @AL00001+16,X'80'                                   1514
         L     @15,GDTGPL(,@03)                                    1514
         LA    @01,@AL00001                                        1514
         BALR  @14,@15                                             1514
*            RESPECIFY RTNREG RSTD;                                1515
*            TESTRC = RTNREG;                                      1516
         LR    TESTRC,RTNREG                                       1516
*            RESPECIFY RTNREG UNRSTD;                              1517
*            IF TESTRC ^= 0                                        1518
*              THEN                                                1518
         LTR   TESTRC,TESTRC                                       1518
         BZ    @RF01518                                            1518
*                DO;                                               1519
*                DARGSMOD = UNIVMSG;                               1520
         L     @01,DDSTRU                                          1520
         MVC   DARGSMOD(3,@01),@CC01023                            1520
*                DEFSTID = NOSTORAG;                               1521
         MVI   DEFSTID,X'04'                                       1521
*                RETURN CODE(LASTCC12);                            1522
         LA    @15,12                                              1522
         L     @14,@SA00008                                        1522
         LM    @00,@12,@SA00008+8                                  1522
         BR    @14                                                 1522
*                END;                                              1523
*                                                                  1523
*            /********************************************************/
*            /*                                                      */
*            /*  CONSTRUCT DEVICETYPES LIST                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1524
*            CTGFLPTR = CTGFVDVT;                                  1524
@RF01518 L     @03,CTGFVPTR                                        1524
         L     @03,CTGFVDVT(,@03)                                  1524
         LR    CTGFLPTR,@03                                        1524
*            FDEVTPTR = CTGFVDVT + LENGTH(CTGFL) +8;               1525
         AL    @03,@CF00312                                        1525
         LR    FDEVTPTR,@03                                        1525
*            DO N = 1 TO  DEVTPTR(LX)->DEVTCNT;                    1526
         LA    N,1                                                 1526
         B     @DE01526                                            1526
@DL01526 DS    0H                                                  1527
*              FDEVT(N) = DEVTPTR(LX) -> DEVTVAL(N,1:8);           1527
         LR    @05,N                                               1527
         MH    @05,@CH00035                                        1527
         ALR   @05,FDEVTPTR                                        1527
         AL    @05,@CF01708                                        1527
         LR    @15,N                                               1527
         MH    @15,@CH00037                                        1527
         L     @14,@PC00008                                        1527
         L     @14,LX(,@14)                                        1527
         SLA   @14,2                                               1527
         L     @01,@PC00001+4                                      1527
         L     @01,FDTPTR+32(,@01)                                 1527
         AL    @01,@CF01689                                        1527
         L     @01,DEVTPTR(@14,@01)                                1527
         ALR   @01,@15                                             1527
         AL    @01,@CF01709                                        1527
         MVC   FDEVT(8,@05),DEVTVAL-3(@01)                         1527
*              END;                                                1528
*                                                                  1528
         AL    N,@CF00221                                          1528
@DE01526 L     @05,@PC00008                                        1528
         L     @05,LX(,@05)                                        1528
         SLA   @05,2                                               1528
         L     @15,@PC00001+4                                      1528
         L     @01,FDTPTR+32(,@15)                                 1528
         AL    @01,@CF01689                                        1528
         L     @05,DEVTPTR(@05,@01)                                1528
         CH    N,DEVTCNT(,@05)                                     1528
         BNH   @DL01526                                            1528
*            /********************************************************/
*            /*                                                      */
*            /*  SET FIELDS IN DEVTYP FPL                            */
*            /*                                                      */
*            /********************************************************/
*                                                                  1529
*            CTGFLDNO = '00000001'B;                               1529
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1529
*            CTGFLDNM = ADDR(FNDEVTYP);                            1530
         LA    @05,FNDEVTYP                                        1530
         ST    @05,CTGFLDNM(,CTGFLPTR)                             1530
*            CTGFLNG(1) = DEVTPTR(LX)->DEVTCNT * LENGTH(FDEVTYP);  1531
         L     @05,@PC00008                                        1531
         L     @05,LX(,@05)                                        1531
         SLA   @05,2                                               1531
         L     @03,@PC00001+4                                      1531
         L     @03,FDTPTR+32(,@03)                                 1531
         AL    @03,@CF01689                                        1531
         L     @05,DEVTPTR(@05,@03)                                1531
         LH    @05,DEVTCNT(,@05)                                   1531
         MH    @05,@CH00035                                        1531
         ST    @05,CTGFLNG(,CTGFLPTR)                              1531
*            CTGFLPT(1) = FDEVTPTR;                                1532
         ST    FDEVTPTR,CTGFLPT(,CTGFLPTR)                         1532
*            END;                                                  1533
*                                                                  1533
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  1534
*        RETURN CODE(0);                                           1534
*                                                                  1534
@RF01511 SLR   @15,@15                                             1534
         L     @14,@SA00008                                        1534
         LM    @00,@12,@SA00008+8                                  1534
         BR    @14                                                 1534
*END LVLRPROC;                                                     1535
*        /************************************************************/
*        /*                                                          */
*        /* PROCEDURE NAME - CTLGPROC                                */
*        /*                                                          */
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/
*        /*  THE OPERATION INDICATED IN THE CPL (LOCATE,ALTER,DELETE)*/
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */
*        /*  INDICATORS                                              */
*        /*                                                          */
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */
*        /*                                                          */
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */
*        /*  FAILURE.  DEFSTID IS SET TO INDICATE MESSAGE ID IF      */
*        /*  AN ERROR MESSAGE IS TO BE LISTED.                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1536
*CTLGPROC: PROCEDURE(SCPLPTR);         /*CPL POINTER                 */
*                                                                  1536
CTLGPROC STM   @14,@12,@SA00009                                    1536
         MVC   @PC00009(4),0(@01)                                  1536
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1537
*        DCL SCPLPTR PTR(31);                                      1537
*                                                                  1537
*        /************************************************************/
*        /*                                                          */
*        /* LOCAL DECLARATIONS                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1538
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */
*                                      /*AM/0 CATALOG MANAGEMENT     */
*        DCL VOLLSTOR CHAR(10) BDY(WORD);                  /*@Y30SSFR*/
*                                      /*STORAGE FOR THE     @Y30SSFR*/
*                                      /*FAKE VOLUMES LIST   @Y30SSFR*/
*                                      /*TO BE PASSED TO     @Y30SSFR*/
*                                      /*DALCPROC WHEN CMS   @Y30SSFR*/
*                                      /*PLACES THE VOLSER   @Y30SSFR*/
*                                      /*TO BE ALLOCATED IN  @Y30SSFR*/
*                                      /*THE WORKAREA.       @Y30SSFR*/
*        DCL VOLLSTPT PTR(31);         /*POINTER TO VOLLSTOR @Y30SSFR*/
*        DCL JX       FIXED(31);       /*INDEX USED IN       @Y30SSFR*/
*                                      /*VOLUME LIST         @Y30SSFR*/
*                                      /*RESTORE             @Y30SSFR*/
*        DCL JX1      FIXED(31);       /*INDEX USED IN       @Y30SSFR*/
*                                      /*VOLUME LIST         @Y30SSFR*/
*                                      /*RESTORE             @Y30SSFR*/
*                                                                  1543
*        /************************************************************/
*        /*                                                          */
*        /*  INVOKE  CATALOG MANAGEMENT                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1543
*        OLDERID2 = NEWERID2;                                      1543
         L     @15,@PC00001                                        1543
         L     @14,GDTTR2(,@15)                                    1543
         MVC   @TS00001(95),NEWERID2(@14)                          1543
         MVC   OLDERID2(95,@14),@TS00001                           1543
*        NEWID2 = 'MPSP';                                          1544
*                                                                  1544
         MVC   NEWID2(4,@14),@CC01427                              1544
*        IF GDTDBG = NULLPTR                                       1545
*          THEN;                                                   1545
         L     @15,GDTDBG(,@15)                                    1545
         LTR   @15,@15                                             1545
         BZ    @RT01545                                            1545
*          ELSE                                                    1547
*            CALL IDCDB010 (GDTTBL,'MPZZ');                        1547
*                                                                  1547
         L     @15,@PC00001                                        1547
         ST    @15,@AL00001                                        1547
         LA    @14,@CC01428                                        1547
         ST    @14,@AL00001+4                                      1547
         MVI   @AL00001+4,X'80'                                    1547
         L     @15,GDTDBG(,@15)                                    1547
         LA    @01,@AL00001                                        1547
         BALR  @14,@15                                             1547
*        CATRTNID = 'CATLGRTN';                                    1548
*                                                                  1548
@RT01545 MVC   CATRTNID(8),@CC01429                                1548
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           1549
*                                                                  1549
         L     @15,@PC00001                                        1549
         ST    @15,@AL00001                                        1549
         L     @14,@PC00009                                        1549
         ST    @14,@AL00001+4                                      1549
         L     @15,GDTCAT(,@15)                                    1549
         LA    @01,@AL00001                                        1549
         BALR  @14,@15                                             1549
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/
*        CATLGRC = REG15;                                          1551
         STH   REG15,CATLGRC                                       1551
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/
*                                                                  1552
*        IF GDTDBG = NULLPTR                                       1553
*          THEN;                                                   1553
         L     @15,@PC00001                                        1553
         L     @15,GDTDBG(,@15)                                    1553
         LTR   @15,@15                                             1553
         BZ    @RT01553                                            1553
*          ELSE                                                    1555
*            CALL IDCDB010 (GDTTBL,'MPZZ');                        1555
*                                                                  1555
         L     @15,@PC00001                                        1555
         ST    @15,@AL00001                                        1555
         LA    @14,@CC01428                                        1555
         ST    @14,@AL00001+4                                      1555
         MVI   @AL00001+4,X'80'                                    1555
         L     @15,GDTDBG(,@15)                                    1555
         LA    @01,@AL00001                                        1555
         BALR  @14,@15                                             1555
*        CTGPLPTR = SCPLPTR;                               /*@Y30SSFR*/
*                                                                  1556
@RT01553 L     @15,@PC00009                                        1556
         L     @15,SCPLPTR(,@15)                                   1556
         ST    @15,CTGPLPTR                                        1556
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1557
*        IF CATLGRC ^= 0                                           1557
*          THEN                                                    1557
         LH    @14,CATLGRC                                         1557
         SLR   @05,@05                                             1557
         CR    @14,@05                                             1557
         BE    @RF01557                                            1557
*            IF CATLGRC = RCWORKSM                                 1558
*              THEN                                                1558
         C     @14,@CF01151                                        1558
         BNE   @RF01558                                            1558
*                DO;                                               1559
*                                                                  1559
*                /****************************************************/
*                /*                                                  */
*                /*  GET NEEDED SIZE FROM CATALOG WORKAREA   @Y30SSFR*/
*                /*                                                  */
*                /****************************************************/
*                                                                  1560
*                WSIZE = RETURNLN;                                 1560
*                                                                  1560
*                                                                  1560
         L     @03,CTGWKA(,@15)                                    1560
         LH    @03,RETURNLN(,@03)                                  1560
         ST    @03,WSIZE                                           1560
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  ZERO OUT CTGWKA, THE POINTER TO THE     @Y30SSFR*/
*                /*  CATALOG WORKAREA.  THE WORKAREA         @Y30SSFR*/
*                /*  IS A PART OF A LARGER AREA THAT WAS     @Y30SSFR*/
*                /*  GOTTEN TO HOLD THE CPL AND THE WORKAREA @Y30SSFR*/
*                /*  AND AS SUCH CANNOT BE FREED INDEPEN-    @Y30SSFR*/
*                /*  DENTLY.                                 @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  1561
*                CTGWKA = NULLPTR;                         /*@Y30SSFR*/
*                                                                  1561
         ST    @05,CTGWKA(,@15)                                    1561
*            /********************************************************/
*            /*                                                      */
*            /*  GET CORE FOR THE LARGER WORK AREA.  IF CORE IS NOT  */
*            /*  OBTAINED SUCCESSFULLY, RETURN TO CALLING PROCESSOR  */
*            /*                                                      */
*            /********************************************************/
*                                                                  1562
*                CALL IDCSAGP0 (GDTTBL,WSIZE,CTGWKA,GPID,SETZERO); 1562
*                                                                  1562
         L     @03,@PC00001                                        1562
         ST    @03,@AL00001                                        1562
         LA    @14,WSIZE                                           1562
         ST    @14,@AL00001+4                                      1562
         LA    @15,CTGWKA(,@15)                                    1562
         ST    @15,@AL00001+8                                      1562
         LA    @15,GPID                                            1562
         ST    @15,@AL00001+12                                     1562
         LA    @15,SETZERO                                         1562
         ST    @15,@AL00001+16                                     1562
         MVI   @AL00001+16,X'80'                                   1562
         L     @15,GDTGPL(,@03)                                    1562
         LA    @01,@AL00001                                        1562
         BALR  @14,@15                                             1562
*                RESPECIFY RTNREG RSTD;                            1563
*                TESTRC = RTNREG;                                  1564
         LR    TESTRC,RTNREG                                       1564
*                RESPECIFY RTNREG UNRSTD;                          1565
*                IF TESTRC ^= 0                                    1566
*                  THEN                                            1566
         LTR   TESTRC,TESTRC                                       1566
         BZ    @RF01566                                            1566
*                    DO;                                           1567
*                    DEFSTID = NOSTORAG;                           1568
         MVI   DEFSTID,X'04'                                       1568
*                    DARGSMOD = UNIVMSG;                           1569
         L     @01,DDSTRU                                          1569
         MVC   DARGSMOD(3,@01),@CC01023                            1569
*                    RETURN CODE(LASTCC12);                        1570
         LA    @15,12                                              1570
         L     @14,@SA00009                                        1570
         LM    @00,@12,@SA00009+8                                  1570
         BR    @14                                                 1570
*                    END;                                          1571
*                                                                  1571
*                AREALN = WSIZE;                                   1572
*                                                                  1572
@RF01566 L     @01,CTGPLPTR                                        1572
         L     @01,CTGWKA(,@01)                                    1572
         L     @00,WSIZE                                           1572
         STH   @00,AREALN(,@01)                                    1572
*                /****************************************************/
*                /*                                                  */
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  1573
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   1573
*                                                                  1573
         L     @15,@PC00001                                        1573
         ST    @15,@AL00001                                        1573
         L     @14,@PC00009                                        1573
         ST    @14,@AL00001+4                                      1573
         L     @15,GDTCAT(,@15)                                    1573
         LA    @01,@AL00001                                        1573
         BALR  @14,@15                                             1573
*                RESPECIFY REG15 RSTD;                     /*@Y30SSFR*/
*                CATLGRC = REG15;                                  1575
         STH   REG15,CATLGRC                                       1575
*                RESPECIFY REG15 UNRSTD;                   /*@Y30SSFR*/
*                END;                                              1577
*              ELSE                                                1578
*                                                                  1578
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  TEST FOR A VSAM CATALOG RETURN CODE OF  @Y30SSFR*/
*                /*  140 WITH A REASON CODE OF 40.  THIS     @Y30SSFR*/
*                /*  INDICATES THAT A VOLUME MUST BE         @Y30SSFR*/
*                /*  DYNAMICALLY ALLOCATED SO THAT ITS CRA   @Y30SSFR*/
*                /*  CAN BE UPDATED.                         @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  1578
*                IF (CATLGRC = DEFALLRC) & (CTGFBFLG =             1578
*                   DEFALLFG)                                      1578
*                  THEN                                            1578
         B     @RC01558                                            1578
@RF01558 CLC   CATLGRC(2),@CH01163                                 1578
         BNE   @RF01578                                            1578
         L     @01,CTGPLPTR                                        1578
         CLC   CTGFBFLG(2,@01),@CH01151                            1578
         BNE   @RF01578                                            1578
*DEFALLC:            DO;                                   /*@Y30SSFR*/
*                                                                  1579
DEFALLC  DS    0H                                                  1580
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  VSAM CATALOG MANAGEMENT IS TO BE    @Y30SSFR*/
*                    /*  INVOKED AGAIN.  RESTORE THE CATALOG @Y30SSFR*/
*                    /*  PARAMETER LISTS TO BE PASSED TO     @Y30SSFR*/
*                    /*  VSAM.                               @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1580
*                    IF (CTGFVT->CTGFVTYP = CTGTCL)       /*@Y30SSFR*/
*                         (CTGFVT->CTGFVTYP = CTGTAIX)     /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         L     @01,CTGPLPTR                                        1580
         L     @15,CTGFVT(,@01)                                    1580
         CLI   CTGFVTYP(@15),C'C'                                  1580
         BE    @RT01580                                            1580
         CLI   CTGFVTYP(@15),C'G'                                  1580
         BNE   @RF01580                                            1580
@RT01580 DS    0H                                                  1581
*DEFCALLC:               DO;                               /*@Y30SSFR*/
DEFCALLC DS    0H                                                  1582
*                        CTGPL = SAVCPL;                   /*@Y30SSFR*/
         L     @01,CTGPLPTR                                        1582
         MVC   CTGPL(28,@01),SAVCPL                                1582
*                        DO JX = 1 TO NUMCOMP;             /*@Y30SSFR*/
         LA    JX,1                                                1583
         B     @DE01583                                            1583
@DL01583 DS    0H                                                  1584
*                          CALL MVDAPROC(TFVTLEN,SAVFVT(JX),       1584
*                             FVTPTR(JX));                 /*@Y30SSFR*/
         LA    @03,TFVTLEN                                         1584
         ST    @03,@AL00001                                        1584
         LR    @03,JX                                              1584
         SLA   @03,2                                               1584
         LA    @15,SAVFVT-4(@03)                                   1584
         ST    @15,@AL00001+4                                      1584
         LA    @03,FVTPTR-4(@03)                                   1584
         ST    @03,@AL00001+8                                      1584
         LA    @01,@AL00001                                        1584
         BAL   @14,MVDAPROC                                        1584
*                          IF CTGFVVLT ^= NULLPTR                  1585
*                            THEN                                  1585
         L     @03,CTGFVPTR                                        1585
         L     @03,CTGFVVLT(,@03)                                  1585
         LTR   @03,@03                                             1585
         BZ    @RF01585                                            1585
*                              DO JX1 = 1 TO (FLISTLN/             1586
*                                 LENGTH(FVOLSERL));       /*@Y30SSFR*/
         LA    JX1,1                                               1586
         B     @DE01586                                            1586
@DL01586 DS    0H                                                  1587
*                                FVOLRTN(JX1) = 0;         /*@Y30SSFR*/
         LR    @15,JX1                                             1587
         SLA   @15,3                                               1587
         L     @01,CTGFVPTR                                        1587
         L     @01,CTGFVVLT(,@01)                                  1587
         ALR   @01,@15                                             1587
         AL    @01,@CF01694                                        1587
         SLR   @00,@00                                             1587
         STCM  @00,3,FVOLRTN-2(@01)                                1587
*                              END;                        /*@Y30SSFR*/
         AL    JX1,@CF00221                                        1588
@DE01586 L     @01,CTGFVPTR                                        1588
         L     @01,CTGFVVLT(,@01)                                  1588
         LH    @00,FLISTLN(,@01)                                   1588
         SRDA  @00,32                                              1588
         D     @00,@CF00039                                        1588
         CR    JX1,@01                                             1588
         BNH   @DL01586                                            1588
*                        END;                              /*@Y30SSFR*/
*                                                                  1589
@RF01585 AL    JX,@CF00221                                         1589
@DE01583 CH    JX,NUMCOMP                                          1589
         BNH   @DL01583                                            1589
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  IF THERE IS A NULL VOLUME       @Y30SSFR*/
*                        /*  FVT, RESTORE THAT.              @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  1590
*                        IF FVTPTR(1) -> CTGFVVCH ^= NULLPTR       1590
*                          THEN                                    1590
         L     @01,FVTPTR                                          1590
         L     @15,CTGFVVCH(,@01)                                  1590
         LTR   @15,@15                                             1590
         BZ    @RF01590                                            1590
*                            DO;                           /*@Y30SSFR*/
*                            IUNIQFVT = ''B;               /*@Y30SSFR*/
         XC    IUNIQFVT(92),IUNIQFVT                               1592
*                            FVTPTR(1) -> CTGFVVCH -> CTGFVTYP     1593
*                               = CTGFVVOL;                /*@Y30SSFR*/
         MVI   CTGFVTYP(@15),C'V'                                  1593
*                            END;                          /*@Y30SSFR*/
*                                                                  1594
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  IF THE OBJECT BEING DEFINED IS  @Y30SSFR*/
*                        /*  AN ALTERNATE INDEX, THEN        @Y30SSFR*/
*                        /*  THEN CMS HAS PLACED THE VOLUME  @Y30SSFR*/
*                        /*  SERIAL OF THE VOLUME TO BE      @Y30SSFR*/
*                        /*  ALLOCATED IN THE WORK AREA.     @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  1595
*                        IF (FVTPTR(1) -> CTGFVTYP = CTGTAIX)      1595
*                          THEN                                    1595
@RF01590 L     @15,FVTPTR                                          1595
         CLI   CTGFVTYP(@15),C'G'                                  1595
         BNE   @RF01595                                            1595
*                            DO;                           /*@Y30SSFR*/
*                                                                  1596
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /*  BUILD A FAKE VOLUMES LIST TO BE     */
*                            /*  PASSED TO DALCPROC.         @Y30SSFR*/
*                            /*  RESPECIFY THE VOLUME LIST   @Y30SSFR*/
*                            /*  OVERLAY TO BE BASED ON VOLLSTPT     */
*                            /*  AND ESTABLISH ADDRESSABILITY TO     */
*                            /*  THE STORAGE FOR THE VOLUME LIST.    */
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                                                                  1597
*                            RESPECIFY FLISTVOL BASED(VOLLSTPT);   1597
*                            VOLLSTPT = ADDR(VOLLSTOR);    /*@Y30SSFR*/
*                                                                  1598
         LA    @14,VOLLSTOR                                        1598
         ST    @14,VOLLSTPT                                        1598
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /*  BUILD THE FAKE VOLUMES LIST AND     */
*                            /*  CALL DALCPROC.              @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                                                                  1599
*                            FLISTLN = LENGTH(FVOLSERL(1));/*@Y30SSFR*/
         MVC   FLISTLN(2,@14),@CH00039                             1599
*                            FVOLSER(1) = CATRCWKA;        /*@Y30SSFR*/
*                                                                  1600
         MVC   FVOLSER(6,@14),CATRCWKA                             1600
*                            CALL DALCPROC('A',VOLLSTPT,           1601
*                               FVTPTR(1) -> CTGFVIND,DALCINDX);   1601
*                                                                  1601
         LA    @14,@CC00811                                        1601
         ST    @14,@AL00001                                        1601
         LA    @14,VOLLSTPT                                        1601
         ST    @14,@AL00001+4                                      1601
         LA    @15,CTGFVIND(,@15)                                  1601
         ST    @15,@AL00001+8                                      1601
         LA    @15,DALCINDX                                        1601
         ST    @15,@AL00001+12                                     1601
         LA    @01,@AL00001                                        1601
         BAL   @14,DALCPROC                                        1601
*                            /****************************************/
*                            /*                              @Y30SSFR*/
*                            /*  TEST THE RETURN CODE FROM   @Y30SSFR*/
*                            /*  DALCPROC.  IF IT IS NON-ZERO,       */
*                            /*  INDICATE A FAILURE, AND RETURN      */
*                            /*  TO THE CALLING PROCESSOR.   @Y30SSFR*/
*                            /*                              @Y30SSFR*/
*                            /****************************************/
*                                                                  1602
*                            RESPECIFY RTNREG RSTD;                1602
*                            TESTRC = RTNREG;                      1603
         LR    TESTRC,RTNREG                                       1603
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSFR*/
*                            IF TESTRC ^= 0                        1605
*                              THEN                                1605
         LTR   TESTRC,TESTRC                                       1605
         BZ    @RF01605                                            1605
*                                RETURN CODE(LASTCC12);    /*@Y30SSFR*/
         LA    @15,12                                              1606
         L     @14,@SA00009                                        1606
         LM    @00,@12,@SA00009+8                                  1606
         BR    @14                                                 1606
*                            RESPECIFY FLISTVOL                    1607
*                               BASED(CTGFVVLT);           /*@Y30SSFR*/
@RF01605 DS    0H                                                  1608
*                            END;                          /*@Y30SSFR*/
*                                                                  1608
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF THERE IS A DATA COMPONENT PRESENT,       */
*                    /*  DYNAMICALLY ALLOCATE THE VOLUMES FROM       */
*                    /*  THE VOLUMES LIST AT THE DATA LEVEL. @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1609
*                    IF FVTPTR(2) ^= NULLPTR                       1609
*                      THEN                                        1609
@RF01595 SLR   @15,@15                                             1609
         L     @14,FVTPTR+4                                        1609
         CR    @14,@15                                             1609
         BE    @RF01609                                            1609
*                        IF (FVTPTR(2) -> CTGFVIND = NULLPTR)      1610
*                           & (FVTPTR(2) -> CTGFVVLT ^=            1610
*                           NULLPTR)                               1610
*                          THEN                                    1610
         C     @15,CTGFVIND(,@14)                                  1610
         BNE   @RF01610                                            1610
         C     @15,CTGFVVLT(,@14)                                  1610
         BE    @RF01610                                            1610
*                            DO;                           /*@Y30SSFR*/
*                            CALL DALCPROC('A',                    1612
*                               FVTPTR(2) -> CTGFVVLT,             1612
*                               FVTPTR(2) -> CTGFVIND,             1612
*                               DALCINDX);                 /*@Y30SSFR*/
         LA    @15,@CC00811                                        1612
         ST    @15,@AL00001                                        1612
         LA    @15,CTGFVVLT(,@14)                                  1612
         ST    @15,@AL00001+4                                      1612
         LA    @15,CTGFVIND(,@14)                                  1612
         ST    @15,@AL00001+8                                      1612
         LA    @15,DALCINDX                                        1612
         ST    @15,@AL00001+12                                     1612
         LA    @01,@AL00001                                        1612
         BAL   @14,DALCPROC                                        1612
*                            RESPECIFY RTNREG RSTD;                1613
*                            TESTRC = RTNREG;                      1614
         LR    TESTRC,RTNREG                                       1614
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSFR*/
*                            IF TESTRC ^= 0                        1616
*                              THEN                                1616
         LTR   TESTRC,TESTRC                                       1616
         BZ    @RF01616                                            1616
*                                RETURN CODE(LASTCC12);    /*@Y30SSFR*/
         LA    @15,12                                              1617
         L     @14,@SA00009                                        1617
         LM    @00,@12,@SA00009+8                                  1617
         BR    @14                                                 1617
*                            END;                          /*@Y30SSFR*/
*                                                                  1618
@RF01616 DS    0H                                                  1619
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  IF THERE IS AN INDEX COMPONENT PRESENT,     */
*                    /*  DYNAMICALLY ALLOCATE THE VOLUMES FROM       */
*                    /*  THE VOLUMES LIST AT THE INDEX LEVEL.        */
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1619
*                    IF FVTPTR(3) ^= NULLPTR                       1619
*                      THEN                                        1619
@RF01610 DS    0H                                                  1619
@RF01609 SLR   @15,@15                                             1619
         L     @14,FVTPTR+8                                        1619
         CR    @14,@15                                             1619
         BE    @RF01619                                            1619
*                        IF (FVTPTR(3) -> CTGFVIND = NULLPTR)      1620
*                           & (FVTPTR(3) -> CTGFVVLT ^=            1620
*                           NULLPTR)                               1620
*                          THEN                                    1620
         C     @15,CTGFVIND(,@14)                                  1620
         BNE   @RF01620                                            1620
         C     @15,CTGFVVLT(,@14)                                  1620
         BE    @RF01620                                            1620
*                            DO;                           /*@Y30SSFR*/
*                            CALL DALCPROC('A',                    1622
*                               FVTPTR(3) -> CTGFVVLT,             1622
*                               FVTPTR(3) -> CTGFVIND,             1622
*                               DALCINDX);                 /*@Y30SSFR*/
         LA    @15,@CC00811                                        1622
         ST    @15,@AL00001                                        1622
         LA    @15,CTGFVVLT(,@14)                                  1622
         ST    @15,@AL00001+4                                      1622
         LA    @15,CTGFVIND(,@14)                                  1622
         ST    @15,@AL00001+8                                      1622
         LA    @15,DALCINDX                                        1622
         ST    @15,@AL00001+12                                     1622
         LA    @01,@AL00001                                        1622
         BAL   @14,DALCPROC                                        1622
*                            RESPECIFY RTNREG RSTD;                1623
*                            TESTRC = RTNREG;                      1624
         LR    TESTRC,RTNREG                                       1624
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSFR*/
*                            IF TESTRC ^= 0                        1626
*                              THEN                                1626
         LTR   TESTRC,TESTRC                                       1626
         BZ    @RF01626                                            1626
*                                RETURN CODE(LASTCC12);    /*@Y30SSFR*/
         LA    @15,12                                              1627
         L     @14,@SA00009                                        1627
         LM    @00,@12,@SA00009+8                                  1627
         BR    @14                                                 1627
*                            END;                          /*@Y30SSFR*/
*                        END DEFCALLC;                     /*@Y30SSFR*/
*                      ELSE                                        1630
*DEFPALLC:               DO;                               /*@Y30SSFR*/
*                                                                  1630
         B     @RC01580                                            1630
@RF01580 DS    0H                                                  1630
DEFPALLC DS    0H                                                  1631
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  HANDLE 140-40 FOR PATHS.        @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  1631
*                        CTGPL = PSAVCPL;                  /*@Y30SSFR*/
*                                                                  1631
         L     @15,CTGPLPTR                                        1631
         MVC   CTGPL(28,@15),PSAVCPL                               1631
*                        /********************************************/
*                        /*                                  @Y30SSFR*/
*                        /*  SET CTGFVT TO POINT TO THE FVT  @Y30SSFR*/
*                        /*  FOR THE PATH DEFINE OPERATION.  @Y30SSFR*/
*                        /*                                  @Y30SSFR*/
*                        /********************************************/
*                                                                  1632
*                        CTGFVT = PFVTPTR;                 /*@Y30SSFR*/
*                                                                  1632
         L     @14,PFVTPTR                                         1632
         ST    @14,CTGFVT(,@15)                                    1632
*                        /********************************************/
*                        /*                                  #Y30SSFR*/
*                        /*  IF THE OBJECT BEING DEFINED IS  #Y30SSFR*/
*                        /*  A PATH, THEN                    #Y30SSFR*/
*                        /*  THEN CMS HAS PLACED THE VOLUME  #Y30SSFR*/
*                        /*  SERIAL OF THE VOLUME TO BE      #Y30SSFR*/
*                        /*  ALLOCATED IN THE WORK AREA.     #Y30SSFR*/
*                        /*                                  #Y30SSFR*/
*                        /********************************************/
*                                                                  1633
*                        IF (PFVTPTR -> CTGFVTYP = CTGTPTH)        1633
*                          THEN                                    1633
         CLI   CTGFVTYP(@14),C'R'                                  1633
         BNE   @RF01633                                            1633
*                            DO;                           /*#Y30SSFR*/
*                                                                  1634
*                            /****************************************/
*                            /*                              #Y30SSFR*/
*                            /*  BUILD A FAKE VOLUMES LIST TO BE     */
*                            /*  PASSED TO DALCPROC.         #Y30SSFR*/
*                            /*  RESPECIFY THE VOLUME LIST   #Y30SSFR*/
*                            /*  OVERLAY TO BE BASED ON VOLLSTPT     */
*                            /*  AND ESTABLISH ADDRESSABILITY TO     */
*                            /*  THE STORAGE FOR THE VOLUME LIST.    */
*                            /*                              #Y30SSFR*/
*                            /****************************************/
*                                                                  1635
*                            RESPECIFY FLISTVOL BASED(VOLLSTPT);   1635
*                            VOLLSTPT = ADDR(VOLLSTOR);    /*#Y30SSFR*/
*                                                                  1636
         LA    @15,VOLLSTOR                                        1636
         ST    @15,VOLLSTPT                                        1636
*                            /****************************************/
*                            /*                              #Y30SSFR*/
*                            /*  BUILD THE FAKE VOLUMES LIST AND     */
*                            /*  CALL DALCPROC.              #Y30SSFR*/
*                            /*                              #Y30SSFR*/
*                            /****************************************/
*                                                                  1637
*                            FLISTLN = LENGTH(FVOLSERL(1));/*#Y30SSFR*/
         MVC   FLISTLN(2,@15),@CH00039                             1637
*                            FVOLSER(1) = CATRCWKA;        /*#Y30SSFR*/
*                                                                  1638
         MVC   FVOLSER(6,@15),CATRCWKA                             1638
*                            CALL DALCPROC('A',VOLLSTPT,           1639
*                               PFVTPTR -> CTGFVIND,DALCINDX);     1639
*                                                                  1639
         LA    @15,@CC00811                                        1639
         ST    @15,@AL00001                                        1639
         LA    @15,VOLLSTPT                                        1639
         ST    @15,@AL00001+4                                      1639
         LA    @15,CTGFVIND(,@14)                                  1639
         ST    @15,@AL00001+8                                      1639
         LA    @15,DALCINDX                                        1639
         ST    @15,@AL00001+12                                     1639
         LA    @01,@AL00001                                        1639
         BAL   @14,DALCPROC                                        1639
*                            /****************************************/
*                            /*                              #Y30SSFR*/
*                            /*  TEST THE RETURN CODE FROM   #Y30SSFR*/
*                            /*  DALCPROC.  IF IT IS NON-ZERO,       */
*                            /*  INDICATE A FAILURE, AND RETURN      */
*                            /*  TO THE CALLING PROCESSOR.   #Y30SSFR*/
*                            /*                              #Y30SSFR*/
*                            /****************************************/
*                                                                  1640
*                            RESPECIFY RTNREG RSTD;                1640
*                            TESTRC = RTNREG;                      1641
         LR    TESTRC,RTNREG                                       1641
*                            RESPECIFY RTNREG UNRSTD;      /*#Y30SSFR*/
*                            IF TESTRC ^= 0                        1643
*                              THEN                                1643
         LTR   TESTRC,TESTRC                                       1643
         BZ    @RF01643                                            1643
*                                RETURN CODE(LASTCC12);    /*#Y30SSFR*/
         LA    @15,12                                              1644
         L     @14,@SA00009                                        1644
         LM    @00,@12,@SA00009+8                                  1644
         BR    @14                                                 1644
*                            RESPECIFY FLISTVOL                    1645
*                               BASED(CTGFVVLT);           /*#Y30SSFR*/
@RF01643 DS    0H                                                  1646
*                            END;                          /*#Y30SSFR*/
*                        END DEFPALLC;                     /*#Y30SSFR*/
*                                                                  1647
@RF01633 DS    0H                                                  1648
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  NOW CALL VSAM CATALOG MANAGEMENT AGAIN. #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  1648
*                CALL IDCSACA0(GDTTBL,SCPLPTR);            /*#Y30SSFR*/
*                                                                  1648
@RC01580 L     @15,@PC00001                                        1648
         ST    @15,@AL00001                                        1648
         L     @14,@PC00009                                        1648
         ST    @14,@AL00001+4                                      1648
         L     @15,GDTCAT(,@15)                                    1648
         LA    @01,@AL00001                                        1648
         BALR  @14,@15                                             1648
*                RESPECIFY REG15 RSTD;                     /*#Y30SSFR*/
*                CATLGRC = REG15;                          /*#Y30SSFR*/
         STH   REG15,CATLGRC                                       1650
*                RESPECIFY REG15 UNRSTD;                   /*#Y30SSFR*/
*                                                                  1651
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  CALL DALCPROC TO DYNAMICALLY UNALLOCATE #Y30SSFR*/
*                /*  THE VOLUMES ALLOCATED.                  #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  1652
*                CALL DALCPROC('D',NULLPARM,NULLPARM,              1652
*                   DALCINDX);                             /*#Y30SSFR*/
         MVC   @AL00001(12),@AL01652                               1652
         LA    @15,DALCINDX                                        1652
         ST    @15,@AL00001+12                                     1652
         LA    @01,@AL00001                                        1652
         BAL   @14,DALCPROC                                        1652
*                RESPECIFY RTNREG RSTD;                            1653
*                TESTRC = RTNREG;                                  1654
         LR    TESTRC,RTNREG                                       1654
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/
*                IF TESTRC ^= 0                                    1656
*                  THEN                                            1656
         LTR   TESTRC,TESTRC                                       1656
         BZ    @RF01656                                            1656
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/
         LA    @15,12                                              1657
         L     @14,@SA00009                                        1657
         LM    @00,@12,@SA00009+8                                  1657
         BR    @14                                                 1657
*                END DEFALLC;                              /*#Y30SSFR*/
*                                                                  1658
@RF01656 DS    0H                                                  1659
*        IF CATLGRC ^= 0 &                                 /*#Y30SSFR*/
*             (IMPF2NER = OFF  CATLGRC ^= DUPNAME)        /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
@RF01578 DS    0H                                                  1659
@RC01558 DS    0H                                                  1659
@RF01557 LH    @15,CATLGRC                                         1659
         LTR   @15,@15                                             1659
         BZ    @RF01659                                            1659
         TM    IMPF2NER,B'00001000'                                1659
         BZ    @RT01659                                            1659
         C     @15,@CF00039                                        1659
         BE    @RF01659                                            1659
@RT01659 DS    0H                                                  1660
*ERCALL1:    DO;                                           /*#Y30SSFR*/
*                                                                  1660
ERCALL1  DS    0H                                                  1661
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     #Y30SSFR*/
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1661
*            ERRORTAB = ''B;                               /*#Y30SSFR*/
*                                                                  1661
         XC    ERRORTAB(32),ERRORTAB                               1661
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    #Y30SSFR*/
*            /*  THE ERROR CONVERSION TABLE.                 #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1662
*            ERCNVADR = ADDR(ERRORTAB);                    /*#Y30SSFR*/
*                                                                  1662
         LA    @15,ERRORTAB                                        1662
         ST    @15,ERCNVADR                                        1662
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  #Y30SSFR*/
*            /*  IS A CATALOG ERROR.  DETERMINE THE CMS      #Y30SSFR*/
*            /*  FUNCTION BEING PERFORMED, AND SET THE       #Y30SSFR*/
*            /*  APPROPRIATE EROPER BIT.                     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1663
*            ERCATLG = ON;                                 /*#Y30SSFR*/
         OI    ERCATLG(@15),B'10000000'                            1663
*            IF CTGFUNC = CTGLOC                                   1664
*              THEN                                                1664
*                                                                  1664
         L     @01,CTGPLPTR                                        1664
         TM    CTGFUNC(@01),B'00100000'                            1664
         BNO   @RF01664                                            1664
         TM    CTGFUNC(@01),B'11000000'                            1664
         BNZ   @RF01664                                            1664
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  THE OPERATION WAS A LOCATE.  SET        #Y30SSFR*/
*                /*  ERCATLC.                                #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  1665
*                ERCATLC = ON;                             /*#Y30SSFR*/
         OI    ERCATLC(@15),B'10000000'                            1665
*              ELSE                                                1666
*                IF CTGOPTNS = CTGALTER                            1666
*                  THEN                                            1666
*                                                                  1666
         B     @RC01664                                            1666
@RF01664 L     @01,CTGPLPTR                                        1666
         TM    CTGOPTNS(@01),B'00010000'                           1666
         BNO   @RF01666                                            1666
         TM    CTGOPTNS(@01),B'11101000'                           1666
         BNZ   @RF01666                                            1666
*                    /************************************************/
*                    /*                                      #Y30SSFR*/
*                    /*  THE CATALOG OPERATION IS AN ALTER.  #Y30SSFR*/
*                    /*  SET ERCATAL TO BE ON.               #Y30SSFR*/
*                    /*                                      #Y30SSFR*/
*                    /************************************************/
*                                                                  1667
*                    ERCATAL = ON;                         /*#Y30SSFR*/
         L     @01,ERCNVADR                                        1667
         OI    ERCATAL(@01),B'00010000'                            1667
*                  ELSE                                            1668
*                    IF CTGOPTNS = CTGDEFIN                        1668
*                      THEN                                        1668
*                                                                  1668
         B     @RC01666                                            1668
@RF01666 L     @01,CTGPLPTR                                        1668
         TM    CTGOPTNS(@01),B'00001000'                           1668
         BNO   @RF01668                                            1668
         TM    CTGOPTNS(@01),B'11110000'                           1668
         BNZ   @RF01668                                            1668
*                        /********************************************/
*                        /*                                  #Y30SSFR*/
*                        /*  THE CATALOG OPERATION WAS A     #Y30SSFR*/
*                        /*  DEFINE.  SET ERCATDE TO BE      #Y30SSFR*/
*                        /*  ON.                             #Y30SSFR*/
*                        /*                                  #Y30SSFR*/
*                        /********************************************/
*                                                                  1669
*                        ERCATDE = ON;                     /*#Y30SSFR*/
*                                                                  1669
         L     @01,ERCNVADR                                        1669
         OI    ERCATDE(@01),B'01000000'                            1669
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  #Y30SSFR*/
*            /*  POINT TO THE CPL FOR THE CATALOG OPERATION. #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1670
*            ERCATRC = CATLGRC;                            /*#Y30SSFR*/
@RF01668 DS    0H                                                  1670
@RC01666 DS    0H                                                  1670
@RC01664 L     @15,ERCNVADR                                        1670
         LH    @14,CATLGRC                                         1670
         ST    @14,ERCATRC(,@15)                                   1670
*            ERCPLPT = CTGPLPTR;                           /*#Y30SSFR*/
*                                                                  1671
         L     @14,CTGPLPTR                                        1671
         ST    @14,ERCPLPT(,@15)                                   1671
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET A POINTER TO THE ENTRY NAME IN THE      #Y30SSFR*/
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1672
*            IF ERCATLC = ON                               /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         TM    ERCATLC(@15),B'10000000'                            1672
         BNO   @RF01672                                            1672
*                ERDSNM = CTGENT;                          /*#Y30SSFR*/
         L     @14,CTGENT(,@14)                                    1673
         ST    @14,ERDSNM(,@15)                                    1673
*              ELSE                                        /*#Y30SSFR*/
*                ERDSNM = CTGFVT -> CTGFVENT;              /*#Y30SSFR*/
*                                                                  1674
         B     @RC01672                                            1674
@RF01672 L     @01,CTGPLPTR                                        1674
         L     @01,CTGFVT(,@01)                                    1674
         L     @15,CTGFVENT(,@01)                                  1674
         L     @14,ERCNVADR                                        1674
         ST    @15,ERDSNM(,@14)                                    1674
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    #Y30SSFR*/
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1675
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*#Y30SSFR*/
@RC01672 L     @15,@PC00001                                        1675
         ST    @15,@AL00001                                        1675
         LA    @14,ERCNVADR                                        1675
         ST    @14,@AL00001+4                                      1675
         MVI   @AL00001+4,X'80'                                    1675
         L     @15,GDTERR(,@15)                                    1675
         LA    @01,@AL00001                                        1675
         BALR  @14,@15                                             1675
*            END ERCALL1;                                  /*#Y30SSFR*/
*                                                                  1676
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING THE RESULT.        #Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1677
*        IF CATLGRC ^= 0                                   /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
@RF01659 LH    @15,CATLGRC                                         1677
         LTR   @15,@15                                             1677
         BZ    @RF01677                                            1677
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/
         LA    @15,12                                              1678
         L     @14,@SA00009                                        1678
         LM    @00,@12,@SA00009+8                                  1678
         BR    @14                                                 1678
*          ELSE                                            /*#Y30SSFR*/
*            RETURN CODE(0);                               /*#Y30SSFR*/
*                                                                  1679
@RF01677 SLR   @15,@15                                             1679
         L     @14,@SA00009                                        1679
         LM    @00,@12,@SA00009+8                                  1679
         BR    @14                                                 1679
*END CTLGPROC;                                                     1680
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  PROCEDURE NAME - DELTPROC                       #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /*  FUNCTION - PERFORMS ALL CALLS TO CATALOG        #Y30SSFR*/
*        /*  DELETE.  WILL ITERATIVELY CALL CATALOG          #Y30SSFR*/
*        /*  DELETE IF NECESSARY TO DELETE ALL OF THE        #Y30SSFR*/
*        /*  OBJECT.                                         #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /*  INPUT - A POINTER TO A CPL                      #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /*  OUTPUT - A PRINTED LIST OF ITEMS DELETED AND    #Y30SSFR*/
*        /*  ANY APPROPRIATE ERROR MESSAGES.                 #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1681
*DELTPROC: PROCEDURE(DLCPLPTR);                            /*#Y30SSFR*/
*                                                                  1681
DELTPROC STM   @14,@12,@SA00010                                    1681
         MVC   @PC00010(4),0(@01)                                  1681
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  ARGUMENTS OF INVOCATION                         #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1682
*        DCL DLCPLPTR PTR(31);         /*POINTER TO THE CPL  #Y30SSFR*/
*                                                                  1682
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  LOCAL DECLARATIONS                              #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1683
*        DCL DSAVCPL CHAR(LENGTH(CTGPL));                  /*#Y30SSFR*/
*                                      /*SAVE AREA FOR       #Y30SSFR*/
*                                      /*DELETE CPL          #Y30SSFR*/
*        DCL IX1 FIXED(31);            /*IX1 AND K ARE       #Y30SSFR*/
*                                      /*USED FOR LOOP       #Y30SSFR*/
*        DCL K FIXED(31);              /*CONTROL             #Y30SSFR*/
*        DCL LIMIT FIXED(15);          /*MAXIMUM NUMBER OF   #Y30SSFR*/
*                                      /*CATALOG ENTRIES     #Y30SSFR*/
*                                      /*THAT WILL FIT INTO  #Y30SSFR*/
*                                      /*THE CURRENT WORK    #Y30SSFR*/
*                                      /*AREA                #Y30SSFR*/
*        DCL COREFLAG BIT(1);          /*FLAG INDICATING     #Y30SSFR*/
*                                      /*WHETHER CORE HAS    #Y30SSFR*/
*                                      /*BEEN GOTTEN         #Y30SSFR*/
*        DCL SIZENEED FIXED(31);       /*SIZE OF WORK AREA   #Y30SSFR*/
*                                      /*NEEDED              #Y30SSFR*/
*        DCL CURSIZE  FIXED(15);       /*CURRENT SIZE OF THE #Y30SSFR*/
*                                      /*WORK AREA           #Y30SSFR*/
*        DCL PLIMIT   FIXED(15);       /*NUMBER OF ENTRIES   #Y30SSFR*/
*                                      /*TO BE PRINTED FROM  @Y30SSFR*/
*                                      /*THE CMS WORKAREA    @Y30SSFR*/
*                                                                  1691
*        OLDERID2 = NEWERID2;                                      1691
         L     @02,@PC00001                                        1691
         L     @15,GDTTR2(,@02)                                    1691
         MVC   @TS00001(95),NEWERID2(@15)                          1691
         MVC   OLDERID2(95,@15),@TS00001                           1691
*        NEWID2 = 'MPDL';                                  /*@Y30SSFR*/
*                                                                  1692
         MVC   NEWID2(4,@15),@CC01455                              1692
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  INITIALIZE AND CALL CATALOG                     @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1693
*        CTGPLPTR = DLCPLPTR;                              /*@Y30SSFR*/
         L     @15,@PC00010                                        1693
         L     @14,DLCPLPTR(,@15)                                  1693
         ST    @14,CTGPLPTR                                        1693
*        DSAVCPL = CTGPL;                                  /*@Y30SSFR*/
         MVC   DSAVCPL(28),CTGPL(@14)                              1694
*        LIMIT = (AREALN - 4) / LENGTH(ENTITEM);           /*@Y30SSFR*/
         L     @01,CTGWKA(,@14)                                    1695
         LH    @14,AREALN(,@01)                                    1695
         LR    @00,@14                                             1695
         SL    @00,@CF00045                                        1695
         SRDA  @00,32                                              1695
         D     @00,@CF01384                                        1695
         LR    LIMIT,@01                                           1695
*        CURSIZE = AREALN;                                 /*@Y30SSFR*/
         STH   @14,CURSIZE                                         1696
*        COREFLAG = OFF;                                   /*@Y30SSFR*/
         NI    COREFLAG,B'01111111'                                1697
*        DARGSMOD = DELMSG;                                /*@Y30SSFR*/
         L     @14,DDSTRU                                          1698
         MVC   DARGSMOD(3,@14),@CC01031                            1698
*        DARGSENT = ENTRYMSG;                              /*@Y30SSFR*/
         MVI   DARGSENT(@14),X'01'                                 1699
*        CATRTNID = 'CATLGRTN';                            /*@Y30SSFR*/
*                                                                  1700
         MVC   CATRTNID(8),@CC01429                                1700
*        CALL IDCSACA0(GDTTBL,DLCPLPTR);                   /*@Y30SSFR*/
*                                                                  1701
         ST    @02,@AL00001                                        1701
         ST    @15,@AL00001+4                                      1701
         L     @15,GDTCAT(,@02)                                    1701
         LA    @01,@AL00001                                        1701
         BALR  @14,@15                                             1701
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/
*        CATLGRC = REG15;                                  /*@Y30SSFR*/
         STH   REG15,CATLGRC                                       1703
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/
*                                                                  1704
*        IF GDTDBG = NULLPTR                                       1705
*          THEN;                                                   1705
         L     @02,@PC00001                                        1705
         L     @02,GDTDBG(,@02)                                    1705
         LTR   @02,@02                                             1705
         BZ    @RT01705                                            1705
*          ELSE                                                    1707
*            CALL IDCDB010(GDTTBL,'MPDC');                         1707
         L     @02,@PC00001                                        1707
         ST    @02,@AL00001                                        1707
         LA    @15,@CC01456                                        1707
         ST    @15,@AL00001+4                                      1707
         MVI   @AL00001+4,X'80'                                    1707
         L     @15,GDTDBG(,@02)                                    1707
         LA    @01,@AL00001                                        1707
         BALR  @14,@15                                             1707
*                                                          /*@Y30SSFR*/
*                                                                  1708
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  RESTORE THE CPL.  TO PREVENT CATALOG FROM       @Y30SSFR*/
*        /*  RE-ERASING THE OBJECT ON SUBSEQUENT CALLS,      @Y30SSFR*/
*        /*  SET CTGOVRID TO ON AND CTGERASE TO OFF. THEN    @Y30SSFR*/
*        /*  SAVE THE CPL AGAIN.                             @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  1708
*        IF (CATLGRC = RCWORKSM)  (CATLGRC = ALLORC1)     /*@Y30SSFR*/
*            (CATLGRC = ALLORC2)  (CATLGRC = ALLORC3)    /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
@RT01705 LH    @02,CATLGRC                                         1708
         C     @02,@CF01151                                        1708
         BE    @RT01708                                            1708
         C     @02,@CF01153                                        1708
         BE    @RT01708                                            1708
         C     @02,@CF01161                                        1708
         BE    @RT01708                                            1708
         C     @02,@CF01155                                        1708
         BNE   @RF01708                                            1708
@RT01708 DS    0H                                                  1709
*            DO;                                           /*@Y30SSFR*/
*            CTGPL = DSAVCPL;                              /*@Y30SSFR*/
         L     @02,CTGPLPTR                                        1710
         MVC   CTGPL(28,@02),DSAVCPL                               1710
*            CTGERASE = OFF;                               /*@Y30SSFR*/
*            CTGOVRID = ON;                                /*@Y30SSFR*/
         OI    CTGOVRID(@02),B'00000100'                           1712
         NI    CTGERASE(@02),B'10111111'                           1712
*            DSAVCPL = CTGPL;                              /*@Y30SSFR*/
         MVC   DSAVCPL(28),CTGPL(@02)                              1713
*            END;                                          /*@Y30SSFR*/
*                                                                  1714
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  IF VSAM CATALOG RETURNS A CODE OF 40, LOOP      #Y30SSFR*/
*        /*  DELETING OBJECTS AND PRINTING THEM.  GET A      #Y30SSFR*/
*        /*  LARGER WORK AREA AS NEEDED.                     #Y30SSFR*/
*        /*  IF VSAM CATALOG RETURNS A CODE OF 72, 76 OR ONE @Y30SSFR*/
*        /*  OF 240, SOMETHING MUST BE DYNAMICALLY           #Y30SSFR*/
*        /*  ALLOCATED.  LOOP PRINTING NAMES FROM THE        #Y30SSFR*/
*        /*  WORKAREA, AND CALLING CATALOG, ALLOCATING       #Y30SSFR*/
*        /*  OBJECTS NEEDED.                                 #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1715
*DELLP:  DO WHILE (CATLGRC = RCWORKSM)                    /*#Y30SSFR*/
*            (CATLGRC = ALLORC1)  (CATLGRC = ALLORC2)     /*@Y30SSFR*/
*             (CATLGRC = ALLORC3);                        /*@Y30SSFR*/
*                                                                  1715
@RF01708 DS    0H                                                  1715
DELLP    B     @DE01715                                            1715
@DL01715 DS    0H                                                  1716
*          IX1 = 1;                                        /*#Y30SSFR*/
*                                                                  1716
         LA    IX1,1                                               1716
*          /**********************************************************/
*          /*                                                #Y30SSFR*/
*          /*  IF THE VSAM CATALOG RETURN CODE WAS 72 OR 76, @Y30SSFR*/
*          /*  ADJUST THE VALUE OF PLIMIT,  THE NUMBER OF    #Y30SSFR*/
*          /*  ENTRIES TO BE PRINTED FROM THE CMS WORKAREA   #Y30SSFR*/
*          /*  SO THAT THE OBJECT TO BE ALLOCATED AND ITS    #Y30SSFR*/
*          /*  ASSOCIATIONS DO NOT GET PRINTED.              #Y30SSFR*/
*          /*  IN ALL OTHER CASES, THE VALUE OF PLIMIT IS    #Y30SSFR*/
*          /*  THE SIZE OF THE WORK AREA.                    #Y30SSFR*/
*          /*                                                #Y30SSFR*/
*          /**********************************************************/
*                                                                  1717
*          IF (CATLGRC = ALLORC1)  (CATLGRC = ALLORC3)    /*@Y30SSFR*/
*            THEN                                          /*#Y30SSFR*/
         LH    @15,CATLGRC                                         1717
         C     @15,@CF01153                                        1717
         BE    @RT01717                                            1717
         C     @15,@CF01155                                        1717
         BNE   @RF01717                                            1717
@RT01717 DS    0H                                                  1718
*              PLIMIT = (RETURNLN - 4) / LENGTH(ENTITEM);  /*@Y30SSFR*/
         L     @01,CTGPLPTR                                        1718
         L     @01,CTGWKA(,@01)                                    1718
         LH    @00,RETURNLN(,@01)                                  1718
         SL    @00,@CF00045                                        1718
         SRDA  @00,32                                              1718
         D     @00,@CF01384                                        1718
         LR    PLIMIT,@01                                          1718
*            ELSE                                          /*#Y30SSFR*/
*              PLIMIT = LIMIT;                             /*#Y30SSFR*/
*                                                                  1719
         B     @RC01717                                            1719
@RF01717 LR    PLIMIT,LIMIT                                        1719
*          /**********************************************************/
*          /*                                                #Y30SSFR*/
*          /*  LOOP THROUGH THE CATALOG WORK AREA, PRINTING  #Y30SSFR*/
*          /*  THE NAMES OF THE OBJECTS DELETED.             #Y30SSFR*/
*          /*                                                #Y30SSFR*/
*          /**********************************************************/
*                                                                  1720
*          DO WHILE IX1 <= PLIMIT & ENTRYTYP(IX1) ^= 0;    /*#Y30SSFR*/
@RC01717 B     @DE01720                                            1720
@DL01720 DS    0H                                                  1721
*            DARGDBP = ADDR(ENTLIST(IX1));                 /*#Y30SSFR*/
         L     @05,DDSTRU                                          1721
         LA    @15,45                                              1721
         LR    @01,IX1                                             1721
         MR    @00,@15                                             1721
         L     @14,CTGPLPTR                                        1721
         L     @14,CTGWKA(,@14)                                    1721
         AL    @14,@CF01706                                        1721
         LA    @14,ENTLIST-4(@01,@14)                              1721
         ST    @14,DARGDBP(,@05)                                   1721
*            DARGILP = LENGTH(ENTLIST(1));                 /*#Y30SSFR*/
         STH   @15,DARGILP(,@05)                                   1722
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*#Y30SSFR*/
         L     @05,@PC00001                                        1723
         ST    @05,@AL00001                                        1723
         LA    @15,@CF00118                                        1723
         ST    @15,@AL00001+4                                      1723
         LA    @15,DDSTRU                                          1723
         ST    @15,@AL00001+8                                      1723
         MVI   @AL00001+8,X'80'                                    1723
         L     @15,GDTPRT(,@05)                                    1723
         LA    @01,@AL00001                                        1723
         BALR  @14,@15                                             1723
*            IX1 = IX1 + 1;                                /*#Y30SSFR*/
         AL    IX1,@CF00221                                        1724
*          END;                                            /*#Y30SSFR*/
*                                                                  1725
@DE01720 CR    IX1,PLIMIT                                          1725
         BH    @DC01720                                            1725
         LR    @05,IX1                                             1725
         MH    @05,@CH01384                                        1725
         L     @01,CTGPLPTR                                        1725
         L     @01,CTGWKA(,@01)                                    1725
         AL    @01,@CF01706                                        1725
         SLR   @00,@00                                             1725
         IC    @00,ENTRYTYP-4(@05,@01)                             1725
         C     @00,@CF00118                                        1725
         BNE   @DL01720                                            1725
@DC01720 DS    0H                                                  1726
*          /**********************************************************/
*          /*                                                #Y30SSFR*/
*          /*  RESTORE THE CPL FOR THE NEXT CALL TO CATALOG. #Y30SSFR*/
*          /*                                                #Y30SSFR*/
*          /**********************************************************/
*                                                                  1726
*          CTGPL = DSAVCPL;                                /*#Y30SSFR*/
*                                                                  1726
         L     @05,CTGPLPTR                                        1726
         MVC   CTGPL(28,@05),DSAVCPL                               1726
*          /**********************************************************/
*          /*                                                #Y30SSFR*/
*          /*  TEST FOR A VSAM CATALOG RETURN CODE OF 40.    #Y30SSFR*/
*          /*                                                #Y30SSFR*/
*          /**********************************************************/
*                                                                  1727
*          IF CATLGRC = RCWORKSM                           /*#Y30SSFR*/
*            THEN                                          /*#Y30SSFR*/
         CLC   CATLGRC(2),@CH01151                                 1727
         BNE   @RF01727                                            1727
*MORESP:       DO;                                         /*#Y30SSFR*/
*                                                                  1728
*                                                                  1728
MORESP   DS    0H                                                  1729
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  COMPUTE THE AMOUNT OF SPACE NEEDED BY CMS #Y30SSFR*/
*              /*  TO CONTINUE WITH THE DELETE               #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  1729
*              SIZENEED = RETURNLN - (LENGTH(ENTITEM) *    /*#Y30SSFR*/
*                (IX1 - 1));                               /*#Y30SSFR*/
*                                                                  1729
         L     @15,CTGPLPTR                                        1729
         L     @01,CTGWKA(,@15)                                    1729
         LR    @00,IX1                                             1729
         BCTR  @00,0                                               1729
         MH    @00,@CH01384                                        1729
         LCR   @00,@00                                             1729
         AH    @00,RETURNLN(,@01)                                  1729
         ST    @00,SIZENEED                                        1729
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  COMPARE THE AMOUNT OF CORE NEEDED WITH    #Y30SSFR*/
*              /*  THAT AVAILABLE, AND GET A LARGER WORK     #Y30SSFR*/
*              /*  AREA IF NEEDED.                           #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  1730
*              IF SIZENEED > CURSIZE                       /*#Y30SSFR*/
*                THEN                                      /*#Y30SSFR*/
         CH    @00,CURSIZE                                         1730
         BNH   @RF01730                                            1730
*                  DO;                                     /*#Y30SSFR*/
*                                                                  1731
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  IF WE HAVE GOTTEN CORE PREVIOUSLY,    #Y30SSFR*/
*                  /*  FREE IT PRIOR TO GETTING ANOTHER      #Y30SSFR*/
*                  /*  WORK AREA.                            #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1732
*                  IF COREFLAG = ON                        /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         TM    COREFLAG,B'10000000'                                1732
         BNO   @RF01732                                            1732
*                      CALL IDCSAFS0(GDTTBL,CTGWKA);       /*#Y30SSFR*/
         L     @14,@PC00001                                        1733
         ST    @14,@AL00001                                        1733
         LA    @15,CTGWKA(,@15)                                    1733
         ST    @15,@AL00001+4                                      1733
         L     @15,GDTFSP(,@14)                                    1733
         LA    @01,@AL00001                                        1733
         BALR  @14,@15                                             1733
*                    ELSE ;                                /*#Y30SSFR*/
*                                                                  1734
@RF01732 DS    0H                                                  1735
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  TURN THE COREFLAG ON AND ISSUE A      #Y30SSFR*/
*                  /*  UGPOOL TO OBTAIN CORE.                #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /*************************************************/
*                                                                  1735
*                  COREFLAG = ON;                          /*#Y30SSFR*/
*                                                                  1735
         OI    COREFLAG,B'10000000'                                1735
*                  CALL IDCSAGP0(GDTTBL,SIZENEED,          /*#Y30SSFR*/
*                    CTGWKA,GPID,SETZERO);                 /*#Y30SSFR*/
*                                                                  1736
         L     @03,@PC00001                                        1736
         ST    @03,@AL00001                                        1736
         LA    @15,SIZENEED                                        1736
         ST    @15,@AL00001+4                                      1736
         L     @01,CTGPLPTR                                        1736
         LA    @15,CTGWKA(,@01)                                    1736
         ST    @15,@AL00001+8                                      1736
         LA    @15,GPID                                            1736
         ST    @15,@AL00001+12                                     1736
         LA    @15,SETZERO                                         1736
         ST    @15,@AL00001+16                                     1736
         MVI   @AL00001+16,X'80'                                   1736
         L     @15,GDTGPL(,@03)                                    1736
         LA    @01,@AL00001                                        1736
         BALR  @14,@15                                             1736
*                  RESPECIFY RTNREG RSTD;                          1737
*                  TESTRC = RTNREG;                                1738
         LR    TESTRC,RTNREG                                       1738
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/
*                  IF TESTRC ^= 0                          /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1740
         BZ    @RF01740                                            1740
*                      DO;                                 /*#Y30SSFR*/
*                      DARGSMOD = UNIVMSG;                 /*#Y30SSFR*/
         L     @01,DDSTRU                                          1742
         MVC   DARGSMOD(3,@01),@CC01023                            1742
*                      DEFSTID = NOSTORAG;                 /*#Y30SSFR*/
         MVI   DEFSTID,X'04'                                       1743
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/
         LA    @15,12                                              1744
         L     @14,@SA00010                                        1744
         LM    @00,@12,@SA00010+8                                  1744
         BR    @14                                                 1744
*                      END;                                /*#Y30SSFR*/
*                                                                  1745
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  COMPUTE A NEW VALUE FOR LIMIT, AND    #Y30SSFR*/
*                  /*  SET CURSIZE AND AREALN TO THE         #Y30SSFR*/
*                  /*  PROPER VALUES.                        #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1746
*                  LIMIT = (SIZENEED - 4) /                /*#Y30SSFR*/
*                     LENGTH(ENTITEM);                     /*#Y30SSFR*/
@RF01740 L     @15,SIZENEED                                        1746
         LR    @00,@15                                             1746
         SL    @00,@CF00045                                        1746
         SRDA  @00,32                                              1746
         D     @00,@CF01384                                        1746
         LR    LIMIT,@01                                           1746
*                  CURSIZE = SIZENEED;                     /*#Y30SSFR*/
         STH   @15,CURSIZE                                         1747
*                  AREALN = SIZENEED;                      /*#Y30SSFR*/
         L     @02,CTGPLPTR                                        1748
         L     @02,CTGWKA(,@02)                                    1748
         STH   @15,AREALN(,@02)                                    1748
*                  END;                                    /*#Y30SSFR*/
*                                                                  1749
*                ELSE                                      /*#Y30SSFR*/
*                                                                  1750
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  ZERO AND REUSE THE PRESENT CATALOG    #Y30SSFR*/
*                  /*  WORK AREA.  IT IS ALREADY LARGE       #Y30SSFR*/
*                  /*  ENOUGH.                               #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1750
*                  DO;                                     /*#Y30SSFR*/
         B     @RC01730                                            1750
@RF01730 DS    0H                                                  1751
*                  RETURNLN = 0;                           /*#Y30SSFR*/
         L     @02,CTGPLPTR                                        1751
         L     @02,CTGWKA(,@02)                                    1751
         SLR   @15,@15                                             1751
         STH   @15,RETURNLN(,@02)                                  1751
*                  DO J = 1 TO LIMIT;                      /*#Y30SSFR*/
         LA    J,1                                                 1752
         B     @DE01752                                            1752
@DL01752 DS    0H                                                  1753
*                    ENTLIST(J) = ''B;                     /*#Y30SSFR*/
         LR    @15,J                                               1753
         MH    @15,@CH01384                                        1753
         L     @01,CTGPLPTR                                        1753
         L     @01,CTGWKA(,@01)                                    1753
         ALR   @01,@15                                             1753
         AL    @01,@CF01706                                        1753
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    1753
*                  END;                                    /*#Y30SSFR*/
         AL    J,@CF00221                                          1754
@DE01752 CR    J,LIMIT                                             1754
         BNH   @DL01752                                            1754
*                  END;                                    /*#Y30SSFR*/
*                                                                  1755
*              END MORESP;                                 /*#Y30SSFR*/
*                                                                  1756
*            ELSE                                                  1757
*                                                                  1757
*              /******************************************************/
*              /*                                            #Y30SSFR*/
*              /*  TEST FOR VSAM CATALOG RETURN CODES OF 72, #Y30SSFR*/
*              /*  76, AND 240.  THESE INDICATE THAT         #Y30SSFR*/
*              /*  SOMETHING MUST BE DYNAMICALLY ALLOCATED.  #Y30SSFR*/
*              /*                                            #Y30SSFR*/
*              /******************************************************/
*                                                                  1757
*              IF (CATLGRC = ALLORC1)  (CATLGRC = ALLORC2)        1757
*                   (CATLGRC = ALLORC3)                           1757
*                THEN                                              1757
*                                                                  1757
         B     @RC01727                                            1757
@RF01727 LH    @05,CATLGRC                                         1757
         C     @05,@CF01153                                        1757
         BE    @RT01757                                            1757
         C     @05,@CF01161                                        1757
         BE    @RT01757                                            1757
         C     @05,@CF01155                                        1757
         BNE   @RF01757                                            1757
@RT01757 DS    0H                                                  1758
*ALLOCRC:          DO;                                     /*#Y30SSFR*/
*                                                                  1758
ALLOCRC  DS    0H                                                  1759
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  IF DEALLOC IS ON, SOMETHING HAS BEEN  #Y30SSFR*/
*                  /*  DYNAMICALLY ALLOCATED.  DYNAMICALLY   #Y30SSFR*/
*                  /*  UNALLOCATE THE OBJECT SO THAT THE     #Y30SSFR*/
*                  /*  SAME STORAGE CAN BE USED FOR THE      #Y30SSFR*/
*                  /*  ALLAGL OF THE NEXT THING TO BE        #Y30SSFR*/
*                  /*  ALLOCATED.                            #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1759
*                  IF DEALLOC = ON                                 1759
*                    THEN                                          1759
*                                                                  1759
         TM    DEALLOC,B'10000000'                                 1759
         BNO   @RF01759                                            1759
*                      DO;                                 /*#Y30SSFR*/
*                      DEALLOC = OFF;                      /*#Y30SSFR*/
*                                                                  1761
         NI    DEALLOC,B'01111111'                                 1761
*                      CALL IDCSADL0(GDTTBL,ALLAGL);       /*#Y30SSFR*/
         L     @05,@PC00001                                        1762
         ST    @05,@AL00001                                        1762
         L     @01,ALLPTR                                          1762
         ST    @01,@AL00001+4                                      1762
         MVI   @AL00001+4,X'80'                                    1762
         L     @15,GDTDLC(,@05)                                    1762
         LA    @01,@AL00001                                        1762
         BALR  @14,@15                                             1762
*                      RESPECIFY RTNREG RSTD;                      1763
*                      TESTRC = RTNREG;                            1764
         LR    TESTRC,RTNREG                                       1764
*                      RESPECIFY RTNREG UNRSTD;            /*#Y30SSFR*/
*                      IF TESTRC ^= 0                              1766
*                        THEN                                      1766
         LTR   TESTRC,TESTRC                                       1766
         BZ    @RF01766                                            1766
*                          SETRC = LASTCC08;               /*#Y30SSFR*/
         MVC   SETRC(2),@CH00039                                   1767
*                      END;                                /*#Y30SSFR*/
*                                                                  1768
@RF01766 DS    0H                                                  1769
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  SET DEALLOC TO INDICATE THAT AN       #Y30SSFR*/
*                  /*  ATTEMPT HAS BEEN MADE TO DYNAMICALLY  #Y30SSFR*/
*                  /*  ALLOCATE SOMETHING.                   #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1769
*                  DEALLOC = ON;                           /*#Y30SSFR*/
*                                                                  1769
@RF01759 OI    DEALLOC,B'10000000'                                 1769
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  POINT TO THE STORAGE FOR THE ALLAGL,  #Y30SSFR*/
*                  /*  AND CLEAR IT TO ZEROS.                #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1770
*                  ALLPTR = ADDR(ALLLIST);                 /*#Y30SSFR*/
         LA    @05,ALLLIST                                         1770
         ST    @05,ALLPTR                                          1770
*                  ALLAGL = ''B;                           /*#Y30SSFR*/
*                                                                  1771
         XC    ALLAGL(31,@05),ALLAGL(@05)                          1771
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  IF THE VSAM CATALOG RETURN CODE IS 72 OR 76,  */
*                  /*  THEN THE THING TO BE DYNAMICALLY      #Y30SSFR*/
*                  /*  ALLOCATED IS THE LAST ITEM IN THE     #Y30SSFR*/
*                  /*  CMS WORK AREA.  IF IT IS 240, THEN    #Y30SSFR*/
*                  /*  THE ADDRESS OF THE THING TO ALLOCATE  #Y30SSFR*/
*                  /*  IS IN CTGENT.                         #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1772
*                  IF (CATLGRC = ALLORC1)                 /*#Y30SSFR*/
*                       (CATLGRC = ALLORC3)                /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         LH    @05,CATLGRC                                         1772
         C     @05,@CF01153                                        1772
         BE    @RT01772                                            1772
         C     @05,@CF01155                                        1772
         BNE   @RF01772                                            1772
@RT01772 DS    0H                                                  1773
*                      ALLDSN = ADDR(ENTRYNM(PLIMIT + 1)); /*#Y30SSFR*/
         LR    @05,PLIMIT                                          1773
         MH    @05,@CH01384                                        1773
         L     @02,CTGPLPTR                                        1773
         L     @02,CTGWKA(,@02)                                    1773
         LA    @05,ENTRYNM(@05,@02)                                1773
         L     @02,ALLPTR                                          1773
         ST    @05,ALLDSN(,@02)                                    1773
*                    ELSE                                  /*#Y30SSFR*/
*                      ALLDSN = CTGENT;                    /*#Y30SSFR*/
*                                                                  1774
         B     @RC01772                                            1774
@RF01772 L     @02,CTGPLPTR                                        1774
         L     @02,CTGENT(,@02)                                    1774
         L     @01,ALLPTR                                          1774
         ST    @02,ALLDSN(,@01)                                    1774
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  SELECT DYNAMIC ALLOCATION OPTIONS     #Y30SSFR*/
*                  /*  (1) DYNAMIC ALLOCATION BY DATA SET    #Y30SSFR*/
*                  /*      NAME                              #Y30SSFR*/
*                  /*  (2) STATUS = OLD                      #Y30SSFR*/
*                  /*  (3) DISP = KEEP                       #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1775
*                  ALLOPTVL = OFF;                         /*#Y30SSFR*/
@RC01772 DS    0H                                                  1776
*                  ALLOPTDS = ON;                          /*#Y30SSFR*/
         L     @15,ALLPTR                                          1776
         OI    ALLOPTDS(@15),B'01000000'                           1776
         NI    ALLOPTVL(@15),B'01111111'                           1776
*                  ALLSTSOD = ON;                          /*#Y30SSFR*/
         OI    ALLSTSOD(@15),B'00000001'                           1777
*                  ALLDSPKP = ON;                          /*#Y30SSFR*/
*                                                                  1778
         OI    ALLDSPKP(@15),B'00001000'                           1778
*                  /**************************************************/
*                  /*                                        #Y30SSFR*/
*                  /*  ISSUE THE UALLOC MACRO OF THE SYSTEM  #Y30SSFR*/
*                  /*  ADAPTER, AND TEST THE RETURN CODE.    #Y30SSFR*/
*                  /*                                        #Y30SSFR*/
*                  /**************************************************/
*                                                                  1779
*                  CALL IDCSAAL0(GDTTBL,ALLAGL);           /*#Y30SSFR*/
         L     @14,@PC00001                                        1779
         ST    @14,@AL00001                                        1779
         ST    @15,@AL00001+4                                      1779
         MVI   @AL00001+4,X'80'                                    1779
         L     @15,GDTALC(,@14)                                    1779
         LA    @01,@AL00001                                        1779
         BALR  @14,@15                                             1779
*                  RESPECIFY RTNREG RSTD;                          1780
*                  TESTRC = RTNREG;                                1781
         LR    TESTRC,RTNREG                                       1781
*                  RESPECIFY RTNREG UNRSTD;                /*#Y30SSFR*/
*                                                                  1782
*                  IF TESTRC = 0                                   1783
*                    THEN                                          1783
*                                                                  1783
         LTR   TESTRC,TESTRC                                       1783
         BNZ   @RF01783                                            1783
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  THE OBJECT HAS BEEN ALLOCATED     #Y30SSFR*/
*                      /*  SUCCESSFULLY.  RESTORE THE CPL,   #Y30SSFR*/
*                      /*  AND PLACE A POINTER TO THE        #Y30SSFR*/
*                      /*  DDNAME RETURNED BY ALLOCATION IN  #Y30SSFR*/
*                      /*  THE CPL.                          #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  1784
*                      DO;                                 /*#Y30SSFR*/
*                      CTGPL = DSAVCPL;                    /*#Y30SSFR*/
         L     @02,CTGPLPTR                                        1785
         MVC   CTGPL(28,@02),DSAVCPL                               1785
*                      CTGDDNM = ADDR(ALLDDN);             /*#Y30SSFR*/
*                                                                  1786
         L     @01,ALLPTR                                          1786
         LA    @15,ALLDDN(,@01)                                    1786
         ST    @15,CTGDDNM(,@02)                                   1786
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  CLEAR THE CMS WORKAREA.           #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  1787
*                      DO J = 1 TO LIMIT;                  /*#Y30SSFR*/
         LA    J,1                                                 1787
         B     @DE01787                                            1787
@DL01787 DS    0H                                                  1788
*                        ENTITEM(J) = ''B;                 /*#Y30SSFR*/
         LR    @15,J                                               1788
         MH    @15,@CH01384                                        1788
         L     @01,CTGPLPTR                                        1788
         L     @01,CTGWKA(,@01)                                    1788
         ALR   @01,@15                                             1788
         AL    @01,@CF01706                                        1788
         XC    ENTITEM-4(45,@01),ENTITEM-4(@01)                    1788
*                      END;                                /*#Y30SSFR*/
         AL    J,@CF00221                                          1789
@DE01787 CR    J,LIMIT                                             1789
         BNH   @DL01787                                            1789
*                      RETURNLN = 0;                       /*#Y30SSFR*/
         L     @02,CTGPLPTR                                        1790
         L     @02,CTGWKA(,@02)                                    1790
         SLR   @15,@15                                             1790
         STH   @15,RETURNLN(,@02)                                  1790
*                      END;                                /*#Y30SSFR*/
*                                                                  1791
*                    ELSE                                  /*#Y30SSFR*/
*                                                                  1792
*                      /**********************************************/
*                      /*                                    #Y30SSFR*/
*                      /*  DYNAMIC ALLOCATION HAS FAILED.    #Y30SSFR*/
*                      /*  PRINT AN ERROR MESSAGE, AND       #Y30SSFR*/
*                      /*  RETURN TO THE CALLING PROCESSOR.  #Y30SSFR*/
*                      /*                                    #Y30SSFR*/
*                      /**********************************************/
*                                                                  1792
*                      DO;                                 /*#Y30SSFR*/
         B     @RC01783                                            1792
@RF01783 DS    0H                                                  1793
*                      DEFSTID = 0;                        /*#Y30SSFR*/
         MVI   DEFSTID,X'00'                                       1793
*                      DARGSMOD = DELMSG;                  /*#Y30SSFR*/
         L     @15,DDSTRU                                          1794
         MVC   DARGSMOD(3,@15),@CC01031                            1794
*                      DARGILP = LENGTH(FENTNAME);         /*#Y30SSFR*/
         MVC   DARGILP(2,@15),@CH00605                             1795
*                      DARGSENT = NODELMSG;                /*#Y30SSFR*/
         MVI   DARGSENT(@15),X'08'                                 1796
*                      DARGDBP = CTGENT;                   /*#Y30SSFR*/
*                                                                  1797
         L     @01,CTGPLPTR                                        1797
         L     @14,CTGENT(,@01)                                    1797
         ST    @14,DARGDBP(,@15)                                   1797
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*     1798
*                                                            #Y30SSFR*/
*                                                                  1798
         L     @15,@PC00001                                        1798
         ST    @15,@AL00001                                        1798
         LA    @14,@CF00118                                        1798
         ST    @14,@AL00001+4                                      1798
         LA    @14,DDSTRU                                          1798
         ST    @14,@AL00001+8                                      1798
         MVI   @AL00001+8,X'80'                                    1798
         L     @15,GDTPRT(,@15)                                    1798
         LA    @01,@AL00001                                        1798
         BALR  @14,@15                                             1798
*                      DARGSMOD = UNIVMSG;                 /*#Y30SSFR*/
         L     @01,DDSTRU                                          1799
         MVC   DARGSMOD(3,@01),@CC01023                            1799
*                      RETURN CODE(LASTCC12);              /*#Y30SSFR*/
         LA    @15,12                                              1800
         L     @14,@SA00010                                        1800
         LM    @00,@12,@SA00010+8                                  1800
         BR    @14                                                 1800
*                      END;                                /*#Y30SSFR*/
*                                                                  1801
*                  END ALLOCRC;                            /*#Y30SSFR*/
*                                                                  1802
@RC01783 DS    0H                                                  1803
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  CALL CATALOG AND SAVE THE RETURN CODE.      #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1803
*            CALL IDCSACA0(GDTTBL,DLCPLPTR);               /*#Y30SSFR*/
*                                                                  1803
@RF01757 DS    0H                                                  1803
@RC01727 L     @02,@PC00001                                        1803
         ST    @02,@AL00001                                        1803
         L     @15,@PC00010                                        1803
         ST    @15,@AL00001+4                                      1803
         L     @15,GDTCAT(,@02)                                    1803
         LA    @01,@AL00001                                        1803
         BALR  @14,@15                                             1803
*            RESPECIFY REG15 RSTD;                         /*#Y30SSFR*/
*            CATLGRC = REG15;                              /*#Y30SSFR*/
         STH   REG15,CATLGRC                                       1805
*            RESPECIFY REG15 UNRSTD;                       /*#Y30SSFR*/
*                                                                  1806
*            IF GDTDBG = NULLPTR                                   1807
*              THEN;                                               1807
         L     @02,@PC00001                                        1807
         L     @02,GDTDBG(,@02)                                    1807
         LTR   @02,@02                                             1807
         BZ    @RT01807                                            1807
*              ELSE                                                1809
*                CALL IDCDB010(GDTTBL,'MPDD');                     1809
         L     @02,@PC00001                                        1809
         ST    @02,@AL00001                                        1809
         LA    @15,@CC01463                                        1809
         ST    @15,@AL00001+4                                      1809
         MVI   @AL00001+4,X'80'                                    1809
         L     @15,GDTDBG(,@02)                                    1809
         LA    @01,@AL00001                                        1809
         BALR  @14,@15                                             1809
*                                                          /*#Y30SSFR*/
*                                                                  1810
*        END DELLP;                                        /*#Y30SSFR*/
*                                                                  1810
@RT01807 DS    0H                                                  1810
@DE01715 LH    @02,CATLGRC                                         1810
         C     @02,@CF01151                                        1810
         BE    @DL01715                                            1810
         C     @02,@CF01153                                        1810
         BE    @DL01715                                            1810
         C     @02,@CF01161                                        1810
         BE    @DL01715                                            1810
         C     @02,@CF01155                                        1810
         BE    @DL01715                                            1810
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  IF VSAM CATALOG MANAGEMENT HAS PLACED ANYTHING  #Y30SSFR*/
*        /*  IN THE WORKAREA PASSED TO IT FOR THE CATALOG    #Y30SSFR*/
*        /*  DELETE, PRINT IT OUT.                           #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1811
*        IF RETURNLN > 4                                   /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
         LA    @15,4                                               1811
         L     @01,CTGPLPTR                                        1811
         L     @01,CTGWKA(,@01)                                    1811
         LH    @14,RETURNLN(,@01)                                  1811
         CR    @14,@15                                             1811
         BNH   @RF01811                                            1811
*            DO;                                           /*#Y30SSFR*/
*            ENTRYNO = (RETURNLN - 4) / LENGTH(ENTITEM);   /*#Y30SSFR*/
         SLR   @14,@15                                             1813
         SRDA  @14,32                                              1813
         D     @14,@CF01384                                        1813
         LR    ENTRYNO,@15                                         1813
*            DO K = 1 TO ENTRYNO;                          /*#Y30SSFR*/
         LA    K,1                                                 1814
         B     @DE01814                                            1814
@DL01814 DS    0H                                                  1815
*              DARGDBP = ADDR(ENTLIST(K));                 /*#Y30SSFR*/
         L     @15,DDSTRU                                          1815
         LA    @14,45                                              1815
         LR    @01,K                                               1815
         MR    @00,@14                                             1815
         L     @05,CTGPLPTR                                        1815
         L     @05,CTGWKA(,@05)                                    1815
         AL    @05,@CF01706                                        1815
         LA    @05,ENTLIST-4(@01,@05)                              1815
         ST    @05,DARGDBP(,@15)                                   1815
*              DARGILP = LENGTH(ENTLIST(1));               /*#Y30SSFR*/
*                                                                  1816
         STH   @14,DARGILP(,@15)                                   1816
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*#Y30SSFR*/
         L     @15,@PC00001                                        1817
         ST    @15,@AL00001                                        1817
         LA    @14,@CF00118                                        1817
         ST    @14,@AL00001+4                                      1817
         LA    @14,DDSTRU                                          1817
         ST    @14,@AL00001+8                                      1817
         MVI   @AL00001+8,X'80'                                    1817
         L     @15,GDTPRT(,@15)                                    1817
         LA    @01,@AL00001                                        1817
         BALR  @14,@15                                             1817
*            END;                                          /*#Y30SSFR*/
*                                                                  1818
         AL    K,@CF00221                                          1818
@DE01814 CR    K,ENTRYNO                                           1818
         BNH   @DL01814                                            1818
*            END;                                          /*#Y30SSFR*/
*          ELSE ;                                          /*#Y30SSFR*/
*                                                                  1820
@RF01811 DS    0H                                                  1821
*        /************************************************************/
*        /*                                                  @Z40RSSA*/
*        /*  IF THE VSAM CATALOG RETURN CODE IS 110          @Z40RSSA*/
*        /*  PRINT THE REASON THE PROFILE COULD NOT BE       @Z40RSSA*/
*        /*  DELETED.                                        @Z40RSSA*/
*        /*         REASON CODE 4 - NO PROFILE               @Z40RSSA*/
*        /*         REASON CODE 8 - PROFILE NOT DELETEABLE   @Z40RSSA*/
*        /*                                                  @Z40RSSA*/
*        /*  IF NOT 110, SIMPLY PRINT THE VSAM RETURN CODE   @Z40RSSA*/
*        /*                                                  @Z40RSSA*/
*        /************************************************************/
*                                                                  1821
*               IF CATLGRC = PRNTDEL & (CTGFBFLG =NFRET           1821
*                CTGFBFLG = NDRET) THEN                            1821
         CLC   CATLGRC(2),@CH01157                                 1821
         BNE   @RF01821                                            1821
         L     @15,CTGPLPTR                                        1821
         CLC   CTGFBFLG(2,@15),@CH00045                            1821
         BE    @RT01821                                            1821
         CLC   CTGFBFLG(2,@15),@CH00039                            1821
         BNE   @RF01821                                            1821
@RT01821 DS    0H                                                  1822
*                  DO;                                     /*@Z40RSSA*/
*                    DARGLIST = ''B;                       /*@Z40RSSA*/
         L     @15,DDSTRU                                          1823
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1823
*                    DARGSMOD = DELMSG;                    /*@Z40RSSA*/
         MVC   DARGSMOD(3,@15),@CC01031                            1824
*                    IF CTGFBFLG = 4 THEN                  /*@Z40RSSA*/
         L     @01,CTGPLPTR                                        1825
         CLC   CTGFBFLG(2,@01),@CH00045                            1825
         BNE   @RF01825                                            1825
*                      DARGSENT = PFNTFND;                 /*@Z40RSSA*/
         MVI   DARGSENT(@15),X'0D'                                 1826
*                    ELSE                                  /*@Z40RSSA*/
*                      DARGSENT = PFNTDL;                  /*@Z40RSSA*/
         B     @RC01825                                            1827
@RF01825 L     @01,DDSTRU                                          1827
         MVI   DARGSENT(@01),X'0C'                                 1827
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*     1828
*                                                            @Z40RSSA*/
@RC01825 L     @15,@PC00001                                        1828
         ST    @15,@AL00001                                        1828
         LA    @14,@CF00118                                        1828
         ST    @14,@AL00001+4                                      1828
         LA    @14,DDSTRU                                          1828
         ST    @14,@AL00001+8                                      1828
         MVI   @AL00001+8,X'80'                                    1828
         L     @15,GDTPRT(,@15)                                    1828
         LA    @01,@AL00001                                        1828
         BALR  @14,@15                                             1828
*                      SETRC = LASTCC04;                   /*@Z40RSSA*/
         MVC   SETRC(2),@CH00045                                   1829
*                  END;                                    /*@Z40RSSA*/
*               ELSE                                       /*@Z40RSSA*/
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  TEST FOR A VSAM CATALOG RETURN CODE OTHER THAN  #Y30SSFR*/
*        /*  ZERO.  IF CATALOG MANAGEMENT HAS SET A NON-ZERO #Y30SSFR*/
*        /*  RETURN CODE, PRINT AN APPROPRIATE MESSAGE.      #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1831
*        IF CATLGRC ^= 0                                   /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
         B     @RC01821                                            1831
@RF01821 LH    @15,CATLGRC                                         1831
         LTR   @15,@15                                             1831
         BZ    @RF01831                                            1831
*ERCALL2:    DO;                                           /*#Y30SSFR*/
*                                                                  1832
ERCALL2  DS    0H                                                  1833
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     #Y30SSFR*/
*            /*  ERROR CONVERSION TABLE.                     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1833
*            ERRORTAB = ''B;                               /*#Y30SSFR*/
*                                                                  1833
         XC    ERRORTAB(32),ERRORTAB                               1833
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    #Y30SSFR*/
*            /*  THE ERROR CONVERSION TABLE.                 #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1834
*            ERCNVADR = ADDR(ERRORTAB);                    /*#Y30SSFR*/
*                                                                  1834
         LA    @15,ERRORTAB                                        1834
         ST    @15,ERCNVADR                                        1834
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  #Y30SSFR*/
*            /*  IS A CATALOG ERROR.  THE CMS                #Y30SSFR*/
*            /*  FUNCTION BEING PERFORMED IS A DELETE.       #Y30SSFR*/
*            /*  SET THE ERCATDL BIT TO ON.                  #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1835
*            ERCATLG = ON;                                 /*#Y30SSFR*/
         OI    ERCATLG(@15),B'10000000'                            1835
*            ERCATDL = ON;                                 /*#Y30SSFR*/
*                                                                  1836
         OI    ERCATDL(@15),B'00100000'                            1836
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  #Y30SSFR*/
*            /*  POINT TO THE CPL FOR THE CATALOG OPERATION. #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1837
*            ERCATRC = CATLGRC;                            /*#Y30SSFR*/
         LH    @14,CATLGRC                                         1837
         ST    @14,ERCATRC(,@15)                                   1837
*            ERCPLPT = CTGPLPTR;                           /*#Y30SSFR*/
*                                                                  1838
         L     @14,CTGPLPTR                                        1838
         ST    @14,ERCPLPT(,@15)                                   1838
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  SET A POINTER IN THE ERROR CONVERSION       #Y30SSFR*/
*            /*  TABLE TO THE ENTRY NAME.                    #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1839
*            ERDSNM = CTGENT;                              /*#Y30SSFR*/
*                                                                  1839
         L     @14,CTGENT(,@14)                                    1839
         ST    @14,ERDSNM(,@15)                                    1839
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    #Y30SSFR*/
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  1840
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*#Y30SSFR*/
         L     @15,@PC00001                                        1840
         ST    @15,@AL00001                                        1840
         LA    @14,ERCNVADR                                        1840
         ST    @14,@AL00001+4                                      1840
         MVI   @AL00001+4,X'80'                                    1840
         L     @15,GDTERR(,@15)                                    1840
         LA    @01,@AL00001                                        1840
         BALR  @14,@15                                             1840
*            RETURN CODE(LASTCC12);                        /*#Y30SSFR*/
         LA    @15,12                                              1841
         L     @14,@SA00010                                        1841
         LM    @00,@12,@SA00010+8                                  1841
         BR    @14                                                 1841
*            END ERCALL2;                                  /*#Y30SSFR*/
*                                                                  1842
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  IF CORE WAS OBTAINED BY THIS PROCEDURE, FREE    #Y30SSFR*/
*        /*  IT.                                             #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1843
*        IF COREFLAG = ON                                  /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
*                                                                  1843
@RF01831 DS    0H                                                  1843
@RC01821 TM    COREFLAG,B'10000000'                                1843
         BNO   @RF01843                                            1843
*            DO;                                           /*#Y30SSFR*/
*            COREFLAG = OFF;                               /*#Y30SSFR*/
         NI    COREFLAG,B'01111111'                                1845
*            CALL IDCSAFS0(GDTTBL,CTGWKA);                 /*#Y30SSFR*/
         L     @15,@PC00001                                        1846
         ST    @15,@AL00001                                        1846
         L     @01,CTGPLPTR                                        1846
         LA    @14,CTGWKA(,@01)                                    1846
         ST    @14,@AL00001+4                                      1846
         L     @15,GDTFSP(,@15)                                    1846
         LA    @01,@AL00001                                        1846
         BALR  @14,@15                                             1846
*            END;                                          /*#Y30SSFR*/
*                                                                  1847
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  IF DYNAMIC ALLOCATION HAS BEEN PERFORMED BY     #Y30SSFR*/
*        /*  THIS PROCEDURE, DYNAMICALLY UNALLOCATE.         #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1848
*        IF DEALLOC = ON                                   /*#Y30SSFR*/
*          THEN                                            /*#Y30SSFR*/
@RF01843 TM    DEALLOC,B'10000000'                                 1848
         BNO   @RF01848                                            1848
*            DO;                                           /*#Y30SSFR*/
*            DEALLOC = OFF;                                /*#Y30SSFR*/
         NI    DEALLOC,B'01111111'                                 1850
*            CALL IDCSADL0(GDTTBL,ALLAGL);                 /*#Y30SSFR*/
         L     @03,@PC00001                                        1851
         ST    @03,@AL00001                                        1851
         L     @01,ALLPTR                                          1851
         ST    @01,@AL00001+4                                      1851
         MVI   @AL00001+4,X'80'                                    1851
         L     @15,GDTDLC(,@03)                                    1851
         LA    @01,@AL00001                                        1851
         BALR  @14,@15                                             1851
*            RESPECIFY RTNREG RSTD;                                1852
*            TESTRC = RTNREG;                                      1853
         LR    TESTRC,RTNREG                                       1853
*            RESPECIFY RTNREG UNRSTD;                      /*#Y30SSFR*/
*            IF TESTRC ^= 0                                /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       1855
         BZ    @RF01855                                            1855
*                SETRC = LASTCC08;                         /*#Y30SSFR*/
         MVC   SETRC(2),@CH00039                                   1856
*            END;                                          /*#Y30SSFR*/
*                                                                  1857
@RF01855 DS    0H                                                  1858
*        /************************************************************/
*        /*                                                  #Y30SSFR*/
*        /*  RETURN TO THE CALLER WITH SUCCESS INDICATED.    #Y30SSFR*/
*        /*                                                  #Y30SSFR*/
*        /************************************************************/
*                                                                  1858
*        RETURN CODE(0);                                   /*#Y30SSFR*/
*                                                                  1858
@RF01848 SLR   @15,@15                                             1858
         L     @14,@SA00010                                        1858
         LM    @00,@12,@SA00010+8                                  1858
         BR    @14                                                 1858
*END DELTPROC;                                             /*#Y30SSFR*/
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - OPENPROC                               */
*        /*                                                          */
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING A    */
*        /*  VSAM OBJECT FOR OUTPUT, OR OPENING THE PORTABILITY      */
*        /*  VOLUME FOR INPUT.                               #Y30SSFR*/
*        /*  WHEN OPENING A VSAM OBJECT FOR INPUT OPENPROC   #Y30SSFR*/
*        /*  SETS THE EXPORT/IMPORT FLAG IN THE OPNAGL.      #Y30SSFR*/
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */
*        /*        C  INDICATES A USER CATALOG                       */
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */
*        /*           OPENED                                         */
*        /*    .ODSN - NAME OF VSAM CLUSTER COMPONENT                */
*        /*    .OREC - LRECL SIZE FOR OUTPUT DATA SET                */
*        /*    .OBLK - BLKSIZE FOR OUTPUT DATA SET                   */
*        /*                                                          */
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */
*        /*                                                          */
*        /************************************************************/
*                                                                  1860
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */
*                                      /*TO CLUSTER                  */
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */
*                     OIOCS);          /*RETURN CELL FOR IOCS        */
*                                                                  1860
OPENPROC STM   @14,@02,@SA00011                                    1860
         STM   @04,@12,@SA00011+20                                 1860
         MVC   @PC00011(24),0(@01)                                 1860
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1861
*        DCL                                                       1861
*          OTYPE CHAR(1),                                          1861
*          ODD   PTR(31),                                          1861
*          ODSN  PTR(31),                                          1861
*          OREC,                                                   1861
*          OBLK,                                                   1861
*          OIOCS PTR(31);                                          1861
*                                                                  1861
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1862
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               1862
*                                      /* STORAGE FOR OPEN ARGUMENT  */
*                                      /* LIST                       */
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        1863
*                                                                  1863
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */
*        /*  VERSUS AN OUTPUT DATA SET                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1864
*        OLDERID2 = NEWERID2;                                      1864
         L     @02,@PC00001                                        1864
         L     @02,GDTTR2(,@02)                                    1864
         MVC   @TS00001(95),NEWERID2(@02)                          1864
         MVC   OLDERID2(95,@02),@TS00001                           1864
*        NEWID2 = 'MPOP';                                          1865
         MVC   NEWID2(4,@02),@CC01483                              1865
*        OPENLIST = ''B;                                           1866
         XC    OPENLIST(48),OPENLIST                               1866
*        OPNPTR = ADDR(OPENLIST);                                  1867
         LA    OPNPTR,OPENLIST                                     1867
*        IF OTYPE = 'I'                                            1868
*          THEN                                                    1868
         L     @02,@PC00011                                        1868
         CLI   OTYPE(@02),C'I'                                     1868
         BNE   @RF01868                                            1868
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN FOR  INPUT SPECIFIED - SET VBS FORMAT          */
*            /*                                                      */
*            /********************************************************/
*                                                                  1869
*            DO;                                                   1869
*            OPNOPTIN = ON;                                        1870
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1870
*            OPNRFMSF = ON;                                        1871
*            OPNRFMBK = ON;                                        1872
         OI    OPNRFMSF(OPNPTR),B'00011000'                        1872
*            OPNBLK = OBLK;                                        1873
*                                                                  1873
         L     @02,@PC00011+16                                     1873
         L     @02,OBLK(,@02)                                      1873
         ST    @02,OPNBLK(,OPNPTR)                                 1873
*            /********************************************************/
*            /*                                                      */
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS               */
*            /*  SET DEVICE TYPE ADDRESS                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1874
*            IF ADDR(ENV) ^= NULLPTR                               1874
*              THEN                                                1874
         SLR   @02,@02                                             1874
         L     @15,@PC00001+4                                      1874
         C     @02,FDTPTR+60(,@15)                                 1874
         BE    @RF01874                                            1874
*                DO;                                               1875
*                IF ADDR(PDEV) ^= NULLPTR                          1876
*                  THEN                                            1876
         L     @15,FDTPTR+84(,@15)                                 1876
         CR    @15,@02                                             1876
         BE    @RF01876                                            1876
*                    OPNDEVDT = ADDR(PDEVVAL);                     1877
*                                                                  1877
         LA    @02,PDEVVAL(,@15)                                   1877
         ST    @02,OPNDEVDT(,OPNPTR)                               1877
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  IF THE USER SPECIFIED THE BLOCKSIZE     @Y30SSFR*/
*                /*  SUBPARAMETER, OVERRIDE THE VALUE OF     @Y30SSFR*/
*                /*  OPNBLK WITH THE VALUE SPECIFIED BY THE  @Y30SSFR*/
*                /*  USER.                                   @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  1878
*                IF ADDR(BLKSZ) ^= NULLPTR                 /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
@RF01876 L     @02,@PC00001+4                                      1878
         L     @02,FDTPTR+80(,@02)                                 1878
         LTR   @02,@02                                             1878
         BZ    @RF01878                                            1878
*                    OPNBLK = BLKSZVAL;                    /*@Y30SSFR*/
*                                                                  1879
         L     @02,BLKSZVAL(,@02)                                  1879
         ST    @02,OPNBLK(,OPNPTR)                                 1879
*                IF ADDR(RCSZE) ^= NULLPTR                         1880
*                  THEN                                            1880
*                                                                  1880
@RF01878 L     @02,@PC00001+4                                      1880
         L     @02,FDTPTR+88(,@02)                                 1880
         LTR   @02,@02                                             1880
         BZ    @RF01880                                            1880
*                    /************************************************/
*                    /*                                      @Y30SSFR*/
*                    /*  SET THE VALUE OF THE OPNREC FIELD   @Y30SSFR*/
*                    /*  OF THE OPNAGL TO BE THE VALUE       @Y30SSFR*/
*                    /*  SPECIFIED BY THE USER OR THE        @Y30SSFR*/
*                    /*  MINIMUM VALUE, WHICHEVER IS LARGER  @Y30SSFR*/
*                    /*                                      @Y30SSFR*/
*                    /************************************************/
*                                                                  1881
*                    IF RCSZEVAL > MINRECSZ + 8            /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         L     @02,RCSZEVAL(,@02)                                  1881
         C     @02,@CF01667                                        1881
         BNH   @RF01881                                            1881
*                        OPNREC = RCSZEVAL;                /*@Y30SSFR*/
         ST    @02,OPNREC(,OPNPTR)                                 1882
*                      ELSE                                /*@Y30SSFR*/
*                        OPNREC = MINRECSZ + 8;            /*@Y30SSFR*/
         B     @RC01881                                            1883
@RF01881 MVC   OPNREC(4,OPNPTR),@CF01667                           1883
*                END;                                              1884
@RC01881 DS    0H                                                  1884
@RF01880 DS    0H                                                  1885
*             IF ADDR(INDD) = NULLPTR                              1885
*               THEN                                               1885
@RF01874 L     @02,@PC00001+4                                      1885
         L     @02,FDTPTR+56(,@02)                                 1885
         LTR   @02,@02                                             1885
         BNZ   @RF01885                                            1885
*                 OPNDSN = ODSN;                           /*@YL026UA*/
         L     @02,@PC00011+8                                      1886
         L     @02,ODSN(,@02)                                      1886
         ST    @02,OPNDSN(,OPNPTR)                                 1886
*               ELSE                                               1887
*                 OPNDDN = ODD;                            /*@YL026UA*/
         B     @RC01885                                            1887
@RF01885 L     @02,@PC00011+4                                      1887
         L     @02,ODD(,@02)                                       1887
         ST    @02,OPNDDN(,OPNPTR)                                 1887
*            END;                                                  1888
*                                                                  1888
@RC01885 DS    0H                                                  1889
*        IF OTYPE = 'O'                                            1889
*          THEN                                                    1889
*                                                                  1889
@RF01868 L     @02,@PC00011                                        1889
         CLI   OTYPE(@02),C'O'                                     1889
         BNE   @RF01889                                            1889
*            /********************************************************/
*            /*                                                      */
*            /*  OPEN FOR OUTPUT FOR VSAM DATA SET.  SET OPEN FOR    */
*            /*  OUTPUT.                                             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1890
*            DO;                                                   1890
*            OPNOPTOT = ON;                                        1891
         OI    OPNOPTOT(OPNPTR),B'01000000'                        1891
*            OPNTYPXM = ON;                                /*@Y30SSFR*/
         OI    OPNTYPXM(OPNPTR),B'00010000'                        1892
*            OPNDDN = ODD;                                 /*@Y30SSFR*/
*                                                                  1893
         L     @02,@PC00011+4                                      1893
         L     @02,ODD(,@02)                                       1893
         ST    @02,OPNDDN(,OPNPTR)                                 1893
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF IMPORTING AN AIX, SET THE OPNMODAX BIT,  @Y30SSFR*/
*            /*  SO THAT WHEN OPENING BY PATH NAME, THE AIX  @Y30SSFR*/
*            /*  IS OPENED RATHER THAN THE BASE CLUSTER.     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1894
*            IF FVTPTR(1) -> CTGFVTYP = CTGTAIX            /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         L     @02,FVTPTR                                          1894
         CLI   CTGFVTYP(@02),C'G'                                  1894
         BNE   @RF01894                                            1894
*                OPNMODAX = ON;                            /*@Y30SSFR*/
*                                                                  1895
         OI    OPNMODAX(OPNPTR),B'00001000'                        1895
*            /********************************************************/
*            /*                                                      */
*            /*  GET OBJECT PASSWORD, WHICH WILL BE OVERRIDEN        */
*            /*  IF A PASSWORD WAS SPECIFIED VIA OUTFILE.    @Y30SSFR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  1896
*            IF ADDR(OUTDD) ^= NULLPTR                     /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
@RF01894 L     @02,@PC00001+4                                      1896
         L     @02,FDTPTR+4(,@02)                                  1896
         LTR   @02,@02                                             1896
         BZ    @RF01896                                            1896
*                DO;                                       /*@Y30SSFR*/
*                IF OUTDDPLN ^= 0                          /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         CLI   OUTDDPLN(@02),0                                     1898
         BE    @RF01898                                            1898
*                    OPNPWA = ADDR(OUTDDPAS);              /*@Y30SSFR*/
         LA    @02,OUTDDPAS(,@02)                                  1899
         ST    @02,OPNPWA(,OPNPTR)                                 1899
*                END;                                      /*@Y30SSFR*/
*              ELSE                                        /*#Y30SSFR*/
*                IF ADDR(OUTDS) ^= NULLPTR                 /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         B     @RC01896                                            1901
@RF01896 L     @02,@PC00001+4                                      1901
         L     @02,FDTPTR+96(,@02)                                 1901
         LTR   @02,@02                                             1901
         BZ    @RF01901                                            1901
*                    DO;                                   /*@Y30SSFR*/
*                    IF OUTDSPLN ^= 0                      /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         CLI   OUTDSPLN(@02),0                                     1903
         BE    @RF01903                                            1903
*                        OPNPWA = ADDR(OUTDSPAS);          /*@Y30SSFR*/
         LA    @02,OUTDSPAS(,@02)                                  1904
         ST    @02,OPNPWA(,OPNPTR)                                 1904
*                    END;                                  /*@Y30SSFR*/
*                                                                  1905
@RF01903 DS    0H                                                  1906
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  IF THERE IS STILL NO PASSWORD POINTED TO    @Y30SSFR*/
*            /*  BY THE OPNAGL, THEN USE THE ONE FROM        @Y30SSFR*/
*            /*  THE PORTABLE DATA SET.                      @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  1906
*            IF OPNPWA = NULLPTR                           /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
@RF01901 DS    0H                                                  1906
@RC01896 SLR   @02,@02                                             1906
         C     @02,OPNPWA(,OPNPTR)                                 1906
         BNE   @RF01906                                            1906
*                DO;                                       /*@Y30SSFR*/
*                CTGFVPTR = FVTPTR(1);                     /*@Y30SSFR*/
         L     @15,FVTPTR                                          1908
         ST    @15,CTGFVPTR                                        1908
*                IF CTGFVSTY ^= NULLPTR                    /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         L     @15,CTGFVSTY(,@15)                                  1909
         CR    @15,@02                                             1909
         BE    @RF01909                                            1909
*                    DO;                                   /*@Y30SSFR*/
*                    CTGFLPTR = CTGFVSTY;                  /*@Y30SSFR*/
         LR    CTGFLPTR,@15                                        1911
*                    OPNPWA = CTGFLPT(1);                  /*@Y30SSFR*/
         L     @05,CTGFLPT(,CTGFLPTR)                              1912
         ST    @05,OPNPWA(,OPNPTR)                                 1912
*                    END;                                  /*@Y30SSFR*/
*                END;                                      /*@Y30SSFR*/
@RF01909 DS    0H                                                  1915
*            END;                                                  1915
*                                                                  1915
@RF01906 DS    0H                                                  1916
*        /************************************************************/
*        /*                                                          */
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */
*        /*  INPUT                                                   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1916
*        OPNIOC = OIOCS;                                           1916
*                                                                  1916
@RF01889 L     @15,@PC00011+20                                     1916
         L     @15,OIOCS(,@15)                                     1916
         ST    @15,OPNIOC(,OPNPTR)                                 1916
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */
*        /*                                                          */
*        /************************************************************/
*                                                                  1917
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            1917
*                                                                  1917
         L     @15,@PC00001                                        1917
         ST    @15,@AL00001                                        1917
         ST    OPNPTR,@AL00001+4                                   1917
         MVI   @AL00001+4,X'80'                                    1917
         L     @15,GDTOPN(,@15)                                    1917
         LA    @01,@AL00001                                        1917
         BALR  @14,@15                                             1917
*        RESPECIFY RTNREG RSTD;                                    1918
*        TESTRC = RTNREG;                                          1919
         LR    TESTRC,RTNREG                                       1919
*        RESPECIFY RTNREG UNRSTD;                                  1920
*                                                                  1920
*        /************************************************************/
*        /*                                                          */
*        /*  TEST RETURN CODE FROM OPEN.  IF NOT SUCCESSFUL, CLOSE   */
*        /*  DATA SET TO FREE CORE, AND SET RETURN CODE TO FAILURE   */
*        /*                                                          */
*        /************************************************************/
*                                                                  1921
*        IF TESTRC ^= 0                                            1921
*          THEN                                                    1921
         LTR   TESTRC,TESTRC                                       1921
         BZ    @RF01921                                            1921
*            DO;                                                   1922
*                                                                  1922
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);                      1923
*                                                                  1923
         L     @02,@PC00001                                        1923
         ST    @02,@AL00001                                        1923
         L     @15,@PC00011+20                                     1923
         L     @01,OIOCS(,@15)                                     1923
         ST    @01,@AL00001+4                                      1923
         MVI   @AL00001+4,X'80'                                    1923
         L     @15,GDTCLS(,@02)                                    1923
         LA    @01,@AL00001                                        1923
         BALR  @14,@15                                             1923
*            OIOCSPTR = NULLPTR;                                   1924
         L     @02,@PC00011+20                                     1924
         L     @02,OIOCS(,@02)                                     1924
         SLR   @15,@15                                             1924
         ST    @15,OIOCSPTR(,@02)                                  1924
*            RETURN CODE(LASTCC12);                                1925
         LA    @15,12                                              1925
         L     @14,@SA00011                                        1925
         LM    @00,@02,@SA00011+8                                  1925
         LM    @04,@12,@SA00011+20                                 1925
         BR    @14                                                 1925
*            END;                                                  1926
*          ELSE                                                    1927
*            /********************************************************/
*            /*                                                      */
*            /*  RETURN TO CALLER WITH SUCCESS INDICATED             */
*            /*                                                      */
*            /********************************************************/
*                                                                  1927
*            RETURN CODE(0);                                       1927
*                                                                  1927
@RF01921 SLR   @15,@15                                             1927
         L     @14,@SA00011                                        1927
         LM    @00,@02,@SA00011+8                                  1927
         LM    @04,@12,@SA00011+20                                 1927
         BR    @14                                                 1927
*END OPENPROC;                                                     1928
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - RANGPROC                               */
*        /*                                                          */
*        /*  FUNCTION - RANGPROC WILL PROCESS ALL INFORMATIION       */
*        /*  DEALING WITH KEYRANGES.  IT WILL BUILD THE RANGES LIST  */
*        /*  THE HIKEYV AND LOKEYV CATALOG INFORMATION FROM  VOLUME  */
*        /*  OF PORTABILITY, AND IT WILL BUILD THE RANGES LIST FROM  */
*        /*  THE OBJECTS PARAMETER IN THE AMS COMMAND.               */
*        /*  WHEN THE LIST IS CONSTRUCTED FROM THE KEYRANGES PARAMETER*
*        /*  IN THE AMS COMMAND, A POINTER TO THE LIST IS PLACED IN  */
*        /*  THE FIELD RANGEPTR, THEN PRIOR TO CALLING CATALOG       */
*        /*  MANAGEMENT, THE POINTER IS PLACED IN THE DATA FVT.      */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    RX - INDEX TO OBJECT PARAMETER OR ZERO                */
*        /*    RDICT - DICTIONARY POINTER                            */
*        /*    RWKA - WORK AREA POINTER (CONTAINS CATALOG FIELD INFO)*/
*        /*    RRANGPTR - PTR TO FIELD IN WHICH TO PLACE LISTRNGS    */
*        /*    POINTER                                               */
*        /*                                                          */
*        /*  OUTPUT - A LISTRNGS LIST OF KEY RANGES WILL HAVE BEEN   */
*        /*  CONSTRUCTED                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1929
*RANGPROC: PROCEDURE(RX,               /*INDEX TO OBJECTS PARAMETER  */
*                   RDICT,             /*DICTIONARY POINTER          */
*                   RWKA,              /*WORK AREA POINTER           */
*                   RRANGPTR);         /*RETURN CELL FOR LISTRNGS    */
RANGPROC STM   @14,@12,@SA00012                                    1929
         MVC   @PC00012(16),0(@01)                                 1929
*                                      /*LIST                        */
*                                                                  1930
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  1930
*        DCL RX        FIXED(31),                                  1930
*            RDICT     PTR(31),                                    1930
*            RWKA      PTR(31),                                    1930
*            RRANGPTR  PTR(31);                                    1930
*                                                                  1930
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARES                                          */
*        /*                                                          */
*        /************************************************************/
*        DCL KEYLENGH FIXED(31);                                   1931
*        DCL 1 FRANGLST BASED(RRANGPTR),                           1932
*              2 FRANGLN   FIXED(15);  /*LENGTH OF LIST EXCLUDING    */
*                                      /*THIS 2-BYTE FIELD           */
*       DCL 1 FRANGES BASED(FRANPTR1),/*DESCRIPTION OF EACH HIGH  */
*                                      /*KEY-LOW KEY PAIR            */
*                2 FKEYLN FIXED(15),   /*LENGTH OF LOW KEY           */
*                2 FKEY   CHAR(*);    /*VARIABLE LENGTH KEY         */
*        DCL FRANPTR1 PTR(31);         /*POINTER TO EACH MEMBER OF   */
*                                      /*LOW KEY-HIGH KEY PAIR       */
*                                                                  1935
*        DCL RPTR1  PTR(31);           /*POINTER TO KEY VALUE        */
*        DCL RPTR2  PTR(31);           /*POINTER TO KEY VALUE        */
*        DCL LENG   FIXED(15);         /*USED TO CONSTRUCT LISTRNGS  */
*                                      /*FROM HIKEYV-LOKEYV FIELDS   */
*        DCL RDOCNTRL BIT(1);          /*LOOP CONTROL                */
*        DCL LKEY  CHAR(64);                                       1939
*        DCL HKEY  CHAR(64);           /*HIGH KEY FOR RANGE VALIDITY */
*                                      /*CHECK                       */
*        DCL 1 FFS    CHAR(64) STATIC LOCAL,               /*@Y30SSFR*/
*              2 *(64) CHAR(1) INIT ((64)'FF'X);           /*@ZA00954*/
*        DCL KERROR BIT(1);            /*SET WHEN KEYRANGES INVALID  */
*        DCL HILN  FIXED(31);          /*LENGTH OF HIGH KEY  @Y30SSFR*/
*        DCL LOWLN FIXED(31);          /*LENGTH OF LOW KEY   @Y30SSFR*/
*                                                                  1944
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE DICTIONARY POINTER IS ZERO, THEN CONSTRUCT THE   */
*        /*  KEY RANGES LIST FROM THE OBJECT PARAMETER IN AMS COMMAND*/
*        /*                                                          */
*        /************************************************************/
*                                                                  1945
*        IF RDICT = NULLPTR                                        1945
*          THEN                                                    1945
         L     @15,@PC00012+4                                      1945
         L     @15,RDICT(,@15)                                     1945
         LTR   @15,@15                                             1945
         BNZ   @RF01945                                            1945
*RANGFCMD:   DO;                                                   1946
*                                                                  1946
RANGFCMD DS    0H                                                  1947
*            /********************************************************/
*            /*                                                      */
*            /*  IF RANGES WAS SPECIFIED IN THE AMS COMMAND,         */
*            /*  CONSTRUCT A KEY RANGES LIST                         */
*            /*                                                      */
*            /********************************************************/
*                                                                  1947
*            IF RANGEPTR(RX) ^= NULLPTR                            1947
*              THEN                                                1947
         L     @15,@PC00012                                        1947
         L     @15,RX(,@15)                                        1947
         SLA   @15,2                                               1947
         L     @14,@PC00001+4                                      1947
         L     @01,FDTPTR+28(,@14)                                 1947
         AL    @01,@CF01689                                        1947
         L     @15,RANGEPTR(@15,@01)                               1947
         LTR   @15,@15                                             1947
         BZ    @RF01947                                            1947
*                DO;                                               1948
*                                                                  1948
*                /****************************************************/
*                /*                                                  */
*                /*  VALIDITY CHECK KEY RANGES SPECIFIED BY USER     */
*                /*                                                  */
*                /****************************************************/
*                                                                  1949
*                KERROR = OFF;                                     1949
         NI    KERROR,B'01111111'                                  1949
*KCOMP1:         DO N = 1 TO RANGECNT(RX) WHILE KERROR = OFF;      1950
KCOMP1   LA    N,1                                                 1950
         B     @DE01950                                            1950
@DL01950 TM    KERROR,B'10000000'                                  1950
         BNZ   @DC01950                                            1950
*                  LKEY = ''B;                                     1951
         XC    LKEY(64),LKEY                                       1951
*                  HKEY = FFS;                                     1952
         MVC   HKEY(64),FFS                                        1952
*                  LKEY = LOWKYPTR(RX,N) ->                        1953
*                    LOWKYVAL(1:LOWKYPTR(RX,N) -> LOWKYLEN);       1953
         MVI   LKEY+1,C' '                                         1953
         MVC   LKEY+2(62),LKEY+1                                   1953
         L     @02,@PC00012                                        1953
         L     @02,RX(,@02)                                        1953
         MH    @02,@CH00629                                        1953
         ALR   @02,N                                               1953
         SLA   @02,2                                               1953
         L     @15,@PC00001+4                                      1953
         L     @01,FDTPTR+44(,@15)                                 1953
         AL    @01,@CF01710                                        1953
         L     @14,LOWKYPTR(@02,@01)                               1953
         SLR   @05,@05                                             1953
         IC    @05,LOWKYLEN(,@14)                                  1953
         BCTR  @05,0                                               1953
         EX    @05,@SM01711                                        1953
*                  HKEY = HIKEYPTR(RX,N) ->                        1954
*                    HIKEYVAL(1:HIKEYPTR(RX,N) -> HIKEYLEN);       1954
*                                                                  1954
         MVI   HKEY+1,C' '                                         1954
         MVC   HKEY+2(62),HKEY+1                                   1954
         L     @01,FDTPTR+48(,@15)                                 1954
         AL    @01,@CF01710                                        1954
         L     @02,HIKEYPTR(@02,@01)                               1954
         SLR   @15,@15                                             1954
         IC    @15,HIKEYLEN(,@02)                                  1954
         BCTR  @15,0                                               1954
         EX    @15,@SM01713                                        1954
*                /****************************************************/
*                /*                                                  */
*                /*  CHECK THAT HIGH KEY IS INDEED HIGHER THAN LOW   */
*                /*  KEY                                             */
*                /*                                                  */
*                /****************************************************/
*                                                                  1955
*                  IF HKEY < LKEY                                  1955
*                    THEN                                          1955
         CLC   HKEY(64),LKEY                                       1955
         BNL   @RF01955                                            1955
*                      KERROR = ON;                                1956
*                                                                  1956
         OI    KERROR,B'10000000'                                  1956
*                  /**************************************************/
*                  /*                                                */
*                  /*  CHECK FOR OVERLAP BETEEN HIGH KEY-LOW KEY     */
*                  /*  PAIRS                                         */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1957
*                  DO J = (N + 1) TO RANGECNT(RX);                 1957
*                                                                  1957
@RF01955 LA    J,1                                                 1957
         ALR   J,N                                                 1957
         B     @DE01957                                            1957
@DL01957 DS    0H                                                  1958
*                    LOWLN = LOWKYPTR(RX,J) -> LOWKYLEN;           1958
         L     @05,@PC00012                                        1958
         L     @05,RX(,@05)                                        1958
         MH    @05,@CH00629                                        1958
         ALR   @05,J                                               1958
         SLA   @05,2                                               1958
         L     @15,@PC00001+4                                      1958
         L     @01,FDTPTR+44(,@15)                                 1958
         AL    @01,@CF01710                                        1958
         L     @14,LOWKYPTR(@05,@01)                               1958
         SLR   @01,@01                                             1958
         IC    @01,LOWKYLEN(,@14)                                  1958
         ST    @01,LOWLN                                           1958
*                    HILN = HIKEYPTR(RX,J) -> HIKEYLEN;            1959
*                                                                  1959
         L     @15,FDTPTR+48(,@15)                                 1959
         AL    @15,@CF01710                                        1959
         L     @15,HIKEYPTR(@05,@15)                               1959
         SLR   HILN,HILN                                           1959
         IC    HILN,HIKEYLEN(,@15)                                 1959
*                    IF LKEY(1:LOWLN) >= LOWKYPTR(RX,J) ->         1960
*                      LOWKYVAL(1:LOWLN) &                         1960
*                      LKEY(1:HILN) <= HIKEYPTR(RX,J)->HIKEYVAL(1:HILN)
*                      THEN                                        1960
         BCTR  @01,0                                               1960
         EX    @01,@SC01715                                        1960
         BL    @RF01960                                            1960
         LR    @05,HILN                                            1960
         BCTR  @05,0                                               1960
         EX    @05,@SC01717                                        1960
         BH    @RF01960                                            1960
*                        KERROR = ON;                              1961
*                                                                  1961
         OI    KERROR,B'10000000'                                  1961
*                    IF HKEY(1:LOWLN) >= LOWKYPTR(RX,J) ->         1962
*                      LOWKYVAL(1:LOWLN) &                         1962
*                      HKEY(1:HILN) <= HIKEYPTR(RX,J)->HIKEYVAL(1:HILN)
*                      THEN                                        1962
@RF01960 L     @05,@PC00012                                        1962
         L     @05,RX(,@05)                                        1962
         MH    @05,@CH00629                                        1962
         ALR   @05,J                                               1962
         SLA   @05,2                                               1962
         L     @15,@PC00001+4                                      1962
         L     @01,FDTPTR+44(,@15)                                 1962
         AL    @01,@CF01710                                        1962
         L     @01,LOWKYPTR(@05,@01)                               1962
         L     @14,LOWLN                                           1962
         BCTR  @14,0                                               1962
         EX    @14,@SC01719                                        1962
         BL    @RF01962                                            1962
         L     @01,FDTPTR+48(,@15)                                 1962
         AL    @01,@CF01710                                        1962
         L     @05,HIKEYPTR(@05,@01)                               1962
         LR    @15,HILN                                            1962
         BCTR  @15,0                                               1962
         EX    @15,@SC01721                                        1962
         BH    @RF01962                                            1962
*                        KERROR = ON;                              1963
         OI    KERROR,B'10000000'                                  1963
*                  END;                                            1964
@RF01962 AL    J,@CF00221                                          1964
@DE01957 L     @15,@PC00012                                        1964
         L     @15,RX(,@15)                                        1964
         SLA   @15,2                                               1964
         L     @14,@PC00001+4                                      1964
         L     @01,FDTPTR+28(,@14)                                 1964
         AL    @01,@CF01689                                        1964
         C     J,RANGECNT(@15,@01)                                 1964
         BNH   @DL01957                                            1964
*                END KCOMP1;                                       1965
*                                                                  1965
         AL    N,@CF00221                                          1965
@DE01950 L     @02,@PC00012                                        1965
         L     @02,RX(,@02)                                        1965
         SLA   @02,2                                               1965
         L     @15,@PC00001+4                                      1965
         L     @01,FDTPTR+28(,@15)                                 1965
         AL    @01,@CF01689                                        1965
         C     N,RANGECNT(@02,@01)                                 1965
         BNH   @DL01950                                            1965
@DC01950 DS    0H                                                  1966
*                /****************************************************/
*                /*                                                  */
*                /*  IF KEYRANGES ARE INVALID, TERMINATE WITH ERROR  */
*                /*                                                  */
*                /****************************************************/
*                                                                  1966
*                IF KERROR = ON                                    1966
*                  THEN                                            1966
         TM    KERROR,B'10000000'                                  1966
         BNO   @RF01966                                            1966
*                    DO;                                           1967
*                    DEFSTID = BADRANG;                            1968
         MVI   DEFSTID,X'0F'                                       1968
*                    DARGSMOD = DEFMODID;                          1969
         L     @01,DDSTRU                                          1969
         MVC   DARGSMOD(3,@01),@CC01038                            1969
*                    RETURN CODE(LASTCC12);                        1970
         LA    @15,12                                              1970
         L     @14,@SA00012                                        1970
         LM    @00,@12,@SA00012+8                                  1970
         BR    @14                                                 1970
*                    END;                                          1971
*                                                                  1971
*                /****************************************************/
*                /*                                                  */
*                /*  COMPUTE THE AMOUNT OF CORE NEEDED FOR THE RANGES*/
*                /*  LIST AND OBTAIN THAT MUCH CORE                  */
*                /*                                                  */
*                /****************************************************/
*                                                                  1972
*                KEYLENGH = 0;                                     1972
@RF01966 SLR   KEYLENGH,KEYLENGH                                   1972
*                DO N= 1 TO RANGECNT(RX);                          1973
         LA    N,1                                                 1973
         B     @DE01973                                            1973
@DL01973 DS    0H                                                  1974
*                  KEYLENGH = KEYLENGH + LOWKYPTR(RX,N) -> LOWKYLEN
*                    + HIKEYPTR(RX,N) ->  HIKEYLEN;                1974
         L     @15,@PC00012                                        1974
         L     @15,RX(,@15)                                        1974
         MH    @15,@CH00629                                        1974
         ALR   @15,N                                               1974
         SLA   @15,2                                               1974
         L     @14,@PC00001+4                                      1974
         L     @01,FDTPTR+44(,@14)                                 1974
         AL    @01,@CF01710                                        1974
         L     @01,LOWKYPTR(@15,@01)                               1974
         LR    @00,KEYLENGH                                        1974
         SLR   @05,@05                                             1974
         IC    @05,LOWKYLEN(,@01)                                  1974
         ALR   @00,@05                                             1974
         L     @01,FDTPTR+48(,@14)                                 1974
         AL    @01,@CF01710                                        1974
         L     @01,HIKEYPTR(@15,@01)                               1974
         SLR   @15,@15                                             1974
         IC    @15,HIKEYLEN(,@01)                                  1974
         ALR   @00,@15                                             1974
         LR    KEYLENGH,@00                                        1974
*                END;                                              1975
         AL    N,@CF00221                                          1975
@DE01973 L     @15,@PC00012                                        1975
         L     @15,RX(,@15)                                        1975
         SLA   @15,2                                               1975
         L     @14,@PC00001+4                                      1975
         L     @01,FDTPTR+28(,@14)                                 1975
         AL    @01,@CF01689                                        1975
         C     N,RANGECNT(@15,@01)                                 1975
         BNH   @DL01973                                            1975
*                TOTLEN = (RANGECNT(RX) * 4) +  KEYLENGH + 2;      1976
*                                                                  1976
         L     @03,@PC00012                                        1976
         L     @03,RX(,@03)                                        1976
         SLA   @03,2                                               1976
         L     @15,@PC00001+4                                      1976
         L     @01,FDTPTR+28(,@15)                                 1976
         AL    @01,@CF01689                                        1976
         L     @03,RANGECNT(@03,@01)                               1976
         SLA   @03,2                                               1976
         ALR   @03,KEYLENGH                                        1976
         AL    @03,@CF00156                                        1976
         ST    @03,TOTLEN                                          1976
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,RRANGPTR,GPID,SETZERO);
*                                                                  1977
         L     @03,@PC00001                                        1977
         ST    @03,@AL00001                                        1977
         LA    @15,TOTLEN                                          1977
         ST    @15,@AL00001+4                                      1977
         L     @15,@PC00012+12                                     1977
         ST    @15,@AL00001+8                                      1977
         LA    @15,GPID                                            1977
         ST    @15,@AL00001+12                                     1977
         LA    @15,SETZERO                                         1977
         ST    @15,@AL00001+16                                     1977
         MVI   @AL00001+16,X'80'                                   1977
         L     @15,GDTGPL(,@03)                                    1977
         LA    @01,@AL00001                                        1977
         BALR  @14,@15                                             1977
*                RESPECIFY RTNREG RSTD;                            1978
*                TESTRC = RTNREG;                                  1979
         LR    TESTRC,RTNREG                                       1979
*                RESPECIFY RTNREG UNRSTD;                          1980
*                IF TESTRC ^= 0                                    1981
*                  THEN                                            1981
*                                                                  1981
         LTR   TESTRC,TESTRC                                       1981
         BZ    @RF01981                                            1981
*                    /************************************************/
*                    /*                                              */
*                    /*  CORE WAS NOT OBTAINED SUCCESSFULLY. RETURN  */
*                    /*  TO CALLING PROCESSOR.                       */
*                    /*                                              */
*                    /************************************************/
*                                                                  1982
*                    DO;                                           1982
*                    DARGSMOD = UNIVMSG;                           1983
         L     @01,DDSTRU                                          1983
         MVC   DARGSMOD(3,@01),@CC01023                            1983
*                    DEFSTID = NOSTORAG;                           1984
         MVI   DEFSTID,X'04'                                       1984
*                    RETURN CODE(LASTCC12);                        1985
         LA    @15,12                                              1985
         L     @14,@SA00012                                        1985
         LM    @00,@12,@SA00012+8                                  1985
         BR    @14                                                 1985
*                    END;                                          1986
*                FRANPTR1 = RRANGPTR + 2;                          1987
*                                                                  1987
@RF01981 L     @15,@PC00012+12                                     1987
         LA    FRANPTR1,2                                          1987
         AL    FRANPTR1,RRANGPTR(,@15)                             1987
*                /****************************************************/
*                /*                                                  */
*                /*  NOW CONSTRUCT THE RANGES LIST FROM THE HIGH     */
*                /*  KEY- LOW KEY PAIRS SPECIFIED IN THE AMS COMMAND */
*                /*                                                  */
*                /****************************************************/
*                                                                  1988
*                DO N = 1 TO RANGECNT(RX);                         1988
*                                                                  1988
         LA    N,1                                                 1988
         B     @DE01988                                            1988
@DL01988 DS    0H                                                  1989
*                  /**************************************************/
*                  /*                                                */
*                  /*  SET LENGTH OF LOW KEY AND MOVE LOW KEY INTO   */
*                  /*  LIST.                                         */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1989
*                  FKEYLN = LOWKYPTR(RX,N) -> LOWKYLEN;            1989
         L     @15,@PC00012                                        1989
         L     @15,RX(,@15)                                        1989
         MH    @15,@CH00629                                        1989
         ALR   @15,N                                               1989
         SLA   @15,2                                               1989
         L     @14,@PC00001+4                                      1989
         L     @01,FDTPTR+44(,@14)                                 1989
         AL    @01,@CF01710                                        1989
         L     @05,LOWKYPTR(@15,@01)                               1989
         SLR   @04,@04                                             1989
         IC    @04,LOWKYLEN(,@05)                                  1989
         STH   @04,FKEYLN(,FRANPTR1)                               1989
*                  FKEY(1:FKEYLN) = LOWKYPTR(RX,N) ->              1990
*                     LOWKYVAL(1:FKEYLN);                          1990
         LR    @01,@04                                             1990
         BCTR  @01,0                                               1990
         EX    @01,@SM01723                                        1990
*                  FRANPTR1 = FRANPTR1 + LENGTH(FKEYLN) + FKEYLN;  1991
*                                                                  1991
         LA    @05,2                                               1991
         LR    @01,FRANPTR1                                        1991
         ALR   @01,@05                                             1991
         ALR   @01,@04                                             1991
         LR    FRANPTR1,@01                                        1991
*                  /**************************************************/
*                  /*                                                */
*                  /*  SET LENGTH OF HIGH KEY AND MOVE HIGH KEY INTO */
*                  /*  LIST.                                         */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1992
*                  FKEYLN = HIKEYPTR(RX,N) -> HIKEYLEN;            1992
         L     @01,FDTPTR+48(,@14)                                 1992
         AL    @01,@CF01710                                        1992
         L     @04,HIKEYPTR(@15,@01)                               1992
         SLR   @15,@15                                             1992
         IC    @15,HIKEYLEN(,@04)                                  1992
         STH   @15,FKEYLN(,FRANPTR1)                               1992
*                  FKEY(1:FKEYLN) = HIKEYPTR(RX,N) ->              1993
*                    HIKEYVAL(1:FKEYLN);                           1993
         LR    @14,@15                                             1993
         BCTR  @14,0                                               1993
         EX    @14,@SM01725                                        1993
*                  FRANPTR1 = FRANPTR1 + LENGTH(FKEYLN) + FKEYLN;  1994
         ALR   @05,FRANPTR1                                        1994
         ALR   @05,@15                                             1994
         LR    FRANPTR1,@05                                        1994
*                  END;                                            1995
*                                                                  1995
         AL    N,@CF00221                                          1995
@DE01988 L     @15,@PC00012                                        1995
         L     @15,RX(,@15)                                        1995
         SLA   @15,2                                               1995
         L     @14,@PC00001+4                                      1995
         L     @01,FDTPTR+28(,@14)                                 1995
         AL    @01,@CF01689                                        1995
         C     N,RANGECNT(@15,@01)                                 1995
         BNH   @DL01988                                            1995
*                /****************************************************/
*                /*                                                  */
*                /*  SET TOTAL LENGTH OF LIST IN FIRST TWO BYTES OF  */
*                /*  OF THE LIST.                                    */
*                /*                                                  */
*                /****************************************************/
*                                                                  1996
*                FRANGLN = TOTLEN;                                 1996
         L     @15,@PC00012+12                                     1996
         L     @01,RRANGPTR(,@15)                                  1996
         L     @00,TOTLEN                                          1996
         STH   @00,FRANGLN(,@01)                                   1996
*                END;                                              1997
*                                                                  1997
*          ELSE;                                                   1998
@RF01947 DS    0H                                                  1999
*        END RANGFCMD;                                             1999
*                                                                  1999
*          /**********************************************************/
*          /*                                                        */
*          /*  THE RANGE LIST IS TO BE CONSTRUCTED FROM CATALOG      */
*          /*  INFORMATION READ IN FROM THE PORTABILITY VOLUME.      */
*          /*  THE HIKEYV AND LOKEYV CATALOG FIELDS CONTAIN THE      */
*          /*  INFORMATION                                           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  2000
*          ELSE                                                    2000
*RANGFDCT:   DO;                                                   2000
         B     @RC01945                                            2000
@RF01945 DS    0H                                                  2000
RANGFDCT DS    0H                                                  2001
*            DICTPTR = RDICT;                                      2001
         L     @15,@PC00012+4                                      2001
         L     @15,RDICT(,@15)                                     2001
         ST    @15,DICTPTR                                         2001
*            IF DICTLN(IHIKEYV) ^= 0 &                             2002
*              DICTLN(ILOKEYV) ^= 0                                2002
*              THEN                                                2002
         SLR   @14,@14                                             2002
         L     @05,DICTLN+120(,@15)                                2002
         CR    @05,@14                                             2002
         BE    @RF02002                                            2002
         L     @15,DICTLN+112(,@15)                                2002
         CR    @15,@14                                             2002
         BE    @RF02002                                            2002
*                DO;                                               2003
*                                                                  2003
*                /****************************************************/
*                /*                                                  */
*                /*  COMPUTE SIZE OF RANGES LIST  AND OBTAIN CORE    */
*                /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING      */
*                /*  PROCESSOR                                       */
*                /*                                                  */
*                /****************************************************/
*                                                                  2004
*                TOTLEN = DICTLN(IHIKEYV) + DICTLN(ILOKEYV) + 2;   2004
*                                                                  2004
         ALR   @05,@15                                             2004
         AL    @05,@CF00156                                        2004
         ST    @05,TOTLEN                                          2004
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,RRANGPTR,GPID,SETZERO);
*                                                                  2005
         L     @03,@PC00001                                        2005
         ST    @03,@AL00001                                        2005
         LA    @15,TOTLEN                                          2005
         ST    @15,@AL00001+4                                      2005
         L     @15,@PC00012+12                                     2005
         ST    @15,@AL00001+8                                      2005
         LA    @15,GPID                                            2005
         ST    @15,@AL00001+12                                     2005
         LA    @15,SETZERO                                         2005
         ST    @15,@AL00001+16                                     2005
         MVI   @AL00001+16,X'80'                                   2005
         L     @15,GDTGPL(,@03)                                    2005
         LA    @01,@AL00001                                        2005
         BALR  @14,@15                                             2005
*                RESPECIFY RTNREG RSTD;                            2006
*                TESTRC = RTNREG;                                  2007
         LR    TESTRC,RTNREG                                       2007
*                RESPECIFY RTNREG UNRSTD;                          2008
*                IF TESTRC ^= 0                                    2009
*                  THEN                                            2009
         LTR   TESTRC,TESTRC                                       2009
         BZ    @RF02009                                            2009
*                    DO;                                           2010
*                    DEFSTID = NOSTORAG;                           2011
         MVI   DEFSTID,X'04'                                       2011
*                    DARGSMOD = UNIVMSG;                           2012
         L     @01,DDSTRU                                          2012
         MVC   DARGSMOD(3,@01),@CC01023                            2012
*                    RETURN CODE(LASTCC12);                        2013
         LA    @15,12                                              2013
         L     @14,@SA00012                                        2013
         LM    @00,@12,@SA00012+8                                  2013
         BR    @14                                                 2013
*                    END;                                          2014
*                                                                  2014
*                /****************************************************/
*                /*                                                  */
*                /*  SET POINTERS TO START OF HIGH KEY AND LOW KEY   */
*                /*  VALUES.  INITIALIZE LOOP CONTROL.               */
*                /*                                                  */
*                /****************************************************/
*                                                                  2015
*                FRANPTR1 = RRANGPTR + 2;                          2015
@RF02009 LA    @05,2                                               2015
         L     @15,@PC00012+12                                     2015
         L     FRANPTR1,RRANGPTR(,@15)                             2015
         ALR   FRANPTR1,@05                                        2015
*                LENG = TOTLEN - 2;                                2016
         LCR   @05,@05                                             2016
         AL    @05,TOTLEN                                          2016
         LR    LENG,@05                                            2016
*                RPTR1 = DICTDL(ILOKEYV) + RWKA;                   2017
         L     @15,DICTPTR                                         2017
         L     @14,@PC00012+8                                      2017
         L     @14,RWKA(,@14)                                      2017
         L     RPTR1,DICTDL+112(,@15)                              2017
         ALR   RPTR1,@14                                           2017
*                RPTR2 = DICTDL(IHIKEYV) + RWKA;                   2018
*                                                                  2018
         AL    @14,DICTDL+120(,@15)                                2018
         ST    @14,RPTR2                                           2018
*                DO WHILE LENG > 0;                                2019
*                                                                  2019
         B     @DE02019                                            2019
@DL02019 DS    0H                                                  2020
*                  /**************************************************/
*                  /*                                                */
*                  /*  MOVE LOW KEY & LENGTH INTO RANGE LIST. UPDATE */
*                  /*  POINTERS AND LOOP CONTROL.                    */
*                  /*                                                */
*                  /**************************************************/
*                                                                  2020
*                  FKEYLN = RPTR1 -> FIELDR(1:2);                  2020
*                                                                  2020
         SLR   @05,@05                                             2020
         ICM   @05,3,FIELDR(RPTR1)                                 2020
         STH   @05,FKEYLN(,FRANPTR1)                               2020
*                  IF FKEYLN ^= 0                          /*@OZ10865*/
*                   THEN                                   /*@OZ10865*/
         LTR   @05,@05                                             2021
         BZ    @RF02021                                            2021
*                     FKEY(1:FKEYLN) = (RPTR1 + 2) -> FIELDR(1:FKEYLN);
         BCTR  @05,0                                               2022
         EX    @05,@SM01727                                        2022
*                                                          /*@OZ10865*/
*                  RPTR1 = RPTR1 + FKEYLN + 2;                     2023
@RF02021 LA    @05,2                                               2023
         LH    @15,FKEYLN(,FRANPTR1)                               2023
         LR    @14,RPTR1                                           2023
         ALR   @14,@15                                             2023
         ALR   @14,@05                                             2023
         LR    RPTR1,@14                                           2023
*                  LENG = LENG - FKEYLN - 2;                       2024
         LR    @14,LENG                                            2024
         SLR   @14,@15                                             2024
         SLR   @14,@05                                             2024
         LR    LENG,@14                                            2024
*                  FRANPTR1 = FRANPTR1 + FKEYLN + 2;               2025
*                                                                  2025
         ALR   @15,FRANPTR1                                        2025
         ALR   @15,@05                                             2025
         LR    FRANPTR1,@15                                        2025
*                  /**************************************************/
*                  /*                                                */
*                  /*  MOVE HIGH KEY & LENGTH INTO RANGE LIST. UPDATE*/
*                  /*  POINTERS AND LOOP CONTROL                     */
*                  /*                                                */
*                  /**************************************************/
*                                                                  2026
*                  FKEYLN = RPTR2 -> FIELDR(1:2);                  2026
*                                                                  2026
         L     @15,RPTR2                                           2026
         SLR   @14,@14                                             2026
         ICM   @14,3,FIELDR(@15)                                   2026
         STH   @14,FKEYLN(,FRANPTR1)                               2026
*                  IF FKEYLN ^= 0                          /*@OZ10865*/
*                    THEN                                  /*@OZ10865*/
         LTR   @14,@14                                             2027
         BZ    @RF02027                                            2027
*                       FKEY(1:FKEYLN) = (RPTR2+2) -> FIELDR(1:FKEYLN);
         BCTR  @14,0                                               2028
         ALR   @15,@05                                             2028
         EX    @14,@SM01729                                        2028
*                                                          /*@OZ10865*/
*                  RPTR2 = RPTR2 + FKEYLN + 2;                     2029
@RF02027 LA    @05,2                                               2029
         LH    @15,FKEYLN(,FRANPTR1)                               2029
         L     @14,RPTR2                                           2029
         ALR   @14,@15                                             2029
         ALR   @14,@05                                             2029
         ST    @14,RPTR2                                           2029
*                  LENG = LENG - FKEYLN - 2;                       2030
         LR    @14,LENG                                            2030
         SLR   @14,@15                                             2030
         SLR   @14,@05                                             2030
         LR    LENG,@14                                            2030
*                  FRANPTR1 = FRANPTR1 + FKEYLN + 2;               2031
         ALR   @15,FRANPTR1                                        2031
         ALR   @15,@05                                             2031
         LR    FRANPTR1,@15                                        2031
*                END;                                              2032
*                                                                  2032
@DE02019 LTR   LENG,LENG                                           2032
         BP    @DL02019                                            2032
*                  /**************************************************/
*                  /*                                                */
*                  /*  SET LENGTH OF ENTIRE LIST AND RETURN          */
*                  /*  WITH SUCCESS INDICATED                        */
*                  /*                                                */
*                  /**************************************************/
*                                                                  2033
*                FRANGLN = TOTLEN;                                 2033
         L     @15,@PC00012+12                                     2033
         L     @01,RRANGPTR(,@15)                                  2033
         L     @00,TOTLEN                                          2033
         STH   @00,FRANGLN(,@01)                                   2033
*                END;                                              2034
*          END RANGFDCT;                                           2035
*                                                                  2035
@RF02002 DS    0H                                                  2036
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2036
*        RETURN CODE(0);                                           2036
@RC01945 SLR   @15,@15                                             2036
         L     @14,@SA00012                                        2036
         LM    @00,@12,@SA00012+8                                  2036
         BR    @14                                                 2036
*END RANGPROC;                                                     2037
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME- BFPLPROC                                */
*        /*                                                          */
*        /*  FUNCTION - CONSTRUCT A FIELD PARAMETER LIST FROM        */
*        /*  DICTIONARY AND WORK AREA INFORMATION PASSED BY EXPORT   */
*        /*  ON PORTABILITY VOLUME OR CONSTRUCT A SKELETON FPL       */
*        /*  CONTAINING NO FIELD INFORMATION                         */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .BFLISTPT - POINTER TO THE FIELD LIST USED    @Y30SSFR*/
*        /*      TO PROVIDE CATALOG FIELD NAMES              @Y30SSFR*/
*        /*    .BINDX - INDEX OF FIELDNAME INTO FIELDLST             */
*        /*    .BFPLADDR - RETURN CELL FOR FPL ADDRESS               */
*        /*    .BDICTPTR - POINTER TO DICTIONARY WHICH REFERENCES    */
*        /*     CATALOG FIELD INFORMATION IN THE WORK AREA           */
*        /*    .BWKAPTR - WORK AREA REFERENCED BY DICTIONARY         */
*        /*                                                          */
*        /*  OUTPUT - A FPL IS CONSTRUCTED                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  2038
*BFPLPROC: PROCEDURE(BFLISTPT,         /*ADDRESS OF FIELD    @Y30SSFR*/
*                                      /*NAMES LIST          @Y30SSFR*/
*                    BINDX,            /*INDEX OF FIELDNAME  @Y30SSFR*/
*                    BFPLADDR,         /*RETURN CELL FOR FPL POINTER */
*                    BDICTPTR,         /*POINTER TO DICTIONARY       */
*                    BWKAPTR,          /*POINTER TO WORK AREA        */
*                                      /*REFERENCED BY DICTIONARY    */
*                    BFPLRTN);         /*ADDR IN WHICH TO STORE FPL  */
BFPLPROC STM   @14,@12,@SA00013                                    2038
         MVC   @PC00013(24),0(@01)                                 2038
*                                      /*POINTER(WITHIN A FVT)       */
*                                                                  2039
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2039
*        DCL BFLISTPT PTR(31),                                     2039
*            BINDX    FIXED(15),                                   2039
*            BFPLADDR PTR(31),                                     2039
*            BDICTPTR PTR(31),                                     2039
*            BWKAPTR  PTR(31),                                     2039
*            BFPLRTN  PTR(31);                                     2039
*                                                                  2039
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  LOCAL DECLARATIONS FOR BFPLPROC                 @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2040
*        DCL BFLIST(*) CHAR(8) BASED(BFLISTPT);            /*@Y30SSFR*/
*                                      /*TEMPLATE FOR FIELD  @Y30SSFR*/
*                                      /*NAME LIST           @Y30SSFR*/
*                                                                  2041
*        /************************************************************/
*        /*                                                          */
*        /*  IF THE DICTIONARY POINTER IS ZERO, THEN A SKELETON      */
*        /*  FIELD PARAMETER LIST(FPL) IS CONSTRUCTED                */
*        /*                                                          */
*        /************************************************************/
*                                                                  2041
*        OLDERID2 = NEWERID2;                                      2041
         L     @15,@PC00001                                        2041
         L     @14,GDTTR2(,@15)                                    2041
         MVC   @TS00001(95),NEWERID2(@14)                          2041
         MVC   OLDERID2(95,@14),@TS00001                           2041
*        NEWID2 = 'MPBF';                                          2042
*                                                                  2042
         MVC   NEWID2(4,@14),@CC01536                              2042
*        IF BDICTPTR = NULLPTR                                     2043
*          THEN                                                    2043
*                                                                  2043
         L     @14,@PC00013+12                                     2043
         L     @14,BDICTPTR(,@14)                                  2043
         LTR   @14,@14                                             2043
         BNZ   @RF02043                                            2043
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  TEST TO DETERMINE IF WE ARE BUILDING AN FPL @Y30SSFR*/
*            /*  FOR THE NAMEDS FIELD.                       @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2044
*            IF BINDX = INAMEDS                                    2044
*              THEN                                                2044
*                                                                  2044
         L     @14,@PC00013+4                                      2044
         CLC   BINDX(2,@14),@CH00705                               2044
         BNE   @RF02044                                            2044
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  BUILD AN FPL FOR NAMEDS AND ALSO A TEST @Y30SSFR*/
*                /*  FPL SO THAT CATALOG MANAGEMENT WILL     @Y30SSFR*/
*                /*  RETURN AT MOST THE FIRST TWO ASSOCIA-   @Y30SSFR*/
*                /*  TIONS FOUND IN THE CATALOG.             @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2045
*                DO;                                       /*@Y30SSFR*/
*                                                                  2045
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  GET CORE FOR TWO FPL'S.                 @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2046
*                CALL IDCSAGP0(GDTTBL,(2*(LENGTH(CTGFL)+8)),/*     2046
*                                                            @Y30SSFR*/
*                  BFPLADDR,GPID,SETZERO);                 /*@Y30SSFR*/
*                                                                  2046
         ST    @15,@AL00001                                        2046
         LA    @03,48                                              2046
         ST    @03,@AFTEMPS+16                                     2046
         LA    @03,@AFTEMPS+16                                     2046
         ST    @03,@AL00001+4                                      2046
         L     @03,@PC00013+8                                      2046
         ST    @03,@AL00001+8                                      2046
         LA    @03,GPID                                            2046
         ST    @03,@AL00001+12                                     2046
         LA    @03,SETZERO                                         2046
         ST    @03,@AL00001+16                                     2046
         MVI   @AL00001+16,X'80'                                   2046
         L     @15,GDTGPL(,@15)                                    2046
         LA    @01,@AL00001                                        2046
         BALR  @14,@15                                             2046
*                RESPECIFY RTNREG RSTD;                            2047
*                TESTRC = RTNREG;                                  2048
         LR    TESTRC,RTNREG                                       2048
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/
*                                                                  2049
*                IF TESTRC ^= 0                            /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2050
         BZ    @RF02050                                            2050
*                    DO;                                   /*@Y30SSFR*/
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/
         L     @01,DDSTRU                                          2052
         MVC   DARGSMOD(3,@01),@CC01023                            2052
*                    DEFSTID = NOSTORAG;                   /*@Y30SSFR*/
         MVI   DEFSTID,X'04'                                       2053
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/
         LA    @15,12                                              2054
         L     @14,@SA00013                                        2054
         LM    @00,@12,@SA00013+8                                  2054
         BR    @14                                                 2054
*                    END;                                  /*@Y30SSFR*/
*                                                                  2055
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  CONSTRUCT THE FPL FOR THE NAMEDS FIELD  @Y30SSFR*/
*                /*  ITSELF.                                 @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2056
*                CTGFLPTR = BFPLADDR;                      /*@Y30SSFR*/
@RF02050 L     @15,@PC00013+8                                      2056
         L     @15,BFPLADDR(,@15)                                  2056
         LR    CTGFLPTR,@15                                        2056
*                CTGFLDNO = '00000001'B;                   /*@Y30SSFR*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2057
*                CTGFLDNM = ADDR(BFLIST(BINDX));           /*@Y30SSFR*/
*                                                                  2058
         L     @05,@PC00013+4                                      2058
         LH    @05,BINDX(,@05)                                     2058
         SLA   @05,3                                               2058
         L     @14,@PC00013                                        2058
         L     @01,BFLISTPT(,@14)                                  2058
         AL    @01,@CF01731                                        2058
         LA    @05,BFLIST(@05,@01)                                 2058
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2058
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  SET THE CHAIN FIELD FROM THE NAMEDS     @Y30SSFR*/
*                /*  FPL.                                    @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2059
*                CTGFLCHN = BFPLADDR + LENGTH(CTGFL) + 8;  /*@Y30SSFR*/
*                                                                  2059
         AL    @15,@CF00312                                        2059
         ST    @15,CTGFLCHN(,CTGFLPTR)                             2059
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  SET THE CTGFLPTR TO POINT TO THE TEST   @Y30SSFR*/
*                /*  FPL.                                    @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2060
*                CTGFLPTR = CTGFLCHN;                      /*@Y30SSFR*/
*                                                                  2060
         LR    CTGFLPTR,@15                                        2060
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  CONSTRUCT THE TEST FPL ITSELF.          @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2061
*                CTGFLDNO = '00000001'B;                   /*@Y30SSFR*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2061
*                CTGFLDNM = ADDR(CNTREPNO);                /*@Y30SSFR*/
         LA    @05,CNTREPNO                                        2062
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2062
*                CTGFLDCD = CTGFLDLE;                      /*@Y30SSFR*/
         MVI   CTGFLDCD(CTGFLPTR),X'C0'                            2063
*                CTGFLNG(1) = LENGTH(NUMASSOB);            /*@Y30SSFR*/
         MVC   CTGFLNG(4,CTGFLPTR),@CF00156                        2064
*                CTGFLPT(1) = ADDR(NUMASSOB);              /*@Y30SSFR*/
*                                                                  2065
         LA    @05,@CH00156                                        2065
         ST    @05,CTGFLPT(,CTGFLPTR)                              2065
*                RETURN CODE(0);                           /*@Y30SSFR*/
*                                                                  2066
         SLR   @15,@15                                             2066
         L     @14,@SA00013                                        2066
         LM    @00,@12,@SA00013+8                                  2066
         BR    @14                                                 2066
*                END;                                      /*@Y30SSFR*/
*                                                                  2067
*              ELSE                                                2068
*                                                                  2068
*                DO;                                       /*@Y30SSFR*/
*                                                                  2068
@RF02044 DS    0H                                                  2069
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  GET CORE FOR A FPL                      @Y30SSFR*/
*                /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO */
*                /*  CALLING PROCESSOR.                      @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2069
*                CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGFL)+8),BFPLADDR,GPID,
*ETZERO);                                                          2069
         L     @03,@PC00001                                        2069
         ST    @03,@AL00001                                        2069
         LA    @15,24                                              2069
         ST    @15,@AFTEMPS+16                                     2069
         LA    @15,@AFTEMPS+16                                     2069
         ST    @15,@AL00001+4                                      2069
         L     @15,@PC00013+8                                      2069
         ST    @15,@AL00001+8                                      2069
         LA    @15,GPID                                            2069
         ST    @15,@AL00001+12                                     2069
         LA    @15,SETZERO                                         2069
         ST    @15,@AL00001+16                                     2069
         MVI   @AL00001+16,X'80'                                   2069
         L     @15,GDTGPL(,@03)                                    2069
         LA    @01,@AL00001                                        2069
         BALR  @14,@15                                             2069
*                RESPECIFY RTNREG RSTD;                            2070
*                TESTRC = RTNREG;                                  2071
         LR    TESTRC,RTNREG                                       2071
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSFR*/
*                IF TESTRC ^= 0                                    2073
*                  THEN                                            2073
         LTR   TESTRC,TESTRC                                       2073
         BZ    @RF02073                                            2073
*                    DO;                                   /*@Y30SSFR*/
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/
         L     @01,DDSTRU                                          2075
         MVC   DARGSMOD(3,@01),@CC01023                            2075
*                    DEFSTID = NOSTORAG;                   /*@Y30SSFR*/
         MVI   DEFSTID,X'04'                                       2076
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/
         LA    @15,12                                              2077
         L     @14,@SA00013                                        2077
         LM    @00,@12,@SA00013+8                                  2077
         BR    @14                                                 2077
*                    END;                                  /*@Y30SSFR*/
*                                                                  2078
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  SET FIELDS IN SKELETON FPL .  RETURN TO CALLING */
*                /*  PROCESSOR INDICATING SUCCESS.           @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2079
*                CTGFLPTR = BFPLADDR;  /*SET FPL BASE        @Y30SSFR*/
@RF02073 L     @15,@PC00013+8                                      2079
         L     CTGFLPTR,BFPLADDR(,@15)                             2079
*                CTGFLDNO = '00000001'B;                   /*@Y30SSFR*/
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2080
*                                      /*NUMBER OF LNG/ADDR PAIRS    */
*                CTGFLDNM = ADDR(BFLIST(BINDX));           /*@Y30SSFR*/
         L     @05,@PC00013+4                                      2081
         LH    @05,BINDX(,@05)                                     2081
         SLA   @05,3                                               2081
         L     @15,@PC00013                                        2081
         L     @01,BFLISTPT(,@15)                                  2081
         AL    @01,@CF01731                                        2081
         LA    @05,BFLIST(@05,@01)                                 2081
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2081
*                                      /*CATALOG FIELD NAME          */
*                RETURN CODE(0);                           /*@Y30SSFR*/
         SLR   @15,@15                                             2082
         L     @14,@SA00013                                        2082
         LM    @00,@12,@SA00013+8                                  2082
         BR    @14                                                 2082
*                END;                                      /*@Y30SSFR*/
*                                                                  2083
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT A FIELD PARAMETER LIST POINTING TO FIELD      */
*        /*  INFORMATION WITHIN THE WORK AREA REFERENCED BY THE      */
*        /*  DICTIONARY                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  2084
*          ELSE                                                    2084
*            DO;                                                   2084
@RF02043 DS    0H                                                  2085
*            DICTPTR = BDICTPTR;                                   2085
         L     @15,@PC00013+12                                     2085
         L     @15,BDICTPTR(,@15)                                  2085
         ST    @15,DICTPTR                                         2085
*            IF DICTLN(BINDX) = 0                                  2086
*              THEN                                                2086
         SLR   @14,@14                                             2086
         L     @05,@PC00013+4                                      2086
         LH    @05,BINDX(,@05)                                     2086
         SLA   @05,3                                               2086
         AL    @15,@CF01689                                        2086
         C     @14,DICTLN-4(@05,@15)                               2086
         BNE   @RF02086                                            2086
*                DO;                                               2087
*                                                                  2087
*                /****************************************************/
*                /*                                                  */
*                /*  IF THE DICTIONARY ENTRY INDICATES NOT CATALOG   */
*                /*  INFORMATION FOR THIS FIELD, SET FVT POINTER     */
*                /*  TO FIELD TO ZERO AND RETURN INDICATING          */
*                /*  SUCCESSFUL COMPLETION.                          */
*                /*                                                  */
*                /****************************************************/
*                                                                  2088
*                BFPLRTN = NULLPTR;                                2088
         L     @15,@PC00013+20                                     2088
         ST    @14,BFPLRTN(,@15)                                   2088
*                RETURN CODE(0);                                   2089
         LR    @15,@14                                             2089
         L     @14,@SA00013                                        2089
         LM    @00,@12,@SA00013+8                                  2089
         BR    @14                                                 2089
*                END;                                              2090
*                                                                  2090
*            /********************************************************/
*            /*                                                      */
*            /*  CORE FOR FPL HAS ALREADY BEEN OBTAINED.  FILL IN    */
*            /*  CATALOG FIELD INFORMATION FROM WORK AREA            */
*            /*                                                      */
*            /********************************************************/
*                                                                  2091
*            CTGFLPTR = BFPLADDR;      /*SET FPL BASE                */
@RF02086 L     @15,@PC00013+8                                      2091
         L     @14,BFPLADDR(,@15)                                  2091
         LR    CTGFLPTR,@14                                        2091
*            BFPLRTN = BFPLADDR;                                   2092
         L     @05,@PC00013+20                                     2092
         ST    @14,BFPLRTN(,@05)                                   2092
*            CTGFLDNO = '00000001'B;   /*SET NUMBER LNG/ADDR PAIRS   */
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2093
*            CTGFLDNM = ADDR(BFLIST(BINDX));               /*@Y30SSFR*/
         L     @05,@PC00013+4                                      2094
         LH    @05,BINDX(,@05)                                     2094
         LR    @03,@05                                             2094
         SLA   @03,3                                               2094
         L     @02,@PC00013                                        2094
         L     @01,BFLISTPT(,@02)                                  2094
         AL    @01,@CF01731                                        2094
         LA    @03,BFLIST(@03,@01)                                 2094
         ST    @03,CTGFLDNM(,CTGFLPTR)                             2094
*                                      /*SET CATALOG FIELD NAME      */
*                                                                  2095
*            /********************************************************/
*            /*                                                      */
*            /*  IF CONSTRUCTING AMDSBCAT FPL, THE CATALOG FIELD     */
*            /*  INFORMATION AREA IS JUST BEYOND THE FPL AREA.       */
*            /*                                                      */
*            /********************************************************/
*                                                                  2095
*            IF BINDX = IAMDSB                                     2095
*              THEN                                                2095
         C     @05,@CF00625                                        2095
         BNE   @RF02095                                            2095
*                DO;                                               2096
*                CTGFLNG(1) = LENGTH(IDAAMDSB);                    2097
         LA    @05,96                                              2097
         ST    @05,CTGFLNG(,CTGFLPTR)                              2097
*                                      /*CATALOG DATA LENGTH         */
*                BFPLADDR = BFPLADDR + LENGTH(CTGFL) + 8;          2098
         AL    @14,@CF00312                                        2098
         ST    @14,BFPLADDR(,@15)                                  2098
*                CTGFLPT(1) = BFPLADDR;/*CATALOG DATA ADDRESS        */
         ST    @14,CTGFLPT(,CTGFLPTR)                              2099
*                BFPLADDR = BFPLADDR + LENGTH(IDAAMDSB);           2100
         ALR   @14,@05                                             2100
         ST    @14,BFPLADDR(,@15)                                  2100
*                END;                                              2101
*              ELSE                                                2102
*                /****************************************************/
*                /*                                                  */
*                /*  FOR A FPL OTHER THAN AMDSBCAT, THE CATALOG FIELD*/
*                /*  INFORMATION IS IN THE WORK AREA READ IN FROM THE*/
*                /*  PORTABLE DATA SET.                              */
*                /*                                                  */
*                /****************************************************/
*                                                                  2102
*                DO;                                               2102
         B     @RC02095                                            2102
@RF02095 DS    0H                                                  2103
*                CTGFLNG(1) = DICTLN(BINDX);                       2103
         L     @05,DICTPTR                                         2103
         L     @15,@PC00013+4                                      2103
         LH    @15,BINDX(,@15)                                     2103
         SLA   @15,3                                               2103
         LA    @01,0(@15,@05)                                      2103
         AL    @01,@CF01689                                        2103
         L     @14,DICTLN-4(,@01)                                  2103
         ST    @14,CTGFLNG(,CTGFLPTR)                              2103
*                                      /*CATALOG DATA LENGTH         */
*                CTGFLPT(1) = BWKAPTR + DICTDL(BINDX);             2104
         L     @14,@PC00013+16                                     2104
         L     @14,BWKAPTR(,@14)                                   2104
         AL    @14,DICTDL-8(@15,@05)                               2104
         ST    @14,CTGFLPT(,CTGFLPTR)                              2104
*                                      /*CATALOG DATA ADDRESS        */
*                                                                  2105
*                /****************************************************/
*                /*                                                  */
*                /*  INCREMENT FPL ADDRESS TO NEXT FPL POSITION      */
*                /*                                                  */
*                /****************************************************/
*                                                                  2105
*                BFPLADDR = BFPLADDR + LENGTH(CTGFL) +8;           2105
         L     @15,@PC00013+8                                      2105
         LA    @14,24                                              2105
         AL    @14,BFPLADDR(,@15)                                  2105
         ST    @14,BFPLADDR(,@15)                                  2105
*                END;                                              2106
*            END;                                                  2107
*                                                                  2107
@RC02095 DS    0H                                                  2108
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2108
*        RETURN CODE(0);                                           2108
*                                                                  2108
         SLR   @15,@15                                             2108
         L     @14,@SA00013                                        2108
         LM    @00,@12,@SA00013+8                                  2108
         BR    @14                                                 2108
*END BFPLPROC;                                                     2109
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - RECPROC                                */
*        /*                                                          */
*        /*  FUNCTION - COPY THE DATA FROM THE PORTABILITY DATA SET  */
*        /*  TO THE VSAM CLUSTER BEING IMPORTED.                     */
*        /*  THE VSAM CLUSTER IS OPENED BY OPENPROC,                 */
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */
*        /*  UCLOSE MACRO.                                           */
*        /*                                                          */
*        /*  INPUT - NONE                                            */
*        /*                                                          */
*        /*  OUTPUT - THE VSAM CLUSTER WILL CONTAIN ALL DATA THAT IT */
*        /*  CONTAINED PRIOR TO EXPORT.                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  2110
*RECPROC:  PROCEDURE;                                              2110
*                                                                  2110
RECPROC  STM   @14,@12,@SA00014                                    2110
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  LOCAL DECLARATIONS FOR RECPROC                  @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2111
*        DCL DSNAME CHAR(44) BASED(IOCDSN);                /*@Y30SSFR*/
*                                      /*DATA SET OPENED BY  @Y30SSFR*/
*                                      /*UOPEN               @Y30SSFR*/
*        DCL RLCPLPTR PTR(31);         /*POINTER TO CPL USED @Y30SSFR*/
*                                      /*TO DO LOCATES       @Y30SSFR*/
*        DCL IRENTYPE FIXED(15) CONSTANT(1);               /*@Y30SSFR*/
*                                      /*INDEX FOR ENTRY     @Y30SSFR*/
*                                      /*TYPE                @Y30SSFR*/
*        DCL IRNAMEDS FIXED(15) CONSTANT(2);               /*@Y30SSFR*/
*                                      /*INDEX FOR           @Y30SSFR*/
*                                      /*ASSOCIATED OBJECTS  @Y30SSFR*/
*        DCL IRENTNAM FIXED(15) CONSTANT(1);               /*@Y30SSFR*/
*                                      /*INDEX FOR ENTRY     @Y30SSFR*/
*                                      /*NAME                @Y30SSFR*/
*        DCL RSAVCPL  CHAR(LENGTH(CTGPL));                 /*@Y30SSFR*/
*                                      /*SAVE AREA FOR CPL   @Y30SSFR*/
*        DCL RLFNAME  FIXED(24);       /*AREA TO HOLD CI     @Y30SSFR*/
*                                      /*NUMBER              @Y30SSFR*/
*                                                                  2118
*        /************************************************************/
*        /*                                                          */
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */
*        /*  IF THE OPEN FAILS, RETURN TO THE CALLING PROCESSOR WITH */
*        /*  FAILURE INDICATED                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  2118
*        IF ADDR(OUTDD) ^= NULLPTR                                 2118
*          THEN                                                    2118
         L     @15,@PC00001+4                                      2118
         L     @15,FDTPTR+4(,@15)                                  2118
         LTR   @15,@15                                             2118
         BZ    @RF02118                                            2118
*            CALL OPENPROC('O',ADDR(OUTDDVAL),NULLPARM,0,0,        2119
*              ADDR(POUTIOCS));                            /*@YL026UA*/
         MVC   @AL00001(20),@AL02119                               2119
         LA    @02,OUTDDVAL(,@15)                                  2119
         ST    @02,@AFTEMPS+20                                     2119
         LA    @02,@AFTEMPS+20                                     2119
         ST    @02,@AL00001+4                                      2119
         LA    @02,POUTIOCS                                        2119
         ST    @02,@AFTEMPS+24                                     2119
         LA    @02,@AFTEMPS+24                                     2119
         ST    @02,@AL00001+20                                     2119
         LA    @01,@AL00001                                        2119
         BAL   @14,OPENPROC                                        2119
*          ELSE                                                    2120
*            CALL OPENPROC('O',ADDR(ALLDDN),NULLPARM,0,0,          2120
*              ADDR(POUTIOCS));                            /*@YL026UA*/
         B     @RC02118                                            2120
@RF02118 MVC   @AL00001(20),@AL02120                               2120
         L     @02,ALLPTR                                          2120
         LA    @02,ALLDDN(,@02)                                    2120
         ST    @02,@AFTEMPS+20                                     2120
         LA    @02,@AFTEMPS+20                                     2120
         ST    @02,@AL00001+4                                      2120
         LA    @02,POUTIOCS                                        2120
         ST    @02,@AFTEMPS+24                                     2120
         LA    @02,@AFTEMPS+24                                     2120
         ST    @02,@AL00001+20                                     2120
         LA    @01,@AL00001                                        2120
         BAL   @14,OPENPROC                                        2120
*        RESPECIFY RTNREG RSTD;                                    2121
@RC02118 DS    0H                                                  2122
*        TESTRC = RTNREG;                                          2122
         LR    TESTRC,RTNREG                                       2122
*        RESPECIFY RTNREG UNRSTD;                                  2123
*        IF TESTRC ^= 0                                            2124
*          THEN                                                    2124
         LTR   TESTRC,TESTRC                                       2124
         BZ    @RF02124                                            2124
*            RETURN CODE(LASTCC12);                                2125
*                                                                  2125
         LA    @15,12                                              2125
         L     @14,@SA00014                                        2125
         LM    @00,@12,@SA00014+8                                  2125
         BR    @14                                                 2125
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO BE SURE THAT THE PROPER DATA SET NAME WAS      */
*        /*  SPECIFIED ON THE DD CARD.                               */
*        /*  COMPARE THE NAME RETURNED BY OPEN WITH THAT OF  @Y30SSFR*/
*        /*  THE OBJECT DEFINED.  IF THEY ARE NOT EQUAL,     @Y30SSFR*/
*        /*  DETERMINE IF THE OBJECT OPENED IS A PATH OVER   @Y30SSFR*/
*        /*  THE OBJECT BEING IMPORTED.                      @Y30SSFR*/
*        /*                                                          */
*        /************************************************************/
*                                                                  2126
*        IOCSPTR = POUTIOCS;                                       2126
*                                                                  2126
@RF02124 L     @02,POUTIOCS                                        2126
         ST    @02,IOCSPTR                                         2126
*        IF DSNAME ^= FVTPTR(1)->CTGFVENT->FENTNAME        /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
         L     @02,IOCDSN(,@02)                                    2127
         L     @01,FVTPTR                                          2127
         L     @01,CTGFVENT(,@01)                                  2127
         CLC   DSNAME(44,@02),FENTNAME(@01)                        2127
         BE    @RF02127                                            2127
*PTHTEST:    DO;                                           /*@Y30SSFR*/
*                                                                  2128
PTHTEST  DS    0H                                                  2129
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  BUILD A CPL AND FPL'S FOR ENTYPE AND        @Y30SSFR*/
*            /*  NAMEDS.  THEN PERFORM A LOCATE.             @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2129
*            CALL CPLPROC('L',RLCPLPTR,ADDR(DSNAME),       /*@Y30SSFR*/
*               NULLPARM,OPNPWA);                          /*@Y30SSFR*/
*                                                                  2129
         LA    @02,@CC01360                                        2129
         ST    @02,@AL00001                                        2129
         LA    @02,RLCPLPTR                                        2129
         ST    @02,@AL00001+4                                      2129
         L     @02,IOCSPTR                                         2129
         LA    @02,IOCDSN(,@02)                                    2129
         ST    @02,@AL00001+8                                      2129
         LA    @02,NULLPARM                                        2129
         ST    @02,@AL00001+12                                     2129
         LA    @02,OPNPWA(,OPNPTR)                                 2129
         ST    @02,@AL00001+16                                     2129
         LA    @01,@AL00001                                        2129
         BAL   @14,CPLPROC                                         2129
*            RESPECIFY RTNREG RSTD;                                2130
*            TESTRC = RTNREG;                                      2131
         LR    TESTRC,RTNREG                                       2131
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  2132
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2133
         BZ    @RF02133                                            2133
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  2134
         LA    @15,12                                              2134
         L     @14,@SA00014                                        2134
         LM    @00,@12,@SA00014+8                                  2134
         BR    @14                                                 2134
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  SET CTGBYPSS TO ON TO REQUEST THAT DOS      @Y30SSFR*/
*            /*  BYPASS SECURITY VERIFICATION.               @Y30SSFR*/
*            /*  SAVE THE CPL AND BUILD A ENTYPE FPL.        @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2135
*            CTGBYPSS = ON;                                /*@Y30SSFR*/
*                                                                  2135
@RF02133 L     @01,CTGPLPTR                                        2135
         OI    CTGBYPSS(@01),B'10000000'                           2135
*            CTGPLPTR = RLCPLPTR;                          /*@Y30SSFR*/
         L     @15,RLCPLPTR                                        2136
         ST    @15,CTGPLPTR                                        2136
*            RSAVCPL = CTGPL;                              /*@Y30SSFR*/
*                                                                  2137
         MVC   RSAVCPL(28),CTGPL(@15)                              2137
*            CTGNOFLD = 2;                                 /*@Y30SSFR*/
*                                                                  2138
         MVI   CTGNOFLD(@15),X'02'                                 2138
*            CALL BFPLPROC(ADDR(FIELDLST),IENTYPE,         /*@Y30SSFR*/
*              CTGFIELD(IRENTYPE),NULLPARM,NULLPARM,       /*@Y30SSFR*/
*              NULLPARM);                                  /*@Y30SSFR*/
*                                                                  2139
         MVC   @AL00001+4(20),@AL02139                             2139
         LA    @14,FIELDLST                                        2139
         ST    @14,@AFTEMPS+20                                     2139
         LA    @14,@AFTEMPS+20                                     2139
         ST    @14,@AL00001                                        2139
         LA    @15,CTGFIELD(,@15)                                  2139
         ST    @15,@AL00001+8                                      2139
         LA    @01,@AL00001                                        2139
         BAL   @14,BFPLPROC                                        2139
*            RESPECIFY RTNREG RSTD;                                2140
*            TESTRC = RTNREG;                                      2141
         LR    TESTRC,RTNREG                                       2141
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  2142
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2143
         BZ    @RF02143                                            2143
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  2144
         LA    @15,12                                              2144
         L     @14,@SA00014                                        2144
         LM    @00,@12,@SA00014+8                                  2144
         BR    @14                                                 2144
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  BUILD A NAMEDS FPL.                         @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2145
*            CALL BFPLPROC(ADDR(FIELDLST),INAMEDS,         /*@Y30SSFR*/
*              CTGFIELD(IRNAMEDS),NULLPARM,NULLPARM,       /*@Y30SSFR*/
*              NULLPARM);                                  /*@Y30SSFR*/
*                                                                  2145
@RF02143 MVC   @AL00001+4(20),@AL02145                             2145
         LA    @15,FIELDLST                                        2145
         ST    @15,@AFTEMPS+20                                     2145
         LA    @15,@AFTEMPS+20                                     2145
         ST    @15,@AL00001                                        2145
         L     @01,CTGPLPTR                                        2145
         LA    @15,CTGFIELD+4(,@01)                                2145
         ST    @15,@AL00001+8                                      2145
         LA    @01,@AL00001                                        2145
         BAL   @14,BFPLPROC                                        2145
*            RESPECIFY RTNREG RSTD;                                2146
*            TESTRC = RTNREG;                                      2147
         LR    TESTRC,RTNREG                                       2147
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  2148
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2149
         BZ    @RF02149                                            2149
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  2150
         LA    @15,12                                              2150
         L     @14,@SA00014                                        2150
         LM    @00,@12,@SA00014+8                                  2150
         BR    @14                                                 2150
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  INVOKE CATALOG MANAGEMENT TO DO A LOCATE    @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2151
*            CALL CTLGPROC(RLCPLPTR);                      /*@Y30SSFR*/
*                                                                  2151
@RF02149 LA    @15,RLCPLPTR                                        2151
         ST    @15,@AL00001                                        2151
         LA    @01,@AL00001                                        2151
         BAL   @14,CTLGPROC                                        2151
*            RESPECIFY RTNREG RSTD;                                2152
*            TESTRC = RTNREG;                                      2153
         LR    TESTRC,RTNREG                                       2153
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*                                                                  2154
*            IF TESTRC ^= 0                                /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2155
         BZ    @RF02155                                            2155
*                DO;                                       /*@Y30SSFR*/
*                IF EMPTYDS = OFF                          /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         TM    EMPTYDS,B'10000000'                                 2157
         BNZ   @RF02157                                            2157
*                    IMPF2DEL = ON;                        /*@Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                2158
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/
@RF02157 LA    @15,12                                              2159
         L     @14,@SA00014                                        2159
         LM    @00,@12,@SA00014+8                                  2159
         BR    @14                                                 2159
*                END;                                      /*@Y30SSFR*/
*                                                                  2160
*            /********************************************************/
*            /*                                              #Y30SSFR*/
*            /*  TEST TO DETERMINE IF THE ENTRY LOCATED ON   #Y30SSFR*/
*            /*  IS A PATH.                                  #Y30SSFR*/
*            /*                                              #Y30SSFR*/
*            /********************************************************/
*                                                                  2161
*            CTGFLPTR = CTGFIELD(IRENTYPE);                /*#Y30SSFR*/
@RF02155 L     @15,CTGPLPTR                                        2161
         L     CTGFLPTR,CTGFIELD(,@15)                             2161
*            IF FENTYPE = CTGTPTH                          /*#Y30SSFR*/
*              THEN                                        /*#Y30SSFR*/
         L     @05,CTGFLPT(,CTGFLPTR)                              2162
         CLI   FENTYPE(@05),C'R'                                   2162
         BNE   @RF02162                                            2162
*                DO;                                       /*#Y30SSFR*/
*                                                                  2163
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  BUILD AN FPL FOR ENTNAME AND DO A       #Y30SSFR*/
*                /*  LOCATE.                                 #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  2164
*                FNMPTR = CTGFIELD(IRNAMEDS) -> CTGFLPT(1);/*#Y30SSFR*/
         L     @01,CTGFIELD+4(,@15)                                2164
         L     @14,CTGFLPT(,@01)                                   2164
         ST    @14,FNMPTR                                          2164
*                RLFNAME = FNAME;                          /*#Y30SSFR*/
         MVC   RLFNAME(3),FNAME(@14)                               2165
*                CTGPL = RSAVCPL;                          /*#Y30SSFR*/
         MVC   CTGPL(28,@15),RSAVCPL                               2166
*                CTGNAME = OFF;                            /*#Y30SSFR*/
         NI    CTGNAME(@15),B'11111011'                            2167
*                CTGENT = ADDR(RLFNAME);                   /*#Y30SSFR*/
         LA    @14,RLFNAME                                         2168
         ST    @14,CTGENT(,@15)                                    2168
*                CTGNOFLD = 1;                             /*#Y30SSFR*/
*                                                                  2169
         MVI   CTGNOFLD(@15),X'01'                                 2169
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  ZERO OUT THE WORK AREA POINTED TO BY    #Y30SSFR*/
*                /*  THE CPL.  BEGIN BY SETTING ZSIZE,       #Y30SSFR*/
*                /*  ZPTR, AND ZCNTRL TO THEIR INITIAL       #Y30SSFR*/
*                /*  VALUES.                                 #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  2170
*                ZSIZE = AREALN;                           /*#Y30SSFR*/
         L     @15,CTGWKA(,@15)                                    2170
         LH    ZSIZE,AREALN(,@15)                                  2170
*                ZPTR = CTGWKA + 2;                        /*#Y30SSFR*/
         AL    @15,@CF00156                                        2171
         LR    ZPTR,@15                                            2171
*                ZCNTRL = ON;                              /*#Y30SSFR*/
*                                                                  2172
         OI    ZCNTRL,B'10000000'                                  2172
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  LOOP CLEARING OUT THE WORK AREA FOR     #Y30SSFR*/
*                /*  THE LOCATE FOR THE ENTRY NAME.          #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  2173
*                DO WHILE (ZCNTRL = ON);                   /*#Y30SSFR*/
         B     @DE02173                                            2173
@DL02173 DS    0H                                                  2174
*                  IF ZSIZE > 256                          /*#Y30SSFR*/
*                    THEN                                  /*#Y30SSFR*/
         LA    @15,256                                             2174
         CR    ZSIZE,@15                                           2174
         BNH   @RF02174                                            2174
*                      DO;                                 /*#Y30SSFR*/
*                      ZAREA(1:256) = ZER(1:256);          /*#Y30SSFR*/
         MVC   ZAREA(256,ZPTR),ZER                                 2176
*                      ZSIZE = ZSIZE - 256;                /*#Y30SSFR*/
         SLR   ZSIZE,@15                                           2177
*                      ZPTR = ZPTR + 256;                  /*#Y30SSFR*/
         ALR   ZPTR,@15                                            2178
*                      END;                                /*#Y30SSFR*/
*                    ELSE                                  /*#Y30SSFR*/
*                      DO;                                 /*#Y30SSFR*/
         B     @RC02174                                            2180
@RF02174 DS    0H                                                  2181
*                      ZAREA(1:ZSIZE) = ZER(1:ZSIZE);      /*#Y30SSFR*/
         LR    @15,ZSIZE                                           2181
         BCTR  @15,0                                               2181
         EX    @15,@SM01687                                        2181
*                      ZCNTRL = OFF;                       /*#Y30SSFR*/
         NI    ZCNTRL,B'01111111'                                  2182
*                      END;                                /*#Y30SSFR*/
*                END;                                      /*#Y30SSFR*/
*                                                                  2184
@RC02174 DS    0H                                                  2184
@DE02173 TM    ZCNTRL,B'10000000'                                  2184
         BO    @DL02173                                            2184
*                CALL BFPLPROC(ADDR(FIELDLST),IENTNAME,    /*#Y30SSFR*/
*                  CTGFIELD(IRENTNAM),NULLPARM,NULLPARM,   /*#Y30SSFR*/
*                  NULLPARM);                              /*#Y30SSFR*/
*                                                                  2185
         MVC   @AL00001+4(20),@AL02185                             2185
         LA    @15,FIELDLST                                        2185
         ST    @15,@AFTEMPS+20                                     2185
         LA    @15,@AFTEMPS+20                                     2185
         ST    @15,@AL00001                                        2185
         L     @01,CTGPLPTR                                        2185
         LA    @15,CTGFIELD(,@01)                                  2185
         ST    @15,@AL00001+8                                      2185
         LA    @01,@AL00001                                        2185
         BAL   @14,BFPLPROC                                        2185
*                RESPECIFY RTNREG RSTD;                            2186
*                TESTRC = RTNREG;                                  2187
         LR    TESTRC,RTNREG                                       2187
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/
*                                                                  2188
*                IF TESTRC ^= 0                            /*#Y30SSFR*/
*                  THEN                                    /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2189
         BZ    @RF02189                                            2189
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/
*                                                                  2190
         LA    @15,12                                              2190
         L     @14,@SA00014                                        2190
         LM    @00,@12,@SA00014+8                                  2190
         BR    @14                                                 2190
*                CALL CTLGPROC(RLCPLPTR);                  /*#Y30SSFR*/
*                                                                  2191
@RF02189 LA    @15,RLCPLPTR                                        2191
         ST    @15,@AL00001                                        2191
         LA    @01,@AL00001                                        2191
         BAL   @14,CTLGPROC                                        2191
*                RESPECIFY RTNREG RSTD;                            2192
*                TESTRC = RTNREG;                                  2193
         LR    TESTRC,RTNREG                                       2193
*                RESPECIFY RTNREG UNRSTD;                  /*#Y30SSFR*/
*                                                                  2194
*                IF TESTRC ^= 0                            /*#Y30SSFR*/
*                  THEN                                    /*#Y30SSFR*/
         LTR   TESTRC,TESTRC                                       2195
         BZ    @RF02195                                            2195
*                    DO;                                   /*@Y30SSFR*/
*                    IF EMPTYDS = OFF                      /*@Y30SSFR*/
*                      THEN                                /*@Y30SSFR*/
         TM    EMPTYDS,B'10000000'                                 2197
         BNZ   @RF02197                                            2197
*                        IMPF2DEL = ON;                    /*@Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                2198
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/
@RF02197 LA    @15,12                                              2199
         L     @14,@SA00014                                        2199
         LM    @00,@12,@SA00014+8                                  2199
         BR    @14                                                 2199
*                    END;                                  /*@Y30SSFR*/
*                                                                  2200
*                CTGFLPTR = CTGFIELD(IRENTNAM);            /*#Y30SSFR*/
*                                                                  2201
@RF02195 L     @01,CTGPLPTR                                        2201
         L     CTGFLPTR,CTGFIELD(,@01)                             2201
*                IF RLCPLPTR->CTGFIELD(IRENTNAM)->         /*#Y30SSFR*/
*                  CTGFLPT(1)->FENTNAME ^= FVTPTR(1)->     /*#Y30SSFR*/
*                  CTGFVENT->FENTNAME                      /*#Y30SSFR*/
*                  THEN                                    /*#Y30SSFR*/
         L     @01,RLCPLPTR                                        2202
         L     @01,CTGFIELD(,@01)                                  2202
         L     @01,CTGFLPT(,@01)                                   2202
         L     @15,FVTPTR                                          2202
         L     @15,CTGFVENT(,@15)                                  2202
         CLC   FENTNAME(44,@01),FENTNAME(@15)                      2202
         BE    @RF02202                                            2202
*                    DO;                                   /*#Y30SSFR*/
*                                                                  2203
*                    /************************************************/
*                    /*                                      #Y30SSFR*/
*                    /*  THE NAME OF THE BASE OBJECT OPENED  #Y30SSFR*/
*                    /*  DOES NOT EQUAL THE NAME OF THE      #Y30SSFR*/
*                    /*  OBJECT DEFINED BY IMPORT.  PRINT    #Y30SSFR*/
*                    /*  AN ERROR MESSAGE AND INDICATE       #Y30SSFR*/
*                    /*  THAT THE OBJECT DEFINED IS TO BE    #Y30SSFR*/
*                    /*  DELETED UNLESS IT WAS A PREDEFINED  #Y30SSFR*/
*                    /*  EMPTY DATA SET.                     #Y30SSFR*/
*                    /*                                      #Y30SSFR*/
*                    /************************************************/
*                                                                  2204
*                    DARGSMOD = UNIVMSG;                   /*#Y30SSFR*/
         L     @14,DDSTRU                                          2204
         MVC   DARGSMOD(3,@14),@CC01023                            2204
*                    DEFSTID = NOOPENMG;                   /*#Y30SSFR*/
         MVI   DEFSTID,X'0B'                                       2205
*                    DARGILP = LENGTH(FENTNAME);           /*#Y30SSFR*/
         MVC   DARGILP(2,@14),@CH00605                             2206
*                    DARGDBP = ADDR(FVTPTR(1)->CTGFVENT->  /*#Y30SSFR*/
*                       FENTNAME);                         /*#Y30SSFR*/
         ST    @15,DARGDBP(,@14)                                   2207
*                    IF EMPTYDS = OFF                      /*#Y30SSFR*/
*                      THEN                                /*#Y30SSFR*/
         TM    EMPTYDS,B'10000000'                                 2208
         BNZ   @RF02208                                            2208
*                        IMPF2DEL = ON;                    /*#Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                2209
*                    RETURN CODE(LASTCC12);                /*#Y30SSFR*/
@RF02208 LA    @15,12                                              2210
         L     @14,@SA00014                                        2210
         LM    @00,@12,@SA00014+8                                  2210
         BR    @14                                                 2210
*                    END;                                  /*#Y30SSFR*/
*                                                                  2211
*                  ELSE ;                                  /*#Y30SSFR*/
@RF02202 DS    0H                                                  2213
*                END;                                      /*#Y30SSFR*/
*                                                                  2213
*              ELSE                                        /*#Y30SSFR*/
*                                                                  2214
*                /****************************************************/
*                /*                                          #Y30SSFR*/
*                /*  THE OBJECT WAS NOT A PATH.              #Y30SSFR*/
*                /*  PREPARE TO PRINT AN ERROR MESSAGE AND   #Y30SSFR*/
*                /*  SET A FLAG INDICATING THAT THE OBJECT   #Y30SSFR*/
*                /*  DEFINED BY IMPORT IS TO BE DELETED      #Y30SSFR*/
*                /*  UNLESS IT IS A PRE-DEFINED DATA         #Y30SSFR*/
*                /*  SET.                                    #Y30SSFR*/
*                /*                                          #Y30SSFR*/
*                /****************************************************/
*                                                                  2214
*                DO;                                       /*#Y30SSFR*/
         B     @RC02162                                            2214
@RF02162 DS    0H                                                  2215
*                DEFSTID = NOOPENMG;                       /*#Y30SSFR*/
         MVI   DEFSTID,X'0B'                                       2215
*                DARGSMOD = UNIVMSG;                       /*#Y30SSFR*/
         L     @15,DDSTRU                                          2216
         MVC   DARGSMOD(3,@15),@CC01023                            2216
*                DARGILP = LENGTH(FENTNAME);               /*#Y30SSFR*/
         MVC   DARGILP(2,@15),@CH00605                             2217
*                DARGDBP = ADDR(FVTPTR(1)->CTGFVENT->      /*#Y30SSFR*/
*                   FENTNAME);                             /*#Y30SSFR*/
         L     @01,FVTPTR                                          2218
         L     @14,CTGFVENT(,@01)                                  2218
         ST    @14,DARGDBP(,@15)                                   2218
*                IF EMPTYDS = OFF                          /*#Y30SSFR*/
*                  THEN                                    /*#Y30SSFR*/
         TM    EMPTYDS,B'10000000'                                 2219
         BNZ   @RF02219                                            2219
*                    IMPF2DEL = ON;                        /*#Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                2220
*                RETURN CODE(LASTCC12);                    /*#Y30SSFR*/
@RF02219 LA    @15,12                                              2221
         L     @14,@SA00014                                        2221
         LM    @00,@12,@SA00014+8                                  2221
         BR    @14                                                 2221
*                END;                                      /*#Y30SSFR*/
*                                                                  2222
*            END PTHTEST;                                  /*#Y30SSFR*/
*                                                                  2223
*          ELSE ;                                          /*#Y30SSFR*/
*                                                                  2224
@RF02127 DS    0H                                                  2225
*        /************************************************************/
*        /*                                                          */
*        /*  COPY DATA BY RECORD FROM THE PORTABILITY DATA SET TO    */
*        /*  THE CLUSTER. IF ANY ERRORS ARE ENCOUNTERED, RETURN TO   */
*        /*  CALLING PROCESSOR WITH ERROR INDICATED                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  2225
*        CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);                  2225
*                                                                  2225
@RC02127 L     @03,@PC00001                                        2225
         ST    @03,@AL00001                                        2225
         LA    @15,PINIOCS                                         2225
         ST    @15,@AL00001+4                                      2225
         LA    @15,POUTIOCS                                        2225
         ST    @15,@AL00001+8                                      2225
         MVI   @AL00001+8,X'80'                                    2225
         L     @15,GDTCPY(,@03)                                    2225
         LA    @01,@AL00001                                        2225
         BALR  @14,@15                                             2225
*        RESPECIFY RTNREG RSTD;                                    2226
*        TESTRC = RTNREG;                                          2227
         LR    TESTRC,RTNREG                                       2227
*        RESPECIFY RTNREG UNRSTD;                                  2228
*        IF TESTRC ^= 0                                            2229
*          THEN                                                    2229
         LTR   TESTRC,TESTRC                                       2229
         BZ    @RF02229                                            2229
*            DO;                                           /*#Y30SSFR*/
*            IMPF2DEL = ON;                                /*#Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                2231
*            RETURN CODE(LASTCC12);                                2232
         LA    @15,12                                              2232
         L     @14,@SA00014                                        2232
         LM    @00,@12,@SA00014+8                                  2232
         BR    @14                                                 2232
*            END;                                          /*#Y30SSFR*/
*                                                                  2233
*        /************************************************************/
*        /*                                                          */
*        /*  CLOSE THE OUTPUT DATA SET (THE VSAM CLUSTER).  IF THE   */
*        /*  CLOSE FAILS, RETURN TO THE CALLING PROCESSOR WITH ERROR */
*        /*  INDICATED.                                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  2234
*        CALL IDCIOCL0 (GDTTBL,POUTIOCS);                          2234
*                                                                  2234
@RF02229 L     @03,@PC00001                                        2234
         ST    @03,@AL00001                                        2234
         LA    @15,POUTIOCS                                        2234
         ST    @15,@AL00001+4                                      2234
         MVI   @AL00001+4,X'80'                                    2234
         L     @15,GDTCLS(,@03)                                    2234
         LA    @01,@AL00001                                        2234
         BALR  @14,@15                                             2234
*        RESPECIFY RTNREG RSTD;                                    2235
*        TESTRC = RTNREG;                                          2236
         LR    TESTRC,RTNREG                                       2236
*        RESPECIFY RTNREG UNRSTD;                                  2237
*        POUTIOCS = NULLPTR;                                       2238
         SLR   @03,@03                                             2238
         ST    @03,POUTIOCS                                        2238
*        IF TESTRC ^= 0                                            2239
*          THEN                                                    2239
         CR    TESTRC,@03                                          2239
         BE    @RF02239                                            2239
*            DO;                                           /*#Y30SSFR*/
*            IMPF2DEL = ON;                                /*#Y30SSFR*/
         OI    IMPF2DEL,B'01000000'                                2241
*            RETURN CODE(LASTCC12);                                2242
         LA    @15,12                                              2242
         L     @14,@SA00014                                        2242
         LM    @00,@12,@SA00014+8                                  2242
         BR    @14                                                 2242
*            END;                                          /*#Y30SSFR*/
*                                                                  2243
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */
*        /*  COMPLETION INDICATED                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  2244
*        RETURN CODE(LASTCC00);                                    2244
@RF02239 SLR   @15,@15                                             2244
         L     @14,@SA00014                                        2244
         LM    @00,@12,@SA00014+8                                  2244
         BR    @14                                                 2244
*END RECPROC;                                                      2245
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - MVDAPROC                               */
*        /*                                                          */
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE TO      */
*        /*  ANOTHER AS SPECIFIED BY INPUT ARGUMENTS.                */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED           @Y30SSFR*/
*        /*    .MF1PTR- FROM LOCATION                        @Y30SSFR*/
*        /*    .MT1PTR- TO LOCATION                          @Y30SSFR*/
*        /*                                                          */
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */
*        /*  THE "TO" AGRUMENT (MPTR).                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  2246
*MVDAPROC: PROCEDURE(MSIZE,                                        2246
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */
*                    MT1PTR);          /*LOCATION TO MOVE DATA INTO  */
*                                                                  2246
MVDAPROC STM   @14,@12,12(@13)                                     2246
         MVC   @PC00015(12),0(@01)                                 2246
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2247
*        DCL MSIZE    FIXED(15),                                   2247
*            MF1PTR   PTR(31),                                     2247
*            MT1PTR   PTR(31);                                     2247
*                                                                  2247
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  2248
*        DCL MFPTR PTR(31);            /*WORKING SOURCE PTR  @Y30SSFR*/
*        DCL MTPTR PTR(31);            /*WORKING TARGET PTR  @Y30SSFR*/
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                        2250
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                        2251
*        DCL M1SIZE FIXED(15);                                     2252
*        DCL DOCNTRL  BIT(1);                                      2253
*                                                                  2253
*        /************************************************************/
*        /*                                                          */
*        /*  LOOP MOVING 256 BYTES AT A TIME                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  2254
*        MFPTR = MF1PTR;                                           2254
         L     @15,@PC00015+4                                      2254
         L     MFPTR,MF1PTR(,@15)                                  2254
*        MTPTR = MT1PTR;                                           2255
         L     @05,@PC00015+8                                      2255
         L     MTPTR,MT1PTR(,@05)                                  2255
*        M1SIZE = MSIZE;                                           2256
         L     @05,@PC00015                                        2256
         LH    M1SIZE,MSIZE(,@05)                                  2256
*        DOCNTRL = ON;                                             2257
         OI    DOCNTRL,B'10000000'                                 2257
*        DO WHILE (DOCNTRL = ON);                                  2258
*                                                                  2258
         B     @DE02258                                            2258
@DL02258 DS    0H                                                  2259
*          /**********************************************************/
*          /*                                                        */
*          /*  CHECK FOR MORE THAN 256 BYTES TO MOVE                 */
*          /*                                                        */
*          /**********************************************************/
*                                                                  2259
*          IF M1SIZE > 256                                         2259
*            THEN                                                  2259
         LA    @05,256                                             2259
         CR    M1SIZE,@05                                          2259
         BNH   @RF02259                                            2259
*              DO;                                                 2260
*              /******************************************************/
*              /*                                                    */
*              /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND      */
*              /*  POINTER VARIABLES FOR NEXT ITERATION              */
*              /*                                                    */
*              /******************************************************/
*                                                                  2261
*              TOAREA(1:256) = FROMAREA(1:256);                    2261
         MVC   TOAREA(256,MTPTR),FROMAREA(MFPTR)                   2261
*              M1SIZE = M1SIZE - 256;                              2262
         SLR   M1SIZE,@05                                          2262
*              MTPTR = MTPTR +256;                                 2263
         ALR   MTPTR,@05                                           2263
*              MFPTR = MFPTR + 256;                                2264
         ALR   MFPTR,@05                                           2264
*              END;                                                2265
*                                                                  2265
*            ELSE                                                  2266
*              DO;                                                 2266
         B     @RC02259                                            2266
@RF02259 DS    0H                                                  2267
*              /******************************************************/
*              /*                                                    */
*              /*  MOVE NUMBER OF BYTES INDICATED BY MSIZE AND RETURN*/
*              /*                                                    */
*              /******************************************************/
*                                                                  2267
*              TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);              2267
         LR    @05,M1SIZE                                          2267
         BCTR  @05,0                                               2267
         EX    @05,@SM01733                                        2267
*              DOCNTRL = OFF;                                      2268
         NI    DOCNTRL,B'01111111'                                 2268
*              END;                                                2269
*          END;                                                    2270
*                                                                  2270
@RC02259 DS    0H                                                  2270
@DE02258 TM    DOCNTRL,B'10000000'                                 2270
         BO    @DL02258                                            2270
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2271
*        RETURN CODE(0);                                           2271
         SLR   @15,@15                                             2271
         L     @14,12(,@13)                                        2271
         LM    @00,@12,20(@13)                                     2271
         BR    @14                                                 2271
*END MVDAPROC;                                             /*@Y30SSFR*/
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - MSGPROC                                */
*        /*                                                          */
*        /*  FUNCTION - USE TEXT PROCESSOR INTERFACE TO LIST         */
*        /*  INFORMATIONAL OR ERROR MESSAGE TO USER                  */
*        /*                                                          */
*        /*  INPUT - MESSAGE ID FOR STATIC TEXT MODULE, DARGSMOD     */
*        /*  ALREADY CONTAINS MODULE ID                              */
*        /*                                                          */
*        /*  OUTPUT - MESSAGE WILL BE LISTED FOR USER. ARGUMENT      */
*        /*  LIST FOR TEXT PROCESSOR WILL BE ZEROED, EXCEPT FOR      */
*        /*  STATIC TEXT MODULE ID, WHICH WILL BE SET TO IMPORT      */
*        /*  STATIC TEXT MODULE.                                     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2273
*MSGPROC: PROCEDURE(MNUM);             /*MESSAGE ID NUMBER IN STATIC */
MSGPROC  STM   @14,@12,@SA00016                                    2273
         MVC   @PC00016(4),0(@01)                                  2273
*                                      /*TEXT MODULE                 */
*                                                                  2274
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2274
*        DCL MNUM FIXED(8);                                        2274
*                                                                  2274
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE TEXT PROCESSOR UPRINT TO LIST MESSAGE             */
*        /*  IF PRINT FAILS, RETURN TO CALLING PROCESSOR INDICATING  */
*        /*  FAILURE.                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  2275
*        OLDERID2 = NEWERID2;                                      2275
         L     @15,@PC00001                                        2275
         L     @15,GDTTR2(,@15)                                    2275
         MVC   @TS00001(95),NEWERID2(@15)                          2275
         MVC   OLDERID2(95,@15),@TS00001                           2275
*        NEWID2 = 'MPMG';                                          2276
         MVC   NEWID2(4,@15),@CC01569                              2276
*        DARGSENT = MNUM;                                          2277
*                                                                  2277
         L     @15,DDSTRU                                          2277
         L     @14,@PC00016                                        2277
         IC    @05,MNUM(,@14)                                      2277
         STC   @05,DARGSENT(,@15)                                  2277
*        IF MNUM = CATLGMSG & DARGSMOD = UNIVMSG                   2278
*          THEN                                                    2278
         CLI   MNUM(@14),7                                         2278
         BNE   @RF02278                                            2278
         CLC   DARGSMOD(3,@15),@CC01023                            2278
         BNE   @RF02278                                            2278
*            DO;                                                   2279
*            DARGDBP = ADDR(CATLGRC);                              2280
         LA    @14,CATLGRC                                         2280
         ST    @14,DARGDBP(,@15)                                   2280
*            DARGILP = 2;                                          2281
         MVC   DARGILP(2,@15),@CH00156                             2281
*            END;                                                  2282
*                                                                  2282
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    2283
*                                                                  2283
*                                                                  2283
@RF02278 L     @15,@PC00001                                        2283
         ST    @15,@AL00001                                        2283
         LA    @14,@CF00118                                        2283
         ST    @14,@AL00001+4                                      2283
         LA    @14,DDSTRU                                          2283
         ST    @14,@AL00001+8                                      2283
         MVI   @AL00001+8,X'80'                                    2283
         L     @15,GDTPRT(,@15)                                    2283
         LA    @01,@AL00001                                        2283
         BALR  @14,@15                                             2283
*        /************************************************************/
*        /*                                                          */
*        /*  ZERO OUT ARGUMENT FOR TEXT PROCESSOR INTERFACE AND      */
*        /*  RESET MODULE ID                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  2284
*        DARGLIST = ''B;                                           2284
         L     @15,DDSTRU                                          2284
         XC    DARGLIST(20,@15),DARGLIST(@15)                      2284
*        DARGSMOD = 'MP0';                                         2285
         MVC   DARGSMOD(3,@15),@CC01000                            2285
*        RETURN CODE(0);                                           2286
         SLR   @15,@15                                             2286
         L     @14,@SA00016                                        2286
         LM    @00,@12,@SA00016+8                                  2286
         BR    @14                                                 2286
*END MSGPROC;                                                      2287
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - FVTPROC                                */
*        /*                                                          */
*        /*  FUNCTION - CONSTRUCT FVT AND FPL'S FROM INFORMATION     */
*        /*  IN THE DICTIONARY PASSED AS AN ARGUMENT TO THIS         */
*        /*  PROCEDURE.  FPL'S WILL POINT TO THE CATALOG FIELD       */
*        /*  INFORMATION WITHIN THE WORK AREA.                       */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .FDICT - POINTER TO DICTIONARY WHICH REFERENCES       */
*        /*      CATALOG FIELD INFORMATION WITH WORK AREA            */
*        /*    .FWKA - WORK AREA CONTAINING CATALOG FIELD INFORMATION*/
*        /*    .FPTRFVT - RETURN CELL FOR FVT POINTER                */
*        /*                                                          */
*        /*  OUTPUT - POINTER TO FVT CONSTRUCTED.  THIS FVT WILL     */
*        /*  REFERENCE ALL FPL'S CONSTRUCTED BY THIS PROCEDURE       */
*        /*                                                          */
*        /************************************************************/
*                                                                  2288
*FVTPROC: PROCEDURE(FDICT,             /*DICTIONARY POINTER          */
*                  FWKA,     /*WORK AREA POINTER                     */
*                  FPTRFVT); /*RETURN CELL FOR FVT POINTER           */
*                                                                  2288
FVTPROC  STM   @14,@12,@SA00017                                    2288
         MVC   @PC00017(12),0(@01)                                 2288
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2289
*        DCL FDICT    PTR(31),                                     2289
*            FWKA     PTR(31),                                     2289
*            FPTRFVT  PTR(31);                                     2289
*                                                                  2289
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  2290
*        DCL FPLADDR  PTR(31);                                     2290
*        DCL FPLNUM  FIXED(15) CONSTANT(12); /*NUMBER OF FPL'S BUILT */
*                                       /*BY THIS PROCEDURE          */
*        DCL FIELDPTR  PTR(31);   /*USED TO POINT TO ENTRY TYPE      */
*                                      /* OR SECFLAGS IN THE         */
*                                      /* DICTIONARY WORK AREA       */
*                                                                  2293
*        /************************************************************/
*        /*                                                          */
*        /*  GET CORE FOR THE FVT AND THE TOTAL NUMBER OF FPL'S      */
*        /*  THAT CAN BE CONSTRUCTED BY THIS PROCEDURE               */
*        /*                                                          */
*        /************************************************************/
*                                                                  2293
*        OLDERID2 = NEWERID2;                                      2293
         L     @03,@PC00001                                        2293
         L     @15,GDTTR2(,@03)                                    2293
         MVC   @TS00001(95),NEWERID2(@15)                          2293
         MVC   OLDERID2(95,@15),@TS00001                           2293
*        NEWID2 = 'MPFV';                                          2294
         MVC   NEWID2(4,@15),@CC01582                              2294
*        RESPECIFY CTGFV BASED(FPTRFVT);                           2295
*        TOTLEN =2*(LENGTH(CTGFV) + (LENGTH(CTGFL)+8) * FPLNUM     2296
*          + LENGTH(IDAAMDSB));                                    2296
*                                                                  2296
         MVC   TOTLEN(4),@CF01674                                  2296
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,FPTRFVT,GPID,SETZERO);       2297
*                                                                  2297
         ST    @03,@AL00001                                        2297
         LA    @15,TOTLEN                                          2297
         ST    @15,@AL00001+4                                      2297
         L     @15,@PC00017+8                                      2297
         ST    @15,@AL00001+8                                      2297
         LA    @15,GPID                                            2297
         ST    @15,@AL00001+12                                     2297
         LA    @15,SETZERO                                         2297
         ST    @15,@AL00001+16                                     2297
         MVI   @AL00001+16,X'80'                                   2297
         L     @15,GDTGPL(,@03)                                    2297
         LA    @01,@AL00001                                        2297
         BALR  @14,@15                                             2297
*        RESPECIFY RTNREG RSTD;                                    2298
*        TESTRC = RTNREG;                                          2299
         LR    TESTRC,RTNREG                                       2299
*        RESPECIFY RTNREG UNRSTD;                                  2300
*        IF TESTRC ^= 0                                            2301
*          THEN                                                    2301
*                                                                  2301
         LTR   TESTRC,TESTRC                                       2301
         BZ    @RF02301                                            2301
*            /********************************************************/
*            /*                                                      */
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */
*            /*  CALLING PROCESSOR WITH FAILURE INDICATED            */
*            /*                                                      */
*            /********************************************************/
*                                                                  2302
*            DO;                                                   2302
*            DEFSTID = NOSTORAG;                                   2303
         MVI   DEFSTID,X'04'                                       2303
*            RETURN CODE(LASTCC12);                                2304
         LA    @15,12                                              2304
         L     @14,@SA00017                                        2304
         LM    @00,@12,@SA00017+8                                  2304
         BR    @14                                                 2304
*            END;                                                  2305
*                                                                  2305
*        DICTPTR = FDICT;                                          2306
@RF02301 L     @03,@PC00017                                        2306
         L     @03,FDICT(,@03)                                     2306
         ST    @03,DICTPTR                                         2306
*        FPLADDR = FPTRFVT + LENGTH(CTGFV);                        2307
*                                                                  2307
         L     @15,@PC00017+8                                      2307
         L     @15,FPTRFVT(,@15)                                   2307
         LA    @14,92                                              2307
         ALR   @14,@15                                             2307
         ST    @14,FPLADDR                                         2307
*        /************************************************************/
*        /*                                                          */
*        /*  SET TYPE FIELD IN FVT FROM CATALOG FIELD INFORMATION    */
*        /*                                                          */
*        /************************************************************/
*                                                                  2308
*        FIELDPTR = DICTDL(IENTYPE) + FWKA;                        2308
         L     @14,@PC00017+4                                      2308
         L     @14,FWKA(,@14)                                      2308
         L     FIELDPTR,DICTDL(,@03)                               2308
         ALR   FIELDPTR,@14                                        2308
*        CTGFVTYP = FIELDPTR -> FENTYPE;                           2309
         MVC   CTGFVTYP(1,@15),FENTYPE(FIELDPTR)                   2309
*        /*                                                  @Z40RSSA*/
*        /*  SET CTGFVRON TO VALUE OF IMPORTED RAC INDICATOR @Z40RSSA*/
*        /*                                                  @Z40RSSA*/
*        IF DICTLN(ISECFLG) ^= NULLPTR THEN                        2310
         L     @02,DICTLN+248(,@03)                                2310
         LTR   @02,@02                                             2310
         BZ    @RF02310                                            2310
*          DO;                                             /*@Z40RSSA*/
*            FIELDPTR = DICTDL(ISECFLG) + FWKA;            /*@Z40RSSA*/
         AL    @14,DICTDL+248(,@03)                                2312
         LR    FIELDPTR,@14                                        2312
*            IF FIELDPTR -> RCDEXSEC= ON THEN                      2313
         TM    RCDEXSEC(FIELDPTR),B'10000000'                      2313
         BNO   @RF02313                                            2313
*              CTGFVRON=ON;                                /*@Z40RSSA*/
         OI    CTGFVRON(@15),B'00001000'                           2314
*          END;                                            /*@Z40RSSA*/
*                                                                  2315
*                                                                  2315
@RF02313 DS    0H                                                  2316
*        /************************************************************/
*        /*                                                          */
*        /*  SET ENTNAME FIELD POINTER IN FPL                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  2316
*        IF DICTLN(IENTNAME) ^= NULLPTR                            2316
*          THEN                                                    2316
@RF02310 L     @15,DICTPTR                                         2316
         L     @14,DICTLN+8(,@15)                                  2316
         LTR   @14,@14                                             2316
         BZ    @RF02316                                            2316
*            CTGFVENT = DICTDL(IENTNAME) + FWKA;                   2317
*                                                                  2317
         L     @14,@PC00017+8                                      2317
         L     @01,FPTRFVT(,@14)                                   2317
         L     @14,@PC00017+4                                      2317
         L     @15,DICTDL+8(,@15)                                  2317
         AL    @15,FWKA(,@14)                                      2317
         ST    @15,CTGFVENT(,@01)                                  2317
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  TEST TO DETERMINE IF WE ARE BUILDING AN FVT     @Y30SSFR*/
*        /*  FOR AN AIX OR A PATH                            @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2318
*        IF CTGFVTYP = CTGTAIX  CTGFVTYP = CTGTPTH        /*@Y30SSFR*/
*          THEN                                            /*@Y30SSFR*/
*                                                                  2318
@RF02316 L     @15,@PC00017+8                                      2318
         L     @15,FPTRFVT(,@15)                                   2318
         CLI   CTGFVTYP(@15),C'G'                                  2318
         BE    @RT02318                                            2318
         CLI   CTGFVTYP(@15),C'R'                                  2318
         BNE   @RF02318                                            2318
@RT02318 DS    0H                                                  2319
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  BUILD AN FPL FOR RGATTR                     @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2319
*            DO;                                           /*@Y30SSFR*/
*            CALL BFPLPROC(ADDR(FIELDLST),IRGATTR,FPLADDR, /*@Y30SSFR*/
*               FDICT,FWKA,CTGFVUPG);                      /*@Y30SSFR*/
*                                                                  2320
         LA    @15,FIELDLST                                        2320
         ST    @15,@AFTEMPS+28                                     2320
         LA    @15,@AFTEMPS+28                                     2320
         ST    @15,@AL00001                                        2320
         LA    @15,@CH01098                                        2320
         ST    @15,@AL00001+4                                      2320
         LA    @15,FPLADDR                                         2320
         ST    @15,@AL00001+8                                      2320
         L     @15,@PC00017                                        2320
         ST    @15,@AL00001+12                                     2320
         L     @15,@PC00017+4                                      2320
         ST    @15,@AL00001+16                                     2320
         L     @15,@PC00017+8                                      2320
         L     @01,FPTRFVT(,@15)                                   2320
         LA    @15,CTGFVUPG(,@01)                                  2320
         ST    @15,@AL00001+20                                     2320
         LA    @01,@AL00001                                        2320
         BAL   @14,BFPLPROC                                        2320
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  DETERMINE IF AN FVT FOR AN AIX IS BEING     @Y30SSFR*/
*            /*  BUILT.  IF SO, SET RELATED NAME VALUE.      @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2321
*            IF CTGFVTYP = CTGTAIX                         /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         L     @15,@PC00017+8                                      2321
         L     @15,FPTRFVT(,@15)                                   2321
         CLI   CTGFVTYP(@15),C'G'                                  2321
         BNE   @RF02321                                            2321
*                CTGFVNAM = DICTDL(IRELNAM) + FWKA;        /*@Y30SSFR*/
         L     @14,@PC00017+4                                      2322
         L     @01,DICTPTR                                         2322
         L     @05,DICTDL+232(,@01)                                2322
         AL    @05,FWKA(,@14)                                      2322
         ST    @05,CTGFVNAM(,@15)                                  2322
*              ELSE                                        /*@Y30SSFR*/
*                                                                  2323
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  OTHERWISE WE ARE CONSTRUCTING A PATH    @Y30SSFR*/
*                /*  FVT.  PLACE THE APPROPRIATE PATHENTRY   @Y30SSFR*/
*                /*  NAME AND PASSWORD IN THE FVT.           @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2323
*                DO;                                       /*@Y30SSFR*/
         B     @RC02321                                            2323
@RF02321 DS    0H                                                  2324
*                CTGFVNAM = FVTPTR(1) -> CTGFVENT;         /*@Y30SSFR*/
         L     @15,@PC00017+8                                      2324
         L     @15,FPTRFVT(,@15)                                   2324
         L     @14,FVTPTR                                          2324
         L     @14,CTGFVENT(,@14)                                  2324
         ST    @14,CTGFVNAM(,@15)                                  2324
*                IF DICTDL(IPTHPASS) ^= 0                  /*@Y30SSFR*/
*                  THEN                                    /*@Y30SSFR*/
         L     @01,DICTPTR                                         2325
         L     @14,DICTDL+240(,@01)                                2325
         LTR   @14,@14                                             2325
         BZ    @RF02325                                            2325
*                    CTGFVPWD = DICTDL(IPTHPASS) + FWKA;   /*@Y30SSFR*/
         L     @05,@PC00017+4                                      2326
         AL    @14,FWKA(,@05)                                      2326
         ST    @14,CTGFVPWD(,@15)                                  2326
*                END;                                      /*@Y30SSFR*/
*                                                                  2327
@RF02325 DS    0H                                                  2328
*            END;                                          /*@Y30SSFR*/
*                                                                  2328
@RC02321 DS    0H                                                  2329
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  CONSTRUCT PASSWALL FPL WHICH REFERENCES THE PASSWORD    */
*        /*  CATALOG FIELD, PLACE POINTER TO FPL IN FVT      @Y30SSFR*/
*        /*  IF THE PASSWALL FIELD IS NOT CONSTRUCTED        @Y30SSFR*/
*        /*  SUCCESSFULLY, RETURN TO THE CALLING             @Y30SSFR*/
*        /*  PROCESSOR WITH FAILURE INDICATED.               @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2329
*        CTGFVSTY = FPLADDR;                               /*@Y30SSFR*/
@RF02318 L     @15,@PC00017+8                                      2329
         L     @01,FPTRFVT(,@15)                                   2329
         L     @00,FPLADDR                                         2329
         ST    @00,CTGFVSTY(,@01)                                  2329
*        CALL BPASPROC(FPLADDR,FDICT,FWKA);                /*@Y30SSFR*/
         LA    @15,FPLADDR                                         2330
         ST    @15,@AL00001                                        2330
         L     @15,@PC00017                                        2330
         ST    @15,@AL00001+4                                      2330
         L     @15,@PC00017+4                                      2330
         ST    @15,@AL00001+8                                      2330
         LA    @01,@AL00001                                        2330
         BAL   @14,BPASPROC                                        2330
*        RESPECIFY RTNREG RSTD;                                    2331
*        TESTRC = RTNREG;                                          2332
         LR    TESTRC,RTNREG                                       2332
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/
*        IF TESTRC ^= 0                                            2334
*          THEN                                                    2334
         SLR   @03,@03                                             2334
         CR    TESTRC,@03                                          2334
         BE    @RF02334                                            2334
*            DO;                                           /*@Y30SSFR*/
*            IF TESTRC = 4                                         2336
*              THEN                                                2336
         C     TESTRC,@CF00045                                     2336
         BNE   @RF02336                                            2336
*                CTGFVSTY = NULLPTR;                       /*@Y30SSFR*/
         L     @02,@PC00017+8                                      2337
         L     @01,FPTRFVT(,@02)                                   2337
         ST    @03,CTGFVSTY(,@01)                                  2337
*              ELSE                                                2338
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
         B     @RC02336                                            2338
@RF02336 LA    @15,12                                              2338
         L     @14,@SA00017                                        2338
         LM    @00,@12,@SA00017+8                                  2338
         BR    @14                                                 2338
*            END;                                          /*@Y30SSFR*/
*                                                                  2339
@RC02336 DS    0H                                                  2340
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  CONSTRUCT OWNERID FPL WHICH REFERENCES THE OWNER OF     */
*        /*  DATA SET CATALOG FIELD, PLACE POINTER TO FPL IN FVT     */
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2340
*        CALL BFPLPROC(ADDR(FIELDLST),IOWNERID,                    2340
*            FPLADDR,FDICT,FWKA,CTGFVOWN);                 /*@Y30SSFR*/
*                                                                  2340
@RF02334 LA    @15,FIELDLST                                        2340
         ST    @15,@AFTEMPS+28                                     2340
         LA    @15,@AFTEMPS+28                                     2340
         ST    @15,@AL00001                                        2340
         LA    @15,@CH00045                                        2340
         ST    @15,@AL00001+4                                      2340
         LA    @15,FPLADDR                                         2340
         ST    @15,@AL00001+8                                      2340
         L     @15,@PC00017                                        2340
         ST    @15,@AL00001+12                                     2340
         L     @15,@PC00017+4                                      2340
         ST    @15,@AL00001+16                                     2340
         L     @15,@PC00017+8                                      2340
         L     @01,FPTRFVT(,@15)                                   2340
         LA    @15,CTGFVOWN(,@01)                                  2340
         ST    @15,@AL00001+20                                     2340
         LA    @01,@AL00001                                        2340
         BAL   @14,BFPLPROC                                        2340
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  CONSTRUCT DSETEXDT FPL WHICH REFERENCES         @Y30SSFR*/
*        /*  THE EXPIRATION DATE CATALOG FIELD, PLACE        @Y30SSFR*/
*        /*  POINTER IN FVT                                  @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2341
*        CALL BFPLPROC(ADDR(FIELDLST),IDSETEXD,            /*@Y30SSFR*/
*           FPLADDR,FDICT,FWKA,CTGFVEXP);                  /*@Y30SSFR*/
*                                                                  2341
         LA    @15,FIELDLST                                        2341
         ST    @15,@AFTEMPS+28                                     2341
         LA    @15,@AFTEMPS+28                                     2341
         ST    @15,@AL00001                                        2341
         LA    @15,@CH00159                                        2341
         ST    @15,@AL00001+4                                      2341
         LA    @15,FPLADDR                                         2341
         ST    @15,@AL00001+8                                      2341
         L     @15,@PC00017                                        2341
         ST    @15,@AL00001+12                                     2341
         L     @15,@PC00017+4                                      2341
         ST    @15,@AL00001+16                                     2341
         L     @15,@PC00017+8                                      2341
         L     @01,FPTRFVT(,@15)                                   2341
         LA    @15,CTGFVEXP(,@01)                                  2341
         ST    @15,@AL00001+20                                     2341
         LA    @01,@AL00001                                        2341
         BAL   @14,BFPLPROC                                        2341
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  CONSTRUCT DSETCRDT FPL WHICH REFERENCES THE     @Y30SSFR*/
*        /*  CREATION DATE CATALOG FIELD, PLACE              @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2342
*        CALL BFPLPROC(ADDR(FIELDLST),IDSETCRD,            /*@Y30SSFR*/
*           FPLADDR,FDICT,FWKA,CTGFVCRE);                  /*@Y30SSFR*/
*                                                                  2342
         LA    @15,FIELDLST                                        2342
         ST    @15,@AFTEMPS+28                                     2342
         LA    @15,@AFTEMPS+28                                     2342
         ST    @15,@AL00001                                        2342
         LA    @15,@CH00288                                        2342
         ST    @15,@AL00001+4                                      2342
         LA    @15,FPLADDR                                         2342
         ST    @15,@AL00001+8                                      2342
         L     @15,@PC00017                                        2342
         ST    @15,@AL00001+12                                     2342
         L     @15,@PC00017+4                                      2342
         ST    @15,@AL00001+16                                     2342
         L     @15,@PC00017+8                                      2342
         L     @01,FPTRFVT(,@15)                                   2342
         LA    @15,CTGFVCRE(,@01)                                  2342
         ST    @15,@AL00001+20                                     2342
         LA    @01,@AL00001                                        2342
         BAL   @14,BFPLPROC                                        2342
*        /************************************************************/
*        /*                                                  @Y30SSFR*/
*        /*  IF THE TYPE IS PATH, OMIT BUILDING THE REST OF  @Y30SSFR*/
*        /*  THE FPL'S.                                      @Y30SSFR*/
*        /*                                                  @Y30SSFR*/
*        /************************************************************/
*                                                                  2343
*        IF CTGFVTYP ^= CTGTPTH                                    2343
*          THEN                                                    2343
         L     @15,@PC00017+8                                      2343
         L     @01,FPTRFVT(,@15)                                   2343
         CLI   CTGFVTYP(@01),C'R'                                  2343
         BE    @RF02343                                            2343
*NOPTH:      DO;                                           /*@Y30SSFR*/
*                                                                  2344
NOPTH    DS    0H                                                  2345
*        /************************************************************/
*        /*                                                          */
*        /*  CONSTRUCT SPACPARM FPL WHICH REFERENCES THE SPACE       */
*        /*  ALLOCATION CATALOG FIELD, PLACE FVT POINTER IN FPL      */
*        /*                                                          */
*        /************************************************************/
*                                                                  2345
*            CALL BFPLPROC(ADDR(FIELDLST),ISPACPAR,        /*@Y30SSFR*/
*                FPLADDR,FDICT,FWKA,CTGFVSPC);             /*@Y30SSFR*/
*                                                                  2345
         LA    @15,FIELDLST                                        2345
         ST    @15,@AFTEMPS+28                                     2345
         LA    @15,@AFTEMPS+28                                     2345
         ST    @15,@AL00001                                        2345
         LA    @15,@CH00038                                        2345
         ST    @15,@AL00001+4                                      2345
         LA    @15,FPLADDR                                         2345
         ST    @15,@AL00001+8                                      2345
         L     @15,@PC00017                                        2345
         ST    @15,@AL00001+12                                     2345
         L     @15,@PC00017+4                                      2345
         ST    @15,@AL00001+16                                     2345
         L     @15,@PC00017+8                                      2345
         L     @01,FPTRFVT(,@15)                                   2345
         LA    @15,CTGFVSPC(,@01)                                  2345
         ST    @15,@AL00001+20                                     2345
         LA    @01,@AL00001                                        2345
         BAL   @14,BFPLPROC                                        2345
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT AMDSB FPL, PLACE POINTER IN FVT   @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2346
*            CALL BFPLPROC(ADDR(FIELDLST),IAMDSB,          /*@Y30SSFR*/
*                FPLADDR,FDICT,FWKA,CTGFVAMD);             /*@Y30SSFR*/
         LA    @15,FIELDLST                                        2346
         ST    @15,@AFTEMPS+28                                     2346
         LA    @15,@AFTEMPS+28                                     2346
         ST    @15,@AL00001                                        2346
         LA    @15,@CH00625                                        2346
         ST    @15,@AL00001+4                                      2346
         LA    @15,FPLADDR                                         2346
         ST    @15,@AL00001+8                                      2346
         L     @15,@PC00017                                        2346
         ST    @15,@AL00001+12                                     2346
         L     @15,@PC00017+4                                      2346
         ST    @15,@AL00001+16                                     2346
         L     @15,@PC00017+8                                      2346
         L     @01,FPTRFVT(,@15)                                   2346
         LA    @15,CTGFVAMD(,@01)                                  2346
         ST    @15,@AL00001+20                                     2346
         LA    @01,@AL00001                                        2346
         BAL   @14,BFPLPROC                                        2346
*            RESPECIFY IDAAMDSB BASED(DSCCATPT);           /*@Y30SSFR*/
*            IF CTGFVAMD ^= NULLPTR                        /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
*                                                                  2348
         L     @15,@PC00017+8                                      2348
         L     @15,FPTRFVT(,@15)                                   2348
         L     @14,CTGFVAMD(,@15)                                  2348
         LTR   @14,@14                                             2348
         BZ    @RF02348                                            2348
*                /****************************************************/
*                /*                                          @Y30SSFR*/
*                /*  IF AMDSBCAT INFORMATION EXISTS FOR THIS @Y30SSFR*/
*                /*  COMPONENT INITIALIZE THE AMDSBCAT       @Y30SSFR*/
*                /*  INFORMATION FROM INFORMATION            @Y30SSFR*/
*                /*  IN THE DICTIONARY AND WORK AREA.        @Y30SSFR*/
*                /*                                          @Y30SSFR*/
*                /****************************************************/
*                                                                  2349
*                DO;                                       /*@Y30SSFR*/
*                DSCCATPT = CTGFVAMD -> CTGFLPT(1);        /*@Y30SSFR*/
         L     DSCCATPT,CTGFLPT(,@14)                              2350
*                AMDLEN = LENGTH(IDAAMDSB);                /*@Y30SSFR*/
         MVC   AMDLEN(2,DSCCATPT),@CH01655                         2351
*                AMDATTR = (FWKA + DICTDL(IAMDSB)) -> AMDATTR;     2352
         L     @03,@PC00017+4                                      2352
         L     @03,FWKA(,@03)                                      2352
         L     @01,DICTPTR                                         2352
         AL    @03,DICTDL+136(,@01)                                2352
         MVC   AMDATTR(1,DSCCATPT),AMDATTR(@03)                    2352
*                AMDRKP = (FWKA + DICTDL(IAMDSB)) -> AMDRKP;       2353
         LH    @14,AMDRKP(,@03)                                    2353
         STH   @14,AMDRKP(,DSCCATPT)                               2353
*                AMDKEYLN = (FWKA + DICTDL(IAMDSB)) -> AMDKEYLN;   2354
         LH    @14,AMDKEYLN(,@03)                                  2354
         STH   @14,AMDKEYLN(,DSCCATPT)                             2354
*                AMDCINV = (FWKA + DICTDL(IAMDSB))-> AMDCINV;      2355
         L     @14,AMDCINV(,@03)                                   2355
         ST    @14,AMDCINV(,DSCCATPT)                              2355
*                AMDLRECL = (FWKA + DICTDL(IAMDSB)) -> AMDLRECL;   2356
         L     @14,AMDLRECL(,@03)                                  2356
         ST    @14,AMDLRECL(,DSCCATPT)                             2356
*                AMDPCTCA = (FWKA + DICTDL(IAMDSB)) -> AMDPCTCA;   2357
         IC    @14,AMDPCTCA(,@03)                                  2357
         STC   @14,AMDPCTCA(,DSCCATPT)                             2357
*                AMDPCTCI = (FWKA + DICTDL(IAMDSB)) -> AMDPCTCI;   2358
         IC    @14,AMDPCTCI(,@03)                                  2358
         STC   @14,AMDPCTCI(,DSCCATPT)                             2358
*                AMDATTR3 = (FWKA + DICTDL(IAMDSB))->      /*@Y30SSFR*/
*                   AMDATTR3;                              /*@Y30SSFR*/
*                                                                  2359
         MVC   AMDATTR3(1,DSCCATPT),AMDATTR3(@03)                  2359
*                IF CTGFVTYP = CTGTDATA                            2360
*                  THEN                                            2360
         CLI   CTGFVTYP(@15),C'D'                                  2360
         BNE   @RF02360                                            2360
*                    AMDAXRKP = (FWKA + DICTDL(IAMDSB))->  /*@Y30SSFR*/
*                       AMDAXRKP;                          /*@Y30SSFR*/
         LH    @03,AMDAXRKP(,@03)                                  2361
         STH   @03,AMDAXRKP(,DSCCATPT)                             2361
*                END;                                      /*@Y30SSFR*/
*                                                                  2362
@RF02360 DS    0H                                                  2363
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT DSATTR FPL WHICH REFERENCES DATA  @Y30SSFR*/
*            /*  SET ATTRIBUTES CATALOG FIELD, PLACE POINTER @Y30SSFR*/
*            /*  IN FVT                                      @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2363
*            IF CTGFVTYP = CTGTINDX  CTGFVTYP = CTGTDATA          2363
*              THEN                                                2363
@RF02348 L     @15,@PC00017+8                                      2363
         L     @15,FPTRFVT(,@15)                                   2363
         CLI   CTGFVTYP(@15),C'I'                                  2363
         BE    @RT02363                                            2363
         CLI   CTGFVTYP(@15),C'D'                                  2363
         BNE   @RF02363                                            2363
@RT02363 DS    0H                                                  2364
*                CALL BFPLPROC(ADDR(FIELDLST),IDSATTR,     /*@Y30SSFR*/
*                   FPLADDR,FDICT,FWKA,CTGFVATR);          /*@Y30SSFR*/
*                                                                  2364
         LA    @15,FIELDLST                                        2364
         ST    @15,@AFTEMPS+28                                     2364
         LA    @15,@AFTEMPS+28                                     2364
         ST    @15,@AL00001                                        2364
         LA    @15,@CH00165                                        2364
         ST    @15,@AL00001+4                                      2364
         LA    @15,FPLADDR                                         2364
         ST    @15,@AL00001+8                                      2364
         L     @15,@PC00017                                        2364
         ST    @15,@AL00001+12                                     2364
         L     @15,@PC00017+4                                      2364
         ST    @15,@AL00001+16                                     2364
         L     @15,@PC00017+8                                      2364
         L     @01,FPTRFVT(,@15)                                   2364
         LA    @15,CTGFVATR(,@01)                                  2364
         ST    @15,@AL00001+20                                     2364
         LA    @01,@AL00001                                        2364
         BAL   @14,BFPLPROC                                        2364
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT EXCEPTION EXIT FPL, PLACE POINTER @Y30SSFR*/
*            /*  IN THE FVT.                                 @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2365
*            CALL BFPLPROC(ADDR(FIELDLST),IEXCPXIT,        /*@Y30SSFR*/
*               FPLADDR,FDICT,FWKA,CTGFVEXT);              /*@Y30SSFR*/
*                                                                  2365
@RF02363 LA    @15,FIELDLST                                        2365
         ST    @15,@AFTEMPS+28                                     2365
         LA    @15,@AFTEMPS+28                                     2365
         ST    @15,@AL00001                                        2365
         LA    @15,@CH01096                                        2365
         ST    @15,@AL00001+4                                      2365
         LA    @15,FPLADDR                                         2365
         ST    @15,@AL00001+8                                      2365
         L     @15,@PC00017                                        2365
         ST    @15,@AL00001+12                                     2365
         L     @15,@PC00017+4                                      2365
         ST    @15,@AL00001+16                                     2365
         L     @15,@PC00017+8                                      2365
         L     @01,FPTRFVT(,@15)                                   2365
         LA    @15,CTGFVEXT(,@01)                                  2365
         ST    @15,@AL00001+20                                     2365
         LA    @01,@AL00001                                        2365
         BAL   @14,BFPLPROC                                        2365
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT BUFSIZE FPL, PLACE POINTER IN FVT @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2366
*            IF CTGFVTYP ^= CTGFVIDX                       /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
         L     @15,@PC00017+8                                      2366
         L     @15,FPTRFVT(,@15)                                   2366
         CLI   CTGFVTYP(@15),C'I'                                  2366
         BE    @RF02366                                            2366
*                CALL BFPLPROC(ADDR(FIELDLST),IBUFSIZE,    /*@Y30SSFR*/
*                   FPLADDR,FDICT,FWKA,CTGFVBUF);          /*@Y30SSFR*/
*                                                                  2367
         LA    @14,FIELDLST                                        2367
         ST    @14,@AFTEMPS+28                                     2367
         LA    @14,@AFTEMPS+28                                     2367
         ST    @14,@AL00001                                        2367
         LA    @14,@CH00040                                        2367
         ST    @14,@AL00001+4                                      2367
         LA    @14,FPLADDR                                         2367
         ST    @14,@AL00001+8                                      2367
         L     @14,@PC00017                                        2367
         ST    @14,@AL00001+12                                     2367
         L     @14,@PC00017+4                                      2367
         ST    @14,@AL00001+16                                     2367
         LA    @15,CTGFVBUF(,@15)                                  2367
         ST    @15,@AL00001+20                                     2367
         LA    @01,@AL00001                                        2367
         BAL   @14,BFPLPROC                                        2367
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT LRECL FPL AND PLACE POINTER IN FVT@Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2368
*            IF CTGFVTYP ^= CTGFVIDX                       /*@Y30SSFR*/
*              THEN                                        /*@Y30SSFR*/
@RF02366 L     @15,@PC00017+8                                      2368
         L     @15,FPTRFVT(,@15)                                   2368
         CLI   CTGFVTYP(@15),C'I'                                  2368
         BE    @RF02368                                            2368
*                CALL BFPLPROC(ADDR(FIELDLST),ILRECL,      /*@Y30SSFR*/
*                   FPLADDR,FDICT,FWKA,CTGFVLRS);          /*@Y30SSFR*/
*                                                                  2369
         LA    @14,FIELDLST                                        2369
         ST    @14,@AFTEMPS+28                                     2369
         LA    @14,@AFTEMPS+28                                     2369
         ST    @14,@AL00001                                        2369
         LA    @14,@CH00039                                        2369
         ST    @14,@AL00001+4                                      2369
         LA    @14,FPLADDR                                         2369
         ST    @14,@AL00001+8                                      2369
         L     @14,@PC00017                                        2369
         ST    @14,@AL00001+12                                     2369
         L     @14,@PC00017+4                                      2369
         ST    @14,@AL00001+16                                     2369
         LA    @15,CTGFVLRS(,@15)                                  2369
         ST    @15,@AL00001+20                                     2369
         LA    @01,@AL00001                                        2369
         BAL   @14,BFPLPROC                                        2369
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  CONSTRUCT KEY RANGES LIST IF HIKEYV, LOKEYV @Y30SSFR*/
*            /*  FIELDS WERE LOCATED AT EXPORT TIME          @Y30SSFR*/
*            /*  IF RANGPROC DOES NOT CONSTRUCT THE LIST     @Y30SSFR*/
*            /*  SUCCESSFULLY, INDICATE AN ERROR AND RETURN  @Y30SSFR*/
*            /*  TO CALLING PROCESSOR.                       @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2370
*            CALL RANGPROC(0,FDICT,FWKA,CTGFVRNG);         /*@Y30SSFR*/
@RF02368 LA    @15,@CF00118                                        2370
         ST    @15,@AL00001                                        2370
         L     @15,@PC00017                                        2370
         ST    @15,@AL00001+4                                      2370
         L     @15,@PC00017+4                                      2370
         ST    @15,@AL00001+8                                      2370
         L     @15,@PC00017+8                                      2370
         L     @01,FPTRFVT(,@15)                                   2370
         LA    @15,CTGFVRNG(,@01)                                  2370
         ST    @15,@AL00001+12                                     2370
         LA    @01,@AL00001                                        2370
         BAL   @14,RANGPROC                                        2370
*            RESPECIFY RTNREG RSTD;                                2371
*            TESTRC = RTNREG;                                      2372
         LR    TESTRC,RTNREG                                       2372
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/
*            IF TESTRC ^= 0                                        2374
*              THEN                                                2374
         LTR   TESTRC,TESTRC                                       2374
         BZ    @RF02374                                            2374
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  2375
         LA    @15,12                                              2375
         L     @14,@SA00017                                        2375
         LM    @00,@12,@SA00017+8                                  2375
         BR    @14                                                 2375
*            /********************************************************/
*            /*                                                      */
*            /*  CONSTRUCT LIST OF VOLUME SERIALS IF THE VOLUME      */
*            /*  SERIAL NUMBER WERE EXPORTED.                        */
*            /*  NOTE THAT IN RELEASE 1 THE VOLUME LIST WAS NOT      */
*            /*  EXPORTED IF PERMANENT WAS  SPECIFIED.               */
*            /*                                                      */
*            /********************************************************/
*                                                                  2376
*            CALL LVLRPROC(0,FDICT,FWKA,FPTRFVT);          /*@OZ32365*/
*                                                                  2376
@RF02374 LA    @15,@CF00118                                        2376
         ST    @15,@AL00001                                        2376
         L     @15,@PC00017                                        2376
         ST    @15,@AL00001+4                                      2376
         L     @15,@PC00017+4                                      2376
         ST    @15,@AL00001+8                                      2376
         L     @15,@PC00017+8                                      2376
         ST    @15,@AL00001+12                                     2376
         LA    @01,@AL00001                                        2376
         BAL   @14,LVLRPROC                                        2376
*            RESPECIFY RTNREG RSTD;                                2377
*            TESTRC = RTNREG;                                      2378
         LR    TESTRC,RTNREG                                       2378
*            RESPECIFY RTNREG UNRSTD;                              2379
*                                                                  2379
*            /********************************************************/
*            /*                                                      */
*            /*  IF UNSUCCESSFUL, RETURN TO CALLER                   */
*            /*                                                      */
*            /********************************************************/
*                                                                  2380
*            IF TESTRC ^= 0                                        2380
*              THEN                                                2380
         LTR   TESTRC,TESTRC                                       2380
         BZ    @RF02380                                            2380
*                RETURN CODE(LASTCC12);                /*@Y30SSFR*/
*                                                                  2381
*                                                                  2381
         LA    @15,12                                              2381
         L     @14,@SA00017                                        2381
         LM    @00,@12,@SA00017+8                                  2381
         BR    @14                                                 2381
*            END NOPTH;                                    /*@Y30SSFR*/
*                                                                  2382
@RF02380 DS    0H                                                  2383
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2383
*        RETURN CODE(0);                                           2383
@RF02343 SLR   @15,@15                                             2383
         L     @14,@SA00017                                        2383
         LM    @00,@12,@SA00017+8                                  2383
         BR    @14                                                 2383
*END FVTPROC;                                                      2384
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - BPASPROC                               */
*        /*                                                          */
*        /*  FUNCTION - CONSTRUCT PASSWALL FPL, MOVE FIELD           */
*        /*  INFORMATION FROM PASSWORD, PASSPRMT, PASSATM, USERAREA  */
*        /*  AND USVRMDUL FIELDS INTO PASSWALL COMBINATION FIELD     */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .BFPL - FPL POINTER                                   */
*        /*    .BDICT - POINTER TO DICTIONARY REFERENCING CATALOG    */
*        /*      FIELD INFORMATION WITHIN THE WORK AREA              */
*        /*    .BWKA - WORK AREA CONTAINING CATALOG FIELD INFORMATION*/
*        /*                                                          */
*        /*  OUTPUT - PASSWALL FPL, AND PASSWALL COMBINATION FIELD   */
*        /*                                                          */
*        /************************************************************/
*                                                                  2385
*BPASPROC: PROCEDURE(BFPL,             /*POINTER TO FPL              */
*                    BDICT,            /*DICTIONARY POINTER          */
*                    BWKA);            /*WORK AREA POINTER           */
*                                                                  2385
BPASPROC STM   @14,@12,@SA00018                                    2385
         MVC   @PC00018(12),0(@01)                                 2385
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2386
*        DCL BFPL   PTR(31),                                       2386
*            BDICT  PTR(31),                                       2386
*            BWKA   PTR(31);                                       2386
*                                                                  2386
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  2387
*        DCL DICENPTR PTR(31);                                     2387
*        DCL FIELDPS  CHAR(*) BASED(DICENPTR);                     2388
*        DCL NOFIND   CONSTANT(4);                                 2389
*                                                                  2389
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO BE SURE PASSWORD INFORMATION WAS SPECIFIED.    */
*        /*  IF IT WAS FILL IN FPL FIELDS FOR PASSSWALL FIELD        */
*        /*                                                          */
*        /************************************************************/
*                                                                  2390
*        OLDERID2 = NEWERID2;                                      2390
         L     @15,@PC00001                                        2390
         L     @14,GDTTR2(,@15)                                    2390
         MVC   @TS00001(95),NEWERID2(@14)                          2390
         MVC   OLDERID2(95,@14),@TS00001                           2390
*        NEWID2 = 'MPPS';                                          2391
         MVC   NEWID2(4,@14),@CC01600                              2391
*        DICTPTR = BDICT;                                          2392
         L     @14,@PC00018+4                                      2392
         L     @14,BDICT(,@14)                                     2392
         ST    @14,DICTPTR                                         2392
*        IF DICTLN(IPASSWOR) ^= 0                                  2393
*          THEN                                                    2393
         L     @05,DICTLN+72(,@14)                                 2393
         LTR   @05,@05                                             2393
         BZ    @RF02393                                            2393
*            DO;                                                   2394
*            CTGFLPTR = BFPL;                                      2395
         L     @03,@PC00018                                        2395
         L     CTGFLPTR,BFPL(,@03)                                 2395
*            CTGFLDNO = '00000001'B;                               2396
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            2396
*            CTGFLDNM = ADDR(FPASNAME);                            2397
         LA    @05,FPASNAME                                        2397
         ST    @05,CTGFLDNM(,CTGFLPTR)                             2397
*            CTGFLNG(1) = LENGTH(FPASSWAL) + DICTLN(IUSRAREC);     2398
*                                                                  2398
         LA    @05,52                                              2398
         AL    @05,DICTLN+104(,@14)                                2398
         ST    @05,CTGFLNG(,CTGFLPTR)                              2398
*            /********************************************************/
*            /*                                                      */
*            /*  GET CORE TO CONTAIN FIELD INFORMATION               */
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR*/
*            /*                                                      */
*            /********************************************************/
*                                                                  2399
*            CALL IDCSAGP0(GDTTBL,CTGFLNG(1),CTGFLPT(1),GPID,SETZERO);
*                                                                  2399
         ST    @15,@AL00001                                        2399
         LA    @05,CTGFLNG(,CTGFLPTR)                              2399
         ST    @05,@AL00001+4                                      2399
         LA    @05,CTGFLPT(,CTGFLPTR)                              2399
         ST    @05,@AL00001+8                                      2399
         LA    @05,GPID                                            2399
         ST    @05,@AL00001+12                                     2399
         LA    @05,SETZERO                                         2399
         ST    @05,@AL00001+16                                     2399
         MVI   @AL00001+16,X'80'                                   2399
         L     @15,GDTGPL(,@15)                                    2399
         LA    @01,@AL00001                                        2399
         BALR  @14,@15                                             2399
*            RESPECIFY RTNREG RSTD;                                2400
*            TESTRC = RTNREG;                                      2401
         LR    TESTRC,RTNREG                                       2401
*            RESPECIFY RTNREG UNRSTD;                              2402
*            IF TESTRC ^= 0                                        2403
*              THEN                                                2403
         LTR   TESTRC,TESTRC                                       2403
         BZ    @RF02403                                            2403
*                DO;                                               2404
*                DEFSTID = NOSTORAG;                               2405
         MVI   DEFSTID,X'04'                                       2405
*                DARGSMOD = UNIVMSG;                               2406
         L     @01,DDSTRU                                          2406
         MVC   DARGSMOD(3,@01),@CC01023                            2406
*                RETURN CODE(LASTCC12);                            2407
         LA    @15,12                                              2407
         L     @14,@SA00018                                        2407
         LM    @00,@12,@SA00018+8                                  2407
         BR    @14                                                 2407
*                END;                                              2408
*                                                                  2408
*            /********************************************************/
*            /*                                                      */
*            /*  INITIALIZE PASSWORD PORTION OF PASSWALL COMBINATION */
*            /*  FIELD TO FF'S                                       */
*            /*                                                      */
*            /********************************************************/
*                                                                  2409
*            DO J = 1 TO LENGTH(FPASSWAL);                         2409
@RF02403 LA    J,1                                                 2409
@DL02409 DS    0H                                                  2410
*              FPASSWAL(J) = 'FF'X;                                2410
         L     @05,CTGFLPT(,CTGFLPTR)                              2410
         ALR   @05,J                                               2410
         BCTR  @05,0                                               2410
         MVI   FPASSWAL(@05),X'FF'                                 2410
*            END;                                                  2411
*                                                                  2411
         AL    J,@CF00221                                          2411
         C     J,@CF01653                                          2411
         BNH   @DL02409                                            2411
*            FUSERLN = 0;                                          2412
*                                                                  2412
         SLR   @05,@05                                             2412
         L     @03,CTGFLPT(,CTGFLPTR)                              2412
         STH   @05,FUSERLN(,@03)                                   2412
*            DICENPTR = DICTDL(IPASSWOR) + BWKA;                   2413
*                                                                  2413
         L     @15,DICTPTR                                         2413
         L     @14,@PC00018+8                                      2413
         L     DICENPTR,DICTDL+72(,@15)                            2413
         AL    DICENPTR,BWKA(,@14)                                 2413
*            /********************************************************/
*            /*                                                      */
*            /*  CONSTRUCT PASSWALL COMBINATION CATALOG FIELD FROM   */
*            /*  ALL SUPPLIED INFORMATION IN WORK AREA.  FIELDS WILL */
*            /*  BE LEFT ZERO WHEN NO INFORMATION HAS BEEN SUPPLIED  */
*            /*  FOR THAT ENTRY                                      */
*            /*                                                      */
*            /********************************************************/
*                                                                  2414
*            IF DICTLN(IPASSWOR) ^= 0                              2414
*              THEN                                                2414
         L     @15,DICTLN+72(,@15)                                 2414
         CR    @15,@05                                             2414
         BE    @RF02414                                            2414
*                FPASWD(1:DICTLN(IPASSWOR)) =                      2415
*                  FIELDPS(1:DICTLN(IPASSWOR));                    2415
*                                                                  2415
         BCTR  @15,0                                               2415
         EX    @15,@SM01735                                        2415
*            DICENPTR = DICTDL(IPASSPRM) + BWKA;                   2416
@RF02414 L     @05,DICTPTR                                         2416
         L     @15,@PC00018+8                                      2416
         L     DICENPTR,DICTDL+80(,@05)                            2416
         AL    DICENPTR,BWKA(,@15)                                 2416
*            IF DICTLN(IPASSPRM) ^= 0                              2417
*              THEN                                                2417
         L     @05,DICTLN+80(,@05)                                 2417
         LTR   @05,@05                                             2417
         BZ    @RF02417                                            2417
*                FPASSPRM(1:DICTLN(IPASSPRM)) =                    2418
*                  FIELDPS(1:DICTLN(IPASSPRM));                    2418
*                                                                  2418
         L     @03,CTGFLPT(,CTGFLPTR)                              2418
         BCTR  @05,0                                               2418
         EX    @05,@SM01737                                        2418
*            DICENPTR = DICTDL(IPASSATM) + BWKA;                   2419
@RF02417 L     @05,DICTPTR                                         2419
         L     @15,DICTDL+88(,@05)                                 2419
         L     @14,@PC00018+8                                      2419
         LR    DICENPTR,@15                                        2419
         AL    DICENPTR,BWKA(,@14)                                 2419
*            IF DICTDL(IPASSATM) ^= 0                              2420
*              THEN                                                2420
         LTR   @15,@15                                             2420
         BZ    @RF02420                                            2420
*                FPASSATM(1:DICTLN(IPASSATM)) =                    2421
*                  FIELDPS(1:DICTLN(IPASSATM));                    2421
*                                                                  2421
         L     @03,CTGFLPT(,CTGFLPTR)                              2421
         L     @05,DICTLN+88(,@05)                                 2421
         BCTR  @05,0                                               2421
         EX    @05,@SM01739                                        2421
*            DICENPTR = DICTDL(IUSVRMDU) + BWKA;                   2422
@RF02420 L     @05,DICTPTR                                         2422
         L     @15,@PC00018+8                                      2422
         L     DICENPTR,DICTDL+96(,@05)                            2422
         AL    DICENPTR,BWKA(,@15)                                 2422
*            IF DICTLN(IUSVRMDU) ^= 0                              2423
*              THEN                                                2423
         L     @05,DICTLN+96(,@05)                                 2423
         LTR   @05,@05                                             2423
         BZ    @RF02423                                            2423
*                FUSVRMDU(1:DICTLN(IUSVRMDU)) =                    2424
*                  FIELDPS(1:DICTDL(IUSVRMDU));                    2424
*                                                                  2424
         L     @03,CTGFLPT(,CTGFLPTR)                              2424
         BCTR  @05,0                                               2424
         EX    @05,@SM01741                                        2424
*            DICENPTR = DICTDL(IUSRAREC) + BWKA;                   2425
@RF02423 L     @05,DICTPTR                                         2425
         L     @15,@PC00018+8                                      2425
         L     DICENPTR,DICTDL+104(,@05)                           2425
         AL    DICENPTR,BWKA(,@15)                                 2425
*            IF DICTLN(IUSRAREC) ^= 0                              2426
*              THEN                                                2426
         L     @05,DICTLN+104(,@05)                                2426
         LTR   @05,@05                                             2426
         BZ    @RF02426                                            2426
*                FUSERARE(1:DICTLN(IUSRAREC)) =                    2427
*                  FIELDPS(1:DICTLN(IUSRAREC));                    2427
         L     @03,CTGFLPT(,CTGFLPTR)                              2427
         BCTR  @05,0                                               2427
         EX    @05,@SM01743                                        2427
*            END;                                                  2428
*                                                                  2428
*          /**********************************************************/
*          /*                                                        */
*          /*  PASSWORD FIELD IS ZERO, THEREFORE DON'T BUILD FPL     */
*          /*  OR FIELD                                              */
*          /*                                                        */
*          /**********************************************************/
*                                                                  2429
*          ELSE                                                    2429
*            RETURN CODE(NOFIND);                                  2429
*                                                                  2429
*                                                                  2429
         B     @RC02393                                            2429
@RF02393 LA    @15,4                                               2429
         L     @14,@SA00018                                        2429
         LM    @00,@12,@SA00018+8                                  2429
         BR    @14                                                 2429
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2430
*        BFPL = BFPL + LENGTH(CTGFL) + 8;                          2430
*                                                                  2430
@RC02393 L     @15,@PC00018                                        2430
         LA    @14,24                                              2430
         AL    @14,BFPL(,@15)                                      2430
         ST    @14,BFPL(,@15)                                      2430
*        RETURN CODE(0);                                           2431
         SLR   @15,@15                                             2431
         L     @14,@SA00018                                        2431
         LM    @00,@12,@SA00018+8                                  2431
         BR    @14                                                 2431
*END BPASPROC;                                                     2432
*/********************************************************************/
*/*                                                          @YL026UA*/
*/* PROCEDURE NAME - DALCPROC (SERVICE ROUTINE)              @YL026UA*/
*/*                                                          @YL026UA*/
*/* FUNCTION - DALCPROC PERFORMS THE NECESSARY PROCESSING TO @YL026UA*/
*/*            INVOKE THE AMS UALLOC ROUTINE WHICH PERFORMS  @YL026UA*/
*/*            DYNAMIC ALLOCATION.                           @YL026UA*/
*/********************************************************************/
*                                                                  2433
*DALCPROC:                                                         2433
*        PROCEDURE (REQTYPE,DALVLPTR,DALDNMPT,DALINDEX);   /*@YL026UA*/
*                                                                  2433
DALCPROC STM   @14,@12,@SA00019                                    2433
         MVC   @PC00019(16),0(@01)                                 2433
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* ARGUMENTS OF INVOCATION                          @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*        DCL                                                       2434
*          REQTYPE CHAR(1),            /* TYPE OF REQUEST    @YL026UA*/
*          DALVLPTR,                   /* ADDR OF VOLUMES    @Y30SSFR*/
*          DALDNMPT,                   /* ADDR OF DNAME      @YL026UA*/
*          DALINDEX;                   /* INDEX OF ALLAGLS   @YL026UA*/
*                                                                  2434
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* UNIT DESCRIPTOR LIST REFERENCED BY ALLAGL        @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*        DCL                                                       2435
*          1 DALCUNIT STATIC LOCAL,                                2435
*            2 DL#UNIT   FIXED(15) INIT(1),                        2435
*            2 DLUNITLN  FIXED(15) INIT(8),                  /*YM6050*/
*            2 DLUNIT    CHAR(8)   INIT('SYSALLDA');         /*YM6050*/
*                                                                  2435
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* SAVE AREAS FOR POINTERS TO ALLAGLS               @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*        DCL                                                       2436
*          1 ALGLSAVE  CHAR(20) BDY(WORD),                         2436
*            2 ALSAVPTR(*) PTR(31);                        /*@YL026UA*/
*                                                                  2436
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* MAPPING STRUCTURE FOR VOLUME LIST TO BE DYNAMICALLY      */
*        /* ALLOCATED, THIS LIST IS RECONSTRUCTED IN A FORM  @YL026UA*/
*        /* COMPATIBLE TO DYNAMIC ALLOCATION IN A NEW AREA   @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  2437
*        DCL                                                       2437
*          1 FVTVLIST BASED(DALVLPTR),                             2437
*            2 FVTVLEN FIXED(15),                                  2437
*            2 * (*),                                              2437
*              3 *       FIXED(15),                                2437
*              3 FVTVSER CHAR(6);                          /*@YL026UA*/
*                                                                  2437
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* MAPPING STRUCTURE FOR VOLUME LIST CONSTRUCTED IN DALCPROC*/
*        /* AND PASSED TO DYNAMIC ALLOCATION VIA THE ALLAGL PARAMETER*/
*        /* LIST                                             @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  2438
*        DCL                                                       2438
*          1 ALCVLIST BASED(ALLVLP),                               2438
*            2 ALC#ENT FIXED(15),                                  2438
*            2 * (*),                                              2438
*              3 ALCVLEN FIXED(15),                                2438
*              3 ALCVSER CHAR(6);                          /*@YL026UA*/
*                                                                  2438
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* POINTER TO ALLAGL PARAMETERLIST                  @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*        DCL                                                       2439
*          DALGLPTR  PTR(31);                              /*@YL026UA*/
*                                                                  2439
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* ENTRY POINT TO DALCPROC                          @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  2440
*        OLDERID2 = NEWERID2;                                      2440
         L     @15,@PC00001                                        2440
         L     @15,GDTTR2(,@15)                                    2440
         MVC   @TS00001(95),NEWERID2(@15)                          2440
         MVC   OLDERID2(95,@15),@TS00001                           2440
*        NEWID2 = 'MPDA';                                  /*@YL026UA*/
*                                                                  2441
         MVC   NEWID2(4,@15),@CC01630                              2441
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* CHECK REQUEST TYPE FOR ALLOCATION OR DEALLOCATION        */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  2442
*        IF REQTYPE = 'A'                                          2442
*          THEN                                                    2442
         L     @15,@PC00019                                        2442
         CLI   REQTYPE(@15),C'A'                                   2442
         BNE   @RF02442                                            2442
*DALOOP0:    DO;                                           /*@YL026UA*/
*                                                                  2443
DALOOP0  DS    0H                                                  2444
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* THIS IS AN ALLOCATION REQUEST - GET SPACE FOR THE    */
*            /* VOLUME LIST TO BE BUILT AND PASSED TO THE AMS        */
*            /* SYSTEM ADAPTER VIA THE ALLAGL PARAMETERLIST  @YL026UA*/
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2444
*            CALL IDCSAGP0 (GDTTBL,                                2444
*              ((FVTVLEN + 8) + (LENGTH(ALLAGL) +4 )),             2444
*              DALGLPTR,                                           2444
*              GPID,                                               2444
*              SETZERO);                                   /*@YL026UA*/
*                                                                  2444
         L     @03,@PC00001                                        2444
         ST    @03,@AL00001                                        2444
         L     @15,@PC00019+4                                      2444
         L     @01,DALVLPTR(,@15)                                  2444
         LA    @00,43                                              2444
         AH    @00,FVTVLEN(,@01)                                   2444
         ST    @00,@AFTEMPS+32                                     2444
         LA    @15,@AFTEMPS+32                                     2444
         ST    @15,@AL00001+4                                      2444
         LA    @15,DALGLPTR                                        2444
         ST    @15,@AL00001+8                                      2444
         LA    @15,GPID                                            2444
         ST    @15,@AL00001+12                                     2444
         LA    @15,SETZERO                                         2444
         ST    @15,@AL00001+16                                     2444
         MVI   @AL00001+16,X'80'                                   2444
         L     @15,GDTGPL(,@03)                                    2444
         LA    @01,@AL00001                                        2444
         BALR  @14,@15                                             2444
*            RESPECIFY RTNREG RSTD;                                2445
*            TESTRC = RTNREG;                                      2446
         LR    TESTRC,RTNREG                                       2446
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UA*/
*            IF TESTRC ^= 0                                        2448
*              THEN                                                2448
         LTR   TESTRC,TESTRC                                       2448
         BZ    @RF02448                                            2448
*                DO;                                       /*@YL026UA*/
*                                                                  2449
*                DEFSTID = NOSTORAG;                       /*@YL026UA*/
         MVI   DEFSTID,X'04'                                       2450
*                RETURN;                                   /*@YL026UA*/
*                                                                  2451
@EL00019 DS    0H                                                  2451
@EF00019 DS    0H                                                  2451
@ER00019 LM    @14,@12,@SA00019                                    2451
         BR    @14                                                 2451
*                END;                                      /*@YL026UA*/
*                                                                  2452
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* SET ADDRESSABILITY TO ALLAGL AND INITIALIZE ALLVLP   */
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2453
*            RFY ALLAGL BASED(DALGLPTR);                   /*@YL026UA*/
@RF02448 DS    0H                                                  2454
*            ALLVLP = DALGLPTR + (LENGTH(ALLAGL) +4);      /*@YL026UA*/
*                                                                  2454
         L     @15,DALGLPTR                                        2454
         LA    @14,35                                              2454
         ALR   @14,@15                                             2454
         ST    @14,ALLVLP(,@15)                                    2454
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* COMPUTE THE NUMBER OF ENTRIES IN THE UALLOC VOLUME   */
*            /* LIST                                         @YL026UA*/
*            /********************************************************/
*                                                                  2455
*            ALC#ENT = FVTVLEN / 8;                        /*@YL026UA*/
*                                                                  2455
         L     @15,@PC00019+4                                      2455
         L     @01,DALVLPTR(,@15)                                  2455
         LH    @00,FVTVLEN(,@01)                                   2455
         SRDA  @00,32                                              2455
         D     @00,@CF00039                                        2455
         STH   @01,ALC#ENT(,@14)                                   2455
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* CHECK FOR UNREASONABLE VALUE IN ALC#ENT TO PREVENT   */
*            /* ALLOPING PROBLEM IN DALOOP1                  @YL026UA*/
*            /*                                              @YL026UA*/
*            /********************************************************/
*            IF ALC#ENT  < 1                                      2456
*               ALC#ENT  > 255                                     2456
*              THEN                                                2456
         LTR   @01,@01                                             2456
         BNP   @RT02456                                            2456
         C     @01,@CF00634                                        2456
         BNH   @RF02456                                            2456
@RT02456 DS    0H                                                  2457
*                DO;                                       /*@YL026UA*/
*                                                                  2457
*                DEFSTID = UALLCERR;                       /*@YL026UA*/
         MVI   DEFSTID,X'10'                                       2458
*                RETURN;                                   /*@YL026UA*/
*                                                                  2459
         B     @EL00019                                            2459
*                END;                                      /*@YL026UA*/
*                                                                  2460
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* LOOP THRU THE LIST OF VOLUMES REFERENCED BY DALVLPTR */
*            /* MOVING EACH VOLSER INTO THE LIST PASSED VIA THE      */
*            /* ALLAGL AND COMPUTE THE LENGTH OF THE NON-BLANK       */
*            /* PORTION OF THE VOLSER, THIS LENGTH PRECEEDES EACH    */
*            /* VOLSER IN THE ALLAGL VOLUME LIST             @YL026UA*/
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2461
*DALOOP1:    DO N = 1 TO ALC#ENT;                          /*@YL026UA*/
*                                                                  2461
@RF02456 DS    0H                                                  2461
DALOOP1  LA    N,1                                                 2461
         B     @DE02461                                            2461
@DL02461 DS    0H                                                  2462
*              DO J = 1 TO 6                                       2462
*                WHILE FVTVSER (N,J) ^= ' ';               /*@YL026UA*/
         LA    J,1                                                 2462
@DL02462 LR    @15,N                                               2462
         SLA   @15,3                                               2462
         ALR   @15,J                                               2462
         L     @14,@PC00019+4                                      2462
         L     @01,DALVLPTR(,@14)                                  2462
         ALR   @01,@15                                             2462
         AL    @01,@CF01707                                        2462
         CLI   FVTVSER-4(@01),C' '                                 2462
         BE    @DC02462                                            2462
*              END;                                        /*@YL026UA*/
*                                                                  2463
         AL    J,@CF00221                                          2463
         C     J,@CF00159                                          2463
         BNH   @DL02462                                            2463
@DC02462 DS    0H                                                  2464
*              /******************************************************/
*              /*                                            @YL026UA*/
*              /* ON EXIT FROM ABOVE LOOP J HAS THE LENGTH OF THE    */
*              /* NONBLANK PORTION OF THE VOLSER + 1         @YL026UA*/
*              /*                                            @YL026UA*/
*              /******************************************************/
*                                                                  2464
*              ALCVLEN(N) = (J - 1);                       /*@YL026UA*/
         LR    @15,N                                               2464
         SLA   @15,3                                               2464
         L     @01,DALGLPTR                                        2464
         L     @14,ALLVLP(,@01)                                    2464
         LR    @05,J                                               2464
         BCTR  @05,0                                               2464
         LA    @04,0(@15,@14)                                      2464
         AL    @04,@CF01694                                        2464
         STH   @05,ALCVLEN-2(,@04)                                 2464
*              ALCVSER(N) = FVTVSER(N);                    /*@YL026UA*/
*                                                                  2465
         ALR   @14,@15                                             2465
         AL    @14,@CF01689                                        2465
         L     @02,@PC00019+4                                      2465
         L     @02,DALVLPTR(,@02)                                  2465
         ALR   @02,@15                                             2465
         AL    @02,@CF01689                                        2465
         MVC   ALCVSER-4(6,@14),FVTVSER-4(@02)                     2465
*            END DALOOP1;                                  /*@YL026UA*/
*                                                                  2466
         AL    N,@CF00221                                          2466
@DE02461 L     @02,DALGLPTR                                        2466
         L     @02,ALLVLP(,@02)                                    2466
         CH    N,ALC#ENT(,@02)                                     2466
         BNH   @DL02461                                            2466
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* INITIALIZE REMAINING ALLAGL FIELDS           @YL026UA*/
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2467
*            ALLULP = ADDR(DALCUNIT);                      /*@YL026UA*/
         L     @03,DALGLPTR                                        2467
         LA    @15,DALCUNIT                                        2467
         ST    @15,ALLULP(,@03)                                    2467
*            ALLOPTVL = ON;                                /*@YL026UA*/
*                                                                  2468
         OI    ALLOPTVL(@03),B'10000000'                           2468
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /*  INVOKE DYNAMIC ALLOCATION VIA AMS UALLOC MACRO      */
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2469
*            CALL IDCSAAL0 (GDTTBL,ALLAGL);                /*@YL026UA*/
*                                                                  2469
         L     @15,@PC00001                                        2469
         ST    @15,@AL00001                                        2469
         ST    @03,@AL00001+4                                      2469
         MVI   @AL00001+4,X'80'                                    2469
         L     @15,GDTALC(,@15)                                    2469
         LA    @01,@AL00001                                        2469
         BALR  @14,@15                                             2469
*            RESPECIFY RTNREG RSTD;                                2470
*            TESTRC = RTNREG;                                      2471
         LR    TESTRC,RTNREG                                       2471
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UA*/
*            IF TESTRC = 4                                         2473
*              THEN                                                2473
         C     TESTRC,@CF00045                                     2473
         BNE   @RF02473                                            2473
*                DO;                                       /*@YL026UA*/
*                                                                  2474
*                DEFSTID = UALLCERR;                       /*@YL026UA*/
         MVI   DEFSTID,X'10'                                       2475
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/
*                                                                  2476
         LA    @15,12                                              2476
         L     @14,@SA00019                                        2476
         LM    @00,@12,@SA00019+8                                  2476
         BR    @14                                                 2476
*                END;                                      /*@YL026UA*/
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* MAINTAIN A LIST OF POINTERS TO ALLAGLS - THERE IS A  */
*            /* POSSIBILITY OF MULTIPLE ALLAGLS.             @Y30SSFR*/
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2478
*            DALINDEX = DALINDEX + 1;                      /*@YL026UA*/
@RF02473 L     @15,@PC00019+12                                     2478
         LA    @14,1                                               2478
         AL    @14,DALINDEX(,@15)                                  2478
         ST    @14,DALINDEX(,@15)                                  2478
*            ALSAVPTR(DALINDEX) = DALGLPTR;                /*@YL026UA*/
*                                                                  2479
         L     @15,DALGLPTR                                        2479
         SLA   @14,2                                               2479
         ST    @15,ALSAVPTR-4(@14)                                 2479
*            /********************************************************/
*            /*                                              @YL026UA*/
*            /* SET POINTER TO DDNAME BUILT BY UALLOC        @YL026UA*/
*            /*                                              @YL026UA*/
*            /********************************************************/
*                                                                  2480
*            DALDNMPT = ADDR(ALLDDN);                      /*@YL026UA*/
*                                                                  2480
         L     @14,@PC00019+8                                      2480
         LA    @15,ALLDDN(,@15)                                    2480
         ST    @15,DALDNMPT(,@14)                                  2480
*            END DALOOP0;                                  /*@YL026UA*/
*                                                                  2481
*          /**********************************************************/
*          /* THIS IS A DEALLOCATE REQUEST                   @YL026UA*/
*          /**********************************************************/
*          ELSE                                                    2482
*            DO;                                           /*@Y30SSFR*/
         B     @RC02442                                            2482
@RF02442 DS    0H                                                  2483
*            DO N = 1 TO DALINDEX;                         /*#YL026UA*/
*                                                                  2483
         LA    N,1                                                 2483
         B     @DE02483                                            2483
@DL02483 DS    0H                                                  2484
*              RFY ALLAGL BASED(ALSAVPTR(N));                /*YM5040*/
*                                                                  2484
*              CALL IDCSADL0 (GDTTBL,ALLAGL);              /*#YL026UA*/
*                                                                  2485
         L     @02,@PC00001                                        2485
         ST    @02,@AL00001                                        2485
         LR    @15,N                                               2485
         SLA   @15,2                                               2485
         L     @01,ALSAVPTR-4(@15)                                 2485
         ST    @01,@AL00001+4                                      2485
         MVI   @AL00001+4,X'80'                                    2485
         L     @15,GDTDLC(,@02)                                    2485
         LA    @01,@AL00001                                        2485
         BALR  @14,@15                                             2485
*            END;                                          /*#YL026UA*/
*                                                                  2486
         AL    N,@CF00221                                          2486
@DE02483 L     @02,@PC00019+12                                     2486
         C     N,DALINDEX(,@02)                                    2486
         BNH   @DL02483                                            2486
*            /********************************************************/
*            /*                                              @Y30SSFR*/
*            /*  RESET THE VALUE OF DALINDEX TO ZERO.        @Y30SSFR*/
*            /*                                              @Y30SSFR*/
*            /********************************************************/
*                                                                  2487
*            DALINDEX = 0;                                 /*@Y30SSFR*/
         L     @15,@PC00019+12                                     2487
         SLR   @14,@14                                             2487
         ST    @14,DALINDEX(,@15)                                  2487
*            END;                                          /*@Y30SSFR*/
*                                                                  2488
*        RETURN CODE(0);                                   /*@Y30SSFR*/
@RC02442 SLR   @15,@15                                             2489
         L     @14,@SA00019                                        2489
         LM    @00,@12,@SA00019+8                                  2489
         BR    @14                                                 2489
*        RFY ALLAGL BASED(ALLPTR);                         /*#YL026UA*/
*END DALCPROC;                                             /*#YL026UA*/
*        /************************************************************/
*        /*                                                          */
*        /*  PROCEDURE NAME - GETPROC                                */
*        /*                                                          */
*        /*  FUNCTION - GET A DATA RECORD AND PLACE IT INTO A        */
*        /*  SUPPLIED BUFFER, RECONSTRUCTING THE ORIGINAL RECORD     */
*        /*  IF IT HAS BEEN SEGMENTED INTO SEVERAL RECORDS           */
*        /*                                                          */
*        /*  INPUT -                                                 */
*        /*    .GINVBUF - ADDR OF SUPPLIED BUFFER TO CONTAIN RECORD  */
*        /*    .GLENGTH - LENGTH OF ENTIRE RECORD                    */
*        /*                                                          */
*        /*  OUTPUT - A BUFFER CONTAINING THE ENTIRE RECORD          */
*        /*                                                          */
*        /************************************************************/
*                                                                  2492
*GETPROC: PROCEDURE (GINVBUF,          /*BUFFER TO CONTAIN RECORD    */
*                    GLENGTH);         /*LENGTH OF RECORD            */
*                                                                  2492
GETPROC  STM   @14,@12,@SA00020                                    2492
         MVC   @PC00020(8),0(@01)                                  2492
*        /************************************************************/
*        /*                                                          */
*        /*  ARGUMENTS OF INVOCATION                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  2493
*        DCL GINVBUF  PTR(31),                                     2493
*            GLENGTH  FIXED(15);                                   2493
*                                                                  2493
*        /************************************************************/
*        /*                                                          */
*        /*  LOCAL DECLARATIONS                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  2494
*        DCL GDOCNTRL BIT(1);                                      2494
*        DCL GMLEN  FIXED(15);                                     2495
*        DCL RDBUF PTR(31);            /*POINTER TO BUFFER POSITION  */
*                                      /*INTO WHICH DATA TO BE MOVED */
*        DCL RDLEN FIXED(15);          /*LENGTH OF DATA YET TO BE    */
*                                      /*READ                        */
*                                                                  2498
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE UGETS UNTIL ENTIRE RECORD HAS BEEN READ INTO CORE */
*        /*                                                          */
*        /************************************************************/
*                                                                  2498
*        RDBUF = GINVBUF;                                          2498
         L     @02,@PC00020                                        2498
         L     @02,GINVBUF(,@02)                                   2498
         ST    @02,RDBUF                                           2498
*        RDLEN= GLENGTH;                                           2499
         L     @15,@PC00020+4                                      2499
         LH    RDLEN,GLENGTH(,@15)                                 2499
*        GDOCNTRL = ON;                                            2500
*                                                                  2500
         OI    GDOCNTRL,B'10000000'                                2500
*READLOOP: DO WHILE (GDOCNTRL = ON);                               2501
READLOOP B     @DE02501                                            2501
@DL02501 DS    0H                                                  2502
*            IOCSPTR = PINIOCS;                                    2502
*                                                                  2502
         L     @15,PINIOCS                                         2502
         ST    @15,IOCSPTR                                         2502
*            CALL IDCIOGT0(GDTTBL,PINIOCS);                        2503
*                                                                  2503
         L     @15,@PC00001                                        2503
         ST    @15,@AL00001                                        2503
         LA    @14,PINIOCS                                         2503
         ST    @14,@AL00001+4                                      2503
         MVI   @AL00001+4,X'80'                                    2503
         L     @15,GDTGET(,@15)                                    2503
         LA    @01,@AL00001                                        2503
         BALR  @14,@15                                             2503
*            RESPECIFY RTNREG RSTD;                                2504
*            TESTRC = RTNREG;                                      2505
         LR    TESTRC,RTNREG                                       2505
*            RESPECIFY RTNREG UNRSTD;                              2506
*            IF TESTRC ^= 0                                        2507
*              THEN                                                2507
*                                                                  2507
         LTR   TESTRC,TESTRC                                       2507
         BZ    @RF02507                                            2507
*              /******************************************************/
*              /*                                                    */
*              /*  IF AN ERROR OR END OF DATA CONDITION IS           */
*              /*  RETURN TO THE CALLING PROCESSOR                   */
*              /*                                                    */
*              /******************************************************/
*                                                                  2508
*                IF TESTRC = 16                                    2508
*                  THEN                                            2508
         LA    @03,16                                              2508
         CR    TESTRC,@03                                          2508
         BNE   @RF02508                                            2508
*                    RETURN CODE(16);                              2509
         LR    @15,@03                                             2509
         L     @14,@SA00020                                        2509
         LM    @00,@12,@SA00020+8                                  2509
         BR    @14                                                 2509
*                  ELSE                                            2510
*                    RETURN CODE(LASTCC12);                        2510
@RF02508 LA    @15,12                                              2510
         L     @14,@SA00020                                        2510
         LM    @00,@12,@SA00020+8                                  2510
         BR    @14                                                 2510
*              ELSE;                                               2511
*                                                                  2511
@RF02507 DS    0H                                                  2512
*          /**********************************************************/
*          /*                                                        */
*          /*  MOVE DATA JUST READ IN INTO BUFFER                    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  2512
*          GMLEN = IOCDLN;                                         2512
*                                                                  2512
         L     @02,IOCSPTR                                         2512
         L     @15,IOCDLN(,@02)                                    2512
         STH   @15,GMLEN                                           2512
*          CALL MVDAPROC(GMLEN,IOCDAD,RDBUF);                      2513
*                                                                  2513
         LA    @15,GMLEN                                           2513
         ST    @15,@AL00001                                        2513
         ST    @02,@AL00001+4                                      2513
         LA    @02,RDBUF                                           2513
         ST    @02,@AL00001+8                                      2513
         LA    @01,@AL00001                                        2513
         BAL   @14,MVDAPROC                                        2513
*        /************************************************************/
*        /*                                                          */
*        /*  DETERMINE IF ALL RECORD SEGMENTS HAVE BEEN READ IN.     */
*        /*  IF SO, EXIT FROM LOOP.  IF NOT ADJUST LENGTH AND        */
*        /*  AND CONTINUE GETTING RECORDS.                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  2514
*          IF IOCDLN < RDLEN                                       2514
*            THEN                                                  2514
         L     @02,IOCSPTR                                         2514
         L     @02,IOCDLN(,@02)                                    2514
         CR    @02,RDLEN                                           2514
         BNL   @RF02514                                            2514
*              DO;                                                 2515
*              RDLEN = RDLEN - IOCDLN;                             2516
         SLR   RDLEN,@02                                           2516
*              RDBUF = RDBUF + IOCDLN;                             2517
         AL    @02,RDBUF                                           2517
         ST    @02,RDBUF                                           2517
*              END;                                                2518
*            ELSE                                                  2519
*              GDOCNTRL = OFF;                                     2519
         B     @RC02514                                            2519
@RF02514 NI    GDOCNTRL,B'01111111'                                2519
*        END READLOOP;                                             2520
*                                                                  2520
@RC02514 DS    0H                                                  2520
@DE02501 TM    GDOCNTRL,B'10000000'                                2520
         BO    @DL02501                                            2520
*        /************************************************************/
*        /*                                                          */
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */
*        /*                                                          */
*        /************************************************************/
*                                                                  2521
*        RETURN CODE(0);                                           2521
         SLR   @15,@15                                             2521
         L     @14,@SA00020                                        2521
         LM    @00,@12,@SA00020+8                                  2521
         BR    @14                                                 2521
*END GETPROC;                                                      2522
*END IDCMP01                                                       2523
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSMP )                                        *
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        *
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*;                                                                 2523
@DATA    DS    0H
@CH00288 DC    H'5'
@CH00040 DC    H'7'
@CH00038 DC    H'9'
@CH00037 DC    H'10'
@CH00036 DC    H'11'
@CH00629 DC    H'20'
@CH00701 DC    H'22'
@CH00705 DC    H'23'
@CH01096 DC    H'28'
@CH01098 DC    H'29'
@CH00605 DC    H'44'
@CH01655 DC    H'96'
@CH01157 DC    H'110'
@CH01163 DC    H'140'
@CH01662 DC    H'544'
@SM01687 MVC   ZAREA(0,ZPTR),ZER
@SM01692 MVC   FLISTVOL(0,@01),FLISTVOL(@05)
@SM01711 MVC   LKEY(0),LOWKYVAL(@14)
@SM01713 MVC   HKEY(0),HIKEYVAL(@02)
@SC01715 CLC   LKEY(0),LOWKYVAL(@14)
@SC01717 CLC   LKEY(0),HIKEYVAL(@15)
@SC01719 CLC   HKEY(0),LOWKYVAL(@01)
@SC01721 CLC   HKEY(0),HIKEYVAL(@05)
@SM01723 MVC   FKEY(0,FRANPTR1),LOWKYVAL(@05)
@SM01725 MVC   FKEY(0,FRANPTR1),HIKEYVAL(@04)
@SM01727 MVC   FKEY(0,FRANPTR1),FIELDR+2(RPTR1)
@SM01729 MVC   FKEY(0,FRANPTR1),FIELDR(@15)
@SM01733 MVC   TOAREA(0,MTPTR),FROMAREA(MFPTR)
@SM01735 MVC   FPASWD(0,@03),FIELDPS(DICENPTR)
@SM01737 MVC   FPASSPRM(0,@03),FIELDPS(DICENPTR)
@SM01739 MVC   FPASSATM(0,@03),FIELDPS(DICENPTR)
@SM01741 MVC   FUSVRMDU(0,@03),FIELDPS(DICENPTR)
@SM01743 MVC   FUSERARE(0,@03),FIELDPS(DICENPTR)
         DS    0F
@AL00531 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL00907 DC    A(@CC00823)             LIST WITH   5 ARGUMENT(S)
         DC    A(@CC00807)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL01133 DC    A(@CH00701)             LIST WITH   5 ARGUMENT(S)
         DC    A(@CC00811)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL01139 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL02145 DC    A(@CH00705)             LIST WITH   5 ARGUMENT(S)
         DC    A(@CF00035+3)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL01145 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL02139 DC    A(@CF00221+2)           LIST WITH   5 ARGUMENT(S)
         DC    A(@CC00807)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL01206 DC    A(@CF00165+2)           LIST WITH   5 ARGUMENT(S)
@AL01096 DC    A(@CH00037+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL01212 DC    A(@CF00312+2)           LIST WITH   5 ARGUMENT(S)
@AL01102 DC    A(@CH00036+1)           LIST WITH   1 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL01218 DC    A(@CF00625+2)           LIST WITH   5 ARGUMENT(S)
@AL01437 DC    A(@CC00811)             LIST WITH   4 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@AL02119 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL02120 DC    A(@CC01484)             LIST WITH   5 ARGUMENT(S)
@AL00512 DC    A(@CF00035+3)           LIST WITH   1 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(@CF00118)
         DC    A(@CF00118)
@AL02185 DC    A(@CF00156+2)           LIST WITH   5 ARGUMENT(S)
@AL00864 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01652 DC    A(@CC00807)             LIST WITH   3 ARGUMENT(S)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
         DC    A(NULLPARM)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00003 DS    15F
@SA00002 DS    15F
@SA00005 DS    15F
@PC00005 DS    5F
@SA00010 DS    15F
@PC00010 DS    1F
@SA00011 DS    14F
@PC00011 DS    6F
@SA00016 DS    15F
@PC00016 DS    1F
@PC00015 DS    3F
@SA00020 DS    15F
@PC00020 DS    2F
@SA00017 DS    15F
@PC00017 DS    3F
@SA00008 DS    15F
@PC00008 DS    4F
@SA00012 DS    15F
@PC00012 DS    4F
@SA00019 DS    15F
@PC00019 DS    4F
@SA00009 DS    15F
@PC00009 DS    1F
@SA00004 DS    15F
@SA00014 DS    15F
@SA00007 DS    15F
@SA00013 DS    15F
@PC00013 DS    6F
@SA00018 DS    15F
@PC00018 DS    3F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    9F
IDCMP01  CSECT
         DS    0F
@CF00118 DC    F'0'
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00156 DC    F'2'
@CH00156 EQU   @CF00156+2
@CF00165 DC    F'3'
@CH00165 EQU   @CF00165+2
@CF00045 DC    F'4'
@CH00045 EQU   @CF00045+2
@CF00159 DC    F'6'
@CH00159 EQU   @CF00159+2
@CF00039 DC    F'8'
@CH00039 EQU   @CF00039+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00625 DC    F'18'
@CH00625 EQU   @CF00625+2
@CF00312 DC    F'24'
@CH00312 EQU   @CF00312+2
@CF01151 DC    F'40'
@CH01151 EQU   @CF01151+2
@CF01384 DC    F'45'
@CH01384 EQU   @CF01384+2
@CF01653 DC    F'52'
@CF01153 DC    F'72'
@CF01155 DC    F'76'
@CF01161 DC    F'240'
@CF00634 DC    F'255'
@CF01667 DC    F'276'
@CF01674 DC    F'952'
@CF01290 DC    F'2048'
@CF01710 DC    F'-84'
@CF01706 DC    F'-41'
@CF01708 DC    F'-12'
@CF01731 DC    F'-8'
@CF01709 DC    F'-7'
@CF01694 DC    F'-6'
@CF01707 DC    F'-5'
@CF01689 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CTGPLPTR DS    A
CTGFVPTR DS    A
BLKSIZ   DS    F
TOTLEN   DS    F
FNMPTR   DS    A
PWORKAR  DS    A
PFVTPTR  DS    A
PTRCPL   DS    A
PPTRCPL  DS    A
DCPLPTR  DS    A
CPSWD    DS    A
PINIOCS  DS    A
POUTIOCS DS    A
PTRCTIOC DS    A
PTRCTACB DS    A
RANGINPT DS    A
RANGPORT DS    A
CONRCPTR DS    A
DICTPTR  DS    A
ALLPTR   DS    A
DALCINDX DS    F
INDX     DS    F
IX       DS    F
ACPLPTR  DS    A
LOOPCTR  DS    F
APSWD    DS    A
WSIZE    DS    F
VOLLSTPT DS    A
SIZENEED DS    F
RPTR2    DS    A
LOWLN    DS    F
RLCPLPTR DS    A
FPLADDR  DS    A
DALGLPTR DS    A
RDBUF    DS    A
FLISTPTR DS    A
LISTPTR  DS    A
LPSWD    DS    A
SAVFVTV  DS    A
SETRC    DS    H
TFVTLEN  DS    H
NUMCOMP  DS    H
NUMOBJ   DS    H
ENTNLN   DS    H
OUTDSNLN DS    H
CURSIZE  DS    H
GMLEN    DS    H
TOTLENH  DS    H
DEFSTID  DS    FL1
         DS    CL2
RLFNAME  DS    FL3
LISTLN   DS    FL1
@TS00001 DS    CL95
ERRORTAB DS    CL32
@NM00054 DS    CL10
         ORG   @NM00054
CATRTNID DS    CL8
CATLGRC  DS    FL2
         ORG   @NM00054+10
         DS    CL2
CATRCVWK DS    CL10
         ORG   CATRCVWK
RCVLN    DS    FL2
RCVRLN   DS    FL2
CATRCWKA DS    CL6
         ORG   CATRCVWK+10
PCOREFLG DS    BL1
SAVCPL   DS    CL28
PSAVCPL  DS    CL28
IMPFLG   DS    BL1
         ORG   IMPFLG
IMPUNIQ  DS    BL1
IMPINHTG EQU   IMPFLG+0
IMPASSOC EQU   IMPFLG+0
IMPBASE  EQU   IMPFLG+0
IMPNTUSD EQU   IMPFLG+0
         ORG   IMPFLG+1
KSDSFLAG DS    BL1
IMPFLG2  DS    BL1
         ORG   IMPFLG2
IMPF2VOL DS    BL1
IMPF2DEL EQU   IMPFLG2+0
IMPF2OBJ EQU   IMPFLG2+0
IMPF2NOD EQU   IMPFLG2+0
IMPF2NER EQU   IMPFLG2+0
IMPF2RES EQU   IMPFLG2+0
         ORG   IMPFLG2+1
         DS    CL2
CONRCARE DS    CL268
ALLLIST  DS    CL29
         DS    CL3
QUALLIST DS    CL12
         ORG   QUALLIST
QUALADDR DS    AL4
QUALCAT  DS    AL4
QUALPAS  DS    AL4
         ORG   QUALLIST+12
ENTNAM   DS    CL44
OUTDSNAM DS    CL44
DEALLOC  DS    BL1
UNIQD    DS    BL1
UNIQI    DS    BL1
EMPTYDS  DS    BL1
IUNIQFVT DS    CL92
ZCNTRL   DS    BL1
         DS    CL3
CNCTBLKS DS    CL120
         ORG   CNCTBLKS
CNCTCPL  DS    CL28
CNCTFVT  DS    CL92
         ORG   CNCTBLKS+120
LDOCNTRL DS    BL1
         DS    CL3
DELTWKA  DS    CL544
         ORG   DELTWKA
@NM00055 DS    FL2
@NM00056 DS    FL2
@NM00057 DS    12CL45
         ORG   DELTWKA+544
AFVT     DS    CL92
VOLLSTOR DS    CL10
DSAVCPL  DS    CL28
COREFLAG DS    BL1
         DS    CL1
OPENLIST DS    BL48
LKEY     DS    CL64
HKEY     DS    CL64
KERROR   DS    BL1
RSAVCPL  DS    CL28
DOCNTRL  DS    BL1
         DS    CL2
ALGLSAVE DS    CL20
         ORG   ALGLSAVE
ALSAVPTR DS    0A
         ORG   ALGLSAVE+20
GDOCNTRL DS    BL1
CDOCNTRL DS    BL1
DEFSTMOD DS    CL3
RDOCNTRL DS    BL1
RENEWCPL DS    CL28
         DS    CL2
PRINTTAB DS    9F
WORKAR   DS    3A
FVTPTR   DS    3A
SAVFVT   DS    3A
LCPLPTR  DS    3A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCMP01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
NULLPARM DC    A(0)
CFPLNUM  DC    H'12'
LNAMEDS  DC    H'4'
@CC01429 DC    C'CATLGRTN'
@CC01277 DC    C'MPBG'
@CC01283 DC    C'MPFN'
@CC01289 DC    C'MPCP'
@CC01294 DC    C'MPCT'
@CC01330 DC    C'MPPT'
@CC01338 DC    C'MPUC'
@CC01359 DC    C'MPDN'
@CC01389 DC    C'MPUQ'
@CC01415 DC    C'MPLV'
@CC01427 DC    C'MPSP'
@CC01428 DC    C'MPZZ'
@CC01455 DC    C'MPDL'
@CC01456 DC    C'MPDC'
@CC01463 DC    C'MPDD'
@CC01483 DC    C'MPOP'
@CC01536 DC    C'MPBF'
@CC01569 DC    C'MPMG'
@CC01582 DC    C'MPFV'
@CC01600 DC    C'MPPS'
@CC01630 DC    C'MPDA'
@CC01000 DC    C'MP0'
@CC01023 DC    C'UV0'
@CC01031 DC    C'DL0'
@CC01038 DC    C'DE0'
@CC01355 DC    C'XP0'
@CC00807 EQU   @CC01031
@CC00809 DC    C'I'
@CC00811 DC    C'A'
@CC00823 DC    C'F'
@CC01360 DC    C'L'
@CC01484 DC    C'O'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'MP01'
GPID     DC    CL4'MP01'
         DS    CL1
FIXAREA  DS    CL1024
         ORG   FIXAREA
@NM00044 DS    CL256
         ORG   @NM00044
@NM00045 DC    256X'00'
         ORG   FIXAREA+256
@NM00046 DS    CL256
         ORG   @NM00046
@NM00047 DC    256X'00'
         ORG   FIXAREA+512
@NM00048 DS    CL256
         ORG   @NM00048
@NM00049 DC    256X'00'
         ORG   FIXAREA+768
@NM00050 DS    CL256
         ORG   @NM00050
@NM00051 DC    256X'00'
         ORG   FIXAREA+1024
FPASNAME DC    CL8'PASSWALL'
FNDEVTYP DC    CL8'DEVTYP  '
CNTREPNO DC    CL8'CNTREPNO'
ZEROS    DC    X'00'
         DC    XL5'0'
ZER      DC    X'00'
         DC    XL255'0'
FFS      DS    CL64
         ORG   FFS
@NM00058 DC    64X'FF'
         ORG   FFS+64
DALCUNIT DS    CL12
         ORG   DALCUNIT
DL#UNIT  DC    H'1'
DLUNITLN DC    H'8'
DLUNIT   DC    CL8'SYSALLDA'
         ORG   DALCUNIT+12
FIELDLST DC    CL8'ENTYPE  '
         DC    CL8'ENTNAME '
         DC    CL8'DSATTR  '
         DC    CL8'OWNERID '
         DC    CL8'DSETCRDT'
         DC    CL8'DSETEXDT'
         DC    CL8'BUFSIZE '
         DC    CL8'LRECL   '
         DC    CL8'SPACPARM'
         DC    CL8'PASSWORD'
         DC    CL8'PASSPRMT'
         DC    CL8'PASSATMP'
         DC    CL8'USVRMDUL'
         DC    CL8'USERAREC'
         DC    CL8'LOKEYV  '
         DC    CL8'HIKEYV  '
         DC    CL8'VOLSER  '
         DC    CL8'AMDSBCAT'
         DC    CL8'EXCPEXIT'
         DC    CL8'RGATTR  '
         DC    CL8'SECFLAGS'
         DC    CL8'CATACB  '
         DC    CL8'NAMEDS  '
         DC    CL8'HURBADS '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RDLEN    EQU   @03
DICENPTR EQU   @02
FIELDPTR EQU   @02
M1SIZE   EQU   @02
MTPTR    EQU   @03
MFPTR    EQU   @04
HILN     EQU   @04
LENG     EQU   @03
RPTR1    EQU   @04
FRANPTR1 EQU   @02
KEYLENGH EQU   @02
PLIMIT   EQU   @04
LIMIT    EQU   @03
K        EQU   @02
IX1      EQU   @02
JX1      EQU   @03
JX       EQU   @02
NUMVOL   EQU   @04
FDEVTPTR EQU   @02
CPLPROCI EQU   @02
AMDSBPTR EQU   @03
ZPTR     EQU   @03
ZSIZE    EQU   @02
AFVTPTR  EQU   @04
J        EQU   @02
N        EQU   @03
I        EQU   @03
FX       EQU   @03
ENTRYNO  EQU   @03
DSCCATPT EQU   @02
CTGFLPTR EQU   @04
OPNPTR   EQU   @03
TESTRC   EQU   @02
RTNREG   EQU   @15
REG15    EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSACA0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSAQL0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLPWD   EQU   ALLAGL+20
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOGT0 EQU   0
IDCIOCO0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMSF EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNTYPXM EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODAX EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDEVDT EQU   OPNDEV
OPNREC   EQU   OPNAGL+32
OPNBLK   EQU   OPNAGL+36
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATAL  EQU   EROPER
EROSOPER EQU   ERCNVTAB+2
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
IN       EQU   0
INDS     EQU   0
INDSPLN  EQU   INDS
INDSPAS  EQU   INDS+1
INDSFLG  EQU   INDS+10
INDSFUQ  EQU   INDSFLG
INDSLEN  EQU   INDS+20
INDSVAL  EQU   INDS+21
OUTDD    EQU   0
OUTDDPLN EQU   OUTDD
OUTDDPAS EQU   OUTDD+1
OUTDDVAL EQU   OUTDD+10
OUTDS    EQU   0
OUTDSPLN EQU   OUTDS
OUTDSPAS EQU   OUTDS+1
OUTDSFLG EQU   OUTDS+10
OUTDSFUQ EQU   OUTDSFLG
OUTDSLEN EQU   OUTDS+20
OUTDSVAL EQU   OUTDS+21
PRG      EQU   0
ERAS     EQU   0
NERAS    EQU   0
OBJTS    EQU   0
OBJTSCNT EQU   0
OBJNMPTR EQU   0
OBJNM    EQU   0
OBJNMFLG EQU   OBJNM+10
OBJNMVAL EQU   OBJNM+21
NEWNMPTR EQU   0
NEWNM    EQU   0
NEWNMFLG EQU   NEWNM+10
NEWNMVAL EQU   NEWNM+21
OBJFLPTR EQU   0
OBJFL    EQU   0
OBJFLVAL EQU   OBJFL+1
LISTVPTR EQU   0
LISTV    EQU   0
LISTVCNT EQU   LISTV
@NM00032 EQU   LISTV+2
LISTVVAL EQU   @NM00032+1
RANGEPTR EQU   0
RANGECNT EQU   0
LOWKYPTR EQU   0
LOWKY    EQU   0
LOWKYLEN EQU   LOWKY
LOWKYVAL EQU   LOWKY+1
HIKEYPTR EQU   0
HIKEY    EQU   0
HIKEYLEN EQU   HIKEY
HIKEYVAL EQU   HIKEY+1
DEVTPTR  EQU   0
DEVT     EQU   0
DEVTCNT  EQU   DEVT
@NM00033 EQU   DEVT+2
DEVTVAL  EQU   @NM00033+1
ORDPTR   EQU   0
UNORDPTR EQU   0
CON      EQU   0
INDD     EQU   0
INDDVAL  EQU   INDD+10
ENV      EQU   0
BLKSZ    EQU   0
BLKSZVAL EQU   BLKSZ
PDEV     EQU   0
PDEVVAL  EQU   PDEV+1
RCSZE    EQU   0
RCSZEVAL EQU   RCSZE
CAT      EQU   0
CATPLN   EQU   CAT
CATPAS   EQU   CAT+1
CATFLG   EQU   CAT+10
CATVAL   EQU   CAT+21
IMPTY    EQU   0
SRAC     EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGBYPSS EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGRCATN EQU   CTGVMNT
CTGOVRID EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGNPROF EQU   CTGOPTN4
CTGENT   EQU   CTGPL+4
CTGFVT   EQU   CTGENT
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGTYPE  EQU   CTGPL+18
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGPSWD  EQU   CTGJSCB
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDNO EQU   CTGFL
CTGFLDCD EQU   CTGFL+1
CTGFLDRE EQU   CTGFL+3
CTGFLDWA EQU   CTGFL+4
CTGFLDNM EQU   CTGFL+8
CTGFLCHN EQU   CTGFL+12
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
CTGFV    EQU   0
CTGFVTYP EQU   CTGFV
CTGFVPRO EQU   CTGFV+1
CTGFVRON EQU   CTGFVPRO
CTGFVDCH EQU   CTGFV+4
CTGFVICH EQU   CTGFV+8
CTGFVVCH EQU   CTGFV+12
CTGFVIND EQU   CTGFV+16
CTGFVENT EQU   CTGFV+20
CTGFVSTY EQU   CTGFV+24
CTGFVOWN EQU   CTGFV+28
CTGFVEXP EQU   CTGFV+32
CTGFVCRE EQU   CTGFV+36
CTGFVVLT EQU   CTGFV+40
CTGFVRNG EQU   CTGFV+44
CTGFVDVT EQU   CTGFV+48
CTGFVSPC EQU   CTGFV+52
CTGFVAMD EQU   CTGFV+56
CTGFVATR EQU   CTGFV+60
CTGFVBUF EQU   CTGFV+64
CTGFVLRS EQU   CTGFV+68
CTGFVLMT EQU   CTGFV+72
CTGFVEXT EQU   CTGFVLMT
CTGFVGAT EQU   CTGFV+76
CTGFVUPG EQU   CTGFVGAT
CTGFVNAM EQU   CTGFV+80
CTGFVPWD EQU   CTGFV+84
CTGFVWKA EQU   CTGFV+88
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDORDER EQU   AMDATTR
AMDRRDS  EQU   AMDATTR
AMDLEN   EQU   IDAAMDSB+2
AMDNEST  EQU   IDAAMDSB+4
AMDAXRKP EQU   AMDNEST
AMDRKP   EQU   IDAAMDSB+6
AMDKEYLN EQU   IDAAMDSB+8
AMDPCTCA EQU   IDAAMDSB+10
AMDPCTCI EQU   IDAAMDSB+11
AMDCINV  EQU   IDAAMDSB+20
AMDLRECL EQU   IDAAMDSB+24
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
FIELDR   EQU   0
FENTYPE  EQU   0
FENTNAME EQU   0
FDSATTR  EQU   0
FDSUNIQ  EQU   FDSATTR
FDSINHUP EQU   FDSATTR
FDSTMPEX EQU   FDSATTR
FCATACB  EQU   0
FLVOLSER EQU   0
FIELDVR  EQU   0
FPASSWAL EQU   0
FPASWD   EQU   FPASSWAL
FPASSPRM EQU   FPASSWAL+32
FPASSATM EQU   FPASSWAL+40
FUSVRMDU EQU   FPASSWAL+42
FUSERARE EQU   FPASSWAL+50
FUSERLN  EQU   FUSERARE
FLISTVOL EQU   0
FLISTLN  EQU   FLISTVOL
FVOLSERL EQU   FLISTVOL+2
FVOLRTN  EQU   FVOLSERL
FVOLSER  EQU   FVOLSERL+2
FNAMEDS  EQU   0
FTYPE    EQU   FNAMEDS
FNAME    EQU   FNAMEDS+1
RCDSECF  EQU   0
RCDEXSEC EQU   RCDSECF
WORKAREA EQU   0
AREALN   EQU   WORKAREA
RETURNLN EQU   WORKAREA+2
ENTLIST  EQU   WORKAREA+4
ENTITEM  EQU   ENTLIST
ENTRYTYP EQU   ENTITEM
ENTRYNM  EQU   ENTITEM+1
CONREC   EQU   0
HEADER   EQU   CONREC
HEADLN   EQU   HEADER
HEADFLG1 EQU   HEADER+2
HEADFLG2 EQU   HEADER+3
ASSRECLN EQU   HEADER+4
VARDATA  EQU   CONREC+8
DICT     EQU   0
DICTEN   EQU   DICT+4
DICTLN   EQU   DICTEN
DICTDL   EQU   DICTEN+4
TIMESTMP EQU   0
TEXOJCT  EQU   TIMESTMP
TEXFLG   EQU   TIMESTMP+1
TIMEODAY EQU   TIMESTMP+4
TIMEDATE EQU   TIMESTMP+12
ZAREA    EQU   0
FHURBADS EQU   0
FDEV     EQU   0
FDEVTYP  EQU   FDEV
FDEVT    EQU   FDEVTYP
OIOCSPTR EQU   0
FRANGLST EQU   0
FRANGLN  EQU   FRANGLST
FRANGES  EQU   0
FKEYLN   EQU   FRANGES
FKEY     EQU   FRANGES+2
BFLIST   EQU   0
DSNAME   EQU   0
FROMAREA EQU   0
TOAREA   EQU   0
FIELDPS  EQU   0
FVTVLIST EQU   0
FVTVLEN  EQU   FVTVLIST
@NM00059 EQU   FVTVLIST+2
FVTVSER  EQU   @NM00059+2
ALCVLIST EQU   0
ALC#ENT  EQU   ALCVLIST
@NM00061 EQU   ALCVLIST+2
ALCVLEN  EQU   @NM00061
ALCVSER  EQU   @NM00061+2
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NPRG     EQU   0
NSRAC    EQU   0
ORD      EQU   0
RANGE    EQU   0
UNORD    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
CTYPE    EQU   0
CPTRCPL  EQU   0
CNAME    EQU   0
CINUM    EQU   0
CCPSWD   EQU   0
LX       EQU   0
LISTDICT EQU   0
LISTWKA  EQU   0
LFVTPTR  EQU   0
SCPLPTR  EQU   0
DLCPLPTR EQU   0
OTYPE    EQU   0
ODD      EQU   0
ODSN     EQU   0
OREC     EQU   0
OBLK     EQU   0
OIOCS    EQU   0
RX       EQU   0
RDICT    EQU   0
RWKA     EQU   0
RRANGPTR EQU   0
BFLISTPT EQU   0
BINDX    EQU   0
BFPLADDR EQU   0
BDICTPTR EQU   0
BWKAPTR  EQU   0
BFPLRTN  EQU   0
MSIZE    EQU   0
MF1PTR   EQU   0
MT1PTR   EQU   0
MNUM     EQU   0
FDICT    EQU   0
FWKA     EQU   0
FPTRFVT  EQU   0
BFPL     EQU   0
BDICT    EQU   0
BWKA     EQU   0
REQTYPE  EQU   0
DALVLPTR EQU   0
DALDNMPT EQU   0
DALINDEX EQU   0
GINVBUF  EQU   0
GLENGTH  EQU   0
@NM00038 EQU   CTGDDNM
CTGPROB  EQU   @NM00038
CTGREASN EQU   CTGPROB+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00060 EQU   @NM00059
FDRESV   EQU   FDEVTYP+8
TEXRESV  EQU   TIMESTMP+2
TEXBASE  EQU   TEXFLG
TEXASSOC EQU   TEXFLG
TEXINHTG EQU   TEXFLG
TEXUNIQ  EQU   TEXFLG
DICTNM   EQU   DICT
ASSRECNM EQU   HEADER+6
@NM00053 EQU   RCDSECF
FUSERVAL EQU   FUSERARE+2
FIELDCT  EQU   FIELDVR+2
FIELDLN  EQU   FIELDVR
FDSNTUSE EQU   FDSATTR+1
@NM00052 EQU   FDSATTR+1
FDSTROVF EQU   FDSATTR
FDSSHARE EQU   FDSATTR
FDSERASE EQU   FDSATTR
FDSRELSE EQU   FDSATTR
FDSSPEED EQU   FDSATTR
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00043 EQU   IDAAMDSB+41
@NM00042 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDSPAN  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
CTGFVCPP EQU   CTGFVPWD
CTGFVFSN EQU   CTGFVAMD
CTGFVTTR EQU   CTGFVSPC
@NM00041 EQU   CTGFV+3
CTGFVELM EQU   CTGFV+2
@NM00040 EQU   CTGFVPRO
CTGFVROF EQU   CTGFVPRO
CTGFVDRC EQU   CTGFVPRO
CTGFVNDC EQU   CTGFVPRO
CTGFVRVL EQU   CTGFVPRO
CTGFVAVL EQU   CTGFVPRO
CTGFLDTS EQU   CTGFLDRE
@NM00039 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
@NM00037 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
@NM00036 EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
@NM00035 EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00034 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGSWAP  EQU   CTGRCATN
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CATLEN   EQU   CAT+20
CATMEM   EQU   CAT+12
CATMLN   EQU   CAT+11
CATFUQ   EQU   CATFLG
CATPOS   EQU   CAT+9
PDEVLEN  EQU   PDEV
INDDLEN  EQU   INDD+9
INDDPAS  EQU   INDD+1
INDDPLN  EQU   INDD
DEVTLEN  EQU   @NM00033
LISTVLEN EQU   @NM00032
OBJFLLEN EQU   OBJFL
NEWNMLEN EQU   NEWNM+20
NEWNMMEM EQU   NEWNM+12
NEWNMMLN EQU   NEWNM+11
NEWNMFUQ EQU   NEWNMFLG
NEWNMPOS EQU   NEWNM+9
NEWNMPAS EQU   NEWNM+1
NEWNMPLN EQU   NEWNM
OBJNMLEN EQU   OBJNM+20
OBJNMMEM EQU   OBJNM+12
OBJNMMLN EQU   OBJNM+11
OBJNMFUQ EQU   OBJNMFLG
OBJNMPOS EQU   OBJNM+9
OBJNMPAS EQU   OBJNM+1
OBJNMPLN EQU   OBJNM
OUTDSMEM EQU   OUTDS+12
OUTDSMLN EQU   OUTDS+11
OUTDSPOS EQU   OUTDS+9
OUTDDLEN EQU   OUTDD+9
INDSMEM  EQU   INDS+12
INDSMLN  EQU   INDS+11
INDSPOS  EQU   INDS+9
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNDEVIX EQU   OPNDEV+4
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00578 EQU   @RC00575
@RF00617 EQU   @RC00613
@RF00632 EQU   @RC00628
@RF00721 EQU   @RC00699
@RF00724 EQU   @RC00699
@RF00765 EQU   @RC00743
@RF00768 EQU   @RC00743
@RC01174 EQU   @RC01173
@RF01268 EQU   @RC01250
@RF01620 EQU   @RC01580
@RF01619 EQU   @RC01580
@RF01626 EQU   @RC01580
@RC01730 EQU   @RC01727
@RF01898 EQU   @RC01896
@RC02162 EQU   @RC02127
@RF02426 EQU   @RC02393
@PB00020 EQU   @EL00001
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCMP01,(C'PLS1441',0701,78177)

         TITLE '************** IDCPR01: IDCAMS PRINT ROUTINE ***********
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCPR01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCPR01   77.067'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@12                                         0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0185
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO IDCPR01 - THIS IS THE ONLY ENTRY POINT    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0186
*        OLDERID2 = NEWERID2;                                      0186
         L     @10,@PC00001                                        0186
         L     @05,GDTTR2(,@10)                                    0186
         MVC   @TS00001(95),NEWERID2(@05)                          0186
         MVC   OLDERID2(95,@05),@TS00001                           0186
*        NEWID2 = 'PR11';                                          0187
*                                                                  0187
         MVC   NEWID2(4,@05),@CC00731                              0187
*        /************************************************************/
*        /*                                                          */
*        /* CONTROL FLAG VALUES AND PARAMETER LIST PTRS ARE SET      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0188
*        CYCLEFLG= GO;                                             0188
         MVI   CYCLEFLG,X'00'                                      0188
*        STATFLG=NORMAL;                                           0189
         MVC   STATFLG(5),@CB00670                                 0189
*        DDSTRU=ADDR(DARGL);                                       0190
         LA    @05,DARGL                                           0190
         ST    @05,DDSTRU                                          0190
*        DARGL = ''B;                                              0191
         XC    DARGL(28),DARGL                                     0191
*        OPRTFILE = NULLPTR;                                       0192
         SLR   @05,@05                                             0192
         ST    @05,OPRTFILE                                        0192
*        RECDPRCS = 0;                                             0193
         ST    @05,RECDPRCS                                        0193
*        RPIOERR = 0;                                              0194
*                                                                  0194
         SLR   RPIOERR,RPIOERR                                     0194
*        IOCSPTR = NULLPTR;                                  /*YM6244*/
         ST    @05,IOCSPTR                                         0195
*        IOCSALT = NULLPTR;                                  /*YM6244*/
*                                                                  0196
         ST    @05,IOCSALT                                         0196
*      INPUTVAL = INDSVAL;                                 /*@YL026UA*/
         L     @15,@PC00001+4                                      0197
         L     @15,FDTPTR+36(,@15)                                 0197
         MVC   INPUTVAL(44),INDSVAL(@15)                           0197
*      INPUTLEN = INDSLEN;                                 /*@YL026UA*/
*                                                                  0198
         SLR   @14,@14                                             0198
         IC    @14,INDSLEN(,@15)                                   0198
         STH   @14,INPUTLEN                                        0198
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /*  IF THE ENTRY IS NOT FULLY QUALIFIED - ISSUE     @YL026UA*/
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIER        */
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0199
*          IF INDSFUQ = ON & ADDR(INDS) ^= NULLPTR                 0199
*            THEN                                                  0199
         TM    INDSFUQ(@15),B'10000000'                            0199
         BNO   @RF00199                                            0199
         CR    @15,@05                                             0199
         BE    @RF00199                                            0199
*              DO;                                         /*@YL026UA*/
*                QUALLIST = ''B;                           /*@YL026UA*/
         XC    QUALLIST(12),QUALLIST                               0201
*                QUALADDR = ADDR(INPUTVAL);                /*@YL026UA*/
*                                                                  0202
         LA    @05,INPUTVAL                                        0202
         ST    @05,QUALADDR                                        0202
*                CALL IDCSAQL0(GDTTBL,QUALADDR,INPUTLEN,QUALCAT,QUALPAS
*;                                                                 0203
         ST    @10,@AL00001                                        0203
         LA    @05,QUALADDR                                        0203
         ST    @05,@AL00001+4                                      0203
         LA    @05,INPUTLEN                                        0203
         ST    @05,@AL00001+8                                      0203
         LA    @05,QUALCAT                                         0203
         ST    @05,@AL00001+12                                     0203
         LA    @05,QUALPAS                                         0203
         ST    @05,@AL00001+16                                     0203
         MVI   @AL00001+16,X'80'                                   0203
         L     @15,GDTQAL(,@10)                                    0203
         LA    @01,@AL00001                                        0203
         BALR  @14,@15                                             0203
*                                                          /*@YL026UA*/
*                RESPECIFY RTNREG RSTD;                            0204
*                TESTRC = RTNREG;                                  0205
         LR    TESTRC,RTNREG                                       0205
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/
*                IF TESTRC ^= 0                                    0207
*                  THEN                                            0207
         LTR   TESTRC,TESTRC                                       0207
         BZ    @RF00207                                            0207
*                    STATFLG = ABNTERM;                    /*@YL026UA*/
         MVC   STATFLG(5),@CB00679                                 0208
*              END;                                        /*@YL026UA*/
*                                                                  0209
@RF00207 DS    0H                                                  0210
*        IF STATFLG = NORMAL                                       0210
*          THEN                                                    0210
@RF00199 CLC   STATFLG(5),@CB00670                                 0210
         BNE   @RF00210                                            0210
*OPENS: DO;                                                /*@YL026UA*/
*                                                                  0211
OPENS    DS    0H                                                  0212
*        /************************************************************/
*        /*                                                          */
*        /* THE  OPENAGL, FOR THE DATA SET TO BE LISTED,  IS         */
*        /* CONSTRUCTED AT  THIS POINT THE IDCAMS I/O                */
*        /* ADAPTER OPENS THE INPUT DATA SET.  THE UOPEN MACRO       */
*        /* REQUESTS THIS SERVICE. THE OPNAGL PROVIDES INFORMATION   */
*        /* ABOUT THE DATA SET TO THE I/O ADAPTER                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0212
*        OPAGLST=''B;                  /* SET OPNAGL TO ZEROES       */
         XC    OPAGLST(48),OPAGLST                                 0212
*        OPNPTR=ADDR(OPAGLST);         /* SET POINTER TO OPNAGL      */
         LA    OPNPTR,OPAGLST                                      0213
*        OPNOPTIN=ON;                  /* OPEN FOR INPUT             */
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0214
*        OPNIOC=ADDR(IOCSPTR);         /* REFERENCE ADDR OF IOCSPTR  */
*                                                                  0215
         LA    @10,IOCSPTR                                         0215
         ST    @10,OPNIOC(,OPNPTR)                                 0215
*        /************************************************************/
*        /*                                                  @YL026UA*/
*        /* IF THE DATA SET WAS ALLOCATED VIA JCL, THE JCL   @YL026UA*/
*        /* STATEMENT DDNAME POINTER IS PLACED IN THE OPNAGL @YL026UA*/
*        /* OTHERWISE THE ADDRESS OF THE DSNAME AND AN OPTIONAL      */
*        /* PASSWORD ADDRESS ARE PLACED IN THE OPNAGL AND    @YL026UA*/
*        /* DYNAMIC ALLOCATION FOR THE DATA SET IS PERFORMED @YL026UA*/
*        /* BY THE UOPEN MACRO                               @YL026UA*/
*        /*                                                  @YL026UA*/
*        /************************************************************/
*                                                                  0216
*        IF INPDDLEN ^= 0 & ADDR(INDN) ^= NULLPTR                  0216
*          THEN                                                    0216
         L     @10,@PC00001+4                                      0216
         L     @05,FDTPTR+32(,@10)                                 0216
         CLI   INPDDLEN(@05),0                                     0216
         BE    @RF00216                                            0216
         L     @10,FDTPTR(,@10)                                    0216
         LTR   @10,@10                                             0216
         BZ    @RF00216                                            0216
*            OPNDDN = ADDR(INPDDVAL);  /*JCL STATEMENT PTR   @YL026UA*/
         LA    @10,INPDDVAL(,@05)                                  0217
         ST    @10,OPNDDN(,OPNPTR)                                 0217
*          ELSE                                                    0218
*            OPNDSN = ADDR(INPUTVAL);  /*OR DSNAME/PASS PTRS @YL026UA*/
*                                                                  0218
         B     @RC00216                                            0218
@RF00216 LA    @10,INPUTVAL                                        0218
         ST    @10,OPNDSN(,OPNPTR)                                 0218
*        /************************************************************/
*        /*                                                          */
*        /* IDENTIFY KEY OR RECORD NUMBER DELIMITER -        @Y30SSJH*/
*        /* UOPEN WILL VERIFY THAT THE DATA SET IS                   */
*        /* CONSISTENT WITH THIS DELIMITER.                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0219
*        IF (ADDR(FMKYC)  ^= NULLPTR  ×                    /*@Y30SSJH*/
*            ADDR(TOKYC)  ^= NULLPTR  ×                    /*@Y30SSJH*/
*            ADDR(FMNUM)  ^= NULLPTR  ×                    /*@Y30SSJH*/
*            ADDR(TONUM)  ^= NULLPTR   )                   /*@Y30SSJH*/
*          THEN                                                    0219
@RC00216 SLR   @10,@10                                             0219
         L     @05,@PC00001+4                                      0219
         C     @10,FDTPTR+8(,@05)                                  0219
         BNE   @RT00219                                            0219
         C     @10,FDTPTR+20(,@05)                                 0219
         BNE   @RT00219                                            0219
         C     @10,FDTPTR+116(,@05)                                0219
         BNE   @RT00219                                            0219
         C     @10,FDTPTR+120(,@05)                                0219
         BE    @RF00219                                            0219
@RT00219 DS    0H                                                  0220
*            OPNOPTKS = ON;                                        0220
*                                                                  0220
         OI    OPNOPTKS(OPNPTR),B'00001000'                        0220
*        /************************************************************/
*        /*                                                          */
*        /* IDENTIFY RBA DELIMITER - UOPEN WILL VERIFY THAT THE DATA */
*        /* SET IS CONSISTENT WITH THIS DELIMITER                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0221
*        IF (ADDR(FMRBA)  ^= NULLPTR  ×                    /*@Y30SSJH*/
*            ADDR(TORBA)  ^= NULLPTR  )                    /*@Y30SSJH*/
*          THEN                                                    0221
@RF00219 SLR   @10,@10                                             0221
         L     @05,@PC00001+4                                      0221
         C     @10,FDTPTR+12(,@05)                                 0221
         BNE   @RT00221                                            0221
         C     @10,FDTPTR+24(,@05)                                 0221
         BE    @RF00221                                            0221
@RT00221 DS    0H                                                  0222
*            OPNOPTCR = ON;                                        0222
*                                                                  0222
         OI    OPNOPTCR(OPNPTR),B'00000100'                        0222
*        /************************************************************/
*        /*                                                          */
*        /* THE PASSWORD OF THE INPUT DATA SET IS NOTED IN THE OPNAGL*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0223
*        IF ADDR(INPDD) ^= NULLPTR & INPDDPLN ^= 0                 0223
*          THEN                                                    0223
@RF00221 L     @10,@PC00001+4                                      0223
         L     @10,FDTPTR+32(,@10)                                 0223
         LTR   @10,@10                                             0223
         BZ    @RF00223                                            0223
         CLI   INPDDPLN(@10),0                                     0223
         BE    @RF00223                                            0223
*            OPNPWA = ADDR(INPDDPAS);                              0224
         LA    @10,INPDDPAS(,@10)                                  0224
         ST    @10,OPNPWA(,OPNPTR)                                 0224
*          ELSE                                                    0225
*            IF ADDR(INDS) ^= NULLPTR & INDSPLN ^= 0               0225
*              THEN                                                0225
         B     @RC00223                                            0225
@RF00223 L     @10,@PC00001+4                                      0225
         L     @10,FDTPTR+36(,@10)                                 0225
         LTR   @10,@10                                             0225
         BZ    @RF00225                                            0225
         CLI   INDSPLN(@10),0                                      0225
         BE    @RF00225                                            0225
*                OPNPWA = ADDR(INDSPAS);                   /*@YL026UA*/
         LA    @10,INDSPAS(,@10)                                   0226
         ST    @10,OPNPWA(,OPNPTR)                                 0226
*                                                                  0227
*        /************************************************************/
*        /*                                                          */
*        /* SPECIFY THE ENVIRONMENT ATTRIBUTES IN THE OPNAGL         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0227
*        IF (ADDR(IENV)) ^= NULLPTR                                0227
*          THEN                                                    0227
@RF00225 DS    0H                                                  0227
@RC00223 L     @10,@PC00001+4                                      0227
         L     @10,FDTPTR+60(,@10)                                 0227
         LTR   @10,@10                                             0227
         BZ    @RF00227                                            0227
*INPUTENV:   DO;                                                   0228
*                                                                  0228
INPUTENV DS    0H                                                  0229
*            /********************************************************/
*            /*                                                      */
*            /* SET RECORD FORMAT INDICATORS                         */
*            /*                                                      */
*            /********************************************************/
*            IF (ADDR(IRFMT)) ^= NULLPTR                           0229
*              THEN                                                0229
         L     @10,@PC00001+4                                      0229
         L     @10,FDTPTR+64(,@10)                                 0229
         LTR   @10,@10                                             0229
         BZ    @RF00229                                            0229
*INRECFMT:       DO;                                               0230
*                                                                  0230
INRECFMT DS    0H                                                  0231
*                /****************************************************/
*                /*                                                  */
*                /*  FIXED - UNBLOCKED                               */
*                /*                                                  */
*                /****************************************************/
*                IF (ADDR(IFUNB)) ^= NULLPTR                       0231
*                  THEN                                            0231
         L     @10,@PC00001+4                                      0231
         L     @10,FDTPTR+88(,@10)                                 0231
         LTR   @10,@10                                             0231
         BZ    @RF00231                                            0231
*                    OPNRFMFX = ON;                                0232
*                                                                  0232
         OI    OPNRFMFX(OPNPTR),B'10000000'                        0232
*                  /**************************************************/
*                  /*                                                */
*                  /*  FIXED - BLOCKED                               */
*                  /*                                                */
*                  /**************************************************/
*                  ELSE                                            0233
*                    IF (ADDR(IFBLK)) ^= NULLPTR                   0233
*                      THEN                                        0233
         B     @RC00231                                            0233
@RF00231 L     @10,@PC00001+4                                      0233
         L     @10,FDTPTR+92(,@10)                                 0233
         LTR   @10,@10                                             0233
         BZ    @RF00233                                            0233
*                        DO;                                       0234
*                                                                  0234
*                        OPNRFMFX = ON;                            0235
*                        OPNRFMBK = ON;                            0236
*                                                                  0236
         OI    OPNRFMFX(OPNPTR),B'10001000'                        0236
*                        END;                                      0237
*                                                                  0237
*                    /************************************************/
*                    /*                                              */
*                    /*  VARIABLE - UNBLOCKED                        */
*                    /*                                              */
*                    /************************************************/
*                      ELSE                                        0238
*                        IF (ADDR(IVUNB)) ^= NULLPTR               0238
*                          THEN                                    0238
         B     @RC00233                                            0238
@RF00233 L     @10,@PC00001+4                                      0238
         L     @10,FDTPTR+96(,@10)                                 0238
         LTR   @10,@10                                             0238
         BZ    @RF00238                                            0238
*                            OPNRFMVR = ON;                        0239
*                                                                  0239
*                                                                  0239
*                                                                  0239
         OI    OPNRFMVR(OPNPTR),B'01000000'                        0239
*            /********************************************************/
*            /*                                                      */
*            /*  VARIABLE - BLOCKED                                  */
*            /*                                                      */
*            /********************************************************/
*            ELSE                                                  0240
*              IF (ADDR(IVBLK)) ^= NULLPTR                         0240
*                THEN                                              0240
         B     @RC00238                                            0240
@RF00238 L     @10,@PC00001+4                                      0240
         L     @10,FDTPTR+100(,@10)                                0240
         LTR   @10,@10                                             0240
         BZ    @RF00240                                            0240
*                  DO;                                             0241
*                                                                  0241
*                  OPNRFMVR = ON;                                  0242
*                  OPNRFMBK = ON;                                  0243
*                                                                  0243
         OI    OPNRFMVR(OPNPTR),B'01001000'                        0243
*                  END;                                            0244
*                                                                  0244
*              /******************************************************/
*              /*                                                    */
*              /*  SPANNED - UNBLOCKED                               */
*              /*                                                    */
*              /******************************************************/
*                ELSE                                              0245
*                  IF (ADDR(ISUNB)) ^= NULLPTR                     0245
*                    THEN                                          0245
         B     @RC00240                                            0245
@RF00240 L     @10,@PC00001+4                                      0245
         L     @10,FDTPTR+104(,@10)                                0245
         LTR   @10,@10                                             0245
         BZ    @RF00245                                            0245
*                      OPNRFMSF = ON;                              0246
*                                                                  0246
         OI    OPNRFMSF(OPNPTR),B'00010000'                        0246
*                    /************************************************/
*                    /*                                              */
*                    /*  SPANNED - BLOCKED                           */
*                    /*                                              */
*                    /************************************************/
*                    ELSE                                          0247
*                      IF (ADDR(ISBLK)) ^= NULLPTR                 0247
*                        THEN                                      0247
         B     @RC00245                                            0247
@RF00245 L     @10,@PC00001+4                                      0247
         L     @10,FDTPTR+108(,@10)                                0247
         LTR   @10,@10                                             0247
         BZ    @RF00247                                            0247
*                          DO;                                     0248
*                                                                  0248
*                          OPNRFMSF = ON;                          0249
*                          OPNRFMBK = ON;                          0250
*                                                                  0250
         OI    OPNRFMSF(OPNPTR),B'00011000'                        0250
*                          END;                                    0251
*                                                                  0251
*                        /********************************************/
*                        /*                                          */
*                        /*       UNDEFINED                          */
*                        /*                                          */
*                        /********************************************/
*                        ELSE                                      0252
*                          IF (ADDR(IUNDF)) ^= NULLPTR             0252
*                            THEN                                  0252
         B     @RC00247                                            0252
@RF00247 L     @10,@PC00001+4                                      0252
         L     @10,FDTPTR+112(,@10)                                0252
         LTR   @10,@10                                             0252
         BZ    @RF00252                                            0252
*                              OPNRFMUN = ON;                      0253
         OI    OPNRFMUN(OPNPTR),B'00100000'                        0253
*              END INRECFMT;                                       0254
@RF00252 DS    0H                                                  0254
@RC00247 DS    0H                                                  0254
@RC00245 DS    0H                                                  0254
@RC00240 DS    0H                                                  0254
@RC00238 DS    0H                                                  0254
@RC00233 DS    0H                                                  0254
@RC00231 DS    0H                                                  0255
*                                                                  0255
*              /******************************************************/
*              /*                                                    */
*              /* SET BLOCKSIZE                                      */
*              /*                                                    */
*              /******************************************************/
*              IF (ADDR(IBKSZ)) ^= NULLPTR                         0255
*                THEN                                              0255
@RF00229 L     @10,@PC00001+4                                      0255
         L     @10,FDTPTR+68(,@10)                                 0255
         LTR   @10,@10                                             0255
         BZ    @RF00255                                            0255
*                  OPNBLK = IBKSZVAL;                              0256
*                                                                  0256
         L     @10,IBKSZVAL(,@10)                                  0256
         ST    @10,OPNBLK(,OPNPTR)                                 0256
*              /******************************************************/
*              /*                                                    */
*              /* SET RECORDSIZE                                     */
*              /*                                                    */
*              /******************************************************/
*              IF (ADDR(IRCSZ)) ^= NULLPTR                         0257
*                THEN                                              0257
@RF00255 L     @10,@PC00001+4                                      0257
         L     @10,FDTPTR+72(,@10)                                 0257
         LTR   @10,@10                                             0257
         BZ    @RF00257                                            0257
*                  OPNREC = IRCSZVAL;                              0258
*                                                                  0258
         L     @10,IRCSZVAL(,@10)                                  0258
         ST    @10,OPNREC(,OPNPTR)                                 0258
*              /******************************************************/
*              /*                                                    */
*              /* SET DEVICE TYPE OF HIGHEST INDEX LEVEL             */
*              /*                                                    */
*              /******************************************************/
*              IF (ADDR(IHDEV)) ^= NULLPTR                         0259
*                THEN                                              0259
@RF00257 L     @10,@PC00001+4                                      0259
         L     @10,FDTPTR+80(,@10)                                 0259
         LTR   @10,@10                                             0259
         BZ    @RF00259                                            0259
*                  OPNDEVIX = ADDR(IHDEVVAL);                      0260
*                                                                  0260
         LA    @10,IHDEVVAL(,@10)                                  0260
         ST    @10,OPNDEVIX(,OPNPTR)                               0260
*              /******************************************************/
*              /*                                                    */
*              /* SET DEVICE TYPE OF PRIME RECORD DATA SET           */
*              /*                                                    */
*              /******************************************************/
*              IF (ADDR(IPDEV)) ^= NULLPTR                         0261
*                THEN                                              0261
@RF00259 L     @10,@PC00001+4                                      0261
         L     @10,FDTPTR+84(,@10)                                 0261
         LTR   @10,@10                                             0261
         BZ    @RF00261                                            0261
*                  OPNDEVDT = ADDR(IPDEVVAL);                      0262
*                                                                  0262
         LA    @10,IPDEVVAL(,@10)                                  0262
         ST    @10,OPNDEVDT(,OPNPTR)                               0262
*            END INPUTENV;                                         0263
@RF00261 DS    0H                                                  0264
*                                                                  0264
*        /************************************************************/
*        /*                                                          */
*        /* OPEN THE INPUT DATA SET                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0264
*        CALL IDCIOOP0(GDTTBL,OPNAGL);                             0264
@RF00227 L     @10,@PC00001                                        0264
         ST    @10,@AL00001                                        0264
         ST    OPNPTR,@AL00001+4                                   0264
         MVI   @AL00001+4,X'80'                                    0264
         L     @15,GDTOPN(,@10)                                    0264
         LA    @01,@AL00001                                        0264
         BALR  @14,@15                                             0264
*        RESPECIFY RTNREG RSTD;                                    0265
*        TESTRC = RTNREG;                                          0266
         LR    TESTRC,RTNREG                                       0266
*        RESPECIFY RTNREG UNRSTD;                                  0267
*                                                                  0267
*        IF TESTRC = 0                                             0268
*          THEN                                                    0268
         LTR   TESTRC,TESTRC                                       0268
         BNZ   @RF00268                                            0268
*            DO;                                                   0269
*                                                                  0269
*            /********************************************************/
*            /*                                                      */
*            /* INVOKE DELIMSET TO ESTABLISH THE DELIMITERS TO THE   */
*            /* DATA SET -                                           */
*            /*  FROM DELIMITERS ARE ESTABLISHED BY POSITIONING VIA  */
*            /*    A UPOSIT OR SKIP ROUTINE                          */
*            /*  TO DELIMITERS ARE INDICATED BY THE SETTINGS OF      */
*            /*    DELIMFLG OR LOOPINCR                              */
*            /*                                                      */
*            /********************************************************/
*            CALL DELIMSET(DELIMFLG,LOOPCNT,LOOPINCR);             0270
*                                                                  0270
         LA    @10,DELIMFLG                                        0270
         ST    @10,@AL00001                                        0270
         LA    @10,LOOPCNT                                         0270
         ST    @10,@AL00001+4                                      0270
         LA    @10,LOOPINCR                                        0270
         ST    @10,@AL00001+8                                      0270
         LA    @01,@AL00001                                        0270
         BAL   @14,DELIMSET                                        0270
*            END;                                                  0271
*                                                                  0271
*          /**********************************************************/
*          /*                                                        */
*          /* CANNOT OPEN - TERMINAL ERROR                           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0272
*          ELSE                                                    0272
*            DO;                                           /*@Y30SSJH*/
*                                                                  0272
         B     @RC00268                                            0272
@RF00268 DS    0H                                                  0273
*            STATFLG = ABNTERM;                                    0273
*                                                                  0273
         MVC   STATFLG(5),@CB00679                                 0273
*            END;                                                  0274
*        /************************************************************/
*        /*                                                          */
*        /* OPEN ALTERNATE PRINT FILE FOR LISTING OUTPUT. THE AMS    */
*        /* I/O ADAPTER OPENS THE FILE VIA THE UOPEN MACRO. THE      */
*        /* OPAGLST IS CONSTRUCTED BY IDCPR01 TO COMMUNICATE THE     */
*        /* REQUEST TO THE I/O ADAPTER                               */
*        /*                                                          */
*        /************************************************************/
*        IF (ADDR(OUTDD)) ^= NULLPTR                               0275
*          THEN                                                    0275
@RC00268 L     @10,@PC00001+4                                      0275
         L     @10,FDTPTR+4(,@10)                                  0275
         LTR   @10,@10                                             0275
         BZ    @RF00275                                            0275
*            DO;                                                   0276
*                                                                  0276
*            OPNPTR = ADDR(OPAGLST);   /* SET POINTER TO OPNAGL      */
         LA    OPNPTR,OPAGLST                                      0277
*            OPNAGL = ''B;             /* SET OPNAGL TO ZEROES       */
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0278
*            OPNOPTOT = ON;            /* OPEN FOR OUTPUT            */
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0279
*            OPNMODAC = ON;            /* SET CARRIAGE CONTROL       */
         OI    OPNMODAC(OPNPTR),B'01000000'                        0280
*            OPNDDN = ADDR(OUTDDVAL);  /* NAME OF OUTFILE JCL STATMNT*/
         LA    @10,OUTDDVAL(,@10)                                  0281
         ST    @10,OPNDDN(,OPNPTR)                                 0281
*            OPNIOC = ADDR(IOCSALT);   /* ADDR OF IOCS POINTER       */
*                                                                  0282
         LA    @10,IOCSALT                                         0282
         ST    @10,OPNIOC(,OPNPTR)                                 0282
*            CALL IDCIOOP0 (GDTTBL,OPNAGL);                        0283
         L     @10,@PC00001                                        0283
         ST    @10,@AL00001                                        0283
         ST    OPNPTR,@AL00001+4                                   0283
         MVI   @AL00001+4,X'80'                                    0283
         L     @15,GDTOPN(,@10)                                    0283
         LA    @01,@AL00001                                        0283
         BALR  @14,@15                                             0283
*            RESPECIFY RTNREG RSTD;                                0284
*            TESTRC = RTNREG;                                      0285
         LR    TESTRC,RTNREG                                       0285
*            RESPECIFY RTNREG UNRSTD;                              0286
*                                                                  0286
*            /********************************************************/
*            /*                                                      */
*            /* THE ALTERNATE FILE IS OPEN SET THE IOCS POINTER OF   */
*            /* THE ALTERNATE FILE IN OPRTFILE FOR UPRINT INVOCATION */
*            /*                                                      */
*            /********************************************************/
*                                                                  0287
*            IF TESTRC = 0                                         0287
*              THEN                                                0287
         LTR   TESTRC,TESTRC                                       0287
         BNZ   @RF00287                                            0287
*                OPRTFILE = IOCSALT;                               0288
*                                                                  0288
         L     @10,IOCSALT                                         0288
         ST    @10,OPRTFILE                                        0288
*              /******************************************************/
*              /*                                                    */
*              /* OPEN OF ALTERNATE OUTPUT FILE WAS UNSUCCESSFUL -   */
*              /* SET STATFLG TO TERMINATE PROCESSING                */
*              /*                                                    */
*              /******************************************************/
*                                                                  0289
*              ELSE                                                0289
*                STATFLG = ABNTERM;                                0289
*                                                                  0289
         B     @RC00287                                            0289
@RF00287 MVC   STATFLG(5),@CB00679                                 0289
*            END;                                                  0290
@RC00287 DS    0H                                                  0291
*      END OPENS;                                          /*@YL026UA*/
*                                                                  0291
@RF00275 DS    0H                                                  0292
*        /************************************************************/
*        /*                                                          */
*        /* THE TEXT PROCESSOR PAGE LAYOUT AND RECORD LAYOUT IS      */
*        /* ESTABLISHED AT THIS POINT                                */
*        /* TEXTPSET ESTABLISHES THE PAGE LAYOUT AND BUILDS THE      */
*        /* DARGLST FOR THE RECORD LAYOUT(EXCLUDING DYNAMIC PORTIONS)*/
*        /*                                                          */
*        /************************************************************/
*                                                                  0292
*        IF STATFLG = NORMAL                                       0292
*          THEN                                                    0292
*                                                                  0292
@RF00210 CLC   STATFLG(5),@CB00670                                 0292
         BNE   @RF00292                                            0292
*            CALL TEXTPSET;                                        0293
*                                                                  0293
         BAL   @14,TEXTPSET                                        0293
*        /************************************************************/
*        /*                                                          */
*        /* THE RECORD RETRIEVAL - PRINT CYCLE ENSUES AT THIS POINT  */
*        /*  RECORDS ARE RETRIEVED VIA UGET- DELIMITER BOUNDS ARE    */
*        /*  CHECKED AND THEN THE RECORD IS PRINTED VIA THE UPRINT   */
*        /*  MACRO INTERFACE                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0294
*        CYCLEFLG = GO;                                            0294
*                                                                  0294
@RF00292 MVI   CYCLEFLG,X'00'                                      0294
*        /************************************************************/
*        /*                                                          */
*        /* INITIALIZE KEY LENGTH USED IN DETERMINING THE ENDING     */
*        /* SUBSET BOUNDARY - THE LENGTH MUST BE THE MINIMUM OF THE  */
*        /* VALUES SPECIFIED BY THE USER VERSUS THAT IN THE IOCS     */
*        /*                                                          */
*        /************************************************************/
*                                                                  0295
*        IF DELIMFLG = TOKYPOST                                    0295
*          THEN                                                    0295
         CLI   DELIMFLG,X'02'                                      0295
         BNE   @RF00295                                            0295
*            ENDKYLN = MIN(TOKYCLEN,IOCKYL);                       0296
*                                                                  0296
         L     @10,@PC00001+4                                      0296
         L     @10,FDTPTR+20(,@10)                                 0296
         SLR   @05,@05                                             0296
         IC    @05,TOKYCLEN(,@10)                                  0296
         L     @10,IOCSPTR                                         0296
         SLR   @15,@15                                             0296
         IC    @15,IOCKYL(,@10)                                    0296
         CR    @05,@15                                             0296
         BNH   *+6
         LR    @05,@15                                             0296
         ST    @05,ENDKYLN                                         0296
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* IF THE DATA SET IS RELATIVE RECORD,INITIALIZE    @Y30SSJH*/
*        /* OLDREL TO POINT TO THE SLOT PRIOR TO WHERE       @Y30SSJH*/
*        /* PRINTING IS TO START.                            @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0297
*        IF ( IOCMACRR = ON  &                                     0297
*             ADDR(COUNT) ^= NULLPTR  )                            0297
*          THEN                                                    0297
@RF00295 L     @10,IOCSPTR                                         0297
         TM    IOCMACRR(@10),B'00100000'                           0297
         BNO   @RF00297                                            0297
         SLR   @10,@10                                             0297
         L     @05,@PC00001+4                                      0297
         C     @10,FDTPTR+28(,@05)                                 0297
         BE    @RF00297                                            0297
*            DO;                                           /*@Y30SSLO*/
*                                                                  0298
*            IF ADDR(SKIP) ^= NULLPTR                              0299
*              THEN                                                0299
         L     @05,FDTPTR+16(,@05)                                 0299
         CR    @05,@10                                             0299
         BE    @RF00299                                            0299
*                OLDREL = SKIPVAL ;                        /*@Y30SSJH*/
         L     @10,SKIPVAL(,@05)                                   0300
         ST    @10,OLDREL                                          0300
*              ELSE                                                0301
*                IF ADDR(FMNUM) ^= NULLPTR                         0301
*                  THEN                                            0301
         B     @RC00299                                            0301
@RF00299 L     @10,@PC00001+4                                      0301
         L     @10,FDTPTR+116(,@10)                                0301
         LTR   @10,@10                                             0301
         BZ    @RF00301                                            0301
*                    OLDREL = FMNUMVAL - 1;                /*@Y30SSJH*/
         L     @10,FMNUMVAL(,@10)                                  0302
         BCTR  @10,0                                               0302
         ST    @10,OLDREL                                          0302
*                  ELSE                                            0303
*                    OLDREL = 0;                           /*@Y30SSJH*/
*                                                                  0303
         B     @RC00301                                            0303
@RF00301 SLR   @10,@10                                             0303
         ST    @10,OLDREL                                          0303
*            END;                                          /*@Y30SSJH*/
*                                                                  0304
@RC00301 DS    0H                                                  0304
@RC00299 DS    0H                                                  0305
*        IF STATFLG = NORMAL                                       0305
*          THEN                                                    0305
*                                                                  0305
@RF00297 CLC   STATFLG(5),@CB00670                                 0305
         BNE   @RF00305                                            0305
*            /********************************************************/
*            /*                                                      */
*            /* PRTLOOPA CONTROLS THE RETRIEVAL AND PRINTING OF RECDS*/
*            /* . LOOPCNT AND LOOPINCR CONTROL THIS LOOP WHEN A      */
*            /*   COUNT DELIMITER IS SPECIFIED.                      */
*            /* . CYCLEFLG CONTROLS LOOP EXIT FOR ENDING RBA, KEY    */
*            /*   AND END OF FILE DELIMITERS.                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0306
* PRTLOOPA:  DO N = 1 TO LOOPCNT BY LOOPINCR                       0306
*               WHILE CYCLEFLG = GO;                               0306
*                                                                  0306
PRTLOOPA LA    N,1                                                 0306
         B     @DE00306                                            0306
@DL00306 CLI   CYCLEFLG,X'00'                                      0306
         BNE   @DC00306                                            0306
*            /********************************************************/
*            /*                                                      */
*            /*  RETRIEVE RECORD FROM INPUT DATA SET                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  0307
*            CALL IDCIOGT0 (GDTTBL,IOCSPTR);                       0307
         L     @10,@PC00001                                        0307
         ST    @10,@AL00001                                        0307
         LA    @05,IOCSPTR                                         0307
         ST    @05,@AL00001+4                                      0307
         MVI   @AL00001+4,X'80'                                    0307
         L     @15,GDTGET(,@10)                                    0307
         LA    @01,@AL00001                                        0307
         BALR  @14,@15                                             0307
*            RESPECIFY RTNREG RSTD;                                0308
*            TESTRC = RTNREG;                                      0309
         LR    TESTRC,RTNREG                                       0309
*            RESPECIFY RTNREG UNRSTD;                              0310
*                                                                  0310
*            IF TESTRC = 0                                         0311
*              THEN                                                0311
         LTR   TESTRC,TESTRC                                       0311
         BNZ   @RF00311                                            0311
* PRTLOOPB:      DO;                                               0312
*                                                                  0312
PRTLOOPB DS    0H                                                  0313
*                /****************************************************/
*                /*                                                  */
*                /* INSURE ENDING RBA DELIMITER HAS NOT BEEN EXCEEDED*/
*                /*                                                  */
*                /****************************************************/
*                                                                  0313
*                IF DELIMFLG = TORBAPOS                            0313
*                  THEN                                            0313
         CLI   DELIMFLG,X'03'                                      0313
         BNE   @RF00313                                            0313
*                    DO;                                           0314
*                                                                  0314
*                    IF IOCRBA > TORBAVAL                          0315
*                      THEN                                        0315
         L     @10,@PC00001+4                                      0315
         L     @10,FDTPTR+24(,@10)                                 0315
         L     @05,IOCSPTR                                         0315
         L     @05,IOCRBA(,@05)                                    0315
         C     @05,TORBAVAL(,@10)                                  0315
         BNH   @RF00315                                            0315
*                        CYCLEFLG = STOP;                          0316
*                                                                  0316
         MVI   CYCLEFLG,X'0F'                                      0316
*                    END;                                          0317
*                                                                  0318
*                  /**************************************************/
*                  /*                                                */
*                  /* VERIFY THAT ENDING KEY DELIMITER HAS NOT BEEN  */
*                  /* EXCEEDED                                       */
*                  /*                                                */
*                  /**************************************************/
*                  ELSE                                            0318
*                    IF DELIMFLG = TOKYPOST                        0318
*                      THEN                                        0318
         B     @RC00313                                            0318
@RF00313 CLI   DELIMFLG,X'02'                                      0318
         BNE   @RF00318                                            0318
*                        DO;                                       0319
*                                                                  0319
*                        IF TOKYCVAL < RECDKEY(1 : ENDKYLN)        0320
*                          THEN                                    0320
         L     @10,@PC00001+4                                      0320
         L     @10,FDTPTR+20(,@10)                                 0320
         L     @05,IOCSPTR                                         0320
         L     @05,IOCKYA(,@05)                                    0320
         L     @02,ENDKYLN                                         0320
         BCTR  @02,0                                               0320
         EX    @02,@SC00814                                        0320
         BNL   @RF00320                                            0320
*                            CYCLEFLG = STOP;                      0321
*                                                                  0321
         MVI   CYCLEFLG,X'0F'                                      0321
*                        END;                                      0322
*                                                                  0322
*                    /************************************************/
*                    /* VERIFY THAT ENDING RELATIVE          @Y30SSJH*/
*                    /* RECORD NUMBER HAS NOT BEEN           @Y30SSJH*/
*                    /* EXCEEDED.                            @Y30SSJH*/
*                    /*                                      @Y30SSJH*/
*                    /************************************************/
*                    ELSE                                          0323
*                      IF DELIMFLG = TORRNPOS                      0323
*                        THEN                                      0323
         B     @RC00318                                            0323
@RF00318 CLI   DELIMFLG,X'04'                                      0323
         BNE   @RF00323                                            0323
*                          DO;                             /*@Y30SSJH*/
*                                                                  0324
*                          IF IOCREL > TONUMVAL            /*@Y30SSJH*/
*                            THEN                                  0325
         L     @10,@PC00001+4                                      0325
         L     @10,FDTPTR+120(,@10)                                0325
         L     @05,IOCSPTR                                         0325
         L     @05,IOCREL(,@05)                                    0325
         C     @05,TONUMVAL(,@10)                                  0325
         BNH   @RF00325                                            0325
*                              CYCLEFLG = STOP;            /*@Y30SSJH*/
*                                                                  0326
         MVI   CYCLEFLG,X'0F'                                      0326
*                          END;                            /*@Y30SSJH*/
*                                                                  0327
*                        /********************************************/
*                        /*                                  @Y30SSJH*/
*                        /* IF COUNT SPECIFIED WITH RELA-    @Y30SSJH*/
*                        /* TIVE RECORD DATA SET, PRINTING   @Y30SSJH*/
*                        /* STOPS WHEN THE NUMBER OF VALID   @Y30SSJH*/
*                        /* RECORD SLOTS PRINTED PLUS THE    @Y30SSJH*/
*                        /* NUMBER OF INVALID SLOTS BYPASSED @Y30SSJH*/
*                        /* EXCEEDS COUNTVAL.                @Y30SSJH*/
*                        /*                                  @Y30SSJH*/
*                        /********************************************/
*                        ELSE                                      0328
*                          IF IOCMACRR = ON   &                    0328
*                             ADDR(COUNT) ^=  NULLPTR              0328
*                            THEN                                  0328
         B     @RC00323                                            0328
@RF00323 L     @10,IOCSPTR                                         0328
         TM    IOCMACRR(@10),B'00100000'                           0328
         BNO   @RF00328                                            0328
         L     @05,@PC00001+4                                      0328
         L     @05,FDTPTR+28(,@05)                                 0328
         LTR   @05,@05                                             0328
         BZ    @RF00328                                            0328
*                              DO;                         /*@Y30SSJH*/
*                                                                  0329
*                              N = N + IOCREL - OLDREL - 1;/*@Y30SSJH*/
         L     @10,IOCREL(,@10)                                    0330
         LR    @05,N                                               0330
         ALR   @05,@10                                             0330
         SL    @05,OLDREL                                          0330
         BCTR  @05,0                                               0330
         LR    N,@05                                               0330
*                              OLDREL = IOCREL;            /*@Y30SSJH*/
         ST    @10,OLDREL                                          0331
*                              IF N > LOOPCNT                      0332
*                                THEN                              0332
         C     N,LOOPCNT                                           0332
         BNH   @RF00332                                            0332
*                                  CYCLEFLG = STOP;        /*@Y30SSJH*/
         MVI   CYCLEFLG,X'0F'                                      0333
*                                ELSE;                     /*@Y30SSJH*/
*                                                                  0334
@RF00332 DS    0H                                                  0335
*                              END;                        /*@Y30SSJH*/
*                /****************************************************/
*                /*                                                  */
*                /* PRINT THE RECORD - THE DARGLIST IS INITIALIZED   */
*                /* TO REFERENCE THE ADDRESS(DARGDBP) AND LENGTH (IN */
*                /* (DARGRETP) OF THE DATA TO BE PRINTED AND SET     */
*                /* DDSTRU TO INDICATE DARGFULL LENGTH. DARGDTM IS   */
*                /* SET TO THE ADDRESS OF THE DATA HEADER    @Y30SSJH*/
*                /* KEY, RELATIVE RECORD NUMBER, OR RECORD   @Y30SSJH*/
*                /* SEQUENCE NUMBER - THE KEY ADDRESS IS SET @Y30SSJH*/
*                /* DYNAMICALLY IN THIS LOOP WHILE THE ADDRESS OF THE*/
*                /* RELATIVE RECORD NUMBER AND RECORD        @Y30SSJH*/
*                /* SEQUENCE NUMBER IS SET IN TEXTPSET.      @Y30SSJH*/
*                /*                                                  */
*                /****************************************************/
*                                                                  0336
*                IF CYCLEFLG = GO                                  0336
*                  THEN                                            0336
@RF00328 DS    0H                                                  0336
@RC00323 DS    0H                                                  0336
@RC00318 DS    0H                                                  0336
@RC00313 CLI   CYCLEFLG,X'00'                                      0336
         BNE   @RF00336                                            0336
* PRTLOOPC:          DO;                                           0337
*                                                                  0337
PRTLOOPC DS    0H                                                  0338
*                    DARGDBP = IOCDAD;                             0338
         L     @10,DDSTRU                                          0338
         L     @05,IOCSPTR                                         0338
         L     @02,IOCDAD(,@05)                                    0338
         ST    @02,DARGDBP(,@10)                                   0338
*                    DARGRETP = IOCDLN;                    /*@OZ14818*/
         L     @05,IOCDLN(,@05)                                    0339
         ST    @05,DARGRETP(,@10)                                  0339
*                    DARGFULL = ON;                        /*@OZ14818*/
*                                                                  0340
         OI    DARGFULL(@10),B'10000000'                           0340
*                    /************************************************/
*                    /*                                              */
*                    /* THE ADDRESS OF THE RECORD KEY FOR THE DATA   */
*                    /* HEADER IS SET DYNAMICALLY IN THE LOOP. THIS  */
*                    /* INDICATES TO THE TEXT PROCESSOR THE KEY      */
*                    /* LOCATION                                     */
*                    /*                                              */
*                    /************************************************/
*                                                                  0341
*                    IF (DARGSENT = 6  ×                   /*@Y30SSJH*/
*                        DARGSENT = 2  ×                           0341
*                        DARGSENT = 10 )                   /*@Y30SSJH*/
*                      THEN                                        0341
         CLI   DARGSENT(@10),6                                     0341
         BE    @RT00341                                            0341
         CLI   DARGSENT(@10),2                                     0341
         BE    @RT00341                                            0341
         CLI   DARGSENT(@10),10                                    0341
         BNE   @RF00341                                            0341
@RT00341 DS    0H                                                  0342
*                        DARGDTM(1) = IOCKYA;                      0342
*                                                                  0342
         L     @10,IOCSPTR                                         0342
         L     @10,IOCKYA(,@10)                                    0342
         L     @05,DDSTRU                                          0342
         ST    @10,DARGDTM(,@05)                                   0342
*                    CALL AMSTP011 (GDTTBL,OPRTFILE,DDSTRU);       0343
@RF00341 L     @10,@PC00001                                        0343
         ST    @10,@AL00001                                        0343
         LA    @05,OPRTFILE                                        0343
         ST    @05,@AL00001+4                                      0343
         LA    @05,DDSTRU                                          0343
         ST    @05,@AL00001+8                                      0343
         MVI   @AL00001+8,X'80'                                    0343
         L     @15,GDTPRT(,@10)                                    0343
         LA    @01,@AL00001                                        0343
         BALR  @14,@15                                             0343
*                    RESPECIFY RTNREG RSTD;                        0344
*                    TESTRC = RTNREG;                              0345
         LR    TESTRC,RTNREG                                       0345
*                    RESPECIFY RTNREG UNRSTD;                      0346
*                                                                  0346
*                    /************************************************/
*                    /*                                              */
*                    /* TERMINAL UPRINT ERROR                        */
*                    /*                                              */
*                    /************************************************/
*                                                                  0347
*                    IF TESTRC >= 12                               0347
*                      THEN                                        0347
         C     TESTRC,@CF00570                                     0347
         BL    @RF00347                                            0347
*                        DO;                                       0348
*                                                                  0348
*                        STATFLG = ABNTERM;                        0349
         MVC   STATFLG(5),@CB00679                                 0349
*                        CYCLEFLG = STOP;                          0350
*                                                                  0350
         MVI   CYCLEFLG,X'0F'                                      0350
*                        END;                                      0351
*                                                                  0352
*                      ELSE                                        0352
*                                                                  0352
*                        /********************************************/
*                        /*                                          */
*                        /* PRINT WAS SUCCESSFUL - BUMP COUNT OF     */
*                        /* RECORDS PRINTED                          */
*                        /*                                          */
*                        /********************************************/
*                                                                  0352
*                        IF TESTRC = 0                             0352
*                          THEN                                    0352
         B     @RC00347                                            0352
@RF00347 LTR   TESTRC,TESTRC                                       0352
         BNZ   @RF00352                                            0352
*                            RECDPRCS = RECDPRCS + 1;              0353
*                                                                  0353
         LA    @10,1                                               0353
         AL    @10,RECDPRCS                                        0353
         ST    @10,RECDPRCS                                        0353
*                          /******************************************/
*                          /*                                        */
*                          /* NON TERMINAL UPRINT ERROR - CONTINUE   */
*                          /* PROCESSING                             */
*                          /*                                        */
*                          /******************************************/
*                                                                  0354
*                          ELSE                                    0354
*                            DO;                                   0354
*                                                                  0354
         B     @RC00352                                            0354
@RF00352 DS    0H                                                  0355
*                            STATFLG = ABNEVENT;                   0355
         MVC   STATFLG(5),@CB00676                                 0355
*                            RECDPRCS = RECDPRCS + 1;              0356
*                                                                  0356
         LA    @10,1                                               0356
         AL    @10,RECDPRCS                                        0356
         ST    @10,RECDPRCS                                        0356
*                            END;                                  0357
*                                                                  0357
*                    END PRTLOOPC;                                 0358
*                                                                  0358
*                END PRTLOOPB;                                     0359
*                                                                  0359
*              /******************************************************/
*              /*                                                    */
*              /* INTERROGATE NON ZERO I/O ADAPTER RETURN CODES -    */
*              /* AN RCFAIL CONDITION WITH IOCMSGOP TURNED ON ALLOWS */
*              /* CONTINUATION OF PROCESSING                         */
*              /* ON RCEODAD VERIFY THAT SPECIFIED ENDING POSITION   */
*              /* WAS PROCESSED                                      */
*              /* RESET DARGFULL INDICATORS                          */
*              /*                                                    */
*              /******************************************************/
*              ELSE                                                0360
*                DO;                                               0360
*                                                                  0360
         B     @RC00311                                            0360
@RF00311 DS    0H                                                  0361
*                CYCLEFLG = STOP;                                  0361
         MVI   CYCLEFLG,X'0F'                                      0361
*                DARGFULL = OFF;                           /*@OZ14818*/
         L     @10,DDSTRU                                          0362
         NI    DARGFULL(@10),B'01111111'                           0362
*                DARGRETP = NULLPTR;                       /*@OZ14818*/
*                                                                  0363
         SLR   @05,@05                                             0363
         ST    @05,DARGRETP(,@10)                                  0363
*                /****************************************************/
*                /*                                                  */
*                /* ON RCEODAD VERIFY ENDING DELIMITER WAS PROCESSED */
*                /* IF NOT PROCESSED INDICATE LASTCC = 4             */
*                /*                                                  */
*                /****************************************************/
*                IF TESTRC = 16    &                               0364
*                  (DELIMFLG ^= '00'X   ×                          0364
*                   LOOPINCR ^=  0      )                          0364
*                  THEN                                            0364
         C     TESTRC,@CF00474                                     0364
         BNE   @RF00364                                            0364
         CLI   DELIMFLG,X'00'                                      0364
         BNE   @RT00364                                            0364
         CH    @05,LOOPINCR                                        0364
         BE    @RF00364                                            0364
@RT00364 DS    0H                                                  0365
*                    DO;                                           0365
*                                                                  0365
*                    /************************************************/
*                    /*                                              */
*                    /* WAS END KEY POSITION BEYOND EOF              */
*                    /*                                              */
*                    /************************************************/
*                    IF DELIMFLG = TOKYPOST                        0366
*                      THEN                                        0366
         CLI   DELIMFLG,X'02'                                      0366
         BNE   @RF00366                                            0366
*                        IF TOKYCVAL > RECDKEY(1:ENDKYLN)          0367
*                          THEN                                    0367
         L     @10,@PC00001+4                                      0367
         L     @10,FDTPTR+20(,@10)                                 0367
         L     @05,IOCSPTR                                         0367
         L     @05,IOCKYA(,@05)                                    0367
         L     @15,ENDKYLN                                         0367
         BCTR  @15,0                                               0367
         EX    @15,@SC00814                                        0367
         BNH   @RF00367                                            0367
*                            STATFLG = ABNCONDT;                   0368
         MVC   STATFLG(5),@CB00673                                 0368
*                          ELSE;                                   0369
*                                                                  0369
@RF00367 DS    0H                                                  0370
*                      /**********************************************/
*                      /*                                            */
*                      /* WAS ENDING RBA DELIMITER BEYOND EOF        */
*                      /*                                            */
*                      /**********************************************/
*                      ELSE                                        0370
*                        IF DELIMFLG = TORBAPOS                    0370
*                          THEN                                    0370
         B     @RC00366                                            0370
@RF00366 CLI   DELIMFLG,X'03'                                      0370
         BNE   @RF00370                                            0370
*                            IF TORBAVAL > IOCRBA                  0371
*                            THEN                                  0371
         L     @10,@PC00001+4                                      0371
         L     @10,FDTPTR+24(,@10)                                 0371
         L     @10,TORBAVAL(,@10)                                  0371
         L     @05,IOCSPTR                                         0371
         C     @10,IOCRBA(,@05)                                    0371
         BNH   @RF00371                                            0371
*                              STATFLG = ABNCONDT;                 0372
*                                                                  0372
         MVC   STATFLG(5),@CB00673                                 0372
*                            ELSE;                                 0373
*                                                                  0373
@RF00371 DS    0H                                                  0374
*                          /******************************************/
*                          /*                                @Y30SSJH*/
*                          /* WAS END RECORD NUMBER BEYOND   @Y30SSJH*/
*                          /* EOF.                           @Y30SSJH*/
*                          /*                                @Y30SSJH*/
*                          /******************************************/
*                          ELSE                                    0374
*                            IF DELIMFLG = TORRNPOS                0374
*                              THEN                                0374
         B     @RC00370                                            0374
@RF00370 CLI   DELIMFLG,X'04'                                      0374
         BNE   @RF00374                                            0374
*                                IF TONUMVAL > IOCREL              0375
*                                  THEN                            0375
         L     @10,@PC00001+4                                      0375
         L     @10,FDTPTR+120(,@10)                                0375
         L     @10,TONUMVAL(,@10)                                  0375
         L     @05,IOCSPTR                                         0375
         C     @10,IOCREL(,@05)                                    0375
         BNH   @RF00375                                            0375
*                                    STATFLG = ABNCONDT;   /*@Y30SSJH*/
         MVC   STATFLG(5),@CB00673                                 0376
*                                  ELSE;                   /*@Y30SSJH*/
*                                                                  0377
*                                                                  0377
@RF00375 DS    0H                                                  0378
*                              /**************************************/
*                              /*                                    */
*                              /* IF COUNT WAS SPECIFIED AND         */
*                              /* AN END OF FILE OCCURRED            */
*                              /* SET STATFLG TO ABNCONDT            */
*                              /*                                    */
*                              /**************************************/
*                              ELSE                                0378
*                                IF LOOPINCR ^= 0                  0378
*                                  THEN                            0378
         B     @RC00374                                            0378
@RF00374 LH    @10,LOOPINCR                                        0378
         LTR   @10,@10                                             0378
         BZ    @RF00378                                            0378
*                                    STATFLG = ABNCONDT;   /*@Y30SSJH*/
*                                                                  0379
         MVC   STATFLG(5),@CB00673                                 0379
*                    END;                                          0380
@RF00378 DS    0H                                                  0380
@RC00374 DS    0H                                                  0380
@RC00370 DS    0H                                                  0380
@RC00366 DS    0H                                                  0381
*                                                                  0381
*                /****************************************************/
*                /*                                                  */
*                /* RCFAIL - SET SEVERITY AND SEE IF PROCESSING CAN  */
*                /* CONTINUE                                         */
*                /*                                                  */
*                /****************************************************/
*                IF TESTRC = 4                                     0381
*                  THEN                                            0381
@RF00364 C     TESTRC,@CF00039                                     0381
         BNE   @RF00381                                            0381
*                    IF IOCMSGOP = ON                              0382
*                      THEN                                        0382
         L     @10,IOCSPTR                                         0382
         TM    IOCMSGOP(@10),B'00100000'                           0382
         BNO   @RF00382                                            0382
*                        DO;                                       0383
*                                                                  0383
*                        /********************************************/
*                        /*                                          */
*                        /* PRINT WILL ONLY ALLOW CONTINUATION ON    */
*                        /* THREE I/O ERRORS THE FOURTH WILL CAUSE   */
*                        /* TERMINATION.                             */
*                        /*                                          */
*                        /********************************************/
*                        RPIOERR = RPIOERR + 1;                    0384
*                                                                  0384
         AL    RPIOERR,@CF00216                                    0384
*                        IF RPIOERR > 3                            0385
*                          THEN                                    0385
         C     RPIOERR,@CF00159                                    0385
         BNH   @RF00385                                            0385
*                            STATFLG = ABNTERM;                    0386
*                                                                  0386
         MVC   STATFLG(5),@CB00679                                 0386
*                          ELSE                                    0387
*                            DO;                                   0387
*                                                                  0387
         B     @RC00385                                            0387
@RF00385 DS    0H                                                  0388
*                            CYCLEFLG = GO;                        0388
         MVI   CYCLEFLG,X'00'                                      0388
*                            STATFLG = ABNEVENT;                   0389
*                                                                  0389
         MVC   STATFLG(5),@CB00676                                 0389
*                            END;                                  0390
*                                                                  0390
*                        END;                                      0391
*                                                                  0391
*                      ELSE                                        0392
*                        STATFLG = ABNTERM;                        0392
*                                                                  0392
         B     @RC00382                                            0392
@RF00382 MVC   STATFLG(5),@CB00679                                 0392
*                END;                                              0393
*                                                                  0393
@RC00382 DS    0H                                                  0393
@RF00381 DS    0H                                                  0394
*          END PRTLOOPA;                                           0394
@RC00311 AH    N,LOOPINCR                                          0394
@DE00306 C     N,LOOPCNT                                           0394
         BNH   @DL00306                                            0394
@DC00306 DS    0H                                                  0395
*        /************************************************************/
*        /*                                                          */
*        /* IDCPR01 TERMINATION PROCESSING -                         */
*        /*    . ISSUE MESSAGE GIVING NUMBER OF RECORDS PRINTED      */
*        /*    . ISSUE ERROR/TERMINATION MESSAGE                     */
*        /*    . CLOSE DATA SETS OPENED                              */
*        /*    . RETURN TO INVOKED OF IDCPR01                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0395
*        OLDERID2 = NEWERID2;                                      0395
@RF00305 L     @10,@PC00001                                        0395
         L     @15,GDTTR2(,@10)                                    0395
         MVC   @TS00001(95),NEWERID2(@15)                          0395
         MVC   OLDERID2(95,@15),@TS00001                           0395
*        NEWID2 = 'PR18';                                          0396
*                                                                  0396
         MVC   NEWID2(4,@15),@CC00749                              0396
*        /************************************************************/
*        /*                                                          */
*        /* ISSUE MESSAGE GIVING THE NUMBER OF RECORDS PRINTED       */
*        /* . RECDPRCS CONTAINS THE COUNT OF RECORDS PRINTED         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0397
*        DARGL = ''B;                                      /*@Y30SSLO*/
         XC    DARGL(28),DARGL                                     0397
*        DARGSMOD = 'UV0';                                         0398
         L     @15,DDSTRU                                          0398
         MVC   DARGSMOD(3,@15),@CC00750                            0398
*        DARGSENT = 5;                                             0399
         MVI   DARGSENT(@15),X'05'                                 0399
*        DARGDBP = ADDR(RECDPRCS);                                 0400
         LA    @14,RECDPRCS                                        0400
         ST    @14,DARGDBP(,@15)                                   0400
*        DARGILP  = LENGTH(RECDPRCS);                              0401
*                                                                  0401
         MVC   DARGILP(2,@15),@CH00039                             0401
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0402
*                                                                  0402
         ST    @10,@AL00001                                        0402
         LA    @15,@CF00112                                        0402
         ST    @15,@AL00001+4                                      0402
         LA    @15,DDSTRU                                          0402
         ST    @15,@AL00001+8                                      0402
         MVI   @AL00001+8,X'80'                                    0402
         L     @15,GDTPRT(,@10)                                    0402
         LA    @01,@AL00001                                        0402
         BALR  @14,@15                                             0402
*        /************************************************************/
*        /*                                                          */
*        /* CLOSE DATA SETS OPENED BY IDCPR01 - THE INPUT AND        */
*        /* OPTIONALLY THE ALTERNATE LISTING DATA SET                */
*        /*                                                          */
*        /************************************************************/
*        IF OPRTFILE = NULLPTR                                     0403
*          THEN                                                    0403
         L     @10,OPRTFILE                                        0403
         LTR   @10,@10                                             0403
         BNZ   @RF00403                                            0403
*            CALL IDCIOCL0 (GDTTBL,IOCSPTR);                       0404
         L     @10,@PC00001                                        0404
         ST    @10,@AL00001                                        0404
         LA    @15,IOCSPTR                                         0404
         ST    @15,@AL00001+4                                      0404
         MVI   @AL00001+4,X'80'                                    0404
         L     @15,GDTCLS(,@10)                                    0404
         LA    @01,@AL00001                                        0404
         BALR  @14,@15                                             0404
*          ELSE                                                    0405
*            CALL IDCIOCL0 (GDTTBL,IOCSALT,IOCSPTR);               0405
*                                                                  0405
         B     @RC00403                                            0405
@RF00403 L     @10,@PC00001                                        0405
         ST    @10,@AL00001                                        0405
         LA    @15,IOCSALT                                         0405
         ST    @15,@AL00001+4                                      0405
         LA    @15,IOCSPTR                                         0405
         ST    @15,@AL00001+8                                      0405
         MVI   @AL00001+8,X'80'                                    0405
         L     @15,GDTCLS(,@10)                                    0405
         LA    @01,@AL00001                                        0405
         BALR  @14,@15                                             0405
*        RESPECIFY RTNREG RSTD;                                    0406
@RC00403 DS    0H                                                  0407
*        TESTRC = RTNREG;                                          0407
         LR    TESTRC,RTNREG                                       0407
*        RESPECIFY RTNREG UNRSTD;                                  0408
*                                                                  0408
*        IF TESTRC ^= 0                                            0409
*          THEN                                                    0409
*                                                                  0409
         LTR   TESTRC,TESTRC                                       0409
         BZ    @RF00409                                            0409
*            /********************************************************/
*            /*                                                      */
*            /* CLOSE ERROR - SET STATFLG IF ABNTERM IS NOT INDICATED*/
*            /*                                                      */
*            /********************************************************/
*            DO;                                                   0410
*                                                                  0410
*            IF STATFLG ^= ABNTERM   &                     /*@YA04557*/
*               STATFLG ^= POSITERR                                0411
*              THEN                                                0411
         CLC   STATFLG(5),@CB00679                                 0411
         BE    @RF00411                                            0411
         CLC   STATFLG(5),@CB00682                                 0411
         BE    @RF00411                                            0411
*                STATFLG = ABNEVENT;                               0412
*                                                                  0412
         MVC   STATFLG(5),@CB00676                                 0412
*            END;                                                  0413
@RF00411 DS    0H                                                  0414
*                                                                  0414
*        /************************************************************/
*        /*                                                          */
*        /*  ISSUE TERMINATION MESSAGE                               */
*        /* . STATFLG CONTAINS THE PROCESSING STATUS                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0414
*        DARGL = ''B;                                      /*@Y30SSLO*/
@RF00409 XC    DARGL(28),DARGL                                     0414
*        DARGSENT = STATFLG2;                                      0415
         L     @10,DDSTRU                                          0415
         IC    @15,STATFLG2                                        0415
         STC   @15,DARGSENT(,@10)                                  0415
*        DARGSMOD = STMODID;                                       0416
         MVC   DARGSMOD(3,@10),STMODID                             0416
*        DARGDBP  = ADDR(LASTCC);                                  0417
         L     @15,@PC00001+8                                      0417
         ST    @15,DARGDBP(,@10)                                   0417
*        DARGILP  = LENGTH(LASTCC);                                0418
         MVC   DARGILP(2,@10),@CH00150                             0418
*        LASTCC   = STATFLG1;                                      0419
         SLR   @14,@14                                             0419
         IC    @14,STATFLG1                                        0419
         STH   @14,LASTCC(,@15)                                    0419
*        IF GDTECT ^= 0 & LASTCC > 0                               0420
*          THEN                                                    0420
         SLR   @15,@15                                             0420
         L     @09,@PC00001                                        0420
         C     @15,GDTECT(,@09)                                    0420
         BE    @RF00420                                            0420
         CR    @14,@15                                             0420
         BNH   @RF00420                                            0420
*            DARGSENT = 15; /*ISSUE BRIEF MSG FOR TSO USER   @Y30SSEC*/
*                                                                  0421
         MVI   DARGSENT(@10),X'0F'                                 0421
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0422
*                                                                  0422
@RF00420 L     @10,@PC00001                                        0422
         ST    @10,@AL00001                                        0422
         LA    @15,@CF00112                                        0422
         ST    @15,@AL00001+4                                      0422
         LA    @15,DDSTRU                                          0422
         ST    @15,@AL00001+8                                      0422
         MVI   @AL00001+8,X'80'                                    0422
         L     @15,GDTPRT(,@10)                                    0422
         LA    @01,@AL00001                                        0422
         BALR  @14,@15                                             0422
*        IF GDTDBG = NULLPTR                                       0423
*          THEN;                                                   0423
         L     @10,@PC00001                                        0423
         L     @10,GDTDBG(,@10)                                    0423
         LTR   @10,@10                                             0423
         BZ    @RT00423                                            0423
*          ELSE                                                    0425
*            CALL IDCDB010 (GDTTBL,'PR01');                        0425
*                                                                  0425
         L     @10,@PC00001                                        0425
         ST    @10,@AL00001                                        0425
         LA    @15,@CC00685                                        0425
         ST    @15,@AL00001+4                                      0425
         MVI   @AL00001+4,X'80'                                    0425
         L     @15,GDTDBG(,@10)                                    0425
         LA    @01,@AL00001                                        0425
         BALR  @14,@15                                             0425
*        /************************************************************/
*        /*                                                          */
*        /*       RETURN TO INVOKER OF IDCPR01                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0426
*        CALL IDCSAEP0(GDTTBL,MODID);                              0426
@RT00423 L     @10,@PC00001                                        0426
         ST    @10,@AL00001                                        0426
         LA    @15,MODID                                           0426
         ST    @15,@AL00001+4                                      0426
         MVI   @AL00001+4,X'80'                                    0426
         L     @15,GDTEPL(,@10)                                    0426
         LA    @01,@AL00001                                        0426
         BALR  @14,@15                                             0426
*                                                                  0427
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - TEXTPSET                                        */
*/*                                                                  */
*/* FUNCTION - TEXTPSET COMMUNICATES THE PAGE LAYOUT AND RECORD      */
*/*            LAYOUT FOR THE LISTING TO THE AMS TEXT PROCESSOR.     */
*/*                                                                  */
*/*            THE PAGE LAYOUT IS DEFINED USING THE DEFAULT VALUES   */
*/*            OF THE PAGE CONTROL INTERFACE(PCARGLST) - EXCEPT FOR  */
*/*            THE SUBTITLE LINE. THE STATIC PORTION OF THE SUBTITLE */
*/*            LINE IS RETRIEVED FROM THE STATIC TEXT MODULE VIA THE */
*/*            UPRINT MACRO, THE NAME OF THE INPUT DATA SET IS MOVED */
*/*            INTO THIS LINE FROM THE LOCATION REFERENCED BY IOCDSN */
*/*            IN THE IOCS.  THE REVISED SUBTITLE LINE AND PAGE      */
*/*            CONTROL INFORMATION IS COMMUNICATED TO THE TEXT       */
*/*            VIA THE UESTA MACRO.                                  */
*/*                                                                  */
*/*            THE RECORD LAYOUT IS COMPOSED OF TWO SECTIONS:        */
*/*              . THE RECORD KEY , RELATIVE RECORD NUMBER   @Y30SSJH*/
*/*                OR RECORD SEQUENCE NUMBER                 @Y30SSJH*/
*/*              . THE DATA PORTION OF THE RECORD                    */
*/*            THE DARGLST REFERENCES THE DYNAMIC DATA OF THESE TWO  */
*/*            SECTIONS ON EACH INVOCATION OF THE UPRINT MACRO.  THE */
*/*            OUTPUT FORMAT IS INCLUDED IN THE STATIC TEXT AS       */
*/*            REFERENCED BY THE DARGSTID                            */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      TEXTPSET REFERENCES THE FOLLOWING ITEMS FROM                */
*/*      THE DECLARATIONS IN THE MAIN PROCEDURE:                     */
*/*       . DARGLIST - TEXT PROCESSOR DATA ARGUMENT LIST             */
*/*        . PCARGLIST- PAGE CONTROL ARG LIST (TEXT PROCESSOR)       */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      . THE PAGE CONTROL IS ESTABLISHED                           */
*/*      . THE DARGLIST IS CONSTRUCTED EXCLUSIVE OF DYNAMIC DATA     */
*/*        SET IN THE UGET/UPRINT LOOP                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0427
*TEXTPSET:                                                         0427
*        PROCEDURE;                                                0427
*                                                                  0427
@EL00001 L     @13,4(,@13)                                         0427
@EF00001 L     @00,@SIZDATD                                        0427
         LR    @01,@11                                             0427
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0427
         BR    @14                                                 0427
TEXTPSET STM   @14,@12,@SA00002                                    0427
*        /************************************************************/
*        /*                                                          */
*        /* NAME OF DATA SET BEING PRINTED SET UP BY UOPEN           */
*        /*                                                          */
*        /***********************************************************/
*        DCL                                                       0428
*          PRTDSNAM  CHAR(44) BASED(IOCDSN);                       0428
*                                                                  0428
*        /************************************************************/
*        /*                                                          */
*        /* AREA INTO WHICH THE SUBTITLE LINE IS CONSTRUCTED         */
*        /*                                                          */
*        /************************************************************/
*        DCL                                                       0429
*          1 SUBTBUFF  CHAR(121),                                  0429
*            2 SUBTLHDR  CHAR(22),     /* SKELETON PORTION           */
*            2 SUBTLDSN  CHAR(99);     /* DATA SET NAME PLUS PADDING */
*                                                                  0429
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO TEXTPSET - THIS IS THE ONLY ENTRY POINT   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0430
*        OLDERID2 = NEWERID2;                                      0430
         L     @10,@PC00001                                        0430
         L     @03,GDTTR2(,@10)                                    0430
         MVC   @TS00001(95),NEWERID2(@03)                          0430
         MVC   OLDERID2(95,@03),@TS00001                           0430
*        NEWID2 = 'PR21';                                          0431
*                                                                  0431
         MVC   NEWID2(4,@03),@CC00760                              0431
*        /************************************************************/
*        /*                                                          */
*        /* THE PAGE LAYOUT FOR THE LISTING IS COMMUNICATED TO THE   */
*        /* AMS TEXT PROCESSOR                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0432
*        DARGL = ''B;                                              0432
         XC    DARGL(28),DARGL                                     0432
*        DARGRETP= ADDR(SUBTBUFF);                                 0433
         L     @03,DDSTRU                                          0433
         LA    @15,SUBTBUFF                                        0433
         ST    @15,DARGRETP(,@03)                                  0433
*        DARGSMOD='PR0';                                           0434
         MVC   DARGSMOD(3,@03),@CC00761                            0434
*        DARGSENT = '01'X;                                         0435
         MVI   DARGSENT(@03),X'01'                                 0435
*        DARGRETL= LENGTH(SUBTBUFF);                       /*@Y30SSJH*/
*                                                                  0436
         MVC   DARGRETL(2,@03),@CH00756                            0436
*        /************************************************************/
*        /*                                                          */
*        /* RETRIEVE THE STATIC TEXT SUBTITLE LINE SKELETON          */
*        /*                                                          */
*        /************************************************************/
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0437
         ST    @10,@AL00001                                        0437
         LA    @03,@CF00112                                        0437
         ST    @03,@AL00001+4                                      0437
         LA    @03,DDSTRU                                          0437
         ST    @03,@AL00001+8                                      0437
         MVI   @AL00001+8,X'80'                                    0437
         L     @15,GDTPRT(,@10)                                    0437
         LA    @01,@AL00001                                        0437
         BALR  @14,@15                                             0437
*        RESPECIFY RTNREG RSTD;                                    0438
*        TESTRC = RTNREG;                                          0439
         LR    TESTRC,RTNREG                                       0439
*        RESPECIFY RTNREG UNRSTD;                                  0440
*                                                                  0440
*        IF TESTRC =< 4                                            0441
*          THEN                                                    0441
         C     TESTRC,@CF00039                                     0441
         BH    @RF00441                                            0441
*            DO;                                                   0442
*                                                                  0442
*            /********************************************************/
*            /*                                                      */
*            /* THE DATA SET NAME TO BE LISTED IS ADDED TO THE SUB-  */
*            /* TITLE LINE. THE ADDRESS OF THE NAME IS IN THE IOCS   */
*            /* WHICH IS BUILT AT UOPEN TIME.                        */
*            /*                                                      */
*            /********************************************************/
*                                                                  0443
*            IF GDTECT = NULLPTR                                   0443
*              THEN                                                0443
         L     @10,@PC00001                                        0443
         L     @03,GDTECT(,@10)                                    0443
         LTR   @03,@03                                             0443
         BNZ   @RF00443                                            0443
*                DO;           /* CHECK FOR TSO ENVIRONMENT  @Y30SSEC*/
*                   PCARGLST = ''B;                                0445
         XC    PCARGLST(34),PCARGLST                               0445
*                   PCSTLP = ADDR(SUBTBUFF);                       0446
         LA    @03,SUBTBUFF                                        0446
         ST    @03,PCSTLP                                          0446
*                   PCSTLC = 1;                                    0447
         MVC   PCSTLC(2),@CH00216                                  0447
*                   SUBTLDSN = PRTDSNAM;                           0448
*                                                                  0448
         MVI   SUBTLDSN+44,C' '                                    0448
         MVC   SUBTLDSN+45(54),SUBTLDSN+44                         0448
         L     @03,IOCSPTR                                         0448
         L     @03,IOCDSN(,@03)                                    0448
         MVC   SUBTLDSN(44),PRTDSNAM(@03)                          0448
*                   /*************************************************/
*                   /*                                               */
*                   /* UESTA COMMUNICATES THE, NOW COMPLETE, PAGE    */
*                   /* LAYOUT TO THE AMS TEXT PROCESSOR              */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0449
*                   CALL AMSTP042 (GDTTBL,PRTFILE,PCARGLST);       0449
         ST    @10,@AL00001                                        0449
         LA    @03,@CF00112                                        0449
         ST    @03,@AL00001+4                                      0449
         LA    @03,PCARGLST                                        0449
         ST    @03,@AL00001+8                                      0449
         L     @15,GDTESA(,@10)                                    0449
         LA    @01,@AL00001                                        0449
         BALR  @14,@15                                             0449
*                   RESPECIFY RTNREG RSTD;                         0450
*                   TESTRC = RTNREG;                               0451
         LR    TESTRC,RTNREG                                       0451
*                   RESPECIFY RTNREG UNRSTD;                       0452
*                END;                                      /*@Y30SSEC*/
*                                                                  0453
*            IF TESTRC =< 4                                        0454
*              THEN                                                0454
@RF00443 C     TESTRC,@CF00039                                     0454
         BH    @RF00454                                            0454
*                DO;                                               0455
*                                                                  0455
*                /****************************************************/
*                /*                                                  */
*                /* INITIALIZE THE DARGLIST                          */
*                /*  THIS ARGUMENT LIST ESTABLISHES THE RECORD LAYOUT*/
*                /*  BY SPECIFYING THE DATA HEADER AND DATA FORMAT   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0456
*                DARGL = ''B;                                      0456
         XC    DARGL(28),DARGL                                     0456
*                DARGCNT = 1;                                      0457
         L     @10,DDSTRU                                          0457
         MVC   DARGCNT(2,@10),@CH00216                             0457
*                DARGSMOD = 'PR0';                                 0458
*                                                                  0458
         MVC   DARGSMOD(3,@10),@CC00761                            0458
*                /****************************************************/
*                /*                                                  */
*                /* SET DARGSENT FOR A HEX LISTING                   */
*                /*                                                  */
*                /****************************************************/
*                                                                  0459
*                IF (ADDR(FHEX)) ^= NULLPTR                /*@Y30SSJH*/
*                  THEN                                            0459
         L     @03,@PC00001+4                                      0459
         L     @03,FDTPTR+44(,@03)                                 0459
         LTR   @03,@03                                             0459
         BZ    @RF00459                                            0459
*                    DARGSENT = 6;                         /*@Y30SSJH*/
*                                                                  0460
         MVI   DARGSENT(@10),X'06'                                 0460
*                  /**************************************************/
*                  /*                                                */
*                  /* SET DARGSENT INDICATING A CHARACTER LISTING    */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0461
*                  ELSE                                            0461
*                    IF (ADDR(FCHAR)) ^= NULLPTR           /*@Y30SSJH*/
*                      THEN                                        0461
         B     @RC00459                                            0461
@RF00459 L     @10,@PC00001+4                                      0461
         L     @10,FDTPTR+48(,@10)                                 0461
         LTR   @10,@10                                             0461
         BZ    @RF00461                                            0461
*                        DARGSENT = 2;                             0462
*                                                                  0462
         L     @10,DDSTRU                                          0462
         MVI   DARGSENT(@10),X'02'                                 0462
*                      /**********************************************/
*                      /*                                            */
*                      /* THE SETTING OF DARGSENT DEFAULTS TO DUMP   */
*                      /*  LISTING                                   */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0463
*                      ELSE                                        0463
*                        DARGSENT = 10;                    /*@Y30SSJH*/
*                                                                  0463
         B     @RC00461                                            0463
@RF00461 L     @10,DDSTRU                                          0463
         MVI   DARGSENT(@10),X'0A'                                 0463
*                /****************************************************/
*                /*                                                  */
*                /* INITIALIZE THE FORMAT INSERT STRUCTURE FOR THE   */
*                /* DATA HEADER WHICH INDICATES THE KEY,     @Y30SSJH*/
*                /* RELATIVE RECORD NUMBER OR THE RECORD     @Y30SSJH*/
*                /* SEQUENCE NUMBER OF THE RECORD            @Y30SSJH*/
*                /*                                                  */
*                /****************************************************/
*                                                                  0464
*                DARGINS(1) = 1;                                   0464
*                                                                  0464
@RC00461 DS    0H                                                  0464
@RC00459 L     @10,DDSTRU                                          0464
         MVC   DARGINS(2,@10),@CH00216                             0464
*                /****************************************************/
*                /*                                          @Y30SSJH*/
*                /* VSAM RELATIVE RECORD DATA SET            @Y30SSJH*/
*                /*  . BUMP DARGSENT TO INDICATE APPROPRIATE @Y30SSJH*/
*                /*    STID                                  @Y30SSJH*/
*                /*  . SET LENGTH OF RELATIVE RECORD NUMBER  @Y30SSJH*/
*                /*    AND ITS ADDRESS FOR THE INSERT        @Y30SSJH*/
*                /*    STRUCTURE.                            @Y30SSJH*/
*                /*   (IT SHOULD BE NOTED THAT THERE IS A    @Y30SSJH*/
*                /*   DEPENDENCY HERE ON THE ORDER OF THE    @Y30SSJH*/
*                /*   MESSAGES IN THE STATIC TEXT MODULE.)   @Y30SSJH*/
*                /*                                          @Y30SSJH*/
*                /****************************************************/
*                                                                  0465
*                IF IOCMACRR = ON                                  0465
*                  THEN                                            0465
         L     @03,IOCSPTR                                         0465
         TM    IOCMACRR(@03),B'00100000'                           0465
         BNO   @RF00465                                            0465
*                    DO;                                   /*@Y30SSJH*/
*                                                                  0466
*                    DARGSENT = DARGSENT + 3;              /*@Y30SSJH*/
         LA    @15,3                                               0467
         SLR   @14,@14                                             0467
         IC    @14,DARGSENT(,@10)                                  0467
         ALR   @15,@14                                             0467
         STC   @15,DARGSENT(,@10)                                  0467
*                    DARGINL(1) = LENGTH(IOCREL);          /*@Y30SSJH*/
         MVC   DARGINL(2,@10),@CH00039                             0468
*                    DARGDTM(1) = ADDR(IOCREL);            /*@Y30SSJH*/
*                                                                  0469
         LA    @03,IOCREL(,@03)                                    0469
         ST    @03,DARGDTM(,@10)                                   0469
*                    END;                                  /*@Y30SSJH*/
*                                                                  0470
*                  ELSE                                            0471
*                    /************************************************/
*                    /*                                      @Y30SSJH*/
*                    /* SET INPUT LENGTH TO KEY LENGTH FOR KEY DATA  */
*                    /* SETS                                 @Y30SSJH*/
*                    /*                                      @Y30SSJH*/
*                    /************************************************/
*                                                                  0471
*                    IF ( IOCDSOAM = ON  &                         0471
*                         IOCMACCR = OFF ×                         0471
*                         IOCDSOIS = ON   )                        0471
*                      THEN                                        0471
         B     @RC00465                                            0471
@RF00465 L     @10,IOCSPTR                                         0471
         TM    IOCDSOAM(@10),B'10000000'                           0471
         BNO   @GL00017                                            0471
         TM    IOCMACCR(@10),B'00010000'                           0471
         BZ    @RT00471                                            0471
@GL00017 L     @10,IOCSPTR                                         0471
         TM    IOCDSOIS(@10),B'00100000'                           0471
         BNO   @RF00471                                            0471
@RT00471 DS    0H                                                  0472
*                        DARGINL(1) = IOCKYL;              /*@Y30SSJH*/
*                                                                  0472
         L     @10,IOCSPTR                                         0472
         SLR   @03,@03                                             0472
         IC    @03,IOCKYL(,@10)                                    0472
         L     @10,DDSTRU                                          0472
         STH   @03,DARGINL(,@10)                                   0472
*                      ELSE                                        0473
*                        DO;                               /*@Y30SSJH*/
*                                                                  0473
         B     @RC00471                                            0473
@RF00471 DS    0H                                                  0474
*                        /********************************************/
*                        /*                                  @Y30SSJH*/
*                        /* SEQUENTIAL NON VSAM DATA SET     @Y30SSJH*/
*                        /*  . BUMP DARGSENT TO INDICATE APPROPRIATE */
*                        /*     STID                         @Y30SSJH*/
*                        /*  . SET LENGTH OF RECORD SEQUENCE @Y30SSJH*/
*                        /*    COUNT AND ITS ADDRESS FOR THE @Y30SSJH*/
*                        /*    INSERT STRUCTURE              @Y30SSJH*/
*                        /*                                  @Y30SSJH*/
*                        /********************************************/
*                                                                  0474
*                        IF IOCDSOPS = ON                          0474
*                          THEN                                    0474
         L     @10,IOCSPTR                                         0474
         TM    IOCDSOPS(@10),B'01000000'                           0474
         BNO   @RF00474                                            0474
*                            DO;                           /*@Y30SSJH*/
*                                                                  0475
*                            DARGSENT = DARGSENT + 1;      /*@Y30SSJH*/
         L     @03,DDSTRU                                          0476
         LA    @15,1                                               0476
         SLR   @14,@14                                             0476
         IC    @14,DARGSENT(,@03)                                  0476
         ALR   @15,@14                                             0476
         STC   @15,DARGSENT(,@03)                                  0476
*                            DARGINL(1) = LENGTH(IOCRRN);  /*@Y30SSJH*/
         MVC   DARGINL(2,@03),@CH00039                             0477
*                            DARGDTM(1) = ADDR(IOCRRN);    /*@Y30SSJH*/
*                                                                  0478
         LA    @10,IOCRRN(,@10)                                    0478
         ST    @10,DARGDTM(,@03)                                   0478
*                            END;                          /*@Y30SSJH*/
*                          /******************************************/
*                          /*                                @Y30SSJH*/
*                          /* SEQUENTIAL VSAM DATA SET (ESDS) Y30SSJH*/
*                          /*  . BUMP DARGSENT TO INDICATE THE STID  */
*                          /*  . SET LENGTH OF RBA AND ITS ADDRESS   */
*                          /*    FOR THE INSERT STRUCTURE    @Y30SSJH*/
*                          /*                                @Y30SSJH*/
*                          /******************************************/
*                                                                  0480
*                          ELSE                                    0480
*                            DO;                           /*@Y30SSJH*/
*                                                                  0480
         B     @RC00474                                            0480
@RF00474 DS    0H                                                  0481
*                            DARGSENT = DARGSENT + 2;      /*@Y30SSJH*/
         L     @10,DDSTRU                                          0481
         LA    @03,2                                               0481
         SLR   @15,@15                                             0481
         IC    @15,DARGSENT(,@10)                                  0481
         ALR   @03,@15                                             0481
         STC   @03,DARGSENT(,@10)                                  0481
*                            DARGINL(1) = 4;               /*@Y30SSJH*/
         MVC   DARGINL(2,@10),@CH00039                             0482
*                            DARGDTM(1) = ADDR(IOCRBA);    /*@Y30SSJH*/
*                                                                  0483
         L     @03,IOCSPTR                                         0483
         LA    @03,IOCRBA(,@03)                                    0483
         ST    @03,DARGDTM(,@10)                                   0483
*                            END;                          /*@Y30SSJH*/
*                                                                  0484
*                          END;                            /*@Y30SSJH*/
*                                                                  0485
@RC00474 DS    0H                                                  0486
*                  END;                                            0486
*                                                                  0486
@RC00471 DS    0H                                                  0486
@RC00465 DS    0H                                                  0487
*              END;                                                0487
@RF00454 DS    0H                                                  0488
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO INVOKING PROCEDURE - IDCPR01                   */
*        /*                                                          */
*        /************************************************************/
*        IF TESTRC > 4                                             0488
*          THEN                                                    0488
@RF00441 C     TESTRC,@CF00039                                     0488
         BNH   @RF00488                                            0488
*            STATFLG = ABNTERM;                                    0489
*                                                                  0489
         MVC   STATFLG(5),@CB00679                                 0489
*        RETURN;                                                   0490
@EL00002 DS    0H                                                  0490
@EF00002 DS    0H                                                  0490
@ER00002 LM    @14,@12,@SA00002                                    0490
         BR    @14                                                 0490
*END TEXTPSET;                                                     0491
         B     @EL00002                                            0491
*                                                                  0492
*/********************************************************************/
*/*                                                                  */
*/* PROCEDURE NAME - DELIMSET                                        */
*/*                                                                  */
*/* FUNCTION - DELIMSET ESTABLISHES THE BOUNDARIES FOR PRINTING A    */
*/*            SUBSET OF THE INPUT DATASET.                          */
*/*            BEGINNING AND/OR ENDING DELIMITERS SERVE TO SUBSET    */
*/*            THE DATA SET.  THESE DELIMITERS MAY BE IN THE FORM    */
*/*            OF KEYS,RBA'S,RECORD NUMBERS OR A RECORD      @Y30SSJH*/
*/*            COUNT                                         @Y30SSJH*/
*/*                                                                  */
*/*            BEGINNING DELIMITERS:                                 */
*/*              FROMKEY - ISAM OR VSAM KEY AT WHICH LISTING BEGINS  */
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */
*/*              FROMADDRESS - RBA AT WHICH PRINTING IS TO BEGIN.    */
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */
*/*              FROMNUMBER - RELATIVE RECORD NUMBER AT      @Y30SSJH*/
*/*                WHICH PRINTING IS TO BEGIN.               @Y30SSJH*/
*/*                POSITIONING VIA THE IDCAMS UPOSIT MACRO.  @Y30SSJH*/
*/*              SKIP - NUMBER OF LOGICAL RECORDS TO BE SKIPPED      */
*/*                BEFORE PRINTING IS BEGUN. DELIMSET EXECUTES A     */
*/*                LOOP OF UGET REQUESTS TO EFFECT POSITIONING       */
*/*                OR ISSUES A UPOSIT IF THE DATA SET IS     @Y30SSJH*/
*/*                RELATIVE RECORD.                          @Y30SSJH*/
*/*                                                                  */
*/*            ENDING DELIMITERS:                                    */
*/*              TOKEY - KEY OF THE LAST RECORD TO BE PRINTED.       */
*/*              TOADDRESS - THE RBA OF THE LAST VSAM RECORD TO BE   */
*/*                PRINTED.                                          */
*/*              TONUMBER - RELATIVE RECORD NUMBER OF THE    @Y30SSJH*/
*/*                LAST RECORD TO BE PRINTED.                @Y30SSJH*/
*/*              COUNT - NUMBER OF LOGICAL RECORDS TO BE PRINTED.    */
*/*                LOOPCNT IS SET TO CONTROL THE UGET/UPRINT LOOP IN */
*/*                IDCPR01.                                          */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      DELIMSET REFERENCES THE FDTTBL AND USES THE IOCS TO EFFECT  */
*/*      'UPOSIT' POSITIONING.                                       */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      DELMFLG - INDICATES KEY,RBA OR RELATIVE RECORD      @Y30SSJH*/
*/*                NUMBER DELIMITER                          @Y30SSJH*/
*/*      DELMCNT - INDICATES NUMBER OF RECORDS TO BE PROCESSED       */
*/*      DELMINCR - UGET/URINT LOOP INCREMENT WHEN AN EXPLICIT       */
*/*                 NUMBER OF RECORDS ARE TO BE PRINTED              */
*/*      STATFLG - INDICATES THE TERMINATION CONDITION OF DELIMSET   */
*/*                                                                  */
*/********************************************************************/
*DELIMSET:                                                         0492
*        PROCEDURE (DELMFLG,DELMCNT,DELMINCR);                     0492
DELIMSET STM   @14,@12,@SA00003                                    0492
         MVC   @PC00003(12),0(@01)                                 0492
*                                                                  0493
*        /************************************************************/
*        /*                                                          */
*        /* ARGUMENTS OF INVOCATION                                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0493
*        DCL                                                       0493
*          DELMFLG CHAR(1),                                        0493
*          DELMCNT FIXED(31),                                      0493
*          DELMINCR FIXED(15);                                     0493
*                                                                  0493
*        /************************************************************/
*        /*                                                          */
*        /* LOOP CONTROL VARIABLES TO SKIP TO BEGINNING SUBSET       */
*        /* DELIMITER                                                */
*        /*                                                          */
*        /************************************************************/
*                                                                  0494
*        DCL                                                       0494
*          SKIPFLAG  CHAR(1),                                      0494
*          SKIPLOOP  FIXED(31);                                    0494
*                                                                  0494
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* VARIABLES FOR VALIDITY ERROR MESSAGE             @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*        DCL                                                       0495
*          MSGARY(6)  CHAR(11)                                     0495
*            INIT('FROMKEY' , 'TOKEY', 'FROMADDRESS' ,             0495
*                 'TOADDRESS' , 'FROMNUMBER' , 'TONUMBER' ),       0495
*          MSGINDX    FIXED(31) ,                                  0495
*          MSGENTRY   PTR(8)      INIT( 17 );              /*@Y30SSLO*/
*                                                                  0495
*        /************************************************************/
*        /*                                                          */
*        /* ENTRY POINT TO DELIMSET- INTERNAL PROCEDURE              */
*        /*                                                          */
*        /************************************************************/
*        OLDERID2 = NEWERID2;                                      0496
         L     @10,@PC00001                                        0496
         L     @10,GDTTR2(,@10)                                    0496
         MVC   @TS00001(95),NEWERID2(@10)                          0496
         MVC   OLDERID2(95,@10),@TS00001                           0496
*        NEWID2 = 'PR31';                                          0497
         MVC   NEWID2(4,@10),@CC00787                              0497
*        DELMFLG = '00'X;                                          0498
         L     @10,@PC00003                                        0498
         MVI   DELMFLG(@10),X'00'                                  0498
*        SKIPFLAG = GO;                                            0499
         MVI   SKIPFLAG,X'00'                                      0499
*        TESTRC = 0;                                               0500
         SLR   TESTRC,TESTRC                                       0500
*        DELMINCR = 0;                                             0501
         SLR   @10,@10                                             0501
         L     @15,@PC00003+8                                      0501
         STH   @10,DELMINCR(,@15)                                  0501
*        DELMCNT = 2;                                              0502
         L     @15,@PC00003+4                                      0502
         MVC   DELMCNT(4,@15),@CF00150                             0502
*        MSGINDX = 0;                                      /*@Y30SSJH*/
*                                                                  0503
         SLR   MSGINDX,MSGINDX                                     0503
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* DATA TYPE VALIDITY CHECKING:                     @Y30SSJH*/
*        /*   FMKEY/TOKEY INVALID WITH RRDS,                 @Y30SSJH*/
*        /*   FMRBA/TORBA INVALID WITH RRDS,                 @Y30SSJH*/
*        /*   FMNUM INVALID WITH KSDS,                       @Y30SSJH*/
*        /*   TONUM VALID ONLY WITH RRDS.                    @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*                                                                  0504
*        IF (ADDR(FMKYC) ^= NULLPTR &                              0504
*            IOCMACRR = ON )                                       0504
*          THEN                                                    0504
         L     @15,@PC00001+4                                      0504
         C     @10,FDTPTR+8(,@15)                                  0504
         BE    @RF00504                                            0504
         L     @10,IOCSPTR                                         0504
         TM    IOCMACRR(@10),B'00100000'                           0504
         BNO   @RF00504                                            0504
*            MSGINDX = 1;                                  /*@Y30SSJH*/
         LA    MSGINDX,1                                           0505
*          ELSE                                                    0506
*            IF (ADDR(TOKYC) ^= NULLPTR &                          0506
*               IOCMACRR = ON)                                     0506
*              THEN                                                0506
         B     @RC00504                                            0506
@RF00504 L     @10,@PC00001+4                                      0506
         L     @10,FDTPTR+20(,@10)                                 0506
         LTR   @10,@10                                             0506
         BZ    @RF00506                                            0506
         L     @10,IOCSPTR                                         0506
         TM    IOCMACRR(@10),B'00100000'                           0506
         BNO   @RF00506                                            0506
*                MSGINDX = 2;                              /*@Y30SSJH*/
         LA    MSGINDX,2                                           0507
*              ELSE                                                0508
*                IF (ADDR(FMRBA) ^= NULLPTR &                      0508
*                   IOCMACRR = ON)                                 0508
*                  THEN                                            0508
         B     @RC00506                                            0508
@RF00506 L     @10,@PC00001+4                                      0508
         L     @10,FDTPTR+12(,@10)                                 0508
         LTR   @10,@10                                             0508
         BZ    @RF00508                                            0508
         L     @10,IOCSPTR                                         0508
         TM    IOCMACRR(@10),B'00100000'                           0508
         BNO   @RF00508                                            0508
*                    MSGINDX = 3;                          /*@Y30SSJH*/
         LA    MSGINDX,3                                           0509
*                  ELSE                                            0510
*                    IF (ADDR(TORBA) ^= NULLPTR &                  0510
*                        IOCMACRR = ON)                            0510
*                      THEN                                        0510
         B     @RC00508                                            0510
@RF00508 L     @10,@PC00001+4                                      0510
         L     @10,FDTPTR+24(,@10)                                 0510
         LTR   @10,@10                                             0510
         BZ    @RF00510                                            0510
         L     @10,IOCSPTR                                         0510
         TM    IOCMACRR(@10),B'00100000'                           0510
         BNO   @RF00510                                            0510
*                        MSGINDX = 4;                      /*@Y30SSJH*/
         LA    MSGINDX,4                                           0511
*                      ELSE                                        0512
*                        IF (ADDR(FMNUM) ^= NULLPTR &              0512
*                            IOCMACRR = OFF)                       0512
*                          THEN                                    0512
         B     @RC00510                                            0512
@RF00510 L     @10,@PC00001+4                                      0512
         L     @10,FDTPTR+116(,@10)                                0512
         LTR   @10,@10                                             0512
         BZ    @RF00512                                            0512
         L     @10,IOCSPTR                                         0512
         TM    IOCMACRR(@10),B'00100000'                           0512
         BNZ   @RF00512                                            0512
*                            MSGINDX = 5;                  /*@Y30SSJH*/
         LA    MSGINDX,5                                           0513
*                          ELSE                                    0514
*                            IF (ADDR(TONUM) ^= NULLPTR &          0514
*                                IOCMACRR = OFF )                  0514
*                              THEN                                0514
         B     @RC00512                                            0514
@RF00512 L     @10,@PC00001+4                                      0514
         L     @10,FDTPTR+120(,@10)                                0514
         LTR   @10,@10                                             0514
         BZ    @RF00514                                            0514
         L     @10,IOCSPTR                                         0514
         TM    IOCMACRR(@10),B'00100000'                           0514
         BNZ   @RF00514                                            0514
*                                MSGINDX = 6;              /*@Y30SSJH*/
         LA    MSGINDX,6                                           0515
*                              ELSE;                       /*@Y30SSJH*/
*                                                                  0516
@RF00514 DS    0H                                                  0517
*        /************************************************************/
*        /*                                                  @Y30SSJH*/
*        /* WRITE MESSAGE INDICATING INVALID USE             @Y30SSJH*/
*        /* OF DELIMITERS                                    @Y30SSJH*/
*        /*                                                  @Y30SSJH*/
*        /************************************************************/
*        IF MSGINDX ^= 0                                           0517
*          THEN                                                    0517
@RC00512 DS    0H                                                  0517
@RC00510 DS    0H                                                  0517
@RC00508 DS    0H                                                  0517
@RC00506 DS    0H                                                  0517
@RC00504 LTR   MSGINDX,MSGINDX                                     0517
         BZ    @RF00517                                            0517
*            DO;                                           /*@Y30SSJH*/
*                                                                  0518
*              STATFLG = ABNTERM;                          /*@Y30SSJH*/
         MVC   STATFLG(5),@CB00679                                 0519
*              DARGL = ''B;                                /*@Y30SSLO*/
         XC    DARGL(28),DARGL                                     0520
*              DARGSENT = MSGENTRY;                        /*@Y30SSJH*/
         L     @10,DDSTRU                                          0521
         IC    @15,MSGENTRY                                        0521
         STC   @15,DARGSENT(,@10)                                  0521
*              DARGSMOD ='PR0';                            /*@Y30SSJH*/
         MVC   DARGSMOD(3,@10),@CC00761                            0522
*              DARGCNT = 1;                                /*@Y30SSJH*/
         LA    @15,1                                               0523
         STH   @15,DARGCNT(,@10)                                   0523
*              DARGINS(1) = 1;                             /*@Y30SSLO*/
         STH   @15,DARGINS(,@10)                                   0524
*              DARGINL(1) = LENGTH(MSGARY(1));             /*@Y30SSJH*/
         LA    @15,11                                              0525
         STH   @15,DARGINL(,@10)                                   0525
*              DARGDTM(1) = ADDR(MSGARY(MSGINDX));         /*@Y30SSJH*/
*                                                                  0526
         MR    @14,MSGINDX                                         0526
         LA    @15,MSGARY-11(@15)                                  0526
         ST    @15,DARGDTM(,@10)                                   0526
*              CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);      /*@Y30SSJH*/
*                                                                  0527
         L     @10,@PC00001                                        0527
         ST    @10,@AL00001                                        0527
         LA    @15,@CF00112                                        0527
         ST    @15,@AL00001+4                                      0527
         LA    @15,DDSTRU                                          0527
         ST    @15,@AL00001+8                                      0527
         MVI   @AL00001+8,X'80'                                    0527
         L     @15,GDTPRT(,@10)                                    0527
         LA    @01,@AL00001                                        0527
         BALR  @14,@15                                             0527
*            END;                                          /*@Y30SSJH*/
*                                                                  0528
*        /************************************************************/
*        /*                                                          */
*        /* POSITION TO THE BEGINNING OF THE SUBSET OF THE DATASET   */
*        /*                                                          */
*        /************************************************************/
*                                                                  0529
*        IF ((ADDR(FMKYC)) ^= NULLPTR ×                            0529
*            (ADDR(FMRBA)) ^= NULLPTR ×                    /*@Y30SSJH*/
*            (ADDR(FMNUM)) ^= NULLPTR )  &                 /*@Y30SSJH*/
*            MSGINDX = 0                                   /*@Y30SSJH*/
*                                                                  0529
*          /**********************************************************/
*          /*                                                        */
*          /* INITIALIZE THE I/O ADAPTER UPOSIT INTERFACE TO POSITION*/
*          /* BY KEY OR RBA                                          */
*          /*                                                        */
*          /**********************************************************/
*          THEN                                                    0529
@RF00517 SLR   @10,@10                                             0529
         L     @15,@PC00001+4                                      0529
         C     @10,FDTPTR+8(,@15)                                  0529
         BNE   @GL00025                                            0529
         C     @10,FDTPTR+12(,@15)                                 0529
         BNE   @GL00025                                            0529
         C     @10,FDTPTR+116(,@15)                                0529
         BE    @RF00529                                            0529
@GL00025 SLR   @10,@10                                             0529
         CR    MSGINDX,@10                                         0529
         BNE   @RF00529                                            0529
*            DO;                                                   0530
*                                                                  0530
*            IF (ADDR(FMKYC)) ^= NULLPTR                   /*@Y30SSJH*/
*              THEN                                                0531
         L     @02,@PC00001+4                                      0531
         L     @02,FDTPTR+8(,@02)                                  0531
         CR    @02,@10                                             0531
         BE    @RF00531                                            0531
*                DO;                                               0532
*                                                                  0532
*                IOCKYA = ADDR(FMKYCVAL);                          0533
         L     @10,IOCSPTR                                         0533
         LA    @15,FMKYCVAL(,@02)                                  0533
         ST    @15,IOCKYA(,@10)                                    0533
*                IOCPTL = FMKYCLEN;                                0534
*                                                                  0534
         SLR   @15,@15                                             0534
         IC    @15,FMKYCLEN(,@02)                                  0534
         STH   @15,IOCPTL(,@10)                                    0534
*                END;                                              0535
*                                                                  0535
*              ELSE                                                0536
*                IF (ADDR(FMNUM)) ^= NULLPTR               /*@Y30SSJH*/
*                  THEN                                            0536
         B     @RC00531                                            0536
@RF00531 L     @10,@PC00001+4                                      0536
         L     @10,FDTPTR+116(,@10)                                0536
         LTR   @10,@10                                             0536
         BZ    @RF00536                                            0536
*                    IOCREL = FMNUMVAL;                    /*@Y30SSJH*/
*                                                                  0537
         L     @10,FMNUMVAL(,@10)                                  0537
         L     @02,IOCSPTR                                         0537
         ST    @10,IOCREL(,@02)                                    0537
*                  ELSE                                            0538
*                    IOCRBA = FMRBAVAL;                    /*@Y30SSJH*/
*                                                                  0538
         B     @RC00536                                            0538
@RF00536 L     @10,@PC00001+4                                      0538
         L     @10,FDTPTR+12(,@10)                                 0538
         L     @10,FMRBAVAL(,@10)                                  0538
         L     @02,IOCSPTR                                         0538
         ST    @10,IOCRBA(,@02)                                    0538
*            /********************************************************/
*            /*                                              @Y30SSJH*/
*            /* ISSUE UPOSIT MACRO TO POSITION TO BEGINNING OF THE   */
*            /* SUBSET                                       @Y30SSJH*/
*            /*                                              @Y30SSJH*/
*            /********************************************************/
*                                                                  0539
*            CALL IDCIOPO0(GDTTBL,IOCSPTR);                /*@Y30SSJH*/
@RC00536 DS    0H                                                  0539
@RC00531 L     @10,@PC00001                                        0539
         ST    @10,@AL00001                                        0539
         LA    @15,IOCSPTR                                         0539
         ST    @15,@AL00001+4                                      0539
         MVI   @AL00001+4,X'80'                                    0539
         L     @15,GDTPOS(,@10)                                    0539
         LA    @01,@AL00001                                        0539
         BALR  @14,@15                                             0539
*            RESPECIFY RTNREG RSTD;                                0540
*            TESTRC = RTNREG;                                      0541
         LR    TESTRC,RTNREG                                       0541
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/
*                                                                  0542
*            END;                                          /*@Y30SSJH*/
*                                                                  0544
*          /**********************************************************/
*          /*                                                        */
*          /* POSITION BY SKIPPING TO BEGINNING OF SUBSET    @Y30SSJH*/
*          /*                                                        */
*          /**********************************************************/
*          ELSE                                                    0544
*            IF MSGINDX = 0                                        0544
*              THEN                                                0544
         B     @RC00529                                            0544
@RF00529 SLR   @10,@10                                             0544
         CR    MSGINDX,@10                                         0544
         BNE   @RF00544                                            0544
*                DO;                                       /*@Y30SSJH*/
*                IF (ADDR(SKIP)) ^= NULLPTR                        0546
*                  THEN                                            0546
         L     @15,@PC00001+4                                      0546
         L     @15,FDTPTR+16(,@15)                                 0546
         CR    @15,@10                                             0546
         BE    @RF00546                                            0546
*                    IF IOCMACRR = ON                              0547
*                      THEN                                        0547
         L     @10,IOCSPTR                                         0547
         TM    IOCMACRR(@10),B'00100000'                           0547
         BNO   @RF00547                                            0547
*                        DO;                               /*@Y30SSJH*/
*                                                                  0548
*                        IOCREL = SKIPVAL + 1;             /*@Y30SSJH*/
*                                                                  0549
         LA    @14,1                                               0549
         AL    @14,SKIPVAL(,@15)                                   0549
         ST    @14,IOCREL(,@10)                                    0549
*                        CALL IDCIOPO0(GDTTBL,IOCSPTR);    /*@Y30SSJH*/
         L     @10,@PC00001                                        0550
         ST    @10,@AL00001                                        0550
         LA    @15,IOCSPTR                                         0550
         ST    @15,@AL00001+4                                      0550
         MVI   @AL00001+4,X'80'                                    0550
         L     @15,GDTPOS(,@10)                                    0550
         LA    @01,@AL00001                                        0550
         BALR  @14,@15                                             0550
*                        RESPECIFY RTNREG RSTD;                    0551
*                        TESTRC = RTNREG;                          0552
         LR    TESTRC,RTNREG                                       0552
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSJH*/
*                                                                  0553
*                        END;                              /*@Y30SSJH*/
*                      ELSE                                        0555
*                        DO SKIPLOOP = 1 TO SKIPVAL                0555
*                          WHILE SKIPFLAG = GO;            /*@Y30SSJH*/
*                                                                  0555
         B     @RC00547                                            0555
@RF00547 LA    SKIPLOOP,1                                          0555
         B     @DE00555                                            0555
@DL00555 CLI   SKIPFLAG,X'00'                                      0555
         BNE   @DC00555                                            0555
*                        CALL IDCIOGT0(GDTTBL,IOCSPTR);    /*@Y30SSJH*/
         L     @10,@PC00001                                        0556
         ST    @10,@AL00001                                        0556
         LA    @05,IOCSPTR                                         0556
         ST    @05,@AL00001+4                                      0556
         MVI   @AL00001+4,X'80'                                    0556
         L     @15,GDTGET(,@10)                                    0556
         LA    @01,@AL00001                                        0556
         BALR  @14,@15                                             0556
*                        RESPECIFY RTNREG RSTD;                    0557
*                        TESTRC = RTNREG;                          0558
         LR    TESTRC,RTNREG                                       0558
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSJH*/
*                        IF TESTRC ^= 0                            0560
*                          THEN                                    0560
         LTR   TESTRC,TESTRC                                       0560
         BZ    @RF00560                                            0560
*                            SKIPFLAG = STOP;              /*@Y30SSJH*/
*                                                                  0561
         MVI   SKIPFLAG,X'0F'                                      0561
*                        END;                              /*@Y30SSJH*/
@RF00560 AL    SKIPLOOP,@CF00216                                   0562
@DE00555 L     @10,@PC00001+4                                      0562
         L     @10,FDTPTR+16(,@10)                                 0562
         C     SKIPLOOP,SKIPVAL(,@10)                              0562
         BNH   @DL00555                                            0562
@DC00555 DS    0H                                                  0563
*                END;                                      /*@Y30SSJH*/
@RC00547 DS    0H                                                  0563
@RF00546 DS    0H                                                  0564
*        /************************************************************/
*        /*                                                          */
*        /* INSURE BEGINNING DELIMITER HAS BEEN SUCCESSFULLY SET     */
*        /* BEFORE SETTING THE ENDING DELIMITER                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0564
*        IF TESTRC = 0 &                                   /*@Y30SSJH*/
*           MSGINDX = 0                                    /*@Y30SSJH*/
*          THEN                                                    0564
@RF00544 DS    0H                                                  0564
@RC00529 SLR   @10,@10                                             0564
         CR    TESTRC,@10                                          0564
         BNE   @RF00564                                            0564
         CR    MSGINDX,@10                                         0564
         BNE   @RF00564                                            0564
*            DO;                                                   0565
*                                                                  0565
*            /********************************************************/
*            /*                                                      */
*            /* SET FLAG INDICATING ENDING KEY DELIMITER             */
*            /*                                                      */
*            /********************************************************/
*                                                                  0566
*            IF (ADDR(TOKYC)) ^= NULLPTR                   /*@Y30SSJH*/
*              THEN                                                0566
         L     @15,@PC00001+4                                      0566
         C     @10,FDTPTR+20(,@15)                                 0566
         BE    @RF00566                                            0566
*                DELMFLG = TOKYPOST;                               0567
*                                                                  0567
         L     @10,@PC00003                                        0567
         MVI   DELMFLG(@10),X'02'                                  0567
*              ELSE                                                0568
*                                                                  0568
*                /****************************************************/
*                /*                                                  */
*                /* SET FLAG INDICATING ENDING RBA DELIMITER         */
*                /*                                                  */
*                /****************************************************/
*                                                                  0568
*                IF (ADDR(TORBA)) ^= NULLPTR               /*@Y30SSJH*/
*                  THEN                                            0568
         B     @RC00566                                            0568
@RF00566 L     @10,@PC00001+4                                      0568
         L     @10,FDTPTR+24(,@10)                                 0568
         LTR   @10,@10                                             0568
         BZ    @RF00568                                            0568
*                    DELMFLG = TORBAPOS;                           0569
*                                                                  0569
         L     @10,@PC00003                                        0569
         MVI   DELMFLG(@10),X'03'                                  0569
*                  /**************************************************/
*                  /*                                        @Y30SSJH*/
*                  /* SET FLAG INDICATING ENDING RECORD      @Y30SSJH*/
*                  /* NUMBER DELIMITER                       @Y30SSJH*/
*                  /*                                        @Y30SSJH*/
*                  /**************************************************/
*                  ELSE                                            0570
*                    IF (ADDR(TONUM)) ^= NULLPTR                   0570
*                      THEN                                        0570
         B     @RC00568                                            0570
@RF00568 L     @10,@PC00001+4                                      0570
         L     @10,FDTPTR+120(,@10)                                0570
         LTR   @10,@10                                             0570
         BZ    @RF00570                                            0570
*                        DELMFLG = TORRNPOS;               /*@Y30SSJH*/
         L     @10,@PC00003                                        0571
         MVI   DELMFLG(@10),X'04'                                  0571
*                      /**********************************************/
*                      /*                                            */
*                      /* SET LOOP CONTROL FOR PROCESSING            */
*                      /* AN EXPLICIT NUMBER OF RECORDS              */
*                      /*                                            */
*                      /**********************************************/
*                                                                  0572
*                      ELSE                                        0572
*                        IF (ADDR(COUNT)) ^= NULLPTR       /*@Y30SSJH*/
*                          THEN                                    0572
         B     @RC00570                                            0572
@RF00570 L     @10,@PC00001+4                                      0572
         L     @10,FDTPTR+28(,@10)                                 0572
         LTR   @10,@10                                             0572
         BZ    @RF00572                                            0572
*                            DO;                                   0573
*                                                                  0573
*                            DELMCNT = COUNTVAL;                   0574
         L     @15,@PC00003+4                                      0574
         L     @10,COUNTVAL(,@10)                                  0574
         ST    @10,DELMCNT(,@15)                                   0574
*                            DELMINCR = 1;                         0575
*                                                                  0575
         L     @10,@PC00003+8                                      0575
         MVC   DELMINCR(2,@10),@CH00216                            0575
*                            END;                                  0576
*                                                                  0576
*                          ELSE;                                   0577
*                                                                  0577
@RF00572 DS    0H                                                  0578
*            END;                                                  0578
*                                                                  0579
*          /**********************************************************/
*          /*                                                        */
*          /* BEGINNING POSITIONING FAILED                           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0579
*          ELSE                                                    0579
*            IF MSGINDX = 0                                /*@Y30SSJH*/
*              THEN                                                0579
         B     @RC00564                                            0579
@RF00564 LTR   MSGINDX,MSGINDX                                     0579
         BNZ   @RF00579                                            0579
*                DO;                                               0580
*                                                                  0580
*                STATFLG = POSITERR;                               0581
*                                                                  0581
         MVC   STATFLG(5),@CB00682                                 0581
*                END;                                              0582
*                                                                  0582
*        /************************************************************/
*        /*                                                          */
*        /* RETURN TO INVOKER OF DELIMSET                            */
*        /*                                                          */
*        /************************************************************/
*                                                                  0583
*        RETURN ;                                                  0583
@EL00003 DS    0H                                                  0583
@EF00003 DS    0H                                                  0583
@ER00003 LM    @14,@12,@SA00003                                    0583
         BR    @14                                                 0583
*END DELIMSET;                                                     0584
*                                                                  0584
         B     @EL00003                                            0584
*END IDCPR01                                                       0585
*                                                                  0585
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSPR )                                        *
*;                                                                 0585
@DATA    DS    0H
@CH00756 DC    H'121'
@SC00814 CLC   TOKYCVAL(0,@10),RECDKEY(@05)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00003 DS    15F
@PC00003 DS    3F
@SA00002 DS    15F
@AL00001 DS    5A
IDCPR01  CSECT
         DS    0F
@CF00112 DC    F'0'
@CF00216 DC    F'1'
@CH00216 EQU   @CF00216+2
@CF00150 DC    F'2'
@CH00150 EQU   @CF00150+2
@CF00159 DC    F'3'
@CF00039 DC    F'4'
@CH00039 EQU   @CF00039+2
@CF00570 DC    F'12'
@CF00474 DC    F'16'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
OPRTFILE DS    A
IOCSALT  DS    A
RECDPRCS DS    F
LOOPCNT  DS    F
OLDREL   DS    F
ENDKYLN  DS    F
IOCSINP  DS    A
LISTPTR  DS    A
LOOPINCR DS    H
INPUTLEN DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
OPAGLST  DS    BL48
DARGL    DS    CL28
PCARGLST DS    CL34
         ORG   PCARGLST
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    FL2
         ORG   PCARGLST+34
         DS    CL2
STATFLG  DS    CL5
         ORG   STATFLG
STMODID  DS    CL3
STATFLG1 DS    AL1
STATFLG2 DS    AL1
         ORG   STATFLG+5
CYCLEFLG DS    CL1
DELIMFLG DS    CL1
         DS    CL1
QUALLIST DS    CL12
         ORG   QUALLIST
QUALADDR DS    AL4
QUALCAT  DS    AL4
QUALPAS  DS    AL4
         ORG   QUALLIST+12
INPUTVAL DS    CL44
SUBTBUFF DS    CL121
         ORG   SUBTBUFF
SUBTLHDR DS    CL22
SUBTLDSN DS    CL99
         ORG   SUBTBUFF+121
SKIPFLAG DS    CL1
         DS    CL2
RCDADRTN DS    CL12
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCPR01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
MSGENTRY DC    AL1(17)
@CC00685 DC    C'PR01'
@CC00731 DC    C'PR11'
@CC00749 DC    C'PR18'
@CC00760 DC    C'PR21'
@CC00787 DC    C'PR31'
@CC00750 DC    C'UV0'
@CC00761 EQU   @CC00685
@CB00670 DC    X'E4E5F00001'
@CB00673 DC    X'E4E5F00401'
@CB00676 DC    X'E4E5F00801'
@CB00679 DC    X'E4E5F00C03'
@CB00682 DC    X'E4E5F00C06'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
MODID    DC    CL4'PR01'
FIXAREA  DS    CL256
         ORG   FIXAREA
@NM00037 DS    CL256
         ORG   @NM00037
@NM00038 DC    256X'00'
         ORG   FIXAREA+256
MSGARY   DC    CL11'FROMKEY'
         DC    CL11'TOKEY'
         DC    CL11'FROMADDRESS'
         DC    CL11'TOADDRESS'
         DC    CL11'FROMNUMBER'
         DC    CL11'TONUMBER'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MSGINDX  EQU   @03
SKIPLOOP EQU   @04
N        EQU   @03
RPIOERR  EQU   @04
OPNPTR   EQU   @02
TESTRC   EQU   @02
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAQL0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPO0 EQU   0
IDCIOGT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCKYL   EQU   IOCSTR+12
IOCDSO   EQU   IOCSTR+16
IOCDSOAM EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMACCR EQU   IOCMAC
IOCMAC2  EQU   IOCSTR+19
IOCMACRR EQU   IOCMAC2
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCDSN   EQU   IOCSTR+32
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCKYA   EQU   IOCMEM
IOCNWM   EQU   IOCSTR+48
IOCPTL   EQU   IOCNWM
IOCRRN   EQU   IOCSTR+52
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNRFMFX EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDEVDT EQU   OPNDEV
OPNDEVIX EQU   OPNDEV+4
OPNREC   EQU   OPNAGL+32
OPNBLK   EQU   OPNAGL+36
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGFLGS EQU   DARGLIST+19
DARGFULL EQU   DARGFLGS
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
INDN     EQU   0
OUTDD    EQU   0
OUTDDVAL EQU   OUTDD+1
FMKYC    EQU   0
FMKYCLEN EQU   FMKYC
FMKYCVAL EQU   FMKYC+1
FMRBA    EQU   0
FMRBAVAL EQU   FMRBA
SKIP     EQU   0
SKIPVAL  EQU   SKIP
TOKYC    EQU   0
TOKYCLEN EQU   TOKYC
TOKYCVAL EQU   TOKYC+1
TORBA    EQU   0
TORBAVAL EQU   TORBA
COUNT    EQU   0
COUNTVAL EQU   COUNT
INPDD    EQU   0
INPDDPLN EQU   INPDD
INPDDPAS EQU   INPDD+1
INPDDLEN EQU   INPDD+9
INPDDVAL EQU   INPDD+10
INDS     EQU   0
INDSPLN  EQU   INDS
INDSPAS  EQU   INDS+1
INDSFLG  EQU   INDS+10
INDSFUQ  EQU   INDSFLG
INDSLEN  EQU   INDS+20
INDSVAL  EQU   INDS+21
FHEX     EQU   0
FCHAR    EQU   0
IENV     EQU   0
IRFMT    EQU   0
IBKSZ    EQU   0
IBKSZVAL EQU   IBKSZ
IRCSZ    EQU   0
IRCSZVAL EQU   IRCSZ
IHDEV    EQU   0
IHDEVVAL EQU   IHDEV+1
IPDEV    EQU   0
IPDEVVAL EQU   IPDEV+1
IFUNB    EQU   0
IFBLK    EQU   0
IVUNB    EQU   0
IVBLK    EQU   0
ISUNB    EQU   0
ISBLK    EQU   0
IUNDF    EQU   0
FMNUM    EQU   0
FMNUMVAL EQU   FMNUM
TONUM    EQU   0
TONUMVAL EQU   TONUM
RECDKEY  EQU   0
PRTDSNAM EQU   0
AMSTP041 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
FDUMP    EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
DELMFLG  EQU   0
DELMCNT  EQU   0
DELMINCR EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
IPDEVLEN EQU   IPDEV
IHDEVLEN EQU   IHDEV
INDSMEM  EQU   INDS+12
INDSMLN  EQU   INDS+11
INDSPOS  EQU   INDS+9
OUTDDLEN EQU   OUTDD
@NM00036 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00035 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00034 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00033 EQU   ERCNVTAB+4
@NM00032 EQU   ERCNVTAB+3
@NM00031 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00030 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00029 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00028 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00027 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00026 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00025 EQU   DARGFLGS
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00024 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00023 EQU   OPNAGL+43
@NM00022 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNCBP   EQU   OPNAGL+20
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCWORK  EQU   IOCSTR+56
IOCPNM   EQU   IOCNWM+2
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00315 EQU   @RC00313
@RF00320 EQU   @RC00318
@RF00325 EQU   @RC00323
@RF00336 EQU   @RC00311
@RC00352 EQU   @RC00311
@RC00347 EQU   @RC00311
@RC00385 EQU   @RC00382
@RF00488 EQU   @EL00002
@RF00579 EQU   @EL00003
@RC00564 EQU   @EL00003
@PB00003 EQU   @EL00001
@PB00002 EQU   @PB00003
@RC00570 EQU   @RC00564
@RC00568 EQU   @RC00564
@RC00566 EQU   @RC00564
@ENDDATA EQU   *
         END   IDCPR01,(C'PLS2133',0701,77067)

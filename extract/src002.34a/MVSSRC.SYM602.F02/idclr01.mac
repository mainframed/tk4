         TITLE '************** IDCLR01: IDCAMS LISTCRA ROUTINE *********
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCLR01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCLR01   78.073'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         LA    @09,4095(,@10)                                      0002
         LA    @08,4095(,@09)                                      0002
         LA    @07,4095(,@08)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@09                                   0002
         USING @PSTART+16380,@08                                   0002
         USING @PSTART+20475,@07                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @06,@01                                             0002
         LA    @05,4095(,@06)                                      0002
         USING @DATD,@06                                           0002
         USING @DATD+4095,@05                                      0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @06,8(,@13)                                         0002
         LR    @13,@06                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
* /*******************************************************************/
* /* PROCEDURE NAME - AATOPLR, TOP SEGMENT SKELETON OF WHOLE         */
* /* FUNCTION -                                                      */
* /*  IF ASKED FOR COMPARE OPEN THE CATALOG AS A DATASET,            */
* /*  LOOP THRU ALL CRAS SPECIFIED IN INFILE:                        */
* /*    OPEN CRA AND BUILD A CRACI VS. CATCI & ENTYPE TABLE,         */
* /*    IF SEQUENTIALDUMP PRINT RECORDS AS THE TABLE IS BUILT        */
* /*    TO AVOID DOUBLE I/O,                                         */
* /*    IF NOT SEQUENTIALDUMP,                                       */
* /*      PRINT (AND OPTIONALLY COMPARE) VOLUME RECORD WITH ALL      */
* /*      ITS EXTENSION RECORDS AND F4DSCB INFO,                     */
* /*      INITIALIZE SORT TO ALPHABETIZE VSAM ENTRIES (CLUSTER       */
* /*      AND ALTERNATE INDEX)  AND IF SORT WORKED PRINT             */
* /*      (COMPARE) THEM IN ALPHA ORDER WITH ALL OF THEIR            */
* /*      ASSOCIATED RECORDS  AND USE SORT AGAIN ON ALL              */
* /*      OTHER ENTRIES (NONVSAM, GDG BASE, AND USERCATPTR)          */
* /*      AND IF SORT WORKED PRINT (COMPARE) THEM,                   */
* /*      PASS THRU TABLE PRINTING EVERYTHING NOT YET PRINTED,       */
* /*    CLOSE THE CRA AND PRINT A COMPLETION MESSAGE,                */
* /*  CLEANUP EVERYTHING AND PRINT OVERALL COMPLETION MESSAGE        */
* /* INPUTS -                                                        */
* /*   FDT (PARSED USER LISTCRA COMMAND PARAMETERS)                  */
* /*   CRAS AND CATALOG (OPTIONAL)                                   */
* /* OUTPUTS -                                                       */
* /*   CRA LISTING PER USER SPECIFIED OPTIONS                        */
* /*******************************************************************/
*                                                                  0172
* OLDERID2 = NEWERID2;                                             0172
         L     @04,@PC00001                                        0172
         L     @15,GDTTR2(,@04)                                    0172
         MVC   @TS00001(95),NEWERID2(@15)                          0172
         MVC   OLDERID2(95,@15),@TS00001                           0172
* NEWID2 = 'LRAA' ;                                                0173
         MVC   NEWID2(4,@15),@CC01157                              0173
* IF GDTDBG = NULLPTR                                              0174
*   THEN;                                                          0174
         L     @04,GDTDBG(,@04)                                    0174
         LTR   @04,@04                                             0174
         BZ    @RT00174                                            0174
*   ELSE                                                           0176
*     CALL IDCDB010 (GDTTBL,'LRAA') ;                              0176
*                                                                  0176
         L     @04,@PC00001                                        0176
         ST    @04,@AL00001                                        0176
         LA    @15,@CC01157                                        0176
         ST    @15,@AL00001+4                                      0176
         MVI   @AL00001+4,X'80'                                    0176
         L     @15,GDTDBG(,@04)                                    0176
         LA    @01,@AL00001                                        0176
         BALR  @14,@15                                             0176
* CALL INITLZE ;                   /* DO GENERAL INITIALIZE          */
*                                                                  0177
@RT00174 BAL   @14,INITLZE                                         0177
* IF ADDR(CMPR) ^= '0'B                                            0178
*   THEN                                                           0178
*                                                                  0178
         L     @02,@PC00001+4                                      0178
         L     @02,FDTPTR+4(,@02)                                  0178
         LTR   @02,@02                                             0178
         BZ    @RF00178                                            0178
*     CALL CATOPEN ;               /* OPEN THE CATALOG               */
*                                                                  0179
         BAL   @14,CATOPEN                                         0179
* DO CRACNT = 1 TO IFILECNT ;      /*************** CRA LOOP         */
*                                                                  0180
@RF00178 LA    @02,1                                               0180
         B     @DE00180                                            0180
@DL00180 DS    0H                                                  0181
*   CALL CRAOPEN ;                 /* OPEN ONE OF THE CRAS           */
         BAL   @14,CRAOPEN                                         0181
*                                  /* PRINT DONE HERE IF SEQDUMP     */
*   IF     SDUMPSW ^= ON                                           0182
*      & CRAOPNSW = ON                                             0182
*      & FMUCTTP ^= '0'B           /* FMUCTTP (PTR) NOT 0 IF CTT     */
*     THEN                         /* WAS BUILT OK                   */
         TM    SDUMPSW,B'00000010'                                 0182
         BO    @RF00182                                            0182
         TM    CRAOPNSW,B'00010000'                                0182
         BNO   @RF00182                                            0182
         L     @02,FMUCTTP                                         0182
         LTR   @02,@02                                             0182
         BZ    @RF00182                                            0182
*       DO ;                                                       0183
*                                                                  0183
*         CALL PRTVOL ;            /* PRINT THE VOLUME SET           */
*                                                                  0184
         BAL   @14,PRTVOL                                          0184
*         ENTYPARG(1) = CATRCTYP($CLUS) ;                          0185
         LA    @02,5                                               0185
         SLR   @01,@01                                             0185
         IC    @01,$CLUS                                           0185
         MR    @00,@02                                             0185
         LA    @15,CATRCTYP-5(@01)                                 0185
         MVC   ENTYPARG(1),0(@15)                                  0185
*         ENTYPARG(2) = CATRCTYP($AIX) ;                           0186
*                                                                  0186
         LR    @01,@02                                             0186
         SLR   @02,@02                                             0186
         IC    @02,$AIX                                            0186
         MR    @00,@02                                             0186
         LA    @02,CATRCTYP-5(@01)                                 0186
         MVC   ENTYPARG+1(1),0(@02)                                0186
*         CALL INTSORT (2,ENTYPARG); /*INIT SORT TABLE (VSAM)        */
*                                                                  0187
         LA    @02,@CF00158                                        0187
         ST    @02,@AL00001                                        0187
         LA    @02,ENTYPARG                                        0187
         ST    @02,@AL00001+4                                      0187
         LA    @01,@AL00001                                        0187
         BAL   @14,INTSORT                                         0187
*         IF SORTOKSW = YES                                        0188
*           THEN                                                   0188
         TM    SORTOKSW,B'00000001'                                0188
         BNO   @RF00188                                            0188
*             DO ;                                                 0189
*                                                                  0189
*               CALL MEMSORT ;     /* SORT VSAM ENTRIES              */
*                                                                  0190
         BAL   @14,MEMSORT                                         0190
*               CALL DOVSAM ;      /* PRINT (COMPARE) VSAMS          */
*                                                                  0191
         BAL   @14,DOVSAM                                          0191
*               ENTYPARG(1) = CATRCTYP($NONV) ;                    0192
         LA    @02,5                                               0192
         SLR   @01,@01                                             0192
         IC    @01,$NONV                                           0192
         MR    @00,@02                                             0192
         LA    @15,CATRCTYP-5(@01)                                 0192
         MVC   ENTYPARG(1),0(@15)                                  0192
*               ENTYPARG(2) = CATRCTYP($GDGB) ;                    0193
         SLR   @01,@01                                             0193
         IC    @01,$GDGB                                           0193
         MR    @00,@02                                             0193
         LA    @15,CATRCTYP-5(@01)                                 0193
         MVC   ENTYPARG+1(1),0(@15)                                0193
*               ENTYPARG(3) = CATRCTYP($UCAT) ;                    0194
*                                                                  0194
         LR    @01,@02                                             0194
         SLR   @02,@02                                             0194
         IC    @02,$UCAT                                           0194
         MR    @00,@02                                             0194
         LA    @02,CATRCTYP-5(@01)                                 0194
         MVC   ENTYPARG+2(1),0(@02)                                0194
*               CALL INTSORT (3,ENTYPARG) ; /* SORTTBL OTHER         */
*                                                                  0195
         LA    @02,@CF00166                                        0195
         ST    @02,@AL00001                                        0195
         LA    @02,ENTYPARG                                        0195
         ST    @02,@AL00001+4                                      0195
         LA    @01,@AL00001                                        0195
         BAL   @14,INTSORT                                         0195
*               IF SORTOKSW = YES                                  0196
*                 THEN                                             0196
         TM    SORTOKSW,B'00000001'                                0196
         BNO   @RF00196                                            0196
*                   DO ;                                           0197
*                                                                  0197
*                     CALL MEMSORT;/* SORT OTHER ENTRIES             */
*                                                                  0198
         BAL   @14,MEMSORT                                         0198
*                     CALL DOOTHR; /* PRINT (COMPARE) OTHER          */
*                                                                  0199
         BAL   @14,DOOTHR                                          0199
*                   END ;                                          0200
*             END ;                                                0201
*                                                                  0201
@RF00196 DS    0H                                                  0202
*         CALL PRTFIFO ;           /* PRINT ALL NOT PRINTED          */
*                                                                  0202
@RF00188 BAL   @14,PRTFIFO                                         0202
*       END ;                                                      0203
*   IF CRAOPNSW = ON                                               0204
*                                                                  0204
*     THEN CALL CLENCRA ;          /* CLEAN UP CRA STUFF             */
*                                                                  0204
@RF00182 TM    CRAOPNSW,B'00010000'                                0204
         BNO   @RF00204                                            0204
         BAL   @14,CLENCRA                                         0205
* END ;                                                            0206
*                                                                  0206
@RF00204 LA    @02,1                                               0206
         L     @15,CRACNT-1                                        0206
         LA    @15,0(,@15)                                         0206
         ALR   @02,@15                                             0206
@DE00180 STCM  @02,7,CRACNT                                        0206
         L     @15,@PC00001+4                                      0206
         L     @01,FDTPTR(,@15)                                    0206
         CH    @02,IFILECNT(,@01)                                  0206
         BNH   @DL00180                                            0206
* CALL CLEANUP ;                                                   0207
*                                                                  0207
         BAL   @14,CLEANUP                                         0207
* LASTCC = LRLASTCC ;                                              0208
*                                                                  0208
         L     @04,@PC00001+8                                      0208
         LH    @15,LRLASTCC                                        0208
         STH   @15,LASTCC(,@04)                                    0208
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                            0209
         L     @15,@PC00001                                        0209
         ST    @15,@AL00001                                        0209
         LA    @14,MODID                                           0209
         ST    @14,@AL00001+4                                      0209
         ST    @04,@AL00001+8                                      0209
         MVI   @AL00001+8,X'80'                                    0209
         L     @15,GDTEPL(,@15)                                    0209
         LA    @01,@AL00001                                        0209
         BALR  @14,@15                                             0209
* /*******************************************************************/
* /* PROCEDURE NAME - ADDASOC, ADD AN ASSOC TO ASSOCTBL              */
* /* FUNCTION -                                                      */
* /*   FOR THE RECORD IDENTIFIED BY CIFRGET CALL INITASOC TO         */
* /*   BUILD AN ASSOCTB2,                                            */
* /*   SEARCH IT FOR THE ASSOCIATION DESIRED AND IF FOUND            */
* /*   ADD IT AND ITS CI TO THE ASSOCTBL ADDING ALSO ANOTHER         */
* /*   TABLE TO THE CHAIN IF THE LAST ONE WAS FULL                   */
* /* INPUTS -                                                        */
* /*   ASOCDSRD (ASSOCIATION DESIRED TO BE ADDED)                    */
* /*   CIFRGET (IDENTIFIES RECORD  ASSOCIATION MAY BE IN)            */
* /* OUTPUTS -                                                       */
* /*   ENTRY ADDED TO THE ASSOCTBL IF FOUND IN THE RECORD            */
* /* CALLS -                                                         */
* /*   INTASOC, UGPOOL, ERROR                                        */
* /*******************************************************************/
*                                                                  0210
*ADDASOC: PROCEDURE (ASOCDSRD) ;                                   0210
@EL00001 L     @13,4(,@13)                                         0210
@EF00001 L     @00,@SIZDATD                                        0210
         LR    @01,@06                                             0210
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0210
         BR    @14                                                 0210
ADDASOC  STM   @14,@12,@SA00002                                    0210
         MVC   @PC00002(4),0(@01)                                  0210
* OLDERID2 = NEWERID2;                                             0211
         L     @15,@PC00001                                        0211
         L     @14,GDTTR2(,@15)                                    0211
         MVC   @TS00001(95),NEWERID2(@14)                          0211
         MVC   OLDERID2(95,@14),@TS00001                           0211
* NEWID2 = 'LRAD' ;                                                0212
         MVC   NEWID2(4,@14),@CC01175                              0212
* IF GDTDBG = NULLPTR                                              0213
*   THEN;                                                          0213
         L     @15,GDTDBG(,@15)                                    0213
         LTR   @15,@15                                             0213
         BZ    @RT00213                                            0213
*   ELSE                                                           0215
*     CALL IDCDB010 (GDTTBL,'LRAD') ;                              0215
*                                                                  0215
         L     @15,@PC00001                                        0215
         ST    @15,@AL00001                                        0215
         LA    @14,@CC01175                                        0215
         ST    @14,@AL00001+4                                      0215
         MVI   @AL00001+4,X'80'                                    0215
         L     @15,GDTDBG(,@15)                                    0215
         LA    @01,@AL00001                                        0215
         BALR  @14,@15                                             0215
* DCL ASOCDSRD CHAR(1) ;           /* ASSOCIATION DESIRED            */
*                                                                  0216
@RT00213 DS    0H                                                  0217
* ADPTRSAV = ATRA2PTR ;            /* SAVE PTR TO CURNT ASOC         */
         L     @15,ATRA2PTR                                        0217
         ST    @15,ADPTRSAV                                        0217
* ATRA2PTR = A2PTR ;                                               0218
*                                                                  0218
         L     @15,A2PTR                                           0218
         ST    @15,ATRA2PTR                                        0218
* CALL INTASOC(1) ;                /* BUILD ASSOCTB2 THEN            */
*                                                                  0219
         LA    @01,@AL00219                                        0219
         BAL   @14,INTASOC                                         0219
* /*******************************************************************/
* /* LOOP: LOOK FOR DESIRED ASSOCIATION TYPE                         */
* /*******************************************************************/
*                                                                  0220
* DO A2SLOT = 1 TO NBRATS                                          0220
*    WHILE (A2ENTYP(A2SLOT) ^= ASOCDSRD                            0220
*       & A2CRACI(A2SLOT) ^= '0'B                                  0220
*       & LASTATSW ^= ON) ;                                        0220
         LA    A2SLOT,1                                            0220
@DL00220 L     @04,ATRA2PTR                                        0220
         LR    @02,A2SLOT                                          0220
         SLA   @02,2                                               0220
         L     @15,@PC00002                                        0220
         ST    @02,@TF00001                                        0220
         ALR   @02,@04                                             0220
         CLC   A2ENTYP-4(1,@02),ASOCDSRD(@15)                      0220
         BE    @DC00220                                            0220
         L     @02,@TF00001                                        0220
         L     @02,A2CRACI-5(@02,@04)                              0220
         LA    @02,0(,@02)                                         0220
         LTR   @02,@02                                             0220
         BZ    @DC00220                                            0220
         TM    LASTATSW,B'00100000'                                0220
         BO    @DC00220                                            0220
*   IF A2SLOT = NBRATS             /* IF END OF TABLE                */
*     THEN                                                         0221
         C     A2SLOT,@CF00038                                     0221
         BNE   @RF00221                                            0221
*       IF A2NXTTBL ^= '0'B        /* AND IS ANOTHER ONE             */
*         THEN                                                     0222
         L     @04,A2NXTTBL(,@04)                                  0222
         LTR   @04,@04                                             0222
         BZ    @RF00222                                            0222
*           DO ;                                                   0223
*             ATRA2PTR = A2NXTTBL; /* BUMP TO NEXT TABLE             */
         ST    @04,ATRA2PTR                                        0224
*             A2SLOT = 0 ;         /* TO SEARCH IT ALSO              */
         SLR   A2SLOT,A2SLOT                                       0225
*           END ;                                                  0226
*         ELSE LASTATSW = ON ;                                     0227
         B     @RC00222                                            0227
@RF00222 OI    LASTATSW,B'00100000'                                0227
* END ;                                                            0228
@RC00222 DS    0H                                                  0228
@RF00221 AL    A2SLOT,@CF00222                                     0228
         C     A2SLOT,@CF00038                                     0228
         BNH   @DL00220                                            0228
@DC00220 DS    0H                                                  0229
*  LASTATSW = OFF ;                                                0229
         NI    LASTATSW,B'11011111'                                0229
* IF A2ENTYP(A2SLOT) = ASOCDSRD    /* IF ASSOCIATION DESIRED         */
*   THEN                           /* WAS FOUND SET UP TO            */
         L     @04,ATRA2PTR                                        0230
         LR    @02,A2SLOT                                          0230
         SLA   @02,2                                               0230
         L     @15,@PC00002                                        0230
         ALR   @02,@04                                             0230
         CLC   A2ENTYP-4(1,@02),ASOCDSRD(@15)                      0230
         BNE   @RF00230                                            0230
*     DO ;                         /* ADD IT TO THE ASSOCTBL         */
*       A2PTRSAV = ATRA2PTR ;                                      0232
         L     @02,ATRA2PTR                                        0232
         ST    @02,A2PTRSAV                                        0232
*       ATRA2PTR = ATPTR ;         /* SAVE PTR TO CURNT ASO2         */
         L     @02,ATPTR                                           0233
         ST    @02,ATRA2PTR                                        0233
*       ADATSLOT = 1 ;             /* FIND LAST SLOT TO INSRT        */
*                                                                  0234
         LA    ADATSLOT,1                                          0234
*       /*************************************************************/
*       /* LOOP: LOOK FOR NEXT EMPTY SLOT IN ASSOCIATION TABL        */
*       /*************************************************************/
*                                                                  0235
*       DO UNTIL (ATCRACI(ADATSLOT) = '0'B                         0235
*              × LASTATSW = ON) ;                                  0235
@DL00235 DS    0H                                                  0236
*         IF ADATSLOT = NBRATS     /*IF AT END OF TABLE              */
*           THEN                                                   0236
         CL    ADATSLOT,@CF00038                                   0236
         BNE   @RF00236                                            0236
*             IF ATNXTTBL ^= '0'B  /* AND IS ANOTHER ONE             */
*               THEN                                               0237
         L     @02,ATRA2PTR                                        0237
         L     @02,ATNXTTBL(,@02)                                  0237
         LTR   @02,@02                                             0237
         BZ    @RF00237                                            0237
*                 DO ;                                             0238
*                   ATRA2PTR = ATNXTTBL ;    /* BUMP TO NEXT         */
         ST    @02,ATRA2PTR                                        0239
*                   ADATSLOT = 0 ;                                 0240
         SLR   ADATSLOT,ADATSLOT                                   0240
*                 END ;                                            0241
*               ELSE LASTATSW = ON ;         /* LAST ONE FULL        */
         B     @RC00237                                            0242
@RF00237 OI    LASTATSW,B'00100000'                                0242
*         ADATSLOT = ADATSLOT + 1 ;                                0243
@RC00237 DS    0H                                                  0243
@RF00236 LA    ADATSLOT,1(,ADATSLOT)                               0243
*       END ;                                                      0244
@DE00235 LR    @02,ADATSLOT                                        0244
         SLL   @02,2                                               0244
         L     @01,ATRA2PTR                                        0244
         L     @02,ATCRACI-5(@02,@01)                              0244
         LA    @02,0(,@02)                                         0244
         LTR   @02,@02                                             0244
         BZ    @DC00235                                            0244
         TM    LASTATSW,B'00100000'                                0244
         BNO   @DL00235                                            0244
@DC00235 DS    0H                                                  0245
*       IF LASTATSW = ON                                           0245
*         THEN                     /* LAST TABLE WAS FULL SO         */
         TM    LASTATSW,B'00100000'                                0245
         BNO   @RF00245                                            0245
*           DO ;                   /* MUST ADD ANOTHER TO            */
*             LASTATSW = OFF ;     /* THE CHAIN OF TABLES            */
*                                                                  0247
         NI    LASTATSW,B'11011111'                                0247
*             CALL IDCSAGP0 (GDTTBL,ATLEN,ATPTRNXT,MODID,SETZERO) ;
*                                                                  0248
         MVC   @AL00001+4(16),@AL00248                             0248
         L     @02,@PC00001                                        0248
         ST    @02,@AL00001                                        0248
         LA    @15,ATPTRNXT                                        0248
         ST    @15,@AL00001+8                                      0248
         L     @15,GDTGPL(,@02)                                    0248
         LA    @01,@AL00001                                        0248
         BALR  @14,@15                                             0248
*             RESPECIFY RTNREG RSTD;                               0249
*             TESTRC = RTNREG;                                     0250
         STH   RTNREG,TESTRC                                       0250
*             RESPECIFY RTNREG UNRSTD ;                            0251
*             IF TESTRC = 0                                        0252
*               THEN                                               0252
         LH    @02,TESTRC                                          0252
         LTR   @02,@02                                             0252
         BNZ   @RF00252                                            0252
*                 DO ;                                             0253
*                   ATPTRNXT -> ATNAME = 'ASOC' ;                  0254
         L     @02,ATPTRNXT                                        0254
         MVC   ATNAME(4,@02),@CC01177                              0254
*                   ATNXTTBL = ATPTRNXT ;                          0255
         L     @01,ATRA2PTR                                        0255
         ST    @02,ATNXTTBL(,@01)                                  0255
*                   ATRA2PTR = ATNXTTBL ;                          0256
         ST    @02,ATRA2PTR                                        0256
*                   ADATSLOT = 1 ;                                 0257
         LA    ADATSLOT,1                                          0257
*                 END ;                                            0258
*               ELSE CALL ERROR (NBRETE,$ABORT) ; /* NO MEMRY        */
         B     @RC00252                                            0259
@RF00252 LA    @01,@AL00259                                        0259
         BAL   @14,ERROR                                           0259
*           END ;                                                  0260
@RC00252 DS    0H                                                  0261
*                                  /* PUT FOUND ASSOC IN TBL         */
*       ATASOC(ADATSLOT) = A2PTRSAV -> A2ASOC(A2SLOT) ;            0261
@RF00245 LR    @02,ADATSLOT                                        0261
         SLL   @02,2                                               0261
         L     @01,ATRA2PTR                                        0261
         ALR   @01,@02                                             0261
         LR    @02,A2SLOT                                          0261
         SLA   @02,2                                               0261
         L     @15,A2PTRSAV                                        0261
         ALR   @15,@02                                             0261
         MVC   ATASOC-4(4,@01),A2ASOC-4(@15)                       0261
*     END ;                                                        0262
* ATRA2PTR = ADPTRSAV ;                                            0263
*                                                                  0263
@RF00230 L     @04,ADPTRSAV                                        0263
         ST    @04,ATRA2PTR                                        0263
*END ADDASOC ;                                                     0264
@EL00002 DS    0H                                                  0264
@EF00002 DS    0H                                                  0264
@ER00002 LM    @14,@12,@SA00002                                    0264
         BR    @14                                                 0264
* /*******************************************************************/
* /* PROCEDURE NAME - BLDVEXT, BUILD THE VEXTTBL                     */
* /* FUNCTION -                                                      */
* /*   ELIMINATE DUPLICATE EXTENSION POINTERS,                       */
* /*   MOVE EXTENSION CI,S INTO THE VEXTTBL,                         */
* /*   WHEN VEXTTBL IS FULL GET MEMORY FOR ANOTHER AND CHAIN         */
* /*   IT OFF THE PREVIOUS ONE                                       */
* /* INPUTS -                                                        */
* /*   VEXTTBL TABLE(S)                                              */
* /*   CIFRTRNS (CI OF EXTENSION RECORD)                             */
* /*   VESLOTB (INCREMENTED HERE FOR LOOP IN INTVEXT)                */
* /* OUTPUTS -                                                       */
* /*   ENTRY IN VEXTTBL AND MAYBE NEW VEXTTBL ADDED TO CHAIN         */
* /* CALLS -                                                         */
* /*   UGPOOL, ERROR                                                 */
* /*******************************************************************/
*                                                                  0265
*BLDVEXT: PROCEDURE ;                                              0265
BLDVEXT  STM   @14,@01,@SA00003                                    0265
         STM   @03,@12,@SA00003+16                                 0265
* OLDERID2 = NEWERID2;                                             0266
         L     @04,@PC00001                                        0266
         L     @03,GDTTR2(,@04)                                    0266
         MVC   @TS00001(95),NEWERID2(@03)                          0266
         MVC   OLDERID2(95,@03),@TS00001                           0266
* NEWID2 = 'LRBL' ;                                                0267
         MVC   NEWID2(4,@03),@CC01183                              0267
* IF GDTDBG = NULLPTR                                              0268
*   THEN;                                                          0268
         L     @04,GDTDBG(,@04)                                    0268
         LTR   @04,@04                                             0268
         BZ    @RT00268                                            0268
*   ELSE                                                           0270
*     CALL IDCDB010 (GDTTBL,'LRBL') ;                              0270
*                                                                  0270
         L     @04,@PC00001                                        0270
         ST    @04,@AL00001                                        0270
         LA    @03,@CC01183                                        0270
         ST    @03,@AL00001+4                                      0270
         MVI   @AL00001+4,X'80'                                    0270
         L     @15,GDTDBG(,@04)                                    0270
         LA    @01,@AL00001                                        0270
         BALR  @14,@15                                             0270
* VEDUPSW = OFF ;                                                  0271
@RT00268 NI    VEDUPSW,B'01111111'                                 0271
* VEPTRSAV = VEPTR ;                                               0272
         L     VEPTRSAV,VEPTR                                      0272
* VEPTR = VEPTRBEG  ;                                              0273
*                                                                  0273
         L     @03,VEPTRBEG                                        0273
         ST    @03,VEPTR                                           0273
* /*******************************************************************/
* /* LOOP: LOOK THRU EXISTING VERTICAL EXTENSIONS TABLE              */
* /*       TO SEE IF THIS EXTENSION CI IS ALREADY THERE              */
* /*******************************************************************/
*                                                                  0274
* DO VECKSLOT = 1 TO NBRVES WHILE(VECRACI(VECKSLOT) ^= '0'B) ;     0274
         LA    VECKSLOT,1                                          0274
@DL00274 L     @15,VEPTR                                           0274
         LR    @14,VECKSLOT                                        0274
         SLA   @14,2                                               0274
         L     @01,VECRACI-5(@14,@15)                              0274
         LA    @01,0(,@01)                                         0274
         LTR   @01,@01                                             0274
         BZ    @DC00274                                            0274
*   IF VECRACI(VECKSLOT) = CIFRTRNS                                0275
*     THEN                                                         0275
         ALR   @15,@14                                             0275
         CLC   VECRACI-4(3,@15),CIFRTRNS                           0275
         BNE   @RF00275                                            0275
*       DO ;                                                       0276
*         VEDUPSW = ON ;           /* DUPLICATE FOUND SO             */
         OI    VEDUPSW,B'10000000'                                 0277
*         VECKSLOT = NBRVES + 1 ;  /* GET OUT OF LOOP NOW            */
         LA    VECKSLOT,10                                         0278
*       END ;                                                      0279
*   IF     VEDUPSW ^= ON                                           0280
*      & VECKSLOT = NBRVES                                         0280
*      & VENXTTBL ^= '0'B                                          0280
*     THEN                         /* BUMP TO NEXT TABLE             */
@RF00275 TM    VEDUPSW,B'10000000'                                 0280
         BO    @RF00280                                            0280
         C     VECKSLOT,@CF00038                                   0280
         BNE   @RF00280                                            0280
         L     @01,VEPTR                                           0280
         L     @15,VENXTTBL(,@01)                                  0280
         LTR   @15,@15                                             0280
         BZ    @RF00280                                            0280
*       DO ;                                                       0281
*         VEPTR = VENXTTBL ;                                       0282
         ST    @15,VEPTR                                           0282
*         VECKSLOT = 0 ;                                   /*@OZ20928*/
         SLR   VECKSLOT,VECKSLOT                                   0283
*       END ;                                                      0284
* END ;                                                            0285
@RF00280 AL    VECKSLOT,@CF00222                                   0285
         C     VECKSLOT,@CF00038                                   0285
         BNH   @DL00274                                            0285
@DC00274 DS    0H                                                  0286
* VEPTR = VEPTRSAV ;               /* POINT BACK TO RIGHT TBL        */
         ST    VEPTRSAV,VEPTR                                      0286
* IF VEDUPSW ^= ON                                                 0287
*   THEN                           /* NOT DUPLICATE SO ADD           */
         TM    VEDUPSW,B'10000000'                                 0287
         BO    @RF00287                                            0287
*     DO ;                         /* THIS CI TO THE VEXTTBL         */
*       VESLOTB = VESLOTB + 1 ;                                    0289
         LA    VESLOTB,1(,VESLOTB)                                 0289
*       IF VESLOTB > NBRVES                                        0290
*         THEN                                                     0290
         C     VESLOTB,@CF00038                                    0290
         BNH   @RF00290                                            0290
*           DO ;                   /* NEED ANOTHER VEXTTBL           */
*             IF VENXTTBL = '0'B   /* IS ONE ALREDY THERE            */
*               THEN                                               0292
         L     @04,VEPTR                                           0292
         L     @04,VENXTTBL(,@04)                                  0292
         LTR   @04,@04                                             0292
         BNZ   @RF00292                                            0292
*                 DO ;             /* NO, GET STORAGE FOR ONE        */
*                                                                  0293
*                   CALL IDCSAGP0 (GDTTBL,VELEN,VEPTRNXT,MODID,    0294
*                           SETZERO) ;  /* ZERO NEXT TBL PTR         */
*                                                                  0294
         MVC   @AL00001+4(16),@AL00294                             0294
         L     @04,@PC00001                                        0294
         ST    @04,@AL00001                                        0294
         LA    @15,VEPTRNXT                                        0294
         ST    @15,@AL00001+8                                      0294
         L     @15,GDTGPL(,@04)                                    0294
         LA    @01,@AL00001                                        0294
         BALR  @14,@15                                             0294
*                   RESPECIFY RTNREG RSTD;                         0295
*                   TESTRC = RTNREG;                               0296
         STH   RTNREG,TESTRC                                       0296
*                   RESPECIFY RTNREG UNRSTD ;                      0297
*                   IF TESTRC = 0                                  0298
*                     THEN                                         0298
         LH    @04,TESTRC                                          0298
         LTR   @04,@04                                             0298
         BNZ   @RF00298                                            0298
*                       DO ;                                       0299
*                         VEPTRNXT->VENAME = 'VEXT' ;              0300
         L     @04,VEPTRNXT                                        0300
         MVC   VENAME(4,@04),@CC00733                              0300
*                         VENXTTBL = VEPTRNXT ;                    0301
         L     @01,VEPTR                                           0301
         ST    @04,VENXTTBL(,@01)                                  0301
*                       END ;                                      0302
*                     ELSE CALL ERROR (NBRETE,$ABORT);/*NOMEM        */
         B     @RC00298                                            0303
@RF00298 LA    @01,@AL00303                                        0303
         BAL   @14,ERROR                                           0303
*                 END ;                                            0304
@RC00298 DS    0H                                                  0305
*             VEPTR = VENXTTBL ;   /* BUMP TO NEXT TABLE             */
@RF00292 L     @04,VEPTR                                           0305
         L     @04,VENXTTBL(,@04)                                  0305
         ST    @04,VEPTR                                           0305
*             DO VESLOTB = 1 TO NBRVES ;                           0306
         LA    VESLOTB,1                                           0306
@DL00306 DS    0H                                                  0307
*               VEEXT(VESLOTB) = '0'B ;                            0307
         LR    @04,VESLOTB                                         0307
         SLA   @04,2                                               0307
         L     @03,VEPTR                                           0307
         ALR   @03,@04                                             0307
         XC    VEEXT-3(3,@03),VEEXT-3(@03)                         0307
         MVI   VEEXT-4(@03),B'00000000'                            0307
*             END ;                                                0308
         AL    VESLOTB,@CF00222                                    0308
         C     VESLOTB,@CF00038                                    0308
         BNH   @DL00306                                            0308
*             VESLOTB = 1 ;        /* TABLE SLOT 1                   */
         LA    VESLOTB,1                                           0309
*           END ;                  /* PUT CI INTO TABLE              */
*       VECRACI(VESLOTB) = CIFRTRNS ;                              0311
@RF00290 LR    @04,VESLOTB                                         0311
         SLA   @04,2                                               0311
         L     @03,VEPTR                                           0311
         ALR   @03,@04                                             0311
         MVC   VECRACI-4(3,@03),CIFRTRNS                           0311
*     END ;                                                        0312
*   ELSE  VEDUPSW = OFF ;                                          0313
*                                                                  0313
         B     @RC00287                                            0313
@RF00287 NI    VEDUPSW,B'01111111'                                 0313
*END BLDVEXT ;                                                     0314
@EL00003 DS    0H                                                  0314
@EF00003 DS    0H                                                  0314
@ER00003 LM    @14,@01,@SA00003                                    0314
         LM    @03,@12,@SA00003+16                                 0314
         BR    @14                                                 0314
* /*******************************************************************/
* /* PROCEDURE NAME - BUFSHUF, BUFFER SHUFFEL TO 'HOME' BUFFR        */
* /* FUNCTION -                                                      */
* /*   MOVES RECORD FROM LAST BUFFER TO ITS 'HOME' POSITION          */
* /*   I.E. BUFFER 1 = CLUSTER OR AIX OR GDG BASE                    */
* /*               2 = DATA OR NONVSAM(ALIENS)                       */
* /*               3 = INDEX                                         */
* /*               4 = CURRENTLY LAST BUFFER MOVED FROM              */
* /* INPUTS -                                                        */
* /*   ENTYPSAV (IDENTIFIES RECORD TYPE IN LAST BUFFER)              */
* /*   RECORD (IN LAST BUFFER POINTED TO BY BUFNO)                   */
* /* OUTPUTS -                                                       */
* /*   RECORD IN ITS 'HOME' BUFFER                                   */
* /* CALLS - NONE                                                    */
* /*******************************************************************/
*                                                                  0315
*BUFSHUF: PROCEDURE ;                                              0315
BUFSHUF  STM   @14,@12,@SA00004                                    0315
* OLDERID2 = NEWERID2;                                             0316
         L     @04,@PC00001                                        0316
         L     @15,GDTTR2(,@04)                                    0316
         MVC   @TS00001(95),NEWERID2(@15)                          0316
         MVC   OLDERID2(95,@15),@TS00001                           0316
* NEWID2 = 'LRBU' ;                                                0317
         MVC   NEWID2(4,@15),@CC01188                              0317
* IF GDTDBG = NULLPTR                                              0318
*   THEN;                                                          0318
         L     @04,GDTDBG(,@04)                                    0318
         LTR   @04,@04                                             0318
         BZ    @RT00318                                            0318
*   ELSE                                                           0320
*     CALL IDCDB010 (GDTTBL,'LRBU') ;                              0320
*                                                                  0320
         L     @04,@PC00001                                        0320
         ST    @04,@AL00001                                        0320
         LA    @15,@CC01188                                        0320
         ST    @15,@AL00001+4                                      0320
         MVI   @AL00001+4,X'80'                                    0320
         L     @15,GDTDBG(,@04)                                    0320
         LA    @01,@AL00001                                        0320
         BALR  @14,@15                                             0320
* IF    ENTYPSAV = CATRCTYP($CLUS)                                 0321
*    × ENTYPSAV = CATRCTYP($AIX)                                   0321
*    × ENTYPSAV = CATRCTYP($GDGB)                                  0321
*   THEN                                                           0321
@RT00318 LA    @04,5                                               0321
         SLR   @01,@01                                             0321
         IC    @01,$CLUS                                           0321
         MR    @00,@04                                             0321
         LA    @15,CATRCTYP-5(@01)                                 0321
         CLC   ENTYPSAV(1),0(@15)                                  0321
         BE    @RT00321                                            0321
         SLR   @01,@01                                             0321
         IC    @01,$AIX                                            0321
         MR    @00,@04                                             0321
         LA    @15,CATRCTYP-5(@01)                                 0321
         CLC   ENTYPSAV(1),0(@15)                                  0321
         BE    @RT00321                                            0321
         LR    @01,@04                                             0321
         SLR   @04,@04                                             0321
         IC    @04,$GDGB                                           0321
         MR    @00,@04                                             0321
         LA    @04,CATRCTYP-5(@01)                                 0321
         CLC   ENTYPSAV(1),0(@04)                                  0321
         BNE   @RF00321                                            0321
@RT00321 DS    0H                                                  0322
*     DO ;                                                         0322
*       IOBUF(1,1:256) = IOBUF(BUFNO,1:256) ;                      0323
         L     @04,IOBFSPTR                                        0323
         SLR   @15,@15                                             0323
         IC    @15,BUFNO                                           0323
         SLA   @15,9                                               0323
         ST    @15,@TF00001                                        0323
         ALR   @15,@04                                             0323
         AL    @15,@CF01464                                        0323
         MVC   @TS00001(256),IOBUF(@15)                            0323
         MVC   IOBUF(256,@04),@TS00001                             0323
*       IOBUF(1,257:508) = IOBUF(BUFNO,257:508) ;                  0324
         LR    @01,@04                                             0324
         AL    @01,@TF00001                                        0324
         AL    @01,@CF01465                                        0324
         MVC   @TS00001(252),IOBUF(@01)                            0324
         MVC   IOBUF+256(252,@04),@TS00001                         0324
*       IOBUFCI(BUFNO) = STENDCI ;                                 0325
         AL    @04,@TF00001                                        0325
         AL    @04,@CF01466                                        0325
         MVC   IOBUFCI-509(3,@04),STENDCI                          0325
*       BUFNO = 1 ;                                                0326
         MVI   BUFNO,X'01'                                         0326
*     END ;                                                        0327
*   ELSE                                                           0328
*     IF    ENTYPSAV = CATRCTYP($DATA)                             0328
*        × ENTYPSAV = CATRCTYP($NONV)                              0328
*       THEN                                                       0328
         B     @RC00321                                            0328
@RF00321 LA    @04,5                                               0328
         SLR   @01,@01                                             0328
         IC    @01,$DATA                                           0328
         MR    @00,@04                                             0328
         LA    @15,CATRCTYP-5(@01)                                 0328
         CLC   ENTYPSAV(1),0(@15)                                  0328
         BE    @RT00328                                            0328
         LR    @01,@04                                             0328
         SLR   @04,@04                                             0328
         IC    @04,$NONV                                           0328
         MR    @00,@04                                             0328
         LA    @04,CATRCTYP-5(@01)                                 0328
         CLC   ENTYPSAV(1),0(@04)                                  0328
         BNE   @RF00328                                            0328
@RT00328 DS    0H                                                  0329
*         DO ;                                                     0329
*           IOBUF(2,1:256) = IOBUF(BUFNO,1:256) ;                  0330
         L     @04,IOBFSPTR                                        0330
         SLR   @15,@15                                             0330
         IC    @15,BUFNO                                           0330
         SLA   @15,9                                               0330
         ST    @15,@TF00001                                        0330
         ALR   @15,@04                                             0330
         AL    @15,@CF01464                                        0330
         MVC   @TS00001(256),IOBUF(@15)                            0330
         MVC   IOBUF+512(256,@04),@TS00001                         0330
*           IOBUF(2,257:508) = IOBUF(BUFNO,257:508) ;              0331
         LR    @01,@04                                             0331
         AL    @01,@TF00001                                        0331
         AL    @01,@CF01465                                        0331
         MVC   @TS00001(252),IOBUF(@01)                            0331
         MVC   IOBUF+768(252,@04),@TS00001                         0331
*           IOBUFCI(BUFNO) = STENDCI ;                             0332
         AL    @04,@TF00001                                        0332
         AL    @04,@CF01466                                        0332
         MVC   IOBUFCI-509(3,@04),STENDCI                          0332
*           BUFNO = 2 ;                                            0333
         MVI   BUFNO,X'02'                                         0333
*         END ;                                                    0334
*       ELSE                                                       0335
*         IF ENTYPSAV = CATRCTYP($INDX)                            0335
*           THEN                                                   0335
         B     @RC00328                                            0335
@RF00328 SLR   @04,@04                                             0335
         IC    @04,$INDX                                           0335
         MH    @04,@CH00042                                        0335
         LA    @01,CATRCTYP-5(@04)                                 0335
         CLC   ENTYPSAV(1),0(@01)                                  0335
         BNE   @RF00335                                            0335
*             DO ;                                                 0336
*               IOBUF(3,1:256) = IOBUF(BUFNO,1:256) ;              0337
         L     @04,IOBFSPTR                                        0337
         SLR   @15,@15                                             0337
         IC    @15,BUFNO                                           0337
         SLA   @15,9                                               0337
         ST    @15,@TF00001                                        0337
         ALR   @15,@04                                             0337
         AL    @15,@CF01464                                        0337
         MVC   @TS00001(256),IOBUF(@15)                            0337
         MVC   IOBUF+1024(256,@04),@TS00001                        0337
*               IOBUF(3,257:508)=IOBUF(BUFNO,257:508) ;            0338
         LR    @01,@04                                             0338
         AL    @01,@TF00001                                        0338
         AL    @01,@CF01465                                        0338
         MVC   @TS00001(252),IOBUF(@01)                            0338
         MVC   IOBUF+1280(252,@04),@TS00001                        0338
*               IOBUFCI(BUFNO) = 'FFFFFF'X ;                       0339
         AL    @04,@TF00001                                        0339
         AL    @04,@CF01466                                        0339
         MVC   IOBUFCI-509(3,@04),@CF00897+1                       0339
*               BUFNO = 3 ;                                        0340
         MVI   BUFNO,X'03'                                         0340
*             END ;                                                0341
* IOBUFCI(BUFNO) = CIFRGET ;                                       0342
*                                                                  0342
@RF00335 DS    0H                                                  0342
@RC00328 DS    0H                                                  0342
@RC00321 SLR   @04,@04                                             0342
         IC    @04,BUFNO                                           0342
         SLA   @04,9                                               0342
         L     @01,IOBFSPTR                                        0342
         ALR   @01,@04                                             0342
         AL    @01,@CF01466                                        0342
         MVC   IOBUFCI-509(3,@01),CIFRGET                          0342
*END BUFSHUF ;                                                     0343
@EL00004 DS    0H                                                  0343
@EF00004 DS    0H                                                  0343
@ER00004 LM    @14,@12,@SA00004                                    0343
         BR    @14                                                 0343
* /*******************************************************************/
* /* PROCEDURE NAME - CATOPEN                                        */
* /* FUNCTION -                                                      */
* /*   OPEN THE CATALOG AS A DATA SET, ISSUE A VERIFY FOR IT,        */
* /*   USE FIELD MGMT TO GET CATALOG NAME FROM CLUSTER RCD,          */
* /*   IF DOS GET VOLSER AND ENQ ON IT OR                            */
* /*   IF OS GET UCB AND RESERVE ON SPECIAL NAME(MAJOR) AND          */
* /*   CATALOG NAME(MINOR)                                           */
* /* INPUTS -                                                        */
* /*   CAT PARAMETERS IN THE FDT                                     */
* /*   CATALOG                                                       */
* /* OUTPUTS -                                                       */
* /*   TESTRC                                                        */
* /*   CMPR SET TO ZERO TO FORCE NOCOMPARE IF OPEN FAILS             */
* /* CALLS -                                                         */
* /*   UOPEN, UVERIFY, ONLY), ERROR,                                 */
* /*   UENQ (DOS), USYSINFO AND URESERVE (OS)                        */
* /*   IDCRC04(ENTNAME)                                              */
* /*******************************************************************/
*                                                                  0344
*CATOPEN: PROCEDURE ;                                              0344
CATOPEN  STM   @14,@12,@SA00005                                    0344
*   OLDERID2 = NEWERID2;                                           0345
         L     @02,@PC00001                                        0345
         L     @15,GDTTR2(,@02)                                    0345
         MVC   @TS00001(95),NEWERID2(@15)                          0345
         MVC   OLDERID2(95,@15),@TS00001                           0345
*   NEWID2 = 'LRCA' ;                                              0346
         MVC   NEWID2(4,@15),@CC01193                              0346
*   IF GDTDBG = NULLPTR                                            0347
*     THEN;                                                        0347
         L     @02,GDTDBG(,@02)                                    0347
         LTR   @02,@02                                             0347
         BZ    @RT00347                                            0347
*     ELSE                                                         0349
*       CALL IDCDB010 (GDTTBL,'LRCA') ;                            0349
*                                                                  0349
         L     @02,@PC00001                                        0349
         ST    @02,@AL00001                                        0349
         LA    @15,@CC01193                                        0349
         ST    @15,@AL00001+4                                      0349
         MVI   @AL00001+4,X'80'                                    0349
         L     @15,GDTDBG(,@02)                                    0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*   OPNAGL = '0'B ;                /* SET UP TO DO OPEN              */
@RT00347 XC    OPNAGL+1(47,OPNPTR),OPNAGL+1(OPNPTR)                0350
         MVI   OPNAGL(OPNPTR),B'00000000'                          0350
*    OPNOPTIN = ON ;            /* ACB - IN                       */
*    OPNOPTBK = ON ;            /* ACB - CNV (NOT A BLOCK)        */
*    OPNOPTDR = ON ;            /* ACB - DIR                      */
         OI    OPNOPTIN(OPNPTR),B'10010010'                        0353
*    OPNDSOAM = ON ;            /* DSORG - VSAM                   */
         OI    OPNDSOAM(OPNPTR),B'10000000'                        0354
*   OPNDDN = ADDR(CATDNVAL) ;      /* CATALOG DNAME                  */
         L     @02,@PC00001+4                                      0355
         L     @01,FDTPTR+28(,@02)                                 0355
         LA    @15,CATDNVAL(,@01)                                  0355
         ST    @15,OPNDDN(,OPNPTR)                                 0355
*   OPNPWA = ADDR(CATNMPAS) ;      /* CATALOG,S PASSWORD             */
         L     @02,FDTPTR+24(,@02)                                 0356
         LA    @02,CATNMPAS(,@02)                                  0356
         ST    @02,OPNPWA(,OPNPTR)                                 0356
*   OPNIOC = ADDR(IOCSCAT) ;       /* RETURN ADDR OF IOCS            */
*                                                                  0357
         LA    @02,IOCSCAT                                         0357
         ST    @02,OPNIOC(,OPNPTR)                                 0357
*   CALL IDCIOOP0 (GDTTBL,OPNAGL) ;                                0358
*                                                                  0358
         L     @02,@PC00001                                        0358
         ST    @02,@AL00001                                        0358
         ST    OPNPTR,@AL00001+4                                   0358
         MVI   @AL00001+4,X'80'                                    0358
         L     @15,GDTOPN(,@02)                                    0358
         LA    @01,@AL00001                                        0358
         BALR  @14,@15                                             0358
*   RESPECIFY RTNREG RSTD;                                         0359
*   TESTRC = RTNREG;                                               0360
         STH   RTNREG,TESTRC                                       0360
*   RESPECIFY RTNREG UNRSTD ;                                      0361
*   IF TESTRC = 0                                                  0362
*     THEN                                                         0362
         LH    @02,TESTRC                                          0362
         LTR   @02,@02                                             0362
         BNZ   @RF00362                                            0362
*       DO ;                                                       0363
*         CATNMPAS = '0'B ;        /* MINIMIZ SECURITY EXPOSR        */
         L     @02,@PC00001+4                                      0364
         L     @02,FDTPTR+24(,@02)                                 0364
         XC    CATNMPAS+1(7,@02),CATNMPAS+1(@02)                   0364
         MVI   CATNMPAS(@02),B'00000000'                           0364
*         DO BUFNO = 1 TO NBRBUF ; /* INITIALIZE BUFFER POOL         */
         LA    @02,1                                               0365
         STC   @02,BUFNO                                           0365
@DL00365 DS    0H                                                  0366
*           IOCTBPTR -> IOBUFCI(BUFNO) = '7FFFFF'X ;               0366
         LR    @15,@02                                             0366
         SLA   @15,9                                               0366
         L     @01,IOCTBPTR                                        0366
         ALR   @01,@15                                             0366
         AL    @01,@CF01466                                        0366
         MVC   IOBUFCI-509(3,@01),@CF01194+1                       0366
*         END ;                    /* TO INVALID CI,S                */
*                                                                  0367
         AL    @02,@CF00222                                        0367
         STC   @02,BUFNO                                           0367
         C     @02,@CF00047                                        0367
         BNH   @DL00365                                            0367
*         CALL IDCIOVY0 (GDTTBL,IOCSCAT);/*                        0368
*                                     NEVER CLOSED , FIND EOF        */
*                                                                  0368
         L     @02,@PC00001                                        0368
         ST    @02,@AL00001                                        0368
         LA    @15,IOCSCAT                                         0368
         ST    @15,@AL00001+4                                      0368
         MVI   @AL00001+4,X'80'                                    0368
         L     @15,GDTVFY(,@02)                                    0368
         LA    @01,@AL00001                                        0368
         BALR  @14,@15                                             0368
*         RESPECIFY RTNREG RSTD;                                   0369
*         TESTRC = RTNREG;                                         0370
         STH   RTNREG,TESTRC                                       0370
*         RESPECIFY RTNREG UNRSTD ;                                0371
*         IF TESTRC ^= 0                                           0372
*          THEN                                            /*@OZ05923*/
         LH    @02,TESTRC                                          0372
         LTR   @02,@02                                             0372
         BZ    @RF00372                                            0372
*             DO;                                          /*@OZ05923*/
*             CALL ERROR (2,$RETURN) ;   /* VERIFY FAILURE   @OZ05923*/
         LA    @01,@AL00374                                        0374
         BAL   @14,ERROR                                           0374
*             IOCSCAT->IOCMSGOP=ON;     /* SET OPEN BIT      @OZ05923*/
         L     @02,IOCSCAT                                         0375
         OI    IOCMSGOP(@02),B'00100000'                           0375
*             END;                                         /*@OZ05923*/
*         FMU1STIO = ON ;          /* SET FIELD MGMT TO GET          */
@RF00372 OI    FMU1STIO,B'10000000'                                0377
*         FMUBFPTR = IOCTBPTR ;    /* CAT NAME FROM CLUS RCD         */
         L     @02,IOCTBPTR                                        0378
         ST    @02,FMUBFPTR                                        0378
*         FMUIOCSI = IOCSCAT ;                                     0379
         L     @02,IOCSCAT                                         0379
         ST    @02,FMUIOCSI                                        0379
*         FMUCATIO = ON ;                                          0380
         OI    FMUCATIO,B'01000000'                                0380
*         FMPLBCIN = CRACLSCI ;                                    0381
         L     @02,FMPLAD                                          0381
         MVC   FMPLBCIN(3,@02),@CF00158+1                          0381
*         FMFLDNAM = ADDR('ENTNAME ') ;                            0382
         LA    @15,@CC01195                                        0382
         ST    @15,FMFLDNAM(,FMFLCUR)                              0382
*         REG1 = FMPLAD ;                                          0383
*                                                                  0383
         LR    REG1,@02                                            0383
*         CALL IDCRC04 ;                                           0384
*                                                                  0384
         L     @15,@CV00793                                        0384
         BALR  @14,@15                                             0384
*         IF FMFLENTH ^= 0                                         0385
*           THEN CATNAME = ENTNAME ;                               0385
         L     @02,FMFLENTH(,FMFLCUR)                              0385
         LTR   @02,@02                                             0385
         BZ    @RF00385                                            0385
         L     @02,FMFLADDR(,FMFLCUR)                              0386
         MVC   CATNAME(44),ENTNAME(@02)                            0386
*           ELSE                                                   0387
*             DO ;                 /* FAILED, SET DUMMY NAME         */
         B     @RC00385                                            0387
@RF00385 DS    0H                                                  0388
*               CATNAME = 'NAMEOFFIELDNOTRETURNED' ;               0388
         MVI   CATNAME+22,C' '                                     0388
         MVC   CATNAME+23(21),CATNAME+22                           0388
         MVC   CATNAME(22),@CC01196                                0388
*               PROCMSG='CATOPEN '; /* PROC NAME FOR INSERT  @OZ09388*/
         MVC   PROCMSG(8),@CC01198                                 0389
*               CALL ERROR (1,$RETURN) ;                           0390
         LA    @01,@AL00390                                        0390
         BAL   @14,ERROR                                           0390
*             END ;                                                0391
*         FMPLBCIN = CTTBASE + 1 ; /* NO CTT, NO TRANSLATE           */
@RC00385 L     @02,FMPLAD                                          0392
         MVC   FMPLBCIN(3,@02),@CF00038+1                          0392
*         REG1 = FMPLAD ;          /* GET VOLSER FOR DOS ENQ         */
*                                                                  0393
         LR    REG1,@02                                            0393
*         CALL IDCRC04 ;                                           0394
*                                                                  0394
         L     @15,@CV00793                                        0394
         BALR  @14,@15                                             0394
*         IF FMFLENTH ^= 0                                         0395
*           THEN                                                   0395
         L     @02,FMFLENTH(,FMFLCUR)                              0395
         LTR   @02,@02                                             0395
         BZ    @RF00395                                            0395
*             DO ;                                                 0396
*                                                                  0396
*               CALL IDCSASI0 (GDTTBL,UNIT,RSVUTPTR,CATDNVAL) ;    0397
*                                                                  0397
         L     @02,@PC00001                                        0397
         ST    @02,@AL00001                                        0397
         LA    @15,UNIT                                            0397
         ST    @15,@AL00001+4                                      0397
         LA    @15,RSVUTPTR                                        0397
         ST    @15,@AL00001+8                                      0397
         L     @15,@PC00001+4                                      0397
         L     @01,FDTPTR+28(,@15)                                 0397
         LA    @15,CATDNVAL(,@01)                                  0397
         ST    @15,@AL00001+12                                     0397
         MVI   @AL00001+12,X'80'                                   0397
         L     @15,GDTSFO(,@02)                                    0397
         LA    @01,@AL00001                                        0397
         BALR  @14,@15                                             0397
*               RESPECIFY RTNREG RSTD;                             0398
*               TESTRC = RTNREG;                                   0399
         STH   RTNREG,TESTRC                                       0399
*               RESPECIFY RTNREG UNRSTD ;                          0400
*               IF TESTRC = 0                                      0401
*                 THEN                                             0401
         LH    @02,TESTRC                                          0401
         LTR   @02,@02                                             0401
         BNZ   @RF00401                                            0401
*                   DO ;                                           0402
*                     IF CATNAME(21) = ' '                         0403
*                       THEN CNLEN = 20 ;                          0403
         CLI   CATNAME+20,C' '                                     0403
         BNE   @RF00403                                            0403
         MVI   CNLEN,X'14'                                         0404
*                       ELSE CNLEN = 44 ;                          0405
*                                                                  0405
         B     @RC00403                                            0405
@RF00403 MVI   CNLEN,X'2C'                                         0405
*                     CALL IDCSARV0 (GDTTBL,EXCL,WAIT,             0406
*                               RSVUTPTR -> UNITUCB,               0406
*                               RSVMJNM,RSVMINM) ;                 0406
*                                                                  0406
@RC00403 L     @02,@PC00001                                        0406
         ST    @02,@AL00001                                        0406
         LA    @15,EXCL                                            0406
         ST    @15,@AL00001+4                                      0406
         LA    @15,WAIT                                            0406
         ST    @15,@AL00001+8                                      0406
         L     @01,RSVUTPTR                                        0406
         ST    @01,@AL00001+12                                     0406
         LA    @15,RSVMJNM                                         0406
         ST    @15,@AL00001+16                                     0406
         LA    @15,RSVMINM                                         0406
         ST    @15,@AL00001+20                                     0406
         MVI   @AL00001+20,X'80'                                   0406
         L     @15,GDTRSV(,@02)                                    0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*                     RESPECIFY RTNREG RSTD;                       0407
*                     TESTRC = RTNREG;                             0408
         STH   RTNREG,TESTRC                                       0408
*                     RESPECIFY RTNREG UNRSTD ;                    0409
*                   END ;                                          0410
*             END ;                                                0411
@RF00401 DS    0H                                                  0412
*         IF FMFLENTH = 0 × TESTRC ^= 0                            0412
*           THEN CALL ERROR (3,$RETURN) ;    /* NO ENQ DONE          */
@RF00395 SLR   @02,@02                                             0412
         C     @02,FMFLENTH(,FMFLCUR)                              0412
         BE    @RT00412                                            0412
         CH    @02,TESTRC                                          0412
         BE    @RF00412                                            0412
@RT00412 DS    0H                                                  0413
         LA    @01,@AL00413                                        0413
         BAL   @14,ERROR                                           0413
*         FMU1STIO = OFF ;                                         0414
@RF00412 NI    FMU1STIO,B'01111111'                                0414
*         FMUBFPTR = IOCRBPTR ;    /* RESTORE ASSUMED VALUES         */
         L     @02,IOCRBPTR                                        0415
         ST    @02,FMUBFPTR                                        0415
*         FMUIOCSI = IOCSCRA ;                                     0416
         L     @02,IOCSCRA                                         0416
         ST    @02,FMUIOCSI                                        0416
*         FMUCATIO = OFF ;                                         0417
         NI    FMUCATIO,B'10111111'                                0417
*       END ;                                                      0418
*     ELSE                                                         0419
*       DO ;                                                       0419
         B     @RC00362                                            0419
@RF00362 DS    0H                                                  0420
*         CMPR = '0'B ;            /*FORCE NOCOMPARE HENCFRTH        */
         L     @02,@PC00001+4                                      0420
         L     @02,FDTPTR+4(,@02)                                  0420
         SLR   @15,@15                                             0420
         ST    @15,CMPR(,@02)                                      0420
*         CMPRSW = OFF ;                                           0421
         NI    CMPRSW,B'10111111'                                  0421
*         CALL ERROR (4,$RETURN) ; /* TELL COMPARE IGNORED   */    0422
         LA    @01,@AL00422                                        0422
         BAL   @14,ERROR                                           0422
*       END ;                                                      0423
*                                                                  0423
*END CATOPEN ;                                                     0424
@EL00005 DS    0H                                                  0424
@EF00005 DS    0H                                                  0424
@ER00005 LM    @14,@12,@SA00005                                    0424
         BR    @14                                                 0424
* /*******************************************************************/
* /* PROCEDURE NAME - CKEYRNG, CHECK FOR KEYRANGE                    */
* /* FUNCTION -                                                      */
* /*   DETERMINE NUMBER OF VOLUME OCCURANCES FOR LATER LOOP,         */
* /*   CHECK TO SEE IF DATA OBJECT HAS A KEYRANGE DEFINED            */
* /*   AND IF IT DOES SET UP TEXT PROCESSOR TO PRINT HIGHKEY         */
* /* INPUTS -                                                        */
* /*   CIFRGET (IDENTIFIES THE OBJECT RECORD)                        */
* /* OUTPUTS -                                                       */
* /*   NBRVOLOC                                                      */
* /*   KEYRNGSW                                                      */
* /*   A SECOND FMFL HOOKED UP FOR HIKEYV IF NEEDED                  */
* /* CALLS -                                                         */
* /*   ERROR,                                                        */
* /*   IDCRC04(HIKEYV, REPNO)                                        */
* /* CALLED BY -                                                     */
* /*   PRTOJVL                                                       */
* /*******************************************************************/
*                                                                  0425
*CKEYRNG: PROCEDURE ;                                              0425
CKEYRNG  STM   @14,@02,@SA00006                                    0425
         STM   @04,@12,@SA00006+20                                 0425
* OLDERID2 = NEWERID2;                                             0426
         L     @15,@PC00001                                        0426
         L     @14,GDTTR2(,@15)                                    0426
         MVC   @TS00001(95),NEWERID2(@14)                          0426
         MVC   OLDERID2(95,@14),@TS00001                           0426
* NEWID2 = 'LRCK' ;                                                0427
         MVC   NEWID2(4,@14),@CC01203                              0427
* IF GDTDBG = NULLPTR                                              0428
*   THEN;                                                          0428
         L     @15,GDTDBG(,@15)                                    0428
         LTR   @15,@15                                             0428
         BZ    @RT00428                                            0428
*   ELSE                                                           0430
*     CALL IDCDB010 (GDTTBL,'LRCK') ;                              0430
*                                                                  0430
         L     @15,@PC00001                                        0430
         ST    @15,@AL00001                                        0430
         LA    @14,@CC01203                                        0430
         ST    @14,@AL00001+4                                      0430
         MVI   @AL00001+4,X'80'                                    0430
         L     @15,GDTDBG(,@15)                                    0430
         LA    @01,@AL00001                                        0430
         BALR  @14,@15                                             0430
* FMPLFLNO = 1 ;                   /* SOMEONE LEFT IT = 2            */
@RT00428 L     @15,FMPLAD                                          0431
         MVI   FMPLFLNO(@15),X'01'                                 0431
* FMFLDNAM = ADDR('REPNO   ') ;                                    0432
         LA    @14,@CC01204                                        0432
         ST    @14,FMFLDNAM(,FMFLCUR)                              0432
* FMFLGRPC = CTVLOCGC ;                                            0433
         MVI   FMFLGRPC(FMFLCUR),X'03'                             0433
* FMPLFMFL(NBRFMFL) -> FMFLGRPC = CTVLOCGC ; /* RELREPNO TOO         */
         L     @01,FMPLFMFL+16(,@15)                               0434
         MVI   FMFLGRPC(@01),X'03'                                 0434
* FMPLFMFL(NBRFMFL-1) -> FMFLGRPC = CTVLOCGC ;   /* CNTREPNO         */
         L     @01,FMPLFMFL+12(,@15)                               0435
         MVI   FMFLGRPC(@01),X'03'                                 0435
* REG1 = FMPLAD ;                                                  0436
*                                                                  0436
         LR    REG1,@15                                            0436
* CALL IDCRC04 ;                                                   0437
*                                                                  0437
         L     @15,@CV00793                                        0437
         BALR  @14,@15                                             0437
* IF FMFLENTH ^= 0                 /* GET NUMBER OCCURANCES          */
*   THEN NBRVOLOC = REPNO ;                                        0438
         L     @15,FMFLENTH(,FMFLCUR)                              0438
         LTR   @15,@15                                             0438
         BZ    @RF00438                                            0438
         L     @01,FMFLADDR(,FMFLCUR)                              0439
         LH    NBRVOLOC,REPNO(,@01)                                0439
*   ELSE                                                           0440
*     DO ;                         /* FIELD MGMT ERROR SO            */
         B     @RC00438                                            0440
@RF00438 DS    0H                                                  0441
*       NBRVOLOC = 0 ;             /* IGNORE ALL VOLUMES             */
         SLR   NBRVOLOC,NBRVOLOC                                   0441
*       PROCMSG='CKEYRNG ';        /* PROC NAME FOR INSERT   @OZ09388*/
         MVC   PROCMSG(8),@CC01205                                 0442
*       CALL ERROR (27,$RETURN) ;                                  0443
         LA    @01,@AL00443                                        0443
         BAL   @14,ERROR                                           0443
*     END ;                                                        0444
* FMFLGRPC = '0'B ;                                                0445
@RC00438 MVI   FMFLGRPC(FMFLCUR),B'00000000'                       0445
* KEYRNGSW = OFF ;                 /* IGNORE FM ERROR                */
         NI    KEYRNGSW,B'10111111'                                0446
* DARGCNT = 2 ;                    /* OR NO KEYRANGE                 */
         L     @02,DDSTRU                                          0447
         MVC   DARGCNT(2,@02),@CH00158                             0447
* IF CTTENTYP(CIFRGET-CTTBASE) = CATRCTYP($DATA)                   0448
*   THEN                           /* DO KEYRANGE CHECK              */
         L     @02,CIFRGET-1                                       0448
         LA    @02,0(,@02)                                         0448
         SLA   @02,3                                               0448
         SLR   @15,@15                                             0448
         IC    @15,$DATA                                           0448
         MH    @15,@CH00042                                        0448
         L     @01,CTTPTR                                          0448
         ALR   @01,@02                                             0448
         AL    @01,@CF01469                                        0448
         LA    @02,CATRCTYP-5(@15)                                 0448
         CLC   CTTENTYP-4(1,@01),0(@02)                            0448
         BNE   @RF00448                                            0448
*     DO ;                         /* ONLY IF DATA RECORD            */
*       FMFLDNAM = ADDR('HIKEYV  ') ;                              0450
         LA    @02,@CC01207                                        0450
         ST    @02,FMFLDNAM(,FMFLCUR)                              0450
*       REG1 = FMPLAD ;                                            0451
*                                                                  0451
         L     REG1,FMPLAD                                         0451
*       CALL IDCRC04 ;             /* GET KEYRANGE IF ANY            */
*                                                                  0452
         L     @15,@CV00793                                        0452
         BALR  @14,@15                                             0452
*       IF FMFLENTH ^= 0 & HIKEYLEN ^= 0                           0453
*         THEN                     /* THERE ARE KEYRANGES SO         */
         SLR   @02,@02                                             0453
         C     @02,FMFLENTH(,FMFLCUR)                              0453
         BE    @RF00453                                            0453
         L     @01,FMFLADDR(,FMFLCUR)                              0453
         CH    @02,HIKEYLEN(,@01)                                  0453
         BE    @RF00453                                            0453
*           DO ;                   /* SET UP FOR PRINTING EM         */
*             KEYRNGSW = ON ;                                      0455
         OI    KEYRNGSW,B'01000000'                                0455
*             DARGCNT = 3 ;                                        0456
         L     @02,DDSTRU                                          0456
         MVC   DARGCNT(2,@02),@CH00166                             0456
*             DARGINL(3) = LENGTH(VOLHD3) ;                        0457
         MVC   DARGINL+16(2,@02),@CH00039                          0457
*             DARGDTM(3) = ADDR(VOLHD3) ;                          0458
         LA    @15,VOLHD3                                          0458
         ST    @15,DARGDTM+16(,@02)                                0458
*             FMPLFLNO = 2 ;                                       0459
         L     @02,FMPLAD                                          0459
         MVI   FMPLFLNO(@02),X'02'                                 0459
*             FMPLFMFL(2) -> FMFLDNAM = ADDR('HIKEYV  ') ;         0460
         L     @02,FMPLFMFL+4(,@02)                                0460
         LA    @15,@CC01207                                        0460
         ST    @15,FMFLDNAM(,@02)                                  0460
*             FMPLFMFL(2) -> FMFLTCHN = ADDR(FMFLST(5)) ;          0461
         LA    @15,FMFLST+96                                       0461
         ST    @15,FMFLTCHN(,@02)                                  0461
*           END ;                                                  0462
*         ELSE ;                   /* TREAT ERR AS NO KEYRNG         */
@RF00453 DS    0H                                                  0464
*     END ;                                                        0464
* FMFLDNAM = ADDR('VOLSER  ') ;                                    0465
*                                                                  0465
@RF00448 LA    @02,@CC01208                                        0465
         ST    @02,FMFLDNAM(,FMFLCUR)                              0465
*END CKEYRNG ;                                                     0466
@EL00006 DS    0H                                                  0466
@EF00006 DS    0H                                                  0466
@ER00006 LM    @14,@02,@SA00006                                    0466
         LM    @04,@12,@SA00006+20                                 0466
         BR    @14                                                 0466
* /*******************************************************************/
* /* PROCEDURE NAME - CLEANUP                                        */
* /* FUNCTION -                                                      */
* /*   IF COMPARE CLOSE THE CATALOG AND                              */
* /*   RELEASE SYSTEM LOCKOUT (UDEQ)                                 */
* /*   PRINT THE FUNCTION COMPLETE MESSAGE,                          */
* /*   FREE ALL GOTTEN MEMORY                                        */
* /* INPUTS -                                                        */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   UCLOSE, UDEQ, UPRINT, UFPOOL                                  */
* /*******************************************************************/
*                                                                  0467
*CLEANUP: PROCEDURE ;                                              0467
CLEANUP  STM   @14,@12,@SA00007                                    0467
* OLDERID2 = NEWERID2;                                             0468
         L     @04,@PC00001                                        0468
         L     @15,GDTTR2(,@04)                                    0468
         MVC   @TS00001(95),NEWERID2(@15)                          0468
         MVC   OLDERID2(95,@15),@TS00001                           0468
* NEWID2 = 'LRC1' ;                                                0469
         MVC   NEWID2(4,@15),@CC01212                              0469
* IF GDTDBG = NULLPTR                                              0470
*   THEN;                                                          0470
         L     @04,GDTDBG(,@04)                                    0470
         LTR   @04,@04                                             0470
         BZ    @RT00470                                            0470
*   ELSE                                                           0472
*     CALL IDCDB010 (GDTTBL,'LRC1') ;                              0472
*                                                                  0472
         L     @04,@PC00001                                        0472
         ST    @04,@AL00001                                        0472
         LA    @15,@CC01212                                        0472
         ST    @15,@AL00001+4                                      0472
         MVI   @AL00001+4,X'80'                                    0472
         L     @15,GDTDBG(,@04)                                    0472
         LA    @01,@AL00001                                        0472
         BALR  @14,@15                                             0472
* IF CMPRSW = ON                                                   0473
*   THEN                                                           0473
@RT00470 TM    CMPRSW,B'01000000'                                  0473
         BNO   @RF00473                                            0473
*     DO ;                                                         0474
*                                                                  0474
*       CALL IDCIOCL0 (GDTTBL,IOCSCAT) ;                           0475
*                                                                  0475
         L     @04,@PC00001                                        0475
         ST    @04,@AL00001                                        0475
         LA    @15,IOCSCAT                                         0475
         ST    @15,@AL00001+4                                      0475
         MVI   @AL00001+4,X'80'                                    0475
         L     @15,GDTCLS(,@04)                                    0475
         LA    @01,@AL00001                                        0475
         BALR  @14,@15                                             0475
*       CALL IDCSADQ0 (GDTTBL,RSVMJNM,RSVMINM) ;                   0476
*                                                                  0476
         L     @04,@PC00001                                        0476
         ST    @04,@AL00001                                        0476
         LA    @15,RSVMJNM                                         0476
         ST    @15,@AL00001+4                                      0476
         LA    @15,RSVMINM                                         0476
         ST    @15,@AL00001+8                                      0476
         MVI   @AL00001+8,X'80'                                    0476
         L     @15,GDTDEQ(,@04)                                    0476
         LA    @01,@AL00001                                        0476
         BALR  @14,@15                                             0476
*     END ;                                                        0477
*                                                                  0477
* IF IOCSALT ^= NULLPTR                                     /*OZ07569*/
*   THEN                                                    /*OZ07569*/
*                                                                  0478
@RF00473 L     @04,IOCSALT                                         0478
         LTR   @04,@04                                             0478
         BZ    @RF00478                                            0478
*       CALL IDCIOCL0 (GDTTBL,IOCSALT) ;                    /*OZ07569*/
*                                                                  0479
         L     @04,@PC00001                                        0479
         ST    @04,@AL00001                                        0479
         LA    @15,IOCSALT                                         0479
         ST    @15,@AL00001+4                                      0479
         MVI   @AL00001+4,X'80'                                    0479
         L     @15,GDTCLS(,@04)                                    0479
         LA    @01,@AL00001                                        0479
         BALR  @14,@15                                             0479
* DARGLIST = '0'B ;                                                0480
@RF00478 L     @04,DDSTRU                                          0480
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0480
         MVI   DARGLIST(@04),B'00000000'                           0480
* DARGSMOD = 'UV0' ;                                               0481
         MVC   DARGSMOD(3,@04),@CC00777                            0481
* DARGSENT = 1 ;                                                   0482
         MVI   DARGSENT(@04),X'01'                                 0482
* DARGILP = LENGTH(LRLASTCC) ;                                     0483
         MVC   DARGILP(2,@04),@CH00158                             0483
* DARGDBP = ADDR(LRLASTCC) ;                                       0484
*                                                                  0484
         LA    @15,LRLASTCC                                        0484
         ST    @15,DARGDBP(,@04)                                   0484
* CALL AMSTP011 (GDTTBL,0,DDSTRU) ;                                0485
         L     @04,@PC00001                                        0485
         ST    @04,@AL00001                                        0485
         LA    @15,@CF00120                                        0485
         ST    @15,@AL00001+4                                      0485
         LA    @15,DDSTRU                                          0485
         ST    @15,@AL00001+8                                      0485
         MVI   @AL00001+8,X'80'                                    0485
         L     @15,GDTPRT(,@04)                                    0485
         LA    @01,@AL00001                                        0485
         BALR  @14,@15                                             0485
*                                                           /*OZ30449*/
* CALL IDCSAFP0 (GDTTBL,MODID,ALL) ;                               0486
*                                                                  0486
         MVC   @AL00001+4(8),@AL00486                              0486
         L     @04,@PC00001                                        0486
         ST    @04,@AL00001                                        0486
         L     @15,GDTFPL(,@04)                                    0486
         LA    @01,@AL00001                                        0486
         BALR  @14,@15                                             0486
*END CLEANUP ;                                                     0487
@EL00007 DS    0H                                                  0487
@EF00007 DS    0H                                                  0487
@ER00007 LM    @14,@12,@SA00007                                    0487
         BR    @14                                                 0487
* /*******************************************************************/
* /* PROCEDURE NAME - CLENCRA                                        */
* /* FUNCTION -                                                      */
* /*   CLOSE THE CRA,                                                */
* /*   FREE UP STORAGE OBTAINED FOR THIS CRA ONLY,                   */
* /*   PRINT MESSAGES ABOUT NUMBER OF MISCOMPARES AS A               */
* /*   COMPLETION MESSAGE                                            */
* /* INPUTS -                                                        */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   UCLOSE, UFPOOL, SUMIT, UPRINT                                 */
* /*******************************************************************/
*                                                                  0488
*CLENCRA: PROCEDURE ;                                              0488
CLENCRA  STM   @14,@12,@SA00008                                    0488
* OLDERID2 = NEWERID2;                                             0489
         L     @04,@PC00001                                        0489
         L     @15,GDTTR2(,@04)                                    0489
         MVC   @TS00001(95),NEWERID2(@15)                          0489
         MVC   OLDERID2(95,@15),@TS00001                           0489
* NEWID2 = 'LRC2' ;                                                0490
         MVC   NEWID2(4,@15),@CC01216                              0490
* IF GDTDBG = NULLPTR                                              0491
*   THEN;                                                          0491
         L     @04,GDTDBG(,@04)                                    0491
         LTR   @04,@04                                             0491
         BZ    @RT00491                                            0491
*   ELSE                                                           0493
*     CALL IDCDB010 (GDTTBL,'LRC2') ;                              0493
*                                                                  0493
         L     @04,@PC00001                                        0493
         ST    @04,@AL00001                                        0493
         LA    @15,@CC01216                                        0493
         ST    @15,@AL00001+4                                      0493
         MVI   @AL00001+4,X'80'                                    0493
         L     @15,GDTDBG(,@04)                                    0493
         LA    @01,@AL00001                                        0493
         BALR  @14,@15                                             0493
* CALL IDCIOCL0 (GDTTBL,IOCSCRA) ;                                 0494
*                                                                  0494
@RT00491 L     @04,@PC00001                                        0494
         ST    @04,@AL00001                                        0494
         LA    @15,IOCSCRA                                         0494
         ST    @15,@AL00001+4                                      0494
         MVI   @AL00001+4,X'80'                                    0494
         L     @15,GDTCLS(,@04)                                    0494
         LA    @01,@AL00001                                        0494
         BALR  @14,@15                                             0494
* CALL IDCSAFP0 (GDTTBL,MODIDCTT) ;                                0495
*                                                                  0495
         L     @04,@PC00001                                        0495
         ST    @04,@AL00001                                        0495
         LA    @15,MODIDCTT                                        0495
         ST    @15,@AL00001+4                                      0495
         MVI   @AL00001+4,X'80'                                    0495
         L     @15,GDTFPL(,@04)                                    0495
         LA    @01,@AL00001                                        0495
         BALR  @14,@15                                             0495
* IF SDUMPSW ^= ON                                                 0496
*                                                                  0496
*   THEN CALL SUMIT(SMPRINT) ;                                     0496
*                                                                  0496
         TM    SDUMPSW,B'00000010'                                 0496
         BO    @RF00496                                            0496
         LA    @01,@AL00497                                        0497
         BAL   @14,SUMIT                                           0497
* IF CMPRSW = ON                                                   0498
*   THEN                                                           0498
@RF00496 TM    CMPRSW,B'01000000'                                  0498
         BNO   @RF00498                                            0498
*     DO ;                                                         0499
*       DARGLIST = '0'B ;                                          0500
         L     @04,DDSTRU                                          0500
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0500
         MVI   DARGLIST(@04),B'00000000'                           0500
*       DARGSMOD = 'LR1' ;                                         0501
         MVC   DARGSMOD(3,@04),@CC00775                            0501
*       DARGSENT = 16 ;                                            0502
         MVI   DARGSENT(@04),X'10'                                 0502
*       DARGCNT = 1 ;                                              0503
         LA    @15,1                                               0503
         STH   @15,DARGCNT(,@04)                                   0503
*       DARGINS(1) = 1 ;                                           0504
         STH   @15,DARGINS(,@04)                                   0504
*       DARGINL(1) = LENGTH(MCENTCNT) ;                            0505
         MVC   DARGINL(2,@04),@CH00158                             0505
*       DARGDTM(1) = ADDR(MCENTCNT) ;                              0506
         LA    @15,MCENTCNT                                        0506
         ST    @15,DARGDTM(,@04)                                   0506
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    0507
         L     @04,@PC00001                                        0507
         ST    @04,@AL00001                                        0507
         LA    @15,IOCSPRT                                         0507
         ST    @15,@AL00001+4                                      0507
         LA    @15,DDSTRU                                          0507
         ST    @15,@AL00001+8                                      0507
         MVI   @AL00001+8,X'80'                                    0507
         L     @15,GDTPRT(,@04)                                    0507
         LA    @01,@AL00001                                        0507
         BALR  @14,@15                                             0507
*       DARGSENT = 8 ;                                             0508
         L     @04,DDSTRU                                          0508
         MVI   DARGSENT(@04),X'08'                                 0508
*       DARGINL(1) = LENGTH(MCRCDCNT) ;                            0509
         MVC   DARGINL(2,@04),@CH00158                             0509
*       DARGDTM(1) = ADDR(MCRCDCNT) ;                              0510
         LA    @15,MCRCDCNT                                        0510
         ST    @15,DARGDTM(,@04)                                   0510
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    0511
         L     @04,@PC00001                                        0511
         ST    @04,@AL00001                                        0511
         LA    @15,IOCSPRT                                         0511
         ST    @15,@AL00001+4                                      0511
         LA    @15,DDSTRU                                          0511
         ST    @15,@AL00001+8                                      0511
         MVI   @AL00001+8,X'80'                                    0511
         L     @15,GDTPRT(,@04)                                    0511
         LA    @01,@AL00001                                        0511
         BALR  @14,@15                                             0511
*       IF MCRCDCNT > 0 & LRLASTCC < 4                             0512
*         THEN LRLASTCC = 4 ;                                      0512
         CLC   MCRCDCNT(2),@CH00120                                0512
         BNH   @RF00512                                            0512
         LA    @04,4                                               0512
         CH    @04,LRLASTCC                                        0512
         BNH   @RF00512                                            0512
         STH   @04,LRLASTCC                                        0513
*     END ;                                                        0514
*                                                                  0514
*END CLENCRA ;                                                     0515
@EL00008 DS    0H                                                  0515
@EF00008 DS    0H                                                  0515
@ER00008 LM    @14,@12,@SA00008                                    0515
         BR    @14                                                 0515
* /*******************************************************************/
* /* PROCEDURE NAME - CRAOPEN                                        */
* /* FUNCTION -                                                      */
* /*   INITIALIZATION INCLUDING BASIC SUBTITLE,                      */
* /*   OPEN AND VERIFY A CRA,                                        */
* /*   IF COMPARE VERIFY THAT THE OPEN CATALOG IS THE OWNER          */
* /*   OF THIS CRA,                                                  */
* /*   IF NOT RUNNING UNDER TSO                                      */
* /*     INITIALIZE TEXT PROCESSOR SUBTITLE LINE WITH VOLSER,        */
* /*   CALL CTTBLD TO GET STORAGE FOR AND BUILD THE CRA TO           */
* /*   CATALOG CI TRANSLATE TABLE                                    */
* /* INPUTS -                                                        */
* /*   DNAME IN THE FDT INFILE LIST                                  */
* /*   CRA                                                           */
* /* OUTPUTS -                                                       */
* /*   CRAOPNSW (NOT ON CAUSES CRA TO BE BYPASSED)                   */
* /*   CTT                                                           */
* /* CALLS -                                                         */
* /*   UESTA, UOPEN, UVERIFY, UREST, CTTBLD, ERROR,                  */
* /*   IDCRC04(ENTNAME)                                              */
* /*******************************************************************/
*                                                                  0516
*CRAOPEN: PROCEDURE ;                                              0516
CRAOPEN  STM   @14,@12,@SA00009                                    0516
*   OLDERID2 = NEWERID2;                                           0517
         L     @02,@PC00001                                        0517
         L     @15,GDTTR2(,@02)                                    0517
         MVC   @TS00001(95),NEWERID2(@15)                          0517
         MVC   OLDERID2(95,@15),@TS00001                           0517
*   NEWID2 = 'LRCR' ;                                              0518
         MVC   NEWID2(4,@15),@CC01221                              0518
*   IF GDTDBG = NULLPTR                                            0519
*     THEN;                                                        0519
         L     @02,GDTDBG(,@02)                                    0519
         LTR   @02,@02                                             0519
         BZ    @RT00519                                            0519
*     ELSE                                                         0521
*       CALL IDCDB010 (GDTTBL,'LRCR') ;                            0521
*                                                                  0521
         L     @02,@PC00001                                        0521
         ST    @02,@AL00001                                        0521
         LA    @15,@CC01221                                        0521
         ST    @15,@AL00001+4                                      0521
         MVI   @AL00001+4,X'80'                                    0521
         L     @15,GDTDBG(,@02)                                    0521
         LA    @01,@AL00001                                        0521
         BALR  @14,@15                                             0521
*   CRAOPNSW = OFF ;                                               0522
@RT00519 NI    CRAOPNSW,B'11101111'                                0522
*   FMUCTTP = '0'B ;               /* TURN CI TRANSLATE OFF          */
         SLR   @02,@02                                             0523
         ST    @02,FMUCTTP                                         0523
*                                  /* IN IDCLR02 (PRE CTT)           */
*   MCRCDCNT = 0 ;                 /* MISCMPR RECORD COUNT           */
         SLR   @02,@02                                             0524
         STH   @02,MCRCDCNT                                        0524
*   MCENTCNT = 0 ;                 /* MISCMPR ENTRY COUNT            */
         STH   @02,MCENTCNT                                        0525
*   INDNTCOL = 0 ;                                                 0526
         MVI   INDNTCOL,X'00'                                      0526
*   SUBTVLSR = '......' ;          /* VOLSER FOR ERRORS              */
         MVC   SUBTVLSR(6),@CC01222                                0527
*   SUBGROUP = 'VSAM ENTRIES' ;                                    0528
         MVI   SUBGROUP+12,C' '                                    0528
         MVC   SUBGROUP+13(3),SUBGROUP+12                          0528
         MVC   SUBGROUP(12),@CC01223                               0528
*   IF GDTECT = NULLPTR            /* IF NOT RUNNING UNDER TSO       */
*      & SBTSETSW = OFF            /* AND SUBTITLE NOT YET SET       */
*                                                                  0529
*     THEN CALL AMSTP042 (GDTTBL,IOCSPRT,PCARGLST) ;/*             0529
*                                               SET UP HEADER        */
*                                                                  0529
         L     @15,@PC00001                                        0529
         C     @02,GDTECT(,@15)                                    0529
         BNE   @RF00529                                            0529
         TM    SBTSETSW,B'00000100'                                0529
         BNZ   @RF00529                                            0529
         ST    @15,@AL00001                                        0530
         LA    @02,IOCSPRT                                         0530
         ST    @02,@AL00001+4                                      0530
         LA    @02,PCARGLST                                        0530
         ST    @02,@AL00001+8                                      0530
         L     @15,GDTESA(,@15)                                    0530
         LA    @01,@AL00001                                        0530
         BALR  @14,@15                                             0530
*   SBTSETSW = ON ;                                                0531
@RF00529 OI    SBTSETSW,B'00000100'                                0531
*   IF ADDR(CMPR) ^= '0'B                                          0532
*     THEN CMPRSW = ON ;                                           0532
         L     @02,@PC00001+4                                      0532
         L     @02,FDTPTR+4(,@02)                                  0532
         LTR   @02,@02                                             0532
         BZ    @RF00532                                            0532
         OI    CMPRSW,B'01000000'                                  0533
*     ELSE CMPRSW = OFF ;                                          0534
         B     @RC00532                                            0534
@RF00532 NI    CMPRSW,B'10111111'                                  0534
*   OPNAGL = '0'B ;                /* SET UP TO DO OPEN              */
@RC00532 XC    OPNAGL+1(47,OPNPTR),OPNAGL+1(OPNPTR)                0535
         MVI   OPNAGL(OPNPTR),B'00000000'                          0535
*   OPNOPTIN = ON ;                /* ACB - IN                       */
*   OPNOPTBK = ON ;                /* ACB - CNV (NOT A BLOCK)        */
*   OPNOPTDR = ON ;                /* ACB - DIR                      */
         OI    OPNOPTIN(OPNPTR),B'10010010'                        0538
*   OPNDSOAM = ON ;                /* DSORG - VSAM                   */
         OI    OPNDSOAM(OPNPTR),B'10000000'                        0539
*   OPNTYPRA = ON ;                /* CATALOG RECOVERY AREA          */
         OI    OPNTYPRA(OPNPTR),B'00001000'                        0540
*   OPNDDN = ADDR(IFILEVAL(CRACNT)) ;   /* CRA DNAME                 */
         L     @02,CRACNT-1                                        0541
         LA    @02,0(,@02)                                         0541
         MH    @02,@CH00037                                        0541
         L     @15,@PC00001+4                                      0541
         L     @01,FDTPTR(,@15)                                    0541
         AL    @01,@CF01473                                        0541
         LA    @02,IFILEVAL-3(@02,@01)                             0541
         ST    @02,OPNDDN(,OPNPTR)                                 0541
*   IF MRPWLEN ^= '0'B                                             0542
*     THEN OPNPWA = ADDR(MRPWVAL) ;/* MASTER CAT,S PASSWORD          */
         L     @02,FDTPTR+32(,@15)                                 0542
         CLI   MRPWLEN(@02),0                                      0542
         BE    @RF00542                                            0542
         LA    @02,MRPWVAL(,@02)                                   0543
         ST    @02,OPNPWA(,OPNPTR)                                 0543
*   OPNIOC = ADDR(IOCSCRA) ;       /* RETURN ADDR OF IOCS            */
*                                                                  0544
@RF00542 LA    @02,IOCSCRA                                         0544
         ST    @02,OPNIOC(,OPNPTR)                                 0544
*   CALL IDCIOOP0 (GDTTBL,OPNAGL,0) ;/*                            0545
*                                     3RD PARM REQD BY UOPEN         */
*                                                                  0545
         L     @02,@PC00001                                        0545
         ST    @02,@AL00001                                        0545
         ST    OPNPTR,@AL00001+4                                   0545
         LA    @15,@CF00120                                        0545
         ST    @15,@AL00001+8                                      0545
         MVI   @AL00001+8,X'80'                                    0545
         L     @15,GDTOPN(,@02)                                    0545
         LA    @01,@AL00001                                        0545
         BALR  @14,@15                                             0545
*   RESPECIFY RTNREG RSTD;                                         0546
*   TESTRC = RTNREG;                                               0547
         STH   RTNREG,TESTRC                                       0547
*   RESPECIFY RTNREG UNRSTD ;                                      0548
*   IF TESTRC = 0                                                  0549
*     THEN                                                         0549
         LH    @02,TESTRC                                          0549
         LTR   @02,@02                                             0549
         BNZ   @RF00549                                            0549
*       DO ;                                                       0550
*         CRAOPNSW = ON ;                                          0551
         OI    CRAOPNSW,B'00010000'                                0551
*         DO BUFNO = 1 TO NBRBUF ; /* INITIALIZE BUFFER POOL         */
         LA    @02,1                                               0552
         STC   @02,BUFNO                                           0552
@DL00552 DS    0H                                                  0553
*           IOBUFCI(BUFNO) = '7FFFFF'X ;                           0553
         LR    @15,@02                                             0553
         SLA   @15,9                                               0553
         L     @01,IOBFSPTR                                        0553
         ALR   @01,@15                                             0553
         AL    @01,@CF01466                                        0553
         MVC   IOBUFCI-509(3,@01),@CF01194+1                       0553
*         END ;                    /* TO INVALID CI,S AND SET        */
         AL    @02,@CF00222                                        0554
         STC   @02,BUFNO                                           0554
         C     @02,@CF00047                                        0554
         BNH   @DL00552                                            0554
*         FMU1STIO = ON ;          /* SW FOR LR02 FLDMGMT I/O        */
         OI    FMU1STIO,B'10000000'                                0555
*         FMUIOCSI = IOCSCRA ;                                     0556
*                                                                  0556
         L     @02,IOCSCRA                                         0556
         ST    @02,FMUIOCSI                                        0556
*         CALL IDCIOVY0 (GDTTBL,IOCSCRA) ;                         0557
*                                                                  0557
         L     @02,@PC00001                                        0557
         ST    @02,@AL00001                                        0557
         LA    @15,IOCSCRA                                         0557
         ST    @15,@AL00001+4                                      0557
         MVI   @AL00001+4,X'80'                                    0557
         L     @15,GDTVFY(,@02)                                    0557
         LA    @01,@AL00001                                        0557
         BALR  @14,@15                                             0557
*         RESPECIFY RTNREG RSTD;                                   0558
*         TESTRC = RTNREG;                                         0559
         STH   RTNREG,TESTRC                                       0559
*         RESPECIFY RTNREG UNRSTD ;                                0560
*         IF TESTRC ^= 0                                           0561
*           THEN                                                   0561
         LH    @02,TESTRC                                          0561
         LTR   @02,@02                                             0561
         BZ    @RF00561                                            0561
*             DO ;                                                 0562
*               CALL ERROR (8,$RETURN) ;     /* VERIFY FAILUR        */
         LA    @01,@AL00563                                        0563
         BAL   @14,ERROR                                           0563
*               TESTRC = 0 ;                                       0564
         SLR   @02,@02                                             0564
         STH   @02,TESTRC                                          0564
*               IOCSCRA->IOCMSGOP=ON; /* SET OPEN BIT ON     @OZ05923*/
         L     @02,IOCSCRA                                         0565
         OI    IOCMSGOP(@02),B'00100000'                           0565
*             END ;                                                0566
*         IF CMPRSW = ON                                           0567
*           THEN                                                   0567
@RF00561 TM    CMPRSW,B'01000000'                                  0567
         BNO   @RF00567                                            0567
*             DO ;                                                 0568
*               FMPLBCIN = 0 ;     /* ASK OWNING CATALOG,S           */
         L     @02,FMPLAD                                          0569
         SLR   @15,@15                                             0569
         STCM  @15,7,FMPLBCIN(@02)                                 0569
*               FMFLDNAM = ADDR       ('ENTNAME ') ;               0570
         LA    @15,@CC01195                                        0570
         ST    @15,FMFLDNAM(,FMFLCUR)                              0570
*               REG1 = FMPLAD ;                                    0571
*                                                                  0571
         LR    REG1,@02                                            0571
*               CALL IDCRC04 ;                                     0572
*                                                                  0572
         L     @15,@CV00793                                        0572
         BALR  @14,@15                                             0572
*               IF FMFLENTH ^= 0                                   0573
*                 THEN                                             0573
         L     @02,FMFLENTH(,FMFLCUR)                              0573
         LTR   @02,@02                                             0573
         BZ    @RF00573                                            0573
*                   IF CATNAME = ENTNAME                           0574
*                     THEN ;       /* AOK, RIGHT OWNER               */
         L     @02,FMFLADDR(,FMFLCUR)                              0574
         CLC   CATNAME(44),ENTNAME(@02)                            0574
         BE    @RT00574                                            0574
*                     ELSE         /* WRONG NAME, DID OPENCAT        */
*                                  /* GETNAME FAIL ALSO              */
*                       IF CATNAME(1:14) = 'NAMEOFFIELDNOT'        0576
*                         THEN ;   /* YES, DO THE CMPR ANYWAY        */
         CLC   CATNAME(14),@CC01226                                0576
         BE    @RT00576                                            0576
*                         ELSE     /* NO, THEN WRONG CATALOG         */
*                           DO ;                                   0578
*                             CATNMCRA = ENTNAME ; /*ERR PRNT        */
         L     @02,FMFLADDR(,FMFLCUR)                              0579
         MVC   CATNMCRA(44),ENTNAME(@02)                           0579
*                             CALL ERROR (6,$RETURN) ;             0580
         LA    @01,@AL00580                                        0580
         BAL   @14,ERROR                                           0580
*                                  /* CAT DOES NOT OWN CRA           */
*                             CMPRSW = OFF ;     /*ABORT CMPR        */
         NI    CMPRSW,B'10111111'                                  0581
*                             CALL ERROR (10,$RETURN) ;            0582
         LA    @01,@AL00582                                        0582
         BAL   @14,ERROR                                           0582
*                           END ;                                  0583
*                 ELSE                                     /*@OZ09388*/
*                   DO;                                    /*@OZ09388*/
         B     @RC00573                                            0584
@RF00573 DS    0H                                                  0585
*                     PROCMSG='CRAOPEN '; /* NAME FOR INSERT @OZ09388*/
         MVC   PROCMSG(8),@CC01228                                 0585
*                     CALL ERROR (7,$RETURN) ; /*FM CATNAM   @OZ09388*/
         LA    @01,@AL00586                                        0586
         BAL   @14,ERROR                                           0586
*                   END;                                   /*@OZ09388*/
*                                  /* GO ON WITH CMPR ANYWAY         */
*             END ;                                                0588
@RC00573 DS    0H                                                  0589
*         FMPLBCIN = CTTBASE + 1 ;                                 0589
@RF00567 L     @02,FMPLAD                                          0589
         MVC   FMPLBCIN(3,@02),@CF00038+1                          0589
*         FMFLDNAM = ADDR('ENTNAME ') ;                            0590
         LA    @15,@CC01195                                        0590
         ST    @15,FMFLDNAM(,FMFLCUR)                              0590
*         REG1 = FMPLAD ;          /* GET VOLSER FOR SUBTITLE        */
*                                                                  0591
         LR    REG1,@02                                            0591
*         CALL IDCRC04 ;                                           0592
*                                                                  0592
         L     @15,@CV00793                                        0592
         BALR  @14,@15                                             0592
*         IF FMFLENTH ^= 0                                         0593
*           THEN SUBTVLSR = ENTNAME(1:6) ;                         0593
         L     @02,FMFLENTH(,FMFLCUR)                              0593
         LTR   @02,@02                                             0593
         BZ    @RF00593                                            0593
         L     @02,FMFLADDR(,FMFLCUR)                              0594
         MVC   SUBTVLSR(6),ENTNAME(@02)                            0594
*           ELSE                                           /*@OZ09388*/
*               DO;                                        /*@OZ09388*/
         B     @RC00593                                            0595
@RF00593 DS    0H                                                  0596
*                  PROCMSG='CRAOPEN '; /* PROC NAME FOR MSG  @OZ09388*/
         MVC   PROCMSG(8),@CC01228                                 0596
*                  CALL ERROR (5,$RETURN);                 /*@OZ09388*/
         LA    @01,@AL00597                                        0597
         BAL   @14,ERROR                                           0597
*               END;                                       /*@OZ09388*/
*         IF GDTECT = NULLPTR      /* IF NOT RUNNING UNDER TSO       */
*                                                                  0599
*           THEN CALL AMSTP043 (GDTTBL,IOCSPRT,PCRST) ;/*          0599
*                                                     CHANGE SUBTITLE*/
*                                                                  0599
@RC00593 L     @02,@PC00001                                        0599
         L     @15,GDTECT(,@02)                                    0599
         LTR   @15,@15                                             0599
         BNZ   @RF00599                                            0599
         ST    @02,@AL00001                                        0600
         LA    @15,IOCSPRT                                         0600
         ST    @15,@AL00001+4                                      0600
         LA    @15,PCRST                                           0600
         ST    @15,@AL00001+8                                      0600
         MVI   @AL00001+8,X'80'                                    0600
         L     @15,GDTRST(,@02)                                    0600
         LA    @01,@AL00001                                        0600
         BALR  @14,@15                                             0600
*         CALL CTTBLD ;            /****** GO BUILD CTT *****        */
*                                                                  0601
@RF00599 BAL   @14,CTTBLD                                          0601
*         FMU1STIO = OFF ;                                         0602
         NI    FMU1STIO,B'01111111'                                0602
*       END ;                                                      0603
*     ELSE CALL ERROR (9,$RETURN); /* TESTRC WILL ABORT CRA          */
*                                                                  0604
         B     @RC00549                                            0604
@RF00549 LA    @01,@AL00604                                        0604
         BAL   @14,ERROR                                           0604
*END CRAOPEN ;                                                     0605
@EL00009 DS    0H                                                  0605
@EF00009 DS    0H                                                  0605
@ER00009 LM    @14,@12,@SA00009                                    0605
         BR    @14                                                 0605
* /*******************************************************************/
* /* PROCEDURE NAME - CTTBLD, CI TRANSLATE TABLE BUILD               */
* /* FUNCTION -                                                      */
* /*   READ THE CATALOG CONTROL RECORD (CCR) IN THE CRA,             */
* /*   GET SIZE OF CRA FROM IT,                                      */
* /*   GET STORAGE FOR THE CTT,                                      */
* /*   IF SEQUENTIALDUMP CALL GETPRT FOR SELF-DESCRIBING CIS (0-8),  */
* /*   SCAN WHOLE CRA BUILDING THE CTT,                              */
* /*   IF SEQUENTIALDUMP CALL GETPRT TO PRINT EACH ENTRY ALSO,       */
* /*   IF FIELD MGMT RETURNS FF,S OR                                 */
* /*   IF GET RECORD CAUSES I/O ERROR SET ENTRY TYPE TO              */
* /*   '7F'X AND TURN ITS ALREADY PRINTED SWITCH ON IN CTT           */
* /* INPUTS -                                                        */
* /*   CRA                                                           */
* /* OUTPUTS -                                                       */
* /*   CTT WITH CATALOG CI AND ENTRY TYPE FILLED IN                  */
* /*   FMUCTTP (POINTER (ZERO CAUSES CRA TO BE BYPASSED))            */
* /* CALLS -                                                         */
* /*   UGPOOL, GETPRT, ERROR,                                        */
* /*   IDCRC04(ENTYPE, ENTIDNO)                                      */
* /*******************************************************************/
*                                                                  0606
*CTTBLD: PROCEDURE ;                                               0606
CTTBLD   STM   @14,@12,@SA00010                                    0606
* OLDERID2 = NEWERID2;                                             0607
         L     @15,@PC00001                                        0607
         L     @14,GDTTR2(,@15)                                    0607
         MVC   @TS00001(95),NEWERID2(@14)                          0607
         MVC   OLDERID2(95,@14),@TS00001                           0607
* NEWID2 = 'LRCT' ;                                                0608
         MVC   NEWID2(4,@14),@CC01233                              0608
* IF GDTDBG = NULLPTR                                              0609
*   THEN;                                                          0609
         L     @15,GDTDBG(,@15)                                    0609
         LTR   @15,@15                                             0609
         BZ    @RT00609                                            0609
*   ELSE                                                           0611
*     CALL IDCDB010 (GDTTBL,'LRCT') ;                              0611
*                                                                  0611
         L     @15,@PC00001                                        0611
         ST    @15,@AL00001                                        0611
         LA    @14,@CC01233                                        0611
         ST    @14,@AL00001+4                                      0611
         MVI   @AL00001+4,X'80'                                    0611
         L     @15,GDTDBG(,@15)                                    0611
         LA    @01,@AL00001                                        0611
         BALR  @14,@15                                             0611
* BUFNO = NBRBUF ;                                                 0612
@RT00609 MVI   BUFNO,X'04'                                         0612
* IOBFSPTR = IOCRBPTR ;                                            0613
         L     @02,IOCRBPTR                                        0613
         ST    @02,IOBFSPTR                                        0613
* IOCSPTR = IOCSCRA ;                                              0614
         L     IOCSPTR,IOCSCRA                                     0614
* IOCRBA = 3 * CATCISZ ;           /* CCR IS AT CI = 3               */
*                                                                  0615
         MVC   IOCRBA(4,IOCSPTR),@CF01449                          0615
* CALL IDCIOGT0 (GDTTBL,IOCSCRA) ;                                 0616
*                                                                  0616
         L     @02,@PC00001                                        0616
         ST    @02,@AL00001                                        0616
         LA    @15,IOCSCRA                                         0616
         ST    @15,@AL00001+4                                      0616
         MVI   @AL00001+4,X'80'                                    0616
         L     @15,GDTGET(,@02)                                    0616
         LA    @01,@AL00001                                        0616
         BALR  @14,@15                                             0616
* RESPECIFY RTNREG RSTD;                                           0617
* TESTRC = RTNREG;                                                 0618
         STH   RTNREG,TESTRC                                       0618
* RESPECIFY RTNREG UNRSTD ;                                        0619
* IF TESTRC = 0                                                    0620
*   THEN                                                           0620
         LH    @02,TESTRC                                          0620
         LTR   @02,@02                                             0620
         BNZ   @RF00620                                            0620
*     DO ;                                                         0621
*       CTTSLOT = (IOCDAD -> CCRNXTFR) - CTTBASE - 1 ;             0622
         L     @01,IOCDAD(,IOCSPTR)                                0622
         SLR   @00,@00                                             0622
         ICM   @00,7,CCRNXTFR(@01)                                 0622
         SL    @00,@CF00038                                        0622
         STH   @00,CTTSLOT                                         0622
*       CTTLEN = CTTSLOT * LENGTH(CTTENTRY)                        0623
*                + LENGTH(CTTENTNO) ;                              0623
*                                                                  0623
         LA    @01,4                                               0623
         SLA   @00,3                                               0623
         ALR   @00,@01                                             0623
         LR    CTTLEN,@00                                          0623
*       CALL IDCSAGP0 (GDTTBL,CTTLEN+4,CTTPTR,MODIDCTT,SETZERO) ;  0624
*                                                                  0624
         L     @03,@PC00001                                        0624
         ST    @03,@AL00001                                        0624
         ALR   @01,CTTLEN                                          0624
         ST    @01,@AFTEMPS                                        0624
         LA    @15,@AFTEMPS                                        0624
         ST    @15,@AL00001+4                                      0624
         LA    @15,CTTPTR                                          0624
         ST    @15,@AL00001+8                                      0624
         LA    @15,MODIDCTT                                        0624
         ST    @15,@AL00001+12                                     0624
         LA    @15,SETZERO                                         0624
         ST    @15,@AL00001+16                                     0624
         MVI   @AL00001+16,X'80'                                   0624
         L     @15,GDTGPL(,@03)                                    0624
         LA    @01,@AL00001                                        0624
         BALR  @14,@15                                             0624
*       RESPECIFY RTNREG RSTD;                                     0625
*       TESTRC = RTNREG;                                           0626
         STH   RTNREG,TESTRC                                       0626
*       RESPECIFY RTNREG UNRSTD ;                                  0627
*       IF TESTRC = 0                                              0628
*         THEN                                                     0628
         LH    @15,TESTRC                                          0628
         SLR   @14,@14                                             0628
         CR    @15,@14                                             0628
         BNE   @RF00628                                            0628
*           DO ;                                                   0629
*             CTTENTNO = CTTSLOT ;                                 0630
         LH    @15,CTTSLOT                                         0630
         N     @15,@CF01475                                        0630
         L     @01,CTTPTR                                          0630
         ST    @15,CTTENTNO(,@01)                                  0630
*             FMU1STIO = ON ;                                      0631
         OI    FMU1STIO,B'10000000'                                0631
*             FMPLFLNO = 2 ;                                       0632
         L     @15,FMPLAD                                          0632
         MVI   FMPLFLNO(@15),X'02'                                 0632
*             FMFLDNAM = ADDR('ENTYPE  ') ;                        0633
         LA    @03,@CC01234                                        0633
         ST    @03,FMFLDNAM(,FMFLCUR)                              0633
*             FMPLFMFL(2) -> FMFLDNAM = ADDR('ENTIDNO ') ;         0634
         L     @01,FMPLFMFL+4(,@15)                                0634
         LA    @00,@CC01235                                        0634
         ST    @00,FMFLDNAM(,@01)                                  0634
*             IF SDUMPSW = ON                                      0635
*               THEN                                               0635
         TM    SDUMPSW,B'00000010'                                 0635
         BNO   @RF00635                                            0635
*                 DO CTLOOP = 0 TO CTTBASE ;                       0636
         LR    CTLOOP,@14                                          0636
@DL00636 DS    0H                                                  0637
*                   CIFRGET = CTLOOP ;                             0637
*                                                                  0637
         STCM  CTLOOP,7,CIFRGET                                    0637
*                   CALL GETPRT ;  /* PRINT SELF-DESCRIBING          */
*                                                                  0638
         BAL   @14,GETPRT                                          0638
*                 END ;                                            0639
*                                                                  0639
         AL    CTLOOP,@CF00222                                     0639
         C     CTLOOP,@CF00039                                     0639
         BNH   @DL00636                                            0639
*             /*******************************************************/
*             /*       LOOP: GET ALL RECORDS OUT OF                  */
*             /*       THE CRA AND PUT THEIR TYPE                    */
*             /*       AND CATALOG CI IN CTT                         */
*             /*******************************************************/
*                                                                  0640
*             DO CTTSLOT = 1 TO CTTENTNO ;                         0640
@RF00635 LA    @15,1                                               0640
         B     @DE00640                                            0640
@DL00640 DS    0H                                                  0641
*               FMPLBCIN = CTTSLOT + CTTBASE ;                     0641
         L     @14,FMPLAD                                          0641
         AL    @15,@CF00039                                        0641
         STCM  @15,7,FMPLBCIN(@14)                                 0641
*               REG1 = FMPLAD ;                                    0642
*                                                                  0642
         LR    REG1,@14                                            0642
*               CALL IDCRC04 ;     /* ASK ENTYPE AND CATCI           */
*                                                                  0643
         L     @15,@CV00793                                        0643
         BALR  @14,@15                                             0643
*               IF FMFLENTH ^= 0 & ENTYPE ^= 'FF'X                 0644
*                 THEN                                             0644
         L     @15,FMFLENTH(,FMFLCUR)                              0644
         LTR   @15,@15                                             0644
         BZ    @RF00644                                            0644
         L     @15,FMFLADDR(,FMFLCUR)                              0644
         CLI   ENTYPE(@15),X'FF'                                   0644
         BE    @RF00644                                            0644
*                   DO ;                                           0645
*                     CTTENTYP(CTTSLOT) = ENTYPE ;                 0646
         L     @14,CTTPTR                                          0646
         LH    @03,CTTSLOT                                         0646
         N     @03,@CF01475                                        0646
         LR    @02,@03                                             0646
         SLA   @02,3                                               0646
         ST    @02,@TF00001                                        0646
         ALR   @02,@14                                             0646
         AL    @02,@CF01476                                        0646
         MVC   CTTENTYP-4(1,@02),ENTYPE(@15)                       0646
*                     CTTCATCI(CTTSLOT) = FMPLFMFL(2) ->           0647
*                       FMFLADDR(1) -> ENTIDNO ;                   0647
         L     @01,FMPLAD                                          0647
         L     @01,FMPLFMFL+4(,@01)                                0647
         L     @01,FMFLADDR(,@01)                                  0647
         AL    @14,@TF00001                                        0647
         AL    @14,@CF01466                                        0647
         MVC   CTTCATCI-5(3,@14),ENTIDNO(@01)                      0647
*                     IF SDUMPSW = ON                              0648
*                       THEN                                       0648
         TM    SDUMPSW,B'00000010'                                 0648
         BNO   @RF00648                                            0648
*                         DO ;                                     0649
*                           PRNTPASW = ON ;                        0650
         OI    PRNTPASW,B'10000000'                                0650
*                           CIFRGET = CTTSLOT + CTTBASE ;          0651
*                                                                  0651
         LA    @03,8(,@03)                                         0651
         STCM  @03,7,CIFRGET                                       0651
*                           CALL GETPRT ;   /* PRINT SEQ DUMP        */
*                                                                  0652
         BAL   @14,GETPRT                                          0652
*                         END ;                                    0653
*                   END ;                                          0654
*                 ELSE                                             0655
*                   DO ;           /* FIELD MGMT ERROR RETURN        */
         B     @RC00644                                            0655
@RF00644 DS    0H                                                  0656
*                     PROCMSG='CTTBLD  '; /* NAME FOR INSERT @OZ09388*/
         MVC   PROCMSG(8),@CC01237                                 0656
*                     CALL ERROR (12,$RETURN) ;                    0657
         LA    @01,@AL00657                                        0657
         BAL   @14,ERROR                                           0657
*                     CTTENTYP(CTTSLOT) = '7F'X ;                  0658
         L     @15,CTTPTR                                          0658
         LH    @14,CTTSLOT                                         0658
         N     @14,@CF01475                                        0658
         SLA   @14,3                                               0658
         ST    @14,@TF00001                                        0658
         ALR   @14,@15                                             0658
         AL    @14,@CF01476                                        0658
         MVI   CTTENTYP-4(@14),X'7F'                               0658
*                      CTTPRTD(CTTSLOT) = ON ;                     0659
         AL    @15,@TF00001                                        0659
         OI    CTTPRTD-8(@15),B'10000000'                          0659
*                   END ;                                          0660
*             END ;                                                0661
*                                                                  0661
@RC00644 LA    @15,1                                               0661
         LH    @14,CTTSLOT                                         0661
         N     @14,@CF01475                                        0661
         ALR   @15,@14                                             0661
@DE00640 STH   @15,CTTSLOT                                         0661
         L     @14,CTTPTR                                          0661
         C     @15,CTTENTNO(,@14)                                  0661
         BNH   @DL00640                                            0661
*             FMUCTTP = CTTPTR ;   /* SAY BUILT AND TELL IDCLR02     */
         L     @15,CTTPTR                                          0662
         ST    @15,FMUCTTP                                         0662
*             FMU1STIO = OFF ;     /* TO TRANSLATE CI'S              */
         NI    FMU1STIO,B'01111111'                                0663
*             FMPLFLNO = 1 ;       /* REPLACE ASSUMED VALUE          */
         L     @01,FMPLAD                                          0664
         MVI   FMPLFLNO(@01),X'01'                                 0664
*           END ;                                                  0665
*         ELSE CALL ERROR (NBRETE,$RETURN) ; /* GETSPACE FAIL        */
         B     @RC00628                                            0666
@RF00628 LA    @01,@AL00666                                        0666
         BAL   @14,ERROR                                           0666
*     END ;                        /* FMUCTTP=0 SAYS SKIP CRA        */
*   ELSE CALL ERROR (11,$RETURN) ; /* GET FOR CRA CCR FAILED         */
*                                                                  0668
         B     @RC00620                                            0668
@RF00620 LA    @01,@AL00668                                        0668
         BAL   @14,ERROR                                           0668
*END CTTBLD ;                                                      0669
@EL00010 DS    0H                                                  0669
@EF00010 DS    0H                                                  0669
@ER00010 LM    @14,@12,@SA00010                                    0669
         BR    @14                                                 0669
* /*******************************************************************/
* /* PROCEDURE NAME - DOOTHR, DO LOOP THRU SORTTBL                   */
* /* FUNCTION -                                                      */
* /*   FOLLOW STFRWD (FORWARD) PATH THRU SORTTBL FOR CIS,            */
* /*     CALL PRTOTHR TO PRINT OTHER THAN VSAM STRUCTURES            */
* /*     INCLUDING USERCATALOG POINTER RECORDS,                      */
* /*   DELETE THE SORTTBL                                            */
* /* INPUTS -                                                        */
* /*   SORTTBL (GDGBASE, NONVSAM, USERCAT POINTERS)                  */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   PRTOTHR, UREST, UFPOOL                                        */
* /*******************************************************************/
*                                                                  0670
*DOOTHR: PROCEDURE ;                                               0670
DOOTHR   STM   @14,@12,@SA00011                                    0670
* OLDERID2 = NEWERID2;                                             0671
         L     @15,@PC00001                                        0671
         L     @14,GDTTR2(,@15)                                    0671
         MVC   @TS00001(95),NEWERID2(@14)                          0671
         MVC   OLDERID2(95,@14),@TS00001                           0671
* NEWID2 = 'LRDO' ;                                                0672
         MVC   NEWID2(4,@14),@CC01242                              0672
* IF GDTDBG = NULLPTR                                              0673
*   THEN;                                                          0673
         L     @15,GDTDBG(,@15)                                    0673
         LTR   @15,@15                                             0673
         BZ    @RT00673                                            0673
*   ELSE                                                           0675
*     CALL IDCDB010 (GDTTBL,'LRDO') ;                              0675
*                                                                  0675
         L     @15,@PC00001                                        0675
         ST    @15,@AL00001                                        0675
         LA    @14,@CC01242                                        0675
         ST    @14,@AL00001+4                                      0675
         MVI   @AL00001+4,X'80'                                    0675
         L     @15,GDTDBG(,@15)                                    0675
         LA    @01,@AL00001                                        0675
         BALR  @14,@15                                             0675
* IF STSLTCNT ^= 0                                                 0676
*   THEN                                                           0676
@RT00673 LH    @15,STSLTCNT                                        0676
         N     @15,@CF01475                                        0676
         LTR   @15,@15                                             0676
         BZ    @RF00676                                            0676
*     DO ;                                                         0677
*       SUBGROUP = 'OTHER ENTRIES' ;                               0678
         MVI   SUBGROUP+13,C' '                                    0678
         MVC   SUBGROUP+14(2),SUBGROUP+13                          0678
         MVC   SUBGROUP(13),@CC01243                               0678
*       IF GDTECT = NULLPTR        /* IF NOT RUNNING UNDER TSO       */
*                                                                  0679
*         THEN CALL AMSTP043 (GDTTBL,IOCSPRT,PCRST) ;              0679
*                                                                  0679
         L     @15,@PC00001                                        0679
         L     @14,GDTECT(,@15)                                    0679
         LTR   @14,@14                                             0679
         BNZ   @RF00679                                            0679
         ST    @15,@AL00001                                        0680
         LA    @14,IOCSPRT                                         0680
         ST    @14,@AL00001+4                                      0680
         LA    @14,PCRST                                           0680
         ST    @14,@AL00001+8                                      0680
         MVI   @AL00001+8,X'80'                                    0680
         L     @15,GDTRST(,@15)                                    0680
         LA    @01,@AL00001                                        0680
         BALR  @14,@15                                             0680
*       STSLOT = STFRWD(1) ;                                       0681
*                                                                  0681
@RF00679 L     @01,STPTR                                           0681
         LH    STSLOT,STFRWD(,@01)                                 0681
         N     STSLOT,@CF01475                                     0681
*       /*************************************************************/
*       /*     LOOP: GO PRINT ALL ENTRIES IN SORTTBL                 */
*       /*************************************************************/
*                                                                  0682
*       DO UNTIL (STCRACI(STSLOT) = STENDCI) ;                     0682
*                                                                  0682
@DL00682 DS    0H                                                  0683
*         CALL PRTOTHR ;                                           0683
*                                                                  0683
         BAL   @14,PRTOTHR                                         0683
*         STSLOT = STFRWD(STSLOT) ;                                0684
         LR    @02,STSLOT                                          0684
         MH    @02,@CH01068                                        0684
         L     @01,STPTR                                           0684
         AL    @01,@CF01476                                        0684
         LH    @02,STFRWD-52(@02,@01)                              0684
         N     @02,@CF01475                                        0684
         LR    STSLOT,@02                                          0684
*       END ;                                                      0685
@DE00682 LR    @02,STSLOT                                          0685
         MH    @02,@CH01068                                        0685
         L     @01,STPTR                                           0685
         ALR   @01,@02                                             0685
         AL    @01,@CF01477                                        0685
         CLC   STCRACI-45(3,@01),STENDCI                           0685
         BNE   @DL00682                                            0685
*     END ;                                                        0686
* CALL IDCSAFP0 (GDTTBL,MODIDST) ; /* FREE SORTTBL SPACE             */
@RF00676 L     @04,@PC00001                                        0687
         ST    @04,@AL00001                                        0687
         LA    @15,MODIDST                                         0687
         ST    @15,@AL00001+4                                      0687
         MVI   @AL00001+4,X'80'                                    0687
         L     @15,GDTFPL(,@04)                                    0687
         LA    @01,@AL00001                                        0687
         BALR  @14,@15                                             0687
*END DOOTHR ;                                                      0688
@EL00011 DS    0H                                                  0688
@EF00011 DS    0H                                                  0688
@ER00011 LM    @14,@12,@SA00011                                    0688
         BR    @14                                                 0688
* /*******************************************************************/
* /* PROCEDURE NAME - DOVSAM, DO LOOP THRU SORTTBL                   */
* /* FUNCTION -                                                      */
* /*   FOLLOW STFRWD (FORWARD) PATH THRU SORTTBL FOR CIS,            */
* /*     CALL PRTVSAM TO PRINT VSAM STRUCTURES,                      */
* /*   DELETE THE SORTTBL                                            */
* /* INPUTS -                                                        */
* /*   SORTTBL (CLUSTER AND AIX RECORDS ONLY)                        */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   PRTVSAM, UFPOOL                                               */
* /*******************************************************************/
*                                                                  0689
*DOVSAM: PROCEDURE ;                                               0689
DOVSAM   STM   @14,@12,@SA00012                                    0689
* OLDERID2 = NEWERID2;                                             0690
         L     @15,@PC00001                                        0690
         L     @14,GDTTR2(,@15)                                    0690
         MVC   @TS00001(95),NEWERID2(@14)                          0690
         MVC   OLDERID2(95,@14),@TS00001                           0690
* NEWID2 = 'LRDV' ;                                                0691
         MVC   NEWID2(4,@14),@CC01249                              0691
* IF GDTDBG = NULLPTR                                              0692
*   THEN;                                                          0692
         L     @15,GDTDBG(,@15)                                    0692
         LTR   @15,@15                                             0692
         BZ    @RT00692                                            0692
*   ELSE                                                           0694
*     CALL IDCDB010 (GDTTBL,'LRDV') ;                              0694
*                                                                  0694
         L     @15,@PC00001                                        0694
         ST    @15,@AL00001                                        0694
         LA    @14,@CC01249                                        0694
         ST    @14,@AL00001+4                                      0694
         MVI   @AL00001+4,X'80'                                    0694
         L     @15,GDTDBG(,@15)                                    0694
         LA    @01,@AL00001                                        0694
         BALR  @14,@15                                             0694
* IF STSLTCNT ^= 0                                                 0695
*   THEN                                                           0695
@RT00692 LH    @15,STSLTCNT                                        0695
         N     @15,@CF01475                                        0695
         LTR   @15,@15                                             0695
         BZ    @RF00695                                            0695
*     DO ;                                                         0696
*       STSLOT = STFRWD(1) ;                                       0697
*                                                                  0697
         L     @01,STPTR                                           0697
         LH    STSLOT,STFRWD(,@01)                                 0697
         N     STSLOT,@CF01475                                     0697
*       /*************************************************************/
*       /*      LOOP: GO PRINT ALL ENTRIES IN SORTTBL                */
*       /*************************************************************/
*                                                                  0698
*       DO UNTIL (STCRACI(STSLOT) = STENDCI) ;                     0698
@DL00698 DS    0H                                                  0699
*         CALL PRTVSAM ;                                           0699
         BAL   @14,PRTVSAM                                         0699
*         STSLOT = STFRWD(STSLOT) ;                                0700
         LR    @02,STSLOT                                          0700
         MH    @02,@CH01068                                        0700
         L     @01,STPTR                                           0700
         AL    @01,@CF01476                                        0700
         LH    @02,STFRWD-52(@02,@01)                              0700
         N     @02,@CF01475                                        0700
         LR    STSLOT,@02                                          0700
*       END ;                                                      0701
@DE00698 LR    @02,STSLOT                                          0701
         MH    @02,@CH01068                                        0701
         L     @01,STPTR                                           0701
         ALR   @01,@02                                             0701
         AL    @01,@CF01477                                        0701
         CLC   STCRACI-45(3,@01),STENDCI                           0701
         BNE   @DL00698                                            0701
*     END ;                                                        0702
* CALL IDCSAFP0 (GDTTBL,MODIDST) ; /* FREE SORTTBL SPACE             */
*                                                                  0703
@RF00695 L     @04,@PC00001                                        0703
         ST    @04,@AL00001                                        0703
         LA    @15,MODIDST                                         0703
         ST    @15,@AL00001+4                                      0703
         MVI   @AL00001+4,X'80'                                    0703
         L     @15,GDTFPL(,@04)                                    0703
         LA    @01,@AL00001                                        0703
         BALR  @14,@15                                             0703
*END DOVSAM ;                                                      0704
@EL00012 DS    0H                                                  0704
@EF00012 DS    0H                                                  0704
@ER00012 LM    @14,@12,@SA00012                                    0704
         BR    @14                                                 0704
* /*******************************************************************/
* /* PROCEDURE NAME - ERROR, HANDLE ERRORS                           */
* /* FUNCTION -                                                      */
* /*   USING ENTRY SUBSCRIPT FOR ERRTBL PASSED                       */
* /*   KEEP THE HIGHEST LASTCC,                                      */
* /*   IF REQUESTED PRINT THE APPROPRIATE ERROR MESSAGE,             */
* /*   IF I/O ERROR TURN THE BIT IN THE IOCS THAT SAYS THE           */
* /*   DATA SET IS OPEN BACK ON SO THE ERROR CAN BE IGNORED          */
* /*   (I/O ADAPTER SETS NOT OPEN AFTER ERROR)                       */
* /*   IF I/O ERROR COUNT IS GREATER THAN THE LIMIT PRINT            */
* /*   AN ADDITIONAL TERMINATION MESSAGE,                            */
* /*   IF CALLER SET GONOGO TO NONZERO OR I/O ERROR COUNT            */
* /*   IS GREATER THAN THE LIMIT ABORT USING UEPIL                   */
* /* INPUTS -                                                        */
* /*   SUBSCRIPT OF ERROR MESSAGE CONTROL INFO IN ERRTBL             */
* /*   GONOGO (INDICATES RETURN OR ABORT)                            */
* /*   ERRTBL                                                        */
* /* OUTPUTS -                                                       */
* /*   LRLASTCC POSSIBLY RAISED                                      */
* /*   ERROR MESSAGE(S) AND POSSIBLE ABORT                           */
* /* CALLS -                                                         */
* /*   UPRINT, UEPIL                                                 */
* /*******************************************************************/
*                                                                  0705
*ERROR: PROCEDURE (ETARG,GONOGO) ;                                 0705
ERROR    STM   @14,@12,@SA00013                                    0705
         MVC   @PC00013(8),0(@01)                                  0705
* OLDERID2 = NEWERID2;                                             0706
         L     @04,@PC00001                                        0706
         L     @15,GDTTR2(,@04)                                    0706
         MVC   @TS00001(95),NEWERID2(@15)                          0706
         MVC   OLDERID2(95,@15),@TS00001                           0706
* NEWID2 = 'LRER' ;                                                0707
         MVC   NEWID2(4,@15),@CC01258                              0707
* IF GDTDBG = NULLPTR                                              0708
*   THEN;                                                          0708
         L     @04,GDTDBG(,@04)                                    0708
         LTR   @04,@04                                             0708
         BZ    @RT00708                                            0708
*   ELSE                                                           0710
*     CALL IDCDB010 (GDTTBL,'LRER') ;                              0710
*                                                                  0710
         L     @04,@PC00001                                        0710
         ST    @04,@AL00001                                        0710
         LA    @15,@CC01258                                        0710
         ST    @15,@AL00001+4                                      0710
         MVI   @AL00001+4,X'80'                                    0710
         L     @15,GDTDBG(,@04)                                    0710
         LA    @01,@AL00001                                        0710
         BALR  @14,@15                                             0710
* DCL                                                              0711
*   ETARG           FIXED(31),     /* SUBSCRIPT IN ERRTBL            */
*   GONOGO          FIXED(8),      /* NONZERO VALUE = ABORT          */
* ENDCLSER CHAR(1);                                                0711
*                                                                  0711
@RT00708 DS    0H                                                  0712
* IF ERRRTNCD(ETARG) > LRLASTCC                                    0712
*   THEN                                                           0712
         L     @04,@PC00013                                        0712
         L     @04,ETARG(,@04)                                     0712
         MH    @04,@CH00035                                        0712
         SLR   @15,@15                                             0712
         IC    @15,ERRRTNCD-12(@04)                                0712
         CH    @15,LRLASTCC                                        0712
         BNH   @RF00712                                            0712
*     LRLASTCC = ERRRTNCD(ETARG) ;                                 0713
         STH   @15,LRLASTCC                                        0713
* DDSTRUSV = DDSTRU ;              /* SAVE NORMAL DARGLIST           */
@RF00712 L     DDSTRUSV,DDSTRU                                     0714
* DDSTRU = DDSTRUE ;               /* ADDR, CHANGE TO ERROR          */
         L     @04,DDSTRUE                                         0715
         ST    @04,DDSTRU                                          0715
* DARGLIST = '0'B ;                                                0716
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0716
         MVI   DARGLIST(@04),B'00000000'                           0716
* DARGSMOD = ERRSTMOD(ETARG) ;                                     0717
         L     @03,@PC00013                                        0717
         L     @03,ETARG(,@03)                                     0717
         MH    @03,@CH00035                                        0717
         LA    @01,ERRSTMOD-12(@03)                                0717
         MVC   DARGSMOD(3,@04),0(@01)                              0717
* DARGSENT = ERRSTENT(ETARG) ;                                     0718
         SLR   @15,@15                                             0718
         IC    @15,ERRSTENT-12(@03)                                0718
         STC   @15,DARGSENT(,@04)                                  0718
* IF DARGSMOD = 'LR1' & DARGSENT = 1                               0719
*   THEN                                                           0719
         CLC   DARGSMOD(3,@04),@CC00775                            0719
         BNE   @RF00719                                            0719
         CLI   DARGSENT(@04),1                                     0719
         BNE   @RF00719                                            0719
*     DO ;                                                         0720
*       ERRCNTIO = ERRCNTIO + 1 ;  /* BUMP IO ERR CNT                */
         IC    @04,ERRCNTIO                                        0721
         LA    @04,1(,@04)                                         0721
         STC   @04,ERRCNTIO                                        0721
*       IOCSCRA -> IOCMSGOP = ON ; /* SET IOCS TO OPEN               */
         L     @04,IOCSCRA                                         0722
         OI    IOCMSGOP(@04),B'00100000'                           0722
*     END ;                        /* SO IOERR CAN BE IGNORED        */
* IF DARGSMOD = 'LR1' & DARGSENT = 2                               0724
*   THEN                                                           0724
@RF00719 L     @04,DDSTRU                                          0724
         CLC   DARGSMOD(3,@04),@CC00775                            0724
         BNE   @RF00724                                            0724
         CLI   DARGSENT(@04),2                                     0724
         BNE   @RF00724                                            0724
*     DO ;                                                         0725
*       ERRCNTIO = ERRCNTIO + 1 ;  /* BUMP IO ERR CNT                */
         IC    @04,ERRCNTIO                                        0726
         LA    @04,1(,@04)                                         0726
         STC   @04,ERRCNTIO                                        0726
*       IOCSCAT -> IOCMSGOP = ON ; /* SET IOCS TO OPEN               */
         L     @04,IOCSCAT                                         0727
         OI    IOCMSGOP(@04),B'00100000'                           0727
*     END ;                        /* SO IOERR CAN BE IGNORED        */
* IF DARGSMOD = 'LR1' & ERRILEN(ETARG) ^= 0                        0729
*   THEN                                                           0729
@RF00724 L     @04,DDSTRU                                          0729
         CLC   DARGSMOD(3,@04),@CC00775                            0729
         BNE   @RF00729                                            0729
         L     @03,@PC00013                                        0729
         L     @03,ETARG(,@03)                                     0729
         MH    @03,@CH00035                                        0729
         SLR   @15,@15                                             0729
         IC    @15,ERRILEN-12(@03)                                 0729
         LTR   @15,@15                                             0729
         BZ    @RF00729                                            0729
*     DO ;                         /* ADD INSERT GROUP               */
*       DARGCNT = 1 ;                                              0731
*                                                                  0731
         LA    @14,1                                               0731
         STH   @14,DARGCNT(,@04)                                   0731
*       DARGINS(1) = 1 ;                                           0732
*                                                                  0732
         STH   @14,DARGINS(,@04)                                   0732
*       DARGINL(1) = ERRILEN(ETARG) ;                              0733
         STH   @15,DARGINL(,@04)                                   0733
*                                  /* IF ADDR IS CODE USE IT         */
*                                  /* TO FIND CI TO INSERT           */
*       IF ERRIADDR(ETARG) = 1                                     0734
*         THEN DARGDTM(1) = ADDR(CATNMCRA) ;                       0734
         C     @14,ERRIADDR-12(@03)                                0734
         BNE   @RF00734                                            0734
         LA    @03,CATNMCRA                                        0735
         ST    @03,DARGDTM(,@04)                                   0735
*         ELSE                                                     0736
*           IF ERRIADDR(ETARG) = 2                                 0736
*             THEN DARGDTM(1) = ADDR(CATCI) ;                      0736
         B     @RC00734                                            0736
@RF00734 L     @04,@PC00013                                        0736
         L     @04,ETARG(,@04)                                     0736
         MH    @04,@CH00035                                        0736
         L     @04,ERRIADDR-12(@04)                                0736
         C     @04,@CF00158                                        0736
         BNE   @RF00736                                            0736
         LA    @04,CATCI                                           0737
         L     @03,DDSTRU                                          0737
         ST    @04,DARGDTM(,@03)                                   0737
*             ELSE                                                 0738
*               IF ERRIADDR(ETARG) = 3                             0738
*                 THEN DARGDTM(1) = ADDR(CIFRGET) ;                0738
*                                                                  0738
         B     @RC00736                                            0738
@RF00736 L     @04,@PC00013                                        0738
         L     @04,ETARG(,@04)                                     0738
         MH    @04,@CH00035                                        0738
         L     @04,ERRIADDR-12(@04)                                0738
         C     @04,@CF00166                                        0738
         BNE   @RF00738                                            0738
         LA    @04,CIFRGET                                         0739
         L     @03,DDSTRU                                          0739
         ST    @04,DARGDTM(,@03)                                   0739
*                                  /* NOT CODE SO INSERT             */
*                 ELSE             /* FROM TABLE ITSELF              */
*                   IF ERRIADDR(ETARG) = 4                         0740
*                     THEN DARGDTM(1) = ADDR(CIFRTRNS) ;           0740
         B     @RC00738                                            0740
@RF00738 L     @04,@PC00013                                        0740
         L     @04,ETARG(,@04)                                     0740
         MH    @04,@CH00035                                        0740
         L     @04,ERRIADDR-12(@04)                                0740
         C     @04,@CF00047                                        0740
         BNE   @RF00740                                            0740
         LA    @04,CIFRTRNS                                        0741
         L     @03,DDSTRU                                          0741
         ST    @04,DARGDTM(,@03)                                   0741
*                                  /* NOT CODE SO INSERT     @OZ09388*/
*                     ELSE         /* FROM TABLE ITSELF      @OZ09388*/
*                       IF ERRIADDR(ETARG) = 5             /*@OZ09388*/
*                          THEN DARGDTM(1)= ADDR(PROCMSG); /*@OZ09388*/
         B     @RC00740                                            0742
@RF00740 L     @04,@PC00013                                        0742
         L     @04,ETARG(,@04)                                     0742
         MH    @04,@CH00035                                        0742
         L     @04,ERRIADDR-12(@04)                                0742
         C     @04,@CF00042                                        0742
         BNE   @RF00742                                            0742
         LA    @04,PROCMSG                                         0743
         L     @03,DDSTRU                                          0743
         ST    @04,DARGDTM(,@03)                                   0743
*                          ELSE DARGDTM(1) = ERRIADDR(ETARG) ;     0744
         B     @RC00742                                            0744
@RF00742 L     @04,@PC00013                                        0744
         L     @04,ETARG(,@04)                                     0744
         MH    @04,@CH00035                                        0744
         L     @04,ERRIADDR-12(@04)                                0744
         L     @03,DDSTRU                                          0744
         ST    @04,DARGDTM(,@03)                                   0744
*                                                          /*@OZ09388*/
*     END ;                                                        0745
@RC00742 DS    0H                                                  0745
@RC00740 DS    0H                                                  0745
@RC00738 DS    0H                                                  0745
@RC00736 DS    0H                                                  0745
@RC00734 DS    0H                                                  0746
* IF DARGSMOD = 'UV0' & ERRILEN(ETARG) ^= 0                        0746
*   THEN                                                           0746
@RF00729 L     @04,DDSTRU                                          0746
         CLC   DARGSMOD(3,@04),@CC00777                            0746
         BNE   @RF00746                                            0746
         L     @03,@PC00013                                        0746
         L     @03,ETARG(,@03)                                     0746
         MH    @03,@CH00035                                        0746
         SLR   @15,@15                                             0746
         IC    @15,ERRILEN-12(@03)                                 0746
         LTR   @15,@15                                             0746
         BZ    @RF00746                                            0746
*     DO ;                         /* FOR FUTURE USE CNSISTNT        */
*       DARGILP = ERRILEN(ETARG) ;                                 0748
         STH   @15,DARGILP(,@04)                                   0748
*       DARGDBP = ERRIADDR(ETARG) ;                                0749
         L     @03,ERRIADDR-12(@03)                                0749
         ST    @03,DARGDBP(,@04)                                   0749
*     END ;                                                        0750
* IF DARGSMOD ^= '   '             /* IF NOT JUST TO SET EC          */
*                                                                  0751
*   THEN CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                   0751
*                                                                  0751
@RF00746 L     @04,DDSTRU                                          0751
         CLC   DARGSMOD(3,@04),@CC00776                            0751
         BE    @RF00751                                            0751
         L     @04,@PC00001                                        0752
         ST    @04,@AL00001                                        0752
         LA    @03,IOCSPRT                                         0752
         ST    @03,@AL00001+4                                      0752
         LA    @03,DDSTRU                                          0752
         ST    @03,@AL00001+8                                      0752
         MVI   @AL00001+8,X'80'                                    0752
         L     @15,GDTPRT(,@04)                                    0752
         LA    @01,@AL00001                                        0752
         BALR  @14,@15                                             0752
* IF ERRCNTIO = ERRLMT                                             0753
*   THEN                                                           0753
@RF00751 CLI   ERRCNTIO,50                                         0753
         BNE   @RF00753                                            0753
*     DO ;                                                         0754
*       DARGLIST = '0'B ;                                          0755
         L     @04,DDSTRU                                          0755
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  0755
         MVI   DARGLIST(@04),B'00000000'                           0755
*       DARGSMOD = 'LR1' ;                                         0756
         MVC   DARGSMOD(3,@04),@CC00775                            0756
*       DARGSENT = 14 ;                                            0757
*                                                                  0757
         MVI   DARGSENT(@04),X'0E'                                 0757
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    0758
*                                                                  0758
         L     @04,@PC00001                                        0758
         ST    @04,@AL00001                                        0758
         LA    @03,IOCSPRT                                         0758
         ST    @03,@AL00001+4                                      0758
         LA    @03,DDSTRU                                          0758
         ST    @03,@AL00001+8                                      0758
         MVI   @AL00001+8,X'80'                                    0758
         L     @15,GDTPRT(,@04)                                    0758
         LA    @01,@AL00001                                        0758
         BALR  @14,@15                                             0758
*     END ;                                                        0759
* IF GDTDBG = NULLPTR                                              0760
*   THEN;                                                          0760
@RF00753 L     @04,@PC00001                                        0760
         L     @04,GDTDBG(,@04)                                    0760
         LTR   @04,@04                                             0760
         BZ    @RT00760                                            0760
*   ELSE                                                           0762
*     CALL IDCDB010 (GDTTBL,'LRZY') ;/*                            0762
*                                     DUMP ID IF ERROR CALLED        */
         L     @04,@PC00001                                        0762
         ST    @04,@AL00001                                        0762
         LA    @03,@CC01260                                        0762
         ST    @03,@AL00001+4                                      0762
         MVI   @AL00001+4,X'80'                                    0762
         L     @15,GDTDBG(,@04)                                    0762
         LA    @01,@AL00001                                        0762
         BALR  @14,@15                                             0762
* IF GONOGO ^= 0 × ERRCNTIO = ERRLMT                               0763
*   THEN                                                           0763
@RT00760 L     @04,@PC00013+4                                      0763
         CLI   GONOGO(@04),0                                       0763
         BNE   @RT00763                                            0763
         CLI   ERRCNTIO,50                                         0763
         BNE   @RF00763                                            0763
@RT00763 DS    0H                                                  0764
*     DO ;                                                         0764
*       IF GDTDBG = NULLPTR                                        0765
*         THEN;                                                    0765
         L     @04,@PC00001                                        0765
         L     @04,GDTDBG(,@04)                                    0765
         LTR   @04,@04                                             0765
         BZ    @RT00765                                            0765
*         ELSE                                                     0767
*           CALL IDCDB010 (GDTTBL,'LRZZ') ;/*                      0767
*                                     DUMP ID ONLY IF ABORT          */
         L     @04,@PC00001                                        0767
         ST    @04,@AL00001                                        0767
         LA    @03,@CC01261                                        0767
         ST    @03,@AL00001+4                                      0767
         MVI   @AL00001+4,X'80'                                    0767
         L     @15,GDTDBG(,@04)                                    0767
         LA    @01,@AL00001                                        0767
         BALR  @14,@15                                             0767
*       LASTCC = LASTCC12 ;                                        0768
*                                                                  0768
@RT00765 L     @04,@PC00001+8                                      0768
         MVC   LASTCC(2,@04),@CH00035                              0768
*         CALL IDCSAEP0(GDTTBL,MODID,LASTCC);         /* ABORT WHOLE FU
*CTION           */                                                0769
*                                                                  0769
         L     @03,@PC00001                                        0769
         ST    @03,@AL00001                                        0769
         LA    @15,MODID                                           0769
         ST    @15,@AL00001+4                                      0769
         ST    @04,@AL00001+8                                      0769
         MVI   @AL00001+8,X'80'                                    0769
         L     @15,GDTEPL(,@03)                                    0769
         LA    @01,@AL00001                                        0769
         BALR  @14,@15                                             0769
*     END ;                                                        0770
* DDSTRU = DDSTRUSV ;              /* REPLACE ASSUMED VALUE          */
*                                                                  0771
@RF00763 ST    DDSTRUSV,DDSTRU                                     0771
*END ERROR ;                                                       0772
@EL00013 DS    0H                                                  0772
@EF00013 DS    0H                                                  0772
@ER00013 LM    @14,@12,@SA00013                                    0772
         BR    @14                                                 0772
* /*******************************************************************/
* /* PROCEDURE NAME - GETPRT, GET AND CALL FOR PRINT RECORD(S        */
* /* FUNCTION -                                                      */
* /*   GET THE CRA COPY OF THE RECORD,                               */
* /*   CALL FIELD MGMT FOR FIELDS LISTED BELOW,                      */
* /*   IGNORE FREESPACE RECORDS UNLESS DUMP AND NOCOMPARE,           */
* /*   CALL BUFSHUF TO MOVE RECORD TO ITS 'HOME' BUFFER,             */
* /*   IF COMPARE SPECIFIED GET THE ORIGINAL CATALOG RECORD,         */
* /*   CALL PRTCMP TO DO PRINTING (AND OPTIONAL COMPARING)           */
* /* INPUTS -                                                        */
* /*   CIFRGET (IDENTIFIES RECORD WANTED)                            */
* /*   CRA                                                           */
* /*   CATALOG                                                       */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   UGET, BUFSHUF, PRTCMP, ERROR,                                 */
* /*   IDCRC04(ENTNAME, ENTYPE)                                      */
* /*******************************************************************/
*                                                                  0773
*GETPRT: PROCEDURE ;                                               0773
GETPRT   STM   @14,@12,@SA00014                                    0773
*   OLDERID2 = NEWERID2;                                           0774
         L     @15,@PC00001                                        0774
         L     @14,GDTTR2(,@15)                                    0774
         MVC   @TS00001(95),NEWERID2(@14)                          0774
         MVC   OLDERID2(95,@14),@TS00001                           0774
*   NEWID2 = 'LRGE' ;                                              0775
         MVC   NEWID2(4,@14),@CC01265                              0775
*   IF GDTDBG = NULLPTR                                            0776
*     THEN;                                                        0776
         L     @15,GDTDBG(,@15)                                    0776
         LTR   @15,@15                                             0776
         BZ    @RT00776                                            0776
*     ELSE                                                         0778
*       CALL IDCDB010 (GDTTBL,'LRGE') ;                            0778
*                                                                  0778
         L     @15,@PC00001                                        0778
         ST    @15,@AL00001                                        0778
         LA    @14,@CC01265                                        0778
         ST    @14,@AL00001+4                                      0778
         MVI   @AL00001+4,X'80'                                    0778
         L     @15,GDTDBG(,@15)                                    0778
         LA    @01,@AL00001                                        0778
         BALR  @14,@15                                             0778
*   IOBFSPTR = IOCRBPTR ;                                          0779
@RT00776 L     @15,IOCRBPTR                                        0779
         ST    @15,IOBFSPTR                                        0779
*   DO BUFNO = 1 TO NBRBUF         /* SEE IF ALREADY IN BUFF         */
*      WHILE (CIFRGET ^= IOBUFCI(BUFNO)) ;                         0780
         LA    @15,1                                               0780
         STC   @15,BUFNO                                           0780
@DL00780 LR    @14,@15                                             0780
         SLA   @14,9                                               0780
         L     @01,IOBFSPTR                                        0780
         ALR   @01,@14                                             0780
         AL    @01,@CF01466                                        0780
         CLC   CIFRGET(3),IOBUFCI-509(@01)                         0780
         BE    @DC00780                                            0780
*   END ;                                                          0781
         AL    @15,@CF00222                                        0781
         STC   @15,BUFNO                                           0781
         C     @15,@CF00047                                        0781
         BNH   @DL00780                                            0781
@DC00780 DS    0H                                                  0782
*   IF BUFNO ^= NBRBUF + 1                                         0782
*     THEN TESTRC = 0 ;            /* FOUND-DO NOT DO GET            */
         CLI   BUFNO,5                                             0782
         BE    @RF00782                                            0782
         SLR   @15,@15                                             0783
         STH   @15,TESTRC                                          0783
*     ELSE                         /* NOT FOUND                      */
*       DO ;                                                       0784
         B     @RC00782                                            0784
@RF00782 DS    0H                                                  0785
*         BUFNO = NBRBUF ;         /* USE LAST BUFFER                */
         MVI   BUFNO,X'04'                                         0785
*         IOCSPTR = IOCSCRA ;      /* SET UP TO GET CRA RCD          */
         L     IOCSPTR,IOCSCRA                                     0786
*         IOCRBA = CIFRGET * CATCISZ ;                             0787
*                                                                  0787
         L     @02,CIFRGET-1                                       0787
         LA    @02,0(,@02)                                         0787
         SLA   @02,9                                               0787
         ST    @02,IOCRBA(,IOCSPTR)                                0787
*         CALL IDCIOGT0 (GDTTBL,IOCSCRA) ;                         0788
*                                                                  0788
         L     @02,@PC00001                                        0788
         ST    @02,@AL00001                                        0788
         LA    @15,IOCSCRA                                         0788
         ST    @15,@AL00001+4                                      0788
         MVI   @AL00001+4,X'80'                                    0788
         L     @15,GDTGET(,@02)                                    0788
         LA    @01,@AL00001                                        0788
         BALR  @14,@15                                             0788
*         RESPECIFY RTNREG RSTD;                                   0789
*         TESTRC = RTNREG;                                         0790
         STH   RTNREG,TESTRC                                       0790
*         RESPECIFY RTNREG UNRSTD ;                                0791
*         IF TESTRC = 0                                            0792
*           THEN                                                   0792
         LH    @02,TESTRC                                          0792
         LTR   @02,@02                                             0792
         BNZ   @RF00792                                            0792
*             DO ;                 /* MOVE INTO BUFFER               */
*               IOBUF(BUFNO,1:256) = IOBUFDMY(1:256) ;             0794
         L     @02,IOBFSPTR                                        0794
         SLR   @15,@15                                             0794
         IC    @15,BUFNO                                           0794
         SLA   @15,9                                               0794
         ST    @15,@TF00001                                        0794
         ALR   @15,@02                                             0794
         AL    @15,@CF01464                                        0794
         L     @14,IOCDAD(,IOCSPTR)                                0794
         MVC   IOBUF(256,@15),IOBUFDMY(@14)                        0794
*               IOBUF(BUFNO,257:508) = IOBUFDMY(257:508) ;         0795
         LR    @01,@02                                             0795
         AL    @01,@TF00001                                        0795
         AL    @01,@CF01465                                        0795
         MVC   IOBUF(252,@01),IOBUFDMY+256(@14)                    0795
*               IOBUFCI(BUFNO) = CIFRGET ;                         0796
         AL    @02,@TF00001                                        0796
         AL    @02,@CF01466                                        0796
         MVC   IOBUFCI-509(3,@02),CIFRGET                          0796
*             END ;                /* AND ADD CI FOR SEARCH          */
*       END ;                                                      0798
@RF00792 DS    0H                                                  0799
*   IF TESTRC = 0                                                  0799
*     THEN                                                         0799
@RC00782 LH    @15,TESTRC                                          0799
         LTR   @15,@15                                             0799
         BNZ   @RF00799                                            0799
*       DO ;                                                       0800
*         IF SDUMPSW ^= ON                                         0801
*           THEN                                                   0801
         TM    SDUMPSW,B'00000010'                                 0801
         BO    @RF00801                                            0801
*             DO ;                                                 0802
*               FMPLFLNO = 2 ;     /* SET UP TO GET 2 FIELDS         */
         L     @15,FMPLAD                                          0803
         MVI   FMPLFLNO(@15),X'02'                                 0803
*               IF CIFRGET > CTTBASE & FMUFRSP ^= ON               0804
*                 THEN FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;      0804
         L     @14,CIFRGET-1                                       0804
         LA    @14,0(,@14)                                         0804
         C     @14,@CF00039                                        0804
         BNH   @RF00804                                            0804
         TM    FMUFRSP,B'00100000'                                 0804
         BO    @RF00804                                            0804
         SLA   @14,3                                               0805
         L     @01,CTTPTR                                          0805
         ALR   @01,@14                                             0805
         AL    @01,@CF01478                                        0805
         MVC   FMPLBCIN(3,@15),CTTCATCI-5(@01)                     0805
*                 ELSE FMPLBCIN = CIFRGET ;                        0806
         B     @RC00804                                            0806
@RF00804 L     @01,FMPLAD                                          0806
         MVC   FMPLBCIN(3,@01),CIFRGET                             0806
*               FMFLDNAM = ADDR('ENTNAME ') ;                      0807
@RC00804 LA    @15,@CC01195                                        0807
         ST    @15,FMFLDNAM(,FMFLCUR)                              0807
*               FMPLFMFL(2) -> FMFLDNAM = ADDR('ENTYPE  ') ;       0808
         L     @15,FMPLAD                                          0808
         L     @01,FMPLFMFL+4(,@15)                                0808
         LA    @00,@CC01234                                        0808
         ST    @00,FMFLDNAM(,@01)                                  0808
*               REG1 = FMPLAD ;                                    0809
*                                                                  0809
         LR    REG1,@15                                            0809
*               CALL IDCRC04 ;                                     0810
*                                                                  0810
         L     @15,@CV00793                                        0810
         BALR  @14,@15                                             0810
*               FMPLFLNO = 1 ;                                     0811
         L     @15,FMPLAD                                          0811
         MVI   FMPLFLNO(@15),X'01'                                 0811
*               ENTYPSAV = FMPLFMFL(2) -> FMFLADDR(1) -> ENTYPE ;  0812
         L     @01,FMPLFMFL+4(,@15)                                0812
         L     @01,FMFLADDR(,@01)                                  0812
         MVC   ENTYPSAV(1),ENTYPE(@01)                             0812
*             END ;                                                0813
*         IF FMPLFMFL(2) -> FMFLENTH ^= 0 × SDUMPSW = ON           0814
*           THEN                                                   0814
@RF00801 L     @01,FMPLAD                                          0814
         L     @01,FMPLFMFL+4(,@01)                                0814
         L     @15,FMFLENTH(,@01)                                  0814
         LTR   @15,@15                                             0814
         BNZ   @RT00814                                            0814
         TM    SDUMPSW,B'00000010'                                 0814
         BNO   @RF00814                                            0814
@RT00814 DS    0H                                                  0815
*             IF      SDUMPSW ^= ON                                0815
*                &  ENTYPSAV = CATRCTYP($FRSP)                     0815
*                & (DUMPSW = OFF                                   0815
*                 ×  CMPRSW = ON)                                  0815
*               THEN ;             /* IGNORE FREESPACE RECORD        */
         TM    SDUMPSW,B'00000010'                                 0815
         BO    @RF00815                                            0815
         SLR   @15,@15                                             0815
         IC    @15,$FRSP                                           0815
         MH    @15,@CH00042                                        0815
         LA    @14,CATRCTYP-5(@15)                                 0815
         CLC   ENTYPSAV(1),0(@14)                                  0815
         BNE   @RF00815                                            0815
         TM    CMPRSW,B'01000000'                                  0815
         BNZ   @RT00815                                            0815
         TM    DUMPSW,B'00000100'                                  0815
         BNO   @RT00815                                            0815
*               ELSE                                               0817
*                 DO ;                                             0817
@RF00815 DS    0H                                                  0818
*                   IF  SDUMPSW ^= ON & BUFNO = NBRBUF             0818
*                                       /* IF RCD IN LAST BUF        */
*                     THEN CALL BUFSHUF;/* MOVE RCD TO 'HOME'        */
         TM    SDUMPSW,B'00000010'                                 0818
         BO    @RF00818                                            0818
         CLI   BUFNO,4                                             0818
         BNE   @RF00818                                            0818
         BAL   @14,BUFSHUF                                         0819
*                   TESTRC = 0 ;                                   0820
@RF00818 SLR   @15,@15                                             0820
         STH   @15,TESTRC                                          0820
*                   IF CMPRSW = ON      /* IF COMPARE GET THE        */
*                     THEN              /* CATALOG RECORD TOO        */
         TM    CMPRSW,B'01000000'                                  0821
         BNO   @RF00821                                            0821
*                       DO ;                                       0822
*                         IOBFSPTR = IOCTBPTR ;                    0823
         L     @02,IOCTBPTR                                        0823
         ST    @02,IOBFSPTR                                        0823
*                         IOCSPTR = IOCSCAT ;                      0824
         L     IOCSPTR,IOCSCAT                                     0824
*                         CATCI = CTTCATCI(CIFRGET-CTTBASE) ;      0825
         L     @15,CIFRGET-1                                       0825
         LA    @15,0(,@15)                                         0825
         SLA   @15,3                                               0825
         L     @01,CTTPTR                                          0825
         AL    @01,@CF01469                                        0825
         L     @15,CTTCATCI-5(@15,@01)                             0825
         LA    @15,0(,@15)                                         0825
         STCM  @15,7,CATCI                                         0825
*                         IOCRBA = CATCI * CATCISZ ;               0826
         SLA   @15,9                                               0826
         ST    @15,IOCRBA(,IOCSPTR)                                0826
*                         IF CATCI ^= IOBUFCI(BUFNO)               0827
*                           THEN        /* NOT ALREADY IN            */
         SLR   @15,@15                                             0827
         IC    @15,BUFNO                                           0827
         SLA   @15,9                                               0827
         ALR   @02,@15                                             0827
         AL    @02,@CF01466                                        0827
         CLC   CATCI(3),IOBUFCI-509(@02)                           0827
         BE    @RF00827                                            0827
*                             DO ;      /* BUFFER SO GET IT          */
*                                                                  0828
*                               CALL IDCIOGT0 (GDTTBL,IOCSCAT) ;   0829
*                                                                  0829
         L     @02,@PC00001                                        0829
         ST    @02,@AL00001                                        0829
         LA    @15,IOCSCAT                                         0829
         ST    @15,@AL00001+4                                      0829
         MVI   @AL00001+4,X'80'                                    0829
         L     @15,GDTGET(,@02)                                    0829
         LA    @01,@AL00001                                        0829
         BALR  @14,@15                                             0829
*                               RESPECIFY RTNREG RSTD;             0830
*                               TESTRC = RTNREG;                   0831
         STH   RTNREG,TESTRC                                       0831
*                               RESPECIFY RTNREG UNRSTD ;          0832
*                               IF TESTRC = 0                      0833
*                                 THEN  /* MOVE TO BUFFER            */
         LH    @02,TESTRC                                          0833
         LTR   @02,@02                                             0833
         BNZ   @RF00833                                            0833
*                                   DO ;                           0834
*                                     IOBUF(BUFNO,1:256) =         0835
*                                       IOBUFDMY(1:256) ;          0835
         L     @02,IOBFSPTR                                        0835
         SLR   @15,@15                                             0835
         IC    @15,BUFNO                                           0835
         SLA   @15,9                                               0835
         ST    @15,@TF00001                                        0835
         ALR   @15,@02                                             0835
         AL    @15,@CF01464                                        0835
         L     @14,IOCDAD(,IOCSPTR)                                0835
         MVC   IOBUF(256,@15),IOBUFDMY(@14)                        0835
*                                     IOBUF(BUFNO,257:508) =       0836
*                                       IOBUFDMY(257:508) ;        0836
         LR    @01,@02                                             0836
         AL    @01,@TF00001                                        0836
         AL    @01,@CF01465                                        0836
         MVC   IOBUF(252,@01),IOBUFDMY+256(@14)                    0836
*                                     IOBUFCI(BUFNO) = CATCI ;     0837
         AL    @02,@TF00001                                        0837
         AL    @02,@CF01466                                        0837
         MVC   IOBUFCI-509(3,@02),CATCI                            0837
*                                   END;     /* AND SET CI           */
*                                 ELSE                             0839
*                                   DO;  /* CAT GET FAILED           */
         B     @RC00833                                            0839
@RF00833 DS    0H                                                  0840
*                                     CALL ERROR (13,$RETURN) ;    0840
         LA    @01,@AL00840                                        0840
         BAL   @14,ERROR                                           0840
*                                     NOCATRSW = ON ;              0841
         OI    NOCATRSW,B'00000010'                                0841
*                                   END ;                          0842
*                             END ;                                0843
@RC00833 DS    0H                                                  0844
*                       END ;                                      0844
@RF00827 DS    0H                                                  0845
*                                  /**************************       */
*                   CALL PRTCMP ;  /* GO PRINT IT OR THEM            */
@RF00821 BAL   @14,PRTCMP                                          0845
*                                  /**************************       */
*                   NOCATRSW = OFF ;                               0846
         NI    NOCATRSW,B'11111101'                                0846
*                 END ;                                            0847
*           ELSE                                           /*@OZ09388*/
*             DO;                                          /*@OZ09388*/
         B     @RC00814                                            0848
@RF00814 DS    0H                                                  0849
*                PROCMSG='GETPRT  '; /* PROC NAME FOR INSERT @OZ09388*/
         MVC   PROCMSG(8),@CC01267                                 0849
*                CALL ERROR(14,$RETURN); /* FLD MGMT ERR RTN @OZ09388*/
         LA    @01,@AL00850                                        0850
         BAL   @14,ERROR                                           0850
*             END;                                         /*@OZ09388*/
*       END ;                                                      0852
*     ELSE CALL ERROR (15,$RETURN);/* CRA GET FAILED                 */
*                                                                  0853
         B     @RC00799                                            0853
@RF00799 LA    @01,@AL00853                                        0853
         BAL   @14,ERROR                                           0853
*END GETPRT ;                                                      0854
@EL00014 DS    0H                                                  0854
@EF00014 DS    0H                                                  0854
@ER00014 LM    @14,@12,@SA00014                                    0854
         BR    @14                                                 0854
* /*******************************************************************/
* /* PROCEDURE NAME - INITLZE, INITILIZE LISTCRA FSR                 */
* /* FUNCTION -                                                      */
* /*   INITIALIZE MISCELLANEOUS,                                     */
* /*   SWITCHES,                                                     */
* /*   SET UP I/O ADAPTER STUFF,                                     */
* /*   SET UP TEXT PROCESSOR STUFF (OS ONLY - INCLUDING OPEN         */
* /*   OF ALTERNATE OUTPUT FILE IF OUTFILE WAS SPECIFIED),           */
* /*   (OS ONLY - SET UP SYSTEM ADAPTER STUFF),                      */
* /*   SET UP FIELD MANAGEMENT STUFF,                                */
* /*   GET STORAGE FOR TABLES AND BUFFERS,                           */
* /*   INITIALIZE TABLE OF SUMS OF ENTRIES PROCESSED                 */
* /* INPUTS -                                                        */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   UGPOOL, SUMIT, ERROR                                          */
* /*******************************************************************/
*                                                                  0855
*INITLZE: PROCEDURE ;                                              0855
INITLZE  STM   @14,@02,@SA00015                                    0855
         STM   @05,@12,@SA00015+20                                 0855
* OLDERID2 = NEWERID2;                                             0856
         L     @04,@PC00001                                        0856
         L     @15,GDTTR2(,@04)                                    0856
         MVC   @TS00001(95),NEWERID2(@15)                          0856
         MVC   OLDERID2(95,@15),@TS00001                           0856
* NEWID2 = 'LRIN' ;                                                0857
         MVC   NEWID2(4,@15),@CC01271                              0857
* IF GDTDBG = NULLPTR                                              0858
*   THEN;                                                          0858
         L     @04,GDTDBG(,@04)                                    0858
         LTR   @04,@04                                             0858
         BZ    @RT00858                                            0858
*   ELSE                                                           0860
*     CALL IDCDB010 (GDTTBL,'LRIN') ;                              0860
*                                                                  0860
         L     @04,@PC00001                                        0860
         ST    @04,@AL00001                                        0860
         LA    @15,@CC01271                                        0860
         ST    @15,@AL00001+4                                      0860
         MVI   @AL00001+4,X'80'                                    0860
         L     @15,GDTDBG(,@04)                                    0860
         LA    @01,@AL00001                                        0860
         BALR  @14,@15                                             0860
* LRLASTCC = 0 ;                   /* INITIALIZE NEEDED VALUS        */
@RT00858 SLR   @04,@04                                             0861
         STH   @04,LRLASTCC                                        0861
* ERRCNTIO = 0 ;                                                   0862
*                                                                  0862
         MVI   ERRCNTIO,X'00'                                      0862
* CALL SUMIT (SMINIT) ;                                            0863
*                                                                  0863
         LA    @01,@AL00863                                        0863
         BAL   @14,SUMIT                                           0863
* ENQCON = '00' ;                  /* INIT DUE TO REENTRANT          */
         MVC   ENQCON(2),@CC01272                                  0864
* SWNAME = 'SWITCHES' ;            /* I.E. PLS DOES NOT              */
         MVC   SWNAME(8),@CC01273                                  0865
* TIMLENWA = 24 ;                  /* INITIAL STRUCTURES             */
         MVC   TIMLENWA(2),@CH00312                                0866
* TSTPTR = ADDR(TIMSTMPS) ;                                        0867
         LA    @04,TIMSTMPS                                        0867
         ST    @04,TSTPTR                                          0867
* IOCSALT = 0 ;                    /* SET IOCSALT PTR TO 0   @OZ26096*/
         SLR   @04,@04                                             0868
         ST    @04,IOCSALT                                         0868
* DO MOSLOT = 1 TO 12 ;                                            0869
         LA    MOSLOT,1                                            0869
@DL00869 DS    0H                                                  0870
*   TSTMDTBL(MOSLOT) = TSTMDINT(MOSLOT) ;                          0870
         SLR   @04,@04                                             0870
         IC    @04,TSTMDINT-1(MOSLOT)                              0870
         STC   @04,TSTMDTBL-1(MOSLOT)                              0870
* END ;                                                            0871
         AL    MOSLOT,@CF00222                                     0871
         C     MOSLOT,@CF00035                                     0871
         BNH   @DL00869                                            0871
* POOLNM = 'POOL' ;                                                0872
         MVC   POOLNM(4),@CC01274                                  0872
* IOBADNAM = 'BUFFADDR' ;                                          0873
         MVC   IOBADNAM(8),@CC01275                                0873
* CISNAME = 'CIS' ;                                                0874
         MVI   CISNAME+3,C' '                                      0874
         MVC   CISNAME(3),@CC01276                                 0874
*                                  /*************************        */
*                                  /* SET UP SWITCHES                */
*                                  /*************************        */
* SWITCHES = '0'B ;                /* TURN THEM ALL OFF FIRST        */
         XC    SWITCHES+1(3),SWITCHES+1                            0875
         MVI   SWITCHES,B'00000000'                                0875
* IF ADDR(DUMP) ^= '0'B                                            0876
*   THEN                                                           0876
         L     @04,@PC00001+4                                      0876
         L     @04,FDTPTR+12(,@04)                                 0876
         LTR   @04,@04                                             0876
         BZ    @RF00876                                            0876
*     DUMPSW = ON ;                                                0877
         OI    DUMPSW,B'00000100'                                  0877
* IF ADDR(SDUMP) ^= '0'B                                           0878
*   THEN                                                           0878
@RF00876 L     @04,@PC00001+4                                      0878
         L     @04,FDTPTR+40(,@04)                                 0878
         LTR   @04,@04                                             0878
         BZ    @RF00878                                            0878
*     SDUMPSW = ON ;                                               0879
         OI    SDUMPSW,B'00000010'                                 0879
*                                  /*************************        */
*                                  /* I/O ADAPTER STUFF              */
*                                  /*************************        */
* OPNPTR = ADDR(OPNAGLST) ;        /* OPEN ARGUMENT LIST             */
@RF00878 LA    OPNPTR,OPNAGLST                                     0880
* IOINBPTR = ADDR(IOINBYTE) ;      /* IOINFO OPTION BYTE             */
         LA    IOINBPTR,IOINBYTE                                   0881
* IOINBYTE = '0'B ;                                                0882
         MVI   IOINBYTE,B'00000000'                                0882
*  IOINBPTR -> IOINFTMS = ON ;                                     0883
         OI    IOINFTMS(IOINBPTR),B'00001000'                      0883
*                                  /*************************        */
*                                  /* TEXT PROCESSOR STUFF           */
*                                  /*************************        */
* IOCSPRT = '0'B ;                 /* TELL TO USE SYSTEM PRTN        */
         SLR   @04,@04                                             0884
         ST    @04,IOCSPRT                                         0884
* IF ADDR(OFILE) ^= '0'B                                           0885
*   THEN                                                           0885
         L     @02,@PC00001+4                                      0885
         L     @02,FDTPTR+36(,@02)                                 0885
         CR    @02,@04                                             0885
         BE    @RF00885                                            0885
*     DO ;                                                         0886
*       OPNAGL = '0'B ;            /* SET UP TO OPEN                 */
         XC    OPNAGL+1(47,OPNPTR),OPNAGL+1(OPNPTR)                0887
         MVI   OPNAGL(OPNPTR),B'00000000'                          0887
*        OPNOPTOT = ON ;        /* ALTERNATE PRINT FILE           */
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0888
*        OPNMODAC = ON ;                                           0889
         OI    OPNMODAC(OPNPTR),B'01000000'                        0889
*       OPNDDN = ADDR(OFILEVAL) ;                                  0890
         LA    @04,OFILEVAL(,@02)                                  0890
         ST    @04,OPNDDN(,OPNPTR)                                 0890
*       OPNIOC = ADDR(IOCSALT) ;                                   0891
         LA    @04,IOCSALT                                         0891
         ST    @04,OPNIOC(,OPNPTR)                                 0891
*       CALL IDCIOOP0 (GDTTBL,OPNAGL) ;                            0892
         L     @04,@PC00001                                        0892
         ST    @04,@AL00001                                        0892
         ST    OPNPTR,@AL00001+4                                   0892
         MVI   @AL00001+4,X'80'                                    0892
         L     @15,GDTOPN(,@04)                                    0892
         LA    @01,@AL00001                                        0892
         BALR  @14,@15                                             0892
*       RESPECIFY RTNREG RSTD;                                     0893
*       TESTRC = RTNREG;                                           0894
         STH   RTNREG,TESTRC                                       0894
*       RESPECIFY RTNREG UNRSTD ;                                  0895
*       IF TESTRC = 0                                              0896
*         THEN IOCSPRT = IOCSALT ;                                 0896
         LH    @04,TESTRC                                          0896
         LTR   @04,@04                                             0896
         BNZ   @RF00896                                            0896
         L     @04,IOCSALT                                         0897
         ST    @04,IOCSPRT                                         0897
*         ELSE                                             /*@OZ07569*/
*            DO;                                           /*@OZ07569*/
         B     @RC00896                                            0898
@RF00896 DS    0H                                                  0899
*              CALL CLEANUP;                               /*@OZ07569*/
         BAL   @14,CLEANUP                                         0899
*              CALL ERROR (31,$ABORT);                     /*@OZ07569*/
         LA    @01,@AL00900                                        0900
         BAL   @14,ERROR                                           0900
*            END;                                          /*@OZ07569*/
*     END ;                                                        0902
@RC00896 DS    0H                                                  0903
* DDSTRU = ADDR(DARGLST) ;         /* TEXT PROCESSOR BASE            */
@RF00885 LA    @04,DARGLST                                         0903
         ST    @04,DDSTRU                                          0903
* DDSTRUE = ADDR(DARGLSTE) ;       /* STRUCTURES, NRML, ERR          */
*                                                                  0904
         LA    @04,DARGLSTE                                        0904
         ST    @04,DDSTRUE                                         0904
* DO SUBSLOT = 1 TO LENGTH(SUBTITLE) ;                             0905
         LA    SUBSLOT,1                                           0905
@DL00905 DS    0H                                                  0906
*   SUBTITLE(SUBSLOT) = ' ' ;                                      0906
         LA    @04,SUBTITLE-1(SUBSLOT)                             0906
         MVI   0(@04),C' '                                         0906
* END ;                            /* SET UP SUBTITLE                */
         AL    SUBSLOT,@CF00222                                    0907
         CL    SUBSLOT,@CF01001                                    0907
         BNH   @DL00905                                            0907
* SUBTSPCT = '2' ;                                                 0908
         MVI   SUBTSPCT,C'2'                                       0908
* SUBT47 = 'LISTING OF CATALOG RECOVERY AREA FOR VOLUME --' ;      0909
         MVI   SUBT47+46,C' '                                      0909
         MVC   SUBT47(46),@CC01278                                 0909
* SUBT4 = ' -- ' ;                                                 0910
         MVC   SUBT4(4),@CC01282                                   0910
* PCARGLST = '0'B ;                /* INITIAL PAGE CONTROL           */
         XC    PCARGLST+1(33),PCARGLST+1                           0911
         MVI   PCARGLST,B'00000000'                                0911
* PCSTLC = 1 ;                                                     0912
         LA    @02,1                                               0912
         STH   @02,PCSTLC                                          0912
* PCSTLP = ADDR(SUBTITLE) ;                                        0913
         LA    @15,SUBTITLE                                        0913
         ST    @15,PCSTLP                                          0913
* PCRSTT = 'ST' ;                  /* MODIFY PAGE CONTROL            */
         MVC   PCRSTT(2),@CC01283                                  0914
* PCRSTLC = 1 ;                                                    0915
         STH   @02,PCRSTLC                                         0915
* PCRSTLP = ADDR(SUBTITLE) ;                                       0916
         ST    @15,PCRSTLP                                         0916
* RSVUTPTR = ADDR(RSVUTBL) ;                                       0917
         LA    @02,RSVUTBL                                         0917
         ST    @02,RSVUTPTR                                        0917
*                                  /*************************        */
*                                  /* SET UP FIELD MANAGEMENT        */
*                                  /*************************        */
* FMPLAD = ADDR(FMPLST) ;          /* ADDR FLD MGMT PARM LIST        */
         LA    @02,FMPLST                                          0918
         ST    @02,FMPLAD                                          0918
* FMPLFLNO = 1 ;                   /* SET UP FMPL TO ASSUMED         */
         MVI   FMPLFLNO(@02),X'01'                                 0919
* FMPLGRTN = ADDR(IDCLR02) ;       /* CONFIGURATION                  */
         L     @15,@CV00794                                        0920
         ST    @15,FMPLGRTN(,@02)                                  0920
* FMPLWKAR = ADDR(JUNK) ;          /* NOTE: CHANGED FIELDS           */
         LA    @15,JUNK                                            0921
         ST    @15,FMPLWKAR(,@02)                                  0921
* FMPLENTH = 256 ;                 /* MUST BE RESTORED               */
         MVC   FMPLENTH(2,@02),@CH00741                            0922
* FMPLOAR = ADDR(FMWA) ;                                           0923
         LA    @15,FMWA                                            0923
         ST    @15,FMPLOAR(,@02)                                   0923
* FMPLUPTR = ADDR(FMUDATA) ;                                       0924
*                                                                  0924
         LA    @15,FMUDATA                                         0924
         ST    @15,FMPLUPTR(,@02)                                  0924
* FMFLCUR = ADDR(FMFLST(NBRFMFL)); /* LAST FMFL SET TO BE            */
         LA    FMFLCUR,FMFLST+96                                   0925
* FMFL = '0'B ;                    /* USED AS TEST ON RELREPN        */
         XC    FMFL+1(15,FMFLCUR),FMFL+1(FMFLCUR)                  0926
         MVI   FMFL(FMFLCUR),B'00000000'                           0926
* FMFLDLNO = 1 ;                   /* TO GET ONLY 1 OCCURANCE        */
         MVI   FMFLDLNO(FMFLCUR),X'01'                             0927
* FMFLTSTC = '20'X ;               /* TEST IS GT                     */
         MVI   FMFLTSTC(FMFLCUR),X'20'                             0928
* FMFLDNAM = ADDR('RELREPNO') ;                                    0929
         LA    @15,@CC01285                                        0929
         ST    @15,FMFLDNAM(,FMFLCUR)                              0929
* FMFLENTH(1) = LENGTH(RELREPNO) ;                                 0930
         LA    @15,2                                               0930
         ST    @15,FMFLENTH(,FMFLCUR)                              0930
* FMFLADDR(1) = ADDR(RELREPNO) ;                                   0931
         LA    @14,RELREPNO                                        0931
         ST    @14,FMFLADDR(,FMFLCUR)                              0931
* FMPLFMFL(NBRFMFL) = FMFLCUR ;                                    0932
         ST    FMFLCUR,FMPLFMFL+16(,@02)                           0932
* FMFLTCHN = ADDR(FMFLST(NBRFMFL-1)) ;  /* HOOK THESE TWO UP         */
*                                                                  0933
         LA    @14,FMFLST+72                                       0933
         ST    @14,FMFLTCHN(,FMFLCUR)                              0933
* FMFLCUR =ADDR(FMFLST(NBRFMFL-1));/* LAST FMFL -1 SET TO BE         */
         LR    FMFLCUR,@14                                         0934
* FMFL = '0'B ;                    /* USED AS TEST ON CNTREPN        */
         XC    FMFL+1(15,FMFLCUR),FMFL+1(FMFLCUR)                  0935
         MVI   FMFL(FMFLCUR),B'00000000'                           0935
* FMFLDLNO = 1 ;                   /* RETRIEVE ONLY ONE OCCUR        */
         MVI   FMFLDLNO(FMFLCUR),X'01'                             0936
* FMFLTSTC = '80'X ;               /* TEST IS EQUAL                  */
         MVI   FMFLTSTC(FMFLCUR),X'80'                             0937
* FMFLDNAM = ADDR('CNTREPNO') ;                                    0938
         LA    @14,@CC01287                                        0938
         ST    @14,FMFLDNAM(,FMFLCUR)                              0938
* FMFLENTH(1) = LENGTH(CNTREPNO) ;                                 0939
         ST    @15,FMFLENTH(,FMFLCUR)                              0939
* FMFLADDR(1) = ADDR(CNTREPNO) ;                                   0940
         LA    @15,CNTREPNO                                        0940
         ST    @15,FMFLADDR(,FMFLCUR)                              0940
* FMPLFMFL(NBRFMFL-1) = FMFLCUR ;                                  0941
*                                                                  0941
         ST    FMFLCUR,FMPLFMFL+12(,@02)                           0941
* DO FMSLOT = NBRFMFL-2 TO 1 BY -1;/* POINT FMPL AT FIRST            */
         LA    FMSLOT,3                                            0942
@DL00942 DS    0H                                                  0943
*   FMFLCUR = ADDR(FMFLST(FMSLOT));/* THRU LAST-2 FMFLS AND          */
         LR    FMFLCUR,FMSLOT                                      0943
         MH    FMFLCUR,@CH00312                                    0943
         LA    FMFLCUR,FMFLST-24(FMFLCUR)                          0943
*   FMFL = '0'B ;                  /* INITIALIZE THE FMFLS           */
         XC    FMFL+1(15,FMFLCUR),FMFL+1(FMFLCUR)                  0944
         MVI   FMFL(FMFLCUR),B'00000000'                           0944
*   FMPLFMFL(FMSLOT) = FMFLCUR ;                                   0945
         LR    @15,FMSLOT                                          0945
         SLA   @15,2                                               0945
         L     @01,FMPLAD                                          0945
         ST    FMFLCUR,FMPLFMFL-4(@15,@01)                         0945
* END ;                            /* LEAVE POINTED PROPERLY         */
*                                                                  0946
         BCTR  FMSLOT,0                                            0946
         C     FMSLOT,@CF00222                                     0946
         BNL   @DL00942                                            0946
*                                  /* INITIALIZE THE                 */
* FMUIOCSP = IOCSPRT ;             /* USER DATA STUFF                */
         L     @02,IOCSPRT                                         0947
         ST    @02,FMUIOCSP                                        0947
* FMUDARGP = DDSTRUE ;             /* FOR FIELD MGMT I/O             */
         L     @02,DDSTRUE                                         0948
         ST    @02,FMUDARGP                                        0948
* FMUGDTP = ADDR(GDTTBL) ;         /* ROUTINE TO ASSUMED VALUES      */
         L     @02,@PC00001                                        0949
         ST    @02,FMUGDTP                                         0949
* FMUCTTP = '0'B ;                                                 0950
         SLR   @15,@15                                             0950
         ST    @15,FMUCTTP                                         0950
* FMUGETMN = ADDR(JUNK2) ;                                         0951
         LA    @15,JUNK2                                           0951
         ST    @15,FMUGETMN                                        0951
* FMUBUFNO = NBRBUF ;                                              0952
         MVI   FMUBUFNO,X'04'                                      0952
* FMUFLAGS = '0'B ;                                                0953
         MVI   FMUFLAGS,B'00000000'                                0953
* FMULR2CL = 0 ;                                                   0954
         SLR   @15,@15                                             0954
         STH   @15,FMULR2CL                                        0954
*                                  /* FMUBFPTR,FMUIOCSI SET LATER  0955
* */                                                               0955
* RELREPNO = 0 ;                                                   0955
         STH   @15,RELREPNO                                        0955
* CNTREPNO = 1 ;                                                   0956
         MVC   CNTREPNO(2),@CH00222                                0956
*                                                                  0957
*                                  /*************************        */
*                                  /* GET SPACE FOR TABLES:          */
*                                  /*************************        */
* CALL IDCSAGP0 (GDTTBL,GPLEN1ST,ATRA2PTR,MODID,SETZERO) ;/*       0957
*                                                      3 TBLS        */
         MVC   @AL00001+4(16),@AL00957                             0957
         ST    @02,@AL00001                                        0957
         LA    @15,ATRA2PTR                                        0957
         ST    @15,@AL00001+8                                      0957
         L     @15,GDTGPL(,@02)                                    0957
         LA    @01,@AL00001                                        0957
         BALR  @14,@15                                             0957
* RESPECIFY RTNREG RSTD;                                           0958
* TESTRC = RTNREG;                                                 0959
         STH   RTNREG,TESTRC                                       0959
* RESPECIFY RTNREG UNRSTD ;                                        0960
* IF TESTRC = 0                                                    0961
*   THEN                                                           0961
         LH    @02,TESTRC                                          0961
         LTR   @02,@02                                             0961
         BNZ   @RF00961                                            0961
*     DO ;                                                         0962
*       ATPTR = ATRA2PTR ;                   /*** ASSOCTBL **        */
         L     @02,ATRA2PTR                                        0963
         ST    @02,ATPTR                                           0963
*       ATNAME = 'ASOC' ;                                          0964
         MVC   ATNAME(4,@02),@CC01177                              0964
*       A2PTR = ATPTR + LENGTH(ASSOCTBL) ;   /*** ASSOCTB2 **        */
         LA    @15,44                                              0965
         ALR   @02,@15                                             0965
         ST    @02,A2PTR                                           0965
*       A2PTR -> A2NAME = 'ASO2' ;                                 0966
         MVC   A2NAME(4,@02),@CC01289                              0966
*       VEPTR = A2PTR + LENGTH(ASSOCTB2) ;   /*** VEXTTBL  **        */
         ALR   @02,@15                                             0967
         ST    @02,VEPTR                                           0967
*       VENAME = 'VEXT' ;                                          0968
         MVC   VENAME(4,@02),@CC00733                              0968
*       VEPTRBEG = VEPTR ;                                         0969
         ST    @02,VEPTRBEG                                        0969
*     END ;                                                        0970
* IF TESTRC = 0                                                    0971
*   THEN                                                           0971
@RF00961 LH    @02,TESTRC                                          0971
         LTR   @02,@02                                             0971
         BNZ   @RF00971                                            0971
*     DO ;                                   /*** BUFFERS  **        */
*       CALL IDCSAGP0 (GDTTBL,IOBFSLEN,IOBFSPTR,MODIDPG,SETZERO) ; 0973
         MVC   @AL00001+4(16),@AL00973                             0973
         L     @02,@PC00001                                        0973
         ST    @02,@AL00001                                        0973
         LA    @15,IOBFSPTR                                        0973
         ST    @15,@AL00001+8                                      0973
         L     @15,GDTGPL(,@02)                                    0973
         LA    @01,@AL00001                                        0973
         BALR  @14,@15                                             0973
*       RESPECIFY RTNREG RSTD;                                     0974
*       TESTRC = RTNREG;                                           0975
         STH   RTNREG,TESTRC                                       0975
*       RESPECIFY RTNREG UNRSTD ;                                  0976
*     END ;                                                        0977
* IF TESTRC = 0                                                    0978
*   THEN                           /* ABOVE STOS -> CRA BUFS         */
@RF00971 LH    @02,TESTRC                                          0978
         LTR   @02,@02                                             0978
         BNZ   @RF00978                                            0978
*     DO ;                         /* BELOW STOS -> CAT BUFS         */
*       IOCRBPTR = IOBFSPTR ;                                      0980
         L     @02,IOBFSPTR                                        0980
         ST    @02,IOCRBPTR                                        0980
*       FMUBFPTR = IOCRBPTR ;                                      0981
         ST    @02,FMUBFPTR                                        0981
*       IOCTBPTR = IOCRBPTR + NBRBUF * CATCISZ ;                   0982
         AL    @02,@CF01451                                        0982
         ST    @02,IOCTBPTR                                        0982
*     END ;                                                        0983
* IF TESTRC ^= 0                                                   0984
*   THEN CALL ERROR (NBRETE,$ABORT) ;   /* MEMORY TOO SMALL          */
*                                                                  0984
@RF00978 LH    @02,TESTRC                                          0984
         LTR   @02,@02                                             0984
         BZ    @RF00984                                            0984
         LA    @01,@AL00985                                        0985
         BAL   @14,ERROR                                           0985
*END INITLZE ;                                                     0986
@EL00015 DS    0H                                                  0986
@EF00015 DS    0H                                                  0986
@ER00015 LM    @14,@02,@SA00015                                    0986
         LM    @05,@12,@SA00015+20                                 0986
         BR    @14                                                 0986
*                                                                  0987
* /*******************************************************************/
* /* PROCEDURE NAME - INTASOC, INITIALIZ ASSOCTBL OR ASSOCTB2        */
* /* FUNCTION -                                                      */
* /*   CALL FIELD MANAGEMENT FOR NUMBER OF ASSOCIATIONS,             */
* /*   REPEAT TILL ALL ASSOCIATIONS HAVE BEEN OBTAINED,              */
* /*     CALL FIELD MGMT ASKING FOR TYPE AND NAME(CI,S)              */
* /*     OF AN ASSOCIATION,                                          */
* /*     MOVE INTO ASSOCTBL OR ASSOCTB2,                             */
* /*     IF ASSOCTB IS FULL BUILD ANOTHER AND CHAIN THEM             */
* /* INPUTS -                                                        */
* /*   STARTING SLT NUMBER FOR INSERT (SOME ALREADY IN)              */
* /*   ATORA2PTR HAS BEEN POINTED TO WHICH TABLE                     */
* /*   CIFRGET (IDENTIFIES RECORD ASSOCS ARE TO BE FROM)             */
* /* OUTPUTS -                                                       */
* /*   ASSOCTBL OR ASSOCTB2                                          */
* /* CALLS -                                                         */
* /*   UGPOOL, ERROR, TCICTCR,                                       */
* /*   IDCRC04(NAMEDS(TYPE & NAME(CATCI)), REPNO)                    */
* /*******************************************************************/
*                                                                  0987
*INTASOC: PROCEDURE (STRTSLOT) ;                                   0987
INTASOC  STM   @14,@12,@SA00016                                    0987
         MVC   @PC00016(4),0(@01)                                  0987
* OLDERID2 = NEWERID2;                                             0988
         L     @15,@PC00001                                        0988
         L     @14,GDTTR2(,@15)                                    0988
         MVC   @TS00001(95),NEWERID2(@14)                          0988
         MVC   OLDERID2(95,@14),@TS00001                           0988
* NEWID2 = 'LRIA' ;                                                0989
         MVC   NEWID2(4,@14),@CC01295                              0989
* IF GDTDBG = NULLPTR                                              0990
*   THEN;                                                          0990
         L     @15,GDTDBG(,@15)                                    0990
         LTR   @15,@15                                             0990
         BZ    @RT00990                                            0990
*   ELSE                                                           0992
*     CALL IDCDB010 (GDTTBL,'LRIA') ;                              0992
*                                                                  0992
         L     @15,@PC00001                                        0992
         ST    @15,@AL00001                                        0992
         LA    @14,@CC01295                                        0992
         ST    @14,@AL00001+4                                      0992
         MVI   @AL00001+4,X'80'                                    0992
         L     @15,GDTDBG(,@15)                                    0992
         LA    @01,@AL00001                                        0992
         BALR  @14,@15                                             0992
* DCL STRTSLOT FIXED(31) ;         /* STARTING SLOT FOR INSRT        */
*                                                                  0993
@RT00990 DS    0H                                                  0994
* ATPTRSAV = ATRA2PTR ;            /* SAVE ADDR OF 1ST TABLE         */
         L     @15,ATRA2PTR                                        0994
         ST    @15,ATPTRSAV                                        0994
* DO UNTIL  ATRA2PTR = 0;          /* LOOP THRU ALL TABLES   @OZ05941*/
@DL00995 DS    0H                                                  0996
*   DO ATSLOTB = 1 TO NBRATS ;     /* ZERO ALL SLOTS IN TABLE        */
         LA    ATSLOTB,1                                           0996
@DL00996 DS    0H                                                  0997
*     ATASOC(ATSLOTB) = '0'B ;                                     0997
         LR    @02,ATSLOTB                                         0997
         SLA   @02,2                                               0997
         L     @01,ATRA2PTR                                        0997
         ALR   @01,@02                                             0997
         XC    ATASOC-3(3,@01),ATASOC-3(@01)                       0997
         MVI   ATASOC-4(@01),B'00000000'                           0997
*   END ;                                                          0998
         AL    ATSLOTB,@CF00222                                    0998
         C     ATSLOTB,@CF00038                                    0998
         BNH   @DL00996                                            0998
*   ATRA2PTR=A2NXTTBL;             /* ADDRESS OF NEXT TABLE  @OZ05941*/
         L     @01,ATRA2PTR                                        0999
         L     @15,A2NXTTBL(,@01)                                  0999
         ST    @15,ATRA2PTR                                        0999
* END;                                                     /*@OZ05941*/
@DE00995 L     @15,ATRA2PTR                                        1000
         LTR   @15,@15                                             1000
         BNZ   @DL00995                                            1000
* ATRA2PTR=ATPTRSAV;              /* RESET TO ORIGINAL TABLE @OZ05941*/
         L     @02,ATPTRSAV                                        1001
         ST    @02,ATRA2PTR                                        1001
* ATSLOTB = STRTSLOT - 1 ;                                         1002
         L     @15,@PC00016                                        1002
         L     ATSLOTB,STRTSLOT(,@15)                              1002
         BCTR  ATSLOTB,0                                           1002
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ; /* SET CI 4 FLD MGMT        */
         L     @02,FMPLAD                                          1003
         L     @15,CIFRGET-1                                       1003
         LA    @15,0(,@15)                                         1003
         SLA   @15,3                                               1003
         L     @01,CTTPTR                                          1003
         ALR   @01,@15                                             1003
         AL    @01,@CF01478                                        1003
         MVC   FMPLBCIN(3,@02),CTTCATCI-5(@01)                     1003
* FMFLDNAM = ADDR('REPNO   ') ;                                    1004
         LA    @15,@CC01204                                        1004
         ST    @15,FMFLDNAM(,FMFLCUR)                              1004
* FMFLGRPC = CTASOCGC ;                                            1005
         MVI   FMFLGRPC(FMFLCUR),X'02'                             1005
* FMPLFMFL(NBRFMFL) -> FMFLGRPC = CTASOCGC ; /* RELREPNO AND         */
         L     @01,FMPLFMFL+16(,@02)                               1006
         MVI   FMFLGRPC(@01),X'02'                                 1006
* FMPLFMFL(NBRFMFL-1) -> FMFLGRPC = CTASOCGC ;   /* CNTREPNO         */
         L     @01,FMPLFMFL+12(,@02)                               1007
         MVI   FMFLGRPC(@01),X'02'                                 1007
* REG1 = FMPLAD ;                                                  1008
*                                                                  1008
         LR    REG1,@02                                            1008
* CALL IDCRC04 ;                   /* ASK NUMBER ASSOCIATIONS        */
*                                                                  1009
         L     @15,@CV00793                                        1009
         BALR  @14,@15                                             1009
* IF FMFLENTH ^= 0                                                 1010
*   THEN NBRASOCS = REPNO ;        /* SAVE NBR ASSOCIATIONS          */
         L     @02,FMFLENTH(,FMFLCUR)                              1010
         LTR   @02,@02                                             1010
         BZ    @RF01010                                            1010
         L     @02,FMFLADDR(,FMFLCUR)                              1011
         LH    @02,REPNO(,@02)                                     1011
         STH   @02,NBRASOCS                                        1011
*   ELSE                                                           1012
*     DO ;                         /* ERROR FROM FLD MGMT SO         */
         B     @RC01010                                            1012
@RF01010 DS    0H                                                  1013
*       NBRASOCS = 0 ;             /* SET TO NO ASSOCIATIONS         */
         SLR   @02,@02                                             1013
         STH   @02,NBRASOCS                                        1013
*       PROCMSG='INTASOC ';        /* PROC NAME FOR INSERT   @OZ09388*/
         MVC   PROCMSG(8),@CC01296                                 1014
*       CALL ERROR (28,$RETURN) ;                                  1015
         LA    @01,@AL01015                                        1015
         BAL   @14,ERROR                                           1015
*     END ;                                                        1016
* FMFLDNAM = ADDR('NAMEDS  ') ;                                    1017
@RC01010 LA    @02,@CC01298                                        1017
         ST    @02,FMFLDNAM(,FMFLCUR)                              1017
* FMFLTCHN = ADDR(FMFLST(NBRFMFL));/* GET FLDS ONE AT A TIME         */
*                                                                  1018
         LA    @02,FMFLST+96                                       1018
         ST    @02,FMFLTCHN(,FMFLCUR)                              1018
* /*******************************************************************/
* /* LOOP: GET ALL OF THE ASSOCIATIONS AND PUT IN TABLE              */
* /*******************************************************************/
*                                                                  1019
* DO WHILE (RELREPNO < NBRASOCS) ;                                 1019
         B     @DE01019                                            1019
@DL01019 DS    0H                                                  1020
*   REG1 = FMPLAD ;                                                1020
*                                                                  1020
         L     REG1,FMPLAD                                         1020
*   CALL IDCRC04 ;                 /* ASK TYPE AND ASOC CI           */
*                                                                  1021
         L     @15,@CV00793                                        1021
         BALR  @14,@15                                             1021
*   IF FMFLENTH ^= 0                                               1022
*     THEN                                                         1022
         SLR   @02,@02                                             1022
         C     @02,FMFLENTH(,FMFLCUR)                              1022
         BE    @RF01022                                            1022
*       DO ;                                                       1023
*         CIFRTRNS = NAMECI ;                                      1024
         L     @01,FMFLADDR(,FMFLCUR)                              1024
         MVC   CIFRTRNS(3),NAMECI(@01)                             1024
*         LRTEMPCC = 0 ;                                           1025
*                                                                  1025
         STH   @02,LRTEMPCC                                        1025
*         CALL TCICTCR (LRTEMPCC) ;     /* TRANSLATE FROM            */
         LA    @02,LRTEMPCC                                        1026
         ST    @02,@AL00001                                        1026
         LA    @01,@AL00001                                        1026
         BAL   @14,TCICTCR                                         1026
*                                       /* CRA TO CATALOG CI         */
*         IF LRTEMPCC = 0                                          1027
*           THEN                                                   1027
         LH    @02,LRTEMPCC                                        1027
         LTR   @02,@02                                             1027
         BNZ   @RF01027                                            1027
*             DO ;                                                 1028
*               ATSLOTB = ATSLOTB+ 1 ;  /* BUMP NEXT TBL SLOT        */
         LA    ATSLOTB,1(,ATSLOTB)                                 1029
*               IF ATSLOTB > NBRATS                                1030
*                 THEN                                             1030
         C     ATSLOTB,@CF00038                                    1030
         BNH   @RF01030                                            1030
*                   DO ;           /* NEED ANOTHER ASSOCTB           */
*                     IF ATNXTTBL = '0'B      /* ALREADY GOT         */
*                       THEN                  /* NO, THEN            */
         L     @01,ATRA2PTR                                        1032
         L     @15,ATNXTTBL(,@01)                                  1032
         LTR   @15,@15                                             1032
         BNZ   @RF01032                                            1032
*                         DO ;     /* GO GET SPACE FOR ANOTHR        */
*                                                                  1033
*                           CALL IDCSAGP0 (GDTTBL,ATLEN,ATPTRNXT,  1034
*                             MODID,SETZERO) ; /*ZERO CHN PTR        */
*                                                                  1034
         MVC   @AL00001+4(16),@AL01034                             1034
         L     @15,@PC00001                                        1034
         ST    @15,@AL00001                                        1034
         LA    @14,ATPTRNXT                                        1034
         ST    @14,@AL00001+8                                      1034
         L     @15,GDTGPL(,@15)                                    1034
         LA    @01,@AL00001                                        1034
         BALR  @14,@15                                             1034
*                           RESPECIFY RTNREG RSTD;                 1035
*                           TESTRC = RTNREG;                       1036
         STH   RTNREG,TESTRC                                       1036
*                           RESPECIFY RTNREG UNRSTD ;              1037
*                           IF TESTRC = 0                          1038
*                             THEN                                 1038
         LH    @15,TESTRC                                          1038
         LTR   @15,@15                                             1038
         BNZ   @RF01038                                            1038
*                               DO ;                               1039
*                                 ATPTRNXT -> ATNAME = 'ASOC' ;    1040
         L     @15,ATPTRNXT                                        1040
         MVC   ATNAME(4,@15),@CC01177                              1040
*                                 ATNXTTBL = ATPTRNXT ;            1041
         L     @14,ATRA2PTR                                        1041
         ST    @15,ATNXTTBL(,@14)                                  1041
*                               END ;                              1042
*                             ELSE                                 1043
*                               CALL ERROR (NBRETE,$ABORT) ;       1043
         B     @RC01038                                            1043
@RF01038 LA    @01,@AL01043                                        1043
         BAL   @14,ERROR                                           1043
*                                       /* NOT ENOUGH MEMORY         */
*                         END ;                                    1044
@RC01038 DS    0H                                                  1045
*                     ATRA2PTR = ATNXTTBL ; /* BUMP NXT TABLE        */
@RF01032 L     @01,ATRA2PTR                                        1045
         L     @15,ATNXTTBL(,@01)                                  1045
         ST    @15,ATRA2PTR                                        1045
*                     DO ATSLOTB = 1 TO NBRATS ;                   1046
         LA    ATSLOTB,1                                           1046
@DL01046 DS    0H                                                  1047
*                       ATASOC(ATSLOTB) = '0'B ;                   1047
         LR    @02,ATSLOTB                                         1047
         SLA   @02,2                                               1047
         L     @01,ATRA2PTR                                        1047
         ALR   @01,@02                                             1047
         XC    ATASOC-3(3,@01),ATASOC-3(@01)                       1047
         MVI   ATASOC-4(@01),B'00000000'                           1047
*                     END ;                                        1048
         AL    ATSLOTB,@CF00222                                    1048
         C     ATSLOTB,@CF00038                                    1048
         BNH   @DL01046                                            1048
*                     ATSLOTB = 1 ;     /* 1ST SLOT THEREIN          */
         LA    ATSLOTB,1                                           1049
*                   END ;                                          1050
*               ATCRACI(ATSLOTB) = CIFRTRNS ;                      1051
@RF01030 L     @02,ATRA2PTR                                        1051
         LR    @15,ATSLOTB                                         1051
         SLA   @15,2                                               1051
         ST    @15,@TF00001                                        1051
         ALR   @15,@02                                             1051
         MVC   ATCRACI-4(3,@15),CIFRTRNS                           1051
*               ATENTYP(ATSLOTB) = TYPE ;                          1052
         AL    @02,@TF00001                                        1052
         L     @01,FMFLADDR(,FMFLCUR)                              1052
         MVC   ATENTYP-4(1,@02),TYPE(@01)                          1052
*             END ;                                                1053
*           ELSE ;                 /* ERROR PRNTED IN TCICTCR        */
@RF01027 DS    0H                                                  1055
*       END ;                                                      1055
*     ELSE                                                         1056
*       DO ;                                                       1056
         B     @RC01022                                            1056
@RF01022 DS    0H                                                  1057
*         PROCMSG='INTAOSC ';        /* PROC NAME FOR INSERT @OZ09388*/
         MVC   PROCMSG(8),@CC01300                                 1057
*         CALL ERROR (16,$RETURN) ;  /* FIELD MGMT ERR RETURN        */
         LA    @01,@AL01058                                        1058
         BAL   @14,ERROR                                           1058
*         RELREPNO = NBRASOCS ;      /* GET OUT OF LOOP              */
         LH    @02,NBRASOCS                                        1059
         STH   @02,RELREPNO                                        1059
*       END ;                                                      1060
*   RELREPNO = RELREPNO + 1 ;                                      1061
@RC01022 LA    @02,1                                               1061
         LH    @15,RELREPNO                                        1061
         ALR   @15,@02                                             1061
         STH   @15,RELREPNO                                        1061
*   CNTREPNO = CNTREPNO + 1 ;                                      1062
         AH    @02,CNTREPNO                                        1062
         STH   @02,CNTREPNO                                        1062
* END ;                                                            1063
@DE01019 LH    @02,RELREPNO                                        1063
         CH    @02,NBRASOCS                                        1063
         BL    @DL01019                                            1063
* RELREPNO = 0 ;                   /* RESTORE ASSUMED VALUES         */
         SLR   @15,@15                                             1064
         STH   @15,RELREPNO                                        1064
* CNTREPNO = 1 ;                                                   1065
         MVC   CNTREPNO(2),@CH00222                                1065
* FMFLTCHN = '0'B ;                                                1066
         SLR   @15,@15                                             1066
         ST    @15,FMFLTCHN(,FMFLCUR)                              1066
* FMFLGRPC = '0'B ;                                                1067
         MVI   FMFLGRPC(FMFLCUR),B'00000000'                       1067
* ATRA2PTR = ATPTRSAV ;                                            1068
*                                                                  1068
         L     @15,ATPTRSAV                                        1068
         ST    @15,ATRA2PTR                                        1068
*END INTASOC ;                                                     1069
@EL00016 DS    0H                                                  1069
@EF00016 DS    0H                                                  1069
@ER00016 LM    @14,@12,@SA00016                                    1069
         BR    @14                                                 1069
* /*******************************************************************/
* /* PROCEDURE NAME - INTSORT, INITIALIZE TABLE FOR SORTING          */
* /* FUNCTION -                                                      */
* /*   SCAN CTT TABLE COUNTING NUMBER OF ENTRIES OF THE TYPE         */
* /*   REQUESTED AND GET STORAGE FOR A SORTTBL,                      */
* /*   INITIALIZE THE FIRST TWO ENTRIES (LOWEST/HIGHEST),            */
* /*   PASS THRU THE CTT TABLE AGAIN BUILDING THE SORTTBL            */
* /* INPUTS -                                                        */
* /*   VARIABLE LENGTH LIST OF ENTRY TYPES TO BE IN SORTTBL          */
* /*   CTT                                                           */
* /* OUTPUTS -                                                       */
* /*   SORTTBL WITH STCRACI AND STENTNM FIELDS FILLED IN             */
* /*   SORTOKSW                                                      */
* /*   STSLTCNT = 0 IF NO ENTRIES FOUND AND NO TABLE BUILT           */
* /* CALLS -                                                         */
* /*   UGPOOL, ERROR,                                                */
* /*   IDCRC04(ENTNAME)                                              */
* /*******************************************************************/
*                                                                  1070
*INTSORT: PROCEDURE (NBRCHAR,SRCHCHAR) ;                           1070
INTSORT  STM   @14,@12,@SA00017                                    1070
         MVC   @PC00017(8),0(@01)                                  1070
* OLDERID2 = NEWERID2;                                             1071
         L     @15,@PC00001                                        1071
         L     @14,GDTTR2(,@15)                                    1071
         MVC   @TS00001(95),NEWERID2(@14)                          1071
         MVC   OLDERID2(95,@14),@TS00001                           1071
* NEWID2 = 'LRIS' ;                                                1072
         MVC   NEWID2(4,@14),@CC01308                              1072
* IF GDTDBG = NULLPTR                                              1073
*   THEN;                                                          1073
         L     @15,GDTDBG(,@15)                                    1073
         LTR   @15,@15                                             1073
         BZ    @RT01073                                            1073
*   ELSE                                                           1075
*     CALL IDCDB010 (GDTTBL,'LRIS') ;                              1075
*                                                                  1075
         L     @15,@PC00001                                        1075
         ST    @15,@AL00001                                        1075
         LA    @14,@CC01308                                        1075
         ST    @14,@AL00001+4                                      1075
         MVI   @AL00001+4,X'80'                                    1075
         L     @15,GDTDBG(,@15)                                    1075
         LA    @01,@AL00001                                        1075
         BALR  @14,@15                                             1075
* DCL                                                              1076
*   NBRCHAR         FIXED(31),     /* NUMBER OF SEARCH CHARS         */
*   SRCHCHAR  (4)   CHAR(1),       /* SEARCH CHARACTER ARRAY         */
* ENDCLSIS CHAR(1) ;                                               1076
*                                                                  1076
@RT01073 DS    0H                                                  1077
* SORTOKSW = ON ;                                                  1077
         OI    SORTOKSW,B'00000001'                                1077
* STSLTCNT = 0 ;                                                   1078
*                                                                  1078
         SLR   @15,@15                                             1078
         STH   @15,STSLTCNT                                        1078
* /*******************************************************************/
* /* LOOP: SCAN CTT COUNTING NUMBER OF ENTRIES FOR SORTTBL           */
* /*******************************************************************/
*                                                                  1079
* DO CTTSLOT = 1 TO CTTENTNO ;                                     1079
         LA    @15,1                                               1079
         B     @DE01079                                            1079
@DL01079 DS    0H                                                  1080
*   DO CHARINDX = 1 TO NBRCHAR ;                                   1080
         LA    @15,1                                               1080
         B     @DE01080                                            1080
@DL01080 DS    0H                                                  1081
*     IF CTTENTYP(CTTSLOT) = SRCHCHAR(CHARINDX)                    1081
*       THEN                                                       1081
         LH    @14,CTTSLOT                                         1081
         N     @14,@CF01475                                        1081
         SLA   @14,3                                               1081
         L     @03,@PC00017+4                                      1081
         L     @01,CTTPTR                                          1081
         ALR   @01,@14                                             1081
         AL    @01,@CF01476                                        1081
         ALR   @03,@15                                             1081
         BCTR  @03,0                                               1081
         CLC   CTTENTYP-4(1,@01),SRCHCHAR(@03)                     1081
         BNE   @RF01081                                            1081
*         STSLTCNT = STSLTCNT + 1 ;                                1082
         LH    @01,STSLTCNT                                        1082
         LA    @01,1(,@01)                                         1082
         STH   @01,STSLTCNT                                        1082
*   END ;                                                          1083
@RF01081 SLR   @15,@15                                             1083
         IC    @15,CHARINDX                                        1083
         AL    @15,@CF00222                                        1083
@DE01080 STC   @15,CHARINDX                                        1083
         L     @14,@PC00017                                        1083
         C     @15,NBRCHAR(,@14)                                   1083
         BNH   @DL01080                                            1083
* END ;                                                            1084
         LH    @15,CTTSLOT                                         1084
         N     @15,@CF01475                                        1084
         AL    @15,@CF00222                                        1084
@DE01079 STH   @15,CTTSLOT                                         1084
         L     @14,CTTPTR                                          1084
         C     @15,CTTENTNO(,@14)                                  1084
         BNH   @DL01079                                            1084
* IF STSLTCNT ^= 0                                                 1085
*   THEN                                                           1085
         LH    @15,STSLTCNT                                        1085
         N     @15,@CF01475                                        1085
         LTR   @15,@15                                             1085
         BZ    @RF01085                                            1085
*     DO ;                         /* GET STORAGE FOR SORTTBL        */
*       STSLTCNT = STSLTCNT + 2 ;  /* ADD LOW & HIGH DUMMIES         */
         LA    @15,2(,@15)                                         1087
         STH   @15,STSLTCNT                                        1087
*       STLEN = STSLTCNT * LENGTH(SORTTBL) ;                       1088
*                                                                  1088
         MH    @15,@CH01068                                        1088
         ST    @15,STLEN                                           1088
*       CALL IDCSAGP0 (GDTTBL,STLEN,STPTR,MODIDST,SETZERO) ;       1089
*                                                                  1089
         L     @15,@PC00001                                        1089
         ST    @15,@AL00001                                        1089
         LA    @14,STLEN                                           1089
         ST    @14,@AL00001+4                                      1089
         LA    @14,STPTR                                           1089
         ST    @14,@AL00001+8                                      1089
         LA    @14,MODIDST                                         1089
         ST    @14,@AL00001+12                                     1089
         LA    @14,SETZERO                                         1089
         ST    @14,@AL00001+16                                     1089
         MVI   @AL00001+16,X'80'                                   1089
         L     @15,GDTGPL(,@15)                                    1089
         LA    @01,@AL00001                                        1089
         BALR  @14,@15                                             1089
*       RESPECIFY RTNREG RSTD;                                     1090
*       TESTRC = RTNREG;                                           1091
         STH   RTNREG,TESTRC                                       1091
*       RESPECIFY RTNREG UNRSTD ;                                  1092
*       IF TESTRC = 0                                              1093
*         THEN                                                     1093
         LH    @15,TESTRC                                          1093
         SLR   @14,@14                                             1093
         CR    @15,@14                                             1093
         BNE   @RF01093                                            1093
*           DO ;                                                   1094
*             STENTYP(1) = 'FF'X ; /* INITIALIZE FIRST TWO           */
         L     @02,STPTR                                           1095
         MVI   STENTYP(@02),X'FF'                                  1095
*             STCRACI(1) = '0'B ;  /* ENTRIES OF SORTTBL             */
         SLR   @15,@15                                             1096
         STCM  @15,7,STCRACI(@02)                                  1096
*             STFLAGS(1) = '0'B ;                                  1097
         MVI   STFLAGS(@02),B'00000000'                            1097
*             STFRWD(1)  = 2 ;                                     1098
         LA    @15,2                                               1098
         STH   @15,STFRWD(,@02)                                    1098
*             STBKWD(1)  = 0 ;                                     1099
         STH   @14,STBKWD(,@02)                                    1099
*             STENTNM(1) = '0'B ;  /* FIRST IS DUMMY LOWEST          */
         XC    STENTNM+1(43,@02),STENTNM+1(@02)                    1100
         MVI   STENTNM(@02),B'00000000'                            1100
*             STENTYP(2) = 'FF'X ;                                 1101
         MVI   STENTYP+56(@02),X'FF'                               1101
*             STCRACI(2) = STENDCI ;                               1102
         MVC   STCRACI+56(3,@02),STENDCI                           1102
*             STFLAGS(2) = '0'B ;                                  1103
         MVI   STFLAGS+56(@02),B'00000000'                         1103
*             STFRWD(2)  = 0 ;                                     1104
         STH   @14,STFRWD+56(,@02)                                 1104
*             STBKWD(2)  = 1 ;     /* SECOND IS DUMMY HIGHEST        */
         LA    @14,1                                               1105
         STH   @14,STBKWD+56(,@02)                                 1105
*             STENTNM(2) = 'FFFFFFFFFFFFFFFFFFFF'X ;               1106
         XC    STENTNM+66(34,@02),STENTNM+66(@02)                  1106
         MVC   STENTNM+56(10,@02),@CB01310                         1106
*             STSLOT = 2 ;                                         1107
         LR    STSLOT,@15                                          1107
*             FMU1STIO = ON ;                                      1108
         OI    FMU1STIO,B'10000000'                                1108
*             FMFLDNAM = ADDR('ENTNAME ') ;                        1109
         LA    @02,@CC01195                                        1109
         ST    @02,FMFLDNAM(,FMFLCUR)                              1109
*             /*******************************************************/
*             /* LOOP: SCAN CTT BUILDING SORTTBL WITH NAMES          */
*             /*******************************************************/
*             DO CTTSLOT = 1 TO CTTENTNO ;                         1110
         B     @DE01110                                            1110
@DL01110 DS    0H                                                  1111
*               DO CHARINDX = 1 TO NBRCHAR ;                       1111
         LA    @02,1                                               1111
         B     @DE01111                                            1111
@DL01111 DS    0H                                                  1112
*                 IF CTTENTYP(CTTSLOT) = SRCHCHAR(CHARINDX)        1112
*                   THEN                                           1112
         L     @15,CTTPTR                                          1112
         LH    @14,CTTSLOT                                         1112
         N     @14,@CF01475                                        1112
         SLA   @14,3                                               1112
         L     @01,@PC00017+4                                      1112
         ST    @14,@TF00001                                        1112
         ALR   @14,@15                                             1112
         AL    @14,@CF01476                                        1112
         ALR   @01,@02                                             1112
         BCTR  @01,0                                               1112
         CLC   CTTENTYP-4(1,@14),SRCHCHAR(@01)                     1112
         BNE   @RF01112                                            1112
*                     DO ;                                         1113
*                       STSLOT = STSLOT + 1 ;                      1114
         LA    STSLOT,1(,STSLOT)                                   1114
*                       STFLAGS(STSLOT) = '0'B ;                   1115
         L     @02,STPTR                                           1115
         LR    @14,STSLOT                                          1115
         MH    @14,@CH01068                                        1115
         ST    @14,@TF00002                                        1115
         ALR   @14,@02                                             1115
         AL    @14,@CF01482                                        1115
         MVI   STFLAGS-48(@14),B'00000000'                         1115
*                       STFRWD(STSLOT) = 0 ;                       1116
         SLR   @14,@14                                             1116
         L     @01,@TF00002                                        1116
         AL    @01,@CF01476                                        1116
         STH   @14,STFRWD-52(@01,@02)                              1116
*                       STBKWD(STSLOT) = 0 ;                       1117
         L     @01,@TF00002                                        1117
         BCTR  @02,0                                               1117
         BCTR  @02,0                                               1117
         STH   @14,STBKWD-54(@01,@02)                              1117
*                       FMPLBCIN = CTTCATCI(CTTSLOT) ;             1118
         L     @02,FMPLAD                                          1118
         AL    @15,@TF00001                                        1118
         AL    @15,@CF01466                                        1118
         MVC   FMPLBCIN(3,@02),CTTCATCI-5(@15)                     1118
*                       REG1 = FMPLAD ;                            1119
*                                                                  1119
         LR    REG1,@02                                            1119
*                       CALL IDCRC04 ;      /* GET ENTRYNAME         */
*                                                                  1120
         L     @15,@CV00793                                        1120
         BALR  @14,@15                                             1120
*                       IF FMFLENTH ^= 0                           1121
*                         THEN                                     1121
         L     @02,FMFLENTH(,FMFLCUR)                              1121
         LTR   @02,@02                                             1121
         BZ    @RF01121                                            1121
*                           DO ;                                   1122
*                             STENTNM(STSLOT) = ENTNAME ;          1123
         L     @02,STPTR                                           1123
         LR    @15,STSLOT                                          1123
         MH    @15,@CH01068                                        1123
         ST    @15,@TF00001                                        1123
         ALR   @15,@02                                             1123
         AL    @15,@CF01483                                        1123
         L     @01,FMFLADDR(,FMFLCUR)                              1123
         MVC   STENTNM(44,@15),ENTNAME(@01)                        1123
*                             STENTYP(STSLOT) =                    1124
*                               CTTENTYP(CTTSLOT) ;                1124
         LR    @01,@02                                             1124
         AL    @01,@TF00001                                        1124
         AL    @01,@CF01484                                        1124
         LH    @15,CTTSLOT                                         1124
         N     @15,@CF01475                                        1124
         LR    @14,@15                                             1124
         SLA   @14,3                                               1124
         L     @02,CTTPTR                                          1124
         ALR   @02,@14                                             1124
         AL    @02,@CF01476                                        1124
         MVC   STENTYP-44(1,@01),CTTENTYP-4(@02)                   1124
*                             STCRACI(STSLOT) = CTTSLOT + 8 ;      1125
         L     @02,STPTR                                           1125
         AL    @15,@CF00039                                        1125
         AL    @02,@TF00001                                        1125
         AL    @02,@CF01477                                        1125
         STCM  @15,7,STCRACI-45(@02)                               1125
*                             CHARINDX = NBRCHAR + 1 ;             1126
         L     @02,@PC00017                                        1126
         L     @02,NBRCHAR(,@02)                                   1126
         LA    @02,1(,@02)                                         1126
         STC   @02,CHARINDX                                        1126
*                           END ;                                  1127
*                         ELSE                                     1128
*                           DO ;                                   1128
         B     @RC01121                                            1128
@RF01121 DS    0H                                                  1129
*                             PROCMSG='INTSORT '; /* PROC    @OZ09388*/
         MVC   PROCMSG(8),@CC01312                                 1129
*                                       /* NAME FOR INSERT   @OZ09388*/
*                             CALL ERROR (17,$RETURN) ;            1130
         LA    @01,@AL01130                                        1130
         BAL   @14,ERROR                                           1130
*                             STSLTCNT = STSLTCNT - 1 ;            1131
         LH    @02,STSLTCNT                                        1131
         N     @02,@CF01475                                        1131
         BCTR  @02,0                                               1131
         STH   @02,STSLTCNT                                        1131
*                           END ;                                  1132
*                     END ;                                        1133
@RC01121 DS    0H                                                  1134
*               END ;                                              1134
@RF01112 LA    @02,1                                               1134
         SLR   @15,@15                                             1134
         IC    @15,CHARINDX                                        1134
         ALR   @02,@15                                             1134
@DE01111 STC   @02,CHARINDX                                        1134
         L     @15,@PC00017                                        1134
         C     @02,NBRCHAR(,@15)                                   1134
         BNH   @DL01111                                            1134
*             END ;                /* END BUILD SORTTBL LOOP         */
         LA    @14,1                                               1135
         LH    @02,CTTSLOT                                         1135
         N     @02,@CF01475                                        1135
         ALR   @14,@02                                             1135
@DE01110 STH   @14,CTTSLOT                                         1135
         L     @02,CTTPTR                                          1135
         C     @14,CTTENTNO(,@02)                                  1135
         BNH   @DL01110                                            1135
*           END ;                                                  1136
*         ELSE                                                     1137
*           DO ;                                                   1137
         B     @RC01093                                            1137
@RF01093 DS    0H                                                  1138
*             CALL ERROR (18,$RETURN) ; /* NO ROOM FOR TABLE         */
         LA    @01,@AL01138                                        1138
         BAL   @14,ERROR                                           1138
*             SORTOKSW = OFF ;                                     1139
         NI    SORTOKSW,B'11111110'                                1139
*           END ;                                                  1140
*     END ;                                                        1141
*                                                                  1141
* END INTSORT ;                                                    1142
@EL00017 DS    0H                                                  1142
@EF00017 DS    0H                                                  1142
@ER00017 LM    @14,@12,@SA00017                                    1142
         BR    @14                                                 1142
* /*******************************************************************/
* /* PROCEDURE NAME - INTVEXT, INITIALIZE VEXTTBL                    */
* /* FUNCTION -                                                      */
* /*   IF HRONLYSW IS ON THEN ONLY RETURN THE HORIZ EXTN CI,         */
* /*   CALL FIELD MGMT ASKING FOR $EXTPTRS (EXTENSION CI             */
* /*   POINTERS, THE HORIZONTAL ONE BEING THE FIRST),                */
* /*   NOTE: RETURN CANNOT EXCEED SIZE OF WORK AREA GIVEN,           */
* /*         508-93 = 415/5 = 83*3 = 249+2 = 251 LT 256              */
* /*   LOOP THRU ALL DATA RETURNED,                                  */
* /*     CALL TCICTCR TO TRANSLATE FROM CATALOG CI TO CRA CI,        */
* /*     SET UP CIHOREXT,                                            */
* /*     CALL BLDVEXT TO ELIMINATE DUPLICATES AND                    */
* /*     MOVE EXTENSION CI,S INTO THE VEXTTBL, AND                   */
* /*     IF VEXTTBL IS FULL BUILD ANOTHER AND CHAIN THEM             */
* /* INPUTS -                                                        */
* /*   HRONLYSW INDICATES ONLY THE HORIZ EXT CI IS WANTED AND        */
* /*   DO NOT TOUCH THE CURRENT VEXTTBL PLEASE,                      */
* /*   CIFRGET (IDENTIFIES RECORD EXTN CI,S ARE TO BE FROM)          */
* /* OUTPUTS -                                                       */
* /*   CIHOREXT                                                      */
* /*   VEXTTBL                                                       */
* /* CALLS -                                                         */
* /*   BLDVEXT, TCICTCR, ERROR,                                      */
* /*   IDCRC04($EXTPTRS(CATCIS))                                     */
* /*******************************************************************/
*                                                                  1143
*INTVEXT: PROCEDURE ;                                              1143
INTVEXT  STM   @14,@12,@SA00018                                    1143
* OLDERID2 = NEWERID2;                                             1144
         L     @15,@PC00001                                        1144
         L     @14,GDTTR2(,@15)                                    1144
         MVC   @TS00001(95),NEWERID2(@14)                          1144
         MVC   OLDERID2(95,@14),@TS00001                           1144
* NEWID2 = 'LRIV' ;                                                1145
         MVC   NEWID2(4,@14),@CC01317                              1145
* IF GDTDBG = NULLPTR                                              1146
*   THEN;                                                          1146
         L     @15,GDTDBG(,@15)                                    1146
         LTR   @15,@15                                             1146
         BZ    @RT01146                                            1146
*   ELSE                                                           1148
*     CALL IDCDB010 (GDTTBL,'LRIV') ;                              1148
*                                                                  1148
         L     @15,@PC00001                                        1148
         ST    @15,@AL00001                                        1148
         LA    @14,@CC01317                                        1148
         ST    @14,@AL00001+4                                      1148
         MVI   @AL00001+4,X'80'                                    1148
         L     @15,GDTDBG(,@15)                                    1148
         LA    @01,@AL00001                                        1148
         BALR  @14,@15                                             1148
* IF HRONLYSW ^= ON                                                1149
*   THEN                           /* ZERO OUT VEXTTBL               */
@RT01146 TM    HRONLYSW,B'10000000'                                1149
         BO    @RF01149                                            1149
*     DO VESLOTB = 1 TO NBRVES ;                                   1150
         LA    VESLOTB,1                                           1150
@DL01150 DS    0H                                                  1151
*       VEEXT(VESLOTB) = '0'B ;                                    1151
         LR    @03,VESLOTB                                         1151
         SLA   @03,2                                               1151
         L     @01,VEPTR                                           1151
         ALR   @01,@03                                             1151
         XC    VEEXT-3(3,@01),VEEXT-3(@01)                         1151
         MVI   VEEXT-4(@01),B'00000000'                            1151
*     END ;                                                        1152
         AL    VESLOTB,@CF00222                                    1152
         C     VESLOTB,@CF00038                                    1152
         BNH   @DL01150                                            1152
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ; /* CI FOR FLD MGMT          */
@RF01149 L     @15,FMPLAD                                          1153
         L     @14,CIFRGET-1                                       1153
         LA    @14,0(,@14)                                         1153
         SLA   @14,3                                               1153
         L     @01,CTTPTR                                          1153
         ALR   @01,@14                                             1153
         AL    @01,@CF01478                                        1153
         MVC   FMPLBCIN(3,@15),CTTCATCI-5(@01)                     1153
* FMFLDNAM = ADDR('$EXTPTRS') ;                                    1154
         LA    @14,@CC01318                                        1154
         ST    @14,FMFLDNAM(,FMFLCUR)                              1154
* FRSTVESW = ON ;                                                  1155
         OI    FRSTVESW,B'00000001'                                1155
* CIHOREXT = 0 ;                                                   1156
         SLR   @14,@14                                             1156
         STCM  @14,7,CIHOREXT                                      1156
* REG1 = FMPLAD ;                                                  1157
*                                                                  1157
         LR    REG1,@15                                            1157
* CALL IDCRC04 ;                   /* ASK FOR EXTENSION CI,S         */
*                                                                  1158
         L     @15,@CV00793                                        1158
         BALR  @14,@15                                             1158
* IF FMPLRTCD = 0                                                  1159
*   THEN                                                           1159
         L     @01,FMPLAD                                          1159
         CLI   FMPLRTCD(@01),0                                     1159
         BNE   @RF01159                                            1159
*     DO ;                                                         1160
*       NBRFLDS = FMFLENTH(1) / LENGTH($EXTPTRS) ;                 1161
         L     @00,FMFLENTH(,FMFLCUR)                              1161
         SRDA  @00,32                                              1161
         D     @00,@CF00166                                        1161
         LR    NBRFLDS,@01                                         1161
*       VESLOTB = 0 ;                                              1162
*                                                                  1162
         SLR   VESLOTB,VESLOTB                                     1162
*       /*************************************************************/
*       /* LOOP: LOOK AT ALL ASSOCIATIONS RETURNED AND IF            */
*       /*       IF THEY ARE NOT DUPLICATES ADD TO TABLE             */
*       /*************************************************************/
*                                                                  1163
*       DO VEFIELD = 1 TO NBRFLDS WHILE (NBRFLDS ^= 0) ;           1163
         LA    @15,1                                               1163
         B     @DE01163                                            1163
@DL01163 SLR   @15,@15                                             1163
         CLR   NBRFLDS,@15                                         1163
         BE    @DC01163                                            1163
*         CIFRTRNS = $EXTPTRS ;                                    1164
         L     @01,FMFLADDR(,FMFLCUR)                              1164
         MVC   CIFRTRNS(3),$EXTPTRS(@01)                           1164
*         LRTEMPCC = 0 ;                                           1165
*                                                                  1165
         STH   @15,LRTEMPCC                                        1165
*         CALL TCICTCR (LRTEMPCC);/* TRANSLATE CAT TO CRA CI         */
*                                                                  1166
         LA    @15,LRTEMPCC                                        1166
         ST    @15,@AL00001                                        1166
         LA    @01,@AL00001                                        1166
         BAL   @14,TCICTCR                                         1166
*         IF LRTEMPCC = 0                                          1167
*           THEN                                                   1167
         LH    @15,LRTEMPCC                                        1167
         LTR   @15,@15                                             1167
         BNZ   @RF01167                                            1167
*             DO ;                                                 1168
*               IF FRSTVESW = ON   /* 1ST IS HORIZ EXTN CI           */
*                 THEN             /* SO STORE 1ST TIME ONLY         */
         TM    FRSTVESW,B'00000001'                                1169
         BNO   @RF01169                                            1169
*                   DO ;                                           1170
*                     CIHOREXT = CIFRTRNS ;                        1171
         MVC   CIHOREXT(3),CIFRTRNS                                1171
*                     FRSTVESW = OFF ;                             1172
         NI    FRSTVESW,B'11111110'                                1172
*                   END ;                                          1173
*                 ELSE             /* NOT FIRST TIME THRU            */
*                   IF HRONLYSW ^= ON                              1174
*                     THEN                                         1174
*                                                                  1174
         B     @RC01169                                            1174
@RF01169 TM    HRONLYSW,B'10000000'                                1174
         BO    @RF01174                                            1174
*                       CALL BLDVEXT ;  /* SEE FUNCTION ABOVE        */
*                                                                  1175
         BAL   @14,BLDVEXT                                         1175
*                     ELSE                                         1176
*                       VEFIELD = NBRFLDS + 1;/* EXIT LOOPS          */
         B     @RC01174                                            1176
@RF01174 LA    @01,1(,NBRFLDS)                                     1176
         STH   @01,VEFIELD                                         1176
*             END ;                                                1177
*           ELSE ;                 /* ERROR PRNTD IN TCICTCR         */
@RF01167 DS    0H                                                  1179
*         FMFLADDR(1) = FMFLADDR(1) + LENGTH($EXTPTRS) ;           1179
@RC01167 LA    @15,3                                               1179
         AL    @15,FMFLADDR(,FMFLCUR)                              1179
         ST    @15,FMFLADDR(,FMFLCUR)                              1179
*       END ;                                                      1180
         LA    @15,1                                               1180
         LH    @14,VEFIELD                                         1180
         N     @14,@CF01475                                        1180
         ALR   @15,@14                                             1180
@DE01163 STH   @15,VEFIELD                                         1180
         CR    @15,NBRFLDS                                         1180
         BNH   @DL01163                                            1180
@DC01163 DS    0H                                                  1181
*     END ;                                                        1181
*   ELSE                                                           1182
*     DO;                                                  /*@OZ09388*/
         B     @RC01159                                            1182
@RF01159 DS    0H                                                  1183
*       PROCMSG='INTVEXT ';   /* PROC NAME FOR INSERT        @OZ09388*/
         MVC   PROCMSG(8),@CC01319                                 1183
*      CALL ERROR (19,$RETURN) ;    /* FIELD MGMT ERR RETURN @OZ09388*/
         LA    @01,@AL01184                                        1184
         BAL   @14,ERROR                                           1184
*     END;                                                 /*@OZ09388*/
* FRSTVESW = OFF ;                                                 1186
@RC01159 NI    FRSTVESW,B'11111110'                                1186
* IF HRONLYSW ^= ON                                        /*@OZ20928*/
*   THEN VEPTR = VEPTRBEG ;     /* POINT BACK AT 1ST TABLE   @OZ20928*/
*                                                                  1187
         TM    HRONLYSW,B'10000000'                                1187
         BO    @RF01187                                            1187
         L     @15,VEPTRBEG                                        1188
         ST    @15,VEPTR                                           1188
*END INTVEXT ;                                                     1189
@EL00018 DS    0H                                                  1189
@EF00018 DS    0H                                                  1189
@ER00018 LM    @14,@12,@SA00018                                    1189
         BR    @14                                                 1189
* /*******************************************************************/
* /* PROCEDURE NAME - MEMSORT, MEMORY SORT                           */
* /* FUNCTION -                                                      */
* /*   ADD FORWARDS AND BACKWARDS ORDERING CHAINS TO SORTTBL         */
* /* INPUTS -                                                        */
* /*   SORTTBL (NAMES AND CIS ONLY)                                  */
* /* OUTPUTS -                                                       */
* /*   SORTTBL (ORDERING SUBSCRIPTS ADDED)                           */
* /* CALLS - NONE                                                    */
* /*******************************************************************/
*                                                                  1190
*MEMSORT: PROCEDURE ;                                              1190
MEMSORT  STM   @14,@12,@SA00019                                    1190
* OLDERID2 = NEWERID2;                                             1191
         L     @04,@PC00001                                        1191
         L     @15,GDTTR2(,@04)                                    1191
         MVC   @TS00001(95),NEWERID2(@15)                          1191
         MVC   OLDERID2(95,@15),@TS00001                           1191
* NEWID2 = 'LRME' ;                                                1192
         MVC   NEWID2(4,@15),@CC01324                              1192
* IF GDTDBG = NULLPTR                                              1193
*   THEN;                                                          1193
         L     @04,GDTDBG(,@04)                                    1193
         LTR   @04,@04                                             1193
         BZ    @RT01193                                            1193
*   ELSE                                                           1195
*     CALL IDCDB010 (GDTTBL,'LRME') ;                              1195
*                                                                  1195
         L     @04,@PC00001                                        1195
         ST    @04,@AL00001                                        1195
         LA    @15,@CC01324                                        1195
         ST    @15,@AL00001+4                                      1195
         MVI   @AL00001+4,X'80'                                    1195
         L     @15,GDTDBG(,@04)                                    1195
         LA    @01,@AL00001                                        1195
         BALR  @14,@15                                             1195
* /*******************************************************************/
* /* LOOP: PASS THRU ALL ENTRIES IN SORTTBL                          */
* /*******************************************************************/
*                                                                  1196
* DO SLOT = 3 TO STSLTCNT ;                                        1196
@RT01193 LA    SLOT,3                                              1196
         B     @DE01196                                            1196
@DL01196 DS    0H                                                  1197
*   CMPRSLOT = SLOT - 1 ;                                          1197
         LR    CMPRSLOT,SLOT                                       1197
         BCTR  CMPRSLOT,0                                          1197
*   IF STENTNM(SLOT) > STENTNM(CMPRSLOT)                           1198
*     THEN                                                         1198
         L     @04,STPTR                                           1198
         LA    @15,56                                              1198
         LR    @01,SLOT                                            1198
         MR    @00,@15                                             1198
         MR    @14,CMPRSLOT                                        1198
         ALR   @01,@04                                             1198
         AL    @01,@CF01483                                        1198
         ALR   @04,@15                                             1198
         AL    @04,@CF01483                                        1198
         CLC   STENTNM(44,@01),STENTNM(@04)                        1198
         BNH   @RF01198                                            1198
*       DO ;                                                       1199
*                                                                  1199
*         /***********************************************************/
*         /* LOOP: GO BACK DOWN FROM HERE TO INSERT POINT            */
*         /***********************************************************/
*                                                                  1200
*         DO UNTIL (STENTNM(SLOT) < STENTNM(CMPRSLOT)) ;           1200
@DL01200 DS    0H                                                  1201
*           CMPRSLOT = STFRWD(CMPRSLOT) ;                          1201
         LR    @04,CMPRSLOT                                        1201
         MH    @04,@CH01068                                        1201
         L     @01,STPTR                                           1201
         AL    @01,@CF01476                                        1201
         LH    @04,STFRWD-52(@04,@01)                              1201
         N     @04,@CF01475                                        1201
         LR    CMPRSLOT,@04                                        1201
*         END ;                                                    1202
@DE01200 L     @04,STPTR                                           1202
         LA    @15,56                                              1202
         LR    @01,SLOT                                            1202
         MR    @00,@15                                             1202
         MR    @14,CMPRSLOT                                        1202
         ALR   @01,@04                                             1202
         AL    @01,@CF01483                                        1202
         ST    @15,@TF00001                                        1202
         ALR   @15,@04                                             1202
         AL    @15,@CF01483                                        1202
         CLC   STENTNM(44,@01),STENTNM(@15)                        1202
         BNL   @DL01200                                            1202
*         CMPRSLOT = STBKWD(CMPRSLOT) ; /* BACK DOWN TO SAME         */
         L     @01,@TF00001                                        1203
         BCTR  @04,0                                               1203
         BCTR  @04,0                                               1203
         LH    @04,STBKWD-54(@01,@04)                              1203
         N     @04,@CF01475                                        1203
         LR    CMPRSLOT,@04                                        1203
*                                       /* POSITION AS BELOW         */
*                                       /* SO MOVE WORKS BOTH        */
*       END ;                                                      1204
*     ELSE                                                         1205
*                                                                  1205
*       /*************************************************************/
*       /* LOOP: GO UP FROM HERE TO INSERT POINT                     */
*       /*************************************************************/
*                                                                  1205
*       DO UNTIL (STENTNM(SLOT) > STENTNM(CMPRSLOT)) ;             1205
         B     @RC01198                                            1205
@RF01198 DS    0H                                                  1205
@DL01205 DS    0H                                                  1206
*         CMPRSLOT = STBKWD(CMPRSLOT) ;                            1206
         LR    @04,CMPRSLOT                                        1206
         MH    @04,@CH01068                                        1206
         L     @01,STPTR                                           1206
         BCTR  @01,0                                               1206
         BCTR  @01,0                                               1206
         LH    @04,STBKWD-54(@04,@01)                              1206
         N     @04,@CF01475                                        1206
         LR    CMPRSLOT,@04                                        1206
*       END ;                                                      1207
*                                                                  1207
@DE01205 L     @04,STPTR                                           1207
         LA    @15,56                                              1207
         LR    @01,SLOT                                            1207
         MR    @00,@15                                             1207
         MR    @14,CMPRSLOT                                        1207
         ALR   @01,@04                                             1207
         AL    @01,@CF01483                                        1207
         ALR   @04,@15                                             1207
         AL    @04,@CF01483                                        1207
         CLC   STENTNM(44,@01),STENTNM(@04)                        1207
         BNH   @DL01205                                            1207
*   STBKWD(SLOT) = STBKWD(STFRWD(CMPRSLOT)) ;                      1208
@RC01198 L     @04,STPTR                                           1208
         LA    @15,56                                              1208
         LR    @01,SLOT                                            1208
         MR    @00,@15                                             1208
         ST    @01,@TF00001                                        1208
         LR    @01,CMPRSLOT                                        1208
         MR    @00,@15                                             1208
         LA    @14,0(@01,@04)                                      1208
         AL    @14,@CF01476                                        1208
         ST    @01,@TF00002                                        1208
         LH    @01,STFRWD-52(,@14)                                 1208
         N     @01,@CF01475                                        1208
         MR    @00,@15                                             1208
         BCTR  @01,0                                               1208
         BCTR  @01,0                                               1208
         LH    @14,STBKWD-54(@01,@04)                              1208
         N     @14,@CF01475                                        1208
         L     @01,@TF00001                                        1208
         BCTR  @01,0                                               1208
         BCTR  @01,0                                               1208
         STH   @14,STBKWD-54(@01,@04)                              1208
*   STBKWD(STFRWD(CMPRSLOT)) = SLOT ;   /* SET BACKWARD AND          */
         L     @01,@TF00002                                        1209
         AL    @01,@CF01476                                        1209
         LH    @01,STFRWD-52(@01,@04)                              1209
         N     @01,@CF01475                                        1209
         MR    @14,@01                                             1209
         BCTR  @15,0                                               1209
         BCTR  @15,0                                               1209
         STH   SLOT,STBKWD-54(@15,@04)                             1209
*   STFRWD(SLOT) = STFRWD(CMPRSLOT) ;   /* FORWARD POINTERS          */
         L     @01,@TF00002                                        1210
         AL    @01,@CF01476                                        1210
         LH    @15,STFRWD-52(@01,@04)                              1210
         N     @15,@CF01475                                        1210
         L     @14,@TF00001                                        1210
         AL    @14,@CF01476                                        1210
         STH   @15,STFRWD-52(@14,@04)                              1210
*   STFRWD(CMPRSLOT) = SLOT ;                                      1211
         L     @01,@TF00002                                        1211
         AL    @04,@CF01476                                        1211
         STH   SLOT,STFRWD-52(@01,@04)                             1211
* END ;                                                            1212
*                                                                  1212
         AL    SLOT,@CF00222                                       1212
@DE01196 LH    @04,STSLTCNT                                        1212
         N     @04,@CF01475                                        1212
         CR    SLOT,@04                                            1212
         BNH   @DL01196                                            1212
*END MEMSORT ;                                                     1213
@EL00019 DS    0H                                                  1213
@EF00019 DS    0H                                                  1213
@ER00019 LM    @14,@12,@SA00019                                    1213
         BR    @14                                                 1213
* /*******************************************************************/
* /* PRODEDURE NAME - PRTAAXV, PRINT ASSOCIATED AIX,S VOLUMES        */
* /* FUNCTION -                                                      */
* /*   INITIALIZE ASSOCTB2 WITH ASSOCIATIONS FROM THE                */
* /*   ASSOCIATED AIX,                                               */
* /*   SEARCH IT FOR THE DATA AND INDEX RECORDS AND                  */
* /*   CALL PRTOJVL TO PRINT THEIR VOLUMES FOR INFORMATION           */
* /*   ONLY (I.E. NO COMPARE OR DUMP)                                */
* /* INPUTS -                                                        */
* /*   CIFRGET (IDENTIFIES AIX CLUSTER RECORD)                       */
* /* OUTPUTS -                                                       */
* /* CALLS -                                                         */
* /*   INTASOC, PRTOJVL                                              */
* /*******************************************************************/
*                                                                  1214
*PRTAAXV: PROCEDURE ;                                              1214
PRTAAXV  STM   @14,@12,@SA00020                                    1214
* OLDERID2 = NEWERID2;                                             1215
         L     @15,@PC00001                                        1215
         L     @14,GDTTR2(,@15)                                    1215
         MVC   @TS00001(95),NEWERID2(@14)                          1215
         MVC   OLDERID2(95,@14),@TS00001                           1215
* NEWID2 = 'LRPA' ;                                                1216
         MVC   NEWID2(4,@14),@CC01329                              1216
* IF GDTDBG = NULLPTR                                              1217
*   THEN;                                                          1217
         L     @15,GDTDBG(,@15)                                    1217
         LTR   @15,@15                                             1217
         BZ    @RT01217                                            1217
*   ELSE                                                           1219
*     CALL IDCDB010 (GDTTBL,'LRPA') ;                              1219
*                                                                  1219
         L     @15,@PC00001                                        1219
         ST    @15,@AL00001                                        1219
         LA    @14,@CC01329                                        1219
         ST    @14,@AL00001+4                                      1219
         MVI   @AL00001+4,X'80'                                    1219
         L     @15,GDTDBG(,@15)                                    1219
         LA    @01,@AL00001                                        1219
         BALR  @14,@15                                             1219
* AAXVCNT = 0 ;                    /* QUIT LOOKING AFTER TWO         */
@RT01217 SLR   AAXVCNT,AAXVCNT                                     1220
* AAPTRSAV = ATRA2PTR ;                                            1221
         L     @03,ATRA2PTR                                        1221
         ST    @03,AAPTRSAV                                        1221
* CISAVED = CIFRGET ;                                              1222
         MVC   CISAVED(3),CIFRGET                                  1222
* IF CMPRSW = ON                   /* SAVE SWITCHES AND SET          */
*   THEN SAVESW2 = ON ;            /* TEMPORARILY TO NO DUMP         */
         TM    CMPRSW,B'01000000'                                  1223
         BNO   @RF01223                                            1223
         OI    SAVESW2,B'00010000'                                 1224
*   ELSE SAVESW2 = OFF ;           /* AND NO COMPARE                 */
         B     @RC01223                                            1225
@RF01223 NI    SAVESW2,B'11101111'                                 1225
* IF DUMPSW = ON                                                   1226
*   THEN SAVESW3 = ON ;                                            1226
@RC01223 TM    DUMPSW,B'00000100'                                  1226
         BNO   @RF01226                                            1226
         OI    SAVESW3,B'00001000'                                 1227
*   ELSE SAVESW3 = OFF ;                                           1228
         B     @RC01226                                            1228
@RF01226 NI    SAVESW3,B'11110111'                                 1228
* CMPRSW = OFF ;                                                   1229
@RC01226 DS    0H                                                  1230
* DUMPSW = OFF ;                                                   1230
         NI    CMPRSW,B'10111011'                                  1230
* ATRA2PTR = A2PTR ;                                               1231
*                                                                  1231
         L     @03,A2PTR                                           1231
         ST    @03,ATRA2PTR                                        1231
* CALL INTASOC(1) ;                /* GO BUILD ASSOCTB2              */
*                                                                  1232
         LA    @01,@AL01232                                        1232
         BAL   @14,INTASOC                                         1232
* /*******************************************************************/
* /* LOOP: LOOK THRU ASSOCTB2 TILL DATA AND INDEX                    */
* /*       ASSOCIATIONS HAVE BEEN FOUND                              */
* /*******************************************************************/
*                                                                  1233
* DO A2SLOT = 1 TO NBRATS                                          1233
*    WHILE (AAXVCNT < 2                                            1233
*       & LASTATSW ^= ON) ;                                        1233
         LA    A2SLOT,1                                            1233
@DL01233 C     AAXVCNT,@CF00158                                    1233
         BNL   @DC01233                                            1233
         TM    LASTATSW,B'00100000'                                1233
         BO    @DC01233                                            1233
*   IF    A2ENTYP(A2SLOT) = CATRCTYP($DATA)                        1234
*      × A2ENTYP(A2SLOT) = CATRCTYP($INDX)                         1234
*     THEN                                                         1234
         L     @15,ATRA2PTR                                        1234
         LR    @14,A2SLOT                                          1234
         SLA   @14,2                                               1234
         LA    @01,5                                               1234
         ST    @01,@TF00001                                        1234
         SLR   @01,@01                                             1234
         IC    @01,$DATA                                           1234
         M     @00,@TF00001                                        1234
         ST    @14,@TF00002                                        1234
         ALR   @14,@15                                             1234
         LA    @15,CATRCTYP-5(@01)                                 1234
         CLC   A2ENTYP-4(1,@14),0(@15)                             1234
         BE    @RT01234                                            1234
         L     @15,ATRA2PTR                                        1234
         SLR   @01,@01                                             1234
         IC    @01,$INDX                                           1234
         M     @00,@TF00001                                        1234
         AL    @15,@TF00002                                        1234
         LA    @14,CATRCTYP-5(@01)                                 1234
         CLC   A2ENTYP-4(1,@15),0(@14)                             1234
         BNE   @RF01234                                            1234
@RT01234 DS    0H                                                  1235
*       DO ;                                                       1235
*         AAXVCNT = AAXVCNT + 1 ;                                  1236
         LA    AAXVCNT,1(,AAXVCNT)                                 1236
*         CIFRGET = A2CRACI(A2SLOT) ;                              1237
*                                                                  1237
         LR    @15,A2SLOT                                          1237
         SLA   @15,2                                               1237
         L     @01,ATRA2PTR                                        1237
         ALR   @01,@15                                             1237
         MVC   CIFRGET(3),A2CRACI-4(@01)                           1237
*         CALL PRTOJVL ;           /* GO PRINT OBJECTS VOLUME        */
*                                                                  1238
         BAL   @14,PRTOJVL                                         1238
*       END ;                                                      1239
*     IF A2SLOT = NBRATS                                           1240
*       THEN                                                       1240
@RF01234 C     A2SLOT,@CF00038                                     1240
         BNE   @RF01240                                            1240
*         IF A2NXTTBL ^= '0'B                                      1241
*           THEN                                                   1241
         L     @01,ATRA2PTR                                        1241
         L     @15,A2NXTTBL(,@01)                                  1241
         LTR   @15,@15                                             1241
         BZ    @RF01241                                            1241
*             DO ;                                                 1242
*               ATRA2PTR = A2NXTTBL ;   /* BUMP TO NEXT TABLE        */
         ST    @15,ATRA2PTR                                        1243
*               A2SLOT = 0 ;                                       1244
         SLR   A2SLOT,A2SLOT                                       1244
*             END ;                                                1245
*           ELSE LASTATSW = ON ;                                   1246
         B     @RC01241                                            1246
@RF01241 OI    LASTATSW,B'00100000'                                1246
* END ;                                                            1247
@RC01241 DS    0H                                                  1247
@RF01240 AL    A2SLOT,@CF00222                                     1247
         C     A2SLOT,@CF00038                                     1247
         BNH   @DL01233                                            1247
@DC01233 DS    0H                                                  1248
* LASTATSW = OFF ;                                                 1248
         NI    LASTATSW,B'11011111'                                1248
* IF SAVESW3 = ON                  /* RESTORE SWITCHES               */
*   THEN DUMPSW = ON ;                                             1249
         TM    SAVESW3,B'00001000'                                 1249
         BNO   @RF01249                                            1249
         OI    DUMPSW,B'00000100'                                  1250
* IF SAVESW2 = ON                                                  1251
*   THEN CMPRSW = ON ;                                             1251
@RF01249 TM    SAVESW2,B'00010000'                                 1251
         BNO   @RF01251                                            1251
         OI    CMPRSW,B'01000000'                                  1252
* CIFRGET = CISAVED ;              /* RESTORE OTHER STUFF            */
@RF01251 MVC   CIFRGET(3),CISAVED                                  1253
* ATRA2PTR = AAPTRSAV ;                                            1254
*                                                                  1254
         L     @04,AAPTRSAV                                        1254
         ST    @04,ATRA2PTR                                        1254
*END PRTAAXV ;                                                     1255
@EL00020 DS    0H                                                  1255
@EF00020 DS    0H                                                  1255
@ER00020 LM    @14,@12,@SA00020                                    1255
         BR    @14                                                 1255
* /*******************************************************************/
* /* PROCEDURE NAME - PRTCMP, PRINT STUFF FOR RECORD (CMPR)          */
* /* FUNCTION -                                                      */
* /*   IF NOT SEQUENTIALDUMP BUT IS PRINT PASS                       */
* /*   AND NOT EXTENSION RECORD - EXTRACT & PRINT TYPE & NAME,       */
* /*   IF NOT SDUMP, PRINT PASS AND NOT DUMP AND DATA, INDEX OR      */
* /*   ALIEN - CALL PRTOJVL TO PRINT OBJECT,S VOLUMES,               */
* /*   IF COMPARE PASS - COMPARE CRA AND CATALOG RECORDS AND         */
* /*   SET MISCOMPARE SWITCH ON AND INCREMENT MISCOMPARED            */
* /*   RECORD COUNT IF THERE WAS A MISMATCH,                         */
* /*   IF PRINT PASS AND DUMP - CALL PRTDMP TO PRINT THE             */
* /*   RECORDS AND UNDERSCORE ALL BYTES THAT MISCOMPARED,            */
* /*   IF PRINT PASS - MARK ALL PROCESSED RECORDS IN THE CTT         */
* /* INPUTS -                                                        */
* /*   INDNTCOL (NUMBER OF COLUMES TO INDENT)                        */
* /*   CTT                                                           */
* /*   MCRCDCNT                                                      */
* /* OUTPUTS -                                                       */
* /*   NAME (AND RECORD) PRINTED AS SPECIFIED                        */
* /*   CTT (RECORDS MARKED THAT HAVE BEEN PROCESSED)                 */
* /*   MCRCDCNT (MISCOMPARED RECORDS COUNT INCREMENTED)              */
* /* CALLS -                                                         */
* /*   UPRINT, PRTDMP, PRTOJVL,                                      */
* /*   IDCRC04($USEDLEN)                                             */
* /*******************************************************************/
*                                                                  1256
*PRTCMP: PROCEDURE ;                                               1256
PRTCMP   STM   @14,@12,@SA00021                                    1256
* OLDERID2 = NEWERID2;                                             1257
         L     @15,@PC00001                                        1257
         L     @14,GDTTR2(,@15)                                    1257
         MVC   @TS00001(95),NEWERID2(@14)                          1257
         MVC   OLDERID2(95,@14),@TS00001                           1257
* NEWID2 = 'LRPC' ;                                                1258
         MVC   NEWID2(4,@14),@CC01334                              1258
* IF GDTDBG = NULLPTR                                              1259
*   THEN;                                                          1259
         L     @15,GDTDBG(,@15)                                    1259
         LTR   @15,@15                                             1259
         BZ    @RT01259                                            1259
*   ELSE                                                           1261
*     CALL IDCDB010 (GDTTBL,'LRPC') ;                              1261
*                                                                  1261
         L     @15,@PC00001                                        1261
         ST    @15,@AL00001                                        1261
         LA    @14,@CC01334                                        1261
         ST    @14,@AL00001+4                                      1261
         MVI   @AL00001+4,X'80'                                    1261
         L     @15,GDTDBG(,@15)                                    1261
         LA    @01,@AL00001                                        1261
         BALR  @14,@15                                             1261
* IF     SDUMPSW ^= ON             /* NO NAMES IF SEQ DUMP           */
*    & PRNTPASW = ON               /* AND ALWAYS FOR SOME OF EM      */
*    & (ENTYPSAV ^= CATRCTYP($OEXT)                                1262
*     & ENTYPSAV ^= CATRCTYP($VEXT))                               1262
*                                  /**************************       */
*   THEN                           /* PRINT TYPE AND NAME            */
@RT01259 TM    PRNTPASW,B'10000000'                                1262
         BNO   @RF01262                                            1262
         TM    SDUMPSW,B'00000010'                                 1262
         BNZ   @RF01262                                            1262
         LA    @15,5                                               1262
         SLR   @01,@01                                             1262
         IC    @01,$OEXT                                           1262
         MR    @00,@15                                             1262
         LA    @14,CATRCTYP-5(@01)                                 1262
         CLC   ENTYPSAV(1),0(@14)                                  1262
         BE    @RF01262                                            1262
         SLR   @03,@03                                             1262
         IC    @03,$VEXT                                           1262
         MR    @14,@03                                             1262
         LA    @14,CATRCTYP-5(@15)                                 1262
         CLC   ENTYPSAV(1),0(@14)                                  1262
         BE    @RF01262                                            1262
*     DO ;                         /**************************       */
*       DO TYPESLOT = 1 TO 26      /* FIND INDEX OF RCD TYPE         */
*          WHILE (ENTYPSAV ^= CATRCTYP(TYPESLOT)) ;                1264
         LA    TYPESLOT,1                                          1264
@DL01264 LR    @03,TYPESLOT                                        1264
         MH    @03,@CH00042                                        1264
         LA    @01,CATRCTYP-5(@03)                                 1264
         CLC   ENTYPSAV(1),0(@01)                                  1264
         BE    @DC01264                                            1264
*       END ;                                                      1265
         AL    TYPESLOT,@CF00222                                   1265
         C     TYPESLOT,@CF00643                                   1265
         BNH   @DL01264                                            1265
@DC01264 DS    0H                                                  1266
*       DARGLIST = '0'B ;          /* SET UP TO PRINT NAME           */
         L     @03,DDSTRU                                          1266
         XC    DARGLIST+1(19,@03),DARGLIST+1(@03)                  1266
         MVI   DARGLIST(@03),B'00000000'                           1266
*       DARGSMOD = 'LR0' ;                                         1267
         MVC   DARGSMOD(3,@03),@CC01335                            1267
*       DARGSENT = 1 ;                                             1268
         MVI   DARGSENT(@03),X'01'                                 1268
*       DARGIND = INDNTCOL ;                                       1269
         IC    @15,INDNTCOL                                        1269
         STC   @15,DARGIND(,@03)                                   1269
*       DARGCNT = 2 ;                                              1270
         LA    @15,2                                               1270
         STH   @15,DARGCNT(,@03)                                   1270
*       DARGINS(1) = 1 ;                                           1271
         MVC   DARGINS(2,@03),@CH00222                             1271
*       DARGINL(1) = 4 ;                                           1272
         MVC   DARGINL(2,@03),@CH00047                             1272
*       DARGDTM(1) = ADDR(CATRDESC(TYPESLOT)) ;                    1273
         LA    @14,5                                               1273
         LR    @01,TYPESLOT                                        1273
         MR    @00,@14                                             1273
         LA    @01,CATRDESC-5(@01)                                 1273
         ST    @01,DARGDTM(,@03)                                   1273
*       DARGINS(2) = 2 ;                                           1274
         STH   @15,DARGINS+8(,@03)                                 1274
*       DARGINL(2) = 44 ;                                          1275
         MVC   DARGINL+8(2,@03),@CH00614                           1275
*       DARGDTM(2) = ADDR(ENTNAME) ;                               1276
         L     @02,FMFLADDR(,FMFLCUR)                              1276
         ST    @02,DARGDTM+8(,@03)                                 1276
*       IF ENTYPSAV = CATRCTYP($VOL)                               1277
*         THEN ENTNAME(7:44) = ' ';/* CHANGE 00 TO 40                */
         LR    @01,@14                                             1277
         SLR   @03,@03                                             1277
         IC    @03,$VOL                                            1277
         MR    @00,@03                                             1277
         LA    @03,CATRCTYP-5(@01)                                 1277
         CLC   ENTYPSAV(1),0(@03)                                  1277
         BNE   @RF01277                                            1277
         MVI   ENTNAME+7(@02),C' '                                 1278
         MVC   ENTNAME+8(36,@02),ENTNAME+7(@02)                    1278
         MVI   ENTNAME+6(@02),C' '                                 1278
*       IF    ENTYPSAV = CATRCTYP($FRSP)                           1279
*          × ENTYPSAV = CATRCTYP($CCR)                             1279
*          × ENTYPSAV = CATRCTYP($UPGD)                            1279
*         THEN ENTNAME = ' ' ;     /* CHANGE TO ALL 40               */
*                                                                  1279
@RF01277 LA    @15,5                                               1279
         SLR   @01,@01                                             1279
         IC    @01,$FRSP                                           1279
         MR    @00,@15                                             1279
         LA    @14,CATRCTYP-5(@01)                                 1279
         CLC   ENTYPSAV(1),0(@14)                                  1279
         BE    @RT01279                                            1279
         SLR   @01,@01                                             1279
         IC    @01,$CCR                                            1279
         MR    @00,@15                                             1279
         LA    @14,CATRCTYP-5(@01)                                 1279
         CLC   ENTYPSAV(1),0(@14)                                  1279
         BE    @RT01279                                            1279
         SLR   @03,@03                                             1279
         IC    @03,$UPGD                                           1279
         MR    @14,@03                                             1279
         LA    @14,CATRCTYP-5(@15)                                 1279
         CLC   ENTYPSAV(1),0(@14)                                  1279
         BNE   @RF01279                                            1279
@RT01279 DS    0H                                                  1280
         L     @01,FMFLADDR(,FMFLCUR)                              1280
         MVI   ENTNAME+1(@01),C' '                                 1280
         MVC   ENTNAME+2(42,@01),ENTNAME+1(@01)                    1280
         MVI   ENTNAME(@01),C' '                                   1280
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    1281
*                                                                  1281
@RF01279 L     @15,@PC00001                                        1281
         ST    @15,@AL00001                                        1281
         LA    @14,IOCSPRT                                         1281
         ST    @14,@AL00001+4                                      1281
         LA    @14,DDSTRU                                          1281
         ST    @14,@AL00001+8                                      1281
         MVI   @AL00001+8,X'80'                                    1281
         L     @15,GDTPRT(,@15)                                    1281
         LA    @01,@AL00001                                        1281
         BALR  @14,@15                                             1281
*     END ;                                                        1282
* IF     PRNTPASW = ON             /* FOR THESE CONDITIONS           */
*    & DUMPSW ^= ON                /* PRINT ENTRIES VOLUMES          */
*    & SDUMPSW ^= ON                                               1283
*    & CIFRGET > CTTBASE                                           1283
*    & (ENTYPSAV = CATRCTYP($DATA)                                 1283
*      × ENTYPSAV = CATRCTYP($INDX)                                1283
*      × ENTYPSAV = CATRCTYP($NONV)                                1283
*      × ENTYPSAV = CATRCTYP($UCAT))                               1283
*   THEN                                                           1283
*                                                                  1283
@RF01262 TM    PRNTPASW,B'10000000'                                1283
         BNO   @RF01283                                            1283
         TM    DUMPSW,B'00000100'                                  1283
         BO    @RF01283                                            1283
         TM    SDUMPSW,B'00000010'                                 1283
         BO    @RF01283                                            1283
         CLC   CIFRGET(3),@CF00039+1                               1283
         BNH   @RF01283                                            1283
         LA    @15,5                                               1283
         SLR   @01,@01                                             1283
         IC    @01,$DATA                                           1283
         MR    @00,@15                                             1283
         LA    @14,CATRCTYP-5(@01)                                 1283
         CLC   ENTYPSAV(1),0(@14)                                  1283
         BE    @RT01283                                            1283
         SLR   @01,@01                                             1283
         IC    @01,$INDX                                           1283
         MR    @00,@15                                             1283
         LA    @14,CATRCTYP-5(@01)                                 1283
         CLC   ENTYPSAV(1),0(@14)                                  1283
         BE    @RT01283                                            1283
         SLR   @01,@01                                             1283
         IC    @01,$NONV                                           1283
         MR    @00,@15                                             1283
         LA    @14,CATRCTYP-5(@01)                                 1283
         CLC   ENTYPSAV(1),0(@14)                                  1283
         BE    @RT01283                                            1283
         SLR   @03,@03                                             1283
         IC    @03,$UCAT                                           1283
         MR    @14,@03                                             1283
         LA    @14,CATRCTYP-5(@15)                                 1283
         CLC   ENTYPSAV(1),0(@14)                                  1283
         BNE   @RF01283                                            1283
@RT01283 DS    0H                                                  1284
*     CALL PRTOJVL ;                                               1284
*                                                                  1284
         BAL   @14,PRTOJVL                                         1284
* IOBFSPTR = IOCRBPTR ;                                            1285
@RF01283 L     @15,IOCRBPTR                                        1285
         ST    @15,IOBFSPTR                                        1285
* IF SDUMPSW = ON                                                  1286
*   THEN $USEDLEN = CATCISZ - 4 ;  /* FULL RECORD IF SEQ DUMP        */
         TM    SDUMPSW,B'00000010'                                 1286
         BNO   @RF01286                                            1286
         L     @01,FMFLADDR(,FMFLCUR)                              1287
         MVC   $USEDLEN(2,@01),@CH01136                            1287
*   ELSE                                                           1288
*     IF ENTYPSAV = CATRCTYP($FRSP)                                1288
*       THEN $USEDLEN = LENFRSP ;                                  1288
         B     @RC01286                                            1288
@RF01286 SLR   @15,@15                                             1288
         IC    @15,$FRSP                                           1288
         MH    @15,@CH00042                                        1288
         LA    @14,CATRCTYP-5(@15)                                 1288
         CLC   ENTYPSAV(1),0(@14)                                  1288
         BNE   @RF01288                                            1288
         L     @01,FMFLADDR(,FMFLCUR)                              1289
         MVC   $USEDLEN(2,@01),@CH00639                            1289
*       ELSE                                                       1290
*         IF ENTYPSAV = CATRCTYP($CCR)                             1290
*           THEN $USEDLEN = LENCCR ;                               1290
         B     @RC01288                                            1290
@RF01288 SLR   @15,@15                                             1290
         IC    @15,$CCR                                            1290
         MH    @15,@CH00042                                        1290
         LA    @14,CATRCTYP-5(@15)                                 1290
         CLC   ENTYPSAV(1),0(@14)                                  1290
         BNE   @RF01290                                            1290
         L     @01,FMFLADDR(,FMFLCUR)                              1291
         MVC   $USEDLEN(2,@01),@CH00637                            1291
*           ELSE                                                   1292
*             DO ;                                                 1292
         B     @RC01290                                            1292
@RF01290 DS    0H                                                  1293
*               IF CIFRGET > CTTBASE       /* IS TRANSLATE NEEDED    */
*                 THEN FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;      1293
         L     @15,CIFRGET-1                                       1293
         LA    @15,0(,@15)                                         1293
         C     @15,@CF00039                                        1293
         BNH   @RF01293                                            1293
         SLA   @15,3                                               1294
         L     @01,FMPLAD                                          1294
         L     @14,CTTPTR                                          1294
         ALR   @14,@15                                             1294
         AL    @14,@CF01478                                        1294
         MVC   FMPLBCIN(3,@01),CTTCATCI-5(@14)                     1294
*                 ELSE FMPLBCIN = CIFRGET ;                        1295
         B     @RC01293                                            1295
@RF01293 L     @01,FMPLAD                                          1295
         MVC   FMPLBCIN(3,@01),CIFRGET                             1295
*               FMFLDNAM = ADDR('$USEDLEN') ;                      1296
@RC01293 LA    @15,@CC01336                                        1296
         ST    @15,FMFLDNAM(,FMFLCUR)                              1296
*               REG1 = FMPLAD ;                                    1297
*                                                                  1297
         L     REG1,FMPLAD                                         1297
*               CALL IDCRC04 ;     /* ASK FOR USED LENGTH            */
*                                                                  1298
         L     @15,@CV00793                                        1298
         BALR  @14,@15                                             1298
*               IF FMFLENTH = 0 × $USEDLEN = 0                     1299
*                 THEN                                             1299
         L     @15,FMFLENTH(,FMFLCUR)                              1299
         LTR   @15,@15                                             1299
         BZ    @RT01299                                            1299
         L     @01,FMFLADDR(,FMFLCUR)                              1299
         LH    @15,$USEDLEN(,@01)                                  1299
         N     @15,@CF01475                                        1299
         LTR   @15,@15                                             1299
         BNZ   @RF01299                                            1299
@RT01299 DS    0H                                                  1300
*                   DO ;                                           1300
*                     PROCMSG='PRTCMP  '; /* NAME FOR INSERT @OZ09388*/
         MVC   PROCMSG(8),@CC01337                                 1301
*                     CALL ERROR (26,$RETURN) ; /* FIELD MGMT        */
         LA    @01,@AL01302                                        1302
         BAL   @14,ERROR                                           1302
*                     $USEDLEN = 508 ; /* PRINT WHOLE RECORD         */
         L     @01,FMFLADDR(,FMFLCUR)                              1303
         MVC   $USEDLEN(2,@01),@CH01136                            1303
*                   END ;                                          1304
*     END ;                                                        1305
@RF01299 DS    0H                                                  1306
* CMPRLENL = MIN(256,$USEDLEN) ;                                   1306
@RC01290 DS    0H                                                  1306
@RC01288 DS    0H                                                  1306
@RC01286 LA    @15,256                                             1306
         L     @01,FMFLADDR(,FMFLCUR)                              1306
         LH    @14,$USEDLEN(,@01)                                  1306
         N     @14,@CF01475                                        1306
         LR    CMPRLENL,@15                                        1306
         CR    CMPRLENL,@14                                        1306
         BNH   *+6
         LR    CMPRLENL,@14                                        1306
* CMPRLENR = MAX(0,$USEDLEN - 256) ;                               1307
         SLR   @01,@01                                             1307
         SLR   @14,@15                                             1307
         CR    @14,@01                                             1307
         BNL   *+6
         LR    @14,@01                                             1307
         LR    CMPRLENR,@14                                        1307
* IF CMPRSW = ON & NOCATRSW ^= ON                                  1308
*   THEN                           /* COMPARE RECORDS                */
         TM    CMPRSW,B'01000000'                                  1308
         BNO   @RF01308                                            1308
         TM    NOCATRSW,B'00000010'                                1308
         BO    @RF01308                                            1308
*     IF    IOBUF(BUFNO,1:CMPRLENL)  ^=                            1309
*           IOCTBPTR -> IOBUF(BUFNO,1:CMPRLENL)                    1309
*        × (CMPRLENR ^= 0                                          1309
*        & IOBUF(BUFNO,257:CMPRLENR)  ^=                           1309
*            IOCTBPTR -> IOBUF(BUFNO,257:CMPRLENR))                1309
*       THEN                                                       1309
         L     @15,IOBFSPTR                                        1309
         SLR   @14,@14                                             1309
         IC    @14,BUFNO                                           1309
         SLA   @14,9                                               1309
         L     @00,IOCTBPTR                                        1309
         LR    @01,CMPRLENL                                        1309
         BCTR  @01,0                                               1309
         ST    @14,@TF00001                                        1309
         ALR   @14,@15                                             1309
         AL    @14,@CF01464                                        1309
         LR    @15,@00                                             1309
         AL    @15,@TF00001                                        1309
         AL    @15,@CF01464                                        1309
         EX    @01,@SC01487                                        1309
         BNE   @RT01309                                            1309
         SLR   @01,@01                                             1309
         CR    CMPRLENR,@01                                        1309
         BE    @RF01309                                            1309
         L     @01,IOBFSPTR                                        1309
         LR    @15,CMPRLENR                                        1309
         SL    @15,@CF01189                                        1309
         AL    @01,@TF00001                                        1309
         AL    @01,@CF01465                                        1309
         LR    @14,@00                                             1309
         AL    @14,@TF00001                                        1309
         AL    @14,@CF01465                                        1309
         EX    @15,@SC01489                                        1309
         BE    @RF01309                                            1309
@RT01309 DS    0H                                                  1310
*         DO ;                     /******* MISCOMPARE ***************/
*            MSCMPRSW = ON ;                                       1311
         OI    MSCMPRSW,B'00001000'                                1311
*            CTTMCSW(CIBASE - CTTBASE) = ON ;                      1312
         L     @15,CIBASE-1                                        1312
         LA    @15,0(,@15)                                         1312
         SLA   @15,3                                               1312
         L     @01,CTTPTR                                          1312
         ALR   @01,@15                                             1312
         AL    @01,@CF01491                                        1312
         OI    CTTMCSW-8(@01),B'01000000'                          1312
*           IF CMPRPASW = ON                                       1313
*             THEN                                                 1313
         TM    CMPRPASW,B'10000000'                                1313
         BNO   @RF01313                                            1313
*               DO ;               /* AVOID COUNTING DOUBLE          */
*                 ENTNOSAV = ENTNOCUR ;                            1315
         LH    @15,ENTNOCUR                                        1315
         STH   @15,ENTNOSAV                                        1315
*                 ENTNOCUR = -1 ;                                  1316
         MVC   ENTNOCUR(2),@CH01288                                1316
*               END ;                                              1317
*           IF PRNTPASW = ON                                       1318
*             THEN MCRCDCNT = MCRCDCNT + 1 ;                       1318
@RF01313 TM    PRNTPASW,B'10000000'                                1318
         BNO   @RF01318                                            1318
         LH    @01,MCRCDCNT                                        1319
         LA    @01,1(,@01)                                         1319
         STH   @01,MCRCDCNT                                        1319
*         END ;                                                    1320
@RF01318 DS    0H                                                  1321
* IF    (PRNTPASW = ON             /* ONLY PRINT DUMP UNDER          */
*    & DUMPSW = ON)                /* THESE CONDITIONS               */
*     × SDUMPSW = ON                                               1321
*                                                                  1321
*   THEN CALL PRTDMP ;             /* PRINT DUMP FORMAT              */
*                                                                  1321
@RF01309 DS    0H                                                  1321
@RF01308 TM    PRNTPASW,B'10000000'                                1321
         BNO   @GL00043                                            1321
         TM    DUMPSW,B'00000100'                                  1321
         BO    @RT01321                                            1321
@GL00043 TM    SDUMPSW,B'00000010'                                 1321
         BNO   @RF01321                                            1321
@RT01321 DS    0H                                                  1322
         BAL   @14,PRTDMP                                          1322
* IF PRNTPASW = ON & CIFRGET > CTTBASE                             1323
*   THEN  CTTPRTD(CIFRGET - CTTBASE) = ON ;                        1323
*                                                                  1323
@RF01321 TM    PRNTPASW,B'10000000'                                1323
         BNO   @RF01323                                            1323
         L     @15,CIFRGET-1                                       1323
         LA    @15,0(,@15)                                         1323
         C     @15,@CF00039                                        1323
         BNH   @RF01323                                            1323
         SLA   @15,3                                               1324
         L     @01,CTTPTR                                          1324
         ALR   @01,@15                                             1324
         AL    @01,@CF01491                                        1324
         OI    CTTPRTD-8(@01),B'10000000'                          1324
*END PRTCMP ;                                                      1325
@EL00021 DS    0H                                                  1325
@EF00021 DS    0H                                                  1325
@ER00021 LM    @14,@12,@SA00021                                    1325
         BR    @14                                                 1325
* /*******************************************************************/
* /* PROCEDURE NAME - PRTDMP, PRINT RECORDS IF DUMP SPECIFIED        */
* /* FUNCTION -                                                      */
* /*   DIVIDING THE RECORD INTO PRINT LINES (UP TO 16),              */
* /*     PRINT 32 CHARACTERS OF CRA RECORD IN 8 GROUPS OF 4          */
* /*     (HEX) FOLLOWED BY THE 32 (CHAR) (LIKE DUMPS),               */
* /*     IF COMPARE CALL PRTDMPC TO PRINT CORRESPONDING              */
* /*     CHARACTERS FROM THE CATALOG RECORD AND BUILD AND            */
* /*     PRINT THE LINE THAT UNDERSCORES WHICH CHARACTERS            */
* /*     MISCOMPARED                                                 */
* /* INPUTS -                                                        */
* /*   CRA (AND CATALOG) RECORDS IDENTIFIED BY BUFNO, CIFRGET        */
* /* OUTPUTS -                                                       */
* /*   CRA PART OF 1 TO 48 LINES OF DUMP FORMAT RECORD(S)            */
* /* CALLS -                                                         */
* /*   UPRINT, PRTDMPC, ERROR                                        */
* /*******************************************************************/
*                                                                  1326
*PRTDMP: PROCEDURE ;                                               1326
PRTDMP   STM   @14,@12,@SA00022                                    1326
* IF GDTDBG = NULLPTR                                              1327
*   THEN;                                                          1327
         L     @15,@PC00001                                        1327
         L     @15,GDTDBG(,@15)                                    1327
         LTR   @15,@15                                             1327
         BZ    @RT01327                                            1327
*   ELSE                                                           1329
*     CALL IDCDB010 (GDTTBL,'LRPD') ;                              1329
         L     @15,@PC00001                                        1329
         ST    @15,@AL00001                                        1329
         LA    @14,@CC01344                                        1329
         ST    @14,@AL00001+4                                      1329
         MVI   @AL00001+4,X'80'                                    1329
         L     @15,GDTDBG(,@15)                                    1329
         LA    @01,@AL00001                                        1329
         BALR  @14,@15                                             1329
* OLDERID2 = NEWERID2;                                             1330
@RT01327 L     @15,@PC00001                                        1330
         L     @15,GDTTR2(,@15)                                    1330
         MVC   @TS00001(95),NEWERID2(@15)                          1330
         MVC   OLDERID2(95,@15),@TS00001                           1330
* NEWID2 = 'LRPD' ;                                                1331
*                                                                  1331
         MVC   NEWID2(4,@15),@CC01344                              1331
* RQDLINES = MIN(16,$USEDLEN/32 + 1) ;                             1332
         LA    @15,1                                               1332
         L     @01,FMFLADDR(,FMFLCUR)                              1332
         LH    @14,$USEDLEN(,@01)                                  1332
         N     @14,@CF01475                                        1332
         SRL   @14,5                                               1332
         ALR   @14,@15                                             1332
         LA    @03,16                                              1332
         CR    @14,@03                                             1332
         BNH   *+6
         LR    @14,@03                                             1332
         STC   @14,RQDLINES                                        1332
* DARGLIST = '0'B ;                /* SET UP FOR PRINTING            */
         L     @14,DDSTRU                                          1333
         XC    DARGLIST+1(19,@14),DARGLIST+1(@14)                  1333
         MVI   DARGLIST(@14),B'00000000'                           1333
* DARGSMOD = 'LR0' ;                                               1334
         MVC   DARGSMOD(3,@14),@CC01335                            1334
* DARGCNT = 10 ;                                                   1335
         MVC   DARGCNT(2,@14),@CH00037                             1335
* DO DARGSLOT = 1 TO 10 ;          /* INITIALIZE PART OF             */
         LR    DARGSLOT,@15                                        1336
@DL01336 DS    0H                                                  1337
*   DARGINS(DARGSLOT) = DARGSLOT ; /* PRINT PARAMETER LIST           */
         L     @03,DDSTRU                                          1337
         LR    @15,DARGSLOT                                        1337
         SLA   @15,3                                               1337
         STH   DARGSLOT,DARGINS-8(@15,@03)                         1337
*   DARGINL(DARGSLOT) = 4 ;                                        1338
         LA    @14,4                                               1338
         STH   @14,DARGINL-8(@15,@03)                              1338
* END ;                                                            1339
         AL    DARGSLOT,@CF00222                                   1339
         C     DARGSLOT,@CF00037                                   1339
         BNH   @DL01336                                            1339
* DARGINL(10) = 32 ;               /* FOR CHAR PART OF LINE          */
         L     @15,DDSTRU                                          1340
         MVC   DARGINL+72(2,@15),@CH00224                          1340
* DARGSENT = 8 ;                   /* STATIC TEXT ENTRY NBR          */
         MVI   DARGSENT(@15),X'08'                                 1341
* IOBFSPTR = IOCRBPTR ;                                            1342
         L     @15,IOCRBPTR                                        1342
         ST    @15,IOBFSPTR                                        1342
* SAVCRCI = IOBUFCI(BUFNO) ;       /* REMOVE BUFFER SEARCH           */
         SLR   @14,@14                                             1343
         IC    @14,BUFNO                                           1343
         SLA   @14,9                                               1343
         ST    @14,@TF00001                                        1343
         ALR   @14,@15                                             1343
         AL    @14,@CF01466                                        1343
         MVC   SAVCRCI(3),IOBUFCI-509(@14)                         1343
* SAVCTCI = IOCTBPTR -> IOBUFCI(BUFNO) ;       /* ARGUMENTS          */
         L     @14,IOCTBPTR                                        1344
         LR    @01,@14                                             1344
         AL    @01,@TF00001                                        1344
         AL    @01,@CF01466                                        1344
         MVC   SAVCTCI(3),IOBUFCI-509(@01)                         1344
* IOBUFCI(BUFNO) = 0 ;                                             1345
         SLR   @03,@03                                             1345
         AL    @15,@TF00001                                        1345
         AL    @15,@CF01466                                        1345
         STCM  @03,7,IOBUFCI-509(@15)                              1345
* IOCTBPTR -> IOBUFCI(BUFNO) = 0 ;                                 1346
*                                                                  1346
         AL    @14,@TF00001                                        1346
         AL    @14,@CF01466                                        1346
         STCM  @03,7,IOBUFCI-509(@14)                              1346
* /******************************************************************/
* /* LOOP: PRINT RECORD LINE BY LINE                                */
* /******************************************************************/
*                                                                  1347
* DO LINE = 1 TO RQDLINES ;                                        1347
         LA    @15,1                                               1347
         B     @DE01347                                            1347
@DL01347 DS    0H                                                  1348
*   LINEOFST = (LINE-1) * 32 ;                                     1348
         BCTR  @15,0                                               1348
         SLA   @15,5                                               1348
         STH   @15,LINEOFST                                        1348
*   IF LINE = 1                                                    1349
*     THEN                                                         1349
         CLI   LINE,1                                              1349
         BNE   @RF01349                                            1349
*       DO ;                       /* PRT CRA CI ON 1ST LINE         */
*         DARGINL(1) = LENGTH(CIFRGET) ;                           1351
         L     @15,DDSTRU                                          1351
         MVC   DARGINL(2,@15),@CH00166                             1351
*         DARGDTM(1) = ADDR(CIFRGET) ;                             1352
         LA    @14,CIFRGET                                         1352
         ST    @14,DARGDTM(,@15)                                   1352
*       END ;                                                      1353
*     ELSE                                                         1354
*       DO ;                       /* PRINT OFSET OTHER LINES        */
         B     @RC01349                                            1354
@RF01349 DS    0H                                                  1355
*         DARGINL(1) = LENGTH(LINEOFST) ;                          1355
         L     @15,DDSTRU                                          1355
         MVC   DARGINL(2,@15),@CH00158                             1355
*         DARGDTM(1) = ADDR(LINEOFST) ;                            1356
         LA    @14,LINEOFST                                        1356
         ST    @14,DARGDTM(,@15)                                   1356
*       END ;                                                      1357
*   INBFOFST = (LINE*8*4-3)+4-1 ;  /* ALIGN ON (END OF LINE          */
@RC01349 SLR   INBFOFST,INBFOFST                                   1358
         IC    INBFOFST,LINE                                       1358
         SLA   INBFOFST,5                                          1358
*                                  /* GROUP) + GROUP LENGTH          */
*   /*****************************************************************/
*   /* LOOP: THRU THE 8 GROUPS OF HEXIDECIMAL CHARACTERS ON          */
*   /*       EACH LINE SETTING THEM UP TO PRINT                      */
*   /*****************************************************************/
*                                                                  1359
*   DO GRPCOL = 8 TO 1 BY -1 ;                                     1359
         LA    GRPCOL,8                                            1359
@DL01359 DS    0H                                                  1360
*     INBFOFST = INBFOFST - 4 ;    /* SHIFT LEFT ONE GROUP           */
         LA    @15,4                                               1360
         SLR   INBFOFST,@15                                        1360
*     DARGINL(GRPCOL+1)=4;                                 /*@OZ05920*/
         L     @14,DDSTRU                                          1361
         LR    @01,GRPCOL                                          1361
         SLA   @01,3                                               1361
         STH   @15,DARGINL(@01,@14)                                1361
*     DARGDTM(GRPCOL+1) = ADDR(IOBUF(BUFNO)) + INBFOFST ;          1362
         SLR   @15,@15                                             1362
         IC    @15,BUFNO                                           1362
         SLA   @15,9                                               1362
         ST    @01,@TF00001                                        1362
         L     @01,IOBFSPTR                                        1362
         AL    @01,@CF01464                                        1362
         LA    @15,IOBUF(@15,@01)                                  1362
         ALR   @15,INBFOFST                                        1362
         L     @01,@TF00001                                        1362
         ST    @15,DARGDTM(@01,@14)                                1362
*   END ;                                                          1363
         BCTR  GRPCOL,0                                            1363
         C     GRPCOL,@CF00222                                     1363
         BNL   @DL01359                                            1363
*   DARGDTM(10) = DARGDTM(2) ;     /* FOR CHARACTER PART DUMP        */
*                                                                  1364
         L     @15,DDSTRU                                          1364
         L     @14,DARGDTM+8(,@15)                                 1364
         ST    @14,DARGDTM+72(,@15)                                1364
*   CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                        1365
*                                                                  1365
         L     @15,@PC00001                                        1365
         ST    @15,@AL00001                                        1365
         LA    @14,IOCSPRT                                         1365
         ST    @14,@AL00001+4                                      1365
         LA    @14,DDSTRU                                          1365
         ST    @14,@AL00001+8                                      1365
         MVI   @AL00001+8,X'80'                                    1365
         L     @15,GDTPRT(,@15)                                    1365
         LA    @01,@AL00001                                        1365
         BALR  @14,@15                                             1365
*   IF CMPRSW = ON & NOCATRSW ^= ON                                1366
*     THEN                                                         1366
*                                                                  1366
         TM    CMPRSW,B'01000000'                                  1366
         BNO   @RF01366                                            1366
         TM    NOCATRSW,B'00000010'                                1366
         BO    @RF01366                                            1366
*       CALL PRTDMPC ;             /* GO DO CAT & UNDERLINE          */
*                                                                  1367
         BAL   @14,PRTDMPC                                         1367
*   DARGSENT = 10 ;                                                1368
@RF01366 L     @01,DDSTRU                                          1368
         MVI   DARGSENT(@01),X'0A'                                 1368
* END ;                                                            1369
         LA    @15,1                                               1369
         SLR   @14,@14                                             1369
         IC    @14,LINE                                            1369
         ALR   @15,@14                                             1369
@DE01347 STC   @15,LINE                                            1369
         SLR   @14,@14                                             1369
         IC    @14,RQDLINES                                        1369
         CR    @15,@14                                             1369
         BNH   @DL01347                                            1369
* IOBUFCI(BUFNO) = SAVCRCI ;                                       1370
         SLR   @15,@15                                             1370
         IC    @15,BUFNO                                           1370
         SLA   @15,9                                               1370
         L     @01,IOBFSPTR                                        1370
         ALR   @01,@15                                             1370
         AL    @01,@CF01466                                        1370
         MVC   IOBUFCI-509(3,@01),SAVCRCI                          1370
* IOCTBPTR -> IOBUFCI(BUFNO) = SAVCTCI ;                           1371
*                                                                  1371
         L     @01,IOCTBPTR                                        1371
         ALR   @01,@15                                             1371
         AL    @01,@CF01466                                        1371
         MVC   IOBUFCI-509(3,@01),SAVCTCI                          1371
*END PRTDMP ;                                                      1372
@EL00022 DS    0H                                                  1372
@EF00022 DS    0H                                                  1372
@ER00022 LM    @14,@12,@SA00022                                    1372
         BR    @14                                                 1372
* /*******************************************************************/
* /* PROCEDURE NAME - PRTDMPC, PRINT DUMP CAT RCDS & CMPR LIN        */
* /* FUNCTION -                                                      */
* /*   PRINT 32 CHARACTERS OF CATALOG RECORD IN DUMP FORMAT          */
* /*   AND LINE UNDERNEATH OF UNDERSCORES OF MISCOMPARING            */
* /*   CHARACTERS                                                    */
* /* INPUTS -                                                        */
* /*   LINE (IDENTIFIES WHICH PRINT LINE (1 TO 16) TO PRINT          */
* /* OUTPUTS -                                                       */
* /*   CATALOG RECORDS AND UNDERSCORE LINES FOR PRTDMP               */
* /* CALLS -                                                         */
* /*   UPRINT                                                        */
* /*******************************************************************/
*                                                                  1373
*PRTDMPC: PROCEDURE ;                                              1373
PRTDMPC  STM   @14,@12,@SA00023                                    1373
* OLDERID2 = NEWERID2;                                             1374
         L     @04,@PC00001                                        1374
         L     @15,GDTTR2(,@04)                                    1374
         MVC   @TS00001(95),NEWERID2(@15)                          1374
         MVC   OLDERID2(95,@15),@TS00001                           1374
* NEWID2 = 'LRPE' ;                                                1375
         MVC   NEWID2(4,@15),@CC01349                              1375
* IF GDTDBG = NULLPTR                                              1376
*   THEN;                                                          1376
         L     @04,GDTDBG(,@04)                                    1376
         LTR   @04,@04                                             1376
         BZ    @RT01376                                            1376
*   ELSE                                                           1378
*     CALL IDCDB010 (GDTTBL,'LRPE') ;                              1378
         L     @04,@PC00001                                        1378
         ST    @04,@AL00001                                        1378
         LA    @15,@CC01349                                        1378
         ST    @15,@AL00001+4                                      1378
         MVI   @AL00001+4,X'80'                                    1378
         L     @15,GDTDBG(,@04)                                    1378
         LA    @01,@AL00001                                        1378
         BALR  @14,@15                                             1378
* DARGSENT = 9 ;                   /* STATIC TEXT ENTRY NBR          */
@RT01376 L     @04,DDSTRU                                          1379
         MVI   DARGSENT(@04),X'09'                                 1379
* IOBFSPTR = IOCTBPTR ;                                            1380
         L     @04,IOCTBPTR                                        1380
         ST    @04,IOBFSPTR                                        1380
* MCMPRMRK = ' ' ;                 /* CLEAR LEFT MARGIN MARK         */
         MVI   MCMPRMRK,C' '                                       1381
* DO GRPCOL = 1 TO 8 ;             /* AND ALL UNDERLINES             */
         LA    GRPCOL,1                                            1382
@DL01382 DS    0H                                                  1383
*   MCMPRARY(GRPCOL) = '        ' ;                                1383
         LR    @04,GRPCOL                                          1383
         SLA   @04,3                                               1383
         LA    @03,MCMPRARY-8(@04)                                 1383
         MVC   0(8,@03),@CC01350                                   1383
* END ;                                                            1384
         AL    GRPCOL,@CF00222                                     1384
         C     GRPCOL,@CF00039                                     1384
         BNH   @DL01382                                            1384
* IF LINE = 1                                                      1385
*   THEN                                                           1385
         CLI   LINE,1                                              1385
         BNE   @RF01385                                            1385
*     DO ;                         /* IDENTIFY CATALOG RECORD        */
*       DARGINL(1) = LENGTH(NCATRCD) ;                             1387
         L     @04,DDSTRU                                          1387
         MVC   DARGINL(2,@04),@CH00041                             1387
*       DARGDTM(1) = ADDR(NCATRCD) ;                               1388
         LA    @15,NCATRCD                                         1388
         ST    @15,DARGDTM(,@04)                                   1388
*     END ;                                                        1389
*   ELSE                                                           1390
*     DO ;                                                         1390
         B     @RC01385                                            1390
@RF01385 DS    0H                                                  1391
*       DARGINL(1) = LENGTH(LINEOFST) ;                            1391
         L     @04,DDSTRU                                          1391
         MVC   DARGINL(2,@04),@CH00158                             1391
*       DARGDTM(1) = ADDR(BLANKS6) ;                               1392
         LA    @15,BLANKS6                                         1392
         ST    @15,DARGDTM(,@04)                                   1392
*     END ;                                                        1393
* INBFOFST = (LINE*8*4-4)+4 ;      /* ALIGN ON (END OF LINE          */
@RC01385 SLR   INBFOFST,INBFOFST                                   1394
         IC    INBFOFST,LINE                                       1394
         SLA   INBFOFST,5                                          1394
*                                  /* GROUP) + GROUP LENGTH          */
*                                                                  1395
* /*******************************************************************/
* /* LOOP: THRU THE 8 GROUPS OF HEXIDECIMAL CHARACTERS ON            */
* /*       EACH LINE SETTING THEM UP TO PRINT                        */
* /*******************************************************************/
*                                                                  1395
* DO GRPCOL = 8 TO 1 BY -1 ;                                       1395
         LA    GRPCOL,8                                            1395
@DL01395 DS    0H                                                  1396
*   INBFOFST = INBFOFST - 4 ;      /* SHIFT LEFT 1 GROUP             */
         SL    INBFOFST,@CF00047                                   1396
*   DARGDTM(GRPCOL+1) = ADDR(IOBUF(BUFNO)) + INBFOFST ;            1397
*                                                                  1397
         LR    @04,GRPCOL                                          1397
         SLA   @04,3                                               1397
         SLR   @15,@15                                             1397
         IC    @15,BUFNO                                           1397
         SLA   @15,9                                               1397
         L     @01,IOBFSPTR                                        1397
         AL    @01,@CF01464                                        1397
         LA    @15,IOBUF(@15,@01)                                  1397
         ALR   @15,INBFOFST                                        1397
         L     @14,DDSTRU                                          1397
         ST    @15,DARGDTM(@04,@14)                                1397
*   /*****************************************************************/
*   /* LOOP: CHECK THE 4 CHARACTERS IN EACH GROUP ONE BY ONE         */
*   /*       FOR ANY MISCOMPARES                                     */
*   /*****************************************************************/
*                                                                  1398
*   DO CMPRCOL = 0 TO 3 ;                                          1398
         SLR   CMPRCOL,CMPRCOL                                     1398
@DL01398 DS    0H                                                  1399
*     MCBFOFST = INBFOFST + CMPRCOL + 1 ; /* USE AS SUBSCRIPT        */
         LR    @15,INBFOFST                                        1399
         ALR   @15,CMPRCOL                                         1399
         LA    @15,1(,@15)                                         1399
         STC   @15,MCBFOFST                                        1399
*     IF IOCRBPTR -> IOBUF(BUFNO,MCBFOFST) ^=                      1400
*                    IOBUF(BUFNO,MCBFOFST)                         1400
*       THEN                                                       1400
         SLR   @14,@14                                             1400
         IC    @14,BUFNO                                           1400
         SLA   @14,9                                               1400
         ALR   @14,@15                                             1400
         L     @01,IOCRBPTR                                        1400
         ALR   @01,@14                                             1400
         AL    @01,@CF01492                                        1400
         L     @15,IOBFSPTR                                        1400
         ALR   @15,@14                                             1400
         AL    @15,@CF01492                                        1400
         CLC   IOBUF(1,@01),IOBUF(@15)                             1400
         BE    @RF01400                                            1400
*         DO ;                                                     1401
*           MCMPRARY(GRPCOL,CMPRCOL*2+1:CMPRCOL*2+2) = '**' ;      1402
         LR    @15,GRPCOL                                          1402
         SLA   @15,3                                               1402
         LR    @14,CMPRCOL                                         1402
         ALR   @14,@14                                             1402
         ALR   @15,@14                                             1402
         LA    @14,MCMPRARY-8(@15)                                 1402
         MVC   0(2,@14),@CC01351                                   1402
*           MCMPRMRK = '*' ;                                       1403
         MVI   MCMPRMRK,C'*'                                       1403
*         END ;                                                    1404
*   END ;                                                          1405
@RF01400 AL    CMPRCOL,@CF00222                                    1405
         C     CMPRCOL,@CF00166                                    1405
         BNH   @DL01398                                            1405
* END ;                                                            1406
         BCTR  GRPCOL,0                                            1406
         C     GRPCOL,@CF00222                                     1406
         BNL   @DL01395                                            1406
* DARGDTM(10) = DARGDTM(2) ;       /* FOR THE CHARACTER PART         */
         L     @04,DDSTRU                                          1407
         L     @15,DARGDTM+8(,@04)                                 1407
         ST    @15,DARGDTM+72(,@04)                                1407
*                                  /* OF THE DUMP FORMAT             */
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1408
*                                                                  1408
         L     @04,@PC00001                                        1408
         ST    @04,@AL00001                                        1408
         LA    @15,IOCSPRT                                         1408
         ST    @15,@AL00001+4                                      1408
         LA    @15,DDSTRU                                          1408
         ST    @15,@AL00001+8                                      1408
         MVI   @AL00001+8,X'80'                                    1408
         L     @15,GDTPRT(,@04)                                    1408
         LA    @01,@AL00001                                        1408
         BALR  @14,@15                                             1408
* DARGCNT = 9 ;                                                    1409
         L     @04,DDSTRU                                          1409
         MVC   DARGCNT(2,@04),@CH00038                             1409
* DARGSENT = 11 ;                                                  1410
         MVI   DARGSENT(@04),X'0B'                                 1410
* DARGINL(1) = LENGTH(MCMPRMRK) ;                                  1411
         LA    @15,1                                               1411
         STH   @15,DARGINL(,@04)                                   1411
* DARGDTM(1) = ADDR(MCMPRMRK) ;                                    1412
         LA    @14,MCMPRMRK                                        1412
         ST    @14,DARGDTM(,@04)                                   1412
* DO GRPCOL = 1 TO 8 ;             /* SET UP UNDERLINES TO           */
         LR    GRPCOL,@15                                          1413
@DL01413 DS    0H                                                  1414
*   DARGINL(GRPCOL+1) = 8 ;        /* PRINT OUT                      */
         L     @04,DDSTRU                                          1414
         LR    @03,GRPCOL                                          1414
         SLA   @03,3                                               1414
         LA    @15,8                                               1414
         STH   @15,DARGINL(@03,@04)                                1414
*   DARGDTM(GRPCOL+1) = ADDR(MCMPRARY(GRPCOL)) ;                   1415
         LA    @15,MCMPRARY-8(@03)                                 1415
         ST    @15,DARGDTM(@03,@04)                                1415
* END ;                                                            1416
*                                                                  1416
         AL    GRPCOL,@CF00222                                     1416
         C     GRPCOL,@CF00039                                     1416
         BNH   @DL01413                                            1416
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1417
*                                                                  1417
         L     @04,@PC00001                                        1417
         ST    @04,@AL00001                                        1417
         LA    @15,IOCSPRT                                         1417
         ST    @15,@AL00001+4                                      1417
         LA    @15,DDSTRU                                          1417
         ST    @15,@AL00001+8                                      1417
         MVI   @AL00001+8,X'80'                                    1417
         L     @15,GDTPRT(,@04)                                    1417
         LA    @01,@AL00001                                        1417
         BALR  @14,@15                                             1417
* DARGCNT = 10 ;                                                   1418
         L     @04,DDSTRU                                          1418
         MVC   DARGCNT(2,@04),@CH00037                             1418
* IOBFSPTR = IOCRBPTR ;            /* RESTORE TO ASSUMED VALU        */
*                                                                  1419
         L     @04,IOCRBPTR                                        1419
         ST    @04,IOBFSPTR                                        1419
*END PRTDMPC ;                                                     1420
@EL00023 DS    0H                                                  1420
@EF00023 DS    0H                                                  1420
@ER00023 LM    @14,@12,@SA00023                                    1420
         BR    @14                                                 1420
* /*******************************************************************/
* /* PROCEDURE NAME - PRTFIFO, PRINT CRA FIRST IN FIRST OUT          */
* /* FUNCTION -                                                      */
* /*   LOOP THRU CTT,                                                */
* /*     IF DUMP START AT CI = 0 AND INCLUDE FREESPACE RCDS,         */
* /*     IF NAMES START AT CI = 9 AND SKIP FREESPACE RECORDS,        */
* /*     IF RECORD NOT ALREADY PROCESSED GET THE RECORD              */
* /*     AND PRINT IT AND ITS STRUCTURE AS SPECIFIED                 */
* /* INPUTS -                                                        */
* /*   CTT (ALREADY PROCESSED RECORDS (IF ANY) MARKED)               */
* /* OUTPUTS -                                                       */
* /*   LIST OF CRA RECORDS AND THEIR STRUCTURES IN THE ORDER         */
* /*   THEY OCCUR IN IN THE CRA BYPASSING ALREADY PRINTED            */
* /* CALLS -                                                         */
* /*   UREST, GETPRT, PRTVSAM, PRTOTHR, SUMIT                        */
* /*******************************************************************/
*                                                                  1421
*PRTFIFO: PROCEDURE ;                                              1421
PRTFIFO  STM   @14,@12,@SA00024                                    1421
*   OLDERID2 = NEWERID2;                                           1422
         L     @15,@PC00001                                        1422
         L     @14,GDTTR2(,@15)                                    1422
         MVC   @TS00001(95),NEWERID2(@14)                          1422
         MVC   OLDERID2(95,@14),@TS00001                           1422
*   NEWID2 = 'LRPF' ;                                              1423
         MVC   NEWID2(4,@14),@CC01356                              1423
*   IF GDTDBG = NULLPTR                                            1424
*     THEN;                                                        1424
         L     @15,GDTDBG(,@15)                                    1424
         LTR   @15,@15                                             1424
         BZ    @RT01424                                            1424
*     ELSE                                                         1426
*       CALL IDCDB010 (GDTTBL,'LRPF') ;                            1426
         L     @15,@PC00001                                        1426
         ST    @15,@AL00001                                        1426
         LA    @14,@CC01356                                        1426
         ST    @14,@AL00001+4                                      1426
         MVI   @AL00001+4,X'80'                                    1426
         L     @15,GDTDBG(,@15)                                    1426
         LA    @01,@AL00001                                        1426
         BALR  @14,@15                                             1426
*   SUBGROUP = 'UNSORTED ENTRIES' ;     /* RESET PAGE HEADER         */
@RT01424 MVC   SUBGROUP(16),@CC01357                               1427
*   IF GDTECT = NULLPTR                 /* IF NOT RUNNING UNDER TSO  */
*                                                                  1428
*     THEN CALL AMSTP043 (GDTTBL,IOCSPRT,PCRST) ;                  1428
*                                                                  1428
         L     @15,@PC00001                                        1428
         L     @14,GDTECT(,@15)                                    1428
         LTR   @14,@14                                             1428
         BNZ   @RF01428                                            1428
         ST    @15,@AL00001                                        1429
         LA    @14,IOCSPRT                                         1429
         ST    @14,@AL00001+4                                      1429
         LA    @14,PCRST                                           1429
         ST    @14,@AL00001+8                                      1429
         MVI   @AL00001+8,X'80'                                    1429
         L     @15,GDTRST(,@15)                                    1429
         LA    @01,@AL00001                                        1429
         BALR  @14,@15                                             1429
*   INDNTCOL = 0 ;                                                 1430
@RF01428 MVI   INDNTCOL,X'00'                                      1430
*    PRNTPASW = ON ;                                               1431
         OI    PRNTPASW,B'10000000'                                1431
*   IF DUMPSW = ON & CMPRSW = OFF                                  1432
*     THEN                                                         1432
         TM    DUMPSW,B'00000100'                                  1432
         BNO   @RF01432                                            1432
         TM    CMPRSW,B'01000000'                                  1432
         BNZ   @RF01432                                            1432
*       DO CTLOOP = 0 TO CTTBASE ; /* UNDER THESE CONDITIONS         */
         SLR   CTLOOP,CTLOOP                                       1433
@DL01433 DS    0H                                                  1434
*         CIFRGET = CTLOOP ;                                       1434
*                                                                  1434
         STCM  CTLOOP,7,CIFRGET                                    1434
*         CALL GETPRT ;            /* GET,PRINT SELF DESCRIBN        */
*                                                                  1435
         BAL   @14,GETPRT                                          1435
*       END ;                                                      1436
*                                                                  1436
         AL    CTLOOP,@CF00222                                     1436
         C     CTLOOP,@CF00039                                     1436
         BNH   @DL01433                                            1436
*   STPTR = ADDR(STDUMMY) ;        /* SET UP DUMMY SORTTBL           */
@RF01432 LA    @02,STDUMMY                                         1437
         ST    @02,STPTR                                           1437
*   STSLOT = 1 ;                   /* FOR LOWER LEVEL SEGMNTS        */
*                                                                  1438
         LA    @15,1                                               1438
         LR    STSLOT,@15                                          1438
*   /*****************************************************************/
*   /* LOOP: MAKING A LAST PASS THRU THE CTT FOR UNPRINTED           */
*   /*****************************************************************/
*                                                                  1439
*   DO CTTSLOT = 1 TO CTTENTNO ;                                   1439
         B     @DE01439                                            1439
@DL01439 DS    0H                                                  1440
*     ENTYP = CTTENTYP(CTTSLOT) ;                                  1440
         L     @02,CTTPTR                                          1440
         SLA   @15,3                                               1440
         ST    @15,@TF00001                                        1440
         ALR   @15,@02                                             1440
         AL    @15,@CF01476                                        1440
         MVC   ENTYP(1),CTTENTYP-4(@15)                            1440
*     IF    CTTPRTD(CTTSLOT) = ON       /* BYPASS IF ALREADY         */
*        × CMPRSW = ON                  /* PRNTED, COMPARE OR        */
*        × (DUMPSW ^= ON                /* DUMP SPECIFIED AND        */
*        & (ENTYP = CATRCTYP($FRSP)     /* FREESPACE OR EXTN         */
*          × ENTYP = CATRCTYP($OEXT)    /* RECORDS (NOT EVER         */
*          × ENTYP = CATRCTYP($VEXT)))  /* MARKED AS PRINTED)        */
*       THEN ;                                                     1441
         AL    @02,@TF00001                                        1441
         TM    CTTPRTD-8(@02),B'10000000'                          1441
         BO    @RT01441                                            1441
         TM    CMPRSW,B'01000000'                                  1441
         BO    @RT01441                                            1441
         TM    DUMPSW,B'00000100'                                  1441
         BO    @RF01441                                            1441
         LA    @02,5                                               1441
         SLR   @01,@01                                             1441
         IC    @01,$FRSP                                           1441
         MR    @00,@02                                             1441
         LA    @15,CATRCTYP-5(@01)                                 1441
         CLC   ENTYP(1),0(@15)                                     1441
         BE    @RT01441                                            1441
         SLR   @01,@01                                             1441
         IC    @01,$OEXT                                           1441
         MR    @00,@02                                             1441
         LA    @15,CATRCTYP-5(@01)                                 1441
         CLC   ENTYP(1),0(@15)                                     1441
         BE    @RT01441                                            1441
         LR    @01,@02                                             1441
         SLR   @02,@02                                             1441
         IC    @02,$VEXT                                           1441
         MR    @00,@02                                             1441
         LA    @02,CATRCTYP-5(@01)                                 1441
         CLC   ENTYP(1),0(@02)                                     1441
         BE    @RT01441                                            1441
*       ELSE                                                       1443
*         DO ;                                                     1443
@RF01441 DS    0H                                                  1444
*           IF     ENTYP ^= CATRCTYP($VEXT)                        1444
*              & ENTYP ^= CATRCTYP($OEXT)                          1444
*                                                                  1444
*             THEN CALL SUMIT (SMACCUM,ENTYP) ;                    1444
*                                                                  1444
         LA    @02,5                                               1444
         SLR   @01,@01                                             1444
         IC    @01,$VEXT                                           1444
         MR    @00,@02                                             1444
         LA    @15,CATRCTYP-5(@01)                                 1444
         CLC   ENTYP(1),0(@15)                                     1444
         BE    @RF01444                                            1444
         LR    @01,@02                                             1444
         SLR   @02,@02                                             1444
         IC    @02,$OEXT                                           1444
         MR    @00,@02                                             1444
         LA    @02,CATRCTYP-5(@01)                                 1444
         CLC   ENTYP(1),0(@02)                                     1444
         BE    @RF01444                                            1444
         LA    @02,SMACCUM                                         1445
         ST    @02,@AL00001                                        1445
         LA    @02,ENTYP                                           1445
         ST    @02,@AL00001+4                                      1445
         LA    @01,@AL00001                                        1445
         BAL   @14,SUMIT                                           1445
*           STENTYP(1) = ENTYP ;                                   1446
@RF01444 L     @02,STPTR                                           1446
         MVC   STENTYP(1,@02),ENTYP                                1446
*           STCRACI(1) = CTTSLOT + CTTBASE ;                       1447
         LA    @15,8                                               1447
         LH    @14,CTTSLOT                                         1447
         N     @14,@CF01475                                        1447
         ALR   @15,@14                                             1447
         STCM  @15,7,STCRACI(@02)                                  1447
*           IF    ENTYP = CATRCTYP($CLUS)                          1448
*              × ENTYP = CATRCTYP($AIX)                            1448
*             THEN                                                 1448
*                                                                  1448
         LA    @02,5                                               1448
         SLR   @01,@01                                             1448
         IC    @01,$CLUS                                           1448
         MR    @00,@02                                             1448
         LA    @15,CATRCTYP-5(@01)                                 1448
         CLC   ENTYP(1),0(@15)                                     1448
         BE    @RT01448                                            1448
         LR    @01,@02                                             1448
         SLR   @02,@02                                             1448
         IC    @02,$AIX                                            1448
         MR    @00,@02                                             1448
         LA    @02,CATRCTYP-5(@01)                                 1448
         CLC   ENTYP(1),0(@02)                                     1448
         BNE   @RF01448                                            1448
@RT01448 DS    0H                                                  1449
*               CALL PRTVSAM ;     /* PRINT VSAM STRUCTURE           */
*                                                                  1449
         BAL   @14,PRTVSAM                                         1449
*             ELSE                                                 1450
*               IF    ENTYP = CATRCTYP($NONV)                      1450
*                  × ENTYP = CATRCTYP($GDGB)                       1450
*                  × ENTYP = CATRCTYP($UCAT)                       1450
*                 THEN                                             1450
*                                                                  1450
         B     @RC01448                                            1450
@RF01448 LA    @02,5                                               1450
         SLR   @01,@01                                             1450
         IC    @01,$NONV                                           1450
         MR    @00,@02                                             1450
         LA    @15,CATRCTYP-5(@01)                                 1450
         CLC   ENTYP(1),0(@15)                                     1450
         BE    @RT01450                                            1450
         SLR   @01,@01                                             1450
         IC    @01,$GDGB                                           1450
         MR    @00,@02                                             1450
         LA    @15,CATRCTYP-5(@01)                                 1450
         CLC   ENTYP(1),0(@15)                                     1450
         BE    @RT01450                                            1450
         LR    @01,@02                                             1450
         SLR   @02,@02                                             1450
         IC    @02,$UCAT                                           1450
         MR    @00,@02                                             1450
         LA    @02,CATRCTYP-5(@01)                                 1450
         CLC   ENTYP(1),0(@02)                                     1450
         BNE   @RF01450                                            1450
@RT01450 DS    0H                                                  1451
*                   CALL PRTOTHR ; /* PRINT OTHER STRUCTURE          */
*                                                                  1451
         BAL   @14,PRTOTHR                                         1451
*                 ELSE                                             1452
*                   DO ;                                           1452
         B     @RC01450                                            1452
@RF01450 DS    0H                                                  1453
*                      PRNTPASW = ON ;                             1453
         OI    PRNTPASW,B'10000000'                                1453
*                     CIFRGET = CTTSLOT + CTTBASE ;                1454
         LH    @02,CTTSLOT                                         1454
         N     @02,@CF01475                                        1454
         LA    @02,8(,@02)                                         1454
         STCM  @02,7,CIFRGET                                       1454
*                     IF ENTYP = CATRCTYP($FRSP)                   1455
*                       THEN FMUFRSP = ON ;  /* FREESPACE RCD        */
*                                                                  1455
         SLR   @02,@02                                             1455
         IC    @02,$FRSP                                           1455
         MH    @02,@CH00042                                        1455
         LA    @01,CATRCTYP-5(@02)                                 1455
         CLC   ENTYP(1),0(@01)                                     1455
         BNE   @RF01455                                            1455
         OI    FMUFRSP,B'00100000'                                 1456
*                     CALL GETPRT; /* PRINT ANY OTHER RECORD         */
*                                                                  1457
@RF01455 BAL   @14,GETPRT                                          1457
*                     FMUFRSP = OFF ;                              1458
         NI    FMUFRSP,B'11011111'                                 1458
*                   END ;                                          1459
*                   /*************************************************/
*                   /* NOTE: MAY CAUSE A DUPLICATE PRINT OF          */
*                   /* A RECORD IF CATALOG STRUCTURES ARE            */
*                   /* NOT IN ASCENDING CIS                          */
*                   /*************************************************/
*         END ;                                                    1460
@RC01450 DS    0H                                                  1460
@RC01448 DS    0H                                                  1461
*   END ;                                                          1461
*                                                                  1461
@RT01441 LA    @15,1                                               1461
         LH    @02,CTTSLOT                                         1461
         N     @02,@CF01475                                        1461
         ALR   @15,@02                                             1461
@DE01439 STH   @15,CTTSLOT                                         1461
         L     @02,CTTPTR                                          1461
         C     @15,CTTENTNO(,@02)                                  1461
         BNH   @DL01439                                            1461
*END PRTFIFO ;                                                     1462
@EL00024 DS    0H                                                  1462
@EF00024 DS    0H                                                  1462
@ER00024 LM    @14,@12,@SA00024                                    1462
         BR    @14                                                 1462
* /*******************************************************************/
* /* PROCEDURE NAME - PRTMCWD, PRINT MISCOMPARE WORDS                */
* /* FUNCTION -                                                      */
* /*   INITIALIZE 'MISCOMPARE -' MESSAGE TO 'OTHER',                 */
* /*   PASS THRU MCARGTBL COMPARING CRA (AND OPTIONALLY              */
* /*   CATALOG) FIELDS NAMED IN THIS TABLE,                          */
* /*   AT THE FIRST MISCOMPARE OVERLAY ERROR MESSAGE                 */
* /*   SEVERITY WORDS USING POINTER FOR GROUP FROM MCMSGTBL,         */
* /*   PRINT THE 'MISCOMPARE- XXXXXXXXXXXXX' MESSAGE                 */
* /* INPUTS -                                                        */
* /*   PARAMETER OF NUMBER OF GROUPS TO COMPARE IN MCARGTBL          */
* /*   (IF ZERO PRINT ONLY 'OTHER')                                  */
* /*   3 TABLE ADDRESSES - ARGUMENT GROUPS, MSGPTRS, MSGLENS         */
* /*   RECORD THAT MESSAGE IS DESIRED FOR -> BY CIFRGET              */
* /*   (USE CI OBTAINED THRU CTT TO GET CATALOG RECORD)              */
* /*   CRA                                                           */
* /*   CATALOG                                                       */
* /* OUTPUTS -                                                       */
* /*   MSCMPRSW TURNED OFF                                           */
* /*   MISCOMPARE - XXXXX  ERROR MESSAGE                             */
* /* CALLS -                                                         */
* /*   UGET, UPRINT,                                                 */
* /*   IDCRC04(SEE MCARGTBL IN DCLS2 SEGMENT, AND REPNO)             */
* /*   ERROR                                                 @OZ09388*/
* /*******************************************************************/
*                                                                  1463
*PRTMCWD: PROCEDURE (NBR2CMP,ARGTBL,MSGTBL,MSGLNTBL) ;             1463
PRTMCWD  STM   @14,@12,@SA00025                                    1463
         MVC   @PC00025(16),0(@01)                                 1463
* OLDERID2 = NEWERID2;                                             1464
         L     @15,@PC00001                                        1464
         L     @14,GDTTR2(,@15)                                    1464
         MVC   @TS00001(95),NEWERID2(@14)                          1464
         MVC   OLDERID2(95,@14),@TS00001                           1464
* NEWID2 = 'LRPM' ;                                                1465
         MVC   NEWID2(4,@14),@CC01371                              1465
* IF GDTDBG = NULLPTR                                              1466
*   THEN;                                                          1466
         L     @15,GDTDBG(,@15)                                    1466
         LTR   @15,@15                                             1466
         BZ    @RT01466                                            1466
*   ELSE                                                           1468
*     CALL IDCDB010 (GDTTBL,'LRPM') ;                              1468
*                                                                  1468
         L     @15,@PC00001                                        1468
         ST    @15,@AL00001                                        1468
         LA    @14,@CC01371                                        1468
         ST    @14,@AL00001+4                                      1468
         MVI   @AL00001+4,X'80'                                    1468
         L     @15,GDTDBG(,@15)                                    1468
         LA    @01,@AL00001                                        1468
         BALR  @14,@15                                             1468
* DCL                                                              1469
*   GRPS2CMP        FIXED(31),     /* GROUPS TO CMPR NUMBER          */
*   NBR2CMP         FIXED(31),                                     1469
*   1 ARGTBL  (*)   CHAR(10),                                      1469
*     2 ARGNAME     CHAR(8),       /* SEE MCARGTBL AND ASOC          */
*     2 ARGGRP      FIXED(8),      /* TABLE DECLARATIONS             */
*     2 ARGCTGRP    FIXED(8),                                      1469
*   MSGTBL    (*)   PTR(31),                                       1469
*   MSGLNTBL  (*)   FIXED(8),                                      1469
* ENDCLSPM CHAR(1) ;                                               1469
*                                                                  1469
@RT01466 DS    0H                                                  1470
* GRPS2CMP = NBR2CMP ;                                             1470
         L     @02,@PC00025                                        1470
         L     @02,NBR2CMP(,@02)                                   1470
         ST    @02,GRPS2CMP                                        1470
* MCMSG = 'OTHER' ;                /* INITIALLY = 'OTHER'            */
         MVI   MCMSG+5,C' '                                        1471
         MVC   MCMSG+6(42),MCMSG+5                                 1471
         MVC   MCMSG(5),@CC01377                                   1471
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;                           1472
         L     @02,CIFRGET-1                                       1472
         LA    @02,0(,@02)                                         1472
         SLA   @02,3                                               1472
         L     @01,FMPLAD                                          1472
         L     @15,CTTPTR                                          1472
         ALR   @15,@02                                             1472
         AL    @15,@CF01478                                        1472
         MVC   FMPLBCIN(3,@01),CTTCATCI-5(@15)                     1472
* ARGSLOT = 1 ;                                                    1473
*                                                                  1473
         LA    ARGSLOT,1                                           1473
* /*******************************************************************/
* /* LOOP: COMPARE AS MANY GROUPS OF FIELDS AS REQUESTED             */
* /*******************************************************************/
*                                                                  1474
* DO WHILE (GRPS2CMP >= ARGGRP(ARGSLOT)                            1474
*       & ARGNAME(ARGSLOT) ^= '$$$$$$$$') ;                        1474
         B     @DE01474                                            1474
@DL01474 DS    0H                                                  1475
*   RELREPNO = 0 ;                                                 1475
         SLR   @02,@02                                             1475
         STH   @02,RELREPNO                                        1475
*   CNTREPNO = 1 ;                                                 1476
         MVC   CNTREPNO(2),@CH00222                                1476
*   IF ARGCTGRP(ARGSLOT) ^= 0      /* IF REPEATING GROUPS            */
*     THEN                         /* FIND OUT HOW MANY OCCUR        */
         LR    @15,ARGSLOT                                         1477
         MH    @15,@CH00037                                        1477
         L     @14,@PC00025+4                                      1477
         BCTR  @14,0                                               1477
         SLR   @01,@01                                             1477
         IC    @01,ARGCTGRP-9(@15,@14)                             1477
         CR    @01,@02                                             1477
         BE    @RF01477                                            1477
*       DO ;                       /* IN THE CATALOG RECORD          */
*         FMFLDNAM = ADDR('REPNO   ') ;                            1479
         LA    @02,@CC01204                                        1479
         ST    @02,FMFLDNAM(,FMFLCUR)                              1479
*         FMFLGRPC = ARGCTGRP(ARGSLOT) ;                           1480
         STC   @01,FMFLGRPC(,FMFLCUR)                              1480
*         FMPLFMFL(NBRFMFL) -> FMFLGRPC = ARGCTGRP(ARGSLOT) ;      1481
         L     @02,FMPLAD                                          1481
         L     @15,FMPLFMFL+16(,@02)                               1481
         STC   @01,FMFLGRPC(,@15)                                  1481
*         FMPLFMFL(NBRFMFL-1) -> FMFLGRPC = ARGCTGRP(ARGSLOT) ;    1482
         L     @15,FMPLFMFL+12(,@02)                               1482
         STC   @01,FMFLGRPC(,@15)                                  1482
*         REG1 = FMPLAD ;                                          1483
*                                                                  1483
         LR    REG1,@02                                            1483
*         CALL IDCRC04 ;           /* GET NBR OF REPETITIONS         */
*                                                                  1484
         L     @15,@CV00793                                        1484
         BALR  @14,@15                                             1484
*         IF FMFLENTH ^= 0                                         1485
*           THEN                                                   1485
         L     @02,FMFLENTH(,FMFLCUR)                              1485
         LTR   @02,@02                                             1485
         BZ    @RF01485                                            1485
*             DO ;                                                 1486
*               NBRMCFMC = REPNO ;                                 1487
         L     @02,FMFLADDR(,FMFLCUR)                              1487
         LH    @02,REPNO(,@02)                                     1487
         STH   @02,NBRMCFMC                                        1487
*               FMFLTCHN = ADDR(FMFLST(NBRFMFL)) ; /*1ATATIME        */
         LA    @02,FMFLST+96                                       1488
         ST    @02,FMFLTCHN(,FMFLCUR)                              1488
*             END ;                                                1489
*           ELSE NBRMCFMC = 1 ;    /* TRY ONE CALL ANYWAY            */
         B     @RC01485                                            1490
@RF01485 MVC   NBRMCFMC(2),@CH00222                                1490
*       END ;                                                      1491
*     ELSE NBRMCFMC = 1 ;          /* CALL FIELD MGMT ONCE           */
         B     @RC01477                                            1492
@RF01477 MVC   NBRMCFMC(2),@CH00222                                1492
*   FMFLDNAM = ADDR(ARGNAME(ARGSLOT)) ;                            1493
*                                                                  1493
@RC01477 LR    @02,ARGSLOT                                         1493
         MH    @02,@CH00037                                        1493
         L     @15,@PC00025+4                                      1493
         AL    @15,@CF01493                                        1493
         LA    @02,ARGNAME(@02,@15)                                1493
         ST    @02,FMFLDNAM(,FMFLCUR)                              1493
*   /*****************************************************************/
*   /* LOOP: COMPARE ALL THE FIELDS IN THIS GROUP                    */
*   /*****************************************************************/
*                                                                  1494
*   DO WHILE (RELREPNO < NBRMCFMC) ;                               1494
         B     @DE01494                                            1494
@DL01494 DS    0H                                                  1495
*     FMPLOAR = ADDR(MCWA) ;       /* CRA FIELD COMPARE AREA         */
         L     @02,FMPLAD                                          1495
         LA    @15,MCWA                                            1495
         ST    @15,FMPLOAR(,@02)                                   1495
*     REG1 = FMPLAD ;                                              1496
*                                                                  1496
         LR    REG1,@02                                            1496
*     CALL IDCRC04 ;               /* ASK FOR FIELD FROM CRA         */
*                                                                  1497
         L     @15,@CV00793                                        1497
         BALR  @14,@15                                             1497
*     FMPLOAR = ADDR(FMWA) ;       /* NORMAL FM BUFFER (CAT)         */
         L     @02,FMPLAD                                          1498
         LA    @15,FMWA                                            1498
         ST    @15,FMPLOAR(,@02)                                   1498
*     IF FMPLRTCD = 0                                              1499
*       THEN                                                       1499
         CLI   FMPLRTCD(@02),0                                     1499
         BNE   @RF01499                                            1499
*         DO ;                     /* SAVE RETURNS FROM CRA          */
*           CRAFLDLN = FMFLENTH(1) ;                               1501
         L     @15,FMFLENTH(,FMFLCUR)                              1501
         ST    @15,CRAFLDLN                                        1501
*           CRAFMRTC = FMPLRTCD ;                                  1502
         IC    @15,FMPLRTCD(,@02)                                  1502
         STC   @15,CRAFMRTC                                        1502
*           FMUBFPTR = IOCTBPTR ;                                  1503
         L     @15,IOCTBPTR                                        1503
         ST    @15,FMUBFPTR                                        1503
*           FMUIOCSI = IOCSCAT ;                                   1504
         L     @15,IOCSCAT                                         1504
         ST    @15,FMUIOCSI                                        1504
*           FMUCATIO = ON ;                                        1505
         OI    FMUCATIO,B'01000000'                                1505
*           REG1 = FMPLAD ;                                        1506
*                                                                  1506
         LR    REG1,@02                                            1506
*           CALL IDCRC04 ;         /* ASK FOR FIELDS FROM CAT        */
*                                                                  1507
         L     @15,@CV00793                                        1507
         BALR  @14,@15                                             1507
*           FMUBFPTR = IOCRBPTR ;                                  1508
         L     @02,IOCRBPTR                                        1508
         ST    @02,FMUBFPTR                                        1508
*           FMUIOCSI = IOCSCRA ;                                   1509
         L     @02,IOCSCRA                                         1509
         ST    @02,FMUIOCSI                                        1509
*           FMUCATIO = OFF ;                                       1510
         NI    FMUCATIO,B'10111111'                                1510
*           CATFLDLN = FMFLENTH(1) ;                               1511
         L     @02,FMFLENTH(,FMFLCUR)                              1511
         ST    @02,CATFLDLN                                        1511
*           IF    FMPLRTCD ^= CRAFMRTC     /* IF ANY MISCMPR         */
*              × CATFLDLN ^= CRAFLDLN                              1512
*              × MCWKAR(1:CRAFLDLN) ^= FMWKAR(1:CRAFLDLN)          1512
*             THEN                                                 1512
         L     @01,FMPLAD                                          1512
         CLC   FMPLRTCD(1,@01),CRAFMRTC                            1512
         BNE   @RT01512                                            1512
         L     @15,CRAFLDLN                                        1512
         CR    @02,@15                                             1512
         BNE   @RT01512                                            1512
         BCTR  @15,0                                               1512
         EX    @15,@SC01494                                        1512
         BE    @RF01512                                            1512
@RT01512 DS    0H                                                  1513
*               DO ;               /* STO SEVERITY WORDS AND         */
*                 MCMSG = MSGTBL(ARGGRP(ARGSLOT)) ->               1514
*                       CHARBASD(1:MSGLNTBL(ARGGRP(ARGSLOT))) ;    1514
         MVI   MCMSG+1,C' '                                        1514
         MVC   MCMSG+2(46),MCMSG+1                                 1514
         LR    @02,ARGSLOT                                         1514
         MH    @02,@CH00037                                        1514
         L     @15,@PC00025+4                                      1514
         BCTR  @15,0                                               1514
         BCTR  @15,0                                               1514
         SLR   @14,@14                                             1514
         IC    @14,ARGGRP-8(@02,@15)                               1514
         L     @02,@PC00025+12                                     1514
         BCTR  @02,0                                               1514
         SLR   @15,@15                                             1514
         IC    @15,MSGLNTBL(@14,@02)                               1514
         BCTR  @15,0                                               1514
         SLA   @14,2                                               1514
         L     @02,@PC00025+8                                      1514
         AL    @02,@CF01476                                        1514
         L     @02,MSGTBL(@14,@02)                                 1514
         EX    @15,@SM01496                                        1514
*                 RELREPNO = NBRMCFMC ; /* GET OUT OF LOOPS          */
         LH    @02,NBRMCFMC                                        1515
         STH   @02,RELREPNO                                        1515
*                 GRPS2CMP = 0 ;                                   1516
         SLR   @02,@02                                             1516
         ST    @02,GRPS2CMP                                        1516
*               END ;                                              1517
*            RELREPNO = RELREPNO + 1 ;                             1518
@RF01512 LA    @02,1                                               1518
         LH    @15,RELREPNO                                        1518
         ALR   @15,@02                                             1518
         STH   @15,RELREPNO                                        1518
*            CNTREPNO = CNTREPNO + 1 ;                             1519
         AH    @02,CNTREPNO                                        1519
         STH   @02,CNTREPNO                                        1519
*         END ;                                                    1520
*       ELSE                                                       1521
*         DO ;                     /* FIELD MGMT ERR RETURN          */
         B     @RC01499                                            1521
@RF01499 DS    0H                                                  1522
*           MCMSG = ' ';           /* NO FIELD TO PRINT      @OZ09388*/
         MVI   MCMSG+1,C' '                                        1522
         MVC   MCMSG+2(46),MCMSG+1                                 1522
         MVI   MCMSG,C' '                                          1522
*           FLDMGTER=ON;           /* SET FLD MGT ERR IND ON @OZ09388*/
         OI    FLDMGTER,B'01000000'                                1523
*           RELREPNO = NBRMCFMC ;  /* GET OUT OF LOOPS               */
         LH    @02,NBRMCFMC                                        1524
         STH   @02,RELREPNO                                        1524
*           GRPS2CMP = 0 ;                                         1525
         SLR   @02,@02                                             1525
         ST    @02,GRPS2CMP                                        1525
*         END ;                                                    1526
*   END ;                                                          1527
@RC01499 DS    0H                                                  1527
@DE01494 LH    @02,RELREPNO                                        1527
         CH    @02,NBRMCFMC                                        1527
         BL    @DL01494                                            1527
*   ARGSLOT = ARGSLOT + 1 ;                                        1528
         LA    @02,1                                               1528
         ALR   ARGSLOT,@02                                         1528
*   FMFLTCHN = '0'B ;              /* RESTORE ASSUMED VALUES         */
         SLR   @15,@15                                             1529
         ST    @15,FMFLTCHN(,FMFLCUR)                              1529
*   RELREPNO = 0 ;                                                 1530
         SLR   @15,@15                                             1530
         STH   @15,RELREPNO                                        1530
*   CNTREPNO = 1 ;                                                 1531
         STH   @02,CNTREPNO                                        1531
*   FMFLGRPC = '0'B ;                                              1532
         MVI   FMFLGRPC(FMFLCUR),B'00000000'                       1532
* END ;                                                            1533
@DE01474 LR    @02,ARGSLOT                                         1533
         MH    @02,@CH00037                                        1533
         L     @15,@PC00025+4                                      1533
         L     @14,GRPS2CMP                                        1533
         LA    @01,0(@02,@15)                                      1533
         BCTR  @01,0                                               1533
         BCTR  @01,0                                               1533
         SLR   @00,@00                                             1533
         IC    @00,ARGGRP-8(,@01)                                  1533
         CR    @14,@00                                             1533
         BL    @DC01474                                            1533
         ALR   @15,@02                                             1533
         AL    @15,@CF01493                                        1533
         CLC   ARGNAME(8,@15),@CC00816                             1533
         BNE   @DL01474                                            1533
@DC01474 DS    0H                                                  1534
* DARGLIST = '0'B ;                /* SET UP TO PRINT IT             */
         L     @15,DDSTRU                                          1534
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  1534
         MVI   DARGLIST(@15),B'00000000'                           1534
* DARGSMOD = 'LR0' ;                                               1535
         MVC   DARGSMOD(3,@15),@CC01335                            1535
* DARGSENT = 7 ;                                                   1536
         MVI   DARGSENT(@15),X'07'                                 1536
* DARGCNT = 1 ;                                                    1537
         LA    @14,1                                               1537
         STH   @14,DARGCNT(,@15)                                   1537
* DARGINS(1) = 1 ;                                                 1538
         STH   @14,DARGINS(,@15)                                   1538
* DARGINL(1) = LENGTH(MCMSG) ;                                     1539
         MVC   DARGINL(2,@15),@CH00639                             1539
* DARGDTM(1) = ADDR(MCMSG) ;                                       1540
*                                                                  1540
         LA    @14,MCMSG                                           1540
         ST    @14,DARGDTM(,@15)                                   1540
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1541
         L     @15,@PC00001                                        1541
         ST    @15,@AL00001                                        1541
         LA    @14,IOCSPRT                                         1541
         ST    @14,@AL00001+4                                      1541
         LA    @14,DDSTRU                                          1541
         ST    @14,@AL00001+8                                      1541
         MVI   @AL00001+8,X'80'                                    1541
         L     @15,GDTPRT(,@15)                                    1541
         LA    @01,@AL00001                                        1541
         BALR  @14,@15                                             1541
* IF FLDMGTER=ON             /* WAS THERE A FLD MGT ERR ?    @OZ09388*/
*   THEN                                                   /*@OZ09388*/
         TM    FLDMGTER,B'01000000'                                1542
         BNO   @RF01542                                            1542
*     DO;                                                  /*@OZ09388*/
*       CALL ERROR (30,$RETURN); /* SEND FLD MGT ERR MSG     @OZ09388*/
         LA    @01,@AL01544                                        1544
         BAL   @14,ERROR                                           1544
*       FLDMGTER=OFF;            /* SET FLD MGT ERR IND OFF  @OZ09388*/
         NI    FLDMGTER,B'10111111'                                1545
*     END;                                                 /*@OZ09388*/
*ELSE;                    /* NO ERROR - NORMAL EXIT          @OZ09388*/
*                                                                  1547
@RF01542 DS    0H                                                  1548
* MSCMPRSW = OFF ;                                                 1548
*                                                                  1548
         NI    MSCMPRSW,B'11110111'                                1548
*END PRTMCWD ;                                                     1549
@EL00025 DS    0H                                                  1549
@EF00025 DS    0H                                                  1549
@ER00025 LM    @14,@12,@SA00025                                    1549
         BR    @14                                                 1549
* /*******************************************************************/
* /* PROCEDURE NAME - PRTOJAL, PRINT OBJECT,S ALIASES                */
* /* FUNCTION -                                                      */
* /*   LOOP UNTIL NO MORE ALIAS RECORD ASSOCIATIONS,                 */
* /*     CALL INTASOC TO BUILD ASSOCTB2 OF ALL ASSOCIATIONS,         */
* /*     IF AN ALIAS ASSOC EXISTS GET AND PRINT ITS RECORD,          */
* /*     IF PRINT PASS AND MISCOMPARE OCCURED IN IT SO NOTE,         */
* /*     ALSO COUNT IT FOR THE ENTRIES PROCESSED SUMMARY             */
* /* INPUTS -                                                        */
* /*   BASE RECORD IDENTIFIED BY CIFRGET                             */
* /* OUTPUTS -                                                       */
* /*   ALIAS RECORDS PRINTED AS SPECIFIED                            */
* /* CALLS -                                                         */
* /*   INTASOC, GETPRT, PRTMCWD, SUMIT                               */
* /* NOTES -                                                         */
* /*   CATALOG MANAGEMENT HANDLES ALIAS RECORD ASSOCIATIONS          */
* /*   DIFFERENT THAN ALL OTHER ASSOCIATIONS, I.E. THE NONVSAM       */
* /*   ENTRY POINTS TO THE FIRST ONE ONLY (IF ANY AT ALL)            */
* /*   AND THEREAFTER THE RECORDS ARE CHAINED TOGETHER.              */
* /*   THERE ARE TWO ALIAS ASSOCIATIONS IN EACH ALIAS ENTRY,         */
* /*   THIS PROGRAM USES THE FIRST ALIAS ASSOCIATION WHICH           */
* /*   IS THE FORWARD CHAIN.  THE SECOND ALIAS ASSOCIATION           */
* /*   (THE BACKWARDS CHAIN) IS NOT USED BY THIS PROGRAM.            */
* /*******************************************************************/
*                                                                  1550
*PRTOJAL: PROCEDURE ;                                              1550
PRTOJAL  STM   @14,@12,@SA00026                                    1550
*   OLDERID2 = NEWERID2;                                           1551
         L     @15,@PC00001                                        1551
         L     @14,GDTTR2(,@15)                                    1551
         MVC   @TS00001(95),NEWERID2(@14)                          1551
         MVC   OLDERID2(95,@14),@TS00001                           1551
*   NEWID2 = 'LRPJ' ;                                              1552
         MVC   NEWID2(4,@14),@CC01382                              1552
*   IF GDTDBG = NULLPTR                                            1553
*     THEN;                                                        1553
         L     @15,GDTDBG(,@15)                                    1553
         LTR   @15,@15                                             1553
         BZ    @RT01553                                            1553
*     ELSE                                                         1555
*       CALL IDCDB010 (GDTTBL,'LRPJ') ;                            1555
*                                                                  1555
         L     @15,@PC00001                                        1555
         ST    @15,@AL00001                                        1555
         LA    @14,@CC01382                                        1555
         ST    @14,@AL00001+4                                      1555
         MVI   @AL00001+4,X'80'                                    1555
         L     @15,GDTDBG(,@15)                                    1555
         LA    @01,@AL00001                                        1555
         BALR  @14,@15                                             1555
*   INDNTCOL = INDNTCOL + 2 ;                                      1556
@RT01553 IC    @01,INDNTCOL                                        1556
         LA    @01,2(,@01)                                         1556
         STC   @01,INDNTCOL                                        1556
*   ATRA2PTR = A2PTR ;             /* SET TO BUILD ASSOCTB2          */
         L     @15,A2PTR                                           1557
         ST    @15,ATRA2PTR                                        1557
*   CISAVED = CIFRGET ;                                            1558
*                                                                  1558
         MVC   CISAVED(3),CIFRGET                                  1558
*   /*****************************************************************/
*   /* LOOP: GET AND PRINT ALL ALIAS RECORDS                         */
*   /*****************************************************************/
*                                                                  1559
*   DO WHILE (NOALIASW = OFF                                       1559
*         & ^(CMPRPASW = ON        /* GETOUT IF COMPARE PASS         */
*             & MSCMPRSW = ON)) ;     /* AND MISCOMPARE ALREADY      */
*                                                                  1559
         B     @DE01559                                            1559
@DL01559 DS    0H                                                  1560
*     CALL INTASOC(1) ;            /* BUILD TABLE OF ALL ASOCS       */
*                                                                  1560
         LA    @01,@AL01560                                        1560
         BAL   @14,INTASOC                                         1560
*     DO A2SLOT = 1 TO NBRATS      /* SEARCH TABLE FOR ALIAS         */
*       WHILE (A2ENTYP(A2SLOT) ^= CATRCTYP($ALIA)                  1561
*          & A2CRACI(A2SLOT) ^= '0'B) ;    /* OR END OF TABLE        */
         LA    A2SLOT,1                                            1561
@DL01561 L     @02,ATRA2PTR                                        1561
         LR    @15,A2SLOT                                          1561
         SLA   @15,2                                               1561
         SLR   @14,@14                                             1561
         IC    @14,$ALIA                                           1561
         MH    @14,@CH00042                                        1561
         ST    @15,@TF00001                                        1561
         ALR   @15,@02                                             1561
         LA    @01,CATRCTYP-5(@14)                                 1561
         CLC   A2ENTYP-4(1,@15),0(@01)                             1561
         BE    @DC01561                                            1561
         L     @01,@TF00001                                        1561
         L     @02,A2CRACI-5(@01,@02)                              1561
         LA    @02,0(,@02)                                         1561
         LTR   @02,@02                                             1561
         BZ    @DC01561                                            1561
*     END ;                                                        1562
         AL    A2SLOT,@CF00222                                     1562
         C     A2SLOT,@CF00038                                     1562
         BNH   @DL01561                                            1562
@DC01561 DS    0H                                                  1563
*     IF      A2ENTYP(A2SLOT) = CATRCTYP($ALIA)                    1563
*         & A2CRACI(A2SLOT) ^= '0'B     /* OR END OF ALIASES         */
*       THEN                                                       1563
         L     @02,ATRA2PTR                                        1563
         LR    @15,A2SLOT                                          1563
         SLA   @15,2                                               1563
         SLR   @14,@14                                             1563
         IC    @14,$ALIA                                           1563
         MH    @14,@CH00042                                        1563
         ST    @15,@TF00001                                        1563
         ALR   @15,@02                                             1563
         LA    @01,CATRCTYP-5(@14)                                 1563
         CLC   A2ENTYP-4(1,@15),0(@01)                             1563
         BNE   @RF01563                                            1563
         L     @01,@TF00001                                        1563
         L     @15,A2CRACI-5(@01,@02)                              1563
         LA    @15,0(,@15)                                         1563
         LTR   @15,@15                                             1563
         BZ    @RF01563                                            1563
*         DO ;                                                     1564
*           CIFRGET = A2CRACI(A2SLOT) ;                            1565
*                                                                  1565
         AL    @02,@TF00001                                        1565
         MVC   CIFRGET(3),A2CRACI-4(@02)                           1565
*           CALL GETPRT ;          /* GET (PRINT) ALIAS RCD          */
*                                                                  1566
         BAL   @14,GETPRT                                          1566
*           IF     PRNTPASW = ON                                   1567
*              & CMPRSW = ON                                       1567
*              & CTTMCSW(CIFRGET - CTTBASE) = ON                   1567
*             THEN                                                 1567
*                                                                  1567
         TM    PRNTPASW,B'10000000'                                1567
         BNO   @RF01567                                            1567
         TM    CMPRSW,B'01000000'                                  1567
         BNO   @RF01567                                            1567
         L     @02,CIFRGET-1                                       1567
         LA    @02,0(,@02)                                         1567
         SLA   @02,3                                               1567
         L     @01,CTTPTR                                          1567
         ALR   @01,@02                                             1567
         AL    @01,@CF01491                                        1567
         TM    CTTMCSW-8(@01),B'01000000'                          1567
         BNO   @RF01567                                            1567
*               CALL PRTMCWD(0,    /* NO GROUPS, ONLY 'OTHER'        */
*                    MCARGTBL,MCMSGTBL,MCMLNTBL) ;                 1568
*                                                                  1568
         LA    @01,@AL01568                                        1568
         BAL   @14,PRTMCWD                                         1568
*           ENTNOCUR = ENTNOCUR + 1 ;    /* AVOID COUNTING TWICE     */
@RF01567 LH    @02,ENTNOCUR                                        1569
         LA    @02,1(,@02)                                         1569
         STH   @02,ENTNOCUR                                        1569
*           IF   (PRNTPASW = ON & CMPRSW = OFF)                    1570
*              × ENTNOCUR > ENTNOSAV                               1570
*                                                                  1570
*             THEN CALL SUMIT(SMACCUM,ATENTYP(A2SLOT)) ;           1570
*                                                                  1570
         TM    PRNTPASW,B'10000000'                                1570
         BNO   @GL00063                                            1570
         TM    CMPRSW,B'01000000'                                  1570
         BZ    @RT01570                                            1570
@GL00063 LH    @02,ENTNOCUR                                        1570
         CH    @02,ENTNOSAV                                        1570
         BNH   @RF01570                                            1570
@RT01570 DS    0H                                                  1571
         LA    @02,SMACCUM                                         1571
         ST    @02,@AL00001                                        1571
         LR    @02,A2SLOT                                          1571
         SLA   @02,2                                               1571
         L     @01,ATRA2PTR                                        1571
         LA    @02,ATENTYP-4(@02,@01)                              1571
         ST    @02,@AL00001+4                                      1571
         LA    @01,@AL00001                                        1571
         BAL   @14,SUMIT                                           1571
*         END ;                                                    1572
*       ELSE                                                       1573
*         NOALIASW = ON ;          /* NO OR LAST ALIAS SO QUIT       */
         B     @RC01563                                            1573
@RF01563 OI    NOALIASW,B'00000100'                                1573
*   END ;                                                          1574
@RC01563 DS    0H                                                  1574
@DE01559 TM    NOALIASW,B'00000100'                                1574
         BNZ   @DC01559                                            1574
         TM    CMPRPASW,B'10000000'                                1574
         BNO   @DL01559                                            1574
         TM    MSCMPRSW,B'00001000'                                1574
         BNO   @DL01559                                            1574
@DC01559 DS    0H                                                  1575
*   NOALIASW = OFF ;                                               1575
         NI    NOALIASW,B'11111011'                                1575
*   CIFRGET = CISAVED ;                                            1576
         MVC   CIFRGET(3),CISAVED                                  1576
*   ATRA2PTR = ATPTR ;             /* RESTORE TO ASUMED STATE        */
         L     @04,ATPTR                                           1577
         ST    @04,ATRA2PTR                                        1577
*   INDNTCOL = INDNTCOL - 2 ;                                      1578
*                                                                  1578
         SLR   @04,@04                                             1578
         IC    @04,INDNTCOL                                        1578
         BCTR  @04,0                                               1578
         BCTR  @04,0                                               1578
         STC   @04,INDNTCOL                                        1578
*END PRTOJAL ;                                                     1579
@EL00026 DS    0H                                                  1579
@EF00026 DS    0H                                                  1579
@ER00026 LM    @14,@12,@SA00026                                    1579
         BR    @14                                                 1579
* /*******************************************************************/
* /* PROCEDURE NAME - PRTOJVL, PRINT OBJECTS VOLUMES                 */
* /* FUNCTION -                                                      */
* /*   CALL CKEYRNG TO CHECK FOR EXISTANCE OF VSAM DATA              */
* /*   OBJECT,S HAVING KEYRANGES AND SETUP TO GET THEM,              */
* /*   SET UP AND PRINT VOLUME HEADING LINE ,                        */
* /*   PRINT ALL THE OBJECT,S VOLUME SERIAL NUMBERS AND THE          */
* /*   HIGH KEYS IF THERE ARE KEYRANGES                              */
* /* INPUTS -                                                        */
* /*   CIFRGET (IDENTIFIES THE OBJECT RECORD)                        */
* /* OUTPUTS -                                                       */
* /*   LIST OF VOLUMES ASSOCIATED WITH THE OBJECT                    */
* /* CALLS -                                                         */
* /*   CKEYRNG, UPRINT, ERROR                                        */
* /*   IDCRC04(VOLSER, HIKEYV)                                       */
* /*******************************************************************/
*                                                                  1580
*PRTOJVL: PROCEDURE ;                                              1580
PRTOJVL  STM   @14,@12,@SA00027                                    1580
* OLDERID2 = NEWERID2;                                             1581
         L     @15,@PC00001                                        1581
         L     @14,GDTTR2(,@15)                                    1581
         MVC   @TS00001(95),NEWERID2(@14)                          1581
         MVC   OLDERID2(95,@14),@TS00001                           1581
* NEWID2 = 'LRPK' ;                                                1582
         MVC   NEWID2(4,@14),@CC01386                              1582
* IF GDTDBG = NULLPTR                                              1583
*   THEN;                                                          1583
         L     @15,GDTDBG(,@15)                                    1583
         LTR   @15,@15                                             1583
         BZ    @RT01583                                            1583
*   ELSE                                                           1585
*     CALL IDCDB010 (GDTTBL,'LRPK') ;                              1585
*                                                                  1585
         L     @15,@PC00001                                        1585
         ST    @15,@AL00001                                        1585
         LA    @14,@CC01386                                        1585
         ST    @14,@AL00001+4                                      1585
         MVI   @AL00001+4,X'80'                                    1585
         L     @15,GDTDBG(,@15)                                    1585
         LA    @01,@AL00001                                        1585
         BALR  @14,@15                                             1585
* INDNTCOL = INDNTCOL + 2 ;                                        1586
@RT01583 LA    @15,2                                               1586
         SLR   @14,@14                                             1586
         IC    @14,INDNTCOL                                        1586
         ALR   @14,@15                                             1586
         STC   @14,INDNTCOL                                        1586
* FMPLBCIN = CTTCATCI(CIFRGET-CTTBASE) ;                           1587
         L     @03,CTTPTR                                          1587
         L     @02,CIFRGET-1                                       1587
         LA    @02,0(,@02)                                         1587
         SLA   @02,3                                               1587
         L     @01,FMPLAD                                          1587
         ST    @02,@TF00001                                        1587
         ALR   @02,@03                                             1587
         AL    @02,@CF01478                                        1587
         MVC   FMPLBCIN(3,@01),CTTCATCI-5(@02)                     1587
* FMFLTCHN = ADDR(FMFLST(NBRFMFL));/* GET FIELDS ONE AT TIME         */
         LA    @02,FMFLST+96                                       1588
         ST    @02,FMFLTCHN(,FMFLCUR)                              1588
* DARGLIST = '0'B ;                /* SET UP COMMON PRINT            */
         L     @02,DDSTRU                                          1589
         XC    DARGLIST+1(19,@02),DARGLIST+1(@02)                  1589
         MVI   DARGLIST(@02),B'00000000'                           1589
* DARGSMOD = 'LR0' ;               /* STUFF FOR HEADER AND           */
         MVC   DARGSMOD(3,@02),@CC01335                            1590
* DARGIND = INDNTCOL ;             /* VOLUME SERIAL PRINTING         */
         STC   @14,DARGIND(,@02)                                   1591
* DARGINS(1) = 1 ;                                                 1592
         MVC   DARGINS(2,@02),@CH00222                             1592
* DARGINS(2) = 2 ;                                                 1593
         STH   @15,DARGINS+8(,@02)                                 1593
* DARGINS(3) = 3 ;                                                 1594
         LA    @15,3                                               1594
         STH   @15,DARGINS+16(,@02)                                1594
* VOLHD2 = ' - ' ;                                                 1595
         MVC   VOLHD2(3),@CC01387                                  1595
* DARGINL(2) = LENGTH(VOLHD2) ;                                    1596
         STH   @15,DARGINL+8(,@02)                                 1596
* DARGDTM(2) = ADDR(VOLHD2) ;                                      1597
         LA    @15,VOLHD2                                          1597
         ST    @15,DARGDTM+8(,@02)                                 1597
* IF CTTENTYP(CIFRGET-CTTBASE) = CATRCTYP($INDX)                   1598
*   THEN VOLHD1 = 'INDX' ;                                         1598
         SLR   @02,@02                                             1598
         IC    @02,$INDX                                           1598
         MH    @02,@CH00042                                        1598
         AL    @03,@TF00001                                        1598
         AL    @03,@CF01469                                        1598
         LA    @01,CATRCTYP-5(@02)                                 1598
         CLC   CTTENTYP-4(1,@03),0(@01)                            1598
         BNE   @RF01598                                            1598
         MVC   VOLHD1(4),@CC00728                                  1599
*   ELSE                                                           1600
*     IF CTTENTYP(CIFRGET-CTTBASE) = CATRCTYP($UCAT)               1600
*       THEN VOLHD1 = 'UCAT' ;                                     1600
         B     @RC01598                                            1600
@RF01598 L     @15,CIFRGET-1                                       1600
         LA    @15,0(,@15)                                         1600
         SLA   @15,3                                               1600
         SLR   @14,@14                                             1600
         IC    @14,$UCAT                                           1600
         MH    @14,@CH00042                                        1600
         L     @01,CTTPTR                                          1600
         ALR   @01,@15                                             1600
         AL    @01,@CF01469                                        1600
         LA    @15,CATRCTYP-5(@14)                                 1600
         CLC   CTTENTYP-4(1,@01),0(@15)                            1600
         BNE   @RF01600                                            1600
         MVC   VOLHD1(4),@CC00731                                  1601
*       ELSE VOLHD1 = 'DATA' ;                                     1602
         B     @RC01600                                            1602
@RF01600 MVC   VOLHD1(4),@CC00723                                  1602
*                                  /* GO SEE IF IS KEYRANGE          */
* CALL CKEYRNG ;                   /* KEYRNGSW SET ON IF IS          */
@RC01600 DS    0H                                                  1603
@RC01598 BAL   @14,CKEYRNG                                         1603
*                                  /* AND DARGXXX(3) ADDED           */
* DARGINL(1) = LENGTH(VOLHD1) ;                                    1604
         L     @02,DDSTRU                                          1604
         MVC   DARGINL(2,@02),@CH00047                             1604
* DARGDTM(1) = ADDR(VOLHD1) ;                                      1605
         LA    @15,VOLHD1                                          1605
         ST    @15,DARGDTM(,@02)                                   1605
* DARGSENT = 2 ;                                                   1606
*                                                                  1606
         MVI   DARGSENT(@02),X'02'                                 1606
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;/*                        1607
*                                     PRINT THE HEADER               */
*                                                                  1607
         L     @02,@PC00001                                        1607
         ST    @02,@AL00001                                        1607
         LA    @15,IOCSPRT                                         1607
         ST    @15,@AL00001+4                                      1607
         LA    @15,DDSTRU                                          1607
         ST    @15,@AL00001+8                                      1607
         MVI   @AL00001+8,X'80'                                    1607
         L     @15,GDTPRT(,@02)                                    1607
         LA    @01,@AL00001                                        1607
         BALR  @14,@15                                             1607
* DARGSENT = 3 ;                                                   1608
         L     @02,DDSTRU                                          1608
         MVI   DARGSENT(@02),X'03'                                 1608
* IF KEYRNGSW = OFF                                                1609
*   THEN VOLHD2 = '   ' ;                                          1609
         TM    KEYRNGSW,B'01000000'                                1609
         BNZ   @RF01609                                            1609
         MVC   VOLHD2(3),@CC00776                                  1610
* DARGIND = DARGIND + 2 ;                                          1611
@RF01609 L     @02,DDSTRU                                          1611
         LA    @15,2                                               1611
         SLR   @14,@14                                             1611
         IC    @14,DARGIND(,@02)                                   1611
         ALR   @15,@14                                             1611
         STC   @15,DARGIND(,@02)                                   1611
* DARGINL(1) = 6 ;                                                 1612
         MVC   DARGINL(2,@02),@CH00041                             1612
* DARGDTM(1) = ADDR(VOLSER) ;                                      1613
*                                                                  1613
         L     @15,FMFLADDR(,FMFLCUR)                              1613
         ST    @15,DARGDTM(,@02)                                   1613
* /*******************************************************************/
* /* LOOP: PRINTING ALL OF THE VOLUME SERIALS                        */
* /*******************************************************************/
*                                                                  1614
* DO WHILE (RELREPNO < NBRVOLOC) ;                                 1614
         B     @DE01614                                            1614
@DL01614 DS    0H                                                  1615
*   FMPLFMFL(2) -> FMFLENTH(1) = 0 ;                               1615
         L     @02,FMPLAD                                          1615
         L     @01,FMPLFMFL+4(,@02)                                1615
         SLR   @00,@00                                             1615
         ST    @00,FMFLENTH(,@01)                                  1615
*   REG1 = FMPLAD ;                                                1616
*                                                                  1616
         LR    REG1,@02                                            1616
*   CALL IDCRC04 ;                 /* ASK VOLSER (AND KEYRNG)        */
*                                                                  1617
         L     @15,@CV00793                                        1617
         BALR  @14,@15                                             1617
*   IF FMFLENTH ^= 0                                               1618
*     THEN                                                         1618
         SLR   @02,@02                                             1618
         C     @02,FMFLENTH(,FMFLCUR)                              1618
         BE    @RF01618                                            1618
*       DO ;                                                       1619
*         IF FMFLENTH(1) = 0       /* IGNORE ALL DELETED             */
*           THEN ;                 /* OCCURANCES                     */
         C     @02,FMFLENTH(,FMFLCUR)                              1620
         BE    @RT01620                                            1620
*           ELSE                                                   1622
*             DO ;                                                 1622
*               IF KEYRNGSW = ON                                   1623
*                 THEN             /* ADD HIGH KEY PRINT             */
         TM    KEYRNGSW,B'01000000'                                1623
         BNO   @RF01623                                            1623
*                   DO ;                                           1624
*                     KEYLEN = FMPLFMFL(2) ->                      1625
*                              FMFLADDR(1) -> HIKEYLEN ;           1625
         L     @01,FMPLAD                                          1625
         L     @01,FMPLFMFL+4(,@01)                                1625
         L     @15,FMFLADDR(,@01)                                  1625
         LH    KEYLEN,HIKEYLEN(,@15)                               1625
*                     DARGINL(3) = MIN(32,KEYLEN) ;                1626
         L     @14,DDSTRU                                          1626
         LA    @01,32                                              1626
         LR    @00,@01                                             1626
         CR    @00,KEYLEN                                          1626
         BNH   *+6
         LR    @00,KEYLEN                                          1626
         STH   @00,DARGINL+16(,@14)                                1626
*                     DARGDTM(3) = (FMPLFMFL(2) -> FMFLADDR(1))    1627
*                                  + LENGTH(HIKEYLEN) ;            1627
         AL    @15,@CF00158                                        1627
         ST    @15,DARGDTM+16(,@14)                                1627
*                     IF KEYLEN > 32                               1628
*                       THEN       /* NEED TWO LINES FOR KEY         */
         CR    KEYLEN,@01                                          1628
         BNH   @RF01628                                            1628
*                         DO ;                                     1629
*                                                                  1629
*                           CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;
*                                                                  1630
         L     @15,@PC00001                                        1630
         ST    @15,@AL00001                                        1630
         LA    @14,IOCSPRT                                         1630
         ST    @14,@AL00001+4                                      1630
         LA    @14,DDSTRU                                          1630
         ST    @14,@AL00001+8                                      1630
         MVI   @AL00001+8,X'80'                                    1630
         L     @15,GDTPRT(,@15)                                    1630
         LA    @01,@AL00001                                        1630
         BALR  @14,@15                                             1630
*                           DARGDTM(1) = ADDR('      ') ;          1631
         L     @15,DDSTRU                                          1631
         LA    @14,@CC00686                                        1631
         ST    @14,DARGDTM(,@15)                                   1631
*                           DARGINL(3) = KEYLEN - 32 ;             1632
         LA    @14,32                                              1632
         LR    @01,KEYLEN                                          1632
         SLR   @01,@14                                             1632
         STH   @01,DARGINL+16(,@15)                                1632
*                           DARGDTM(3) = DARGDTM(3) + 32 ;         1633
         AL    @14,DARGDTM+16(,@15)                                1633
         ST    @14,DARGDTM+16(,@15)                                1633
*                         END ;                                    1634
*                   END ;                                          1635
*                                                                  1635
@RF01628 DS    0H                                                  1636
*               CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;            1636
*                                                                  1636
@RF01623 L     @02,@PC00001                                        1636
         ST    @02,@AL00001                                        1636
         LA    @15,IOCSPRT                                         1636
         ST    @15,@AL00001+4                                      1636
         LA    @15,DDSTRU                                          1636
         ST    @15,@AL00001+8                                      1636
         MVI   @AL00001+8,X'80'                                    1636
         L     @15,GDTPRT(,@02)                                    1636
         LA    @01,@AL00001                                        1636
         BALR  @14,@15                                             1636
*             END ;                                                1637
*         RELREPNO = RELREPNO + 1; /* ASK FOR NEXT ONE               */
@RT01620 LA    @02,1                                               1638
         LH    @15,RELREPNO                                        1638
         ALR   @15,@02                                             1638
         STH   @15,RELREPNO                                        1638
*         CNTREPNO = CNTREPNO + 1 ;                                1639
         AH    @02,CNTREPNO                                        1639
         STH   @02,CNTREPNO                                        1639
*       END ;                                                      1640
*     ELSE                                                         1641
*       DO ;                                                       1641
         B     @RC01618                                            1641
@RF01618 DS    0H                                                  1642
*         PROCMSG='PRTOJVL ';    /* PROC NAME FOR INSERT     @OZ09388*/
         MVC   PROCMSG(8),@CC01388                                 1642
*         CALL ERROR (21,$RETURN); /* FLD MGMT ERROR RETURN          */
         LA    @01,@AL01643                                        1643
         BAL   @14,ERROR                                           1643
*         RELREPNO = NBRVOLOC + 1; /* GET OUT OF LOOP                */
         LA    @02,1(,NBRVOLOC)                                    1644
         STH   @02,RELREPNO                                        1644
*       END ;                                                      1645
* END ;                                                            1646
@RC01618 DS    0H                                                  1646
@DE01614 CH    NBRVOLOC,RELREPNO                                   1646
         BH    @DL01614                                            1646
* RELREPNO = 0 ;                   /* RESTORE ASSUMED VALUES         */
         SLR   @15,@15                                             1647
         STH   @15,RELREPNO                                        1647
* CNTREPNO = 1 ;                                                   1648
         MVC   CNTREPNO(2),@CH00222                                1648
* FMPLFLNO = 1 ;                                                   1649
         L     @15,FMPLAD                                          1649
         MVI   FMPLFLNO(@15),X'01'                                 1649
* FMPLFMFL(2) -> FMFLTCHN = '0'B ;                                 1650
         SLR   @14,@14                                             1650
         L     @01,FMPLFMFL+4(,@15)                                1650
         ST    @14,FMFLTCHN(,@01)                                  1650
* FMFLTCHN = '0'B ;                                                1651
         ST    @14,FMFLTCHN(,FMFLCUR)                              1651
* INDNTCOL = INDNTCOL - 2 ;                                        1652
*                                                                  1652
         SLR   @15,@15                                             1652
         IC    @15,INDNTCOL                                        1652
         BCTR  @15,0                                               1652
         BCTR  @15,0                                               1652
         STC   @15,INDNTCOL                                        1652
*END PRTOJVL ;                                                     1653
@EL00027 DS    0H                                                  1653
@EF00027 DS    0H                                                  1653
@ER00027 LM    @14,@12,@SA00027                                    1653
         BR    @14                                                 1653
* /*******************************************************************/
* /* PROCEDURE NAME - PRTOTHR, PRINT OTHER THAN VSAM OBJECTS         */
* /* FUNCTION -                                                      */
* /*   IF ALREADY MARKED AS GDG MEMBER OR ALREADY PRINTED DO NOTHING,*/
* /*   IF COMPARE, PASS TWICE THRU THE FOLLOWING, FIRST              */
* /*   WITH NO PRINTING LOOKING FOR ANY MISCOMPARE,                  */
* /*   SECOND TIME PRINTING IF THERE WAS ONE,                        */
* /*   LOOP THRU HORIZONTAL EXTENSIONS,                              */
* /*     GET (AND PRINT) TOP RECORD OF STRUCTURE,                    */
* /*     CALL VERTEXT TO HANDLE ANY VERTICAL EXTENSIONS,             */
* /*   IF NOT GDG BASE CALL PRTOJAL TO PROCESS ALIASES               */
* /*     AND IF COMPARE AND MISCOMPARED PRINT RIGHT WORDS            */
* /*     AND BUMP MISCOMPARED ENTRIES COUNT,                         */
* /*   IF IS GDG BASE INITIALIZE THE ASSOTBL WITH ALL                */
* /*     MEMBER CI,S AND DO THE ABOVE FOR EACH ONE OF                */
* /*     THEM AFTER DOING MICOMPARE WORDS FOR BASE ITSELF            */
* /* INPUTS -                                                        */
* /*   SORTTBL ENTRY IDENTIFIED BY STSLOT                            */
* /* OUTPUTS -                                                       */
* /*   LISTING OF OTHER THAN VSAM STRUCTURES AS REQUESTED            */
* /*   CTTGDGM SWITCHES ON FOR NONVSAM MEMBERS OF GDG SETS           */
* /*   MCENTCNT (MISCOMPARED ENTRIES COUNT)                          */
* /* CALLS -                                                         */
* /*   GETPRT, INTASOC, VERTEXT, PRTMCWD, PRTOJAL, SUMIT             */
* /*******************************************************************/
*                                                                  1654
*PRTOTHR: PROCEDURE ;                                              1654
PRTOTHR  STM   @14,@12,@SA00028                                    1654
* OLDERID2 = NEWERID2;                                             1655
         L     @02,@PC00001                                        1655
         L     @15,GDTTR2(,@02)                                    1655
         MVC   @TS00001(95),NEWERID2(@15)                          1655
         MVC   OLDERID2(95,@15),@TS00001                           1655
* NEWID2 = 'LRPO' ;                                                1656
         MVC   NEWID2(4,@15),@CC01392                              1656
* IF GDTDBG = NULLPTR                                              1657
*   THEN;                                                          1657
         L     @02,GDTDBG(,@02)                                    1657
         LTR   @02,@02                                             1657
         BZ    @RT01657                                            1657
*   ELSE                                                           1659
*     CALL IDCDB010 (GDTTBL,'LRPO') ;                              1659
*                                                                  1659
         L     @02,@PC00001                                        1659
         ST    @02,@AL00001                                        1659
         LA    @15,@CC01392                                        1659
         ST    @15,@AL00001+4                                      1659
         MVI   @AL00001+4,X'80'                                    1659
         L     @15,GDTDBG(,@02)                                    1659
         LA    @01,@AL00001                                        1659
         BALR  @14,@15                                             1659
* CMPRPASW = OFF ;                 /* SET CONTROL SWITCHES           */
@RT01657 NI    CMPRPASW,B'01111111'                                1660
* PRNTPASW = OFF ;                 /* FOR ONE ONLY OR                */
         NI    PRNTPASW,B'01111111'                                1661
* IF CMPRSW = ON                   /* (IF COMPARE) POSSIBLE          */
*   THEN                           /* TWO PASSES THRU LOGIC,         */
         TM    CMPRSW,B'01000000'                                  1662
         BNO   @RF01662                                            1662
*     CMPRPASW = ON ;              /* 1 - LOOK FOR MISCOMPARE        */
         OI    CMPRPASW,B'10000000'                                1663
*   ELSE                           /* 2 - PRINT IF MISCOMPARE        */
*     PRNTPASW = ON ;              /* WAS FOUND                      */
         B     @RC01662                                            1664
@RF01662 OI    PRNTPASW,B'10000000'                                1664
* MSCMPRSW = OFF ;                                                 1665
@RC01662 NI    MSCMPRSW,B'11110111'                                1665
* ENTNOCUR = 0 ;                                                   1666
         SLR   @02,@02                                             1666
         STH   @02,ENTNOCUR                                        1666
* ENTNOSAV = 0 ;                                                   1667
*                                                                  1667
         STH   @02,ENTNOSAV                                        1667
* /*******************************************************************/
* /* IF NOT ALREADY PROCESSED AS MEMBER OF GDG SET OR ALREADY PRINTED*/
* /* PASS THRU TWICE IF COMPARE SO ONLY MISCOMPARES WILL PRINT       */
* /*******************************************************************/
*                                                                  1668
* IF CTTGDGM(STCRACI(STSLOT)-CTTBASE) ^= ON THEN                   1668
         LR    @02,STSLOT                                          1668
         MH    @02,@CH01068                                        1668
         L     @01,STPTR                                           1668
         AL    @01,@CF01484                                        1668
         L     @02,STCRACI-45(@02,@01)                             1668
         LA    @02,0(,@02)                                         1668
         SLA   @02,3                                               1668
         L     @01,CTTPTR                                          1668
         ALR   @01,@02                                             1668
         AL    @01,@CF01491                                        1668
         TM    CTTGDGM-8(@01),B'00100000'                          1668
         BO    @RF01668                                            1668
*   DO WHILE (CTTPRTD(STCRACI(STSLOT)-CTTBASE) ^= ON               1669
*         & (CMPRPASW = ON × PRNTPASW = ON)) ;                     1669
         B     @DE01669                                            1669
@DL01669 DS    0H                                                  1670
*     INDNTCOL = 0 ;                                               1670
         MVI   INDNTCOL,X'00'                                      1670
*     CIFRGET = STCRACI(STSLOT) ;                                  1671
         L     @02,STPTR                                           1671
         LR    @15,STSLOT                                          1671
         MH    @15,@CH01068                                        1671
         ST    @15,@TF00001                                        1671
         ALR   @15,@02                                             1671
         AL    @15,@CF01477                                        1671
         MVC   CIFRGET(3),STCRACI-45(@15)                          1671
*     CIBASE = CIFRGET ;                                           1672
         MVC   CIBASE(3),CIFRGET                                   1672
*     BASETYPE = STENTYP(STSLOT) ;                                 1673
*                                                                  1673
         AL    @02,@TF00001                                        1673
         AL    @02,@CF01484                                        1673
         MVC   BASETYPE(1),STENTYP-44(@02)                         1673
*     /***************************************************************/
*     /* LOOP: THRU ALL HORIZONTAL EXTENSION RECORDS (IF ANY)        */
*     /***************************************************************/
*                                                                  1674
*     DO WHILE ((CIFRGET ^= '0'B)                                  1674
*           & (^(CMPRPASW = ON          /* QUIT AFTER FIRST          */
*                & MSCMPRSW = ON)));    /* MISCOMPARE                */
*                                                                  1674
         B     @DE01674                                            1674
@DL01674 DS    0H                                                  1675
*       CALL GETPRT ;              /* GET (PRINT) TOP RECORD         */
*                                                                  1675
         BAL   @14,GETPRT                                          1675
*       CALL VERTEXT ;             /* AND ITS VERTICAL EXTNS         */
*                                                                  1676
         BAL   @14,VERTEXT                                         1676
*     END ;                                                        1677
@DE01674 L     @02,CIFRGET-1                                       1677
         LA    @02,0(,@02)                                         1677
         LTR   @02,@02                                             1677
         BZ    @DC01674                                            1677
         TM    CMPRPASW,B'10000000'                                1677
         BNO   @DL01674                                            1677
         TM    MSCMPRSW,B'00001000'                                1677
         BNO   @DL01674                                            1677
@DC01674 DS    0H                                                  1678
*     ENTNOCUR = ENTNOCUR + 1 ;    /* AVOID COUNTING TWICE           */
         LH    @02,ENTNOCUR                                        1678
         LA    @02,1(,@02)                                         1678
         STH   @02,ENTNOCUR                                        1678
*     IF    (PRNTPASW = ON & CMPRSW = OFF)                         1679
*         × ENTNOCUR > ENTNOSAV                                    1679
*                                                                  1679
*       THEN CALL SUMIT (SMACCUM,BASETYPE) ;                       1679
*                                                                  1679
         TM    PRNTPASW,B'10000000'                                1679
         BNO   @GL00069                                            1679
         TM    CMPRSW,B'01000000'                                  1679
         BZ    @RT01679                                            1679
@GL00069 LH    @02,ENTNOCUR                                        1679
         CH    @02,ENTNOSAV                                        1679
         BNH   @RF01679                                            1679
@RT01679 DS    0H                                                  1680
         LA    @02,SMACCUM                                         1680
         ST    @02,@AL00001                                        1680
         LA    @02,BASETYPE                                        1680
         ST    @02,@AL00001+4                                      1680
         LA    @01,@AL00001                                        1680
         BAL   @14,SUMIT                                           1680
*     CIFRGET = CIBASE ;                                           1681
@RF01679 MVC   CIFRGET(3),CIBASE                                   1681
*     IF ^(CMPRPASW = ON           /* QUIT AFTER 1ST MISCMPR         */
*        & MSCMPRSW = ON)                                          1682
*       THEN                                                       1682
         TM    CMPRPASW,B'10000000'                                1682
         BNO   @RT01682                                            1682
         TM    MSCMPRSW,B'00001000'                                1682
         BO    @RF01682                                            1682
@RT01682 DS    0H                                                  1683
*         DO ;                                                     1683
*           IF BASETYPE ^= CATRCTYP($GDGB)                         1684
*             THEN                       /****************************/
         SLR   @02,@02                                             1684
         IC    @02,$GDGB                                           1684
         MH    @02,@CH00042                                        1684
         LA    @01,CATRCTYP-5(@02)                                 1684
         CLC   BASETYPE(1),0(@01)                                  1684
         BE    @RF01684                                            1684
*               DO ;                     /* NONVSAM AND UCAT PTRS    */
*                 IF     PRNTPASW = ON   /****************************/
*                    & CMPRSW = ON                                 1686
*                    & CTTMCSW(CIFRGET - CTTBASE) = ON             1686
*                   THEN                                           1686
         TM    PRNTPASW,B'10000000'                                1686
         BNO   @RF01686                                            1686
         TM    CMPRSW,B'01000000'                                  1686
         BNO   @RF01686                                            1686
         L     @02,CIFRGET-1                                       1686
         LA    @02,0(,@02)                                         1686
         SLA   @02,3                                               1686
         L     @01,CTTPTR                                          1686
         ALR   @01,@02                                             1686
         AL    @01,@CF01491                                        1686
         TM    CTTMCSW-8(@01),B'01000000'                          1686
         BNO   @RF01686                                            1686
*                     DO ;                                         1687
*                                                                  1687
*                       CALL PRTMCWD(2, /* ONLY 1ST 2 GROUPS         */
*                                  MCARGTBL,MCMSGTBL,MCMLNTBL);    1688
*                                                                  1688
         LA    @01,@AL01688                                        1688
         BAL   @14,PRTMCWD                                         1688
*                       MCENTCNT = MCENTCNT + 1 ; /* BUMP COUNT      */
         LH    @02,MCENTCNT                                        1689
         LA    @02,1(,@02)                                         1689
         STH   @02,MCENTCNT                                        1689
*                     END ;                                        1690
*                                                                  1690
*                 CALL PRTOJAL ;   /* GO PRINT ALIASES (IFANY        */
*                                                                  1691
@RF01686 BAL   @14,PRTOJAL                                         1691
*               END ;                                              1692
*             ELSE                         /**************************/
*               DO ;                       /* HANDLE GDG MEMBERS     */
         B     @RC01684                                            1693
@RF01684 DS    0H                                                  1694
*                 IF     PRNTPASW = ON     /**************************/
*                    & CMPRSW = ON                                 1694
*                    & CTTMCSW(CIFRGET - CTTBASE) = ON             1694
*                   THEN                                           1694
         TM    PRNTPASW,B'10000000'                                1694
         BNO   @RF01694                                            1694
         TM    CMPRSW,B'01000000'                                  1694
         BNO   @RF01694                                            1694
         L     @02,CIFRGET-1                                       1694
         LA    @02,0(,@02)                                         1694
         SLA   @02,3                                               1694
         L     @01,CTTPTR                                          1694
         ALR   @01,@02                                             1694
         AL    @01,@CF01491                                        1694
         TM    CTTMCSW-8(@01),B'01000000'                          1694
         BNO   @RF01694                                            1694
*                     DO ;                                         1695
*                                                                  1695
*                       CALL PRTMCWD(1,    /* ONLY 1ST GROUP         */
*                                  MCARGTBL,MCMSGTBL,MCMLNTBL);    1696
*                                                                  1696
         LA    @01,@AL01696                                        1696
         BAL   @14,PRTMCWD                                         1696
*                       MCENTCNT = MCENTCNT + 1 ;                  1697
         LH    @02,MCENTCNT                                        1697
         LA    @02,1(,@02)                                         1697
         STH   @02,MCENTCNT                                        1697
*                     END ;                                        1698
*                 INDNTCOL = 2 ;                                   1699
*                                                                  1699
@RF01694 MVI   INDNTCOL,X'02'                                      1699
*                 CALL INTASOC(1) ;                                1700
*                                                                  1700
         LA    @01,@AL01700                                        1700
         BAL   @14,INTASOC                                         1700
*                 /***************************************************/
*                 /* LOOP: THRU GDG MEMBERS                          */
*                 /***************************************************/
*                                                                  1701
*                 DO ATSLOT = 1 TO NBRATS                          1701
*                    WHILE (ATCRACI(ATSLOT) ^= '0'B                1701
*                       & LASTATSW ^= ON                           1701
*                       & ^(CMPRPASW = ON                          1701
*                           & MSCMPRSW = ON)) ;                    1701
         LA    ATSLOT,1                                            1701
@DL01701 LR    @15,ATSLOT                                          1701
         SLA   @15,2                                               1701
         L     @01,ATRA2PTR                                        1701
         L     @15,ATCRACI-5(@15,@01)                              1701
         LA    @15,0(,@15)                                         1701
         LTR   @15,@15                                             1701
         BZ    @DC01701                                            1701
         TM    LASTATSW,B'00100000'                                1701
         BO    @DC01701                                            1701
         TM    CMPRPASW,B'10000000'                                1701
         BNO   @DB01701                                            1701
         TM    MSCMPRSW,B'00001000'                                1701
         BO    @DC01701                                            1701
@DB01701 DS    0H                                                  1702
*                   CIFRGET = ATCRACI(ATSLOT) ;                    1702
         LR    @15,ATSLOT                                          1702
         SLA   @15,2                                               1702
         L     @01,ATRA2PTR                                        1702
         ALR   @01,@15                                             1702
         MVC   CIFRGET(3),ATCRACI-4(@01)                           1702
*                   CIBASE = CIFRGET ;                             1703
*                                                                  1703
         MVC   CIBASE(3),CIFRGET                                   1703
*                   /************************************************/
*                   /* LOOP: THRU ANY GDG MEMBER                     */
*                   /*       HORIZONTAL EXTENSION RECORDS            */
*                   /************************************************/
*                                                                  1704
*                   DO WHILE (CIFRGET ^= '0'B                      1704
*                        & (^(CMPRPASW = ON           /* SEE         */
*                             & MSCMPRSW = ON)));     /*ABOVE        */
*                                                                  1704
         B     @DE01704                                            1704
@DL01704 DS    0H                                                  1705
*                     CALL GETPRT ;/* GET (PRINT) MEMBER             */
*                                                                  1705
         BAL   @14,GETPRT                                          1705
*                     CALL VERTEXT;/* HANDLE VERT EXTENSIONS         */
*                                                                  1706
         BAL   @14,VERTEXT                                         1706
*                   END ;                                          1707
@DE01704 L     @15,CIFRGET-1                                       1707
         LA    @15,0(,@15)                                         1707
         LTR   @15,@15                                             1707
         BZ    @DC01704                                            1707
         TM    CMPRPASW,B'10000000'                                1707
         BNO   @DL01704                                            1707
         TM    MSCMPRSW,B'00001000'                                1707
         BNO   @DL01704                                            1707
@DC01704 DS    0H                                                  1708
*                   CIFRGET = CIBASE ;                             1708
         L     @15,CIBASE-1                                        1708
         LA    @15,0(,@15)                                         1708
         STCM  @15,7,CIFRGET                                       1708
*                   CTTGDGM(CIFRGET-CTTBASE) = ON;  /* MARK AS MEMBR */
         L     @14,CTTPTR                                          1709
         SLA   @15,3                                               1709
         ST    @15,@TF00001                                        1709
         ALR   @15,@14                                             1709
         AL    @15,@CF01491                                        1709
         OI    CTTGDGM-8(@15),B'00100000'                          1709
*                   IF     PRNTPASW = ON                           1710
*                      & CMPRSW = ON                               1710
*                      & CTTMCSW(CIFRGET - CTTBASE) = ON           1710
*                     THEN                                         1710
*                                                                  1710
         TM    PRNTPASW,B'10000000'                                1710
         BNO   @RF01710                                            1710
         TM    CMPRSW,B'01000000'                                  1710
         BNO   @RF01710                                            1710
         AL    @14,@TF00001                                        1710
         AL    @14,@CF01491                                        1710
         TM    CTTMCSW-8(@14),B'01000000'                          1710
         BNO   @RF01710                                            1710
*                       CALL PRTMCWD(2,      /*USE 1ST 2 GRPS        */
*                                  MCARGTBL,MCMSGTBL,MCMLNTBL);    1711
*                                                                  1711
         LA    @01,@AL01711                                        1711
         BAL   @14,PRTMCWD                                         1711
*                   CALL PRTOJAL ; /* PRINT ANY ALIASES              */
*                                                                  1712
@RF01710 BAL   @14,PRTOJAL                                         1712
*                   ENTNOCUR = ENTNOCUR + 1 ;                      1713
         LH    @01,ENTNOCUR                                        1713
         LA    @01,1(,@01)                                         1713
         STH   @01,ENTNOCUR                                        1713
*                   IF   (PRNTPASW = ON & CMPRSW = OFF)            1714
*                      × ENTNOCUR > ENTNOSAV                       1714
*                                                                  1714
*                     THEN CALL SUMIT(SMACCUM,ATENTYP(ATSLOT));    1714
*                                                                  1714
         TM    PRNTPASW,B'10000000'                                1714
         BNO   @GL00083                                            1714
         TM    CMPRSW,B'01000000'                                  1714
         BZ    @RT01714                                            1714
@GL00083 LH    @15,ENTNOCUR                                        1714
         CH    @15,ENTNOSAV                                        1714
         BNH   @RF01714                                            1714
@RT01714 DS    0H                                                  1715
         LA    @15,SMACCUM                                         1715
         ST    @15,@AL00001                                        1715
         LR    @15,ATSLOT                                          1715
         SLA   @15,2                                               1715
         L     @01,ATRA2PTR                                        1715
         LA    @15,ATENTYP-4(@15,@01)                              1715
         ST    @15,@AL00001+4                                      1715
         LA    @01,@AL00001                                        1715
         BAL   @14,SUMIT                                           1715
*                   IF ATSLOT = NBRATS                             1716
*                     THEN                                         1716
@RF01714 C     ATSLOT,@CF00038                                     1716
         BNE   @RF01716                                            1716
*                       IF ATNXTTBL ^= '0'B                        1717
*                         THEN                                     1717
         L     @01,ATRA2PTR                                        1717
         L     @15,ATNXTTBL(,@01)                                  1717
         LTR   @15,@15                                             1717
         BZ    @RF01717                                            1717
*                             DO ;                                 1718
*                               ATPTR = ATNXTTBL ;  /*BUMP TO        */
         ST    @15,ATPTR                                           1719
*                               ATRA2PTR = ATPTR;          /*@OZ09619*/
         ST    @15,ATRA2PTR                                        1720
*                               ATSLOT = 0 ;   /* NEXT TABLE         */
         SLR   ATSLOT,ATSLOT                                       1721
*                             END ;                                1722
*                           ELSE                                   1723
*                             LASTATSW = ON ;                      1723
         B     @RC01717                                            1723
@RF01717 OI    LASTATSW,B'00100000'                                1723
*                 END ;                                            1724
@RC01717 DS    0H                                                  1724
@RF01716 AL    ATSLOT,@CF00222                                     1724
         C     ATSLOT,@CF00038                                     1724
         BNH   @DL01701                                            1724
@DC01701 DS    0H                                                  1725
*                 LASTATSW = OFF ;                                 1725
         NI    LASTATSW,B'11011111'                                1725
*               END ;                                              1726
*         END ;                                                    1727
@RC01684 DS    0H                                                  1728
*     PRNTPASW = OFF ;             /* TURN OFF AFTER PRINTING        */
@RF01682 NI    PRNTPASW,B'01111111'                                1728
*     IF CMPRPASW = ON & MSCMPRSW = ON                             1729
*       THEN PRNTPASW = ON ;       /* PASS THRU AGAIN PRINTIN        */
         TM    CMPRPASW,B'10000000'                                1729
         BNO   @RF01729                                            1729
         TM    MSCMPRSW,B'00001000'                                1729
         BNO   @RF01729                                            1729
         OI    PRNTPASW,B'10000000'                                1730
*     CMPRPASW = OFF ;                                             1731
@RF01729 NI    CMPRPASW,B'01111111'                                1731
*   END ;                          /* END 2ND PASS CONTROL           */
*                                                                  1732
@DE01669 LR    @02,STSLOT                                          1732
         MH    @02,@CH01068                                        1732
         L     @01,STPTR                                           1732
         AL    @01,@CF01484                                        1732
         L     @02,STCRACI-45(@02,@01)                             1732
         LA    @02,0(,@02)                                         1732
         SLA   @02,3                                               1732
         L     @01,CTTPTR                                          1732
         ALR   @01,@02                                             1732
         AL    @01,@CF01491                                        1732
         TM    CTTPRTD-8(@01),B'10000000'                          1732
         BO    @DC01669                                            1732
         TM    CMPRPASW,B'10000000'                                1732
         BO    @DL01669                                            1732
         TM    PRNTPASW,B'10000000'                                1732
         BO    @DL01669                                            1732
@DC01669 DS    0H                                                  1733
*END PRTOTHR ;                                                     1733
@EL00028 DS    0H                                                  1733
@EF00028 DS    0H                                                  1733
@ER00028 LM    @14,@12,@SA00028                                    1733
         BR    @14                                                 1733
* /*******************************************************************/
* /* PROCEDURE NAME - PRTTIME, PRINT VARIOUS TIMESTAMPS              */
* /* FUNCTION -                                                      */
* /*   CONVERT 64 BIT TIMESTAMP TO 'MO/DA/YR  HR:MN:SC' AND          */
* /*   ADD IDENTIFYING WORD AND PRINT THEM                           */
* /*   NOTE: BECAUSE PLS CANNOT DO A 64 BIT DIVIDE  AND A            */
* /*         FIXED POINT DIVIDE EXCEPTION IS UNDESIREABLE,           */
* /*         SHIFT THE TIMESTAMP RIGHT 12 POSITIONS TO GET           */
* /*         TO THE MICROSECOND COUNTING BIT THEN DIVIDE BY          */
* /*         86,400,000,000 (1,000,000*3600*24) SAME AS              */
* /*         (10,546,875*2**13 (SHIFT 13 THEN DIVIDE))               */
* /*         TO GET WHOLE DAYS AS QUOTIENT AND PARTS OF              */
* /*         DAYS AS DECIMAL REMAINDER) THEN CONVERT THIS            */
* /*         BACK TO SECONDS.  1/1/1900 IS THE BASE YEAR AND         */
* /*         LEAP YEAR EFFECTS ARE HANDLED TO YEAR 2000              */
* /*   CREDITS: AL KULAS FURNISHED MOST OF THE INFORMATION           */
* /*            WHICH ALLOWED ME TO WRITE THIS ROUTINE WITH          */
* /*            W.J.RICHARDS HELP IN DEBUGGING IT                    */
* /* INPUTS -                                                        */
* /*   SUBSCRIPT OF TIMESTAMP IDENTIFYING WORD                       */
* /*   TIMESTAMP (64 BIT)                                            */
* /* OUTPUTS -                                                       */
* /*   PRINTED TIMESTAMP LINE                                        */
* /* CALLS -                                                         */
* /*   UPRINT                                                        */
* /*******************************************************************/
*PRTTIME: PROCEDURE (TSTID,TSTBIT64) ;                             1734
PRTTIME  STM   @14,@12,@SA00029                                    1734
         MVC   @PC00029(8),0(@01)                                  1734
* OLDERID2 = NEWERID2;                                             1735
         L     @04,@PC00001                                        1735
         L     @15,GDTTR2(,@04)                                    1735
         MVC   @TS00001(95),NEWERID2(@15)                          1735
         MVC   OLDERID2(95,@15),@TS00001                           1735
* NEWID2 = 'LRPT' ;                                                1736
         MVC   NEWID2(4,@15),@CC01402                              1736
* IF GDTDBG = NULLPTR                                              1737
*   THEN;                                                          1737
         L     @04,GDTDBG(,@04)                                    1737
         LTR   @04,@04                                             1737
         BZ    @RT01737                                            1737
*   ELSE                                                           1739
*     CALL IDCDB010 (GDTTBL,'LRPT') ;                              1739
*                                                                  1739
         L     @04,@PC00001                                        1739
         ST    @04,@AL00001                                        1739
         LA    @15,@CC01402                                        1739
         ST    @15,@AL00001+4                                      1739
         MVI   @AL00001+4,X'80'                                    1739
         L     @15,GDTDBG(,@04)                                    1739
         LA    @01,@AL00001                                        1739
         BALR  @14,@15                                             1739
* DCL                                                              1740
*   TSTID           FIXED(31),     /* SUBSCRIPT OF ID WORD           */
*   TSTBIT64        CHAR(8),       /* FOR PASSING TO GEN,S           */
*   TST64BIT        CHAR(8),       /* THE 64 BIT TIMESTAMP           */
*   TSTDAYS         FIXED(31),     /* NBR FULL DAYS TIMESTAMP        */
*   TSTPDAY         FIXED(31),     /* PART OF DAY TIMESTAMP          */
* ENDCLSTS CHAR(1);                                                1740
*                                                                  1740
@RT01737 DS    0H                                                  1741
* TST64BIT = TSTBIT64 ;            /* FOR PLS AND GEN,S              */
         L     @04,@PC00029+4                                      1741
         MVC   TST64BIT(8),TSTBIT64(@04)                           1741
* RESPECIFY (REG2,REG3) RESTRICTED ;                               1742
* GEN (L    REG2,TST64BIT) ;       /* CAN NOT DO 64 BIT              */
         L    REG2,TST64BIT
* GEN (L    REG3,TST64BIT+4) ;     /* OPERATIONS IN PL/S             */
         L    REG3,TST64BIT+4
* GEN (SRDL REG2,12) ;             /* SHIFT DOWN TO MICROSEC         */
         SRDL REG2,12
* GEN (SRDL REG2,13) ;             /* DIVIDE DOWN TO DAYS AND        */
         SRDL REG2,13
* GEN (D    REG2,=F'10546875') ;   /* PARTS OF DAYS FOR PLS          */
         D    REG2,=F'10546875'
* GEN (ST   REG3,TSTDAYS) ;        /* SAVE NUMBER FULL DAYS          */
         ST   REG3,TSTDAYS
* GEN (LR   REG3,REG2) ;           /* CHANGE REMAINDER BACK          */
         LR   REG3,REG2
* GEN (M    REG2,=F'86400') ;      /* TO SECONDS                     */
         M    REG2,=F'86400'
* GEN (D    REG2,=F'10546875') ;   /* ( * 86400 / 10546875)          */
         D    REG2,=F'10546875'
* GEN (ST   REG3,TSTPDAY) ;        /* SAVE PARTS OF DAYS             */
         ST   REG3,TSTPDAY
* RESPECIFY (REG2,REG3) UNRESTRICTED ;                             1753
* TSTHMS(3) = TSTPDAY//60 ;        /* SAVE SECONDS                   */
         L     @04,TSTPDAY                                         1754
         LA    @15,60                                              1754
         LR    @00,@04                                             1754
         SRDA  @00,32                                              1754
         DR    @00,@15                                             1754
         STH   @00,TSTHMS+4                                        1754
* TSTPDAY = TSTPDAY/60 ;                                           1755
         LR    @00,@04                                             1755
         SRDA  @00,32                                              1755
         DR    @00,@15                                             1755
         ST    @01,TSTPDAY                                         1755
* TSTHMS(2) = TSTPDAY//60 ;        /* SAVE MINUTES                   */
         LR    @02,@01                                             1756
         SRDA  @02,32                                              1756
         DR    @02,@15                                             1756
         STH   @02,TSTHMS+2                                        1756
* TSTHMS(1) = TSTPDAY/60 ;         /* SAVE HOURS                     */
         LR    @02,@01                                             1757
         SRDA  @02,32                                              1757
         DR    @02,@15                                             1757
         STH   @03,TSTHMS                                          1757
*                                  /* TIME ZERO ON 1/1/1900          */
* TSTMDY(3) = (TSTDAYS/1461)*4 ;   /* SAVE YEAR ( - 0,1,2,3)         */
         L     @04,TSTDAYS                                         1758
         LA    @15,1461                                            1758
         LR    @00,@04                                             1758
         SRDA  @00,32                                              1758
         DR    @00,@15                                             1758
         SLA   @01,2                                               1758
         STH   @01,TSTMDY+4                                        1758
* TSTDAYS = TSTDAYS//1461 ;        /* 1461 DAYS PER QUADYEAR         */
         LR    @00,@04                                             1759
         SRDA  @00,32                                              1759
         DR    @00,@15                                             1759
         ST    @00,TSTDAYS                                         1759
* IF TSTDAYS <= 366                                                1760
*   THEN TSTMDTBL(2) = 29 ;        /* 1ST YEAR OF QUAD = LEAP        */
         C     @00,@CF01409                                        1760
         BH    @RF01760                                            1760
         MVI   TSTMDTBL+1,X'1D'                                    1761
*   ELSE TSTMDTBL(2) = 28 ;        /* AND FEB. HAS 28 OR 29          */
         B     @RC01760                                            1762
@RF01760 MVI   TSTMDTBL+1,X'1C'                                    1762
* IF TSTDAYS >= 366                                                1763
*   THEN                                                           1763
@RC01760 L     @04,TSTDAYS                                         1763
         LA    @15,366                                             1763
         CR    @04,@15                                             1763
         BL    @RF01763                                            1763
*     DO ;                                                         1764
*       TSTMDY(3) = TSTMDY(3) + 1; /* ADD 1ST LEAP YEAR              */
         LA    @14,1                                               1765
         AH    @14,TSTMDY+4                                        1765
         STH   @14,TSTMDY+4                                        1765
*       TSTDAYS = TSTDAYS - 366 ;                                  1766
         SLR   @04,@15                                             1766
         ST    @04,TSTDAYS                                         1766
*     END ;                                                        1767
* DO WHILE (TSTDAYS > 365) ;                                       1768
@RF01763 B     @DE01768                                            1768
@DL01768 DS    0H                                                  1769
*   TSTMDY(3) = TSTMDY(3) + 1 ;    /* ADD OTHER FULL YEARS           */
         LA    @04,1                                               1769
         AH    @04,TSTMDY+4                                        1769
         STH   @04,TSTMDY+4                                        1769
*   TSTDAYS = TSTDAYS - 365 ;                                      1770
         L     @04,TSTDAYS                                         1770
         SL    @04,@CF01411                                        1770
         ST    @04,TSTDAYS                                         1770
* END ;                                                            1771
@DE01768 L     @04,TSTDAYS                                         1771
         C     @04,@CF01411                                        1771
         BH    @DL01768                                            1771
* TSTDAYS = TSTDAYS + 1 ;          /* ADJUST (1900 NOT LEAP)         */
         LA    @15,1                                               1772
         ALR   @04,@15                                             1772
         ST    @04,TSTDAYS                                         1772
* TSTDAYS = TSTDAYS + 1 ;          /* ADJUST FOR ZERO                */
         ALR   @04,@15                                             1773
         ST    @04,TSTDAYS                                         1773
* DO MOSLOT = 1 TO 12 WHILE (TSTDAYS > TSTMDTBL(MOSLOT)) ;         1774
         LR    MOSLOT,@15                                          1774
@DL01774 L     @04,TSTDAYS                                         1774
         SLR   @03,@03                                             1774
         IC    @03,TSTMDTBL-1(MOSLOT)                              1774
         CR    @04,@03                                             1774
         BNH   @DC01774                                            1774
*   TSTDAYS = TSTDAYS - TSTMDTBL(MOSLOT) ;                         1775
         SLR   @04,@03                                             1775
         ST    @04,TSTDAYS                                         1775
* END ;                                                            1776
         AL    MOSLOT,@CF00222                                     1776
         C     MOSLOT,@CF00035                                     1776
         BNH   @DL01774                                            1776
@DC01774 DS    0H                                                  1777
* TSTMDY(1) = MOSLOT ;             /* SAVE MONTH                     */
         STH   MOSLOT,TSTMDY                                       1777
* TSTMDY(2) = TSTDAYS ;            /* AND FINALLY SAVE DAY           */
*                                                                  1778
         L     @04,TSTDAYS                                         1778
         STH   @04,TSTMDY+2                                        1778
* DARGLIST = '0'B ;                /* SET UP TO PRINT IT             */
         L     @04,DDSTRU                                          1779
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  1779
         MVI   DARGLIST(@04),B'00000000'                           1779
* DARGSMOD = 'LR0' ;                                               1780
         MVC   DARGSMOD(3,@04),@CC01335                            1780
* DARGSENT = 5 ;                                                   1781
         MVI   DARGSENT(@04),X'05'                                 1781
* DARGCNT = 7 ;                                                    1782
         MVC   DARGCNT(2,@04),@CH00040                             1782
* DARGINS(1) = 1 ;                                                 1783
         MVC   DARGINS(2,@04),@CH00222                             1783
* DARGINL(1) = 10 ;                                                1784
         LA    @15,10                                              1784
         STH   @15,DARGINL(,@04)                                   1784
* DARGDTM(1) = ADDR(TSTDESC(TSTID)) ;                              1785
         L     @14,@PC00029                                        1785
         ST    @14,@TF00001                                        1785
         L     @01,@TF00001                                        1785
         M     @14,TSTID(,@01)                                     1785
         LA    @15,TSTDESC-10(@15)                                 1785
         ST    @15,DARGDTM(,@04)                                   1785
* DO TSTSLOT = 2 TO 4 ;                                            1786
         LA    TSTSLOT,2                                           1786
@DL01786 DS    0H                                                  1787
*   DARGINS(TSTSLOT) = TSTSLOT ;                                   1787
         L     @04,DDSTRU                                          1787
         LR    @03,TSTSLOT                                         1787
         SLA   @03,3                                               1787
         STH   TSTSLOT,DARGINS-8(@03,@04)                          1787
*   DARGINL(TSTSLOT) = LENGTH(TSTMDY(TSTSLOT-1)) ;                 1788
         LA    @15,2                                               1788
         STH   @15,DARGINL-8(@03,@04)                              1788
*   DARGDTM(TSTSLOT) = ADDR(TSTMDY(TSTSLOT-1)) ;                   1789
         LR    @15,TSTSLOT                                         1789
         ALR   @15,@15                                             1789
         LA    @15,TSTMDY-4(@15)                                   1789
         ST    @15,DARGDTM-8(@03,@04)                              1789
* END ;                                                            1790
         AL    TSTSLOT,@CF00222                                    1790
         C     TSTSLOT,@CF00047                                    1790
         BNH   @DL01786                                            1790
* DO TSTSLOT = 5 TO 7 ;                                            1791
         LA    TSTSLOT,5                                           1791
@DL01791 DS    0H                                                  1792
*   DARGINS(TSTSLOT) = TSTSLOT ;                                   1792
         L     @04,DDSTRU                                          1792
         LR    @03,TSTSLOT                                         1792
         SLA   @03,3                                               1792
         STH   TSTSLOT,DARGINS-8(@03,@04)                          1792
*   DARGINL(TSTSLOT) = LENGTH(TSTHMS(TSTSLOT-4)) ;                 1793
         LA    @15,2                                               1793
         STH   @15,DARGINL-8(@03,@04)                              1793
*   DARGDTM(TSTSLOT) = ADDR(TSTHMS(TSTSLOT-4)) ;                   1794
         LR    @15,TSTSLOT                                         1794
         ALR   @15,@15                                             1794
         LA    @15,TSTHMS-10(@15)                                  1794
         ST    @15,DARGDTM-8(@03,@04)                              1794
* END ;                                                            1795
*                                                                  1795
         AL    TSTSLOT,@CF00222                                    1795
         C     TSTSLOT,@CF00040                                    1795
         BNH   @DL01791                                            1795
* CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                          1796
*                                                                  1796
         L     @04,@PC00001                                        1796
         ST    @04,@AL00001                                        1796
         LA    @15,IOCSPRT                                         1796
         ST    @15,@AL00001+4                                      1796
         LA    @15,DDSTRU                                          1796
         ST    @15,@AL00001+8                                      1796
         MVI   @AL00001+8,X'80'                                    1796
         L     @15,GDTPRT(,@04)                                    1796
         LA    @01,@AL00001                                        1796
         BALR  @14,@15                                             1796
*END PRTTIME ;                                                     1797
@EL00029 DS    0H                                                  1797
@EF00029 DS    0H                                                  1797
@ER00029 LM    @14,@12,@SA00029                                    1797
         BR    @14                                                 1797
* /*******************************************************************/
* /* PROCEDURE NAME - PRTVOL, PRINT VOLUME RECORD                    */
* /* FUNCTION -                                                      */
* /*   IF COMPARE, PASS TWICE THRU THE FOLLOWING, FIRST WITH         */
* /*   NO PRINTING LOOKING FOR ANY MISCOMPARE, SECOND TIME           */
* /*   PRINTING,                                                     */
* /*     FOR THE CRA COPY OF THE VOLUME RECORD (CI=9),               */
* /*     LOOP THRU HORIZONTAL EXTENSIONS,                            */
* /*       GET THE RECORD(S) PRINTING AS SPECIFIED,                  */
* /*       CALL VERTEXT TO HANDLE ALL VERTICAL EXTENSIONS,           */
* /*     IF CMPR SPECIFIED AND THERE WAS A MISCOMPARE NOTE           */
* /*     NAMES OF THE SIGNIFICANT FIELDS THAT MISCOMPARED,           */
* /*     BUMP COUNTS OF ENTRIES PROCESSED AND MISCOMPARED,           */
* /*   GET THE F4DSCB AND PRINT ALL TIMESTAMPS,                      */
* /* INPUTS -                                                        */
* /* OUTPUTS -                                                       */
* /*   LIST OF VOLUME RECORDS AS REQUESTED                           */
* /*   MCENTCNT (MISCOMPARE ENTRY COUNT)                             */
* /* CALLS -                                                         */
* /*   GETPRT, VERTEXT, PRTMCWD, UIOINFO, ERROR, PRTMCD,             */
* /*   SUMIT,                                                        */
* /*   IDCRC04(VOLTSTMP)                                             */
* /*******************************************************************/
*                                                                  1798
*PRTVOL: PROCEDURE ;                                               1798
PRTVOL   STM   @14,@12,@SA00030                                    1798
* IF GDTDBG = NULLPTR                                              1799
*   THEN;                                                          1799
         L     @15,@PC00001                                        1799
         L     @15,GDTDBG(,@15)                                    1799
         LTR   @15,@15                                             1799
         BZ    @RT01799                                            1799
*   ELSE                                                           1801
*     CALL IDCDB010 (GDTTBL,'LRPW') ;                              1801
         L     @15,@PC00001                                        1801
         ST    @15,@AL00001                                        1801
         LA    @14,@CC01415                                        1801
         ST    @14,@AL00001+4                                      1801
         MVI   @AL00001+4,X'80'                                    1801
         L     @15,GDTDBG(,@15)                                    1801
         LA    @01,@AL00001                                        1801
         BALR  @14,@15                                             1801
* OLDERID2 = NEWERID2;                                             1802
@RT01799 L     @15,@PC00001                                        1802
         L     @15,GDTTR2(,@15)                                    1802
         MVC   @TS00001(95),NEWERID2(@15)                          1802
         MVC   OLDERID2(95,@15),@TS00001                           1802
* NEWID2 = 'LRPW' ;                                                1803
*                                                                  1803
         MVC   NEWID2(4,@15),@CC01415                              1803
* CALL SUMIT (SMACCUM,CATRCTYP($VOL)) ;     /* ADD VOLUME TO         */
         LA    @15,SMACCUM                                         1804
         ST    @15,@AL00001                                        1804
         SLR   @15,@15                                             1804
         IC    @15,$VOL                                            1804
         MH    @15,@CH00042                                        1804
         LA    @15,CATRCTYP-5(@15)                                 1804
         ST    @15,@AL00001+4                                      1804
         LA    @01,@AL00001                                        1804
         BAL   @14,SUMIT                                           1804
*                             /* ENTRIES PROCESED COUNT TABLE        */
* CMPRPASW = OFF ;            /* SET UP CONTROL SWITCHES             */
         NI    CMPRPASW,B'01111111'                                1805
* PRNTPASW = OFF ;            /* MAKING A COMPARE PASS THRU          */
         NI    PRNTPASW,B'01111111'                                1806
* IF CMPRSW = ON              /* LOGIC BEFORE THE ACTUAL             */
*   THEN CMPRPASW = ON ;      /* PRINTING PASS IF COMPARE            */
         TM    CMPRSW,B'01000000'                                  1807
         BNO   @RF01807                                            1807
         OI    CMPRPASW,B'10000000'                                1808
*   ELSE PRNTPASW = ON ;                                           1809
         B     @RC01807                                            1809
@RF01807 OI    PRNTPASW,B'10000000'                                1809
* BASETYPE = CATRCTYP($VOL) ;                                      1810
@RC01807 SLR   @15,@15                                             1810
         IC    @15,$VOL                                            1810
         MH    @15,@CH00042                                        1810
         LA    @14,CATRCTYP-5(@15)                                 1810
         MVC   BASETYPE(1),0(@14)                                  1810
* CIBASE = CTTBASE + 1 ;           /* FIXED CI LOCA OF VOL RC        */
         MVC   CIBASE(3),@CF00038+1                                1811
* MSCMPRSW = OFF ;                                                 1812
*                                                                  1812
         NI    MSCMPRSW,B'11110111'                                1812
* /*******************************************************************/
* /* PASS THRU TWICE IF COMPARE SO ONLY MISCOMPARES                  */
* /* WILL PRINT                                                      */
* /*******************************************************************/
*                                                                  1813
* DO WHILE (CMPRPASW = ON × PRNTPASW = ON) ;                       1813
         B     @DE01813                                            1813
@DL01813 DS    0H                                                  1814
*   CIFRGET = CIBASE ;                                             1814
*                                                                  1814
         MVC   CIFRGET(3),CIBASE                                   1814
*   /*****************************************************************/
*   /* LOOP: THRU ALL HORIZONTAL EXTENSION RECORDS (IF ANY)          */
*   /*****************************************************************/
*                                                                  1815
*   DO WHILE ((CIFRGET ^= '0'B)         /* NO MORE HORIZ EXTNS       */
*         & (^(CMPRPASW = ON            /* QUIT AFTER FIRST          */
*              & MSCMPRSW = ON))) ;     /* MISCOMPARE ALSO           */
*                                                                  1815
         B     @DE01815                                            1815
@DL01815 DS    0H                                                  1816
*     CALL GETPRT ;                /* GET (PRINT) BASE RECORD        */
*                                                                  1816
         BAL   @14,GETPRT                                          1816
*     IF    (PRNTPASW = ON & DUMPSW = OFF)                         1817
*        × (CMPRPASW = ON & MSCMPRSW = ON)                         1817
*       THEN CIFRGET = '0'B ;      /* OR GET OUT OF THIS LOOP        */
*                                                                  1817
         TM    PRNTPASW,B'10000000'                                1817
         BNO   @GL00088                                            1817
         TM    DUMPSW,B'00000100'                                  1817
         BZ    @RT01817                                            1817
@GL00088 TM    CMPRPASW,B'10000000'                                1817
         BNO   @RF01817                                            1817
         TM    MSCMPRSW,B'00001000'                                1817
         BNO   @RF01817                                            1817
@RT01817 DS    0H                                                  1818
         SLR   @15,@15                                             1818
         STCM  @15,7,CIFRGET                                       1818
*       ELSE CALL VERTEXT ;        /* DO VERTICAL EXTENSIONS         */
*                                                                  1819
         B     @RC01817                                            1819
@RF01817 BAL   @14,VERTEXT                                         1819
*   END ;                                                          1820
@RC01817 DS    0H                                                  1820
@DE01815 L     @15,CIFRGET-1                                       1820
         LA    @15,0(,@15)                                         1820
         LTR   @15,@15                                             1820
         BZ    @DC01815                                            1820
         TM    CMPRPASW,B'10000000'                                1820
         BNO   @DL01815                                            1820
         TM    MSCMPRSW,B'00001000'                                1820
         BNO   @DL01815                                            1820
@DC01815 DS    0H                                                  1821
*   CIFRGET = CIBASE ;                                             1821
         MVC   CIFRGET(3),CIBASE                                   1821
*   IF     PRNTPASW = ON                                           1822
*      & CMPRSW = ON                                               1822
*                                                                  1822
*     THEN CALL PRTMCWD(2,         /* NOTE LEVEL OF MISCMPR          */
         TM    PRNTPASW,B'10000000'                                1822
         BNO   @RF01822                                            1822
         TM    CMPRSW,B'01000000'                                  1822
         BNO   @RF01822                                            1822
*                       MCARGTBV,MCMSGTBV,MCMLNTBV) ;              1823
*                                                                  1823
         LA    @01,@AL01823                                        1823
         BAL   @14,PRTMCWD                                         1823
*   PRNTPASW = OFF ;               /* TURN OFF AFTER PRINTING        */
@RF01822 NI    PRNTPASW,B'01111111'                                1824
*   IF CMPRPASW = ON & MSCMPRSW = ON                               1825
*     THEN                         /* MISCOMPARE FOUND SO            */
         TM    CMPRPASW,B'10000000'                                1825
         BNO   @RF01825                                            1825
         TM    MSCMPRSW,B'00001000'                                1825
         BNO   @RF01825                                            1825
*       DO ;                                                       1826
*         PRNTPASW = ON ;          /* PASS THRU AGAIN PRINTIN        */
         OI    PRNTPASW,B'10000000'                                1827
*         MCENTCNT = MCENTCNT + 1 ;                                1828
         LH    @01,MCENTCNT                                        1828
         LA    @01,1(,@01)                                         1828
         STH   @01,MCENTCNT                                        1828
*       END ;                                                      1829
*   CMPRPASW = OFF ;                                               1830
@RF01825 NI    CMPRPASW,B'01111111'                                1830
* END ;                                                            1831
@DE01813 TM    CMPRPASW,B'10000000'                                1831
         BO    @DL01813                                            1831
         TM    PRNTPASW,B'10000000'                                1831
         BO    @DL01813                                            1831
* FMPLFLNO = 1 ;                                                   1832
         L     @15,FMPLAD                                          1832
         MVI   FMPLFLNO(@15),X'01'                                 1832
* FMFLDNAM = ADDR('VOLTSTMP') ;    /* SET UP FIELD MGMT              */
         LA    @14,@CC01416                                        1833
         ST    @14,FMFLDNAM(,FMFLCUR)                              1833
* FMPLBCIN = CTTCATCI(1) ;                                         1834
         L     @14,CTTPTR                                          1834
         MVC   FMPLBCIN(3,@15),CTTCATCI(@14)                       1834
* IF CMPRSW = ON                                                   1835
*   THEN                                                           1835
         TM    CMPRSW,B'01000000'                                  1835
         BNO   @RF01835                                            1835
*     DO ;                                                         1836
*       FMUBFPTR = IOCTBPTR ;      /* TELL WANT CATALOG FIELD        */
         L     @14,IOCTBPTR                                        1837
         ST    @14,FMUBFPTR                                        1837
*       FMUIOCSI = IOCSCAT ;                                       1838
         L     @14,IOCSCAT                                         1838
         ST    @14,FMUIOCSI                                        1838
*       FMUCATIO = ON ;                                            1839
         OI    FMUCATIO,B'01000000'                                1839
*       REG1 = FMPLAD ;                                            1840
*                                                                  1840
         LR    REG1,@15                                            1840
*       CALL IDCRC04 ;             /* ASK VOL RECORD TIMSTMP         */
*                                                                  1841
         L     @15,@CV00793                                        1841
         BALR  @14,@15                                             1841
*       FMUBFPTR = IOCRBPTR ;      /* SET BACK TO ASSUMED VLU        */
         L     @15,IOCRBPTR                                        1842
         ST    @15,FMUBFPTR                                        1842
*       FMUIOCSI = IOCSCRA ;                                       1843
         L     @15,IOCSCRA                                         1843
         ST    @15,FMUIOCSI                                        1843
*       FMUCATIO = OFF ;                                           1844
         NI    FMUCATIO,B'10111111'                                1844
*       IF FMFLENTH ^= 0                                           1845
*         THEN CALL PRTTIME (1,VOLTSTMP) ;   /* CATVOLRCD            */
         L     @15,FMFLENTH(,FMFLCUR)                              1845
         LTR   @15,@15                                             1845
         BZ    @RF01845                                            1845
         LA    @15,@CF00222                                        1846
         ST    @15,@AL00001                                        1846
         L     @01,FMFLADDR(,FMFLCUR)                              1846
         ST    @01,@AL00001+4                                      1846
         LA    @01,@AL00001                                        1846
         BAL   @14,PRTTIME                                         1846
*         ELSE                                                     1847
*             DO;                                          /*@OZ09388*/
         B     @RC01845                                            1847
@RF01845 DS    0H                                                  1848
*               PROCMSG='PRTVOL  '; /* PROC NAME FOR MESSAGE @OZ09388*/
         MVC   PROCMSG(8),@CC01417                                 1848
*               CALL ERROR (22,$RETURN);                   /*@OZ09388*/
         LA    @01,@AL01849                                        1849
         BAL   @14,ERROR                                           1849
*             END;                                         /*@OZ09388*/
*     END ;                                                        1851
@RC01845 DS    0H                                                  1852
* REG1 = FMPLAD ;                                                  1852
*                                                                  1852
@RF01835 L     REG1,FMPLAD                                         1852
* CALL IDCRC04 ;                   /* ASK VOL RECORD TIMSTMP         */
*                                                                  1853
         L     @15,@CV00793                                        1853
         BALR  @14,@15                                             1853
* IF FMFLENTH ^= 0                                                 1854
*   THEN CALL PRTTIME (2,VOLTSTMP) ;         /* CRAVOLRCD            */
         L     @15,FMFLENTH(,FMFLCUR)                              1854
         LTR   @15,@15                                             1854
         BZ    @RF01854                                            1854
         LA    @15,@CF00158                                        1855
         ST    @15,@AL00001                                        1855
         L     @01,FMFLADDR(,FMFLCUR)                              1855
         ST    @01,@AL00001+4                                      1855
         LA    @01,@AL00001                                        1855
         BAL   @14,PRTTIME                                         1855
*   ELSE                                                           1856
*       DO;                                                /*@OZ09388*/
         B     @RC01854                                            1856
@RF01854 DS    0H                                                  1857
*          PROCMSG='PRTVOL  '; /* PROC NAME FOR MESSAGE      @OZ09388*/
         MVC   PROCMSG(8),@CC01417                                 1857
*          CALL ERROR (23,$RETURN);                        /*@OZ09388*/
         LA    @01,@AL01858                                        1858
         BAL   @14,ERROR                                           1858
*       END;                                               /*@OZ09388*/
*                                  /* GET F4DSCB TIMESTAMPS          */
* CALL IDCIOSI0 (GDTTBL,IOINBYTE,TSTPTR,IFILEVAL(CRACNT)) ;        1860
*                                                                  1860
@RC01854 L     @15,@PC00001                                        1860
         ST    @15,@AL00001                                        1860
         LA    @14,IOINBYTE                                        1860
         ST    @14,@AL00001+4                                      1860
         LA    @14,TSTPTR                                          1860
         ST    @14,@AL00001+8                                      1860
         L     @14,CRACNT-1                                        1860
         LA    @14,0(,@14)                                         1860
         MH    @14,@CH00037                                        1860
         L     @03,@PC00001+4                                      1860
         L     @01,FDTPTR(,@03)                                    1860
         AL    @01,@CF01473                                        1860
         LA    @14,IFILEVAL-3(@14,@01)                             1860
         ST    @14,@AL00001+12                                     1860
         MVI   @AL00001+12,X'80'                                   1860
         L     @15,GDTIFO(,@15)                                    1860
         LA    @01,@AL00001                                        1860
         BALR  @14,@15                                             1860
* RESPECIFY RTNREG RSTD;                                           1861
* TESTRC = RTNREG;                                                 1862
         STH   RTNREG,TESTRC                                       1862
* RESPECIFY RTNREG UNRSTD ;                                        1863
* IF TESTRC = 0                                                    1864
*   THEN                                                           1864
         LH    @15,TESTRC                                          1864
         LTR   @15,@15                                             1864
         BNZ   @RF01864                                            1864
*     DO ;                                                         1865
*       CALL PRTTIME (3,F4TSTVSM) ;          /* F4DSCBVSAM           */
         LA    @15,@CF00166                                        1866
         ST    @15,@AL00001                                        1866
         LA    @15,F4TSTVSM                                        1866
         ST    @15,@AL00001+4                                      1866
         LA    @01,@AL00001                                        1866
         BAL   @14,PRTTIME                                         1866
*       CALL PRTTIME (4,F4TSTDMP) ;          /* F4DSCBDUMP           */
         LA    @15,@CF00047                                        1867
         ST    @15,@AL00001                                        1867
         LA    @15,F4TSTDMP                                        1867
         ST    @15,@AL00001+4                                      1867
         LA    @01,@AL00001                                        1867
         BAL   @14,PRTTIME                                         1867
*     END ;                                                        1868
*   ELSE CALL ERROR (24,$RETURN) ;                                 1869
*                                                                  1869
         B     @RC01864                                            1869
@RF01864 LA    @01,@AL01869                                        1869
         BAL   @14,ERROR                                           1869
*END PRTVOL ;                                                      1870
@EL00030 DS    0H                                                  1870
@EF00030 DS    0H                                                  1870
@ER00030 LM    @14,@12,@SA00030                                    1870
         BR    @14                                                 1870
* /*******************************************************************/
* /* PROCEDURE NAME - PRTVSAM, PRINT VSAM STRUCTURES                 */
* /* FUNCTION -                                                      */
* /*   IF COMPARE, PASS TWICE THRU THE FOLLOWING, FIRST              */
* /*   WITH NO PRINTING LOOKING FOR ANY MISCOMPARE,                  */
* /*   SECOND TIME PRINTING IF THERE WAS ONE,                        */
* /*     LOOP THRU ASSOCTBL (PRINT ALL EXCEPT :                      */
* /*     (FOR BASE CLUSTER,S AIX ASSOCIATIONS - NAME ONLY),          */
* /*     (FOR BASE AIX,S CLUSTER ASSOCIATION - IGNORE)),             */
* /*       LOOP THRU HORIZONTAL EXTENSIONS,                          */
* /*         GET THE RECORD(S), PRINTING AS SPECIFIED, AND           */
* /*         FIRST TIME INITIALIZE THE ASSOCTBL,                     */
* /*         CALL VERTEXT TO HANDLE ANY VERTICAL EXTENSIONS          */
* /*       IF DATA RECORD ADD UPGRADE TO ASSOCTBL (IF 1),            */
* /*       IF COMPARE AND DATA OR INDEX, NOTE THE NAMES OF           */
* /*       SIGNIFICANT ITEMS THAT MISCOMPARED,                       */
* /*       IF BASE CLUSTER,S AIX ASSOCIATION CALL PRTAAXV TO         */
* /*       ADD AIX,S VOLUMES FOR REFERENCE,                          */
* /*       BUMP COUNTS OF NUMBER OF ENTRIES AND MISCOMPARES          */
* /* INPUTS -                                                        */
* /*   SORTTBL ENTRY IDENTIFIED BY STSLOT                            */
* /* OUTPUTS -                                                       */
* /*   LISTING OF VSAM STRUCTURES AS REQUESTED                       */
* /*   MCENTCNT (MISCOMPARE ENTRIES COUNT)                           */
* /* CALLS -                                                         */
* /*   GETPRT, INTASOC, VERTEXT, PRTMCWD, PRTAAXV, ADDASOC,          */
* /*   SUMIT                                                         */
* /*******************************************************************/
*                                                                  1871
* PRTVSAM: PROCEDURE ;                                             1871
PRTVSAM  STM   @14,@12,@SA00031                                    1871
*   OLDERID2 = NEWERID2;                                           1872
         L     @02,@PC00001                                        1872
         L     @15,GDTTR2(,@02)                                    1872
         MVC   @TS00001(95),NEWERID2(@15)                          1872
         MVC   OLDERID2(95,@15),@TS00001                           1872
*   NEWID2 = 'LRPV' ;                                              1873
         MVC   NEWID2(4,@15),@CC01421                              1873
*   IF GDTDBG = NULLPTR                                            1874
*     THEN;                                                        1874
         L     @02,GDTDBG(,@02)                                    1874
         LTR   @02,@02                                             1874
         BZ    @RT01874                                            1874
*     ELSE                                                         1876
*       CALL IDCDB010 (GDTTBL,'LRPV') ;                            1876
*                                                                  1876
         L     @02,@PC00001                                        1876
         ST    @02,@AL00001                                        1876
         LA    @15,@CC01421                                        1876
         ST    @15,@AL00001+4                                      1876
         MVI   @AL00001+4,X'80'                                    1876
         L     @15,GDTDBG(,@02)                                    1876
         LA    @01,@AL00001                                        1876
         BALR  @14,@15                                             1876
*   CMPRPASW = OFF ;               /* SET CONTROL SWITCHES           */
@RT01874 NI    CMPRPASW,B'01111111'                                1877
*   PRNTPASW = OFF ;               /* FOR ONE ONLY OR                */
         NI    PRNTPASW,B'01111111'                                1878
*   IF CMPRSW = ON                 /* (IF COMPARE) POSSIBLE          */
*     THEN                         /* TWO PASSES THRU LOGIC,         */
         TM    CMPRSW,B'01000000'                                  1879
         BNO   @RF01879                                            1879
*       CMPRPASW = ON ;            /* 1 - LOOK FOR MISCOMPARE        */
         OI    CMPRPASW,B'10000000'                                1880
*     ELSE                         /* 2 - PRINT IF MISCOMPARE        */
*       PRNTPASW = ON ;            /* WAS FOUND                      */
         B     @RC01879                                            1881
@RF01879 OI    PRNTPASW,B'10000000'                                1881
*   MSCMPRSW = OFF ;                                               1882
@RC01879 NI    MSCMPRSW,B'11110111'                                1882
*   ENTNOCUR = 0 ;                 /* FOR COUNTING ENTRIES           */
         SLR   @02,@02                                             1883
         STH   @02,ENTNOCUR                                        1883
*   ENTNOSAV = 0 ;                                                 1884
*                                                                  1884
         STH   @02,ENTNOSAV                                        1884
*   /*****************************************************************/
*   /* PASS THRU TWICE IF COMPARE SO ONLY THE MISCOMPARES            */
*   /* WILL PRINT                                                    */
*   /*****************************************************************/
*                                                                  1885
*   DO WHILE (CMPRPASW = ON × PRNTPASW = ON) ;                     1885
         B     @DE01885                                            1885
@DL01885 DS    0H                                                  1886
*     FRSTIMSW = YES ;                                             1886
         OI    FRSTIMSW,B'00000010'                                1886
*     INDNTCOL = 0 ;                                               1887
         MVI   INDNTCOL,X'00'                                      1887
*     ATCRACI(1) = STCRACI(STSLOT);/* STO BASE CI AS 1ST ASOC        */
         L     @02,ATRA2PTR                                        1888
         LR    @15,STSLOT                                          1888
         MH    @15,@CH01068                                        1888
         L     @01,STPTR                                           1888
         ALR   @01,@15                                             1888
         AL    @01,@CF01477                                        1888
         MVC   ATCRACI(3,@02),STCRACI-45(@01)                      1888
*     ATENTYP(1) = '0'B ;          /* WITH UNKNOWN TYPES FOR         */
         MVI   ATENTYP(@02),B'00000000'                            1889
*     BASETYPE = '0'B ;            /* ASSOCTBL INITILIZE             */
*                                                                  1890
         MVI   BASETYPE,B'00000000'                                1890
*     /***************************************************************/
*     /* LOOP: THRU ALL ENTRIES IN THE ASSOCTBL INCLUDING            */
*     /*       THE FIRST DUMMY ONE (CLUS OR AIX) FOR GETTING         */
*     /*       STARTED                                               */
*     /***************************************************************/
*                                                                  1891
*     DO ATSLOT = 1 TO NBRATS                                      1891
*        WHILE (ATCRACI(ATSLOT) ^= '0'B                            1891
*           & LASTATSW ^= ON                                       1891
*           & ^(CMPRPASW = ON                                      1891
*               & MSCMPRSW = ON)) ;                                1891
         LA    ATSLOT,1                                            1891
@DL01891 LR    @15,ATSLOT                                          1891
         SLA   @15,2                                               1891
         L     @01,ATRA2PTR                                        1891
         L     @15,ATCRACI-5(@15,@01)                              1891
         LA    @15,0(,@15)                                         1891
         LTR   @15,@15                                             1891
         BZ    @DC01891                                            1891
         TM    LASTATSW,B'00100000'                                1891
         BO    @DC01891                                            1891
         TM    CMPRPASW,B'10000000'                                1891
         BNO   @DB01891                                            1891
         TM    MSCMPRSW,B'00001000'                                1891
         BO    @DC01891                                            1891
@DB01891 DS    0H                                                  1892
*       SAVESW1 = OFF ;                                            1892
         NI    SAVESW1,B'11011111'                                 1892
*       IF DUMPSW = ON             /* SAVE DUMP SWITCH FOR           */
*         THEN SAVESW = ON ;       /* MAY BE TEMP USED BELOW         */
         TM    DUMPSW,B'00000100'                                  1893
         BNO   @RF01893                                            1893
         OI    SAVESW,B'01000000'                                  1894
*       ASOCTYP = ATENTYP(ATSLOT) ;                                1895
@RF01893 LR    @15,ATSLOT                                          1895
         SLA   @15,2                                               1895
         L     @01,ATRA2PTR                                        1895
         ALR   @01,@15                                             1895
         MVC   ASOCTYP(1),ATENTYP-4(@01)                           1895
*       IF    (BASETYPE = CATRCTYP($CLUS)    /* IF                   */
*          & ASOCTYP = CATRCTYP($AIX))       /* REFERENCE            */
*          × (BASETYPE = CATRCTYP($AIX)      /* ONLY                 */
*          & ASOCTYP = CATRCTYP($CLUS))      /* PRINTING             */
*         THEN                                                     1896
         LA    @15,5                                               1896
         SLR   @01,@01                                             1896
         IC    @01,$CLUS                                           1896
         MR    @00,@15                                             1896
         LA    @14,CATRCTYP-5(@01)                                 1896
         CLC   BASETYPE(1),0(@14)                                  1896
         BNE   @GL00099                                            1896
         SLR   @01,@01                                             1896
         IC    @01,$AIX                                            1896
         MR    @14,@01                                             1896
         LA    @14,CATRCTYP-5(@15)                                 1896
         CLC   ASOCTYP(1),0(@14)                                   1896
         BE    @RT01896                                            1896
@GL00099 LA    @15,5                                               1896
         SLR   @01,@01                                             1896
         IC    @01,$AIX                                            1896
         MR    @00,@15                                             1896
         LA    @14,CATRCTYP-5(@01)                                 1896
         CLC   BASETYPE(1),0(@14)                                  1896
         BNE   @RF01896                                            1896
         SLR   @01,@01                                             1896
         IC    @01,$CLUS                                           1896
         MR    @14,@01                                             1896
         LA    @14,CATRCTYP-5(@15)                                 1896
         CLC   ASOCTYP(1),0(@14)                                   1896
         BNE   @RF01896                                            1896
@RT01896 DS    0H                                                  1897
*           DO ;                                                   1897
*             DUMPSW = OFF ;       /* DO NOT DUMP PRINT              */
         NI    DUMPSW,B'11111011'                                  1898
*             NOCNTSW = ON ;       /* OR COUNT THESE ENTRIES         */
         OI    NOCNTSW,B'00000001'                                 1899
*           END ;                                                  1900
*       CIBASE = ATCRACI(ATSLOT) ;                                 1901
@RF01896 LR    @15,ATSLOT                                          1901
         SLA   @15,2                                               1901
         L     @01,ATRA2PTR                                        1901
         ALR   @01,@15                                             1901
         MVC   CIBASE(3),ATCRACI-4(@01)                            1901
*       CIFRGET = CIBASE ;                                         1902
*                                                                  1902
         MVC   CIFRGET(3),CIBASE                                   1902
*       /*************************************************************/
*       /* LOOP: THRU ALL HORIZONTAL EXTENSION RECORDS               */
*       /*       (IF ANY)                                            */
*       /*************************************************************/
*                                                                  1903
*       DO WHILE ((CIFRGET ^= '0'B)                                1903
*             & (^(CMPRPASW = ON             /* QUIT AFTER           */
*                  & MSCMPRSW = ON))) ;      /* FIRST MSCMPR         */
*                                                                  1903
         B     @DE01903                                            1903
@DL01903 DS    0H                                                  1904
*         CALL GETPRT ;            /* GET (PRINT) BASE RECORD        */
*                                                                  1904
         BAL   @14,GETPRT                                          1904
*         IF FRSTIMSW = YES                                        1905
*           THEN                                                   1905
         TM    FRSTIMSW,B'00000010'                                1905
         BNO   @RF01905                                            1905
*             DO ;                                                 1906
*                                                                  1906
*               CALL INTASOC(2) ;  /* BUILD ASSOCTBL                 */
*                                                                  1907
         LA    @01,@AL01907                                        1907
         BAL   @14,INTASOC                                         1907
*               ATENTYP(1) = STENTYP(STSLOT) ;                     1908
         L     @15,ATRA2PTR                                        1908
         LR    @14,STSLOT                                          1908
         MH    @14,@CH01068                                        1908
         L     @01,STPTR                                           1908
         ALR   @01,@14                                             1908
         AL    @01,@CF01484                                        1908
         MVC   ATENTYP(1,@15),STENTYP-44(@01)                      1908
*               BASETYPE = ATENTYP(1) ;      /* REAL VALUE           */
         MVC   BASETYPE(1),ATENTYP(@15)                            1909
*             END ;                                                1910
*         FRSTIMSW = NO ;                                          1911
*                                                                  1911
@RF01905 NI    FRSTIMSW,B'11111101'                                1911
*         CALL VERTEXT ;           /* DO VERTICAL EXTENSIONS         */
*                                                                  1912
         BAL   @14,VERTEXT                                         1912
*       END ;                                                      1913
@DE01903 L     @15,CIFRGET-1                                       1913
         LA    @15,0(,@15)                                         1913
         LTR   @15,@15                                             1913
         BZ    @DC01903                                            1913
         TM    CMPRPASW,B'10000000'                                1913
         BNO   @DL01903                                            1913
         TM    MSCMPRSW,B'00001000'                                1913
         BNO   @DL01903                                            1913
@DC01903 DS    0H                                                  1914
*       CIFRGET = CIBASE ;                                         1914
         MVC   CIFRGET(3),CIBASE                                   1914
*       IF ASOCTYP = CATRCTYP($DATA)                               1915
*         THEN                     /* UPGRADE ASSOC IN DATA          */
*                                                                  1915
         LA    @15,5                                               1915
         SLR   @01,@01                                             1915
         IC    @01,$DATA                                           1915
         MR    @00,@15                                             1915
         LA    @14,CATRCTYP-5(@01)                                 1915
         CLC   ASOCTYP(1),0(@14)                                   1915
         BNE   @RF01915                                            1915
*           CALL ADDASOC(CATRCTYP($UPGD)) ;                        1916
*                                                                  1916
         SLR   @01,@01                                             1916
         IC    @01,$UPGD                                           1916
         MR    @14,@01                                             1916
         LA    @15,CATRCTYP-5(@15)                                 1916
         ST    @15,@AL00001                                        1916
         LA    @01,@AL00001                                        1916
         BAL   @14,ADDASOC                                         1916
*       IF     PRNTPASW = ON       /* SEE IF MISCOMPARE WORDS        */
*          & CMPRSW = ON           /* SHOULD BE PRINTED              */
*          & CTTMCSW(CIFRGET - CTTBASE) = ON                       1917
*         THEN                                                     1917
@RF01915 TM    PRNTPASW,B'10000000'                                1917
         BNO   @RF01917                                            1917
         TM    CMPRSW,B'01000000'                                  1917
         BNO   @RF01917                                            1917
         L     @15,CIFRGET-1                                       1917
         LA    @15,0(,@15)                                         1917
         SLA   @15,3                                               1917
         L     @01,CTTPTR                                          1917
         ALR   @01,@15                                             1917
         AL    @01,@CF01491                                        1917
         TM    CTTMCSW-8(@01),B'01000000'                          1917
         BNO   @RF01917                                            1917
*          IF   (ASOCTYP = CATRCTYP($DATA)                         1918
*             × ASOCTYP = CATRCTYP($INDX))                         1918
*                                                                  1918
*               THEN CALL PRTMCWD  /* USE ALL MISCMPR GROUPS         */
         LA    @15,5                                               1918
         SLR   @01,@01                                             1918
         IC    @01,$DATA                                           1918
         MR    @00,@15                                             1918
         LA    @14,CATRCTYP-5(@01)                                 1918
         CLC   ASOCTYP(1),0(@14)                                   1918
         BE    @RT01918                                            1918
         SLR   @01,@01                                             1918
         IC    @01,$INDX                                           1918
         MR    @14,@01                                             1918
         LA    @14,CATRCTYP-5(@15)                                 1918
         CLC   ASOCTYP(1),0(@14)                                   1918
         BNE   @RF01918                                            1918
@RT01918 DS    0H                                                  1919
*                         (99,MCARGTBL,MCMSGTBL,MCMLNTBL) ;        1919
         LA    @01,@AL01919                                        1919
         BAL   @14,PRTMCWD                                         1919
*               ELSE CALL PRTMCWD  /* USE ONLY FIRST GROUP           */
*                         (1,MCARGTBL,MCMSGTBL,MCMLNTBL) ;         1920
*                                                                  1920
         B     @RC01918                                            1920
@RF01918 LA    @01,@AL01920                                        1920
         BAL   @14,PRTMCWD                                         1920
*         ELSE ;                                                   1921
@RF01917 DS    0H                                                  1922
*       IF    PRNTPASW = ON                                        1922
*         & BASETYPE = CATRCTYP($CLUS)                             1922
*         & ASOCTYP = CATRCTYP($AIX)                               1922
*                                                                  1922
*         THEN CALL PRTAAXV ;      /* PRINT AIX VOLUMES INFO         */
*                                                                  1922
@RC01917 TM    PRNTPASW,B'10000000'                                1922
         BNO   @RF01922                                            1922
         LA    @15,5                                               1922
         SLR   @01,@01                                             1922
         IC    @01,$CLUS                                           1922
         MR    @00,@15                                             1922
         LA    @14,CATRCTYP-5(@01)                                 1922
         CLC   BASETYPE(1),0(@14)                                  1922
         BNE   @RF01922                                            1922
         SLR   @01,@01                                             1922
         IC    @01,$AIX                                            1922
         MR    @14,@01                                             1922
         LA    @14,CATRCTYP-5(@15)                                 1922
         CLC   ASOCTYP(1),0(@14)                                   1922
         BNE   @RF01922                                            1922
         BAL   @14,PRTAAXV                                         1923
*       ENTNOCUR = ENTNOCUR + 1 ;  /* AVOID COUNTING TWICE           */
@RF01922 LH    @01,ENTNOCUR                                        1924
         LA    @01,1(,@01)                                         1924
         STH   @01,ENTNOCUR                                        1924
*       IF       NOCNTSW = OFF     /* IF REF ONLY OR 2 PASS          */
*          & ((PRNTPASW = ON & CMPRSW = OFF)                       1925
*             × ENTNOCUR > ENTNOSAV)                               1925
*                                                                  1925
*         THEN CALL SUMIT (SMACCUM,ATENTYP(ATSLOT)) ;              1925
*                                                                  1925
         TM    NOCNTSW,B'00000001'                                 1925
         BNZ   @RF01925                                            1925
         TM    PRNTPASW,B'10000000'                                1925
         BNO   @GL00110                                            1925
         TM    CMPRSW,B'01000000'                                  1925
         BZ    @RT01925                                            1925
@GL00110 LH    @15,ENTNOCUR                                        1925
         CH    @15,ENTNOSAV                                        1925
         BNH   @RF01925                                            1925
@RT01925 DS    0H                                                  1926
         LA    @15,SMACCUM                                         1926
         ST    @15,@AL00001                                        1926
         LR    @15,ATSLOT                                          1926
         SLA   @15,2                                               1926
         L     @01,ATRA2PTR                                        1926
         LA    @15,ATENTYP-4(@15,@01)                              1926
         ST    @15,@AL00001+4                                      1926
         LA    @01,@AL00001                                        1926
         BAL   @14,SUMIT                                           1926
*       NOCNTSW = OFF ;                                            1927
@RF01925 NI    NOCNTSW,B'11111110'                                 1927
*       IF SAVESW = ON                                             1928
*         THEN  DUMPSW = ON ;                                      1928
         TM    SAVESW,B'01000000'                                  1928
         BNO   @RF01928                                            1928
         OI    DUMPSW,B'00000100'                                  1929
*       IF ATSLOT = NBRATS         /* IF AT END OF TABLE             */
*         THEN                                                     1930
@RF01928 C     ATSLOT,@CF00038                                     1930
         BNE   @RF01930                                            1930
*           IF ATNXTTBL ^= '0'B    /* AND THERE IS ANOTHER           */
*             THEN                                                 1931
         L     @01,ATRA2PTR                                        1931
         L     @15,ATNXTTBL(,@01)                                  1931
         LTR   @15,@15                                             1931
         BZ    @RF01931                                            1931
*               DO ;                                               1932
*                 ATRA2PTR = ATNXTTBL ; /* BUMP TO NEXT TABLE        */
         ST    @15,ATRA2PTR                                        1933
*                 ATSLOT = 0 ;                                     1934
         SLR   ATSLOT,ATSLOT                                       1934
*               END ;                                              1935
*             ELSE LASTATSW = ON ;                                 1936
         B     @RC01931                                            1936
@RF01931 OI    LASTATSW,B'00100000'                                1936
*       INDNTCOL = 2 ;                                             1937
@RC01931 DS    0H                                                  1937
@RF01930 MVI   INDNTCOL,X'02'                                      1937
*     END ;                        /* ASSOCTBL LOOP                  */
         AL    ATSLOT,@CF00222                                     1938
         C     ATSLOT,@CF00038                                     1938
         BNH   @DL01891                                            1938
@DC01891 DS    0H                                                  1939
*     ATRA2PTR = ATPTR ;                                           1939
         L     @02,ATPTR                                           1939
         ST    @02,ATRA2PTR                                        1939
*     LASTATSW = OFF ;                                             1940
         NI    LASTATSW,B'11011111'                                1940
*     PRNTPASW = OFF ;             /* TURN OFF AFTER PRINTING        */
         NI    PRNTPASW,B'01111111'                                1941
*     IF CMPRPASW = ON & MSCMPRSW = ON                             1942
*       THEN                                                       1942
         TM    CMPRPASW,B'10000000'                                1942
         BNO   @RF01942                                            1942
         TM    MSCMPRSW,B'00001000'                                1942
         BNO   @RF01942                                            1942
*         DO ;                                                     1943
*           PRNTPASW = ON ;        /* PASS THRU AGAIN PRINTIN        */
         OI    PRNTPASW,B'10000000'                                1944
*           MCENTCNT = MCENTCNT + 1 ;                              1945
         LH    @02,MCENTCNT                                        1945
         LA    @02,1(,@02)                                         1945
         STH   @02,MCENTCNT                                        1945
*         END ;                                                    1946
*     CMPRPASW = OFF ;                                             1947
@RF01942 NI    CMPRPASW,B'01111111'                                1947
*   END ;                          /* SECOND PASS CONTROL            */
*                                                                  1948
@DE01885 TM    CMPRPASW,B'10000000'                                1948
         BO    @DL01885                                            1948
         TM    PRNTPASW,B'10000000'                                1948
         BO    @DL01885                                            1948
*END PRTVSAM ;                                                     1949
@EL00031 DS    0H                                                  1949
@EF00031 DS    0H                                                  1949
@ER00031 LM    @14,@12,@SA00031                                    1949
         BR    @14                                                 1949
* /*******************************************************************/
* /* PROCEDURE NAME - SUMIT, SUM, PRINT NBR ENTRIES PROCESSED        */
* /* FUNCTION -                                                      */
* /*   DEPENDING ON CODE RECEIVED IN 1ST PARAMETER,                  */
* /*     ACCUMULATE TOTAL NUMBER OF ENTRIES OF THE TYPE              */
* /*       SPECIFIED IN THE SECOND PARAMETER IN A TABLE,             */
* /*     PRINT ALL ENTRIES IN THE TABLE THAT ARE NON ZERO            */
* /*       WITH HEADER AND TOTAL,                                    */
* /*     INITIALIZE THE TABLE TO ALL ZERO SUMS                       */
* /* INPUTS -                                                        */
* /*   FUNCTION, ENTRY TYPE                                          */
* /* OUTPUTS -                                                       */
* /*   INCREMENTED COUNT FOR ENTRY TYPE SPECIFIED OR                 */
* /*   PRINTED TABLE OF COUNT OF EACH ENTRY TYPE PROCESSED           */
* /* CALLS -                                                         */
* /*   UPRINT                                                        */
* /* NOTE - THIS SEGMENT CODED BY WJR                                */
* /*******************************************************************/
*                                                                  1950
*SUMIT: PROCEDURE (SUMFUNC, SUMENTYP) ;                            1950
SUMIT    STM   @14,@12,@SA00032                                    1950
         MVC   @PC00032(8),0(@01)                                  1950
* OLDERID2 = NEWERID2;                                             1951
         L     @04,@PC00001                                        1951
         L     @15,GDTTR2(,@04)                                    1951
         MVC   @TS00001(95),NEWERID2(@15)                          1951
         MVC   OLDERID2(95,@15),@TS00001                           1951
* NEWID2 = 'LRSM' ;                                                1952
         MVC   NEWID2(4,@15),@CC01429                              1952
* IF GDTDBG = NULLPTR                                              1953
*   THEN;                                                          1953
         L     @04,GDTDBG(,@04)                                    1953
         LTR   @04,@04                                             1953
         BZ    @RT01953                                            1953
*   ELSE                                                           1955
*     CALL IDCDB010 (GDTTBL,'LRSM') ;                              1955
*                                                                  1955
         L     @04,@PC00001                                        1955
         ST    @04,@AL00001                                        1955
         LA    @15,@CC01429                                        1955
         ST    @15,@AL00001+4                                      1955
         MVI   @AL00001+4,X'80'                                    1955
         L     @15,GDTDBG(,@04)                                    1955
         LA    @01,@AL00001                                        1955
         BALR  @14,@15                                             1955
* DCL SUMENTYP CHAR(1) ;                                           1956
@RT01953 DS    0H                                                  1957
* DCL SUMFUNC  CHAR(1) ;                                           1957
* DCL SUMIX    FIXED(15) ;                                         1958
* DCL SUMS (NBRCTRT) FIXED(31) ;   /* TABLE COUNTS EACH ENTYP        */
* DCL SUMSUM   FIXED(31);                                          1960
*                                                                  1960
* /*******************************************************************/
* /*   ADD 1 TO THE SUM OF ENTRY TYPES                               */
* /*******************************************************************/
*                                                                  1961
* IF SUMFUNC = SMACCUM                                             1961
*   THEN                                                           1961
         L     @04,@PC00032                                        1961
         CLC   SUMFUNC(1,@04),SMACCUM                              1961
         BNE   @RF01961                                            1961
*     DO SUMIX = 1 TO NBRCTRT ;                                    1962
         LA    SUMIX,1                                             1962
@DL01962 DS    0H                                                  1963
*       IF CATRCTYP(SUMIX) = SUMENTYP                              1963
*         THEN                                                     1963
         LR    @04,SUMIX                                           1963
         MH    @04,@CH00042                                        1963
         L     @03,@PC00032+4                                      1963
         LA    @01,CATRCTYP-5(@04)                                 1963
         CLC   0(1,@01),SUMENTYP(@03)                              1963
         BNE   @RF01963                                            1963
*           DO ;                                                   1964
*             SUMS(SUMIX) = SUMS(SUMIX) + 1 ;                      1965
         LR    @04,SUMIX                                           1965
         SLA   @04,2                                               1965
         LA    @03,1                                               1965
         AL    @03,SUMS-4(@04)                                     1965
         ST    @03,SUMS-4(@04)                                     1965
*             SUMIX = NBRCTRT ;         /* GET OUT OF LOOP          */
         LA    SUMIX,26                                            1966
*           END ;                                                  1967
*     END ;                                                        1968
*                                                                  1968
@RF01963 AL    SUMIX,@CF00222                                      1968
         C     SUMIX,@CF00643                                      1968
         BNH   @DL01962                                            1968
* /*******************************************************************/
* /*   PRINT THE NON-ZERO,S OF THE TABLE                             */
* /*******************************************************************/
*                                                                  1969
* IF SUMFUNC = SMPRINT                                             1969
*   THEN                                                           1969
@RF01961 L     @04,@PC00032                                        1969
         CLC   SUMFUNC(1,@04),SMPRINT                              1969
         BNE   @RF01969                                            1969
*     DO ;                                                         1970
*       SUMSUM = 0 ;                                               1971
         SLR   @04,@04                                             1971
         ST    @04,SUMSUM                                          1971
*       DARGLIST = '0'B ;                                          1972
         L     @04,DDSTRU                                          1972
         XC    DARGLIST+1(19,@04),DARGLIST+1(@04)                  1972
         MVI   DARGLIST(@04),B'00000000'                           1972
*       DARGSMOD = 'LR0' ;                                         1973
         MVC   DARGSMOD(3,@04),@CC01335                            1973
*       DARGSENT = 12 ;            /* PRINT HEADING                  */
         MVI   DARGSENT(@04),X'0C'                                 1974
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    1975
         L     @04,@PC00001                                        1975
         ST    @04,@AL00001                                        1975
         LA    @15,IOCSPRT                                         1975
         ST    @15,@AL00001+4                                      1975
         LA    @15,DDSTRU                                          1975
         ST    @15,@AL00001+8                                      1975
         MVI   @AL00001+8,X'80'                                    1975
         L     @15,GDTPRT(,@04)                                    1975
         LA    @01,@AL00001                                        1975
         BALR  @14,@15                                             1975
*       DARGSENT = 13 ;            /* PRINT BODY OF TABLE            */
         L     @04,DDSTRU                                          1976
         MVI   DARGSENT(@04),X'0D'                                 1976
*       DARGCNT = 2 ;                                              1977
         LA    @15,2                                               1977
         STH   @15,DARGCNT(,@04)                                   1977
*       DARGINS(1) = 1 ;                                           1978
         LA    @14,1                                               1978
         STH   @14,DARGINS(,@04)                                   1978
*       DARGINL(1) = LENGTH(CATRDESC) ;                            1979
         LA    @03,4                                               1979
         STH   @03,DARGINL(,@04)                                   1979
*       DARGINS(2) = 2 ;                                           1980
         STH   @15,DARGINS+8(,@04)                                 1980
*       DARGINL(2) = LENGTH(SUMS) ;                                1981
         STH   @03,DARGINL+8(,@04)                                 1981
*       DO SUMIX = 1 TO NBRCTRT ;                                  1982
         LR    SUMIX,@14                                           1982
@DL01982 DS    0H                                                  1983
*         IF SUMS(SUMIX) ^= 0                                      1983
*           THEN                                                   1983
         LR    @04,SUMIX                                           1983
         SLA   @04,2                                               1983
         L     @03,SUMS-4(@04)                                     1983
         LTR   @03,@03                                             1983
         BZ    @RF01983                                            1983
*             DO ;                                                 1984
*               DARGDTM(1) = ADDR(CATRDESC(SUMIX)) ;               1985
         L     @03,DDSTRU                                          1985
         LR    @15,SUMIX                                           1985
         MH    @15,@CH00042                                        1985
         LA    @15,CATRDESC-5(@15)                                 1985
         ST    @15,DARGDTM(,@03)                                   1985
*               DARGDTM(2) = ADDR(SUMS(SUMIX)) ;                   1986
         LA    @04,SUMS-4(@04)                                     1986
         ST    @04,DARGDTM+8(,@03)                                 1986
*               CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;            1987
         L     @04,@PC00001                                        1987
         ST    @04,@AL00001                                        1987
         LA    @03,IOCSPRT                                         1987
         ST    @03,@AL00001+4                                      1987
         LA    @03,DDSTRU                                          1987
         ST    @03,@AL00001+8                                      1987
         MVI   @AL00001+8,X'80'                                    1987
         L     @15,GDTPRT(,@04)                                    1987
         LA    @01,@AL00001                                        1987
         BALR  @14,@15                                             1987
*               SUMSUM = SUMSUM + SUMS(SUMIX) ;                    1988
         LR    @04,SUMIX                                           1988
         SLA   @04,2                                               1988
         L     @03,SUMSUM                                          1988
         AL    @03,SUMS-4(@04)                                     1988
         ST    @03,SUMSUM                                          1988
*               SUMS(SUMIX) = 0 ;                                  1989
         SLR   @03,@03                                             1989
         ST    @03,SUMS-4(@04)                                     1989
*             END ;                                                1990
*       END ;                                                      1991
@RF01983 AL    SUMIX,@CF00222                                      1991
         C     SUMIX,@CF00643                                      1991
         BNH   @DL01982                                            1991
*       DARGDTM(1) = ADDR('SUM ') ;     /* PRINT TOTALS              */
         L     @04,DDSTRU                                          1992
         LA    @15,@CC01433                                        1992
         ST    @15,DARGDTM(,@04)                                   1992
*       DARGDTM(2) = ADDR(SUMSUM) ;                                1993
         LA    @15,SUMSUM                                          1993
         ST    @15,DARGDTM+8(,@04)                                 1993
*       CALL AMSTP011 (GDTTBL,IOCSPRT,DDSTRU) ;                    1994
         L     @04,@PC00001                                        1994
         ST    @04,@AL00001                                        1994
         LA    @15,IOCSPRT                                         1994
         ST    @15,@AL00001+4                                      1994
         LA    @15,DDSTRU                                          1994
         ST    @15,@AL00001+8                                      1994
         MVI   @AL00001+8,X'80'                                    1994
         L     @15,GDTPRT(,@04)                                    1994
         LA    @01,@AL00001                                        1994
         BALR  @14,@15                                             1994
*     END ;                                                        1995
*                                                                  1995
* /*******************************************************************/
* /*   INITIALIZE THE TABLE OF SUMS                                  */
* /*******************************************************************/
*                                                                  1996
* IF SUMFUNC = SMINIT                                              1996
*   THEN                                                           1996
@RF01969 L     @04,@PC00032                                        1996
         CLC   SUMFUNC(1,@04),SMINIT                               1996
         BNE   @RF01996                                            1996
*     DO SUMIX = 1 TO NBRCTRT ;                                    1997
         LA    SUMIX,1                                             1997
@DL01997 DS    0H                                                  1998
*       SUMS(SUMIX) = 0 ;                                          1998
         LR    @04,SUMIX                                           1998
         SLA   @04,2                                               1998
         SLR   @03,@03                                             1998
         ST    @03,SUMS-4(@04)                                     1998
*     END ;                                                        1999
*                                                                  1999
         AL    SUMIX,@CF00222                                      1999
         C     SUMIX,@CF00643                                      1999
         BNH   @DL01997                                            1999
*END SUMIT ;                                                       2000
@EL00032 DS    0H                                                  2000
@EF00032 DS    0H                                                  2000
@ER00032 LM    @14,@12,@SA00032                                    2000
         BR    @14                                                 2000
* /*******************************************************************/
* /* PROCEDURE NAME - TCICTCR, TRANSLATE CI CATALOG TO CRA           */
* /* FUNCTION -                                                      */
* /*   SEARCH THRU CTT TABLE FOR CATALOG CI GIVEN, SLOT              */
* /*   FOUND IN IS THE CRA CI MINUS THE CTT BASE                     */
* /* INPUTS -                                                        */
* /*   CIFRTRNS (CATALOG CONTROL INTERVAL (CI))                      */
* /*   CTT                                                           */
* /* OUTPUTS -                                                       */
* /*   CIFRTRNS (CRA CI)                                             */
* /* CALLS -                                                         */
* /*   ERROR                                                         */
* /*******************************************************************/
*                                                                  2001
* TCICTCR: PROCEDURE (TRRTNCD) ;                                   2001
TCICTCR  STM   @14,@12,@SA00033                                    2001
         MVC   @PC00033(4),0(@01)                                  2001
*   OLDERID2 = NEWERID2;                                           2002
         L     @04,@PC00001                                        2002
         L     @15,GDTTR2(,@04)                                    2002
         MVC   @TS00001(95),NEWERID2(@15)                          2002
         MVC   OLDERID2(95,@15),@TS00001                           2002
*   NEWID2 = 'LRTC' ;                                              2003
         MVC   NEWID2(4,@15),@CC01439                              2003
*   IF GDTDBG = NULLPTR                                            2004
*     THEN;                                                        2004
         L     @04,GDTDBG(,@04)                                    2004
         LTR   @04,@04                                             2004
         BZ    @RT02004                                            2004
*     ELSE                                                         2006
*       CALL IDCDB010 (GDTTBL,'LRTC') ;                            2006
*                                                                  2006
         L     @04,@PC00001                                        2006
         ST    @04,@AL00001                                        2006
         LA    @15,@CC01439                                        2006
         ST    @15,@AL00001+4                                      2006
         MVI   @AL00001+4,X'80'                                    2006
         L     @15,GDTDBG(,@04)                                    2006
         LA    @01,@AL00001                                        2006
         BALR  @14,@15                                             2006
*   DCL TRRTNCD     FIXED(8) ;     /* RETURN CODE TO CALLER          */
*                                                                  2007
@RT02004 DS    0H                                                  2008
*   IF CIFRTRNS > CTTBASE          /* CI 0-8 NO TRANSLATE            */
*     THEN                                                         2008
         CLC   CIFRTRNS(3),@CF00039+1                              2008
         BNH   @RF02008                                            2008
*       DO ;                                                       2009
*         DO TCISLOT = 1 TO CTTENTNO    /* SEARCH FOR CI             */
*                                                                  2010
*            WHILE (CTTCATCI(TCISLOT) ^= CIFRTRNS); /* IN CTT        */
         LA    TCISLOT,1                                           2010
         B     @DE02010                                            2010
@DL02010 LR    @04,TCISLOT                                         2010
         SLL   @04,3                                               2010
         L     @03,CTTPTR                                          2010
         ALR   @03,@04                                             2010
         AL    @03,@CF01466                                        2010
         CLC   CTTCATCI-5(3,@03),CIFRTRNS                          2010
         BE    @DC02010                                            2010
*         END ;                                                    2011
         AL    TCISLOT,@CF00222                                    2011
@DE02010 L     @04,CTTPTR                                          2011
         CL    TCISLOT,CTTENTNO(,@04)                              2011
         BNH   @DL02010                                            2011
@DC02010 DS    0H                                                  2012
*         IF TCISLOT ^= CTTENTNO + 1    /* IF IT WAS FOUND           */
*           THEN CIFRTRNS = TCISLOT + CTTBASE ; /* TRANSLATE         */
         LA    @04,1                                               2012
         L     @03,CTTPTR                                          2012
         AL    @04,CTTENTNO(,@03)                                  2012
         CLR   TCISLOT,@04                                         2012
         BE    @RF02012                                            2012
         LA    @04,8(,TCISLOT)                                     2013
         STCM  @04,7,CIFRTRNS                                      2013
*           ELSE                                                   2014
*             DO ;                                                 2014
         B     @RC02012                                            2014
@RF02012 DS    0H                                                  2015
*               TRRTNCD = 4 ;      /* SET RETURN CODE TO FAIL        */
         L     @04,@PC00033                                        2015
         MVI   TRRTNCD(@04),X'04'                                  2015
*               CALL ERROR (29,$RETURN) ;                          2016
         LA    @01,@AL02016                                        2016
         BAL   @14,ERROR                                           2016
*             END ;                                                2017
*       END ;                                                      2018
*                                                                  2018
* END TCICTCR ;                                                    2019
@EL00033 DS    0H                                                  2019
@EF00033 DS    0H                                                  2019
@ER00033 LM    @14,@12,@SA00033                                    2019
         BR    @14                                                 2019
* /*******************************************************************/
* /* PROCEDURE NAME - VERTEXT, VERTICAL EXTENSION HANDLING           */
* /* FUNCTION -                                                      */
* /*   INITIALIZE VEXTTBL (ALL VERTICAL EXTENSIONS),                 */
* /*   LOOP THRU VERTICAL EXTENSIONS (PRIMARY),                      */
* /*     GET THE RECORD(S), PRINTING AS SPECIFIED,                   */
* /*     LOOP THRU FURTHER VERTICAL EXTENSIONS (USING                */
* /*     HORIZONTAL POINTER AS VERTICAL (SECONDARY)),                */
* /*       GET RECORD(S), PRINT AS SPECIFIED,                        */
* /* INPUTS -                                                        */
* /* OUTPUTS -                                                       */
* /*   CIFRGET (SET TO HORIZONTAL EXTENSION CI)                      */
* /* CALLS -                                                         */
* /*   INTVEXT, GETPRT                                               */
* /*******************************************************************/
*                                                                  2020
*VERTEXT: PROCEDURE ;                                              2020
VERTEXT  STM   @14,@12,@SA00034                                    2020
* OLDERID2 = NEWERID2;                                             2021
         L     @15,@PC00001                                        2021
         L     @14,GDTTR2(,@15)                                    2021
         MVC   @TS00001(95),NEWERID2(@14)                          2021
         MVC   OLDERID2(95,@14),@TS00001                           2021
* NEWID2 = 'LRVE' ;                                                2022
         MVC   NEWID2(4,@14),@CC01443                              2022
* IF GDTDBG = NULLPTR                                              2023
*   THEN;                                                          2023
         L     @15,GDTDBG(,@15)                                    2023
         LTR   @15,@15                                             2023
         BZ    @RT02023                                            2023
*   ELSE                                                           2025
*     CALL IDCDB010 (GDTTBL,'LRVE') ;                              2025
*                                                                  2025
         L     @15,@PC00001                                        2025
         ST    @15,@AL00001                                        2025
         LA    @14,@CC01443                                        2025
         ST    @14,@AL00001+4                                      2025
         MVI   @AL00001+4,X'80'                                    2025
         L     @15,GDTDBG(,@15)                                    2025
         LA    @01,@AL00001                                        2025
         BALR  @14,@15                                             2025
* HRONLYSW = OFF ;                                                 2026
*                                                                  2026
@RT02023 NI    HRONLYSW,B'01111111'                                2026
* CALL INTVEXT ;                   /* GO BUILD VEXTTBL               */
*                                                                  2027
         BAL   @14,INTVEXT                                         2027
* CI1STHE = CIHOREXT ;             /* KEEP FOR HOR EXT LOOP          */
         MVC   CI1STHE(3),CIHOREXT                                 2028
* HRONLYSW = ON ;                                                  2029
*                                                                  2029
         OI    HRONLYSW,B'10000000'                                2029
* /*******************************************************************/
* /* LOOP: THRU ALL VERTICAL EXTENSION RECORDS                       */
* /*******************************************************************/
*                                                                  2030
* DO VESLOT = 1 TO NBRVES                                          2030
*    WHILE (VECRACI(VESLOT) ^= '0'B                                2030
*       & LASTVESW ^= ON                                           2030
*      & (^(CMPRPASW = ON          /* QUIT AFTER 1ST MISCMPR         */
*           & MSCMPRSW = ON))) ;                                   2030
         LA    VESLOT,1                                            2030
@DL02030 LR    @03,VESLOT                                          2030
         SLA   @03,2                                               2030
         L     @01,VEPTR                                           2030
         L     @03,VECRACI-5(@03,@01)                              2030
         LA    @03,0(,@03)                                         2030
         LTR   @03,@03                                             2030
         BZ    @DC02030                                            2030
         TM    LASTVESW,B'00010000'                                2030
         BO    @DC02030                                            2030
         TM    CMPRPASW,B'10000000'                                2030
         BNO   @DB02030                                            2030
         TM    MSCMPRSW,B'00001000'                                2030
         BO    @DC02030                                            2030
@DB02030 DS    0H                                                  2031
*   CIFRGET = VECRACI(VESLOT) ;                                    2031
*                                                                  2031
         LR    @03,VESLOT                                          2031
         SLA   @03,2                                               2031
         L     @01,VEPTR                                           2031
         ALR   @01,@03                                             2031
         MVC   CIFRGET(3),VECRACI-4(@01)                           2031
*   CALL GETPRT ;                  /* GET  AND PRINT A RECORD        */
*                                                                  2032
         BAL   @14,GETPRT                                          2032
*   HRONLYSW = ON ;                                                2033
*                                                                  2033
         OI    HRONLYSW,B'10000000'                                2033
*   CALL INTVEXT ;                 /* GET HORIZ EXTN ONLY            */
*                                                                  2034
         BAL   @14,INTVEXT                                         2034
*   CIFRGET = CIHOREXT ;                                           2035
*                                                                  2035
         MVC   CIFRGET(3),CIHOREXT                                 2035
*   /*****************************************************************/
*   /* LOOP: THRU ALL HORIZONTAL EXTENSION CI,S BEING USED           */
*   /*       AS VERTICAL EXTENSION CI,S                              */
*   /*****************************************************************/
*   DO WHILE (CIHOREXT ^= 0                                        2036
*        & (^(CMPRPASW = ON        /* QUIT AFTER 1ST MSCMPR          */
*             & MSCMPRSW = ON))) ;                                 2036
*                                                                  2036
         B     @DE02036                                            2036
@DL02036 DS    0H                                                  2037
*     CALL GETPRT ;                                                2037
*                                                                  2037
         BAL   @14,GETPRT                                          2037
*     CALL INTVEXT ;                                               2038
*                                                                  2038
         BAL   @14,INTVEXT                                         2038
*     CIFRGET = CIHOREXT ;                                         2039
         MVC   CIFRGET(3),CIHOREXT                                 2039
*   END ;                                                          2040
@DE02036 L     @03,CIHOREXT-1                                      2040
         LA    @03,0(,@03)                                         2040
         LTR   @03,@03                                             2040
         BZ    @DC02036                                            2040
         TM    CMPRPASW,B'10000000'                                2040
         BNO   @DL02036                                            2040
         TM    MSCMPRSW,B'00001000'                                2040
         BNO   @DL02036                                            2040
@DC02036 DS    0H                                                  2041
*   IF VESLOT = NBRVES                                             2041
*     THEN                                                         2041
         C     VESLOT,@CF00038                                     2041
         BNE   @RF02041                                            2041
*       IF VENXTTBL ^= '0'B                                        2042
*         THEN                                                     2042
         L     @03,VEPTR                                           2042
         L     @03,VENXTTBL(,@03)                                  2042
         LTR   @03,@03                                             2042
         BZ    @RF02042                                            2042
*           DO ;                                                   2043
*             VEPTR = VENXTTBL ;   /* BUMP TO NEXT TABLE             */
         ST    @03,VEPTR                                           2044
*             VESLOT = 0 ;                                 /*@OZ20928*/
         SLR   VESLOT,VESLOT                                       2045
*           END ;                                                  2046
*         ELSE                                                     2047
*           LASTVESW = ON ;        /* NO MORE TABLES                 */
         B     @RC02042                                            2047
@RF02042 OI    LASTVESW,B'00010000'                                2047
* END ;                                                            2048
@RC02042 DS    0H                                                  2048
@RF02041 AL    VESLOT,@CF00222                                     2048
         C     VESLOT,@CF00038                                     2048
         BNH   @DL02030                                            2048
@DC02030 DS    0H                                                  2049
*  LASTVESW = OFF ;                                                2049
         NI    LASTVESW,B'11101111'                                2049
* CIFRGET = CI1STHE ;                                              2050
*                                                                  2050
         MVC   CIFRGET(3),CI1STHE                                  2050
*END VERTEXT ;                                                     2051
@EL00034 DS    0H                                                  2051
@EF00034 DS    0H                                                  2051
@ER00034 LM    @14,@12,@SA00034                                    2051
         BR    @14                                                 2051
*                                                                  2052
*END IDCLR01                                                       2052
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSLR )                                        *
*/*%INCLUDE SYSLIB  (IDCDF61 )                                        *
*;                                                                 2052
@DATA    DS    0H
@CH00614 DC    H'44'
@CH00639 DC    H'48'
@CH01068 DC    H'56'
@CH00637 DC    H'105'
@CH00741 DC    H'256'
@CH01136 DC    H'508'
@CH01288 DC    H'-1'
@SC01487 CLC   IOBUF(0,@14),IOBUF(@15)
@SC01489 CLC   IOBUF(0,@01),IOBUF(@14)
@SC01494 CLC   MCWKAR(0),FMWKAR
@SM01496 MVC   MCMSG(0),CHARBASD(@02)
         DS    0F
@AL00248 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01034 DC    A(ATLEN)                LIST WITH   4 ARGUMENT(S)
         DC    A(SMPRINT)
         DC    A(MODID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00259 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00303 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00985 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01043 DC    A(@CF00224)             LIST WITH   2 ARGUMENT(S)
         DC    A($ABORT)
@AL00294 DC    A(VELEN)                LIST WITH   4 ARGUMENT(S)
         DC    A(SMINIT)
         DC    A(MODID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00374 DC    A(@CF00158)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00390 DC    A(@CF00222)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00413 DC    A(@CF00166)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00422 DC    A(@CF00047)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00443 DC    A(@CF01206)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00486 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@AL00563 DC    A(@CF00039)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00580 DC    A(@CF00041)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00582 DC    A(@CF00037)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00586 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00597 DC    A(@CF00042)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00604 DC    A(@CF00038)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00657 DC    A(@CF00035)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00666 DC    A(@CF00224)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00668 DC    A(@CF00036)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00840 DC    A(@CF00779)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00850 DC    A(@CF01225)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00853 DC    A(@CF00231)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL00900 DC    A(@CF00049)             LIST WITH   2 ARGUMENT(S)
         DC    A($ABORT)
@AL00957 DC    A(GPLEN1ST)             LIST WITH   4 ARGUMENT(S)
@AL00497 DC    A(SMPRINT)              LIST WITH   1 ARGUMENT(S)
         DC    A(MODID)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL00973 DC    A(IOBFSLEN)             LIST WITH   4 ARGUMENT(S)
@AL00863 DC    A(SMINIT)               LIST WITH   1 ARGUMENT(S)
         DC    A(MODIDPG)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL01015 DC    A(@CF01297)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01058 DC    A(@CF00483)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01130 DC    A(@CF00780)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01138 DC    A(@CF00658)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01184 DC    A(@CF01320)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01302 DC    A(@CF00643)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01544 DC    A(@CF00952)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01568 DC    A(@CF00120)             LIST WITH   4 ARGUMENT(S)
         DC    A(MCARGTBL)
         DC    A(MCMSGTBL)
         DC    A(MCMLNTBL)
@AL01643 DC    A(@CF00660)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01688 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01711 DC    A(@CF00158)             LIST WITH   4 ARGUMENT(S)
         DC    A(MCARGTBL)
         DC    A(MCMSGTBL)
         DC    A(MCMLNTBL)
@AL01696 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01920 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00219 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01232 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01560 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01700 DC    A(@CF00222)             LIST WITH   1 ARGUMENT(S)
         DC    A(MCARGTBL)
         DC    A(MCMSGTBL)
         DC    A(MCMLNTBL)
@AL01823 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01907 DC    A(@CF00158)             LIST WITH   1 ARGUMENT(S)
         DC    A(MCARGTBV)
         DC    A(MCMSGTBV)
         DC    A(MCMLNTBV)
@AL01849 DC    A(@CF00662)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01858 DC    A(@CF00664)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01869 DC    A(@CF00312)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@AL01919 DC    A(@CF00818)             LIST WITH   4 ARGUMENT(S)
         DC    A(MCARGTBL)
         DC    A(MCMSGTBL)
         DC    A(MCMLNTBL)
@AL02016 DC    A(@CF01410)             LIST WITH   2 ARGUMENT(S)
         DC    A($RETURN)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00015 DS    13F
@SA00005 DS    15F
@SA00009 DS    15F
@SA00030 DS    15F
@SA00017 DS    15F
@PC00017 DS    2F
@SA00019 DS    15F
@SA00012 DS    15F
@SA00011 DS    15F
@SA00024 DS    15F
@SA00008 DS    15F
@SA00007 DS    15F
@SA00002 DS    15F
@PC00002 DS    1F
@SA00016 DS    15F
@PC00016 DS    1F
@SA00013 DS    15F
@PC00013 DS    2F
@SA00003 DS    14F
@SA00004 DS    15F
@SA00006 DS    14F
@SA00032 DS    15F
@PC00032 DS    2F
@SA00010 DS    15F
@SA00014 DS    15F
@SA00028 DS    15F
@SA00031 DS    15F
@SA00021 DS    15F
@SA00033 DS    15F
@PC00033 DS    1F
@SA00018 DS    15F
@SA00020 DS    15F
@SA00027 DS    15F
@SA00022 DS    15F
@SA00023 DS    15F
@SA00025 DS    15F
@PC00025 DS    4F
@SA00026 DS    15F
@SA00034 DS    15F
@SA00029 DS    15F
@PC00029 DS    2F
@AL00001 DS    6A
@TF00001 DS    F
@TF00002 DS    F
@AFTEMPS DS    1F
IDCLR01  CSECT
         DS    0F
@CF00120 DC    F'0'
@CH00120 EQU   @CF00120+2
@CF00222 DC    F'1'
@CH00222 EQU   @CF00222+2
@CF00158 DC    F'2'
@CH00158 EQU   @CF00158+2
@CF00166 DC    F'3'
@CH00166 EQU   @CF00166+2
@CF00047 DC    F'4'
@CH00047 EQU   @CF00047+2
@CF00042 DC    F'5'
@CH00042 EQU   @CF00042+2
@CF00041 DC    F'6'
@CH00041 EQU   @CF00041+2
@CF00040 DC    F'7'
@CH00040 EQU   @CF00040+2
@CF00039 DC    F'8'
@CH00039 EQU   @CF00039+2
@CF00038 DC    F'9'
@CH00038 EQU   @CF00038+2
@CF00037 DC    F'10'
@CH00037 EQU   @CF00037+2
@CF00036 DC    F'11'
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00779 DC    F'13'
@CF01225 DC    F'14'
@CF00231 DC    F'15'
@CF00483 DC    F'16'
@CF00780 DC    F'17'
@CF00658 DC    F'18'
@CF01320 DC    F'19'
@CF00660 DC    F'21'
@CF00662 DC    F'22'
@CF00664 DC    F'23'
@CF00312 DC    F'24'
@CH00312 EQU   @CF00312+2
@CF00643 DC    F'26'
@CF01206 DC    F'27'
@CF01297 DC    F'28'
@CF01410 DC    F'29'
@CF00952 DC    F'30'
@CF00049 DC    F'31'
@CF00224 DC    F'32'
@CH00224 EQU   @CF00224+2
@CF00818 DC    F'99'
@CF01001 DC    F'121'
@CF01189 DC    F'257'
@CF01411 DC    F'365'
@CF01409 DC    F'366'
@CF01449 DC    F'1536'
@CF01451 DC    F'2048'
@CF01492 DC    F'-513'
@CF01464 DC    F'-512'
@CF01465 DC    F'-256'
@CF01469 DC    F'-68'
@CF01478 DC    F'-67'
@CF01491 DC    F'-64'
@CF01483 DC    F'-56'
@CF01484 DC    F'-12'
@CF01477 DC    F'-11'
@CF01493 DC    F'-10'
@CF01482 DC    F'-8'
@CF01473 DC    F'-7'
@CF01476 DC    F'-4'
@CF01466 DC    F'-3'
@CF01475 DC    XL4'0000FFFF'
@CF00897 DC    XL4'FFFFFF'
@CF01194 DC    XL4'7FFFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
AAPTRSAV DS    A
ADPTRSAV DS    A
ATPTRNXT DS    A
ATPTRSAV DS    A
A2PTRSAV DS    A
CATFLDLN DS    F
CRAFLDLN DS    F
RSVUTPTR DS    A
TSTPTR   DS    A
VEPTRBEG DS    A
VEPTRNXT DS    A
IOCSALT  DS    A
IOCSCAT  DS    A
IOCSCRA  DS    A
IOCSPRT  DS    A
DDSTRUE  DS    A
FMPLAD   DS    A
STLEN    DS    F
GRPS2CMP DS    F
TSTDAYS  DS    F
TSTPDAY  DS    F
SUMSUM   DS    F
LISTPTR  DS    A
TESTRC   DS    H
CTTSLOT  DS    H
ENTNOCUR DS    H
ENTNOSAV DS    H
LINEOFST DS    H
LRLASTCC DS    H
LRTEMPCC DS    H
MCENTCNT DS    H
MCRCDCNT DS    H
NBRASOCS DS    H
NBRMCFMC DS    H
STSLTCNT DS    H
VEFIELD  DS    H
CNTREPNO DS    H
RELREPNO DS    H
ATFIELD  DS    H
SETRC    DS    H
BUFNO    DS    FL1
         DS    CL2
CATCI    DS    FL3
CHARINDX DS    FL1
CRACNT   DS    FL3
CRAFMRTC DS    FL1
ERRCNTIO DS    FL1
INDNTCOL DS    FL1
LINE     DS    FL1
MCBFOFST DS    FL1
RQDLINES DS    FL1
         DS    CL3
SAVCRCI  DS    FL3
         DS    CL1
SAVCTCI  DS    FL3
LISTLN   DS    FL1
@TS00001 DS    CL256
ASOCTYP  DS    CL1
BASETYPE DS    CL1
CATNMCRA DS    CL44
         DS    CL1
CIS      DS    CL32
         ORG   CIS
CISNAME  DS    CL4
         DS    CL1
CIBASE   DS    FL3
         DS    CL1
CIFRGET  DS    FL3
         DS    CL1
CIFRTRNS DS    FL3
         DS    CL1
CIHOREXT DS    FL3
         DS    CL1
CILOOP   DS    FL3
         DS    CL1
CISAVED  DS    FL3
         DS    CL1
CI1STHE  DS    FL3
         ORG   CIS+32
ENQNAME  DS    CL8
         ORG   ENQNAME
ENQVLSR  DS    CL6
ENQCON   DS    CL2
         ORG   ENQNAME+8
ENTYP    DS    CL1
ENTYPSAV DS    CL1
MCMSG    DS    CL48
MCMPRMRK DS    CL1
PROCMSG  DS    CL8
         DS    CL1
MCWA     DS    CL256
         ORG   MCWA
MCWALEN  DS    FL2
MCWKAR   DS    CL254
         ORG   MCWA+256
RSVMINM  DS    CL45
         ORG   RSVMINM
CNLEN    DS    FL1
CATNAME  DS    CL44
         ORG   RSVMINM+45
         DS    CL3
RSVUTBL  DS    CL11
         DS    CL1
SW       DS    CL12
         ORG   SW
SWNAME   DS    CL8
SWITCHES DS    BL4
         ORG   SWITCHES
CMPRPASW DS    BL1
CMPRSW   EQU   SWITCHES+0
COMERRSW EQU   SWITCHES+0
CRAOPNSW EQU   SWITCHES+0
CTORCRSW EQU   SWITCHES+0
DUMPSW   EQU   SWITCHES+0
FRSTIMSW EQU   SWITCHES+0
FRSTVESW EQU   SWITCHES+0
HRONLYSW DS    BL1
KEYRNGSW EQU   SWITCHES+1
LASTATSW EQU   SWITCHES+1
LASTVESW EQU   SWITCHES+1
MSCMPRSW EQU   SWITCHES+1
NOALIASW EQU   SWITCHES+1
NOCATRSW EQU   SWITCHES+1
NOCNTSW  EQU   SWITCHES+1
PRNTPASW DS    BL1
SAVESW   EQU   SWITCHES+2
SAVESW1  EQU   SWITCHES+2
SAVESW2  EQU   SWITCHES+2
SAVESW3  EQU   SWITCHES+2
SBTSETSW EQU   SWITCHES+2
SDUMPSW  EQU   SWITCHES+2
SORTOKSW EQU   SWITCHES+2
VEDUPSW  DS    BL1
FLDMGTER EQU   SWITCHES+3
         ORG   SW+12
TIMSTMPS DS    CL24
         ORG   TIMSTMPS
TIMLENWA DS    FL2
@NM00036 DS    FL2
TIMGROUP DS    CL20
         ORG   TIMGROUP
TIMGRPCD DS    FL2
TIMGRPLN DS    FL2
F4TSTVSM DS    CL8
F4TSTDMP DS    CL8
         ORG   TIMSTMPS+24
VOLHD1   DS    CL4
VOLHD2   DS    CL3
         DS    CL1
OPNAGLST DS    BL48
IOINBYTE DS    CL1
         DS    CL3
DARGLST  DS    CL100
DARGLSTE DS    CL28
PCARGLST DS    CL34
         ORG   PCARGLST
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    FL2
         ORG   PCARGLST+34
         DS    CL2
PCRST    DS    CL8
         ORG   PCRST
PCRSTT   DS    CL2
PCRSTLC  DS    FL2
PCRSTLP  DS    AL4
         ORG   PCRST+8
SUBTITLE DS    CL121
         ORG   SUBTITLE
SUBTSPCT DS    CL1
@NM00037 DS    CL24
SUBT47   DS    CL47
SUBTVLSR DS    CL6
SUBT4    DS    CL4
SUBGROUP DS    CL16
@NM00038 DS    CL23
         ORG   SUBTITLE+121
         DS    CL3
FMPLST   DS    CL44
FMUDATA  DS    CL32
         ORG   FMUDATA
FMUBFPTR DS    AL4
FMUIOCSI DS    AL4
FMUIOCSP DS    AL4
FMUDARGP DS    AL4
FMUGDTP  DS    AL4
FMUCTTP  DS    AL4
FMUGETMN DS    AL4
FMUBUFNO DS    AL1
FMUFLAGS DS    BL1
         ORG   FMUFLAGS
FMU1STIO DS    BL1
FMUCATIO EQU   FMUFLAGS+0
FMUFRSP  EQU   FMUFLAGS+0
         ORG   FMUDATA+30
FMULR2CL DS    FL2
         ORG   FMUDATA+32
FMWA     DS    CL256
         ORG   FMWA
FMWALEN  DS    FL2
FMWKAR   DS    CL254
         ORG   FMWA+256
JUNK     DS    CL256
JUNK2    DS    CL256
POOLPTRS DS    CL28
         ORG   POOLPTRS
POOLNM   DS    CL4
ATRA2PTR DS    AL4
ATPTR    DS    AL4
A2PTR    DS    AL4
CTTPTR   DS    AL4
STPTR    DS    AL4
VEPTR    DS    AL4
         ORG   POOLPTRS+28
IOBADDRS DS    CL20
         ORG   IOBADDRS
IOBADNAM DS    CL8
IOBFSPTR DS    AL4
IOCRBPTR DS    AL4
IOCTBPTR DS    AL4
         ORG   IOBADDRS+20
STDUMMY  DS    CL56
TST64BIT DS    CL8
ENDCLSER DS    CL1
ENDCLSFM DS    CL1
ENDCLSFN DS    CL1
ENDCLSIO DS    CL1
ENDCLSIS DS    CL1
ENDCLSPM DS    CL1
ENDCLSPO DS    CL1
ENDCLSP0 DS    CL1
ENDCLSTP DS    CL1
ENDCLSTS DS    CL1
ENDCLS0  DS    CL1
ENDCLS1  DS    CL1
ENDCLS2  DS    CL1
ENDCLS3  DS    CL1
ENDCLS4  DS    CL1
ENDCLS5  DS    CL1
ENDCLS6  DS    CL1
ENDCLS7  DS    CL1
ENDCLS8  DS    CL1
ENDCLS9  DS    CL1
PATCH    DS    CL1
ENTYPARG DS    3CL1
MCMPRARY DS    8CL8
TSTHMS   DS    3H
TSTMDTBL DS    12AL1
TSTMDY   DS    3H
FMFLST   DS    5CL24
SUMS     DS    26F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCLR01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00793 DC    V(IDCRC04)
@CV00794 DC    V(IDCLR02)
         DS    0D
GPLEN1ST DC    AL4(44+44+44)
ATLEN    DC    AL4(44)
IOBFSLEN DC    AL4(2*4*512)
VELEN    DC    AL4(44)
A2LEN    DC    AL2(44)
$NONV    DC    AL1(1)
$GDGB    DC    AL1(2)
$CLUS    DC    AL1(3)
$DATA    DC    AL1(4)
$OEXT    DC    AL1(5)
$FRSP    DC    AL1(6)
$AIX     DC    AL1(7)
$INDX    DC    AL1(9)
$CCR     DC    AL1(12)
$PATH    DC    AL1(18)
$UCAT    DC    AL1(21)
$VOL     DC    AL1(22)
$VEXT    DC    AL1(23)
$ALIA    DC    AL1(24)
$UPGD    DC    AL1(25)
$ABORT   DC    AL1(1)
$RETURN  DC    AL1(0)
PRTSPACE DC    AL1(0)
         DS    CL1
STENDCI  DC    XL3'FFFFFF'
@CC01278 DC    C'LISTING OF CATALOG RECOVERY AREA FOR VOLUME --'
@CC01196 DC    C'NAMEOFFIELDNOTRETURNED'
@CC01357 DC    C'UNSORTED ENTRIES'
@CC01226 EQU   @CC01196
@CC01243 DC    C'OTHER ENTRIES'
@CC01223 DC    C'VSAM ENTRIES'
@CC00816 DC    C'$$$$$$$$'
@CC01195 DC    C'ENTNAME '
@CC01198 DC    C'CATOPEN '
@CC01204 DC    C'REPNO   '
@CC01205 DC    C'CKEYRNG '
@CC01207 DC    C'HIKEYV  '
@CC01208 DC    C'VOLSER  '
@CC01228 DC    C'CRAOPEN '
@CC01234 DC    C'ENTYPE  '
@CC01235 DC    C'ENTIDNO '
@CC01237 DC    C'CTTBLD  '
@CC01267 DC    C'GETPRT  '
@CC01273 DC    C'SWITCHES'
@CC01275 DC    C'BUFFADDR'
@CC01285 DC    C'RELREPNO'
@CC01287 DC    C'CNTREPNO'
@CC01296 DC    C'INTASOC '
@CC01298 DC    C'NAMEDS  '
@CC01300 DC    C'INTAOSC '
@CC01312 DC    C'INTSORT '
@CC01318 DC    C'$EXTPTRS'
@CC01319 DC    C'INTVEXT '
@CC01336 DC    C'$USEDLEN'
@CC01337 DC    C'PRTCMP  '
@CC01350 DC    C'        '
@CC01388 DC    C'PRTOJVL '
@CC01416 DC    C'VOLTSTMP'
@CC01417 DC    C'PRTVOL  '
@CC00686 EQU   @CC01350
@CC01222 DC    C'......'
@CC01377 EQU   @CC01243
@CC00723 DC    C'DATA'
@CC00728 DC    C'INDX'
@CC00731 DC    C'UCAT'
@CC00733 DC    C'VEXT'
@CC01157 DC    C'LRAA'
@CC01175 DC    C'LRAD'
@CC01177 DC    C'ASOC'
@CC01183 DC    C'LRBL'
@CC01188 DC    C'LRBU'
@CC01193 DC    C'LRCA'
@CC01203 DC    C'LRCK'
@CC01212 DC    C'LRC1'
@CC01216 DC    C'LRC2'
@CC01221 DC    C'LRCR'
@CC01233 DC    C'LRCT'
@CC01242 DC    C'LRDO'
@CC01249 DC    C'LRDV'
@CC01258 DC    C'LRER'
@CC01260 DC    C'LRZY'
@CC01261 DC    C'LRZZ'
@CC01265 DC    C'LRGE'
@CC01271 DC    C'LRIN'
@CC01274 DC    C'POOL'
@CC01282 DC    C' -- '
@CC01289 DC    C'ASO2'
@CC01295 DC    C'LRIA'
@CC01308 DC    C'LRIS'
@CC01317 DC    C'LRIV'
@CC01324 DC    C'LRME'
@CC01329 DC    C'LRPA'
@CC01334 DC    C'LRPC'
@CC01344 DC    C'LRPD'
@CC01349 DC    C'LRPE'
@CC01356 DC    C'LRPF'
@CC01371 DC    C'LRPM'
@CC01382 DC    C'LRPJ'
@CC01386 DC    C'LRPK'
@CC01392 DC    C'LRPO'
@CC01402 DC    C'LRPT'
@CC01415 DC    C'LRPW'
@CC01421 DC    C'LRPV'
@CC01429 DC    C'LRSM'
@CC01433 DC    C'SUM '
@CC01439 DC    C'LRTC'
@CC01443 DC    C'LRVE'
@CC00775 DC    C'LR1'
@CC00776 EQU   @CC01350
@CC00777 DC    C'UV0'
@CC01276 DC    C'CIS'
@CC01335 DC    C'LR0'
@CC01387 DC    C' - '
@CC01272 DC    C'00'
@CC01283 DC    C'ST'
@CC01351 DC    C'**'
@CC00785 EQU   @CC01350
@CB01310 DC    X'FFFFFFFFFFFFFFFFFFFF'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
BLANKS6  DC    CL6'      '
         DS    CL1
FIXAREA  DS    CL1000
         ORG   FIXAREA
@NM00035 DC    CL8'FIXAREA'
         ORG   FIXAREA+1000
MMGRP1   DC    CL32'CATALOG ENTRY HAS DIFFERENT NAME'
MMGRP2   DC    CL18'VOLUME OR KEYRANGE'
MMGRP3   DC    CL7'EXTENTS'
MMGRP4   DC    CL13'HIGH USED RBA'
MMGRP5   DC    CL10'STATISTICS'
MMGRP99  DC    CL1' '
MVGRP1   DC    CL18'DATA SPACE EXTENTS'
MVGRP2   DC    CL18'DATA SET DIRECTORY'
MODID    DC    CL4'LR01'
MODIDCTT DC    CL4'LR11'
MODIDPG  DC    CL4'LRPG'
MODIDST  DC    CL4'LR12'
NCATRCD  DC    CL6'CATRCD'
RSVMJNM  DC    CL8'SYSIGGV2'
SMACCUM  DC    CL1'A'
SMINIT   DC    CL1'I'
SMPRINT  DC    CL1'P'
VOLHD3   DC    CL8'HIGH KEY'
CATRCDS  DS    CL5
         ORG   CATRCDS+0
CATRCTYP DC    CL1'A'
CATRDESC DC    CL4'NONV'
         ORG   CATRCDS+5
         ORG   CATRCDS+5
         DC    CL1'B'
         DC    CL4'GDGB'
         ORG   CATRCDS+10
         ORG   CATRCDS+10
         DC    CL1'C'
         DC    CL4'CLUS'
         ORG   CATRCDS+15
         ORG   CATRCDS+15
         DC    CL1'D'
         DC    CL4'DATA'
         ORG   CATRCDS+20
         ORG   CATRCDS+20
         DC    CL1'E'
         DC    CL4'OEXT'
         ORG   CATRCDS+25
         ORG   CATRCDS+25
         DC    CL1'F'
         DC    CL4'FRSP'
         ORG   CATRCDS+30
         ORG   CATRCDS+30
         DC    CL1'G'
         DC    CL4'AIX '
         ORG   CATRCDS+35
         ORG   CATRCDS+35
         DC    CL1'H'
         DC    CL4'    '
         ORG   CATRCDS+40
         ORG   CATRCDS+40
         DC    CL1'I'
         DC    CL4'INDX'
         ORG   CATRCDS+45
         ORG   CATRCDS+45
         DC    CL1'J'
         DC    CL4'    '
         ORG   CATRCDS+50
         ORG   CATRCDS+50
         DC    CL1'K'
         DC    CL4'    '
         ORG   CATRCDS+55
         ORG   CATRCDS+55
         DC    CL1'L'
         DC    CL4'CCR '
         ORG   CATRCDS+60
         ORG   CATRCDS+60
         DC    CL1'M'
         DC    CL4'    '
         ORG   CATRCDS+65
         ORG   CATRCDS+65
         DC    CL1'N'
         DC    CL4'    '
         ORG   CATRCDS+70
         ORG   CATRCDS+70
         DC    CL1'O'
         DC    CL4'    '
         ORG   CATRCDS+75
         ORG   CATRCDS+75
         DC    CL1'P'
         DC    CL4'    '
         ORG   CATRCDS+80
         ORG   CATRCDS+80
         DC    CL1'Q'
         DC    CL4'    '
         ORG   CATRCDS+85
         ORG   CATRCDS+85
         DC    CL1'R'
         DC    CL4'PATH'
         ORG   CATRCDS+90
         ORG   CATRCDS+90
         DC    CL1'S'
         DC    CL4'    '
         ORG   CATRCDS+95
         ORG   CATRCDS+95
         DC    CL1'T'
         DC    CL4'    '
         ORG   CATRCDS+100
         ORG   CATRCDS+100
         DC    CL1'U'
         DC    CL4'UCAT'
         ORG   CATRCDS+105
         ORG   CATRCDS+105
         DC    CL1'V'
         DC    CL4'VOL '
         ORG   CATRCDS+110
         ORG   CATRCDS+110
         DC    CL1'W'
         DC    CL4'VEXT'
         ORG   CATRCDS+115
         ORG   CATRCDS+115
         DC    CL1'X'
         DC    CL4'ALIA'
         ORG   CATRCDS+120
         ORG   CATRCDS+120
         DC    CL1'Y'
         DC    CL4'UPGD'
         ORG   CATRCDS+125
         ORG   CATRCDS+125
         DC    CL1'Z'
         DC    CL4'    '
         ORG   CATRCDS+130
ERRTBL   DS    CL12
         ORG   ERRTBL+0
ERRRTNCD DC    AL1(8)
ERRSTMOD DC    CL3'LR1'
ERRSTENT DC    AL1(9)
ERRILEN  DC    AL1(8)
@NM00034 DS    CL2
ERRIADDR DC    A(5)
         ORG   ERRTBL+12
         ORG   ERRTBL+12
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(7)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+24
         ORG   ERRTBL+24
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(10)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+36
         ORG   ERRTBL+36
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(4)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+48
         ORG   ERRTBL+48
         DC    AL1(4)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+60
         ORG   ERRTBL+60
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(3)
         DC    AL1(44)
         DS    CL2
         DC    A(1)
         ORG   ERRTBL+72
         ORG   ERRTBL+72
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+84
         ORG   ERRTBL+84
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(6)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+96
         ORG   ERRTBL+96
         DC    AL1(8)
         DC    CL3'   '
         DC    AL1(0)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+108
         ORG   ERRTBL+108
         DC    AL1(0)
         DC    CL3'LR1'
         DC    AL1(4)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+120
         ORG   ERRTBL+120
         DC    AL1(12)
         DC    CL3'LR1'
         DC    AL1(13)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+132
         ORG   ERRTBL+132
         DC    AL1(4)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+144
         ORG   ERRTBL+144
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(2)
         DC    AL1(3)
         DS    CL2
         DC    A(2)
         ORG   ERRTBL+156
         ORG   ERRTBL+156
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+168
         ORG   ERRTBL+168
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(1)
         DC    AL1(3)
         DS    CL2
         DC    A(3)
         ORG   ERRTBL+180
         ORG   ERRTBL+180
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+192
         ORG   ERRTBL+192
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+204
         ORG   ERRTBL+204
         DC    AL1(4)
         DC    CL3'LR1'
         DC    AL1(5)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+216
         ORG   ERRTBL+216
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+228
         ORG   ERRTBL+228
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+240
         ORG   ERRTBL+240
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+252
         ORG   ERRTBL+252
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+264
         ORG   ERRTBL+264
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+276
         ORG   ERRTBL+276
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(11)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+288
         ORG   ERRTBL+288
         DC    AL1(4)
         DC    CL3'LR1'
         DC    AL1(12)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+300
         ORG   ERRTBL+300
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+312
         ORG   ERRTBL+312
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+324
         ORG   ERRTBL+324
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(9)
         DC    AL1(8)
         DS    CL2
         DC    A(5)
         ORG   ERRTBL+336
         ORG   ERRTBL+336
         DC    AL1(8)
         DC    CL3'LR1'
         DC    AL1(15)
         DC    AL1(3)
         DS    CL2
         DC    A(4)
         ORG   ERRTBL+348
         ORG   ERRTBL+348
         DC    AL1(4)
         DC    CL3'LR1'
         DC    AL1(17)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+360
         ORG   ERRTBL+360
         DC    AL1(16)
         DC    CL3'UV0'
         DC    AL1(3)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+372
         ORG   ERRTBL+372
         DC    AL1(16)
         DC    CL3'UV0'
         DC    AL1(4)
         DC    AL1(0)
         DS    CL2
         DC    AL4(@CC00785)
         ORG   ERRTBL+384
MCARGTBL DS    CL10
         ORG   MCARGTBL+0
MAFLDNM  DC    CL8'ENTNAME'
MAGROUP  DC    AL1(1)
MACTGRPC DC    AL1(0)
         ORG   MCARGTBL+10
         ORG   MCARGTBL+10
         DC    CL8'ENTYPE'
         DC    AL1(1)
         DC    AL1(0)
         ORG   MCARGTBL+20
         ORG   MCARGTBL+20
         DC    CL8'CRADITS'
         DC    AL1(1)
         DC    AL1(0)
         ORG   MCARGTBL+30
         ORG   MCARGTBL+30
         DC    CL8'VOLSER'
         DC    AL1(2)
         DC    AL1(3)
         ORG   MCARGTBL+40
         ORG   MCARGTBL+40
         DC    CL8'DEVTYP'
         DC    AL1(2)
         DC    AL1(3)
         ORG   MCARGTBL+50
         ORG   MCARGTBL+50
         DC    CL8'LOKEYV'
         DC    AL1(2)
         DC    AL1(3)
         ORG   MCARGTBL+60
         ORG   MCARGTBL+60
         DC    CL8'HIKEYV'
         DC    AL1(2)
         DC    AL1(3)
         ORG   MCARGTBL+70
         ORG   MCARGTBL+70
         DC    CL8'HARBA'
         DC    AL1(3)
         DC    AL1(3)
         ORG   MCARGTBL+80
         ORG   MCARGTBL+80
         DC    CL8'EXTENT'
         DC    AL1(3)
         DC    AL1(3)
         ORG   MCARGTBL+90
         ORG   MCARGTBL+90
         DC    CL8'HURBA'
         DC    AL1(4)
         DC    AL1(3)
         ORG   MCARGTBL+100
         ORG   MCARGTBL+100
         DC    CL8'AMDSBCAT'
         DC    AL1(5)
         DC    AL1(1)
         ORG   MCARGTBL+110
         ORG   MCARGTBL+110
         DC    CL8'$$$$$$$$'
         DC    AL1(99)
         DC    AL1(99)
         ORG   MCARGTBL+120
MCARGTBV DS    CL10
         ORG   MCARGTBV+0
MAFLDNMV DC    CL8'$SPCEHDR'
MAGROUPV DC    AL1(1)
MACTGPCV DC    AL1(6)
         ORG   MCARGTBV+10
         ORG   MCARGTBV+10
         DC    CL8'DIRECTRY'
         DC    AL1(2)
         DC    AL1(8)
         ORG   MCARGTBV+20
         ORG   MCARGTBV+20
         DC    CL8'$$$$$$$$'
         DC    AL1(99)
         DC    AL1(99)
         ORG   MCARGTBV+30
         DS    CL2
MCMSGTBL DC    AL4(MMGRP1)
         DC    AL4(MMGRP2)
         DC    AL4(MMGRP3)
         DC    AL4(MMGRP4)
         DC    AL4(MMGRP5)
         DC    AL4(MMGRP99)
MCMSGTBV DC    AL4(MVGRP1)
         DC    AL4(MVGRP2)
         DC    AL4(MMGRP99)
MCMLNTBL DC    AL1(32)
         DC    AL1(18)
         DC    AL1(7)
         DC    AL1(13)
         DC    AL1(10)
         DC    AL1(1)
MCMLNTBV DC    AL1(18)
         DC    AL1(18)
         DC    AL1(1)
TSTDESC  DC    CL10'CATVOLRCD'
         DC    CL10'CRAVOLRCD'
         DC    CL10'F4DSCBVSAM'
         DC    CL10'F4DSCBDUMP'
TSTMDINT DC    AL1(31)
         DC    AL1(0)
         DC    AL1(31)
         DC    AL1(30)
         DC    AL1(31)
         DC    AL1(30)
         DC    AL1(31)
         DC    AL1(31)
         DC    AL1(30)
         DC    AL1(31)
         DC    AL1(30)
         DC    AL1(31)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SUMIX    EQU   @02
CTTLEN   EQU   @02
FMFLCUR  EQU   @04
DDSTRUSV EQU   @02
IOINBPTR EQU   @02
VESLOTB  EQU   @02
VESLOT   EQU   @02
VEPTRSAV EQU   @04
VECKSLOT EQU   @03
TYPESLOT EQU   @02
TSTSLOT  EQU   @02
TCISLOT  EQU   @02
SUBSLOT  EQU   @02
STSLOT   EQU   @03
SLOT     EQU   @03
NBRVOLOC EQU   @03
NBRFLDS  EQU   @03
MOSLOT   EQU   @02
KEYLEN   EQU   @02
INBFOFST EQU   @03
GRPCOL   EQU   @02
FMSLOT   EQU   @02
DARGSLOT EQU   @02
CTLOOP   EQU   @02
CMPRSLOT EQU   @02
CMPRLENR EQU   @02
CMPRLENL EQU   @03
CMPRCOL  EQU   @04
A2SLOT   EQU   @03
ATSLOTB  EQU   @03
ATSLOT   EQU   @02
ARGSLOT  EQU   @03
ADATSLOT EQU   @04
AAXVCNT  EQU   @02
OPNPTR   EQU   @03
IOCSPTR  EQU   @03
RTNREG   EQU   @15
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG0     EQU   @00
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSARV0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITUCB  EQU   UNITABL
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOGT0 EQU   0
IDCIOVY0 EQU   0
IDCIOSI0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPRA EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNDSOAM EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
IOINFTMS EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGIND  EQU   DARGLIST+18
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
IFILE    EQU   0
IFILECNT EQU   IFILE
@NM00032 EQU   IFILE+2
IFILEVAL EQU   @NM00032+1
CMPR     EQU   0
DUMP     EQU   0
CATNM    EQU   0
CATNMPAS EQU   CATNM+1
CATNMFLG EQU   CATNM+10
CATDN    EQU   0
CATDNVAL EQU   CATDN+1
MRPW     EQU   0
MRPWLEN  EQU   MRPW
MRPWVAL  EQU   MRPW+1
OFILE    EQU   0
OFILEVAL EQU   OFILE+1
SDUMP    EQU   0
CCR      EQU   0
CCRNXTFR EQU   CCR+48
CHARBASD EQU   0
FMPL     EQU   0
FMPLFLNO EQU   FMPL
FMPLBCIN EQU   FMPL+1
FMPLGRTN EQU   FMPL+4
FMPLWKAR EQU   FMPL+8
FMPLUPTR EQU   FMPL+12
FMPLRTCD EQU   FMPL+16
FMPLENTH EQU   FMPL+18
FMPLOAR  EQU   FMPL+20
FMPLFMFL EQU   FMPL+24
FMFL     EQU   0
FMFLDLNO EQU   FMFL
FMFLTSTC EQU   FMFL+1
FMFLGRPC EQU   FMFL+2
FMFLINDS EQU   FMFL+3
FMFLDNAM EQU   FMFL+8
FMFLTCHN EQU   FMFL+12
FMFLDATA EQU   FMFL+16
FMFLENTH EQU   FMFLDATA
FMFLADDR EQU   FMFLDATA+4
$EXTPTRS EQU   0
$USEDLEN EQU   0
AMDSBCAT EQU   0
ENTIDNO  EQU   0
ENTNAME  EQU   0
ENTYPE   EQU   0
HIKEYSET EQU   0
HIKEYLEN EQU   HIKEYSET
NAMEDS   EQU   0
TYPE     EQU   NAMEDS
NAMECI   EQU   NAMEDS+1
REPNO    EQU   0
VOLSER   EQU   0
VOLTSTMP EQU   0
ASSOCTBL EQU   0
ATNAME   EQU   ASSOCTBL
ATNXTTBL EQU   ASSOCTBL+4
ATASOC   EQU   ASSOCTBL+8
ATENTYP  EQU   ATASOC
ATCRACI  EQU   ATASOC+1
ASSOCTB2 EQU   0
A2NAME   EQU   ASSOCTB2
A2NXTTBL EQU   ASSOCTB2+4
A2ASOC   EQU   ASSOCTB2+8
A2ENTYP  EQU   A2ASOC
A2CRACI  EQU   A2ASOC+1
VEXTTBL  EQU   0
VENAME   EQU   VEXTTBL
VENXTTBL EQU   VEXTTBL+4
VEEXT    EQU   VEXTTBL+8
VECRACI  EQU   VEEXT+1
CTT      EQU   0
CTTENTNO EQU   CTT
CTTENTRY EQU   CTT+4
CTTENTYP EQU   CTTENTRY
CTTCATCI EQU   CTTENTRY+1
CTTINDS  EQU   CTTENTRY+4
CTTPRTD  EQU   CTTINDS
CTTMCSW  EQU   CTTINDS
CTTGDGM  EQU   CTTINDS
IOBUFS   EQU   0
IOBUF    EQU   IOBUFS
IOBUFCI  EQU   IOBUFS+509
IOBUFDMY EQU   0
SORTTBL  EQU   0
STENTNM  EQU   SORTTBL
STENTYP  EQU   SORTTBL+44
STCRACI  EQU   SORTTBL+45
STFLAGS  EQU   SORTTBL+48
STFRWD   EQU   SORTTBL+52
STBKWD   EQU   SORTTBL+54
AMSTP041 EQU   0
AMSTP044 EQU   0
CAT      EQU   0
DEVTYP   EQU   0
DMPTRM   EQU   0
EXTENTS  EQU   0
FMFLCNTR EQU   0
FMFLNAME EQU   0
HARBA    EQU   0
HURBA    EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
LOKEYLEN EQU   0
LOKEYV   EQU   0
NAME     EQU   0
NCMPR    EQU   0
NEWERID1 EQU   5
RRNRET   EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
ASOCDSRD EQU   0
ETARG    EQU   0
GONOGO   EQU   0
STRTSLOT EQU   0
NBRCHAR  EQU   0
SRCHCHAR EQU   0
NBR2CMP  EQU   0
ARGTBL   EQU   0
ARGNAME  EQU   ARGTBL
ARGGRP   EQU   ARGTBL+8
ARGCTGRP EQU   ARGTBL+9
MSGTBL   EQU   0
MSGLNTBL EQU   0
TSTID    EQU   0
TSTBIT64 EQU   0
SUMFUNC  EQU   0
SUMENTYP EQU   0
TRRTNCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00044 EQU   SORTTBL+49
@NM00043 EQU   IOBUFS+508
@NM00042 EQU   CTTENTRY+5
@NM00045 EQU   VEEXT
HIKEYV   EQU   HIKEYSET+2
STATISTC EQU   AMDSBCAT+56
@NM00041 EQU   AMDSBCAT
FMFLWKAR EQU   FMFL+4
FMFLSUCC EQU   FMFLINDS
@NM00040 EQU   FMFLINDS
@NM00039 EQU   FMPL+17
@NM00033 EQU   CCR
OFILELEN EQU   OFILE
CATDNLEN EQU   CATDN
CATNMVAL EQU   CATNM+21
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
CATNMPLN EQU   CATNM
IFILELEN EQU   @NM00032
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00287 EQU   @EL00003
@RC00362 EQU   @EL00005
@RF00498 EQU   @EL00008
@RF00512 EQU   @EL00008
@RT00576 EQU   @RC00573
@RT00574 EQU   @RC00573
@RC00549 EQU   @EL00009
@RF00648 EQU   @RC00644
@RC00620 EQU   @EL00010
@RC00799 EQU   @EL00014
@RF00984 EQU   @EL00015
@RF01085 EQU   @EL00017
@RC01093 EQU   @EL00017
@RC01174 EQU   @RC01167
@RC01169 EQU   @RC01167
@RF01187 EQU   @EL00018
@RF01323 EQU   @EL00021
@RC01485 EQU   @RC01477
@RF01570 EQU   @RC01563
@RF01668 EQU   @EL00028
@RC01864 EQU   @EL00030
@RC01918 EQU   @RC01917
@RF01996 EQU   @EL00032
@RF02008 EQU   @EL00033
@RC02012 EQU   @EL00033
@PB00034 EQU   @EL00001
@RC00628 EQU   @RC00620
@RC00814 EQU   @RC00799
@PB00033 EQU   @PB00034
@RT00815 EQU   @RC00814
@PB00032 EQU   @PB00033
@PB00031 EQU   @PB00032
@PB00030 EQU   @PB00031
@PB00029 EQU   @PB00030
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCLR01,(C'PLS1738',0701,78073)

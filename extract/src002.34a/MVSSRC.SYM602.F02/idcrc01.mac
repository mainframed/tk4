         TITLE 'IDCRC01 - EXPORTRA FUNCTION DRIVER                     *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRC01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRC01   77.332'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         LA    @11,4095(,@10)                                      0002
         LA    @12,4095(,@11)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         USING @PSTART+8190,@11                                    0002
         USING @PSTART+12285,@12                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0002
         USING @DATD,@08                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @08,8(,@13)                                         0002
         LR    @13,@08                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0327
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE INITIALIZATION AND BUILDING OF THE CRV           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0328
*  CALL INIT;                     /* INITIALIZE THE MODULE           */
         BAL   @14,INIT                                            0328
*  CALL BUILDCRV;                 /* BUILD THE CRV REQUIRED FOR      */
         BAL   @14,BUILDCRV                                        0329
*                                 /* THIS FUNCTION                   */
*  IF REG15^=LASTCC12             /* IF NO ERRORS                    */
*                                                                  0330
*    /****************************************************************/
*    /*                                                              */
*    /*    IF EVERYTHING IS OK, THEN LOOP THROUGH ALL THE CRA'S      */
*    /*    TO PREPARE THEM FOR THE EXPORTING                         */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0330
*    THEN DO;                     /* THEN:                           */
         CH    REG15,@CH00038                                      0330
         BE    @RF00330                                            0330
*      DO INX1=1 TO CRACNT;       /* LOOP THROUGH ALL CRA'S          */
*                                                                  0332
         LA    @14,1                                               0332
         B     @DE00332                                            0332
@DL00332 DS    0H                                                  0333
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE OPENING OF THE CRA TO PROCESS              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0333
*        CALL OPENCRA (OPENFUNC,INX1,CRADS);                       0333
         MVC   @AL00001(12),@AL00333                               0333
         LA    @14,INX1                                            0333
         ST    @14,@AL00001+4                                      0333
         LA    @01,@AL00001                                        0333
         BAL   @14,OPENCRA                                         0333
*                                 /* OPEN THE NEXT CRA TO DO         */
*        IF REG15=LASTCC12        /* IF THERE IS A CORE PROBLEM      */
*          THEN DO;               /* THEN:                           */
         LA    @14,12                                              0334
         CR    REG15,@14                                           0334
         BNE   @RF00334                                            0334
*            LASTCC=LASTCC12;     /* INDICATE A BAD PROBLEM          */
         L     @04,@PC00001+8                                      0336
         STH   @14,LASTCC(,@04)                                    0336
*            CALL EXITTHE;        /* EXIT FROM THE MODULE            */
         BAL   @14,EXITTHE                                         0337
*            END;                 /*                                 */
*          ELSE DO;               /* ELSE:                           */
         B     @RC00334                                            0339
@RF00334 DS    0H                                                  0340
*            IF LASTCC<REG15      /* IF LARGER RETURN CODE           */
*              THEN LASTCC=REG15; /* THEN: SAVE NEW ONE              */
         L     @14,@PC00001+8                                      0340
         CH    REG15,LASTCC(,@14)                                  0340
         BNH   @RF00340                                            0340
         STH   REG15,LASTCC(,@14)                                  0341
*              ELSE;              /* ELSE: CONTINUE                  */
@RF00340 DS    0H                                                  0343
*            END;                 /*                                 */
*        IF CRVBADVL=ON           /* IF THIS A BAD VOLUME            */
*          THEN;                  /* THEN: CONTINUE                  */
@RC00334 TM    CRVBADVL(CRVEBASE),B'10000000'                      0344
         BO    @RT00344                                            0344
*          /**********************************************************/
*          /*                                                        */
*          /*    IF THE CRA WAS OPEN'ED OK, THEN PROCESS THE         */
*          /*    INFORMATION CONTAINED THEREIN                       */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0346
*          ELSE DO;               /* ELSE:                           */
*            CALL CKNAMES(INX1);  /* CONDITION THE NAME CHAIN        */
         LA    @14,INX1                                            0347
         ST    @14,@AL00001                                        0347
         LA    @01,@AL00001                                        0347
         BAL   @14,CKNAMES                                         0347
*            CALL DUPNAMCK;       /* EXCLUDE DUPLICATE NAMES         */
         BAL   @14,DUPNAMCK                                        0348
*            CALL SYNCH(INX1);    /* CHECK SYNC ON DATA SETS         */
         LA    @14,INX1                                            0349
         ST    @14,@AL00001                                        0349
         LA    @01,@AL00001                                        0349
         BAL   @14,SYNCH                                           0349
*            IF REG15=LASTCC12    /* IF THERE IS AN ERROR            */
*              THEN DO;           /* THEN:                           */
         LA    @14,12                                              0350
         CR    REG15,@14                                           0350
         BNE   @RF00350                                            0350
*                LASTCC=LASTCC12; /* INDICATE A BAD ERROR            */
         L     @04,@PC00001+8                                      0352
         STH   @14,LASTCC(,@04)                                    0352
*                CALL EXITTHE;    /* EXIT FROM THE MODULE            */
         BAL   @14,EXITTHE                                         0353
*                END;             /*                                 */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF00350 DS    0H                                                  0356
*            CALL OPENCRA(CLOSFUNC,INX1);                          0356
         LA    @14,@CC00855                                        0356
         ST    @14,@AL00001                                        0356
         LA    @14,INX1                                            0356
         ST    @14,@AL00001+4                                      0356
         LA    @01,@AL00001                                        0356
         BAL   @14,OPENCRA                                         0356
*                                 /* CLOSE THE BASE CRA              */
*            END;                 /*                                 */
*        END;                     /*                                 */
*                                                                  0358
@RT00344 LA    @14,1                                               0358
         AL    @14,INX1                                            0358
@DE00332 ST    @14,INX1                                            0358
         L     @04,@PC00001+4                                      0358
         LA    @04,FDTPTR+12(,@04)                                 0358
         C     @14,CRACNT(,@04)                                    0358
         BNH   @DL00332                                            0358
*      /**************************************************************/
*      /*                                                            */
*      /*    LOOP THROUGH TO EXPORT THE ENTRIES                      */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0359
*      DO INX1=1 TO CRACNT;       /* LOOP THROUGH ALL CRA'S          */
         LA    @14,1                                               0359
         B     @DE00359                                            0359
@DL00359 DS    0H                                                  0360
*        CRVEBASE=ADDR(CRVENTRY(INX1));                            0360
         MH    @14,@CH00954                                        0360
         L     CRVEBASE,CRVBASE                                    0360
         LA    CRVEBASE,CRVENTRY-28(@14,CRVEBASE)                  0360
*                                 /* POINT AT THE CORRECT ENTRY      */
*        IF CRVBADVL=ON           /* IF THIS IS A BAD VOL            */
*          THEN;                  /* THEN: CONTINUE                  */
         TM    CRVBADVL(CRVEBASE),B'10000000'                      0361
         BO    @RT00361                                            0361
*          ELSE DO;               /* ELSE:                           */
*            CALL MESSAGE(0,MSGID14,VTTVOLSR(INX1),LENGTH(VTTVOLSR));
         MVC   @AL00001(16),@AL00364                               0364
         L     @14,INX1                                            0364
         MH    @14,@CH00763                                        0364
         L     @04,CRVBASE                                         0364
         L     @04,CRVCRAPL(,@04)                                  0364
         L     @04,ACCVOLTT(,@04)                                  0364
         AL    @04,@CF01391                                        0364
         LA    @14,VTTVOLSR-4(@14,@04)                             0364
         ST    @14,@AL00001+8                                      0364
         LA    @01,@AL00001                                        0364
         BAL   @14,MESSAGE                                         0364
*                                 /* INDICATE THE VOL TO EXPORT      */
*            CALL EXPORTDR(INX1); /* EXPORT THE NAME CHAIN           */
         LA    @14,INX1                                            0365
         ST    @14,@AL00001                                        0365
         LA    @01,@AL00001                                        0365
         BAL   @14,EXPORTDR                                        0365
*                                                          /*@OZ18993*/
*            IF EXPORTED > LASTCC                          /*@OZ18993*/
*              THEN               /*INDICATE THAT PORTABLE   @OZ18993*/
         L     @14,@PC00001+8                                      0366
         LH    @14,LASTCC(,@14)                                    0366
         CR    EXPORTED,@14                                        0366
         BNH   @RF00366                                            0366
*                EXPORTED = LASTCC;/*DATASET IS GOOD         @OZ18993*/
*                                                                  0367
         LR    EXPORTED,@14                                        0367
*            IF REG15>=LASTCC12   /* IF THERE IS AN ERROR            */
*              THEN DO;           /* THEN:                           */
@RF00366 CH    REG15,@CH00038                                      0368
         BL    @RF00368                                            0368
*                LASTCC=REG15;    /* INDICATE A BAD ERROR            */
         L     @14,@PC00001+8                                      0370
         STH   REG15,LASTCC(,@14)                                  0370
*                CALL EXITTHE;    /* EXIT FROM THE MODULE            */
         BAL   @14,EXITTHE                                         0371
*                END;             /*                                 */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF00368 DS    0H                                                  0374
*            END;                 /*                                 */
*        END;                     /*                                 */
@RT00361 LA    @14,1                                               0375
         AL    @14,INX1                                            0375
@DE00359 ST    @14,INX1                                            0375
         L     @04,@PC00001+4                                      0375
         LA    @04,FDTPTR+12(,@04)                                 0375
         C     @14,CRACNT(,@04)                                    0375
         BNH   @DL00359                                            0375
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE THE TERMINATION PROCESS                          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0376
*      END;                       /*                                 */
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00330                                            0377
@RF00330 DS    0H                                                  0378
*      LASTCC=LASTCC12;           /* INDICATE BAD RETURN             */
         L     @14,@PC00001+8                                      0378
         MVC   LASTCC(2,@14),@CH00038                              0378
*      END;                       /*                                 */
*  CALL EXITTHE;                  /* EXIT FROM THE MODULE            */
*                                                                  0380
@RC00330 BAL   @14,EXITTHE                                         0380
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*  GEN (EJECT);                                                    0382
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    BUILDCRV                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    CONSTRUCT THE CRV THAT WILL BE REQUIRED TO HANDLE THE       */
*  /*    DATA THAT WILL BE GENERATED AND USED DURING THE             */
*  /*    FUNCTIONS TO BE PERFORMED                                   */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    NONE                                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0383
*BUILDCRV: PROCEDURE;                                              0383
*                                                                  0383
         B     @PB00002                                            0383
BUILDCRV STM   @14,@12,@SA00002                                    0383
*  DCL BLDPTR        PTR(31);     /* POINTER TO SCAN IOINFO          */
*                                 /* DATA AREA                       */
*  DCL NOFNO1        FIXED(15) CONSTANT(2);                        0385
*                                 /* CONSTANT FOR NUMBER OF          */
*                                 /* TYPES IN IOINFO AREA            */
*  DCL BLDIX2        FIXED(31);   /* GENERAL COUNTER FOR ROUTIN      */
*  DCL BLDIX1        FIXED(31);   /* GENERAL COUNTER FOR ROUTIN      */
*  DCL CRVSIZE       FIXED(31);   /* SIZE OF THE CRV                 */
*  DCL ACCSIZE       FIXED(31);   /* SIZE OF THE ACC                 */
*  DCL VTTSIZE       FIXED(31);   /* SIZE OF THE VTT                 */
*  DCL POOLSIZE      FIXED(31);   /* SIZE OF THE POOL                */
*  DCL NOFBUFFS      FIXED(31) CONSTANT(6);                        0392
*                                 /* NUMBER OF BUFFERS IN POOL       */
*  DCL MINLRECL      FIXED(31) CONSTANT(280);              /*@OZ17191*/
*                                 /* MIMUM LRECL ALLOWABLE           */
*                                                                  0394
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  0394
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0395
*  OLDERID2 = NEWERID2;                                            0395
         L     @14,@PC00001                                        0395
         L     @04,GDTTR2(,@14)                                    0395
         MVC   @TS00001(95),NEWERID2(@04)                          0395
         MVC   OLDERID2(95,@04),@TS00001                           0395
*  NEWID2='RC81';                                                  0396
         MVC   NEWID2(4,@04),@CC01102                              0396
*  IF GDTDBG = NULLPTR                                             0397
*    THEN;                                                         0397
         ICM   @04,15,GDTDBG(@14)                                  0397
         BZ    @RT00397                                            0397
*    ELSE                                                          0399
*      CALL IDCDB010 (GDTTBL,'RC81');                              0399
         L     @14,@PC00001                                        0399
         ST    @14,@AL00001                                        0399
         LA    @04,@CC01102                                        0399
         ST    @04,@AL00001+4                                      0399
         MVI   @AL00001+4,X'80'                                    0399
         L     @15,GDTDBG(,@14)                                    0399
         LA    @01,@AL00001                                        0399
         BALR  @14,@15                                             0399
*  /******************************************************************/
*  /*                                                                */
*  /*    CALCULATE THE SIZE OF THE CRV,ACC AND VTT.  ATTEMPT TO      */
*  /*    OBTAIN THE SPACE TO ALLOCATE THE BLOCKS                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0400
*  BUFSIZE=((NOFBUFFS*LENGTH(BUFELM)+3)/4)*4;                      0400
@RT00397 LA    @14,3120                                            0400
         STH   @14,BUFSIZE(,BUFSPTR)                               0400
*                                 /* COMPUTE SIZE OF BUFFER          */
*                                 /* POOL                            */
*  VGOSIZE=((NOOFVGOS*LENGTH(VGOEXT)+LENGTH(VGOS)+3)/4)*4;         0401
         LA    @07,2464                                            0401
         ST    @07,VGOSIZE                                         0401
*                                 /* COMPUTE SIZE OF SPACE FOR       */
*                                 /* THE VGO'S                       */
*  CRVSIZE=((LENGTH(CRVENTRY)*CRACNT+LENGTH(CRV)+3)/4)*4;          0402
         LA    @06,4                                               0402
         L     @01,@PC00001+4                                      0402
         LA    @01,FDTPTR+12(,@01)                                 0402
         L     @01,CRACNT(,@01)                                    0402
         ST    @06,@TF00001                                        0402
         LR    @06,@01                                             0402
         MH    @06,@CH00954                                        0402
         AH    @06,@CH01374                                        0402
         SRDA  @06,32                                              0402
         D     @06,@TF00001                                        0402
         SLA   @07,2                                               0402
         LR    CRVSIZE,@07                                         0402
*                                 /* GET SIZE OF CRV IN WORDS        */
*  ACCSIZE=((LENGTH(ACC)+3)/4)*4; /* GET SIZE OF ACC IN WORDS        */
         LA    ACCSIZE,12                                          0403
*  VTTSIZE=((LENGTH(VTTENTRY)*CRACNT+LENGTH(VTT)+3)/4)*4;          0404
         LR    @06,@01                                             0404
         MH    @06,@CH00763                                        0404
         AH    @06,@CH00473                                        0404
         SRDA  @06,32                                              0404
         D     @06,@TF00001                                        0404
         SLA   @07,2                                               0404
         LR    VTTSIZE,@07                                         0404
*                                 /* GET SIZE OF VTT IN WORDS        */
*  POOLSIZE=CRVSIZE+ACCSIZE+VTTSIZE+BUFSIZE+VGOSIZE;               0405
         L     @07,VGOSIZE                                         0405
         LR    @06,CRVSIZE                                         0405
         ALR   @06,ACCSIZE                                         0405
         ALR   @06,VTTSIZE                                         0405
         ALR   @06,@14                                             0405
         ALR   @06,@07                                             0405
         ST    @06,POOLSIZE                                        0405
*                                 /* GET SIZE OF TOTAL SPACE         */
*  CALL IDCSAGP0 (GDTTBL,POOLSIZE,CRVBASE,COREID4,SETZERO);        0406
         L     @14,@PC00001                                        0406
         ST    @14,@AL00001                                        0406
         LA    @07,POOLSIZE                                        0406
         ST    @07,@AL00001+4                                      0406
         LA    @07,CRVBASE                                         0406
         ST    @07,@AL00001+8                                      0406
         LA    @07,@CC00835                                        0406
         ST    @07,@AL00001+12                                     0406
         LA    @07,SETZERO                                         0406
         ST    @07,@AL00001+16                                     0406
         MVI   @AL00001+16,X'80'                                   0406
         L     @15,GDTGPL(,@14)                                    0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*                                 /* GET THE SPACE FOR CRV,          */
*                                 /* ACC AND VTT                     */
*                                                                  0407
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THE SPACE WAS OBTAINED THEN SUBALLOCATE THE SPACE        */
*  /*    TO THE OTHER BLOCKS                                         */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0407
*  IF REG15=LASTCC00              /* IF SPACE OBTAINED               */
*    THEN DO;                     /* THEN:                           */
         LTR   REG15,REG15                                         0407
         BNZ   @RF00407                                            0407
*      CRVCRAPL=CRVBASE+CRVSIZE;  /* SET UP ACC BASE ADDRESS         */
         L     @14,CRVBASE                                         0409
         LR    @07,CRVSIZE                                         0409
         ALR   @07,@14                                             0409
         ST    @07,CRVCRAPL(,@14)                                  0409
*      ACCVOLTT=CRVCRAPL+ACCSIZE; /* SET UP VTT BASE ADDRESS         */
         LR    @02,ACCSIZE                                         0410
         ALR   @02,@07                                             0410
         ST    @02,ACCVOLTT(,@07)                                  0410
*      BUFPOOL=ACCVOLTT+VTTSIZE;  /* ALLOCATE THE BUFFER POOL        */
         LR    @03,VTTSIZE                                         0411
         ALR   @03,@02                                             0411
         ST    @03,BUFPOOL(,BUFSPTR)                               0411
*      VGOPTR=BUFPOOL+BUFSIZE;    /* ALLOCATE THE VGO SPACE          */
         AH    @03,BUFSIZE(,BUFSPTR)                               0412
         ST    @03,VGOPTR                                          0412
*      CRVMAXLR=MINLRECL;         /* INITIALIZE MAXIMUM LRECL        */
         MVC   CRVMAXLR(4,@14),@CF01101                            0413
*      VTTENTNO=CRACNT;           /* INITIALIZE NO. OF ENTRIES       */
         L     @14,@PC00001+4                                      0414
         LA    @14,FDTPTR+12(,@14)                                 0414
         MVC   VTTENTNO(4,@02),CRACNT(@14)                         0414
*      /**************************************************************/
*      /*                                                            */
*      /*    PREPARE THE IOINFO CONTROL BYTE AND LOOP THROUGH        */
*      /*    ALL OF THE CRA'S TO BUILD THE INFORMATION NEEDED        */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0415
*      BYTEPM1A=ADDR(BYTEPM1);    /* POINT AT THE OPTION BYTE        */
         LA    BYTEPM1A,BYTEPM1                                    0415
*      BYTEPM1=0;                 /* CLEAR THE INDICATORS            */
         MVI   BYTEPM1,X'00'                                       0416
*      IOINFVOL=ON;               /* INDICATE VOLSER'S DESIRED       */
*      IOINFDVT=ON;               /* INDICATE DEVTYPE DESIRED        */
         OI    IOINFVOL(BYTEPM1A),B'11000000'                      0418
*      TMSFLDLN=LENGTH(TMSAREA);  /* PLACE THE LENGTH OF AREA        */
         MVC   TMSFLDLN(2),@CH01375                                0419
*      DO BLDIX1=1 TO CRACNT;     /* LOOP THROUGH ALL THE CRA'S      */
         LA    BLDIX1,1                                            0420
         B     @DE00420                                            0420
@DL00420 DS    0H                                                  0421
*        CALL IDCIOSI0 (GDTTBL,BYTEPM1,ADDR(TMSAREA),              0421
*                 CRADDPTR(BLDIX1)->CRADDVAL);                     0421
         L     @14,@PC00001                                        0421
         ST    @14,@AL00001                                        0421
         LA    @04,BYTEPM1                                         0421
         ST    @04,@AL00001+4                                      0421
         LA    @04,TMSAREA                                         0421
         ST    @04,@AFTEMPS                                        0421
         LA    @04,@AFTEMPS                                        0421
         ST    @04,@AL00001+8                                      0421
         LR    @04,BLDIX1                                          0421
         SLA   @04,2                                               0421
         L     @07,@PC00001+4                                      0421
         L     @01,FDTPTR+16(,@07)                                 0421
         AL    @01,@CF01392                                        0421
         L     @04,CRADDPTR(@04,@01)                               0421
         LA    @04,CRADDVAL(,@04)                                  0421
         ST    @04,@AL00001+12                                     0421
         MVI   @AL00001+12,X'80'                                   0421
         L     @15,GDTIFO(,@14)                                    0421
         LA    @01,@AL00001                                        0421
         BALR  @14,@15                                             0421
*                                 /* GET THE VOLSER AND DEVTYPE      */
*                                 /* FOR THE DNAME                   */
*        CRVEBASE=ADDR(CRVENTRY(BLDIX1));                          0422
         LR    @14,BLDIX1                                          0422
         MH    @14,@CH00954                                        0422
         L     CRVEBASE,CRVBASE                                    0422
         LA    CRVEBASE,CRVENTRY-28(@14,CRVEBASE)                  0422
*                                 /* ESTABLISH BASE OF CRV           */
*                                 /* ENTRY                           */
*                                                                  0423
*        /************************************************************/
*        /*                                                          */
*        /*    IF THE INFORMATION WAS OBTAINED THEN BUILD THE        */
*        /*    THE INFORMATION FOR THIS CRA ENTRY                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0423
*        IF REG15=LASTCC00        /* IF DATA WAS RETURNED            */
*          THEN DO;               /* THEN:                           */
         LTR   REG15,REG15                                         0423
         BNZ   @RF00423                                            0423
*            BLDPTR=ADDR(TMSRETRN);                                0425
         LA    BLDPTR,TMSRETRN                                     0425
*                                 /* POINT AT THE RETURNED DATA      */
*            DO BLDIX2=1 TO NOFNO1;                                0426
         LA    @14,1                                               0426
         ST    @14,BLDIX2                                          0426
@DL00426 DS    0H                                                  0427
*                                 /* LOOP THROUGH ALL FIELDS         */
*                                 /* THAT ARE REQUESTED              */
*              /******************************************************/
*              /*                                                    */
*              /*    HANDLE THE VOLUME SERIAL INFORMATION FOR        */
*              /*    THIS CRA VOLUME                                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0427
*              IF BLDPTR->TMSVSCD=TMSVSCDC                         0427
*                                 /* IF THE FIELD IS A VOLSER        */
*                THEN IF BLDPTR->TMSVSLEN=TMSNOVOL                 0427
         CLC   TMSVSCD(2,BLDPTR),@CH00154                          0427
         BNE   @RF00427                                            0427
*                                 /* THEN: IF THERE IS ONLY ONE      */
*                  THEN VTTVOLSR(BLDIX1)=BLDPTR->TMSVOLSR;         0428
         CLC   TMSVSLEN(2,BLDPTR),@CH00157                         0428
         BNE   @RF00428                                            0428
         LR    @14,BLDIX1                                          0429
         MH    @14,@CH00763                                        0429
         L     @01,CRVBASE                                         0429
         L     @01,CRVCRAPL(,@01)                                  0429
         L     @01,ACCVOLTT(,@01)                                  0429
         ALR   @01,@14                                             0429
         AL    @01,@CF01391                                        0429
         MVC   VTTVOLSR-4(6,@01),TMSVOLSR(BLDPTR)                  0429
*                                 /* PLACE THE VOLSER IN TABLE       */
*                  ELSE DO;       /* ELSE:                           */
         B     @RC00428                                            0430
@RF00428 DS    0H                                                  0431
*                    CALL MESSAGE(0,MSGID19,CRADDPTR(BLDIX1)->CRADDVAL,
*                                 LENGTH(CRADDVAL));               0431
         MVC   @AL00001(16),@AL00431                               0431
         LR    @14,BLDIX1                                          0431
         SLA   @14,2                                               0431
         L     @07,@PC00001+4                                      0431
         L     @01,FDTPTR+16(,@07)                                 0431
         AL    @01,@CF01392                                        0431
         L     @14,CRADDPTR(@14,@01)                               0431
         LA    @14,CRADDVAL(,@14)                                  0431
         ST    @14,@AL00001+8                                      0431
         LA    @01,@AL00001                                        0431
         BAL   @14,MESSAGE                                         0431
*                                 /* PRINT BAD JCL MESSAGE           */
*                    CRVBADVL=ON; /* INDICATE THAT VOLUME BAD        */
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0432
*                    END;         /*                                 */
*                ELSE;            /* ELSE: CONTINUE                  */
*                                                                  0434
@RF00427 DS    0H                                                  0435
*              /******************************************************/
*              /*                                                    */
*              /*    HANDLE THE DEVICE TYPE INFORMATION FOR          */
*              /*    THIS CRA VOLUME                                 */
*              /*                                                    */
*              /******************************************************/
*                                                                  0435
*              IF BLDPTR->TMSDTCD=TMSDTCDC                         0435
*                                 /* IF THE FIELD IS DEVTYPE         */
*                THEN CRVTKPCY=BLDPTR->TMSDTTPC;                   0435
@RC00427 CLC   TMSDTCD(2,BLDPTR),@CH00163                          0435
         BNE   @RF00435                                            0435
         MVC   CRVTKPCY(2,CRVEBASE),TMSDTTPC(BLDPTR)               0436
*                                 /* THEN: SAVE TRACKS PER CYL.      */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00435 DS    0H                                                  0438
*              BLDPTR=BLDPTR+BLDPTR->TMSVSLEN+LENGTH(TMSHDR);      0438
         LR    @14,BLDPTR                                          0438
         AH    @14,TMSVSLEN(,BLDPTR)                               0438
         AH    @14,@CH00043                                        0438
         LR    BLDPTR,@14                                          0438
*                                 /* POINT AT THE NEXT FIELD         */
*              END;               /*                                 */
         LA    @14,1                                               0439
         AL    @14,BLDIX2                                          0439
         ST    @14,BLDIX2                                          0439
         CH    @14,@CH00154                                        0439
         BNH   @DL00426                                            0439
*            /********************************************************/
*            /*                                                      */
*            /*    IF ENTRIES SPECIFIED FOR THIS CRA THEN            */
*            /*    CONSTRUCT THE NAME CHAIN                          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0440
*            IF ENTREPTR(BLDIX1)=NULLPTR                           0440
*                                 /* IF ENTRIES NOT SPECIFIED        */
*              THEN;              /* THEN: CONTINUE                  */
         LR    @14,BLDIX1                                          0440
         SLA   @14,2                                               0440
         L     @04,@PC00001+4                                      0440
         L     @04,FDTPTR+28(,@04)                                 0440
         AL    @04,@CF01392                                        0440
         L     @14,ENTREPTR(@14,@04)                               0440
         LTR   @14,@14                                             0440
         BZ    @RT00440                                            0440
*              ELSE DO;           /* ELSE:                           */
*                DO BLDIX2=1 TO ENTRECNT(BLDIX1);                  0443
         LA    @14,1                                               0443
         B     @DE00443                                            0443
@DL00443 DS    0H                                                  0444
*                                 /* LOOP TO BUILD ALL THE NAME      */
*                                 /* BLOCKS FOR THIS CRA             */
*                  CALL BUILDNAM(ENTNMPTR(BLDIX1,BLDIX2)->ENTNMVAL,
*                                BLDIX2);                          0444
         LR    @04,BLDIX1                                          0444
         MH    @04,@CH00762                                        0444
         ALR   @04,@14                                             0444
         SLA   @04,2                                               0444
         L     @14,@PC00001+4                                      0444
         L     @14,FDTPTR+52(,@14)                                 0444
         AL    @14,@CF01394                                        0444
         L     @14,ENTNMPTR(@04,@14)                               0444
         LA    @14,ENTNMVAL(,@14)                                  0444
         ST    @14,@AL00001                                        0444
         LA    @14,BLDIX2                                          0444
         ST    @14,@AL00001+4                                      0444
         LA    @01,@AL00001                                        0444
         BAL   @14,BUILDNAM                                        0444
*                                 /* GO TO BUILD A NAME BLOCK        */
*                  END;           /*                                 */
         LA    @14,1                                               0445
         AL    @14,BLDIX2                                          0445
@DE00443 ST    @14,BLDIX2                                          0445
         LR    @04,BLDIX1                                          0445
         SLA   @04,2                                               0445
         L     @07,@PC00001+4                                      0445
         L     @01,FDTPTR+28(,@07)                                 0445
         AL    @01,@CF01392                                        0445
         C     @14,ENTRECNT(@04,@01)                               0445
         BNH   @DL00443                                            0445
*                END;             /*                                 */
*            END;                 /*                                 */
*                                                                  0447
*          /**********************************************************/
*          /*                                                        */
*          /*    IF INFORMATION FOR THE VOLUME IS NOT OBTAINED       */
*          /*    THEN MARK THE VOLUME BAD AND PRINT MESSAGE          */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0448
*          ELSE DO;               /* ELSE:                           */
         B     @RC00423                                            0448
@RF00423 DS    0H                                                  0449
*            CALL MESSAGE(0,MSGID19,CRADDPTR(BLDIX1)->CRADDVAL,    0449
*                         LENGTH(CRADDVAL));                       0449
         MVC   @AL00001(16),@AL00449                               0449
         LR    @14,BLDIX1                                          0449
         SLA   @14,2                                               0449
         L     @04,@PC00001+4                                      0449
         L     @04,FDTPTR+16(,@04)                                 0449
         AL    @04,@CF01392                                        0449
         L     @14,CRADDPTR(@14,@04)                               0449
         LA    @14,CRADDVAL(,@14)                                  0449
         ST    @14,@AL00001+8                                      0449
         LA    @01,@AL00001                                        0449
         BAL   @14,MESSAGE                                         0449
*                                 /* PRINT BAD JCL MESSAGE           */
*            CRVBADVL=ON;         /* INDICATE A BAD VOLUME           */
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0450
*            END;                 /*                                 */
*        END;                     /*                                 */
@RC00423 AH    BLDIX1,@CH00220                                     0452
@DE00420 L     @14,@PC00001+4                                      0452
         LA    @14,FDTPTR+12(,@14)                                 0452
         C     BLDIX1,CRACNT(,@14)                                 0452
         BNH   @DL00420                                            0452
*      REG15=LASTCC00;            /* INDICATE ALL IS GOOD            */
         SLR   REG15,REG15                                         0453
*      END;                       /*                                 */
*    /****************************************************************/
*    /*                                                              */
*    /*    IF THE SPACE FOR THE TABLES COUND NOT BE OBTAINED         */
*    /*    THEN PRINT INSAFICIENT STORAGE MESSAGE                    */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0455
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00407                                            0455
@RF00407 DS    0H                                                  0456
*      REG15=LASTCC12;            /* INDICATE ERROR RETURN           */
         LA    REG15,12                                            0456
*      CORE=BAD;                  /* INDICATE CORE MESSAGE           */
         MVC   CORE(1),BAD                                         0457
*      END;                       /*                                 */
*                                                                  0458
*  RETURN CODE(REG15);            /* RETURN RETURN CODE              */
*                                                                  0459
@RC00407 L     @14,@SA00002                                        0459
         LM    @00,@12,@SA00002+8                                  0459
         BR    @14                                                 0459
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  0460
*  END BUILDCRV;                  /* END OF PRCOEDURE                */
@PB00002 DS    0H                                                  0462
*  GEN (EJECT);                                                    0462
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    BUILDNAM                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    CONSTRUCT A NAME CHAIN BLOCK FOR THE PROVIDED NAME          */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    NONE                                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0463
*BUILDNAM: PROCEDURE (PARMNAM,PARMNOS);                            0463
*                                                                  0463
         B     @PB00003                                            0463
BUILDNAM STM   @14,@12,@SA00003                                    0463
         MVC   @PC00003(8),0(@01)                                  0463
*  /******************************************************************/
*  /*                                                                */
*  /*    INCOMING PARAMETERS FOR THIS ROUTINE                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0464
*  DCL PARMNOS     FIXED(31);     /* NUMBER IN THE ARRAY             */
*  DCL PARMNAM     CHAR(*);       /* NAME TO COMPRESS                */
*                                                                  0465
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  0466
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0467
*  OLDERID2 = NEWERID2;                                            0467
         L     @14,@PC00001                                        0467
         L     @02,GDTTR2(,@14)                                    0467
         MVC   @TS00001(95),NEWERID2(@02)                          0467
         MVC   OLDERID2(95,@02),@TS00001                           0467
*  NEWID2='RC86';                                                  0468
         MVC   NEWID2(4,@02),@CC01111                              0468
*  IF GDTDBG = NULLPTR                                             0469
*    THEN;                                                         0469
         ICM   @02,15,GDTDBG(@14)                                  0469
         BZ    @RT00469                                            0469
*    ELSE                                                          0471
*      CALL IDCDB010 (GDTTBL,'RC86');                              0471
         L     @14,@PC00001                                        0471
         ST    @14,@AL00001                                        0471
         LA    @02,@CC01111                                        0471
         ST    @02,@AL00001+4                                      0471
         MVI   @AL00001+4,X'80'                                    0471
         L     @15,GDTDBG(,@14)                                    0471
         LA    @01,@AL00001                                        0471
         BALR  @14,@15                                             0471
*  /******************************************************************/
*  /*                                                                */
*  /*    BUILD THE NAME BLOCK FOR THE NAME CHAIN                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0472
*  CALL SUBSP (GETTYPE,LENGTH(NBLK),NBLKPTR);                      0472
@RT00469 MVC   @AL00001(8),@AL00472                                0472
         LA    @14,NBLKPTR                                         0472
         ST    @14,@AL00001+8                                      0472
         LA    @01,@AL00001                                        0472
         BAL   @14,SUBSP                                           0472
*                                 /* GET SPACE FOR A NAME BLOCK      */
*  IF REG15^=LASTCC00             /* IF THERE IS NO STORAGE          */
*    THEN REG15=LASTCC12;         /* THEN: INDICATE NO STORAGE       */
         LTR   REG15,REG15                                         0473
         BZ    @RF00473                                            0473
         LA    REG15,12                                            0474
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00473                                            0475
@RF00473 DS    0H                                                  0476
*      NBLKCHN=CRVNAMCH;          /* POINT BLOCK AT THE NAME         */
         L     @14,NBLKPTR                                         0476
         MVC   NBLKCHN(4,@14),CRVNAMCH(CRVEBASE)                   0476
*                                 /* CHAIN                           */
*      CRVNAMCH=NBLKPTR;          /* POINT CRV AT NEW CHAIN          */
         ST    @14,CRVNAMCH(,CRVEBASE)                             0477
*      NBLKENTN=PARMNOS;          /* PLACE NUMBER IN ARRAY           */
         L     @02,@PC00003+4                                      0478
         MVC   NBLKENTN(2,@14),PARMNOS+2(@02)                      0478
*      NBLKCI=INVALCI;            /* PLACE INVALID CI NUMBER         */
         MVC   NBLKCI(3,@14),INVALCI                               0479
*      NBLKICI=INVALCI;           /* SET INDEX CI INVALID            */
         MVC   NBLKICI(3,@14),INVALCI                              0480
*      NBLKDCI=INVALCI;           /* SET DATA CI INVALID             */
         MVC   NBLKDCI(3,@14),INVALCI                              0481
*      CALL COMPNAME (PARMNAM,NBLKNAME);                           0482
         L     @02,@PC00003                                        0482
         ST    @02,@AL00001                                        0482
         LA    @14,NBLKNAME(,@14)                                  0482
         ST    @14,@AL00001+4                                      0482
         LA    @01,@AL00001                                        0482
         BAL   @14,COMPNAME                                        0482
*                                 /* PLACE THE NAME POINTER IN       */
*                                 /* THE NAME BLOCK                  */
*      IF REG15^=LASTCC00         /* IF THERE IS NO STORAGE          */
*        THEN REG15=LASTCC12;     /* THEN: INDICATE NO STORAGE       */
         LTR   REG15,REG15                                         0483
         BZ    @RF00483                                            0483
         LA    REG15,12                                            0484
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF00483 DS    0H                                                  0486
*      END;                       /*                                 */
*                                                                  0486
*  RETURN CODE(REG15);            /* RETURN THE RETURN CODE          */
*                                                                  0487
@RC00473 L     @14,@SA00003                                        0487
         LM    @00,@12,@SA00003+8                                  0487
         BR    @14                                                 0487
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  0488
*  END BUILDNAM;                  /* END OF PROCEDURE                */
@PB00003 DS    0H                                                  0490
*  GEN (EJECT);                                                    0490
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    CKCATNM                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    CHECK TO SEE THAT ANY CRA THAT IS OPEN'ED IS FOR THE        */
*  /*    SAME CRA AS THE FIRST ONE OPEN'ED                           */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. THE CRV MUST BE BUILT                                    */
*  /*                                                                */
*  /*    2. THE CRA MUST BE OPEN'ED                                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0491
*CKCATNM: PROCEDURE (CPARM4);                                      0491
*                                                                  0491
         B     @PB00004                                            0491
CKCATNM  STM   @14,@01,@SA00004                                    0491
         STM   @03,@12,@SA00004+16                                 0491
         MVC   @PC00004(4),0(@01)                                  0491
*  DCL CPARM4   PTR(31);          /* INDEX INTO THE CRV              */
*                                                                  0492
*  /******************************************************************/
*  /*                                                                */
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0493
*  DCL UCBAREA     CHAR(LENGTH(UNITABL));                          0493
*                                 /* AREA FOR THE UCB ADDRESS        */
*  DCL UCBAPTR     PTR(31);       /* ADDRESS OF AREA                 */
*                                                                  0494
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  0495
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0496
*  OLDERID2 = NEWERID2;                                            0496
         L     @14,@PC00001                                        0496
         L     @07,GDTTR2(,@14)                                    0496
         MVC   @TS00001(95),NEWERID2(@07)                          0496
         MVC   OLDERID2(95,@07),@TS00001                           0496
*  NEWID2='RC93';                                                  0497
         MVC   NEWID2(4,@07),@CC01122                              0497
*  IF GDTDBG = NULLPTR                                             0498
*    THEN;                                                         0498
         ICM   @07,15,GDTDBG(@14)                                  0498
         BZ    @RT00498                                            0498
*    ELSE                                                          0500
*      CALL IDCDB010 (GDTTBL,'RC93');                              0500
         L     @14,@PC00001                                        0500
         ST    @14,@AL00001                                        0500
         LA    @07,@CC01122                                        0500
         ST    @07,@AL00001+4                                      0500
         MVI   @AL00001+4,X'80'                                    0500
         L     @15,GDTDBG(,@14)                                    0500
         LA    @01,@AL00001                                        0500
         BALR  @14,@15                                             0500
*  /******************************************************************/
*  /*                                                                */
*  /*    CHECK TO SEE IF THIS CRA HAS ALREADY HAD ITS OWNING         */
*  /*    CATALOG CHECKED WITH THE MAJOR OWNING CATALOG               */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0501
*  IF CRVCATOK=ON                 /* THEN: IF THE CATALOG NAME       */
*                                 /*       HAS BEEN CHECKED          */
*    THEN;                        /* THEN: CONTINUE                  */
*                                                                  0501
@RT00498 TM    CRVCATOK(CRVEBASE),B'01000000'                      0501
         BO    @RT00501                                            0501
*    /****************************************************************/
*    /*                                                              */
*    /*    READ IN A CRA RECORD SO THAT THE INFORMATION ABOUT        */
*    /*    THE OWNING CATALOG CAN BE OBTAINED                        */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0503
*    ELSE DO;                     /* ELSE:                           */
*      IOCRBA=CONCINO0;           /* PLACE RBA OF CI NUMBER 0        */
         L     @14,IOCSPTR                                         0504
         SLR   @07,@07                                             0504
         ST    @07,IOCRBA(,@14)                                    0504
*      CALL IDCIOGT0 (GDTTBL,IOCSPTR);                             0505
         L     @14,@PC00001                                        0505
         ST    @14,@AL00001                                        0505
         LA    @07,IOCSPTR                                         0505
         ST    @07,@AL00001+4                                      0505
         MVI   @AL00001+4,X'80'                                    0505
         L     @15,GDTGET(,@14)                                    0505
         LA    @01,@AL00001                                        0505
         BALR  @14,@15                                             0505
*                                 /* GET THE DESIRED RECORD          */
*      /**************************************************************/
*      /*                                                            */
*      /*    IF THERE WAS AN I/O ERROR THEN RETURN AN ERROR          */
*      /*    CODE                                                    */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0506
*      IF REG15^=LASTCC00         /* IF THE WAS AN ERROR             */
*        THEN DO;                 /* THEN:                           */
         LTR   REG15,REG15                                         0506
         BZ    @RF00506                                            0506
*          RSNCD=RSNCD04;         /* SET THE REASON CODE             */
         MVC   RSNCD(2),@CC00922                                   0508
*          ERRNO=ERCDIOER;        /* INDICATE THAT THERE WAS AN      */
         LA    ERRNO,12                                            0509
*                                 /* I/O ERROR IN READING THE        */
*                                 /* CRA                             */
*          END;                   /*                                 */
*        /************************************************************/
*        /*                                                          */
*        /*    IF THE I/O OPERATION WAS OK THEN CHECK IF THIS        */
*        /*    IS TO BE THE OWNING CATALOG BECAUSE IT IS THE         */
*        /*    FIRST ONE ENCOUNTERED                                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0511
*        ELSE IF CRVCATNL=0       /* ELSE: IF NO OWNING CATALOG      */
*                                 /*       NAME YET                  */
*        /************************************************************/
*        /*                                                          */
*        /*    MAKE THIS THE OWNING CATALOG NAME, AND ENQ ON IT      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0511
*          THEN DO;               /* THEN:                           */
         B     @RC00506                                            0511
@RF00506 L     @14,CRVBASE                                         0511
         CLI   CRVCATNL(@14),0                                     0511
         BNE   @RF00511                                            0511
*            CRVCATNC=RECNAME;    /* PLACE THE OWNING CATALOG        */
         L     @01,IOCSPTR                                         0513
         L     @01,IOCDAD(,@01)                                    0513
         MVC   CRVCATNC(44,@14),RECNAME(@01)                       0513
*                                 /* NAME FOR LATTER USE             */
*            IF CRVCATNC(21)=' ' /* IF THE NAME IS LESS THAN 21      */
*              THEN CRVCATNL=20; /* THEN: SET LENGTH TO 20           */
         CLI   CRVCATNC+20(@14),C' '                               0514
         BNE   @RF00514                                            0514
         MVI   CRVCATNL(@14),X'14'                                 0515
*                                /* ------------VS2-----------       */
*              ELSE CRVCATNL=LENGTH(CRVCATNC);                     0516
         B     @RC00514                                            0516
@RF00514 L     @14,CRVBASE                                         0516
         MVI   CRVCATNL(@14),X'2C'                                 0516
*                                 /* ELSE: SET LENGTH OF CAT NAME    */
*                                 /* -----------VS2-----------       */
*            CRVMAJNM=SYSTEM;                                      0517
@RC00514 L     @14,CRVBASE                                         0517
         MVC   CRVMAJNM(8,@14),SYSTEM                              0517
*                                 /* PLACE 'SYSIGGV2'                */
*                                 /* AS THE MAJOR NAME IN            */
*                                 /* -----------VS2-----------       */
*            UCBAPTR=ADDR(UCBAREA);                                0518
         LA    @14,UCBAREA                                         0518
         ST    @14,UCBAPTR                                         0518
*                                 /* POINT AT THE AREA               */
*            CALL IDCSASI0(GDTTBL,UNIT,UCBAPTR,                    0519
*                     CRADDPTR(CPARM4)->CRADDVAL);                 0519
         L     @14,@PC00001                                        0519
         ST    @14,@AL00001                                        0519
         LA    @07,UNIT                                            0519
         ST    @07,@AL00001+4                                      0519
         LA    @07,UCBAPTR                                         0519
         ST    @07,@AL00001+8                                      0519
         L     @07,@PC00004                                        0519
         L     @07,CPARM4(,@07)                                    0519
         SLA   @07,2                                               0519
         L     @06,@PC00001+4                                      0519
         L     @01,FDTPTR+16(,@06)                                 0519
         AL    @01,@CF01392                                        0519
         L     @01,CRADDPTR(@07,@01)                               0519
         LA    @07,CRADDVAL(,@01)                                  0519
         ST    @07,@AL00001+12                                     0519
         MVI   @AL00001+12,X'80'                                   0519
         L     @15,GDTSFO(,@14)                                    0519
         LA    @01,@AL00001                                        0519
         BALR  @14,@15                                             0519
*                                 /* GET THE UCB ADDRESS             */
*            IF REG15=LASTCC00    /* IF IT IS RETURNED               */
*              THEN DO;           /* THEN:                           */
         LTR   REG15,REG15                                         0520
         BNZ   @RF00520                                            0520
*                CALL IDCSARV0 (GDTTBL,SHR,WAIT,UCBAPTR->UNITUCB,  0522
*                          CRVMAJNM,CRVCATNM);                     0522
         L     @14,@PC00001                                        0522
         ST    @14,@AL00001                                        0522
         LA    @07,SHR                                             0522
         ST    @07,@AL00001+4                                      0522
         LA    @07,WAIT                                            0522
         ST    @07,@AL00001+8                                      0522
         L     @01,UCBAPTR                                         0522
         ST    @01,@AL00001+12                                     0522
         L     @07,CRVBASE                                         0522
         LA    @06,CRVMAJNM(,@07)                                  0522
         ST    @06,@AL00001+16                                     0522
         LA    @07,CRVCATNM(,@07)                                  0522
         ST    @07,@AL00001+20                                     0522
         MVI   @AL00001+20,X'80'                                   0522
         L     @15,GDTRSV(,@14)                                    0522
         LA    @01,@AL00001                                        0522
         BALR  @14,@15                                             0522
*                                 /* ENQ ON THE OWNING CATALOG       */
*                                 /* ___________VS1___________       */
*                END;             /*                                 */
*              ELSE DO;           /* ELSE:                           */
         B     @RC00520                                            0524
@RF00520 DS    0H                                                  0525
*                RSNCD=RSNCD09;   /* INDICATE UCB ERROR              */
         MVC   RSNCD(2),@CC00932                                   0525
*                ERRNO=ERCDIOER;  /* INDICATE I/O ERROR              */
         LA    ERRNO,12                                            0526
*                END;             /*                                 */
*            CRVCATOK=ON;         /* INDICATE THAT THIS CRA          */
@RC00520 OI    CRVCATOK(CRVEBASE),B'01000000'                      0528
*                                 /* HAS BEEN CHECKED                */
*            END;                 /*                                 */
*                                                                  0529
*          /**********************************************************/
*          /*                                                        */
*          /*    CHECK TO SEE THAT THIS NAME IS THE SAME AS          */
*          /*    THE FIRST ONE ENCOUNTERED                           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0530
*          ELSE IF CRVCATNC=RECNAME                                0530
*                                 /* ELSE: IF THE CATALOG NAME       */
*                                 /*       MATCHES THE INUSE         */
*            THEN CRVCATOK=ON;                                     0530
         B     @RC00511                                            0530
@RF00511 L     @14,IOCSPTR                                         0530
         L     @14,IOCDAD(,@14)                                    0530
         L     @01,CRVBASE                                         0530
         CLC   CRVCATNC(44,@01),RECNAME(@14)                       0530
         BNE   @RF00530                                            0530
         OI    CRVCATOK(CRVEBASE),B'01000000'                      0531
*                                 /* THEN: INDICATE THAT THIS        */
*                                 /*       CRA IS OK                 */
*            /********************************************************/
*            /*                                                      */
*            /*    IF THE NAME IS NOT THE SAME THEN PRINT THE        */
*            /*    MESSAGES REQUIRED                                 */
*            /*                                                      */
*            /********************************************************/
*                                                                  0532
*            ELSE DO;             /* ELSE:                           */
         B     @RC00530                                            0532
@RF00530 DS    0H                                                  0533
*              ERRNO=ERCDCTNM;    /* INDICATE THAT THIS CRA IS       */
         LA    ERRNO,16                                            0533
*                                 /* FOR A DIFFERENT CATALOG         */
*              CALL MESSAGE (0,MSGID16,VTTVOLSR(CPARM4),           0534
*                                 LENGTH(VTTVOLSR));               0534
         MVC   @AL00001(16),@AL00534                               0534
         L     @14,@PC00004                                        0534
         L     @14,CPARM4(,@14)                                    0534
         MH    @14,@CH00763                                        0534
         L     @01,CRVBASE                                         0534
         L     @01,CRVCRAPL(,@01)                                  0534
         L     @01,ACCVOLTT(,@01)                                  0534
         AL    @01,@CF01391                                        0534
         LA    @14,VTTVOLSR-4(@14,@01)                             0534
         ST    @14,@AL00001+8                                      0534
         LA    @01,@AL00001                                        0534
         BAL   @14,MESSAGE                                         0534
*                                 /* PRINT CRA TO NOT DO             */
*              CALL MESSAGE (0,MSGID17,CRVCATNM,                   0535
*                                 LENGTH(CRVCATNM));               0535
         MVC   @AL00001(16),@AL00535                               0535
         L     @14,CRVBASE                                         0535
         LA    @14,CRVCATNM(,@14)                                  0535
         ST    @14,@AL00001+8                                      0535
         LA    @01,@AL00001                                        0535
         BAL   @14,MESSAGE                                         0535
*                                 /* PRINT NAME OF CATALOG           */
*                                 /* THAT IS BEING DONE              */
*              CRVBADVL=ON;       /* INDICATE BAD VOLUME             */
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0536
*              END;               /*                                 */
*      END;                       /*                                 */
*                                                                  0538
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  0539
*  END CKCATNM;                   /* END OF PROCEDURE                */
@EL00004 DS    0H                                                  0540
@EF00004 DS    0H                                                  0540
@ER00004 LM    @14,@01,@SA00004                                    0540
         LM    @03,@12,@SA00004+16                                 0540
         BR    @14                                                 0540
@PB00004 DS    0H                                                  0541
*  GEN (EJECT);                                                    0541
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    CKNAMES                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS ROUTINE DOES THE FOLLOWING FUNCTIONS FOR EACH OF       */
*  /*    THE NAMES ON THE CRV ENTRY SELECTED AT THE TIME OF THE      */
*  /*    CALL-                                                       */
*  /*                                                                */
*  /*    FOR ALL VSAM OR ALTERNATE INDEXES                           */
*  /*                                                                */
*  /*    1. COLLECTS THE MASTER PASSWORD AND PLACES IT IN THE        */
*  /*       NAME BLOCK.                                              */
*  /*                                                                */
*  /*    2. INSURES THAT THE NAME IS NOT THAT OF A PAGING DATA       */
*  /*       SET.  IF IT IS AND IT WAS SELECTED BY AN 'ENTRIES'       */
*  /*       KEYWORD A MESSAGE IS PRINTED TO INDICATE INPROPER        */
*  /*       SELECTION, ELSE THE NAME IS SIMPLY BYPASSED.             */
*  /*                                                                */
*  /*    3. COLLECTS THE DATA AND INDEX ASSOCIATION POINTERS         */
*  /*       FOR LATTER USE AND PLACES THEM IN THE NAME BLOCK.        */
*  /*                                                                */
*  /*    4. MAKES SURE THAT THE DATA LRECL IS SMALLER THAN ANY       */
*  /*       PREVIOUS DATA LRECL.  IF IT IS NOT THAN THE DATA         */
*  /*       LRECL IS USED AS THE NEW MAXIMUM.                        */
*  /*                                                                */
*  /*    FOR ALL NON-VSAM DATA SETS:                                 */
*  /*                                                                */
*  /*    1. INSURES THAT THE NAME IS NOT PART OF A GENERATION        */
*  /*       DATA GROUP (GDG).  IF IT IS AND IT WAS SPECIFIED         */
*  /*       BY AN 'ENTRIES' KEYWORD A MESSAGE IS PRINTED TO          */
*  /*       INDICATE AN IMPROPER SELECTION, ELSE THE NAME IS         */
*  /*       SIMPLY BYPASSED.                                         */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. A CRV ENTRY MUST BE SELECTED.                            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0542
*CKNAMES: PROCEDURE (KPARM4);                                      0542
*                                                                  0542
         B     @PB00005                                            0542
CKNAMES  STM   @14,@12,@SA00005                                    0542
         MVC   @PC00005(4),0(@01)                                  0542
*  /******************************************************************/
*  /*                                                                */
*  /*    INCOMING PRPAMETER USED BY THIS ROUTINE                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0543
*  DCL KPARM4     FIXED(31);      /* INDEX INTO CRV                  */
*  /******************************************************************/
*  /*                                                                */
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0544
*  DCL KVALA      PTR(31);        /* ADDRESS OF DATA RETURNED        */
*  DCL KVALL      FIXED(31);      /* LENGTH OF DATA RETURNED         */
*                                                                  0545
*  DCL KVALD      FIXED(31) BASED(KVALA);                          0546
*                                 /* RETURNED 4 BYTE FIELD           */
*                                                                  0547
*  DCL KPW        CHAR(8) BASED(KVALA);                            0547
*                                 /* MASTER PASSWORD FOR ENTRY       */
*                                                                  0548
*  DCL 1 KCHAR    BIT(8) BASED(KVALA),                             0548
*                                 /* ASSOCIATION TYPE                */
*        2 *      BIT(7),         /* UNREFERENCED BITS               */
*        2 KPGDS  BIT(1);         /* INDICATES PAGE DATA SET         */
*                                                                  0548
*  DCL KPWINVAL   BIT(64) STATIC INITIAL('FFFFFFFFFFFFFFFF'X);     0549
*                                 /* NOEXISTENT PASSWORD             */
*                                                                  0550
*  DCL 1 KTYPE    BASED(KVALA),   /* USED FOR TYPE, CI NUMBER        */
*        2 KCHART CHAR(1),        /* TYPE OF ASSOCIATION             */
*        2 KCINO  FIXED(24);      /* ASSOCIATION'S CI NUMBER         */
*                                                                  0550
*  DCL KRRHDL     FIXED(31) CONSTANT(8);                           0551
*                                 /* LENGTH OF HEADER        @OZ26756*/
*  DCL RRDS       FIXED(15);      /* RRDS OVERHEAD FOR RECORD LENGTH */
*                                                          /*@OZ26756*/
*                                                                  0553
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0553
*  OLDERID2 = NEWERID2;                                            0553
         L     @04,@PC00001                                        0553
         L     @02,GDTTR2(,@04)                                    0553
         MVC   @TS00001(95),NEWERID2(@02)                          0553
         MVC   OLDERID2(95,@02),@TS00001                           0553
*  NEWID2='RC99';                                                  0554
         MVC   NEWID2(4,@02),@CC01143                              0554
*  IF GDTDBG = NULLPTR                                             0555
*    THEN;                                                         0555
         ICM   @02,15,GDTDBG(@04)                                  0555
         BZ    @RT00555                                            0555
*    ELSE                                                          0557
*      CALL IDCDB010 (GDTTBL,'RC99');                              0557
*                                                                  0557
         L     @04,@PC00001                                        0557
         ST    @04,@AL00001                                        0557
         LA    @02,@CC01143                                        0557
         ST    @02,@AL00001+4                                      0557
         MVI   @AL00001+4,X'80'                                    0557
         L     @15,GDTDBG(,@04)                                    0557
         LA    @01,@AL00001                                        0557
         BALR  @14,@15                                             0557
*  /******************************************************************/
*  /*                                                                */
*  /*    LOOP THROUGH ALL OF THE NAME BLOCKS ON THE LIST             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0558
*  NBLKPTR=CRVNAMCH;              /* POINT AT START OF CHAIN         */
@RT00555 MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       0558
*  DO WHILE NBLKPTR^=NULLPTR;     /* LOOP UNTIL CHAIN IS DONE        */
         B     @DE00559                                            0559
@DL00559 DS    0H                                                  0560
*    /****************************************************************/
*    /*                                                              */
*    /*    DO THE FOLLOWING FOR ALL VSAM DATA SETS AND FOR ALL       */
*    /*    ALTERNATE INDEXES                                         */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0560
*    IF NBLKTYPE=CLUSTYPE  NBLKTYPE=AIXTYPE                       0560
*                                 /* IF CLUSTER OR AIX               */
*      THEN DO;                   /* THEN:                           */
*                                                                  0560
         L     @04,NBLKPTR                                         0560
         CLI   NBLKTYPE(@04),C'C'                                  0560
         BE    @RT00560                                            0560
         CLI   NBLKTYPE(@04),C'G'                                  0560
         BNE   @RF00560                                            0560
@RT00560 DS    0H                                                  0561
*        /************************************************************/
*        /*                                                          */
*        /*    GATHER THE PASSWORDS FOR THE VSAM DATA SETS           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0562
*        CALL EXTRACT (0,NBLKCI,0,0,KVALA,KVALL,QPASWORD,0);       0562
         MVC   @AL00001(32),@AL00562                               0562
         L     @04,NBLKPTR                                         0562
         LA    @04,NBLKCI(,@04)                                    0562
         ST    @04,@AL00001+4                                      0562
         LA    @04,KVALA                                           0562
         ST    @04,@AL00001+16                                     0562
         LA    @04,KVALL                                           0562
         ST    @04,@AL00001+20                                     0562
         LA    @01,@AL00001                                        0562
         BAL   @14,EXTRACT                                         0562
*                                 /* GET THE MASTER PASSWORD         */
*        IF KVALA^=NULLPTR & KPW^=KPWINVAL                         0563
*                                 /* IF PASSWORD RETURNED AND        */
*                                 /* IT IS VALID                     */
*          THEN DO;               /* THEN:                           */
         L     @04,KVALA                                           0563
         LTR   @04,@04                                             0563
         BZ    @RF00563                                            0563
         CLC   KPW(8,@04),KPWINVAL                                 0563
         BE    @RF00563                                            0563
*            NBLKPW=KPW;          /* PLACE PASSWORD FOR LATTER       */
         L     @02,NBLKPTR                                         0565
         MVC   NBLKPW(8,@02),KPW(@04)                              0565
*                                 /* USE                             */
*            NBLKPWL=LENGTH(KPW); /* PLACE LENGTH OF PASSWORD        */
         MVI   NBLKPWL(@02),X'08'                                  0566
*                                 /* TO INDICATE PRESENCE            */
*            END;                 /*                                 */
*          ELSE NBLKPWL=0;        /* ELSE: INDICATE NO PASSWORD      */
         B     @RC00563                                            0568
@RF00563 L     @04,NBLKPTR                                         0568
         MVI   NBLKPWL(@04),X'00'                                  0568
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE FLAGGING OF THE PAGING DATA SETS           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0569
*        CALL EXTRACT (0,NBLKCI,0,0,KVALA,KVALL,QCATTR,0);         0569
@RC00563 MVC   @AL00001(32),@AL00569                               0569
         L     @04,NBLKPTR                                         0569
         LA    @04,NBLKCI(,@04)                                    0569
         ST    @04,@AL00001+4                                      0569
         LA    @04,KVALA                                           0569
         ST    @04,@AL00001+16                                     0569
         LA    @04,KVALL                                           0569
         ST    @04,@AL00001+20                                     0569
         LA    @01,@AL00001                                        0569
         BAL   @14,EXTRACT                                         0569
*                                 /* GET ATTRIBUTE BYTE              */
*        IF KVALA^=NULLPTR & KCHAR^=KPWINVAL(1:8) & KPGDS=ON       0570
*                                 /* IF DATA RETURNED AND IT IS      */
*                                 /* VALID DATA AND IT IS A          */
*                                 /* PAGING DATA SET                 */
*          THEN DO;               /* THEN:                           */
         L     @04,KVALA                                           0570
         SLR   @02,@02                                             0570
         CR    @04,@02                                             0570
         BE    @RF00570                                            0570
         CLC   KCHAR(1,@04),KPWINVAL                               0570
         BE    @RF00570                                            0570
         TM    KPGDS(@04),B'00000001'                              0570
         BNO   @RF00570                                            0570
*            NBLKBE=ON;           /* INDICATE NO EXPORT              */
         L     @04,NBLKPTR                                         0572
         OI    NBLKBE(@04),B'01000000'                             0572
*            IF ENTREPTR(KPARM4)=NULLPTR                           0573
*                                 /* IF NO ENTRIES FOR CRA           */
*              THEN;              /* THEN: CONTINUE                  */
         L     @04,@PC00005                                        0573
         L     @04,KPARM4(,@04)                                    0573
         SLA   @04,2                                               0573
         L     @15,@PC00001+4                                      0573
         L     @01,FDTPTR+28(,@15)                                 0573
         AL    @01,@CF01392                                        0573
         C     @02,ENTREPTR(@04,@01)                               0573
         BE    @RT00573                                            0573
*              ELSE DO;           /* ELSE:                           */
*                CALL MESSAGE(0,MSGID3,0,0);                       0576
         LA    @01,@AL00576                                        0576
         BAL   @14,MESSAGE                                         0576
*                                 /* PRINT INVALID TYPE              */
*                KVALL=NBLKNAME->DSNAMLEN;                         0577
         L     @04,NBLKPTR                                         0577
         L     @04,NBLKNAME(,@04)                                  0577
         LH    @02,DSNAMLEN(,@04)                                  0577
         ST    @02,KVALL                                           0577
*                                 /* GET THE NAME LENGTH             */
*                CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,KVALL);    0578
         LA    @02,@CF00116                                        0578
         ST    @02,@AL00001                                        0578
         LA    @02,@CH00885                                        0578
         ST    @02,@AL00001+4                                      0578
         LA    @04,DSNAM(,@04)                                     0578
         ST    @04,@AL00001+8                                      0578
         LA    @04,KVALL                                           0578
         ST    @04,@AL00001+12                                     0578
         LA    @01,@AL00001                                        0578
         BAL   @14,MESSAGE                                         0578
*                                 /* PRINT THE DSNAME                */
*                END;             /*                                 */
*            END;                 /*                                 */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00570 DS    0H                                                  0582
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE COLLECTION OF THE ASSOCIATION CI           */
*        /*    NUMBERS FOR THE VSAM DATA SETS                        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0582
*        CALL EXTRACT (0,NBLKCI,0,0,KVALA,KVALL,QNAMEDS,0);        0582
@RC00570 MVC   @AL00001(32),@AL00582                               0582
         L     @04,NBLKPTR                                         0582
         LA    @04,NBLKCI(,@04)                                    0582
         ST    @04,@AL00001+4                                      0582
         LA    @04,KVALA                                           0582
         ST    @04,@AL00001+16                                     0582
         LA    @04,KVALL                                           0582
         ST    @04,@AL00001+20                                     0582
         LA    @01,@AL00001                                        0582
         BAL   @14,EXTRACT                                         0582
*                                 /* GET THE ASSOCIATIONS            */
*        IF KVALA^=NULLPTR        /* IF DATA RETURNED                */
*          THEN DO;               /* THEN:                           */
         ICM   @04,15,KVALA                                        0583
         BZ    @RF00583                                            0583
*            DO WHILE KVALL>0;    /* LOOP THROUGH ALL DATA           */
         B     @DE00585                                            0585
@DL00585 DS    0H                                                  0586
*              IF KCHART=INDEXTYP /* IF INDEX CI NUMBER              */
*                THEN NBLKICI=KCINO;                               0586
         L     @04,KVALA                                           0586
         CLI   KCHART(@04),C'I'                                    0586
         BNE   @RF00586                                            0586
         L     @02,NBLKPTR                                         0587
         MVC   NBLKICI(3,@02),KCINO(@04)                           0587
*                                 /* THEN: SAVE INDEX CI NUMBER      */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00586 DS    0H                                                  0589
*              IF KCHART=DATATYP  /* IF DATA CI NUMBER               */
*                THEN NBLKDCI=KCINO;                               0589
         L     @04,KVALA                                           0589
         CLI   KCHART(@04),C'D'                                    0589
         BNE   @RF00589                                            0589
         L     @02,NBLKPTR                                         0590
         MVC   NBLKDCI(3,@02),KCINO(@04)                           0590
*                                 /* THEN: SAVE DATA CI NUMBER       */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00589 DS    0H                                                  0592
*              KVALA=KVALA+LENGTH(KTYPE);                          0592
         LA    @04,4                                               0592
         L     @02,KVALA                                           0592
         ALR   @02,@04                                             0592
         ST    @02,KVALA                                           0592
*                                 /* POINT AT NEXT ASSOCIATION       */
*              KVALL=KVALL-LENGTH(KTYPE);                          0593
         LCR   @04,@04                                             0593
         AL    @04,KVALL                                           0593
         ST    @04,KVALL                                           0593
*                                 /* COMPUTE REMAINDER OF SPACE      */
*              END;               /*                                 */
*                                                                  0594
@DE00585 ICM   @04,15,KVALL                                        0594
         BP    @DL00585                                            0594
*            /********************************************************/
*            /*                                                      */
*            /*    DETERMINE IF DATA SET IS RRDS TYPE AND IF SO      */
*            /*    PUT 4 IN FOR ADDITIONAL RRDS OVERHEAD     @OZ26756*/
*            /*                                                      */
*            /********************************************************/
*                                                                  0595
*            CALL EXTRACT (0,NBLKDCI,0,0,KVALA,KVALL,QMAMDSB,0);   0595
         MVC   @AL00001(32),@AL00595                               0595
         L     @04,NBLKPTR                                         0595
         LA    @04,NBLKDCI(,@04)                                   0595
         ST    @04,@AL00001+4                                      0595
         LA    @04,KVALA                                           0595
         ST    @04,@AL00001+16                                     0595
         LA    @04,KVALL                                           0595
         ST    @04,@AL00001+20                                     0595
         LA    @01,@AL00001                                        0595
         BAL   @14,EXTRACT                                         0595
*                                 /* GET THE AMDSB TO CHECK FOR RRDS */
*                                                          /*@OZ26756*/
*            IF AMDRRDS = ON                               /*@OZ26756*/
*              THEN                                        /*@OZ26756*/
         L     @04,KVALA                                           0596
         TM    AMDRRDS(@04),B'00000010'                            0596
         BNO   @RF00596                                            0596
*                RRDS = 4;                                 /*@OZ26756*/
         LA    RRDS,4                                              0597
*              ELSE                                        /*@OZ26756*/
*                RRDS = 0;                                 /*@OZ26756*/
*                                                                  0598
         B     @RC00596                                            0598
@RF00596 SLR   RRDS,RRDS                                           0598
*            /********************************************************/
*            /*                                                      */
*            /*    HANDLE THE DETERMINATION OF THE LARGEST           */
*            /*    LRECL FOR THESE DATA SETS                         */
*            /*                                                      */
*            /********************************************************/
*                                                                  0599
*            CALL EXTRACT (0,NBLKDCI,0,0,KVALA,KVALL,QMXLRECL,0);  0599
@RC00596 MVC   @AL00001(32),@AL00599                               0599
         L     @04,NBLKPTR                                         0599
         LA    @04,NBLKDCI(,@04)                                   0599
         ST    @04,@AL00001+4                                      0599
         LA    @04,KVALA                                           0599
         ST    @04,@AL00001+16                                     0599
         LA    @04,KVALL                                           0599
         ST    @04,@AL00001+20                                     0599
         LA    @01,@AL00001                                        0599
         BAL   @14,EXTRACT                                         0599
*                                 /* GET THE LRECL FOR THE DATA      */
*                                 /* ASSOCIATION                     */
*            IF KVALA ^= NULLPTR & (KVALD + KRRHDL + RRDS) > CRVMAXLR
*                                 /* IF DATA IS RETURNED AND         */
*                                 /* IT IS LARGER LRECL      @OZ26756*/
*              THEN CRVMAXLR=KVALD + KRRHDL + RRDS;        /*@OZ26756*/
         L     @04,KVALA                                           0600
         LTR   @04,@04                                             0600
         BZ    @RF00600                                            0600
         LA    @15,8                                               0600
         AL    @15,KVALD(,@04)                                     0600
         ALR   @15,RRDS                                            0600
         L     @04,CRVBASE                                         0600
         C     @15,CRVMAXLR(,@04)                                  0600
         BNH   @RF00600                                            0600
         ST    @15,CRVMAXLR(,@04)                                  0601
*                                 /* THEN: PLACE NEW LRECL           */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF00600 DS    0H                                                  0603
*            /********************************************************/
*            /*                                                      */
*            /*    GET THE EMPTY DATA SET INDICATOR                  */
*            /*                                                      */
*            /********************************************************/
*                                                                  0603
*            CALL EXTRACT(0,NBLKDCI,0,0,KVALA,KVALL,QHURBA,0);     0603
         MVC   @AL00001(32),@AL00603                               0603
         L     @04,NBLKPTR                                         0603
         LA    @04,NBLKDCI(,@04)                                   0603
         ST    @04,@AL00001+4                                      0603
         LA    @04,KVALA                                           0603
         ST    @04,@AL00001+16                                     0603
         LA    @04,KVALL                                           0603
         ST    @04,@AL00001+20                                     0603
         LA    @01,@AL00001                                        0603
         BAL   @14,EXTRACT                                         0603
*                                 /* GET THE HIGH USED RBA           */
*            IF KVALA^=NULLPTR & KVALD=0                           0604
*                                 /* IF THERE IS A VALUE AND         */
*                                 /* IT IS ZERO                      */
*              THEN NBLKMT=ON;    /* THEN: INDICATE EMPTY D.S.       */
         L     @04,KVALA                                           0604
         SLR   @02,@02                                             0604
         CR    @04,@02                                             0604
         BE    @RF00604                                            0604
         C     @02,KVALD(,@04)                                     0604
         BNE   @RF00604                                            0604
         L     @04,NBLKPTR                                         0605
         OI    NBLKMT(@04),B'00010000'                             0605
*              ELSE;              /* ELSE: CONTINUE                  */
@RF00604 DS    0H                                                  0607
*            END;                 /*                                 */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00583 DS    0H                                                  0609
*        END;                     /*                                 */
*      ELSE;                      /* ELSE: CONTINUE                  */
@RF00560 DS    0H                                                  0611
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE ALL OF THE NON-VSAM NAMES                          */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0611
*    IF NBLKTYPE=NONVTYPE         /* IF NON-VSAM ENTRY               */
*      THEN DO;                   /* THEN:                           */
*                                                                  0611
         L     @04,NBLKPTR                                         0611
         CLI   NBLKTYPE(@04),C'A'                                  0611
         BNE   @RF00611                                            0611
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE CHECKING OF GDG BASES                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  0613
*        CALL EXTRACT (1,NBLKCI,0,0,KVALA,KVALL,QTYPE,0,           0613
*                      QTYPE,EQUAL,0,ADDR(GDGBTYPE),               0613
*                      LENGTH(GDGBTYPE));                          0613
         MVC   @AL00001(52),@AL00613                               0613
         LA    @04,NBLKCI(,@04)                                    0613
         ST    @04,@AL00001+4                                      0613
         LA    @04,KVALA                                           0613
         ST    @04,@AL00001+16                                     0613
         LA    @04,KVALL                                           0613
         ST    @04,@AL00001+20                                     0613
         LA    @04,@CC00860                                        0613
         ST    @04,@AFTEMPS+4                                      0613
         LA    @04,@AFTEMPS+4                                      0613
         ST    @04,@AL00001+44                                     0613
         LA    @01,@AL00001                                        0613
         BAL   @14,EXTRACT                                         0613
*                                 /* GET THE GDG ASSOCIATION IF      */
*                                 /* THERE IS ONE                    */
*        IF KVALA^=NULLPTR & KCHAR=GDGBTYPE                        0614
*                                 /* IF DATA RETURNED AND IT         */
*                                 /* IS FOR A GDGBASE                */
*          THEN DO;               /* THEN:                           */
         L     @04,KVALA                                           0614
         SLR   @02,@02                                             0614
         CR    @04,@02                                             0614
         BE    @RF00614                                            0614
         CLI   KCHAR(@04),C'B'                                     0614
         BNE   @RF00614                                            0614
*            NBLKBE=ON;           /* INDICATE NO EXPORT              */
         L     @04,NBLKPTR                                         0616
         OI    NBLKBE(@04),B'01000000'                             0616
*            IF ENTREPTR(KPARM4)=NULLPTR                           0617
*                                 /* IF ENTRIES FOR THIS CRA         */
*              THEN;              /* THEN: CONTINUE                  */
         L     @04,@PC00005                                        0617
         L     @04,KPARM4(,@04)                                    0617
         SLA   @04,2                                               0617
         L     @15,@PC00001+4                                      0617
         L     @01,FDTPTR+28(,@15)                                 0617
         AL    @01,@CF01392                                        0617
         C     @02,ENTREPTR(@04,@01)                               0617
         BE    @RT00617                                            0617
*              ELSE DO;           /* ELSE:                           */
*                CALL MESSAGE(0,MSGID3,0,0);                       0620
         LA    @01,@AL00620                                        0620
         BAL   @14,MESSAGE                                         0620
*                                 /* PRINT INVALID TYPE              */
*                KVALL=NBLKNAME->DSNAMLEN;                         0621
         L     @04,NBLKPTR                                         0621
         L     @04,NBLKNAME(,@04)                                  0621
         LH    @02,DSNAMLEN(,@04)                                  0621
         ST    @02,KVALL                                           0621
*                                 /* GET THE NAME LENGTH             */
*                CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,KVALL);    0622
         LA    @02,@CF00116                                        0622
         ST    @02,@AL00001                                        0622
         LA    @02,@CH00885                                        0622
         ST    @02,@AL00001+4                                      0622
         LA    @04,DSNAM(,@04)                                     0622
         ST    @04,@AL00001+8                                      0622
         LA    @04,KVALL                                           0622
         ST    @04,@AL00001+12                                     0622
         LA    @01,@AL00001                                        0622
         BAL   @14,MESSAGE                                         0622
*                                 /* PRINT THE DSNAME                */
*                END;             /*                                 */
*            END;                 /*                                 */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF00614 DS    0H                                                  0626
*        END;                     /*                                 */
*      ELSE;                      /* ELSE: CONTINUE                  */
*                                                                  0627
@RF00611 DS    0H                                                  0628
*    NBLKPTR=NBLKCHN;             /* POINT AT THE NEXT ENTRY         */
@RC00611 L     @04,NBLKPTR                                         0628
         L     @04,NBLKCHN(,@04)                                   0628
         ST    @04,NBLKPTR                                         0628
*    END;                         /*                                 */
@DE00559 ICM   @04,15,NBLKPTR                                      0629
         BNZ   @DL00559                                            0629
*  END CKNAMES;                   /* END OF PROCEDURE                */
@EL00005 DS    0H                                                  0630
@EF00005 DS    0H                                                  0630
@ER00005 LM    @14,@12,@SA00005                                    0630
         BR    @14                                                 0630
@PB00005 DS    0H                                                  0631
*  GEN (EJECT);                                                    0631
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    COMPNAME                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    COMPRESSS THE NAME PROVIDED FROM THE 44 CHARACTERS          */
*  /*    WITH TRAILING BLANKS TO SOMETHING LESS WITH NO TRAIL-       */
*  /*    ING BLANKS                                                  */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    NONE                                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0632
*COMPNAME: PROCEDURE (PARMDSN,DSNAMPTR);                           0632
*                                                                  0632
         B     @PB00006                                            0632
COMPNAME STM   @14,@12,@SA00006                                    0632
         MVC   @PC00006(8),0(@01)                                  0632
*  DCL PARMDSN        CHAR(44);   /* INPUT UNCOMPRESSED NAME         */
*  DCL DSNAMPTR       PTR(31);    /* ADDRESS OF COMPRESSED NAME      */
*                                 /* BLOCK                           */
*                                                                  0635
*  DCL INDEX1         FIXED(31);  /* COUNTER FOR THE COMPRESSOR      */
*  DCL INDEX2         FIXED(31);  /* LENGTH OF COMPRESSED NAME       */
*                                                                  0636
*  RFY REG15 RSTD;                /* RSTRICT THE REGISTER            */
*                                                                  0637
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0638
*  OLDERID2 = NEWERID2;                                            0638
         L     @14,@PC00001                                        0638
         L     @07,GDTTR2(,@14)                                    0638
         MVC   @TS00001(95),NEWERID2(@07)                          0638
         MVC   OLDERID2(95,@07),@TS00001                           0638
*  NEWID2='RC87';                                                  0639
         MVC   NEWID2(4,@07),@CC01154                              0639
*  IF GDTDBG = NULLPTR                                             0640
*    THEN;                                                         0640
         ICM   @07,15,GDTDBG(@14)                                  0640
         BZ    @RT00640                                            0640
*    ELSE                                                          0642
*      CALL IDCDB010 (GDTTBL,'RC87');                              0642
         L     @14,@PC00001                                        0642
         ST    @14,@AL00001                                        0642
         LA    @07,@CC01154                                        0642
         ST    @07,@AL00001+4                                      0642
         MVI   @AL00001+4,X'80'                                    0642
         L     @15,GDTDBG(,@14)                                    0642
         LA    @01,@AL00001                                        0642
         BALR  @14,@15                                             0642
*  /******************************************************************/
*  /*                                                                */
*  /*    COMPRESS THE BLANKS FROM THE RIGHT OF THE NAME AND          */
*  /*    OBTAIN SPACE TO HOLD THE COMPRESSED NAME                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0643
*  INDEX2=LENGTH(PARMDSN);        /* SET INDEX TO LAST CHAR-         */
@RT00640 LA    INDEX2,44                                           0643
*                                 /* ACTER OF THE NAME               */
*  DO INDEX1=1 TO (LENGTH(PARMDSN)-1) WHILE PARMDSN(INDEX2)=' ';   0644
         LA    INDEX1,1                                            0644
@DL00644 L     @14,@PC00006                                        0644
         ALR   @14,INDEX2                                          0644
         BCTR  @14,0                                               0644
         CLI   PARMDSN(@14),C' '                                   0644
         BNE   @DC00644                                            0644
*                                 /* LOOP UNTIL RIGHTMOST NON-       */
*                                 /* BLANK IS FOUND                  */
*    INDEX2=INDEX2-1;             /* DECREMENT TO THE NEXT           */
         BCTR  INDEX2,0                                            0645
*                                 /* CHARACTER LEFT                  */
*    END;                         /*                                 */
         AL    INDEX1,@CF00220                                     0646
         CH    INDEX1,@CH01379                                     0646
         BNH   @DL00644                                            0646
@DC00644 DS    0H                                                  0647
*  CALL SUBSP(GETTYPE,INDEX2+LENGTH(DSNAMLEN),DSNAMPTR);           0647
         LA    @14,@CC00849                                        0647
         ST    @14,@AL00001                                        0647
         LA    @14,2                                               0647
         ALR   @14,INDEX2                                          0647
         ST    @14,@AFTEMPS+8                                      0647
         LA    @14,@AFTEMPS+8                                      0647
         ST    @14,@AL00001+4                                      0647
         L     @14,@PC00006+4                                      0647
         ST    @14,@AL00001+8                                      0647
         LA    @01,@AL00001                                        0647
         BAL   @14,SUBSP                                           0647
*                                 /* GET THE SPACE FOR THE NAME      */
*                                                                  0648
*  /******************************************************************/
*  /*                                                                */
*  /*    IF EVERY THING IS OK, PLACE THE COMPRESSED NAME IN          */
*  /*    THE SPACE OBTAINED FOR IT                                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0648
*  IF REG15^=LASTCC00             /* IF THERE IS NO SPACE            */
*    THEN REG15=LASTCC12;         /* THEN: SET RETURN CODE           */
         LTR   REG15,REG15                                         0648
         BZ    @RF00648                                            0648
         LA    REG15,12                                            0649
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00648                                            0650
@RF00648 DS    0H                                                  0651
*      DSNAMPTR->DSNAM(1:INDEX2)=PARMDSN(1:INDEX2);                0651
         L     @14,@PC00006+4                                      0651
         L     @14,DSNAMPTR(,@14)                                  0651
         LR    @03,INDEX2                                          0651
         BCTR  @03,0                                               0651
         L     @07,@PC00006                                        0651
         EX    @03,@SM01397                                        0651
*                                 /* PLACE THE NAME IN THE AREA      */
*                                 /* PROVIDED                        */
*      DSNAMPTR->DSNAMLEN=INDEX2; /* SAVE THE LENGTH OF THE          */
         STH   INDEX2,DSNAMLEN(,@14)                               0652
*                                 /* COMPRESSED NAME                 */
*      END;                       /*                                 */
*                                                                  0653
*  RETURN CODE(REG15);            /* PASS THE RETURN CODE            */
*                                                                  0654
@RC00648 L     @14,@SA00006                                        0654
         LM    @00,@12,@SA00006+8                                  0654
         BR    @14                                                 0654
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  0655
*  END COMPNAME;                  /* END OF PROCEDURE                */
@PB00006 DS    0H                                                  0657
*  GEN (EJECT);                                                    0657
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    DIRECT                                                      */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS ROUTINE OBTAINS SPACE FOR THE DIRECTORY INFOR-         */
*  /*    MATION FROM THIS CRA.                                       */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    THE CORRECT CRV ENTRY MUST BE POINTED AT PREVIOUS TO        */
*  /*    THE CALL.                                                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0658
*DIRECT: PROCEDURE;                                                0658
*                                                                  0658
         B     @PB00007                                            0658
DIRECT   STM   @14,@01,@SA00007                                    0658
         STM   @03,@12,@SA00007+16                                 0658
*  /******************************************************************/
*  /*                                                                */
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0659
*  DCL OUTAD         PTR(31);     /* ADDRESS OF DATA RECIEVED        */
*                                                                  0659
*  DCL OUTLNG        FIXED(31);   /* LENGTH OF DATA RECIEVED         */
*                                                                  0660
*  DCL GRPCD8        BIT(8) CONSTANT('08'X);                       0661
*                                 /* DIRECTORY ENTRY GROUP CODE      */
*                                                                  0662
*  DCL DIRCNT        FIXED(15) BASED(OUTAD);                       0662
*                                 /* HIGHEST SEQUENCE NUMBER         */
*                                 /* FOR DIRECTORY ENTRYS            */
*                                                                  0663
*  DCL DIRSIZE       FIXED(31);   /* SIZE OF DIRECTORY TO GET        */
*                                                                  0663
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  0664
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0665
*  OLDERID2 = NEWERID2;                                            0665
         L     @14,@PC00001                                        0665
         L     @04,GDTTR2(,@14)                                    0665
         MVC   @TS00001(95),NEWERID2(@04)                          0665
         MVC   OLDERID2(95,@04),@TS00001                           0665
*  NEWID2='RC98';                                                  0666
         MVC   NEWID2(4,@04),@CC01165                              0666
*  IF GDTDBG = NULLPTR                                             0667
*    THEN;                                                         0667
         ICM   @04,15,GDTDBG(@14)                                  0667
         BZ    @RT00667                                            0667
*    ELSE                                                          0669
*      CALL IDCDB010 (GDTTBL,'RC98');                              0669
         L     @14,@PC00001                                        0669
         ST    @14,@AL00001                                        0669
         LA    @04,@CC01165                                        0669
         ST    @04,@AL00001+4                                      0669
         MVI   @AL00001+4,X'80'                                    0669
         L     @15,GDTDBG(,@14)                                    0669
         LA    @01,@AL00001                                        0669
         BALR  @14,@15                                             0669
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THERE IS NO PREVIOUS ERROR OR THE DIRECTORY HAS          */
*  /*    NOT BEEN PREVIOUSLY BEEN CONSTRUCTED, CONSTRUCT THE         */
*  /*    DIRECTORY FOR THIS CRV ENTRY                                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0670
*  IF ERRNO=ERCDNRML & CRVDIREC=NULLPTR                            0670
*                                 /* IF THERE IS NO ERROR AND        */
*                                 /* THE DIRECTORY HAS NOT BEEN      */
*                                 /* BEFORE                          */
*                                                                  0670
*    /****************************************************************/
*    /*                                                              */
*    /*    FIND THE NUMBER OF DIRECTORY ENTRIES                      */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0670
*    THEN DO;                     /* THEN:                           */
@RT00667 SLR   @14,@14                                             0670
         CR    ERRNO,@14                                           0670
         BNE   @RF00670                                            0670
         C     @14,CRVDIREC(,CRVEBASE)                             0670
         BNE   @RF00670                                            0670
*      CALL EXTRACT(0,CTTCATCI(VOLRECCI-BEGINCI+1),0,0,            0672
*                   OUTAD,OUTLNG,QREPNO,GRPCD8);                   0672
         MVC   @AL00001(32),@AL00672                               0672
         L     @14,CRVADCTT(,CRVEBASE)                             0672
         LA    @14,CTTCATCI(,@14)                                  0672
         ST    @14,@AL00001+4                                      0672
         LA    @14,OUTAD                                           0672
         ST    @14,@AL00001+16                                     0672
         LA    @14,OUTLNG                                          0672
         ST    @14,@AL00001+20                                     0672
         LA    @01,@AL00001                                        0672
         BAL   @14,EXTRACT                                         0672
*                                 /* GET THE HIGHEST SEQUENCE        */
*                                 /* NUMBER OF THE DIRECTORY         */
*      IF OUTAD^=NULLPTR & DIRCNT^=0                               0673
*                                 /* IF DATA RETURNED AND IT IS      */
*                                 /* A REAL VALUE                    */
*        THEN DO;                 /* THEN:                           */
         L     @14,OUTAD                                           0673
         SLR   @04,@04                                             0673
         CR    @14,@04                                             0673
         BE    @RF00673                                            0673
         LH    @14,DIRCNT(,@14)                                    0673
         CR    @14,@04                                             0673
         BE    @RF00673                                            0673
*          DIRSIZE=LENGTH(DIRECTY)*(DIRCNT)+LENGTH(DIRLENU);       0675
         LR    @04,@14                                             0675
         MH    @04,@CH00038                                        0675
         AH    @04,@CH00154                                        0675
         ST    @04,DIRSIZE                                         0675
*                                 /* COUMPUT THE SIZE OF BLOCK       */
*                                 /* PLUS OVERHEAD                   */
*          CRVHIREP=DIRCNT;       /* SAVE THE NUMBER IF              */
         STH   @14,CRVHIREP(,CRVEBASE)                             0676
*                                 /* DIRECTORY ENTRIES               */
*                                                                  0677
*          /**********************************************************/
*          /*                                                        */
*          /*    GET THE DIRECTORY ENTRIES                           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  0677
*          CALL IDCSAGP0(GDTTBL,DIRSIZE,CRVDIREC,COREID3,SETZERO); 0677
         L     @14,@PC00001                                        0677
         ST    @14,@AL00001                                        0677
         LA    @04,DIRSIZE                                         0677
         ST    @04,@AL00001+4                                      0677
         LA    @04,CRVDIREC(,CRVEBASE)                             0677
         ST    @04,@AL00001+8                                      0677
         LA    @04,@CC00833                                        0677
         ST    @04,@AL00001+12                                     0677
         LA    @04,SETZERO                                         0677
         ST    @04,@AL00001+16                                     0677
         MVI   @AL00001+16,X'80'                                   0677
         L     @15,GDTGPL(,@14)                                    0677
         LA    @01,@AL00001                                        0677
         BALR  @14,@15                                             0677
*                                 /* GET THE SPACE FOR THE           */
*                                 /* DIRECTORY                       */
*          IF REG15=LASTCC00      /* IF THERE IS NO ERROR            */
*            THEN DO;             /* THEN:                           */
         LTR   REG15,REG15                                         0678
         BNZ   @RF00678                                            0678
*              CALL EXTRACT(0,CTTCATCI(VOLRECCI-BEGINCI+1),        0680
*                           CRVDIREC,DIRSIZE,                      0680
*                           CRVDIREC,OUTLNG,QDSDRRPM,0);   /*@OZ25037*/
         LA    @14,@CF00116                                        0680
         ST    @14,@AL00001                                        0680
         L     @14,CRVADCTT(,CRVEBASE)                             0680
         LA    @14,CTTCATCI(,@14)                                  0680
         ST    @14,@AL00001+4                                      0680
         LA    @14,CRVDIREC(,CRVEBASE)                             0680
         ST    @14,@AL00001+8                                      0680
         LA    @14,DIRSIZE                                         0680
         ST    @14,@AL00001+12                                     0680
         LA    @14,CRVDIREC(,CRVEBASE)                             0680
         ST    @14,@AL00001+16                                     0680
         LA    @14,OUTLNG                                          0680
         ST    @14,@AL00001+20                                     0680
         LA    @14,QDSDRRPM                                        0680
         ST    @14,@AL00001+24                                     0680
         LA    @14,@CF00116                                        0680
         ST    @14,@AL00001+28                                     0680
         LA    @01,@AL00001                                        0680
         BAL   @14,EXTRACT                                         0680
*                                 /* BRING IN THE DIRECTORY          */
*              /******************************************************/
*              /*                                                    */
*              /*    HANDLE THE REASON CODE FOR THE ERROR IF         */
*              /*    THERE WAS AN ERROR                              */
*              /*                                                    */
*              /******************************************************/
*                                                                  0681
*              IF CRVDIREC=NULLPTR/* IF NO DATA RETURNED             */
*                THEN DO;         /* THEN:                           */
         SLR   @14,@14                                             0681
         C     @14,CRVDIREC(,CRVEBASE)                             0681
         BNE   @RF00681                                            0681
*                  IF FRC^=NULLPTR/* IF FORCE SPECIFIED              */
*                    THEN;        /* THEN: CONTINUE                  */
         L     @07,@PC00001+4                                      0683
         L     @01,FDTPTR(,@07)                                    0683
         C     @14,FRC(,@01)                                       0683
         BNE   @RT00683                                            0683
*                    ELSE DO;     /* ELSE:                           */
*                      RSNCD=RSNCD08;                              0686
         MVC   RSNCD(2),@CC00930                                   0686
*                                 /* INDICATE THE ERROR TYPE         */
*                      CRVDIRER=ON;                                0687
         OI    CRVDIRER(CRVEBASE),B'00001000'                      0687
*                                 /* INDICATE DIRECTORY ERROR        */
*                      ERRNO=ERCDFMDT;                             0688
         LA    ERRNO,32                                            0688
*                                 /* INDICATE NO DATA FOUND          */
*                      END;       /*                                 */
*                  END;           /*                                 */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF00681 DS    0H                                                  0692
*              END;               /*                                 */
*            ELSE DO;             /* ELSE:                           */
         B     @RC00678                                            0693
@RF00678 DS    0H                                                  0694
*              ERRNO=ERCDNSTR;    /* INDICATE NO STORAGE             */
         LA    ERRNO,28                                            0694
*              CORE=BAD;          /* INDICATE CORE MESSAGE           */
         MVC   CORE(1),BAD                                         0695
*              END;               /*                                 */
*          END;                   /*                                 */
*                                                                  0697
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE REASON CODE FOR NO NUMBER OF DIREC-        */
*        /*    TORY ENTRIES                                          */
*        /*                                                          */
*        /************************************************************/
*                                                                  0698
*        ELSE DO;                 /* ELSE:                           */
         B     @RC00673                                            0698
@RF00673 DS    0H                                                  0699
*          IF FRC^=NULLPTR        /* IF FORCE SPECIFIED              */
*            THEN;                /* THEN: CONTINUE                  */
         L     @14,@PC00001+4                                      0699
         L     @14,FDTPTR(,@14)                                    0699
         ICM   @07,15,FRC(@14)                                     0699
         BNZ   @RT00699                                            0699
*            ELSE DO;             /* ELSE:                           */
*              RSNCD=RSNCD07;     /* INDICATE THE ERROR TYPE         */
         MVC   RSNCD(2),@CC00928                                   0702
*              CRVDIRER=ON;       /* INDICATE DIRECTORY ERROR        */
         OI    CRVDIRER(CRVEBASE),B'00001000'                      0703
*              ERRNO=ERCDFMDT;    /* INDICATE NO DATA FOUND          */
         LA    ERRNO,32                                            0704
*              END;               /*                                 */
*          END;                   /*                                 */
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0708
@RF00670 DS    0H                                                  0709
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  0709
*  END DIRECT;                    /* END OF PROCEDURE                */
@EL00007 DS    0H                                                  0710
@EF00007 DS    0H                                                  0710
@ER00007 LM    @14,@01,@SA00007                                    0710
         LM    @03,@12,@SA00007+16                                 0710
         BR    @14                                                 0710
@PB00007 DS    0H                                                  0711
*  GEN (EJECT);                                                    0711
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    DUPNAMCK                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    INSURE THAT ANY NAMES SKIPPED BECAUSE THEY ARE DUPLI-       */
*  /*    CATIONS OF SOME OTHER NAMES ARE PRINTED TO INFORM           */
*  /*    THE USER                                                    */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. THE NAME TABLES OF ALL CRA'S PREVIOUS IN THE FDT         */
*  /*       MUST HAVE BEEN CONSTRUCTED                               */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0712
*DUPNAMCK: PROCEDURE (DPARM4);                                     0712
*                                                                  0712
         B     @PB00008                                            0712
DUPNAMCK STM   @14,@12,@SA00008                                    0712
         MVC   @PC00008(4),0(@01)                                  0712
*  DCL DPARM4        FIXED(31);   /* INDEX INTO CRV                  */
*  DCL DUPIX         FIXED(31);   /* CCRV INDEX NUMBER TO SCAN       */
*  DCL DUPPTR        PTR(31);     /* REFERENCE CHAIN POINTER         */
*  DCL DUPIXL        FIXED(31);   /* GENERAL COUNTER                 */
*                                                                  0716
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0717
*  OLDERID2 = NEWERID2;                                            0717
         L     @02,@PC00001                                        0717
         L     @15,GDTTR2(,@02)                                    0717
         MVC   @TS00001(95),NEWERID2(@15)                          0717
         MVC   OLDERID2(95,@15),@TS00001                           0717
*  NEWID2='RC85';                                                  0718
         MVC   NEWID2(4,@15),@CC01174                              0718
*  IF GDTDBG = NULLPTR                                             0719
*    THEN;                                                         0719
         ICM   @15,15,GDTDBG(@02)                                  0719
         BZ    @RT00719                                            0719
*    ELSE                                                          0721
*      CALL IDCDB010 (GDTTBL,'RC85');                              0721
*                                                                  0721
         L     @02,@PC00001                                        0721
         ST    @02,@AL00001                                        0721
         LA    @15,@CC01174                                        0721
         ST    @15,@AL00001+4                                      0721
         MVI   @AL00001+4,X'80'                                    0721
         L     @15,GDTDBG(,@02)                                    0721
         LA    @01,@AL00001                                        0721
         BALR  @14,@15                                             0721
*  /******************************************************************/
*  /*                                                                */
*  /*    POINT AT THE NAME CHAIN TO CHECK FOR DUPLICATES AND         */
*  /*    LOOP THROUGH ALL OF THE ENTRIES                             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0722
*  NBLKPTR=CRVNAMCH;              /* POINT AT NAME CHAIN TO          */
@RT00719 MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       0722
*                                 /* SCAN FOR DUPLICATES             */
*  DO WHILE NBLKPTR^=NULLPTR;     /* LOOP THROUGH ALL THE NAMES      */
         B     @DE00723                                            0723
@DL00723 DS    0H                                                  0724
*    /****************************************************************/
*    /*                                                              */
*    /*    LOOP THROUGH ALL CRA'A THAT ARE PREVIOUS TO THE CRA       */
*    /*    BEING CHECKED                                             */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0724
*    DO DUPIX=1 TO DPARM4 WHILE DUPIX<DPARM4;                      0724
         LA    DUPIX,1                                             0724
         B     @DE00724                                            0724
@DL00724 L     @05,@PC00008                                        0724
         C     DUPIX,DPARM4(,@05)                                  0724
         BNL   @DC00724                                            0724
*                                 /* LOOP THROUGH PREVIOUS CRA       */
*                                 /* NAME CHAIN'S                    */
*                                                                  0725
*      /**************************************************************/
*      /*                                                            */
*      /*    POINT AT THE NAME CHAIN AND PROCESS ALL OF THE          */
*      /*    ENTRIES IN THE CHAIN                                    */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0725
*      DUPPTR=ADDR(CRVENTRY(DUPIX))->CRVNAMCH;                     0725
         LR    @05,DUPIX                                           0725
         MH    @05,@CH00954                                        0725
         L     @01,CRVBASE                                         0725
         LA    @05,CRVENTRY-28(@05,@01)                            0725
         L     DUPPTR,CRVNAMCH(,@05)                               0725
*                                 /* POINT AT NAME CHAIN FOR         */
*                                 /* THIS CRV ENTRY                  */
*      DO WHILE DUPPTR^=NULLPTR;  /* LOOP THROUGH THE WHOLE          */
         B     @DE00726                                            0726
@DL00726 DS    0H                                                  0727
*                                 /* NAME CHAIN                      */
*                                                                  0727
*        /************************************************************/
*        /*                                                          */
*        /*    CHECK THE LENGTH TO SEE IF IT IS THE SAME, AND        */
*        /*    THEN CHECK THE ENTRY NAME                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  0727
*        IF DUPPTR->NBLKNAME->DSNAMLEN=NBLKNAME->DSNAMLEN          0727
*                                 /* DO THE LENGTH'S OF THE          */
*                                 /* NAMES MATCH                     */
*          THEN IF DUPPTR->NBLKNAME->DSNAM(1:NBLKNAME->DSNAMLEN)=  0727
         L     @05,NBLKNAME(,DUPPTR)                               0727
         L     @15,NBLKPTR                                         0727
         L     @14,NBLKNAME(,@15)                                  0727
         LH    @07,DSNAMLEN(,@14)                                  0727
         CH    @07,DSNAMLEN(,@05)                                  0727
         BNE   @RF00727                                            0727
*                          NBLKNAME->DSNAM(1:NBLKNAME->DSNAMLEN)   0728
*                                 /* THEN: IF THE NAMES MATCH        */
*            /********************************************************/
*            /*                                                      */
*            /*    IF THE ENTRY NAMES ARE EQUAL, THEN HANDLE THE     */
*            /*    MESSAGES AND SWITCHES FOR THE DUPLICATE NAME      */
*            /*                                                      */
*            /********************************************************/
*                                                                  0728
*            THEN DO;             /* THEN:                           */
         BCTR  @07,0                                               0728
         EX    @07,@SC01400                                        0728
         BNE   @RF00728                                            0728
*              NBLKBE=ON;         /* INDICATE NAME NOT TO BE         */
         OI    NBLKBE(@15),B'01000000'                             0730
*                                 /* EXPORTED                        */
*              CALL MESSAGE (0,MSGID21,CRADDPTR(DPARM4)->CRADDVAL, 0731
*                            LENGTH(CRADDVAL));                    0731
         MVC   @AL00001(16),@AL00731                               0731
         L     @05,@PC00008                                        0731
         L     @05,DPARM4(,@05)                                    0731
         SLA   @05,2                                               0731
         L     @15,@PC00001+4                                      0731
         L     @01,FDTPTR+16(,@15)                                 0731
         AL    @01,@CF01392                                        0731
         L     @05,CRADDPTR(@05,@01)                               0731
         LA    @05,CRADDVAL(,@05)                                  0731
         ST    @05,@AL00001+8                                      0731
         LA    @01,@AL00001                                        0731
         BAL   @14,MESSAGE                                         0731
*                                 /* PRINT DUPLICATE NAME            */
*                                 /* MESSAGE                         */
*              DUPIXL=NBLKNAME->DSNAMLEN;                          0732
         L     @05,NBLKPTR                                         0732
         L     @05,NBLKNAME(,@05)                                  0732
         LH    @15,DSNAMLEN(,@05)                                  0732
         ST    @15,DUPIXL                                          0732
*                                 /* GET THE NAME LENGTH             */
*              CALL MESSAGE (0,MSGID20,NBLKNAME->DSNAM,DUPIXL);    0733
         LA    @15,@CF00116                                        0733
         ST    @15,@AL00001                                        0733
         LA    @15,@CH00885                                        0733
         ST    @15,@AL00001+4                                      0733
         LA    @05,DSNAM(,@05)                                     0733
         ST    @05,@AL00001+8                                      0733
         LA    @05,DUPIXL                                          0733
         ST    @05,@AL00001+12                                     0733
         LA    @01,@AL00001                                        0733
         BAL   @14,MESSAGE                                         0733
*                                 /* PRINT DSNAME                    */
*              END;               /*                                 */
*            ELSE;                /* ELSE: CONTINUE                  */
*                                                                  0735
@RF00728 DS    0H                                                  0736
*          ELSE;                  /* ELSE: CONTINUE                  */
*                                                                  0736
@RF00727 DS    0H                                                  0737
*        DUPPTR=DUPPTR->NBLKCHN;  /* POINT AT NEXT NAME ENTRY        */
         L     DUPPTR,NBLKCHN(,DUPPTR)                             0737
*        END;                     /*                                 */
@DE00726 LTR   DUPPTR,DUPPTR                                       0738
         BNZ   @DL00726                                            0738
*      END;                       /*                                 */
*                                                                  0739
         AL    DUPIX,@CF00220                                      0739
@DE00724 L     @05,@PC00008                                        0739
         C     DUPIX,DPARM4(,@05)                                  0739
         BNH   @DL00724                                            0739
@DC00724 DS    0H                                                  0740
*    NBLKPTR=NBLKCHN;             /* POINT AT THE NEXT NAME          */
         L     @02,NBLKPTR                                         0740
         L     @02,NBLKCHN(,@02)                                   0740
         ST    @02,NBLKPTR                                         0740
*    END;                         /*                                 */
*                                                                  0741
@DE00723 ICM   @02,15,NBLKPTR                                      0741
         BNZ   @DL00723                                            0741
*  END DUPNAMCK;                  /* END OF PROCEDURE                */
@EL00008 DS    0H                                                  0742
@EF00008 DS    0H                                                  0742
@ER00008 LM    @14,@12,@SA00008                                    0742
         BR    @14                                                 0742
@PB00008 DS    0H                                                  0743
*  GEN (EJECT);                                                    0743
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    ERRCK                                                       */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    HANDLE THE COMMON PROCESSING THAT MUST BE DONE AT THE       */
*  /*    COMPLETION OF OPEN'ING A CRA (E.G. ERROR RETURN CODES,      */
*  /*    OR ERROR MESSAGES)                                          */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    NONE                                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0744
*ERRCK: PROCEDURE (EPARM4);                                        0744
*                                                                  0744
         B     @PB00009                                            0744
ERRCK    STM   @14,@01,@SA00009                                    0744
         STM   @03,@12,@SA00009+16                                 0744
         MVC   @PC00009(4),0(@01)                                  0744
*  DCL EPARM4      FIXED(31);     /* INDEX INTO CRV                  */
*                                                                  0745
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0746
*  OLDERID2 = NEWERID2;                                            0746
         L     @15,@PC00001                                        0746
         L     @14,GDTTR2(,@15)                                    0746
         MVC   @TS00001(95),NEWERID2(@14)                          0746
         MVC   OLDERID2(95,@14),@TS00001                           0746
*  NEWID2='RC96';                                                  0747
         MVC   NEWID2(4,@14),@CC01181                              0747
*  IF GDTDBG = NULLPTR                                             0748
*    THEN;                                                         0748
         ICM   @14,15,GDTDBG(@15)                                  0748
         BZ    @RT00748                                            0748
*    ELSE                                                          0750
*      CALL IDCDB010 (GDTTBL,'RC96');                              0750
*                                                                  0750
         L     @15,@PC00001                                        0750
         ST    @15,@AL00001                                        0750
         LA    @14,@CC01181                                        0750
         ST    @14,@AL00001+4                                      0750
         MVI   @AL00001+4,X'80'                                    0750
         L     @15,GDTDBG(,@15)                                    0750
         LA    @01,@AL00001                                        0750
         BALR  @14,@15                                             0750
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE NORMAL RETURN                                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0751
*  IF ERRNO=ERCDNRML              /* IF NO ERROR WAS DETECTED        */
*    THEN ERRNO=LASTCC00;         /* THEN: SET ZERO RETURN CODE      */
@RT00748 LTR   ERRNO,ERRNO                                         0751
         BNZ   @RF00751                                            0751
         SLR   ERRNO,ERRNO                                         0752
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE CLOSING THE CRA IF IT WAS OPENED                   */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0753
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00751                                            0753
@RF00751 DS    0H                                                  0754
*      IF ERRNO=ERCDCNTO  ERRNO=ERCDNSTR                          0754
*                                 /* IF BAD VOLUME OR NO CORE        */
*        THEN;                    /* THEN: CONTINUE                  */
         CH    ERRNO,@CH00043                                      0754
         BE    @RT00754                                            0754
         CH    ERRNO,@CH00954                                      0754
         BE    @RT00754                                            0754
*        ELSE CALL IDCIOCL0 (GDTTBL,IOCSPTR);                      0756
         L     @15,@PC00001                                        0756
         ST    @15,@AL00001                                        0756
         LA    @14,IOCSPTR                                         0756
         ST    @14,@AL00001+4                                      0756
         MVI   @AL00001+4,X'80'                                    0756
         L     @15,GDTCLS(,@15)                                    0756
         LA    @01,@AL00001                                        0756
         BALR  @14,@15                                             0756
*                                 /* ELSE: CLOSE THE DATA SET        */
*                                                                  0757
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE PRINTING THE MESSAGE IF REQUIRED                 */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0757
*      IF ERRNO=ERCDCNTO  ERRNO=ERCDNSTR  ERRNO=ERCDCTNM         0757
*                                 /* IF BAD VOLUME, NO CORE OR       */
*                                 /* WRONG CATALOG NAME              */
*        THEN;                    /* THEN: CONTINUE                  */
@RT00754 CH    ERRNO,@CH00043                                      0757
         BE    @RT00757                                            0757
         CH    ERRNO,@CH00954                                      0757
         BE    @RT00757                                            0757
         CH    ERRNO,@CH00483                                      0757
         BE    @RT00757                                            0757
*        ELSE DO;                 /* ELSE:                           */
*          CRVBADVL=ON;           /* INDICATE A BAD VOLUME           */
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0760
*          CALL MESSAGE(2,MSGID18,VTTVOLSR(EPARM4),LENGTH(VTTVOLSR),
*                       RSNCD,LENGTH(RSNCD));                      0761
         MVC   @AL00001(24),@AL00761                               0761
         L     @15,@PC00009                                        0761
         L     @15,EPARM4(,@15)                                    0761
         MH    @15,@CH00763                                        0761
         L     @01,CRVBASE                                         0761
         L     @01,CRVCRAPL(,@01)                                  0761
         L     @01,ACCVOLTT(,@01)                                  0761
         AL    @01,@CF01391                                        0761
         LA    @15,VTTVOLSR-4(@15,@01)                             0761
         ST    @15,@AL00001+8                                      0761
         LA    @15,RSNCD                                           0761
         ST    @15,@AL00001+16                                     0761
         LA    @01,@AL00001                                        0761
         BAL   @14,MESSAGE                                         0761
*                                 /* PRINT BAD VOLUME MESSAGE        */
*          END;                   /*                                 */
*                                                                  0762
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE THE RETURN CODE                                  */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0763
*      IF ERRNO=ERCDNSTR & RSNCD=RSNCD09                           0763
*                                 /* IF NO STORAGE OR NO UCB         */
*        THEN ERRNO=LASTCC12;     /* THEN: INDICATE BAD ERROR        */
@RT00757 CH    ERRNO,@CH00954                                      0763
         BNE   @RF00763                                            0763
         CLC   RSNCD(2),@CC00932                                   0763
         BNE   @RF00763                                            0763
         LA    ERRNO,12                                            0764
*        ELSE ERRNO=LASTCC08;     /* ELSE: INDICATE CONTINUE         */
         B     @RC00763                                            0765
@RF00763 LA    ERRNO,8                                             0765
*                                 /*       ERROR                     */
*      END;                       /*                                 */
*                                                                  0766
*  END ERRCK;                     /* END OF PROCEDURE                */
@EL00009 DS    0H                                                  0767
@EF00009 DS    0H                                                  0767
@ER00009 LM    @14,@01,@SA00009                                    0767
         LM    @03,@12,@SA00009+16                                 0767
         BR    @14                                                 0767
@PB00009 DS    0H                                                  0768
*  GEN (EJECT);                                                    0768
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    EXITTHE                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    PRINT THE COMPLETION MESSAGE AND EXIT FROM THE MODULE.      */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. LASTCC MUST CONTAIN THE CONDITION CODE.                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0769
*  EXITTHE: PROCEDURE;                                             0769
*                                                                  0769
         B     @PB00010                                            0769
EXITTHE  STM   @14,@12,@SA00010                                    0769
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE CORE MESSAGE                                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0770
*  IF CORE=BAD                    /* IF THE MESSAGE MUST BE          */
*                                 /* PRINTED                         */
*    THEN CALL MESSAGE(0,MSGID54,0,0);                             0770
         CLC   CORE(1),BAD                                         0770
         BNE   @RF00770                                            0770
         LA    @01,@AL00771                                        0771
         BAL   @14,MESSAGE                                         0771
*                                 /* THEN: PRINT IT                  */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  0772
@RF00770 DS    0H                                                  0773
*  /*******************************************************************
*  /*                                                                 *
*  /*    HANDLE THE TERMINATION                                       *
*  /*                                                                 *
*  /*******************************************************************
*                                                                  0773
*  CALL TERM;                      /* EXECUTE TERMINATION ROUTINE     *
*                                                                  0773
         BAL   @14,TERM                                            0773
*  /*******************************************************************
*  /*                                                                 *
*  /*    HANDLE THE SPECIAL RETURN CODE (TERMINAL AND NOT STORAGE)    *
*  /*                                                                 *
*  /*******************************************************************
*                                                                  0774
*  IF LASTCC=LASTCC16              /* IF SPECIAL RETURN CODE          *
*    THEN LASTCC=LASTCC12;         /* THEN: CONVERT TO TERMINAL       *
         L     @15,@PC00001+8                                      0774
         CLC   LASTCC(2,@15),@CH00483                              0774
         BNE   @RF00774                                            0774
         MVC   LASTCC(2,@15),@CH00038                              0775
*    ELSE;                         /* ELSE: CONTINUE                  *
@RF00774 DS    0H                                                  0777
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE COMPLETION MESSAGE                               */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0777
*  IF GDTECT^=NULLPTR &           /* IS THIS THE TSO ENVIORNMENT     */
*     LASTCC^=LASTCC00            /* AND THE RETURN CODE IS NOT ZERO */
*    THEN CALL MESSAGE(0,MSGID65,LASTCC,LENGTH(LASTCC));           0777
         SLR   @15,@15                                             0777
         L     @14,@PC00001                                        0777
         C     @15,GDTECT(,@14)                                    0777
         BE    @RF00777                                            0777
         L     @14,@PC00001+8                                      0777
         CH    @15,LASTCC(,@14)                                    0777
         BE    @RF00777                                            0777
         MVC   @AL00001(16),@AL00778                               0778
         ST    @14,@AL00001+8                                      0778
         LA    @01,@AL00001                                        0778
         BAL   @14,MESSAGE                                         0778
*                                 /* THEN: PRINT SPECIAL TSO MESSAGE */
*                                 /* ------------VS2-------------    */
*    ELSE IF LASTCC=LASTCC12      /* ELSE: IF FUNCTION FAILURE       */
*      THEN CALL MESSAGE(0,MSGID53,LASTCC,LENGTH(LASTCC));         0779
         B     @RC00777                                            0779
@RF00777 L     @15,@PC00001+8                                      0779
         CLC   LASTCC(2,@15),@CH00038                              0779
         BNE   @RF00779                                            0779
         MVC   @AL00001(16),@AL00780                               0780
         ST    @15,@AL00001+8                                      0780
         LA    @01,@AL00001                                        0780
         BAL   @14,MESSAGE                                         0780
*                                 /* THEN: PRINT FAILURE MESSAGE     */
*      ELSE CALL MESSAGE(0,MSGID51,LASTCC,LENGTH(LASTCC));         0781
         B     @RC00779                                            0781
@RF00779 MVC   @AL00001(16),@AL00781                               0781
         L     @15,@PC00001+8                                      0781
         ST    @15,@AL00001+8                                      0781
         LA    @01,@AL00001                                        0781
         BAL   @14,MESSAGE                                         0781
*                                 /* ELSE: PRINT SUCCESS MESSAGE     */
*                                                                  0782
*  /******************************************************************/
*  /*                                                                */
*  /*    EXIT FROM THE MODULE                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0782
*  CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                             0782
@RC00779 DS    0H                                                  0782
@RC00777 L     @15,@PC00001                                        0782
         ST    @15,@AL00001                                        0782
         LA    @14,MODID                                           0782
         ST    @14,@AL00001+4                                      0782
         L     @14,@PC00001+8                                      0782
         ST    @14,@AL00001+8                                      0782
         MVI   @AL00001+8,X'80'                                    0782
         L     @15,GDTEPL(,@15)                                    0782
         LA    @01,@AL00001                                        0782
         BALR  @14,@15                                             0782
*                                 /* EXIT FROM THE MODULE            */
*  END EXITTHE;                   /* END OF PROCEDURE                */
@EL00010 DS    0H                                                  0783
@EF00010 DS    0H                                                  0783
@ER00010 LM    @14,@12,@SA00010                                    0783
         BR    @14                                                 0783
@PB00010 DS    0H                                                  0784
*  GEN (EJECT);                                                    0784
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    EXPORTDR                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    ACTIVATE THE EXPORT MODULE TO CONSTRUCT THE PORT-           */
*  /*    ABILITY DATA SET IN THE CORRECT ORDER AND WITH THE          */
*  /*    THINGS DESIRED (E.G. PASSWORDS AND LRECL)                   */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. ALL PROCESSING NECESSARY TO DECIDE THAT THE ENTRY        */
*  /*       CAN BE EXPORTED MUST BE DONE                             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0785
*EXPORTDR: PROCEDURE (PPARM4);                                     0785
*                                                                  0785
         B     @PB00011                                            0785
EXPORTDR STM   @14,@12,@SA00011                                    0785
         MVC   @PC00011(4),0(@01)                                  0785
*  DCL PPARM4      FIXED(31);     /* INDEX INTO CRV                  */
*  DCL EXPTOTL     FIXED(15) CONSTANT(5);                          0787
*                                 /* NUMBER OF ENTRIES TO DO         */
*  DCL INPTBLA(5)      PTR(31);   /* EXPORT TABLE AREA               */
*  DCL ENTOBJA     CHAR(LENGTH(ENTOBJ)) BDY(WORD);                 0789
*                                 /* ENTRY DATA AREA                 */
*  DCL OUTDATA     CHAR(LENGTH(OUTDAT)) BDY(WORD);                 0790
*                                 /* CONTROL INFO AREA               */
*  DCL EXPTIX1     FIXED(31);     /* LOOP COUNTER TO PROCESSING      */
*  DCL EXPTIX2     FIXED(31);     /* GENERAL COUNTER FOR USE         */
*  DCL DEFBKSZ     FIXED(31) CONSTANT(2048);                       0793
*                                 /* DEFAULT BLOCK SIZE FOR THE      */
*                                 /* EXPORT PROCESS                  */
*  DCL RECSTYPE(EXPTOTL) CHAR(1)  /* RECORD TYPES IN THE ORDER       */
*    INITIAL('C','G','A','B','U');/* THAT NEED PROCESSING            */
*                                                                  0794
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  0795
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0796
*  OLDERID2 = NEWERID2;                                            0796
         L     @14,@PC00001                                        0796
         L     @04,GDTTR2(,@14)                                    0796
         MVC   @TS00001(95),NEWERID2(@04)                          0796
         MVC   OLDERID2(95,@04),@TS00001                           0796
*  NEWID2='RC82';                                                  0797
         MVC   NEWID2(4,@04),@CC01200                              0797
*  IF GDTDBG = NULLPTR                                             0798
*    THEN;                                                         0798
         ICM   @04,15,GDTDBG(@14)                                  0798
         BZ    @RT00798                                            0798
*    ELSE                                                          0800
*      CALL IDCDB010 (GDTTBL,'RC82');                              0800
         L     @14,@PC00001                                        0800
         ST    @14,@AL00001                                        0800
         LA    @04,@CC01200                                        0800
         ST    @04,@AL00001+4                                      0800
         MVI   @AL00001+4,X'80'                                    0800
         L     @15,GDTDBG(,@14)                                    0800
         LA    @01,@AL00001                                        0800
         BALR  @14,@15                                             0800
*  /******************************************************************/
*  /*                                                                */
*  /*    OPEN CRA AS A SIMULATED CATALOG SO THAT EXPORT CAN          */
*  /*    BE DONE                                                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0801
*  CALL OPENCRA(OPENFUNC,PPARM4,CRACAT);                           0801
@RT00798 MVC   @AL00001(12),@AL00801                               0801
         L     @14,@PC00011                                        0801
         ST    @14,@AL00001+4                                      0801
         LA    @01,@AL00001                                        0801
         BAL   @14,OPENCRA                                         0801
*                                 /* OPEN CRA AS CATALOG             */
*                                                                  0802
*  /******************************************************************/
*  /*                                                                */
*  /*    LOOP THROUGH ALL OF THE TYPES THAT ARE TO BE HANDLED        */
*  /*    SO THAT THE ORDER CAN BE MAINTAINED                         */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0802
*  DO EXPTIX1=1 TO EXPTOTL;       /* LOOP TO EXPORT ALL THE          */
         LA    EXPTIX1,1                                           0802
@DL00802 DS    0H                                                  0803
*                                 /* RECORD TYPES HANDLED            */
*                                                                  0803
*    /****************************************************************/
*    /*                                                              */
*    /*    POINT AT THE HEAD OF THE NAME CHAIN AND LOOP THROUGH      */
*    /*    ALL OF THE NAME BLOCKS ON THE CHAIN                       */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0803
*    NBLKPTR=CRVNAMCH;            /* POINT AT THE START OF THE       */
         MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       0803
*                                 /* NAME CHAIN ON THIS CRA          */
*    DO WHILE NBLKPTR^=NULLPTR;   /* LOOP TO THE END OF THE          */
         B     @DE00804                                            0804
@DL00804 DS    0H                                                  0805
*                                 /* NAME CHAIN                      */
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE ALL OF THE NAMES OF THE TYPE BEING PROCESSED     */
*      /*    ON THIS LOOP THROUGH THE NAMES                          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  0805
*      IF NBLKBE=ON  RECSTYPE(EXPTIX1)^=NBLKTYPE                  0805
*                                 /* IF THIS IS A BAD ENTRY          */
*                                 /* OR THE TYPE IS WRONG FOR        */
*                                 /* THIS PASS                       */
*        THEN;                    /* THEN: CONTINUE                  */
         L     @14,NBLKPTR                                         0805
         TM    NBLKBE(@14),B'01000000'                             0805
         BO    @RT00805                                            0805
         LA    @04,RECSTYPE-1(EXPTIX1)                             0805
         CLC   0(1,@04),NBLKTYPE(@14)                              0805
         BNE   @RT00805                                            0805
*        ELSE IF ENTREPTR(PPARM4)^=NULLPTR & NBLKMH=OFF            0807
*                                 /* IF ENTRIES ARE SPECIFIED        */
*                                 /* AND THIS ON  DOSEN'T MATCH      */
*          THEN;                  /* THEN: CONTINUE                  */
         L     @14,@PC00011                                        0807
         L     @14,PPARM4(,@14)                                    0807
         SLA   @14,2                                               0807
         L     @04,@PC00001+4                                      0807
         L     @04,FDTPTR+28(,@04)                                 0807
         AL    @04,@CF01392                                        0807
         L     @14,ENTREPTR(@14,@04)                               0807
         LTR   @14,@14                                             0807
         BZ    @RF00807                                            0807
         L     @14,NBLKPTR                                         0807
         TM    NBLKMH(@14),B'10000000'                             0807
         BZ    @RT00807                                            0807
*          ELSE DO;               /* ELSE:                           */
@RF00807 DS    0H                                                  0810
*            IF NBLKSC=ON & FRC=NULLPTR                            0810
*                                 /* IF DATA SET OUT-OF-SYNCH        */
*                                 /* AND THERE IS NO FORCE           */
*              THEN REG15=LASTCC08;                                0810
         L     @14,NBLKPTR                                         0810
         TM    NBLKSC(@14),B'00100000'                             0810
         BNO   @RF00810                                            0810
         L     @14,@PC00001+4                                      0810
         L     @14,FDTPTR(,@14)                                    0810
         ICM   @04,15,FRC(@14)                                     0810
         BNZ   @RF00810                                            0810
         LA    REG15,8                                             0811
*                                 /* THEN: INDICATE NOT DONE         */
*              ELSE DO;           /* ELSE:                           */
*                                                                  0812
         B     @RC00810                                            0812
@RF00810 DS    0H                                                  0813
*                /****************************************************/
*                /*                                                  */
*                /*    INITIALIZE THE AREAS THE FIRST TIME           */
*                /*    THROUGH THIS CODE                             */
*                /*                                                  */
*                /****************************************************/
*                                                                  0813
*                IF INPPTR=NULLPTR/* IF THIS IS FIRST TIME           */
*                  THEN DO;       /* THEN:                           */
         ICM   @14,15,INPPTR                                       0813
         BNZ   @RF00813                                            0813
*                    ENTOBJA=''B; /* CLEAR ENTRY INFO                */
         XC    ENTOBJA(17),ENTOBJA                                 0815
*                    OUTDATA=''B; /* CLEAR CONTROL INFO              */
         XC    OUTDATA(17),OUTDATA                                 0816
*                    END;         /*                                 */
*                  ELSE;          /* ELSE: CONTINUE                  */
@RF00813 DS    0H                                                  0819
*                /****************************************************/
*                /*                                                  */
*                /*    PREPARE THE PARAMETER LIST FOR EXPORT         */
*                /*    AND GO TO GET IT DONE                         */
*                /*                                                  */
*                /****************************************************/
*                                                                  0819
*                INPPTR=ADDR(INPTBLA);                             0819
         LA    @14,INPTBLA                                         0819
         ST    @14,INPPTR                                          0819
*                                 /* POINT AT EXPORT TABLE           */
*                INPTBL(1)=ADDR(ENTOBJA);                          0820
         LA    @04,ENTOBJA                                         0820
         ST    @04,INPTBL(,@14)                                    0820
*                                 /* POINT AT ENTRY TABLE            */
*                OBJTYP=NBLKTYPE; /* PLACE ENTRY TYPE                */
         L     @07,NBLKPTR                                         0821
         MVC   OBJTYP(1,@04),NBLKTYPE(@07)                         0821
*                OBJVAL=NBLKCI;   /* PLACE CI NUMBER                 */
         MVC   OBJVAL(3,@04),NBLKCI(@07)                           0822
*                OBJPLN=NBLKPWL;  /* PLACE PASSWORD LENGTH           */
         MVC   OBJPLN(1,@04),NBLKPWL(@07)                          0823
*                OBJPAS=NBLKPW;   /* PLACE PASSWORD                  */
         MVC   OBJPAS(8,@04),NBLKPW(@07)                           0824
*                INPTBL(2)=ADDR(OUTDATA);                          0825
         LA    @04,OUTDATA                                         0825
         ST    @04,INPTBL+4(,@14)                                  0825
*                                 /* POINT AT CONTROL INFO           */
*                OUTLEN=CRVMAXLR; /* PLACE MAXIMUM LRECL             */
         L     @01,CRVBASE                                         0826
         MVC   OUTLEN(4,@04),CRVMAXLR(@01)                         0826
*                INPTBL(4)=ADDR(OUTDDVAL);                         0827
         L     @04,@PC00001+4                                      0827
         L     @01,FDTPTR+48(,@04)                                 0827
         LA    @07,OUTDDVAL(,@01)                                  0827
         ST    @07,INPTBL+12(,@14)                                 0827
*                                 /* POINT AT OUTPUT DNAME           */
*                IF ADDR(PDEV)=NULLPTR                             0828
*                                 /* IF THERE IS NO PDEV             */
*                  THEN INPTBL(5)=NULLPTR;                         0828
         SLR   @07,@07                                             0828
         C     @07,FDTPTR+44(,@04)                                 0828
         BNE   @RF00828                                            0828
         ST    @07,INPTBL+16(,@14)                                 0829
*                                 /* THEN: GIVE NULL POINTER         */
*                  ELSE INPTBL(5)=ADDR(PDEVVAL);                   0830
         B     @RC00828                                            0830
@RF00828 L     @14,@PC00001+4                                      0830
         L     @14,FDTPTR+44(,@14)                                 0830
         LA    @14,PDEVVAL(,@14)                                   0830
         L     @04,INPPTR                                          0830
         ST    @14,INPTBL+16(,@04)                                 0830
*                                 /* ELSE: POINT AT THE              */
*                                 /*       ENVIORNMENT DATA          */
*                ACCTRANT=CRVADCTT;                                0831
@RC00828 L     @14,CRVBASE                                         0831
         L     @14,CRVCRAPL(,@14)                                  0831
         MVC   ACCTRANT(4,@14),CRVADCTT(CRVEBASE)                  0831
*                                 /* POINT AT TRANSLATE TABLE        */
*                ACCDSNCI=NBLKCI; /* PLACE THE CI NUMBER             */
         L     @04,NBLKPTR                                         0832
         MVC   ACCDSNCI(3,@14),NBLKCI(@04)                         0832
*                IF NBLKMT=ON     /* IF DATA SET EMPTY               */
*                  THEN EMPTYDS=ON;                                0833
         TM    NBLKMT(@04),B'00010000'                             0833
         BNO   @RF00833                                            0833
         L     @14,INPPTR                                          0834
         L     @14,INPTBL+4(,@14)                                  0834
         OI    EMPTYDS(@14),B'00100000'                            0834
*                                 /* THEN: INDICATE EMPTY D.S.       */
*                  ELSE EMPTYDS=OFF;                               0835
         B     @RC00833                                            0835
@RF00833 L     @14,INPPTR                                          0835
         L     @14,INPTBL+4(,@14)                                  0835
         NI    EMPTYDS(@14),B'11011111'                            0835
*                                 /* ELSE: INDICATE D.S. NOT         */
*                                 /*       EMPTY                     */
*                IF ADDR(BLKSZ)=NULLPTR                            0836
*                                 /* IF NO BLOCK SIZE SPECIFIED      */
*                  THEN USBKSZ=DEFBKSZ;                            0836
@RC00833 L     @14,@PC00001+4                                      0836
         ICM   @04,15,FDTPTR+60(@14)                               0836
         BNZ   @RF00836                                            0836
         L     @14,INPPTR                                          0837
         L     @14,INPTBL+4(,@14)                                  0837
         MVC   USBKSZ(4,@14),@CF01198                              0837
*                                 /* THEN: SET DEFAULT BLOCK         */
*                                 /*       SIZE                      */
*                  ELSE USBKSZ=BLKSZVAL;                           0838
         B     @RC00836                                            0838
@RF00836 L     @14,INPPTR                                          0838
         L     @14,INPTBL+4(,@14)                                  0838
         L     @04,@PC00001+4                                      0838
         L     @04,FDTPTR+60(,@04)                                 0838
         MVC   USBKSZ(4,@14),BLKSZVAL(@04)                         0838
*                                 /* ELSE: PASS USER VALUE           */
*                /****************************************************/
*                /*                                                  */
*                /*    HANDLE THE SELECTION OF THE DNAME TO          */
*                /*    PASS TO THE EXPORT MODULE                     */
*                /*                                                  */
*                /****************************************************/
*                                                                  0839
*                INPTBL(3)=ADDR(CRADDPTR(PPARM4)->CRADDVAL);       0839
@RC00836 L     @14,@PC00011                                        0839
         L     @14,PPARM4(,@14)                                    0839
         SLA   @14,2                                               0839
         L     @04,@PC00001+4                                      0839
         L     @01,FDTPTR+16(,@04)                                 0839
         AL    @01,@CF01392                                        0839
         L     @01,CRADDPTR(@14,@01)                               0839
         LA    @07,CRADDVAL(,@01)                                  0839
         L     @06,INPPTR                                          0839
         ST    @07,INPTBL+8(,@06)                                  0839
*                                 /* DEFAULT THE DNAME TO CRADD      */
*                IF ALLNTPTR(PPARM4)^=NULLPTR                      0840
*                                 /* IF ALL IS SPECIFIED             */
*                  THEN IF IFILEPTR(PPARM4)=NULLPTR                0840
         SLR   @07,@07                                             0840
         L     @01,FDTPTR+20(,@04)                                 0840
         AL    @01,@CF01392                                        0840
         C     @07,ALLNTPTR(@14,@01)                               0840
         BE    @RF00840                                            0840
*                                 /* THEN: IF AN INFILE IS           */
*                                 /*       SPECIFIED                 */
*                    THEN;        /* THEN: CONTINUE                  */
         L     @04,FDTPTR+32(,@04)                                 0841
         AL    @04,@CF01392                                        0841
         C     @07,IFILEPTR(@14,@04)                               0841
         BE    @RT00841                                            0841
*                    ELSE INPTBL(3)=ADDR(IFILEPTR(PPARM4)->IFILEVAL);
         L     @14,@PC00011                                        0843
         L     @14,PPARM4(,@14)                                    0843
         SLA   @14,2                                               0843
         L     @04,@PC00001+4                                      0843
         L     @04,FDTPTR+32(,@04)                                 0843
         AL    @04,@CF01392                                        0843
         L     @14,IFILEPTR(@14,@04)                               0843
         LA    @14,IFILEVAL(,@14)                                  0843
         L     @04,INPPTR                                          0843
         ST    @14,INPTBL+8(,@04)                                  0843
*                                 /* ELSE: SUPPLY INFILE NAME        */
*                  ELSE;          /* ELSE: CONTINUE                  */
@RF00840 DS    0H                                                  0845
*                IF ENTREPTR(PPARM4)^=NULLPTR                      0845
*                                 /* IF ENTRIES IS SPECIFIED         */
*                  THEN IF ENTDNPTR(PPARM4,NBLKENTN)=NULLPTR       0845
@RC00840 SLR   @14,@14                                             0845
         L     @04,@PC00011                                        0845
         L     @04,PPARM4(,@04)                                    0845
         LR    @07,@04                                             0845
         SLA   @07,2                                               0845
         L     @06,@PC00001+4                                      0845
         L     @01,FDTPTR+28(,@06)                                 0845
         AL    @01,@CF01392                                        0845
         C     @14,ENTREPTR(@07,@01)                               0845
         BE    @RF00845                                            0845
*                                 /* THEN: IF THERE IS NO DNAME      */
*                    THEN;        /* THEN: CONTINUE                  */
         MH    @04,@CH00762                                        0846
         L     @01,NBLKPTR                                         0846
         AH    @04,NBLKENTN(,@01)                                  0846
         SLA   @04,2                                               0846
         L     @01,FDTPTR+56(,@06)                                 0846
         AL    @01,@CF01394                                        0846
         C     @14,ENTDNPTR(@04,@01)                               0846
         BE    @RT00846                                            0846
*                    ELSE INPTBL(3)=ADDR(ENTDNPTR(PPARM4,NBLKENTN)->
*                                   ENTDNVAL);                     0848
         L     @14,@PC00011                                        0848
         L     @14,PPARM4(,@14)                                    0848
         MH    @14,@CH00762                                        0848
         L     @04,NBLKPTR                                         0848
         AH    @14,NBLKENTN(,@04)                                  0848
         SLA   @14,2                                               0848
         L     @04,@PC00001+4                                      0848
         L     @04,FDTPTR+56(,@04)                                 0848
         AL    @04,@CF01394                                        0848
         L     @14,ENTDNPTR(@14,@04)                               0848
         LA    @14,ENTDNVAL(,@14)                                  0848
         L     @04,INPPTR                                          0848
         ST    @14,INPTBL+8(,@04)                                  0848
*                  ELSE;          /* ELSE: CONTINUE                  */
*                                                                  0849
@RF00845 DS    0H                                                  0850
*                /****************************************************/
*                /*                                                  */
*                /*    CALL THE EXPORT MODULE TO MAKE THE            */
*                /*    OBJECT PORTABLE                               */
*                /*                                                  */
*                /****************************************************/
*                                                                  0850
*                CALL IDCRC02 (GDTTBL,INPPTR);                     0850
@RC00845 L     @14,@PC00001                                        0850
         ST    @14,@AL00001                                        0850
         LA    @14,INPPTR                                          0850
         ST    @14,@AL00001+4                                      0850
         L     @15,@CV00913                                        0850
         LA    @01,@AL00001                                        0850
         BALR  @14,@15                                             0850
*                                 /* GO TO EXPORT THIS ENTRY         */
*                END;             /*                                 */
*            /********************************************************/
*            /*                                                      */
*            /*    HANDLE PRINTING THE MESSAGE AFTER EXPORT          */
*            /*                                                      */
*            /********************************************************/
*                                                                  0852
*            IF REG15=LASTCC00    /* IF NO ERRORS                    */
*              THEN DO;           /* THEN:                           */
@RC00810 LTR   REG15,REG15                                         0852
         BNZ   @RF00852                                            0852
*                IF NBLKSC=ON     /* IF OUT-OF-SYNCH                 */
*                  THEN CALL MESSAGE(0,MSGID6,0,0);                0854
         L     @14,NBLKPTR                                         0854
         TM    NBLKSC(@14),B'00100000'                             0854
         BNO   @RF00854                                            0854
         LA    @01,@AL00855                                        0855
         BAL   @14,MESSAGE                                         0855
*                                 /* THEN: PRINT O-F-S EXPORTED      */
*                  ELSE CALL MESSAGE(0,MSGID15,0,0);               0856
         B     @RC00854                                            0856
@RF00854 LA    @01,@AL00856                                        0856
         BAL   @14,MESSAGE                                         0856
*                                 /* ELSE: PRINT EXPORTED            */
*                END;             /*                                 */
*              ELSE IF REG15=LASTCC04                              0858
*                                 /* ELSE: IF THE WAS A MINOR        */
*                                 /*       ERROR                     */
*                THEN DO;         /* THEN:                           */
         B     @RC00852                                            0858
@RF00852 LA    @14,4                                               0858
         CR    REG15,@14                                           0858
         BNE   @RF00858                                            0858
*                  IF LASTCC<LASTCC04                              0860
*                                 /* IF THIS IS A NEW HIGH           */
*                    THEN LASTCC=LASTCC04;                         0860
         L     @04,@PC00001+8                                      0860
         CH    @14,LASTCC(,@04)                                    0860
         BNH   @RF00860                                            0860
         STH   @14,LASTCC(,@04)                                    0861
*                                 /* THEN: SAVE THE NEW VALUE        */
*                    ELSE;        /* ELSE: CONTINUE                  */
@RF00860 DS    0H                                                  0863
*                  IF NBLKSC=ON   /* THEN: IF OUT-OF-SYNCH           */
*                    THEN CALL MESSAGE(0,MSGID3,0,0);              0863
         L     @14,NBLKPTR                                         0863
         TM    NBLKSC(@14),B'00100000'                             0863
         BNO   @RF00863                                            0863
         LA    @01,@AL00864                                        0864
         BAL   @14,MESSAGE                                         0864
*                                 /* THEN: PRINT O-O-S WITH          */
*                                 /*       MINOR ERRORS              */
*                    ELSE CALL MESSAGE(0,MSGID2,0,0);              0865
         B     @RC00863                                            0865
@RF00863 LA    @01,@AL00865                                        0865
         BAL   @14,MESSAGE                                         0865
*                                 /* THEN: PRINT WITH MINOR          */
*                                 /*       ERRORS                    */
*                  END;           /*                                 */
*                ELSE IF REG15=LASTCC08                            0867
*                                 /* ELSE: IF DATA SET NOT           */
*                                 /*       EXPORTED                  */
*                  THEN DO;       /* THEN:                           */
         B     @RC00858                                            0867
@RF00858 LA    @14,8                                               0867
         CR    REG15,@14                                           0867
         BNE   @RF00867                                            0867
*                    IF LASTCC<LASTCC08                            0869
*                                 /* IF THIS IS A NEW HIGH           */
*                      THEN LASTCC=LASTCC08;                       0869
         L     @04,@PC00001+8                                      0869
         CH    @14,LASTCC(,@04)                                    0869
         BNH   @RF00869                                            0869
         STH   @14,LASTCC(,@04)                                    0870
*                                 /* THEN: SAVE NEW VALUE            */
*                      ELSE;      /* ELSE: CONTINUE                  */
@RF00869 DS    0H                                                  0872
*                    IF NBLKSC=ON /* IF OUT-OF-SYNCH                 */
*                      THEN CALL MESSAGE(0,MSGID7,0,0);            0872
         L     @14,NBLKPTR                                         0872
         TM    NBLKSC(@14),B'00100000'                             0872
         BNO   @RF00872                                            0872
         LA    @01,@AL00873                                        0873
         BAL   @14,MESSAGE                                         0873
*                                 /* THEN: PRINT O-O-S NOT           */
*                                 /*       EXPORTED                  */
*                      ELSE CALL MESSAGE(0,MSGID1,0,0);            0874
         B     @RC00872                                            0874
@RF00872 LA    @01,@AL00874                                        0874
         BAL   @14,MESSAGE                                         0874
*                                 /* ELSE: PRINT NOT EXPORTED        */
*                    END;         /*                                 */
*                  /**************************************************/
*                  /*                                                */
*                  /*    HANDLE THE TERMINAL ERRORS FROM EXPORT      */
*                  /*                                                */
*                  /**************************************************/
*                                                                  0876
*                  ELSE DO;       /* ELSE:                           */
         B     @RC00867                                            0876
@RF00867 DS    0H                                                  0877
*                    IF REG15=LASTCC12                             0877
*                                 /* IF THIS ERROR REQUIRES NAME     */
*                      THEN DO;   /* THEN:                           */
         CH    REG15,@CH00038                                      0877
         BNE   @RF00877                                            0877
*                        EXPTIX2=NBLKNAME->DSNAMLEN;               0879
         L     @14,NBLKPTR                                         0879
         L     @14,NBLKNAME(,@14)                                  0879
         LH    @04,DSNAMLEN(,@14)                                  0879
         ST    @04,EXPTIX2                                         0879
*                                 /* PICK UP THE LENGTH              */
*                        CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,   0880
*                                     EXPTIX2);                    0880
         LA    @04,@CF00116                                        0880
         ST    @04,@AL00001                                        0880
         LA    @04,@CH00885                                        0880
         ST    @04,@AL00001+4                                      0880
         LA    @14,DSNAM(,@14)                                     0880
         ST    @14,@AL00001+8                                      0880
         LA    @14,EXPTIX2                                         0880
         ST    @14,@AL00001+12                                     0880
         LA    @01,@AL00001                                        0880
         BAL   @14,MESSAGE                                         0880
*                                 /* PRINT THE ENTRY NAME            */
*                        END;     /*                                 */
*                      ELSE;                                       0882
@RF00877 DS    0H                                                  0883
*                    CALL OPENCRA(CLOSFUNC,PPARM4);                0883
         LA    @14,@CC00855                                        0883
         ST    @14,@AL00001                                        0883
         L     @14,@PC00011                                        0883
         ST    @14,@AL00001+4                                      0883
         LA    @01,@AL00001                                        0883
         BAL   @14,OPENCRA                                         0883
*                                 /* CLOSE THE CRA                   */
*                    RETURN CODE(LASTCC16);                        0884
         LA    @15,16                                              0884
         L     @14,@SA00011                                        0884
         LM    @00,@12,@SA00011+8                                  0884
         BR    @14                                                 0884
*                                 /* RETURN WITH ERROR               */
*                    END;         /*                                 */
*            /********************************************************/
*            /*                                                      */
*            /*    HANDLE THE MESSAGES THAT RELATE REGARDLESS        */
*            /*    OF THE RETURN CODE                                */
*            /*                                                      */
*            /********************************************************/
*                                                                  0886
*            EXPTIX2=NBLKNAME->DSNAMLEN;                           0886
@RC00867 DS    0H                                                  0886
@RC00858 DS    0H                                                  0886
@RC00852 L     @14,NBLKPTR                                         0886
         L     @14,NBLKNAME(,@14)                                  0886
         LH    @04,DSNAMLEN(,@14)                                  0886
         ST    @04,EXPTIX2                                         0886
*                                 /* FORMAT LENGTH OF NAME           */
*            CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,EXPTIX2);      0887
         LA    @04,@CF00116                                        0887
         ST    @04,@AL00001                                        0887
         LA    @04,@CH00885                                        0887
         ST    @04,@AL00001+4                                      0887
         LA    @14,DSNAM(,@14)                                     0887
         ST    @14,@AL00001+8                                      0887
         LA    @14,EXPTIX2                                         0887
         ST    @14,@AL00001+12                                     0887
         LA    @01,@AL00001                                        0887
         BAL   @14,MESSAGE                                         0887
*                                 /* PRINT THE DSNAME                */
*            IF NBLKMT=ON         /* IF DATA SET EMPTY               */
*              THEN CALL MESSAGE(0,MSGID23,0,0);                   0888
         L     @14,NBLKPTR                                         0888
         TM    NBLKMT(@14),B'00010000'                             0888
         BNO   @RF00888                                            0888
         LA    @01,@AL00889                                        0889
         BAL   @14,MESSAGE                                         0889
*                                 /* THEN: PRINT MESSAGE             */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF00888 DS    0H                                                  0891
*            END;                 /*                                 */
*      NBLKPTR=NBLKCHN;           /* POINT AT THE NEXT BLOCK         */
@RT00807 DS    0H                                                  0892
@RT00805 L     @14,NBLKPTR                                         0892
         L     @14,NBLKCHN(,@14)                                   0892
         ST    @14,NBLKPTR                                         0892
*      END;                       /*                                 */
@DE00804 ICM   @14,15,NBLKPTR                                      0893
         BNZ   @DL00804                                            0893
*    END;                         /*                                 */
*                                                                  0894
         AL    EXPTIX1,@CF00220                                    0894
         CH    EXPTIX1,@CH00287                                    0894
         BNH   @DL00802                                            0894
*  /******************************************************************/
*  /*                                                                */
*  /*    CLOSE THE CRA AS A CATALOG AND HANDLE THE RETURN CODE       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0895
*  CALL OPENCRA(CLOSFUNC,PPARM4); /* CLOSE THE CRA AS CATALOG        */
*                                                                  0895
         LA    @14,@CC00855                                        0895
         ST    @14,@AL00001                                        0895
         L     @14,@PC00011                                        0895
         ST    @14,@AL00001+4                                      0895
         LA    @01,@AL00001                                        0895
         BAL   @14,OPENCRA                                         0895
*  RETURN CODE(LASTCC00);         /* RETURN TO CALLER                */
*                                                                  0896
         SLR   @15,@15                                             0896
         L     @14,@SA00011                                        0896
         LM    @00,@12,@SA00011+8                                  0896
         BR    @14                                                 0896
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  0897
*  END EXPORTDR;                  /* END OF PROCEDURE                */
@PB00011 DS    0H                                                  0899
*  GEN (EJECT);                                                    0899
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    EXTRACT                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS ROUTINE PROVIDES THE INTERFACE WITH AMS'S FIELD        */
*  /*    MANAGEMENT ROUTINES (IDCRC04) TO GET INFORMATION FROM       */
*  /*    THE CATALOG RECORDS                                         */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. IDCRC03 IS REQUIRED TO DO THE NECESSARY I/O FOR THE      */
*  /*       RECORDS IN THE CRA                                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0900
*EXTRACT: PROCEDURE(FLDNO,FLD0,FLDI1,FLDI2,FLD01,FLD02,FLD1,       0900
*                   FLD1A,FLD2,FLD3,FLD3A,FLD4,FLD5);              0900
*                                                                  0900
         B     @PB00012                                            0900
EXTRACT  STM   @14,@12,@SA00012                                    0900
         MVC   @PC00012(52),0(@01)                                 0900
*  /******************************************************************/
*  /*                                                                */
*  /*    THIS IS A DESCRIPTION OF THE PARAMETERS                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0901
*  DCL FLDNO    PTR(31);          /* NUMBER OF TESTS PRESENT         */
*  DCL FLD0     PTR(24);          /* BEGINING CI NUMBER              */
*  DCL FLDI1    PTR(31);          /* ADDRESS OF AREA TO USE          */
*  DCL FLDI2    FIXED(31);        /* LENGTH OF AREA TO USE           */
*  DCL FLD01    PTR(31);          /* ADDRESS OF THE DATA             */
*  DCL FLD02    PTR(31);          /* LENGTH OF STRING OF DATA        */
*  DCL FLD1     CHAR(8);          /* FUNCTION DESIRED                */
*  DCL FLD1A    BIT(8);           /* BASE GROUP CODE                 */
*  DCL FLD2     CHAR(8);          /* TEST FUNCTION 1 DESIRED         */
*  DCL FLD3     FIXED(8);         /* TEST CONDITION 1                */
*  DCL FLD3A    BIT(8);           /* TEST GROUP CODE                 */
*  DCL FLD4     PTR(31);          /* ADDRESS OF TEST DATA            */
*  DCL FLD5     FIXED(31);        /* LENGTH OF TEST DATA             */
*  /******************************************************************/
*  /*                                                                */
*  /*    THESE ARE THE FMPL, FMFL'S AND WORK AREAS                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0914
*  DCL FMPLAR   CHAR(LENGTH(FMPL)+LENGTH(FMPLFMFL));               0914
*                                 /* AREA FOR THE FMPL               */
*  DCL 1 FMFLAR1     BDY(WORD),   /* AREA FOR FIRST FMFL             */
*        2 *         CHAR(LENGTH(FMFL)),                           0915
*        2 *         CHAR(LENGTH(FMFLDATA));                       0915
*                                                                  0915
*  DCL 1 FMFLAR2     BDY(WORD),   /* AREA FOR SECOND FMFL            */
*        2 *         CHAR(LENGTH(FMFL)),                           0916
*        2 *         CHAR(LENGTH(FMFLDATA));                       0916
*                                                                  0916
*  DCL OARA     CHAR(256) BDY(WORD);                               0917
*                                 /* OUTPUT AREA                     */
*  DCL WKA256   CHAR(256) BDY(WORD);                               0918
*                                 /* FIELD MANAGEMENT WORK AREA      */
*  DCL FMFLCUR  PTR(31);          /* BASE FOR FMFL STRUCTERS         */
*  DCL FMPLAD   PTR(31);          /* BASE FOR FMPL STRUCTERS         */
*                                                                  0920
*  /******************************************************************/
*  /*                                                                */
*  /*    EXTERNAL ROUTINES NEEDED TO DO FIELD MANAGEMENT             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0921
*  DCL IDCRC03  EXTERNAL ENTRY;   /* I/O ROUTINE TO GET RECORDS      */
*  DCL IDCRC04  EXTERNAL ENTRY;   /* FIELD MANAGEMENT ROUTINES       */
*                                                                  0922
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0923
*  OLDERID2 = NEWERID2;                                            0923
         L     @04,@PC00001                                        0923
         L     @02,GDTTR2(,@04)                                    0923
         MVC   @TS00001(95),NEWERID2(@02)                          0923
         MVC   OLDERID2(95,@02),@TS00001                           0923
*  NEWID2='RC90';                                                  0924
         MVC   NEWID2(4,@02),@CC01243                              0924
*  IF GDTDBG = NULLPTR                                             0925
*    THEN;                                                         0925
         ICM   @02,15,GDTDBG(@04)                                  0925
         BZ    @RT00925                                            0925
*    ELSE                                                          0927
*      CALL IDCDB010 (GDTTBL,'RC90');                              0927
         L     @04,@PC00001                                        0927
         ST    @04,@AL00001                                        0927
         LA    @02,@CC01243                                        0927
         ST    @02,@AL00001+4                                      0927
         MVI   @AL00001+4,X'80'                                    0927
         L     @15,GDTDBG(,@04)                                    0927
         LA    @01,@AL00001                                        0927
         BALR  @14,@15                                             0927
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE FMPL                                         */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0928
*  FMPLAD=ADDR(FMPLAR);           /* POINT AT FMPL                   */
@RT00925 LA    FMPLAD,FMPLAR                                       0928
*  FMPLFLNO=1;                    /* INITIALIZE NUMBER OF FMFLS      */
         MVI   FMPLFLNO(FMPLAD),X'01'                              0929
*  FMPLBCIN=FLD0;                 /* PLACE THE CI NUMBER             */
         L     @02,@PC00012+4                                      0930
         MVC   FMPLBCIN(3,FMPLAD),FLD0(@02)                        0930
*  FMPLGRTN=ADDR(IDCRC03);        /* POINT AT I/O ROUTINE            */
         L     @02,@CV01241                                        0931
         ST    @02,FMPLGRTN(,FMPLAD)                               0931
*  FMPLWKAR=ADDR(WKA256);         /* POINT AT THE WORK AREA          */
         LA    @02,WKA256                                          0932
         ST    @02,FMPLWKAR(,FMPLAD)                               0932
*  FMPLUPTR=ADDR(BUFS);           /* PASS THE BUFFER POOL            */
         ST    BUFSPTR,FMPLUPTR(,FMPLAD)                           0933
*  FMPLFMFL(1)=ADDR(FMFLAR1);     /* POINT AT THE FMFL TO USE        */
         LA    @02,FMFLAR1                                         0934
         ST    @02,FMPLFMFL(,FMPLAD)                               0934
*  IF FLDI1=NULLPTR               /* IF THERE IS NONE SUPPLIED       */
*    THEN DO;                     /* THEN:                           */
         L     @02,@PC00012+8                                      0935
         ICM   @15,15,FLDI1(@02)                                   0935
         BNZ   @RF00935                                            0935
*      FMPLENTH=LENGTH(OARA);     /* PLACE OUTPUT AREA LENGTH        */
         MVC   FMPLENTH(2,FMPLAD),@CH01239                         0937
*      FMPLOAR=ADDR(OARA);        /* POINT AT THE OUTPUT AREA        */
         LA    @02,OARA                                            0938
         ST    @02,FMPLOAR(,FMPLAD)                                0938
*      END;                       /*                                 */
*    ELSE DO;                     /* ELSE:                           */
         B     @RC00935                                            0940
@RF00935 DS    0H                                                  0941
*      FMPLOAR=FLDI1;             /* PLACE AREA ADDRESS              */
         L     @02,@PC00012+8                                      0941
         MVC   FMPLOAR(4,FMPLAD),FLDI1(@02)                        0941
*      FMPLENTH=FLDI2;            /* PLACE AREA LENGTH               */
         L     @02,@PC00012+12                                     0942
         MVC   FMPLENTH(2,FMPLAD),FLDI2+2(@02)                     0942
*      END;                       /*                                 */
*                                                                  0943
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP INFORMATION FOR IDCRC03                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0944
*  BUFIOCS=CRVIOSTR;              /* POINT AT THE IOCSTR FOR         */
@RC00935 MVC   BUFIOCS(4,BUFSPTR),CRVIOSTR(CRVEBASE)               0944
*                                 /* THIS REQUEST                    */
*  BUFCTT=CRVADCTT;               /* POINT AT THE TRANSLATE          */
         MVC   BUFCTT(4,BUFSPTR),CRVADCTT(CRVEBASE)                0945
*                                 /* TABLE FOR THIS REQUEST          */
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE BASE FMFL                                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0946
*  FMFLCUR=ADDR(FMFLAR1);         /* POINT AT FIRST FMFL             */
         LA    FMFLCUR,FMFLAR1                                     0946
*  FMFLDLNO=0;                    /* ZERO THE NUMBER OF FIELDS       */
         MVI   FMFLDLNO(FMFLCUR),X'00'                             0947
*  FMFLTSTC=0;                    /* ZERO THE TEST CONDITION         */
         MVI   FMFLTSTC(FMFLCUR),X'00'                             0948
*  FMFLGRPC=FLD1A;                /* ZERO THE GROUP CODE             */
         L     @15,@PC00012+28                                     0949
         MVC   FMFLGRPC(1,FMFLCUR),FLD1A(@15)                      0949
*  FMFLINDS=0;                    /* ZERO THE INDICATORS             */
         MVI   FMFLINDS(FMFLCUR),X'00'                             0950
*  FMFLDNAM=ADDR(FLD1);           /* POINT AT THE FIELD NAME         */
         L     @15,@PC00012+24                                     0951
         ST    @15,FMFLDNAM(,FMFLCUR)                              0951
*  FMFLTCHN=NULLPTR;              /* INDICATE NO TEST FMFL           */
         SLR   @15,@15                                             0952
         ST    @15,FMFLTCHN(,FMFLCUR)                              0952
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE A TEST FMFL IF IT IS NECESSARY                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0953
*  IF FLDNO=0                     /* IF THERE IS NO TEST FMFL        */
*    THEN;                        /* THEN: CONTINUE                  */
         L     @14,@PC00012                                        0953
         C     @15,FLDNO(,@14)                                     0953
         BE    @RT00953                                            0953
*    ELSE DO;                     /* ELSE:                           */
*      FMFLTCHN=ADDR(FMFLAR2);    /* ADD FMFL TO TEST CHAIN          */
         LA    @15,FMFLAR2                                         0956
         ST    @15,FMFLTCHN(,FMFLCUR)                              0956
*      FMFLCUR=ADDR(FMFLAR2);     /* SET BASE TO TEST FMFL           */
         LR    FMFLCUR,@15                                         0957
*      FMFLDLNO=1;                /* SET NUMBER OF FIELDS            */
         MVI   FMFLDLNO(FMFLCUR),X'01'                             0958
*      FMFLTSTC=FLD3;             /* PLACE TEST CONDITION            */
         L     @15,@PC00012+36                                     0959
         MVC   FMFLTSTC(1,FMFLCUR),FLD3(@15)                       0959
*      FMFLGRPC=FLD3A;            /* ZERO THE GROUP CODE             */
         L     @15,@PC00012+40                                     0960
         MVC   FMFLGRPC(1,FMFLCUR),FLD3A(@15)                      0960
*      FMFLINDS=0;                /* ZERO THE INDICATORS             */
         MVI   FMFLINDS(FMFLCUR),X'00'                             0961
*      FMFLDNAM=ADDR(FLD2);       /* POINT AT FIELD NAME             */
         L     @15,@PC00012+32                                     0962
         ST    @15,FMFLDNAM(,FMFLCUR)                              0962
*      FMFLTCHN=NULLPTR;          /* INDICATE END OF CHAIN           */
         SLR   @15,@15                                             0963
         ST    @15,FMFLTCHN(,FMFLCUR)                              0963
*      FMFLENTH(1)=FLD5;          /* PLACE LENGTH OF DATA            */
         L     @15,@PC00012+48                                     0964
         MVC   FMFLENTH(4,FMFLCUR),FLD5(@15)                       0964
*      FMFLADDR(1)=FLD4;          /* POINT AT THE DATA               */
         L     @15,@PC00012+44                                     0965
         MVC   FMFLADDR(4,FMFLCUR),FLD4(@15)                       0965
*      END;                       /*                                 */
*                                                                  0966
*  /******************************************************************/
*  /*                                                                */
*  /*    GO TO FIELD MANAGEMENT TO GET THE DATA                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0967
*  RFY REG1 RSTD;                 /* RESTRICT THE REGISTER           */
@RT00953 DS    0H                                                  0968
*  REG1=ADDR(FMPLAR);             /* POINT AT THE FMPL               */
         LA    REG1,FMPLAR                                         0968
*  CALL IDCRC04;                  /* GO TO FIELD MANAGEMENT          */
         L     @15,@CV01242                                        0969
         BALR  @14,@15                                             0969
*  RFY REG1 UNRSTD;               /* RELEASE THE REGISTER            */
*                                                                  0970
*  /******************************************************************/
*  /*                                                                */
*  /*    RETURN THE INFORMATION TO THE CALLER                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0971
*  FMFLCUR=ADDR(FMFLAR1);         /* POINT AT THE FMFL               */
         LA    FMFLCUR,FMFLAR1                                     0971
*  FLD02=FMFLENTH(1);             /* RETURN THE DATA LENGTH          */
         L     @15,@PC00012+20                                     0972
         MVC   FLD02(4,@15),FMFLENTH(FMFLCUR)                      0972
*  FLD01=FMFLADDR(1);             /* RETURN THE DATA ADDRESS         */
*                                                                  0973
         L     @15,@PC00012+16                                     0973
         MVC   FLD01(4,@15),FMFLADDR(FMFLCUR)                      0973
*  RETURN CODE(FMPLRTCD);         /* RETURN ERROR CODE IF ANY        */
*                                                                  0974
         SLR   @15,@15                                             0974
         IC    @15,FMPLRTCD(,FMPLAD)                               0974
         L     @14,@SA00012                                        0974
         LM    @00,@12,@SA00012+8                                  0974
         BR    @14                                                 0974
*  END EXTRACT;                   /* END OF PROCEDURE                */
@PB00012 DS    0H                                                  0976
*  GEN (EJECT);                                                    0976
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    INIT                                                        */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS ROUTINE PROVIDES THE FOLLOWING FUNCTIONS               */
*  /*                                                                */
*  /*    1. INITIALIZES THE RETURN CODE.                             */
*  /*                                                                */
*  /*    2. INITIALIZES THE 'SUBSP' PROCEDURE SO IT CAN HANDLE       */
*  /*       THE SUBALLOCATION OF SPACE.                              */
*  /*                                                                */
*  /*    3. INITIALIZES THE DATA IN THE FMPL THAT HAS TO DO          */
*  /*       WITH THE BUFFER POOL AND WORK AREA USED BY IDCRC03       */
*  /*       TO HANDLE FIELD MANAGEMENT REQUESTS.                     */
*  /*                                                                */
*  /*    4. ENQUEUE ON THE PROGRAM NAME TO ENSURE THAT THERE         */
*  /*       IS ONLY ONE COPY IN THE SYSTEM ACTIVE AT ONE TIME.       */
*  /*                                                                */
*  /*    5. INITIALIZE POINTER TO PARAMETER LIST OF IDCRC02.         */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0977
*INIT: PROCEDURE;                                                  0977
*                                                                  0977
         B     @PB00013                                            0977
INIT     STM   @14,@01,@SA00013                                    0977
         STM   @03,@04,@SA00013+16                                 0977
         STM   @06,@12,@SA00013+24                                 0977
*  /******************************************************************/
*  /*                                                                */
*  /*    DECLARATIONS TO INITIALIZE THE BUFFER POOL TO USE           */
*  /*    THE FIELD MANAGEMENT ROUTINES                               */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0978
*  DCL BUFSAR        CHAR(LENGTH(BUFS))   BDY(WORD);               0978
*  DCL BUFWKAR1      CHAR(256) BDY(WORD);                          0979
*                                                                  0979
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0980
*  OLDERID2 = NEWERID2;                                            0980
         L     @15,@PC00001                                        0980
         L     @14,GDTTR2(,@15)                                    0980
         MVC   @TS00001(95),NEWERID2(@14)                          0980
         MVC   OLDERID2(95,@14),@TS00001                           0980
*  NEWID2='RC80';                                                  0981
         MVC   NEWID2(4,@14),@CC01249                              0981
*  IF GDTDBG = NULLPTR                                             0982
*    THEN;                                                         0982
         ICM   @14,15,GDTDBG(@15)                                  0982
         BZ    @RT00982                                            0982
*    ELSE                                                          0984
*      CALL IDCDB010 (GDTTBL,'RC80');                              0984
         L     @15,@PC00001                                        0984
         ST    @15,@AL00001                                        0984
         LA    @14,@CC01249                                        0984
         ST    @14,@AL00001+4                                      0984
         MVI   @AL00001+4,X'80'                                    0984
         L     @15,GDTDBG(,@15)                                    0984
         LA    @01,@AL00001                                        0984
         BALR  @14,@15                                             0984
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE RETURN CODE                                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0985
*  LASTCC=LASTCC00;               /* INITIALIZE NORMAL RETURN        */
@RT00982 L     @15,@PC00001+8                                      0985
         SLR   @14,@14                                             0985
         STH   @14,LASTCC(,@15)                                    0985
*                                 /* CODE                            */
*                                                                  0986
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE SUPSP FUNCTION                               */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0986
*  CALL SUBSP (INITYPE);          /* GO TO INITIALIZE ROUTINE        */
*                                                                  0986
         LA    @01,@AL00986                                        0986
         BAL   @14,SUBSP                                           0986
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE BUFFER POOL FOR FIELD MANAGEMENT             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0987
*  BUFSPTR=ADDR(BUFSAR);          /* POINT AT THE I/O VECTOR         */
         LA    BUFSPTR,BUFSAR                                      0987
*  BUFGDT=ADDR(GDTTBL);           /* POINT AT THE GDT                */
         L     @04,@PC00001                                        0988
         ST    @04,BUFGDT(,BUFSPTR)                                0988
*  BUFWKARA=ADDR(BUFWKAR1);       /* POINT AT WORK AREA              */
         LA    @03,BUFWKAR1                                        0989
         ST    @03,BUFWKARA(,BUFSPTR)                              0989
*  BUFSWS=''B;                    /* ZERO SWITCHES                   */
*                                                                  0990
         XC    BUFSWS(2,BUFSPTR),BUFSWS(BUFSPTR)                   0990
*  /******************************************************************/
*  /*                                                                */
*  /*    ENQUEUE ON THE PROGRAM RESOURSE SO THAT ONLY ONE            */
*  /*    COPY OF EXPORTRA CAN BE RUNNING AT A TIME                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0991
*  CALL IDCSANQ0 (GDTTBL,EXCL,WAIT,SYSTEM,PROGRAM);                0991
         MVC   @AL00001+4(16),@AL00991                             0991
         ST    @04,@AL00001                                        0991
         L     @15,GDTENQ(,@04)                                    0991
         LA    @01,@AL00001                                        0991
         BALR  @14,@15                                             0991
*                                 /* ENQUEUE ON THIS PROGRAM         */
*                                                                  0992
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE POINTER TO THE PARAMETER LIST FOR THE        */
*  /*    CALL TO IDCRC02                                             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0992
*  INPPTR=NULLPTR;                /* CLEAR THE POINTER               */
*                                                                  0992
         SLR   @04,@04                                             0992
         ST    @04,INPPTR                                          0992
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE CORE MESSAGE INDICATOR AND DATASET   @OZ18993*/
*  /*    EXPORTED INDICATOR.                                 @OZ18993*/
*  /*                                                                */
*  /******************************************************************/
*                                                                  0993
*  CORE=GOOD;                     /* SET TO GOOD VALUE               */
         MVC   CORE(1),GOOD                                        0993
*  EXPORTED = 8;                  /* NOTHING EXPORTED        @OZ18993*/
*                                                                  0994
         LA    EXPORTED,8                                          0994
*  END INIT;                      /* END OF PROCEDURE                */
@EL00013 DS    0H                                                  0995
@EF00013 DS    0H                                                  0995
@ER00013 LM    @14,@01,@SA00013                                    0995
         LM    @03,@04,@SA00013+16                                 0995
         LM    @06,@12,@SA00013+24                                 0995
         BR    @14                                                 0995
@PB00013 DS    0H                                                  0996
*  GEN (EJECT);                                                    0996
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    MESSAGE                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    THIS ROUTINE INTERFACES WITH THE TEXT PROCESSOR FOR         */
*  /*    AMS TO BUILD THE DARGLIST                                   */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    NONE                                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  0997
*MESSAGE: PROCEDURE (MESSAGE0,MESSAGE1,MESSAGE2,MESSAGE3,          0997
*                    MESSAGE4,MESSAGE5);                           0997
*                                                                  0997
         B     @PB00014                                            0997
MESSAGE  STM   @14,@12,@SA00014                                    0997
         MVC   @PC00014(24),0(@01)                                 0997
*  DCL MESSAGE0  FIXED(31);       /* TYPE OF FORMATED BLOCK          */
*  DCL MESSAGE1  FIXED(15);       /* TEXT ID NUMBER                  */
*  DCL MESSAGE2  CHAR(*);         /* ADDRESS OF THE DATA BLOCK       */
*  DCL MESSAGE3  FIXED(31);       /* LENGTH OF THE DATA BLOCK        */
*  DCL MESSAGE4  CHAR(*);         /* ADDRESS OF THE DATA BLOCK       */
*  DCL MESSAGE5  FIXED(31);       /* LENGTH OF THE DATA BLOCK        */
*  DCL DDSTRU1   CHAR(LENGTH(DARGLIST)+2*LENGTH(DARGARY)) BDY(WORD);
*                                 /* INTERFACE BLOCK TO MESSAGE      */
*                                 /* ROUTINES                        */
*                                                                  1005
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1005
*  OLDERID2 = NEWERID2;                                            1005
         L     @15,@PC00001                                        1005
         L     @14,GDTTR2(,@15)                                    1005
         MVC   @TS00001(95),NEWERID2(@14)                          1005
         MVC   OLDERID2(95,@14),@TS00001                           1005
*  NEWID2='RC89';                                                  1006
         MVC   NEWID2(4,@14),@CC01266                              1006
*  IF GDTDBG = NULLPTR                                             1007
*    THEN;                                                         1007
         ICM   @14,15,GDTDBG(@15)                                  1007
         BZ    @RT01007                                            1007
*    ELSE                                                          1009
*      CALL IDCDB010 (GDTTBL,'RC89');                              1009
         L     @15,@PC00001                                        1009
         ST    @15,@AL00001                                        1009
         LA    @14,@CC01266                                        1009
         ST    @14,@AL00001+4                                      1009
         MVI   @AL00001+4,X'80'                                    1009
         L     @15,GDTDBG(,@15)                                    1009
         LA    @01,@AL00001                                        1009
         BALR  @14,@15                                             1009
*  /******************************************************************/
*  /*                                                                */
*  /*    POINT AT AND INITIALIZE THE UNUSED PORTION OF THE           */
*  /*    BLOCK TO COMMUNICATE ABOUT THE MESSAGE TO PRINT             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1010
*  DDSTRU=ADDR(DDSTRU1);          /* SET UP THE BASE ADDRESS         */
*                                                                  1010
@RT01007 LA    @15,DDSTRU1                                         1010
         ST    @15,DDSTRU                                          1010
*  DARGRETP=0;                    /* INITIALIZE TO ZERO              */
         SLR   @14,@14                                             1011
         ST    @14,DARGRETP(,@15)                                  1011
*  DARGCNT=0;                     /* INITIALIZE TO ZERO              */
         STH   @14,DARGCNT(,@15)                                   1012
*  DARGRETL=0;                    /* INITIALIZE TO ZERO              */
         STH   @14,DARGRETL(,@15)                                  1013
*  DARGIND=0;                     /* INITIALIZE TO ZERO              */
         MVI   DARGIND(@15),X'00'                                  1014
*  DARGDBP=0;                     /* INITIALIZE TO ZERO              */
         ST    @14,DARGDBP(,@15)                                   1015
*  DARGILP=0;                     /* INITIALIZE TO ZERO              */
*                                                                  1016
         STH   @14,DARGILP(,@15)                                   1016
*  /******************************************************************/
*  /*                                                                */
*  /*    FILL IN THE MESSAGE ID AND THE MODULE ID                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1017
*  IF MESSAGE1>UV0IDNO            /* IF NOT EXPORTRA MESSAGE         */
*    THEN IF MESSAGE1>XP0IDNO     /* THEN: IF EXPORT MESSAGE         */
         L     @14,@PC00014+4                                      1017
         LH    @14,MESSAGE1(,@14)                                  1017
         CH    @14,@CH00898                                        1017
         BNH   @RF01017                                            1017
*      THEN DO;                   /* THEN:                           */
         LA    @07,100                                             1018
         CR    @14,@07                                             1018
         BNH   @RF01018                                            1018
*        DARGSMOD=XP0MODID;       /* PLACE MODULE ID                 */
         MVC   DARGSMOD(3,@15),@CC00908                            1020
*        DARGSENT=MESSAGE1-XP0IDNO;                                1021
         SLR   @14,@07                                             1021
         STC   @14,DARGSENT(,@15)                                  1021
*                                 /* PLACE MESSAGE NUMBER            */
*        END;                     /*                                 */
*      ELSE DO;                   /* ELSE:                           */
         B     @RC01018                                            1023
@RF01018 DS    0H                                                  1024
*        DARGSMOD=UV0MODID;       /* PLACE MODULE ID                 */
         L     @15,DDSTRU                                          1024
         MVC   DARGSMOD(3,@15),UV0MODID                            1024
*        DARGSENT=MESSAGE1-UV0IDNO;                                1025
         L     @14,@PC00014+4                                      1025
         LH    @14,MESSAGE1(,@14)                                  1025
         SH    @14,@CH00898                                        1025
         STC   @14,DARGSENT(,@15)                                  1025
*                                 /* PLACE MESSAGE NUMBER            */
*        END;                     /*                                 */
*    ELSE DO;                     /* ELSE:                           */
         B     @RC01017                                            1027
@RF01017 DS    0H                                                  1028
*      DARGSMOD=MODID(1:3);       /* PLACE THE TEXT MODULE ID        */
         L     @15,DDSTRU                                          1028
         MVC   DARGSMOD(3,@15),MODID                               1028
*      DARGSENT=MESSAGE1;         /* PLACE THE TEXT ID               */
         L     @14,@PC00014+4                                      1029
         MVC   DARGSENT(1,@15),MESSAGE1+1(@14)                     1029
*      END;                       /*                                 */
*  /******************************************************************/
*  /*                                                                */
*  /*    FILL IN THE SINGLE DATA BLOCK FORMAT OF THE CALL            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1031
*  IF MESSAGE0<2                  /* IF SINGLE BLOCK DATA            */
*    THEN DO;                     /* THEN:                           */
@RC01017 L     @15,@PC00014                                        1031
         L     @15,MESSAGE0(,@15)                                  1031
         CH    @15,@CH00154                                        1031
         BNL   @RF01031                                            1031
*      IF MESSAGE3=0              /* IF NO MESSAGE PASSED            */
*        THEN DARGDBP=NULLPTR;    /* THEN: PLACE NULL POINTER        */
         SLR   @15,@15                                             1033
         L     @14,@PC00014+12                                     1033
         C     @15,MESSAGE3(,@14)                                  1033
         BNE   @RF01033                                            1033
         L     @14,DDSTRU                                          1034
         ST    @15,DARGDBP(,@14)                                   1034
*        ELSE DARGDBP=ADDR(MESSAGE2);                              1035
         B     @RC01033                                            1035
@RF01033 L     @15,@PC00014+8                                      1035
         L     @14,DDSTRU                                          1035
         ST    @15,DARGDBP(,@14)                                   1035
*                                 /* ELSE: POINT AT DATA             */
*      DARGILP=MESSAGE3;          /* PLACE DATA LENGTH               */
@RC01033 L     @15,@PC00014+12                                     1036
         L     @01,DDSTRU                                          1036
         MVC   DARGILP(2,@01),MESSAGE3+2(@15)                      1036
*      END;                       /*                                 */
*                                                                  1037
*    /****************************************************************/
*    /*                                                              */
*    /*    FILL IN THE MULTI DATA FORMAT OF THE MESSAGE              */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1038
*    ELSE DO;                     /* ELSE:                           */
         B     @RC01031                                            1038
@RF01031 DS    0H                                                  1039
*      DARGCNT=MESSAGE0;          /* PLACE DATA COUNT                */
         L     @15,DDSTRU                                          1039
         L     @14,@PC00014                                        1039
         MVC   DARGCNT(2,@15),MESSAGE0+2(@14)                      1039
*      DARGINS(1)=1;              /* INITIALIZE INSERT POINT         */
         MVC   DARGINS(2,@15),@CH00220                             1040
*      DARGINL(1)=MESSAGE3;       /* PLACE DATA LENGTH               */
         L     @14,@PC00014+12                                     1041
         MVC   DARGINL(2,@15),MESSAGE3+2(@14)                      1041
*      DARGDTM(1)=ADDR(MESSAGE2); /* PLACE DATA ADDRESS              */
         L     @14,@PC00014+8                                      1042
         ST    @14,DARGDTM(,@15)                                   1042
*      DARGINS(2)=2;              /* INITIALIZE INSERT POINT         */
         MVC   DARGINS+8(2,@15),@CH00154                           1043
*      DARGINL(2)=MESSAGE5;       /* PLACE DATA LENGTH               */
         L     @14,@PC00014+20                                     1044
         MVC   DARGINL+8(2,@15),MESSAGE5+2(@14)                    1044
*      DARGDTM(2)=ADDR(MESSAGE4); /* PLACE DATA ADDRESS              */
         L     @14,@PC00014+16                                     1045
         ST    @14,DARGDTM+8(,@15)                                 1045
*      END;                       /*                                 */
*                                                                  1046
*  /******************************************************************/
*  /*                                                                */
*  /*    INTERFACE WITH THE ROUTINE THAT PRINTS THE MESSAGE          */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1047
*  CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                          1047
@RC01031 L     @15,@PC00001                                        1047
         ST    @15,@AL00001                                        1047
         LA    @14,@CF00116                                        1047
         ST    @14,@AL00001+4                                      1047
         LA    @14,DDSTRU                                          1047
         ST    @14,@AL00001+8                                      1047
         MVI   @AL00001+8,X'80'                                    1047
         L     @15,GDTPRT(,@15)                                    1047
         LA    @01,@AL00001                                        1047
         BALR  @14,@15                                             1047
*                                 /* PRINT THE MESSAGE               */
*  END MESSAGE;                   /* END OF PROCEDURE                */
@EL00014 DS    0H                                                  1048
@EF00014 DS    0H                                                  1048
@ER00014 LM    @14,@12,@SA00014                                    1048
         BR    @14                                                 1048
@PB00014 DS    0H                                                  1049
*  GEN (EJECT);                                                    1049
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    NAMETABL                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS ROUTINE DOES ALL OF THE FOLLOWING FOR EACH OF          */
*  /*    THE TYPES THAT ARE PROCESSED (CLUSTER, ALTERNATE INDEX      */
*  /*    ,NON-VSAM, GENERATION DATA GROUP BASES, AND CATALOG         */
*  /*    CONECTORS).                                                 */
*  /*                                                                */
*  /*    IF 'ALL' WAS SPECIFIED:                                     */
*  /*                                                                */
*  /*    1. BUILD AND FILL IN THE NAME BLOCK WITH ALL THE DATA       */
*  /*       THAT IS KNOWN TODATE.                                    */
*  /*                                                                */
*  /*    IF 'ENTRIES' WAS SPECIFIED:                                 */
*  /*                                                                */
*  /*    1. SCAN THE NAME BLOCK CHAIN AND MARK THE NAME FOUND        */
*  /*       AND FILL IN ANY NEW DATA FOUND.                          */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. CRV ENTRY MUST BE SELECTED BEFOR THE CALL.               */
*  /*                                                                */
*  /*    2. CATALOG RECORD MUST BE RECORD1.                          */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1050
*NAMETABL: PROCEDURE (NPARM4);                                     1050
*                                                                  1050
         B     @PB00015                                            1050
NAMETABL STM   @14,@01,@SA00015                                    1050
         STM   @03,@12,@SA00015+16                                 1050
         MVC   @PC00015(4),0(@01)                                  1050
*  DCL NPARM4      FIXED(31);     /*INDEX INTO CRV                   */
*                                                                  1051
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1052
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1053
*  OLDERID2 = NEWERID2;                                            1053
         L     @14,@PC00001                                        1053
         L     @07,GDTTR2(,@14)                                    1053
         MVC   @TS00001(95),NEWERID2(@07)                          1053
         MVC   OLDERID2(95,@07),@TS00001                           1053
*  NEWID2='RC97';                                                  1054
         MVC   NEWID2(4,@07),@CC01273                              1054
*  IF GDTDBG = NULLPTR                                             1055
*    THEN;                                                         1055
         ICM   @07,15,GDTDBG(@14)                                  1055
         BZ    @RT01055                                            1055
*    ELSE                                                          1057
*      CALL IDCDB010 (GDTTBL,'RC97');                              1057
         L     @14,@PC00001                                        1057
         ST    @14,@AL00001                                        1057
         LA    @07,@CC01273                                        1057
         ST    @07,@AL00001+4                                      1057
         MVI   @AL00001+4,X'80'                                    1057
         L     @15,GDTDBG(,@14)                                    1057
         LA    @01,@AL00001                                        1057
         BALR  @14,@15                                             1057
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE NAME ON THIS RECORD ONLY IF IT IS ONE THAT       */
*  /*    IS TO BE PROCESSED                                          */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1058
*  IF RECTYPE=CLUSTYPE           /* IS THIS A CLUSTER               */
*     RECTYPE=AIXTYPE            /* OR AN AIX                       */
*     RECTYPE=NONVTYPE           /* OR A NON-VSAM                   */
*     RECTYPE=GDGBTYPE           /* OR A GDG BASE                   */
*     RECTYPE=CATCTYPE            /* OR A CATALOG CONECTOR           */
*    THEN DO;                     /* THEN:                           */
@RT01055 L     @14,IOCSPTR                                         1058
         L     @14,IOCDAD(,@14)                                    1058
         CLI   RECTYPE(@14),C'C'                                   1058
         BE    @RT01058                                            1058
         CLI   RECTYPE(@14),C'G'                                   1058
         BE    @RT01058                                            1058
         CLI   RECTYPE(@14),C'A'                                   1058
         BE    @RT01058                                            1058
         CLI   RECTYPE(@14),C'B'                                   1058
         BE    @RT01058                                            1058
         CLI   RECTYPE(@14),C'U'                                   1058
         BNE   @RF01058                                            1058
@RT01058 DS    0H                                                  1059
*      /**************************************************************/
*      /*                                                            */
*      /*    IF 'ALL' WAS SPECIFIED THEN THE NAME TABLE MUST BE      */
*      /*    BUILT AS THE LIST IS SCANED                             */
*      /*                                                            */
*      /**************************************************************/
*                                                                  1060
*      IF ALLNTPTR(NPARM4)^=NULLPTR                                1060
*                                 /* IF ALL WAS SPECIFIED            */
*        THEN DO;                 /* THEN:                           */
         L     @14,@PC00015                                        1060
         L     @14,NPARM4(,@14)                                    1060
         SLA   @14,2                                               1060
         L     @07,@PC00001+4                                      1060
         L     @01,FDTPTR+20(,@07)                                 1060
         AL    @01,@CF01392                                        1060
         L     @14,ALLNTPTR(@14,@01)                               1060
         LTR   @14,@14                                             1060
         BZ    @RF01060                                            1060
*          CALL SUBSP (GETTYPE,LENGTH(NBLK),NBLKPTR);              1062
         MVC   @AL00001(8),@AL01062                                1062
         LA    @14,NBLKPTR                                         1062
         ST    @14,@AL00001+8                                      1062
         LA    @01,@AL00001                                        1062
         BAL   @14,SUBSP                                           1062
*                                 /* GET SPACE FOR A NAME BLOCK      */
*          IF REG15^=LASTCC00     /* IF THERE IS NO STORAGE          */
*            THEN ERRNO=ERCDNSTR; /* THEN: INDICATE NO STORAGE       */
         LTR   REG15,REG15                                         1063
         BZ    @RF01063                                            1063
         LA    ERRNO,28                                            1064
*            ELSE DO;             /* ELSE:                           */
         B     @RC01063                                            1065
@RF01063 DS    0H                                                  1066
*              NBLKCHN=CRVNAMCH;  /* POINT BLOCK AT THE NAME         */
         L     @14,NBLKPTR                                         1066
         MVC   NBLKCHN(4,@14),CRVNAMCH(CRVEBASE)                   1066
*                                 /* CHAIN                           */
*              CRVNAMCH=NBLKPTR;  /* POINT CRV AT NEW CHAIN          */
         ST    @14,CRVNAMCH(,CRVEBASE)                             1067
*              NBLKTYPE=RECTYPE;  /* PLACE TYPE IN NAME BLOCK        */
         L     @01,IOCSPTR                                         1068
         L     @07,IOCDAD(,@01)                                    1068
         MVC   NBLKTYPE(1,@14),RECTYPE(@07)                        1068
*              NBLKCI=RECCI;      /* PLACE CATALOG CI IN THE         */
         MVC   NBLKCI(3,@14),RECCI(@07)                            1069
*                                 /* NAME BLOCK                      */
*              NBLKICI=INVALCI;   /* SET INDEX CI INVALID            */
         MVC   NBLKICI(3,@14),INVALCI                              1070
*              NBLKDCI=INVALCI;   /* SET DATA CI INVALID             */
         MVC   NBLKDCI(3,@14),INVALCI                              1071
*              CALL COMPNAME (RECNAME,NBLKNAME);                   1072
         LA    @07,RECNAME(,@07)                                   1072
         ST    @07,@AL00001                                        1072
         LA    @14,NBLKNAME(,@14)                                  1072
         ST    @14,@AL00001+4                                      1072
         LA    @01,@AL00001                                        1072
         BAL   @14,COMPNAME                                        1072
*                                 /* PLACE THE NAME POINTER IN       */
*                                 /* THE NAME BLOCK                  */
*              IF REG15^=LASTCC00 /* IF THERE IS NO STORAGE          */
*                THEN ERRNO=ERCDNSTR;                              1073
         LTR   REG15,REG15                                         1073
         BZ    @RF01073                                            1073
         LA    ERRNO,28                                            1074
*                                 /* THEN: INDICATE NO STORAGE       */
*                ELSE;            /* ELSE: CONTINUE                  */
@RF01073 DS    0H                                                  1076
*              END;               /*                                 */
*          END;                   /*                                 */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF01060 DS    0H                                                  1079
*      /**************************************************************/
*      /*                                                            */
*      /*    MATCH THE NAMES ON THE CHAIN IF ENTRIES WAS             */
*      /*    SPECIFIED FOR THIS CRA                                  */
*      /*                                                            */
*      /**************************************************************/
*                                                                  1079
*      IF ENTREPTR(NPARM4)^=NULLPTR                                1079
*                                 /* IF ENTRIES ARE SPECIFIED        */
*        THEN DO;                 /* THEN:                           */
@RC01060 L     @14,@PC00015                                        1079
         L     @14,NPARM4(,@14)                                    1079
         SLA   @14,2                                               1079
         L     @07,@PC00001+4                                      1079
         L     @01,FDTPTR+28(,@07)                                 1079
         AL    @01,@CF01392                                        1079
         L     @14,ENTREPTR(@14,@01)                               1079
         LTR   @14,@14                                             1079
         BZ    @RF01079                                            1079
*          CALL COMPNAME(RECNAME,DSNPTR);                          1081
         L     @14,IOCSPTR                                         1081
         L     @14,IOCDAD(,@14)                                    1081
         LA    @14,RECNAME(,@14)                                   1081
         ST    @14,@AL00001                                        1081
         LA    @14,DSNPTR                                          1081
         ST    @14,@AL00001+4                                      1081
         LA    @01,@AL00001                                        1081
         BAL   @14,COMPNAME                                        1081
*                                 /* GET A COMPRESSED COPY OF        */
*                                 /* THE NAME                        */
*          IF REG15^=LASTCC00     /* IF THERE IS NO SPACE            */
*            THEN ERRNO=ERCDNSTR; /* THEN: INDICATE NO STORAGE       */
         LTR   REG15,REG15                                         1082
         BZ    @RF01082                                            1082
         LA    ERRNO,28                                            1083
*            ELSE DO;             /* ELSE:                           */
         B     @RC01082                                            1084
@RF01082 DS    0H                                                  1085
*              CALL SUBSP (RETTYPE);                               1085
         LA    @01,@AL01085                                        1085
         BAL   @14,SUBSP                                           1085
*                                 /* RETURN THE SPACE TO POOL        */
*              NBLKPTR=CRVNAMCH;  /* POINT TO START SEARCH OF        */
         MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       1086
*                                 /* THE NAME CHAIN                  */
*              DO WHILE NBLKPTR^=NULLPTR;                          1087
         B     @DE01087                                            1087
@DL01087 DS    0H                                                  1088
*                                 /* LOOP TO SEARCH THE WHOLE        */
*                                 /* NAME CHAIN                      */
*                IF NBLKNAME->DSNAMLEN=DSNAMLEN                    1088
*                                 /* IF THE LENGTH'S MATCH THEN      */
*                  THEN IF NBLKNAME->DSNAM(1:DSNAMLEN)=            1088
         L     @14,NBLKPTR                                         1088
         L     @07,NBLKNAME(,@14)                                  1088
         L     @06,DSNPTR                                          1088
         LH    @05,DSNAMLEN(,@06)                                  1088
         CH    @05,DSNAMLEN(,@07)                                  1088
         BNE   @RF01088                                            1088
*                                    DSNAM(1:DSNAMLEN)             1089
*                    THEN DO;     /* THEN:                           */
         BCTR  @05,0                                               1089
         EX    @05,@SC01404                                        1089
         BNE   @RF01089                                            1089
*                      NBLKMH=ON;                                  1091
         OI    NBLKMH(@14),B'10000000'                             1091
*                                 /* INDICATE A MATCH                */
*                      NBLKTYPE=RECTYPE;                           1092
         L     @01,IOCSPTR                                         1092
         L     @07,IOCDAD(,@01)                                    1092
         MVC   NBLKTYPE(1,@14),RECTYPE(@07)                        1092
*                                 /* PLACE RECORD TYPE               */
*                      NBLKCI=RECCI;                               1093
         MVC   NBLKCI(3,@14),RECCI(@07)                            1093
*                                 /* PLACE THE BASE CI NUMBER        */
*                      NBLKPTR=NULLPTR;                            1094
         SLR   @14,@14                                             1094
         ST    @14,NBLKPTR                                         1094
*                                 /* INDICATE END OF SEARCH          */
*                      END;       /*                                 */
*                    ELSE;        /* ELSE: CONTINUE                  */
@RF01089 DS    0H                                                  1097
*                  ELSE;          /* ELSE: CONTINUE                  */
@RF01088 DS    0H                                                  1098
*                IF NBLKPTR=NULLPTR                                1098
*                                 /* IF AT END OF CHAIN              */
*                  THEN;          /* THEN: CONTINUE                  */
         ICM   @14,15,NBLKPTR                                      1098
         BZ    @RT01098                                            1098
*                  ELSE NBLKPTR=NBLKCHN;                           1100
         L     @14,NBLKPTR                                         1100
         L     @14,NBLKCHN(,@14)                                   1100
         ST    @14,NBLKPTR                                         1100
*                                 /* ELSE: POINT AT THE NEXT         */
*                                 /*       NAME ON THE CHAIN         */
*                END;             /*                                 */
@RT01098 DS    0H                                                  1101
@DE01087 ICM   @14,15,NBLKPTR                                      1101
         BNZ   @DL01087                                            1101
*              END;               /*                                 */
*          END;                   /*                                 */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF01079 DS    0H                                                  1105
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1106
@RF01058 DS    0H                                                  1107
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1107
*  END NAMETABL;                  /* END OF PROCEDURE                */
@EL00015 DS    0H                                                  1108
@EF00015 DS    0H                                                  1108
@ER00015 LM    @14,@01,@SA00015                                    1108
         LM    @03,@12,@SA00015+16                                 1108
         BR    @14                                                 1108
@PB00015 DS    0H                                                  1109
*  GEN (EJECT);                                                    1109
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    OBJVOLCK                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    CHECK THE DIRECTORY ENTRIES AND SUMTT TO INSURE THAT        */
*  /*    THE ENTRY COMPONENT IS IN SYNCRONIZATION ACROSS THE         */
*  /*    VOLUMES ON WHICH IT RESIDES                                 */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    NONE                                                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1110
*OBJVOLCK: PROCEDURE (OBJCI,OBJVOLSR);                             1110
*                                                                  1110
         B     @PB00016                                            1110
OBJVOLCK STM   @14,@02,@SA00016                                    1110
         STM   @04,@12,@SA00016+20                                 1110
         MVC   @PC00016(8),0(@01)                                  1110
*  /******************************************************************/
*  /*                                                                */
*  /*    THE INCOMING PARAMTERES FOR THIS ROUTINE                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1111
*  DCL OBJCI      FIXED(24);      /* CI NUMBER TO CHECK              */
*  DCL OBJVOLSR   CHAR(6);        /* VOLSER OF THE CRA               */
*                                                                  1112
*  /******************************************************************/
*  /*                                                                */
*  /*    VARIABLES USED IN THIS ROUTINE                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1113
*  DCL OBJSUMTT   FIXED(31);      /* COMPUTED SUMTT                  */
*  DCL OBJVOL2    CHAR(6);        /* WORK FIELD FOR VOLSER   @OZ14812*/
*  DCL OBJIX1     FIXED(31);      /* GENERAL COUNTER                 */
*  DCL OBJIX2     PTR(31);        /* GENERAL COUNTER                 */
*  DCL OBJIX3     FIXED(31);      /* GENERAL COUNTER                 */
*  DCL OBJIX4     PTR(31);        /* GENERAL COUNTER         @OZ14812*/
*  DCL OBJIX5     FIXED(31);      /* GENERAL COUNTER                 */
*  DCL OBJIX6     FIXED(31);      /* GENERAL COUNTER                 */
*  DCL OBJIX7     FIXED(31);      /* GENERAL COUNTER         @OZ14812*/
*  DCL OBJIX8     FIXED(31);      /* GENERAL COUNTER                 */
*  DCL OBJIX9     FIXED(31);      /* GENERAL COUNTER                 */
*  DCL OBJIX99    FIXED(31) BASED(OBJIX2);                         1124
*                                 /* USED TO MOVE DATA               */
*  DCL SSWTHDTA   BIT(8) CONSTANT('80'X);                          1125
*                                 /* SEQUENCE SET WITH DATA FLG      */
*                                                                  1126
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1127
*  OLDERID2 = NEWERID2;                                            1127
         L     @14,@PC00001                                        1127
         L     @04,GDTTR2(,@14)                                    1127
         MVC   @TS00001(95),NEWERID2(@04)                          1127
         MVC   OLDERID2(95,@04),@TS00001                           1127
*  NEWID2='RC84';                                                  1128
         MVC   NEWID2(4,@04),@CC01295                              1128
*  IF GDTDBG = NULLPTR                                             1129
*    THEN;                                                         1129
         ICM   @04,15,GDTDBG(@14)                                  1129
         BZ    @RT01129                                            1129
*    ELSE                                                          1131
*      CALL IDCDB010 (GDTTBL,'RC84');                              1131
*                                                                  1131
         L     @14,@PC00001                                        1131
         ST    @14,@AL00001                                        1131
         LA    @04,@CC01295                                        1131
         ST    @04,@AL00001+4                                      1131
         MVI   @AL00001+4,X'80'                                    1131
         L     @15,GDTDBG(,@14)                                    1131
         LA    @01,@AL00001                                        1131
         BALR  @14,@15                                             1131
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THE DIRECTORY IS NOT IN STORAGE AND THE USER DID         */
*  /*    SPECIFY FORCE THEN THERE IS NO NEED TO CHECK THE SUMTT      */
*  /*    SO JUST RETURN TO THE CALLER                                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1132
*  IF CRVDIRER=ON & FRC^=NULLPTR  /* IF DIRECTORY NOT IN CORE        */
*    THEN RETURN CODE(LASTCC00);  /* THEN: RETURN WITH ZERO          */
@RT01129 TM    CRVDIRER(CRVEBASE),B'00001000'                      1132
         BNO   @RF01132                                            1132
         SLR   @14,@14                                             1132
         L     @04,@PC00001+4                                      1132
         L     @04,FDTPTR(,@04)                                    1132
         C     @14,FRC(,@04)                                       1132
         BE    @RF01132                                            1132
         LR    @15,@14                                             1133
         L     @14,@SA00016                                        1133
         LM    @00,@02,@SA00016+8                                  1133
         LM    @04,@12,@SA00016+20                                 1133
         BR    @14                                                 1133
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1134
@RF01132 DS    0H                                                  1135
*  /******************************************************************/
*  /*                                                                */
*  /*    OBTAIN THE DATA NECESSARY TO CHECK THE SYNCHRONIZATION      */
*  /*    OF THIS DATA SET                                            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1135
*  CALL EXTRACT(0,OBJCI,0,0,OBJIX2,OBJIX1,QCRADITS,0);             1135
         MVC   @AL00001(32),@AL01135                               1135
         L     @14,@PC00016                                        1135
         ST    @14,@AL00001+4                                      1135
         LA    @14,OBJIX2                                          1135
         ST    @14,@AL00001+16                                     1135
         LA    @14,OBJIX1                                          1135
         ST    @14,@AL00001+20                                     1135
         LA    @01,@AL00001                                        1135
         BAL   @14,EXTRACT                                         1135
*                                 /* OBTAIN THE CREATION TS          */
*  IF OBJIX2=NULLPTR              /* IF NO DATA RETURNED             */
*    THEN VGOCRATS=0;             /* THEN: SET TO ZERO               */
         SLR   @14,@14                                             1136
         C     @14,OBJIX2                                          1136
         BNE   @RF01136                                            1136
         ST    @14,VGOCRATS                                        1137
*    ELSE VGOCRATS=OBJIX99;       /* ELSE: SET RETURNED TS           */
         B     @RC01136                                            1138
@RF01136 L     @14,OBJIX2                                          1138
         MVC   VGOCRATS(4),OBJIX99(@14)                            1138
*  CALL EXTRACT(1,OBJCI,VGOPTR,VGOSIZE,OBJIX2,OBJIX1,QEXTDATA,0,   1139
*               QITYPEXT,EQUAL,0,ADDR(SSWTHDTA),(LENGTH(SSWTHDTA)/8));
@RC01136 LA    @14,@CF00220                                        1139
         ST    @14,@AL00001                                        1139
         L     @14,@PC00016                                        1139
         ST    @14,@AL00001+4                                      1139
         LA    @14,VGOPTR                                          1139
         ST    @14,@AL00001+8                                      1139
         LA    @14,VGOSIZE                                         1139
         ST    @14,@AL00001+12                                     1139
         LA    @14,OBJIX2                                          1139
         ST    @14,@AL00001+16                                     1139
         LA    @14,OBJIX1                                          1139
         ST    @14,@AL00001+20                                     1139
         LA    @14,QEXTDATA                                        1139
         ST    @14,@AL00001+24                                     1139
         LA    @14,@CF00116                                        1139
         ST    @14,@AL00001+28                                     1139
         LA    @14,QITYPEXT                                        1139
         ST    @14,@AL00001+32                                     1139
         LA    @14,@CB00934                                        1139
         ST    @14,@AL00001+36                                     1139
         LA    @14,@CF00116                                        1139
         ST    @14,@AL00001+40                                     1139
         LA    @14,@CB00934                                        1139
         ST    @14,@AFTEMPS+12                                     1139
         LA    @14,@AFTEMPS+12                                     1139
         ST    @14,@AL00001+44                                     1139
         LA    @14,1                                               1139
         ST    @14,@AFTEMPS+16                                     1139
         LA    @14,@AFTEMPS+16                                     1139
         ST    @14,@AL00001+48                                     1139
         LA    @01,@AL00001                                        1139
         BAL   @14,EXTRACT                                         1139
*                                 /* GET THE VGO'S FOR THIS          */
*                                 /* ENTRY                           */
*                                                                  1140
*  /******************************************************************/
*  /*                                                                */
*  /*    CHECK THE SUMTT'S ON ALL THE VOLUMES REQUIRED FOR           */
*  /*    THIS ENTRY                                                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1140
*  VGOPTR1=ADDR(VGOENTYS(1));     /* POINT AT START OF VGO'S         */
         L     VGOPTR1,VGOPTR                                      1140
         LA    VGOPTR1,VGOENTYS(,VGOPTR1)                          1140
*  DO WHILE OBJIX1>0;             /* LOOP THROUGH ALL THE VGO'S      */
         B     @DE01141                                            1141
@DL01141 DS    0H                                                  1142
*    /****************************************************************/
*    /*                                                              */
*    /*    FIND THE VOLSER ENTRY NUMBER IN THE VTT (THAT IS          */
*    /*    INDEX INTO THE CRV)                                       */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1142
*    OBJIX3=0;                    /* INITIALIZE INDICATOR            */
         SLR   @14,@14                                             1142
         ST    @14,OBJIX3                                          1142
*    DO OBJIX2=1 TO CRACNT;       /* LOOP THROUGH VTT FOR            */
         LA    @14,1                                               1143
         B     @DE01143                                            1143
@DL01143 DS    0H                                                  1144
*                                 /* VOLUME SERIAL NUMBER            */
*      IF VTTVOLSR(OBJIX2)=VGOVOLSR                                1144
*                                 /* IF A MATCH IS FOUND             */
*        THEN DO;                 /* THEN:                           */
         LR    @04,@14                                             1144
         MH    @04,@CH00763                                        1144
         L     @01,CRVBASE                                         1144
         L     @01,CRVCRAPL(,@01)                                  1144
         L     @01,ACCVOLTT(,@01)                                  1144
         ALR   @01,@04                                             1144
         AL    @01,@CF01391                                        1144
         CLC   VTTVOLSR-4(6,@01),VGOVOLSR(VGOPTR1)                 1144
         BNE   @RF01144                                            1144
*          OBJIX3=OBJIX2;         /* SAVE THE FOUND INDEX            */
         ST    @14,OBJIX3                                          1146
*          OBJIX2=CRACNT;         /* INDICATE SEARCH COMPLETE        */
         L     @14,@PC00001+4                                      1147
         LA    @14,FDTPTR+12(,@14)                                 1147
         MVC   OBJIX2(4),CRACNT(@14)                               1147
*          END;                   /*                                 */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF01144 DS    0H                                                  1150
*      END;                       /*                                 */
*                                                                  1150
         LA    @14,1                                               1150
         AL    @14,OBJIX2                                          1150
@DE01143 ST    @14,OBJIX2                                          1150
         L     @04,@PC00001+4                                      1150
         LA    @04,FDTPTR+12(,@04)                                 1150
         C     @14,CRACNT(,@04)                                    1150
         BNH   @DL01143                                            1150
*    /****************************************************************/
*    /*                                                              */
*    /*    PRINT THE NECESSARY MESSAGES IF THE VOLSER NOT            */
*    /*    FOUND IN THE VTT                                          */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1151
*    IF OBJIX3=0                  /* IF THE VOLUME SERIAL IS         */
*                                 /* NOT FOUND                       */
*      THEN DO;                   /* THEN:                           */
         ICM   @14,15,OBJIX3                                       1151
         BNZ   @RF01151                                            1151
*        NBLKBE=ON;               /* INDICATE ENTRY IS BAD           */
         L     @14,NBLKPTR                                         1153
         OI    NBLKBE(@14),B'01000000'                             1153
*        CALL MESSAGE(0,MSGID13,VGOVOLSR,LENGTH(VGOVOLSR));        1154
         MVC   @AL00001(16),@AL01154                               1154
         ST    VGOPTR1,@AL00001+8                                  1154
         LA    @01,@AL00001                                        1154
         BAL   @14,MESSAGE                                         1154
*                                 /* PRINT REQUIRED VOLUME           */
*        OBJIX9=NBLKNAME->DSNAMLEN;                                1155
         L     @14,NBLKPTR                                         1155
         L     @14,NBLKNAME(,@14)                                  1155
         LH    @04,DSNAMLEN(,@14)                                  1155
         ST    @04,OBJIX9                                          1155
*                                 /* GET LENGTH OF NAME              */
*        CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,OBJIX9);           1156
         LA    @04,@CF00116                                        1156
         ST    @04,@AL00001                                        1156
         LA    @04,@CH00885                                        1156
         ST    @04,@AL00001+4                                      1156
         LA    @14,DSNAM(,@14)                                     1156
         ST    @14,@AL00001+8                                      1156
         LA    @14,OBJIX9                                          1156
         ST    @14,@AL00001+12                                     1156
         LA    @01,@AL00001                                        1156
         BAL   @14,MESSAGE                                         1156
*                                 /* PRINT THE DSNAME                */
*        END;                     /*                                 */
*      /**************************************************************/
*      /*                                                            */
*      /*    HANDLE THE VOLSER IF IT IS FOUND                        */
*      /*                                                            */
*      /**************************************************************/
*                                                                  1158
*      ELSE DO;                   /* ELSE:                           */
         B     @RC01151                                            1158
@RF01151 DS    0H                                                  1159
*        OBJIX8=CRVEBASE;         /* SAVE THE OLD BASE               */
         ST    CRVEBASE,OBJIX8                                     1159
*        CRVEBASE=ADDR(CRVENTRY(OBJIX3));                          1160
         L     @14,OBJIX3                                          1160
         MH    @14,@CH00954                                        1160
         L     CRVEBASE,CRVBASE                                    1160
         LA    CRVEBASE,CRVENTRY-28(@14,CRVEBASE)                  1160
*                                 /* POINT AT THE NEW ENTRY          */
*        IF CRVOPNAG=NULLPTR & CRVBADVL=OFF                        1161
*                                 /* IF VOLUME NOT OPENED AND        */
*                                 /* MAY BE OK                       */
*          THEN DO;               /* THEN:                           */
         ICM   @14,15,CRVOPNAG(CRVEBASE)                           1161
         BNZ   @RF01161                                            1161
         TM    CRVBADVL(CRVEBASE),B'10000000'                      1161
         BNZ   @RF01161                                            1161
*            CALL OPENCRA(OPENFUNC,OBJIX3,CRADS);                  1163
         MVC   @AL00001(12),@AL01163                               1163
         LA    @14,OBJIX3                                          1163
         ST    @14,@AL00001+4                                      1163
         LA    @01,@AL00001                                        1163
         BAL   @14,OPENCRA                                         1163
*                                 /* OPEN TO BUILD THE TABLES        */
*            IF REG15=LASTCC12    /* IF THERE IS NO STORAGE          */
*              THEN RETURN CODE(LASTCC12);                         1164
         LA    @14,12                                              1164
         CR    REG15,@14                                           1164
         BNE   @RF01164                                            1164
         LR    @15,@14                                             1165
         L     @14,@SA00016                                        1165
         LM    @00,@02,@SA00016+8                                  1165
         LM    @04,@12,@SA00016+20                                 1165
         BR    @14                                                 1165
*                                 /* THEN: RETURN ERROR              */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF01164 DS    0H                                                  1167
*            CALL OPENCRA(CLOSFUNC,OBJIX3);                        1167
         LA    @14,@CC00855                                        1167
         ST    @14,@AL00001                                        1167
         LA    @14,OBJIX3                                          1167
         ST    @14,@AL00001+4                                      1167
         LA    @01,@AL00001                                        1167
         BAL   @14,OPENCRA                                         1167
*                                 /* CLOSE BECAUSE NOT NEEDED        */
*            END;                 /*                                 */
*          ELSE;                  /* ELSE: CONTINUE                  */
*                                                                  1169
@RF01161 DS    0H                                                  1170
*        /************************************************************/
*        /*                                                          */
*        /*    PRINT THE MESSAGES IF THE VOLUME CAN NOT BE           */
*        /*    OPENED UP                                             */
*        /*                                                          */
*        /************************************************************/
*                                                                  1170
*        IF CRVBADVL=ON           /* IF THE VOLUME IS NO GOOD        */
*          THEN NBLKSC=ON;        /* THEN: INDICATE OU-OF-SYNCH      */
         TM    CRVBADVL(CRVEBASE),B'10000000'                      1170
         BNO   @RF01170                                            1170
         L     @14,NBLKPTR                                         1171
         OI    NBLKSC(@14),B'00100000'                             1171
*          /**********************************************************/
*          /*                                                        */
*          /*    CHECK THE SUMTT IF THE VOLUME IS NOT THE            */
*          /*    SAME AS THE VOLUME BEING CHECKED                    */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1172
*          ELSE DO;               /* ELSE:                           */
         B     @RC01170                                            1172
@RF01170 DS    0H                                                  1173
*            IF VGOVOLSR=OBJVOLSR /* IF CHECKING THE SAME            */
*                                 /* VOLUME AS THE CRA VOLUME,       */
*               VGOSKIP(1)='FF'X /* OR ENTRY HAS ALREADY    @OZ14812*/
*                                 /* BEEN PROCESSED,         @OZ14812*/
*                                 /* THERE IS NO NEED        @OZ14812*/
*              THEN;              /* THEN: CONTINUE                  */
         L     @14,@PC00016+4                                      1173
         CLC   VGOVOLSR(6,VGOPTR1),OBJVOLSR(@14)                   1173
         BE    @RT01173                                            1173
         CLI   VGOSKIP(VGOPTR1),X'FF'                              1173
         BE    @RT01173                                            1173
*              ELSE                                                1175
*INLOOP1:        DO;                                       /*@OZ25037*/
INLOOP1  DS    0H                                                  1176
*                IF VGODIRSN ^=0                           /*@OZ25037*/
*                  THEN                                    /*@OZ25037*/
         ICM   @14,3,VGODIRSN(VGOPTR1)                             1176
         BZ    @RF01176                                            1176
*INLOOP2:            DO;                                   /*@OZ25037*/
INLOOP2  DS    0H                                                  1178
*                    I = VGODIRSN;                         /*@OZ25037*/
         LH    I,VGODIRSN(,VGOPTR1)                                1178
*                    PDELERR = OFF;                        /*@OZ25037*/
*                                                                  1179
         NI    PDELERR,B'01111111'                                 1179
*                   /*************************************************/
*                   /* NOW LOOP THRU THE ENTRIES TO FIND     @OZ25037*/
*                   /* RELREPNO THATS THE SAME.THE EXTRACT   @OZ25037*/
*                   /* WILL NOT BRING IN DELETED ENTRIES.    @OZ25037*/
*                   /*************************************************/
*                                                                  1180
*                    DO WHILE DIRELPNO(I) ^= VGODIRSN              1180
*                      & PDELERR = OFF;                    /*@OZ25037*/
         B     @DE01180                                            1180
@DL01180 DS    0H                                                  1181
*                      IF DIRELPNO(I) > VGODIRSN  I > 1   /*@OZ25037*/
*                        THEN                              /*@OZ25037*/
         LR    @14,I                                               1181
         MH    @14,@CH00038                                        1181
         L     @01,CRVDIREC(,CRVEBASE)                             1181
         ALR   @01,@14                                             1181
         BCTR  @01,0                                               1181
         BCTR  @01,0                                               1181
         SLR   @14,@14                                             1181
         ICM   @14,3,DIRELPNO-10(@01)                              1181
         CH    @14,VGODIRSN(,VGOPTR1)                              1181
         BH    @RT01181                                            1181
         CH    I,@CH00220                                          1181
         BNH   @RF01181                                            1181
@RT01181 DS    0H                                                  1182
*                          I = I - 1;                      /*@OZ25037*/
         BCTR  I,0                                                 1182
*                        ELSE                              /*@OZ25037*/
*                                                                  1183
*                        /********************************************/
*                        /* THERE IS NO MATCH IN THE TABLE.  @OZ25036*/
*                        /* THE ENTRY IN VGO IS THERE        @OZ25036*/
*                        /* BUT NOT IN DIRECTORY.            @OZ25036*/
*                        /********************************************/
*                                                                  1183
*                          DO;                             /*@OZ25036*/
         B     @RC01181                                            1183
@RF01181 DS    0H                                                  1184
*                            PDELERR = ON;                 /*@OZ25036*/
         OI    PDELERR,B'10000000'                                 1184
*                            CALL MESSAGE(1,MSGID25,VGOVOLSR,      1185
*                            LENGTH(VGOVOLSR));            /*@OZ25036*/
         MVC   @AL00001(16),@AL01185                               1185
         ST    VGOPTR1,@AL00001+8                                  1185
         LA    @01,@AL00001                                        1185
         BAL   @14,MESSAGE                                         1185
*                            NBLKBE=ON;   /* MARK ENTRY BAD  @OZ25036*/
         L     @14,NBLKPTR                                         1186
         OI    NBLKBE(@14),B'01000000'                             1186
*                            OBJIX6=NBLKNAME->DSNAMLEN;    /*@OZ25036*/
         L     @14,NBLKNAME(,@14)                                  1187
         LH    @07,DSNAMLEN(,@14)                                  1187
         ST    @07,OBJIX6                                          1187
*                                         /* GET THE NAME LENGTH     */
*                            CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,
*                             OBJIX6); /* PRINT DATA SET NAME@OZ25036*/
         LA    @07,@CF00116                                        1188
         ST    @07,@AL00001                                        1188
         LA    @07,@CH00885                                        1188
         ST    @07,@AL00001+4                                      1188
         LA    @14,DSNAM(,@14)                                     1188
         ST    @14,@AL00001+8                                      1188
         LA    @14,OBJIX6                                          1188
         ST    @14,@AL00001+12                                     1188
         LA    @01,@AL00001                                        1188
         BAL   @14,MESSAGE                                         1188
*                          END;                            /*@OZ25036*/
*                    END;                                  /*@OZ25036*/
@RC01181 DS    0H                                                  1190
@DE01180 LR    @14,I                                               1190
         MH    @14,@CH00038                                        1190
         L     @01,CRVDIREC(,CRVEBASE)                             1190
         ALR   @01,@14                                             1190
         BCTR  @01,0                                               1190
         BCTR  @01,0                                               1190
         SLR   @14,@14                                             1190
         ICM   @14,3,DIRELPNO-10(@01)                              1190
         CH    @14,VGODIRSN(,VGOPTR1)                              1190
         BE    @DC01180                                            1190
         TM    PDELERR,B'10000000'                                 1190
         BZ    @DL01180                                            1190
@DC01180 DS    0H                                                  1191
*                    IF PDELERR = ON                       /*@OZ25036*/
*                      THEN;                               /*@OZ25037*/
         TM    PDELERR,B'10000000'                                 1191
         BO    @RT01191                                            1191
*                      ELSE                                /*@OZ25037*/
*                      IF (DIRCI(I)=OBJCI & (DIRTS(I)=VGOCRATS     1193
*                          DIRTS(I)='FFFFFFFF'X))         /*@OZ25037*/
*                                 /* IF THE CI AND TIMESTAMP         */
*                                 /* MATCHES                         */
*                  THEN DO;       /* THEN:                           */
         LR    @14,I                                               1193
         MH    @14,@CH00038                                        1193
         L     @07,CRVDIREC(,CRVEBASE)                             1193
         L     @06,@PC00016                                        1193
         ST    @14,@TF00001                                        1193
         ALR   @14,@07                                             1193
         AL    @14,@CF01407                                        1193
         CLC   DIRCI(3,@14),OBJCI(@06)                             1193
         BNE   @RF01193                                            1193
         LR    @14,@07                                             1193
         AL    @14,@TF00001                                        1193
         AL    @14,@CF01408                                        1193
         CLC   DIRTS-3(4,@14),VGOCRATS                             1193
         BE    @RT01193                                            1193
         AL    @07,@TF00001                                        1193
         AL    @07,@CF01408                                        1193
         CLC   DIRTS-3(4,@07),@CB01300                             1193
         BNE   @RF01193                                            1193
@RT01193 DS    0H                                                  1194
*                    OBJSUMTT=0;  /* ZERO THE SUMTT FIELD            */
         SLR   @14,@14                                             1195
         ST    @14,OBJSUMTT                                        1195
*                    /************************************************/
*                    /* SAVE THE POINTER TO THE CURRENT      @OZ14812*/
*                    /* ENTRY, THE LOOP COUNTER, AND THE     @OZ14812*/
*                    /* CURRENT VOLSER FOR NEXT LOOP:        @OZ14812*/
*                    /************************************************/
*                    OBJIX4=VGOPTR1;                       /*@OZ14812*/
         ST    VGOPTR1,OBJIX4                                      1196
*                    OBJIX7=OBJIX1;                        /*@OZ14812*/
         L     OBJIX7,OBJIX1                                       1197
*                    OBJVOL2=VGOVOLSR;                     /*@OZ14812*/
         MVC   OBJVOL2(6),VGOVOLSR(VGOPTR1)                        1198
*                    /************************************************/
*                    /* NOW LOOP THROUGH THE REST OF THE     @OZ14812*/
*                    /* VGO TABLE, LOOKING FOR ENTRIES       @OZ14812*/
*                    /* HAVING THE SAME VOLSER (NOTE THAT    @OZ14812*/
*                    /* FIRST TIME WE FIND CURRENT ENTRY):   @OZ14812*/
*                    /************************************************/
*                    DO WHILE OBJIX7>0;                    /*@OZ14812*/
         B     @DE01199                                            1199
@DL01199 DS    0H                                                  1200
*                      IF VGOVOLSR=OBJVOL2 & VGOEXLEN>0    /*@OZ14812*/
*                        THEN                              /*@OZ14812*/
         CLC   VGOVOLSR(6,VGOPTR1),OBJVOL2                         1200
         BNE   @RF01200                                            1200
         LH    @14,VGOEXLEN(,VGOPTR1)                              1200
         LTR   @14,@14                                             1200
         BNP   @RF01200                                            1200
*                          DO;                             /*@OZ14812*/
*                            /* SET SWITCH TO IGNORE THIS    @OZ14812*/
*                            /* ENTRY NEXT TIME:             @OZ14812*/
*                            VGOSKIP(1)='FF'X;             /*@OZ14812*/
         MVI   VGOSKIP(VGOPTR1),X'FF'                              1202
*                            /* ACCCUMULATE THE SUMTT        @OZ14812*/
*                            OBJIX5=VGOEXLEN/LENGTH(VGOEXT);       1203
         LR    @00,@14                                             1203
         SRDA  @00,32                                              1203
         D     @00,@CF00885                                        1203
         ST    @01,OBJIX5                                          1203
*                            DO OBJIX6=1 TO OBJIX5;        /*@OZ14812*/
         LA    @14,1                                               1204
         B     @DE01204                                            1204
@DL01204 DS    0H                                                  1205
*                              OBJSUMTT=OBJSUMTT+VGOHH(OBJIX6)+    1205
*                                       VGOCC(OBJIX6)*CRVTKPCY;    1205
         LR    @07,@14                                             1205
         MH    @07,@CH00885                                        1205
         LR    @01,VGOPTR1                                         1205
         AL    @01,@CF01409                                        1205
         LH    @01,VGOHH-14(@07,@01)                               1205
         AL    @01,OBJSUMTT                                        1205
         AL    @07,@CF01384                                        1205
         LH    @07,VGOCC-12(@07,VGOPTR1)                           1205
         MH    @07,CRVTKPCY(,CRVEBASE)                             1205
         ALR   @01,@07                                             1205
         ST    @01,OBJSUMTT                                        1205
*                            END;                          /*@OZ14812*/
         AL    @14,@CF00220                                        1206
@DE01204 ST    @14,OBJIX6                                          1206
         C     @14,OBJIX5                                          1206
         BNH   @DL01204                                            1206
*                          END;                            /*@OZ14812*/
*                      /* BUMP TO NEXT VGO ENTRY             @OZ14812*/
*                      VGOPTR1=VGOPTR1+VGOEXLEN            /*@OZ14812*/
*                              +LENGTH(VGOENT);            /*@OZ14812*/
@RF01200 LA    @14,10                                              1208
         LR    @07,VGOPTR1                                         1208
         AH    @07,VGOEXLEN(,VGOPTR1)                              1208
         ALR   @07,@14                                             1208
         LR    VGOPTR1,@07                                         1208
*                      OBJIX7=OBJIX7-VGOEXLEN              /*@OZ14812*/
*                             -LENGTH(VGOENT);             /*@OZ14812*/
         LR    @07,OBJIX7                                          1209
         SH    @07,VGOEXLEN(,VGOPTR1)                              1209
         SLR   @07,@14                                             1209
         LR    OBJIX7,@07                                          1209
*                    END;                                  /*@OZ14812*/
@DE01199 LTR   OBJIX7,OBJIX7                                       1210
         BP    @DL01199                                            1210
*                    /* RESTORE PTR TO CURRENT ENTRY         @OZ14812*/
*                    VGOPTR1=OBJIX4;                       /*@OZ14812*/
         L     VGOPTR1,OBJIX4                                      1211
*                    IF OBJSUMTT=DIRSUMTT(I)              /*@OZ25037*/
*                       DIRSUMTT(I)='FFFFFF'X              /*@OZ25037*/
*                                 /* IF THE SUMS MATCH               */
*                      THEN;      /* THEN: CONTINUE                  */
         LR    @14,I                                               1212
         MH    @14,@CH00038                                        1212
         L     @07,CRVDIREC(,CRVEBASE)                             1212
         L     @06,OBJSUMTT                                        1212
         LA    @01,0(@14,@07)                                      1212
         AL    @01,@CF01409                                        1212
         L     @01,DIRSUMTT-7(,@01)                                1212
         LA    @01,0(,@01)                                         1212
         CR    @06,@01                                             1212
         BE    @RT01212                                            1212
         ALR   @07,@14                                             1212
         AL    @07,@CF01410                                        1212
         CLC   DIRSUMTT-7(3,@07),@CB00655                          1212
         BE    @RT01212                                            1212
*                      ELSE NBLKSC=ON;                             1214
         L     @14,NBLKPTR                                         1214
         OI    NBLKSC(@14),B'00100000'                             1214
*                                 /* ELSE: INDICATE OUT-OF-SYNC      */
*                    END;         /*                                 */
*                  /**************************************************/
*                  /*                                                */
*                  /*    HANDLE PRINTING THE VOLUME OUT-OF-SYNC      */
*                  /*    MESSAGE                                     */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1216
*                  ELSE           /* ELSE:                           */
*                    DO;                                           1216
         B     @RC01193                                            1216
@RF01193 DS    0H                                                  1217
*                      IF VGOCRATS>DIRTS(I)                /*@OZ25037*/
*                             /* IF OBJECT VOLUME IS LATER           */
*                             /* VOLUME                              */
*                        THEN CALL MESSAGE(2,MSGID12,              1217
         LR    @14,I                                               1217
         MH    @14,@CH00038                                        1217
         L     @01,CRVDIREC(,CRVEBASE)                             1217
         ALR   @01,@14                                             1217
         AL    @01,@CF01408                                        1217
         CLC   VGOCRATS(4),DIRTS-3(@01)                            1217
         BNH   @RF01217                                            1217
*                                  OBJVOLSR,LENGTH(OBJVOLSR),      1218
*                                  VGOVOLSR,LENGTH(VGOVOLSR));     1218
         MVC   @AL00001(24),@AL01218                               1218
         L     @14,@PC00016+4                                      1218
         ST    @14,@AL00001+8                                      1218
         ST    VGOPTR1,@AL00001+16                                 1218
         LA    @01,@AL00001                                        1218
         BAL   @14,MESSAGE                                         1218
*                        ELSE CALL MESSAGE(2,MSGID12,              1219
*                                  VGOVOLSR,LENGTH(VGOVOLSR),      1219
*                                  OBJVOLSR,LENGTH(OBJVOLSR));     1219
         B     @RC01217                                            1219
@RF01217 MVC   @AL00001(24),@AL01219                               1219
         ST    VGOPTR1,@AL00001+8                                  1219
         L     @14,@PC00016+4                                      1219
         ST    @14,@AL00001+16                                     1219
         LA    @01,@AL00001                                        1219
         BAL   @14,MESSAGE                                         1219
*                      NBLKBE=ON;   /* MARK AS BAD ENTRY             */
@RC01217 L     @14,NBLKPTR                                         1220
         OI    NBLKBE(@14),B'01000000'                             1220
*                      OBJIX6=NBLKNAME->DSNAMLEN;                  1221
         L     @14,NBLKNAME(,@14)                                  1221
         LH    @04,DSNAMLEN(,@14)                                  1221
         ST    @04,OBJIX6                                          1221
*                                   /* GET THE NAME LENGTH           */
*                      CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,OBJIX6);
         LA    @04,@CF00116                                        1222
         ST    @04,@AL00001                                        1222
         LA    @04,@CH00885                                        1222
         ST    @04,@AL00001+4                                      1222
         LA    @14,DSNAM(,@14)                                     1222
         ST    @14,@AL00001+8                                      1222
         LA    @14,OBJIX6                                          1222
         ST    @14,@AL00001+12                                     1222
         LA    @01,@AL00001                                        1222
         BAL   @14,MESSAGE                                         1222
*                                   /* PRINT THE DATA SET NAME       */
*                    END;           /*                               */
*                END INLOOP2;       /*                       @OZ25036*/
*                                                                  1224
*                /****************************************************/
*                /*                                                  */
*                /*  HANDLE PRINTING THE UNUSEABLE MESSAGE   @OZ25036*/
*                /*  (THE VGODIRSN IS ZERO) AND DATA SET NAME@OZ25036*/
*                /*                                                  */
*                /****************************************************/
*                                                                  1225
*              ELSE                                        /*@OZ25036*/
*                DO;                                       /*@OZ25036*/
         B     @RC01176                                            1225
@RF01176 DS    0H                                                  1226
*                  CALL MESSAGE(0,MSGID24,0,0);            /*@OZ25036*/
         LA    @01,@AL01226                                        1226
         BAL   @14,MESSAGE                                         1226
*                  OBJIX6=NBLKNAME->DSNAMLEN;                      1227
         L     @14,NBLKPTR                                         1227
         L     @14,NBLKNAME(,@14)                                  1227
         LH    @04,DSNAMLEN(,@14)                                  1227
         ST    @04,OBJIX6                                          1227
*                                   /* GET THE NAME LENGTH   @OZ25036*/
*                  CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,OBJIX6); 1228
         LA    @04,@CF00116                                        1228
         ST    @04,@AL00001                                        1228
         LA    @04,@CH00885                                        1228
         ST    @04,@AL00001+4                                      1228
         LA    @14,DSNAM(,@14)                                     1228
         ST    @14,@AL00001+8                                      1228
         LA    @14,OBJIX6                                          1228
         ST    @14,@AL00001+12                                     1228
         LA    @01,@AL00001                                        1228
         BAL   @14,MESSAGE                                         1228
*                                   /* PRINT DATA SET NAME   @OZ25036*/
*                  NBLKBE = ON;                            /*@OZ25036*/
         L     @14,NBLKPTR                                         1229
         OI    NBLKBE(@14),B'01000000'                             1229
*                END;                                      /*@OZ25036*/
*            END INLOOP1;                                  /*@OZ25037*/
@RC01176 DS    0H                                                  1232
*          END;                                            /*@OZ25037*/
@RT01173 DS    0H                                                  1233
*        CRVEBASE=OBJIX8;         /* RESTORE THE ORIGINAL BASE       */
@RC01170 L     CRVEBASE,OBJIX8                                     1233
*        END;                     /*                                 */
*                                                                  1234
*    /****************************************************************/
*    /*                                                              */
*    /*    CONTINUE TO HANDLE THE NEXT VOLUME OF THE DATA SET        */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1235
*    OBJIX1=OBJIX1-VGOEXLEN-LENGTH(VGOENT);                        1235
@RC01151 LA    @14,10                                              1235
         LH    @04,VGOEXLEN(,VGOPTR1)                              1235
         L     @07,OBJIX1                                          1235
         SLR   @07,@04                                             1235
         SLR   @07,@14                                             1235
         ST    @07,OBJIX1                                          1235
*                                 /* DECREMENT BY LENGTH             */
*                                 /* PROCESSED                       */
*    VGOPTR1=VGOPTR1+VGOEXLEN+LENGTH(VGOENT);                      1236
         ALR   @04,VGOPTR1                                         1236
         ALR   @04,@14                                             1236
         LR    VGOPTR1,@04                                         1236
*                                 /* POINT TO NEXT VOLSER            */
*    END;                         /*                                 */
*                                                                  1237
@DE01141 SLR   @14,@14                                             1237
         C     @14,OBJIX1                                          1237
         BL    @DL01141                                            1237
*  RETURN CODE(LASTCC00);         /* RETURN ZERO RETURN CODE         */
*                                                                  1238
         LR    @15,@14                                             1238
         L     @14,@SA00016                                        1238
         LM    @00,@02,@SA00016+8                                  1238
         LM    @04,@12,@SA00016+20                                 1238
         BR    @14                                                 1238
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1239
*  END OBJVOLCK;                  /* END OF PROCEDURE                */
@PB00016 DS    0H                                                  1241
*  GEN (EJECT);                                                    1241
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    OPEN                                                        */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*                                                                */
*  /*    THIS ROUTINE ACTS AS A DRIVER FOR ALL OF THE ROUTINES       */
*  /*    THAT ARE REQUIRED TO OPEN A CRA                             */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. THE CRV MUST BE CONSTRUCTED                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1242
*OPEN: PROCEDURE (OPARM4,OPARM5);                                  1242
*                                                                  1242
         B     @PB00017                                            1242
OPEN     STM   @14,@01,@SA00017                                    1242
         STM   @03,@12,@SA00017+16                                 1242
         MVC   @PC00017(8),0(@01)                                  1242
*  DCL OPARM4     FIXED(31);      /* INDEX INTO CRV                  */
*  DCL OPARM5     CHAR(1);        /* CRA OPEN TYPE                   */
*                                                                  1244
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1245
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1246
*  OLDERID2 = NEWERID2;                                            1246
         L     @14,@PC00001                                        1246
         L     @07,GDTTR2(,@14)                                    1246
         MVC   @TS00001(95),NEWERID2(@07)                          1246
         MVC   OLDERID2(95,@07),@TS00001                           1246
*  NEWID2='RC92';                                                  1247
         MVC   NEWID2(4,@07),@CC01309                              1247
*  IF GDTDBG = NULLPTR                                             1248
*    THEN;                                                         1248
         ICM   @07,15,GDTDBG(@14)                                  1248
         BZ    @RT01248                                            1248
*    ELSE                                                          1250
*      CALL IDCDB010 (GDTTBL,'RC92');                              1250
*                                                                  1250
         L     @14,@PC00001                                        1250
         ST    @14,@AL00001                                        1250
         LA    @07,@CC01309                                        1250
         ST    @07,@AL00001+4                                      1250
         MVI   @AL00001+4,X'80'                                    1250
         L     @15,GDTDBG(,@14)                                    1250
         LA    @01,@AL00001                                        1250
         BALR  @14,@15                                             1250
*  /******************************************************************/
*  /*                                                                */
*  /*    RETURN AN ERROR MESSAGE IF THIS CRA HAS BEEN DEFINED        */
*  /*    AS BAD AND CAN NOT BE OPENED OR USED                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1251
*  IF CRVBADVL=ON                 /* IF THIS IS A BAD CRA            */
*    THEN ERRNO=ERCDCNTO;         /* THEN: INDICATE NOT OPEN-        */
@RT01248 TM    CRVBADVL(CRVEBASE),B'10000000'                      1251
         BNO   @RF01251                                            1251
         LA    ERRNO,4                                             1252
*                                 /*       ABLE ERROR CODE           */
*    /****************************************************************/
*    /*                                                              */
*    /*    ATTEMPT TO OPEN THE CRA DESIRED                           */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1253
*    ELSE DO;                     /* ELSE:                           */
*                                                                  1253
         B     @RC01251                                            1253
@RF01251 DS    0H                                                  1254
*      /**************************************************************/
*      /*                                                            */
*      /*    OBTAIN AN OPEN OPNAGL TO DO THE OPEN WITH               */
*      /*                                                            */
*      /**************************************************************/
*                                                                  1254
*      IF CRVOPNAG=NULLPTR        /* IF THERE IS NO OPNAGL           */
*                                                                  1254
*        /************************************************************/
*        /*                                                          */
*        /*    THERE IS NO OPNAGL SO A NEW ONE MUST BE OBTAINED      */
*        /*    AND INITIALIZED                                       */
*        /*                                                          */
*        /************************************************************/
*                                                                  1254
*        THEN DO;                 /* THEN:                           */
         ICM   @14,15,CRVOPNAG(CRVEBASE)                           1254
         BNZ   @RF01254                                            1254
*          CALL IDCSAGP0 (GDTTBL,LENGTH(OPNAGL),OPNPTR,COREID1,SETZERO)
         MVC   @AL00001+4(16),@AL01256                             1256
         L     @14,@PC00001                                        1256
         ST    @14,@AL00001                                        1256
         LA    @07,OPNPTR                                          1256
         ST    @07,@AL00001+8                                      1256
         L     @15,GDTGPL(,@14)                                    1256
         LA    @01,@AL00001                                        1256
         BALR  @14,@15                                             1256
*                                 /* OBTAIN SPACE FOR THE            */
*                                 /* OPNAGL                          */
*          IF REG15^=LASTCC00     /* IF THERE IS NO STORAGE          */
*            THEN DO;             /* THEN:                           */
         LTR   REG15,REG15                                         1257
         BZ    @RF01257                                            1257
*              ERRNO=ERCDNSTR;    /* INDICATE NO STORAGE             */
         LA    ERRNO,28                                            1259
*              CORE=BAD;          /* INDICATE CORE MESSAGE           */
         MVC   CORE(1),BAD                                         1260
*              END;               /*                                 */
*            ELSE DO;             /* ELSE:                           */
         B     @RC01257                                            1262
@RF01257 DS    0H                                                  1263
*              CRVOPNAG=OPNPTR;   /* SAVE THE ADDRESS OF THE         */
         L     @14,OPNPTR                                          1263
         ST    @14,CRVOPNAG(,CRVEBASE)                             1263
*                                 /* OPNAGL                          */
*              OPNOPTIN=ON;       /* INDICATE - INPUT FILE           */
*              OPNOPTBK=ON;       /* INDICATE - CI PROCESSING        */
*              OPNOPTCR=ON;       /* INDICATE - ADDRESSED            */
*                                 /*            PROCESSING           */
*              OPNOPTDR=ON;       /* INDICATE - DIRECT               */
         OI    OPNOPTIN(@14),B'10010110'                           1267
*                                 /*            PROCESSING           */
*              OPNTYPRA=ON;       /* INDICATE CRA DATA SET           */
         OI    OPNTYPRA(@14),B'00001000'                           1268
*              OPNDSOAM=ON;       /* INDICATE DATA SET IS VSAM       */
         OI    OPNDSOAM(@14),B'10000000'                           1269
*              END;               /*                                 */
*          END;                   /*                                 */
*                                                                  1271
*        /************************************************************/
*        /*                                                          */
*        /*    POINT AT THE OLD OPNAGL USED LAST TIME SO IT          */
*        /*    CAN BE REUSED                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  1272
*        ELSE OPNPTR=CRVOPNAG;    /* POINT AT THE OLD OPNAGL         */
         B     @RC01254                                            1272
@RF01254 MVC   OPNPTR(4),CRVOPNAG(CRVEBASE)                        1272
*      /**************************************************************/
*      /*                                                            */
*      /*    CHECK TO SEE IF THERE HAS BEEN AN ERROR TO NOW          */
*      /*                                                            */
*      /**************************************************************/
*                                                                  1273
*      IF ERRNO^=ERCDNRML         /* IF THERE IS AN ERROR            */
*        THEN;                    /* THEN: CONTINUE                  */
*                                                                  1273
@RC01254 LTR   ERRNO,ERRNO                                         1273
         BNZ   @RT01273                                            1273
*        /************************************************************/
*        /*                                                          */
*        /*    FILL IN THE VALUES PASSED BY THE CALLER               */
*        /*                                                          */
*        /************************************************************/
*                                                                  1275
*        ELSE DO;                 /* ELSE:                           */
*          OPNIOC=ADDR(IOCSPTR);  /* SET UP ADDRESSABILITY TO        */
         L     @14,OPNPTR                                          1276
         LA    @07,IOCSPTR                                         1276
         ST    @07,OPNIOC(,@14)                                    1276
*                                 /* THE IOCSTR                      */
*          OPNDDN=ADDR(CRADDPTR(OPARM4)->CRADDVAL);                1277
         L     @07,@PC00017                                        1277
         L     @07,OPARM4(,@07)                                    1277
         SLA   @07,2                                               1277
         L     @06,@PC00001+4                                      1277
         L     @01,FDTPTR+16(,@06)                                 1277
         AL    @01,@CF01392                                        1277
         L     @01,CRADDPTR(@07,@01)                               1277
         LA    @07,CRADDVAL(,@01)                                  1277
         ST    @07,OPNDDN(,@14)                                    1277
*                                 /* POINT AT DDNAME                 */
*          IF ADDR(MRPW)=NULLPTR  /* IF NO PASSWORD PROVIDED         */
*            THEN OPNPWA=NULLPTR; /* THEN: SET NO PASSWORD           */
         SLR   @07,@07                                             1278
         C     @07,FDTPTR+36(,@06)                                 1278
         BNE   @RF01278                                            1278
         ST    @07,OPNPWA(,@14)                                    1279
*            ELSE OPNPWA=ADDR(MRPWVAL);                            1280
         B     @RC01278                                            1280
@RF01278 L     @14,@PC00001+4                                      1280
         L     @14,FDTPTR+36(,@14)                                 1280
         LA    @14,MRPWVAL(,@14)                                   1280
         L     @01,OPNPTR                                          1280
         ST    @14,OPNPWA(,@01)                                    1280
*                                 /* ELSE: POINT AT PASS WORD        */
*                                                                  1281
*          /**********************************************************/
*          /*                                                        */
*          /*    DO THE DESIRED OPEN FUNCTION FOR THIS CRA           */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1281
*          IF OPARM5=CRADS        /* IF OPEN AS DATA SET             */
*            THEN CALL IDCIOOP0 (GDTTBL,OPNAGL,0);                 1281
@RC01278 L     @14,@PC00017+4                                      1281
         CLC   OPARM5(1,@14),CRADS                                 1281
         BNE   @RF01281                                            1281
         L     @14,@PC00001                                        1282
         ST    @14,@AL00001                                        1282
         L     @01,OPNPTR                                          1282
         ST    @01,@AL00001+4                                      1282
         LA    @07,@CF00116                                        1282
         ST    @07,@AL00001+8                                      1282
         MVI   @AL00001+8,X'80'                                    1282
         L     @15,GDTOPN(,@14)                                    1282
         LA    @01,@AL00001                                        1282
         BALR  @14,@15                                             1282
*                                 /* THEN: OPEN AS DATA SET          */
*            ELSE CALL IDCIOOP0 (GDTTBL,OPNAGL,CRVCRAPL);          1283
         B     @RC01281                                            1283
@RF01281 L     @14,@PC00001                                        1283
         ST    @14,@AL00001                                        1283
         L     @01,OPNPTR                                          1283
         ST    @01,@AL00001+4                                      1283
         L     @01,CRVBASE                                         1283
         LA    @07,CRVCRAPL(,@01)                                  1283
         ST    @07,@AL00001+8                                      1283
         MVI   @AL00001+8,X'80'                                    1283
         L     @15,GDTOPN(,@14)                                    1283
         LA    @01,@AL00001                                        1283
         BALR  @14,@15                                             1283
*                                 /* ELSE: OPEN AS CATALOG           */
*          CRVIOSTR=IOCSPTR;      /* SAVE ADDRESS OF THE IOCSTR      */
@RC01281 L     @14,IOCSPTR                                         1284
         ST    @14,CRVIOSTR(,CRVEBASE)                             1284
*                                 /* FOR LATTER USE                  */
*          /**********************************************************/
*          /*                                                        */
*          /*    CHECK TO SEE IF THE CRA WAS SUCCESSFULLY            */
*          /*    OPENED                                              */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1285
*          IF  IOCMSGOP=ON        /* IF THE DATA SET IS OPENED       */
*                                                                  1285
*            /********************************************************/
*            /*                                                      */
*            /*    CHECK TO SEE IF THE OWNING CATALOG IS             */
*            /*    CORRECT                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1285
*            THEN DO;             /* THEN:                           */
         TM    IOCMSGOP(@14),B'00100000'                           1285
         BNO   @RF01285                                            1285
*              CALL IDCIOVY0 (GDTTBL,IOCSPTR);                     1287
         L     @14,@PC00001                                        1287
         ST    @14,@AL00001                                        1287
         LA    @07,IOCSPTR                                         1287
         ST    @07,@AL00001+4                                      1287
         MVI   @AL00001+4,X'80'                                    1287
         L     @15,GDTVFY(,@14)                                    1287
         LA    @01,@AL00001                                        1287
         BALR  @14,@15                                             1287
*                                 /* VERIFY THE CRA                  */
*              IF REG15=LASTCC00  /* IF THE VERIFY IS CORRECT        */
*                THEN CALL CKCATNM (OPARM4);                       1288
         LTR   REG15,REG15                                         1288
         BNZ   @RF01288                                            1288
         L     @14,@PC00017                                        1289
         ST    @14,@AL00001                                        1289
         LA    @01,@AL00001                                        1289
         BAL   @14,CKCATNM                                         1289
*                                 /* THEN: CHECK TO SEE IF THE       */
*                                 /*       OWNING CATALOG IS         */
*                                 /*       CORRECT                   */
*                ELSE DO;         /* ELSE:                           */
         B     @RC01288                                            1290
@RF01288 DS    0H                                                  1291
*                  RSNCD=RSNCD01; /* SET THE REASON CODE             */
         MVC   RSNCD(2),@CC00916                                   1291
*                  ERRNO=ERCDIOER;/* INDICATE VERIFY WAS NOT         */
         LA    ERRNO,12                                            1292
*                                 /* SUCCESSFUL                      */
*                  END;           /*                                 */
*              END;               /*                                 */
*                                                                  1294
*            /********************************************************/
*            /*                                                      */
*            /*    INDICATE THAT THE OPEN DID NOT TAKE PLACE AS      */
*            /*    WAS DESIRED                                       */
*            /*                                                      */
*            /********************************************************/
*                                                                  1295
*            ELSE DO;             /* ELSE:                           */
         B     @RC01285                                            1295
@RF01285 DS    0H                                                  1296
*              RSNCD=RSNCD02;     /* SET THE REASON CODE             */
         MVC   RSNCD(2),@CC00918                                   1296
*              ERRNO=ERCDDNTO;    /* INDICATE THAT THE OPEN WAS      */
         LA    ERRNO,8                                             1297
*                                 /* UNSUCCESSFUL                    */
*              END;               /*                                 */
*          END;                   /*                                 */
*      END;                       /*                                 */
*                                                                  1300
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1301
*  END OPEN;                      /* END OF PROCEDURE                */
@EL00017 DS    0H                                                  1302
@EF00017 DS    0H                                                  1302
@ER00017 LM    @14,@01,@SA00017                                    1302
         LM    @03,@12,@SA00017+16                                 1302
         BR    @14                                                 1302
@PB00017 DS    0H                                                  1303
*  GEN (EJECT);                                                    1303
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    OPENCRA                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS IS THE DRIVER TO OPEN THE CRA AND CONSTRUCT THE        */
*  /*    TABLES THAT ARE REQUIRED. THE FOLLOWING TABLES AREA         */
*  /*    CONSTRUCTED BY ROUTINES THAT ARE CALLED:                    */
*  /*        OPNAGL                                                  */
*  /*        IOCSTR                                                  */
*  /*        VTT                                                     */
*  /*        CTT                                                     */
*  /*        DIREC                                                   */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. THE CRV MUST BE CONSTRUCTED.                             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1304
*OPENCRA: PROCEDURE (PARM2,PARM4,PARM5);                           1304
*                                                                  1304
         B     @PB00018                                            1304
OPENCRA  STM   @14,@02,@SA00018                                    1304
         STM   @04,@12,@SA00018+20                                 1304
         MVC   @PC00018(12),0(@01)                                 1304
*  /******************************************************************/
*  /*                                                                */
*  /*     THIS IS THE DESCRIPTION OF THE INCOMING PARAMETERS         */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1305
*  DCL PARM2    CHAR(1);          /* O=OPEN SPECIFIED CRV            */
*                                 /* C=CLOSE SPECIFIED CRV           */
*  DCL PARM4    FIXED(31);        /* INDEX INTO THE CRV FOR THE      */
*  DCL PARM5    CHAR(1);          /* CRA OPEN TYPE                   */
*                                                                  1307
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1308
*  OLDERID2 = NEWERID2;                                            1308
         L     @04,@PC00001                                        1308
         L     @15,GDTTR2(,@04)                                    1308
         MVC   @TS00001(95),NEWERID2(@15)                          1308
         MVC   OLDERID2(95,@15),@TS00001                           1308
*  NEWID2='RC91';                                                  1309
         MVC   NEWID2(4,@15),@CC01319                              1309
*  IF GDTDBG = NULLPTR                                             1310
*    THEN;                                                         1310
         ICM   @15,15,GDTDBG(@04)                                  1310
         BZ    @RT01310                                            1310
*    ELSE                                                          1312
*      CALL IDCDB010 (GDTTBL,'RC91');                              1312
         L     @04,@PC00001                                        1312
         ST    @04,@AL00001                                        1312
         LA    @15,@CC01319                                        1312
         ST    @15,@AL00001+4                                      1312
         MVI   @AL00001+4,X'80'                                    1312
         L     @15,GDTDBG(,@04)                                    1312
         LA    @01,@AL00001                                        1312
         BALR  @14,@15                                             1312
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE THE RETURN CODE FOR FUNCTION                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1313
*  ERRNO=ERCDNRML;                /* INITIALIZE INTERNAL ERROR       */
@RT01310 SLR   ERRNO,ERRNO                                         1313
*                                 /* CODE                            */
*                                                                  1314
*  /******************************************************************/
*  /*                                                                */
*  /*    SET UP THE ADDRESSABILITY TO THE CORRECT ENTRY              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1314
*  CRVEBASE=ADDR(CRVENTRY(PARM4));/* POINT AT THE CORRECT ENTRY      */
*                                                                  1314
         L     @04,@PC00018+4                                      1314
         L     @15,PARM4(,@04)                                     1314
         MH    @15,@CH00954                                        1314
         L     CRVEBASE,CRVBASE                                    1314
         LA    CRVEBASE,CRVENTRY-28(@15,CRVEBASE)                  1314
*  /******************************************************************/
*  /*                                                                */
*  /*    INDICATE THE BUFFER POOL FOR FIELD MANAGEMENT NEEDS TO      */
*  /*    BE REFORMATED BEFORE USE                                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1315
*  BUFORMAT=OFF;                  /* INDICATE BUFFER POOL NEEDS      */
         NI    BUFORMAT(BUFSPTR),B'01111111'                       1315
*                                 /* TO BE FORMATED                  */
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE OPEN FUNCTION IF REQUESTED                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1316
*  IF PARM2=OPENFUNC              /* IF OPEN FUNCTION REQUESTED      */
*    THEN DO;                     /* THEN:                           */
         L     @15,@PC00018                                        1316
         CLI   PARM2(@15),C'O'                                     1316
         BNE   @RF01316                                            1316
*      CALL OPEN(PARM4,PARM5);    /* ATTEMPT TO OPEN THE CRA         */
         ST    @04,@AL00001                                        1318
         L     @04,@PC00018+8                                      1318
         ST    @04,@AL00001+4                                      1318
         LA    @01,@AL00001                                        1318
         BAL   @14,OPEN                                            1318
*                                 /* AND CHECK CATALOG NAME          */
*      CALL TIMESTMP(PARM4);      /* PLACE TIMESTAMP FOR VOLUME      */
         L     @04,@PC00018+4                                      1319
         ST    @04,@AL00001                                        1319
         LA    @01,@AL00001                                        1319
         BAL   @14,TIMESTMP                                        1319
*                                 /* IN THE TABLE                    */
*      CALL SCANCRA(PARM4);       /* BUILD THE NAME TABLE            */
         L     @04,@PC00018+4                                      1320
         ST    @04,@AL00001                                        1320
         LA    @01,@AL00001                                        1320
         BAL   @14,SCANCRA                                         1320
*      CALL DIRECT;               /* BUILD THE DIRECTORY ENTRY       */
         BAL   @14,DIRECT                                          1321
*      CALL ERRCK(PARM4);         /* PROCESS ANY ERRORS              */
         L     @04,@PC00018+4                                      1322
         ST    @04,@AL00001                                        1322
         LA    @01,@AL00001                                        1322
         BAL   @14,ERRCK                                           1322
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
@RF01316 DS    0H                                                  1325
*  /*****************************************************************/
*  /*                                                                */
*  /*    HANDLE THE CLOSE FUNCTION IF REQUESTED                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1325
*  IF PARM2=CLOSFUNC              /* IF CLOSE FUNCTION IS            */
*                                 /* REQUESTED                       */
*    THEN DO;                     /* THEN:                           */
         L     @04,@PC00018                                        1325
         CLI   PARM2(@04),C'C'                                     1325
         BNE   @RF01325                                            1325
*      CALL IDCIOCL0 (GDTTBL,CRVIOSTR);/*                          1327
*                                    CLOSE THE DESIRED ACB           */
         L     @04,@PC00001                                        1327
         ST    @04,@AL00001                                        1327
         LA    @15,CRVIOSTR(,CRVEBASE)                             1327
         ST    @15,@AL00001+4                                      1327
         MVI   @AL00001+4,X'80'                                    1327
         L     @15,GDTCLS(,@04)                                    1327
         LA    @01,@AL00001                                        1327
         BALR  @14,@15                                             1327
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1329
@RF01325 DS    0H                                                  1330
*  /******************************************************************/
*  /*                                                                */
*  /*    EXIT FROM THIS ROUTINE                                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1330
*  RETURN CODE(ERRNO);            /* RETURN THE ERROR CODE           */
*                                                                  1330
         LR    @15,ERRNO                                           1330
         L     @14,@SA00018                                        1330
         LM    @00,@02,@SA00018+8                                  1330
         LM    @04,@12,@SA00018+20                                 1330
         BR    @14                                                 1330
*  END OPENCRA;                   /* END OF PROCEDURE                */
@PB00018 DS    0H                                                  1332
*  GEN (EJECT);                                                    1332
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    SCANCRA                                                     */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    SCAN THE CRA AND CONSTRUCT THE CTT.  IF ALL IS              */
*  /*    SPECIFIED THEN CONSTRUCT THE NAME CHAIN.  IF ENTRIES        */
*  /*    IS SPECIFIED THEN MARK THE NAME CHAIN FOUND SO THAT         */
*  /*    IT IS KNOW IF THE NAME IS PRESENT.                          */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. CRV MUST BE CONSTRUCTED.                                 */
*  /*                                                                */
*  /*    2. CRA MUST BE OPENED.                                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1333
*SCANCRA: PROCEDURE (SPARM4);                                      1333
*                                                                  1333
         B     @PB00019                                            1333
SCANCRA  STM   @14,@01,@SA00019                                    1333
         STM   @03,@12,@SA00019+16                                 1333
         MVC   @PC00019(4),0(@01)                                  1333
*  DCL SPARM4      FIXED(31);     /* INDEX INTO CRV                  */
*  DCL SIZE        FIXED(31);     /* SIZE OF CTT TO GET              */
*  DCL INDEX       FIXED(31);     /* INDEX COUNTER TO SCAN CRA       */
*                                                                  1336
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1337
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1338
*  OLDERID2 = NEWERID2;                                            1338
         L     @14,@PC00001                                        1338
         L     @07,GDTTR2(,@14)                                    1338
         MVC   @TS00001(95),NEWERID2(@07)                          1338
         MVC   OLDERID2(95,@07),@TS00001                           1338
*  NEWID2='RC95';                                                  1339
         MVC   NEWID2(4,@07),@CC01329                              1339
*  IF GDTDBG = NULLPTR                                             1340
*    THEN;                                                         1340
         ICM   @07,15,GDTDBG(@14)                                  1340
         BZ    @RT01340                                            1340
*    ELSE                                                          1342
*      CALL IDCDB010 (GDTTBL,'RC95');                              1342
*                                                                  1342
         L     @14,@PC00001                                        1342
         ST    @14,@AL00001                                        1342
         LA    @07,@CC01329                                        1342
         ST    @07,@AL00001+4                                      1342
         MVI   @AL00001+4,X'80'                                    1342
         L     @15,GDTDBG(,@14)                                    1342
         LA    @01,@AL00001                                        1342
         BALR  @14,@15                                             1342
*  /******************************************************************/
*  /*                                                                */
*  /*    CHECK TO SEE IF THERE IS ANY NEED TO SCAN THE CRA           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1343
*  IF ERRNO=ERCDNRML & CRVNAME=OFF/* IF THERE HAS BEEN NO ERROR      */
*                                 /* AND NAMES HAVE NOT BEEN         */
*                                 /* PROCESSED FOR THIS CRA          */
*                                                                  1343
*    /****************************************************************/
*    /*                                                              */
*    /*    SCAN THE CRA BECAUSE IT HAS NOT BEEN DONE BEFORE          */
*    /*    AND CONSTRUCT A CTT FOR IT                                */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1343
*    THEN DO;                     /* THEN:                           */
@RT01340 LTR   ERRNO,ERRNO                                         1343
         BNZ   @RF01343                                            1343
         TM    CRVNAME(CRVEBASE),B'00100000'                       1343
         BNZ   @RF01343                                            1343
*      IOCRBA=CONCINO3;           /* PLACE RBA OF CI NUMBER 3        */
         L     @14,IOCSPTR                                         1345
         MVC   IOCRBA(4,@14),@CF01068                              1345
*      CALL IDCIOGT0 (GDTTBL,CRVIOSTR);                            1346
         L     @14,@PC00001                                        1346
         ST    @14,@AL00001                                        1346
         LA    @07,CRVIOSTR(,CRVEBASE)                             1346
         ST    @07,@AL00001+4                                      1346
         MVI   @AL00001+4,X'80'                                    1346
         L     @15,GDTGET(,@14)                                    1346
         LA    @01,@AL00001                                        1346
         BALR  @14,@15                                             1346
*                                 /* READ THE DESIRED RECORD         */
*      IF REG15=LASTCC00          /* IF THE RECORD WAS OBTAINED      */
*        THEN DO;                 /* THEN:                           */
         LTR   REG15,REG15                                         1347
         BNZ   @RF01347                                            1347
*          SIZE=RECNEXCI*LENGTH(CTTENTRY)+LENGTH(CTT);             1349
         L     @14,IOCSPTR                                         1349
         L     @14,IOCDAD(,@14)                                    1349
         SLR   @07,@07                                             1349
         ICM   @07,7,RECNEXCI(@14)                                 1349
         SLA   @07,2                                               1349
         AH    @07,@CH00043                                        1349
         ST    @07,SIZE                                            1349
*                                 /* CALCULATE THE SIZE OF THE       */
*                                 /* TRANSLATE TABLE NEEDED          */
*          CALL IDCSAGP0(GDTTBL,SIZE,CRVADCTT,COREID5,SETZERO);    1350
         L     @14,@PC00001                                        1350
         ST    @14,@AL00001                                        1350
         LA    @07,SIZE                                            1350
         ST    @07,@AL00001+4                                      1350
         LA    @07,CRVADCTT(,CRVEBASE)                             1350
         ST    @07,@AL00001+8                                      1350
         LA    @07,@CC00837                                        1350
         ST    @07,@AL00001+12                                     1350
         LA    @07,SETZERO                                         1350
         ST    @07,@AL00001+16                                     1350
         MVI   @AL00001+16,X'80'                                   1350
         L     @15,GDTGPL(,@14)                                    1350
         LA    @01,@AL00001                                        1350
         BALR  @14,@15                                             1350
*                                 /* GET SPACE FOR THE CTT           */
*          IF REG15=LASTCC00      /* IF THERE IS NO ERROR            */
*            THEN DO;             /* THEN:                           */
*                                                                  1351
         LTR   REG15,REG15                                         1351
         BNZ   @RF01351                                            1351
*              /******************************************************/
*              /*                                                    */
*              /*    PREPARE THE IOCSTR TO ALLOW SCANNING OF THE     */
*              /*    CRA                                             */
*              /*                                                    */
*              /******************************************************/
*                                                                  1353
*              CTTENTNO=RECNEXCI-BEGINCI;                          1353
         L     @14,CRVADCTT(,CRVEBASE)                             1353
         L     @04,IOCSPTR                                         1353
         L     @01,IOCDAD(,@04)                                    1353
         SLR   @07,@07                                             1353
         ICM   @07,7,RECNEXCI(@01)                                 1353
         LR    @06,@07                                             1353
         SH    @06,@CH00035                                        1353
         ST    @06,CTTENTNO(,@14)                                  1353
*                                 /* INITIALIZE NUMBER OF            */
*                                 /* ENTRIES IN TABLE                */
*              COUNT=RECNEXCI-1;  /* PICK UP THE NUMBER OF CI'S      */
         BCTR  @07,0                                               1354
         LR    COUNT,@07                                           1354
*                                 /* THAT MUST BE SCANED             */
*              IOCRBA=CONCINO9;   /* SET CI NUMBER TO 9              */
         MVC   IOCRBA(4,@04),@CF01070                              1355
*              CALL IDCIOPO0 (GDTTBL,CRVIOSTR);                    1356
         L     @14,@PC00001                                        1356
         ST    @14,@AL00001                                        1356
         LA    @04,CRVIOSTR(,CRVEBASE)                             1356
         ST    @04,@AL00001+4                                      1356
         MVI   @AL00001+4,X'80'                                    1356
         L     @15,GDTPOS(,@14)                                    1356
         LA    @01,@AL00001                                        1356
         BALR  @14,@15                                             1356
*                                 /* POINT AT CI NUMBER 9            */
*              IOCCHPDR=OFF;      /* INSURE THAT BOTH BITS ARE       */
*                                 /* NOT ON                          */
*              IOCCHPSQ=ON;       /* INDICATE THAT A CHANGE          */
         L     @14,IOCSPTR                                         1358
         OI    IOCCHPSQ(@14),B'10000000'                           1358
         NI    IOCCHPDR(@14),B'10111111'                           1358
*                                 /* FROM DIRECT TO SEQUENTIAL       */
*                                 /* PROCESSING IS REQUIRED          */
*              /******************************************************/
*              /*                                                    */
*              /*    READ ALL OF THE CRA CI'S TO GET THE CRA TO      */
*              /*    CATALOG TRANSLATION VALUES                      */
*              /*                                                    */
*              /******************************************************/
*                                                                  1359
*              DO INDEX=BEGINCI TO COUNT WHILE ERRNO=ERCDNRML;     1359
         LA    INDEX,9                                             1359
         B     @DE01359                                            1359
@DL01359 LTR   ERRNO,ERRNO                                         1359
         BNZ   @DC01359                                            1359
*                                 /* LOOP THROUGH ALL THE CRA        */
*                                 /* RECORDS TO GET THE CATALOG      */
*                                 /* CI NUMBER                       */
*                CALL IDCIOGT0 (GDTTBL,CRVIOSTR);                  1360
         L     @14,@PC00001                                        1360
         ST    @14,@AL00001                                        1360
         LA    @07,CRVIOSTR(,CRVEBASE)                             1360
         ST    @07,@AL00001+4                                      1360
         MVI   @AL00001+4,X'80'                                    1360
         L     @15,GDTGET(,@14)                                    1360
         LA    @01,@AL00001                                        1360
         BALR  @14,@15                                             1360
*                                 /* GET THE NEXT RECORD             */
*                IF REG15=LASTCC00/* IF THE RECORD WAS OBTAINED      */
*                                                                  1361
*                  /**************************************************/
*                  /*                                                */
*                  /*    HANDLE CONSTRUCTION OF THE TABLE FOR A      */
*                  /*    CI THAT IS OK                               */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1361
*                  THEN DO;       /* THEN:                           */
         LTR   REG15,REG15                                         1361
         BNZ   @RF01361                                            1361
*                    IF RECTYPE=FREETYPE                           1363
*                                 /* IF THIS IS A FREE RECORD        */
*                      THEN CTTCATCI(INDEX-BEGINCI+1)=INVALCI;     1363
         L     @14,IOCSPTR                                         1363
         L     @14,IOCDAD(,@14)                                    1363
         CLI   RECTYPE(@14),C'F'                                   1363
         BNE   @RF01363                                            1363
         LR    @14,INDEX                                           1364
         SLA   @14,2                                               1364
         L     @01,CRVADCTT(,CRVEBASE)                             1364
         ALR   @01,@14                                             1364
         AL    @01,@CF01411                                        1364
         MVC   CTTCATCI-5(3,@01),INVALCI                           1364
*                                 /* THEN: INVALIDATE THE CI         */
*                                 /*       NUMBER                    */
*                      ELSE CTTCATCI(INDEX-BEGINCI+1)=RECCI;       1365
         B     @RC01363                                            1365
@RF01363 LR    @14,INDEX                                           1365
         SLA   @14,2                                               1365
         L     @01,CRVADCTT(,CRVEBASE)                             1365
         L     @07,IOCSPTR                                         1365
         L     @07,IOCDAD(,@07)                                    1365
         ALR   @01,@14                                             1365
         AL    @01,@CF01411                                        1365
         MVC   CTTCATCI-5(3,@01),RECCI(@07)                        1365
*                                 /* ELSE: PLACE THE CATALOG         */
*                                 /*       CI NUMBER                 */
*                    CTTENTYP(INDEX-BEGINCI+1)=RECTYPE;            1366
@RC01363 LR    @14,INDEX                                           1366
         SLA   @14,2                                               1366
         L     @01,CRVADCTT(,CRVEBASE)                             1366
         ALR   @01,@14                                             1366
         AL    @01,@CF01412                                        1366
         L     @14,IOCSPTR                                         1366
         L     @14,IOCDAD(,@14)                                    1366
         MVC   CTTENTYP-4(1,@01),RECTYPE(@14)                      1366
*                                 /* PLACE THE RECORD TYPE           */
*                    CALL NAMETABL (SPARM4);                       1367
         L     @14,@PC00019                                        1367
         ST    @14,@AL00001                                        1367
         LA    @01,@AL00001                                        1367
         BAL   @14,NAMETABL                                        1367
*                                 /* GO TO BUILD THE NAME TABLE      */
*                    END;         /*                                 */
*                                                                  1368
*                  /**************************************************/
*                  /*                                                */
*                  /*    HANDLE CONSTRUCTION OF THE TABLE FOR A      */
*                  /*    CI THAT PRODUCED AN I/O ERROR               */
*                  /*                                                */
*                  /**************************************************/
*                                                                  1369
*                  ELSE DO;       /* ELSE:                           */
         B     @RC01361                                            1369
@RF01361 DS    0H                                                  1370
*                    RSNCD=RSNCD06;                                1370
         MVC   RSNCD(2),@CC00926                                   1370
*                                 /* INDICATE THE ERROR TYPE         */
*                    IF CRVCTTER=ON                                1371
*                                 /* IF ERROR HAS BEEN PRINTED       */
*                      THEN;      /* THEN: CONTINUE                  */
         TM    CRVCTTER(CRVEBASE),B'00000100'                      1371
         BO    @RT01371                                            1371
*                      ELSE DO;   /* ELSE:                           */
*                        CALL MESSAGE(2,MSGID22,VTTVOLSR(SPARM4),  1374
*                                     LENGTH(VTTVOLSR),RSNCD,      1374
*                                     LENGTH(RSNCD));              1374
         MVC   @AL00001(24),@AL01374                               1374
         L     @14,@PC00019                                        1374
         L     @14,SPARM4(,@14)                                    1374
         MH    @14,@CH00763                                        1374
         L     @01,CRVBASE                                         1374
         L     @01,CRVCRAPL(,@01)                                  1374
         L     @01,ACCVOLTT(,@01)                                  1374
         AL    @01,@CF01391                                        1374
         LA    @14,VTTVOLSR-4(@14,@01)                             1374
         ST    @14,@AL00001+8                                      1374
         LA    @14,RSNCD                                           1374
         ST    @14,@AL00001+16                                     1374
         LA    @01,@AL00001                                        1374
         BAL   @14,MESSAGE                                         1374
*                                 /* PRINT CTT I/O ERROR             */
*                        CTTCATCI(INDEX-BEGINCI+1)=INVALCI;        1375
         LR    @14,INDEX                                           1375
         SLA   @14,2                                               1375
         L     @07,CRVADCTT(,CRVEBASE)                             1375
         ST    @14,@TF00001                                        1375
         ALR   @14,@07                                             1375
         AL    @14,@CF01411                                        1375
         MVC   CTTCATCI-5(3,@14),INVALCI                           1375
*                                 /* SET INVALID CI NUMBER           */
*                        CTTENTYP(INDEX-BEGINCI+1)=FREETYPE;       1376
         AL    @07,@TF00001                                        1376
         AL    @07,@CF01412                                        1376
         MVI   CTTENTYP-4(@07),C'F'                                1376
*                                 /* SET RECORD TYPE                 */
*                        END;     /*                                 */
*                    END;         /*                                 */
@RT01371 DS    0H                                                  1379
*                END;             /*                                 */
@RC01361 AL    INDEX,@CF00220                                      1379
@DE01359 CR    INDEX,COUNT                                         1379
         BNH   @DL01359                                            1379
@DC01359 DS    0H                                                  1380
*              /******************************************************/
*              /*                                                    */
*              /*    RETURN THE IOCSTR TO DIRECT MODE FOR ALL        */
*              /*    OTHER PROCESSING                                */
*              /*                                                    */
*              /******************************************************/
*                                                                  1380
*              IOCCHPDR=ON;       /* RETURN THE IOCSTR TO THE        */
         L     @14,IOCSPTR                                         1380
         OI    IOCCHPDR(@14),B'01000000'                           1380
*                                 /* DIRECT MODE                     */
*              END;               /*                                 */
*                                                                  1381
*            /********************************************************/
*            /*                                                      */
*            /*    HANDLE NOT BEING ABLE TO GET STORAGE FOR          */
*            /*    THE CTT                                           */
*            /*                                                      */
*            /********************************************************/
*                                                                  1382
*            ELSE DO;             /* ELSE:                           */
         B     @RC01351                                            1382
@RF01351 DS    0H                                                  1383
*              ERRNO=ERCDNSTR;    /* INDICATE NO CORE                */
         LA    ERRNO,28                                            1383
*              CORE=BAD;          /* INDICATE CORE MESSAGE           */
         MVC   CORE(1),BAD                                         1384
*              END;               /*                                 */
*          END;                   /*                                 */
*                                                                  1386
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE NOT BEING ABLE TO DETURMINE THE SIZE OF        */
*        /*    THE CTT TO BUILD                                      */
*        /*                                                          */
*        /************************************************************/
*                                                                  1387
*        ELSE DO;                 /* ELSE:                           */
         B     @RC01347                                            1387
@RF01347 DS    0H                                                  1388
*          RSNCD=RSNCD05;         /* INDICATE THE ERROR TYPE         */
         MVC   RSNCD(2),@CC00924                                   1388
*          ERRNO=ERCDIOER;        /* INDICATE AN I/O ERROR           */
         LA    ERRNO,12                                            1389
*          END;                   /*                                 */
*      CRVNAME=ON;                /* INDICATE NAMES HAVE BEEN        */
@RC01347 OI    CRVNAME(CRVEBASE),B'00100000'                       1391
*                                 /* PROCESSED FOR THIS CRA          */
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1393
*                                                                  1393
@RF01343 DS    0H                                                  1394
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1394
*  END SCANCRA;                   /* END OF PROCEDURE                */
@EL00019 DS    0H                                                  1395
@EF00019 DS    0H                                                  1395
@ER00019 LM    @14,@01,@SA00019                                    1395
         LM    @03,@12,@SA00019+16                                 1395
         BR    @14                                                 1395
@PB00019 DS    0H                                                  1396
*  GEN (EJECT);                                                    1396
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    SUBSP                                                       */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    PROVIDES SMALL PIECES OF STORAGE (SMALLER THAN 2000         */
*  /*    BYTES) TO AVOID MANY CALLS TO STORAGE ALLOCATION.           */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. MUST DO INITIALIZATION CALL BEFORE OTHER FUNCTIONS       */
*  /*       ARE USED.                                                */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1397
*SUBSP: PROCEDURE (SPCTYPE,SPSIZ,SPADR);                           1397
*                                                                  1397
         B     @PB00020                                            1397
SUBSP    STM   @14,@12,@SA00020                                    1397
         MVC   @PC00020(12),0(@01)                                 1397
*  DCL SPCTYPE  CHAR(1);          /* TYPE OF REQUEST                 */
*  DCL SPSIZ    PTR(31);          /* SIZE OF AREA DESIRED            */
*  DCL SPADR    PTR(31);          /* ADDRESS OF AREA ALLOCATED       */
*                                                                  1400
*  DCL SPCSIZE      FIXED(31);    /* SIZE OF THE PRESENT AREA        */
*  DCL SPCSIZE1     FIXED(31);    /* SIZE OF PREVIOUS AREA           */
*  DCL SPCPTR       PTR(31);      /* ADDRESS OF PRESENT AREA         */
*  DCL SPCPTR1      PTR(31);      /* ADDRESS OF PREVIOUS AREA        */
*  DCL SPCAREA      CHAR(2032) BASED;                              1405
*                                 /* SHAPE OF THE AREA               */
*                                                                  1406
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1406
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1407
*  OLDERID2 = NEWERID2;                                            1407
         L     @14,@PC00001                                        1407
         L     @07,GDTTR2(,@14)                                    1407
         MVC   @TS00001(95),NEWERID2(@07)                          1407
         MVC   OLDERID2(95,@07),@TS00001                           1407
*  NEWID2='RC88';                                                  1408
         MVC   NEWID2(4,@07),@CC01345                              1408
*  IF GDTDBG = NULLPTR                                             1409
*    THEN;                                                         1409
         ICM   @07,15,GDTDBG(@14)                                  1409
         BZ    @RT01409                                            1409
*    ELSE                                                          1411
*      CALL IDCDB010 (GDTTBL,'RC88');                              1411
*                                                                  1411
         L     @14,@PC00001                                        1411
         ST    @14,@AL00001                                        1411
         LA    @07,@CC01345                                        1411
         ST    @07,@AL00001+4                                      1411
         MVI   @AL00001+4,X'80'                                    1411
         L     @15,GDTDBG(,@14)                                    1411
         LA    @01,@AL00001                                        1411
         BALR  @14,@15                                             1411
*  /******************************************************************/
*  /*                                                                */
*  /*    INITIALIZE TO PREFORM THE FUNCTION DESIRED                  */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1412
*  REG15=LASTCC00;                /* SET OK SPACE RETURN CODE        */
@RT01409 SLR   REG15,REG15                                         1412
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE ALLOCATION OF SMALL PIECES OF STORAGE            */
*  /*    ASSOCIATED WITH THE NAME TABLE                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1413
*  IF SPCTYPE=GETTYPE             /* IF SPACE DESIRED                */
*    THEN DO;                     /* THEN:                           */
         L     @14,@PC00020                                        1413
         CLI   SPCTYPE(@14),C'G'                                   1413
         BNE   @RF01413                                            1413
*      IF SPCSIZE>=SPSIZ          /* IF THERE IS ENOUGH SPACE        */
*        THEN;                    /* THEN: CONTINUE                  */
         L     @14,@PC00020+4                                      1415
         L     @07,SPCSIZE                                         1415
         C     @07,SPSIZ(,@14)                                     1415
         BNL   @RT01415                                            1415
*        ELSE DO;                 /* ELSE:                           */
*          SPCSIZE=LENGTH(SPCAREA);                                1418
         MVC   SPCSIZE(4),@CF01344                                 1418
*                                 /* SET THE NEW SIZE                */
*          CALL IDCSAGP0 (GDTTBL,SPCSIZE,SPCPTR,COREID2,SETZERO);  1419
         L     @14,@PC00001                                        1419
         ST    @14,@AL00001                                        1419
         LA    @07,SPCSIZE                                         1419
         ST    @07,@AL00001+4                                      1419
         LA    @07,SPCPTR                                          1419
         ST    @07,@AL00001+8                                      1419
         LA    @07,@CC00831                                        1419
         ST    @07,@AL00001+12                                     1419
         LA    @07,SETZERO                                         1419
         ST    @07,@AL00001+16                                     1419
         MVI   @AL00001+16,X'80'                                   1419
         L     @15,GDTGPL(,@14)                                    1419
         LA    @01,@AL00001                                        1419
         BALR  @14,@15                                             1419
*                                 /* GET A NEW POOL OF SPACE         */
*          END;                   /*                                 */
*                                                                  1420
*      IF REG15^=LASTCC00         /* IF THERE IS NO SPACE            */
*        THEN CORE=BAD;           /* THEN: INDICATE CORE MESSAGE     */
@RT01415 LTR   REG15,REG15                                         1421
         BZ    @RF01421                                            1421
         MVC   CORE(1),BAD                                         1422
*        ELSE DO;                 /* ELSE:                           */
         B     @RC01421                                            1423
@RF01421 DS    0H                                                  1424
*          SPCPTR1=SPCPTR;        /* SAVE THE ADDRESS                */
         L     @14,SPCPTR                                          1424
         ST    @14,SPCPTR1                                         1424
*          SPCSIZE1=SPCSIZE;      /* SAVE THE SIZE                   */
         L     @07,SPCSIZE                                         1425
         ST    @07,SPCSIZE1                                        1425
*          SPADR=SPCPTR;          /* POINT AT NEXT AREA              */
         L     @06,@PC00020+8                                      1426
         ST    @14,SPADR(,@06)                                     1426
*          SPCPTR=SPCPTR+((SPSIZ+3)/4)*4;                          1427
         L     @06,@PC00020+4                                      1427
         LA    @00,3                                               1427
         AL    @00,SPSIZ(,@06)                                     1427
         SRDA  @00,32                                              1427
         D     @00,@CF00043                                        1427
         SLA   @01,2                                               1427
         ALR   @14,@01                                             1427
         ST    @14,SPCPTR                                          1427
*                                 /* POINT PAST THE AREA             */
*          SPCSIZE=SPCSIZE-((SPSIZ+3)/4)*4;                        1428
         SLR   @07,@01                                             1428
         ST    @07,SPCSIZE                                         1428
*                                 /* DECREMENT AREA SIZE             */
*          END;                   /*                                 */
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1431
@RF01413 DS    0H                                                  1432
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE RETURNING OF THE LAST USED BLOCK ONLY            */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1432
*  IF SPCTYPE=RETTYPE             /* IF RETURN SPECIFIED             */
*    THEN DO;                     /* THEN:                           */
@RC01413 L     @14,@PC00020                                        1432
         CLI   SPCTYPE(@14),C'R'                                   1432
         BNE   @RF01432                                            1432
*      SPCPTR=SPCPTR1;            /* RETURN ADDRESS                  */
         MVC   SPCPTR(4),SPCPTR1                                   1434
*      SPCSIZE=SPCSIZE1;          /* RETURN SIZE                     */
         MVC   SPCSIZE(4),SPCSIZE1                                 1435
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
@RF01432 DS    0H                                                  1438
*  /******************************************************************/
*  /*                                                                */
*  /*    HANDLE THE INITIALIZATION OF THE SUBSP FUNCTION             */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1438
*  IF SPCTYPE=INITYPE             /* IF INITIALIZE SPECIFIED         */
*    THEN SPCSIZE=0;              /* THEN: INITIALIZE THE SIZE       */
         L     @14,@PC00020                                        1438
         CLI   SPCTYPE(@14),C'I'                                   1438
         BNE   @RF01438                                            1438
         SLR   @14,@14                                             1439
         ST    @14,SPCSIZE                                         1439
*                                 /*       HELD VALUE                */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1440
@RF01438 DS    0H                                                  1441
*  RETURN CODE(REG15);            /* RETURN POSSIBLE ERROR CODE      */
*                                                                  1441
         L     @14,@SA00020                                        1441
         LM    @00,@12,@SA00020+8                                  1441
         BR    @14                                                 1441
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1442
*  END SUBSP;                     /* END OF PROCEDURE                */
@PB00020 DS    0H                                                  1444
*  GEN (EJECT);                                                    1444
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    SYNCH                                                       */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    CHECK TO SEE THAT THE NAME CHAIN THAT IS PRESENT FOR        */
*  /*    THIS CRV ENTRY CONTAINS ONLY ENTRIES THAT SHOULD            */
*  /*    BE EXPORTED IS FORCE IS NOT SUPPLIED.                       */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. CRV NEEDS TO BE CONSTRUCTED.                             */
*  /*                                                                */
*  /*    2. NAMCE CHAIN NEEDS TO BE CONSTRUCTED.                     */
*  /*                                                                */
*  /*    3. CI NUMBERS NEED TO BE FILLED IN IF THE ENTRY IS          */
*  /*       TO BE EXPORTED.                                          */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1445
*SYNCH: PROCEDURE (YPARM4);                                        1445
*                                                                  1445
         B     @PB00021                                            1445
SYNCH    STM   @14,@12,@SA00021                                    1445
         MVC   @PC00021(4),0(@01)                                  1445
*  /******************************************************************/
*  /*                                                                */
*  /*    INCOMING PARAMETERS FOR THIS ROUTINE                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1446
*  DCL YPARM4     FIXED(31);      /* INDEX INTO CRV                  */
*                                                                  1446
*  /******************************************************************/
*  /*                                                                */
*  /*    VARIABLES USED IN THIS ROUTINE                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1447
*  DCL SYIX1      FIXED(31);      /* GENERAL COUNTER                 */
*                                                                  1447
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1448
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1449
*  OLDERID2 = NEWERID2;                                            1449
         L     @14,@PC00001                                        1449
         L     @04,GDTTR2(,@14)                                    1449
         MVC   @TS00001(95),NEWERID2(@04)                          1449
         MVC   OLDERID2(95,@04),@TS00001                           1449
*  NEWID2='RC83';                                                  1450
         MVC   NEWID2(4,@04),@CC01352                              1450
*  IF GDTDBG = NULLPTR                                             1451
*    THEN;                                                         1451
         ICM   @04,15,GDTDBG(@14)                                  1451
         BZ    @RT01451                                            1451
*    ELSE                                                          1453
*      CALL IDCDB010 (GDTTBL,'RC83');                              1453
         L     @14,@PC00001                                        1453
         ST    @14,@AL00001                                        1453
         LA    @04,@CC01352                                        1453
         ST    @04,@AL00001+4                                      1453
         MVI   @AL00001+4,X'80'                                    1453
         L     @15,GDTDBG(,@14)                                    1453
         LA    @01,@AL00001                                        1453
         BALR  @14,@15                                             1453
*  /******************************************************************/
*  /*                                                                */
*  /*    POINT AT THE NAME CHAIN AND LOOP THROUGH ALL OF THE         */
*  /*    ENTRIES TO CHECK FOR VALIDITY                               */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1454
*  NBLKPTR=CRVNAMCH;              /* POINT AT THE START OF THE       */
@RT01451 MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       1454
*                                 /* NAME CHAIN                      */
*  DO WHILE NBLKPTR^=NULLPTR;     /* LOOP THROUGH THE WHOLE          */
         B     @DE01455                                            1455
@DL01455 DS    0H                                                  1456
*                                 /* NAME CHAINE                     */
*                                                                  1456
*    /****************************************************************/
*    /*                                                              */
*    /*    IF THIS NAME CAME FROM AN ENTRY, INSURE THAT IT WAS       */
*    /*    FOUND IN THE DESIRED CRA                                  */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1456
*    IF ENTREPTR(YPARM4)=NULLPTR & NBLKBE=OFF                      1456
*                                 /* IF ENTRIES NOT SPECIFIED        */
*                                 /* AND THIS NAME BLOCK IS OK       */
*      THEN;                      /* THEN: CONTINUE                  */
         L     @14,@PC00021                                        1456
         L     @14,YPARM4(,@14)                                    1456
         SLA   @14,2                                               1456
         L     @04,@PC00001+4                                      1456
         L     @04,FDTPTR+28(,@04)                                 1456
         AL    @04,@CF01392                                        1456
         L     @14,ENTREPTR(@14,@04)                               1456
         LTR   @14,@14                                             1456
         BNZ   @RF01456                                            1456
         L     @14,NBLKPTR                                         1456
         TM    NBLKBE(@14),B'01000000'                             1456
         BZ    @RT01456                                            1456
*      ELSE DO;                   /* ELSE:                           */
@RF01456 DS    0H                                                  1459
*        IF NBLKCI=INVALCI        /* IF THE CI WAS NOT FILED IN      */
*          THEN DO;               /* THEN:                           */
         L     @14,NBLKPTR                                         1459
         CLC   NBLKCI(3,@14),INVALCI                               1459
         BNE   @RF01459                                            1459
*            NBLKBE=ON;           /* INDICATE A BAD ENTRY            */
         OI    NBLKBE(@14),B'01000000'                             1461
*            CALL MESSAGE (0,MSGID11,CRADDPTR(YPARM4)->CRADDVAL,   1462
*                          LENGTH(CRADDVAL));                      1462
         MVC   @AL00001(16),@AL01462                               1462
         L     @14,@PC00021                                        1462
         L     @14,YPARM4(,@14)                                    1462
         SLA   @14,2                                               1462
         L     @04,@PC00001+4                                      1462
         L     @04,FDTPTR+16(,@04)                                 1462
         AL    @04,@CF01392                                        1462
         L     @14,CRADDPTR(@14,@04)                               1462
         LA    @14,CRADDVAL(,@14)                                  1462
         ST    @14,@AL00001+8                                      1462
         LA    @01,@AL00001                                        1462
         BAL   @14,MESSAGE                                         1462
*                                 /* PRINT CRA ENTRY MISMATCH        */
*            SYIX1=NBLKNAME->DSNAMLEN;                             1463
         L     @14,NBLKPTR                                         1463
         L     @14,NBLKNAME(,@14)                                  1463
         LH    @04,DSNAMLEN(,@14)                                  1463
         ST    @04,SYIX1                                           1463
*                                 /* PICK UP LENGTH OF NAME          */
*            CALL MESSAGE (0,MSGID20,NBLKNAME->DSNAM,SYIX1);       1464
         LA    @04,@CF00116                                        1464
         ST    @04,@AL00001                                        1464
         LA    @04,@CH00885                                        1464
         ST    @04,@AL00001+4                                      1464
         LA    @14,DSNAM(,@14)                                     1464
         ST    @14,@AL00001+8                                      1464
         LA    @14,SYIX1                                           1464
         ST    @14,@AL00001+12                                     1464
         LA    @01,@AL00001                                        1464
         BAL   @14,MESSAGE                                         1464
*                                 /* PRINT DSNAME                    */
*            IF LASTCC<LASTCC08   /* IF THIS IS A NEW HIGH           */
*              THEN LASTCC=LASTCC08;                               1465
         LA    @14,8                                               1465
         L     @04,@PC00001+8                                      1465
         CH    @14,LASTCC(,@04)                                    1465
         BNH   @RF01465                                            1465
         STH   @14,LASTCC(,@04)                                    1466
*                                 /* THEN: SAVE THE NEW VALUE        */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF01465 DS    0H                                                  1468
*            END;                 /*                                 */
*          ELSE;                  /* ELSE: CONTINUE                  */
@RF01459 DS    0H                                                  1470
*        END;                     /*                                 */
*    /****************************************************************/
*    /*                                                              */
*    /*    HANDLE THE CHECKING FOR SYNCHRONIZATION OF A CLUSTER      */
*    /*    OR AN ALTERNATE INDEX ENTRY                               */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1471
*    IF (NBLKTYPE=CLUSTYPE  NBLKTYPE=AIXTYPE) & NBLKBE=OFF        1471
*                                 /* IF VSAM DATA SET AND            */
*                                 /* NAME BLOCK IS VALID             */
*      THEN DO;                   /* THEN:                           */
*                                                                  1471
@RT01456 L     @14,NBLKPTR                                         1471
         CLI   NBLKTYPE(@14),C'C'                                  1471
         BE    @GL00033                                            1471
         CLI   NBLKTYPE(@14),C'G'                                  1471
         BNE   @RF01471                                            1471
@GL00033 L     @14,NBLKPTR                                         1471
         TM    NBLKBE(@14),B'01000000'                             1471
         BNZ   @RF01471                                            1471
*        /************************************************************/
*        /*                                                          */
*        /*    HANDLE THE CHECKING FOR THE SYNCHRONIZATION OF        */
*        /*    THE DATA COMPONENT                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1473
*        IF NBLKDCI=INVALCI       /* IF THERE IS NO DATA ENTRY       */
*          THEN DO;               /* THEN:                           */
         CLC   NBLKDCI(3,@14),INVALCI                              1473
         BNE   @RF01473                                            1473
*            NBLKBE=ON;           /* INDICATE BAD ENTRY              */
         OI    NBLKBE(@14),B'01000000'                             1475
*            CALL MESSAGE (0,MSGID104,0,0);                        1476
         LA    @01,@AL01476                                        1476
         BAL   @14,MESSAGE                                         1476
*                                 /* PRINT ERROR IS ASSOCIATION      */
*            SYIX1=NBLKNAME->DSNAMLEN;                             1477
         L     @14,NBLKPTR                                         1477
         L     @14,NBLKNAME(,@14)                                  1477
         LH    @04,DSNAMLEN(,@14)                                  1477
         ST    @04,SYIX1                                           1477
*                                 /* PICK UP LENGTH OF NAME          */
*            CALL MESSAGE (0,MSGID20,NBLKNAME->DSNAM,SYIX1);       1478
         LA    @04,@CF00116                                        1478
         ST    @04,@AL00001                                        1478
         LA    @04,@CH00885                                        1478
         ST    @04,@AL00001+4                                      1478
         LA    @14,DSNAM(,@14)                                     1478
         ST    @14,@AL00001+8                                      1478
         LA    @14,SYIX1                                           1478
         ST    @14,@AL00001+12                                     1478
         LA    @01,@AL00001                                        1478
         BAL   @14,MESSAGE                                         1478
*                                 /* PRINT DATA SET NAME             */
*            END;                 /*                                 */
*          ELSE DO;               /* ELSE:                           */
         B     @RC01473                                            1480
@RF01473 DS    0H                                                  1481
*            CALL OBJVOLCK (NBLKDCI,VTTVOLSR(YPARM4));             1481
         L     @14,NBLKPTR                                         1481
         LA    @14,NBLKDCI(,@14)                                   1481
         ST    @14,@AL00001                                        1481
         L     @14,@PC00021                                        1481
         L     @14,YPARM4(,@14)                                    1481
         MH    @14,@CH00763                                        1481
         L     @04,CRVBASE                                         1481
         L     @04,CRVCRAPL(,@04)                                  1481
         L     @04,ACCVOLTT(,@04)                                  1481
         AL    @04,@CF01391                                        1481
         LA    @14,VTTVOLSR-4(@14,@04)                             1481
         ST    @14,@AL00001+4                                      1481
         LA    @01,@AL00001                                        1481
         BAL   @14,OBJVOLCK                                        1481
*                                 /* CHECK THE DATA VOLUME           */
*            IF REG15=LASTCC12    /* IF OUT OF STORAGE               */
*              THEN RETURN CODE(LASTCC12);                         1482
         LA    @14,12                                              1482
         CR    REG15,@14                                           1482
         BNE   @RF01482                                            1482
         LR    @15,@14                                             1483
         L     @14,@SA00021                                        1483
         LM    @00,@12,@SA00021+8                                  1483
         BR    @14                                                 1483
*                                 /* THEN: RETURN ERROR              */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF01482 DS    0H                                                  1485
*            END;                 /*                                 */
*        /************************************************************/
*        /*                                                          */
*        /*    IF THERE IS AN INDEX COMPONENT THEN CHECK TO          */
*        /*    SEE IF THE COMPONENT IS IN SYNCHRONIZATION.           */
*        /*                                                          */
*        /************************************************************/
*                                                                  1486
*        IF NBLKICI=INVALCI & NBLKBE=OFF & NBLKSC=OFF              1486
*                                 /* IF THERE IS NO VALID INDEX      */
*                                 /* ENTRY                           */
*          THEN;                  /* THEN: CONTINUE                  */
@RC01473 L     @14,NBLKPTR                                         1486
         CLC   NBLKICI(3,@14),INVALCI                              1486
         BNE   @RF01486                                            1486
         TM    NBLKBE(@14),B'01100000'                             1486
         BZ    @RT01486                                            1486
*          ELSE DO;               /* ELSE:                           */
@RF01486 DS    0H                                                  1489
*            CALL OBJVOLCK (NBLKICI,VTTVOLSR(YPARM4));             1489
         L     @14,NBLKPTR                                         1489
         LA    @14,NBLKICI(,@14)                                   1489
         ST    @14,@AL00001                                        1489
         L     @14,@PC00021                                        1489
         L     @14,YPARM4(,@14)                                    1489
         MH    @14,@CH00763                                        1489
         L     @04,CRVBASE                                         1489
         L     @04,CRVCRAPL(,@04)                                  1489
         L     @04,ACCVOLTT(,@04)                                  1489
         AL    @04,@CF01391                                        1489
         LA    @14,VTTVOLSR-4(@14,@04)                             1489
         ST    @14,@AL00001+4                                      1489
         LA    @01,@AL00001                                        1489
         BAL   @14,OBJVOLCK                                        1489
*                                 /* CHECK THE INDEX PORTION         */
*            IF REG15=LASTCC12    /* IF OUT OF STORAGE               */
*              THEN RETURN CODE(LASTCC12);                         1490
         LA    @14,12                                              1490
         CR    REG15,@14                                           1490
         BNE   @RF01490                                            1490
         LR    @15,@14                                             1491
         L     @14,@SA00021                                        1491
         LM    @00,@12,@SA00021+8                                  1491
         BR    @14                                                 1491
*                                 /* THEN: RETURN ERROR              */
*              ELSE;              /* ELSE: CONTINUE                  */
@RF01490 DS    0H                                                  1493
*            END;                 /*                                 */
*        END;                     /*                                 */
*      ELSE;                      /* ELSE: CONTINUE                  */
@RF01471 DS    0H                                                  1496
*    NBLKPTR=NBLKCHN;             /* POINT AT NEXT BLOCK             */
@RC01471 L     @14,NBLKPTR                                         1496
         L     @14,NBLKCHN(,@14)                                   1496
         ST    @14,NBLKPTR                                         1496
*    END;                         /*                                 */
*                                                                  1497
@DE01455 SLR   @14,@14                                             1497
         C     @14,NBLKPTR                                         1497
         BNE   @DL01455                                            1497
*  RETURN CODE(LASTCC00);         /* RETURN ZERO RETURN CODE         */
*                                                                  1498
         LR    @15,@14                                             1498
         L     @14,@SA00021                                        1498
         LM    @00,@12,@SA00021+8                                  1498
         BR    @14                                                 1498
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1499
*  END SYNCH;                     /* END OF PROCEDURE                */
@PB00021 DS    0H                                                  1501
*  GEN (EJECT);                                                    1501
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    TERM                                                        */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    THIS ROUTINE PERFORMS THE FOLLOWING FUNCTIONS IN THE        */
*  /*    TERMINATION PROCESS                                         */
*  /*                                                                */
*  /*    1. DEQUEUE THE CATALOG NAME THAT IS BEING HELD UP           */
*  /*       FOR THERE IS NO FURTHER NEED FOR IT.                     */
*  /*                                                                */
*  /*    2. DEQUEUE THE PROGRAM NAME SO THAT EXPORTRA CAN RUN        */
*  /*       IN ANOTHER PARTITION.                                    */
*  /*                                                                */
*  /*    3. IF THERE WAS A CALL TO IDCRC02, THEN THE PORT-           */
*  /*       ABILITY DATA SET MUST BE CLOSED.  A CALL IS MADE         */
*  /*       TO IDCRC02 TO CLOSE IT AND THE OK MESSAGE IS             */
*  /*       PRINTED IF ALL IS OK.                                    */
*  /*                                                                */
*  /*    4. ALL OF THE STORAGE OBTAINED BY THIS MODULE IS FREED      */
*  /*       SO THAT ALL THINGS ARE CLEAN.                            */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    THE CRV MUST BE CONSTRUCTED, AS THE CATALOG NAME IS         */
*  /*    NEEDED.                                                     */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1502
*TERM: PROCEDURE;                                                  1502
*                                                                  1502
         B     @PB00022                                            1502
TERM     STM   @14,@12,@SA00022                                    1502
*  /******************************************************************/
*  /*                                                                */
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1503
*  DCL TERMTIME    CHAR(8);       /* TIME FROM UTIME ROUTINE         */
*  DCL TERMDATE    CHAR(8);       /* DATE FROM UTIME ROUTINE         */
*                                                                  1504
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1505
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1506
*  OLDERID2 = NEWERID2;                                            1506
         L     @14,@PC00001                                        1506
         L     @03,GDTTR2(,@14)                                    1506
         MVC   @TS00001(95),NEWERID2(@03)                          1506
         MVC   OLDERID2(95,@03),@TS00001                           1506
*  NEWID2='RC79';                                                  1507
         MVC   NEWID2(4,@03),@CC01358                              1507
*  IF GDTDBG = NULLPTR                                             1508
*    THEN;                                                         1508
         ICM   @03,15,GDTDBG(@14)                                  1508
         BZ    @RT01508                                            1508
*    ELSE                                                          1510
*      CALL IDCDB010 (GDTTBL,'RC79');                              1510
*                                                                  1510
         L     @14,@PC00001                                        1510
         ST    @14,@AL00001                                        1510
         LA    @03,@CC01358                                        1510
         ST    @03,@AL00001+4                                      1510
         MVI   @AL00001+4,X'80'                                    1510
         L     @15,GDTDBG(,@14)                                    1510
         LA    @01,@AL00001                                        1510
         BALR  @14,@15                                             1510
*  /******************************************************************/
*  /*                                                                */
*  /*    DEQUEUE THE OWNING CATALOG SO THAT IT MAY BE USED           */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1511
*  IF CRVBASE=NULLPTR  CRVCATNL=0                                 1511
*                                 /* IF THERE IS NO NAME             */
*    THEN;                        /* THEN: CONTINUE                  */
@RT01508 L     @14,CRVBASE                                         1511
         LTR   @14,@14                                             1511
         BZ    @RT01511                                            1511
         CLI   CRVCATNL(@14),0                                     1511
         BE    @RT01511                                            1511
*    ELSE DO;                     /* ELSE:                           */
*      CALL IDCSADQ0 (GDTTBL,CRVMAJNM,CRVCATNM);                   1514
         L     @14,@PC00001                                        1514
         ST    @14,@AL00001                                        1514
         L     @03,CRVBASE                                         1514
         LA    @07,CRVMAJNM(,@03)                                  1514
         ST    @07,@AL00001+4                                      1514
         LA    @03,CRVCATNM(,@03)                                  1514
         ST    @03,@AL00001+8                                      1514
         MVI   @AL00001+8,X'80'                                    1514
         L     @15,GDTDEQ(,@14)                                    1514
         LA    @01,@AL00001                                        1514
         BALR  @14,@15                                             1514
*                                 /* RELEASE CONTROL OF THE          */
*                                 /* OWNING CATALOG                  */
*      END;                       /*                                 */
*                                                                  1515
*  /******************************************************************/
*  /*                                                                */
*  /*    DEQUEUE ON THE EXPORTRA MODULE                              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1516
*  CALL IDCSADQ0 (GDTTBL,SYSTEM,PROGRAM);                          1516
@RT01511 MVC   @AL00001+4(8),@AL01516                              1516
         L     @14,@PC00001                                        1516
         ST    @14,@AL00001                                        1516
         L     @15,GDTDEQ(,@14)                                    1516
         LA    @01,@AL00001                                        1516
         BALR  @14,@15                                             1516
*                                 /* RELEASE CONTROL OF THE          */
*                                 /* PROGRAM SO IT CAN RUN IN        */
*                                 /* OTHER PARTITIONS                */
*                                                                  1517
*  /******************************************************************/
*  /*                                                                */
*  /*    CAUSE EXPORT TO CLOSE THE PORTABILITY DATA SET              */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1517
*  IF INPPTR=NULLPTR  LASTCC>LASTCC08                             1517
*                                 /* IF THERE HAVE BEEN NO           */
*                                 /* EXPORTS OR FUNCTION TERMINATED  */
*    THEN;                        /* THEN: CONTINUE                  */
         ICM   @14,15,INPPTR                                       1517
         BZ    @RT01517                                            1517
         L     @14,@PC00001+8                                      1517
         LH    @14,LASTCC(,@14)                                    1517
         CH    @14,@CH00180                                        1517
         BH    @RT01517                                            1517
*    ELSE DO;                     /* ELSE:                           */
*      ENDFLG=ON;                 /* INDICATE END OF EXPORT          */
         L     @14,INPPTR                                          1520
         L     @14,INPTBL+4(,@14)                                  1520
         OI    ENDFLG(@14),B'01000000'                             1520
*      CALL IDCRC02(GDTTBL,INPPTR);                                1521
         L     @14,@PC00001                                        1521
         ST    @14,@AL00001                                        1521
         LA    @14,INPPTR                                          1521
         ST    @14,@AL00001+4                                      1521
         L     @15,@CV00913                                        1521
         LA    @01,@AL00001                                        1521
         BALR  @14,@15                                             1521
*                                 /* CAUSE CLOSE OF DATA SET         */
*      IF REG15=LASTCC00 & EXPORTED < 8 /* IF ANY DATASETS   @OZ18993*/
*                                 /* WERE EXPORTED SUCCESSFULLY      */
*        THEN DO;                 /* THEN:                           */
         LTR   REG15,REG15                                         1522
         BNZ   @RF01522                                            1522
         CH    EXPORTED,@CH00180                                   1522
         BNL   @RF01522                                            1522
*          CALL IDCSATI0 (GDTTBL,TERMTIME,TERMDATE,FORMAT);        1524
         L     @14,@PC00001                                        1524
         ST    @14,@AL00001                                        1524
         LA    @07,TERMTIME                                        1524
         ST    @07,@AL00001+4                                      1524
         LA    @07,TERMDATE                                        1524
         ST    @07,@AL00001+8                                      1524
         LA    @07,FORMAT                                          1524
         ST    @07,@AL00001+12                                     1524
         MVI   @AL00001+12,X'80'                                   1524
         L     @15,GDTTIM(,@14)                                    1524
         LA    @01,@AL00001                                        1524
         BALR  @14,@15                                             1524
*                                 /* GET TIME AND DATE FOR THE       */
*                                 /* COMPLETION MESSAGE              */
*          CALL MESSAGE(2,MSGID5,TERMDATE,LENGTH(TERMDATE),        1525
*                       TERMTIME,LENGTH(TERMTIME));                1525
         MVC   @AL00001(24),@AL01525                               1525
         LA    @14,TERMDATE                                        1525
         ST    @14,@AL00001+8                                      1525
         LA    @14,TERMTIME                                        1525
         ST    @14,@AL00001+16                                     1525
         LA    @01,@AL00001                                        1525
         BAL   @14,MESSAGE                                         1525
*                                 /* PRINT DATA SET OK               */
*          END;                   /*                                 */
*        ELSE LASTCC=LASTCC12;    /* ELSE: SET UP THE RETURN CODE    */
         B     @RC01522                                            1527
@RF01522 L     @14,@PC00001+8                                      1527
         MVC   LASTCC(2,@14),@CH00038                              1527
*      END;                       /*                                 */
@RC01522 DS    0H                                                  1529
*  /******************************************************************/
*  /*                                                                */
*  /*    RELEASE ALL THE OBTAINED STORAGE ON EXIT                    */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1529
*  CALL IDCSAFP0 (GDTTBL,COREID1,ALL);                             1529
@RT01517 MVC   @AL00001+4(8),@AL01529                              1529
         L     @14,@PC00001                                        1529
         ST    @14,@AL00001                                        1529
         L     @15,GDTFPL(,@14)                                    1529
         LA    @01,@AL00001                                        1529
         BALR  @14,@15                                             1529
*                                 /* FREE ALL STORAGE OBTAINED       */
*                                                                  1530
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1530
*  END TERM;                      /* END OF PRCOEDURE                */
@EL00022 DS    0H                                                  1531
@EF00022 DS    0H                                                  1531
@ER00022 LM    @14,@12,@SA00022                                    1531
         BR    @14                                                 1531
@PB00022 DS    0H                                                  1532
*  GEN (EJECT);                                                    1532
         EJECT
*  /******************************************************************/
*  /*                                                                */
*  /* PROCEDURE NAME:                                                */
*  /*    TIMESTMP                                                    */
*  /*                                                                */
*  /* FUNCTION:                                                      */
*  /*    OBTAIN THE FORMAT 4 DSCB NEW VSAM TIMESTAMP FOR THE         */
*  /*    VOLUME WHILE IT IS MOUNTED.                                 */
*  /*                                                                */
*  /* REQUIREMENTS:                                                  */
*  /*                                                                */
*  /*    1. THE CORRECT CRV ENTRY MUST BE SELECTED BEFOR THIS        */
*  /*       ROUTINE IS CALLED.                                       */
*  /*                                                                */
*  /*    2. THE VTT TABLE MUST BE BUILT SO IT MAY BE FILLED          */
*  /*       IN.                                                      */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1533
*TIMESTMP: PROCEDURE (TPARM4);                                     1533
*                                                                  1533
         B     @PB00023                                            1533
TIMESTMP STM   @14,@12,@SA00023                                    1533
         MVC   @PC00023(4),0(@01)                                  1533
*  /******************************************************************/
*  /*                                                                */
*  /*    INCOMING PARAMETERS FOR THIS ROUTINE                        */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1534
*  DCL TPARM4   PTR(31);          /* INDEX INTO THE CRV              */
*                                                                  1534
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */
*                                                                  1535
*  /******************************************************************/
*  /*                                                                */
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1536
*  OLDERID2 = NEWERID2;                                            1536
         L     @14,@PC00001                                        1536
         L     @07,GDTTR2(,@14)                                    1536
         MVC   @TS00001(95),NEWERID2(@07)                          1536
         MVC   OLDERID2(95,@07),@TS00001                           1536
*  NEWID2='RC94';                                                  1537
         MVC   NEWID2(4,@07),@CC01364                              1537
*  IF GDTDBG = NULLPTR                                             1538
*    THEN;                                                         1538
         ICM   @07,15,GDTDBG(@14)                                  1538
         BZ    @RT01538                                            1538
*    ELSE                                                          1540
*      CALL IDCDB010 (GDTTBL,'RC94');                              1540
*                                                                  1540
         L     @14,@PC00001                                        1540
         ST    @14,@AL00001                                        1540
         LA    @07,@CC01364                                        1540
         ST    @07,@AL00001+4                                      1540
         MVI   @AL00001+4,X'80'                                    1540
         L     @15,GDTDBG(,@14)                                    1540
         LA    @01,@AL00001                                        1540
         BALR  @14,@15                                             1540
*  /******************************************************************/
*  /*                                                                */
*  /*    IF THERE IS AN ERROR ALREADY FOUND THEN THERE IS NO         */
*  /*    NEED TO SPEND THE TIME TO GET THE TIMESTAMP                 */
*  /*                                                                */
*  /*    CHECK TO SEE IT THERE IS AN ERROR ALREADY                   */
*  /*                                                                */
*  /******************************************************************/
*                                                                  1541
*  IF ERRNO=ERCDNRML              /* IF THERE IS NO ERROR YET        */
*                                                                  1541
*    THEN DO;                     /* THEN:                           */
@RT01538 LTR   ERRNO,ERRNO                                         1541
         BNZ   @RF01541                                            1541
*      /**************************************************************/
*      /*                                                            */
*      /*    CHECK TO SEE IF THE TIMESTAMP IS ALREADY FILLED         */
*      /*                                                            */
*      /**************************************************************/
*                                                                  1543
*      IF VTTTMSTP(TPARM4)=NULLCHAR(1:LENGTH(VTTTMSTP))            1543
*                                 /* IF THERE IS NO TIMESTAMP        */
*                                 /* ALREADY                         */
*        /************************************************************/
*        /*                                                          */
*        /*    WITH THE ENTRY NOT BEING ALREADY FILLED IN,           */
*        /*    OBTAIN THE TIMESTAMP FOR THE TABLE                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  1543
*        THEN DO;                 /* THEN:                           */
         L     @14,@PC00023                                        1543
         L     @14,TPARM4(,@14)                                    1543
         LR    @07,@14                                             1543
         MH    @07,@CH00763                                        1543
         L     @01,CRVBASE                                         1543
         L     @01,CRVCRAPL(,@01)                                  1543
         L     @01,ACCVOLTT(,@01)                                  1543
         ALR   @01,@07                                             1543
         AL    @01,@CF01392                                        1543
         CLC   VTTTMSTP-10(8,@01),NULLCHAR                         1543
         BNE   @RF01543                                            1543
*          BYTEPM1A=ADDR(BYTEPM1);/* POINT AT THE OPTION BYTE        */
         LA    BYTEPM1A,BYTEPM1                                    1545
*          BYTEPM1=0;             /* ZERO THE BYTE                   */
         MVI   BYTEPM1,X'00'                                       1546
*          IOINFTMS=ON;           /* INDICATE THAT THE TIME-         */
         OI    IOINFTMS(BYTEPM1A),B'00001000'                      1547
*                                 /* STAMPS ARE DESIRED              */
*          TMSFLDLN=LENGTH(TMSAREA);                               1548
         MVC   TMSFLDLN(2),@CH01375                                1548
*                                 /* PLACE THE LENGTH IN THE         */
*                                 /* AREA PROVIDED                   */
*          CALL IDCIOSI0 (GDTTBL,BYTEPM1,ADDR(TMSAREA),            1549
*                   CRADDPTR(TPARM4)->CRADDVAL);                   1549
         L     @07,@PC00001                                        1549
         ST    @07,@AL00001                                        1549
         LA    @06,BYTEPM1                                         1549
         ST    @06,@AL00001+4                                      1549
         LA    @06,TMSAREA                                         1549
         ST    @06,@AFTEMPS+20                                     1549
         LA    @06,@AFTEMPS+20                                     1549
         ST    @06,@AL00001+8                                      1549
         SLA   @14,2                                               1549
         L     @06,@PC00001+4                                      1549
         L     @01,FDTPTR+16(,@06)                                 1549
         AL    @01,@CF01392                                        1549
         L     @14,CRADDPTR(@14,@01)                               1549
         LA    @14,CRADDVAL(,@14)                                  1549
         ST    @14,@AL00001+12                                     1549
         MVI   @AL00001+12,X'80'                                   1549
         L     @15,GDTIFO(,@07)                                    1549
         LA    @01,@AL00001                                        1549
         BALR  @14,@15                                             1549
*                                 /* GET THE TWO TIMESTAMPS          */
*                                                                  1550
*          /**********************************************************/
*          /*                                                        */
*          /*    SET UP AN ERROR CODE IF THE TIMESTAMP WAS           */
*          /*    NOT OBTAINED CORRECTLY                              */
*          /*                                                        */
*          /**********************************************************/
*                                                                  1550
*          IF REG15^=LASTCC00     /* IF DATA NOT RETURNED            */
*            THEN DO;             /* THEN:                           */
         LTR   REG15,REG15                                         1550
         BZ    @RF01550                                            1550
*              RSNCD=RSNCD03;     /* INDICATE THE ERROR TYPE         */
         MVC   RSNCD(2),@CC00920                                   1552
*              IF CRVBTSER=ON     /* IF ERROR HAS BEEN PRINTED       */
*                THEN;            /* THEN: CONTINUE                  */
         TM    CRVBTSER(CRVEBASE),B'00000010'                      1553
         BO    @RT01553                                            1553
*                ELSE DO;         /* ELSE:                           */
*                  CALL MESSAGE(2,MSGID22,VTTVOLSR(TPARM4),        1556
*                               LENGTH(VTTVOLSR),RSNCD,LENGTH(RSNCD));
         MVC   @AL00001(24),@AL01556                               1556
         L     @14,@PC00023                                        1556
         L     @14,TPARM4(,@14)                                    1556
         MH    @14,@CH00763                                        1556
         L     @01,CRVBASE                                         1556
         L     @01,CRVCRAPL(,@01)                                  1556
         L     @01,ACCVOLTT(,@01)                                  1556
         AL    @01,@CF01391                                        1556
         LA    @14,VTTVOLSR-4(@14,@01)                             1556
         ST    @14,@AL00001+8                                      1556
         LA    @14,RSNCD                                           1556
         ST    @14,@AL00001+16                                     1556
         LA    @01,@AL00001                                        1556
         BAL   @14,MESSAGE                                         1556
*                  END;           /*                                 */
*              END;               /*                                 */
*            /********************************************************/
*            /*                                                      */
*            /*    IF THE TIMESTAMP WAS OBTAINED, PLACE IT IN        */
*            /*    THE VOLUME TIMESTAMP TABLE (VTT)                  */
*            /*                                                      */
*            /********************************************************/
*                                                                  1559
*            ELSE VTTTMSTP(TPARM4)=ADDR(TMSRETRN)->TMSNEWTS;       1559
         B     @RC01550                                            1559
@RF01550 L     @14,@PC00023                                        1559
         L     @14,TPARM4(,@14)                                    1559
         MH    @14,@CH00763                                        1559
         L     @01,CRVBASE                                         1559
         L     @01,CRVCRAPL(,@01)                                  1559
         L     @01,ACCVOLTT(,@01)                                  1559
         ALR   @01,@14                                             1559
         AL    @01,@CF01392                                        1559
         LA    @14,TMSRETRN                                        1559
         MVC   VTTTMSTP-10(8,@01),TMSNEWTS(@14)                    1559
*                                 /* ELSE: PLACE TIMESTAMP IN        */
*                                 /*       THE TABLE                 */
*          END;                   /*                                 */
*        ELSE;                    /* ELSE: CONTINUE                  */
@RF01543 DS    0H                                                  1562
*      END;                       /*                                 */
*    ELSE;                        /* ELSE: CONTINUE                  */
*                                                                  1563
@RF01541 DS    0H                                                  1564
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */
*                                                                  1564
*  END TIMESTMP;                  /* END OF PROCEDURE                */
@EL00023 DS    0H                                                  1565
@EF00023 DS    0H                                                  1565
@ER00023 LM    @14,@12,@SA00023                                    1565
         BR    @14                                                 1565
*  END IDCRC01                    /* END OF PROCEDURE                */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*@INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*@INCLUDE SYSLIB  (IDCDF60 )                                        *
*/*@INCLUDE SYSLIB  (IDCDF61 )                                        *
*/*@INCLUDE SYSLIB  (IDCDF62 )                                        *
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        *
*/*@INCLUDE SYSLIB  (IDCDF63 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRC )                                        *
*;                                                                 1566
@EL00001 L     @13,4(,@13)                                         1566
@EF00001 L     @00,@SIZDATD                                        1566
         LR    @01,@08                                             1566
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     1566
         BR    @14                                                 1566
@DATA    DS    0H
@CH00163 DC    H'3'
@CH00287 DC    H'5'
@CH00473 DC    H'7'
@CH00035 DC    H'9'
@CH00037 DC    H'11'
@CH00038 DC    H'12'
@CH00758 DC    H'13'
@CH00763 DC    H'14'
@CH00229 DC    H'15'
@CH00483 DC    H'16'
@CH00879 DC    H'17'
@CH00881 DC    H'18'
@CH00883 DC    H'19'
@CH00887 DC    H'21'
@CH00889 DC    H'22'
@CH00891 DC    H'23'
@CH00311 DC    H'24'
@CH00894 DC    H'25'
@CH00954 DC    H'28'
@CH01379 DC    H'43'
@CH00898 DC    H'50'
@CH00900 DC    H'51'
@CH00902 DC    H'53'
@CH00904 DC    H'54'
@CH00906 DC    H'65'
@CH01374 DC    H'67'
@CH01375 DC    H'96'
@CH00911 DC    H'104'
@CH00762 DC    H'255'
@CH01239 DC    H'256'
@SM01397 MVC   DSNAM(0,@14),PARMDSN(@07)
@SC01400 CLC   DSNAM(0,@05),DSNAM(@14)
@SC01404 CLC   DSNAM(0,@07),DSNAM(@06)
         DS    0F
@AL00333 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01163 DC    A(@CC00942)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CC00853)
         DC    A(CRADS)
@AL00364 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00763)
         DC    A(@CC00851)
         DC    A(@CF00157)
@AL00431 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00449 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00883)
         DC    A(@CC00853)
         DC    A(@CF00180)
@AL00534 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00483)
         DC    A(@CC00851)
         DC    A(@CF00157)
@AL00535 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00879)
@AL00562 DC    A(@CF00116)             LIST WITH   8 ARGUMENT(S)
         DC    A(@CF01378)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(QPASWORD)
         DC    A(@CF00116)
@AL00569 EQU   *                       LIST WITH   8 ARGUMENT(S)
@AL00576 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00620 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00864 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00163)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(SYSTEM)
         DC    AL1(X'80')
         DC    AL3(PROGRAM)
         DC    A(QCATTR)
         DC    A(@CF00116)
@AL00582 EQU   *                       LIST WITH   8 ARGUMENT(S)
@AL00771 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00904)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CC00829)
         DC    AL1(X'80')
         DC    AL3(ALL)
         DC    A(QNAMEDS)
         DC    A(@CF00116)
@AL00595 EQU   *                       LIST WITH   8 ARGUMENT(S)
@AL00855 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CF00157+2)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CC00853)
         DC    A(@CC00851)
         DC    A(QMAMDSB)
         DC    A(@CF00116)
@AL00599 EQU   *                       LIST WITH   8 ARGUMENT(S)
@AL00856 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00229)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CC00849)
         DC    A(@CF00222)
         DC    A(QMXLRECL)
         DC    A(@CF00116)
@AL00603 EQU   *                       LIST WITH   8 ARGUMENT(S)
@AL00865 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CF00154+2)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(SYSTEM)
         DC    AL1(X'80')
         DC    AL3(PROGRAM)
         DC    A(QHURBA)
         DC    A(@CF00116)
@AL00613 DC    A(@CF00220)             LIST WITH  13 ARGUMENT(S)
         DC    A(@CC00853)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL01529 DC    A(@CC00829)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
         DC    A(QTYPE)
         DC    A(@CF00116)
         DC    A(QTYPE)
         DC    A(@CB00934)
         DC    A(@CF00116)
@AL00672 DC    A(@CF00116)             LIST WITH   8 ARGUMENT(S)
         DC    A(@CF00220)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(@CF00116)
         DC    A(QREPNO)
         DC    A(@CB01162)
@AL00731 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00887)
         DC    A(@CC00851)
         DC    A(@CF00180)
@AL00761 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)
         DC    A(@CH00881)
         DC    A(@CC00942)
         DC    A(@CF00157)
         DC    A(CRACAT)
         DC    A(@CF00154)
@AL00778 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00906)
         DC    A(@CC00853)
         DC    A(@CF00154)
@AL00780 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00902)
         DC    A(@CC00851)
         DC    A(@CF00154)
@AL00781 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00900)
         DC    A(@CC00853)
         DC    A(@CF00154)
@AL00873 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00473)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL00874 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CF00220+2)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL00889 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00891)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL00991 DC    A(EXCL)                 LIST WITH   4 ARGUMENT(S)
         DC    A(WAIT)
@AL01516 DC    A(SYSTEM)               LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(PROGRAM)
@AL01135 EQU   *                       LIST WITH   8 ARGUMENT(S)
@AL01226 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00311)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL00472 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01062 DC    A(@CC00849)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00222)
         DC    A(QCRADITS)
         DC    A(@CF00116)
@AL01154 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00758)
         DC    A(@CC00851)
         DC    A(@CF00157)
@AL01185 DC    A(@CF00220)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00894)
         DC    A(@CC00853)
         DC    A(@CF00157)
@AL01218 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL01219 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)
         DC    A(@CH00038)
@AL00801 DC    A(@CC00942)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00157)
         DC    A(CRACAT)
         DC    A(@CF00157)
@AL01256 DC    A(@CF00381)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CC00851)
         DC    A(@CC00829)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@AL01374 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL01556 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)
         DC    A(@CH00889)
         DC    A(@CC00853)
         DC    A(@CF00157)
         DC    A(@CC00851)
         DC    A(@CF00154)
@AL01462 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00037)
         DC    A(@CC00853)
         DC    A(@CF00180)
@AL01476 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CH00911)
         DC    A(@CF00116)
         DC    A(@CF00116)
@AL01525 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)
         DC    A(@CH00287)
@AL01085 DC    A(@CC00851)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00180)
@AL00986 DC    A(@CC00853)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00180)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00013 DS    13F
@SA00002 DS    15F
@SA00018 DS    14F
@PC00018 DS    3F
@SA00010 DS    15F
@SA00005 DS    15F
@PC00005 DS    1F
@SA00008 DS    15F
@PC00008 DS    1F
@SA00021 DS    15F
@PC00021 DS    1F
@SA00014 DS    15F
@PC00014 DS    6F
@SA00011 DS    15F
@PC00011 DS    1F
@SA00003 DS    15F
@PC00003 DS    2F
@SA00020 DS    15F
@PC00020 DS    3F
@SA00006 DS    15F
@PC00006 DS    2F
@SA00004 DS    14F
@PC00004 DS    1F
@SA00012 DS    15F
@PC00012 DS    13F
@SA00007 DS    14F
@SA00009 DS    14F
@PC00009 DS    1F
@SA00022 DS    15F
@SA00015 DS    14F
@PC00015 DS    1F
@SA00016 DS    14F
@PC00016 DS    2F
@SA00017 DS    14F
@PC00017 DS    2F
@SA00023 DS    15F
@PC00023 DS    1F
@SA00019 DS    14F
@PC00019 DS    1F
@AL00001 DS    13A
@TF00001 DS    F
@AFTEMPS DS    6F
IDCRC01  CSECT
         DS    0F
@CF00116 DC    F'0'
@CF00220 DC    F'1'
@CH00220 EQU   @CF00220+2
@CF00154 DC    F'2'
@CH00154 EQU   @CF00154+2
@CF00043 DC    F'4'
@CH00043 EQU   @CF00043+2
@CF00157 DC    F'6'
@CH00157 EQU   @CF00157+2
@CF00180 DC    F'8'
@CH00180 EQU   @CF00180+2
@CF00885 DC    F'20'
@CH00885 EQU   @CF00885+2
@CF00222 DC    F'32'
@CF01378 DC    F'45'
@CF01101 DC    F'280'
@CF00381 DC    F'384'
@CF01068 DC    F'1536'
@CF01344 DC    F'2032'
@CF01198 DC    F'2048'
@CF01070 DC    F'4608'
@CF01394 DC    F'-1024'
@CF01412 DC    F'-32'
@CF01411 DC    F'-31'
@CF01407 DC    F'-12'
@CF01391 DC    F'-10'
@CF01408 DC    F'-9'
@CF01384 DC    F'-8'
@CF01409 DC    F'-6'
@CF01410 DC    F'-5'
@CF01392 DC    F'-4'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CHAIN2   DS    A
INPPTR   DS    A
CRVBASE  DS    A
VGOPTR   DS    A
VGOSIZE  DS    F
DSNPTR   DS    A
NBLKPTR  DS    A
INX1     DS    F
KVALA    DS    A
BLDIX2   DS    F
POOLSIZE DS    F
UCBAPTR  DS    A
KVALL    DS    F
OUTAD    DS    A
OUTLNG   DS    F
DIRSIZE  DS    F
DUPIXL   DS    F
EXPTIX2  DS    F
OBJSUMTT DS    F
OBJIX1   DS    F
OBJIX2   DS    A
OBJIX3   DS    F
OBJIX4   DS    A
OBJIX5   DS    F
OBJIX6   DS    F
OBJIX8   DS    F
OBJIX9   DS    F
SIZE     DS    F
SPCSIZE  DS    F
SPCSIZE1 DS    F
SPCPTR   DS    A
SPCPTR1  DS    A
SYIX1    DS    F
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
VGOCRATS DS    CL4
RSNCD    DS    CL2
CORE     DS    CL1
BYTEPM1  DS    BL1
TMSAREA  DS    CL96
         ORG   TMSAREA
TMSFLDLN DS    FL2
TMSFLDUS DS    FL2
TMSRETRN DS    FL2
@NM00044 DS    CL90
         ORG   TMSAREA+96
@NM00058 DS    CL1
         ORG   @NM00058
PDELERR  DS    BL1
         ORG   @NM00058+1
UCBAREA  DS    CL11
ENTOBJA  DS    CL17
         DS    CL3
OUTDATA  DS    CL17
FMPLAR   DS    CL28
         DS    CL3
FMFLAR1  DS    CL24
         ORG   FMFLAR1
@NM00060 DS    CL16
@NM00061 DS    CL8
         ORG   FMFLAR1+24
FMFLAR2  DS    CL24
         ORG   FMFLAR2
@NM00062 DS    CL16
@NM00063 DS    CL8
         ORG   FMFLAR2+24
OARA     DS    CL256
WKA256   DS    CL256
BUFSAR   DS    CL28
BUFWKAR1 DS    CL256
DDSTRU1  DS    CL36
OBJVOL2  DS    CL6
TERMTIME DS    CL8
TERMDATE DS    CL8
         DS    CL2
INPTBLA  DS    5A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRC01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00913 DC    V(IDCRC02)
@CV01241 DC    V(IDCRC03)
@CV01242 DC    V(IDCRC04)
         DS    0D
         DS    CL1
INVALCI  DC    XL3'FFFFFF'
@CC00829 DC    C'RC50'
@CC00831 DC    C'RC51'
@CC00833 DC    C'RC52'
@CC00835 DC    C'RC53'
@CC00837 DC    C'RC54'
@CC01102 DC    C'RC81'
@CC01111 DC    C'RC86'
@CC01122 DC    C'RC93'
@CC01143 DC    C'RC99'
@CC01154 DC    C'RC87'
@CC01165 DC    C'RC98'
@CC01174 DC    C'RC85'
@CC01181 DC    C'RC96'
@CC01200 DC    C'RC82'
@CC01243 DC    C'RC90'
@CC01249 DC    C'RC80'
@CC01266 DC    C'RC89'
@CC01273 DC    C'RC97'
@CC01295 DC    C'RC84'
@CC01309 DC    C'RC92'
@CC01319 DC    C'RC91'
@CC01329 DC    C'RC95'
@CC01345 DC    C'RC88'
@CC01352 DC    C'RC83'
@CC01358 DC    C'RC79'
@CC01364 DC    C'RC94'
@CC00908 DC    C'XP0'
@CC00916 DC    C'01'
@CC00918 DC    C'02'
@CC00920 DC    C'03'
@CC00922 DC    C'04'
@CC00924 DC    C'05'
@CC00926 DC    C'06'
@CC00928 DC    C'07'
@CC00930 DC    C'08'
@CC00932 DC    C'09'
@CC00849 DC    C'G'
@CC00851 EQU   @CC00829
@CC00853 DC    C'I'
@CC00855 DC    C'C'
@CC00860 DC    C'B'
@CC00942 DC    C'O'
@CB01300 DC    X'FFFFFFFF'
@CB00655 EQU   @CB01300
@CB00934 DC    X'80'
@CB01162 DC    X'08'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
UV0MODID DC    CL3'UV0'
GOOD     DC    CL1'G'
BAD      DC    CL1'B'
CRACAT   DC    CL1'C'
CRADS    DC    CL1'D'
QDSDIREC DC    CL8'$DSDIREC'
QDSDRRPM DC    CL8'$DSDRIRN'
QEXTDATA DC    CL8'$EXTDATA'
QMXLRECL DC    CL8'$MXLRECL'
QMAMDSB  DC    CL8'AMDSBCAT'
QCATTR   DC    CL8'CATTR   '
QCRADITS DC    CL8'CRADITS '
QHURBA   DC    CL8'HURBA   '
QITYPEXT DC    CL8'ITYPEXT '
QNAMEDS  DC    CL8'NAMEDS  '
QPASWORD DC    CL8'PASSWORD'
QREPNO   DC    CL8'REPNO   '
QTYPE    DC    CL8'TYPE    '
NULLCHAR DS    CL8
         ORG   NULLCHAR
@NM00055 DC    X'0000000000000000'
         ORG   NULLCHAR+8
SYSTEM   DC    CL8'SYSIGGV2'
PROGRAM  DS    CL9
         ORG   PROGRAM
@NM00056 DC    AL1(8)
@NM00057 DC    X'D9EEEEEEEEEEEE00'
         ORG   PROGRAM+9
MODID    DC    CL4'RC01'
KPWINVAL DC    X'FFFFFFFFFFFFFFFF'
         DS    CL1
PATCH    DC    125A(0)
RECSTYPE DC    CL1'C'
         DC    CL1'G'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'U'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
INDEX    EQU   @04
OBJIX7   EQU   @06
EXPTIX1  EQU   @02
DUPPTR   EQU   @02
DUPIX    EQU   @04
INDEX2   EQU   @02
INDEX1   EQU   @03
RRDS     EQU   @02
VTTSIZE  EQU   @04
ACCSIZE  EQU   @03
CRVSIZE  EQU   @02
BLDIX1   EQU   @02
BLDPTR   EQU   @04
I        EQU   @04
ERRNO    EQU   @02
COUNT    EQU   @05
BYTEPM1A EQU   @04
EXPORTED EQU   @02
VGOPTR1  EQU   @02
CRVEBASE EQU   @03
BUFSPTR  EQU   @05
FMFLCUR  EQU   @02
FMPLAD   EQU   @04
REG1     EQU   @01
REG15    EQU   @15
REG0     EQU   @00
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
RTNREG   EQU   @15
IDCSAEP0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSANQ0 EQU   0
IDCSARV0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITUCB  EQU   UNITABL
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOPO0 EQU   0
IDCIOGT0 EQU   0
IDCIOVY0 EQU   0
IDCIOSI0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCCHPSQ EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCMSG   EQU   IOCSTR+21
IOCMSGOP EQU   IOCMSG
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTIN EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPRA EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNPWA   EQU   OPNAGL+12
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNDSOAM EQU   OPNDSO
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
IOINFDVT EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGIND  EQU   DARGLIST+18
DARGFLGS EQU   DARGLIST+19
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
ACC      EQU   0
ACCTRANT EQU   ACC
ACCDSNCI EQU   ACC+5
ACCVOLTT EQU   ACC+8
CTT      EQU   0
CTTENTNO EQU   CTT
CTTENTRY EQU   CTT+4
CTTENTYP EQU   CTTENTRY
CTTCATCI EQU   CTTENTRY+1
VTT      EQU   0
VTTENTNO EQU   VTT
VTTENTRY EQU   VTT+4
VTTVOLSR EQU   VTTENTRY
VTTTMSTP EQU   VTTENTRY+6
FMPL     EQU   0
FMPLFLNO EQU   FMPL
FMPLBCIN EQU   FMPL+1
FMPLGRTN EQU   FMPL+4
FMPLWKAR EQU   FMPL+8
FMPLUPTR EQU   FMPL+12
FMPLRTCD EQU   FMPL+16
FMPLENTH EQU   FMPL+18
FMPLOAR  EQU   FMPL+20
FMPLFMFL EQU   FMPL+24
FMFL     EQU   0
FMFLDLNO EQU   FMFL
FMFLTSTC EQU   FMFL+1
FMFLGRPC EQU   FMFL+2
FMFLINDS EQU   FMFL+3
FMFLDNAM EQU   FMFL+8
FMFLTCHN EQU   FMFL+12
FMFLDATA EQU   FMFL+16
FMFLENTH EQU   FMFLDATA
FMFLADDR EQU   FMFLDATA+4
BUFS     EQU   0
BUFPOOL  EQU   BUFS
BUFIOCS  EQU   BUFS+8
BUFGDT   EQU   BUFS+12
BUFCTT   EQU   BUFS+16
BUFWKARA EQU   BUFS+20
BUFSIZE  EQU   BUFS+24
BUFSWS   EQU   BUFS+26
BUFORMAT EQU   BUFSWS
BUFELM   EQU   0
IDAAMDSB EQU   0
AMDATTR  EQU   IDAAMDSB+1
AMDRRDS  EQU   AMDATTR
AMDNEST  EQU   IDAAMDSB+4
AMDHLRBA EQU   IDAAMDSB+28
AMDSSRBA EQU   IDAAMDSB+32
AMDATTR3 EQU   IDAAMDSB+40
AMDSTAT  EQU   IDAAMDSB+48
INPTBL   EQU   0
ENTOBJ   EQU   0
OBJTYP   EQU   ENTOBJ
OBJVAL   EQU   ENTOBJ+1
OBJPLN   EQU   ENTOBJ+8
OBJPAS   EQU   ENTOBJ+9
OUTDAT   EQU   0
OUTLEN   EQU   OUTDAT
USBKSZ   EQU   OUTDAT+8
OUTFLGS  EQU   OUTDAT+16
ENDFLG   EQU   OUTFLGS
EMPTYDS  EQU   OUTFLGS
FRC      EQU   0
CRACNT   EQU   0
CRADDPTR EQU   0
CRADD    EQU   0
CRADDVAL EQU   CRADD+1
ALLNTPTR EQU   0
ENTREPTR EQU   0
ENTRECNT EQU   0
IFILEPTR EQU   0
IFILE    EQU   0
IFILEVAL EQU   IFILE+1
MRPW     EQU   0
MRPWVAL  EQU   MRPW+1
PDEV     EQU   0
PDEVVAL  EQU   PDEV+1
OUTDD    EQU   0
OUTDDVAL EQU   OUTDD+1
ENTNMPTR EQU   0
ENTNM    EQU   0
ENTNMFLG EQU   ENTNM+10
ENTNMVAL EQU   ENTNM+21
ENTDNPTR EQU   0
ENTDN    EQU   0
ENTDNVAL EQU   ENTDN+1
BLKSZ    EQU   0
BLKSZVAL EQU   BLKSZ
CRVENTY  EQU   0
CRVOPNAG EQU   CRVENTY
CRVIOSTR EQU   CRVENTY+4
CRVDIREC EQU   CRVENTY+8
CRVADCTT EQU   CRVENTY+12
CRVNAMCH EQU   CRVENTY+16
CRVIND   EQU   CRVENTY+20
CRVBADVL EQU   CRVIND
CRVCATOK EQU   CRVIND
CRVNAME  EQU   CRVIND
CRVDIRER EQU   CRVIND
CRVCTTER EQU   CRVIND
CRVBTSER EQU   CRVIND
CRVTKPCY EQU   CRVENTY+22
CRVHIREP EQU   CRVENTY+26
CRV      EQU   0
CRVMAXLR EQU   CRV
CRVCRAPL EQU   CRV+4
CRVCATNM EQU   CRV+8
CRVCATNL EQU   CRVCATNM
CRVCATNC EQU   CRVCATNM+1
CRVMAJNM EQU   CRV+53
CRVENTRY EQU   CRV+64
VGOENT   EQU   0
VGOVOLSR EQU   VGOENT
VGODIRSN EQU   VGOENT+6
VGOEXLEN EQU   VGOENT+8
VGOEXT   EQU   VGOENT+10
VGOSKIP  EQU   VGOEXT
VGOCC    EQU   VGOEXT+2
VGOHH    EQU   VGOEXT+4
VGOS     EQU   0
VGOENTYS EQU   VGOS+2
DSNAME   EQU   0
DSNAMLEN EQU   DSNAME
DSNAM    EQU   DSNAME+2
DIRECTY  EQU   0
DIRCI    EQU   DIRECTY
DIRTS    EQU   DIRECTY+3
DIRSUMTT EQU   DIRECTY+7
DIRELPNO EQU   DIRECTY+10
DIRLENU  EQU   0
TMSTS    EQU   0
TMSHDR   EQU   TMSTS
TMSNEWTS EQU   TMSTS+12
TMSDT    EQU   0
TMSDTCD  EQU   TMSDT
TMSDTTPC EQU   TMSDT+14
TMSVS    EQU   0
TMSVSCD  EQU   TMSVS
TMSVSLEN EQU   TMSVS+2
TMSVOLSR EQU   TMSVS+4
NBLK     EQU   0
NBLKCHN  EQU   NBLK
NBLKTYPE EQU   NBLK+4
NBLKCI   EQU   NBLK+5
@NM00048 EQU   NBLK+8
NBLKMH   EQU   @NM00048
NBLKBE   EQU   @NM00048
NBLKSC   EQU   @NM00048
NBLKMT   EQU   @NM00048
NBLKDCI  EQU   NBLK+9
NBLKPWL  EQU   NBLK+12
NBLKICI  EQU   NBLK+13
NBLKNAME EQU   NBLK+16
NBLKENTN EQU   NBLK+20
NBLKPW   EQU   NBLK+24
RECORD1  EQU   0
RECCI    EQU   RECORD1+1
RECTYPE  EQU   RECORD1+44
RECNEXCI EQU   RECORD1+48
RECNAME  EQU   RECNEXCI+1
KVALD    EQU   0
KPW      EQU   0
KCHAR    EQU   0
KPGDS    EQU   KCHAR
KTYPE    EQU   0
KCHART   EQU   KTYPE
KCINO    EQU   KTYPE+1
DIRCNT   EQU   0
OBJIX99  EQU   0
SPCAREA  EQU   0
ALLNT    EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CRA      EQU   0
DMPTRM   EQU   0
ENTRE    EQU   0
ENVIR    EQU   0
FMFLCNTR EQU   0
FMFLNAME EQU   0
IDCIOCO0 EQU   0
IDCIOIT0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFS0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
INDDNM   EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NFRC     EQU   0
NONE     EQU   0
NONEPTR  EQU   0
OUT      EQU   0
OUTDDNM  EQU   0
PDEVNM   EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTECT   EQU   GDTTBL+188
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCC   EQU   0
PARMNAM  EQU   0
PARMNOS  EQU   0
CPARM4   EQU   0
KPARM4   EQU   0
PARMDSN  EQU   0
DSNAMPTR EQU   0
DPARM4   EQU   0
EPARM4   EQU   0
PPARM4   EQU   0
FLDNO    EQU   0
FLD0     EQU   0
FLDI1    EQU   0
FLDI2    EQU   0
FLD01    EQU   0
FLD02    EQU   0
FLD1     EQU   0
FLD1A    EQU   0
FLD2     EQU   0
FLD3     EQU   0
FLD3A    EQU   0
FLD4     EQU   0
FLD5     EQU   0
MESSAGE0 EQU   0
MESSAGE1 EQU   0
MESSAGE2 EQU   0
MESSAGE3 EQU   0
MESSAGE4 EQU   0
MESSAGE5 EQU   0
NPARM4   EQU   0
OBJCI    EQU   0
OBJVOLSR EQU   0
OPARM4   EQU   0
OPARM5   EQU   0
PARM2    EQU   0
PARM4    EQU   0
PARM5    EQU   0
SPARM4   EQU   0
SPCTYPE  EQU   0
SPSIZ    EQU   0
SPADR    EQU   0
YPARM4   EQU   0
TPARM4   EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FDTVERB  EQU   FDTTBL
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00059 EQU   KCHAR
@NM00054 EQU   RECNEXCI
@NM00053 EQU   RECORD1+45
@NM00052 EQU   RECORD1+11
RECVOLSR EQU   RECORD1+5
@NM00051 EQU   RECORD1+4
@NM00050 EQU   RECORD1
@NM00049 EQU   NBLK+22
@NM00047 EQU   TMSDT+4
@NM00046 EQU   TMSDT+2
TMSOLDTS EQU   TMSTS+4
@NM00045 EQU   TMSHDR+2
TMSTSCD  EQU   TMSHDR
VGOAREAU EQU   VGOS
@NM00043 EQU   VGOEXT+6
@NM00042 EQU   VGOEXT+1
@NM00041 EQU   CRVENTY+24
@NM00040 EQU   CRVENTY+21
CRVSYCHK EQU   CRVIND
ENTDNLEN EQU   ENTDN
ENTNMLEN EQU   ENTNM+20
ENTNMMEM EQU   ENTNM+12
ENTNMMLN EQU   ENTNM+11
ENTNMFUQ EQU   ENTNMFLG
ENTNMPOS EQU   ENTNM+9
ENTNMPAS EQU   ENTNM+1
ENTNMPLN EQU   ENTNM
OUTDDLEN EQU   OUTDD
PDEVLEN  EQU   PDEV
MRPWLEN  EQU   MRPW
IFILELEN EQU   IFILE
CRADDLEN EQU   CRADD
@NM00039 EQU   OUTFLGS
OPNFLG   EQU   OUTFLGS
RESOUTP  EQU   OUTDAT+12
SAVOIOCS EQU   OUTDAT+4
RESINP   EQU   ENTOBJ+4
AMDEXCP  EQU   AMDSTAT+44
AMDNCAS  EQU   AMDSTAT+40
AMDNCIS  EQU   AMDSTAT+36
AMDASPA  EQU   AMDSTAT+32
AMDRETR  EQU   AMDSTAT+28
AMDUPR   EQU   AMDSTAT+24
AMDIREC  EQU   AMDSTAT+20
AMDDELR  EQU   AMDSTAT+16
AMDNLR   EQU   AMDSTAT+12
AMDNEXT  EQU   AMDSTAT+10
AMDNIL   EQU   AMDSTAT+8
AMDSTSP  EQU   AMDSTAT
@NM00038 EQU   IDAAMDSB+41
@NM00037 EQU   AMDATTR3
AMDLM    EQU   AMDATTR3
AMDWAIT  EQU   AMDATTR3
AMDBIND  EQU   AMDATTR3
AMDFAULT EQU   AMDATTR3
AMDUNQ   EQU   AMDATTR3
AMDPARDB EQU   IDAAMDSB+36
AMDMAXRR EQU   AMDSSRBA
AMDNSLOT EQU   AMDHLRBA
AMDLRECL EQU   IDAAMDSB+24
AMDCINV  EQU   IDAAMDSB+20
AMDFSCI  EQU   IDAAMDSB+16
AMDFSCA  EQU   IDAAMDSB+14
AMDCIPCA EQU   IDAAMDSB+12
AMDPCTCI EQU   IDAAMDSB+11
AMDPCTCA EQU   IDAAMDSB+10
AMDKEYLN EQU   IDAAMDSB+8
AMDRKP   EQU   IDAAMDSB+6
AMDAXRKP EQU   AMDNEST
AMDLEN   EQU   IDAAMDSB+2
AMDSPAN  EQU   AMDATTR
AMDRANGE EQU   AMDATTR
AMDORDER EQU   AMDATTR
AMDREPL  EQU   AMDATTR
AMDSDT   EQU   AMDATTR
AMDWCK   EQU   AMDATTR
AMDDST   EQU   AMDATTR
AMDSBID  EQU   IDAAMDSB
BUFAREA  EQU   BUFELM+8
BUFNEXT  EQU   BUFELM+4
BUFCI    EQU   BUFELM+1
@NM00036 EQU   BUFELM
@NM00035 EQU   BUFSWS
BUFPL    EQU   BUFS+4
FMFLWKAR EQU   FMFL+4
FMFLSUCC EQU   FMFLINDS
@NM00034 EQU   FMFLINDS
@NM00033 EQU   FMPL+17
@NM00032 EQU   ACC+4
@NM00031 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00030 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00029 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00028 EQU   ERCNVTAB+4
@NM00027 EQU   ERCNVTAB+3
@NM00026 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00025 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00024 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00023 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00022 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00021 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00020 EQU   DARGFLGS
DARGFULL EQU   DARGFLGS
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00019 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00018 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00017 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00016 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00015 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00428 EQU   @RC00427
@RT00440 EQU   @RC00423
@RT00501 EQU   @EL00004
@RC00530 EQU   @EL00004
@RC00511 EQU   @EL00004
@RC00506 EQU   @EL00004
@RT00573 EQU   @RC00570
@RC00614 EQU   @RC00611
@RC00670 EQU   @EL00007
@RC00751 EQU   @EL00009
@RC00763 EQU   @EL00009
@RT00841 EQU   @RC00840
@RT00846 EQU   @RC00845
@RC00854 EQU   @RC00852
@RC00863 EQU   @RC00858
@RC00872 EQU   @RC00867
@RC01018 EQU   @RC01017
@RC01063 EQU   @RC01060
@RC01058 EQU   @EL00015
@RC01193 EQU   @RC01176
@RT01191 EQU   @RC01176
@RC01257 EQU   @RC01254
@RC01251 EQU   @EL00017
@RT01273 EQU   @EL00017
@RC01285 EQU   @EL00017
@RC01351 EQU   @RC01347
@RC01421 EQU   @RC01413
@RT01486 EQU   @RC01471
@RC01541 EQU   @EL00023
@PB00023 EQU   @EL00001
@RT00617 EQU   @RC00614
@RC00673 EQU   @RC00670
@RT00699 EQU   @RC00670
@RC01079 EQU   @RC01058
@RT01212 EQU   @RC01193
@RC01288 EQU   @RC01285
@RC01543 EQU   @RC01541
@RC00678 EQU   @RC00673
@RC01082 EQU   @RC01079
@RC01550 EQU   @RC01543
@RC00681 EQU   @RC00678
@RT01553 EQU   @RC01550
@RT00683 EQU   @RC00681
@ENDDATA EQU   *
         END   IDCRC01,(C'PLS1314',0701,77332)

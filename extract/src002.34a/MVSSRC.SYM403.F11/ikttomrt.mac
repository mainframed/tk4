         TITLE '***IKTTOMRT:  ROCKET TERMINAL OUTPUT MANAGER***        *
                        '
IKTTOMRT CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKTTOMRT  78.045'                                 0001
         DROP  @15
@PROLOG  BALR  @08,0                                               0001
@PSTART  LA    @09,4095(,@08)                                      0001
         LA    @10,4095(,@09)                                      0001
         USING @PSTART,@08                                         0001
         USING @PSTART+4095,@09                                    0001
         USING @PSTART+8190,@10                                    0001
*                                                                  0150
         LR    TOMWREG,RTOMW
         USING @DATD,TOMWREG
*           SAVE14 = BRNCHREG;           /* SAVE RETURN ADDRESS      */
         ST    BRNCHREG,SAVE14(,TOMWREG)                           0151
*           RFY (RTOMW,BRNCHREG) UNRSTD;                           0152
*           TSBREG=ASCBTSB;              /* LOAD TSB ADDRESS @ZA24528*/
         L     @01,PSAAOLD                                         0153
         L     TSBREG,ASCBTSB(,@01)                                0153
*           RFY TSB BASED(TSBREG);       /* REBASE THE TSB   @ZA24528*/
*           TSBSAVE=TSBREG;              /* SAVE TSB ADDRESS @ZA24528*/
         ST    TSBREG,TSBSAVE                                      0155
*           TVWAREG=TSBXTVWA;            /* LOAD TVWA ADDRESS@ZA24528*/
         L     @01,TSBEXTNT(,TSBREG)                               0156
         L     TVWAREG,TSBXTVWA(,@01)                              0156
*           RFY TVWA BASED(TVWAREG);     /* REBASE THE TVWA  @ZA24528*/
*           TVWASAVE=TVWAREG;            /* SAVE TVWA ADDRESS@ZA24528*/
         ST    TVWAREG,TVWASAVE                                    0158
*           RPLREG=TOMWREG+320+LENGTH(WORKAREA); /* RPL ADDR @ZA24528*/
         LA    RPLREG,960                                          0159
         ALR   RPLREG,TOMWREG                                      0159
*           RPLSAVE=RPLREG;              /* SAVE RPL ADDRESS @ZA24528*/
         ST    RPLREG,RPLSAVE                                      0160
*           FRRPTR = ADDR(IKTIOFRR);     /* FRR ADDRESS      @ZM20856*/
*                                                                  0161
         L     @01,CVTPTR                                          0161
         L     @01,CVTTCASP(,@01)                                  0161
         L     FRRPTR,TCASFRR(,@01)                                0161
*           /*********************************************************/
*           /* SET UP FUNCTIONAL RECOVERY ROUTINE (IKTIOFRR).        */
*           /*********************************************************/
*                                                                  0162
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    0162
*                                                                  0162
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,FRRSELEN,FLC,
*                         FRRSFRRA,FRRSENTR,FRRSPARM,PSA,PSACSTK,  0163
*                         PSALSFCC,PSALITA)                        0163
*                   SETS(WRK2,WRK3,REGPARM,REG13,REG14);           0163
       SETFRR  A,FRRAD=(FRRPTR),PARMAD=(REGPARM),WRKREGS=(WRK2,WRK3)
A1     SETLOCK OBTAIN,                                                CC
               TYPE=LOCAL,                                            CC
               MODE=UNCOND,                                           CC
               REGS=USE,                                              CC
               RELATED=(A2,'OBTAIN LOCAL LOCK')
*           FRRPARM=REGPARM;          /* SAVE ADDRESS OF           0164
*                                        FRR PARAMETER AREA  @ZM20856*/
         ST    REGPARM,FRRPARM                                     0164
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) UNRSTD;  0165
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/
*CKMC0002:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856
**/            FRWACKPT(2)=ADDR(CKMC0002); /* SAVE ADDRESS    @ZM20856
*/           END;      /* CHECK POINT         @ZM20856*/           0167
CKMC0002 L     @15,TVWAFRWO(,TVWAREG)                              0167
         STM   REG0,REG15,FRWACKRG(@15)                            0167
         LA    @14,CKMC0002                                        0168
         ST    @14,FRWACKPT+4(,@15)                                0168
*           CALL INITFRR;             /* CALL FRR INIT       @ZM20856*/
         BAL   @14,INITFRR                                         0170
*           TVWATIR = '1'B;           /* TOM IS RUNNING              */
*                                                                  0171
         OI    TVWATIR(TVWAREG),B'00001000'                        0171
*           /*********************************************************/
*           /* FOR THE FIRST INVOCATION OF TOM, BUILD THE RPL.       */
*           /*********************************************************/
*                                                                  0172
*           IF TIME1 = '0'B THEN      /* CHECK IF FIRST PASS         */
         TM    TIME1(TOMWREG),B'00010000'                          0172
         BNZ   @RF00172                                            0172
*             DO;                     /* FIRST-PASS PROCESSING       */
*               TIME1 = '1'B;         /* RESET PASS SWITCH           */
         OI    TIME1(TOMWREG),B'00010000'                          0174
*               SWNL = '1'B;          /* START ON NEW LINE           */
         OI    SWNL(TOMWREG),B'01000000'                           0175
*               IFGRPL=DUMMYRPL;      /* INITIALIZE RPL              */
         MVC   IFGRPL(112,RPLREG),DUMMYRPL                         0176
*               RPLDACB=TVWAACB;      /* ACB ADDRESS                 */
         L     @15,TVWAACB(,TVWAREG)                               0177
         ST    @15,RPLDACB(,RPLREG)                                0177
*               RPLARG=NIBCID;        /* CID                         */
         L     @01,TVWANIB(,TVWAREG)                               0178
         L     @15,NIBCID(,@01)                                    0178
         ST    @15,RPLARG(,RPLREG)                                 0178
*               RPLAREA = ADDR(RU);   /* RU ADDRESS                  */
         LA    @15,RU(,TOMWREG)                                    0179
         ST    @15,RPLAREA(,RPLREG)                                0179
*               TVWATOMW = TOMWREG;   /* WORK AREA ADDRESS           */
         ST    TOMWREG,TVWATOMW(,TVWAREG)                          0180
*               STM(REG0,REG15,RETRYREG); /* SAVE REGISTERS USED   0181
*                                        IN RETRY            @ZM20856*/
         STM   REG0,REG15,RETRYREG                                 0181
*             END;                    /* END FIRST-PASS PROCESSING   */
*           ELSE;                     /* NOT FIRST PASS              */
*                                                                  0183
@RF00172 DS    0H                                                  0184
*FRRENTRY:  CALL BLDCHAIN;            /* BUILD CHAINS                */
*                                                                  0184
FRRENTRY BAL   @14,BLDCHAIN                                        0184
*           /*********************************************************/
*           /* TURN OFF BOTH TOM-IS-SCHEDULED AND TOM-IS-RUNNING     */
*           /* SWITCHES.                                    @YM03259 */
*           /*********************************************************/
*                                                                  0185
*           TVWATIS = '0'B;           /* RESET TOM-SCHEDULED SWITCH  */
         NI    TVWATIS(TVWAREG),B'10111111'                        0185
*           TVWATIR = '0'B;           /* RESET TOM-RUNNING SWITCH    */
*                                                                  0186
         NI    TVWATIR(TVWAREG),B'11110111'                        0186
*           /*********************************************************/
*           /* RELEASE LOCAL LOCK AND FRR                            */
*           /*********************************************************/
*                                                                  0187
*           RFY (WRK2,WRK3,REG0,REG1,REG14,REG15) RSTD;            0187
*                                                                  0187
*           GENERATE REFS(PSACSTK,PSA,FRRSCURR,FRRS,FRRSEMP,FRRSELEN,
*                         PSALITA,FLC)                             0188
*                    SETS(WRK2,WRK3,REG13,REG14);                  0188
*                                                                  0188
A2     SETLOCK RELEASE,                                               CC
               TYPE=LOCAL,                                            CC
               REGS=USE,                                              CC
               RELATED=(A1,'RELEASE LOCAL LOCK')
       SETFRR  D,WRKREGS=(WRK2,WRK3)
*           RFY (WRK2,WRK3,REG0,REG1,REG14,REG15) UNRSTD;          0189
*                                                                  0189
*           RFY BRNCHREG RSTD;        /* RESTRICT RETURN REGISTER    */
*           BRNCHREG = SAVE14;        /* RESTORE RETURN ADDRESS      */
         L     BRNCHREG,SAVE14(,TOMWREG)                           0191
*           GEN (BR BRNCHREG)                                      0192
*               REFS(BRNCHREG);       /* RETURN TO CALLER            */
         BR BRNCHREG
*           RFY BRNCHREG UNRSTD;      /* UNRESTRICT RETURN REGISTER  */
         EJECT
*BLDCHAIN:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0194
*                                                                  0194
BLDCHAIN ST    @14,@SA00002                                        0194
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - BLDCHAIN                                  */
*           /*                                                       */
*           /* FUNCTION - TO BUILD CHAINS                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0195
*                                                                  0195
*   /*****************************************************************/
*   /*         STRUCTURE OF BUILD-CHAIN                              */
*   /*****************************************************************/
*   /*                                                               */
*   /*         ***************************************************** */
*   /*         * DO WHILE                                          * */
*   /*         *                                                   * */
*   /*         *               *********************************** * */
*   /*         *               * BLDMSGS                         * * */
*   /*         *               *                **************** * * */
*   /*         *               *                * EDITMSG      * * * */
*   /*         *               *                **************** * * */
*   /*         *               *********************************** * */
*   /*         *    **********************************             * */
*   /*         *    * BLDMID                         *             * */
*   /*         *    *          ********************* *             * */
*   /*         *    *          * BLDEND            * *             * */
*   /*         *    *          ********************* *             * */
*   /*         *    **********************************             * */
*   /*         *               *********************************** * */
*   /*         *               * FIN                             * * */
*   /*         *               *********************************** * */
*   /*         *                                                   * */
*   /*         * END DO WHILE                                      * */
*   /*         ***************************************************** */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0195
*   /*****************************************************************/
*   /*         INITIALIZATION OF BIT VARIABLES:                      */
*   /*         (A) MOR, HLD, FCNERR, PARMERR, RETRYMSG,              */
*   /*             XIT, AND PSENT ARE TURNED OFF.                    */
*   /*         (B) MSG, TSTPRMPT, AND AGAIN ARE TURNED ON.           */
*   /*         NOTE:  A NEW-LINE CHARACTER IS PLACED AT THE END OF   */
*   /*                EACH MESSAGE THAT IS NOT CONTROL, ASIS, OR     */
*   /*                FULLSCR.  WHEN THE RU IS FULL AND A NEW-LINE   */
*   /*                CHARACTER IS NEEDED, SWNL ('START WITH A       */
*   /*                NEW-LINE CHARACTER') IS TURNED ON.             */
*   /*****************************************************************/
*                                                                  0195
*           BITVALU0 = '00000000'B;         /* INITIALIZE VARIABLES  */
         MVI   BITVALU0(TOMWREG),B'00000000'                       0195
*           BITVALU1 = '00000111'B;         /* INITIALIZE VARIABLES  */
*                                                                  0196
         MVI   BITVALU1(TOMWREG),B'00000111'                       0196
*           /*********************************************************/
*           /* INITIALIZE PRINTABLE-CHARACTER COUNT TO 0.            */
*           /* INITIALIZE CHAIN SIZE TO USER-DEFINED CHAIN LENGTH.   */
*           /* INITIALIZE NUMBER OF RU'S IN A CHAIN.                 */
*           /*********************************************************/
*                                                                  0197
*           CHARCNT = 0;                    /* PRINTABLE-CHAR. COUNT */
         SLR   @15,@15                                             0197
         ST    @15,CHARCNT(,TOMWREG)                               0197
*           CHAINSZE = TVWACHNL;            /* CHAIN SIZE            */
         IC    @15,TVWACHNL(,TVWAREG)                              0198
         STC   @15,CHAINSZE(,TOMWREG)                              0198
*           RUCOUNT = CHAINSZE;             /* NO. OF RU'S IN CHAIN  */
*                                                                  0199
         IC    @15,CHAINSZE(,TOMWREG)                              0199
         STC   @15,RUCOUNT(,TOMWREG)                               0199
*           DO WHILE (AGAIN = '1'B);                               0200
*                                                                  0200
         B     @DE00200                                            0200
@DL00200 DS    0H                                                  0201
*             /*******************************************************/
*             /* INITIALIZATION OF BIT VARIABLES:                    */
*             /* (A) BRK, XC, NXC, MORMSGS, ERMG, SKIP, AND BYPASS   */
*             /*     ARE TURNED OFF.                                 */
*             /* (B) REPEAT IS TURNED ON.                            */
*             /*******************************************************/
*                                                                  0201
*             BITVAL00 = '00000000'B;       /* INITIALIZE VARIABLES  */
         MVI   BITVAL00(TOMWREG),B'00000000'                       0201
*             REPEAT = '1'B;                /* REPEAT                */
         OI    REPEAT(TOMWREG),B'00000010'                         0202
*             BYTECNT = 1;                  /* BYTE-POSITION OF RU   */
         MVC   BYTECNT(4,TOMWREG),@CF00064                         0203
*             NOTNOW = '0'B;                /* RESET SWITCH          */
         NI    NOTNOW(TOMWREG),B'11111011'                         0204
*             /*******************************************************/
*             /* IF LOST-TERM ENTERED OR TIM IS GONE,                */
*             /* DO A CLEAN-EXIT.                                    */
*             /*******************************************************/
*             IF TVWALTE = '1'B ×           /* LOSTERM ENTERED?      */
*                TVWATID='1'B THEN          /* IKTTIMRT IS DEAD?     */
         TM    TVWALTE(TVWAREG),B'00010010'                        0205
         BZ    @RF00205                                            0205
*               CALL FINPROC;               /* CALL CLEAN-UP ROUTINE */
         BAL   @14,FINPROC                                         0206
*             ELSE                                                 0207
*               /*****************************************************/
*               /* CHECK IF GLOBAL ERROR HAS OCCURRED, I.E.,         */
*               /* ATTENTION, ATTENTION-IGNORED, OR TIM-ERROR        */
*               /* MESSAGE.                                          */
*               /*****************************************************/
*               IF TVWAGERR = '1'B THEN     /* GLOBAL ERROR?         */
         B     @RC00205                                            0207
@RF00205 TM    TVWAGERR(TVWAREG),B'00010000'                       0207
         BNO   @RF00207                                            0207
*                 DO;                       /* DO THE FOLLOWING      */
*                   SWNL = '0'B;            /* RESET NEW-LINE SWITCH */
         NI    SWNL(TOMWREG),B'10111111'                           0209
*                   ERMG = '1'B;            /* GLOBAL ERROR          */
         OI    ERMG(TOMWREG),B'00001000'                           0210
*                   CALL CHKOCEOC;          /* CANCEL CHAIN  @ZA27108*/
         BAL   @14,CHKOCEOC                                        0211
*                   SKIP = '1'B;            /* SKIP BLDMSGS          */
         OI    SKIP(TOMWREG),B'00000010'                           0212
*                   TVWABKMG = '0'B;        /* NO PARTIAL MESSAGE    */
         NI    TVWABKMG(TVWAREG),B'11111011'                       0213
*                   SIGSENT = '0'B;         /* RESET SIGNAL SWITCH   */
*                   PROMPT = '0'B;          /* RESET PROMPT SWITCH   */
         NI    SIGSENT(TOMWREG),B'01101111'                        0215
*                   /*************************************************/
*                   /* IF ATTENTION OR ATTENTION-IGNORED,            */
*                   /* CALL ATTENTION-HANDLING ROUTINE.              */
*                   /* OTHERWISE, CALL TIM-ERROR-MESSAGE ROUTINE.    */
*                   /*************************************************/
*                   IF TVWAATTN > 0 ×       /* ATTENTION(S)?         */
*                      TVWAAIGN='1'B THEN   /* ATTENTION IGNORED?    */
         CLI   TVWAATTN(TVWAREG),0                                 0216
         BH    @RT00216                                            0216
         TM    TVWAAIGN(TVWAREG),B'00100000'                       0216
         BNO   @RF00216                                            0216
@RT00216 DS    0H                                                  0217
*                     CALL ATTNROUT;        /* CALL ATTENTION ROUTINE*/
         BAL   @14,ATTNROUT                                        0217
*                   ELSE                    /* TIM-ERROR-MESSAGE CASE*/
*                     /***********************************************/
*                     /* PLACE 'INPUT DATA LOST' MESSAGE INTO RU     */
*                     /* WHICH WAS ISSUED BY IKTTIMRT TO INDICATE    */
*                     /* THAT EITHER DATA NOT BEING RECEIVED         */
*                     /* PROPERLY OR DATA UNABLE TO BE PLACED ON     */
*                     /* INPUT QUEUE.                                */
*                     /***********************************************/
*                     DO;                   /* PROCESS ERROR MESSAGE */
         B     @RC00216                                            0218
@RF00216 DS    0H                                                  0219
*                       RU(BYTECNT) = NL;   /* START ON NEW LINE     */
         L     @15,BYTECNT(,TOMWREG)                               0219
         ALR   @15,TOMWREG                                         0219
         MVC   RU-1(1,@15),NL                                      0219
*                       BYTECNT=BYTECNT+1;  /* INCREMENT RU POSITION */
         LA    @15,1                                               0220
         L     @14,BYTECNT(,TOMWREG)                               0220
         ALR   @14,@15                                             0220
         ST    @14,BYTECNT(,TOMWREG)                               0220
*                       TVWAERMG = '0'B;    /* RESET ERROR SWITCH    */
         NI    TVWAERMG(TVWAREG),B'11110111'                       0221
*                       I = INPUTERR;       /* ERROR ON INPUT        */
         LA    @05,4                                               0222
         ST    @05,I(,TOMWREG)                                     0222
*                       RU(BYTECNT:BYTECNT+MSGSIZE-1)              0223
*                             = MSGDATA(1:MSGSIZE);                0223
         ALR   @14,TOMWREG                                         0223
         SLA   @05,2                                               0223
         L     @01,CVTPTR                                          0223
         L     @01,CVTTCASP(,@01)                                  0223
         L     @01,TCASMSGS(,@01)                                  0223
         AL    @01,@CF02987                                        0223
         L     @05,MSGADR(@05,@01)                                 0223
         LH    @04,MSGSIZE(,@05)                                   0223
         LR    @03,@04                                             0223
         BCTR  @03,0                                               0223
         EX    @03,@SM02988                                        0223
*                       BYTECNT=BYTECNT+MSGSIZE; /* INCREMENT BYTECNT*/
         L     @05,BYTECNT(,TOMWREG)                               0224
         ALR   @05,@04                                             0224
         ST    @05,BYTECNT(,TOMWREG)                               0224
*                       RU(BYTECNT) = NL;   /* GO TO NEXT LINE       */
         ALR   @05,TOMWREG                                         0225
         MVC   RU-1(1,@05),NL                                      0225
*                       BYTECNT=BYTECNT+1;  /* INCREMENT RU POSITION */
         L     @14,BYTECNT(,TOMWREG)                               0226
         ALR   @14,@15                                             0226
         ST    @14,BYTECNT(,TOMWREG)                               0226
*                     END;                  /* END MESSAGE PROCESSING*/
*                 END;                      /* END OF GLOBAL ERROR   */
*               ELSE                        /* NOT GLOBAL ERROR      */
*                 IF RETRYMSG = '1'B THEN   /* RETRY MESSAGE?        */
         B     @RC00207                                            0229
@RF00207 TM    RETRYMSG(TOMWREG),B'00001000'                       0229
         BNO   @RF00229                                            0229
*                   DO;                     /* PROCESS RETRY MESSAGE */
*                     SKIP = '1'B;          /* SKIP BLDMSGS          */
*                     XC = '1'B;            /* ENSURE OC (BLDMID)    */
*                     ERMG = '0'B;          /* NO GLOBAL ERROR       */
         OI    SKIP(TOMWREG),B'01000010'                           0233
         NI    ERMG(TOMWREG),B'11110111'                           0233
*                     SPEC = '0'B;          /* RESET SPECIAL SWITCH  */
         NI    SPEC(TOMWREG),B'11011111'                           0234
*                     RU(BYTECNT) = NL;     /* START ON NEW LINE     */
         L     @15,BYTECNT(,TOMWREG)                               0235
         ALR   @15,TOMWREG                                         0235
         MVC   RU-1(1,@15),NL                                      0235
*                     BYTECNT=BYTECNT+1;    /* INCREMENT RU POSITION */
         LA    @15,1                                               0236
         L     @14,BYTECNT(,TOMWREG)                               0236
         ALR   @14,@15                                             0236
         ST    @14,BYTECNT(,TOMWREG)                               0236
*                     I = OUTERR;           /* ERROR ON OUTPUT       */
         LA    @05,7                                               0237
         ST    @05,I(,TOMWREG)                                     0237
*                     RU(BYTECNT:BYTECNT+MSGSIZE-1)                0238
*                            = MSGDATA(1:MSGSIZE);                 0238
         ALR   @14,TOMWREG                                         0238
         SLA   @05,2                                               0238
         L     @01,CVTPTR                                          0238
         L     @01,CVTTCASP(,@01)                                  0238
         L     @01,TCASMSGS(,@01)                                  0238
         AL    @01,@CF02987                                        0238
         L     @05,MSGADR(@05,@01)                                 0238
         LH    @04,MSGSIZE(,@05)                                   0238
         LR    @03,@04                                             0238
         BCTR  @03,0                                               0238
         EX    @03,@SM02988                                        0238
*                     BYTECNT=BYTECNT+MSGSIZE; /* INCREMENT BYTECNT  */
         L     @05,BYTECNT(,TOMWREG)                               0239
         ALR   @05,@04                                             0239
         ST    @05,BYTECNT(,TOMWREG)                               0239
*                     RU(BYTECNT) = NL;     /* GO TO NEXT LINE       */
         ALR   @05,TOMWREG                                         0240
         MVC   RU-1(1,@05),NL                                      0240
*                     BYTECNT=BYTECNT+1;    /* INCREMENT RU POSITION */
         L     @14,BYTECNT(,TOMWREG)                               0241
         ALR   @14,@15                                             0241
         ST    @14,BYTECNT(,TOMWREG)                               0241
*                     SWNL = '0'B;          /* ALREADY ON NEW LINE   */
         NI    SWNL(TOMWREG),B'10111111'                           0242
*                   END;                    /* END MESSAGE PROCESSING*/
*                 ELSE;                                            0244
*                                                                  0244
@RF00229 DS    0H                                                  0245
*             IF SKIP = '1'B ×              /* SKIP BLDMSGS?         */
*                MSG='0'B ×                 /* NO MESSAGE ON QUEUE?  */
*                SENDPRMT='1'B THEN;        /* SEND PROMPT ONLY?     */
@RC00207 DS    0H                                                  0245
@RC00205 TM    SKIP(TOMWREG),B'00000010'                           0245
         BO    @RT00245                                            0245
         TM    MSG(TOMWREG),B'00000100'                            0245
         BZ    @RT00245                                            0245
         TM    SENDPRMT(TOMWREG),B'00001000'                       0245
         BO    @RT00245                                            0245
*             ELSE                          /* DO NOT SKIP BLDMSGS   */
*               CALL BLDMSGS;               /* BUILD MESSAGES        */
*                                                                  0247
         BAL   @14,BLDMSGS                                         0247
*             CALL BLDMID;                                         0248
*                                                                  0248
@RT00245 BAL   @14,BLDMID                                          0248
*             IF XIT = '0'B THEN            /* EXIT MODULE?          */
         TM    XIT(TOMWREG),B'00000100'                            0249
         BNZ   @RF00249                                            0249
*               CALL FIN;                   /* DO FINAL PROCESSING   */
         BAL   @14,FIN                                             0250
*             ELSE;                         /* DO NOT EXIT MODULE    */
*                                                                  0251
@RF00249 DS    0H                                                  0252
*           END;                                                   0252
*                                                                  0252
@DE00200 TM    AGAIN(TOMWREG),B'00000001'                          0252
         BO    @DL00200                                            0252
*           END BLDCHAIN;                   /* END OF BLDCHAIN       */
@EL00002 DS    0H                                                  0253
@EF00002 DS    0H                                                  0253
@ER00002 L     @14,@SA00002                                        0253
         BR    @14                                                 0253
         EJECT
*/********************************************************************/
*/*                                                                  */
*/* SUBROUTINE-                                                      */
*/*      FINPROC                                                     */
*/*                                                                  */
*/* FUNCTION-                                                        */
*/*      PERMANENT EXIT.                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0254
*FINPROC:                                                          0254
*   PROCEDURE OPTIONS(NOSAVE);      /* CALL IKTEXIT          @ZM21235*/
FINPROC  DS    0H                                                  0255
*   RFY                                                            0255
*     REG1 RSTD;                    /* PARAMETER POINTER     @ZM21235*/
*   REG1=ADDR(PLXPARMS);            /* ADDRESS PARAMETER LIST      0256
*                                                            @ZM21235*/
         LA    REG1,PLXPARMS                                       0256
*   CALL IKTEXIT;                   /* PERMANENT EXIT        @ZM21235*/
         L     @14,CVTPTR                                          0257
         L     @14,CVTTCASP(,@14)                                  0257
         L     @15,TCASEXIT(,@14)                                  0257
         BALR  @14,@15                                             0257
*   RFY                                                            0258
*     REG1 UNRSTD;                  /* PARAMETER POINTER     @ZM21235*/
*   END FINPROC;                    /* END OF SUBROUTINE     @ZM21235*/
@EL00003 DS    0H                                                  0259
@EF00003 DS    0H                                                  0259
@ER00003 BR    @14                                                 0259
         EJECT
*BLDMSGS:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0260
BLDMSGS  ST    @14,@SA00004                                        0260
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - BLDMSGS                                   */
*           /*                                                       */
*           /* FUNCTION - TO PREPARE MESSAGES FOR PLACEMENT INTO RU  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0261
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/
*CKMC0003:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856
**/            FRWACKPT(2)=ADDR(CKMC0003); /* SAVE ADDRESS    @ZM20856
*/           END;            /* CHECK POINT   @ZM20856*/           0262
*                                                                  0262
CKMC0003 L     @15,TVWAFRWO(,TVWAREG)                              0262
         STM   REG0,REG15,FRWACKRG(@15)                            0262
         LA    @14,CKMC0003                                        0263
         ST    @14,FRWACKPT+4(,@15)                                0263
*           OPREQ = OBTAINO;                /* OBTAIN MESSAGE        */
         MVI   OPREQ(TOMWREG),X'02'                                0265
*           CALL IKTQMOUT(OPARMS);          /* CALL QUEUE MANAGER    */
*                                                                  0266
         LA    @15,OPARMS(,TOMWREG)                                0266
         ST    @15,@AL00001                                        0266
         L     @01,CVTPTR                                          0266
         L     @01,CVTTCASP(,@01)                                  0266
         L     @15,TCASOQM(,@01)                                   0266
         LA    @01,@AL00001                                        0266
         BALR  @14,@15                                             0266
*           /*********************************************************/
*           /* IF MESSAGE AVAILABLE                                  */
*           /*********************************************************/
*           IF OPRC = MORQMSGS ×            /* MESSAGES ON QUEUE?    */
*              OPRC = ONEQMSG THEN          /* ONE MESSAGE ON QUEUE? */
         CLI   OPRC(TOMWREG),1                                     0267
         BE    @RT00267                                            0267
         CLI   OPRC(TOMWREG),2                                     0267
         BNE   @RF00267                                            0267
@RT00267 DS    0H                                                  0268
*             /*******************************************************/
*             /* IF PART OF PREVIOUS MESSAGE WAS NOT PROCESSED       */
*             /*******************************************************/
*             IF MOR = '1'B THEN            /* MIDDLE OF MESSAGE?    */
         TM    MOR(TOMWREG),B'10000000'                            0268
         BNO   @RF00268                                            0268
*               /*****************************************************/
*               /* IF THE PREVIOUS MESSAGE IS STILL THERE,           */
*               /* LEAVE CHAIN ALONE.                                */
*               /*****************************************************/
*               IF OPBUFADR = BUFPTR THEN;  /* SAME MESSAGE?         */
         CLC   OPBUFADR(4,TOMWREG),BUFPTR(TOMWREG)                 0269
         BE    @RT00269                                            0269
*               ELSE                        /* DIFFERENT MESSAGE     */
*                 DO;                       /* DO THE FOLLOWING      */
*                   CALL CHKOCEOC;          /* CANCEL CHAIN          */
         BAL   @14,CHKOCEOC                                        0272
*                   MOR = '0'B;             /* NEW MESSAGE           */
         NI    MOR(TOMWREG),B'01111111'                            0273
*                 END;                      /* CHAIN CANCELED        */
*             ELSE                          /* NEW MESSAGE           */
*               SPEC = '0'B;                /* NOT SPECIAL CASE      */
         B     @RC00268                                            0275
@RF00268 NI    SPEC(TOMWREG),B'11011111'                           0275
*           ELSE                            /* MESSAGE NOT AVAILABLE */
*             DO;                           /* DO THE FOLLOWING      */
         B     @RC00267                                            0276
@RF00267 DS    0H                                                  0277
*               /*****************************************************/
*               /* WHEN MESSAGE IS NOT AVAILABLE AND PART OF         */
*               /* PREVIOUS MESSAGE WAS NOT PROCESSED, CANCEL        */
*               /* CHAIN IF NECESSARY.                               */
*               /* WHEN MESSAGE IS NOT AVAILABLE AND ALL OF THE      */
*               /* PREVIOUS MESSAGE WAS PROCESSED, SKIP THE REST     */
*               /* OF THIS PROCEDURE.                                */
*               /*****************************************************/
*               IF MOR = '1'B THEN          /* MIDDLE OF MESSAGE     */
         TM    MOR(TOMWREG),B'10000000'                            0277
         BNO   @RF00277                                            0277
*                 DO;                       /* DO THE FOLLOWING      */
*                   CALL CHKOCEOC;          /* CANCEL CHAIN          */
         BAL   @14,CHKOCEOC                                        0279
*                   MOR = '0'B;             /* END OF MESSAGE        */
         NI    MOR(TOMWREG),B'01111111'                            0280
*                 END;                      /* CHAIN CANCELED        */
*               ELSE;                       /* NOT MIDDLE OF MESSAGE */
@RF00277 DS    0H                                                  0283
*               SPEC = '0'B;                /* NOT A SPECIAL CASE    */
         NI    SPEC(TOMWREG),B'11011111'                           0283
*               MSG = '0'B;                 /* NO MESSAGE AVAILABLE  */
         NI    MSG(TOMWREG),B'11111011'                            0284
*               SKIP = '1'B;                /* SKIP THE FOLLOWING    */
         OI    SKIP(TOMWREG),B'00000010'                           0285
*             END;                                                 0286
*           /*********************************************************/
*           /* IF NO MESSAGE AVAILABLE, SKIP THE FOLLOWING.          */
*           /*********************************************************/
*           IF SKIP = '1'B THEN;            /* SKIP THE FOLLOWING    */
@RC00267 TM    SKIP(TOMWREG),B'00000010'                           0287
         BO    @RT00287                                            0287
*           ELSE                            /* DO THE FOLLOWING      */
*             DO;                                                  0289
*               IF SPEC = '0'B THEN         /* NOT SPECIAL CASE?     */
         TM    SPEC(TOMWREG),B'00100000'                           0290
         BNZ   @RF00290                                            0290
*                 DO;                       /* ESTIMATE MESSAGE SIZE */
*                   ESTIMATE = OPBFSZ + (OPBFSZ/TSBLNSZ) + 2;      0292
         LH    @15,OPBFSZ(,TOMWREG)                                0292
         LR    @00,@15                                             0292
         SRDA  @00,32                                              0292
         SLR   @14,@14                                             0292
         IC    @14,TSBLNSZ(,TSBREG)                                0292
         DR    @00,@14                                             0292
         ALR   @15,@01                                             0292
         AL    @15,@CF00076                                        0292
         ST    @15,ESTIMATE(,TOMWREG)                              0292
*                   IF ESTIMATE > (257-BYTECNT)+(RUCOUNT-1)*256 THEN
         LA    @14,257                                             0293
         SL    @14,BYTECNT(,TOMWREG)                               0293
         SLR   @05,@05                                             0293
         IC    @05,RUCOUNT(,TOMWREG)                               0293
         BCTR  @05,0                                               0293
         SLA   @05,8                                               0293
         ALR   @14,@05                                             0293
         CR    @15,@14                                             0293
         BNH   @RF00293                                            0293
*                                           /* MESSAGE TOO LARGE?    */
*                     SPEC = '1'B;          /* SPECIAL CASE          */
         OI    SPEC(TOMWREG),B'00100000'                           0294
*                   ELSE;                   /* MESSAGE FITS          */
@RF00293 DS    0H                                                  0296
*                 END;                      /* END OF ESTIMATION     */
*               ELSE;                       /* SPECIAL CASE          */
@RF00290 DS    0H                                                  0298
*               /*****************************************************/
*               /* IF MESSAGE IS BREAKIN, CROSS-MEMORY, OR CONTROL,  */
*               /* THEN TURN ON  EXCEPTION SWITCH (XC = '1'B).       */
*               /*****************************************************/
*               IF OPBRK = '1'B THEN        /* BREAKIN TPUT?         */
         TM    OPBRK(TOMWREG),B'01000000'                          0298
         BNO   @RF00298                                            0298
*                 DO;                       /* DO THE FOLLOWING      */
*                   TVWABIR = '0'B;         /* RESET BREAK SWITCH    */
         NI    TVWABIR(TVWAREG),B'11111110'                        0300
*                   IF MOR = '0'B           /* CHECK IF NEW MESSAGE  */
*                   THEN                    /* NEW MESSAGE           */
         TM    MOR(TOMWREG),B'10000000'                            0301
         BNZ   @RF00301                                            0301
*                     SWNL = '1'B;          /* START ON NEW LINE     */
         OI    SWNL(TOMWREG),B'01000000'                           0302
*                   ELSE;                   /* NOT NEW MESSAGE       */
@RF00301 DS    0H                                                  0304
*                   BRK = '1'B;             /* BREAKIN MESSAGE       */
*                   XC = '1'B;              /* EXCEPTION MESSAGE     */
         OI    BRK(TOMWREG),B'11000000'                            0305
*                 END;                      /* END BREAK PROCESSING  */
*               ELSE;                       /* NOT BREAKIN TPUT      */
@RF00298 DS    0H                                                  0308
*               IF OPEDIT = '10'B THEN      /* CONTROL TPUT?         */
         TM    OPEDIT(TOMWREG),B'00100000'                         0308
         BNO   @RF00308                                            0308
         TM    OPEDIT(TOMWREG),B'00010000'                         0308
         BNZ   @RF00308                                            0308
*                 XC = '1'B;                /* EXCEPTION CONDITION   */
         OI    XC(TOMWREG),B'01000000'                             0309
*               ELSE;                       /* NOT CONTROL TPUT      */
@RF00308 DS    0H                                                  0311
*               IF OPASID = '1'B THEN       /* CROSS-MEMORY TPUT?    */
         TM    OPASID(TOMWREG),B'00001000'                         0311
         BNO   @RF00311                                            0311
*                 DO;                       /* DO THE FOLLOWING      */
*                   XC = '1'B;              /* EXCEPTION CONDITION   */
         OI    XC(TOMWREG),B'01000000'                             0313
*                   IF MOR = '0'B THEN      /* NEW MESSAGE?          */
         TM    MOR(TOMWREG),B'10000000'                            0314
         BNZ   @RF00314                                            0314
*                     SWNL = '1'B;          /* START ON NEW LINE     */
         OI    SWNL(TOMWREG),B'01000000'                           0315
*                   ELSE;                   /* NOT NEW MESSAGE       */
@RF00314 DS    0H                                                  0317
*                 END;                      /* END OF X-MEMORY TPUT  */
*               ELSE;                       /* NOT CROSS-MEMORY MSG  */
@RF00311 DS    0H                                                  0319
*               IF XC = '1'B ×              /* TPUT IS X-MEMORY,   0319
*                                              BREAKIN, OR CONTROL?  */
*                  SPEC = '1'B THEN         /* MESSAGE LARGER THAN 0319
*                                              ONE CHAIN?            */
         TM    XC(TOMWREG),B'01000000'                             0319
         BO    @RT00319                                            0319
         TM    SPEC(TOMWREG),B'00100000'                           0319
         BNO   @RF00319                                            0319
@RT00319 DS    0H                                                  0320
*                 DO;                       /* OR SPECIAL CASE       */
*                   /*************************************************/
*                   /* AT THIS POINT, MOR='0'B MEANS THAT THE        */
*                   /* CURRENT MESSAGE IS NOT PART OF A PREVIOUS     */
*                   /* MESSAGE.  THUS, IF MOR='0'B, INITIALIZE THE   */
*                   /* RU COUNT TO THE CHAIN SIZE OF 3 (ANY INTEGER  */
*                   /* > 2 WILL DO) SO THAT IN BLDMID THE            */
*                   /* CHAIN-ELEMENT WILL BE SET TO BEGINNING OF     */
*                   /* CHAIN.                                        */
*                   /* IF MOR ^= '0'B, SET RU COUNT DIFFERENT FROM   */
*                   /* CHAIN SIZE SO THAT IN BLDMID THE              */
*                   /* CHAIN-ELEMENT WILL NOT BE SET TO              */
*                   /* BEGINNING-OF-CHAIN.                           */
*                   /*************************************************/
*                   CHAINSZE = 3;           /* INITIALIZE CHAIN SIZE */
         MVI   CHAINSZE(TOMWREG),X'03'                             0321
*                   IF MOR = '0'B THEN      /* NEW MESSAGE?          */
         TM    MOR(TOMWREG),B'10000000'                            0322
         BNZ   @RF00322                                            0322
*                     RUCOUNT = CHAINSZE;   /* BOC OR OC             */
         IC    @15,CHAINSZE(,TOMWREG)                              0323
         STC   @15,RUCOUNT(,TOMWREG)                               0323
*                   ELSE                    /* OTHERWISE, MOC OR EOC */
*                     RUCOUNT=CHAINSZE - 1; /* SET RUCOUNT ^= CHAINSZE
*                                              AND > 1 SO THAT THE 0324
*                                              CHAIN ELEMENT WILL NOT
*                                              BE SET TO BEGINNING OF
*                                              CHAIN.                */
         B     @RC00322                                            0324
@RF00322 SLR   @15,@15                                             0324
         IC    @15,CHAINSZE(,TOMWREG)                              0324
         BCTR  @15,0                                               0324
         STC   @15,RUCOUNT(,TOMWREG)                               0324
*                   CALL EDITMSG;           /* EDIT MESSAGE          */
@RC00322 BAL   @14,EDITMSG                                         0325
*                   MORMSGS = '0'B;         /* LET CHAIN CONSIST OF
*                                              EXCEPTION MESSAGE ONLY*/
         NI    MORMSGS(TOMWREG),B'11101111'                        0326
*                   /*************************************************/
*                   /* IF MORE OF MESSAGE YET TO BE PROCESSED,       */
*                   /* UPDATE MESSAGE POINTER.                       */
*                   /*************************************************/
*                   IF MOR = '1'B THEN      /* MIDDLE OF MESSAGE?    */
         TM    MOR(TOMWREG),B'10000000'                            0327
         BNO   @RF00327                                            0327
*                     DO;                   /* DO THE FOLLOWING      */
*                       OPREQ = UPDATO;     /* UPDATE MESSAGE POINTER*/
         MVI   OPREQ(TOMWREG),X'04'                                0329
*                       OPBUFADR = BUFPTR;  /* MESSAGE ADDRESS       */
         L     @15,BUFPTR(,TOMWREG)                                0330
         ST    @15,OPBUFADR(,TOMWREG)                              0330
*                       CALL IKTQMOUT(OPARMS);                     0331
         LA    @15,OPARMS(,TOMWREG)                                0331
         ST    @15,@AL00001                                        0331
         L     @01,CVTPTR                                          0331
         L     @01,CVTTCASP(,@01)                                  0331
         L     @15,TCASOQM(,@01)                                   0331
         LA    @01,@AL00001                                        0331
         BALR  @14,@15                                             0331
*                     END;                  /* MSG. POINTER UPDATED  */
*                   ELSE                    /* END OF MESSAGE        */
*                     IF OPHOLD = '1'B THEN /* TPUT HOLD MESSAGE?    */
         B     @RC00327                                            0333
@RF00327 TM    OPHOLD(TOMWREG),B'10000000'                         0333
         BNO   @RF00333                                            0333
*                       HLD = '1'B;         /* TURN ON HOLD SWITCH.  */
         OI    HLD(TOMWREG),B'01000000'                            0334
*                     ELSE;                 /* NOT TPUT-HOLD MESSAGE */
@RF00333 DS    0H                                                  0336
*                 END;                      /* END SPECIAL PROCESSING*/
*               ELSE                        /* NOT SPECIAL CASE      */
*                 /***************************************************/
*                 /* BLOCK AS MANY MESSAGES (THAT ARE NOT            */
*                 /* EXCEPTIONAL) AS POSSIBLE INTO THE RU UNTIL THE  */
*                 /* OUTPUT MESSAGE QUEUE IS EMPTY OR THE RU IS FULL.*/
*                 /***************************************************/
*                 DO WHILE (REPEAT = '1'B);                        0337
         B     @RC00319                                            0337
@RF00319 B     @DE00337                                            0337
@DL00337 DS    0H                                                  0338
*                   /*************************************************/
*                   /* IF THERE ARE MORE MESSAGES ON THE QUEUE,      */
*                   /* CHECK IF NEXT MESSAGE IS AN EXCEPTION         */
*                   /* MESSAGE.                                      */
*                   /*************************************************/
*                   IF OPRC = MORQMSGS THEN /* MORE MESSAGES?        */
         CLI   OPRC(TOMWREG),1                                     0338
         BNE   @RF00338                                            0338
*                     DO;                   /* DO THE FOLLOWING      */
*                       MORMSGS = '1'B;     /* MORE MESSAGES ON QUEUE*/
*                                                                  0340
         OI    MORMSGS(TOMWREG),B'00010000'                        0340
*                       /*********************************************/
*                       /* IF NEXT MESSAGE IS CROSS-MEMORY, BREAKIN, */
*                       /* OR EDIT, TURN ON EXCEPTION INDICATOR      */
*                       /* FOR NEXT MESSAGE (NXC = '1'B).            */
*                       /*********************************************/
*                       IF OPNXASID = '1'B × /* NEXT TPUT A X-MEMORY?*/
*                          OPNXBRK = '1'B ×  /* NEXT TPUT A BREAKIN? */
*                          OPNXEDIT = '10'B THEN /* NEXT-CONTROL MSG?*/
         TM    OPNXASID(TOMWREG),B'01001000'                       0341
         BNZ   @RT00341                                            0341
         TM    OPNXEDIT(TOMWREG),B'00100000'                       0341
         BNO   @RF00341                                            0341
         TM    OPNXEDIT(TOMWREG),B'00010000'                       0341
         BNZ   @RF00341                                            0341
@RT00341 DS    0H                                                  0342
*                         NXC = '1'B;        /* NEXT TPUT EXCEPTIONAL*/
         OI    NXC(TOMWREG),B'00100000'                            0342
*                       ELSE;                                      0343
*                                                                  0343
@RF00341 DS    0H                                                  0344
*                     END;                   /* END OF MORE MESSAGES */
*                                                                  0344
*                   ELSE                    /* QUEUE IS EMPTY        */
*                     MORMSGS = '0'B;       /* QUEUE IS EMPTY        */
         B     @RC00338                                            0345
@RF00338 NI    MORMSGS(TOMWREG),B'11101111'                        0345
*                   CALL EDITMSG;           /* EDIT MESSAGE          */
@RC00338 BAL   @14,EDITMSG                                         0346
*                   IF MOR = '1'B THEN      /* MIDDLE OF MESSAGE?    */
         TM    MOR(TOMWREG),B'10000000'                            0347
         BNO   @RF00347                                            0347
*                     DO;                   /* UPDATE MESSAGE POINTER*/
*                       OPREQ = UPDATO;     /* UPDATE MESSAGE POINTER*/
         MVI   OPREQ(TOMWREG),X'04'                                0349
*                       OPBUFADR = BUFPTR;  /* UPDATE MESSAGE POINTER*/
         L     @15,BUFPTR(,TOMWREG)                                0350
         ST    @15,OPBUFADR(,TOMWREG)                              0350
*                       CALL IKTQMOUT(OPARMS);                     0351
         LA    @15,OPARMS(,TOMWREG)                                0351
         ST    @15,@AL00001                                        0351
         L     @01,CVTPTR                                          0351
         L     @01,CVTTCASP(,@01)                                  0351
         L     @15,TCASOQM(,@01)                                   0351
         LA    @01,@AL00001                                        0351
         BALR  @14,@15                                             0351
*                       REPEAT = '0'B;      /* RU FULL-DO NOT REPEAT */
         NI    REPEAT(TOMWREG),B'11111101'                         0352
*                     END;                  /* POINTER UPDATED       */
*                   ELSE                    /* END OF MESSAGE        */
*                     DO;                   /* DO THE FOLLOWING      */
         B     @RC00347                                            0354
@RF00347 DS    0H                                                  0355
*                       IF OPHOLD='1'B THEN /* TPUT HOLD MESSAGE?    */
         TM    OPHOLD(TOMWREG),B'10000000'                         0355
         BNO   @RF00355                                            0355
*                         HLD = '1'B;       /* TURN ON HOLD SWITCH.  */
         OI    HLD(TOMWREG),B'01000000'                            0356
*                       ELSE;               /* NOT TPUT HOLD MESSAGE */
*                                                                  0357
@RF00355 DS    0H                                                  0358
*                       /*********************************************/
*                       /* IF THE RU IS NOT FULL AND IF THERE ARE    */
*                       /* MESSAGES ON THE QUEUE AND THE NEXT        */
*                       /* MESSAGE IS NOT EXCEPTIONAL, OBTAIN NEXT   */
*                       /* MESSAGE.                                  */
*                       /*********************************************/
*                       IF BYTECNT<256 &    /* RU NOT FULL?          */
*                          MORMSGS='1'B &   /* MORE MESSAGES?        */
*                          NXC='0'B THEN    /* NEXT TPUT ^EXCEPTION? */
         L     @15,BYTECNT(,TOMWREG)                               0358
         C     @15,@CF00684                                        0358
         BNL   @RF00358                                            0358
         TM    MORMSGS(TOMWREG),B'00010000'                        0358
         BNO   @RF00358                                            0358
         TM    NXC(TOMWREG),B'00100000'                            0358
         BNZ   @RF00358                                            0358
*                         DO;                                      0359
*                           ESTIMATE = OPNXBFSZ+(OPNXBFSZ/TSBLNSZ)+2;
         LH    @14,OPNXBFSZ(,TOMWREG)                              0360
         LR    @00,@14                                             0360
         SRDA  @00,32                                              0360
         SLR   @05,@05                                             0360
         IC    @05,TSBLNSZ(,TSBREG)                                0360
         DR    @00,@05                                             0360
         ALR   @14,@01                                             0360
         AL    @14,@CF00076                                        0360
         ST    @14,ESTIMATE(,TOMWREG)                              0360
*                           IF ESTIMATE <= (257-BYTECNT)           0361
*                                          + (RUCOUNT-1)*256 THEN  0361
         LCR   @15,@15                                             0361
         AL    @15,@CF02797                                        0361
         SLR   @05,@05                                             0361
         IC    @05,RUCOUNT(,TOMWREG)                               0361
         BCTR  @05,0                                               0361
         SLA   @05,8                                               0361
         ALR   @15,@05                                             0361
         CR    @14,@15                                             0361
         BH    @RF00361                                            0361
*                             DO;                                  0362
*                               OPREQ = OBTAINO;                   0363
         MVI   OPREQ(TOMWREG),X'02'                                0363
*                               CALL IKTQMOUT(OPARMS);             0364
         LA    @15,OPARMS(,TOMWREG)                                0364
         ST    @15,@AL00001                                        0364
         L     @01,CVTPTR                                          0364
         L     @01,CVTTCASP(,@01)                                  0364
         L     @15,TCASOQM(,@01)                                   0364
         LA    @01,@AL00001                                        0364
         BALR  @14,@15                                             0364
*                             END;                                 0365
*                           ELSE                                   0366
*                             DO;                                  0366
         B     @RC00361                                            0366
@RF00361 DS    0H                                                  0367
*                               REPEAT='0'B; /* END BLOCKING OF    0367
*                                               MESSAGES             */
         NI    REPEAT(TOMWREG),B'11111101'                         0367
*                               NXC='1'B;    /* TREAT NEXT MESSAGE AS
*                                               EXCEPTION TO END   0368
*                                               CURRENT CHAIN        */
         OI    NXC(TOMWREG),B'00100000'                            0368
*                             END;                                 0369
*                         END;                                     0370
*                       ELSE                                       0371
*                         REPEAT = '0'B;     /* END MESSAGE BLOCKING */
*                                                                  0371
         B     @RC00358                                            0371
@RF00358 NI    REPEAT(TOMWREG),B'11111101'                         0371
*                     END;                                         0372
*                                                                  0372
@RC00358 DS    0H                                                  0373
*                 END;                       /* END MESSAGE BLOCKING */
@RC00347 DS    0H                                                  0373
@DE00337 TM    REPEAT(TOMWREG),B'00000010'                         0373
         BO    @DL00337                                            0373
*             END;                                                 0374
*                                                                  0374
*           END BLDMSGS;            /* END OF BLDMSGS                */
@EL00004 DS    0H                                                  0375
@EF00004 DS    0H                                                  0375
@ER00004 L     @14,@SA00004                                        0375
         BR    @14                                                 0375
         EJECT
*BLDMID:    PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0376
*                                                                  0376
BLDMID   ST    @14,@SA00005                                        0376
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - BLDMID                                    */
*           /*                                                       */
*           /* FUNCTION - TO PREPARE RU FOR OUTPUT                   */
*           /*     (A) DETERMINE IF PROMPT IS AVAILABLE AND IF IT    */
*           /*         SHOULD BE PLACED IN RU AT THIS TIME.          */
*           /*     (B) DETERMINE IF USER TRANSLATION OR ASCII        */
*           /*         TRANSLATION SHOULD BE DONE.                   */
*           /*     (C) DETERMINE CHAIN ELEMENT IF NECESSARY.         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0377
*           /*********************************************************/
*           /* WHEN START-WITH-NEW-LINE CHARACTER IS INDICATED AND   */
*           /* THE RU IS NOT FULL (--BOTH CONDITIONS ARE POSSIBLE AT */
*           /* THIS POINT IF BLDMSGS WAS ENTERED BUT THERE WAS NO    */
*           /* MESSAGE ON THE QUEUE), ADD NEW-LINE CHARACTER TO RU.  */
*           /*********************************************************/
*                                                                  0377
*           IF SWNL = '1'B &                /* NEW LINE PROCESSING?  */
*              BYTECNT < 257 THEN           /* ROOM IN RU?           */
         TM    SWNL(TOMWREG),B'01000000'                           0377
         BNO   @RF00377                                            0377
         L     @15,BYTECNT(,TOMWREG)                               0377
         C     @15,@CF02797                                        0377
         BNL   @RF00377                                            0377
*             DO;                           /* BEGIN NL PROCESSING   */
*               RU(BYTECNT) = NL;           /* NEXT LINE             */
         ALR   @15,TOMWREG                                         0379
         MVC   RU-1(1,@15),NL                                      0379
*               BYTECNT = BYTECNT + 1;      /* NEXT BYTE POSITION    */
         L     @15,BYTECNT(,TOMWREG)                               0380
         AL    @15,@CF00064                                        0380
         ST    @15,BYTECNT(,TOMWREG)                               0380
*               SWNL = '0'B;                /* RESET NEW-LINE SWITCH */
         NI    SWNL(TOMWREG),B'10111111'                           0381
*             END;                          /* END OF NL PROCESSING  */
*           ELSE;                           /* NO NL PROCESSING      */
*                                                                  0383
@RF00377 DS    0H                                                  0384
*           IF BYTECNT > 1 THEN             /* RU NOT EMPTY?         */
         L     @15,BYTECNT(,TOMWREG)                               0384
         C     @15,@CF00064                                        0384
         BNH   @RF00384                                            0384
*             TSTPRMPT = '1'B;              /* TEST FOR PROMPTING    */
         OI    TSTPRMPT(TOMWREG),B'00000010'                       0385
*           ELSE;                           /* RU EMPTY              */
*                                                                  0386
@RF00384 DS    0H                                                  0387
*           IF SENDPRMT = '1'B THEN         /* SEND PROMPT?          */
         TM    SENDPRMT(TOMWREG),B'00001000'                       0387
         BNO   @RF00387                                            0387
*             DO;                                                  0388
*               SENDPRMT = '0'B;            /* RESET SEND-PROMPT SW  */
         NI    SENDPRMT(TOMWREG),B'11110111'                       0389
*               TSTPRMPT = '0'B;            /* RESET TEST-PROMPT SW  */
         NI    TSTPRMPT(TOMWREG),B'11111101'                       0390
*               CALL PRMPTCHK;              /* CALL PROMPT ROUTINE   */
         BAL   @14,PRMPTCHK                                        0391
*               IF PROMPT = '0'B THEN       /* IS THERE NO PROMPT?   */
         TM    PROMPT(TOMWREG),B'10000000'                         0392
         BNZ   @RF00392                                            0392
*                 DO;                       /* SEND SPACE-BACKSPACE  */
*                   RU(BYTECNT:BYTECNT+1) = '4016'X;               0394
         L     @15,BYTECNT(,TOMWREG)                               0394
         ALR   @15,TOMWREG                                         0394
         MVC   RU-1(2,@15),@CB02804                                0394
*                   BYTECNT = BYTECNT + 2;  /* INCREMENT BYTE COUNT  */
         L     @15,BYTECNT(,TOMWREG)                               0395
         AL    @15,@CF00076                                        0395
         ST    @15,BYTECNT(,TOMWREG)                               0395
*                   PROMPT = '1'B;          /* SIMILAR TO A PROMPT   */
         OI    PROMPT(TOMWREG),B'10000000'                         0396
*                 END;                                             0397
*               ELSE;                       /* PROMPT                */
@RF00392 DS    0H                                                  0399
*             END;                                                 0399
*           ELSE                                                   0400
*             IF TSTPRMPT = '0'B THEN;      /* NO PROMPT CHECKING?   */
         B     @RC00387                                            0400
@RF00387 TM    TSTPRMPT(TOMWREG),B'00000010'                       0400
         BZ    @RT00400                                            0400
*             ELSE                          /* TEST FOR PROMPTING    */
*             IF TSBSPIT = '0'B &           /* PROMPTING NOT PURGED? */
*                TSBAUTON='1'B &            /* PROMPTING REQUESTED?  */
*                TSBSTAUT='1'B THEN         /* PROMPT USER?          */
         TM    TSBSPIT(TSBREG),B'00100000'                         0402
         BNZ   @RF00402                                            0402
         TM    TSBAUTON(TSBREG),B'01000100'                        0402
         BNO   @RF00402                                            0402
*               IF BYTECNT = 1 THEN         /* IS RU EMPTY?          */
         CLC   BYTECNT(4,TOMWREG),@CF00064                         0403
         BNE   @RF00403                                            0403
*                 DO;                                              0404
*                   TSTPRMPT = '0'B;        /* RESET TEST-PROMPT SW  */
         NI    TSTPRMPT(TOMWREG),B'11111101'                       0405
*                   CALL PRMPTCHK;          /* CALL PROMPT ROUTINE   */
         BAL   @14,PRMPTCHK                                        0406
*                 END;                                             0407
*               ELSE                        /* RU IS NOT EMPTY       */
*                 IF TVWADOOQ = '0'B THEN   /* IS OUTPUT QUEUE EMPTY?*/
         B     @RC00403                                            0408
@RF00403 TM    TVWADOOQ(TVWAREG),B'01000000'                       0408
         BNZ   @RF00408                                            0408
*                   IF (257-BYTECNT) > 9 THEN /* ROOM IN RU?         */
         LA    @15,257                                             0409
         SL    @15,BYTECNT(,TOMWREG)                               0409
         C     @15,@CF01008                                        0409
         BNH   @RF00409                                            0409
*                     DO;                                          0410
*                       CALL PRMPTCHK;      /* CALL PROMPT ROUTINE   */
         BAL   @14,PRMPTCHK                                        0411
*                       TSTPRMPT = '0'B;    /* RESET TEST-PROMPT SW  */
         NI    TSTPRMPT(TOMWREG),B'11111101'                       0412
*                       PROMPT = '0'B;      /* RESET PROMPT SWITCH   */
         NI    PROMPT(TOMWREG),B'01111111'                         0413
*                     END;                                         0414
*                   ELSE                    /* NO ROOM IN RU         */
*                     DO;                                          0415
         B     @RC00409                                            0415
@RF00409 DS    0H                                                  0416
*                       SENDPRMT = '1'B;    /* SEND PROMPT LATER     */
         OI    SENDPRMT(TOMWREG),B'00001000'                       0416
*                       TSTPRMPT = '1'B;    /* TEST PROMPT LATER     */
         OI    TSTPRMPT(TOMWREG),B'00000010'                       0417
*                       IF RPLCHN = BOC ×   /* BEGINNING OF CHAIN?   */
*                          RPLCHN = MOC THEN  /* MIDDLE OF CHAIN?    */
         LA    @15,16                                              0418
         ALR   @15,RPLREG                                          0418
         CLI   RPLCHN(@15),X'80'                                   0418
         BE    @RT00418                                            0418
         CLI   RPLCHN(@15),X'40'                                   0418
         BNE   @RF00418                                            0418
@RT00418 DS    0H                                                  0419
*                         RPLCHN = MOC;     /* MOC                   */
         MVI   RPLCHN+16(RPLREG),X'40'                             0419
*                       ELSE                /* OC OR EOC             */
*                         RPLCHN = BOC;     /* BOC                   */
         B     @RC00418                                            0420
@RF00418 MVI   RPLCHN+16(RPLREG),X'80'                             0420
*                       RPLVTFL2 = SCHEDNEG;                       0421
@RC00418 MVI   RPLVTFL2+16(RPLREG),X'84'                           0421
*                       NOTNOW = '1'B;      /* CHAIN ELT DETERMINED  */
         OI    NOTNOW(TOMWREG),B'00000100'                         0422
*                     END;                                         0423
*                 ELSE;                     /* MESSAGE ON QUEUE      */
@RF00408 DS    0H                                                  0425
*             ELSE                          /* NO PROMPT             */
*               DO;                         /* RESET SWITCHES        */
         B     @RC00402                                            0425
@RF00402 DS    0H                                                  0426
*                 TSTPRMPT = '0'B;          /* RESET TEST-PROMPT SW  */
*                 PSENT = '0'B;             /* RESET SWITCH  OZ11996 */
         NI    TSTPRMPT(TOMWREG),B'11110101'                       0427
*               END;                        /* END OF RESET          */
*           /*********************************************************/
*           /* IF RU IS EMPTY, DO NOT REPEAT PROCESS.                */
*           /*********************************************************/
*           IF BYTECNT = 1 THEN             /* RU EMPTY?             */
@RC00402 DS    0H                                                  0429
@RT00400 DS    0H                                                  0429
@RC00387 CLC   BYTECNT(4,TOMWREG),@CF00064                         0429
         BNE   @RF00429                                            0429
*             AGAIN = '0'B;                 /* END CHAINING PROCESS  */
         NI    AGAIN(TOMWREG),B'11111110'                          0430
*           ELSE                            /* RU NOT EMPTY          */
*             DO;                           /* DO THE FOLLOWING      */
*                                                                  0431
         B     @RC00429                                            0431
@RF00429 DS    0H                                                  0432
*               /*****************************************************/
*               /* IF USER-TRANSLATION OR ASCII-TRANSLATION IS       */
*               /* INDICATED, CALL TRANSLATION ROUTINE.              */
*               /*****************************************************/
*               IF TVWATRAN = '1'B ×        /* DO USER TRANSLATION?  */
*                  TSBXASCI='1'B THEN       /* DO ASCII TRANSLATION? */
         TM    TVWATRAN(TVWAREG),B'00000010'                       0432
         BO    @RT00432                                            0432
         L     @01,TSBEXTNT(,TSBREG)                               0432
         TM    TSBXASCI(@01),B'10000000'                           0432
         BNO   @RF00432                                            0432
@RT00432 DS    0H                                                  0433
*                 CALL TRANSL8;             /* TRANSLATE DATA        */
         BAL   @14,TRANSL8                                         0433
*               ELSE;                       /* DO NOT TRANSLATE      */
@RF00432 DS    0H                                                  0435
*               IF NOTNOW = '1'B THEN;      /* CHAIN-ELT DETERMINED? */
         TM    NOTNOW(TOMWREG),B'00000100'                         0435
         BO    @RT00435                                            0435
*               ELSE                        /* DETERMINE CHAIN-ELT   */
*               /*****************************************************/
*               /* (A) IF MORE OF THE CURRENT MESSAGE IS LEFT TO BE  */
*               /*     PROCESSED,                                    */
*               /* (B) IF THERE ARE MORE MESSAGES ON THE QUEUE AND   */
*               /*     BOTH THE CURRENT MESSAGE AND THE NEXT MESSAGE */
*               /*     ARE NOT CROSS-MEMORY, BREAKIN, AND CONTROL, OR*/
*               /* (C) IF GLOBAL ERROR                               */
*               /*****************************************************/
*               IF PROMPT = '0'B &   /* NOT PROMPT MESSAGE?          */
*                 (MOR='1'B ×        /* MIDDLE OF A TPUT?            */
*                 (XC='0'B &         /* CURRENT TPUT IS NOT CROSS- 0437
*                                       MEMORY, NOT BREAKIN, AND NOT
*                                       CONTROL?                     */
*                  MORMSGS='1'B &    /* MORE MESSAGES ON QUEUE?      */
*                  NXC='0'B &        /* NEXT TPUT IS NOT CROSS-MEMORY,
*                                       NOT BREAKIN, AND NOT CONTROL?*/
*                  SPEC='0'B) ×      /* MESSAGE FITS IN CHAIN?       */
*                  ERMG = '1'B) THEN /* GLOBAL ERROR MESSAGE?        */
         TM    PROMPT(TOMWREG),B'10000000'                         0437
         BNZ   @RF00437                                            0437
         TM    MOR(TOMWREG),B'10000000'                            0437
         BO    @RT00437                                            0437
         TM    MORMSGS(TOMWREG),B'00010000'                        0437
         BNO   @GL00013                                            0437
         TM    XC(TOMWREG),B'01100000'                             0437
         BNZ   @GL00013                                            0437
         TM    SPEC(TOMWREG),B'00100000'                           0437
         BZ    @RT00437                                            0437
@GL00013 TM    ERMG(TOMWREG),B'00001000'                           0437
         BNO   @RF00437                                            0437
@RT00437 DS    0H                                                  0438
*                 /***************************************************/
*                 /* IF ONLY ONE RU PER CHAIN OR GLOBAL ERROR        */
*                 /* SITUATION, TURN ON ONLY-CHAIN INDICATOR.        */
*                 /***************************************************/
*                 IF CHAINSZE = 1 ×         /* ONLY CHAIN SITUATION? */
*                    ERMG='1'B THEN         /* GLOBAL ERROR MESSAGE? */
         CLI   CHAINSZE(TOMWREG),1                                 0438
         BE    @RT00438                                            0438
         TM    ERMG(TOMWREG),B'00001000'                           0438
         BNO   @RF00438                                            0438
@RT00438 DS    0H                                                  0439
*                   DO;                     /* BEGIN OC PROCESSING   */
*                    RPLCHN = OC;           /* ONLY CHAIN            */
         LA    @15,16                                              0440
         ALR   @15,RPLREG                                          0440
         MVI   RPLCHN(@15),X'10'                                   0440
*                    RPLVTFL2 = RESPPOS;    /* POST=RESP AND       0441
*                                             RESPOND=(NEX,FME,NRRN) */
         MVI   RPLVTFL2(@15),X'00'                                 0441
*                    CHAINSZE = TVWACHNL;   /* RESET CHAIN SIZE      */
         IC    @15,TVWACHNL(,TVWAREG)                              0442
         STC   @15,CHAINSZE(,TOMWREG)                              0442
*                    RUCOUNT = CHAINSZE;    /* RESET RU COUNT        */
         IC    @15,CHAINSZE(,TOMWREG)                              0443
         STC   @15,RUCOUNT(,TOMWREG)                               0443
*                   END;                    /* END OF OC PROCESSING  */
*                 ELSE                      /* BOC, EOC, OR MOC      */
*                   /*************************************************/
*                   /* IF THIS IS THE FIRST RU IN THIS CHAIN,        */
*                   /* TURN ON BEGINNING-OF-CHAIN INDICATOR.         */
*                   /*************************************************/
*                   IF RUCOUNT=CHAINSZE THEN /* BEGINNING OF CHAIN?  */
         B     @RC00438                                            0445
@RF00438 CLC   RUCOUNT(1,TOMWREG),CHAINSZE(TOMWREG)                0445
         BNE   @RF00445                                            0445
*                     DO;                   /* BEGIN BOC PROCESSING  */
*                       RPLCHN = BOC;       /* BEGINNING-OF-CHAIN    */
         LA    @15,16                                              0447
         ALR   @15,RPLREG                                          0447
         MVI   RPLCHN(@15),X'80'                                   0447
*                       RPLVTFL2 = SCHEDNEG;   /* POST=SCHED AND   0448
*                                              RESPOND=(EX,FME,NRRN) */
         MVI   RPLVTFL2(@15),X'84'                                 0448
*                       RUCOUNT = RUCOUNT - 1;                     0449
         SLR   @15,@15                                             0449
         IC    @15,RUCOUNT(,TOMWREG)                               0449
         BCTR  @15,0                                               0449
         STC   @15,RUCOUNT(,TOMWREG)                               0449
*                     END;                  /* END OF BOC PROCESSING */
*                   ELSE                    /* EOC OR MOC            */
*                     /***********************************************/
*                     /* IF THIS IS THE LAST RU IN THE CHAIN,        */
*                     /* TURN ON THE END-OF-CHAIN INDICATOR.         */
*                     /***********************************************/
*                     IF RUCOUNT=1 THEN     /* END OF CHAIN?         */
         B     @RC00445                                            0451
@RF00445 CLI   RUCOUNT(TOMWREG),1                                  0451
         BNE   @RF00451                                            0451
*                       DO;                 /* BEGIN EOC PROCESSING  */
*                         RPLCHN = EOC;     /* END-OF-CHAIN          */
         LA    @15,16                                              0453
         ALR   @15,RPLREG                                          0453
         MVI   RPLCHN(@15),X'20'                                   0453
*                         RPLVTFL2 = RESPPOS;  /* POST=RESP AND    0454
*                                              RESPOND=(NEX,FME,NRRN)*/
         MVI   RPLVTFL2(@15),X'00'                                 0454
*                         CHAINSZE = TVWACHNL; /* RESET CHAIN SIZE   */
         IC    @15,TVWACHNL(,TVWAREG)                              0455
         STC   @15,CHAINSZE(,TOMWREG)                              0455
*                         RUCOUNT = CHAINSZE;  /* RESET RU COUNT     */
         IC    @15,CHAINSZE(,TOMWREG)                              0456
         STC   @15,RUCOUNT(,TOMWREG)                               0456
*                       END;                /* END OF EOC PROCESSING */
*                     ELSE                  /* MOC                   */
*                       DO;                 /* BEGIN MOC PROCESSING  */
         B     @RC00451                                            0458
@RF00451 DS    0H                                                  0459
*                         RPLCHN = MOC;     /* MIDDLE-OF-CHAIN       */
         LA    @15,16                                              0459
         ALR   @15,RPLREG                                          0459
         MVI   RPLCHN(@15),X'40'                                   0459
*                         RPLVTFL2 = SCHEDNEG; /* POST=SCHED AND   0460
*                                              RESPOND=(EX,FME,NRRN) */
         MVI   RPLVTFL2(@15),X'84'                                 0460
*                         RUCOUNT = RUCOUNT - 1;                   0461
         SLR   @15,@15                                             0461
         IC    @15,RUCOUNT(,TOMWREG)                               0461
         BCTR  @15,0                                               0461
         STC   @15,RUCOUNT(,TOMWREG)                               0461
*                       END;                /* END OF MOC PROCESSING */
*               ELSE                        /* END CHAIN             */
*                 DO;                       /* EOC OR OC PROCESSING  */
         B     @RC00437                                            0463
@RF00437 DS    0H                                                  0464
*                   IF RPLCHN = BOC ×       /* BEGINNING OF CHAIN?   */
*                      RPLCHN=MOC THEN      /* MIDDLE OF CHAIN?      */
         LA    @15,16                                              0464
         ALR   @15,RPLREG                                          0464
         CLI   RPLCHN(@15),X'80'                                   0464
         BE    @RT00464                                            0464
         CLI   RPLCHN(@15),X'40'                                   0464
         BNE   @RF00464                                            0464
@RT00464 DS    0H                                                  0465
*                     DO;                   /* BEGIN EOC PROCESSING  */
*                       RPLCHN = EOC;       /* END-OF-CHAIN          */
         LA    @15,16                                              0466
         ALR   @15,RPLREG                                          0466
         MVI   RPLCHN(@15),X'20'                                   0466
*                       RPLVTFL2 = RESPPOS; /* POST=RESP AND       0467
*                                              RESPOND=(NEX,FME,NRRN)*/
         MVI   RPLVTFL2(@15),X'00'                                 0467
*                       PROMPT = '0'B;      /* RESET PROMPT SWITCH   */
         NI    PROMPT(TOMWREG),B'01111111'                         0468
*                     END;                  /* END EOC PROCESSING    */
*                   ELSE                    /* ONLY CHAIN            */
*                     DO;                   /* BEGIN OC PROCESSING   */
         B     @RC00464                                            0470
@RF00464 DS    0H                                                  0471
*                       RPLCHN = OC;        /* ONLY CHAIN            */
         LA    @15,16                                              0471
         ALR   @15,RPLREG                                          0471
         MVI   RPLCHN(@15),X'10'                                   0471
*                       RPLVTFL2 = RESPPOS; /* POST=RESP AND       0472
*                                              RESPOND=(NEX,FME,NRRN)*/
         MVI   RPLVTFL2(@15),X'00'                                 0472
*                     END;                  /* END OF OC PROCESSING  */
*                                                                  0473
*                   CHAINSZE = TVWACHNL;    /* RESET CHAIN SIZE      */
@RC00464 IC    @15,TVWACHNL(,TVWAREG)                              0474
         STC   @15,CHAINSZE(,TOMWREG)                              0474
*                   RUCOUNT = CHAINSZE;     /* RESET RU COUNT        */
*                                                                  0475
         IC    @15,CHAINSZE(,TOMWREG)                              0475
         STC   @15,RUCOUNT(,TOMWREG)                               0475
*                 END;                                             0476
*                                                                  0476
*               CALL BLDEND;                                       0477
*                                                                  0477
@RC00437 DS    0H                                                  0477
@RT00435 BAL   @14,BLDEND                                          0477
*             END;                                                 0478
*                                                                  0478
*           END BLDMID;                     /* END OF BLDMID         */
@EL00005 DS    0H                                                  0479
@EF00005 DS    0H                                                  0479
@ER00005 L     @14,@SA00005                                        0479
         BR    @14                                                 0479
         EJECT
*BLDEND:    PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0480
*                                                                  0480
BLDEND   ST    @14,@SA00006                                        0480
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - BLDEND                                    */
*           /*                                                       */
*           /* FUNCTION - (A) DETERMINE IF A TERMWAIT SYSEVENT IS TO */
*           /*                IS ISSUED.                             */
*           /*            (B) CALL SENDRU TO SEND RU.                */
*           /*            (C) IF SEND IS SUCCESSFUL,                 */
*           /*                (1) CONSIDER GLOBAL-ERROR INDICATION,  */
*           /*                (2) HANDLE TPUT-HOLD SITUATION,        */
*           /*                (3) DELETE MESSAGE(S),                 */
*           /*                (4) CHECK IF THERE ARE MORE MESSAGES   */
*           /*                    ON QUEUE.                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0481
*           RFY (REG0,REG1) RSTD;           /* RESTRICT REGISTERS 0,1*/
*           MPSTSOIR='0'B;                  /* TURN OFF SOIR @ZA26553*/
*           MPSTSOIW='0'B;                  /* TURN OFF SOIW @ZA26553*/
         L     @15,PSAAOLD                                         0483
         L     @15,ASCBASXB(,@15)                                  0483
         L     @15,ASXBMPST(,@15)                                  0483
         NI    MPSTSOIR(@15),B'00111111'                           0483
*           IF (RPLCHN=EOC ×                /* END OF CHAIN?         */
*               RPLCHN=OC) &                /* ONLY CHAIN?           */
*               TVWADOOQ='0'B &             /* NO MESSAGE ON QUEUE?  */
*               TVWABKMG='0'B THEN          /* NO BREAK-IN MESSAGE?  */
         LA    @15,16                                              0484
         ALR   @15,RPLREG                                          0484
         CLI   RPLCHN(@15),X'20'                                   0484
         BE    @GL00019                                            0484
         CLI   RPLCHN(@15),X'10'                                   0484
         BNE   @RF00484                                            0484
@GL00019 TM    TVWADOOQ(TVWAREG),B'01000000'                       0484
         BNZ   @RF00484                                            0484
         TM    TVWABKMG(TVWAREG),B'00000100'                       0484
         BNZ   @RF00484                                            0484
*             DO;                           /* CHECK OWAIT           */
*               IF TSBOWAIT = '1'B THEN     /* OWAIT?        @ZA17004*/
         TM    TSBOWAIT(TSBREG),B'00100000'                        0486
         BNO   @RF00486                                            0486
*                 DO;                       /* ISSUE SYSEVENT 22     */
*                   REG0 = ASCBASID;        /* ASID                  */
         L     @15,PSAAOLD                                         0488
         LH    REG0,ASCBASID(,@15)                                 0488
         N     REG0,@CF02998                                       0488
*                   REG1 = TPUT;            /* TPUT SATISFIED        */
         L     REG1,@CF02008                                       0489
*                   GEN REFS(ASCBASID,CVTOPTE,CVTPTR,CVT)          0490
*                       SETS(REG0,REG14,REG15);                    0490
         SYSEVENT TGETTPUT,ASID=(REG0),ENTRY=BRANCH
*                 END;                      /* END OF SYSEVENT 22    */
*               ELSE;                       /* NOT OWAIT             */
@RF00486 DS    0H                                                  0493
*               IF TSBOWAIT = '1'B ×        /* OWAIT?                */
*                 (TSBIWAIT = '1'B &        /* IWAIT?                */
*                 (TVWADOOQ='1'B ×          /* MESSAGE ON QUEUE?     */
*                  TSTPRMPT = '1'B)) THEN   /* CHECK PROMPT?         */
         TM    TSBOWAIT(TSBREG),B'00100000'                        0493
         BO    @RT00493                                            0493
         TM    TSBIWAIT(TSBREG),B'01000000'                        0493
         BNO   @RF00493                                            0493
         TM    TVWADOOQ(TVWAREG),B'01000000'                       0493
         BO    @RT00493                                            0493
         TM    TSTPRMPT(TOMWREG),B'00000010'                       0493
         BNO   @RF00493                                            0493
@RT00493 DS    0H                                                  0494
*                 DO;                                              0494
*                   SEVENT = '1'B;          /* ISSUE SYSEVENT 02     */
         OI    SEVENT(TOMWREG),B'10000000'                         0495
*                   REG1 = TPUT;            /* OUTPUT TERMINAL WAIT  */
         L     REG1,@CF02008                                       0496
*                 END;                      /* END OF OUTPUT CASE    */
*               ELSE                        /* NOT OUTPUT SITUATION  */
*                 IF TSBIWAIT = '1'B THEN   /* IWAIT?                */
         B     @RC00493                                            0498
@RF00493 TM    TSBIWAIT(TSBREG),B'01000000'                        0498
         BNO   @RF00498                                            0498
*                   DO;                                            0499
*                     SEVENT = '0'B;        /* NO SYSEVENT   @ZA24418*/
         NI    SEVENT(TOMWREG),B'01111111'                         0500
*                     MPSTSOIR = '1'B;      /* INDICATE IWAIT TO VTAM*/
         L     @15,PSAAOLD                                         0501
         L     @15,ASCBASXB(,@15)                                  0501
         L     @15,ASXBMPST(,@15)                                  0501
         OI    MPSTSOIR(@15),B'01000000'                           0501
*                     TVWAISYS = '1'B;      /* IWAIT SYSEVENT OZ12002*/
         OI    TVWAISYS(TVWAREG),B'10000000'                       0502
*                   END;                    /* END OF INPUT SITUATION*/
*                 ELSE                      /* NOT OWAIT - NOT IWAIT */
*                   SEVENT = '0'B;          /* NO SYSEVENT           */
         B     @RC00498                                            0504
@RF00498 NI    SEVENT(TOMWREG),B'01111111'                         0504
*               IF SEVENT = '1'B THEN       /* SYSEVENT 02?          */
@RC00498 DS    0H                                                  0505
@RC00493 TM    SEVENT(TOMWREG),B'10000000'                         0505
         BNO   @RF00505                                            0505
*                 DO;                       /* PROCESS SYSEVENT 02   */
*                   REG0 = ASCBASID;        /* ASID                  */
         L     @15,PSAAOLD                                         0507
         LH    REG0,ASCBASID(,@15)                                 0507
         N     REG0,@CF02998                                       0507
*                   GEN REFS(ASCBASID,CVTOPTE,CVTPTR,CVT)          0508
*                       SETS(REG0,REG14,REG15);                    0508
         SYSEVENT TERMWAIT,ASID=(REG0),ENTRY=BRANCH
*                 END;                      /* END OF SYSEVENT 02    */
*               ELSE;                       /* NO SYSEVENT           */
@RF00505 DS    0H                                                  0511
*             END;                          /* END OF WAIT CHECK     */
*           ELSE;                                                  0512
*                                                                  0512
@RF00484 DS    0H                                                  0513
*           IF RPLCHN = BOC &               /* BEGINNING OF CHAIN?   */
*              TVWARCRS='1'B THEN           /* RESP. BEING RECEIVED? */
         LA    @15,16                                              0513
         ALR   @15,RPLREG                                          0513
         CLI   RPLCHN(@15),X'80'                                   0513
         BNE   @RF00513                                            0513
         TM    TVWARCRS(TVWAREG),B'00000010'                       0513
         BNO   @RF00513                                            0513
*             DO;                           /* RESP. BEING RECEIVED  */
*               RPLNFSYN = '1'B;            /* RTYPE=NDFSYN          */
*               RPLDFASY = '0'B;            /* RTYPE=NDFASY          */
         OI    RPLNFSYN(@15),B'00000100'                           0516
         NI    RPLDFASY(@15),B'11111101'                           0516
*               TVWARCRS = '0'B;            /* DO NOT RECEIVE RESP.  */
         NI    TVWARCRS(TVWAREG),B'11111101'                       0517
*               CALL RCVRSET;               /* RESETSR               */
         BAL   @14,RCVRSET                                         0518
*             END;                          /* END OF RESETSR        */
*           ELSE;                           /* DO NOTHING            */
*                                                                  0520
@RF00513 DS    0H                                                  0521
*           IF PROMPT = '1'B THEN           /* PROMPT MESSAGE?       */
         TM    PROMPT(TOMWREG),B'10000000'                         0521
         BNO   @RF00521                                            0521
*             DO;                           /* DO THE FOLLOWING      */
*               IF RPLCHN=OC &              /* ONLY CHAIN?           */
*                  NOTNOW='0'B THEN         /* ONLY PROMPT IN RU?    */
         LA    @15,16                                              0523
         ALR   @15,RPLREG                                          0523
         CLI   RPLCHN(@15),X'10'                                   0523
         BNE   @RF00523                                            0523
         TM    NOTNOW(TOMWREG),B'00000100'                         0523
         BNZ   @RF00523                                            0523
*                 DO;                       /* DO THE FOLLOWING      */
*                   RPLVTFL2 = SCHEDNEG;    /* POST=SCHED            */
         MVI   RPLVTFL2(@15),X'84'                                 0525
*                   IF TVWARCRS='0'B THEN   /* RESPONSES ^ RECEIVED? */
         TM    TVWARCRS(TVWAREG),B'00000010'                       0526
         BNZ   @RF00526                                            0526
*                     DO;                   /* RECEIVED              */
*                       RPLNFSYN = '0'B;    /* RTYPE=DFSYN           */
*                       RPLDFASY = '1'B;    /* RTYPE=DFASY           */
         OI    RPLDFASY(@15),B'00000010'                           0529
         NI    RPLNFSYN(@15),B'11111011'                           0529
*                       TVWARCRS = '1'B;    /* RECEIVE RESPONSES     */
         OI    TVWARCRS(TVWAREG),B'00000010'                       0530
*                       CALL RCVRSET;       /* RESETSR               */
         BAL   @14,RCVRSET                                         0531
*                     END;                  /* END OF RESETSR        */
*                   ELSE;                   /* DO NOTHING            */
@RF00526 DS    0H                                                  0534
*                 END;                      /* END OC PROCESSING     */
*               ELSE;                       /* BOC, MOC, OR EOC      */
@RF00523 DS    0H                                                  0536
*               PROMPT = '0'B;              /* PROMPT MESSAGE HANDLED*/
         NI    PROMPT(TOMWREG),B'01111111'                         0536
*             END;                          /* END OF PROMPT HANDLING*/
*           ELSE;                           /* NOT PROMPT SITUATION  */
*                                                                  0538
@RF00521 DS    0H                                                  0539
*           RFY (REG0,REG1) UNRSTD;         /* UNRESTRICT REG. 0,1   */
*                                                                  0539
*           NEC = '1'B;                     /* SEND DATA             */
         OI    NEC(TOMWREG),B'00000100'                            0540
*           DO WHILE (NEC = '1'B);                                 0541
         B     @DE00541                                            0541
@DL00541 DS    0H                                                  0542
*             CALL SENDRU;                  /* CALL SEND-DATA ROUTINE*/
         BAL   @14,SENDRU                                          0542
*           END;                                                   0543
*                                                                  0543
@DE00541 TM    NEC(TOMWREG),B'00000100'                            0543
         BO    @DL00541                                            0543
*           /*********************************************************/
*           /* IF THE GLOBAL-ERROR INDICATOR IS ON BUT THE ATTENTION */
*           /* COUNTERS ARE ZERO AND THERE IS NO TIM-ERROR MESSAGE,  */
*           /* TURN OFF THE GLOBAL-ERROR SWITCH.                     */
*           /*********************************************************/
*           IF TVWAGERR = '1'B THEN         /* GLOBAL ERROR?         */
         TM    TVWAGERR(TVWAREG),B'00010000'                       0544
         BNO   @RF00544                                            0544
*             IF TVWAATTN = 0 &             /* NO ATTENTIONS?        */
*                TVWAAIGN='0'B &            /* NO ATTENTION IGNORED? */
*                TVWAERMG='0'B THEN         /* NO TIM-ERROR MESSAGE? */
         CLI   TVWAATTN(TVWAREG),0                                 0545
         BNE   @RF00545                                            0545
         TM    TVWAAIGN(TVWAREG),B'00100000'                       0545
         BNZ   @RF00545                                            0545
         TM    TVWAERMG(TVWAREG),B'00001000'                       0545
         BNZ   @RF00545                                            0545
*               TVWAGERR = '0'B;            /* RESET ERROR SWITCH    */
         NI    TVWAGERR(TVWAREG),B'11101111'                       0546
*             ELSE;                         /* GLOBAL ERROR          */
@RF00545 DS    0H                                                  0548
*           ELSE;                           /* NO GLOBAL ERROR       */
@RF00544 DS    0H                                                  0549
*           /*********************************************************/
*           /* IF PROMPT WAS NOT SENT AND PROMPTING IS IN EFFECT,    */
*           /* TEST FOR PROMPTING.                                   */
*           /*********************************************************/
*           IF PSENT = '0'B &               /* NO PROMPT SENT?       */
*              TSBSPIT = '0'B &             /* PROMPTING NOT PURGED? */
*              TSBAUTON='1'B &              /* PROMPTING REQUESTED?  */
*              TSBSTAUT='1'B THEN           /* PROMPT USER?          */
         TM    PSENT(TOMWREG),B'00001000'                          0549
         BNZ   @RF00549                                            0549
         TM    TSBSPIT(TSBREG),B'00100000'                         0549
         BNZ   @RF00549                                            0549
         TM    TSBAUTON(TSBREG),B'01000100'                        0549
         BNO   @RF00549                                            0549
*             TSTPRMPT = '1'B;              /* TEST PROMPT           */
         OI    TSTPRMPT(TOMWREG),B'00000010'                       0550
*           ELSE                                                   0551
*             PSENT = '0'B;                 /* RESET SWITCH   OZ1196 */
         B     @RC00549                                            0551
@RF00549 NI    PSENT(TOMWREG),B'11110111'                          0551
*           /*********************************************************/
*           /* IF ERROR ENCOUNTERED, THEN BYPASS THE FOLLOWING.      */
*           /*********************************************************/
*           IF BYPASS = '1'B THEN;          /* BYPASS THE FOLLOWING? */
@RC00549 TM    BYPASS(TOMWREG),B'00000001'                         0552
         BO    @RT00552                                            0552
*           ELSE                            /* DO THE FOLLOWING      */
*               /*****************************************************/
*               /* IF END-OF-CHAIN OR ONLY CHAIN, DO THE FOLLOWING   */
*               /*****************************************************/
*               IF RPLCHN=EOC ×             /* END OF CHAIN?         */
*                  RPLCHN=OC THEN           /* ONLY CHAIN?           */
         LA    @15,16                                              0554
         ALR   @15,RPLREG                                          0554
         CLI   RPLCHN(@15),X'20'                                   0554
         BE    @RT00554                                            0554
         CLI   RPLCHN(@15),X'10'                                   0554
         BNE   @RF00554                                            0554
@RT00554 DS    0H                                                  0555
*                 DO;                                              0555
*                   IF RETRYMSG='0'B THEN   /* NO RETRY MESSAGE SENT?
*                                                            @ZM21462*/
         TM    RETRYMSG(TOMWREG),B'00001000'                       0556
         BNZ   @RF00556                                            0556
*                     RETRY = 0;            /* RESET RETRY COUNT     */
         MVI   RETRY(TOMWREG),X'00'                                0557
*                   ELSE                    /* RETRY MESSAGE SENT  0558
*                                                            @ZM21462*/
*                     RETRYMSG='0'B;        /* RESET RETRY-MESSAGE 0558
*                                              FLAG          @ZM21462*/
*                                                                  0558
         B     @RC00556                                            0558
@RF00556 NI    RETRYMSG(TOMWREG),B'11110111'                       0558
*                   /*************************************************/
*                   /* IF TPUT-HOLD, CALL POST ROUTINE.              */
*                   /*************************************************/
*                   IF HLD = '1'B THEN      /* TPUT HOLD?            */
@RC00556 TM    HLD(TOMWREG),B'01000000'                            0559
         BNO   @RF00559                                            0559
*                     CALL POSTROUT;        /* CALL POST ROUTINE     */
         BAL   @14,POSTROUT                                        0560
*                   ELSE;                   /* NOT HOLD SITUATION    */
*                                                                  0561
@RF00559 DS    0H                                                  0562
*                   /*************************************************/
*                   /* IF NO MESSAGE FROM THE QUEUE WAS PROCESSED,   */
*                   /* SKIP THE FOLLOWING.                           */
*                   /*************************************************/
*                   IF SKIP = '1'B THEN;    /* SKIP THE FOLLOWING?   */
         TM    SKIP(TOMWREG),B'00000010'                           0562
         BO    @RT00562                                            0562
*                   ELSE                    /* DO THE FOLLOWING      */
*                     DO;                   /* DELETE MESSAGE(S)     */
*                                                                  0564
*                       /*********************************************/
*                       /* DELETE MESSAGE(S) FROM THE QUEUE.         */
*                       /*********************************************/
*                       OPREQ = DELETO;     /* DELETE MSG FROM QUEUE */
         MVI   OPREQ(TOMWREG),X'03'                                0565
*                       CALL IKTQMOUT(OPARMS);                     0566
*                                                                  0566
         LA    @15,OPARMS(,TOMWREG)                                0566
         ST    @15,@AL00001                                        0566
         L     @01,CVTPTR                                          0566
         L     @01,CVTTCASP(,@01)                                  0566
         L     @15,TCASOQM(,@01)                                   0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*                       /*********************************************/
*                       /* IF MORE MESSAGES LEFT ON THE QUEUE,       */
*                       /* LEAVE MESSAGE SWITCH ON.                  */
*                       /* OTHERWISE, TURN OFF MESSAGE SWITCH.       */
*                       /*********************************************/
*                       IF OPRC=MORQMSGS THEN;                     0567
         CLI   OPRC(TOMWREG),1                                     0567
         BE    @RT00567                                            0567
*                                           /* MORE MESSAGE ON QUEUE?*/
*                       ELSE                /* NO MESSAGE ON QUEUE   */
*                         DO;               /* TURN OFF SWITCHES     */
*                           MSG = '0'B;     /* NO MESSAGE LEFT       */
         NI    MSG(TOMWREG),B'11111011'                            0570
*                           MOR = '0'B;     /* NO MESSAGE LEFT       */
         NI    MOR(TOMWREG),B'01111111'                            0571
*                         END;              /* SWITCHES TURNED OFF   */
*                     END;                  /* END MESSAGE DELETION  */
*                                                                  0573
*                 END;                      /* END EOC-OC PROCESSING */
*                                                                  0574
*               ELSE;                       /* BOC-MOC SITUATION     */
*                                                                  0575
@RF00554 DS    0H                                                  0576
*           END BLDEND;                     /* END OF BLDEND         */
@EL00006 DS    0H                                                  0576
@EF00006 DS    0H                                                  0576
@ER00006 L     @14,@SA00006                                        0576
         BR    @14                                                 0576
         EJECT
*FIN:       PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0577
*                                                                  0577
FIN      ST    @14,@SA00007                                        0577
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - FIN                                       */
*           /*                                                       */
*           /* FUNCTION - IF CHAINING PROCESS NEEDS TO BE HALTED,    */
*           /*            (A) CHECK IF CURRENT CHAIN NEEDS TO BE     */
*           /*                CANCELED,                              */
*           /*            (B) CHECK IF PARTIAL MESSAGE (DUE TO       */
*           /*                BREAK-IN) NEEDS TO BE SENT BACK TO THE */
*           /*                TERMINAL, AND                          */
*           /*            (C) CALL CHANGE-DIRECTION ROUTINE IF       */
*           /*                THERE IS NO PARTIAL MESSAGE.           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0578
*           /*********************************************************/
*           /* IF BUILD-CHAIN PROCESS IS TO BE REPEATED,             */
*           /* OMIT THE FOLLOWING.                                   */
*           /*********************************************************/
*           IF AGAIN = '1'B THEN;     /* NOT FINAL PROCESSING?       */
         TM    AGAIN(TOMWREG),B'00000001'                          0578
         BO    @RT00578                                            0578
*           ELSE                      /* FINAL PROCESSING            */
*             DO;                     /* BEGIN FINAL PROCESSING      */
*                                                                  0580
*               /*****************************************************/
*               /* CHECK IF CURRENT CHAIN NEEDS TO BE CANCELED.      */
*               /*****************************************************/
*               CALL CHKOCEOC;        /* CANCEL CHAIN IF NECESSARY   */
*                                                                  0581
         BAL   @14,CHKOCEOC                                        0581
*               /*****************************************************/
*               /* IF BREAK-IN HAS OCCURRED, CALL BREAK-MESSAGE      */
*               /* ROUTINE.                                          */
*               /*****************************************************/
*               SIGSENT = '0'B;       /* RESET SIGNAL SWITCH         */
         NI    SIGSENT(TOMWREG),B'11101111'                        0582
*               IF TVWABKMG='1'B THEN /* BREAK IN OCCURRED?          */
         TM    TVWABKMG(TVWAREG),B'00000100'                       0583
         BNO   @RF00583                                            0583
*                 CALL BKMGROUT;      /* HANDLE BREAK-IN SITUATION   */
         BAL   @14,BKMGROUT                                        0584
*               ELSE                                               0585
*                 /***************************************************/
*                 /* IF CHANGE-DIRECTION HAS BEEN RECEIVED,          */
*                 /* CALL CHANGE-DIRECTION ROUTINE.                  */
*                 /***************************************************/
*                 IF TVWASCD='1'B THEN /* CHANGE DIRECTION RECEIVED? */
         B     @RC00583                                            0585
@RF00583 TM    TVWASCD(TVWAREG),B'00100000'                        0585
         BNO   @RF00585                                            0585
*                   CALL SCDROUT;     /* SEND SPACE-BACKSPACE        */
         BAL   @14,SCDROUT                                         0586
*                 ELSE                /* NOTHING ELSE TO PROCESS     */
*                   TSBIFLSH = '0'B;  /* TURN OFF TSBIFLSH SWITCH    */
*                                                                  0587
         B     @RC00585                                            0587
@RF00585 NI    TSBIFLSH(TSBREG),B'11110111'                        0587
*             END;                    /* END OF PROCESSING           */
*                                                                  0588
*           END FIN;                  /* END OF FIN                  */
@EL00007 DS    0H                                                  0589
@EF00007 DS    0H                                                  0589
@ER00007 L     @14,@SA00007                                        0589
         BR    @14                                                 0589
         EJECT
*CHKOCEOC:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0590
*                                                                  0590
CHKOCEOC ST    @14,@SA00008                                        0590
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - CHKOCEOC                                  */
*           /*                                                       */
*           /* FUNCTION - TO CANCEL CHAIN IF THE LAST CHAIN-ELEMENT  */
*           /*            SENT WAS A BEGINNING-OF-CHAIN OR A         */
*           /*            MIDDLE-OF-CHAIN.                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0591
*           IF RPLCHN = BOC ×              /* BEGINNING OF CHAIN?    */
*              RPLCHN=MOC THEN             /* MIDDLE OF CHAIN?       */
         LA    @15,16                                              0591
         ALR   @15,RPLREG                                          0591
         CLI   RPLCHN(@15),X'80'                                   0591
         BE    @RT00591                                            0591
         CLI   RPLCHN(@15),X'40'                                   0591
         BNE   @RF00591                                            0591
@RT00591 DS    0H                                                  0592
*             DO;                          /* CANCEL CHAIN           */
*               RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;
*               MPSTSOIR='0'B;             /* RESET IWAIT SYSEVENT 0594
*                                             REQUEST FLAG           */
*               MPSTSOIW='0'B;             /* RESET IWAIT SYSEVENT 0595
*                                             FLAG                   */
         L     @04,PSAAOLD                                         0595
         L     @04,ASCBASXB(,@04)                                  0595
         L     @04,ASXBMPST(,@04)                                  0595
         NI    MPSTSOIR(@04),B'00111111'                           0595
*               WRK2 = ADDR(IFGRPL);       /* RPL ADDRESS            */
         LR    WRK2,RPLREG                                         0596
*               RPLCHN = OC;               /* USE ONLY CHAIN @ZM20858*/
         MVI   RPLCHN+16(RPLREG),X'10'                             0597
*               GENERATE REFS(FRRPTR,FRRS,FRRSCURR,FRRSLAST,FRRSELEN,
*                             FRRSFRRA,FRRSENTR,FRRSPARM,PSA,PSACSTK,
*                             PSALSFCC,PSALITA,FLC)                0598
*                        SETS(WRK2,WRK3,REGPARM,REG1,REG13,REG14,  0598
*                             REG15);                              0598
*                                                                  0598
       SETLOCK RELEASE,                                               CC
               TYPE=LOCAL,                                            CC
               REGS=USE,                                              CC
               RELATED=(RPL)
       SEND    RPL=(WRK2),                                            CC
               CONTROL=CANCEL
       SETFRR  A,FRRAD=(FRRPTR),PARMAD=(REGPARM),WRKREGS=(WRK2,WRK3)
       SETLOCK OBTAIN,                                                CC
               TYPE=LOCAL,                                            CC
               MODE=UNCOND,                                           CC
               REGS=USE,                                              CC
               RELATED=(RPL)
*               FRRPARM=REGPARM;           /* SAVE ADDRESS OF      0599
*                                              PARAMETER AREA      0599
*                                              PROVIDED BY         0599
*                                              SETFRR MACRO  @ZM20856*/
         ST    REGPARM,FRRPARM                                     0599
*               RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) UNRSTD;
*                                                                  0600
*               CALL INITFRR;              /* CALL FRR INIT  @ZM20856*/
         BAL   @14,INITFRR                                         0601
*               AGAIN = '1'B;              /* CONTINUE CHAINING      */
*               MSG = '1'B;                /* POSSIBLY MSG ON QUEUE  */
         OI    AGAIN(TOMWREG),B'00000101'                          0603
*             END;                         /* CHAIN CANCELED         */
*           ELSE;                          /* CHAIN ALREADY ENDED    */
*                                                                  0605
@RF00591 DS    0H                                                  0606
*           MOR = '0'B;                    /* END OF MESSAGE         */
         NI    MOR(TOMWREG),B'01111111'                            0606
*           SPEC = '0'B;                   /* NOT SPECIAL CONDITION  */
*           SENDPRMT = '0'B;               /* RESET SEND-PROMPT SW   */
*           NOTNOW = '0'B;                 /* RESET SWITCH           */
         NI    SPEC(TOMWREG),B'11010011'                           0609
*           RPLCHN = OC;                   /* RESET CHAIN ELEMENT    */
         MVI   RPLCHN+16(RPLREG),X'10'                             0610
*           CHAINSZE=TVWACHNL;             /* RESET CHAIN SIZE       */
         IC    @15,TVWACHNL(,TVWAREG)                              0611
         STC   @15,CHAINSZE(,TOMWREG)                              0611
*           RUCOUNT=CHAINSZE;              /* RESET RU COUNT         */
*                                                                  0612
         IC    @15,CHAINSZE(,TOMWREG)                              0612
         STC   @15,RUCOUNT(,TOMWREG)                               0612
*           END CHKOCEOC;                  /* END OF CHKOCEOC        */
@EL00008 DS    0H                                                  0613
@EF00008 DS    0H                                                  0613
@ER00008 L     @14,@SA00008                                        0613
         BR    @14                                                 0613
         EJECT
*ATTNROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0614
*                                                                  0614
ATTNROUT ST    @14,12(,@13)                                        0614
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - ATTNROUT                                  */
*           /*                                                       */
*           /* FUNCTION - TO MOVE ATTENTION AND ATTENTION-IGNORED    */
*           /*            COMBINATIONS INTO THE RU.                  */
*           /*            THE ATTENTION COUNTER (TVWAATTN) AND THE   */
*           /*            ATTENTION-IGNORED INDICATOR (TVWAAIGN) ARE */
*           /*            SET BY IKTTIMRT.  FOR EACH ATTENTION COUNT,*/
*           /*            THE EXCLAMATION-POINT CHARACTER (X'5A')    */
*           /*            AND THE SCS NEW-LINE CHARACTER (X'15') ARE */
*           /*            MOVED INTO THE RU.  WHEN ATTENTION-IGNORED */
*           /*            IS INDICATED, THE EXCLAMATION-POINT AND I  */
*           /*            CHARACTERS (X'5AC9') AND THE SCS NEW-LINE  */
*           /*            CHARACTER (X'15') ARE MOVED INTO THE RU.   */
*           /*            SINCE THE RU CONSISTS OF A MAXIMUM OF 256  */
*           /*            BYTES AND SINCE AN ATTENTION-IGNORED       */
*           /*            COMBINATION (X'5AC914') REQUIRES 3 BYTES,  */
*           /*            THERE CAN BE AT MOST 126 ATTENTION         */
*           /*            COMBINATIONS (X'5A15') IN THE RU.  IF THE  */
*           /*            ATTENTION COUNT IS GREATER THAN 126, AFTER */
*           /*            126 ATTENTION COMBINATIONS HAVE BEEN MOVED */
*           /*            INTO THE RU, THE ATTENTION COUNTER WILL BE */
*           /*            SET TO ZERO.                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0615
*           IF TVWAATTN > 0 THEN        /* ATTENTION?                */
         CLI   TVWAATTN(TVWAREG),0                                 0615
         BNH   @RF00615                                            0615
*             DO;                       /* DO ATTENTION PROCESSING   */
*                                                                  0616
*               /*****************************************************/
*               /* FOR EACH NONZERO ATTENTION COUNT BUT NO MORE      */
*               /* THAN 126, MOVE THE EXCLAMATION-POINT CHARACTER    */
*               /* FOLLOWED BY THE NEW-LINE CHARACTER INTO THE RU.   */
*               /*****************************************************/
*               TVWAATTN = MIN(TVWAATTN,126);                      0617
         SLR   @15,@15                                             0617
         IC    @15,TVWAATTN(,TVWAREG)                              0617
         LA    @14,126                                             0617
         CR    @15,@14                                             0617
         BNH   *+6
         LR    @15,@14                                             0617
         STC   @15,TVWAATTN(,TVWAREG)                              0617
*               DO I=1 TO TVWAATTN;                                0618
         LA    @15,1                                               0618
         B     @DE00618                                            0618
@DL00618 DS    0H                                                  0619
*                  RU(BYTECNT:BYTECNT+1) = '5A15'X;                0619
         L     @15,BYTECNT(,TOMWREG)                               0619
         ALR   @15,TOMWREG                                         0619
         MVC   RU-1(2,@15),@CB02826                                0619
*                  BYTECNT = BYTECNT + 2;                          0620
         L     @15,BYTECNT(,TOMWREG)                               0620
         AL    @15,@CF00076                                        0620
         ST    @15,BYTECNT(,TOMWREG)                               0620
*               END;                                               0621
*                                                                  0621
         LA    @15,1                                               0621
         AL    @15,I(,TOMWREG)                                     0621
@DE00618 ST    @15,I(,TOMWREG)                                     0621
         SLR   @14,@14                                             0621
         IC    @14,TVWAATTN(,TVWAREG)                              0621
         CR    @15,@14                                             0621
         BNH   @DL00618                                            0621
*               TVWAATTN = 0;           /* CLEAR ATTENTION COUNTER.  */
         MVI   TVWAATTN(TVWAREG),X'00'                             0622
*             END;                      /* END ATTENTION PROCESSING  */
*           ELSE;                       /* NOT ATTENTION SITUATION   */
*                                                                  0624
@RF00615 DS    0H                                                  0625
*           IF TVWAAIGN = '1'B THEN     /* ATTENTION IGNORED?        */
*                                                                  0625
         TM    TVWAAIGN(TVWAREG),B'00100000'                       0625
         BNO   @RF00625                                            0625
*             /*******************************************************/
*             /* MOVE THE EXCLAMATION-POINT AND I CHARACTERS FOLLOWED*/
*             /* BY THE SCS NEW-LINE CHARACTER TO THE RU.  CLEAR THE */
*             /* ATTENTION-IGNORED INDICATOR.                        */
*             /*******************************************************/
*                                                                  0626
*             DO;                       /* PROCESS ATTENTION-IGNORED */
*               RU(BYTECNT:BYTECNT+2) = '5AC915'X;                 0627
         L     @15,BYTECNT(,TOMWREG)                               0627
         ALR   @15,TOMWREG                                         0627
         MVC   RU-1(3,@15),@CB02827                                0627
*               BYTECNT = BYTECNT + 3;  /* UPDATE BYTE POSITION      */
         L     @15,BYTECNT(,TOMWREG)                               0628
         AL    @15,@CF00291                                        0628
         ST    @15,BYTECNT(,TOMWREG)                               0628
*               TVWAAIGN = '0'B;        /* RESET IGNORED SWITCH      */
         NI    TVWAAIGN(TVWAREG),B'11011111'                       0629
*             END;                      /* END PROCESSING            */
*                                                                  0630
*           ELSE;                       /* NOT ATTENTION-IGNORED     */
*                                                                  0631
@RF00625 DS    0H                                                  0632
*           END ATTNROUT;               /* END OF ATTNROUT           */
@EL00009 DS    0H                                                  0632
@EF00009 DS    0H                                                  0632
@ER00009 L     @14,12(,@13)                                        0632
         BR    @14                                                 0632
         EJECT
*EDITMSG:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0633
*                                                                  0633
EDITMSG  ST    @14,@SA00010                                        0633
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - EDITMSG                                   */
*           /*                                                       */
*           /* FUNCTION - TO EDIT MESSAGE AND PLACE THE RESULT INTO  */
*           /*            THE RU.                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0634
*           BUFPTR = OPBUFADR;             /* ADDRESS OF MESSAGE     */
         L     @15,OPBUFADR(,TOMWREG)                              0634
         ST    @15,BUFPTR(,TOMWREG)                                0634
*           SIZE =  OPBFSZ;                /* SIZE OF MESSAGE        */
*                                                                  0635
         LH    @15,OPBFSZ(,TOMWREG)                                0635
         ST    @15,SIZE(,TOMWREG)                                  0635
*           /*********************************************************/
*           /* IF START-WITH-NEW-LINE-CHARACTER IS INDICATED,        */
*           /* PLACE ADD NEW-LINE CHARACTER INTO THE RU.             */
*           /*********************************************************/
*           IF SWNL = '1'B THEN            /* NEW-LINE SITUATION?    */
         TM    SWNL(TOMWREG),B'01000000'                           0636
         BNO   @RF00636                                            0636
*             DO;                          /* BEGIN NL PROCESSING    */
*               SWNL = '0'B;               /* RESET NEW-LINE SWITCH  */
         NI    SWNL(TOMWREG),B'10111111'                           0638
*               RU(BYTECNT) = NL;          /* NEXT LINE              */
         L     @15,BYTECNT(,TOMWREG)                               0639
         ALR   @15,TOMWREG                                         0639
         MVC   RU-1(1,@15),NL                                      0639
*               BYTECNT = BYTECNT + 1;     /* NEXT BYTE POSITION     */
         L     @15,BYTECNT(,TOMWREG)                               0640
         AL    @15,@CF00064                                        0640
         ST    @15,BYTECNT(,TOMWREG)                               0640
*             END;                         /* END NL PROCESSING      */
*           ELSE;                          /* NOT NEW-LINE SITUATION */
*                                                                  0642
@RF00636 DS    0H                                                  0643
*           /*********************************************************/
*           /* IF THERE IS AN INSTALLATION EXIT FOR EDITING,         */
*           /* ADDR(IKTRTX1) WILL NOT BE ZERO.  THE INSTALLATION     */
*           /* EXIT EDIT ROUTINE WILL RETURN A ZERO RETURN CODE IF   */
*           /* NORMAL EDITING IS TO BE PERFORMED.                    */
*           /*********************************************************/
*                                                                  0643
*           RFY REG0 RSTD;                 /* RESTRICT REGISTER 0    */
*           IF ADDR(IKTRTX1) = 0 THEN      /* NO USER EXIT?          */
         L     @01,@CV02710                                        0644
         LTR   @01,@01                                             0644
         BNZ   @RF00644                                            0644
*             NORMEDIT = '1'B;             /* DO NORMAL EDIT         */
         OI    NORMEDIT(TOMWREG),B'00100000'                       0645
*           ELSE                           /* INSTALLATION EXIT      */
*             DO;                          /* DO THE FOLLOWING       */
         B     @RC00644                                            0646
@RF00644 DS    0H                                                  0647
*               REG0 = ADDR(OPARMSA);      /* PARAMETER LIST ADDRESS */
         LA    REG0,OPARMSA(,TOMWREG)                              0647
*               OPARMSA = ADDR(OPARMS);    /* OPARMS ADDRESS         */
         LA    @01,OPARMS(,TOMWREG)                                0648
         ST    @01,OPARMSA(,TOMWREG)                               0648
*               BYTECNTA = ADDR(BYTECNT);  /* BYTECNT ADDRESS        */
         LA    @01,BYTECNT(,TOMWREG)                               0649
         ST    @01,BYTECNTA(,TOMWREG)                              0649
*               BUFPTRA = ADDR(BUFPTR);    /* BUFPTR ADDRESS         */
         LA    @01,BUFPTR(,TOMWREG)                                0650
         ST    @01,BUFPTRA(,TOMWREG)                               0650
*               RUADDR = ADDR(RU);         /* RU ADDRESS             */
         LA    @01,RU(,TOMWREG)                                    0651
         ST    @01,RUADDR(,TOMWREG)                                0651
*               CHARCNTA = ADDR(CHARCNT);  /* CHARCNT ADDRESS        */
         LA    @01,CHARCNT(,TOMWREG)                               0652
         ST    @01,CHARCNTA(,TOMWREG)                              0652
*               BITVALA = ADDR(BITVALU0);  /* BITVALU0 ADDRESS       */
         LA    @01,BITVALU0(,TOMWREG)                              0653
         ST    @01,BITVALA(,TOMWREG)                               0653
*               LASTPARM = '8'X;           /* LAST PARAMETER         */
         LA    @01,8                                               0654
         STC   @01,LASTPARM(,TOMWREG)                              0654
*               TSBADDR = ASCBTSB;         /* TSB ADDRESS            */
         L     @01,PSAAOLD                                         0655
         MVC   TSBADDR(3,TOMWREG),ASCBTSB+1(@01)                   0655
*               CALL IKTRTX1;              /* CALL INSTALLATION EXIT */
         L     @15,@CV02710                                        0656
         BALR  @14,@15                                             0656
*               RFY RTNCDE RSTD;           /* RESTRICT CODE REGISTER */
*               IF RTNCDE = 0 THEN         /* DO NORMAL EDIT?        */
         LTR   RTNCDE,RTNCDE                                       0658
         BNZ   @RF00658                                            0658
*                 NORMEDIT = '1'B;         /* DO NORMAL EDIT         */
         OI    NORMEDIT(TOMWREG),B'00100000'                       0659
*               ELSE                       /* NOT NORMAL EDIT CASE   */
*                 NORMEDIT = '0'B;         /* DO NOT DO NORMAL EDIT  */
         B     @RC00658                                            0660
@RF00658 NI    NORMEDIT(TOMWREG),B'11011111'                       0660
*               RFY RTNCDE UNRSTD;         /* UNRESTRICT CODE REG    */
@RC00658 DS    0H                                                  0662
*             END;                         /* END OF USER EXIT       */
*           RFY REG0 UNRSTD;               /* UNRESTRICT REGISTER 0  */
@RC00644 DS    0H                                                  0664
*           IF NORMEDIT = '1'B THEN        /* DO NORMAL EDIT?        */
         TM    NORMEDIT(TOMWREG),B'00100000'                       0664
         BNO   @RF00664                                            0664
*             /*******************************************************/
*             /* IF CONTROL OPTION, CALL CNTRLOPT TO EDIT DATA AND   */
*             /* PLACE THE RESULT INTO THE RU.                       */
*             /*******************************************************/
*             IF OPEDIT = '10'B THEN       /* CONTROL TPUT?          */
         TM    OPEDIT(TOMWREG),B'00100000'                         0665
         BNO   @RF00665                                            0665
         TM    OPEDIT(TOMWREG),B'00010000'                         0665
         BNZ   @RF00665                                            0665
*               CALL CNTRLOPT;             /* CALL CONTROL ROUTINE   */
         BAL   @14,CNTRLOPT                                        0666
*             ELSE                         /* NOT CONTROL OPTION     */
*               DO;                        /* EDIT-ASIS OPTION       */
         B     @RC00665                                            0667
@RF00665 DS    0H                                                  0668
*                 CALL EDITASIS;           /* CALL EDIT-ASIS ROUTINE */
         BAL   @14,EDITASIS                                        0668
*                 /***************************************************/
*                 /* IF THE LINE SIZE IS GREATER THAN OR EQUAL TO    */
*                 /* 132, MOVE EDITED DATA INTO RU.                  */
*                 /* OTHERWISE, CALL INSERTNL TO INSERT NEW-LINE     */
*                 /* CHARACTERS INTO THE EDITED DATA AND TO MOVE THE */
*                 /* RESULT INTO THE RU.                             */
*                 /***************************************************/
*                 IF TSBLNSZ >=  132 THEN  /* LINE SIZE >= 132?      */
         CLI   TSBLNSZ(TSBREG),132                                 0669
         BL    @RF00669                                            0669
*                   /*************************************************/
*                   /* MOVE DATA FROM THE WORKSPACE INTO THE RU.     */
*                   /*************************************************/
*                   DO;                    /* DO THE FOLLOWING       */
*                     RU(BYTECNT:BYTECNT+LIMIT-1) = WKSP(1:LIMIT); 0671
         L     @15,BYTECNT(,TOMWREG)                               0671
         ALR   @15,TOMWREG                                         0671
         L     @14,LIMIT(,TOMWREG)                                 0671
         LR    @05,@14                                             0671
         BCTR  @05,0                                               0671
         EX    @05,@SM02999                                        0671
*                     BYTECNT=BYTECNT+LIMIT; /* INCREMENT RU POSITION*/
         L     @15,BYTECNT(,TOMWREG)                               0672
         ALR   @15,@14                                             0672
         ST    @15,BYTECNT(,TOMWREG)                               0672
*                     IF SIZE = LIMIT THEN /* END OF MESSAGE?        */
         C     @14,SIZE(,TOMWREG)                                  0673
         BNE   @RF00673                                            0673
*                       MOR = '0'B;        /* END OF MESSAGE         */
         NI    MOR(TOMWREG),B'01111111'                            0674
*                     ELSE                 /* MIDDLE OF MESSAGE      */
*                       DO;                /* UPDATE MESSAGE POINTER */
         B     @RC00673                                            0675
@RF00673 DS    0H                                                  0676
*                         MOR = '1'B;      /* NOT END OF MESSAGE     */
         OI    MOR(TOMWREG),B'10000000'                            0676
*                         BUFPTR = BUFPTR + LIMIT;                 0677
         L     @15,BUFPTR(,TOMWREG)                                0677
         AL    @15,LIMIT(,TOMWREG)                                 0677
         ST    @15,BUFPTR(,TOMWREG)                                0677
*                       END;               /* MESSAGE POINTER UPDATED*/
*                     IF MOR = '0'B &      /* END OF MESSAGE?        */
*                       (OPEDIT = '00'B ×  /* EDIT TPUT?             */
*                        OPBRK='1'B ×      /* BREAK TPUT?            */
*                        OPASID='1'B) THEN /* CROSS-MEMORY TPUT?     */
@RC00673 TM    MOR(TOMWREG),B'10000000'                            0679
         BNZ   @RF00679                                            0679
         TM    OPEDIT(TOMWREG),B'00110000'                         0679
         BZ    @RT00679                                            0679
         TM    OPBRK(TOMWREG),B'01001000'                          0679
         BZ    @RF00679                                            0679
@RT00679 DS    0H                                                  0680
*                       SWNL = '1'B;       /* START ON NEW LINE      */
         OI    SWNL(TOMWREG),B'01000000'                           0680
*                     ELSE;                /* REMAIN ON SAME LINE    */
@RF00679 DS    0H                                                  0682
*                   END;                   /* EDITED DATA IN RU      */
*                 ELSE                     /* LINE SIZE < 132        */
*                   DO;                    /* DO NEW-LINE PROCESSING */
         B     @RC00669                                            0683
@RF00669 DS    0H                                                  0684
*                     CALL INSERTNL;       /* INSERT NL CHARACTERS   */
         BAL   @14,INSERTNL                                        0684
*                     IF MOR = '1'B THEN   /* MIDDLE OF MESSAGE?     */
         TM    MOR(TOMWREG),B'10000000'                            0685
         BNO   @RF00685                                            0685
*                       BUFPTR = BUFPTR + I - 1;                   0686
         L     @15,BUFPTR(,TOMWREG)                                0686
         AL    @15,I(,TOMWREG)                                     0686
         BCTR  @15,0                                               0686
         ST    @15,BUFPTR(,TOMWREG)                                0686
*                     ELSE;                /* END OF MESSAGE         */
@RF00685 DS    0H                                                  0688
*                   END;                   /* END NEW-LINE PROCESSING*/
*               END;                       /* END NORMAL EDITING     */
*           ELSE;                          /* NO NORMAL EDITING      */
*                                                                  0690
@RF00664 DS    0H                                                  0691
*           END EDITMSG;                   /* END OF EDITMSG         */
@EL00010 DS    0H                                                  0691
@EF00010 DS    0H                                                  0691
@ER00010 L     @14,@SA00010                                        0691
         BR    @14                                                 0691
         EJECT
*CNTRLOPT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0692
*                                                                  0692
CNTRLOPT ST    @14,12(,@13)                                        0692
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - CNTRLOPT                                  */
*           /*                                                       */
*           /* FUNCTION - TO EDIT MESSAGE ACCORDING TO THE CONTROL   */
*           /*            OPTION AND TO PLACE THE RESULT INTO THE    */
*           /*            RU.  ONLY BYPASS AND RESTORE CHARACTERS    */
*           /*            ARE VALID.                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0693
*           LIMIT = MIN(257-BYTECNT,SIZE); /* BYTES TO BE EDITED     */
         LA    @15,257                                             0693
         SL    @15,BYTECNT(,TOMWREG)                               0693
         L     @14,SIZE(,TOMWREG)                                  0693
         CR    @15,@14                                             0693
         BNH   *+6
         LR    @15,@14                                             0693
         ST    @15,LIMIT(,TOMWREG)                                 0693
*           I = 1;                         /* INITIALIZE INDEX       */
         MVC   I(4,TOMWREG),@CF00064                               0694
*           DO WHILE(I <= LIMIT);                                  0695
         B     @DE00695                                            0695
@DL00695 DS    0H                                                  0696
*              IF BUFFER(I) = BYP ×        /* BYPASS CHARACTER?      */
*                 BUFFER(I) = RES THEN     /* RESTORE CHARACTER?     */
         L     @15,I(,TOMWREG)                                     0696
         L     @14,BUFPTR(,TOMWREG)                                0696
         ALR   @15,@14                                             0696
         BCTR  @15,0                                               0696
         CLC   BUFFER(1,@15),BYP                                   0696
         BE    @RT00696                                            0696
         L     @15,I(,TOMWREG)                                     0696
         ALR   @14,@15                                             0696
         BCTR  @14,0                                               0696
         CLC   BUFFER(1,@14),RES                                   0696
         BNE   @RF00696                                            0696
@RT00696 DS    0H                                                  0697
*                DO;                       /* DO THE FOLLOWING       */
*                  RU(BYTECNT)=BUFFER(I);  /* MOVE IN CONTROL CHAR.  */
         L     @15,BYTECNT(,TOMWREG)                               0698
         ALR   @15,TOMWREG                                         0698
         L     @01,I(,TOMWREG)                                     0698
         L     @14,BUFPTR(,TOMWREG)                                0698
         ALR   @14,@01                                             0698
         BCTR  @14,0                                               0698
         MVC   RU-1(1,@15),BUFFER(@14)                             0698
*                  BYTECNT = BYTECNT + 1;  /* NEXT BYTE POSITION     */
         L     @15,BYTECNT(,TOMWREG)                               0699
         AL    @15,@CF00064                                        0699
         ST    @15,BYTECNT(,TOMWREG)                               0699
*                END;                      /* CONTROL CHAR. IN RU    */
*              ELSE;                       /* NOT CONTROL CHARACTER  */
@RF00696 DS    0H                                                  0702
*              I = I + 1;                  /* NEXT BUFFER POSITION   */
         LA    @15,1                                               0702
         AL    @15,I(,TOMWREG)                                     0702
         ST    @15,I(,TOMWREG)                                     0702
*           END;                           /* END OF SEARCH          */
@DE00695 L     @15,LIMIT(,TOMWREG)                                 0703
         C     @15,I(,TOMWREG)                                     0703
         BNL   @DL00695                                            0703
*           BUFPTR = BUFPTR + LIMIT;       /* UPDATE BUFFER ADDRESS  */
         L     @14,BUFPTR(,TOMWREG)                                0704
         ALR   @14,@15                                             0704
         ST    @14,BUFPTR(,TOMWREG)                                0704
*           IF SIZE = LIMIT THEN           /* END OF MESSAGE?        */
         C     @15,SIZE(,TOMWREG)                                  0705
         BNE   @RF00705                                            0705
*             MOR = '0'B;                  /* END OF MESSAGE         */
         NI    MOR(TOMWREG),B'01111111'                            0706
*           ELSE                           /* NOT END OF MESSAGE     */
*             MOR = '1'B;                  /* NOT END OF MESSAGE     */
         B     @RC00705                                            0707
@RF00705 OI    MOR(TOMWREG),B'10000000'                            0707
*           IF BYTECNT = 1 THEN            /* RU EMPTY?              */
@RC00705 CLC   BYTECNT(4,TOMWREG),@CF00064                         0708
         BNE   @RF00708                                            0708
*             DO;                                                  0709
*               RU(1:2) = '4016'X;         /* SPACE AND BACKSPACE    */
         MVC   RU(2,TOMWREG),@CB02804                              0710
*               BYTECNT = 3;               /* NEXT AVAILABLE BYTE    */
         MVC   BYTECNT(4,TOMWREG),@CF00291                         0711
*             END;                                                 0712
*           ELSE;                          /* RU IS NOT EMPTY        */
*                                                                  0713
@RF00708 DS    0H                                                  0714
*           END CNTRLOPT;                  /* END OF CNTRLOPT        */
@EL00011 DS    0H                                                  0714
@EF00011 DS    0H                                                  0714
@ER00011 L     @14,12(,@13)                                        0714
         BR    @14                                                 0714
         EJECT
*EDITASIS:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0715
*                                                                  0715
EDITASIS ST    @14,12(,@13)                                        0715
*    /****************************************************************/
*    /*                                                              */
*    /*        PROCEDURE - EDITASIS                                  */
*    /*                                                              */
*    /*        FUNCTION - TO MOVE AS MUCH OF THE MESSAGE (BUT NO     */
*    /*                   MORE THAN THERE IS ROOM IN THE RU) INTO    */
*    /*                   THE WORKSPACE AND TO EDIT ACCORDING TO THE */
*    /*                   TPUT-ASIS OR THE TPUT-EDIT OPTION.    THE  */
*    /*                   TPUT-FULLSCR OPTION IS TREATED AS A        */
*    /*                   TPUT-ASIS OPTION.   FOR THE TPUT-EDIT      */
*    /*                   OPTION, SET HORIZONTAL FORMAT AND SET      */
*    /*                   VERTICAL FORMAT STRINGS ARE REPLACED BY    */
*    /*                   COLONS (X'7A').                            */
*    /*        NOTES - SET HORIZONTAL FORMAT IS X'2BC1', WHICH IS    */
*    /*                FMT (=X'2B') CONCATENATED WITH THE CHARACTER  */
*    /*                A (=X'C1').  SET VERTICAL FORMAT IS X'2BC2',  */
*    /*                WHICH IS FMT (=X'2B') CONCATENATED WITH THE   */
*    /*                CHARACTER B (=X'C2').  THE SET HORIZONTAL     */
*    /*                (VERTICAL) FORMAT TWO-BYTE CODE IS FOLLOWED   */
*    /*                BY A ONE-BYTE COUNT (CNT).  THE ONE-BYTE      */
*    /*                COUNT (CNT) IS THE NUMBER OF BYTES TO THE END */
*    /*                OF THE SET HORIZONTAL (VERTICAL) FORMAT       */
*    /*                STRING, INCLUDING THE BYTE-COUNT.  IN         */
*    /*                WHAT FOLLOWS, SHF (=X'C1') IS THE CHARACTER   */
*    /*                A TO REPRESENT SET HORIZONTAL FORMAT AND SVF  */
*    /*                (=X'C2') IS THE CHARACTER B TO REPRESENT SET  */
*    /*                VERTICAL FORMAT.                              */
*    /*                                                              */
*    /*        SET HORIZONTAL/VERTICAL FORMAT:                       */
*    /*                                                              */
*    /*        *************************                   ********* */
*    /*        *       *   A   *       *                   *       * */
*    /*        * F M T *  O R  * C N T *      *  *  *      *       * */
*    /*        *       *   B   *       *                   *       * */
*    /*        *************************                   ********* */
*    /*                         *                                 *  */
*    /*                        *********       C N T       ********* */
*    /*                         *                                 *  */
*    /****************************************************************/
*                                                                  0716
*           /*********************************************************/
*           /* MOVE AS MUCH OF THE MESSAGE (BUT NO MORE THAN THERE   */
*           /* IS ROOM IN THE RU) INTO THE WORKSPACE.  THE WORKSPACE */
*           /* CONSISTS OF 256 BYTES.                                */
*           /*********************************************************/
*                                                                  0716
*           LIMIT = MIN(257-BYTECNT,SIZE);    /* BYTES TO BE EDITED  */
         LA    @15,257                                             0716
         SL    @15,BYTECNT(,TOMWREG)                               0716
         L     @14,SIZE(,TOMWREG)                                  0716
         CR    @15,@14                                             0716
         BNH   *+6
         LR    @15,@14                                             0716
         ST    @15,LIMIT(,TOMWREG)                                 0716
*           WKSP(1:LIMIT) = BUFFER(1:LIMIT);  /* MESSAGE IN WORKSPACE*/
*                                                                  0717
         BCTR  @15,0                                               0717
         L     @01,BUFPTR(,TOMWREG)                                0717
         EX    @15,@SM03001                                        0717
*           /*********************************************************/
*           /* L IS THE BYTE-POSITION OF THE LEFT-MOST BYTE THAT HAS */
*           /* NOT BEEN TRANSLATED OR EDITED.                        */
*           /* IF THERE IS AN FMT CHARACTER, THEN R IS THE POSITION  */
*           /* OF THE FIRST OCCURRENCE OF THE CHARACTER FMT AFTER    */
*           /* THE POSITION L.                                       */
*           /*********************************************************/
*                                                                  0718
*           L = 1;                            /* INIT. LEFT POSITION */
         LA    @15,1                                               0718
         ST    @15,L(,TOMWREG)                                     0718
*           R = 1;                            /* INIT. RIGHT INDEX   */
*                                                                  0719
         ST    @15,R(,TOMWREG)                                     0719
*           /*********************************************************/
*           /* SEARCH FOR THE FIRST OCCURRENCE OF THE FMT CHARACTER. */
*           /* IF AN FMT CHARACTER IS FOUND, TRANSLATE UP TO THE     */
*           /* FMT CHARACTER USING EITHER THE EDITAB OR ASISTAB      */
*           /* TABLE.  OTHERWISE, TRANSLATE TO THE END OF WHAT IS IN */
*           /* THE WORKSPACE (WKSP).                                 */
*           /* IF THE TPUT-EDIT OPTION IS BEING CONSIDERED, IF THE   */
*           /* CHARACTER AFTER FMT IS NOT AN 'A' AND NOT A 'B', IF   */
*           /* A FUNCTION ERROR HAS OCCURRED AND AN SVF IS BEING     */
*           /* CONSIDERED, OR IF A PARAMETER ERROR HAS OCCURRED,     */
*           /* THEN REPLACE THE FMT STRING WITH COLONS.  OTHERWISE,  */
*           /* LEAVE THE FMT STRING INTACT.  HOWEVER, IF THE FMT     */
*           /* CHARACTER OCCURS IN THE LAST POSITION OF THE MESSAGE, */
*           /* REPLACE IT WITH A COLON, OR IF THE FMT CHARACTER      */
*           /* OCCURS IN THE SECOND TO THE LAST POSITION OF THE      */
*           /* MESSAGE, REPLACE THE LAST TWO BYTES WITH COLONS.      */
*           /* REPEAT THE ABOVE-MENTIONED STEPS UNTIL EVERYTHING     */
*           /* THAT IS IN THE WORKSPACE HAS BEEN EXAMINED.           */
*           /*********************************************************/
*           RFY (REG1,REG2) RSTD;             /* RESTRICT REGS. 1,2  */
*           DO WHILE(R <= LIMIT);                                  0721
         B     @DE00721                                            0721
@DL00721 DS    0H                                                  0722
*             OUTOFRNG = '0'B;                /* OUT-OF-RANGE SWITCH */
         NI    OUTOFRNG(TOMWREG),B'10111111'                       0722
*             REG1 = 0;                       /* CLEAR ADDRESS REG.  */
         SLR   REG1,REG1                                           0723
*             TRT(WKSP(L:LIMIT),FMTTAB);      /* SEARCH FOR FMT CHAR.*/
         L     @03,L(,TOMWREG)                                     0724
         ALR   @03,TOMWREG                                         0724
         L     @15,LIMIT(,TOMWREG)                                 0724
         SL    @15,L(,TOMWREG)                                     0724
         EX    @15,@SB03003                                        0724
*             BC(8,NOFMT);                    /* BRANCH IF NO FMT    */
         BC    8,NOFMT                                             0725
*                 R = REG1 - ADDR(WKSP) + 1;  /* FMT CHAR. POSITION  */
         LA    @03,WKSP(,TOMWREG)                                  0726
         LCR   @03,@03                                             0726
         ALR   @03,REG1                                            0726
         AL    @03,@CF00064                                        0726
         ST    @03,R(,TOMWREG)                                     0726
*                 IF R > L THEN               /* NOT AT BEGINNING?   */
         L     @15,L(,TOMWREG)                                     0727
         CR    @03,@15                                             0727
         BNH   @RF00727                                            0727
*                   IF OPEDIT = '00'B THEN    /* EDIT TPUT?          */
         TM    OPEDIT(TOMWREG),B'00110000'                         0728
         BNZ   @RF00728                                            0728
*                     TR(WKSP(L:R-1),EDITAB); /* TRANSLATE           */
         ALR   @15,TOMWREG                                         0729
         L     @03,R(,TOMWREG)                                     0729
         SL    @03,L(,TOMWREG)                                     0729
         BCTR  @03,0                                               0729
         EX    @03,@SB03005                                        0729
*                   ELSE                      /* NOT EDIT TPUT       */
*                     TR(WKSP(L:R-1),ASISTAB);                     0730
         B     @RC00728                                            0730
@RF00728 L     @03,L(,TOMWREG)                                     0730
         ALR   @03,TOMWREG                                         0730
         L     @15,R(,TOMWREG)                                     0730
         SL    @15,L(,TOMWREG)                                     0730
         BCTR  @15,0                                               0730
         EX    @15,@SB03007                                        0730
*                 ELSE;                       /* AT BEGINNING        */
@RF00727 DS    0H                                                  0732
*                 CNT = WKSP(R+2);            /* PARAMETER COUNT     */
@RC00727 L     @03,R(,TOMWREG)                                     0732
         SLR   @00,@00                                             0732
         IC    @00,WKSP+1(@03,TOMWREG)                             0732
         ST    @00,CNT(,TOMWREG)                                   0732
*                 IF CNT > 136 ×              /* CHECK COUNT         */
*                    CNT = 0 THEN             /* COUNT OUT OF RANGE? */
         C     @00,@CF02846                                        0733
         BH    @RT00733                                            0733
         LTR   @00,@00                                             0733
         BNZ   @RF00733                                            0733
@RT00733 DS    0H                                                  0734
*                   DO;                       /* SET SWITCHES        */
*                     OUTOFRNG = '1'B;        /* OUT OF RANGE        */
         OI    OUTOFRNG(TOMWREG),B'01000000'                       0735
*                     CNT = 1;                /* RESET COUNT         */
         MVC   CNT(4,TOMWREG),@CF00064                             0736
*                   END;                      /* SWITCHES SET        */
*                 ELSE;                       /* COUNT IS VALID      */
@RF00733 DS    0H                                                  0739
*                 IF LIMIT >= (R+CNT+1) THEN  /* FMT STRING FITS?    */
*                                                                  0739
         L     @03,R(,TOMWREG)                                     0739
         LR    @00,@03                                             0739
         AL    @00,CNT(,TOMWREG)                                   0739
         AL    @00,@CF00064                                        0739
         C     @00,LIMIT(,TOMWREG)                                 0739
         BH    @RF00739                                            0739
*                   /*************************************************/
*                   /* IF THE EDIT OPTION IS IN EFFECT, IF THE       */
*                   /* CHARACTER AFTER FMT IS NOT AN 'A' AND NOT     */
*                   /* A 'B', IF A FUNCTION ERROR HAS OCCURRED AND   */
*                   /* AN SVF IS BEING CONSIDERED, IF A PARAMETER    */
*                   /* ERROR OCCURRED, OR IF A PARAMETER IS OUT OF   */
*                   /* RANGE, REPLACE THE FMT STRING WITH COLONS.    */
*                   /* OTHERWISE, LEAVE THE FMT STRING INTACT.       */
*                   /*************************************************/
*                   IF OPEDIT='00'B ×         /* EDIT TPUT?          */
*                     (WKSP(R+1)^=SHF &       /* NOT SHF?            */
*                      WKSP(R+1)^=SVF) ×      /* NOT SVF?            */
*                     (FCNERR='1'B &          /* FUNCTION NOT      0740
*                                                SUPPORTED?          */
*                      WKSP(R+1)=SVF) ×       /* SVF?                */
*                      PARMERR='1'B ×         /* PARAMETER ERROR?    */
*                      OUTOFRNG='1'B THEN     /* PARAMETER OUT OF  0740
*                                                RANGE?              */
         TM    OPEDIT(TOMWREG),B'00110000'                         0740
         BZ    @RT00740                                            0740
         ALR   @03,TOMWREG                                         0740
         CLI   WKSP(@03),C'A'                                      0740
         BE    @GL00038                                            0740
         L     @03,R(,TOMWREG)                                     0740
         ALR   @03,TOMWREG                                         0740
         CLI   WKSP(@03),C'B'                                      0740
         BNE   @RT00740                                            0740
@GL00038 TM    FCNERR(TOMWREG),B'00100000'                         0740
         BNO   @GL00037                                            0740
         L     @03,R(,TOMWREG)                                     0740
         ALR   @03,TOMWREG                                         0740
         CLI   WKSP(@03),C'B'                                      0740
         BE    @RT00740                                            0740
@GL00037 TM    PARMERR(TOMWREG),B'00010000'                        0740
         BO    @RT00740                                            0740
         TM    OUTOFRNG(TOMWREG),B'01000000'                       0740
         BNO   @RF00740                                            0740
@RT00740 DS    0H                                                  0741
*                     DO;                     /* REPLACE FMT STRING  */
*                       /*********************************************/
*                       /* REPLACE FMT STRING WITH COLONS.           */
*                       /*********************************************/
*                       DO I=1 TO (CNT+2);                         0742
         LA    @03,1                                               0742
         B     @DE00742                                            0742
@DL00742 DS    0H                                                  0743
*                         WKSP(R) = COLON;    /* REPLACE WITH COLON  */
         L     @03,R(,TOMWREG)                                     0743
         ALR   @03,TOMWREG                                         0743
         MVC   WKSP-1(1,@03),COLON                                 0743
*                         R = R + 1;          /* NEXT BYTE POSITION  */
         L     @03,R(,TOMWREG)                                     0744
         AL    @03,@CF00064                                        0744
         ST    @03,R(,TOMWREG)                                     0744
*                       END;                                       0745
         LA    @03,1                                               0745
         AL    @03,I(,TOMWREG)                                     0745
@DE00742 ST    @03,I(,TOMWREG)                                     0745
         LA    @00,2                                               0745
         AL    @00,CNT(,TOMWREG)                                   0745
         CR    @03,@00                                             0745
         BNH   @DL00742                                            0745
*                       L = R;                /* RESET LEFT INDEX    */
         L     @03,R(,TOMWREG)                                     0746
         ST    @03,L(,TOMWREG)                                     0746
*                     END;                    /* END OF REPLACEMENT  */
*                   ELSE                      /* KEEP FMT STRING     */
*                     /***********************************************/
*                     /* LEAVE FMT STRING INTACT.                    */
*                     /***********************************************/
*                     DO;                     /* KEEP FMT STRING     */
         B     @RC00740                                            0748
@RF00740 DS    0H                                                  0749
*                       R = R + CNT + 2;      /* INCREMENT BYTE POS. */
         L     @03,R(,TOMWREG)                                     0749
         AL    @03,CNT(,TOMWREG)                                   0749
         AL    @03,@CF00076                                        0749
         ST    @03,R(,TOMWREG)                                     0749
*                       L = R;                /* RESET LEFT INDEX    */
         ST    @03,L(,TOMWREG)                                     0750
*                     END;                    /* FMT STRING KEPT     */
*                 ELSE                        /* FMT STRING TOO LARGE*/
*                   /*************************************************/
*                   /* IF PART OF FMT STRING IS MISSING,             */
*                   /* REPLACE WITH COLONS.                          */
*                   /* OTHERWISE, DO NOT CONSIDER FMT STRING AT      */
*                   /* THIS TIME.                                    */
*                   /*************************************************/
*                   IF LIMIT = SIZE  THEN     /* FMT STRING INVALID? */
         B     @RC00739                                            0752
@RF00739 CLC   LIMIT(4,TOMWREG),SIZE(TOMWREG)                      0752
         BNE   @RF00752                                            0752
*                     DO WHILE (R <= SIZE);                        0753
         B     @DE00753                                            0753
@DL00753 DS    0H                                                  0754
*                       WKSP(R) = COLON;      /* REPLACE WITH COLON  */
         L     @03,R(,TOMWREG)                                     0754
         ALR   @03,TOMWREG                                         0754
         MVC   WKSP-1(1,@03),COLON                                 0754
*                       R = R + 1;            /* NEXT BYTE POSITION  */
         L     @03,R(,TOMWREG)                                     0755
         AL    @03,@CF00064                                        0755
         ST    @03,R(,TOMWREG)                                     0755
*                     END;                                         0756
@DE00753 L     @03,R(,TOMWREG)                                     0756
         C     @03,SIZE(,TOMWREG)                                  0756
         BNH   @DL00753                                            0756
*                   ELSE                      /* FMT STRING VALID    */
*                     LIMIT = R - 1;          /* CONSIDER LATER      */
         B     @RC00752                                            0757
@RF00752 L     @03,R(,TOMWREG)                                     0757
         BCTR  @03,0                                               0757
         ST    @03,LIMIT(,TOMWREG)                                 0757
*             R = R - 1;                      /* RESET BYTE POSITION */
@RC00752 DS    0H                                                  0758
@RC00739 L     @03,R(,TOMWREG)                                     0758
         BCTR  @03,0                                               0758
         ST    @03,R(,TOMWREG)                                     0758
*             BC(15,NEXT);                                         0759
         BC    15,NEXT                                             0759
*NOFMT:       R = LIMIT;                      /* NO FMT CHARACTER    */
NOFMT    L     @03,LIMIT(,TOMWREG)                                 0760
         ST    @03,R(,TOMWREG)                                     0760
*                 IF OPEDIT = '00'B THEN      /* EDIT TPUT?          */
         TM    OPEDIT(TOMWREG),B'00110000'                         0761
         BNZ   @RF00761                                            0761
*                   TR(WKSP(L:R),EDITAB);     /* TRANSLATE           */
         L     @03,L(,TOMWREG)                                     0762
         ALR   @03,TOMWREG                                         0762
         L     @15,R(,TOMWREG)                                     0762
         SL    @15,L(,TOMWREG)                                     0762
         EX    @15,@SB03009                                        0762
*                 ELSE                        /* NOT EDIT TPUT       */
*                   TR(WKSP(L:R),ASISTAB);    /* TRANSLATE           */
         B     @RC00761                                            0763
@RF00761 L     @03,L(,TOMWREG)                                     0763
         ALR   @03,TOMWREG                                         0763
         L     @15,R(,TOMWREG)                                     0763
         SL    @15,L(,TOMWREG)                                     0763
         EX    @15,@SB03007                                        0763
*NEXT:          R = R + 1;                    /* NEXT BYTE POSITION  */
*                                                                  0764
@RC00761 DS    0H                                                  0764
NEXT     LA    @03,1                                               0764
         AL    @03,R(,TOMWREG)                                     0764
         ST    @03,R(,TOMWREG)                                     0764
*           END;                                                   0765
@DE00721 L     @03,R(,TOMWREG)                                     0765
         C     @03,LIMIT(,TOMWREG)                                 0765
         BNH   @DL00721                                            0765
*           RFY (REG1,REG2) UNRSTD;           /* UNRESTRICT REGS. 1,2*/
*           FCNERR = '0'B;                    /* RESET FUNCTION-NOT-
*                                                SUPPORTED SWITCH    */
*           PARMERR = '0'B;                   /* RESET PARAMETER-ERROR
*                                                SWITCH              */
*                                                                  0768
         NI    FCNERR(TOMWREG),B'11001111'                         0768
*           END EDITASIS;                     /* END OF EDITASIS     */
@EL00012 DS    0H                                                  0769
@EF00012 DS    0H                                                  0769
@ER00012 L     @14,12(,@13)                                        0769
         BR    @14                                                 0769
         EJECT
*TRANSL8:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0770
*                                                                  0770
TRANSL8  ST    @14,12(,@13)                                        0770
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - TRANSL8                                   */
*           /*                                                       */
*           /* FUNCTION - TO TRANSLATE CONTENTS OF RU, USING EITHER  */
*           /*            USER-TRANSLATE TABLE OR ASCII-TRANSLATE    */
*           /*            TABLE.                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0771
*IF BYTECNT=1 THEN              /* RU EMPTY?                @ZA19882 */
         CLC   BYTECNT(4,TOMWREG),@CF00064                         0771
         BNE   @RF00771                                            0771
*  DO;                          /* YES, SET UP FOR NULL RU  @ZA19882 */
*    RU(1:2)='4016'X;           /* SPACE-BACKSPACE          @ZA19882 */
         MVC   RU(2,TOMWREG),@CB02804                              0773
*    BYTECNT=3;                 /* NEXT AVAILABLE BYTE      @ZA19882 */
         MVC   BYTECNT(4,TOMWREG),@CF00291                         0774
*  END;                         /* END OF NULL RU SETUP     @ZA19882 */
*ELSE;                          /* THE RU IS NOT EMPTY      @ZA19882 */
@RF00771 DS    0H                                                  0777
*RFY (REG1,REG2) RSTD;          /* RESTRICT REGISTERS 1 & 2 @ZA19882 */
*L=1;                           /* SET LEFT INDEX TO 1      @ZA19882 */
         MVC   L(4,TOMWREG),@CF00064                               0778
*LIMIT=BYTECNT-1;               /* DATA LENGTH              @ZA19882 */
         L     @03,BYTECNT(,TOMWREG)                               0779
         BCTR  @03,0                                               0779
         ST    @03,LIMIT(,TOMWREG)                                 0779
*DO WHILE (L<=LIMIT);           /* LOOP THROUGH DATA IN RU  @ZA19882 */
         B     @DE00780                                            0780
@DL00780 DS    0H                                                  0781
*  R=LIMIT;                     /* SET THE RIGHT INDEX      @ZA19882 */
         L     @03,LIMIT(,TOMWREG)                                 0781
         ST    @03,R(,TOMWREG)                                     0781
*  REG1=0;                      /* INITIALIZE REGISTER 1    @ZA19882 */
         SLR   REG1,REG1                                           0782
*  REG2=0;                      /* INITIALIZE REGISTER 2    @ZA19882 */
         SLR   REG2,REG2                                           0783
*  TRT(RU(L:R),CNTRLTAB);       /* SEARCH FOR CONTROL CHAR. @ZA19882 */
         L     @03,L(,TOMWREG)                                     0784
         ALR   @03,TOMWREG                                         0784
         L     @15,R(,TOMWREG)                                     0784
         SL    @15,L(,TOMWREG)                                     0784
         EX    @15,@SB03011                                        0784
*  BC(8,NOCNTRLC);              /* BRANCH IF NO CNTL CHAR   @ZA19882 */
         BC    8,NOCNTRLC                                          0785
*  R=REG1-ADDR(RU(L));          /* INDEX BEFORE CONTROL CHAR@ZA19882 */
         L     @03,L(,TOMWREG)                                     0786
         LA    @00,RU-1(@03,TOMWREG)                               0786
         LCR   @00,@00                                             0786
         ALR   @00,REG1                                            0786
         ST    @00,R(,TOMWREG)                                     0786
*  IF L<=R THEN                 /* LEFT <= RIGHT INDEX?     @ZA19882 */
         CR    @03,@00                                             0787
         BH    @RF00787                                            0787
*    DO;                        /* YES, BEGIN TRANS. CHECKS @ZA19882 */
*NOCNTRLC:                                                         0789
*      IF TVWATRAN='1'B THEN    /* USER TRANSLATION?        @ZA19882 */
NOCNTRLC TM    TVWATRAN(TVWAREG),B'00000010'                       0789
         BNO   @RF00789                                            0789
*        TR(RU(L:R),USRTRANS);  /* DO USER TRANSLATION      @ZA19882 */
         L     @03,L(,TOMWREG)                                     0790
         ALR   @03,TOMWREG                                         0790
         L     @15,R(,TOMWREG)                                     0790
         SL    @15,L(,TOMWREG)                                     0790
         L     @14,TVWATABO(,TVWAREG)                              0790
         EX    @15,@SB03013                                        0790
*      ELSE;                    /* NOT USER TRANSLATION     @ZA19882 */
@RF00789 DS    0H                                                  0792
*      IF TSBXASCI='1'B THEN    /* ASCII?                   @ZA19882 */
         L     @03,TSBEXTNT(,TSBREG)                               0792
         TM    TSBXASCI(@03),B'10000000'                           0792
         BNO   @RF00792                                            0792
*        IF REG2=0 THEN         /* YES, AND NO CONTROL CHAR @ZA19882 */
         LTR   REG2,REG2                                           0793
         BNZ   @RF00793                                            0793
*          TR(RU(L:R),ASCIITAB);/* TRANSLATE INTO ASCII     @ZA19882 */
         L     @03,L(,TOMWREG)                                     0794
         ALR   @03,TOMWREG                                         0794
         L     @15,R(,TOMWREG)                                     0794
         SL    @15,L(,TOMWREG)                                     0794
         L     @14,TVWAATBO(,TVWAREG)                              0794
         EX    @15,@SB03015                                        0794
*        ELSE                   /* CONTROL CHARACTER        @ZA19882 */
*          IF REG2=FMT THEN     /* FORMAT CHARACTER         @ZA19882 */
         B     @RC00793                                            0795
@RF00793 SLR   @03,@03                                             0795
         IC    @03,FMT                                             0795
         CR    REG2,@03                                            0795
         BNE   @RF00795                                            0795
*            TR(RU(L:R+2),ASCIITAB); /* INCLUDE FMT A/B     @ZA19882 */
         L     @03,L(,TOMWREG)                                     0796
         ALR   @03,TOMWREG                                         0796
         L     @15,R(,TOMWREG)                                     0796
         SL    @15,L(,TOMWREG)                                     0796
         AL    @15,@CF00076                                        0796
         L     @14,TVWAATBO(,TVWAREG)                              0796
         EX    @15,@SB03015                                        0796
*          ELSE                 /* NOT FORMAT CHARACTER     @ZA19882 */
*            TR(RU(L:R+1),ASCIITAB); /* INCLUDE CNTL CHAR   @ZA19882 */
         B     @RC00795                                            0797
@RF00795 L     @03,L(,TOMWREG)                                     0797
         ALR   @03,TOMWREG                                         0797
         L     @15,R(,TOMWREG)                                     0797
         SL    @15,L(,TOMWREG)                                     0797
         AL    @15,@CF00064                                        0797
         L     @14,TVWAATBO(,TVWAREG)                              0797
         EX    @15,@SB03015                                        0797
*      ELSE;                    /* NOT ASCII                @ZA19882 */
@RF00792 DS    0H                                                  0799
*    END;                       /* END TRANSLATION CHECKS   @ZA19882 */
*  ELSE;                        /* LEFT INDEX > RIGHT INDEX @ZA19882 */
@RF00787 DS    0H                                                  0801
*  IF REG2=0 THEN               /* NO CONTROL CHAR FOUND?   @ZA19882 */
@RC00787 LTR   REG2,REG2                                           0801
         BNZ   @RF00801                                            0801
*    L=L+R;                     /* INCLUDE END OF DATA      @ZA19882 */
         L     @03,L(,TOMWREG)                                     0802
         AL    @03,R(,TOMWREG)                                     0802
         ST    @03,L(,TOMWREG)                                     0802
*  ELSE                         /* CONTROL CHAR. WAS FOUND  @ZA19882 */
*    IF REG2=FMT THEN           /* FORMAT CHARACTER         @ZA19882 */
         B     @RC00801                                            0803
@RF00801 SLR   @03,@03                                             0803
         IC    @03,FMT                                             0803
         CR    REG2,@03                                            0803
         BNE   @RF00803                                            0803
*      L=R+RU(R+3)+3;           /* INCLUDE FORMAT STRING    @ZA19882 */
         L     @03,R(,TOMWREG)                                     0804
         SLR   @00,@00                                             0804
         IC    @00,RU+2(@03,TOMWREG)                               0804
         ALR   @00,@03                                             0804
         AL    @00,@CF00291                                        0804
         ST    @00,L(,TOMWREG)                                     0804
*    ELSE                       /* NOT FORMAT CHARACTER     @ZA19882 */
*      L=R+2;                   /* INCLUDE CONTROL CHARACTER@ZA19882 */
         B     @RC00803                                            0805
@RF00803 LA    @03,2                                               0805
         AL    @03,R(,TOMWREG)                                     0805
         ST    @03,L(,TOMWREG)                                     0805
*END;                           /* END OF TRANSLATION LOOP  @ZA19882 */
@RC00803 DS    0H                                                  0806
@RC00801 DS    0H                                                  0806
@DE00780 L     @03,L(,TOMWREG)                                     0806
         C     @03,LIMIT(,TOMWREG)                                 0806
         BNH   @DL00780                                            0806
*RFY (REG1,REG2) UNRSTD;        /* FREE REGISTERS 1 & 2     @ZA19882 */
*                                                                  0807
*END TRANSL8;                   /* END OF TRANSL8                    */
@EL00013 DS    0H                                                  0808
@EF00013 DS    0H                                                  0808
@ER00013 L     @14,12(,@13)                                        0808
         BR    @14                                                 0808
         EJECT
*INSERTNL:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0809
*                                                                  0809
INSERTNL ST    @14,12(,@13)                                        0809
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - INSERTNL                                  */
*           /*                                                       */
*           /* FUNCTION - TO INSERT NEW-LINE CHARACTERS INTO THE     */
*           /*            THE EDITED DATA AND TO PLACE THE RESULT    */
*           /*            INTO THE RU.                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0810
*           I = 1;                             /* INITIALIZE INDEX   */
*                                                                  0810
         MVC   I(4,TOMWREG),@CF00064                               0810
*           DO WHILE (BYTECNT < 257 & I <= LIMIT);                 0811
*                                                                  0811
         B     @DE00811                                            0811
@DL00811 DS    0H                                                  0812
*             IF WKSP(I) = FMT THEN            /* FMT CHARACTER?     */
         L     @15,I(,TOMWREG)                                     0812
         ALR   @15,TOMWREG                                         0812
         CLC   WKSP-1(1,@15),FMT                                   0812
         BNE   @RF00812                                            0812
*               DO;                            /* PROCESS FMT STRING */
*                 CNT = WKSP(I+2);             /* PARAMETER COUNT    */
*                                                                  0814
         L     @15,I(,TOMWREG)                                     0814
         SLR   @14,@14                                             0814
         IC    @14,WKSP+1(@15,TOMWREG)                             0814
         ST    @14,CNT(,TOMWREG)                                   0814
*                 /***************************************************/
*                 /* IF THE FMT-STRING FITS INTO THE RU,             */
*                 /* MOVE THE FMT-STRING INTO THE RU.                */
*                 /* OTHERWISE, DO NOT PROCESS THE FMT-STRING AT     */
*                 /* THIS TIME.                                      */
*                 /***************************************************/
*                 IF BYTECNT+CNT+1 < 257 THEN  /* FMT STRING FITS?   */
         LA    @05,1                                               0815
         L     @04,BYTECNT(,TOMWREG)                               0815
         LR    @03,@04                                             0815
         ALR   @03,@14                                             0815
         LR    @02,@03                                             0815
         ALR   @02,@05                                             0815
         C     @02,@CF02797                                        0815
         BNL   @RF00815                                            0815
*                   DO;                        /* PLACE STRING IN RU */
*                     RU(BYTECNT:BYTECNT+CNT+1) = WKSP(I:I+CNT+1); 0817
         ALR   @04,TOMWREG                                         0817
         ALR   @05,@14                                             0817
         ALR   @15,TOMWREG                                         0817
         EX    @05,@SM03017                                        0817
*                     I = I + CNT + 2;         /* UPDATE INDEX       */
         LA    @02,2                                               0818
         L     @15,I(,TOMWREG)                                     0818
         ALR   @15,@14                                             0818
         ALR   @15,@02                                             0818
         ST    @15,I(,TOMWREG)                                     0818
*                     BYTECNT=BYTECNT+CNT+2;   /* UPDATE RU POSITION */
         ALR   @03,@02                                             0819
         ST    @03,BYTECNT(,TOMWREG)                               0819
*                     SIZE = SIZE - (CNT + 2); /* DECREMENT COUNTER  */
         ALR   @14,@02                                             0820
         LCR   @14,@14                                             0820
         AL    @14,SIZE(,TOMWREG)                                  0820
         ST    @14,SIZE(,TOMWREG)                                  0820
*                   END;                       /* FMT STRING MOVED   */
*                 ELSE                         /* FMT STRING TOO BIG */
*                   LIMIT = I - 1;             /* EXCLUDE FMT STRING */
*                                                                  0822
         B     @RC00815                                            0822
@RF00815 L     @15,I(,TOMWREG)                                     0822
         BCTR  @15,0                                               0822
         ST    @15,LIMIT(,TOMWREG)                                 0822
*               END;                           /* END OF FMT STRING  */
*             ELSE                             /* NOT A FMT CHARACTER*/
*               DO;                            /* PROCESS CHARACTER  */
         B     @RC00812                                            0824
@RF00812 DS    0H                                                  0825
*                 RU(BYTECNT) = WKSP(I);       /* PLACE CHAR. IN RU  */
         L     @15,BYTECNT(,TOMWREG)                               0825
         ALR   @15,TOMWREG                                         0825
         L     @14,I(,TOMWREG)                                     0825
         ALR   @14,TOMWREG                                         0825
         MVC   RU-1(1,@15),WKSP-1(@14)                             0825
*                 I = I + 1;                   /* NEXT INDEX POSITION*/
         L     @15,I(,TOMWREG)                                     0826
         AL    @15,@CF00064                                        0826
         ST    @15,I(,TOMWREG)                                     0826
*                 IF RU(BYTECNT) < '40'X THEN  /* CONTROL CHARACTER? */
         L     @15,BYTECNT(,TOMWREG)                               0827
         ALR   @15,TOMWREG                                         0827
         CLI   RU-1(@15),X'40'                                     0827
         BNL   @RF00827                                            0827
*                   /*************************************************/
*                   /* WHEN THE BACKSPACE CHARACTER IS ENCOUNTERED,  */
*                   /* DECREMENT THE PRINTABLE-CHARACTER COUNT BY    */
*                   /* ONE UNLESS THE COUNT IS ALREADY ZERO.         */
*                   /*************************************************/
*                   IF RU(BYTECNT)=BKSPACE THEN /* BACKSPACE?        */
         L     @15,BYTECNT(,TOMWREG)                               0828
         ALR   @15,TOMWREG                                         0828
         CLC   RU-1(1,@15),BKSPACE                                 0828
         BNE   @RF00828                                            0828
*                     IF CHARCNT > 0 THEN      /* COUNT > 0?         */
         L     @15,CHARCNT(,TOMWREG)                               0829
         LTR   @15,@15                                             0829
         BNP   @RF00829                                            0829
*                       CHARCNT = CHARCNT - 1; /* DECREMENT COUNT    */
         BCTR  @15,0                                               0830
         ST    @15,CHARCNT(,TOMWREG)                               0830
*                     ELSE;                    /* LEAVE COUNT ALONE  */
@RF00829 DS    0H                                                  0832
*                   ELSE                       /* NOT BACKSPACE CHAR.*/
*                     IF RU(BYTECNT) = HTAB ×  /* HORIZONTAL TAB?    */
*                        RU(BYTECNT) = FF ×    /* FORM FEED?         */
*                        RU(BYTECNT) = NL ×    /* NEW LINE?          */
*                        RU(BYTECNT) = CR ×    /* CARRIAGE RETURN?   */
*                        RU(BYTECNT) = IRS THEN /* INTERCHANGE RECORD
*                                                 SEPARATOR?         */
         B     @RC00828                                            0832
@RF00828 L     @15,BYTECNT(,TOMWREG)                               0832
         ALR   @15,TOMWREG                                         0832
         CLC   RU-1(1,@15),HTAB                                    0832
         BE    @RT00832                                            0832
         L     @15,BYTECNT(,TOMWREG)                               0832
         ALR   @15,TOMWREG                                         0832
         CLC   RU-1(1,@15),FF                                      0832
         BE    @RT00832                                            0832
         L     @15,BYTECNT(,TOMWREG)                               0832
         ALR   @15,TOMWREG                                         0832
         CLC   RU-1(1,@15),NL                                      0832
         BE    @RT00832                                            0832
         L     @15,BYTECNT(,TOMWREG)                               0832
         ALR   @15,TOMWREG                                         0832
         CLC   RU-1(1,@15),CR                                      0832
         BE    @RT00832                                            0832
         L     @15,BYTECNT(,TOMWREG)                               0832
         ALR   @15,TOMWREG                                         0832
         CLC   RU-1(1,@15),IRS                                     0832
         BNE   @RF00832                                            0832
@RT00832 DS    0H                                                  0833
*                       CHARCNT = 0;           /* RESET COUNT        */
         SLR   @15,@15                                             0833
         ST    @15,CHARCNT(,TOMWREG)                               0833
*                     ELSE;                                        0834
@RF00832 DS    0H                                                  0835
*                 ELSE                         /* NOT CONTROL CHAR.  */
*                   CHARCNT = CHARCNT + 1;     /* INCREMENT COUNT    */
         B     @RC00827                                            0835
@RF00827 LA    @15,1                                               0835
         AL    @15,CHARCNT(,TOMWREG)                               0835
         ST    @15,CHARCNT(,TOMWREG)                               0835
*                 BYTECNT = BYTECNT + 1;       /* NEXT BYTE POSITION */
@RC00827 LA    @15,1                                               0836
         AL    @15,BYTECNT(,TOMWREG)                               0836
         ST    @15,BYTECNT(,TOMWREG)                               0836
*                 SIZE = SIZE - 1;             /* DECREMENT COUNTER  */
         L     @15,SIZE(,TOMWREG)                                  0837
         BCTR  @15,0                                               0837
         ST    @15,SIZE(,TOMWREG)                                  0837
*               END;                                               0838
*             IF SIZE = 0 THEN                 /* END OF MESSAGE?    */
@RC00812 L     @15,SIZE(,TOMWREG)                                  0839
         LTR   @15,@15                                             0839
         BNZ   @RF00839                                            0839
*               /*****************************************************/
*               /* THE FOLLOWING HANDLES END OF MESSAGE.             */
*               /*****************************************************/
*               DO;                                                0840
*                 MOR = '0'B;                  /* END OF MESSAGE     */
         NI    MOR(TOMWREG),B'01111111'                            0841
*                 /***************************************************/
*                 /* A NEW-LINE CHARACTER IS APPENDED TO THE END     */
*                 /* OF EACH TPUT-EDIT MESSAGE OR TO THE END OF A    */
*                 /* MESSAGE WHEN PRINTABLE-CHARACTER COUNT EQUALS   */
*                 /* LINE SIZE.                                      */
*                 /***************************************************/
*                 IF OPEDIT = '00'B ×          /* EDIT TPUT?         */
*                    CHARCNT=TSBLNSZ ×         /* END OF LINE?       */
*                    OPBRK = '1'B ×            /* BREAK TPUT?        */
*                    OPASID='1'B THEN          /* CROSS MEMORY TPUT? */
         TM    OPEDIT(TOMWREG),B'00110000'                         0842
         BZ    @RT00842                                            0842
         L     @15,CHARCNT(,TOMWREG)                               0842
         SLR   @14,@14                                             0842
         IC    @14,TSBLNSZ(,TSBREG)                                0842
         CR    @15,@14                                             0842
         BE    @RT00842                                            0842
         TM    OPBRK(TOMWREG),B'01001000'                          0842
         BZ    @RF00842                                            0842
@RT00842 DS    0H                                                  0843
*                   DO;                        /* DO NL PROCESSING   */
*                     IF BYTECNT = 257 THEN    /* RU FULL?           */
         CLC   BYTECNT(4,TOMWREG),@CF02797                         0844
         BNE   @RF00844                                            0844
*                       SWNL = '1'B;           /* SET NEW-LINE SWITCH*/
         OI    SWNL(TOMWREG),B'01000000'                           0845
*                     ELSE                     /* RU NOT FULL        */
*                       DO;                    /* PLACE NL IN RU     */
         B     @RC00844                                            0846
@RF00844 DS    0H                                                  0847
*                         RU(BYTECNT) = NL;    /* NEXT LINE          */
         L     @15,BYTECNT(,TOMWREG)                               0847
         ALR   @15,TOMWREG                                         0847
         MVC   RU-1(1,@15),NL                                      0847
*                         BYTECNT = BYTECNT + 1;                   0848
         L     @15,BYTECNT(,TOMWREG)                               0848
         AL    @15,@CF00064                                        0848
         ST    @15,BYTECNT(,TOMWREG)                               0848
*                       END;                   /* NL PLACED IN RU    */
*                     CHARCNT = 0;             /* RESET CHAR. COUNT  */
@RC00844 SLR   @15,@15                                             0850
         ST    @15,CHARCNT(,TOMWREG)                               0850
*                   END;                       /* END NL PROCESSING  */
*                 ELSE;                        /* DO NOTHING         */
@RF00842 DS    0H                                                  0853
*               END;                                               0853
*             ELSE                             /* MIDDLE OF MESSAGE  */
*               /*****************************************************/
*               /* INSERT A NEW-LINE CHARACTER WHEN LINESIZE IS      */
*               /* REACHED.                                          */
*               /*****************************************************/
*               IF BYTECNT = 257 THEN          /* RU FULL?           */
         B     @RC00839                                            0854
@RF00839 CLC   BYTECNT(4,TOMWREG),@CF02797                         0854
         BNE   @RF00854                                            0854
*                 DO;                                              0855
*                   MOR = '1'B;                /* MIDDLE OF MESSAGE  */
         OI    MOR(TOMWREG),B'10000000'                            0856
*                   IF CHARCNT = TSBLNSZ THEN  /* COUNT = LINE SIZE? */
         L     @15,CHARCNT(,TOMWREG)                               0857
         SLR   @14,@14                                             0857
         IC    @14,TSBLNSZ(,TSBREG)                                0857
         CR    @15,@14                                             0857
         BNE   @RF00857                                            0857
*                     DO;                      /* DO NL PROCESSING   */
*                       SWNL = '1'B;           /* SET NEW-LINE SWITCH*/
         OI    SWNL(TOMWREG),B'01000000'                           0859
*                       CHARCNT = 0;           /* RESET CHAR. COUNT  */
         SLR   @15,@15                                             0860
         ST    @15,CHARCNT(,TOMWREG)                               0860
*                     END;                     /* END NL PROCESSING  */
*                   ELSE;                      /* COUNT ^= LINE SIZE */
@RF00857 DS    0H                                                  0863
*                 END;                                             0863
*               ELSE                           /* RU NOT FULL        */
*                 IF CHARCNT = TSBLNSZ THEN    /* COUNT = LINE SIZE? */
         B     @RC00854                                            0864
@RF00854 L     @15,CHARCNT(,TOMWREG)                               0864
         SLR   @14,@14                                             0864
         IC    @14,TSBLNSZ(,TSBREG)                                0864
         CR    @15,@14                                             0864
         BNE   @RF00864                                            0864
*                   DO;                        /* DO NL PROCESSING   */
*                     CHARCNT = 0;             /* RESET CHAR. COUNT  */
         SLR   @15,@15                                             0866
         ST    @15,CHARCNT(,TOMWREG)                               0866
*                     RU(BYTECNT) = NL;        /* PLACE NL IN RU     */
         L     @15,BYTECNT(,TOMWREG)                               0867
         ALR   @15,TOMWREG                                         0867
         MVC   RU-1(1,@15),NL                                      0867
*                     BYTECNT = BYTECNT + 1;   /* NEXT BYTE POSITION */
         L     @15,BYTECNT(,TOMWREG)                               0868
         AL    @15,@CF00064                                        0868
         ST    @15,BYTECNT(,TOMWREG)                               0868
*                     IF BYTECNT = 257 THEN    /* RU FULL?           */
         C     @15,@CF02797                                        0869
         BNE   @RF00869                                            0869
*                       MOR = '1'B;            /* MIDDLE OF MESSAGE  */
         OI    MOR(TOMWREG),B'10000000'                            0870
*                     ELSE;                    /* RU NOT FULL        */
@RF00869 DS    0H                                                  0872
*                   END;                       /* END NL PROCESSING  */
*                 ELSE;                        /* COUNT ^= LINE SIZE */
@RF00864 DS    0H                                                  0874
*           END;                                                   0874
*                                                                  0874
@RC00854 DS    0H                                                  0874
@RC00839 DS    0H                                                  0874
@DE00811 L     @15,BYTECNT(,TOMWREG)                               0874
         C     @15,@CF02797                                        0874
         BNL   @DC00811                                            0874
         L     @15,I(,TOMWREG)                                     0874
         C     @15,LIMIT(,TOMWREG)                                 0874
         BNH   @DL00811                                            0874
@DC00811 DS    0H                                                  0875
*           END INSERTNL;                      /* END OF INSERTNL    */
@EL00014 DS    0H                                                  0875
@EF00014 DS    0H                                                  0875
@ER00014 L     @14,12(,@13)                                        0875
         BR    @14                                                 0875
         EJECT
*SENDRU:    PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0876
*                                                                  0876
SENDRU   ST    @14,@SA00015                                        0876
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - SENDRU                                    */
*           /*                                                       */
*           /* FUNCTION - TO SEND DATA TO THE TERMINAL.              */
*           /*            IF THE SEND WAS NOT SUCCESSFUL, THE        */
*           /*            CHECK-RESPONSE ROUTINE WILL BE CALLED.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0877
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/
*CKMC0004:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856
**/            FRWACKPT(2)=ADDR(CKMC0004); /* SAVE ADDRESS    @ZM20856
*/           END;       /* CHECK POINT        @ZM20856*/           0878
*                                                                  0878
CKMC0004 L     @15,TVWAFRWO(,TVWAREG)                              0878
         STM   REG0,REG15,FRWACKRG(@15)                            0878
         LA    @14,CKMC0004                                        0879
         ST    @14,FRWACKPT+4(,@15)                                0879
*           /*********************************************************/
*           /* IF NOT IN BRACKET STATE AND BEGINNING OF CHAIN OR ONLY*/
*           /* CHAIN, SET RPL BRACKET FIELD TO BEGIN-BRACKET.        */
*           /*********************************************************/
*           IF TVWAINB='0'B &          /* NOT BRACKET STATE  @ZM20858*/
*              (RPLCHN = BOC ×         /* BEGINNING OF CHAIN?        */
*               RPLCHN=OC) THEN        /* ONLY CHAIN?                */
         TM    TVWAINB(TVWAREG),B'00000100'                        0881
         BNZ   @RF00881                                            0881
         LA    @15,16                                              0881
         ALR   @15,RPLREG                                          0881
         CLI   RPLCHN(@15),X'80'                                   0881
         BE    @RT00881                                            0881
         CLI   RPLCHN(@15),X'10'                                   0881
         BNE   @RF00881                                            0881
@RT00881 DS    0H                                                  0882
*             DO;                      /* DO BEGIN-BRACKET PROCESSING*/
*               TVWAINB = '1'B;        /* RESET BRACKET-STATE@ZM20858*/
         OI    TVWAINB(TVWAREG),B'00000100'                        0883
*               TVWATOBB='1'B;         /* BEG BRACKET ON SEND@ZM20858*/
         OI    TVWATOBB(TVWAREG),B'00000100'                       0884
*               RPLRH3 = BB;           /* SEND BEGIN BRACKET         */
         MVI   RPLRH3+16(RPLREG),X'80'                             0885
*             END;                     /* END BB PROCESSING          */
*           ELSE                       /* NOT BB OR MOC OR EOC       */
*             DO;                      /*                    @ZM20858*/
         B     @RC00881                                            0887
@RF00881 DS    0H                                                  0888
*               TVWATOBB='0'B;         /* BEGIN BRACKET NOT ON SEND
*                                                            @ZM20858*/
         NI    TVWATOBB(TVWAREG),B'11111011'                       0888
*               RPLRH3 = '00'X;        /* DO NOT SEND BEGIN BRACKET  */
         MVI   RPLRH3+16(RPLREG),X'00'                             0889
*             END;                     /*                    @ZM20858*/
*                                                                  0890
*           IF TSBXASCI = '1'B THEN    /* IS IT ASCII CODE?          */
@RC00881 L     @01,TSBEXTNT(,TSBREG)                               0891
         TM    TSBXASCI(@01),B'10000000'                           0891
         BNO   @RF00891                                            0891
*             RPLCSI = '1'B;           /* ASCII                      */
         OI    RPLCSI+16(RPLREG),B'00001000'                       0892
*           ELSE                       /* NO                         */
*             RPLCSI = '0'B;           /* EBCDIC                     */
*                                                                  0893
         B     @RC00891                                            0893
@RF00891 NI    RPLCSI+16(RPLREG),B'11110111'                       0893
*           RPLRLEN = BYTECNT - 1;     /* LENGTH OF MESSAGE          */
@RC00891 L     @15,BYTECNT(,TOMWREG)                               0894
         BCTR  @15,0                                               0894
         ST    @15,RPLRLEN(,RPLREG)                                0894
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    0895
*           TVWAIOP='1'B;              /* TURN ON I/O PENDING BIT  0896
*                                                            @ZA24418*/
         OI    TVWAIOP(TVWAREG),B'00100000'                        0896
*           WRK2 = ADDR(IFGRPL);       /* RPL ADDRESS                */
         LR    WRK2,RPLREG                                         0897
*           SRPLCHN = RPLCHN;          /* SAVE CHAIN ELEMENT         */
*                                                                  0898
         MVC   SRPLCHN(1,TOMWREG),RPLCHN+16(RPLREG)                0898
*           /*********************************************************/
*           /* THE FOLLOWING GENERATED CODE CONTAINS CODE TO SAVE    */
*           /* REGS 14-1 IN THE SAVE AREA. REGS 15 AND 0 ARE THE REGS*/
*           /* OF SPECIFIC INTEREST FOR MAINTAINING VTAM RETURN CODES*/
*           /* FROM THE SEND. THE STM,LM SEQUENCE IS USED FOR SPEED  */
*           /*********************************************************/
*           GENERATE REFS(BYTECNT,FRRPTR,FRRS,FRRSCURR,FRRSLAST,FLC,
*                         PSALSFCC,PSA,FRRSELEN,PSACSTK,FRRSFRRA,  0899
*                         FRRSENTR,FRRSPARM,PSALITA)               0899
*                    SETS(WRK2,WRK3,REGPARM,REG1,REG13,REG14,REG15,
*                         REG0);                                   0899
*                                                                  0899
       SETLOCK RELEASE,                                               CC
               TYPE=LOCAL,                                            CC
               REGS=USE,                                              CC
               RELATED=(RPL)
       SEND    RPL=(WRK2),                                            CC
               CONTROL=DATA
         STM   REG14,REG1,12(REG13)      SAVE REGS 15,0       @ZM20858
       SETFRR  A,                                                     CC
               FRRAD=(FRRPTR),                                        CC
               PARMAD=(REGPARM),                                      CC
               WRKREGS=(WRK2,WRK3)
       SETLOCK OBTAIN,                                                CC
               TYPE=LOCAL,                                            CC
               MODE=UNCOND,                                           CC
               REGS=USE,                                              CC
               RELATED=(RPL)
         LM    REG14,REG1,12(REG13)      RESTORE REGS 15,0  @ZM20858
*           FRRPARM=REGPARM;           /* SAVE ADDRESS OF PARAMETER
*                                         AREA PROVIDED BY SETFRR  0900
*                                         MACRO              @ZM20856*/
*                                                                  0900
         ST    REGPARM,FRRPARM                                     0900
*          RFY (WRK2,WRK3,REGPARM,REG1,REG14,REG15) UNRSTD;        0901
*                                                                  0901
*           CALL INITFRR;              /* CALL FRR INIT      @ZM20856*/
         BAL   @14,INITFRR                                         0902
*           RFY GENRC RSTD;            /* RESTRICT RETURN-CODE REG.  */
*           RPLCHN = SRPLCHN;          /* RESTORE CHAIN ELEMENT      */
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                0904
*           TVWASCD = '0'B;            /* RESET CHANGE-DIRECTION BIT */
         NI    TVWASCD(TVWAREG),B'11011111'                        0905
*           TVWAISYS = '0'B;           /* RESET I-SYS SWITCH  0Z12002*/
*           TVWAIOP='0'B;              /* RESET I/O PENDING BIT    0907
*                                                            @ZA24418*/
*                                                                  0907
         NI    TVWAISYS(TVWAREG),B'01011111'                       0907
*           /*********************************************************/
*           /* IF THE VTAM GENERAL RETURN CODE IS ZERO,              */
*           /* THEN DO NOT RESEND.                                   */
*           /* OTHERWISE, CALL CHECK-RESPONSE ROUTINE.               */
*           /*********************************************************/
*           IF GENRC = 0 THEN          /* REQUEST ACCEPTED?          */
         LTR   GENRC,GENRC                                         0908
         BNZ   @RF00908                                            0908
*             NEC = '0'B;              /* NOT NECESSARY TO RESEND    */
         NI    NEC(TOMWREG),B'11111011'                            0909
*           ELSE                       /* REQUEST REJECTED           */
*             CALL CHKRESP;            /* CHECK RESPONSE             */
*                                                                  0910
         B     @RC00908                                            0910
@RF00908 BAL   @14,CHKRESP                                         0910
*           RFY (GENRC,REG0) UNRSTD;   /* FREE UP REGS       @ZM20858*/
*                                                                  0911
*           END SENDRU;                /* END OF SENDRU              */
@EL00015 DS    0H                                                  0912
@EF00015 DS    0H                                                  0912
@ER00015 L     @14,@SA00015                                        0912
         BR    @14                                                 0912
         EJECT
*RCVRSET:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0913
*                                                                  0913
RCVRSET  ST    @14,@SA00016                                        0913
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - RCVRSET                                   */
*           /*                                                       */
*           /* FUNCTION - TO RELEASE THE LOCAL LOCK, TO ISSUE A      */
*           /*            RESETSR, TO SET THE FRR, AND TO OBTAIN THE */
*           /*            LOCAL LOCK                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0914
*           RFY (WRK2,WRK3,REGPARM) RSTD;                          0914
*           WRK2 = ADDR(IFGRPL);        /* RPL ADDRESS               */
         LR    WRK2,RPLREG                                         0915
*           SRPLCHN = RPLCHN;           /* SAVE CHAIN ELEMENT        */
         LA    @04,16                                              0916
         ALR   @04,RPLREG                                          0916
         MVC   SRPLCHN(1,TOMWREG),RPLCHN(@04)                      0916
*           RPLRRESP = '1'B;            /* RTYPE=RESP                */
*                                                                  0917
         OI    RPLRRESP(@04),B'00001000'                           0917
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,PSA,
*                         FRRSELEN,PSACSTK,FRRSFRRA,FRRSENTR,FRRSPARM,
*                         PSALITA,FLC)                             0918
*                    SETS(WRK2,WRK3,REGPARM,REG0,REG1,REG13,REG14, 0918
*                         REG15);                                  0918
*                                                                  0918
       SETLOCK RELEASE,                                               CC
               TYPE=LOCAL,                                            CC
               REGS=USE,                                              CC
               RELATED=('RELEASE LOCAL LOCK')
       RESETSR RPL=(WRK2)
       SETFRR  A,                                                     CC
               FRRAD=(FRRPTR),                                        CC
               PARMAD=(REGPARM),                                      CC
               WRKREGS=(WRK2,WRK3)
       SETLOCK OBTAIN,                                                CC
               TYPE=LOCAL,                                            CC
               MODE=UNCOND,                                           CC
               REGS=USE,                                              CC
               RELATED=('OBTAIN LOCAL LOCK')
*           FRRPARM=REGPARM;               /* SAVE ADDRESS OF      0919
*                                              PARAMETER AREA      0919
*                                              PROVIDED BY         0919
*                                              SETFRR MACRO  @ZM20856*/
         ST    REGPARM,FRRPARM                                     0919
*           RFY (WRK2,WRK3,REGPARM) UNRSTD;                        0920
*                                                                  0920
*           CALL INITFRR;                  /* CALL FRR INIT  @ZM20856*/
         BAL   @14,INITFRR                                         0921
*           RPLCHN = SRPLCHN;              /* RESTORE CHAIN ELEMENT  */
*                                                                  0922
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                0922
*           END RCVRSET;                   /* END OF RCVRSET         */
@EL00016 DS    0H                                                  0923
@EF00016 DS    0H                                                  0923
@ER00016 L     @14,@SA00016                                        0923
         BR    @14                                                 0923
         EJECT
*CHKRESP:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0924
*                                                                  0924
CHKRESP  ST    @14,@SA00017                                        0924
*    /****************************************************************/
*    /*                                                              */
*    /*        PROCEDURE - CHKRESP                                   */
*    /*                                                              */
*    /*        FUNCTION - TO DETERMINE THE COURSE OF ACTION WHEN A   */
*    /*                   REQUEST IS REJECTED BY VTAM.               */
*    /*                   A.  CASE WHEN THE VTAM GENERAL RETURN CODE */
*    /*                       IS 4:                                  */
*    /*                       1. IF THE REQUEST WAS CANCELED BY A    */
*    /*                          PRIOR EXCEPTION MESSAGE (RTNCD=12   */
*    /*                          AND FDBK2=13), CALL ISSUERCV TO     */
*    /*                          A RECEIVE TO OBTAIN THE RESPONSE.   */
*    /*                       2. IF THE INCOMING RESPONSE INDICATES  */
*    /*                          AN EXCEPTION CONDITION (RTNCD=4 AND */
*    /*                          FDBK2=4), CALL CHKSENSE TO CHECK    */
*    /*                          SENSE INFORMATION.                  */
*    /*                       3. IF RPL FIELD IS INVALID, CALL       */
*    /*                          REBLDRPL TO REBUILD THE RPL.        */
*    /*                       4. WHEN THE REQUEST WAS CANCELED       */
*    /*                          BECAUSE OF A VTAM TEMPORARY STORAGE */
*    /*                          CONDITION OR A CLEAR INDICATOR      */
*    /*                          (RTNCD=8 AND FDBK2=0 OR RTNCD=12    */
*    /*                          AND FDBKW=12), CALL REISSUE TO      */
*    /*                          RETRY THE REQUEST.                  */
*    /*                       5. WHEN COMMUNICATION WITH THE         */
*    /*                          TERMINAL IS NOT POSSIBLE, CALL      */
*    /*                          FINPROC TO FREE THE TOM WORK AREA   */
*    /*                          AND SRB AND TO CLEAR THE POINTERS   */
*    /*                          TO THE TOM WORK AREA AND SRB.       */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0925
*           RFY (GENRC,REG0) RSTD;         /* RESTRICT REGS  @ZM21327*/
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/
*CKMC0005:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856
**/            FRWACKPT(2)=ADDR(CKMC0005); /* SAVE ADDRESS    @ZM20856
*/           END;           /* CHECK POINT    @ZM20856*/           0927
CKMC0005 L     @14,TVWAFRWO(,TVWAREG)                              0927
         STM   REG0,REG15,FRWACKRG(@14)                            0927
         LA    @01,CKMC0005                                        0928
         ST    @01,FRWACKPT+4(,@14)                                0928
*           CHK = '1'B;                    /* CHECK RESPONSE         */
*                                                                  0930
         OI    CHK(TOMWREG),B'00000001'                            0930
*           DO WHILE (CHK = '1'B);                                 0931
*                                                                  0931
         B     @DE00931                                            0931
@DL00931 DS    0H                                                  0932
*             CHK = '0'B;                  /* RESET CHECK SWITCH     */
*                                                                  0932
         NI    CHK(TOMWREG),B'11111110'                            0932
*            /********************************************************/
*            /* CHECK VTAM IMMEDIATE RETURN CODES            @ZM20858*/
*            /********************************************************/
*            IF REG15=32 ×              /* INVALID RPL OR    @ZM20858*/
*              (REG15=4 & REG0=24) THEN /* VTAM NOT ACTIVE   @ZM20858*/
         C     REG15,@CF00742                                      0933
         BE    @RT00933                                            0933
         C     REG15,@CF00056                                      0933
         BNE   @RF00933                                            0933
         C     REG0,@CF00073                                       0933
         BNE   @RF00933                                            0933
@RT00933 DS    0H                                                  0934
*              CALL REBLDRPL;       /* REBUILD RPL AND RETRY @ZM20858*/
         BAL   @14,REBLDRPL                                        0934
*            ELSE                   /* IMMED RETURN CODE OK  @ZM20858*/
*              DO;                                                 0935
*                                                                  0935
         B     @RC00933                                            0935
@RF00933 DS    0H                                                  0936
*           /*********************************************************/
*           /* WHEN FURTHER COMMUNICATION WITH THE TERMINAL IS NOT   */
*           /* POSSIBLE, DO A CLEAN EXIT.                            */
*           /*********************************************************/
*           IF (RPLRTNCD=12 & (RPLFDB2=2 ×    /*REQUEST RESET@ZM20858*/
*                              RPLFDB2=7 ×    /*RECOVERY IN PROGRESS
*                                                            @ZM20858*/
*                              RPLFDB2=8 ×    /*RECORD TERM RESTARTED
*                                               AFTER FAIL   @ZM20858*/
*                              RPLFDB2=9 ×    /*OPNDST CANCELED BY 0936
*                                               CLSDST       @ZM20858*/
*                              RPLFDB2=11)) × /*CLSDST OCCURD@ZM20858*/
*              (RPLRTNCD=20 &                                      0936
*              (RPLFDB2=18 × RPLFDB2=65)) × /* 65-NO SDT ISSUED    0936
*                                                            @ZA17888*/
*              (RPLRTNCD=16 & (RPLFDB2=3 ×  /*VTAM HALTING   @ZM20858*/
*                              RPLFDB2=5 ×  /*PERM PATH FAIL @ZM20858*/
*                              RPLFDB2=6 ×  /*AUTO NET SHUTD @ZM20858*/
*                              RPLFDB2=7 ×  /*VARY DEACT IMM @ZM20858*/
*                              RPLFDB2=9 ×  /*TERMINATE SELF @ZM20858*/
*                              RPLFDB2=15)) /*VTAM BUFR OVFLW@ZM20858*/
*              THEN                        /* COMMUNICATION SEVERED  */
         CLI   RPLRTNCD(RPLREG),12                                 0936
         BNE   @GL00054                                            0936
         CLI   RPLFDB2(RPLREG),2                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),7                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),8                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),9                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),11                                  0936
         BE    @RT00936                                            0936
@GL00054 CLI   RPLRTNCD(RPLREG),20                                 0936
         BNE   @GL00053                                            0936
         CLI   RPLFDB2(RPLREG),18                                  0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),65                                  0936
         BE    @RT00936                                            0936
@GL00053 CLI   RPLRTNCD(RPLREG),16                                 0936
         BNE   @RF00936                                            0936
         CLI   RPLFDB2(RPLREG),3                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),5                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),6                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),7                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),9                                   0936
         BE    @RT00936                                            0936
         CLI   RPLFDB2(RPLREG),15                                  0936
         BNE   @RF00936                                            0936
@RT00936 DS    0H                                                  0937
*                 CALL FINPROC;            /* DO A CLEAN EXIT        */
         BAL   @14,FINPROC                                         0937
*           ELSE                                                   0938
*              IF GENRC = 4 THEN           /* GENERAL RETURN CODE 4? */
         B     @RC00936                                            0938
@RF00936 C     GENRC,@CF00056                                      0938
         BNE   @RF00938                                            0938
*               /*****************************************************/
*               /* IF REQUEST CANCELED BY A PRIOR EXCEPTION MESSAGE, */
*               /* ISSUE A RECEIVE.                                  */
*               /*****************************************************/
*               IF RPLRTNCD=12 & RPLFDB2=13 THEN                   0939
         CLI   RPLRTNCD(RPLREG),12                                 0939
         BNE   @RF00939                                            0939
         CLI   RPLFDB2(RPLREG),13                                  0939
         BNE   @RF00939                                            0939
*                                          /* PRIOR EXCEPTION MESSAGE*/
*                 CALL ISSUERCV;           /* ISSUE RECEIVE MACRO    */
         BAL   @14,ISSUERCV                                        0940
*               ELSE                                               0941
*                 /***************************************************/
*                 /* IF SENSE INFORMATION PROVIDED,                  */
*                 /* CHECK SENSE INFORMATION.                        */
*                 /***************************************************/
*                 IF RPLRTNCD=4 & RPLFDB2=4 THEN                   0941
         B     @RC00939                                            0941
@RF00939 CLI   RPLRTNCD(RPLREG),4                                  0941
         BNE   @RF00941                                            0941
         CLI   RPLFDB2(RPLREG),4                                   0941
         BNE   @RF00941                                            0941
*                                          /* EXCEPTION OCCURRED     */
*                   CALL CHKSENSE;         /* CHECK SENSE INFORMATION*/
         BAL   @14,CHKSENSE                                        0942
*                 ELSE                                             0943
*                   /*************************************************/
*                   /* IF RPL FIELD INVALID, REBUILD RPL.            */
*                   /*************************************************/
*                   IF RPLRTNCD=20 &                               0943
*                     ((RPLFDB2<=64 & RPLFDB2^=18) × RPLFDB2=93) THEN
         B     @RC00941                                            0943
@RF00941 CLI   RPLRTNCD(RPLREG),20                                 0943
         BNE   @RF00943                                            0943
         CLI   RPLFDB2(RPLREG),64                                  0943
         BH    @GL00071                                            0943
         CLI   RPLFDB2(RPLREG),18                                  0943
         BNE   @RT00943                                            0943
@GL00071 CLI   RPLFDB2(RPLREG),93                                  0943
         BNE   @RF00943                                            0943
@RT00943 DS    0H                                                  0944
*                                          /* RPL FIELD INVALID      */
*                     CALL REBLDRPL;       /* REBUILD RPL            */
         BAL   @14,REBLDRPL                                        0944
*                   ELSE                                           0945
*                     /***********************************************/
*                     /* IF VTAM TEMPORARY STORAGE SHORTAGE OR       */
*                     /* REQUEST CANCELED BY CLEAR INDICATOR,        */
*                     /* REISSUE.                                    */
*                     /***********************************************/
*                     IF (RPLRTNCD=8 & RPLFDB2=0) ×                0945
*                        (RPLRTNCD=12 & RPLFDB2=12) THEN           0945
         B     @RC00943                                            0945
@RF00943 CLI   RPLRTNCD(RPLREG),8                                  0945
         BNE   @GL00073                                            0945
         CLI   RPLFDB2(RPLREG),0                                   0945
         BE    @RT00945                                            0945
@GL00073 CLI   RPLRTNCD(RPLREG),12                                 0945
         BNE   @RF00945                                            0945
         CLI   RPLFDB2(RPLREG),12                                  0945
         BNE   @RF00945                                            0945
@RT00945 DS    0H                                                  0946
*                                          /* VTAM STORAGE SHORTAGE  */
*                       CALL REISSUE;      /* REISSUE SEND MACRO     */
         BAL   @14,REISSUE                                         0946
*                     ELSE                                         0947
*                       /*********************************************/
*                       /* ALL OTHERS, REFRESH AND RETRY     @ZM20858*/
*                       /*********************************************/
*                       CALL REBLDRPL;   /* REFRESH RPL      @ZM20858*/
         B     @RC00945                                            0947
@RF00945 BAL   @14,REBLDRPL                                        0947
*             ELSE                                                 0948
*               /*****************************************************/
*               /* FOR CATASTROPHIC ERRS, ABEND. RETRY OTHERS@ZM20858*/
*               /*****************************************************/
*               IF RPLRTNCD=16 THEN        /* SEVERE ERROR   @ZM20858*/
         B     @RC00938                                            0948
@RF00938 CLI   RPLRTNCD(RPLREG),16                                 0948
         BNE   @RF00948                                            0948
*                 CALL EXITFRR;            /* CALL ABEND RTN @ZM20856*/
         BAL   @14,EXITFRR                                         0949
*               ELSE                       /* NOT SEVERE ERR @ZM20858*/
*                 CALL REBLDRPL;           /* REFRESH, RETRY @ZM20858*/
*                                                                  0950
         B     @RC00948                                            0950
@RF00948 BAL   @14,REBLDRPL                                        0950
*           END;                                                   0951
@RC00948 DS    0H                                                  0951
@RC00938 DS    0H                                                  0951
@RC00936 DS    0H                                                  0952
*           END;                                                   0952
@RC00933 DS    0H                                                  0952
@DE00931 TM    CHK(TOMWREG),B'00000001'                            0952
         BO    @DL00931                                            0952
*           RFY (GENRC,REG0) UNRSTD;                               0953
*                                                                  0953
*           END CHKRESP;                   /* END OF CHKRESP         */
@EL00017 DS    0H                                                  0954
@EF00017 DS    0H                                                  0954
@ER00017 L     @14,@SA00017                                        0954
         BR    @14                                                 0954
         EJECT
*ISSUERCV:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0955
*                                                                  0955
ISSUERCV ST    @14,@SA00018                                        0955
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - ISSUERCV                                  */
*           /*                                                       */
*           /* FUNCTION - TO ISSUE A RECEIVE TO OBTAIN A RESPONSE.   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0956
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    0956
*           SRPLCHN = RPLCHN;               /* SAVE CHAIN ELEMENT    */
         MVC   SRPLCHN(1,TOMWREG),RPLCHN+16(RPLREG)                0957
*           WRK2 = ADDR(IFGRPL);            /* ADDRESS OF RPL        */
*                                                                  0958
         LR    WRK2,RPLREG                                         0958
*           /*********************************************************/
*           /* THE FOLLOWING GENERATED CODE CONTAINS CODE TO SAVE    */
*           /* REGS 14-1 IN THE SAVE AREA. REGS 15 AND 0 ARE THE REGS*/
*           /* OF SPECIFIC INTEREST FOR MAINTAINING VTAM RETURN CODES*/
*           /* FROM THE RECEIVE.THE STM,LM SEQUENCE IS USED FOR SPEED*/
*           /************************************************@ZM20858*/
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,PSA,
*                         FRRSELEN,PSACSTK,FRRSFRRA,FRRSENTR,FRRSPARM,
*                         PSALITA,FLC)                             0959
*                    SETS(WRK2,WRK3,REGPARM,REG1,REG13,REG14,REG15);
       SETLOCK RELEASE,                                               CC
               TYPE=LOCAL,                                            CC
               REGS=USE,                                              CC
               RELATED=('RELEASE LOCAL LOCK')
       RECEIVE RPL=(WRK2),                                            CC
               RTYPE=(NDFSYN,NDFASY,RESP)
         STM   REG14,REG1,12(REG13)       SAVE REGS 15,0      @ZM20858
       SETFRR  A,                                                     CC
               FRRAD=(FRRPTR),                                        CC
               PARMAD=(REGPARM),                                      CC
               WRKREGS=(WRK2,WRK3)
       SETLOCK OBTAIN,                                                CC
               TYPE=LOCAL,                                            CC
               MODE=UNCOND,                                           CC
               REGS=USE,                                              CC
               RELATED=('OBTAIN LOCAL LOCK')
         LM    REG14,REG1,12(REG13)       RESTORE REGS 15,0   @ZM20858
*           /*********************************************************/
*           /* THE RETURN CODES FROM THE RECEIVE NOW IN REGS 15 AND  */
*           /* 0 WILL BE CHECKED IN THE CHKRESP PROCEDURE    @ZM20858*/
*           /*********************************************************/
*                                                                  0960
*           FRRPARM=REGPARM;               /* SAVE ADDRESS OF      0960
*                                             PARAMETER AREA       0960
*                                             PROVIDED BY          0960
*                                             SETFRR MACRO   @ZM20856*/
         ST    REGPARM,FRRPARM                                     0960
*           RFY REG1 UNRSTD;               /* FREE REG 1     @ZM20856*/
*           CALL INITFRR;                  /* CALL FRR INIT  @ZM20856*/
         BAL   @14,INITFRR                                         0962
*           CHK = '1'B;                    /* CHECK RESPONSE AGAIN   */
         OI    CHK(TOMWREG),B'00000001'                            0963
*           RPLCHN =  SRPLCHN;             /* RESTORE CHAIN ELEMENT  */
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                0964
*           RFY (WRK2,WRK3,REGPARM,REG0,REG14,REG15) UNRSTD;       0965
*                                          /* FREE UP REGS   @ZM20858*/
*           END ISSUERCV;                  /* END OF ISSUERCV        */
@EL00018 DS    0H                                                  0966
@EF00018 DS    0H                                                  0966
@ER00018 L     @14,@SA00018                                        0966
         BR    @14                                                 0966
         EJECT
*CHKSENSE:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0967
*                                                                  0967
CHKSENSE ST    @14,@SA00019                                        0967
*    /****************************************************************/
*    /*                                                              */
*    /*        PROCEDURE - CHKSENSE                                  */
*    /*                                                              */
*    /*        FUNCTION - TO CHECK THE SENSE INFORMATION OF THE RPL  */
*    /*                   SSENSEO FIELD.                             */
*    /*                   (1) FOR BUFFER CONTENTION (X'081B'), CALL  */
*    /*                       BFCN.                                  */
*    /*                   (2) FOR CANCEL (X'0811'), CALL CNCL.       */
*    /*                   (3) FOR INTERVENTION REQUIRED (X'0802'),   */
*    /*                       CALL PAPEROUT.                         */
*    /*                   (4) FOR  BRACKET BID REJECT OR             */
*    /*                       FOR  BRACKET STATE ERROR (X'2003'),    */
*    /*                       CALL FIXIT.                    @ZA27108*/
*    /*                   (5) FOR CHAINING ERROR (X'2002'),          */
*    /*                       CALL FIXIT.                    @ZA27108*/
*    /*                   (6) FOR FUNCTION NOT SUPPORTED (X'1003'),  */
*    /*                       SET FCNERR TO 1                @ZA27108*/
*    /*                       (TO BE CHECKED BY THE PROCEDURE        */
*    /*                       EDITASIS), AND CALL FIXIT.             */
*    /*                   (7) FOR PARAMETER ERROR (X'1005'),         */
*    /*                       SET PARMERR TO 1               @ZA27108*/
*    /*                       (TO BE CHECKED BY THE PROCEDURE        */
*    /*                       EDITASIS), AND CALL FIXIT.             */
*    /*                   (8) FOR OTHER CASES, AN ABEND WILL BE      */
*    /*                       ISSUED.                                */
*    /*                                                              */
*    /****************************************************************/
*                                                                  0968
*           /*********************************************************/
*           /* BUFFER CONTENTION                                     */
*           /*********************************************************/
*                                                                  0968
*           IF RPLSSNSI = '081B'X THEN                             0968
         CLC   RPLSSNSI(2,RPLREG),@CB02886                         0968
         BNE   @RF00968                                            0968
*             CALL BFCN;                                           0969
         BAL   @14,BFCN                                            0969
*           ELSE                                                   0970
*                                                                  0970
*             /*******************************************************/
*             /* CANCEL                                              */
*             /*******************************************************/
*                                                                  0970
*             IF RPLSSNSI = '0811'X THEN                           0970
         B     @RC00968                                            0970
@RF00968 CLC   RPLSSNSI(2,RPLREG),@CB02888                         0970
         BNE   @RF00970                                            0970
*               CALL CNCL;                                         0971
         BAL   @14,CNCL                                            0971
*             ELSE                                                 0972
*                                                                  0972
*               /*****************************************************/
*               /* INTERVENTION REQUIRED                             */
*               /*****************************************************/
*                                                                  0972
*               IF RPLSSNSI = '0802'X THEN                         0972
         B     @RC00970                                            0972
@RF00970 CLC   RPLSSNSI(2,RPLREG),@CB02890                         0972
         BNE   @RF00972                                            0972
*                 CALL PAPEROUT;                                   0973
         BAL   @14,PAPEROUT                                        0973
*               ELSE                                               0974
*                                                                  0974
*                 /***************************************************/
*                 /* BRACKET ERROR OR BRACKET STATE ERROR    @ZA27108*/
*                 /***************************************************/
*                                                                  0974
*                 IF RPLSSNSI = '0813'X ×  /* BRACKET ERROR  @ZA27108*/
*                    RPLSSNSI = '080B'X ×  /* BRACKET ERROR  @ZA27108*/
*                    RPLSSNSI = '2003'X /*BRACKET STATE ERROR@ZA27108*/
*                 THEN                                             0974
         B     @RC00972                                            0974
@RF00972 CLC   RPLSSNSI(2,RPLREG),@CB02892                         0974
         BE    @RT00974                                            0974
         CLC   RPLSSNSI(2,RPLREG),@CB02893                         0974
         BE    @RT00974                                            0974
         CLC   RPLSSNSI(2,RPLREG),@CB02894                         0974
         BNE   @RF00974                                            0974
@RT00974 DS    0H                                                  0975
*                   DO;                                            0975
*                     IF TVWATOBB='0'B THEN /* BEG BRKT ^SENT@ZM20858*/
         TM    TVWATOBB(TVWAREG),B'00000100'                       0976
         BNZ   @RF00976                                            0976
*                       TVWAINB='0'B;  /* SEND BEGIN BRACKET @ZM20858*/
         NI    TVWAINB(TVWAREG),B'11111011'                        0977
*                     ELSE;                                        0978
@RF00976 DS    0H                                                  0979
*                     CALL FIXIT;                                  0979
         BAL   @14,FIXIT                                           0979
*                   END;                                           0980
*                 ELSE                                             0981
*                                                                  0981
*                     /***********************************************/
*                     /* CHAINING ERROR                              */
*                     /***********************************************/
*                                                                  0981
*                     IF RPLSSNSI = '2002'X THEN                   0981
         B     @RC00974                                            0981
@RF00974 CLC   RPLSSNSI(2,RPLREG),@CB02896                         0981
         BNE   @RF00981                                            0981
*                         CALL  FIXIT;                             0982
         BAL   @14,FIXIT                                           0982
*                     ELSE                                         0983
*                                                                  0983
*                       /*********************************************/
*                       /* FUNCTION NOT SUPPORTED - SVF              */
*                       /*********************************************/
*                                                                  0983
*                       IF RPLSSNSI = '1003'X THEN                 0983
         B     @RC00981                                            0983
@RF00981 CLC   RPLSSNSI(2,RPLREG),@CB02897                         0983
         BNE   @RF00983                                            0983
*                         DO;                                      0984
*                           FCNERR = '1'B;                         0985
         OI    FCNERR(TOMWREG),B'00100000'                         0985
*                           CALL FIXIT;                            0986
         BAL   @14,FIXIT                                           0986
*                         END;                                     0987
*                       ELSE                                       0988
*                                                                  0988
*                         /*******************************************/
*                         /* PARAMETER ERROR                         */
*                         /*******************************************/
*                                                                  0988
*                         IF RPLSSNSI = '1005'X THEN               0988
         B     @RC00983                                            0988
@RF00983 CLC   RPLSSNSI(2,RPLREG),@CB02898                         0988
         BNE   @RF00988                                            0988
*                           DO;                                    0989
*                             PARMERR = '1'B;                      0990
         OI    PARMERR(TOMWREG),B'00010000'                        0990
*                             CALL  FIXIT;                         0991
         BAL   @14,FIXIT                                           0991
*                           END;                                   0992
*                                                                  0992
*                         ELSE                                     0993
*                             CALL REBLDRPL; /*REFRESH AND RETRY   0993
*                                              OTHERS        @ZM20858*/
*                                                                  0993
         B     @RC00988                                            0993
@RF00988 BAL   @14,REBLDRPL                                        0993
*           END  CHKSENSE;                   /* END OF CHKSENSE      */
@EL00019 DS    0H                                                  0994
@EF00019 DS    0H                                                  0994
@ER00019 L     @14,@SA00019                                        0994
         BR    @14                                                 0994
         EJECT
*REBLDRPL:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0995
*                                                                  0995
REBLDRPL ST    @14,@SA00020                                        0995
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - REBLDRPL                                  */
*           /*                                                       */
*           /* FUNCTION - TO REBUILD THE RPL                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0996
*           RETRY  = RETRY + 1;      /* INCREMENT RETRY COUNT        */
*                                                                  0996
         LA    @15,1                                               0996
         SLR   @14,@14                                             0996
         IC    @14,RETRY(,TOMWREG)                                 0996
         ALR   @15,@14                                             0996
         STC   @15,RETRY(,TOMWREG)                                 0996
*           IF RETRY > 3 THEN        /* ABEND SITUATION?             */
         CLI   RETRY(TOMWREG),3                                    0997
         BNH   @RF00997                                            0997
*             CALL EXITFRR;          /* CALL ABEND ROUTINE   @ZM20856*/
         BAL   @14,EXITFRR                                         0998
*           ELSE                     /* RETRY SITUATION              */
*             DO;                    /* DO NOT ABEND                 */
*                                                                  0999
         B     @RC00997                                            0999
@RF00997 DS    0H                                                  1000
*               IFGRPL = DUMMYRPL;   /* REBUILD RPL                  */
         MVC   IFGRPL(112,RPLREG),DUMMYRPL                         1000
*               RPLAREA = ADDR(RU);  /* RU ADDRESS IN RPL DATA AREA  */
         LA    @15,RU(,TOMWREG)                                    1001
         ST    @15,RPLAREA(,RPLREG)                                1001
*               RPLDACB = TVWAACB;   /* ACB ADDRESS                  */
         L     @15,TVWAACB(,TVWAREG)                               1002
         ST    @15,RPLDACB(,RPLREG)                                1002
*               RPLARG = NIBCID;     /* CID                          */
         L     @01,TVWANIB(,TVWAREG)                               1003
         L     @15,NIBCID(,@01)                                    1003
         ST    @15,RPLARG(,RPLREG)                                 1003
*               RPLNIB = '0'B;       /* CID IN RPLARG FIELD          */
         NI    RPLNIB(RPLREG),B'11111011'                          1004
*               NEC = '0'B;          /* NOT NECESSARY TO RESEND RU   */
         NI    NEC(TOMWREG),B'11111011'                            1005
*               BYPASS = '1'B;       /* BYPASS REST OF BLDEND        */
         OI    BYPASS(TOMWREG),B'00000001'                         1006
*               CHARCNT = 0;         /* RESET PRINTABLE CHAR. COUNT  */
         SLR   @15,@15                                             1007
         ST    @15,CHARCNT(,TOMWREG)                               1007
*               RETRYMSG = '1'B;     /* TURN ON RETRY MESSAGE SWITCH */
         OI    RETRYMSG(TOMWREG),B'00001000'                       1008
*               CALL CHKOCEOC;       /* CANCEL CHAIN IF NECESSARY    */
*                                                                  1009
*                                                                  1009
         BAL   @14,CHKOCEOC                                        1009
*               /*****************************************************/
*               /* RESET MESSAGE POINTER.                            */
*               /*****************************************************/
*               OPREQ = RESET;       /* RESET MESSAGE POINTER        */
         MVI   OPREQ(TOMWREG),X'07'                                1010
*               CALL IKTQMOUT(OPARMS);                             1011
*                                                                  1011
         LA    @15,OPARMS(,TOMWREG)                                1011
         ST    @15,@AL00001                                        1011
         L     @01,CVTPTR                                          1011
         L     @01,CVTTCASP(,@01)                                  1011
         L     @15,TCASOQM(,@01)                                   1011
         LA    @01,@AL00001                                        1011
         BALR  @14,@15                                             1011
*             END;                   /* END OF RETRY SITUATION       */
*                                                                  1012
*           END REBLDRPL;            /* END OF REBLDRPL              */
@EL00020 DS    0H                                                  1013
@EF00020 DS    0H                                                  1013
@ER00020 L     @14,@SA00020                                        1013
         BR    @14                                                 1013
         EJECT
*REISSUE:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1014
*                                                                  1014
REISSUE  ST    @14,@SA00021                                        1014
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - REISSUE                                   */
*           /*                                                       */
*           /* FUNCTION - TO ESTABLISH CONDITIONS FOR RETRY ATTEMPT  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1015
*           RETRY = RETRY + 1;         /* INCREMENT RETRY COUNT      */
*                                                                  1015
         LA    @15,1                                               1015
         SLR   @14,@14                                             1015
         IC    @14,RETRY(,TOMWREG)                                 1015
         ALR   @15,@14                                             1015
         STC   @15,RETRY(,TOMWREG)                                 1015
*           IF RETRY > 3 THEN          /* ABEND SITUATION?           */
         CLI   RETRY(TOMWREG),3                                    1016
         BNH   @RF01016                                            1016
*             CALL EXITFRR;            /* CALL ABEND ROUTINE @ZM20856*/
         BAL   @14,EXITFRR                                         1017
*           ELSE                       /* RETRY SITUATION            */
*             DO;                      /* PREPARE FOR RETRY          */
         B     @RC01016                                            1018
@RF01016 DS    0H                                                  1019
*               CALL CHKOCEOC;         /* CANCEL CHAIN IF NECESSARY  */
         BAL   @14,CHKOCEOC                                        1019
*               RPLVTFL2 = RESPPOS;    /* POST=RESP AND            1020
*                                         RESPOND=(NEX,FME,NRRN)     */
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1020
*             END;                     /* END OF RETRY SITUATION     */
*                                                                  1021
*           END REISSUE;               /* END OF REISSUE             */
@EL00021 DS    0H                                                  1022
@EF00021 DS    0H                                                  1022
@ER00021 L     @14,@SA00021                                        1022
         BR    @14                                                 1022
         EJECT
*BFCN:      PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1023
*                                                                  1023
BFCN     ST    @14,@SA00022                                        1023
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - BFCN                                      */
*           /*                                                       */
*           /* FUNCTION - TO HANDLE BUFFER CONTENTION SITUATION      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1024
*           SWNL = '1'B;                  /* START ON NEW LINE       */
         OI    SWNL(TOMWREG),B'01000000'                           1024
*           CHARCNT = 0;                  /* RESET PRINT.-CHAR. COUNT*/
         SLR   @15,@15                                             1025
         ST    @15,CHARCNT(,TOMWREG)                               1025
*           CALL CHKOCEOC;                /* CANCEL CHAIN IF NEC.    */
*                                                                  1026
         BAL   @14,CHKOCEOC                                        1026
*           IF TVWARTRY = '1'B THEN       /* RETRY SITUATION?        */
         TM    TVWARTRY(TVWAREG),B'00000010'                       1027
         BNO   @RF01027                                            1027
*             DO;                         /* DO THE FOLLOWING        */
*               TVWARTRY = '0'B;          /* RESET RETRY SWITCH      */
         NI    TVWARTRY(TVWAREG),B'11111101'                       1029
*               /*****************************************************/
*               /* IF GLOBAL ERROR, RESEND RU.  OTHERWISE, RESET     */
*               /* MESSAGE POINTER AND TRY AGAIN.                    */
*               /*****************************************************/
*               IF ERMG = '1'B THEN;      /* IF GLOBAL ERROR       1030
*                                            RESEND GLOBAL ERROR MSG */
         TM    ERMG(TOMWREG),B'00001000'                           1030
         BO    @RT01030                                            1030
*               ELSE                      /* NOT GLOBAL ERROR        */
*                 DO;                     /* DO THE FOLLOWING        */
*                   OPREQ = RESET;        /* RESET MESSAGE POINTER   */
         MVI   OPREQ(TOMWREG),X'07'                                1033
*                   CALL IKTQMOUT(OPARMS);                         1034
         LA    @15,OPARMS(,TOMWREG)                                1034
         ST    @15,@AL00001                                        1034
         L     @01,CVTPTR                                          1034
         L     @01,CVTTCASP(,@01)                                  1034
         L     @15,TCASOQM(,@01)                                   1034
         LA    @01,@AL00001                                        1034
         BALR  @14,@15                                             1034
*                   BYPASS = '1'B;        /* BYPASS REST OF BLDEND   */
         OI    BYPASS(TOMWREG),B'00000001'                         1035
*                   NEC = '0'B;           /* DO NOT RESEND           */
         NI    NEC(TOMWREG),B'11111011'                            1036
*                 END;                                             1037
*             END;                        /* END OF RETRY SITUATION  */
*           ELSE                          /* NOT RETRY SITUATION     */
*             /*******************************************************/
*             /* IF GLOBAL ERROR, SEND SIGNAL AND RESEND RU.         */
*             /*******************************************************/
*             IF ERMG = '1'B THEN         /* GLOBAL ERROR?           */
         B     @RC01027                                            1039
@RF01027 TM    ERMG(TOMWREG),B'00001000'                           1039
         BNO   @RF01039                                            1039
*               CALL SENDSIG;             /* SEND SIGNAL             */
         BAL   @14,SENDSIG                                         1040
*             ELSE                        /* NOT GLOBAL ERROR        */
*               DO;                       /* DO THE FOLLOWING        */
         B     @RC01039                                            1041
@RF01039 DS    0H                                                  1042
*                 OPREQ = RESET;          /* RESET MESSAGE POINTER   */
         MVI   OPREQ(TOMWREG),X'07'                                1042
*                 CALL IKTQMOUT(OPARMS);  /* CALL QUEUE MANAGER      */
         LA    @15,OPARMS(,TOMWREG)                                1043
         ST    @15,@AL00001                                        1043
         L     @01,CVTPTR                                          1043
         L     @01,CVTTCASP(,@01)                                  1043
         L     @15,TCASOQM(,@01)                                   1043
         LA    @01,@AL00001                                        1043
         BALR  @14,@15                                             1043
*                 NEC = '0'B;             /* DO NOT RESEND RU        */
         NI    NEC(TOMWREG),B'11111011'                            1044
*                 BYPASS = '1'B;          /* BYPASS REST OF BLDEND   */
         OI    BYPASS(TOMWREG),B'00000001'                         1045
*                 /***************************************************/
*                 /* IF THERE IS A BREAK-IN MESSAGE ON THE QUEUE OR  */
*                 /* IF A BREAK-IN MESSAGE IS BEING PROCESSED, DO    */
*                 /* THE FOLLOWING.                                  */
*                 /***************************************************/
*                 IF TVWABIR = '1'B ×       /* BREAK TPUT ON QUEUE?  */
*                    BRK='1'B THEN          /* CURRENT TPUT A BREAK? */
         TM    TVWABIR(TVWAREG),B'00000001'                        1046
         BO    @RT01046                                            1046
         TM    BRK(TOMWREG),B'10000000'                            1046
         BNO   @RF01046                                            1046
@RT01046 DS    0H                                                  1047
*                   DO;                     /* HANDLE BREAK-IN CASE  */
*                     TVWABRIN = '1'B;      /* BREAK-IN SITUATION    */
         OI    TVWABRIN(TVWAREG),B'10000000'                       1048
*                     BRK = '0'B;           /* RESET BREAK SWITCH    */
         NI    BRK(TOMWREG),B'01111111'                            1049
*                     CALL SENDSIG;         /* SEND SIGNAL           */
         BAL   @14,SENDSIG                                         1050
*                     SIGSENT = '1'B;       /* SIGNAL SENT           */
         OI    SIGSENT(TOMWREG),B'00010000'                        1051
*                     /***********************************************/
*                     /* IF CHANGE-DIRECTION RECEIVED, TRY AGAIN.    */
*                     /* OTHERWISE, EXIT.                            */
*                     /***********************************************/
*                     IF TVWASCD = '1'B THEN /* CHANGE DIRECTION?    */
         TM    TVWASCD(TVWAREG),B'00100000'                        1052
         BNO   @RF01052                                            1052
*                       TVWASCD = '0'B;     /* RESET DIRECTION SWITCH*/
         NI    TVWASCD(TVWAREG),B'11011111'                        1053
*                     ELSE                  /* NOT CHANGE DIRECTION  */
*                       DO;                                        1054
         B     @RC01052                                            1054
@RF01052 DS    0H                                                  1055
*                         AGAIN = '0'B;     /* STOP CHAINING PROCESS */
         NI    AGAIN(TOMWREG),B'11111110'                          1055
*                         TVWATAS = '1'B;   /* TOM NOT AVAILABLE     */
         OI    TVWATAS(TVWAREG),B'00100000'                        1056
*                         TVWABKMG = '0'B;  /* NO BREAK-IN MESSAGE   */
         NI    TVWABKMG(TVWAREG),B'11111011'                       1057
*                         SIGSENT = '0'B;   /* RESET SIGNAL SWITCH   */
         NI    SIGSENT(TOMWREG),B'11101111'                        1058
*                         XIT = '1'B;       /* EXIT                  */
         OI    XIT(TOMWREG),B'00000100'                            1059
*                       END;                                       1060
*                   END;                                           1061
*                 ELSE                                             1062
*                   /*************************************************/
*                   /* WHEN NO BREAK-IN MESSAGE INVOLVED, EXIT.      */
*                   /*************************************************/
*                   DO;                                            1062
         B     @RC01046                                            1062
@RF01046 DS    0H                                                  1063
*                     TVWABKMG = '0'B;      /* NO BREAK-IN MESSAGE   */
         NI    TVWABKMG(TVWAREG),B'11111011'                       1063
*                     SIGSENT = '0'B;       /* RESET SIGNAL SWITCH   */
         NI    SIGSENT(TOMWREG),B'11101111'                        1064
*                     TVWATAS = '1'B;       /* TOM NOT AVAILABLE     */
         OI    TVWATAS(TVWAREG),B'00100000'                        1065
*                     AGAIN = '0'B;         /* STOP CHAINING PROCESS */
         NI    AGAIN(TOMWREG),B'11111110'                          1066
*                     XIT = '1'B;           /* EXIT                  */
         OI    XIT(TOMWREG),B'00000100'                            1067
*                     TVWABFC = '1'B;       /* BUFFER CONTENTION     */
         OI    TVWABFC(TVWAREG),B'10000000'                        1068
*                   END;                                           1069
*               END;                                               1070
*                                                                  1070
*           END BFCN;                       /* END OF BFCN           */
@EL00022 DS    0H                                                  1071
@EF00022 DS    0H                                                  1071
@ER00022 L     @14,@SA00022                                        1071
         BR    @14                                                 1071
         EJECT
*CNCL:      PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1072
*                                                                  1072
CNCL     ST    @14,@SA00023                                        1072
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - CNCL                                      */
*           /*                                                       */
*           /* FUNCTION  -    CALL CHKOCEOC SO THAT THE CURRENT      */
*           /*                CHAIN WILL BE CANCELED IF THE LAST     */
*           /*                CHAIN-ELEMENT SENT WAS A BEGINNING OF  */
*           /*                CHAIN OR A MIDDLE OF CHAIN.            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1073
*           RETRY = 0;            /* RESET RETRY COUNT               */
         MVI   RETRY(TOMWREG),X'00'                                1073
*           RETRYMSG='0'B;        /* RESET RETRY-MESSAGE FLAG      1074
*                                                            @ZM21462*/
         NI    RETRYMSG(TOMWREG),B'11110111'                       1074
*           SWNL = '1'B;          /* START NEXT MESSAGE ON NEW LINE  */
         OI    SWNL(TOMWREG),B'01000000'                           1075
*           CHARCNT = 0;          /* RESET PRINTABLE CHARACTER COUNT */
         SLR   @15,@15                                             1076
         ST    @15,CHARCNT(,TOMWREG)                               1076
*           CALL CHKOCEOC;        /* CANCEL CHAIN IF NECESSARY       */
*                                                                  1077
         BAL   @14,CHKOCEOC                                        1077
*           IF TVWADOOQ='1'B THEN /* MESSAGE ON QUEUE?               */
         TM    TVWADOOQ(TVWAREG),B'01000000'                       1078
         BNO   @RF01078                                            1078
*             NEC = '0'B;         /* DO NOT RESEND RU                */
         NI    NEC(TOMWREG),B'11111011'                            1079
*           ELSE                  /* NO MESSAGE ON QUEUE             */
*             DO;                 /* SEND SPACE-BACKSPACE AS OC      */
         B     @RC01078                                            1080
@RF01078 DS    0H                                                  1081
*               NEC = '1'B;       /* DO ANOTHER SEND                 */
         OI    NEC(TOMWREG),B'00000100'                            1081
*               RU(1:2)='4016'X;  /* SPACE-BACKSPACE                 */
         MVC   RU(2,TOMWREG),@CB02804                              1082
*               BYTECNT = 3;      /* NEXT AVAILABLE BYTE POSITION    */
         MVC   BYTECNT(4,TOMWREG),@CF00291                         1083
*               RPLVTFL2 = RESPPOS;                                1084
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1084
*             END;                                                 1085
*                                                                  1085
*           END CNCL;             /* END OF CNCL                     */
@EL00023 DS    0H                                                  1086
@EF00023 DS    0H                                                  1086
@ER00023 L     @14,@SA00023                                        1086
         BR    @14                                                 1086
         EJECT
*PAPEROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1087
*                                                                  1087
PAPEROUT ST    @14,@SA00024                                        1087
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - PAPEROUT                                  */
*           /*                                                       */
*           /* FUNCTION - TO HANDLE OUT-OF-PAPER CONDITION           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1088
*           CHARCNT = 0;          /* RESET PRINTABLE CHARACTER COUNT */
         SLR   @15,@15                                             1088
         ST    @15,CHARCNT(,TOMWREG)                               1088
*           SWNL = '1'B;          /* START NEXT MESSAGE ON NEW LINE  */
         OI    SWNL(TOMWREG),B'01000000'                           1089
*           CALL CHKOCEOC;        /* CANCEL CHAIN IF NECESSARY       */
*                                                                  1090
         BAL   @14,CHKOCEOC                                        1090
*           IF TVWARTRY='1'B THEN /* RETRY SITUATION?                */
         TM    TVWARTRY(TVWAREG),B'00000010'                       1091
         BNO   @RF01091                                            1091
*             DO;                 /* DO THE FOLLOWING                */
*               TVWARTRY = '0'B;  /* RESET RETRY SWITCH              */
*                                                                  1093
         NI    TVWARTRY(TVWAREG),B'11111101'                       1093
*               /*****************************************************/
*               /* IF GLOBAL ERROR, RESEND RU.                       */
*               /* OTHERWISE, RESET MESSAGE POINTER AND TRY AGAIN.   */
*               /*****************************************************/
*               IF ERMG='1'B THEN; /* IF GLOBAL ERROR, RESEND RU.    */
         TM    ERMG(TOMWREG),B'00001000'                           1094
         BO    @RT01094                                            1094
*               ELSE              /* NOT GLOBAL ERROR                */
*                 DO;             /* DO THE FOLLOWING                */
*                   OPREQ = RESET;         /* RESET MESSAGE POINTER  */
         MVI   OPREQ(TOMWREG),X'07'                                1097
*                   CALL IKTQMOUT(OPARMS); /* CALL QUEUE MANAGER     */
         LA    @15,OPARMS(,TOMWREG)                                1098
         ST    @15,@AL00001                                        1098
         L     @01,CVTPTR                                          1098
         L     @01,CVTTCASP(,@01)                                  1098
         L     @15,TCASOQM(,@01)                                   1098
         LA    @01,@AL00001                                        1098
         BALR  @14,@15                                             1098
*                   BYPASS = '1'B;         /* BYPASS REST OF BLDEND  */
         OI    BYPASS(TOMWREG),B'00000001'                         1099
*                   NEC = '0'B;   /* DO NOT RESEND RU                */
         NI    NEC(TOMWREG),B'11111011'                            1100
*                 END;                                             1101
*             END;                /* END OF RETRY SITUATION          */
*           ELSE                  /* NOT RETRY SITUATION             */
*             DO;                 /* DO THE FOLLOWING                */
         B     @RC01091                                            1103
@RF01091 DS    0H                                                  1104
*               OPREQ = RESET;    /* RESET MESSAGE POINTER           */
         MVI   OPREQ(TOMWREG),X'07'                                1104
*               CALL IKTQMOUT(OPARMS);                             1105
         LA    @15,OPARMS(,TOMWREG)                                1105
         ST    @15,@AL00001                                        1105
         L     @01,CVTPTR                                          1105
         L     @01,CVTTCASP(,@01)                                  1105
         L     @15,TCASOQM(,@01)                                   1105
         LA    @01,@AL00001                                        1105
         BALR  @14,@15                                             1105
*               NEC = '0'B;       /* DO NOT RESEND RU                */
         NI    NEC(TOMWREG),B'11111011'                            1106
*               BYPASS = '1'B;    /* BYPASS REST OF BLDEND           */
         OI    BYPASS(TOMWREG),B'00000001'                         1107
*               TVWATAS = '1'B;   /* TOM IS NOT AVAILABLE            */
*               TVWAOOPS = '1'B;  /* OUT OF PAPER CONDITION          */
         OI    TVWATAS(TVWAREG),B'00100001'                        1109
*               AGAIN = '0'B;     /* STOP CHAINING PROCESS           */
         NI    AGAIN(TOMWREG),B'11111110'                          1110
*               XIT = '1'B;       /* EXIT                            */
         OI    XIT(TOMWREG),B'00000100'                            1111
*             END;                /* END OF NON-RETRY SITUATION      */
*                                                                  1112
*           END PAPEROUT;         /* END OF PAPEROUT                 */
@EL00024 DS    0H                                                  1113
@EF00024 DS    0H                                                  1113
@ER00024 L     @14,@SA00024                                        1113
         BR    @14                                                 1113
         EJECT
*FIXIT:     PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1114
*                                                                  1114
FIXIT    ST    @14,@SA00025                                        1114
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - FIXIT                                     */
*           /*                                                       */
*           /* FUNCTION - TO HANDLE BRACKET BID REJECT, BRACKET      */
*           /*            STATE ERROR, CHAINING ERROR, FUNCTION NOT  */
*           /*            SUPPORTED, AND PARAMETER ERROR.            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1115
*           RETRY = RETRY + 1;      /* INCREMENT RETRY COUNT         */
*                                                                  1115
         LA    @15,1                                               1115
         SLR   @14,@14                                             1115
         IC    @14,RETRY(,TOMWREG)                                 1115
         ALR   @15,@14                                             1115
         STC   @15,RETRY(,TOMWREG)                                 1115
*           IF RETRY > 3 THEN       /* ABEND SITUATION?              */
         CLI   RETRY(TOMWREG),3                                    1116
         BNH   @RF01116                                            1116
*             CALL EXITFRR;         /* CALL ABEND ROUTINE    @ZM20856*/
         BAL   @14,EXITFRR                                         1117
*           ELSE                    /* RETRY SITUATION               */
*             DO;                   /* DO THE FOLLOWING              */
         B     @RC01116                                            1118
@RF01116 DS    0H                                                  1119
*               NEC = '0'B;         /* NOT NECESSARY TO RESEND       */
         NI    NEC(TOMWREG),B'11111011'                            1119
*               CHARCNT = 0;        /* RESET PRINTABLE CHAR. COUNT   */
         SLR   @15,@15                                             1120
         ST    @15,CHARCNT(,TOMWREG)                               1120
*               BYPASS = '1'B;      /* BYPASS REST OF BLDEND         */
         OI    BYPASS(TOMWREG),B'00000001'                         1121
*               CALL CHKOCEOC;      /* CANCEL CHAIN IF NECESSARY     */
         BAL   @14,CHKOCEOC                                        1122
*               OPREQ = RESET;      /* RESET MESSAGE POINTER         */
         MVI   OPREQ(TOMWREG),X'07'                                1123
*               CALL IKTQMOUT(OPARMS);                             1124
         LA    @15,OPARMS(,TOMWREG)                                1124
         ST    @15,@AL00001                                        1124
         L     @01,CVTPTR                                          1124
         L     @01,CVTTCASP(,@01)                                  1124
         L     @15,TCASOQM(,@01)                                   1124
         LA    @01,@AL00001                                        1124
         BALR  @14,@15                                             1124
*               RETRYMSG = '1'B;    /* RETRY MESSAGE TO BE SEND      */
         OI    RETRYMSG(TOMWREG),B'00001000'                       1125
*             END;                  /* END OF RETRY SITUATION        */
*                                                                  1126
*           END FIXIT;              /* END OF FIXIT                  */
@EL00025 DS    0H                                                  1127
@EF00025 DS    0H                                                  1127
@ER00025 L     @14,@SA00025                                        1127
         BR    @14                                                 1127
         EJECT
*SENDSIG:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1128
*                                                                  1128
SENDSIG  ST    @14,@SA00026                                        1128
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - SENDSIG                                   */
*           /*                                                       */
*           /* FUNCTION - TO SEND SIGNAL                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1129
*           /*********************************************************/
*           /* A.  RELEASE THE LOCAL LOCK.                           */
*           /* B.  SEND SIGNAL.                                      */
*           /* C.  RESET THE FRR.                                    */
*           /* D.  OBTAIN THE LOCAL LOCK.                            */
*           /*********************************************************/
*                                                                  1129
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    1129
*           MPSTSOIR='0'B;             /* RESET IWAIT SYSEVENT     1130
*                                         REQUEST FLAG               */
*           MPSTSOIW='0'B;             /* RESET IWAIT SYSEVENT FLAG  */
         L     @04,PSAAOLD                                         1131
         L     @04,ASCBASXB(,@04)                                  1131
         L     @04,ASXBMPST(,@04)                                  1131
         NI    MPSTSOIR(@04),B'00111111'                           1131
*           SRPLCHN = RPLCHN;          /* SAVE CHAIN ELEMENT         */
         MVC   SRPLCHN(1,TOMWREG),RPLCHN+16(RPLREG)                1132
*           WRK2 = ADDR(IFGRPL);       /* RPL ADDRESS                */
*                                                                  1133
         LR    WRK2,RPLREG                                         1133
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,PSA,
*                         FRRSELEN,PSACSTK,FRRSFRRA,FRRSENTR,FRRSPARM,
*                         PSALITA,FLC)                             1134
*                    SETS(WRK2,WRK3,REGPARM,REG0,REG1,REG13,REG14, 1134
*                         REG15);                                  1134
*                                                                  1134
       SETLOCK RELEASE,                                               CC
               TYPE=LOCAL,                                            CC
               REGS=USE,                                              CC
               RELATED=(RPL)
       SEND    RPL=(WRK2),                                            CC
               STYPE=REQ,                                             CC
               OPTCD=(SYN,CS),                              @ZA24528  CC
               CONTROL=SIGNAL
       SETFRR  A,                                                     CC
               FRRAD=(FRRPTR),                                        CC
               PARMAD=(REGPARM),                                      CC
               WRKREGS=(WRK2,WRK3)
       SETLOCK OBTAIN,                                                CC
               TYPE=LOCAL,                                            CC
               MODE=UNCOND,                                           CC
               REGS=USE,                                              CC
               RELATED=(RPL)
*           FRRPARM=REGPARM;           /* SAVE ADDRESS OF PARAMETER
*                                         AREA PROVIDED BY SETFRR  1135
*                                         MACRO              @ZM20856*/
         ST    REGPARM,FRRPARM                                     1135
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) UNRSTD;  1136
*                                                                  1136
*           CALL INITFRR;              /* CALL FRR INIT      @ZM20856*/
         BAL   @14,INITFRR                                         1137
*           RPLFMHDR='0'B;             /* RESET FORMAT HDR   @ZA26553*/
         NI    RPLFMHDR(RPLREG),B'11111110'                        1138
*           RPLCHN = SRPLCHN;          /* RESTORE CHAIN ELEMENT      */
*                                                                  1139
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                1139
*           END SENDSIG;               /* END OF SENDSIG             */
@EL00026 DS    0H                                                  1140
@EF00026 DS    0H                                                  1140
@ER00026 L     @14,@SA00026                                        1140
         BR    @14                                                 1140
         EJECT
*POSTROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1141
*                                                                  1141
POSTROUT ST    @14,@SA00027                                        1141
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - POSTROUT                                  */
*           /*                                                       */
*           /* FUNCTION - CALL STATUS TO RESET ALL TASKS IN STEP     */
*           /*            THAT ARE SUSPENDED FOR TCBOWAIT.  STATUS   */
*           /*            IS BRANCH-ENTERED WHILE THE LOCAL LOCK IS  */
*           /*            IS HELD.                                   */
*           /*            THE FOLLOWING CODE REQUIRES PREVIOUS       */
*           /*            ADDRESSABILITY TO THE SCVT TO OBTAIN THE   */
*           /*            ADDRESS OF STATUS AND THE ASCB TO OBTAIN   */
*           /*            THE ASID.                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1142
*           RFY WRK2 RSTD;              /* RESTRICT WORK REGISTER    */
*           WRK2 = TOMWREG;             /* SAVE ADDRESS OF WORK AREA */
*                                                                  1143
         LR    WRK2,TOMWREG                                        1143
*           HLD = '0'B;                 /* RESET HOLD SWITCH         */
         NI    HLD(TOMWREG),B'10111111'                            1144
*           IF TSBOWAIT = '1'B THEN     /* OWAIT?                    */
         TM    TSBOWAIT(TSBREG),B'00100000'                        1145
         BNO   @RF01145                                            1145
*             DO;                       /* BEGIN OWAIT PROCESSING    */
*               TSBOWAIT = '0'B;        /* RESET OWAIT SWITCH        */
         NI    TSBOWAIT(TSBREG),B'11011111'                        1147
*               RFY(REG0,REG1,REG13) RSTD;                         1148
*                                                                  1148
*               /*****************************************************/
*               /* PLACE ASID IN THE UPPER HALF OF REGISTER 0 AND    */
*               /* ENTRY CODE (ALL TASKS IN STEP) IN LOWER HALF OF   */
*               /* REGISTER 0.                                       */
*               /*****************************************************/
*                                                                  1149
*               REG0=8;                                            1149
         LA    REG0,8                                              1149
*               REG1='80000000'X;       /* RESET INDICATED           */
         L     REG1,@CF02008                                       1150
*               REG13='0400'X;          /* TCBOWAIT BEING MANIPULATED*/
         LA    REG13,1024                                          1151
*               CALL STATUS;            /* CALL STATUS               */
         L     @03,CVTPTR                                          1152
         L     @03,CVTABEND(,@03)                                  1152
         L     @15,SCVTSTAT(,@03)                                  1152
         BALR  @14,@15                                             1152
*               RFY(REG0,REG1,REG13) UNRSTD;                       1153
*             END;                      /* END OF OWAIT PROCESSING   */
*           ELSE;                       /* NOT OWAIT SITUATION       */
@RF01145 DS    0H                                                  1156
*           TOMWREG = WRK2;             /* RESTORE WORK AREA ADDRESS */
         LR    TOMWREG,WRK2                                        1156
*           RFY WRK2 UNRSTD;            /* UNRESTRICT WORK REGISTER  */
*                                                                  1157
*           END POSTROUT;               /* END OF POSTROUT           */
@EL00027 DS    0H                                                  1158
@EF00027 DS    0H                                                  1158
@ER00027 L     @14,@SA00027                                        1158
         BR    @14                                                 1158
         EJECT
*PRMPTCHK:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1159
*                                                                  1159
PRMPTCHK ST    @14,@SA00028                                        1159
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - PRMPTCHK                                  */
*           /*                                                       */
*           /* FUNCTION - TO CHECK FOR AUTO-PROMPTING                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1160
*           /*********************************************************/
*           /* IF TCLEARQ HAS STOPPED PROMPTING, DO NOTHING.         */
*           /*********************************************************/
*           IF TSBSPIT = '1'B THEN;                                1160
         TM    TSBSPIT(TSBREG),B'00100000'                         1160
         BO    @RT01160                                            1160
*           ELSE                                                   1162
*             /*******************************************************/
*             /* IF AUTO-PROMPTING HAS BEEN REQUESTED, PROCEED.      */
*             /*******************************************************/
*             IF TSBAUTON = '1'B THEN                              1162
         TM    TSBAUTON(TSBREG),B'01000000'                        1162
         BNO   @RF01162                                            1162
*               /*****************************************************/
*               /* IF USER IS TO BE PROMPTED, CONTINUE.              */
*               /*****************************************************/
*               IF TSBSTAUT = '1'B THEN                            1163
         TM    TSBSTAUT(TSBREG),B'00000100'                        1163
         BNO   @RF01163                                            1163
*                 /***************************************************/
*                 /* IF LINE-NUMBER PROMPTING,                       */
*                 /* CALL LINE-NUMBER CONVERSION ROUTINE.            */
*                 /***************************************************/
*                 DO;                                              1164
*                   PROMPT = '1'B;            /* PROMPT MESSAGE      */
         OI    PROMPT(TOMWREG),B'10000000'                         1165
*                   PSENT = '1'B;             /* PROMPT TO BE SENT   */
         OI    PSENT(TOMWREG),B'00001000'                          1166
*                   IF TSBAULST = '1'B THEN   /* LINE PROMPT?        */
         TM    TSBAULST(TSBREG),B'00010000'                        1167
         BNO   @RF01167                                            1167
*                     CALL CNVRT;             /* CONVERT LINE NUMBER */
         BAL   @14,CNVRT                                           1168
*                   ELSE                      /* CHARACTER PROMPT    */
*                     /***********************************************/
*                     /* IF CHARACTER PROMPTING, MOVE UNDERSCORE     */
*                     /* CHARACTER FOLLOWED BY BACKSPACE INTO RU     */
*                     /* (FOUND IN THE TWO HIGH-ORDER BYTES OF       */
*                     /* TSBAUTOS).                                  */
*                     /***********************************************/
*                     DO;                                          1169
         B     @RC01167                                            1169
@RF01167 DS    0H                                                  1170
*                       RU(BYTECNT:BYTECNT+1)=CHARPRMT;            1170
         L     @15,BYTECNT(,TOMWREG)                               1170
         ALR   @15,TOMWREG                                         1170
         MVC   RU-1(2,@15),CHARPRMT(TSBREG)                        1170
*                       BYTECNT = BYTECNT+2;                       1171
         L     @15,BYTECNT(,TOMWREG)                               1171
         AL    @15,@CF00076                                        1171
         ST    @15,BYTECNT(,TOMWREG)                               1171
*                     END;                                         1172
*                 END;                                             1173
*               ELSE;                                              1174
@RF01163 DS    0H                                                  1175
*             ELSE;                                                1175
*                                                                  1175
@RF01162 DS    0H                                                  1176
*           END PRMPTCHK; /* END OF PRMPTCHK                         */
@EL00028 DS    0H                                                  1176
@EF00028 DS    0H                                                  1176
@ER00028 L     @14,@SA00028                                        1176
         BR    @14                                                 1176
         EJECT
*CNVRT:     PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1177
*                                                                  1177
CNVRT    ST    @14,12(,@13)                                        1177
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - CNVRT                                     */
*           /*                                                       */
*           /* FUNCTION - TO CONVERT 8-DIGIT LINE NUMBER INTO        */
*           /*            EDCDIC, TO SUPPRESS LEADING ZEROS (UP TO   */
*           /*            3), AND TO FOLLOW THE LINE NUMBER WITH A   */
*           /*            SPACE (BLANK).                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1178
*           CVD(TSBAUTOS,PACKAREA);  /* CONVERT LINE NO. TO DECIMAL  */
         L     @15,TSBAUTOS(,TSBREG)                               1178
         CVD   @15,PACKAREA(,TOMWREG)                              1178
*           UNPK(UNPKAREA,PACKAREA); /* UNPACK LINE NUMBER           */
         UNPK  UNPKAREA(8,TOMWREG),PACKAREA(8,TOMWREG)             1179
*           NIB1 = '1'B;             /* CHANGE SIGN NIBBLE           */
*           NIB2 = '1'B;             /* CHANGE SIGN NIBBLE           */
*           NIB3 = '1'B;             /* CHANGE SIGN NIBBLE           */
*           NIB4 = '1'B;             /* CHANGE SIGN NIBBLE           */
*                                                                  1183
         OI    NIB1(TOMWREG),B'11110000'                           1183
*           /*********************************************************/
*           /* SINCE LEADING ZEROS (UP TO 3) ARE SUPPRESSED, FIND    */
*           /* THE INDEX (POSITION) OF THE LEFT-MOST DIGIT TO BE     */
*           /* OUTPUT.                                               */
*           /*********************************************************/
*           DO I=1 TO 3 WHILE(UNPKAREA(I) = 'F0'X);                1184
         LA    @15,1                                               1184
         ST    @15,I(,TOMWREG)                                     1184
@DL01184 L     @01,I(,TOMWREG)                                     1184
         ALR   @01,TOMWREG                                         1184
         CLI   UNPKAREA-1(@01),X'F0'                               1184
         BNE   @DC01184                                            1184
*           END;                                                   1185
*                                                                  1185
         LA    @15,1                                               1185
         AL    @15,I(,TOMWREG)                                     1185
         ST    @15,I(,TOMWREG)                                     1185
         C     @15,@CF00291                                        1185
         BNH   @DL01184                                            1185
@DC01184 DS    0H                                                  1186
*           /*********************************************************/
*           /* MOVE LINE NUMBER INTO RU.                             */
*           /*********************************************************/
*           RU(BYTECNT:BYTECNT+8-I)                                1186
*             = UNPKAREA(I:8);       /* PLACE LINE NUMBER INTO RU    */
*                                                                  1186
         L     @15,BYTECNT(,TOMWREG)                               1186
         ALR   @15,TOMWREG                                         1186
         L     @14,BYTECNT(,TOMWREG)                               1186
         LA    @05,8                                               1186
         ALR   @05,@14                                             1186
         L     @04,I(,TOMWREG)                                     1186
         SLR   @05,@04                                             1186
         SLR   @05,@14                                             1186
         ALR   @04,TOMWREG                                         1186
         EX    @05,@SM03020                                        1186
*           BYTECNT = BYTECNT + 9 - I;                             1187
*                                                                  1187
         AL    @14,@CF01008                                        1187
         L     @15,I(,TOMWREG)                                     1187
         SLR   @14,@15                                             1187
         ST    @14,BYTECNT(,TOMWREG)                               1187
*           /*********************************************************/
*           /* ADD A SPACE (BLANK) AFTER THE LINE NUMBER.            */
*           /*********************************************************/
*           RU(BYTECNT) = BLANK;     /* SPACE                        */
*                                                                  1188
         ALR   @14,TOMWREG                                         1188
         MVI   RU-1(@14),X'40'                                     1188
*           BYTECNT = BYTECNT + 1;   /* NEXT BYTE POSITION           */
*                                                                  1189
         L     @15,BYTECNT(,TOMWREG)                               1189
         AL    @15,@CF00064                                        1189
         ST    @15,BYTECNT(,TOMWREG)                               1189
*           END CNVRT;               /* END OF CNVRT                 */
@EL00029 DS    0H                                                  1190
@EF00029 DS    0H                                                  1190
@ER00029 L     @14,12(,@13)                                        1190
         BR    @14                                                 1190
         EJECT
*SCDROUT:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1191
*                                                                  1191
SCDROUT  ST    @14,@SA00030                                        1191
*           /*********************************************************/
*           /*                                                       */
*           /* PROCEDURE - SCDROUT                                   */
*           /*                                                       */
*           /* FUNCTION - TO SEND SPACE-BACKSPACE AS ONLY CHAIN WHEN */
*           /*            CHANGE-DIRECTION RECEIVED AND NOTHING TO   */
*           /*            OUTPUT.                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1192
*           RU(1:2) = '4016'X;  /* SPACE - BACKSPACE                 */
         MVC   RU(2,TOMWREG),@CB02804                              1192
*           BYTECNT = 3;        /* NEXT BYTE                         */
         MVC   BYTECNT(4,TOMWREG),@CF00291                         1193
*           RPLVTFL2 = RESPPOS; /* POST=RESP AND                     */
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1194
*                               /* RESPOND=(NEX,FME,NRRN)            */
*           CHARCNT = 0;        /* RESET PRINTABLE-CHARACTER COUNT   */
         SLR   @15,@15                                             1195
         ST    @15,CHARCNT(,TOMWREG)                               1195
*           TVWASCD = '0'B;     /* RESET CHANGE-DIRECTION SWITCH     */
         NI    TVWASCD(TVWAREG),B'11011111'                        1196
*           AGAIN = '1'B;       /* GO THROUGH BLDCHAIN AGAIN         */
*           MSG = '1'B;         /* POSSIBLE ANOTHER MESSAGE ON QUEUE */
         OI    AGAIN(TOMWREG),B'00000101'                          1198
*           CALL SENDRU;        /* SEND RU AS ONLY CHAIN             */
*                                                                  1199
         BAL   @14,SENDRU                                          1199
*           END SCDROUT;        /* END OF SCDROUT                    */
@EL00030 DS    0H                                                  1200
@EF00030 DS    0H                                                  1200
@ER00030 L     @14,@SA00030                                        1200
         BR    @14                                                 1200
         EJECT
*BKMGROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1201
*                                                                  1201
BKMGROUT ST    @14,@SA00031                                        1201
*    /****************************************************************/
*    /*                                                              */
*    /*        PROCEDURE - BKMGROUT                                  */
*    /*                                                              */
*    /*        FUNCTION - TO TRANSMIT A PARTIAL MESSAGE (THAT WAS    */
*    /*                   BEING KEYED-IN AT THE TERMINAL WHEN A      */
*    /*                   BREAK-IN OCCURRED) BACK TO THE TERMINAL.   */
*    /*                                                              */
*    /****************************************************************/
*                                                                  1202
*           IF SWNL = '1'B THEN /* NEW LINE?                         */
         TM    SWNL(TOMWREG),B'01000000'                           1202
         BNO   @RF01202                                            1202
*             DO;               /* DO NEW-LINE PROCESSING            */
*               SWNL = '0'B;    /* RESET NEW-LINE SWITCH             */
         NI    SWNL(TOMWREG),B'10111111'                           1204
*               RU(BYTECNT) = NL;                                  1205
         L     @15,BYTECNT(,TOMWREG)                               1205
         ALR   @15,TOMWREG                                         1205
         MVC   RU-1(1,@15),NL                                      1205
*               BYTECNT = BYTECNT + 1;                             1206
         L     @15,BYTECNT(,TOMWREG)                               1206
         AL    @15,@CF00064                                        1206
         ST    @15,BYTECNT(,TOMWREG)                               1206
*             END;              /* END OF NEW-LINE PROCESSING        */
*           ELSE;               /* SAME LINE                         */
*                                                                  1208
@RF01202 DS    0H                                                  1209
*           /*********************************************************/
*           /* ISSUE MESSAGE 'REENTER DATA BEGINNING WITH' SINCE, AS */
*           /* A RESULT OF A BREAK_IN CONDITION, THE PARTIAL LINE    */
*           /* MUST BE REENTERED TO BE VALID INPUT.                  */
*           /*********************************************************/
*           I = REENTDTA;       /* REENTER-DATA MESSAGE              */
         LA    @15,6                                               1209
         ST    @15,I(,TOMWREG)                                     1209
*           RU(BYTECNT:BYTECNT+MSGSIZE-1) = MSGDATA(1:MSGSIZE);    1210
         L     @14,BYTECNT(,TOMWREG)                               1210
         ALR   @14,TOMWREG                                         1210
         SLA   @15,2                                               1210
         L     @01,CVTPTR                                          1210
         L     @01,CVTTCASP(,@01)                                  1210
         L     @01,TCASMSGS(,@01)                                  1210
         AL    @01,@CF02987                                        1210
         L     @15,MSGADR(@15,@01)                                 1210
         LH    @05,MSGSIZE(,@15)                                   1210
         LR    @04,@05                                             1210
         BCTR  @04,0                                               1210
         EX    @04,@SM03022                                        1210
*           BYTECNT = BYTECNT + MSGSIZE;                           1211
         L     @04,BYTECNT(,TOMWREG)                               1211
         ALR   @04,@05                                             1211
         ST    @04,BYTECNT(,TOMWREG)                               1211
*           RU(BYTECNT) = NL;   /* NEXT LINE                         */
         ALR   @04,TOMWREG                                         1212
         MVC   RU-1(1,@04),NL                                      1212
*           BYTECNT = BYTECNT + 1;                                 1213
*                                                                  1213
         LA    @15,1                                               1213
         L     @14,BYTECNT(,TOMWREG)                               1213
         ALR   @14,@15                                             1213
         ST    @14,BYTECNT(,TOMWREG)                               1213
*           /*********************************************************/
*           /* MOVE PARTIAL MESSAGE INTO THE RU.                     */
*           /*********************************************************/
*           RU(BYTECNT:BYTECNT+TVWATQL1-1) = MESSAGE(1:TVWATQL1);  1214
*                                                                  1214
         ALR   @14,TOMWREG                                         1214
         SLR   @05,@05                                             1214
         IC    @05,TVWATQL1(,TVWAREG)                              1214
         LR    @04,@05                                             1214
         BCTR  @04,0                                               1214
         L     @01,TVWATOPQ(,TVWAREG)                              1214
         EX    @04,@SM03024                                        1214
*           /*********************************************************/
*           /* INCREMENT BYTE-COUNT BY THE LENGTH OF THE PARTIAL     */
*           /* MESSAGE.                                              */
*           /*********************************************************/
*           BYTECNT = BYTECNT + TVWATQL1;                          1215
*                                                                  1215
         L     @14,BYTECNT(,TOMWREG)                               1215
         ALR   @14,@05                                             1215
         ST    @14,BYTECNT(,TOMWREG)                               1215
*           RU(BYTECNT) = NL;   /* NEXT LINE                         */
         ALR   @14,TOMWREG                                         1216
         MVC   RU-1(1,@14),NL                                      1216
*           BYTECNT=BYTECNT+1;  /* INCREMENT RU POSITION             */
         L     @14,BYTECNT(,TOMWREG)                               1217
         ALR   @14,@15                                             1217
         ST    @14,BYTECNT(,TOMWREG)                               1217
*           TVWABKMG = '0'B;    /* RESET BREAK-MESSAGE SWITCH        */
         NI    TVWABKMG(TVWAREG),B'11111011'                       1218
*           AGAIN = '1'B;       /* DO CHAINING PROCESS AGAIN         */
*           MSG = '1'B;         /* POSSIBLY MESSAGE ON QUEUE         */
         OI    AGAIN(TOMWREG),B'00000101'                          1220
*           CHARCNT = 0;        /* RESET PRINTABLE-CHARACTER COUNT   */
         SLR   @15,@15                                             1221
         ST    @15,CHARCNT(,TOMWREG)                               1221
*           RPLVTFL2 = RESPPOS; /* POST=RESP AND                     */
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1222
*                               /* RESPOND=(NEX,FME,NRRN)            */
*           CALL SENDRU;        /* SEND RU                           */
*                                                                  1223
         BAL   @14,SENDRU                                          1223
*           END BKMGROUT;       /* END OF BKMGROUT                   */
@EL00031 DS    0H                                                  1224
@EF00031 DS    0H                                                  1224
@ER00031 L     @14,@SA00031                                        1224
         BR    @14                                                 1224
         EJECT
*INITFRR: PROCEDURE OPTIONS(PARMREG);                              1225
*                                                                  1225
INITFRR  STM   @14,@12,12(@13)                                     1225
*RFY IKTFRPRM BASED(FRRPARM);       /* BASE FRR PARAMETERS   @ZM20856*/
*IKTFRPRM=IKTFRPRM && IKTFRPRM;     /* ZERO CONTROL BLOCK STORAGE  1227
*                                                            @ZM20856*/
         L     @15,FRRPARM                                         1227
         XC    IKTFRPRM(24,@15),IKTFRPRM(@15)                      1227
*FRPRPLAD=ADDR(IFGRPL);             /* INITIALIZE RPL ADDRESS      1228
*                                                            @ZM21178*/
         ST    RPLREG,FRPRPLAD(,@15)                               1228
*FRPRETRY=ADDR(FRWARTRY);           /* INITIALIZE FRR PARM WITH    1229
*                                      OF RETRY INFORMATION  @ZM20856*/
         L     @14,TVWAFRWO(,TVWAREG)                              1229
         LA    @05,FRWARTRY(,@14)                                  1229
         ST    @05,FRPRETRY(,@15)                                  1229
*RFY INFODSCT BASED(ADDR(FRWARTRY));/* BASE INFORMATION DSECT      1230
*                                      ON RETRY AREA         @ZM20856*/
*INFOREGS=ADDR(RETRYREG);           /* INITIALIZE ADDRESS OF RETRY 1231
*                                      REGISTER SAVE AREA ADDRESS  1231
*                                                            @ZM20856*/
         LA    @05,8                                               1231
         ALR   @05,@14                                             1231
         LA    @04,RETRYREG                                        1231
         ST    @04,INFOREGS(,@05)                                  1231
*INFOADDR=ADDR(FRRENTRY);           /* INITIALIZE RETRY ADDR @ZM20856*/
         LA    @04,FRRENTRY                                        1232
         ST    @04,INFOADDR(,@05)                                  1232
*RFY INFODSCT BASED(ADDR(FRWACKPT));/* BASE INFORMATION DSECT      1233
*                                      ON CHECK POINT AREA   @ZM20856*/
*FRPCKINF=ADDR(FRWACKPT);           /* INITIALIZE POINTER TO ADDRESS
*                                      OF CHECK POINT AREA   @ZM20856*/
         ST    @14,FRPCKINF(,@15)                                  1234
*INFOREGS=ADDR(FRWACKRG);           /* INITIALIZE POINTER TO CHECK 1235
*                                      POINT REGISTER SAVE AREA    1235
*                                                            @ZM20856*/
         LA    @05,FRWACKRG(,@14)                                  1235
         ST    @05,INFOREGS(,@14)                                  1235
*FRPXITPT=ADDR(FRWAEXIT);           /* INITIALIZE POINTER TO EXIT  1236
*                                      INFORMATION AREA      @ZM20856*/
         LA    @05,FRWAEXIT(,@14)                                  1236
         ST    @05,FRPXITPT(,@15)                                  1236
*RFY INFODSCT BASED(ADDR(FRWAEXIT));/* BASE INFORMATION DSECT ON EXIT
*                                      INFORMATION AREA      @ZM20856*/
*INFOREGS=ADDR(FRWAEXRG);           /* INITIALIZE POINTER TO EXIT  1238
*                                      REGISTER SAVE AREA ADDRESS  1238
*                                                            @ZM20856*/
         LA    @05,16                                              1238
         ALR   @05,@14                                             1238
         LA    @04,FRWAEXRG(,@14)                                  1238
         ST    @04,INFOREGS(,@05)                                  1238
*INFOADDR=ADDR(IKTEXIT);            /* INITIALIZE POINTER TO ADDRESS
*                                      OF EXIT ROUTINE       @ZM21235*/
         L     @01,CVTPTR                                          1239
         L     @01,CVTTCASP(,@01)                                  1239
         L     @04,TCASEXIT(,@01)                                  1239
         ST    @04,INFOADDR(,@05)                                  1239
*PLXEXITA=SAVE14;                   /* SET SRB EXIT ADDRESS  @ZM21235*/
         L     @05,SAVE14(,TOMWREG)                                1240
         ST    @05,PLXEXITA                                        1240
*PLXTOMLN=VALTOMLN;                 /* SET TOM LENGTH        @ZM21235*/
         MVC   PLXTOMLN(4),@CF02765                                1241
*PLXTOTLN=VALTOTLN;                 /* SET TOTAL AREA LENGTH @ZM21235*/
         SLR   @05,@05                                             1242
         ST    @05,PLXTOTLN                                        1242
*RFY                                                               1243
*  REG1 RSTD;                       /* PARAMETER POINTER     @ZM21235*/
*REG1=ADDR(PLXPARMS);               /* ADDRESS PARAMETER LIST      1244
*                                                            @ZM21235*/
         LA    REG1,PLXPARMS                                       1244
*STM(REG0,REG15,FRWAEXRG);          /* SAVE REGISTERS FOR USE BY   1245
*                                      EXIT ROUTINE          @ZM20856*/
         STM   REG0,REG15,FRWAEXRG(@14)                            1245
*RFY                                                               1246
*  REG1 UNRSTD;                     /* PARAMETER POINTER     @ZM21235*/
*FRPOMNGR='1'B;                     /* INDICATE OUTPUT MANAGER     1247
*                                                            @ZM20856*/
         OI    FRPOMNGR(@15),B'10000000'                           1247
*FRPCONST=ADDR(CONSAREA);           /* INITIALIZE THE FRR PARAMETER TO
*                                      THE ADDRESS OF THE CONSTANT 1248
*                                      AREA                  @ZM20856*/
         LA    @14,CONSAREA                                        1248
         ST    @14,FRPCONST(,@15)                                  1248
*END INITFRR;                       /* END OF INITFRR        @ZM20856*/
@EL00032 DS    0H                                                  1249
@EF00032 DS    0H                                                  1249
@ER00032 LM    @14,@12,12(@13)                                     1249
         BR    @14                                                 1249
         EJECT
*EXITFRR:  PROCEDURE OPTIONS(NOSAVEAREA);                          1250
*                                                                  1250
EXITFRR  STM   @14,@12,12(@13)                                     1250
*RFY IKTLTCB BASED(ADDR(RPLUSFLD)); /* BASE LOSTERM FLAGS ON       1251
*                                      RPL USER FIELD        @ZM20856*/
*IKTLTCB=0;                         /* ZERO USER FIELD       @ZM20856*/
         LA    @15,92                                              1252
         ALR   @15,RPLREG                                          1252
         SLR   @14,@14                                             1252
         STCM  @14,15,IKTLTCB(@15)                                 1252
*LTCBIOER='1'B;                     /* TURN ON I/O ERROR BIT @ZM20856*/
         OI    LTCBIOER(@15),B'10000000'                           1253
*RFY                                                               1254
*  REG15 RSTD;                      /* RESTRICT REGISTER 15  @ZM21142*/
*REG15=REASONCD;                    /* REASON CODE           @ZM21142*/
         L     REG15,REASONCD                                      1255
*GEN EXIT                                                          1256
*    (ABEND X'0AB',,,SYSTEM);       /* ISSUE ABEND           @ZM20856*/
*                                                                  1256
         ABEND X'0AB',,,SYSTEM
*END EXITFRR;                       /* END OF EXITFRR        @ZM20856*/
@EL00033 DS    0H                                                  1257
@EF00033 DS    0H                                                  1257
@ER00033 LM    @14,@12,12(@13)                                     1257
         BR    @14                                                 1257
@PB00033 DS    0H                                                  1257
         EJECT
*END IKTTOMRT                       /* END OF IKTTOMRT               */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        *
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                        *
*/*%INCLUDE SYSLIB  (ISTRPLFB)                                        *
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        *
*/*%INCLUDE SYSLIB  (IHAASCB )                                        *
*/*%INCLUDE SYSLIB  (IHAASXB )                                        *
*/*%INCLUDE SYSLIB  (IHAFRRS )                                        *
*/*%INCLUDE SYSLIB  (IHASCVT )                                        *
*/*%INCLUDE SYSLIB  (IHASRB  )                                        *
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                        *
*/*%INCLUDE SYSLIB  (IKJTSB  )                                        *
*/*%INCLUDE SYSLIB  (IKTTSBX )                                        *
*/*%INCLUDE SYSLIB  (IKTEQU  )                                        *
*/*%INCLUDE SYSLIB  (IKTFRPRM)                                        *
*/*%INCLUDE SYSLIB  (IKTFRRWA)                                        *
*/*%INCLUDE SYSLIB  (IKTLTCB )                                        *
*/*%INCLUDE SYSLIB  (IKTTCAST)                                        *
*/*%INCLUDE SYSLIB  (IKTTVWA )                                        *
*/*%INCLUDE SYSLIB  (ISTPAB  )                                        *
*/*%INCLUDE SYSLIB  (ISTDYPAB)                                        *
*/*%INCLUDE SYSLIB  (ISTMPST )                                        *
*/*%INCLUDE SYSLIB  (IKTOPARM)                                        *
*;                                                                 1258
@DATA    DS    0H
@SM02988 MVC   RU-1(0,@14),MSGDATA(@05)
@SM02999 MVC   RU-1(0,@15),WKSP(TOMWREG)
@SM03001 MVC   WKSP(0,TOMWREG),BUFFER(@01)
@SB03003 TRT   WKSP-1(0,@03),FMTTAB
@SB03005 TR    WKSP-1(0,@15),EDITAB
@SB03007 TR    WKSP-1(0,@03),ASISTAB
@SB03009 TR    WKSP-1(0,@03),EDITAB
@SB03011 TRT   RU-1(0,@03),CNTRLTAB
@SB03013 TR    RU-1(0,@03),USRTRANS(@14)
@SB03015 TR    RU-1(0,@03),ASCIITAB(@14)
@SM03017 MVC   RU-1(0,@04),WKSP-1(@15)
@SM03020 MVC   RU-1(0,@15),UNPKAREA-1(@04)
@SM03022 MVC   RU-1(0,@14),MSGDATA(@15)
@SM03024 MVC   RU-1(0,@14),MESSAGE(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    1F
@SA00008 DS    1F
@SA00004 DS    1F
@SA00005 DS    1F
@SA00007 DS    1F
@SA00010 DS    1F
@SA00028 DS    1F
@SA00006 DS    1F
@SA00016 DS    1F
@SA00015 DS    1F
@SA00027 DS    1F
@SA00031 DS    1F
@SA00030 DS    1F
@SA00017 DS    1F
@SA00020 DS    1F
@SA00018 DS    1F
@SA00019 DS    1F
@SA00021 DS    1F
@SA00022 DS    1F
@SA00023 DS    1F
@SA00024 DS    1F
@SA00025 DS    1F
@SA00026 DS    1F
@AL00001 DS    1A
IKTTOMRT CSECT
         DS    0F
@CF00064 DC    F'1'
@CF00076 DC    F'2'
@CF00291 DC    F'3'
@CF00056 DC    F'4'
@CF01008 DC    F'9'
@CF00073 DC    F'24'
@CF00742 DC    F'32'
@CF02846 DC    F'136'
@CF00684 DC    F'256'
@CF02797 DC    F'257'
@CF02765 DC    F'5192'
@CF02987 DC    F'-4'
@CF02008 DC    XL4'80000000'
@CF02998 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
FRRPARM  DS    A
@NM00282 DS    CL12
         ORG   @NM00282
RPLSAVE  DS    AL4
TSBSAVE  DS    AL4
TVWASAVE DS    AL4
         ORG   @NM00282+12
RETRYREG DS    CL64
PLXPARMS DS    CL12
         ORG   PLXPARMS
PLXEXITA DS    AL4
PLXTOMLN DS    FL4
PLXTOTLN DS    FL4
         ORG   PLXPARMS+12
IKTTOMRT CSECT
         NOPR  ((@ENDDATD-@DATD)/321*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV02710 DC    V(IKTRTX1)
         DS    0D
@CB02827 DC    X'5AC915'
@CB02804 DC    X'4016'
@CB02826 DC    X'5A15'
@CB02886 DC    X'081B'
@CB02888 DC    X'0811'
@CB02890 DC    X'0802'
@CB02892 DC    X'0813'
@CB02893 DC    X'080B'
@CB02894 DC    X'2003'
@CB02896 DC    X'2002'
@CB02897 DC    X'1003'
@CB02898 DC    X'1005'
ASISTAB  DS    CL256
         ORG   ASISTAB
@NM00153 DC    X'7A7A7A7A7A'
HTAB     DC    X'05'
@NM00154 DC    X'7A7A7A7A7A'
VTAB     DC    X'0B'
FF       DC    X'0C'
CR       DC    X'0D'
@NM00155 DC    X'7A7A7A7A7A7A'
RES      DC    X'14'
NL       DC    X'15'
BKSPACE  DC    X'16'
@NM00156 DC    X'7A7A7A7A7A7A7A'
IRS      DC    X'1E'
@NM00157 DC    X'7A7A7A7A7A'
BYP      DC    X'24'
LF       DC    X'25'
@NM00158 DC    X'7A7A7A7A7A'
FMT      DC    X'2B'
@NM00159 DC    X'7A7A7A7A'
@NM00160 DC    X'7A7A7A7A7A7A7A7A'
@NM00161 DC    X'7A7A7A7A7A7A7A7A'
@NM00162 DC    X'4041424344454647'
@NM00163 DC    X'48494A4B4C4D4E4F'
@NM00164 DC    X'5051525354555657'
@NM00165 DC    X'58595A5B5C5D5E5F'
@NM00166 DC    X'6061626364656667'
@NM00167 DC    X'68696A6B6C6D6E6F'
@NM00168 DC    X'70717273747576777879'
COLON    DC    X'7A'
@NM00169 DC    X'7B7C7D7E7F'
@NM00170 DC    X'8081828384858687'
@NM00171 DC    X'88898A8B8C8D8E8F'
@NM00172 DC    X'9091929394959697'
@NM00173 DC    X'98999A9B9C9D9E9F'
@NM00174 DC    X'A0A1A2A3A4A5A6A7'
@NM00175 DC    X'A8A9AAABACADAEAF'
@NM00176 DC    X'B0B1B2B3B4B5B6B7'
@NM00177 DC    X'B8B9BABBBCBDBEBF'
@NM00178 DC    X'C0C1C2C3C4C5C6C7'
@NM00179 DC    X'C8C9CACBCCCDCECF'
@NM00180 DC    X'D0D1D2D3D4D5D6D7'
@NM00181 DC    X'D8D9DADBDCDDDEDF'
@NM00182 DC    X'E0E1E2E3E4E5E6E7'
@NM00183 DC    X'E8E9EAEBECEDEEEF'
@NM00184 DC    X'F0F1F2F3F4F5F6F7'
@NM00185 DC    X'F8F9FAFBFCFDFEFF'
         ORG   ASISTAB+256
EDITAB   DS    CL256
         ORG   EDITAB
@NM00186 DC    X'7A7A7A7A7A7A7A7A'
@NM00187 DC    X'7A7A7A7A7A7A7A7A'
@NM00188 DC    X'7A7A7A7A7A7A167A'
@NM00189 DC    X'7A7A7A7A7A7A7A7A'
@NM00190 DC    X'7A7A7A7A7A7A7A7A'
@NM00191 DC    X'7A7A7A7A7A7A7A7A'
@NM00192 DC    X'7A7A7A7A7A7A7A7A'
@NM00193 DC    X'7A7A7A7A7A7A7A7A'
@NM00194 DC    X'4041424344454647'
@NM00195 DC    X'48494A4B4C4D4E4F'
@NM00196 DC    X'5051525354555657'
@NM00197 DC    X'58595A5B5C5D5E5F'
@NM00198 DC    X'6061626364656667'
@NM00199 DC    X'68696A6B6C6D6E6F'
@NM00200 DC    X'7071727374757677'
@NM00201 DC    X'78797A7B7C7D7E7F'
@NM00202 DC    X'8081828384858687'
@NM00203 DC    X'88898A8B8C8D8E8F'
@NM00204 DC    X'9091929394959697'
@NM00205 DC    X'98999A9B9C9D9E9F'
@NM00206 DC    X'A0A1A2A3A4A5A6A7'
@NM00207 DC    X'A8A9AAABACADAEAF'
@NM00208 DC    X'B0B1B2B3B4B5B6B7'
@NM00209 DC    X'B8B9BABBBCBDBEBF'
@NM00210 DC    X'C0C1C2C3C4C5C6C7'
@NM00211 DC    X'C8C9CACBCCCDCECF'
@NM00212 DC    X'D0D1D2D3D4D5D6D7'
@NM00213 DC    X'D8D9DADBDCDDDEDF'
@NM00214 DC    X'E0E1E2E3E4E5E6E7'
@NM00215 DC    X'E8E9EAEBECEDEEEF'
@NM00216 DC    X'F0F1F2F3F4F5F6F7'
@NM00217 DC    X'F8F9FAFBFCFDFEFF'
         ORG   EDITAB+256
FMTTAB   DS    CL256
         ORG   FMTTAB
@NM00218 DC    X'0000000000000000'
@NM00219 DC    X'0000000000000000'
@NM00220 DC    X'0000000000000000'
@NM00221 DC    X'0000000000000000'
@NM00222 DC    X'0000000000000000'
@NM00223 DC    X'0000002B00000000'
@NM00224 DC    X'0000000000000000'
@NM00225 DC    X'0000000000000000'
@NM00226 DC    X'0000000000000000'
@NM00227 DC    X'0000000000000000'
@NM00228 DC    X'0000000000000000'
@NM00229 DC    X'0000000000000000'
@NM00230 DC    X'0000000000000000'
@NM00231 DC    X'0000000000000000'
@NM00232 DC    X'0000000000000000'
@NM00233 DC    X'0000000000000000'
@NM00234 DC    X'0000000000000000'
@NM00235 DC    X'0000000000000000'
@NM00236 DC    X'0000000000000000'
@NM00237 DC    X'0000000000000000'
@NM00238 DC    X'0000000000000000'
@NM00239 DC    X'0000000000000000'
@NM00240 DC    X'0000000000000000'
@NM00241 DC    X'0000000000000000'
@NM00242 DC    X'0000000000000000'
@NM00243 DC    X'0000000000000000'
@NM00244 DC    X'0000000000000000'
@NM00245 DC    X'0000000000000000'
@NM00246 DC    X'0000000000000000'
@NM00247 DC    X'0000000000000000'
@NM00248 DC    X'0000000000000000'
@NM00249 DC    X'0000000000000000'
         ORG   FMTTAB+256
CNTRLTAB DS    CL256
         ORG   CNTRLTAB
@NM00250 DC    X'0000000000050000'
@NM00251 DC    X'0000000B0C0D0000'
@NM00252 DC    X'0000000014151600'
@NM00253 DC    X'0000000000001E00'
@NM00254 DC    X'0000000024250000'
@NM00255 DC    X'0000002B00000000'
@NM00256 DC    X'0000000000000000'
@NM00257 DC    X'0000000000000000'
@NM00258 DC    X'0000000000000000'
@NM00259 DC    X'0000000000000000'
@NM00260 DC    X'0000000000000000'
@NM00261 DC    X'0000000000000000'
@NM00262 DC    X'0000000000000000'
@NM00263 DC    X'0000000000000000'
@NM00264 DC    X'0000000000000000'
@NM00265 DC    X'0000000000000000'
@NM00266 DC    X'0000000000000000'
@NM00267 DC    X'0000000000000000'
@NM00268 DC    X'0000000000000000'
@NM00269 DC    X'0000000000000000'
@NM00270 DC    X'0000000000000000'
@NM00271 DC    X'0000000000000000'
@NM00272 DC    X'0000000000000000'
@NM00273 DC    X'0000000000000000'
@NM00274 DC    X'0000000000000000'
@NM00275 DC    X'0000000000000000'
@NM00276 DC    X'0000000000000000'
@NM00277 DC    X'0000000000000000'
@NM00278 DC    X'0000000000000000'
@NM00279 DC    X'0000000000000000'
@NM00280 DC    X'0000000000000000'
@NM00281 DC    X'0000000000000000'
         ORG   CNTRLTAB+256
         DS    CL3
CONSAREA DS    CL28
         ORG   CONSAREA
CSECTNME DC    CL8'IKTTOMRT'
FRRNAME  DC    CL8'IKTIOFRR'
LOADNAME DC    CL8'IKTIOM01'
REASONCD DC    XL4'102'
         ORG   CONSAREA+28
PATCH    DC    130F'0'
IKTTOMRT CSECT
DUMMYRPL RPL   AM=VTAM,                                               CC
               STYPE=REQ,                                             CC
               OPTCD=(CS,SYN,SPEC,Q),                                 CC
               BRANCH=YES
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKTTOMRT CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
BASEREGA EQU   @08
BASEREGB EQU   @09
BASEREGC EQU   @10
TOMWREG  EQU   @13
RTOMW    EQU   @01
WRK2     EQU   @02
WRK3     EQU   @03
REGPARM  EQU   @05
FRRPTR   EQU   @06
RPLREG   EQU   @07
TVWAREG  EQU   @11
TSBREG   EQU   @12
BRNCHREG EQU   @14
GENRC    EQU   @15
RTNCDE   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
ASCBREG  EQU   @07
REG10    EQU   @10
REG11    EQU   @11
REG3     EQU   @03
REG5     EQU   @05
REG6     EQU   @06
TCBREG   EQU   @04
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
FLCCVT   EQU   FLCICCW2
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
PSALSFCC EQU   PSA+1012
CVTMAP   EQU   0
CVT      EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVT0PT01 EQU   CVTMAP+152
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTABEND EQU   CVTMAP+200
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTSHS   EQU   CVTXTNT2+40
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLDACB  EQU   RPLCOMN+24
RPLAREA  EQU   RPLCOMN+32
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLOPT4  EQU   RPLOPTCD+3
RPLNXTRP EQU   RPLCOMN+44
RPLRLEN  EQU   RPLCOMN+48
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
RPLNIB   EQU   RPLEXTD1
RPLVTEXT EQU   IFGRPL+76
RPLFDBK2 EQU   RPLVTEXT+12
RPLSSNSI EQU   RPLFDBK2
RPLDSB   EQU   RPLSSNSI
RPLDSB1  EQU   RPLDSB
RPLSSEI  EQU   RPLDSB1
RPLDSB2  EQU   RPLDSB+1
RPLUSNSI EQU   RPLFDBK2+2
RPLUSFLD EQU   RPLVTEXT+16
RPLOPTC3 EQU   RPLVTEXT+20
RPLOPT9  EQU   RPLOPTC3
RPLOPT10 EQU   RPLOPTC3+1
RPLOPT11 EQU   RPLOPTC3+2
RPLOPT12 EQU   RPLOPTC3+3
RPLFMHDR EQU   RPLOPT12
RPLOSENS EQU   RPLVTEXT+24
RPLSSNSO EQU   RPLOSENS
RPLSSEO  EQU   RPLSSNSO
RPLOF16  EQU   0
RPLRH3   EQU   RPLOF16
RPLCSI   EQU   RPLRH3
RPLSRTYP EQU   RPLOF16+1
RPLSTYPE EQU   RPLSRTYP
RPLRTYPE EQU   RPLSRTYP
RPLRRESP EQU   RPLRTYPE
RPLNFSYN EQU   RPLRTYPE
RPLDFASY EQU   RPLRTYPE
RPLCHN   EQU   RPLOF16+2
RPLVTFL1 EQU   RPLOF16+3
RPLVTFL2 EQU   RPLOF16+4
RPLPOSTV EQU   RPLVTFL2
RPLRESP  EQU   RPLVTFL2
RPLCNTRL EQU   RPLOF16+5
RPLCNTDF EQU   RPLCNTRL
RPLCNTDC EQU   RPLCNTRL+1
RPLCNTSC EQU   RPLCNTRL+2
RPLOF60  EQU   0
RPLOBSQ  EQU   RPLOF60+4
RPLIBSQ  EQU   RPLOF60+5
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBASID EQU   ASCB+36
ASCBTSB  EQU   ASCB+60
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBASXB EQU   ASCB+108
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
ASXB     EQU   0
ASXBMPST EQU   ASXB+16
ASXBAEQ  EQU   ASXB+168
ASXBCASW EQU   ASXB+216
ASXBCRB1 EQU   ASXBCASW
FRRS     EQU   0
FRRSHEAD EQU   FRRS
FRRSEMP  EQU   FRRSHEAD
FRRSLAST EQU   FRRSHEAD+4
FRRSELEN EQU   FRRSHEAD+8
FRRSCURR EQU   FRRSHEAD+12
FRRSENTR EQU   0
FRRSFRRA EQU   FRRSENTR
FRRSFLGS EQU   FRRSENTR+4
FRRSFLG1 EQU   FRRSFLGS
FRRSPARM EQU   FRRSENTR+8
SCVTSECT EQU   0
SCVTSTAT EQU   SCVTSECT+148
SRBSECT  EQU   0
SRBFLC   EQU   SRBSECT+12
WSAG     EQU   0
TSB      EQU   0
TSBASCBA EQU   TSB
TSBSTAT  EQU   TSBASCBA
TSBFLG1  EQU   TSB+4
TSBIFLSH EQU   TSBFLG1
TSBLNSZ  EQU   TSB+8
TSBFLG2  EQU   TSB+16
TSBAUTON EQU   TSBFLG2
TSBAULST EQU   TSBFLG2
TSBSTAUT EQU   TSBFLG2
TSBFLG3  EQU   TSB+24
TSBSPIT  EQU   TSBFLG3
TSBFLG5  EQU   TSB+25
TSBTERMC EQU   TSB+26
TSBTERM1 EQU   TSBTERMC
TSBTERM2 EQU   TSBTERMC+1
TSBSTCC  EQU   TSB+34
TSBFLG4  EQU   TSB+41
TSBIWAIT EQU   TSBFLG4
TSBOWAIT EQU   TSBFLG4
TSBAUTOS EQU   TSB+48
TSBRCB   EQU   TSB+64
TSBLINKA EQU   TSBRCB+4
TSBTPOST EQU   TSB+72
TSBTPFLG EQU   TSBTPOST
TSBMINL  EQU   TSB+84
TSBEXTNT EQU   TSB+96
TSBX     EQU   0
TSBXFLG1 EQU   TSBX+32
TSBXASCI EQU   TSBXFLG1
TSBXTVWA EQU   TSBX+36
TSBXTERM EQU   TSBX+72
IKTFRPRM EQU   0
FRPCKINF EQU   IKTFRPRM
FRPCONST EQU   IKTFRPRM+4
FRPRETRY EQU   IKTFRPRM+8
FRPXITPT EQU   IKTFRPRM+12
FRPRPLAD EQU   IKTFRPRM+16
FRPFRFLG EQU   IKTFRPRM+20
FRPOMNGR EQU   FRPFRFLG
IKTFRRWA EQU   0
FRWACKPT EQU   IKTFRRWA
FRWARTRY EQU   IKTFRRWA+8
FRWAEXIT EQU   IKTFRRWA+16
FRWACKRG EQU   IKTFRRWA+24
FRWAEXRG EQU   IKTFRRWA+88
FRWAFLGS EQU   IKTFRRWA+152
FRWAFL1  EQU   FRWAFLGS
IKTLTCB  EQU   0
LTCBFLAG EQU   IKTLTCB+3
LTCBIOER EQU   LTCBFLAG
TCAST    EQU   0
TCASUSER EQU   TCAST+4
TCASMSGS EQU   TCAST+52
TCASFRR  EQU   TCAST+56
TCASOQM  EQU   TCAST+76
TCASEXIT EQU   TCAST+80
TCASFLG1 EQU   TCAST+88
TCASFLG2 EQU   TCAST+89
TVWA     EQU   0
TVWATOMW EQU   TVWA+12
TVWATOPQ EQU   TVWA+16
TVWACHNL EQU   TVWA+84
TVWAATTN EQU   TVWA+85
TVWATQL1 EQU   TVWA+86
TVWAACB  EQU   TVWA+88
TVWANIB  EQU   TVWA+92
TVWAFLG7 EQU   TVWA+110
TVWATOBB EQU   TVWAFLG7
TVWAECBL EQU   TVWA+120
TVWADLST EQU   TVWA+132
TVWAFLG1 EQU   TVWA+144
TVWATIS  EQU   TVWAFLG1
TVWATAS  EQU   TVWAFLG1
TVWATID  EQU   TVWAFLG1
TVWALTE  EQU   TVWAFLG1
TVWAOOPS EQU   TVWAFLG1
TVWAFLG2 EQU   TVWA+145
TVWABFC  EQU   TVWAFLG2
TVWASCD  EQU   TVWAFLG2
TVWAGERR EQU   TVWAFLG2
TVWAERMG EQU   TVWAFLG2
TVWABKMG EQU   TVWAFLG2
TVWARTRY EQU   TVWAFLG2
TVWABIR  EQU   TVWAFLG2
TVWAFLG3 EQU   TVWA+146
TVWABRIN EQU   TVWAFLG3
TVWAAIGN EQU   TVWAFLG3
TVWATRAN EQU   TVWAFLG3
TVWAFLG4 EQU   TVWA+147
TVWADOOQ EQU   TVWAFLG4
TVWARCRS EQU   TVWAFLG4
TVWAFLG5 EQU   TVWA+150
TVWATIR  EQU   TVWAFLG5
TVWATABO EQU   TVWA+156
TVWAATBO EQU   TVWA+172
TVWAFLG6 EQU   TVWA+182
TVWAISYS EQU   TVWAFLG6
TVWAIOP  EQU   TVWAFLG6
TVWAINB  EQU   TVWAFLG6
TVWAFRWO EQU   TVWA+188
ISTPAB   EQU   0
PABWQCHN EQU   ISTPAB
PABWEQA  EQU   PABWQCHN
PABCHAIN EQU   PABWQCHN+4
PABRPHFG EQU   ISTPAB+12
PABFLAGS EQU   PABRPHFG
PABERLCK EQU   PABFLAGS
PABERRLK EQU   PABERLCK
ISTDYPAB EQU   0
ISTMPST  EQU   0
MPSRSV07 EQU   ISTMPST+4
MPSTSOIW EQU   MPSRSV07
MPSTSOIR EQU   MPSRSV07
MPSRQUE  EQU   ISTMPST+8
MPSFLGA  EQU   ISTMPST+12
MPSCRA   EQU   ISTMPST+24
MPSCRACT EQU   MPSCRA+4
MPSSRB   EQU   ISTMPST+32
MPSSRBCT EQU   MPSSRB+4
MPSCRPL  EQU   ISTMPST+40
MPSRPLCT EQU   MPSCRPL+4
ISTPROCD EQU   0
PROPROC  EQU   ISTPROCD
PROPROC1 EQU   PROPROC
PROPROC2 EQU   PROPROC+1
PROPROC3 EQU   PROPROC+2
PROPROC4 EQU   PROPROC+3
PROPROCS EQU   0
PROSETMS EQU   PROPROCS+1
PROSETM2 EQU   PROSETMS
PROSETM3 EQU   PROSETMS+1
PROSETM4 EQU   PROSETMS+2
ISTDEVCH EQU   0
DEVSHCH  EQU   ISTDEVCH
DEVCHAR  EQU   DEVSHCH
DEVTCODE EQU   ISTDEVCH+1
DEVFLAGS EQU   ISTDEVCH+3
DEVFCCTL EQU   DEVFLAGS
DEVCHAR3 EQU   DEVFLAGS
ISTNIB   EQU   0
NIBCID   EQU   ISTNIB+4
NIBFLGS  EQU   ISTNIB+40
NIBFLG1  EQU   NIBFLGS
WORKAREA EQU   320
OPARMS   EQU   WORKAREA
OPBUFADR EQU   OPARMS
OPREQ    EQU   OPARMS+4
OPRC     EQU   OPARMS+5
OPBFSZ   EQU   OPARMS+6
OPFLAGS  EQU   OPARMS+8
OPOPTNS  EQU   OPFLAGS+1
OPHOLD   EQU   OPOPTNS
OPBRK    EQU   OPOPTNS
OPEDIT   EQU   OPOPTNS
OPASID   EQU   OPOPTNS
OPNXBFSZ EQU   OPARMS+14
OPNXFLGS EQU   OPARMS+16
OPNXBRK  EQU   OPNXFLGS+1
OPNXEDIT EQU   OPNXFLGS+1
OPNXASID EQU   OPNXFLGS+1
BUFPTR   EQU   WORKAREA+20
OPARMSA  EQU   WORKAREA+28
BYTECNTA EQU   WORKAREA+32
BUFPTRA  EQU   WORKAREA+36
RUADDR   EQU   WORKAREA+40
CHARCNTA EQU   WORKAREA+44
BITVALA  EQU   WORKAREA+48
@NM00141 EQU   WORKAREA+52
LASTPARM EQU   @NM00141
TSBADDR  EQU   @NM00141+1
WKSP     EQU   WORKAREA+56
RU       EQU   WORKAREA+312
PACKAREA EQU   WORKAREA+568
UNPKAREA EQU   WORKAREA+576
@NM00143 EQU   UNPKAREA+7
NIB1     EQU   @NM00143
NIB2     EQU   @NM00143
NIB3     EQU   @NM00143
NIB4     EQU   @NM00143
INDICES  EQU   WORKAREA+584
I        EQU   INDICES
L        EQU   INDICES+4
R        EQU   INDICES+8
ESTIMATE EQU   WORKAREA+596
SIZE     EQU   WORKAREA+600
BYTECNT  EQU   WORKAREA+604
CHARCNT  EQU   WORKAREA+608
LIMIT    EQU   WORKAREA+612
CNT      EQU   WORKAREA+616
RETRY    EQU   WORKAREA+625
CHAINSZE EQU   WORKAREA+626
RUCOUNT  EQU   WORKAREA+627
BITVAR   EQU   WORKAREA+628
SRPLCHN  EQU   BITVAR
BITVALU0 EQU   BITVAR+1
MOR      EQU   BITVALU0
HLD      EQU   BITVALU0
FCNERR   EQU   BITVALU0
PARMERR  EQU   BITVALU0
RETRYMSG EQU   BITVALU0
XIT      EQU   BITVALU0
BITVAL00 EQU   BITVAR+2
BRK      EQU   BITVAL00
XC       EQU   BITVAL00
NXC      EQU   BITVAL00
MORMSGS  EQU   BITVAL00
ERMG     EQU   BITVAL00
SKIP     EQU   BITVAL00
BYPASS   EQU   BITVAL00
BITVALU1 EQU   BITVAR+3
PSENT    EQU   BITVALU1
MSG      EQU   BITVALU1
TSTPRMPT EQU   BITVALU1
AGAIN    EQU   BITVALU1
MORBITS  EQU   BITVAR+4
SEVENT   EQU   MORBITS
OUTOFRNG EQU   MORBITS
NORMEDIT EQU   MORBITS
TIME1    EQU   MORBITS
NEC      EQU   MORBITS
REPEAT   EQU   MORBITS
CHK      EQU   MORBITS
HELPBITS EQU   BITVAR+5
PROMPT   EQU   HELPBITS
SWNL     EQU   HELPBITS
SPEC     EQU   HELPBITS
SIGSENT  EQU   HELPBITS
SENDPRMT EQU   HELPBITS
NOTNOW   EQU   HELPBITS
SAVE14   EQU   WORKAREA+636
INFODSCT EQU   0
INFOREGS EQU   INFODSCT
INFOADDR EQU   INFODSCT+4
@NM00283 EQU   0
MSGSIZE  EQU   @NM00283
MSGDATA  EQU   @NM00283+2
MSGADR   EQU   0
ASCIITAB EQU   0
BUFFER   EQU   0
IKTIOFRR EQU   0
IKTQMOUT EQU   0
MESSAGE  EQU   0
STATUS   EQU   0
USRTRANS EQU   0
IKTEXIT  EQU   0
ISTRPL   EQU   0
POST     EQU   0
CVTPTR   EQU   FLCCVT
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTOPTE  EQU   CVTS01+188
CVTSPSA  EQU   CVTS01+336
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
CVTTCASP EQU   CVTS01+664
FLC      EQU   PSA
PSARSVTE EQU   PSARSVT
PSACSTK  EQU   PSARSVTE
ASXBPTR  EQU   ASCBASXB
CHARPRMT EQU   TSBAUTOS
SRB      EQU   SRBSECT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTIRM   EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00152 EQU   BITVAR+6
@NM00151 EQU   HELPBITS
@NM00150 EQU   MORBITS
@NM00149 EQU   BITVALU1
@NM00148 EQU   BITVAL00
@NM00147 EQU   BITVALU0
@NM00146 EQU   WORKAREA+624
@NM00145 EQU   WORKAREA+620
@NM00144 EQU   @NM00143
@NM00142 EQU   UNPKAREA
@NM00140 EQU   WORKAREA+24
@NM00139 EQU   OPNXFLGS+3
@NM00138 EQU   OPNXFLGS+2
@NM00137 EQU   OPNXFLGS+1
OPNXHOLD EQU   OPNXFLGS+1
@NM00136 EQU   OPNXFLGS
OPNXADTP EQU   OPNXFLGS
OPNXALC  EQU   OPNXFLGS
@NM00135 EQU   OPARMS+12
@NM00134 EQU   OPFLAGS+3
@NM00133 EQU   OPFLAGS+2
@NM00132 EQU   OPOPTNS
@NM00131 EQU   OPFLAGS
OPADTOP  EQU   OPFLAGS
OPALLOC  EQU   OPFLAGS
NIBRESV  EQU   ISTNIB+60
NIBNDAR  EQU   ISTNIB+56
NIBLMODE EQU   ISTNIB+48
NIBEXLST EQU   ISTNIB+44
NIBLIMIT EQU   ISTNIB+42
@NM00130 EQU   ISTNIB+41
@NM00129 EQU   NIBFLG1
@NM00128 EQU   NIBFLG1
@NM00127 EQU   NIBFLG1
@NM00126 EQU   NIBFLG1
NIBSHLTP EQU   NIBFLG1
NIBSDAPP EQU   NIBFLG1
NIBCON   EQU   NIBFLG1
NIBLAST  EQU   NIBFLG1
NIBPROCD EQU   ISTNIB+36
NIBDEVCH EQU   ISTNIB+28
NIBMODE  EQU   ISTNIB+20
NIBSYM   EQU   ISTNIB+12
NIBUSER  EQU   ISTNIB+8
NIBLEN   EQU   ISTNIB+3
NIBCONDN EQU   ISTNIB+2
NIBRSV01 EQU   ISTNIB+1
NIBID    EQU   ISTNIB
DEVRSV03 EQU   ISTDEVCH+5
DEVPHYSA EQU   ISTDEVCH+4
DEVCSLPN EQU   DEVCHAR3
DEVCSTCL EQU   DEVCHAR3
DEVCCHEK EQU   DEVCHAR3
DEVCATTN EQU   DEVCHAR3
DEVCSWL  EQU   DEVFCCTL
DEVCRVB  EQU   DEVFCCTL
DEVCSSL  EQU   DEVFCCTL
DEVCBSC  EQU   DEVFCCTL
DEVMCODE EQU   ISTDEVCH+2
DEVCHAR2 EQU   DEVTCODE
DEVRSV01 EQU   DEVCHAR
DEVCCTL  EQU   DEVCHAR
DEVNNSPT EQU   DEVCHAR
DEVSPS   EQU   DEVCHAR
DEVSUBND EQU   DEVCHAR
DEVCONVR EQU   DEVCHAR
DEVOTPUT EQU   DEVCHAR
DEVINPUT EQU   DEVCHAR
PROSRDEF EQU   PROSETM4
PRORSV47 EQU   PROSETM4
PROSCON  EQU   PROSETM4
PRORSV46 EQU   PROSETM3
PROSMONT EQU   PROSETM3
PRORSV45 EQU   PROSETM3
PROSNTO  EQU   PROSETM3
PRORSV44 EQU   PROSETM3
PRORSV43 EQU   PROSETM2
PROSNTFL EQU   PROSETM2
PRORSV42 EQU   PROSETM2
PRORSV41 EQU   PROPROCS
PROMODC  EQU   PROPROC4
PROMODT  EQU   PROPROC4
PROMODM  EQU   PROPROC4
PROMODB  EQU   PROPROC4
PRORSV14 EQU   PROPROC4
PRORSV13 EQU   PROPROC4
PRORSV12 EQU   PROPROC4
PROEIB   EQU   PROPROC4
PROMONT3 EQU   PROPROC3
PROMONT2 EQU   PROPROC3
PROMONIT EQU   PROPROC3
PROSUBLK EQU   PROPROC3
PRONTO   EQU   PROPROC3
PROLGIN  EQU   PROPROC3
PROERPI  EQU   PROPROC3
PRORSV07 EQU   PROPROC3
PROCFTX  EQU   PROPROC2
PROEMLC  EQU   PROPROC2
PRONTFL  EQU   PROPROC2
PRORSV05 EQU   PROPROC2
PRORSV04 EQU   PROPROC2
PROLGOT  EQU   PROPROC2
PROERPO  EQU   PROPROC2
PRORSV03 EQU   PROPROC2
PRORPLC  EQU   PROPROC1
PROCS    EQU   PROPROC1
PROCA    EQU   PROPROC1
PRORESPX EQU   PROPROC1
PRODFASY EQU   PROPROC1
PROXPOPT EQU   PROPROC1
PROTRUNC EQU   PROPROC1
PROASYIP EQU   PROPROC1
MPSSRB1  EQU   ISTMPST+172
MPSSAVE  EQU   ISTMPST+140
MPSMQLBP EQU   ISTMPST+136
MPSSYSRT EQU   ISTMPST+132
MPSQEL   EQU   ISTMPST+128
MPSDBTBL EQU   ISTMPST+124
MPSASCB  EQU   ISTMPST+120
MPSTPPAB EQU   ISTMPST+88
MPSSMPAB EQU   ISTMPST+56
MPSSMRPH EQU   ISTMPST+52
MPSSRB55 EQU   ISTMPST+48
MPSRPLAC EQU   MPSRPLCT+2
MPSRPLRC EQU   MPSRPLCT
MPSCRPLQ EQU   MPSCRPL
MPSSRBAC EQU   MPSSRBCT+2
MPSSRBRC EQU   MPSSRBCT
MPSSRBQ  EQU   MPSSRB
MPSCRAAC EQU   MPSCRACT+2
MPSCRARC EQU   MPSCRACT
MPSCRAQ  EQU   MPSCRA
MPSMPSTP EQU   ISTMPST+20
MPSPSTCT EQU   ISTMPST+16
MPSASID  EQU   MPSFLGA+2
MPSRSV02 EQU   MPSFLGA+1
MPSPSTAB EQU   MPSFLGA
MPSRSV01 EQU   MPSFLGA
MPSTPBU  EQU   MPSFLGA
MPMEMTRM EQU   MPSFLGA
MPSAUTH  EQU   MPSFLGA
MPSCRAO  EQU   MPSFLGA
MPSSRBO  EQU   MPSFLGA
MPSRQUEG EQU   MPSRQUE
MPSID    EQU   ISTMPST
DYPPAB   EQU   ISTDYPAB+16
DYPRSV01 EQU   ISTDYPAB+12
DYPTSKID EQU   ISTDYPAB+8
DYPCHAIN EQU   ISTDYPAB+4
DYPFLGS  EQU   ISTDYPAB+2
DYPLNGTH EQU   ISTDYPAB+1
DYPTYPE  EQU   ISTDYPAB
PABRPHA  EQU   PABRPHFG+1
PABNODQ  EQU   PABFLAGS
PABINHBT EQU   PABFLAGS
PABERLOK EQU   PABERRLK
PABSSN   EQU   PABFLAGS
PABDYNAM EQU   PABFLAGS
PABNORPR EQU   PABFLAGS
PABPRIOR EQU   PABFLAGS
PABAPYP  EQU   PABFLAGS
PABDVTA  EQU   ISTPAB+9
PABOFFST EQU   ISTPAB+8
PABCHNGP EQU   PABCHAIN+1
PABRSV02 EQU   PABCHAIN
PABDELAY EQU   PABCHAIN
PABRUNNG EQU   PABCHAIN
PABRESET EQU   PABCHAIN
PABUNCON EQU   PABCHAIN
PABCDP   EQU   PABCHAIN
PABRESCH EQU   PABCHAIN
PABCHNG  EQU   PABCHAIN
PABWEQP  EQU   PABWEQA+1
PABRSV01 EQU   PABWEQA
PABWEQG  EQU   PABWEQA
TVWAEND  EQU   TVWA+216
@NM00125 EQU   TVWA+208
TVWAUSRA EQU   TVWA+200
@NM00124 EQU   TVWA+192
TVWAFRWI EQU   TVWA+184
TVWARSHW EQU   TVWA+183
@NM00123 EQU   TVWAFLG6
TVWAFMEW EQU   TVWAFLG6
TVWARCDT EQU   TVWAFLG6
TVWAIOTR EQU   TVWAFLG6
@NM00122 EQU   TVWA+180
TVWAQMLB EQU   TVWA+176
TVWAATBI EQU   TVWA+168
TVWATRNM EQU   TVWA+160
TVWATABI EQU   TVWA+152
TVWALNCT EQU   TVWA+151
TVWAP1ST EQU   TVWAFLG5
TVWAPRMT EQU   TVWAFLG5
TVWANFSP EQU   TVWAFLG5
TVWAFSW  EQU   TVWAFLG5
TVWAWO   EQU   TVWAFLG5
TVWAFSM  EQU   TVWAFLG5
TVWASCAN EQU   TVWAFLG5
@NM00121 EQU   TVWA+148
TVWADARC EQU   TVWAFLG4
TVWAQMEV EQU   TVWAFLG4
TVWAFLSC EQU   TVWAFLG4
TVWANOFB EQU   TVWAFLG4
TVWAKBDL EQU   TVWAFLG4
TVWAFMSC EQU   TVWAFLG4
TVWATRDF EQU   TVWAFLG3
TVWAQLBU EQU   TVWAFLG3
TVWAQMIO EQU   TVWAFLG3
TVWAQMRT EQU   TVWAFLG3
TVWASDSG EQU   TVWAFLG3
TVWAPGN  EQU   TVWAFLG2
TVWAULK  EQU   TVWAFLG1
TVWAXSCD EQU   TVWAFLG1
TVWATOD  EQU   TVWAFLG1
TVWADIN3 EQU   TVWADLST+8
TVWADIN2 EQU   TVWADLST+4
TVWADIN1 EQU   TVWADLST
TVWAECB3 EQU   TVWAECBL+8
TVWAECB2 EQU   TVWAECBL+4
TVWAECB1 EQU   TVWAECBL
TVWATECB EQU   TVWA+116
TVWAECB  EQU   TVWA+112
TVWALNSV EQU   TVWA+111
@NM00120 EQU   TVWAFLG7
TVWACHSE EQU   TVWAFLG7
TVWARISW EQU   TVWAFLG7
TVWARET  EQU   TVWAFLG7
TVWARDBF EQU   TVWAFLG7
TVWASND1 EQU   TVWAFLG7
TVWABKPG EQU   TVWAFLG7
TVWAVSZ  EQU   TVWA+108
TVWAVST  EQU   TVWA+104
TVWAEXL  EQU   TVWA+100
TVWARPL  EQU   TVWA+96
TVWATQL2 EQU   TVWA+87
TVWALBUF EQU   TVWA+80
TVWAHBUF EQU   TVWA+76
TVWACLSZ EQU   TVWA+74
TVWARTR  EQU   TVWA+72
TVWAGMPT EQU   TVWA+68
TVWATCB  EQU   TVWA+64
TVWAUSMN EQU   TVWA+60
TVWACPID EQU   TVWA+56
TVWAEOQ  EQU   TVWA+52
TVWANOM  EQU   TVWA+48
TVWABOQ  EQU   TVWA+44
TVWAEIQ  EQU   TVWA+40
TVWANIM  EQU   TVWA+36
TVWABIQ  EQU   TVWA+32
TVWAQMWA EQU   TVWA+28
TVWALLWA EQU   TVWA+24
TVWABFPT EQU   TVWA+20
TVWATIMW EQU   TVWA+8
TVWAPPL  EQU   TVWA
TCASTEND EQU   TCAST+136
TCASDUMP EQU   TCAST+132
TCASSCHD EQU   TCAST+128
TCASTPND EQU   TCAST+124
TCASOMJR EQU   TCAST+120
@NM00119 EQU   TCAST+118
TCASBR14 EQU   TCAST+116
TCASATTN EQU   TCAST+112
TCASASCI EQU   TCAST+108
TCASTTQH EQU   TCAST+104
@NM00118 EQU   TCAST+102
@NM00117 EQU   TCAST+100
@NM00116 EQU   TCAST+98
@NM00115 EQU   TCAST+96
TCASASCB EQU   TCAST+92
@NM00114 EQU   TCAST+90
@NM00113 EQU   TCASFLG2
@NM00112 EQU   TCASFLG1
TCASNACT EQU   TCASFLG1
TCASVSD  EQU   TCASFLG1
TCASABND EQU   TCASFLG1
TCASMDSW EQU   TCASFLG1
TCASBKMD EQU   TCASFLG1
TCASLTE  EQU   TCAST+84
TCASIQM  EQU   TCAST+72
TCASTSB  EQU   TCAST+68
TCASTTL  EQU   TCAST+64
TCASWA   EQU   TCAST+60
TCASDATO EQU   TCAST+48
TCASDATI EQU   TCAST+44
TCASXECB EQU   TCAST+40
TCASTID  EQU   TCAST+32
@NM00111 EQU   TCAST+31
TCASCHNL EQU   TCAST+30
TCASCRSZ EQU   TCAST+28
TCASLBUF EQU   TCAST+24
TCASHBUF EQU   TCAST+20
TCASCLSZ EQU   TCAST+18
TCASRCON EQU   TCAST+16
TCASACBP EQU   TCAST+8
TCASUMAX EQU   TCASUSER+2
TCASUSEC EQU   TCASUSER
TCASID   EQU   TCAST
@NM00110 EQU   LTCBFLAG
LTCBRCUR EQU   LTCBFLAG
@NM00109 EQU   IKTLTCB
@NM00108 EQU   FRWAFLGS+1
@NM00107 EQU   FRWAFL1
FRWAPCRE EQU   FRWAFL1
@NM00106 EQU   IKTFRPRM+21
@NM00105 EQU   FRPFRFLG
FRPIMNGR EQU   FRPFRFLG
TSBXEND  EQU   TSBX+120
@NM00104 EQU   TSBX+116
TSBXBIND EQU   TSBX+80
TSBXRPL  EQU   TSBX+76
TSBXTMBF EQU   TSBXTERM+2
@NM00103 EQU   TSBXTERM+1
TSBXTMTP EQU   TSBXTERM
TSBXAIND EQU   TSBX+70
TSBXRSZO EQU   TSBX+69
TSBXRSZI EQU   TSBX+68
TSBXLBUF EQU   TSBX+64
TSBXCSAP EQU   TSBX+60
TSBXSRB  EQU   TSBX+56
TSBXSRBI EQU   TSBX+52
@NM00102 EQU   TSBX+48
TSBXTOM  EQU   TSBX+44
TSBXTIM  EQU   TSBX+40
@NM00101 EQU   TSBX+33
@NM00100 EQU   TSBXFLG1
TSBXWREC EQU   TSBXFLG1
TSBXLOGF EQU   TSBXFLG1
TSBXACTV EQU   TSBXFLG1
TSBXUID  EQU   TSBX+24
@NM00099 EQU   TSBX+16
@NM00098 EQU   TSBX+12
TSBXECB  EQU   TSBX+8
TSBXBCK  EQU   TSBX+4
TSBXFWD  EQU   TSBX
TSBEND   EQU   TSB+120
TSBSF1   EQU   TSB+112
TSBTRMID EQU   TSB+104
TSBALTC  EQU   TSB+103
TSBALTR  EQU   TSB+102
TSBPRMC  EQU   TSB+101
TSBPRMR  EQU   TSB+100
TSBPSWD  EQU   TSB+88
TSBLECB  EQU   TSBMINL
TSBLINE  EQU   TSB+82
TSBSTAX  EQU   TSB+81
TSBATTNC EQU   TSB+80
TSBF1V   EQU   TSBTPOST+7
TSBF1M   EQU   TSBTPOST+6
TSBF2V   EQU   TSBTPOST+5
TSBF2M   EQU   TSBTPOST+4
TSBFLAGV EQU   TSBTPOST+3
TSBFLAGM EQU   TSBTPOST+2
TSBSBASV EQU   TSBTPOST+1
@NM00097 EQU   TSBTPFLG
@NM00096 EQU   TSBTPFLG
@NM00095 EQU   TSBTPFLG
@NM00094 EQU   TSBTPFLG
TSBNEWID EQU   TSBTPFLG
TSBTPAYI EQU   TSBTPFLG
TSBTPQCB EQU   TSBTPFLG
TSBPOSTO EQU   TSBTPFLG
TSBLINKB EQU   TSBLINKA+1
TSBPRI   EQU   TSBLINKA
TSBRQCB  EQU   TSBRCB
TSBCTCB  EQU   TSB+60
TSBERSDS EQU   TSB+56
TSBAUTOI EQU   TSB+52
TSBATNCC EQU   TSB+44
TSBASRCE EQU   TSB+42
TSBHLDL  EQU   TSBFLG4
TSBGETBF EQU   TSBFLG4
TSBCANC  EQU   TSBFLG4
TSBHOLD  EQU   TSBFLG4
TSBHUNG  EQU   TSBFLG4
TSBOCAB  EQU   TSBFLG4
TSBLNNO  EQU   TSB+40
TSBATNTC EQU   TSB+38
TSBATNLC EQU   TSB+36
TSBCHDCC EQU   TSBSTCC+1
TSBLNDCC EQU   TSBSTCC
TSBWTJID EQU   TSB+32
TSBECB   EQU   TSB+28
TSBC1050 EQU   TSBTERM2
@NM00093 EQU   TSBTERM2
@NM00092 EQU   TSBTERM2
@NM00091 EQU   TSBTERM2
@NM00090 EQU   TSBTERM2
TSBCTWX  EQU   TSBTERM2
@NM00089 EQU   TSBTERM2
@NM00088 EQU   TSBTERM2
@NM00087 EQU   TSBTERM1
@NM00086 EQU   TSBTERM1
@NM00085 EQU   TSBTERM1
TSBC2741 EQU   TSBTERM1
TSBC5041 EQU   TSBTERM1
TSBCATTN EQU   TSBTERM1
TSBCBRK  EQU   TSBTERM1
TSBCIHBN EQU   TSBTERM1
TSBVTAM  EQU   TSBFLG5
TSBKEYS  EQU   TSBFLG5
@NM00084 EQU   TSBFLG5
TSBATMP  EQU   TSBFLG5
TSBNFLOP EQU   TSBFLG3
TSBNOBRK EQU   TSBFLG3
TSBTPUT  EQU   TSBFLG3
TSBAWOIP EQU   TSBFLG3
TSBNBKSP EQU   TSBFLG3
TSBTJMSG EQU   TSBFLG3
TSBATTN  EQU   TSBFLG3
TSBIBFP  EQU   TSB+21
TSBNIBF  EQU   TSB+20
TSBITBFP EQU   TSB+17
TSBSATN2 EQU   TSBFLG2
TSBSATN1 EQU   TSBFLG2
TSBAUTOC EQU   TSBFLG2
TSBBRKIN EQU   TSBFLG2
TSBBIPI  EQU   TSBFLG2
TSBOBFP  EQU   TSB+13
TSBNOBF  EQU   TSB+12
TSBOTBFP EQU   TSB+9
TSBWTCB  EQU   TSB+5
TSBTJBF  EQU   TSBFLG1
TSBTJIP  EQU   TSBFLG1
TSBTJOW  EQU   TSBFLG1
TSBWOWIP EQU   TSBFLG1
TSBOWIP  EQU   TSBFLG1
TSBOFLSH EQU   TSBFLG1
TSBANSR  EQU   TSBFLG1
TSBASCB  EQU   TSBASCBA+1
TSBATNLD EQU   TSBSTAT
TSB3270  EQU   TSBSTAT
TSBDISC  EQU   TSBSTAT
TSBITOFF EQU   TSBSTAT
TSBNOBUF EQU   TSBSTAT
TSBDSPLY EQU   TSBSTAT
TSBLWAIT EQU   TSBSTAT
TSBINUSE EQU   TSBSTAT
WSAGSCHE EQU   WSAG+40
WSAGREST EQU   WSAG+36
WSAGNQDQ EQU   WSAG+32
WSAGMEMT EQU   WSAG+28
WSAGOPTM EQU   WSAG+24
WSAGSTAT EQU   WSAG+20
WSAGEMS0 EQU   WSAG+16
WSAGSSRS EQU   WSAG+12
WSAGRSM  EQU   WSAG+8
WSAGGMFM EQU   WSAG+4
WSAGPGIO EQU   WSAG
@NM00083 EQU   SRBSECT+40
@NM00082 EQU   SRBSECT+38
SRBPRIOR EQU   SRBSECT+37
SRBPKF   EQU   SRBSECT+36
SRBSAVE  EQU   SRBSECT+32
SRBPARM  EQU   SRBSECT+28
SRBRMTR  EQU   SRBSECT+24
SRBEP    EQU   SRBSECT+20
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBASCB  EQU   SRBSECT+8
SRBFLNK  EQU   SRBSECT+4
SRBID    EQU   SRBSECT
@NM00081 EQU   SCVTSECT+180
@NM00080 EQU   SCVTSECT+176
SCVTPIQE EQU   SCVTSECT+172
@NM00079 EQU   SCVTSECT+168
SCVTPTRM EQU   SCVTSECT+164
@NM00078 EQU   SCVTSECT+160
@NM00077 EQU   SCVTSECT+156
SCVTQCBR EQU   SCVTSECT+152
@NM00076 EQU   SCVTSECT+144
SCVTTQE  EQU   SCVTSECT+140
@NM00075 EQU   SCVTSECT+136
SCVTSVCT EQU   SCVTSECT+132
@NM00074 EQU   SCVTSECT+128
@NM00073 EQU   SCVTSECT+124
SCVTRXLQ EQU   SCVTSECT+120
@NM00072 EQU   SCVTSECT+116
SCVTCTCB EQU   SCVTSECT+112
@NM00071 EQU   SCVTSECT+108
@NM00070 EQU   SCVTSECT+104
@NM00069 EQU   SCVTSECT+100
@NM00068 EQU   SCVTSECT+96
SCVTCOMM EQU   SCVTSECT+92
@NM00067 EQU   SCVTSECT+88
@NM00066 EQU   SCVTSECT+84
@NM00065 EQU   SCVTSECT+80
@NM00064 EQU   SCVTSECT+76
@NM00063 EQU   SCVTSECT+72
SCVTGMBR EQU   SCVTSECT+68
SCVTRPTR EQU   SCVTSECT+64
SCVTHSKP EQU   SCVTSECT+60
@NM00062 EQU   SCVTSECT+56
@NM00061 EQU   SCVTSECT+52
SCVTLFRM EQU   SCVTSECT+48
SCVTCDCL EQU   SCVTSECT+44
@NM00060 EQU   SCVTSECT+40
SCVTRACE EQU   SCVTSECT+36
@NM00059 EQU   SCVTSECT+32
SCVTRMBR EQU   SCVTSECT+28
@NM00058 EQU   SCVTSECT+24
@NM00057 EQU   SCVTSECT+20
@NM00056 EQU   SCVTSECT+16
@NM00055 EQU   SCVTSECT+14
SCVTBR14 EQU   SCVTSECT+12
SCVTSPET EQU   SCVTSECT+8
SCVTPGWR EQU   SCVTSECT+4
SCVTPGTM EQU   SCVTSECT
@NM00054 EQU   FRRSFLGS+1
@NM00053 EQU   FRRSFLG1
FRRSRCUR EQU   FRRSFLG1
FRRSENTS EQU   FRRS+84
FRRSRTMW EQU   FRRS+16
ASXBEND  EQU   ASXB+232
ASXBRV25 EQU   ASXB+228
ASXBRV24 EQU   ASXB+224
ASXBPT0E EQU   ASXB+220
ASXBCRB4 EQU   ASXBCASW+3
ASXBCRB3 EQU   ASXBCASW+2
ASXBCRB2 EQU   ASXBCASW+1
ASXBCR06 EQU   ASXBCRB1
ASXBCR05 EQU   ASXBCRB1
ASXBCR04 EQU   ASXBCRB1
ASXBCR03 EQU   ASXBCRB1
ASXBCR02 EQU   ASXBCRB1
ASXBCR01 EQU   ASXBCRB1
ASXBTFD  EQU   ASXBCRB1
ASXBPIP  EQU   ASXBCRB1
ASXBCTDC EQU   ASXB+212
ASXBTDCB EQU   ASXB+208
ASXBRV19 EQU   ASXB+204
ASXBRV18 EQU   ASXB+200
ASXBRV17 EQU   ASXB+196
ASXBRV16 EQU   ASXB+192
ASXBLSRB EQU   ASXBAEQ+20
ASXBFSRB EQU   ASXBAEQ+16
ASXBLRQE EQU   ASXBAEQ+12
ASXBFRQE EQU   ASXBAEQ+8
ASXBLIQE EQU   ASXBAEQ+4
ASXBFIQE EQU   ASXBAEQ
ASXBETSK EQU   ASXB+164
ASXBSIRB EQU   ASXB+160
ASXBPSWD EQU   ASXB+152
ASXBPRG  EQU   ASXB+136
ASXBRV26 EQU   ASXB+132
ASXBOUSB EQU   ASXB+128
ASXBDDR  EQU   ASXB+124
ASXBRCTD EQU   ASXB+120
ASXBRSMD EQU   ASXB+116
ASXBSPSA EQU   ASXB+112
ASXBFRWA EQU   ASXB+108
ASXBFLSA EQU   ASXB+36
ASXBIHSA EQU   ASXB+32
ASXBRV15 EQU   ASXB+28
ASXBRV14 EQU   ASXB+24
ASXBLWA  EQU   ASXB+20
ASXBRS00 EQU   ASXB+14
ASXBTCBS EQU   ASXB+12
ASXBLTCB EQU   ASXB+8
ASXBFTCB EQU   ASXB+4
ASXBASXB EQU   ASXB
ASXBEGIN EQU   ASXB
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
RPLSEQNO EQU   RPLOF60+6
@NM00028 EQU   RPLIBSQ
RPLIINV  EQU   RPLIBSQ
RPLINEG  EQU   RPLIBSQ
RPLIPOS  EQU   RPLIBSQ
RPLIIGN  EQU   RPLIBSQ
RPLIRSET EQU   RPLIBSQ
RPLITST  EQU   RPLIBSQ
RPLISET  EQU   RPLIBSQ
@NM00027 EQU   RPLOBSQ
RPLOINV  EQU   RPLOBSQ
RPLONEG  EQU   RPLOBSQ
RPLOPOS  EQU   RPLOBSQ
RPLOIGN  EQU   RPLOBSQ
RPLORSET EQU   RPLOBSQ
RPLOTST  EQU   RPLOBSQ
RPLOSET  EQU   RPLOBSQ
RPLIBSQV EQU   RPLOF60+2
RPLOBSQV EQU   RPLOF60
@NM00026 EQU   RPLCNTSC
RPLRSHUT EQU   RPLCNTSC
RPLRQR   EQU   RPLCNTSC
RPLSHUTC EQU   RPLCNTSC
RPLSHUTD EQU   RPLCNTSC
RPLSTSN  EQU   RPLCNTSC
RPLCLEAR EQU   RPLCNTSC
RPLSDT   EQU   RPLCNTSC
@NM00025 EQU   RPLCNTDC
RPLSIGNL EQU   RPLCNTDC
RPLLUS   EQU   RPLCNTDC
RPLRTR   EQU   RPLCNTDC
RPLBID   EQU   RPLCNTDC
@NM00024 EQU   RPLCNTDF
RPLQI    EQU   RPLCNTDF
RPLRELQ  EQU   RPLCNTDF
RPLCHASE EQU   RPLCNTDF
RPLQEC   EQU   RPLCNTDF
RPLQC    EQU   RPLCNTDF
RPLCNCEL EQU   RPLCNTDF
RPLDATA  EQU   RPLCNTDF
RPLRRN   EQU   RPLRESP
RPLNFME  EQU   RPLRESP
RPLEX    EQU   RPLRESP
@NM00023 EQU   RPLRESP
@NM00022 EQU   RPLPOSTV
RPLSCHED EQU   RPLPOSTV
@NM00021 EQU   RPLVTFL1
RPLAUTUS EQU   RPLVTFL1
RPLVTUSE EQU   RPLVTFL1
@NM00020 EQU   RPLVTFL1
@NM00019 EQU   RPLCHN
RPLONLY  EQU   RPLCHN
RPLLAST  EQU   RPLCHN
RPLMIDLE EQU   RPLCHN
RPLFIRST EQU   RPLCHN
@NM00018 EQU   RPLRTYPE
@NM00017 EQU   RPLSTYPE
RPLSRESP EQU   RPLSTYPE
@NM00016 EQU   RPLRH3
RPLCHREQ EQU   RPLRH3
RPLCMD   EQU   RPLRH3
RPLEB    EQU   RPLRH3
RPLBB    EQU   RPLRH3
RPLSIGDA EQU   RPLVTEXT+32
RPLSAV13 EQU   RPLVTEXT+28
RPLUSNSO EQU   RPLOSENS+2
RPLSSMO  EQU   RPLSSNSO+1
@NM00015 EQU   RPLSSEO
RPLRRO   EQU   RPLSSEO
RPLFIO   EQU   RPLSSEO
RPLSTATO EQU   RPLSSEO
RPLCPMO  EQU   RPLSSEO
@NM00014 EQU   RPLSSEO
@NM00013 EQU   RPLOPT12
@NM00012 EQU   RPLOPT12
@NM00011 EQU   RPLOPT12
RPLNIBTK EQU   RPLOPT12
RPLTRUNC EQU   RPLOPT12
RPLKEEP  EQU   RPLOPT12
@NM00010 EQU   RPLOPT12
RPLRSVE8 EQU   RPLOPT11
RPLRSVE7 EQU   RPLOPT11
RPLRSVE6 EQU   RPLOPT11
RPLRSVE5 EQU   RPLOPT11
RPLRSVE4 EQU   RPLOPT11
RPLSTOP  EQU   RPLOPT11
RPLSTART EQU   RPLOPT11
RPLQUIES EQU   RPLOPT11
RPLRSVI6 EQU   RPLOPT10
RPLRSVI5 EQU   RPLOPT10
RPLRSVI4 EQU   RPLOPT10
RPLRSVI3 EQU   RPLOPT10
RPLRSVI2 EQU   RPLOPT10
RPLSPARM EQU   RPLOPT10
RPLDSPLY EQU   RPLOPT10
RPLBSCID EQU   RPLOPT10
RPLTOPL  EQU   RPLOPT9
RPLCIDE  EQU   RPLOPT9
RPLRNNM  EQU   RPLOPT9
RPLAPPST EQU   RPLOPT9
RPLCOUNT EQU   RPLOPT9
RPLTERMS EQU   RPLOPT9
RPLDEVCH EQU   RPLOPT9
RPLLOGON EQU   RPLOPT9
RPLESR2  EQU   RPLUSNSI+1
RPLESR1  EQU   RPLUSNSI
RPLSSMI  EQU   RPLDSB2
@NM00009 EQU   RPLSSEI
RPLRRI   EQU   RPLSSEI
RPLFII   EQU   RPLSSEI
RPLSTATI EQU   RPLSSEI
RPLCPMI  EQU   RPLSSEI
RPLPATHI EQU   RPLSSEI
RPLARCLN EQU   RPLVTEXT+8
RPLAARLN EQU   RPLVTEXT+4
RPLAAREA EQU   RPLVTEXT
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
@NM00008 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00007 EQU   RPLRBAR+3
@NM00006 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLTCRNO EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
@NM00005 EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLCHAIN EQU   RPLNXTRP
RPLBOP   EQU   RPLOPT4
@NM00004 EQU   RPLOPT4
RPLMKFRM EQU   RPLOPT4
RPLENDTR EQU   RPLOPT4
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
@NM00003 EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLTCBPT EQU   RPLCOMN+28
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLERREG EQU   RPLRTNCD
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00002 EQU   CVTFIX+248
@NM00001 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTSHSB  EQU   CVTSHS
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
@NM00052 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00051 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00050 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00049 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSARV011 EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSARV063 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00048 EQU   FLCFSA
@NM00047 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00046 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00045 EQU   FLCIOA
@NM00044 EQU   FLCMCLA+15
@NM00043 EQU   FLCMCLA+14
@NM00042 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00041 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00040 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00039 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00038 EQU   FLCPER
@NM00037 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00036 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00035 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00034 EQU   FLCPIILC
@NM00033 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00032 EQU   FLCSVILC
@NM00031 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00030 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00029 EQU   FLCICCW2+4
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00216 EQU   @RC00207
@RC00268 EQU   @RC00267
@RC00361 EQU   @RC00358
@RT00287 EQU   @EL00004
@RC00319 EQU   @EL00004
@RC00408 EQU   @RC00402
@RC00403 EQU   @RC00402
@RC00451 EQU   @RC00437
@RC00445 EQU   @RC00437
@RC00438 EQU   @RC00437
@RC00429 EQU   @EL00005
@RC00554 EQU   @EL00006
@RT00552 EQU   @EL00006
@RT00578 EQU   @EL00007
@RC00585 EQU   @EL00007
@RC00583 EQU   @EL00007
@RC00664 EQU   @EL00010
@RC00728 EQU   @RC00727
@RC00740 EQU   @RC00739
@RC00792 EQU   @RC00787
@RC00815 EQU   @RC00812
@RC00828 EQU   @RC00827
@RC00908 EQU   @EL00015
@RC00945 EQU   @RC00938
@RC00943 EQU   @RC00938
@RC00941 EQU   @RC00938
@RC00939 EQU   @RC00938
@RC00988 EQU   @EL00019
@RC00983 EQU   @EL00019
@RC00981 EQU   @EL00019
@RC00974 EQU   @EL00019
@RC00972 EQU   @EL00019
@RC00970 EQU   @EL00019
@RC00968 EQU   @EL00019
@RC00997 EQU   @EL00020
@RC01016 EQU   @EL00021
@RC01039 EQU   @EL00022
@RC01027 EQU   @EL00022
@RC01046 EQU   @EL00022
@RC01078 EQU   @EL00023
@RC01091 EQU   @EL00024
@RC01116 EQU   @EL00025
@RC01162 EQU   @EL00028
@RT01160 EQU   @EL00028
@PB00032 EQU   @PB00033
@RT00269 EQU   @RC00268
@RC00327 EQU   @RC00319
@RC00409 EQU   @RC00408
@RT00562 EQU   @RC00554
@RT00567 EQU   @RC00554
@RC00665 EQU   @RC00664
@RC00669 EQU   @RC00664
@RC00795 EQU   @RC00792
@RC00793 EQU   @RC00792
@RT01030 EQU   @RC01027
@RC01052 EQU   @RC01046
@RT01094 EQU   @RC01091
@RC01163 EQU   @RC01162
@PB00031 EQU   @PB00032
@RC01167 EQU   @RC01163
@PB00030 EQU   @PB00031
@PB00029 EQU   @PB00030
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKTTOMRT,(C'PLS1953',0701,78045)

         TITLE 'ICB2MSG: MSSC MESSAGE TASK                             *
                        '
         MACRO
         DATEM
         LCLC  &FILL
&FILL    SETC  'CL8'.''''.'&SYSDATE'.''''
         DC    &FILL
         MEND
ICB2MSG  CSECT                                                 @Y30LB03
C8       EQU   8                    FOR DISPLACMENTS           @Z40LB01
C4       EQU   4                    FOR DISPLACMENTS           @ZA16123
F4095    EQU   4095                 FOR DISPLACMENTS           @Y30LB03
         USING *,R15                ESTB ADDRESSABILITY        @Y30LB03
         BALR  R8,R0                SET                        @Y30LB03
START    DS    0H                   BASE                       @Y30LB03
         DROP  R15                  REG                        @Y30LB03
         USING START,R8             ESTABLISH ADDRESSABILITY   @Y30LB03
         LA    R7,F4095(R8)         SET SECOND BASE REG        @ZA16123
         USING START+4095,R7        ESTABLISH ADDRESSABILITY   @ZA16123
         LA    R6,F4095(R7)         SET THIRD BASE REG         @ZA16123
         USING START+8190,R6        ESTABLISH ADDRESSABILITY   @ZA16123
         LA    R5,F4095(R6)         SET FOURTH BASE REG        @ZA16123
         USING START+12285,R5       ESTABLISH ADDRESSABILITY   @ZA16123
         LA    R14,SAVAREA          INITIALIZE                 @Y30LB03
         ST    R14,C8(R13)          SAVE                       @Z40LB01
         LR    R13,R14              AREA                       @Y30LB03
         ST    R1,INTECBPT          STORE ECB ADDR             @Y30LB03
         B     AROUNDAT
         DS    0H
         DC    C'ICB2MSG '
         DATEM
AROUNDAT EQU   *
*   ICBTCB=CURTCB;                  /* SET UP TCB POINTER    @G24LB02*/
         L     @15,CVTPTR                                          0257
         L     @12,CVTEXT2(,@15)                                   0257
         L     @12,CVTICB(,@12)                                    0257
         L     @15,CVTTCBP(,@15)                                   0257
         L     @15,CURTCB(,@15)                                    0257
         ST    @15,ICBTCB(,@12)                                    0257
*   ICBPTR=CVTICB;                  /* SET INTERNAL CB PTR   @Z40LB01*/
         ST    @12,ICBPTR                                          0258
*   RFY                                                            0259
*     ICB2SSCB BASED(ICBPTR);       /* RESET BASE FOR CB     @Z40LB01*/
*   SMFAREA=''B;                    /* CLEAR SMF AREA        @X70AC02*/
         XC    SMFAREA(64),SMFAREA                                 0260
*   SMF22PTR=ADDR(SMFAREA);         /* PTR TO SMF AREA       @G24LB02*/
         LA    @15,SMFAREA                                         0261
         ST    @15,SMF22PTR                                        0261
*   RECOVER=''B;                    /* CLEAR STATE SWITCHES  @G24LB02*/
         MVI   RECOVER,X'00'                                       0262
*   LOCKRCVY=''B;                   /* CLEAR LOCK TRACE SWITCH     0263
*                                                            @G24LB02*/
         MVI   LOCKRCVY,X'00'                                      0263
*   INITBITS=''B;                   /* CLEAR INIT SWITCHES   @G24LB02*/
         MVI   INITBITS,X'00'                                      0264
*   PURGINDC=''B;                   /*                       @G24LB02*/
         XC    PURGINDC(4),PURGINDC                                0265
*   PURGPTR=ADDR(PURGINDC);         /* SET UP THE PURGE AREA PTR   0266
*                                                            @G24LB02*/
         LA    @15,PURGINDC                                        0266
         ST    @15,PURGPTR                                         0266
*   REENTRY=ADDR(INITBEG);          /* SET REENTRY           @Y30LB03*/
         LA    @15,INITBEG                                         0267
         ST    @15,REENTRY                                         0267
*/*  ESTABLISH STAE ENVIRONMENT FOR RECOVERY                 @Y30LB03*/
*                                                                  0268
*   GEN;                                                           0268
*                                                          /*@Y30LB03*/
ISTAE1   STAE  ICBMSG90,CT,XCTL=YES ESTABLISH STAE FOR TASK    @Y30LB03
*   RESPECIFY                                                      0269
*     R1 RSTD;                      /* RSTD REG 1            @ZA20251*/
*   R1=INTECBPT;                    /* LD REG 1,ECB ADDR     @ZA20251*/
         L     R1,INTECBPT                                         0270
*IPOST2:                                                           0271
*   GEN(POST  (1),2130706432);      /* POST ICBINIT          @ZA20251*/
IPOST2   POST  (1),2130706432
*   RESPECIFY                                                      0272
*     R1 UNRSTD;                    /* RELEASE REG 1         @ZA20251*/
*   INITPTR=ADDR(REQLIST1);         /* SETUP ENAB/DISAB RQB PTR    0273
*                                                            @G24LB02*/
         LA    @15,REQLIST1                                        0273
         ST    @15,INITPTR                                         0273
*   IF ICBPUCB=F0 THEN              /* IS MSS THERE          @G24LB02*/
         L     @15,ICBPTR                                          0274
         L     @15,ICBPUCB(,@15)                                   0274
         LTR   @15,@15                                             0274
         BNZ   @RF00274                                            0274
*     DO;                           /*                       @G24LB02*/
*       CALL ICBMSG89;              /*                       @G24LB02*/
         BAL   @14,ICBMSG89                                        0276
*     END;                          /*                       @G24LB02*/
*   GTMAINLL=LENGTH(CCWS)+LENGTH(BUFFER)+/*                  @ZA08838*/
*       +LENGTH(SRB)+LENGTH(IOSB)+LENGTH(SSCDATA)/*          @Y30LB03*/
*       +LENGTH(MESG)               /*                       @ZA08838*/
*       +LENGTH(AWAX)+LENGTH(AWBX); /*                       @ZA00671*/
@RF00274 MVC   GTMAINLL(3),@CF03269+1                              0278
*   RESPECIFY                                                      0279
*    (R0,                                                          0279
*     R1,                                                          0279
*     R15) RSTD;                    /*                       @ZM31014*/
*   R0=GTMAINR0;                    /* INIT R0 WITH GETMAIN LENGTH 0280
*                                                            @ZM31014*/
         L     R0,GTMAINR0                                         0280
*   GEN;                                                           0281
*                                                          /*@Y30LB03*/
* GETMAIN FOR CBLOCKS                                          @Y30LB03
IGETMN1  GETMAIN RC,LV=(R0),SP=245,RELATED=(ICB2MSG(IFREEMN1)) @ZM31056
*   IF R15=0 THEN                   /* GETMAIN SUCCESSFUL    @ZM31056*/
         LTR   R15,R15                                             0282
         BNZ   @RF00282                                            0282
*     DO;                           /* SAVE ADDRESS OF STORAGE     0283
*                                                            @ZM31056*/
*       CCWSPTR=R1;                 /* INIT PTR TO CCWS      @G24LB02*/
         ST    R1,CCWSPTR                                          0284
*     END;                          /*                       @ZM31056*/
*   ELSE                            /* NO I/O STORAGE, WILL QUIT   0286
*                                                            @ZM31056*/
*     CALL ICBMSG89;                /* WILL NEVER RETURN     @ZM31056*/
         B     @RC00282                                            0286
@RF00282 BAL   @14,ICBMSG89                                        0286
*   RFY                                                            0287
*    (R0,                                                          0287
*     R1,                                                          0287
*     R15) UNRSTD;                  /*                       @ZM31014*/
*                                                                  0287
@RC00282 DS    0H                                                  0288
*   /*****************************************************************/
*   /*                                                               */
*   /* ICBMSG89 WAITS ON ECB THAT NO ONE POSTS               @ZM31056*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   ECB1=ADDR(ICBECB);              /* INIT ECB1(MSS ECB)    @Y30LB03*/
         L     @15,ICBPTR                                          0288
         LA    @12,ICBECB(,@15)                                    0288
         ST    @12,ECB1                                            0288
*   ECB2=ADDR(ICBACTV);             /* INIT ECB2(ACT ECB)    @Y30LB03*/
         LA    @12,ICBACTV(,@15)                                   0289
         ST    @12,ECB2                                            0289
*   ECB3=ADDR(ICBCOM);              /* INIT ECB3(COM ECB)    @Y30LB03*/
         LA    @12,ICBCOM(,@15)                                    0290
         ST    @12,ECB3                                            0290
*   ECB4=ADDR(ICBIOR);              /* INIT ECB4(IOR ECB)    @Y30LB03*/
         LA    @15,ICBIOR(,@15)                                    0291
         STCM  @15,7,ECB4                                          0291
*INITBEG:                                                          0292
*   REENTRY=ADDR(INITBEG);          /* SETUP REENTRY POINT   @G24LB02*/
INITBEG  LA    @15,INITBEG                                         0292
         ST    @15,REENTRY                                         0292
*   CALL FSENTRY;                   /* CALL FIRST ENTRY ROUTINE    0293
*                                                            @G24LB02*/
*                                                                  0293
         BAL   @14,FSENTRY                                         0293
*   /*****************************************************************/
*   /*                                                               */
*   /* SET SWITCHES FOR INITIALIZATION AND IMPL MESSAGES     @ZM31014*/
*   /* FROM THE MSC, WITH CONFIGURATION INFORMATION          @ZM31014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   NEED9092=BONE;                  /* NEED STORAGE FOR 90 & 92 AREA
*                                                            @ZM31014*/
*   SAVE9092=BONE;                  /* 90 & 92S TO BE SAVED IN AREA
*                                                            @ZM31014*/
*   PROC9092=BZERO;                 /* NOT TIME TO PROCESS 90 OR 92
*                                                            @ZM31014*/
*   SKIP9092=BZERO;                 /* NOT SKIPPING 90S & 92S      0297
*                                                            @ZM31014*/
*   HAVE90=BZERO;                   /* HAVE NO 90 MESSAGE AS YET   0298
*                                                            @ZM31014*/
*   HAVE92=BZERO;                   /* HAVE NO 92 MESSAGE AS YET   0299
*                                                            @ZM31014*/
         OI    NEED9092,B'11000000'                                0299
         NI    PROC9092,B'11000011'                                0299
*   VVICREC=BZERO;                  /* ZERO MSVC REC BIT     #Y30LB03*/
         NI    VVICREC,B'11101111'                                 0300
*   REENTRY=ADDR(INITBEG2);         /* SET REENTRY POINT     #Y30LB03*/
         LA    @15,INITBEG2                                        0301
         ST    @15,REENTRY                                         0301
*INITBEG2:                                                         0302
*   CLEANUP=F1;                     /* INIT CLEANUP SWTCH    @Y30LB03*/
INITBEG2 MVC   CLEANUP(4),@CF00117                                 0302
*/******************************************************     @Y30LB03*/
*/* CALL MSVC INIT RTN                                       @Y30LB03*/
*/******************************************************     @Y30LB03*/
*                                                                  0303
*   IF ICBV^=BONE THEN              /* DID MSVC GET INIT'D ? @Y30LB03*/
         L     @15,ICBPTR                                          0303
         TM    ICBV(@15),B'00100000'                               0303
         BO    @RF00303                                            0303
*     DO;                           /* NO,                   @Y30LB03*/
*       CALL ICBMSG89;              /* WILL NEVER RETURN     @ZM31056*/
*                                                                  0305
         BAL   @14,ICBMSG89                                        0305
*       /*************************************************************/
*       /*                                                           */
*       /* ICBMSG89 WAITS FOREVER ON AN ECB THAT NO ONE POSTS        */
*       /*                                                   @ZM31056*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0306
*     END;                          /*                       @Y30LB03*/
*   RESPECIFY                                                      0307
*    (R0,                                                          0307
*     R1) UNRSTD;                   /*                       @Y30LB03*/
@RF00303 DS    0H                                                  0308
*/* *****************************************************    @Y30LB03*/
*/*   SET UP CONTROL BLOCK POINTERS FOR ALL DATA AREAS       @Y30LB03*/
*/*   IN DYNAMIC AREA THAT DID GETMAIN FOR                   @Y30LB03*/
*/* *****************************************************    @Y30LB03*/
*                                                                  0308
*   SSCDATAP=ADDR(BUFFER)+LENGTH(BUFFER);/*                  @Y30LB03*/
         LA    @15,536                                             0308
         AL    @15,CCWSPTR                                         0308
         ST    @15,SSCDATAP                                        0308
*   IOSBPTR=SSCDATAP+LENGTH(SSCDATA);/*                      @Y30LB03*/
         AL    @15,@CF03265                                        0309
         ST    @15,IOSBPTR                                         0309
*   SRBPTR=IOSBPTR+LENGTH(IOSB);    /*                       @Y30LB03*/
         AL    @15,@CF02395                                        0310
         ST    @15,SRBPTR                                          0310
*   MESGPTR=SRBPTR+LENGTH(SRB);     /*                       @Y30LB03*/
         AL    @15,@CF00838                                        0311
         ST    @15,MESGPTR                                         0311
*   REENTRY=ADDR(REINIT);           /* INIT RE-ENTRY PNT     @Y30LB03*/
         LA    @15,REINIT                                          0312
         ST    @15,REENTRY                                         0312
*/*  ******************************************************  @Y30LB03*/
*/*     START OF EXECUTION SHOULD THIS TASK BECOME           @Y30LB03*/
*/*     RE-INSTATED.  THIS POINT IS ALSO A RE-ENTRY POINT    @Y30LB03*/
*/*     FROM ICBMSG95(THE STAE RE-TRY SUBRTN).               @Y30LB03*/
*/*  ******************************************************  @Y30LB03*/
*                                                                  0313
*REINIT:                                                           0313
*   ASCBPTR=MSGASCB;                /* INIT ASCB PTR         @Y30LB03*/
REINIT   L     @15,CVTPTR                                          0313
         LA    @12,4                                               0313
         AL    @12,CVTTCBP(,@15)                                   0313
         L     @11,MSGASCB(,@12)                                   0313
         ST    @11,ASCBPTR                                         0313
*   BITSW=''B;                      /* CLEAR DISPLAY SWITCHES      0314
*                                                            @Z40LB01*/
         MVI   BITSW,X'00'                                         0314
*   RECOVER=''B;                    /* SET RECOVERY BITS     @Y30LB03
*                                      TO ZEROES             @Y30LB03*/
         MVI   RECOVER,X'00'                                       0315
*   LOCKRCVY=''B;                   /* INIT LOCK RECOVERY    @Y30LB03
*                                      INFORMATION FIELD     @Y30LB03*/
         MVI   LOCKRCVY,X'00'                                      0316
*   VVICREC=BONE;                   /* RE-SET MSVC RECY BIT(IF     0317
*                                      REINSTATED)           @Y30LB03*/
         OI    VVICREC,B'00010000'                                 0317
*   ICBTCB=MSGTCB;                  /* DEFINE CB TCB         @Y30LB03*/
         L     @11,ICBPTR                                          0318
         L     @12,MSGTCB(,@12)                                    0318
         ST    @12,ICBTCB(,@11)                                    0318
*   ASVTPTR=CVTASVT;                /* INIT ASVT PTR         @Y30LB03*/
         L     @15,CVTASVT(,@15)                                   0319
         ST    @15,ASVTPTR                                         0319
*   UCBPTR=ICBPUCB;                 /* INIT UCB PTR TO       @Y30LB03
*                                      PRIMARY UCB(MSC)      @Y30LB03*/
         L     @15,ICBPUCB(,@11)                                   0320
         ST    @15,UCBPTR                                          0320
*   ECB1=ADDR(ICBECB);              /* INIT ECB1(MSS ECB)    @Y30LB03*/
         LA    @15,ICBECB(,@11)                                    0321
         ST    @15,ECB1                                            0321
*   ECB2=ADDR(ICBACTV);             /* INIT ECB2(ACT ECB)    @Y30LB03*/
         LA    @15,ICBACTV(,@11)                                   0322
         ST    @15,ECB2                                            0322
*   ECB3=ADDR(ICBCOM);              /* INIT ECB3(COM ECB)    @Y30LB03*/
         LA    @15,ICBCOM(,@11)                                    0323
         ST    @15,ECB3                                            0323
*   ECB4=ADDR(ICBIOR);              /* INIT ECB4(IOR ECB)    @Y30LB03*/
*                                                                  0324
         LA    @15,ICBIOR(,@11)                                    0324
         STCM  @15,7,ECB4                                          0324
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT ECBS IN CONTROL BLOCK TO ZEROES                  @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   ICBECB=F0;                      /*                       @Y30LB03*/
         SLR   @15,@15                                             0325
         ST    @15,ICBECB(,@11)                                    0325
*   ICBACTV=F0;                     /*                       @Y30LB03*/
         ST    @15,ICBACTV(,@11)                                   0326
*   ICBCOM=F0;                      /*                       @Y30LB03*/
         ST    @15,ICBCOM(,@11)                                    0327
*   ICBIOR=F0;                      /*                       @Y30LB03*/
         ST    @15,ICBIOR(,@11)                                    0328
*   NON7F=F0;                       /* NO I/O ERRORS YET     @ZA13488*/
         ST    @15,NON7F                                           0329
*   FIRST=CHAR0;                    /* INIT TO 0             @Y30LB03*/
         MVI   FIRST,C'0'                                          0330
*   DO WHILE CLEANUP^=F0;           /* CLEANUP GARBAGE       @Y30LB03
*                                      IN MSC BUFFER FROM    @Y30LB03
*                                      LAST IPL              @Y30LB03*/
         B     @DE00331                                            0331
@DL00331 DS    0H                                                  0332
*     CALL ICBMSG10;                /* CALL SUBRTN TO        @Y30LB03
*                                      DEBLK & ROUTE MSGS    @Y30LB03*/
         BAL   @14,ICBMSG10                                        0332
*   END;                            /*                       @Y30LB03*/
*                                                                  0333
@DE00331 L     @15,CLEANUP                                         0333
         LTR   @15,@15                                             0333
         BNZ   @DL00331                                            0333
*   /*****************************************************************/
*   /*                                                               */
*   /* HAVE READ ALL MESSAGE BUFFERS FROM MSC. DURING        @ZM31014*/
*   /* INITIALIZATION, WANT TO PROCESS LAST 90 & 92 MESSAGE  @ZM31014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   IF REENTRY=ADDR(REINIT)         /* DURING INITIALIZATION ?     0334
*                                                            @ZM31014*/
*     THEN                                                         0334
         LA    @15,REINIT                                          0334
         C     @15,REENTRY                                         0334
         BNE   @RF00334                                            0334
*     DO;                           /* PROCESS 90 & 92 MESSAGES    0335
*                                                            @ZM31014*/
*       PROC9092=BONE;              /* TIME TO PROCESS LAST ONES   0336
*                                                            @ZM31014*/
*       SAVE9092=BZERO;             /* NO LONGER SAVING THEM @ZM31014*/
         OI    PROC9092,B'00100000'                                0337
         NI    SAVE9092,B'10111111'                                0337
*       CALL ICBMSG18;              /* OFF TO PROCESS THEM   @ZM31014*/
         BAL   @14,ICBMSG18                                        0338
*     END;                          /* PROCESSING LAST 90/92 MESSAGE
*                                                            @ZM31014*/
*   ELSE                                                           0340
*     ;                             /* NOT PROCESSED LATER   @ZM31014*/
@RF00334 DS    0H                                                  0341
*   IF ICBR=BZERO THEN              /* IS READY BIT ON?      @Y30LB03*/
         L     @15,ICBPTR                                          0341
         TM    ICBR(@15),B'01000000'                               0341
         BNZ   @RF00341                                            0341
*     DO;                           /* NO,                   @Y30LB03*/
*       SAVREENT=REENTRY;           /* SAVE REENTRY POINTER  @G24LB02*/
         L     @15,REENTRY                                         0343
         ST    @15,SAVREENT                                        0343
*       REENTRY=ADDR(RDYRET);       /* SET NEW REENTRY POINT @G24LB02*/
         LA    @15,RDYRET                                          0344
         ST    @15,REENTRY                                         0344
*       SVCCALL=ON;                 /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 0345
*       RESPECIFY                                                  0346
*         R15 RSTD;                 /* RESTRICT REG 15       @Y30LB03*/
*IPAIR1:                                                           0347
*                                                                  0347
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO       @Y30LB02*/
*       /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00           @Y30LB02*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Y30LB02*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Y30LB02*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Y30LB02*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Y30LB02*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Y30LB02*/
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0347
*       RFY                                                        0347
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/
IPAIR1   DS    0H                                                  0348
*       PAIRR1=ADDR(ARLIST);        /* SET PAIRR1 TO REQ BLOCK     0348
*                                                            @Y30LB02*/
         LA    PAIRR1,ARLIST                                       0348
*       AIRLL='08'X;                /* SET LENGTH FIELD      @Y30LB02*/
         LA    @12,8                                               0349
         ST    @12,AIRLL                                           0349
*       AIROP='20'X;                /* RDY OPCODE            @Y30LB02*/
         MVI   AIROP,X'20'                                         0350
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 0351
*       RFY                                                        0352
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02*/
*/*@Y30LB03                                                          */
*                                                                  0353
*RDYRET:                            /* RETURN LABEL          @G24LB02*/
*       SVCCALL=OFF;                /* CLEAR SVC CALL FLAG   @G24LB02*/
RDYRET   NI    SVCCALL,B'11110111'                                 0353
*       REENTRY=SAVREENT;           /* RESTORE REENTRY POINTER     0354
*                                                            @G24LB02*/
         L     @12,SAVREENT                                        0354
         ST    @12,REENTRY                                         0354
*       IF R15=F0 THEN              /* GOOD RTN CODE?        @Y30LB03*/
         LTR   R15,R15                                             0355
         BNZ   @RF00355                                            0355
*         DO;                       /* SUCCESSFUL READY      @Y30LB03*/
*           ICBR=BONE;              /* SET READY BIT         @ZM31014*/
         L     @12,ICBPTR                                          0357
         OI    ICBR(@12),B'01000000'                               0357
*         END;                      /*                       @Y30LB03*/
*       ELSE                        /* UNSUCCESSFUL READY    @Y30LB03*/
*         DO;                       /* SET UP FAILURE MSG    @Y30LB03*/
         B     @RC00355                                            0359
@RF00355 DS    0H                                                  0360
*           RESPECIFY                                              0360
*             R0 RSTD;              /* RESTRICT REG 0        @Y30LB03*/
*           INTER=R0;               /* SET UP CONVERSION AREA      0361
*                                                            @X04AC03*/
         ST    R0,INTER                                            0361
*           CALL ICBMSG82;          /* CALL SUBRTN TO        @X04AC03
*                                      CONVERT REAS CODE     @X04AC03*/
         BAL   @14,ICBMSG82                                        0362
*           RESPECIFY                                              0363
*             R0 UNRSTD;            /* RELEASE REG 0         @X04AC03*/
*           WTOGEN03=MESGS(MSG01201);/* FILL WTO BUFFER      @X50AC01*/
         MVI   WTOGEN03+72,C' '                                    0364
         L     @12,@CA02101                                        0364
         MVC   WTOGEN03(72),MESGS-MSGS+1976(@12)                   0364
*           WTOGEN03(52:54)=BYTES234;/* FILL IN REAS CODE    @X50AC01*/
         MVC   WTOGEN03+51(3),BYTES234                             0365
*           RESPECIFY                                              0366
*             R15 UNRSTD;           /* RELEASE REG 15        @G24LB02*/
*           CALL ICBMSG45;          /* CALL WTO SUBRTN       @G24LB02*/
*                                                                  0367
         BAL   @14,ICBMSG45                                        0367
*           /*********************************************************/
*           /*                                                       */
*           /* THIS SEGMENT OF CODE WILL SET ON MSSC SUSPEND FLAG,   */
*           /* TURN ON THE BROKEN BOX FLAG AND SET OFF THE INITIALIZE*/
*           /* BIT.                                          @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0368
*           ICBS=ON;                /* SET SUSPEND INDICATOR ON    0368
*                                                            @G24LB02*/
         L     @15,ICBPTR                                          0368
         OI    ICBS(@15),B'00001000'                               0368
*           REQLIST1=''B;           /* ZERO LIST 1           @G24LB02*/
         XC    REQLIST1(40),REQLIST1                               0369
*           INILNGTH=INILEN;        /* SET REQ BLK LENGTH    @G24LB02*/
         L     @15,INITPTR                                         0370
         LH    @12,INILEN                                          0370
         ST    @12,INILNGTH(,@15)                                  0370
*           INITOPCD=INICODE;       /* SET OP CODE           @G24LB02*/
         MVI   INITOPCD(@15),X'88'                                 0371
*           INIDISAB=ON;            /* SET DISABLE FLAG      @G24LB02*/
         OI    INIDISAB(@15),B'00100000'                           0372
*           INIABLE=ON;             /* SET MSVI FLAG ON      @G24LB02*/
*           INIJRNL=ON;             /* SET JOURNAL FLAG      @G24LB02*/
         OI    INIABLE(@15),B'01100000'                            0374
*           RFY                                                    0375
*             R1 RSTD;              /*                       @G24LB02*/
*           R1=INITPTR;             /* SET PARAMETER REG     @G24LB02*/
         LR    R1,@15                                              0376
*           SVC(126);               /* INVOKE SVC 126        @G24LB02*/
         SVC   126                                                 0377
*           RFY                                                    0378
*             R1 UNRSTD;            /*                       @G24LB02*/
*           ICBB=ON;                /* SET BROKEN BOX INDICATOR    0379
*                                                            @G24LB02*/
*           ICBI=OFF;               /* INIT INDICATOR SET OFF      0380
*                                                            @G24LB02*/
         L     @15,ICBPTR                                          0380
         OI    ICBB(@15),B'00010000'                               0380
         NI    ICBI(@15),B'01111111'                               0380
*           INITFLAG=OFF;           /* SETOFF FSENTRY LOOP CNTL    0381
*                                                            @G24LB02*/
         NI    INITFLAG,B'11110111'                                0381
*           GOTO INITBEG;           /*                       @G24LB02*/
         B     INITBEG                                             0382
*         END;                      /*                       @Y30LB03*/
*     END;                          /*                       @Y30LB03*/
@RC00355 DS    0H                                                  0385
*   IF ICBOPT=F0 THEN               /* FIRST TIME FOR ACTIVITY ?   0385
*                                                            @Y30LB03*/
@RF00341 L     @15,ICBPTR                                          0385
         L     @12,ICBOPT(,@15)                                    0385
         LTR   @12,@12                                             0385
         BNZ   @RF00385                                            0385
*     DO;                           /* YES,                  @Y30LB03*/
*       ICBOPT=MESGPTR+LENGTH(MESG);/* ACTIVITY BUFFER ADDRESS     0387
*                                                            @ZA08838*/
         LA    @12,68                                              0387
         AL    @12,MESGPTR                                         0387
         ST    @12,ICBOPT(,@15)                                    0387
*     END;                          /*                       @Y30LB03*/
*   SAVR14=R14;                     /*                       @Y30LB03*/
@RF00385 ST    R14,SAVR14                                          0389
*   CALL ICBMSG50;                  /* CALL ACTIVITY RTN     @Y30LB03*/
         BAL   @14,ICBMSG50                                        0390
*   R14=SAVR14;                     /*                       @Y30LB03*/
         L     R14,SAVR14                                          0391
*   REENTRY=ADDR(SCAN);             /* SET RE-ENTRY PNT      @Y30LB03*/
         LA    @15,SCAN                                            0392
         ST    @15,REENTRY                                         0392
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/* AT THIS POINT THE MESSAGE TASK ENTERS THE WAIT STATE     @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  0393
*WAIT:                                                             0393
*   GEN(WAIT  ECBLIST=WAITLIST);    /*                       @Y30LB03*/
WAIT     WAIT  ECBLIST=WAITLIST
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/* SCAN LIST OF ECBS FOR POSTED ECB                         @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  0394
*SCAN:                                                             0394
*   REENTRY=ADDR(WAIT);             /*                       @Y30LB03*/
SCAN     LA    @15,WAIT                                            0394
         ST    @15,REENTRY                                         0394
*   DO I=0 TO 12 BY 4;              /*                       @Y30LB03*/
         SLR   @15,@15                                             0395
         ST    @15,I                                               0395
@DL00395 DS    0H                                                  0396
*     BITPTR=ECB1+I;                /*                       @Y30LB03*/
         AL    @15,ECB1                                            0396
         ST    @15,BITPTR                                          0396
*     IF BITPATT(2)=BZERO THEN      /* THIS ECB POSTED       @Y30LB03*/
         TM    BITPATT(@15),B'01000000'                            0397
         BZ    @RT00397                                            0397
*       ;                           /* NO,JUST INCR I        @Y30LB03*/
*     ELSE                          /* YES,FIND RTN THAT     @Y30LB03
*                                      SHOULD BE CALLED      @Y30LB03*/
*       DO;                         /*                       @Y30LB03*/
*         IF I=F0 THEN              /* WAS IT MSS ECB?       @Y30LB03*/
         L     @15,I                                               0400
         LTR   @15,@15                                             0400
         BNZ   @RF00400                                            0400
*           DO;                     /*                       @Y30LB03*/
*             CALL ICBMSG10;        /* MSC MESSAGE           @Y30LB03
*                                      HANDLER RTN           @Y30LB03*/
         BAL   @14,ICBMSG10                                        0402
*           END;                    /*                       @Y30LB03*/
*         IF I=F4 THEN              /* WAS IT ACT ECB?       @Y30LB03*/
@RF00400 CLC   I(4),@CF00109                                       0404
         BNE   @RF00404                                            0404
*           DO;                     /*                       @Y30LB03*/
*             CALL ICBMSG50;        /* MSC ACTIVITY          @Y30LB03
*                                      INTERFACE RTN         @Y30LB03*/
         BAL   @14,ICBMSG50                                        0406
*           END;                    /*                       @Y30LB03*/
*         IF I=F8 THEN              /* WAS IT COM ECB?       @Y30LB03*/
@RF00404 CLC   I(4),@CF00115                                       0408
         BNE   @RF00408                                            0408
*           DO;                     /*                       @Y30LB03*/
*             RECOVER=''B;          /* CLEAR                 @Y30LB03
*                                      COMTASK RECOVERY BITS @Y30LB03*/
         MVI   RECOVER,X'00'                                       0410
*             RECOVER(1)=BONE;      /* SET REC-              @Y30LB03
*                                      OVERY BIT FOR CMTASK  @Y30LB03*/
         OI    RECOVER,B'10000000'                                 0411
*             CALL ICBMSG40;        /* MSC/COMTASK           @Y30LB03
*                                      INTERFACE RTN         @Y30LB03*/
         BAL   @14,ICBMSG40                                        0412
*             RECOVER=''B;          /* TURN OFF              @Y30LB03
*                                      COMTASK RECOVERY BIT  @Y30LB03*/
         MVI   RECOVER,X'00'                                       0413
*           END;                    /*                       @Y30LB03*/
*         IF I=F12 THEN             /* I/O RESTART ECB?      @Y30LB03*/
@RF00408 CLC   I(4),@CF02050                                       0415
         BNE   @RF00415                                            0415
*           DO;                     /*                       @Y30LB03*/
*                                                                  0416
*             /*******************************************************/
*             /*                                                     */
*             /* *********************************           @Y30LB03*/
*             /* CALL I/O RESTART SUBROUTINE                 @Y30LB03*/
*             /* *********************************           @Y30LB03*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0417
*             CALL ICBMSG70;        /*                       @Y30LB03*/
         BAL   @14,ICBMSG70                                        0417
*           END;                    /*                       @Y30LB03*/
*       END;                        /*                       @Y30LB03*/
@RF00415 DS    0H                                                  0420
*   END;                            /*                       @Y30LB03*/
@RT00397 LA    @15,4                                               0420
         AL    @15,I                                               0420
         ST    @15,I                                               0420
         C     @15,@CF02050                                        0420
         BNH   @DL00395                                            0420
*EXITX:                                                            0421
*   GOTO WAIT;                      /* BRANCH TO WAIT        @Y30LB03*/
         B     WAIT                                                0421
*                                                                  0422
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/* SUBROUTINES                                              @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/*********************************************************  @G24LB02*/
*/*    PROCEDURE NAME - FSENTRY                              @G24LB02*/
*/*                                                          @G24LB02*/
*/*    FUNCTION - THE FUNCTION OF THIS SUBROUTINE IS TO      @G24LB02*/
*/*               DETERMINE INITIALIZATION STATUS OF THE     @G24LB02*/
*/*               MSC.  IF THE MSC'S BROKEN BOX FLAG IS      @G24LB02*/
*/*               SET IN THE ICBSS1CB CONTROL BLOCK, THEN    @G24LB02*/
*/*               A WAIT WILL BE ISSUED UNTIL THE COMTASK    @G24LB02*/
*/*               PROCESSOR RECEIVES A VARY-ON REQUEST       @G24LB02*/
*/*               FOR THE MSC.  WHEN A VARY-ON OF THE MSC    @G24LB02*/
*/*               IS PROCESSED, THE CKUCB SUBROUTINE WILL    @G24LB02*/
*/*               BE  INVOKED TO LOAD AND CALL THE ICBMSG05  @G24LB02*/
*/*               ROUTINE FOR INITIALIZATION OF THE MSC      @G24LB02*/
*/*               UCB.                                       @G24LB02*/
*/*                                                          @G24LB02*/
*/*               IF THE FIRST ENTRY FLAG(ICBENT) IS ON      @G24LB02*/
*/*               AND ICBI IS OFF, THEN THIS ROUTINE WILL    @G24LB02*/
*/*               LOAD AND CALL ICBMSG05 FOR INITIALIZATION  @G24LB02*/
*/*               PROCESSING.                                @G24LB02*/
*/*                                                          @G24LB02*/
*/*               IF THE INITIALIZE ATTEMPT IS SUCCESSFUL    @G24LB02*/
*/*               THEN THIS SUBROUTINE WILL CALL THE         @G24LB02*/
*/*               'SECENTRY' SUBROUTINE TO COMPLETE MSS      @G24LB02*/
*/*               INITIALIZATION.                            @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUTS - ICBENT FLAG                                    @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUTS- ICBI FLAG SET                                  @G24LB02*/
*/*           IF LOAD FOR ICBMSG05 FAILS-WTO MESSAGE         @G24LB02*/
*/*                                                          @G24LB02*/
*/*********************************************************  @G24LB02*/
*                                                                  0422
*FSENTRY:                                                          0422
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
FSENTRY  DS    0H                                                  0423
*   RFY                                                            0423
*     R14 RSTD;                     /* RESTRICT REG 14       @G24LB02*/
*   FSENTR14=R14;                   /* SAVE REG 14           @G24LB02*/
         ST    R14,FSENTR14                                        0424
*   RFY                                                            0425
*     R14 UNRSTD;                   /* FREE REG 14           @G24LB02*/
*   DO WHILE INITFLAG^=ON;          /* EXECUTE FSENTRY UNTIL INITLD
*                                                            @G24LB02*/
*                                                                  0426
         B     @DE00426                                            0426
@DL00426 DS    0H                                                  0427
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR INITIALIZATION AND BROKEN BOX STATUS.     @G24LB02*/
*     /* IF MSI HAS NOT BEEN POSTED THEN POST MSI BEFORE WAITING FOR */
*     /* A MSC VARY COMMAND                                  @G24LB02*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0427
*ICBITEST:                          /* LABEL FOR ICBI/ICBB TEST    0427
*                                                            @G24LB02*/
*     IF(ICBI=OFF&ICBB=ON) THEN                                    0427
ICBITEST L     @12,ICBPTR                                          0427
         TM    ICBB(@12),B'00010000'                               0427
         BNO   @RF00427                                            0427
         TM    ICBI(@12),B'10000000'                               0427
         BNZ   @RF00427                                            0427
*       DO;                         /*                       @G24LB02*/
*         IF MSG05FLG=ON THEN                                      0429
         TM    MSG05FLG,B'01000000'                                0429
         BNO   @RF00429                                            0429
*           DO;                     /*                       @G24LB02*/
*             WTOGEN03=NOMSS;       /* PUT MSG IN WTO BUFFER @G24LB02*/
         MVI   WTOGEN03+50,C' '                                    0431
         MVC   WTOGEN03+51(22),WTOGEN03+50                         0431
         MVC   WTOGEN03(50),NOMSS                                  0431
*             WTOGEN03(51:66)=', REAS CODE=179 ';/* REAS CODE      0432
*                                                            @G24LB02*/
         MVC   WTOGEN03+50(16),@CC02598                            0432
*             CALL ICBMSG45;        /*                       @G24LB02*/
         BAL   @14,ICBMSG45                                        0433
*             MSG05FLG=OFF;         /* MSG05 NOT IN CONTROL  @G24LB02*/
         NI    MSG05FLG,B'10111111'                                0434
*           END;                    /*                       @G24LB02*/
*         ICBCOM=F0;                /* CLEAR COMTASK ECB     @G24LB02*/
@RF00429 SLR   @12,@12                                             0436
         L     @11,ICBPTR                                          0436
         ST    @12,ICBCOM(,@11)                                    0436
*         ICBCOMQ=F0;               /* CLEAR COMQUE PTR      @G24LB02*/
         ST    @12,ICBCOMQ(,@11)                                   0437
*         RFY                                                      0438
*           R2 RSTD;                /* RESTRICT REG 2        @G24LB02*/
*         R2=ADDR(ICBCOM);          /* POINT R2 TO ECB       @G24LB02*/
         LA    R2,ICBCOM(,@11)                                     0439
*IWAIT3:                            /* LABEL WAIT            @G24LB02*/
*         GEN(WAIT ECB=(R2));       /* ISSUE WAIT            @G24LB02*/
IWAIT3   WAIT ECB=(R2)
*         RFY                                                      0441
*           R2 UNRSTD;              /* FREE REG 2            @G24LB02*/
*                                                                  0441
*         /***********************************************************/
*         /*                                                         */
*         /* THE CKUCB ROUTINE WILL PROCESS THE VARY ON      @G24LB02*/
*         /* MSC COMMANDS UNTIL A SUCCESSFUL INITIALIZE IS           */
*         /* ACCOMPLISHED.                                   @G24LB02*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0442
*         CALL CKUCB;               /* PROCESS CWB UCB       @G24LB02*/
         BAL   @14,CKUCB                                           0442
*       END;                        /*                       @G24LB02*/
*     IF ICBI^=OFF THEN             /* WAS THE INIT ATTEMPT SUCC   0444
*                                                            @G24LB02*/
@RF00427 L     @12,ICBPTR                                          0444
         TM    ICBI(@12),B'10000000'                               0444
         BZ    @RF00444                                            0444
*       DO;                         /*                       @G24LB02*/
*                                                                  0445
*         /***********************************************************/
*         /*                                                         */
*         /* A SUCCESSFUL INITIALIZE ACCOMPLISHED, PROCEED   @G24LB02*/
*         /* WITH ICBV TEST, MESSAGE BUFFER CLEANUP, READY FUNCTION  */
*         /* AND ESTABLISH TIMER INTERRUPT.                  @G24LB02*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0446
*         CALL SECENTRY;            /*                       @G24LB02*/
         BAL   @14,SECENTRY                                        0446
*         INITFLAG=ON;              /* INIT IS COMPLETE      @G24LB02*/
         OI    INITFLAG,B'00001000'                                0447
*       END;                        /*                       @G24LB02*/
*   END;                            /*                       @G24LB02*/
*                                                                  0449
@RF00444 DS    0H                                                  0449
@DE00426 TM    INITFLAG,B'00001000'                                0449
         BNO   @DL00426                                            0449
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE INITFLAG IS NOT SET ON, ANOTHER PASS           @G24LB02*/
*   /* WILL BE MADE THROUGH THIS MODULE, THUS CAUSING A WAIT FOR     */
*   /* ANOTHER VARY ON MSC COMMAND.                          @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   RFY                                                            0450
*     R14 RSTD;                     /* RESTRICT REG 14       @G24LB02*/
*   R14=FSENTR14;                   /* RESTORE REG14         @G24LB02*/
         L     R14,FSENTR14                                        0451
*   RFY                                                            0452
*     R14 UNRSTD;                   /* FREE REG 14           @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
@EL00002 DS    0H                                                  0453
@EF00002 DS    0H                                                  0453
@ER00002 BR    @14                                                 0453
*   END FSENTRY;                    /*                       @G24LB02*/
*                                                                  0455
*/********************************************************** @G24LB02*/
*/*  PROCEDURE NAME - SECENTRY                               @G24LB02*/
*/*                                                          @G24LB02*/
*/*  FUNCTION - THE PURPOSES OF THIS SUBROUTINE ARE          @G24LB02*/
*/*             AS FOLLOWS:                                  @G24LB02*/
*/*             (1) DETERMINE IF PSUEDO VATLIST PROCESSING   @G24LB02*/
*/*                 IS NECESSARY.  IF VATLIST PROCESSING     @G24LB02*/
*/*                 IS REQUIRED, THEN CALL SUBROUTINE        @G24LB02*/
*/*                 VATLIST.                                @G24LB02 */
*/*                                                          @G24LB02*/
*/*             (2) IF THE MSC HAS BEEN SUSPENDED(ICBS=1)    @G24LB02*/
*/*                 THEN MSVC MUST BE ENABLED.(ISSUE MSVC    @G24LB02*/
*/*                 ENABLE/DISABLE MACRO)                    @G24LB02*/
*/*                                                          @G24LB02*/
*/*             (3) DISPATCH THE MSVC TASK                   @G24LB02*/
*/*                                                          @G24LB02*/
*/*             (4) WAIT FOR THE ICBERP AND ICBECB ECBS TO   @G24LB02*/
*/*                 BE POSTED                                @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUTS:  ICBB,ICBI,ICBS                                 @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT:  WTOR FOR PSUEDO VATLIST PROCESSING             @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0455
*SECENTRY:                                                         0455
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
SECENTRY DS    0H                                                  0456
*   RFY                                                            0456
*     R14 RSTD;                     /*                       @G24LB02*/
*   SECENR14=R14;                   /* SAVE REG 14           @G24LB02*/
         ST    R14,SECENR14                                        0457
*   RFY                                                            0458
*     R14 UNRSTD;                   /*                       @G24LB02*/
*/*   THIS SEGMENT OF CODE SETS UP PARAMETERS TO ENABLE      @G24LB02*/
*/*   THE MSVC, INVOKE SVC 126. THE RETURN CODE WILL NOT     @G24LB02*/
*/*   BE CHECKED AFTER THE COMPLETION OF THE ENABLE.         @G24LB02*/
*                                                                  0459
*   IF ICBS=ON THEN                 /*                       @G24LB02*/
         L     @12,ICBPTR                                          0459
         TM    ICBS(@12),B'00001000'                               0459
         BNO   @RF00459                                            0459
*     DO;                           /* ENABLE MSVC CODE      @G24LB02*/
*       ICBS=OFF;                   /* SET SUSPEND OFF       @G24LB02*/
         NI    ICBS(@12),B'11110111'                               0461
*     END;                          /* END ENABLE MSVC CODE  @G24LB02*/
*                                                                  0462
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE MAKES THE MSVC TASK              @G24LB02*/
*   /* DISPATCHABLE                                          @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0463
*   ELSE                            /*                       @G24LB02*/
*     DO;                           /* DISPATCH THE MSVC TASK      0463
*                                                            @G24LB02*/
         B     @RC00459                                            0463
@RF00459 DS    0H                                                  0464
*       RFY                                                        0464
*         R14 RSTD;                 /*                       @G24LB02*/
*       SAVR14=R14;                 /*                       @G24LB02*/
         ST    R14,SAVR14                                          0465
*       RFY                                                        0466
*         R14 UNRSTD;               /*                       @G24LB02*/
*       IF VVICREC=BZERO THEN       /* HAS MSVC BEEN INITL'D?      0467
*                                                            @G24LB02*/
         TM    VVICREC,B'00010000'                                 0467
         BNZ   @RF00467                                            0467
*         DO;                       /* NO                    @G24LB02*/
*           RESPECIFY                                              0469
*             R15 RSTD;             /*                       @G24LB02*/
*           R15=ICBVN02P;           /*                       @G24LB02*/
         L     @12,ICBPTR                                          0470
         L     R15,ICBVN02P(,@12)                                  0470
*           GEN(BALR  R14,R15);     /* CALL MSVC INIT        @G24LB02*/
         BALR  R14,R15
*           RESPECIFY                                              0472
*             R15 UNRSTD;           /*                       @G24LB02*/
*           VVICREC=BONE;           /* SET MSVC REC BIT      @G24LB02*/
         OI    VVICREC,B'00010000'                                 0473
*         END;                      /*                       @G24LB02*/
*     END;                          /*                       @G24LB02*/
@RF00467 DS    0H                                                  0476
*   RFY                                                            0476
*     R14 RSTD;                     /*                       @G24LB02*/
@RC00459 DS    0H                                                  0477
*   R14=SECENR14;                   /* RESTORE REGISTER 14   @G24LB02*/
         L     R14,SECENR14                                        0477
*   RFY                                                            0478
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
@EL00003 DS    0H                                                  0479
@EF00003 DS    0H                                                  0479
@ER00003 BR    @14                                                 0479
*   END SECENTRY;                   /*                       @G24LB02*/
*                                                                  0481
*/*********************************************************  @G24LB02*/
*/*                                                          @G24LB02*/
*/*  PROCEDURE NAME = CKUCB                                  @G24LB02*/
*/*                                                          @G24LB02*/
*/*  FUNCTION = THIS ROUTINE WILL PROCESS THE VARIED-ON MSC  @G24LB02*/
*/*             UCB.  SUBROUTINE ICBMSG49 WILL ACCOMPLISH    @G24LB02*/
*/*             THE MSC VARY PROCESSING.  AFTER THIS         @G24LB02*/
*/*             PROCESSING IS DONE AN ATTEMPT WILL BE MADE   @G24LB02*/
*/*             TO LOAD ICBMSG05 FOR INITIALIZATION OF THE   @G24LB02*/
*/*             MSC UCB.  SUBROUTINES ICBMSG44 AND ICBMSG46  @G24LB02*/
*/*             ARE USED TO DEQUEUE AND FREEMAIN CWBS,       @G24LB02*/
*/*             RESPECTIVELY.  A MESSAGE WILL BE GIVEN IF    @G24LB02*/
*/*             THE INITIALIZATION ATTEMPT FAILED.           @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUT = UCBONLI,UCBNOTRD                                @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT = ICBI,MESSAGE IF INITIALIZATION FAILS           @G24LB02*/
*/*                                                          @G24LB02*/
*/*********************************************************  @G24LB02*/
*                                                                  0481
*CKUCB:                                                            0481
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
CKUCB    DS    0H                                                  0482
*   RFY                                                            0482
*     R14 RSTD;                     /* RESTRICT REG 14       @G24LB02*/
*   CKUCBR14=R14;                   /* SAVE REGISTER 14      @G24LB02*/
         ST    R14,CKUCBR14                                        0483
*   RFY                                                            0484
*     R14 UNRSTD;                   /* FREE REG 14           @G24LB02*/
*   CWBCOMP=OFF;                    /* CLEAR CWB FLAG        @G24LB02*/
         NI    CWBCOMP,B'11111011'                                 0485
*   DO WHILE CWBCOMP^=ON;           /* EXEC LOOP UNTIL ICBCOMQ=0   0486
*                                                            @G24LB02*/
         B     @DE00486                                            0486
@DL00486 DS    0H                                                  0487
*CKCWB:                                                            0487
*     CWBPTR=ICBCOMQ;               /* SETUP CWB POINTER     @G24LB02*/
*                                                                  0487
CKCWB    L     @12,ICBPTR                                          0487
         L     @12,ICBCOMQ(,@12)                                   0487
         ST    @12,CWBPTR                                          0487
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK TO SEE IF PURGE WAS SPECIFIED ON THE VARY CMD @G24LB02*/
*     /* IF SO THEN THE PURGE BIT MUST BE SET .              @G24LB02*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0488
*     IF CWBCMND(19:23)='PURGE' THEN                               0488
         CLC   CWBCMND+18(5,@12),@CC02612                          0488
         BNE   @RF00488                                            0488
*       PURGBIT=ON;                 /* SET PURGE INDICATOR   @G24LB02*/
         OI    PURGBIT,B'10000000'                                 0489
*     ELSE                          /*                       @G24LB02*/
*       PURGBIT=OFF;                /* SET PURGE INDICATOR   @G24LB02*/
*                                                                  0490
         B     @RC00488                                            0490
@RF00488 NI    PURGBIT,B'01111111'                                 0490
*     /***************************************************************/
*     /*                                                             */
*     /* FOR POST IPL VARY CHECK FOR BOTH PRIMARY AND ALTERNATE UCBS.*/
*     /* TRY TO INITIALIZE BOTH UCBS.                        @G24LB02*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0491
*     UCBPTR=ICBPUCB;               /* POINT TO PRIM UCB     @G24LB02*/
@RC00488 L     @12,ICBPTR                                          0491
         L     @11,ICBPUCB(,@12)                                   0491
         ST    @11,UCBPTR                                          0491
*     IF(CWBCMND(1:3)=ICBPUCB->UCBNAMECWBCMND(1:3)=ICBAUCB->UCBNAME)
*       THEN                        /*                       @G24LB02*/
         L     @09,CWBPTR                                          0492
         CLC   CWBCMND(3,@09),UCBNAME(@11)                         0492
         BE    @RT00492                                            0492
         L     @12,ICBAUCB(,@12)                                   0492
         CLC   CWBCMND(3,@09),UCBNAME(@12)                         0492
         BNE   @RF00492                                            0492
@RT00492 DS    0H                                                  0493
*       DO;                         /* IF EITHER UCB SPECIFIED THEN
*                                      INITIALIZE BOTH       @G24LB02*/
*         CALL MSG05LCD;            /* LOAD,CALL&DELETE MSG05      0494
*                                                            @G24LB02*/
         BAL   @14,MSG05LCD                                        0494
*       END;                        /*                       @G24LB02*/
*     ELSE                          /*                       @G24LB02*/
*       GOTO NOMSSC;                /* GOTO PRINT NOMSS MSG  @G24LB02*/
*                                                                  0496
*     /***************************************************************/
*     /*                                                             */
*     /* NEITHER OF THE MSC UCBS COULD BE INITIALIZED        @G24LB02*/
*     /* IF ONE OF THE UCBS INITIALIZED SUCCESSFULLY, THEN   @G24LB02*/
*     /* MUST CLEANUP CWB(DEQUEUE AND FREEMAIN). RETURN.     @G24LB02*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0497
*     IF ICBI=ON THEN               /* INITIALIZE BIT ON?    @G24LB02*/
         L     @12,ICBPTR                                          0497
         TM    ICBI(@12),B'10000000'                               0497
         BNO   @RF00497                                            0497
*       DO;                         /* YES, DEQUE AND FREEMAIN CWB 0498
*                                                            @G24LB02*/
*         CWBCOMP=ON;               /* SET SWITCH, CWB PROC COMP   0499
*                                                            @G24LB02*/
         OI    CWBCOMP,B'00000100'                                 0499
*         CALL ICBMSG44;            /* DEQUEUE SUCCESSFUL CWB      0500
*                                                            @G24LB02*/
         BAL   @14,ICBMSG44                                        0500
*         CALL ICBMSG46;            /* FREEMAIN DEQUED CWB   @G24LB02*/
         BAL   @14,ICBMSG46                                        0501
*         ICBCOMQ=F0;               /* CLEAR COMQUE POINTER  @G24LB02*/
         SLR   @12,@12                                             0502
         L     @11,ICBPTR                                          0502
         ST    @12,ICBCOMQ(,@11)                                   0502
*         ICBCOM=F0;                /* CLEAR COMTASK ECB     @G24LB02*/
         ST    @12,ICBCOM(,@11)                                    0503
*         GOTO CKEXIT;              /*                       @G24LB02*/
         B     CKEXIT                                              0504
*       END;                        /*                       @G24LB02*/
*     ELSE                                                         0506
*       DO;                         /*                       @G24LB02*/
@RF00497 DS    0H                                                  0507
*         IF ICBCOMQ^=F0 THEN       /* IS CWB CHAIN EMPTY?   @G24LB02*/
         L     @12,ICBPTR                                          0507
         L     @12,ICBCOMQ(,@12)                                   0507
         LTR   @12,@12                                             0507
         BZ    @RF00507                                            0507
*           DO;                     /*                       @G24LB02*/
*             CALL ICBMSG44;        /* DEQUEUE FAILED CWB    @G24LB02*/
         BAL   @14,ICBMSG44                                        0509
*             CALL ICBMSG46;        /* FREEMAIN FAILED CWB   @G24LB02*/
         BAL   @14,ICBMSG46                                        0510
*             IF ICBCOMQ^=F0 THEN   /* IS CWB CHAIN EMPTY?   @G24LB02*/
         L     @12,ICBPTR                                          0511
         L     @12,ICBCOMQ(,@12)                                   0511
         LTR   @12,@12                                             0511
         BNZ   @RT00511                                            0511
*               GOTO CKCWB;         /* CHECK FOR OTHER CWBS  @G24LB02*/
*           END;                    /*                       @G24LB02*/
*         ICBCOM=F0;                /* CLEAR COMTASK ECB     @G24LB02*/
@RF00507 L     @12,ICBPTR                                          0514
         SLR   @11,@11                                             0514
         ST    @11,ICBCOM(,@12)                                    0514
*         RFY                                                      0515
*           R2 RSTD;                /* RESTRICT REG 2        @G24LB02*/
*         R2=ADDR(ICBCOM);          /* POINT REG 2 TO ECB    @G24LB02*/
         LA    R2,ICBCOM(,@12)                                     0516
*IWAIT7:                            /* LABEL WAIT            @G24LB02*/
*         GEN(WAIT ECB=(R2));       /* ISSUE WAIT            @G24LB02*/
IWAIT7   WAIT ECB=(R2)
*         RFY                                                      0518
*           R2 UNRSTD;              /* FREE REG 2            @G24LB02*/
*         GOTO CKCWB;               /* CHECK FOR OTHER CWBS  @G24LB02*/
         B     CKCWB                                               0519
*       END;                        /*                       @G24LB02*/
*NOMSSC:                                                           0521
*     DO;                           /*                       @G24LB02*/
*                                                                  0521
NOMSSC   DS    0H                                                  0522
*       /*************************************************************/
*       /*                                                           */
*       /* SEND MSS INOPERATIVE MSG - MSC NOT INITIALIZED    @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0522
*       WTOGEN03=NOMSS;             /* LOAD WTO BUFFER       @G24LB02*/
         MVI   WTOGEN03+50,C' '                                    0522
         MVC   WTOGEN03+51(22),WTOGEN03+50                         0522
         MVC   WTOGEN03(50),NOMSS                                  0522
*       CALL ICBMSG45;              /* WRITE MSG TO OPR      @G24LB02*/
         BAL   @14,ICBMSG45                                        0523
*       IF ICBCOMQ^=F0 THEN         /*                       @G24LB02*/
         L     @12,ICBPTR                                          0524
         L     @12,ICBCOMQ(,@12)                                   0524
         LTR   @12,@12                                             0524
         BZ    @RF00524                                            0524
*         DO;                       /*                       @G24LB02*/
*           CALL ICBMSG44;          /*                       @G24LB02*/
         BAL   @14,ICBMSG44                                        0526
*           CALL ICBMSG46;          /*                       @G24LB02*/
         BAL   @14,ICBMSG46                                        0527
*           IF ICBCOMQ^=F0 THEN     /* IS THE CWB CHAIN EMPTY?     0528
*                                                            @G24LB02*/
         L     @12,ICBPTR                                          0528
         L     @12,ICBCOMQ(,@12)                                   0528
         LTR   @12,@12                                             0528
         BNZ   @RT00528                                            0528
*             GOTO CKCWB;           /* CHECK FOR OTHER CWBS  @G24LB02*/
*         END;                      /*                       @G24LB02*/
*       ICBCOM=F0;                  /* CLEAR COMTASK ECB     @G24LB02*/
@RF00524 L     @12,ICBPTR                                          0531
         SLR   @11,@11                                             0531
         ST    @11,ICBCOM(,@12)                                    0531
*       RFY                                                        0532
*         R2 RSTD;                  /* RESTRICT REG 2        @G24LB02*/
*       R2=ADDR(ICBCOM);            /* POINT REG 2 TO ECB    @G24LB02*/
         LA    R2,ICBCOM(,@12)                                     0533
*IWAIT5:                            /* LABEL WAIT            @G24LB02*/
*       GEN(WAIT ECB=(R2));         /* ISSUE WAIT            @G24LB02*/
IWAIT5   WAIT ECB=(R2)
*       RFY                                                        0535
*         R2 UNRSTD;                /* FREE REG 2            @G24LB02*/
*       GOTO CKCWB;                 /*                       @G24LB02*/
         B     CKCWB                                               0536
*     END;                          /*                       @G24LB02*/
*CKEXIT:                                                           0538
*     RFY                                                          0538
*       R14 RSTD;                   /* RESTRICT REG 14       @G24LB02*/
CKEXIT   DS    0H                                                  0539
*     R14=CKUCBR14;                 /*                       @G24LB02*/
         L     R14,CKUCBR14                                        0539
*     RFY                                                          0540
*       R14 UNRSTD;                 /* FREE REG 14           @G24LB02*/
*     RETURN;                       /*                       @G24LB02*/
@EL00004 DS    0H                                                  0541
@EF00004 DS    0H                                                  0541
@ER00004 BR    @14                                                 0541
*   END;                            /*                       @G24LB02*/
@DE00486 TM    CWBCOMP,B'00000100'                                 0542
         BNO   @DL00486                                            0542
*   END CKUCB;                      /*                       @G24LB02*/
         B     @EL00004                                            0543
*                                                                  0544
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*  PROCEDURE NAME - MSG05LCD                               @G24LB02*/
*/*                                                          @G24LB02*/
*/*  FUNCTION - THIS ROUTINE SETS UP ARGUMENTS FOR AND       @G24LB02*/
*/*             INVOKES THE LOAD MACRO.  THE LOAD MACRO      @G24LB02*/
*/*             WILL CAUSE ICBMSG05 TO BE LOADED INTO THE    @G24LB02*/
*/*             SYSTEM. AFTER THE LOAD IS COMPLETED,         @G24LB02*/
*/*             IS CALLED TO DO MSC INITIALIZATION.          @G24LB02*/
*/*             THE DELETE MACRO IS USED TO DELETE ICBMSG05. @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUT - PARAMETERS ARE SET IN THIS ROUTINE              @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT - R15 IS SET TO THE ADDRESS OF ICBMSG05          @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************   @G24LB02*/
*                                                                  0544
*MSG05LCD:                                                         0544
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
MSG05LCD DS    0H                                                  0545
*   RFY                                                            0545
*     R14 RSTD;                     /*                       @G24LB02*/
*   LDMSSR14=R14;                   /* SAVE REG 14           @G24LB02*/
         ST    R14,LDMSSR14                                        0546
*   RFY                                                            0547
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RFY                                                            0548
*    (R0,                                                          0548
*     R1,                                                          0548
*     R15) RSTD;                    /*                       @G24LB02*/
*   GEN REFS(LOADERR) SETS(R0);                                    0549
*                                                          /*@G24LB02*/
LOAD05  LOAD EP=ICBMSG05,ERRET=LOADERR,RELATED=(ICBMSG05,ICB2MSG(CKUCB)*
               )                                             @G24LB02
*   GOTO LOADGD;                    /* LOAD WAS GOOD, BRANCH @G24LB02*/
         B     LOADGD                                              0550
*LOADERR:                           /*                       @G24LB02*/
*   INTER=R1;                       /* CONVERT ERROR RTN     @G24LB02*/
LOADERR  ST    R1,INTER                                            0551
*   FAILCODE=R1;                    /* SAVE FAIL CODE        @G24LB02*/
         ST    R1,FAILCODE                                         0552
*   CALL ICBMSG82;                  /* MAKE RTN PRINTABLE    @G24LB02*/
         BAL   @14,ICBMSG82                                        0553
*   WTOGEN03=MESGS(MSG53301);       /* LOAD MSG BUFFER       @MV44258*/
         MVI   WTOGEN03+72,C' '                                    0554
         L     @14,@CA02101                                        0554
         MVC   WTOGEN03(72),MESGS-MSGS+3040(@14)                   0554
*   WTOGEN03(61:63)=BYTES234;       /* ABEND CODE            @G24LB02*/
         MVC   WTOGEN03+60(3),BYTES234                             0555
*   CALL ICBMSG45;                  /*                       @G24LB02*/
         BAL   @14,ICBMSG45                                        0556
*   RFY                                                            0557
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=LDMSSR14;                   /*                       @G24LB02*/
         L     R14,LDMSSR14                                        0558
*   RFY                                                            0559
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
@EL00005 DS    0H                                                  0560
@EF00005 DS    0H                                                  0560
@ER00005 BR    @14                                                 0560
*LOADGD:                            /*                       @G24LB02*/
*   R15=R0;                         /* SAVE ADDRESS OF ICBMSG05 IN 0561
*                                      R15                   @G24LB02*/
LOADGD   LR    R15,R0                                              0561
*   R1=PURGPTR;                     /* SET UP PARM POINTER FOR MSG05
*                                                            @G24LB02*/
         L     R1,PURGPTR                                          0562
*   MSG05FLG=ON;                    /* ICBMSG05 MODULE IN CONTROL  0563
*                                                            @G24LB02*/
         OI    MSG05FLG,B'01000000'                                0563
*   RFY                                                            0564
*    (R0,                                                          0564
*     R1,                                                          0564
*     R15) UNRSTD;                  /*                       @G24LB02*/
*   GEN REFS(R14,R15);                                             0565
*                                                          /*@G24LB02*/
          BALR   R14,R15      BR AND LINK TO ICBMSG05          @G24LB02
*   MSG05FLG=OFF;                   /* ICBMSG05 NOT IN CONTROL NOW 0566
*                                                            @G24LB02*/
         NI    MSG05FLG,B'10111111'                                0566
*   GEN;                                                           0567
DELET05  DELETE EP=ICBMSG05,RELATED=(ICBMSG05,ICB2MSG(CKUCB))  @G24LB02
*   RFY                                                            0568
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=LDMSSR14;                   /* RESTORE REGISTER 14   @G24LB02*/
         L     R14,LDMSSR14                                        0569
*   RFY                                                            0570
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
         B     @EL00005                                            0571
*   END MSG05LCD;                   /*                       @G24LB02*/
*                                                                  0573
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG10                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = MSC MESSAGE SUBROUTINE               @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = PROCESS MESSAGES FROM MSC                    @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = HANDLE READING OF THE MSC MESSAGE             @Y30LB03
*                BUFFER AND APPROPRIATE ROUTING TO            @Y30LB03
*                OTHER SUBROUTINES FOR PROCESSING THE         @Y30LB03
*                MESSAGE CONTENT. ALSO,TO INTERFACE WITH MSVC @Y30LB03
*                MODULES (VIA SVC 126) FOR CERTAIN MESSAGES.  @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = MSC MESSAGE                                   @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = PROCESSED MSC MESSAGE                        @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  0573
*ICBMSG10:                                                         0573
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       #Y30LB03*/
ICBMSG10 DS    0H                                                  0574
*/*  ****************************************************    #Y30LB03*/
*/*                                                          #Y30LB03*/
*/*    THIS SUBROUTINE HANDLES THE READING OF THE MSC        #Y30LB03*/
*/*    MESSAGE BUFFER AND APPROPRIATE ROUTING TO OTHER       #Y30LB03*/
*/*    SUBROUTINES FOR PROCESSING THE MESSAGE CONTENT.       @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  0574
*   DCL                                                            0574
*     SAVRENT FIXED(31);            /* SAVE AREA FOR REENTRY POINT 0574
*                                                            @G24LB02*/
*   DCL                                                            0575
*     1 USERCB BASED(ICBMSSC),      /* TRAP CONTROL BLOCK    @G24LB02*/
*      2 USERX1 PTR(31),            /* SVC EXIT ONE          @G24LB02*/
*      2 USERX2 PTR(31),            /* SVC EXIT TWO          @G24LB02*/
*      2 USERX3 PTR(31),            /* MSG EXIT ONE          @G24LB02*/
*      2 USERX4 PTR(31),            /* MSG EXIT TWO          @G24LB02*/
*      2 USERX5 PTR(31);            /* AEA EXIT              @G24LB02*/
*   RFY                                                            0576
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1410=R14;                   /* SAVE REG 14           @Y30LB03*/
         ST    R14,SAVR1410                                        0577
*   RFY                                                            0578
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   ICBECB=F0;                      /* CLEAR ICBECB          @Y30LB03*/
         SLR   @12,@12                                             0579
         L     @11,ICBPTR                                          0579
         ST    @12,ICBECB(,@11)                                    0579
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/* TEST TO SEE IF MSC IS ON-LINE                            @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  0580
*   UCBPTR=ICBPUCB;                 /* SET UCB BASE TO       @Y30LB03
*                                      PRIMARY UCB           @Y30LB03*/
         L     @11,ICBPUCB(,@11)                                   0580
         ST    @11,UCBPTR                                          0580
*   IF UCBONLI=BZERO THEN           /* MSC OFFLINE?          @Y30LB03*/
         TM    UCBONLI(@11),B'10000000'                            0581
         BNZ   @RF00581                                            0581
*     DO;                           /*                       @Y30LB03*/
*       IF REENTRY=ADDR(REINIT) THEN/* DURING INITIALIZATION?      0583
*                                                            @Y30LB03*/
         LA    @11,REINIT                                          0583
         C     @11,REENTRY                                         0583
         BNE   @RF00583                                            0583
*         DO;                       /* YES                   @Y30LB03*/
*           CLEANUP=F0;             /* DON'T LOOP WITH MSC OFFLINE 0585
*                                                            @ZA13488*/
         ST    @12,CLEANUP                                         0585
*           RFY                                                    0586
*             R14 RSTD;             /*                       @G24LB02*/
*           R14=SAVR1410;           /* RESET RETURN POINT    @Y30LB03*/
         L     @12,SAVR1410                                        0587
         LR    R14,@12                                             0587
*           RFY                                                    0588
*             R14 UNRSTD;           /*                       @G24LB02*/
*           RETURN;                 /* RETURN                @Y30LB03*/
@EL00006 DS    0H                                                  0589
@EF00006 DS    0H                                                  0589
@ER00006 BR    @14                                                 0589
*         END;                      /*                       @Y30LB03*/
*       ELSE                        /* NOT DURING INITIALIZATION   0591
*                                                            @Y30LB03*/
*         REENTRY=ADDR(WAIT);       /* SET RE-ENTRY POINT    @Y30LB03*/
@RF00583 LA    @12,WAIT                                            0591
         ST    @12,REENTRY                                         0591
*       CALL ICBMSG35;              /* YES,CALL MSC OFF-     @Y30LB03
*                                      LINE ROUTINE          @Y30LB03*/
         BAL   @14,ICBMSG35                                        0592
*     END;                          /*                       @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/* THE REMAINING PORTION OF THE SUBRTN IS EXECUTED WHEN     @Y30LB03*/
*/* MSC IS ON-LINE                                           @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  0594
*   ELSE                            /*                       @Y30LB03*/
*     DO;                           /*                       @Y30LB03*/
         B     @RC00581                                            0594
@RF00581 DS    0H                                                  0595
*       CALL ICBMSG80;              /* CALL I/O INITIALIZATION SUBRTN
*                                                            @Y30LB03*/
         BAL   @14,ICBMSG80                                        0595
*       MSGPTR=ADDR(BUFFER);        /* LD MSGPTR BUFFER ADDR @ZA05076*/
         L     @12,CCWSPTR                                         0596
         LA    @11,24                                              0596
         ALR   @11,@12                                             0596
         ST    @11,MSGPTR                                          0596
*       MSGL=F0;                    /* ZERO MSG LENGTH       @ZA05076*/
         MVI   MSGL(@11),X'00'                                     0597
*       IOSVST=ADDR(CCWS);          /* ADDR OF THE CCWS      @Y30LB03*/
         L     @09,IOSBPTR                                         0598
         ST    @12,IOSVST(,@09)                                    0598
*       OPCODE0=F38;                /* INIT OPCODE OF        @YD00154
*                                      CCW0 TO '26'X         @YD00154*/
         MVI   OPCODE0(@12),X'26'                                  0599
*       DATA0=F0;                   /* INIT DATA0 OF CCW0    @YD00154*/
         SLR   @04,@04                                             0600
         STCM  @04,7,DATA0(@12)                                    0600
*       FLAGS0=F96;                 /* INIT FLAGS0 OF CCW0   @YD00154
*                                      TO '60'X              @YD00154*/
         MVI   FLAGS0(@12),X'60'                                   0601
*       COUNT0=F1;                  /* INIT COUNT0 OF CCW0   @YD00154
*                                      TO '000001'X          @YD00154*/
         LA    @15,1                                               0602
         STCM  @15,7,COUNT0(@12)                                   0602
*       OPCODE=F6;                  /* INIT OPCODE OF        @Y30LB03
*                                      CCW TO '06'X          @Y30LB03*/
         MVI   OPCODE(@12),X'06'                                   0603
*       DATA1=ADDR(BUFFER);         /* INIT DATA1 OF CCW     @Y30LB03*/
         STCM  @11,7,DATA1(@12)                                    0604
*       FLAGS=F96;                  /* INIT FLAGS OF CCW     @Y30LB03
*                                      TO 60                 @YD00154*/
         MVI   FLAGS(@12),X'60'                                    0605
*       COUNT=FF7;                  /* INIT COUNT OF CCW     @ZA08845
*                                      TO '0000F7'X          @ZA08845*/
         MVC   COUNT(3,@12),@CF00741+1                             0606
*       OPCODE2=F3;                 /* INIT NO-OP CCW        @Y30LB03*/
         MVI   OPCODE2(@12),X'03'                                  0607
*       DATA2=F0;                   /*                       @Y30LB03*/
         STCM  @04,7,DATA2(@12)                                    0608
*       FLAGS2=F0;                  /*                       @Y30LB03*/
         MVI   FLAGS2(@12),X'00'                                   0609
*       COUNT2=F1;                  /*                       @Y30LB03*/
         STCM  @15,7,COUNT2(@12)                                   0610
*       RESPECIFY                                                  0611
*        (R1,                                                      0611
*         R13,                                                     0611
*         R15) RSTD;                /* RESTRICT R1,R13,R15   @Y30LB03*/
*       R1=IOSBPTR;                 /* R1 SET TO IOB ADDR    @G24LB02*/
*                                                                  0612
         LR    R1,@09                                              0612
*       /*************************************************************/
*       /*                                                           */
*       /* IF ICBMSSC IS NOT ZERO THEN TRAP HAS BEEN SET.    @G24LB02*/
*       /* CHECK USER EXIT FOR A NON-ZERO PTR, IF NON-ZERO   @G24LB02*/
*       /* THEN BALR TO ADDR IN USERX3 FIELD.                @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0613
*       IF ICBMSSC^=F0 THEN         /*                       @G24LB02*/
         L     @14,ICBPTR                                          0613
         L     @14,ICBMSSC(,@14)                                   0613
         CR    @14,@04                                             0613
         BE    @RF00613                                            0613
*         DO;                       /*                       @G24LB02*/
*           IF USERX3^=F0 THEN      /*                       @G24LB02*/
         C     @04,USERX3(,@14)                                    0615
         BE    @RF00615                                            0615
*             DO;                   /*                       @G24LB02*/
*               SAVRENT=REENTRY;    /* SAVE REENTRY ADDRESS  @G24LB02*/
         L     @14,REENTRY                                         0617
         ST    @14,SAVRENT                                         0617
*               REENTRY=ADDR(UEXITR1);/* SET NEW REENTRY     @G24LB02*/
         LA    @14,UEXITR1                                         0618
         ST    @14,REENTRY                                         0618
*               RFY                                                0619
*                 R15 RSTD;         /* RESTRICT REG 15       @G24LB02*/
*               GEN(STM   0,15,SAVX);/* SAVE REGS            @ZA17151*/
         STM   0,15,SAVX
*               R15=USERX3;         /* SET REG 15 TO ENTRY   @ZA17151*/
         L     @12,ICBPTR                                          0621
         L     @12,ICBMSSC(,@12)                                   0621
         L     R15,USERX3(,@12)                                    0621
*               GEN(BALR  14,15);   /* BRANCH TO TRAP ROUTINE      0622
*                                                            @G24LB02*/
         BALR  14,15
*UEXITR1:                           /* LABEL FOR EXIT RETURN @G24LB02*/
*               GEN(LM    0,15,SAVX);/* RESTORE REGS         @ZA17151*/
UEXITR1  LM    0,15,SAVX
*               REENTRY=SAVRENT;    /* RESTORE REENTRY ADDRESS     0624
*                                                            @G24LB02*/
         L     @14,SAVRENT                                         0624
         ST    @14,REENTRY                                         0624
*               RFY                                                0625
*                 R15 UNRSTD;       /* FREE REG 15           @G24LB02*/
*             END;                  /*                       @G24LB02*/
*         END;                      /*                       @G24LB02*/
@RF00615 DS    0H                                                  0628
*       RFY                                                        0628
*         R15 RSTD;                 /*                       @G24LB02*/
@RF00613 DS    0H                                                  0629
*       R1=SRBPTR;                  /* R1 SET TO SRB ADDR    @Y30LB03*/
         L     R1,SRBPTR                                           0629
*       GEN(LA    R13,SAVAREA);     /* RESET SAVE AREA ADDR  @ZA16123*/
         LA    R13,SAVAREA
*       R15=ICBSIOP;                /* GET I/O DRVR ADDR     @Y30LB03*/
         L     @12,ICBPTR                                          0631
         L     R15,ICBSIOP(,@12)                                   0631
*       GEN(BALR  R14,R15);         /* ISSUE I/O             @Y30LB03*/
         BALR  R14,R15
*       RESPECIFY                                                  0633
*        (R1,                                                      0633
*         R13) UNRSTD;              /*                       @Y30LB03*/
*       IF R15=F0 THEN              /* GOOD RTN?             @Y30LB03*/
         LTR   R15,R15                                             0634
         BNZ   @RF00634                                            0634
*         DO;                       /* YES,                  @Y30LB03*/
*           RESPECIFY                                              0636
*             R15 UNRSTD;           /* RELEASE R15           @Y30LB03*/
*           RESPECIFY                                              0637
*             R2 RSTD;              /* RESTRICT R2           @Y30LB03*/
*           R2=SSCDATAP;            /* R2 SET TO ECB ADDR    @Y30LB03*/
         L     R2,SSCDATAP                                         0638
*IWAIT2:                                                           0639
*           GEN(WAIT  ECB=(R2));    /* WAIT ON IOECB         @Y30LB03*/
IWAIT2   WAIT  ECB=(R2)
*           RESPECIFY                                              0640
*            (R1,                                                  0640
*             R2) UNRSTD;           /* RELEASE REGS          @Y30LB03*/
*                                                                  0640
*           /*********************************************************/
*           /*                                                       */
*           /* IF ICBMSSC IS NOT ZERO THEN TRAP HAS BEEN SET.        */
*           /*                                               @G24LB02*/
*           /* CHECK USER EXIT FOR A NON-ZERO PTR, IF NON-ZERO       */
*           /*                                               @G24LB02*/
*           /* THEN BALR TO ADDR IN USERX4 FIELD.            @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0641
*           IF ICBMSSC^=F0 THEN     /*                       @G24LB02*/
         SLR   @12,@12                                             0641
         L     @11,ICBPTR                                          0641
         L     @11,ICBMSSC(,@11)                                   0641
         CR    @11,@12                                             0641
         BE    @RF00641                                            0641
*             DO;                   /*                       @G24LB02*/
*               IF USERX4^=F0 THEN  /*                       @G24LB02*/
         C     @12,USERX4(,@11)                                    0643
         BE    @RF00643                                            0643
*                 DO;               /*                       @G24LB02*/
*                   SAVRENT=REENTRY;/* SAVE REENTRY ADDRESS  @G24LB02*/
         L     @12,REENTRY                                         0645
         ST    @12,SAVRENT                                         0645
*                   REENTRY=ADDR(UEXITR2);/* SET NEW REENTRY @G24LB02*/
         LA    @12,UEXITR2                                         0646
         ST    @12,REENTRY                                         0646
*                   RFY                                            0647
*                    (R1,                                          0647
*                     R15) RSTD;    /* RESTRICT REG 15       @G24LB02*/
*                   R1=IOSBPTR;     /* RESET IOB POINTER     @G24LB02*/
         L     R1,IOSBPTR                                          0648
*                   GEN(STM   0,15,SAVX);/* SAVE REGS        @ZA17151*/
         STM   0,15,SAVX
*                   R15=USERX4;     /* SET REG 15 TO ENTRY   @ZA17151*/
         L     @12,ICBPTR                                          0650
         L     @12,ICBMSSC(,@12)                                   0650
         L     R15,USERX4(,@12)                                    0650
*                   GEN(BALR  14,15);/* BRANCH TO TRAP ROUTINE     0651
*                                                            @G24LB02*/
         BALR  14,15
*                   GEN(LM    0,15,SAVX);/* RESTORE REGS     @ZA17151*/
         LM    0,15,SAVX
*                   RFY                                            0653
*                    (R1,                                          0653
*                     R15) UNRSTD;  /* FREE REG 15           @G24LB02*/
*UEXITR2:                           /* LABEL FOR EXIT RETURN @G24LB02*/
*                   REENTRY=SAVRENT;/* RESTORE REENTRY ADDRESS     0654
*                                                            @G24LB02*/
UEXITR2  L     @12,SAVRENT                                         0654
         ST    @12,REENTRY                                         0654
*                 END;              /*                       @G24LB02*/
*             END;                  /*                       @G24LB02*/
*                                                                  0656
@RF00643 DS    0H                                                  0657
*           /*********************************************************/
*           /*                                                       */
*           /* END OF TRAP CODE                              @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0657
*           IF ECBCODE^=CHAR7F THEN /* POST CODE^='7F'X?(BAD)      0657
*                                                            @Y30LB03*/
@RF00641 L     @12,SSCDATAP                                        0657
         CLI   ECBCODE(@12),X'7F'                                  0657
         BE    @RF00657                                            0657
*             DO;                   /* YES,BAD POST CODE     @Y30LB03*/
*               IF REENTRY=ADDR(REINIT) THEN/* DURING INITIALIZATION?
*                                                            @Y30LB03*/
         LA    @12,REINIT                                          0659
         C     @12,REENTRY                                         0659
         BNE   @RF00659                                            0659
*                 DO;               /* YES                   @Y30LB03*/
*                   IF NON7F>F12 THEN/* DON'T ALLOW MORE THAN 12 I/O
*                                      ERRS                  @ZA13488*/
         L     @12,NON7F                                           0661
         C     @12,@CF02050                                        0661
         BNH   @RF00661                                            0661
*                     DO;           /* RESET TO STOP LOOP ON I/O ERRS
*                                                            @ZA13488*/
*                       NON7F=F0;   /* RESET I/O ERROR CNTR  @ZA13488*/
         SLR   @12,@12                                             0663
         ST    @12,NON7F                                           0663
*                       CLEANUP=F0; /* RESET CLEANUP TO GET OUT OF 0664
*                                      LOOP                  @ZA13488*/
         ST    @12,CLEANUP                                         0664
*                     END;          /*                       @ZA13488*/
*                   NON7F=NON7F+F1; /* INCREMENT I/O ERR COUNTER   0666
*                                                            @ZA13488*/
@RF00661 LA    @12,1                                               0666
         AL    @12,NON7F                                           0666
         ST    @12,NON7F                                           0666
*                   RFY                                            0667
*                     R14 RSTD;     /*                       @G24LB02*/
*                   R14=SAVR1410;   /* RESET RETURN POINT    @Y30LB03*/
         L     R14,SAVR1410                                        0668
*                   RFY                                            0669
*                     R14 UNRSTD;   /*                       @G24LB02*/
*                   RETURN;         /* RETURN                @Y30LB03*/
         B     @EL00006                                            0670
*                 END;              /*                       @Y30LB03*/
*               ELSE                /* NOT DURING INITIALIZATION   0672
*                                                            @Y30LB03*/
*                 REENTRY=ADDR(ICBMSG30);/* SET RENTRY       @Y30LB03*/
@RF00659 LA    @12,ICBMSG30                                        0672
         ST    @12,REENTRY                                         0672
*               CALL ICBMSG30;      /* CALL ICBMSG30         @Y30LB03*/
         BAL   @14,ICBMSG30                                        0673
*             END;                  /*                       @Y30LB03*/
*           ELSE                    /* NO,GOOD POST CODE     @Y30LB03*/
*             DO;                   /* CONTINUE PROCESSING   @Y30LB03
*                                      MESSAGE               @Y30LB03*/
         B     @RC00657                                            0675
@RF00657 DS    0H                                                  0676
*               MSGPTR=ADDR(BUFFER);/* LD MSGPTR BUFFER ADDR @Y30LB03*/
         LA    @12,24                                              0676
         AL    @12,CCWSPTR                                         0676
         ST    @12,MSGPTR                                          0676
*               LENCNTR=F0;         /* TO CONTAIN TOTAL      @Y30LB03
*                                      LENGTH OF MSGS        @Y30LB03*/
         SLR   @12,@12                                             0677
         ST    @12,LENCNTR                                         0677
*/*********************************************************  @Y30LB03*/
*/* DEBLOCK AND ROUTE MSGS IN MSG BUFFER                     @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  0678
*PROCMSG:                                                          0678
*               DO WHILE(MSGL^=F0&LENCNTR<F248);/* DO IF MSGL^=0   0678
*                                                            @ZA08845
*                                      AND TOTAL LENGTH      @Y30LB03
*                                      < 248                 @ZA08845*/
PROCMSG  B     @DE00678                                            0678
@DL00678 DS    0H                                                  0679
*                 IF REENTRY^=ADDR(REINIT) THEN/* DURING           0679
*                                      INITIALIZATION?       @Y30LB03*/
         LA    @12,REINIT                                          0679
         C     @12,REENTRY                                         0679
         BE    @RF00679                                            0679
*                   REENTRY=ADDR(PROCMSG);/* NO,SET RE-ENTRY POINT 0680
*                                                            @Y30LB03*/
         LA    @12,PROCMSG                                         0680
         ST    @12,REENTRY                                         0680
*                 IF(MSGC='04'XMSGC='0A'X/*                @Y30LB03*/
*                     MSGC='0D'XMSGC='83'X) THEN/* MSVC NEED MSG  0681
*                                                            @Y30LB03*/
@RF00679 L     @12,MSGPTR                                          0681
         CLI   MSGC(@12),4                                         0681
         BE    @RT00681                                            0681
         CLI   MSGC(@12),10                                        0681
         BE    @RT00681                                            0681
         CLI   MSGC(@12),13                                        0681
         BE    @RT00681                                            0681
         CLI   MSGC(@12),131                                       0681
         BNE   @RF00681                                            0681
@RT00681 DS    0H                                                  0682
*                   DO;             /* YES,                  @Y30LB03*/
*                     MESLNGTH=MESLEN;/* INIT LENGTH FIELD   @Y30LB03*/
         L     @12,MESGPTR                                         0683
         LH    @11,MESLEN                                          0683
         ST    @11,MESLNGTH(,@12)                                  0683
*                     MESOPCD=MESOP;/* INIT OPCODE FIELD     @Y30LB03*/
         MVI   MESOPCD(@12),X'86'                                  0684
*                     MESGBUF=MSG1; /* INIT BUFFER FIELD W/ MSG    0685
*                                                            @Y30LB03*/
         L     @11,MSGPTR                                          0685
         MVC   MESGBUF(60,@12),MSG1(@11)                           0685
*                     RESPECIFY                                    0686
*                      (R0,                                        0686
*                       R1,                                        0686
*                       R13,                                       0686
*                       R15) RSTD;  /*                       @ZA29990*/
*                     R0=NULL;      /* CLEAR REG 0           @ZA29990*/
         SLR   R0,R0                                               0687
*                     R1=MESGPTR;   /* LOAD REG1 W ADDR MSG  @ZA29990*/
         LR    R1,@12                                              0688
*                     R15=ICBVVIC;  /* LOAD MSVC ADDRESS     @ZA29990*/
         L     @12,ICBPTR                                          0689
         L     R15,ICBVVIC(,@12)                                   0689
*                     R13=ADDR(SAVAREA);/* LOAD SAVE AREA ADDR     0690
*                                                            @ZA29990*/
         LA    R13,SAVAREA                                         0690
*                     GEN(BALR  14,15);/* BRANCH TO MSVC     @ZA29990*/
         BALR  14,15
*                     RESPECIFY                                    0692
*                      (R0,                                        0692
*                       R1,                                        0692
*                       R13,                                       0692
*                       R15) UNRSTD;/*                       @ZA29990*/
*                   END;            /*                       @Y30LB03*/
*                 IF MSGC<='70'X THEN/* CODE TO POST ECB ?   @Y30LB03*/
@RF00681 L     @12,MSGPTR                                          0694
         CLI   MSGC(@12),112                                       0694
         BH    @RF00694                                            0694
*                   DO;             /* YES, ....             @Y30LB03*/
*                     CALL ICBMSG20;/* CALL ROUTINE THAT     @Y30LB03
*                                      POSTS USER'S ECB      @Y30LB03*/
         BAL   @14,ICBMSG20                                        0696
*                   END;            /*                       @Y30LB03*/
*                 ELSE              /* BYPASS POSTING        @Y30LB03*/
*                   DO;             /*                       @Y30LB03*/
         B     @RC00694                                            0698
@RF00694 DS    0H                                                  0699
*                     CALL ICBMSG15;/* CALL WTO SUB-RTN      @Y30LB03*/
         BAL   @14,ICBMSG15                                        0699
*                   END;            /*                       @Y30LB03*/
*                 LENCNTR=LENCNTR+MSGL;/* INCR LENGTH CTR    @Y30LB03*/
@RC00694 L     @12,MSGPTR                                          0701
         SLR   @11,@11                                             0701
         IC    @11,MSGL(,@12)                                      0701
         L     @09,LENCNTR                                         0701
         ALR   @09,@11                                             0701
         ST    @09,LENCNTR                                         0701
*                 MSGPTR=MSGPTR+MSGL;/* POINT TO NEXT MSG    @Y30LB03*/
         ALR   @12,@11                                             0702
         ST    @12,MSGPTR                                          0702
*               END;                /*                       @Y30LB03*/
@DE00678 L     @12,MSGPTR                                          0703
         CLI   MSGL(@12),0                                         0703
         BE    @DC00678                                            0703
         L     @12,LENCNTR                                         0703
         C     @12,@CF00741                                        0703
         BL    @DL00678                                            0703
@DC00678 DS    0H                                                  0704
*               CLEANUP=LENCNTR;    /* SET CLEANUP SWITCH--  @Y30LB03
*                                      0'S IMPLIES HAVE CLEANED    0704
*                                                            @Y30LB03
*                                      UP GARBAGE LEFT FROM  @Y30LB03
*                                      PREVIOUS IPL          @Y30LB03*/
         L     @12,LENCNTR                                         0704
         ST    @12,CLEANUP                                         0704
*             END;                  /*                       @Y30LB03*/
*         END;                      /*                       @Y30LB03*/
*       ELSE                        /* I/O DIDN'T WORK       @Y30LB03*/
*         CLEANUP=F0;               /* CLEAR CLEAN-UP SWITCH @Y30LB03*/
         B     @RC00634                                            0707
@RF00634 SLR   @12,@12                                             0707
         ST    @12,CLEANUP                                         0707
*       RESPECIFY                                                  0708
*         R15 UNRSTD;               /* RELEASE R15           @Y30LB03*/
@RC00634 DS    0H                                                  0709
*     END;                          /*                       @Y30LB03*/
*EXIT10:                                                           0710
*   RFY                                                            0710
*     R14 RSTD;                     /*                       @G24LB02*/
@RC00581 DS    0H                                                  0710
EXIT10   DS    0H                                                  0711
*   R14=SAVR1410;                   /* RESTORE REG 14        @Y30LB03*/
         L     R14,SAVR1410                                        0711
*   RFY                                                            0712
*     R14 RSTD;                     /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICB2MSG        @Y30LB03*/
         B     @EL00006                                            0713
*   END ICBMSG10;                   /*                       @Y30LB03*/
*                                                                  0715
*/******************************************************     @Z40LB01*/
*/*                                                          @Z40LB01*/
*/* PROCEDURE NAME - ICBMSG15                                @Z40LB01*/
*/*                                                          @Z40LB01*/
*/* FUNCTION - THE PRIMARY PURPOSE OF THIS SUBROUTINE IS TO  @Z40LB01*/
*/*            TRANSLATE DATA FROM MSC UNSOLICITED MESSAGES  @Z40LB01*/
*/*            AND ISSUE WTO MACROS TO WRITE THE TRANSLATED  @Z40LB01*/
*/*            MESSAGE TO THE OPERATOR.                      @Z40LB01*/
*/*            OTHER FUNCTIONS -                             @Z40LB01*/
*/*                    WHEN AN MSC MESSAGE WITH A MESSAGE    @Z40LB01*/
*/*            CODE OF X'91' IS RECEIVED WHEN THE MSC HAS    @Z40LB01*/
*/*            OFFLOADED ENVIRONMENTAL DATA AND THIS MESSAGE @Z40LB01*/
*/*            IS INTERCEPTED AND AND IGNORED.               @Z40LB01*/
*/*                     WHEN MESSAGES WITH MESSAGE CODE      @Z40LB01*/
*/*            X'92' ARE RECEIVED, A TEST IS MADE OF A FLAG  @Z40LB01*/
*/*            (MSG92FLG) AND IF IT IS SET TO B'1' THEN      @Z40LB01*/
*/*            THE MESSAGE WAS REQUESTED BY THE DISPLAY      @Z40LB01*/
*/*            3850 SUBROUTINE AND EXECUTION IS THEN ROUTED  @Z40LB01*/
*/*            TO THE DISPLAY 3850 PROCESSOR SUBROUTINE      @Z40LB01*/
*/*            (ICBMSG56). IF THE FLAG IS NOT SET TO B'1'    @Z40LB01*/
*/*            THEN EXECUTION IS ROUTED TO THE CONFIG -      @Z40LB01*/
*/*            URATION ERROR SUBROUTINE (ICBMSG16) AND       @Z40LB01*/
*/*            THE SMF RECORD WRITE SUBROUTINE (ICBMSG17).   @Z40LB01*/
*/*                     WHEN MESSAGES WITH MESSAGE CODE      @Z40LB01*/
*/*            X'90' ARE RECEIVED, EXECUTION IS ROUTED       @Z40LB01*/
*/*            TO THE CONFIGURATION ERROR SUBROUTINE         @Z40LB01*/
*/*            (ICBMSG16.                                    @Z40LB01*/
*/*                                                          @Z40LB01*/
*/* INPUTS - MSGPTR SET                                      @Z40LB01*/
*/*                                                          @Z40LB01*/
*/* OUTPUTS - WTO MESSAGES FOR UNSOLICITED MSC MESSAGES.     @Z40LB01*/
*/*                                                          @Z40LB01*/
*/* MESSAGES ISSUED -                                        @Z40LB01*/
*/*         ICB080I                                          @Z40LB01*/
*/*         ICB081I                                          @Z40LB01*/
*/*         ICB082I                                          @Z40LB01*/
*/*         ICB083I                                          @Z40LB01*/
*/*         ICB084I                                          @Z40LB01*/
*/*         ICB085I                                          @Z40LB01*/
*/*         ICB093I                                          @Z40LB01*/
*/*         ICB100I                                          @Z40LB01*/
*/*         ICB095A                                          @Z40LB01*/
*/*         ICB096D                                          @ZA32787*/
*/*         ICB097I                                          @Z40LB01*/
*/*         ICB098I                                          @Z40LB01*/
*/*         ICB101I                                          @Z40LB01*/
*/*         ICB102E                                          @ZA17153*/
*/*         ICB194E                                          @Z40LB01*/
*/*                                                          @Z40LB01*/
*/******************************************************     @Z40LB01*/
*                                                                  0715
*ICBMSG15:                                                         0715
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @XD00086*/
ICBMSG15 DS    0H                                                  0716
*   DCL                                                            0716
*     CHAR1F BIT(8) INIT('1F'X);    /* HEX 1F                @Z40LB01*/
*   DCL                                                            0717
*     1 MSG15SW BIT(8),             /* BIT SWITCHES          @Z40LB01*/
*      2 DESC2 BIT(1),              /* DESC CODE 2 NEEDED    @Z40LB01*/
*      2 DESC3 BIT(1),              /* DESC CODE 3 NEEDED    @Z40LB01*/
*      2 ROUT24 BIT(1),             /* ROUT 2 AND 4          @Z40LB01*/
*      2 WTOOK BIT(1),              /* WTO SWITCH            @Z40LB01*/
*      2 * BIT(4);                  /* RESERVED              @Z40LB01*/
*   DCL                                                            0718
*     DESCR2 BIT(16) INIT('4000'X); /* DESC 2 BYTES          @Z40LB01*/
*   DCL                                                            0719
*     DESCR3 BIT(16) INIT('2000'X); /* DESC 3 BYTES          @Z40LB01*/
*   DCL                                                            0720
*     SAVDESC BIT(16);              /* SAVE ORIG DESC        @Z40LB01*/
*   DCL                                                            0721
*     ROUTE24 BIT(16) INIT('5000'X);/* ROUT CODE 24          @Z40LB01*/
*   DCL                                                            0722
*     SAVROUT BIT(16);              /* SAVE ORIG ROUTE CODE  @Z40LB01*/
*/********************************************************   @Z40LB01*/
*/* FORMAT OF LZYX IN MSG                                    @Z40LB01*/
*/********************************************************   @Z40LB01*/
*                                                                  0723
*   DCL                                                            0723
*     LZYXPTR PTR(31);              /* BASE POINTER          @ZA17153*/
*   DCL                                                            0724
*     1 MSGLZYX FIXED(16) BASED(LZYXPTR),/*                  @ZA17153*/
*      2 MSGFLZY FIXED(8),          /* MSF, Z LOC            @Z40LB01
*                                      AND Y LOC ARE IN THIS @Z40LB01
*                                      BYTE                  @Z40LB01*/
*       3 MSGCY CHAR(1),            /* Y IN CHARACTER -      @Z40LB01
*                                      (AFTER BITS0-2 0'D    @Z40LB01*/
*        4 MSGLZY BIT(8),           /* BIT REP OF BYTE       @Z40LB01*/
*      2 MSGCX CHAR(1),             /* X LOC IN CHARACTER    @Z40LB01*/
*       3 MSGFX FIXED(8);           /* X LOC IN FIXED REP    @Z40LB01*/
*/********************************************************   @Z40LB01*/
*/* DATA AREA THAT IS FILLED WITH PRINTABLE MSF,             @Z40LB01*/
*/*Z,Y, AND X LOCATIONS.  IT IS THIS FIELD THAT IS FINALLY   @Z40LB01*/
*/*INSERTED INTO TO MSG TO BE WTO'D                          @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  0725
*   DCL                                                            0725
*     1 PRNTLZYX,                   /*                       @Z40LB01*/
*      2 PRINTL CHAR(1),            /* MSF                   @Z40LB01*/
*      2 PRINTX CHAR(3),            /* X LOCATION            @Z40LB01*/
*      2 PRINTY CHAR(2),            /* Y LOCATION            @Z40LB01*/
*      2 PRINTZ CHAR(1);            /* Z LOCATION            @Z40LB01*/
*/********************************************************   @ZA17153*/
*/*  REDEFINED STATUS BYTE FOR MSC MSG CODE 9C               @ZA17153*/
*/********************************************************   @ZA17153*/
*                                                                  0726
*   DCL                                                            0726
*     1 STATBYTE BIT(16) BASED(MSGPTR+2),/*                  @ZA17153*/
*      2 BADLAB BIT(1),             /* LABEL UNREADABLE FLAG @ZA17153*/
*      2 * BIT(15);                 /*                       @ZA17153*/
*   DCL                                                            0727
*     LNOT CHAR(4) INIT('NOT ');    /* LIT NOT FOR 83 MSG    @ZA09555*/
*   DCL                                                            0728
*     LALSO CHAR(4) INIT('ALSO');   /* LIT ALSO FOR 83 MSG   @ZA09555*/
*   DCL                                                            0729
*     CMMA CHAR(1) INIT(',');       /* LIT COMMA FOR MSGS    @ZA17153*/
*   RFY                                                            0730
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1415=R14;                   /*                       @Z40LB01*/
         ST    R14,SAVR1415                                        0731
*   RFY                                                            0732
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   MSG15SW=''B;                    /* CLEAR LOCAL SWITCHES  @Z40LB01*/
         MVI   MSG15SW,X'00'                                       0733
*   SAVROUT=WTOGEN05;               /* SAVE ORIG ROUT CODE   @Z40LB01*/
         MVC   SAVROUT(2),WTOGEN05                                 0734
*   SAVDESC=WTOGEN04;               /* SAVE ORIG DESC CODE   @Z40LB01*/
         MVC   SAVDESC(2),WTOGEN04                                 0735
*/*************************************************          @Z40LB01*/
*/* CHECK FOR A MSG CODE OF '92'X AND IF THE DISPLAY REQUEST @Z40LB01*/
*/* FLAG (MSG92FLG) IS SET TO '1'B ROUTE EXECUTION TO THE    @Z40LB01*/
*/* DISPLAY PROCESSOR ROUTINE ICBMSG56.                      @Z40LB01*/
*/*************************************************          @Z40LB01*/
*                                                                  0736
*   IF MSGC='92'X&MSG92FLG=BONE THEN/* MSG FOR DISPLAY       @Z40LB01*/
         L     @12,MSGPTR                                          0736
         CLI   MSGC(@12),146                                       0736
         BNE   @RF00736                                            0736
         TM    MSG92FLG,B'10000000'                                0736
         BNO   @RF00736                                            0736
*     DO;                           /*                       @ZA16123*/
*       MSG92FLG=BZERO;             /* RESET MSG92 FLAG      @ZA16123*/
         NI    MSG92FLG,B'01111111'                                0738
*       GEN(LA    R13,SAVAREA);     /* SET SAVE AREA ADDR    @ZA16123*/
         LA    R13,SAVAREA
*       CALL ICBMSG56;              /* CALL DISPLAY SUB      @Z40LB01*/
         L     @15,@CV00087                                        0740
         BALR  @14,@15                                             0740
*     END;                          /*                       @ZA16123*/
*/*************************************************          @Z40LB01*/
*/* CHECK FOR MSG CODE OF '90'X OR '92'X                     @Z40LB01*/
*/*************************************************          @Z40LB01*/
*                                                                  0742
*   ELSE                            /*                       @Z40LB01*/
*     IF(MSGC='90'XMSGC='92'X) THEN/*                       @Z40LB01*/
         B     @RC00736                                            0742
@RF00736 L     @12,MSGPTR                                          0742
         CLI   MSGC(@12),144                                       0742
         BE    @RT00742                                            0742
         CLI   MSGC(@12),146                                       0742
         BNE   @RF00742                                            0742
@RT00742 DS    0H                                                  0743
*       CALL ICBMSG18;              /* CALL CONFIG SUBRTN    @Z40LB01*/
         BAL   @14,ICBMSG18                                        0743
*                                                                  0744
*/*********************************************************  @Z40LB01*/
*/* USING THE MESSAGE CODE CONTAINED IN THE MSC MESSAGE,     @Z40LB01*/
*/* FIND THE APPROPRIATE SKELETON MESSAGE TEXT AND FILL      @Z40LB01*/
*/* THE APPROPRIATE DATA FIELDS FROM THE MSC MESSAGE.        @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  0744
*     ELSE                          /* UNSOLICITED MESSAGE PROCESS 0744
*                                                            @Z40LB01*/
*       DO;                         /*                       @Z40LB01*/
*                                                                  0744
         B     @RC00742                                            0744
@RF00742 DS    0H                                                  0745
*         /***********************************************************/
*         /*                                                         */
*         /* CERTAIN MESSAGES REQUIRE THE LZYX CARTRIDGE LOCATION    */
*         /*                                                 @Z40LB01*/
*         /* WHICH MUST BE TRANSLATED TO PRINTABLE CHARACTERS.       */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0745
*         IF MSGC='80'X            /* UNSOLICITED MSG 80    @Z40LB01*/
*             MSGC='81'X           /* UNSOLICITED MSG 81    @Z40LB01*/
*             MSGC='82'X           /* UNSOLICITED MSG 82    @Z40LB01*/
*             MSGC='83'X           /* UNSOLICITED MSG 83    @ZA17153*/
*             MSGC='9C'X THEN       /* UNSOLICITED MSG 9C    @ZA17153*/
         L     @12,MSGPTR                                          0745
         CLI   MSGC(@12),128                                       0745
         BE    @RT00745                                            0745
         CLI   MSGC(@12),129                                       0745
         BE    @RT00745                                            0745
         CLI   MSGC(@12),130                                       0745
         BE    @RT00745                                            0745
         CLI   MSGC(@12),131                                       0745
         BE    @RT00745                                            0745
         CLI   MSGC(@12),156                                       0745
         BNE   @RF00745                                            0745
@RT00745 DS    0H                                                  0746
*           DO;                     /* THESE MESSAGES REQUIRE LZYX 0746
*                                      DATA TRANSLATED       @Z40LB01*/
*             IF MSGC='9C'X THEN    /* FOR 9C LZYX IS OFFSET 17    0747
*                                                            @ZA17153*/
         L     @12,MSGPTR                                          0747
         CLI   MSGC(@12),156                                       0747
         BNE   @RF00747                                            0747
*               LZYXPTR=MSGPTR+16;  /* SET LZYX FIELD POINTER      0748
*                                                            @ZA17153*/
         AL    @12,@CF00090                                        0748
         ST    @12,LZYXPTR                                         0748
*             ELSE                  /* OTHER LZYX FLDS AT OFFSET 3 0749
*                                                            @ZA17153*/
*               LZYXPTR=MSGPTR+2;   /* SET LZYX FIELD POINTER      0749
*                                                            @ZA17153*/
         B     @RC00747                                            0749
@RF00747 LA    @12,2                                               0749
         AL    @12,MSGPTR                                          0749
         ST    @12,LZYXPTR                                         0749
*             IF MSGLZY(1:2)=B2ZERO THEN/* MSF 0?            @Z40LB01*/
@RC00747 L     @12,LZYXPTR                                         0750
         TM    MSGLZY(@12),B'11000000'                             0750
         BNZ   @RF00750                                            0750
*               PRINTL='F0'X;       /* YES,INIT AS SUCH      @Z40LB01*/
         MVI   PRINTL,X'F0'                                        0751
*             ELSE                  /* NO,CHECK NEXT CASE    @Z40LB01*/
*               IF MSGLZY(1:2)=B2ZERONE THEN/* IS THIS MSF 1?      0752
*                                                            @Z40LB01*/
         B     @RC00750                                            0752
@RF00750 L     @12,LZYXPTR                                         0752
         TM    MSGLZY(@12),B'01000000'                             0752
         BNO   @RF00752                                            0752
         TM    MSGLZY(@12),B'10000000'                             0752
         BNZ   @RF00752                                            0752
*                 PRINTL='F1'X;     /* YES,INIT AS SUCH      @Z40LB01*/
         MVI   PRINTL,X'F1'                                        0753
*               ELSE                /* NO,CHECK NEXT CASE    @Z40LB01*/
*                 IF MSGLZY(1:2)=B2ONEZER THEN/* IS THIS MSF 2?    0754
*                                                            @Z40LB01*/
         B     @RC00752                                            0754
@RF00752 L     @12,LZYXPTR                                         0754
         TM    MSGLZY(@12),B'10000000'                             0754
         BNO   @RF00754                                            0754
         TM    MSGLZY(@12),B'01000000'                             0754
         BNZ   @RF00754                                            0754
*                   PRINTL='F2'X;   /* YES,INIT AS SUCH      @Z40LB01*/
         MVI   PRINTL,X'F2'                                        0755
*                 ELSE              /* HAS TO BE MSF 3       @Z40LB01*/
*                   PRINTL='F3'X;   /* INIT AS 3             @Z40LB01*/
*                                                                  0756
         B     @RC00754                                            0756
@RF00754 MVI   PRINTL,X'F3'                                        0756
*             /*******************************************************/
*             /*                                                     */
*             /* NOW, CONVERT Z LOCATION                     @Z40LB01*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0757
*             IF MSGLZY(3:3)=BZERO THEN/* IS Z 0?            @Z40LB01*/
@RC00754 DS    0H                                                  0757
@RC00752 DS    0H                                                  0757
@RC00750 L     @12,LZYXPTR                                         0757
         TM    MSGLZY(@12),B'00100000'                             0757
         BNZ   @RF00757                                            0757
*               PRINTZ='F0'X;       /* INIT Z AS ZERO        @Z40LB01*/
         MVI   PRINTZ,X'F0'                                        0758
*             ELSE                  /* NO,HAS TO BE 1        @Z40LB01*/
*               PRINTZ='F1'X;       /* INIT Z AS ONE         @Z40LB01*/
*                                                                  0759
         B     @RC00757                                            0759
@RF00757 MVI   PRINTZ,X'F1'                                        0759
*             /*******************************************************/
*             /*                                                     */
*             /* ZERO THESE 3 BITS THAT HAVE                 @Z40LB01*/
*             /* JUST BEEN CONVERTED TO                      @Z40LB01*/
*             /* PRINTABLE CHARACTERS                        @Z40LB01*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0760
*             MSGLZY=MSGLZY&CHAR1F; /*                       @Z40LB01*/
*                                                                  0760
@RC00757 L     @12,LZYXPTR                                         0760
         NC    MSGLZY(1,@12),CHAR1F                                0760
*             /*******************************************************/
*             /*                                                     */
*             /* NOW, MSGCY CONTAINS Y LOCATION              @Z40LB01*/
*             /* ONLY (ANOTHER NAME FOR MSGLZY)              @Z40LB01*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0761
*             INTER=''B;            /* INIT FIELD            @Z40LB01*/
         XC    INTER(4),INTER                                      0761
*             BYTE4=MSGCY;          /* PUT Y LOC IN LAST BYTE      0762
*                                                            @Z40LB01*/
         SLR   @11,@11                                             0762
         IC    @11,MSGCY(,@12)                                     0762
         STC   @11,BYTE4                                           0762
*             CVD(BYTE4,INTER);     /* CONVERT Y TO DECIMAL  @Z40LB01*/
         CVD   @11,@TS00001                                        0763
         MVC   INTER(4),@TS00001+4                                 0763
*             INTER=INTER/F16;      /* CLEAR SIGN            @Z40LB01*/
         L     @12,INTER                                           0764
         SRL   @12,4                                               0764
         ST    @12,INTER                                           0764
*             CALL ICBMSG82;        /* CONV SUB ROUTINE      @Z40LB01*/
         BAL   @14,ICBMSG82                                        0765
*             PRINTY=BYTES34;       /* FILL IN CONVERTED Y LOC     0766
*                                                            @Z40LB01*/
*                                                                  0766
         MVC   PRINTY(2),BYTES34                                   0766
*             /*******************************************************/
*             /*                                                     */
*             /* HAVE TO CONVERT X LOC YET                   @Z40LB01*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0767
*             INTER=''B;            /* INIT FIELD            @Z40LB01*/
         XC    INTER(4),INTER                                      0767
*             BYTE4=MSGCX;          /* PUT X LOC IN LAST BYTE      0768
*                                                            @Z40LB01*/
         L     @12,LZYXPTR                                         0768
         SLR   @11,@11                                             0768
         IC    @11,MSGCX(,@12)                                     0768
         STC   @11,BYTE4                                           0768
*             CVD(BYTE4,INTER);     /* CONVERT X TO DECIMAL  @Z40LB01*/
         CVD   @11,@TS00001                                        0769
         MVC   INTER(4),@TS00001+4                                 0769
*             INTER=INTER/F16;      /* CLEAR SIGN            @Z40LB01*/
         L     @12,INTER                                           0770
         SRL   @12,4                                               0770
         ST    @12,INTER                                           0770
*             CALL ICBMSG82;        /* CONV SUB ROUTINE      @Z40LB01*/
         BAL   @14,ICBMSG82                                        0771
*             PRINTX=BYTES234;      /* FILL IN CONVERTED X LOC     0772
*                                                            @Z40LB01*/
         MVC   PRINTX(3),BYTES234                                  0772
*           END;                    /* END OF LXYZ TRANSLATION     0773
*                                                            @Z40LB01*/
*                                                                  0774
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 80 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0774
*         IF MSGC='80'X THEN        /*                       @Z40LB01*/
@RF00745 L     @12,MSGPTR                                          0774
         CLI   MSGC(@12),128                                       0774
         BNE   @RF00774                                            0774
*           DO;                     /* INDEX TO MESSAGE 80 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*             WTOOK=BONE;           /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0776
*             WTOGEN03=MESGS(MSG08001);/* FILL WTO BUFFER    @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0777
         L     @12,@CA02101                                        0777
         MVC   WTOGEN03(72),MESGS-MSGS(@12)                        0777
*             WTOGEN03(34:34)=PRNTLZYX(1:1);/* LIB ID        @Z40LB01*/
         MVC   WTOGEN03+33(1),PRNTLZYX                             0778
*             WTOGEN03(41:46)=PRNTLZYX(2:7);/* CART LOC      @Z40LB01*/
         MVC   WTOGEN03+40(6),PRNTLZYX+1                           0779
*           END;                    /* END MSG 80 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0780
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 81 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0781
*         ELSE                      /*                       @Z40LB01*/
*           IF MSGC='81'X THEN      /*                       @Z40LB01*/
         B     @RC00774                                            0781
@RF00774 L     @12,MSGPTR                                          0781
         CLI   MSGC(@12),129                                       0781
         BNE   @RF00781                                            0781
*             DO;                   /* INDEX TO MESSAGE 81 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*               WTOOK=BONE;         /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0783
*               WTOGEN03=MESGS(MSG08101);/* FILL WTO BUFFER  @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0784
         L     @11,@CA02101                                        0784
         MVC   WTOGEN03(72),MESGS-MSGS+76(@11)                     0784
*               WTOGEN03(62:67)=PRNTLZYX(2:7);/* CART LOC    @Z40LB01*/
         MVC   WTOGEN03+61(6),PRNTLZYX+1                           0785
*               WTOGEN03(55:55)=PRNTLZYX(1:1);/* LIB ID      @Z40LB01*/
         MVC   WTOGEN03+54(1),PRNTLZYX                             0786
*               WTOGEN03(13:24)=MSGDATA(3:14);/* CSN NO.     @Z40LB01*/
         MVC   WTOGEN03+12(12),MSGDATA+2(@12)                      0787
*             END;                  /* END MSG 81 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0788
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 82 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0789
*           ELSE                    /*                       @Z40LB01*/
*             IF MSGC='82'X THEN    /*                       @Z40LB01*/
         B     @RC00781                                            0789
@RF00781 L     @12,MSGPTR                                          0789
         CLI   MSGC(@12),130                                       0789
         BNE   @RF00789                                            0789
*               DO;                 /* INDEX TO MESSAGE 82 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                 WTOOK=BONE;       /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0791
*                 WTOGEN03=MESGS(MSG08201);/* FILL WTO BUFFER      0792
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0792
         L     @11,@CA02101                                        0792
         MVC   WTOGEN03(72),MESGS-MSGS+152(@11)                    0792
*                 WTOGEN03(48:53)=PRNTLZYX(2:7);/* CART LOC  @Z40LB01*/
         MVC   WTOGEN03+47(6),PRNTLZYX+1                           0793
*                 WTOGEN03(41:41)=PRNTLZYX(1:1);/* LIB ID    @Z40LB01*/
         MVC   WTOGEN03+40(1),PRNTLZYX                             0794
*                 WTOGEN03(59:70)=MSGDATA(3:14);/* CSN NO.   @Z40LB01*/
         MVC   WTOGEN03+58(12),MSGDATA+2(@12)                      0795
*                 WTOGEN03(13:18)=MSGDATA(27:32);/* VOLID    @Z40LB01*/
         MVC   WTOGEN03+12(6),MSGDATA+26(@12)                      0796
*               END;                /* END MSG 82 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0797
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 83 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0798
*             ELSE                  /*                       @Z40LB01*/
*               IF MSGC='83'X THEN  /*                       @Z40LB01*/
         B     @RC00789                                            0798
@RF00789 L     @12,MSGPTR                                          0798
         CLI   MSGC(@12),131                                       0798
         BNE   @RF00798                                            0798
*                 DO;               /* INDEX TO MESSAGE 83 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                   WTOOK=BONE;     /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0800
*                   WTOGEN03=MESGS(MSG08301);/* FILL WTO BUFFER    0801
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0801
         L     @11,@CA02101                                        0801
         MVC   WTOGEN03(72),MESGS-MSGS+228(@11)                    0801
*                   WTOGEN03(66:71)=PRNTLZYX(2:7);/* CART LOC      0802
*                                                            @ZA09555*/
         MVC   WTOGEN03+65(6),PRNTLZYX+1                           0802
*                   WTOGEN03(60:60)=PRNTLZYX(1:1);/* LIB ID  @ZA09555*/
         MVC   WTOGEN03+59(1),PRNTLZYX                             0803
*                   WTOGEN03(32:43)=MSGDATA(3:14);/* CSN NO. @ZA09555*/
         MVC   WTOGEN03+31(12),MSGDATA+2(@12)                      0804
*                   WTOGEN03(18:23)=MSGDATA(27:32);/* VOLID  @ZA09555*/
         MVC   WTOGEN03+17(6),MSGDATA+26(@12)                      0805
*                   WTOGEN03(30:30)=MSGDATA(33:33);/* SEQ NUM      0806
*                                                            @ZA09555*/
         MVC   WTOGEN03+29(1),MSGDATA+32(@12)                      0806
*                 END;              /* END MSG 83 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0807
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE SETS THE INDEX TO MESSAGE SKELETON   */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 84. THIS MESSAGE       */
*         /*                                                 @Z40LB01*/
*         /* HAS NO VARIABLE DATA FIELDS AND NO MOVES ARE    @Z40LB01*/
*         /* PERFORMED.                                      @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0808
*               ELSE                /*                       @Z40LB01*/
*                 IF MSGC='84'X THEN/*                       @Z40LB01*/
         B     @RC00798                                            0808
@RF00798 L     @12,MSGPTR                                          0808
         CLI   MSGC(@12),132                                       0808
         BNE   @RF00808                                            0808
*                   DO;             /* INDEX TO MESSAGE 84 AND SET 0809
*                                      WTOOK SWITCH          @Z40LB01*/
*                     WTOOK=BONE;   /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0810
*                     WTOGEN03=MESGS(MSG08401);/* FILL WTO BUFFER  0811
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0811
         L     @12,@CA02101                                        0811
         MVC   WTOGEN03(72),MESGS-MSGS+380(@12)                    0811
*                   END;            /* END MSG 84 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0812
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 85 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0813
*                 ELSE              /*                       @Z40LB01*/
*                   IF MSGC='85'X THEN/*                     @Z40LB01*/
         B     @RC00808                                            0813
@RF00808 L     @12,MSGPTR                                          0813
         CLI   MSGC(@12),133                                       0813
         BNE   @RF00813                                            0813
*                     DO;           /* INDEX TO MESSAGE 85 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                       WTOOK=BONE; /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0815
*                       WTOGEN03=MESGS(MSG08501);/* FILL WTO BUFFER
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0816
         L     @11,@CA02101                                        0816
         MVC   WTOGEN03(72),MESGS-MSGS+456(@11)                    0816
*                       WTOGEN03(23:23)=MSGDATA(1:1);/* TRACE X OR Y
*                                                            @Z40LB01*/
         MVC   WTOGEN03+22(1),MSGDATA(@12)                         0817
*                     END;          /* END MSG 85 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0818
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 86 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0819
*                   ELSE            /*                       @Z40LB01*/
*                     IF MSGC='86'X THEN/*                   @Z40LB01*/
         B     @RC00813                                            0819
@RF00813 L     @12,MSGPTR                                          0819
         CLI   MSGC(@12),134                                       0819
         BNE   @RF00819                                            0819
*                       DO;         /* INDEX TO MESSAGE 86 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                         WTOOK=BONE;/* SET WTO SWITCH       @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0821
*                         WTOGEN03=MESGS(MSG08601);/* FILL WTO BUFFER
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0822
         L     @11,@CA02101                                        0822
         MVC   WTOGEN03(72),MESGS-MSGS+532(@11)                    0822
*                         WTOGEN03(23:23)=MSGDATA(1:1);/* TRACE X OR
*                                      Y                     @Z40LB01*/
         MVC   WTOGEN03+22(1),MSGDATA(@12)                         0823
*                       END;        /* END MSG 86 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0824
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 93 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0825
*                     ELSE          /*                       @Z40LB01*/
*                       IF MSGC='93'X THEN/*                 @Z40LB01*/
         B     @RC00819                                            0825
@RF00819 L     @12,MSGPTR                                          0825
         CLI   MSGC(@12),147                                       0825
         BNE   @RF00825                                            0825
*                         DO;       /* INDEX TO PROPER MESSAGE     0826
*                                      SKELETON              @Z40LB01*/
*                           WTOOK=BONE;/* SET WTO SWITCH     @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0827
*                           WTOGEN03=MESGS(MSG09301);/* FILL WTO   0828
*                                      BUFFER                @Z40LB01*/
*                                                                  0828
         MVI   WTOGEN03+72,C' '                                    0828
         L     @11,@CA02101                                        0828
         MVC   WTOGEN03(72),MESGS-MSGS+608(@11)                    0828
*                           /*****************************************/
*                           /*                                       */
*                           /* TRANSLATE THE SSID FROM THE MSC       */
*                           /* MESSAGE                       @Z40LB01*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  0829
*                           INTER=''B;/* CLEAR WORK AREA     @Z40LB01*/
         XC    INTER(4),INTER                                      0829
*                           BYTE4=MSGDATA(1:1);/* INSERT BYTE      0830
*                                                            @Z40LB01*/
         IC    @11,MSGDATA(,@12)                                   0830
         STC   @11,BYTE4                                           0830
*                           CALL ICBMSG82;/* CALL TRANSLATE SUB    0831
*                                                            @Z40LB01*/
         BAL   @14,ICBMSG82                                        0831
*                           WTOGEN03(43:45)=BYTES234;/* SSID @Z40LB01*/
*                                                                  0832
         MVC   WTOGEN03+42(3),BYTES234                             0832
*                           /*****************************************/
*                           /*                                       */
*                           /* TRANSLATE THE STATUS BYTE FROM MSC MSG*/
*                           /*                               @Z40LB01*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  0833
*                           INTER=''B;/* CLEAR WORK AREA     @Z40LB01*/
         XC    INTER(4),INTER                                      0833
*                           BYTE4C=MSGDATAC;/* INSERT BYTE   @Z40LB01*/
         L     @12,MSGPTR                                          0834
         MVC   BYTE4C(1),MSGDATAC(@12)                             0834
*                           CALL ICBMSG82;/* CALL TRANSLATE SUB    0835
*                                                            @Z40LB01*/
         BAL   @14,ICBMSG82                                        0835
*                           WTOGEN03(55:57)=BYTES234;/* REASON CODE
*                                                            @Z40LB01*/
         MVC   WTOGEN03+54(3),BYTES234                             0836
*                           ROUT24=BONE;/* SET ROUT CHNG SW  @Z40LB01*/
         OI    ROUT24,B'00100000'                                  0837
*                         END;      /* END MESSAGE 93 PROCESS      0838
*                                                            @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0838
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 94 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0839
*                       ELSE        /*                       @Z40LB01*/
*                         IF MSGC='94'X THEN/* 94 USES ICB194E MESG
*                                                            @Z40LB01*/
         B     @RC00825                                            0839
@RF00825 L     @12,MSGPTR                                          0839
         CLI   MSGC(@12),148                                       0839
         BNE   @RF00839                                            0839
*                           DO;     /* INDEX TO MESSAGE 194 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                             WTOOK=BONE;/* SET WTO SWITCH   @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0841
*                             WTOGEN03=MESGS(MSG19401);/* FILL WTO 0842
*                                      BUFFER                @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0842
         L     @11,@CA02101                                        0842
         MVC   WTOGEN03(72),MESGS-MSGS+1748(@11)                   0842
*                             WTOGEN03(22:27)=VOLSER;/* FILL VOLID 0843
*                                      FIELD                 @Z40LB01*/
         MVC   WTOGEN03+21(6),VOLSER(@12)                          0843
*                             CARTNO=CARTNO'F0'X;/* CONV TO EBCDIC
*                                                            @ZA05082*/
         OI    CARTNO(@12),X'F0'                                   0844
*                             WTOGEN03(34)=CARTNO;/* FILL CARTNO   0845
*                                      FIELD                 @ZA05082*/
         MVC   WTOGEN03+33(1),CARTNO(@12)                          0845
*                             INTER=''B;/* CLEAR CONV WORKAREA     0846
*                                                            @Z40LB01*/
         XC    INTER(4),INTER                                      0846
*                             BYTE4C=RESTCD;/* PUT IN RESTART CODE 0847
*                                                            @Z40LB01*/
         MVC   BYTE4C(1),RESTCD(@12)                               0847
*                             CALL ICBMSG82;/* CALL CONV SUBROUTINE
*                                                            @Z40LB01*/
         BAL   @14,ICBMSG82                                        0848
*                             WTOGEN03(67:68)=BYTES34;/* FILL RESTART
*                                      FLD                   @ZA05082*/
         MVC   WTOGEN03+66(2),BYTES34                              0849
*                           END;    /* END MESSAGE 94 PROCESS      0850
*                                                            @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0850
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 8F AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0851
*                         ELSE      /*                       @Z40LB01*/
*                           IF MSGC='8F'X THEN/* 8F USES ICB100I MESG
*                                                            @Z40LB01*/
         B     @RC00839                                            0851
@RF00839 L     @12,MSGPTR                                          0851
         CLI   MSGC(@12),143                                       0851
         BNE   @RF00851                                            0851
*                             DO;   /* INDEX TO MESSAGE 100 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                               WTOOK=BONE;/* SET WTO SWITCH @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0853
*                               WTOGEN03=MESGS(MSG10001);/* FILL WTO
*                                      BUFFER                @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0854
         L     @11,@CA02101                                        0854
         MVC   WTOGEN03(72),MESGS-MSGS+684(@11)                    0854
*                               WTOGEN03(20:25)=MSGDATA(1:6);/* VOLID
*                                                            @Z40LB01*/
         MVC   WTOGEN03+19(6),MSGDATA(@12)                         0855
*                             END;  /* END MSG 8F PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0856
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 95 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0857
*                           ELSE    /*                       @Z40LB01*/
*                             IF MSGC='95'X THEN/*           @Z40LB01*/
         B     @RC00851                                            0857
@RF00851 L     @12,MSGPTR                                          0857
         CLI   MSGC(@12),149                                       0857
         BNE   @RF00857                                            0857
*                               DO; /* INDEX TO MESSAGE 95 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                                 WTOOK=BONE;/* SET WTO SWITCH     0859
*                                                            @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0859
*                                 WTOGEN03=MESGS(MSG09501);/* FILL 0860
*                                      WTO BUFFER            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0860
         L     @11,@CA02101                                        0860
         MVC   WTOGEN03(72),MESGS-MSGS+760(@11)                    0860
*                                 INTER=''B;/* CLEAR CONV WORKAREA 0861
*                                                            @Z40LB01*/
         XC    INTER(4),INTER                                      0861
*                                 BYTES34=MSGDATA(1:2);/* PUT IN SSID
*                                                            @Z40LB01*/
         MVC   BYTES34(2),MSGDATA(@12)                             0862
*                                 CALL ICBMSG82;/* CALL CONV       0863
*                                      SUBROUTINE            @Z40LB01*/
         BAL   @14,ICBMSG82                                        0863
*                                 WTOGEN03(40:42)=BYTES234;/* FILL 0864
*                                      MESG FIELD            @Z40LB01*/
         MVC   WTOGEN03+39(3),BYTES234                             0864
*                                 IF CONFGMSK(1)=(MSGDATA(13:13)&  0865
*                                     CONFGMSK(1)) THEN/*    @Z40LB01*/
         L     @12,MSGPTR                                          0865
         MVC   @TS00001(1),MSGDATA+12(@12)                         0865
         NC    @TS00001(1),CONFGMSK                                0865
         CLC   CONFGMSK(1),@TS00001                                0865
         BNE   @RF00865                                            0865
*                                   WTOGEN03(45:48)='3333';/*      0866
*                                      CONTROLLER            @Z40LB01*/
         MVC   WTOGEN03+44(4),@CC02725                             0866
*                                 ELSE/*                     @Z40LB01*/
*                                   WTOGEN03(45:48)='3330';/* DASD 0867
*                                                            @Z40LB01*/
         B     @RC00865                                            0867
@RF00865 MVC   WTOGEN03+44(4),@CC02726                             0867
*                                 ROUT24=BONE;/* SET ROUT CHNG SW  0868
*                                                            @Z40LB01*/
@RC00865 DS    0H                                                  0869
*                                 DESC2=BONE;/* SET DESC CHNG SW   0869
*                                                            @Z40LB01*/
         OI    ROUT24,B'10100000'                                  0869
*                               END;/* END MSG 95 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0870
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 96 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0871
*         IF MSGC='96'X THEN        /*                       @Z40LB01*/
@RF00857 DS    0H                                                  0871
@RC00851 DS    0H                                                  0871
@RC00839 DS    0H                                                  0871
@RC00825 DS    0H                                                  0871
@RC00819 DS    0H                                                  0871
@RC00813 DS    0H                                                  0871
@RC00808 DS    0H                                                  0871
@RC00798 DS    0H                                                  0871
@RC00789 DS    0H                                                  0871
@RC00781 DS    0H                                                  0871
@RC00774 L     @12,MSGPTR                                          0871
         CLI   MSGC(@12),150                                       0871
         BNE   @RF00871                                            0871
*           DO;                     /* INDEX TO MESSAGE 96 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*             DSTGERR=BZERO;        /* RESET DESTAGE ERR SW  @ZA16123*/
         NI    DSTGERR,B'10111111'                                 0873
*             WTOOK=BONE;           /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0874
*             WTOGEN03=MESGS(MSG09601);/* FILL WTO BUFFER    @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0875
         L     @11,@CA02101                                        0875
         MVC   WTOGEN03(72),MESGS-MSGS+836(@11)                    0875
*             INTER=''B;            /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0876
*             BYTES34=MSGDATA(1:2); /* PUT IN SSID           @Z40LB01*/
         MVC   BYTES34(2),MSGDATA(@12)                             0877
*             CALL ICBMSG82;        /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0878
*             WTOGEN03(46:48)=BYTES234;/* FILL SSID FIELD    @Z40LB01*/
         MVC   WTOGEN03+45(3),BYTES234                             0879
*             INTER=''B;            /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0880
*             BYTE4C=MSGDATA(5:5);  /* THE REAL PAGE BYTE    @Z40LB01*/
         L     @12,MSGPTR                                          0881
         MVC   BYTE4C(1),MSGDATA+4(@12)                            0881
*             CVD(BYTE4,INTER);     /* CVD REAL PAGE TO DEC  @Z40LB01*/
         SLR   @12,@12                                             0882
         IC    @12,BYTE4                                           0882
         CVD   @12,@TS00001                                        0882
         MVC   INTER(4),@TS00001+4                                 0882
*             INTER=INTER/F16;      /* SHIFT OUT SIGN MSG82  @Z40LB01*/
         L     @12,INTER                                           0883
         SRL   @12,4                                               0883
         ST    @12,INTER                                           0883
*             CALL ICBMSG82;        /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0884
*             WTOGEN03(35:36)=BYTES34;/* FILL REAL PAGE FLD  @Z40LB01*/
         MVC   WTOGEN03+34(2),BYTES34                              0885
*             IF CONFGMSK(8)=(MSGDATA(13:13)&CONFGMSK(8)) THEN/*   0886
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0886
         MVC   @TS00001(1),MSGDATA+12(@12)                         0886
         NC    @TS00001(1),CONFGMSK+7                              0886
         CLC   CONFGMSK+7(1),@TS00001                              0886
         BNE   @RF00886                                            0886
*               DO;                 /* THIS IS DESTG ERROR   @Z40LB01*/
*                 WTOGEN03(17:23)='DESTAGE';/* FILL MESG     @Z40LB01*/
         MVC   WTOGEN03+16(7),@CC02728                             0888
*                 DSTGERR=BONE;     /* SET 2ND LINE SWITCH   @Z40LB01*/
         OI    DSTGERR,B'01000000'                                 0889
*               END;                /*                       @Z40LB01*/
*             ELSE                  /* TEST FOR STAGE ERR    @Z40LB01*/
*               IF CONFGMSK(7)=(MSGDATA(13:13)&CONFGMSK(7)) THEN/* 0891
*                                                            @Z40LB01*/
         B     @RC00886                                            0891
@RF00886 L     @12,MSGPTR                                          0891
         MVC   @TS00001(1),MSGDATA+12(@12)                         0891
         NC    @TS00001(1),CONFGMSK+6                              0891
         CLC   CONFGMSK+6(1),@TS00001                              0891
         BNE   @RF00891                                            0891
*                 WTOGEN03(17:23)='STAGE   ';/* FILL MESG    @Z40LB01*/
         MVC   WTOGEN03+16(7),@CC02729                             0892
*               ELSE                /* MUST BE HOST ERROR    @Z40LB01*/
*                 WTOGEN03(17:23)='HOST    ';/* FILL MESG    @Z40LB01*/
         B     @RC00891                                            0893
@RF00891 MVC   WTOGEN03+16(7),@CC02730                             0893
*             ROUT24=BONE;          /* SET ROUT CHNG SW      @Z40LB01*/
@RC00891 DS    0H                                                  0894
@RC00886 OI    ROUT24,B'00100000'                                  0894
*           END;                    /* END MSG 96 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0895
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 97 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0896
*         ELSE                      /*                       @Z40LB01*/
*           IF MSGC='97'X THEN      /*                       @Z40LB01*/
         B     @RC00871                                            0896
@RF00871 L     @12,MSGPTR                                          0896
         CLI   MSGC(@12),151                                       0896
         BNE   @RF00896                                            0896
*             DO;                   /* INDEX TO MESSAGE 97 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*               WTOOK=BONE;         /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0898
*               WTOGEN03=MESGS(MSG09701);/* FILL WTO BUFFER  @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0899
         L     @11,@CA02101                                        0899
         MVC   WTOGEN03(72),MESGS-MSGS+988(@11)                    0899
*               INTER=''B;          /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0900
*               BYTES34=MSGDATA(3:4);/* FROM SSID            @Z40LB01*/
         MVC   BYTES34(2),MSGDATA+2(@12)                           0901
*               CALL ICBMSG82;      /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0902
*               WTOGEN03(34:36)=BYTES234;/* FILL FROM SSID   @Z40LB01*/
         MVC   WTOGEN03+33(3),BYTES234                             0903
*               INTER=''B;          /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0904
*               BYTES34=MSGDATA(5:6);/* TO SSID              @Z40LB01*/
         L     @12,MSGPTR                                          0905
         MVC   BYTES34(2),MSGDATA+4(@12)                           0905
*               CALL ICBMSG82;      /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0906
*               WTOGEN03(38:40)=BYTES234;/* FILL TO SSID     @Z40LB01*/
         MVC   WTOGEN03+37(3),BYTES234                             0907
*               INTER=''B;          /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0908
*               BYTES34=MSGDATA(1:2);/* FROM/TO RUA          @Z40LB01*/
         L     @12,MSGPTR                                          0909
         MVC   BYTES34(2),MSGDATA(@12)                             0909
*               CALL ICBMSG82;      /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0910
*               WTOGEN03(42:43)=INTER(1:2);/* FILL FROM RUA  @Z40LB01*/
         MVC   WTOGEN03+41(2),INTER                                0911
*               WTOGEN03(45:46)=INTER(3:4);/* FILL TO RUA    @Z40LB01*/
         MVC   WTOGEN03+44(2),INTER+2                              0912
*               ROUT24=BONE;        /* CHANGE ROUT CODE SW   @Z40LB01*/
         OI    ROUT24,B'00100000'                                  0913
*             END;                  /* END MSG 97 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0914
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 98 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0915
*           ELSE                    /*                       @Z40LB01*/
*             IF MSGC='98'X THEN    /*                       @Z40LB01*/
         B     @RC00896                                            0915
@RF00896 L     @12,MSGPTR                                          0915
         CLI   MSGC(@12),152                                       0915
         BNE   @RF00915                                            0915
*               DO;                 /* INDEX TO MESSAGE 98 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                 WTOOK=BONE;       /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0917
*                 WTOGEN03=MESGS(MSG09801);/* FILL WTO BUFFER      0918
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0918
         L     @11,@CA02101                                        0918
         MVC   WTOGEN03(72),MESGS-MSGS+1064(@11)                   0918
*                 WTOGEN03(37:42)=MSGDATA(3:8);/* FILL VOLID @Z40LB01*/
         MVC   WTOGEN03+36(6),MSGDATA+2(@12)                       0919
*                 INTER=''B;        /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0920
*                 BYTES34=MSGDATA(9:10);/* PUT IN VUA        @Z40LB01*/
         MVC   BYTES34(2),MSGDATA+8(@12)                           0921
*                 CALL ICBMSG82;    /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0922
*                 WTOGEN03(44:46)=BYTES234;/* FILL VUA       @Z40LB01*/
         MVC   WTOGEN03+43(3),BYTES234                             0923
*                 INTER=''B;        /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0924
*                 BYTES34=MSGDATA(11:12);/* PUT IN BYT 1&2 HOSTID  0925
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0925
         MVC   BYTES34(2),MSGDATA+10(@12)                          0925
*                 CALL ICBMSG82;    /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0926
*                 WTOGEN03(54:57)=INTER;/* FILL BYT 1&2 HOSTID     0927
*                                                            @Z40LB01*/
         MVC   WTOGEN03+53(4),INTER                                0927
*                 INTER=''B;        /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0928
*                 BYTES34=MSGDATA(13:14);/* PUT IN BYT 3&4 HOSTID  0929
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0929
         MVC   BYTES34(2),MSGDATA+12(@12)                          0929
*                 CALL ICBMSG82;    /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0930
*                 WTOGEN03(58:61)=INTER;/* FILL BYT 3&4 HOSTID     0931
*                                                            @Z40LB01*/
         MVC   WTOGEN03+57(4),INTER                                0931
*                 INTER=''B;        /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0932
*                 BYTE4C=MSGDATA(15:15);/* PUT IN BYT 5 HOSTID     0933
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0933
         MVC   BYTE4C(1),MSGDATA+14(@12)                           0933
*                 CALL ICBMSG82;    /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0934
*                 WTOGEN03(62:63)=BYTES34;/* FILL BYT 5 HOSTID     0935
*                                                            @Z40LB01*/
         MVC   WTOGEN03+61(2),BYTES34                              0935
*                 INTER=''B;        /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0936
*                 BYTE4C=MSGDATA(16:16);/* THE FROM SDG BYTE @Z40LB01*/
         L     @12,MSGPTR                                          0937
         MVC   BYTE4C(1),MSGDATA+15(@12)                           0937
*                 CVD(BYTE4,INTER); /* FROM SDG TO DEC       @Z40LB01*/
         SLR   @12,@12                                             0938
         IC    @12,BYTE4                                           0938
         CVD   @12,@TS00001                                        0938
         MVC   INTER(4),@TS00001+4                                 0938
*                 INTER=INTER/F16;  /* SHIFT OUT SIGN MSG82  @Z40LB01*/
         L     @12,INTER                                           0939
         SRL   @12,4                                               0939
         ST    @12,INTER                                           0939
*                 CALL ICBMSG82;    /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0940
*                 WTOGEN03(48:49)=BYTES34;/* FILL FROM SDG   @Z40LB01*/
         MVC   WTOGEN03+47(2),BYTES34                              0941
*                 INTER=''B;        /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0942
*                 BYTE4C=MSGDATA(17:17);/* THE TO SDG BYTE   @Z40LB01*/
         L     @12,MSGPTR                                          0943
         MVC   BYTE4C(1),MSGDATA+16(@12)                           0943
*                 CVD(BYTE4,INTER); /* TO SDG TO DEC         @Z40LB01*/
         SLR   @12,@12                                             0944
         IC    @12,BYTE4                                           0944
         CVD   @12,@TS00001                                        0944
         MVC   INTER(4),@TS00001+4                                 0944
*                 INTER=INTER/F16;  /* SHIFT OUT SIGN MSG82  @Z40LB01*/
         L     @12,INTER                                           0945
         SRL   @12,4                                               0945
         ST    @12,INTER                                           0945
*                 CALL ICBMSG82;    /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0946
*                 WTOGEN03(51:52)=BYTES34;/* FILL TO SDG     @Z40LB01*/
         MVC   WTOGEN03+50(2),BYTES34                              0947
*                 ROUT24=BONE;      /* CHANGE ROUT CODE SW   @Z40LB01*/
         OI    ROUT24,B'00100000'                                  0948
*               END;                /* END MSG 98 PROCESS    @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0949
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 99 AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0950
*             ELSE                  /*                       @Z40LB01*/
*               IF MSGC='99'X THEN  /*                       @Z40LB01*/
         B     @RC00915                                            0950
@RF00915 L     @12,MSGPTR                                          0950
         CLI   MSGC(@12),153                                       0950
         BNE   @RF00950                                            0950
*                 DO;               /* INDEX TO MESSAGE 99 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                   WTOOK=BONE;     /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0952
*                   WTOGEN03=MESGS(MSG09901);/* FILL WTO BUFFER    0953
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0953
         L     @11,@CA02101                                        0953
         MVC   WTOGEN03(72),MESGS-MSGS+1824(@11)                   0953
*                   INTER=''B;      /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0954
*                   BYTES34=MSGDATA(5:6);/* PUT IN SA SSID   @Z40LB01*/
         MVC   BYTES34(2),MSGDATA+4(@12)                           0955
*                   CALL ICBMSG82;  /* CONVERSION SUB RTN    @Z40LB01*/
         BAL   @14,ICBMSG82                                        0956
*                   WTOGEN03(34:36)=BYTES234;/* SSID TO MESSAGE    0957
*                                                            @Z40LB01*/
         MVC   WTOGEN03+33(3),BYTES234                             0957
*                   INTER=''B;      /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0958
*                   BYTES34=MSGDATA(9:10);/* PUT IN CORE ADDR      0959
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0959
         MVC   BYTES34(2),MSGDATA+8(@12)                           0959
*                   CALL ICBMSG82;  /* CONV SUB RTN          @Z40LB01*/
         BAL   @14,ICBMSG82                                        0960
*                   WTOGEN03(43:46)=INTER;/* CORE ADDR TO MSG      0961
*                                                            @Z40LB01*/
         MVC   WTOGEN03+42(4),INTER                                0961
*                   INTER=''B;      /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0962
*                   BYTES34=MSGDATA(11:12);/* PUT IN 1ST HALF CUR  0963
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0963
         MVC   BYTES34(2),MSGDATA+10(@12)                          0963
*                   CALL ICBMSG82;  /* CONV SUB RTN          @Z40LB01*/
         BAL   @14,ICBMSG82                                        0964
*                   WTOGEN03(52:55)=INTER;/* 1ST HALF CUR TO MSG   0965
*                                                            @Z40LB01*/
         MVC   WTOGEN03+51(4),INTER                                0965
*                   INTER=''B;      /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0966
*                   BYTES34=MSGDATA(13:14);/* PUT IN 2ND HALF CUR  0967
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0967
         MVC   BYTES34(2),MSGDATA+12(@12)                          0967
*                   CALL ICBMSG82;  /* CONV SUB RTN          @Z40LB01*/
         BAL   @14,ICBMSG82                                        0968
*                   WTOGEN03(56:59)=INTER;/* 2ND HALF CUR TO MSG   0969
*                                                            @Z40LB01*/
         MVC   WTOGEN03+55(4),INTER                                0969
*                   INTER=''B;      /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0970
*                   BYTES34=MSGDATA(15:16);/* PUT IN 1ST HALF VER  0971
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0971
         MVC   BYTES34(2),MSGDATA+14(@12)                          0971
*                   CALL ICBMSG82;  /* CONV SUB RTN          @Z40LB01*/
         BAL   @14,ICBMSG82                                        0972
*                   WTOGEN03(65:68)=INTER;/* 1ST HALF VER TO MSG   0973
*                                                            @Z40LB01*/
         MVC   WTOGEN03+64(4),INTER                                0973
*                   INTER=''B;      /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      0974
*                   BYTES34=MSGDATA(17:18);/* PUT IN 2ND HALF VER  0975
*                                                            @Z40LB01*/
         L     @12,MSGPTR                                          0975
         MVC   BYTES34(2),MSGDATA+16(@12)                          0975
*                   CALL ICBMSG82;  /* CONV SUB RTN          @Z40LB01*/
         BAL   @14,ICBMSG82                                        0976
*                   WTOGEN03(69:72)=INTER;/* 2ND HALF VER TO MSG   0977
*                                                            @Z40LB01*/
         MVC   WTOGEN03+68(4),INTER                                0977
*                 END;              /* END MSG 99 CODE       @Z40LB01
*                                                            @Z40LB01*/
*                                                                  0978
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @Z40LB01*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 9A AND MOVES THE       */
*         /*                                                 @Z40LB01*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @Z40LB01*/
*         /* WTO MESSAGE SKELETON.                           @Z40LB01*/
*         /* ***************************************************     */
*         /*                                                 @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0979
*               ELSE                /*                       @Z40LB01*/
*                 IF MSGC='9A'X THEN/* 9A USES ICB101I MESG  @Z40LB01*/
         B     @RC00950                                            0979
@RF00950 L     @12,MSGPTR                                          0979
         CLI   MSGC(@12),154                                       0979
         BNE   @RF00979                                            0979
*                   DO;             /* INDEX TO MESSAGE 101 AND FILL
*                                      MSG VARIABLES         @Z40LB01*/
*                     WTOOK=BONE;   /* SET WTO SWITCH        @Z40LB01*/
         OI    WTOOK,B'00010000'                                   0981
*                     WTOGEN03=MESGS(MSG10101);/* FILL WTO BUFFER  0982
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    0982
         L     @11,@CA02101                                        0982
         MVC   WTOGEN03(72),MESGS-MSGS+1140(@11)                   0982
*                     INTER=''B;    /* CLEAR CONV WORKAREA   @Z40LB01*/
         XC    INTER(4),INTER                                      0983
*                     BYTES34=MSGDATA(1:2);/* PUT IN SAID/VUA      0984
*                                                            @Z40LB01*/
         MVC   BYTES34(2),MSGDATA(@12)                             0984
*                     CALL ICBMSG82;/* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        0985
*                     WTOGEN03(57:57)=INTER(2:2);/* FILL SA FIELD  0986
*                                                            @Z40LB01*/
         MVC   WTOGEN03+56(1),INTER+1                              0986
*                     WTOGEN03(65:66)=INTER(3:4);/* FILL RUA FIELD 0987
*                                                            @Z40LB01*/
         MVC   WTOGEN03+64(2),INTER+2                              0987
*                     ROUT24=BONE;  /* CHANGE ROUT CODE SW   @Z40LB01*/
         OI    ROUT24,B'00100000'                                  0988
*                   END;            /* END MSG 9A PROCESS    @Z40LB01*/
*                                                                  0989
*         /***********************************************************/
*         /*                                                         */
*         /* ***************************************************     */
*         /*                                                 @ZA17153*/
*         /* THE FOLLOWING CODE INDEXES TO THE MESSAGE SKELETON      */
*         /*                                                 @ZA17153*/
*         /* FOR UNSOLICITED MSC MESSAGE CODE 9C AND MOVES THE       */
*         /*                                                 @ZA17153*/
*         /* APPROPRIATE DATA FROM THE MSC MESSAGE BUFFER TO THE     */
*         /*                                                 @ZA17153*/
*         /* WTO MESSAGE SKELETON.                           @ZA17153*/
*         /* ***************************************************     */
*         /*                                                 @ZA17153*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0990
*                 ELSE              /*                       @ZA17153*/
*                   IF MSGC='9C'X THEN/* 9C USES ICB102E MESG      0990
*                                                            @ZA17153*/
         B     @RC00979                                            0990
@RF00979 L     @12,MSGPTR                                          0990
         CLI   MSGC(@12),156                                       0990
         BNE   @RF00990                                            0990
*                     DO;           /* INDEX TO MESSAGE 102 AND FILL
*                                      MSG VARIABLES         @ZA17153*/
*                       WTOOK=BONE; /* SET WTO SWITCH        @ZA17153*/
         OI    WTOOK,B'00010000'                                   0992
*                       WTOGEN03=MESGS(MSG10201);/* FILL WTO BUFFER
*                                                            @ZA17153*/
         MVI   WTOGEN03+72,C' '                                    0993
         L     @11,@CA02101                                        0993
         MVC   WTOGEN03(72),MESGS-MSGS+3116(@11)                   0993
*                       WTOGEN03(11:22)=MSGDATA(3:14);/* FOREIGN CSN
*                                      FIELD                 @ZA17153*/
         MVC   WTOGEN03+10(12),MSGDATA+2(@12)                      0994
*                       INTER=''B;  /* CLEAR CONV WORK AREA  @ZA17153*/
         XC    INTER(4),INTER                                      0995
*                       BYTE4=MSGDATA(1:1);/* CART STAT BYTE @ZA17153*/
         IC    @11,MSGDATA(,@12)                                   0996
         STC   @11,BYTE4                                           0996
*                       CALL ICBMSG82;/* CALL CONV SUB ROUTINE     0997
*                                                            @ZA17153*/
         BAL   @14,ICBMSG82                                        0997
*                       WTOGEN03(24:25)=BYTES34;/* CART STAT IN MSG
*                                                            @ZA17153*/
*                                                                  0998
         MVC   WTOGEN03+23(2),BYTES34                              0998
*                       /*********************************************/
*                       /*                                           */
*                       /* BIT 0 IN CART STAT BYTE IS SET BY MSC IF  */
*                       /* THE                               @ZA17153*/
*                       /* CART LABEL IS UNREADABLE. IF SET, NO OTHER*/
*                       /* DATA                              @ZA17153*/
*                       /* FIELDS IN MSG ARE VALID AND SHALL NOT BE  */
*                       /* WRITTEN.                          @ZA17153*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0999
*                       IF BADLAB=BZERO THEN/*               @ZA17153*/
         L     @12,MSGPTR                                          0999
         TM    BADLAB+2(@12),B'10000000'                           0999
         BNZ   @RF00999                                            0999
*                         DO;       /* CART LABEL GOOD CODE  @ZA17153*/
*                           WTOGEN03(26:26)=CMMA;/* INSERT COMMA   1001
*                                                            @ZA17153*/
         MVC   WTOGEN03+25(1),CMMA                                 1001
*                           WTOGEN03(27:38)=MSGDATA(19:30);/* CART 1002
*                                      CSN FIELD             @ZA17153*/
         MVC   WTOGEN03+26(12),MSGDATA+18(@12)                     1002
*                           WTOGEN03(39:39)=CMMA;/* INSERT COMMA   1003
*                                                            @ZA17153*/
         MVC   WTOGEN03+38(1),CMMA                                 1003
*                           WTOGEN03(40:51)=MSGDATA(31:42);/* OTHER
*                                      CSN FIELD             @ZA17153*/
         MVC   WTOGEN03+39(12),MSGDATA+30(@12)                     1004
*                           WTOGEN03(52:52)=CMMA;/* INSERT COMMA   1005
*                                                            @ZA17153*/
         MVC   WTOGEN03+51(1),CMMA                                 1005
*                           WTOGEN03(53:53)=PRNTLZYX(1:1);/* MSF ID
*                                      FIELD                 @ZA17153*/
         MVC   WTOGEN03+52(1),PRNTLZYX                             1006
*                           WTOGEN03(54:54)=CMMA;/* INSERT COMMA   1007
*                                                            @ZA17153*/
         MVC   WTOGEN03+53(1),CMMA                                 1007
*                           WTOGEN03(55:60)=PRNTLZYX(2:7);/* CART LOC
*                                      FIELD                 @ZA17153*/
         MVC   WTOGEN03+54(6),PRNTLZYX+1                           1008
*                           WTOGEN03(61:61)=CMMA;/* INSERT COMMA   1009
*                                                            @ZA17153*/
         MVC   WTOGEN03+60(1),CMMA                                 1009
*                           INTER=''B;/* CLEAR CONV WORK AREA      1010
*                                                            @ZA17153*/
         XC    INTER(4),INTER                                      1010
*                           BYTES34=MSGDATA(17:18);/* VOLSEQ AND VOL
*                                      FLAGS                 @ZA17153*/
         MVC   BYTES34(2),MSGDATA+16(@12)                          1011
*                           CALL ICBMSG82;/* CALL CONV SUB ROUTINE 1012
*                                                            @ZA17153*/
         BAL   @14,ICBMSG82                                        1012
*                           WTOGEN03(62:62)=INTER(4:4);/* VOL SEQ  1013
*                                      NUMBER FLD            @ZA17153*/
         MVC   WTOGEN03+61(1),INTER+3                              1013
*                           WTOGEN03(63:63)=CMMA;/* INSERT COMMA   1014
*                                                            @ZA17153*/
         MVC   WTOGEN03+62(1),CMMA                                 1014
*                           WTOGEN03(64:65)=INTER(1:2);/* VOL FLAGS
*                                      FIELD                 @ZA17153*/
         MVC   WTOGEN03+63(2),INTER                                1015
*                         END;      /* END LABEL GOOD CODE   @ZA17153*/
*                       DESC3=BONE; /* SET FOR DESC CODE 3   @ZA17153*/
@RF00999 OI    DESC3,B'01000000'                                   1017
*                     END;          /* END MSG 9C PROCESS    @ZA17153*/
*                                                                  1019
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO MATCH FOUND ON MSGC THEN THE WTO AND SECOND       */
*         /*                                                 @Z40LB01*/
*         /* LINE CODE WILL BE BYPASSED.                     @Z40LB01*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1019
*         IF WTOOK=BONE THEN        /* SEE IF MATCH FOUND    @Z40LB01*/
@RF00990 DS    0H                                                  1019
@RC00979 DS    0H                                                  1019
@RC00950 DS    0H                                                  1019
@RC00915 DS    0H                                                  1019
@RC00896 DS    0H                                                  1019
@RC00871 TM    WTOOK,B'00010000'                                   1019
         BNO   @RF01019                                            1019
*           DO;                     /* PROCESS WTO           @Z40LB01*/
*                                                                  1020
*             /*******************************************************/
*             /*                                                     */
*             /* IF ROUTE AND DESCRIPTOR CODES MUST BE CHANGED,      */
*             /*                                             @Z40LB01*/
*             /* CHANGE THEM HERE.                           @Z40LB01*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1021
*             IF DESC3=BONE THEN    /* CHANGE DESC NEEDED    @Z40LB01*/
         TM    DESC3,B'01000000'                                   1021
         BNO   @RF01021                                            1021
*               WTOGEN04=DESCR3;    /* FILL WITH DESC CODE 3 @Z40LB01*/
         MVC   WTOGEN04(2),DESCR3                                  1022
*             IF DESC2=BONE THEN    /* CHANGE DESC NEEDED    @Z40LB01*/
@RF01021 TM    DESC2,B'10000000'                                   1023
         BNO   @RF01023                                            1023
*               WTOGEN04=DESCR2;    /* FILL WITH DESC CODE 2 @Z40LB01*/
         MVC   WTOGEN04(2),DESCR2                                  1024
*             IF ROUT24=BONE THEN   /* CHANGE ROUT NEEDED    @Z40LB01*/
@RF01023 TM    ROUT24,B'00100000'                                  1025
         BNO   @RF01025                                            1025
*               WTOGEN05=ROUTE24;   /* FILL WITH 24 ROUTE    @Z40LB01*/
         MVC   WTOGEN05(2),ROUTE24                                 1026
*             RFY                                                  1027
*               R1 RSTD;            /*                       @Z40LB01*/
@RF01025 DS    0H                                                  1028
*IWTO2:                                                            1028
*             DO;                   /* WTOP MF(E,WTOGEN) RTCD(R15)   */
IWTO2    DS    0H                                                  1029
*               RFY                                                1029
*                 GPR01P RSTD;      /* RESTRICT REG 1                */
*               GPR01P=ADDR(WTOGEN);/* ADDRESS CONTROL PROGRAM LIST  */
         LA    GPR01P,WTOGEN                                       1030
*               SVC(35);            /* ISSUE WTO SVC                 */
         SVC   35                                                  1031
*               RFY                                                1032
*                 GPR15F RSTD;      /* RESTRICT REG 15               */
*               R15=GPR15F;         /* SAVE SVC RETURN CODE          */
*               RFY                                                1034
*                 GPR15F UNRSTD;    /* RELEASE REG 15                */
*               RFY                                                1035
*                 GPR01P UNRSTD;    /* RELEASE REG 1                 */
*             END;                  /* WTOP MF(E,WTOGEN) RTCD(R15) 1036
*                                      ISSUE WTO MACRO       @Z40LB01*/
*                                                                  1036
*             /*******************************************************/
*             /*                                                     */
*             /* TEST TO SEE IF A SECOND LINE IS REQUIRED. IF THE    */
*             /*                                             @Z40LB01*/
*             /* MESSAGE PROCESSED REQUIRES A SECOND LINE THEN       */
*             /*                                             @Z40LB01*/
*             /* LOCATE THE PROPER MESSAGE SKELETON, FILL IN THE     */
*             /*                                             @Z40LB01*/
*             /* VARIABLE DATA FIELDS, MOVE THE MESSAGE TO THE       */
*             /*                                             @Z40LB01*/
*             /* WTO AREA AND ISSUE THE SECOND WTO MACRO     @Z40LB01*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1037
*             IF MSGC='83'XMSGC='96'X/* THESE REQ 2ND LINE @ZA17153*/
*                 MSGC='9C'X THEN   /*                       @ZA17153*/
         L     @12,MSGPTR                                          1037
         CLI   MSGC(@12),131                                       1037
         BE    @RT01037                                            1037
         CLI   MSGC(@12),150                                       1037
         BE    @RT01037                                            1037
         CLI   MSGC(@12),156                                       1037
         BNE   @RF01037                                            1037
@RT01037 DS    0H                                                  1038
*               DO;                 /* BUILD AND WRITE LINE  @Z40LB01*/
*                 LINETWO=BZERO;    /* SET SW TO BYPASS WTO  @Z40LB01*/
*                                                                  1039
         NI    LINETWO,B'11011111'                                 1039
*                 /***************************************************/
*                 /*                                                 */
*                 /* 83 MESSAGES ALWAYS REQUIRE A SECOND LINE        */
*                 /*                                         @Z40LB01*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1040
*                 IF MSGC='83'X THEN/*                       @Z40LB01*/
         L     @12,MSGPTR                                          1040
         CLI   MSGC(@12),131                                       1040
         BNE   @RF01040                                            1040
*                   DO;             /*                       @Z40LB01*/
*                     WTOGEN03=MESGS(MSG08302);/* FILL WTO BUFFER  1042
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    1042
         L     @11,@CA02101                                        1042
         MVC   WTOGEN03(72),MESGS-MSGS+304(@11)                    1042
*                     WTOGEN03(18:23)=MSGDATA(27:32);/* VOLID      1043
*                                                            @ZA09555*/
         MVC   WTOGEN03+17(6),MSGDATA+26(@12)                      1043
*                     IF MSGDATA(33:33)='F1'X THEN/* SET CART      1044
*                                                            @ZA09555*/
         CLI   MSGDATA+32(@12),X'F1'                               1044
         BNE   @RF01044                                            1044
*                       WTOGEN03(30:30)='F2'X;/* SEQ NUM     @ZA09555*/
         MVI   WTOGEN03+29,X'F2'                                   1045
*                     ELSE                                         1046
*                       WTOGEN03(30:30)='F1'X;/* OF OTHER CART     1046
*                                                            @ZA09555*/
         B     @RC01044                                            1046
@RF01044 MVI   WTOGEN03+29,X'F1'                                   1046
*                     WTOGEN03(32:43)=MSGDATA(15:26);/* CSN ID     1047
*                                                            @ZA09555*/
@RC01044 L     @12,MSGPTR                                          1047
         MVC   WTOGEN03+31(12),MSGDATA+14(@12)                     1047
*                     IF MSGDATA(34:34)='F1'X THEN/* OTHER CART IN 1048
*                                      MSF?                  @ZA09555*/
         CLI   MSGDATA+33(@12),X'F1'                               1048
         BNE   @RF01048                                            1048
*                       WTOGEN03(45:48)=LNOT;/* NOT THERE    @ZA09555*/
         MVC   WTOGEN03+44(4),LNOT                                 1049
*                     ELSE                                         1050
*                       WTOGEN03(45:48)=LALSO;/* ALSO THERE  @ZA09555*/
         B     @RC01048                                            1050
@RF01048 MVC   WTOGEN03+44(4),LALSO                                1050
*                     LINETWO=BONE; /* SET 2ND LINE WTO SW   @Z40LB01*/
@RC01048 OI    LINETWO,B'00100000'                                 1051
*                   END;            /* END MSG83 2ND LINE    @Z40LB01*/
*                                                                  1052
*                 /***************************************************/
*                 /*                                                 */
*                 /* 96 MESSAGES ONLY REQUIRE A SECOND LINE IF THE   */
*                 /*                                         @Z40LB01*/
*                 /* ERROR CAUSING THE MESSAGE TO COME UP IS A       */
*                 /*                                         @Z40LB01*/
*                 /* RESULT OF A DESTAGING ERROR. ON DESTAGE ERRORS, */
*                 /*                                         @Z40LB01*/
*                 /* THE INSTALLATION PERSONNEL REQUIRE THE VIRTUAL  */
*                 /*                                         @Z40LB01*/
*                 /* AND REAL VOLUME CYLINDERS WHERE THE ERROR       */
*                 /*                                         @Z40LB01*/
*                 /* OCCURRED TO BE TRANSLTED AND REPORTED TO THE    */
*                 /*                                         @Z40LB01*/
*                 /* OPERATOR SO CORRECTIVE ACTION CAN BE INITIATED  */
*                 /*                                         @Z40LB01*/
*                 /* TO RECOVER FROM THE ERROR.              @Z40LB01*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1053
*                 IF MSGC='96'X&DSTGERR=BONE THEN/* 2ND LINE REQ   1053
*                                                            @Z40LB01*/
@RF01040 L     @12,MSGPTR                                          1053
         CLI   MSGC(@12),150                                       1053
         BNE   @RF01053                                            1053
         TM    DSTGERR,B'01000000'                                 1053
         BNO   @RF01053                                            1053
*                   DO;             /* MSG96 2ND LINE        @Z40LB01*/
*                     WTOGEN03=MESGS(MSG09602);/* FILL WTO BUFFER  1055
*                                                            @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    1055
         L     @11,@CA02101                                        1055
         MVC   WTOGEN03(72),MESGS-MSGS+912(@11)                    1055
*                     WTOGEN03(56:61)=MSGDATA(7:12);/* VOLID @Z40LB01*/
         MVC   WTOGEN03+55(6),MSGDATA+6(@12)                       1056
*                     BYTE4C=MSGDATA(6:6);/* CYLINDER IN ERROR     1057
*                                                            @Z40LB01*/
         MVC   BYTE4C(1),MSGDATA+5(@12)                            1057
*                     LOOPEND=BZERO;/* SET LOOPEND SW OFF    @Z40LB01*/
         NI    LOOPEND,B'11101111'                                 1058
*                     IF BYTE4=F0 THEN/* USE CYL 0 IN CALC   @Z40LB01*/
         CLI   BYTE4,0                                             1059
         BNE   @RF01059                                            1059
*                       J=F1;       /* SET J = 1             @Z40LB01*/
         MVC   J(4),@CF00117                                       1060
*                     ELSE          /* FIND THE CYL NO       @Z40LB01*/
*                       DO;         /* SCAN CYL BITS FIRST   @Z40LB01*/
         B     @RC01059                                            1061
@RF01059 DS    0H                                                  1062
*                         J=F0;     /* SET RELATIVE CYL NO   @Z40LB01*/
         SLR   @12,@12                                             1062
         ST    @12,J                                               1062
*                         DO UNTIL LOOPEND=BONE;/* SCAN BITS @Z40LB01*/
@DL01063 DS    0H                                                  1064
*                           J=J+F1; /* DEC RELATIVE CYL NO   @Z40LB01*/
         LA    @12,1                                               1064
         AL    @12,J                                               1064
         ST    @12,J                                               1064
*                           IF CONFGMSK(J)=(BYTE4&CONFGMSK(J)) THEN/*
*                                                            @Z40LB01*/
         SLR   @11,@11                                             1065
         IC    @11,CONFGMSK-1(@12)                                 1065
         SLR   @12,@12                                             1065
         IC    @12,BYTE4                                           1065
         NR    @12,@11                                             1065
         CR    @11,@12                                             1065
         BNE   @RF01065                                            1065
*                             LOOPEND=BONE;/* SET LOOP EXIT SW     1066
*                                                            @Z40LB01*/
         OI    LOOPEND,B'00010000'                                 1066
*                         END;      /* END DO UNTIL LOOP     @Z40LB01*/
@RF01065 DS    0H                                                  1067
@DE01063 TM    LOOPEND,B'00010000'                                 1067
         BNO   @DL01063                                            1067
*                       END;        /* END SCAN              @Z40LB01*/
*                     INTER=''B;    /* CLEAR CONV WORK AREA  @Z40LB01*/
@RC01059 XC    INTER(4),INTER                                      1069
*                     BYTE4C=MSGDATA(5:5);/* THE REAL PAGE NO BYTE 1070
*                                                            @Z40LB01*/
*                                                                  1070
         L     @12,MSGPTR                                          1070
         MVC   BYTE4C(1),MSGDATA+4(@12)                            1070
*                     /***********************************************/
*                     /*                                             */
*                     /* ALGORITHM FOR REAL CYL CALCULATION -        */
*                     /*                                     @Z40LB01*/
*                     /* REAL PAGE *8 -7 +CYLINDER           @Z40LB01*/
*                     /* THE CYL BYTE IS BIT SENSITIVE 0THRU7        */
*                     /*                                     @Z40LB01*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1071
*                     INTER=(INTER*8)+J-F8;/* CALC REAL VOL CYL NO 1071
*                                                            @Z40LB01*/
         L     @12,INTER                                           1071
         SLL   @12,3                                               1071
         AL    @12,J                                               1071
         SL    @12,@CF00115                                        1071
         ST    @12,INTER                                           1071
*                     CALL ICBMSG82;/* CONV SUBROUTINE       @Z40LB01*/
         BAL   @14,ICBMSG82                                        1072
*                     WTOGEN03(45:47)=BYTES234;/* REAL VOL CYL     1073
*                                                            @Z40LB01*/
         MVC   WTOGEN03+44(3),BYTES234                             1073
*                     INTER=''B;    /* CLEAR CONV WORK AREA  @Z40LB01*/
         XC    INTER(4),INTER                                      1074
*                     BYTE4C=MSGDATA(4:4);/* THE VIRT PAGE NO BYTE 1075
*                                                            @Z40LB01*/
*                                                                  1075
         L     @12,MSGPTR                                          1075
         MVC   BYTE4C(1),MSGDATA+3(@12)                            1075
*                     /***********************************************/
*                     /*                                             */
*                     /* ALGORITHM FOR VIRT CYL CALCULATION -        */
*                     /*                                     @Z40LB01*/
*                     /* VIRT PAGE *8 +CYLINDER              @Z40LB01*/
*                     /* THE CYL BYTE IS BIT SENSITIVE 0THRU7        */
*                     /*                                     @Z40LB01*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1076
*                     INTER=(INTER*8)+J-F1;/* CALC VIRT VOL CYL NO 1076
*                                                            @Z40LB01*/
         L     @12,INTER                                           1076
         SLL   @12,3                                               1076
         AL    @12,J                                               1076
         BCTR  @12,0                                               1076
         ST    @12,INTER                                           1076
*                     CALL ICBMSG82;/* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        1077
*                     WTOGEN03(31:33)=BYTES234;/* VIRT VOL CYL     1078
*                                                            @Z40LB01*/
         MVC   WTOGEN03+30(3),BYTES234                             1078
*                     LINETWO=BONE; /* SET SW FOR 2ND WTO    @Z40LB01*/
         OI    LINETWO,B'00100000'                                 1079
*                   END;            /* END MSG96 2ND LINE    @Z40LB01*/
*                                                                  1080
*                 /***************************************************/
*                 /*                                                 */
*                 /* 9C MESSAGES ONLY REQUIRE A SECOND LINE IF THE   */
*                 /*                                         @ZA17153*/
*                 /* CART LABEL IS READABLE.                 @ZA17153*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1081
*                 IF MSGC='9C'X&BADLAB=BZERO THEN/*          @ZA17153*/
@RF01053 L     @12,MSGPTR                                          1081
         CLI   MSGC(@12),156                                       1081
         BNE   @RF01081                                            1081
         TM    BADLAB+2(@12),B'10000000'                           1081
         BNZ   @RF01081                                            1081
*                   DO;             /* CART LABEL GOOD CODE  @ZA17153*/
*                     WTOGEN03=MESGS(MSG10202);/* FILL MSG BUFFER  1083
*                                                            @ZA17153*/
         MVI   WTOGEN03+72,C' '                                    1083
         L     @11,@CA02101                                        1083
         MVC   WTOGEN03(72),MESGS-MSGS+3192(@11)                   1083
*                     WTOGEN03(11:61)=MSGDATA(43:93);/* LABEL DATA 1084
*                                      FLD                   @ZA17153*/
         MVC   WTOGEN03+10(51),MSGDATA+42(@12)                     1084
*                     LINETWO=BONE; /* SET SECOND LINE SW    @ZA17153*/
         OI    LINETWO,B'00100000'                                 1085
*                   END;            /* END LABEL GOOD CODE   @ZA17153*/
*                                                                  1086
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF ANY NEW MESSAGES NEED A SECOND LINE ADD A    */
*                 /*                                         @Z40LB01*/
*                 /* TEST FOR THAT MSGC AND BUILD THE SECOND LINE    */
*                 /*                                         @Z40LB01*/
*                 /* FOR THE MESSAGE HERE.                   @Z40LB01*/
*                 /* THE NEXT CODE MOVES THE MESSAGE INTO THE WTO    */
*                 /*                                         @Z40LB01*/
*                 /* LIST WORK AREA AND ISSUES THE WTO MACRO.        */
*                 /*                                         @Z40LB01*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1087
*                 IF LINETWO=BONE THEN/* 1ND WTO REQUIRED    @Z40LB01*/
@RF01081 TM    LINETWO,B'00100000'                                 1087
         BNO   @RF01087                                            1087
*                   DO;             /* SET UP AND ISSUE WTO  @Z40LB01*/
*IWTO3:                                                            1089
*                     DO;           /* WTOP MF(E,WTOGEN) RTCD(R15)   */
IWTO3    DS    0H                                                  1090
*                       RFY                                        1090
*                         GPR01P RSTD;/* RESTRICT REG 1              */
*                       GPR01P=ADDR(WTOGEN);/* ADDRESS CONTROL     1091
*                                      PROGRAM LIST                  */
         LA    GPR01P,WTOGEN                                       1091
*                       SVC(35);    /* ISSUE WTO SVC                 */
         SVC   35                                                  1092
*                       RFY                                        1093
*                         GPR15F RSTD;/* RESTRICT REG 15             */
*                       R15=GPR15F; /* SAVE SVC RETURN CODE          */
*                       RFY                                        1095
*                         GPR15F UNRSTD;/* RELEASE REG 15            */
*                       RFY                                        1096
*                         GPR01P UNRSTD;/* RELEASE REG 1             */
*                     END;          /* WTOP MF(E,WTOGEN) RTCD(R15) 1097
*                                      ISSUE WTO MACRO       @Z40LB01*/
*                   END;            /* END 2ND WTO           @Z40LB01*/
*               END;                /* END SECOND LINE CODE  @Z40LB01*/
@RF01087 DS    0H                                                  1100
*           END;                    /* END OF WTO OK CODE    @Z40LB01*/
@RF01037 DS    0H                                                  1101
*         WTOGEN04=SAVDESC;         /* RESTORE ORIG DESC     @Z40LB01*/
@RF01019 MVC   WTOGEN04(2),SAVDESC                                 1101
*         WTOGEN05=SAVROUT;         /* RESTORE ORIG ROUT     @Z40LB01*/
         MVC   WTOGEN05(2),SAVROUT                                 1102
*       END;                        /* END UNSOLICITED MESSAGE     1103
*                                      PROCESS               @Z40LB01*/
*                                                                  1104
*/******************************************************     @Z40LB01*/
*/*                                                          @Z40LB01*/
*/*  RETURN TO CALLING ROUTINE ICBMSG10.                     @Z40LB01*/
*/*                                                          @Z40LB01*/
*/******************************************************     @Z40LB01*/
*                                                                  1104
*   RFY                                                            1104
*     R1 UNRSTD;                    /* FREE R1               @Z40LB01*/
@RC00742 DS    0H                                                  1104
@RC00736 DS    0H                                                  1105
*   RFY                                                            1105
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1415;                   /* RESTORE REG 14        @Z40LB01*/
         L     R14,SAVR1415                                        1106
*   RFY                                                            1107
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG10       @Z40LB01*/
@EL00007 DS    0H                                                  1108
@EF00007 DS    0H                                                  1108
@ER00007 BR    @14                                                 1108
*   END ICBMSG15;                   /*                       @Z40LB01*/
*                                                                  1110
*/****************************************************       #Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG16                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = SMF CONFIGURATION SUBROUTINE         @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = CREATE AND WRITE SMF CONFIGURATION RECORD    @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = TO DEFINE AN SMF CONFIGURATION RECORD       @Y30LB03
*       THAT REFLECTS THOSE UNITS IN MSS THAT EXIST AND       @Y30LB03
*       ARE ONLINE.  AND, TO RECORD THIS DATA ON SYS1.MANX.   @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = CONFIGURATION MESSAGE (CONTAINING SMF DATA)   @Y30LB03
*       THAT APPLIES TO MSS AT TIME OF THIS IPL.              @ZM31014
*       (THIS IS A 92 MESSAGE FROM THE MSC )                  @ZM31014
*                                                             @Y30LB03
*02*    OUTPUT = SMF RECORD WRITTEN TO SYS1.MANX              @Y30LB03
*       MESSAGE ICB094I ABOUT TABLES PACKS IS SENT TO CONSOLE @ZM31014
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1110
*ICBMSG16:                                                         1110
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG16 DS    0H                                                  1111
*/*  VARIABLE DATA FOR SMF CONFIGURATION RECORD, TYPE 22     @Y30LB03*/
*                                                                  1111
*   DCL                                                            1111
*     SSIDLENM FIXED CONSTANT(2);   /* CHARS TO FILL IN LESS 1     1111
*                                                            @ZD00177*/
*/*  POSITION IN MESSAGE FOR 1ST CHAR OF TABLES PACK SSIDS   @ZD00177*/
*                                                                  1112
*   DCL                                                            1112
*     PAKMPOS(2) FIXED(8) INIT(41,62);/* PACK PLACE IN MSG   @ZD00177*/
*   RFY                                                            1113
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1416=R14;                   /* SAVE REGISTER 14      @Z307B04*/
         ST    R14,SAVR1416                                        1114
*   RFY                                                            1115
*     R14 UNRSTD;                   /*                       @G24LB02*/
*/*  *****************************************************   @Y30LB03*/
*/*                                                          @Y30LB03*/
*                                                                  1116
*   RFY                                                            1116
*     SMF22IPL BASED(SMF22PTR+LENGTH(SMFRCD22));/*           @G24LB02*/
*   IF CVTSMCA^=F0 THEN             /* IS SMF AVAILABLE?     @Y30LB03*/
         L     @12,CVTPTR                                          1117
         L     @12,CVTSMCA(,@12)                                   1117
         LTR   @12,@12                                             1117
         BZ    @RF01117                                            1117
*     DO;                           /* YES, CONTINUE         @Y30LB03*/
*                                                                  1118
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE SMF RECORD TYPE 22                     @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1119
*       SMFRCD22=''B;               /* ZERO RECORD           @G24LB02*/
         L     @12,SMF22PTR                                        1119
         XC    SMFRCD22(22,@12),SMFRCD22(@12)                      1119
*       SMF22LEN=LENGTH(SMFRCD22)+LENGTH(SMF22IPL);                1120
         MVC   SMF22LEN(2,@12),@CH00935                            1120
*       SMF22RTY='16'X;             /* RECORD TYPE 22        @G24LB02*/
         MVI   SMF22RTY(@12),X'16'                                 1121
*       SMF22IND='04'X;             /* RECORD CREATOR INDIC  @G24LB02*/
         LA    @11,4                                               1122
         STH   @11,SMF22IND(,@12)                                  1122
*       SMF22ECT='0001'X;           /* NUMBER OF RECS        @G24LB02*/
         MVC   SMF22ECT(2,@12),@CH02431                            1123
*       SMF22IPL=''B;               /* ZERO IPL LIST         @G24LB02*/
         LA    @11,22                                              1124
         ALR   @11,@12                                             1124
         XC    SMF22IPL(42,@11),SMF22IPL(@11)                      1124
*       SMF22IID='04'X;             /* RECORD ELEMENT        @G24LB02*/
         MVI   SMF22IID(@11),X'04'                                 1125
*       SMF22ION=EXIST&ONLIN;       /* DEFINE SMF DATA       @G24LB02*/
         L     @09,MSGPTR                                          1126
         MVC   SMF22ION(40,@11),EXIST(@09)                         1126
         NC    SMF22ION(40,@11),ONLIN(@09)                         1126
*       RFY                                                        1127
*         R1 RSTD;                  /*                       @G24LB02*/
*       R1=SMF22PTR;                /* PTR TO SMF PARM LIST  @G24LB02*/
         LR    R1,@12                                              1128
*       CALL ICBMSG83;              /* CALL SMF SUBRTN       @G24LB02*/
         BAL   @14,ICBMSG83                                        1129
*       RFY                                                        1130
*         R1 UNRSTD;                /*                       @G24LB02*/
*     END;                          /*                       @ZM31014*/
*/*  GET AND PRINT PRIMARY AND SECONDARY TABLES PACK ID INFO @ZD00177*/
*                                                                  1132
*   WTOGEN03=MESGS(MSG09401);       /* FILL WTO BUFFER       @Z40LB01*/
@RF01117 MVI   WTOGEN03+72,C' '                                    1132
         L     @12,@CA02101                                        1132
         MVC   WTOGEN03(72),MESGS-MSGS+2356(@12)                   1132
*   DO K=F1 TO F2;                  /* DO ONCE FOR PRIMARY, ONCE FOR
*                                      SECONDARY             @ZD00177*/
         LA    @12,1                                               1133
         ST    @12,K                                               1133
@DL01133 DS    0H                                                  1134
*     INTER=''B;                    /* CLEAR CONVERSION AREA @ZD00177*/
         XC    INTER(4),INTER                                      1134
*     BYTE4C=TPAKSSID(K);           /* BYTE OF ID FROM MSC MESSAGE 1135
*                                                            @ZD00177*/
         L     @11,MSGPTR                                          1135
         ALR   @11,@12                                             1135
         MVC   BYTE4C(1),TPAKSSID+1(@11)                           1135
*     CALL ICBMSG82;                /* FOR CONVERSION TO EBCDIC    1136
*                                                            @ZD00177*/
*                                                                  1136
         BAL   @14,ICBMSG82                                        1136
*     /***************************************************************/
*     /*                                                             */
*     /* PUT CONVERTED CUU INTO MESSAGE AT PROPER POSITION   @ZD00177*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1137
*     WTOGEN03(PAKMPOS(K):PAKMPOS(K)+SSIDLENM)=BYTES234;/*   @Z40LB01*/
         L     @12,K                                               1137
         SLR   @11,@11                                             1137
         IC    @11,PAKMPOS-1(@12)                                  1137
         LA    @09,WTOGEN03-1(@11)                                 1137
         MVC   0(3,@09),BYTES234                                   1137
*   END;                            /* CONVERTING SSID OF TABLES   1138
*                                      PACKS                 @ZD00177*/
         AL    @12,@CF00117                                        1138
         ST    @12,K                                               1138
         C     @12,@CF00129                                        1138
         BNH   @DL01133                                            1138
*/*  NOW WRITE TABLES PACK ID MESSAGE                        @ZD00177*/
*                                                                  1139
*   CALL ICBMSG45;                  /* SUBROUTINE WHICH WRITES     1139
*                                      MESSAGE               @ZD00177*/
         BAL   @14,ICBMSG45                                        1139
*   RFY                                                            1140
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1416;                   /* RESTORE REGISTER 14   @Z307B04*/
         L     R14,SAVR1416                                        1141
*   RFY                                                            1142
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RETURN TO ICBMSG15    @Y30LB03*/
@EL00008 DS    0H                                                  1143
@EF00008 DS    0H                                                  1143
@ER00008 BR    @14                                                 1143
*   END ICBMSG16;                   /*                       @Y30LB03*/
*                                                                  1145
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG17                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = CONFIGURATION MESSAGE SUBROUTINE     @ZM31014
*                                                             @Y30LB03
*01*  FUNCTION = PROCESS MSS CONFIGURATION MESSAGE  (90)      @ZM31014
*                                                             @Y30LB03
*02*    INPUT = MSC MESSAGE THAT INDICATES STATUS OF EACH     @Y30LB03
*               SSID DEFINED IN MSS.                          @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = CONFIGURATION MESSAGES (INFORMATIONAL        @Y30LB03
*       AND ERROR) WRITTEN TO OPERATOR.                       @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1145
*ICBMSG17:                                                         1145
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
*                                                                  1145
ICBMSG17 DS    0H                                                  1146
*   /*****************************************************************/
*   /*                                                               */
*   /* DESC. FOR MSG 92                                      @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1146
*   DCL                                                            1146
*     WTO92 BIT(16) INIT('0010000000000000'B);/*             @Y30LB03*/
*                                                                  1146
*   /*****************************************************************/
*   /*                                                               */
*   /* DESC. FOR OTHERS                                      @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1147
*   DCL                                                            1147
*     WTOREST BIT(16) INIT('0001000000000000'B);/*           @Y30LB03*/
*   RFY                                                            1148
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1417=R14;                   /* SAVE REGISTER 14 FOR RETURN 1149
*                                                            @ZD00177*/
         ST    R14,SAVR1417                                        1149
*   RFY                                                            1150
*     R14 UNRSTD;                   /*                       @G24LB02*/
*/*********************************************************  #YM02189*/
*/* ZERO OUT THE RESERVED BYTES IN THE MSG                   #YM02189*/
*/*********************************************************  #YM02189*/
*                                                                  1151
*   EXISTING(39)=F0;                /*                       #YM02189*/
         LA    @12,2                                               1151
         AL    @12,MSGPTR                                          1151
         MVI   EXISTING+38(@12),X'00'                              1151
*   ONLINE(39)=F0;                  /*                       #YM02189*/
         MVI   ONLINE+38(@12),X'00'                                1152
*   AVAILBL(39)=F0;                 /*                       #YM02189*/
         MVI   AVAILBL+38(@12),X'00'                               1153
*   DO K=F1 TO F40;                 /* DETERMINE STATUS OF   #Y30LB03
*                                      SSID ACCORDING TO     @Y30LB03
*                                      CONFIG MAPPING OF MSG @Y30LB03*/
         LA    @12,1                                               1154
         ST    @12,K                                               1154
@DL01154 DS    0H                                                  1155
*     DO J=F1 TO F8;                /* DO LOOP FOR BITS      @Y30LB03*/
*                                                                  1155
         LA    @12,1                                               1155
         ST    @12,J                                               1155
@DL01155 DS    0H                                                  1156
*       /*************************************************************/
*       /*                                                           */
*       /* DOES SSID EXIST?                                  @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1156
*       IF CONFGMSK(J)=(EXISTING(K)&CONFGMSK(J)) THEN/*      @Y30LB03*/
         L     @11,K                                               1156
         LA    @09,2                                               1156
         AL    @09,MSGPTR                                          1156
         ALR   @11,@09                                             1156
         MVC   @TS00001(1),EXISTING-1(@11)                         1156
         LA    @11,CONFGMSK-1(@12)                                 1156
         NC    @TS00001(1),0(@11)                                  1156
         LA    @11,CONFGMSK-1(@12)                                 1156
         CLC   0(1,@11),@TS00001                                   1156
         BNE   @RF01156                                            1156
*         IF CONFGMSK(J)=(ONLINE(K)&CONFGMSK(J)) THEN/*      @Y30LB03
*                                      YES,IS IT ONLINE?     @Y30LB03*/
         L     @11,K                                               1157
         ALR   @11,@09                                             1157
         MVC   @TS00001(1),ONLINE-1(@11)                           1157
         LA    @11,CONFGMSK-1(@12)                                 1157
         NC    @TS00001(1),0(@11)                                  1157
         LA    @11,CONFGMSK-1(@12)                                 1157
         CLC   0(1,@11),@TS00001                                   1157
         BNE   @RF01157                                            1157
*           IF CONFGMSK(J)=(AVAILBL(K)&CONFGMSK(J)) THEN/*   @Y30LB03
*                                      YES,IS IT AVAILBL?    @Y30LB03*/
         L     @11,K                                               1158
         ALR   @09,@11                                             1158
         MVC   @TS00001(1),AVAILBL-1(@09)                          1158
         LA    @11,CONFGMSK-1(@12)                                 1158
         NC    @TS00001(1),0(@11)                                  1158
         LA    @11,CONFGMSK-1(@12)                                 1158
         CLC   0(1,@11),@TS00001                                   1158
         BE    @RT01158                                            1158
*             ;                                                    1159
*           ELSE                    /* IF NOT AVAILABLE      @Y30LB03
*                                      (BUT ONLINE) ...      @Y30LB03*/
*             DO;                   /* CREATE SSID CONFIG    @Y30LB03
*                                      ERROR MSG             @Y30LB03*/
*               WTOGEN03=MESGS(MSG09201);/* FILL BUFF        @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    1161
         L     @12,@CA02101                                        1161
         MVC   WTOGEN03(72),MESGS-MSGS+2280(@12)                   1161
*               WTOGEN03(14:16)=SSIDS((K-F1)*F8+J);/*        @Z40LB01
*                                      FILL IN SSID          @Y30LB03*/
         L     @12,K                                               1162
         BCTR  @12,0                                               1162
         SLA   @12,3                                               1162
         AL    @12,J                                               1162
         MH    @12,@CH00081                                        1162
         L     @11,@CA02112                                        1162
         ALR   @11,@12                                             1162
         AL    @11,@CF03331                                        1162
         MVC   WTOGEN03+13(3),SSIDS-SSIDS(@11)                     1162
*               WTOGEN04=WTO92;     /* FILL IN DESC.         @Y30LB03*/
         MVC   WTOGEN04(2),WTO92                                   1163
*               CALL ICBMSG45;      /* CALL WTO SUBRTN       @Y30LB03*/
         BAL   @14,ICBMSG45                                        1164
*               WTOGEN04=WTOREST;   /* RESTORE DESC.         @Y30LB03*/
         MVC   WTOGEN04(2),WTOREST                                 1165
*             END;                  /*                       @Y30LB03*/
*         ELSE                      /* NOT ONLINE            @Y30LB03*/
*           DO;                     /* CREATE SSID OFFLINE   @Y30LB03
*                                      INFORMATION MSG       @Y30LB03*/
         B     @RC01157                                            1167
@RF01157 DS    0H                                                  1168
*             WTOGEN03=MESGS(MSG09001);/* FILL WTO BUFF      @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    1168
         L     @12,@CA02101                                        1168
         MVC   WTOGEN03(72),MESGS-MSGS+2204(@12)                   1168
*             WTOGEN03(14:16)=SSIDS((K-F1)*F8+J);/*          @Z40LB01
*                                      FILL IN SSID          @Y30LB03*/
         L     @12,K                                               1169
         BCTR  @12,0                                               1169
         SLA   @12,3                                               1169
         AL    @12,J                                               1169
         MH    @12,@CH00081                                        1169
         L     @11,@CA02112                                        1169
         ALR   @11,@12                                             1169
         AL    @11,@CF03331                                        1169
         MVC   WTOGEN03+13(3),SSIDS-SSIDS(@11)                     1169
*             CALL ICBMSG45;        /* CALL WTO SUBRTN       @Y30LB03*/
         BAL   @14,ICBMSG45                                        1170
*           END;                    /*                       @Y30LB03*/
*     END;                          /*                       @Y30LB03*/
@RC01157 DS    0H                                                  1172
@RF01156 LA    @12,1                                               1172
         AL    @12,J                                               1172
         ST    @12,J                                               1172
         C     @12,@CF00115                                        1172
         BNH   @DL01155                                            1172
*   END;                            /*                       @Y30LB03*/
         LA    @12,1                                               1173
         AL    @12,K                                               1173
         ST    @12,K                                               1173
         C     @12,@CF02094                                        1173
         BNH   @DL01154                                            1173
*   RFY                                                            1174
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1417;                   /* RESTORE RETURN ADDRESS      1175
*                                                            @ZD00177*/
         L     R14,SAVR1417                                        1175
*   RFY                                                            1176
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RETURN TO ICBMSG15    @Y30LB03*/
@EL00009 DS    0H                                                  1177
@EF00009 DS    0H                                                  1177
@ER00009 BR    @14                                                 1177
*   END ICBMSG17;                   /*                       @ZM31014*/
*                                                                  1179
*/********************************************************   @ZM31014*/
*/*                                                          @ZM31014*/
*/*     ICBMSG18     HANDLES 90 AND 92 MESSAGES FROM MSC     @ZM31014*/
*/*                                                          @ZM31014*/
*/*     PURPOSE   DURING MSSC INITIALIZATION,                @ZM31014*/
*/*           GET STORAGE IN WHICH THE LAST-RECEIVED 90 AND  @ZM31014*/
*/*             92 MESSAGES MAY BE KEPT.                     @ZM31014*/
*/*           WRITE EACH 90 OR 92 MESSAGE RECEIVED ON TOP OF @ZM31014*/
*/*           ITS PREDECESSOR IN THIS SPECIAL AREA           @ZM31014*/
*/*           WHEN NOTIFIED THAT ALL OF THE MSC BUFFERS HAVE @ZM31014*/
*/*           BEEN EMPTIED, PERFORM PROCESSING FOR THE 92 AND@ZM31014*/
*/*           90 MESSAGE (THERE MUST BE AT LEAST ONE 92)     @ZM31014*/
*/*           AFTER PROCESSING THE LATEST 90 AND 92 RECEIVED @ZM31014*/
*/*           DURING SYSTEM INITIALIZATION, FREES THE SPECIAL@ZM31014*/
*/*           STORAGE OBTAINED TO KEEP THESE MESSAGES        @ZM31014*/
*/*         AFTER SYSTEM INITIALIZATION, 90 AND 92 MESSAGES  @ZM31014*/
*/*         ARE NOT PROCESSED BY THIS MODULE                 @ZM31014*/
*/*                                                          @ZM31014*/
*/*     INPUT A 90 OR 92 MESSAGE, OR SWITCHES ONLY           @ZM31014*/
*/*                                                          @ZM31014*/
*/********************************************************   @ZM31014*/
*                                                                  1179
*ICBMSG18:                                                         1179
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZM31014*/
ICBMSG18 DS    0H                                                  1180
*   RFY                                                            1180
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1418=R14;                   /*                       @ZM31014*/
         ST    R14,SAVR1418                                        1181
*   RFY                                                            1182
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   IF SKIP9092=BONE                /* ARE ALL 90,92 BEING SKIPPED?
*                                                            @ZM31014*/
*     THEN                                                         1183
         TM    SKIP9092,B'00010000'                                1183
         BO    @RT01183                                            1183
*     ;                             /* YES, DO NOTHING BUT RETURN  1184
*                                                            @ZM31014*/
*   ELSE                            /* THERE SOMETHING FOR MSG18 TO
*                                      DO                    @ZM31014*/
*     DO;                           /*                       @ZM31014*/
*       IF NEED9092=BONE            /* NEED STORAGE TO SAVE 90 & 92?
*                                                            @ZM31014*/
*         THEN                                                     1186
         TM    NEED9092,B'10000000'                                1186
         BNO   @RF01186                                            1186
*         DO;                       /* OBTAIN THAT STORAGE   @ZM31014*/
*           RFY                                                    1188
*            (R0,                                                  1188
*             R1,                                                  1188
*             R15) RSTD;            /*                       @ZM31014*/
*           R0=LENGTH(STOR9092);    /* AMOUNT NEEDED         @ZM31014*/
         LA    R0,248                                              1189
*IGETMN3:                           /*                       @ZM31014*/
*           GEN REFS(R0,R1,R15) SETS(R0,R1,R15);                   1190
IGETMN3  DS    0H                                                  1190
*                                                          /*@ZM31014*/
     GETMAIN RC,LV=(R0),RELATED=(ICB2MSG(IFREEMN5))            @ZM31014
*           IF R15^=0               /* SOME PROBLEM ?        @ZM31014*/
*             THEN                  /* NO STORAGE FOR 90 & 92      1191
*                                                            @ZM31014*/
         LTR   R15,R15                                             1191
         BZ    @RF01191                                            1191
*             DO;                   /* WILL NOT PROCESS ANY  @ZM31014*/
*               WTOGEN03=MESGS(MSG98701);/* FILL WTO BUFFER  @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    1193
         L     @14,@CA02101                                        1193
         MVC   WTOGEN03(72),MESGS-MSGS+2964(@14)                   1193
*               CALL ICBMSG45;      /* WHICH WRITES MESSAGE  @ZM31014*/
         BAL   @14,ICBMSG45                                        1194
*               SAVE9092=BZERO;     /* NOT SAVING ANY        @ZM31014*/
*               SKIP9092=BONE;      /* WILL SKIP HEREAFTER   @ZM31014*/
         OI    SKIP9092,B'00010000'                                1196
         NI    SAVE9092,B'10111111'                                1196
*             END;                  /*                       @ZM31014*/
*           ELSE                    /* HAVE STORAGE TO PILE MESSAGES
*                                      INTO                  @ZM31014*/
*             DO;                   /*                       @ZM31014*/
         B     @RC01191                                            1198
@RF01191 DS    0H                                                  1199
*               PNTR9092=R1;        /* ADDR OF 9092 STORAGE  @ZM31014*/
         ST    R1,PNTR9092                                         1199
*               NEED9092=BZERO;     /* NOTE HAVE STORAGE     @ZM31014*/
         NI    NEED9092,B'01111111'                                1200
*             END;                  /* STORAGE ADDRESSABILITY      1201
*                                                            @ZM31014*/
*           RFY                                                    1202
*            (R0,                                                  1202
*             R1,                                                  1202
*             R15) UNRSTD;          /*                       @ZM31014*/
@RC01191 DS    0H                                                  1203
*         END;                      /* GETTING STORAGE FOR 90 & 92 1203
*                                                            @ZM31014*/
*       ELSE                                                       1204
*         ;                         /* DO NOT NEED TO GET STORAGE  1204
*                                                            @ZM31014*/
@RF01186 DS    0H                                                  1205
*       IF SAVE9092=BONE            /* IS THERE A 90 OR 92 TO KEEP?
*                                                            @ZM31014*/
*         THEN                      /* YES                   @ZM31014*/
         TM    SAVE9092,B'01000000'                                1205
         BNO   @RF01205                                            1205
*         DO;                       /*                       @ZM31014*/
*           IF MCODE='90'X          /* A 90 ?                @ZM31014*/
*             THEN                                                 1207
         L     @12,MSGPTR                                          1207
         CLI   MCODE(@12),X'90'                                    1207
         BNE   @RF01207                                            1207
*             DO;                   /*                       @ZM31014*/
*               STOR90=CONFIG;      /* SAVE THIS AS LATEST   @ZM31014*/
         L     @11,PNTR9092                                        1209
         MVC   STOR90(124,@11),CONFIG(@12)                         1209
*               HAVE90=BONE;        /* NOTE HAVE A 90        @ZM31014*/
         OI    HAVE90,B'00001000'                                  1210
*             END;                  /*                       @ZM31014*/
*           ELSE                                                   1212
*             DO;                   /* MUST BE A 92 IF GET HERE    1212
*                                                            @ZM31014*/
         B     @RC01207                                            1212
@RF01207 DS    0H                                                  1213
*               STOR92=CONFIG;      /* WRITE INTO AREA       @ZM31014*/
         L     @12,PNTR9092                                        1213
         L     @11,MSGPTR                                          1213
         MVC   STOR92(124,@12),CONFIG(@11)                         1213
*               HAVE92=BONE;        /* HAVE A 92             @ZM31014*/
         OI    HAVE92,B'00000100'                                  1214
*             END;                  /*                       @ZM31014*/
*         END;                      /* PROCESSING WITH SAVE9092 ON 1216
*                                                            @ZM31014*/
*       ELSE                                                       1217
*         ;                         /* NO SINGLE MESSAGE TO SAVE   1217
*                                                            @ZM31014*/
@RF01205 DS    0H                                                  1218
*       IF PROC9092=BONE            /* TIME TO PROCESS 90 & 92 ?   1218
*                                                            @ZM31014*/
*         THEN                                                     1218
@RC01205 TM    PROC9092,B'00100000'                                1218
         BNO   @RF01218                                            1218
*         DO;                       /*                       @ZM31014*/
*           IF HAVE90=BONE          /* HAVE A 90 ?           @ZM31014*/
*             THEN                                                 1220
         TM    HAVE90,B'00001000'                                  1220
         BNO   @RF01220                                            1220
*             DO;                   /*                       @ZM31014*/
*               MSGPTR=ADDR(STOR90);/* SET UP ADDRESS        @ZM31014*/
         L     @12,PNTR9092                                        1222
         ST    @12,MSGPTR                                          1222
*               CALL ICBMSG17;      /* TO PROCESS IT         @ZM31014*/
         BAL   @14,ICBMSG17                                        1223
*             END;                  /*                       @ZM31014*/
*           ELSE                                                   1225
*             ;                     /*                       @ZM31014*/
@RF01220 DS    0H                                                  1226
*           IF HAVE92=BONE          /* HAVE A 92 ?           @ZM31014*/
*             THEN                                                 1226
         TM    HAVE92,B'00000100'                                  1226
         BNO   @RF01226                                            1226
*             DO;                   /*                       @ZM31014*/
*               MSGPTR=ADDR(STOR92);/* SET UP ADDRESS OF LAST        */
         L     @12,PNTR9092                                        1228
         LA    @12,STOR92(,@12)                                    1228
         ST    @12,MSGPTR                                          1228
*               CALL ICBMSG16;      /* TO PROCESS IT         @ZM31014*/
         BAL   @14,ICBMSG16                                        1229
*             END;                  /*                       @ZM31014*/
*           RFY                                                    1231
*            (R0,                                                  1231
*             R1) RSTD;             /*                       @ZM31014*/
@RF01226 DS    0H                                                  1232
*           R0=LENGTH(STOR9092);    /*                       @ZM31014*/
         LA    R0,248                                              1232
*           R1=ADDR(STOR9092);      /* TEMPORARY 90 & 92 AREA      1233
*                                                            @ZM31014*/
         L     R1,PNTR9092                                         1233
*IFREEMN5:                          /* FREE TEMPORARY 90 & 92 STORAGE
*                                      AREA                  @ZM31014*/
*           GEN REFS(R0,R1);                                       1234
IFREEMN5 DS    0H                                                  1234
*                                                          /*@ZM31014*/
      FREEMAIN R,LV=(R0),A=(R1),RELATED=(ICB2MSG(IGETMN3))     @ZM31014
*           PROC9092=BZERO;         /*                       @ZM31014*/
*           SAVE9092=BZERO;         /*                       @ZM31014*/
*           SKIP9092=BONE;          /* ONLY PROCESS ONCE     @ZM31014*/
         OI    SKIP9092,B'00010000'                                1237
         NI    PROC9092,B'10011111'                                1237
*         END;                      /* PROCESSING FOR PROCESS-TIME 1238
*                                      FOR 90 & 92                   */
*     END;                          /* PROCESSING WHEN NOT SKIPPING
*                                                            @ZM31014*/
@RF01218 DS    0H                                                  1240
*   RFY                                                            1240
*     R14 RSTD;                     /*                       @G24LB02*/
@RT01183 DS    0H                                                  1241
*   R14=SAVR1418;                   /*                       @ZM31014*/
         L     R14,SAVR1418                                        1241
*   RFY                                                            1242
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   END ICBMSG18;                   /*                       @ZM31014*/
@EL00010 DS    0H                                                  1243
@EF00010 DS    0H                                                  1243
@ER00010 BR    @14                                                 1243
*                                                                  1244
*/*********************************************************  #Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG20                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = POST USER ECB SUBROUTINE             @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = POST ECB FOR TASK AWAITING MSS EVENT         @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = TO VERIFY THAT THE ECB TO BE POSTED         @Y30LB03
*       IS VALID AND TO ISSUE POST SPECIFYING THE ECB         @Y30LB03
*       AND POST CODE. INVALID ECB(S) OCCUR WHEN THE          @Y30LB03
*       REQUESTING TASK HAS ABENDED. POST IS BYPASSED FOR     @Y30LB03
*       INVALID ECB(S).                                       @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = MSC SOLICITED AND DELAYED RESPONSES MESSAGES  @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = POSTED USER ECB                              @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1244
*ICBMSG20:                                                         1244
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG20 DS    0H                                                  1245
*/*  ****************************************************    @Y30LB03*/
*/*    THIS SUBROUTINE HANDLES MSC MESSAGE WHICH REQUIRE     @Y30LB03*/
*/*    POSTING OF A USER ECB.                                @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1245
*   DCL                                                            1245
*     CHARFF BIT(8) CONSTANT('FF'X);/* HEX'FF'               @Y30LB03*/
*   DCL                                                            1246
*     CHAR77 BIT(8) CONSTANT('77'X);/* HEX'77'               @YD00111*/
*   DCL                                                            1247
*     RPRNHUNT CHAR(1) BASED(CWBVREF-1);/* USED TO CHECK     @Y30LB03
*                                      FOR RIGHT PAREN       @Y30LB03*/
*   DCL                                                            1248
*     VALIDCNT FIXED(31);           /* COUNT OF NUMBER       @Y30LB03
*                                      UNITS--IF 0 ALL       @Y30LB03
*                                      HAVE HAD THEIR ECB    @Y30LB03
*                                      POSTED.               @Y30LB03*/
*   DCL                                                            1249
*     HAVELK FIXED(8);              /* SWITCH--SET WHEN      @Y30LB03
*                                      GET LOCAL LOCK        @Y30LB03*/
*   DCL                                                            1250
*     POSTC7F CHAR(1);              /* GOOD POST CODE        @Y30LB03*/
*   DCL                                                            1251
*     MSGVARY FIXED(8);             /* SWITCH--SET WHEN NO   @Y30LB03
*                                      DR Q ELT MATCH AND MSG IS   1251
*                                                            @Y30LB03
*                                      FOR MSG TASK          @Y30LB03*/
*   DCL                                                            1252
*     HIGHBIT BIT(32) BDY(WORD)     /*                       @Y30LB03*/
*         INIT('10000000000000000000000000000000'B);/* BIT MASK TO 1252
*                                      SET                   @Y30LB03
*                                      HIGH BIT OF ECBPTR FOR POST 1252
*                                                            @Y30LB03*/
*   RFY                                                            1253
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1420=R14;                   /* SAVE REG 14           @Y30LB03*/
         ST    R14,SAVR1420                                        1254
*   RFY                                                            1255
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   VALIDCNT=F0;                    /* INIT VALIDCNT         @Y30LB03*/
         SLR   @12,@12                                             1256
         ST    @12,VALIDCNT                                        1256
*   POSTC7F='7F'X;                  /* INIT GOOD POST CD     @Y30LB03*/
         MVI   POSTC7F,X'7F'                                       1257
*   MSGVARY=F0;                     /* INIT SWITCH           @Y30LB03*/
         MVI   MSGVARY,X'00'                                       1258
*   HAVELK=F0;                      /* INIT LCL LCK SWTCH    @Y30LB03*/
         MVI   HAVELK,X'00'                                        1259
*   QELTPTR=ICBQHEAD;               /* SET Q ELT PTR         @Y30LB03*/
         L     @11,ICBPTR                                          1260
         L     @11,ICBQHEAD(,@11)                                  1260
         ST    @11,QELTPTR                                         1260
*   ECBPTR=ADDR(MSGECB);            /* SET PTR TO ECBWORD    @Y30LB03*/
         L     @09,MSGPTR                                          1261
         LA    @09,MSGECB(,@09)                                    1261
         ST    @09,ECBPTR                                          1261
*   RESPECIFY                                                      1262
*     BITPATT BASED(ECBPTR);        /*                       @Y30LB03*/
*   IF QELTPTR=F0 THEN              /* IS DL RES Q EMPTY?    @Y30LB03*/
         CR    @11,@12                                             1263
         BNE   @RF01263                                            1263
*     DO;                           /* YES,...........       @Y30LB03*/
*       IF BITPATT(1:8)=CHARFF THEN /* IS HIGH BYTE OF       @Y30LB03
*                                      ECB(IN MSG) = 'FF'X?  @Y30LB03
*                                      I.E. VARY RESPONSE FOR@Y30LB03
*                                      THIS TASK ?           @Y30LB03*/
         CLI   BITPATT(@09),X'FF'                                  1265
         BNE   @RF01265                                            1265
*         MSGVARY=F1;               /* YES, SET SWTCH        @Y30LB03*/
         MVI   MSGVARY,X'01'                                       1266
*       ELSE                        /* NO,............       @Y30LB03*/
*         DO;                       /* RETURN                @Y30LB03*/
         B     @RC01265                                            1267
@RF01265 DS    0H                                                  1268
*           RFY                                                    1268
*             R14 RSTD;             /*                       @G24LB02*/
*           R14=SAVR1420;           /* SETUP REG14           @Y30LB03*/
         L     R14,SAVR1420                                        1269
*           RFY                                                    1270
*             R14 UNRSTD;           /*                       @G24LB02*/
*           RETURN;                 /* RETURN                @Y30LB03*/
@EL00011 DS    0H                                                  1271
@EF00011 DS    0H                                                  1271
@ER00011 BR    @14                                                 1271
*         END;                      /*                       @Y30LB03*/
*     END;                          /*                       @Y30LB03*/
*   ELSE                            /*                       @Y30LB03*/
*                                                                  1274
*     /***************************************************************/
*     /*                                                             */
*     /* SEARCH FOR MATCH ON ECB,QELECB PTRS OR              @Y30LB03*/
*     /* ASID,QELASID FIELDS OR HAS ELT BEEN INVALIDATED     @Y30LB03*/
*     /* BY SVC,OR END OF Q                                  @Y30LB03*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1274
*     DO WHILE((ECBRBADR^=QELECBPRMSGASID^=QELASID/*       @Y30LB03*/
*           QELFLG3=CHARFF)&MSGVARY=F0);/*                   @Y30LB03*/
         B     @RC01263                                            1274
@RF01263 B     @DE01274                                            1274
@DL01274 DS    0H                                                  1275
*       IF QELAHEAD=F0 THEN         /* END RSPNS Q CHAIN?    @Y30LB03*/
         L     @12,QELTPTR                                         1275
         L     @12,QELAHEAD-1(,@12)                                1275
         LA    @12,0(,@12)                                         1275
         LTR   @12,@12                                             1275
         BNZ   @RF01275                                            1275
*         DO;                       /* YES, .....            @Y30LB03*/
*           IF BITPATT(1:8)=CHARFF THEN/* HIGH ORDER         @Y30LB03
*                                      BYTE OF ECB = 'FF'X?  @Y30LB03
*                                      I.E.RESPONSE FOR THIS @Y30LB03
*                                      TASK?                 @Y30LB03*/
         L     @12,ECBPTR                                          1277
         CLI   BITPATT(@12),X'FF'                                  1277
         BNE   @RF01277                                            1277
*             MSGVARY=F1;           /* YES,SET SWTCH         @Y30LB03*/
         MVI   MSGVARY,X'01'                                       1278
*           ELSE                    /* NO,                   @Y30LB03*/
*             DO;                   /* RETURN                @Y30LB03*/
         B     @RC01277                                            1279
@RF01277 DS    0H                                                  1280
*               RFY                                                1280
*                 R14 RSTD;         /*                       @G24LB02*/
*               R14=SAVR1420;       /* SETUP REG14           @Y30LB03*/
         L     R14,SAVR1420                                        1281
*               RFY                                                1282
*                 R14 UNRSTD;       /*                       @G24LB02*/
*               RETURN;             /* RETURN                @Y30LB03*/
         B     @EL00011                                            1283
*             END;                  /*                       @Y30LB03*/
*         END;                      /*                       @Y30LB03*/
*       ELSE                        /* NOT END               @Y30LB03*/
*         QELTPTR=QELAHEAD;         /* INCR RES Q PTR        @Y30LB03*/
         B     @RC01275                                            1286
@RF01275 L     @12,QELTPTR                                         1286
         L     @12,QELAHEAD-1(,@12)                                1286
         LA    @12,0(,@12)                                         1286
         ST    @12,QELTPTR                                         1286
*     END;                          /*                       @Y30LB03*/
@RC01275 DS    0H                                                  1287
@DE01274 L     @12,QELTPTR                                         1287
         L     @11,ECBPTR                                          1287
         CLC   ECBRBADR(3,@11),QELECBPR(@12)                       1287
         BNE   @GL00016                                            1287
         L     @11,MSGPTR                                          1287
         CLC   MSGASID(2,@11),QELASID(@12)                         1287
         BNE   @GL00016                                            1287
         CLI   QELFLG3(@12),X'FF'                                  1287
         BNE   @DC01274                                            1287
@GL00016 CLI   MSGVARY,0                                           1287
         BE    @DL01274                                            1287
@DC01274 DS    0H                                                  1288
*   IF BITPATT(1:8)=CHARFF THEN     /* IS HIGH BYTE OF       @Y30LB03
*                                      ECB POINTED TO BY     @Y30LB03
*                                      MSGECB='FF'X ?        @Y30LB03*/
@RC01263 L     @12,ECBPTR                                          1288
         CLI   BITPATT(@12),X'FF'                                  1288
         BNE   @RF01288                                            1288
*     DO;                           /*                       @Y30LB03*/
*                                                                  1289
*       /*************************************************************/
*       /*                                                           */
*       /* ******************************************        @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* THE FOLLOWING CODE DETERMINES WHAT                @Y30LB03*/
*       /* COMMAND THE RESPONSE IF FOR, IF THE               @Y30LB03*/
*       /* EXECUTION WAS SUCCESSFUL, FILLS                   @Y30LB03*/
*       /* IN THE WTO MESSAGE ACCORDINGLY,                   @Y30LB03*/
*       /* AND CALLS ICBMSG45 WHICH ISSUES THE               @Y30LB03*/
*       /* WTO MACRO. ICBMSG46 IS THEN CALLED                @Y30LB03*/
*       /* TO FREEUP THE SPACE THAT THE COMTASK              @Y30LB03*/
*       /* QUEUE ELEMENT OCCUPIES.                           @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* ******************************************        @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1290
*       CWBPTR=MSGECB;              /* SET CNTRL BLOCK UP    @Y30LB03*/
         L     @12,MSGPTR                                          1290
         L     @11,MSGECB(,@12)                                    1290
         ST    @11,CWBPTR                                          1290
*       INTER=''B;                  /* INIT FIELD            @Y30LB03*/
         XC    INTER(4),INTER                                      1291
*       BYTES34=MSGSSID;            /* PUT SSID IN           @Y30LB03
*                                      LAST 3 BYTES          @Y30LB03*/
*                                                                  1292
         MVC   BYTES34(2),MSGSSID(@12)                             1292
*       /*************************************************************/
*       /*                                                           */
*       /* *************************************             @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* CONVERT 2 BYTE HEX SSID(UNIT)                     @Y30LB03*/
*       /* TO 3 BYTE REAL UNIT IN EBCDIC                     @Y30LB03*/
*       /* BY CALLING SUBRTN ICBMSG82                        @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* *************************************             @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1293
*       CALL ICBMSG82;              /*                       @Y30LB03*/
*                                                                  1293
         BAL   @14,ICBMSG82                                        1293
*       /*************************************************************/
*       /*                                                           */
*       /* *************************************             @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* TRANSLATED TO 3 BYTES                             @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* *************************************             @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1294
*       WTOMCS03=MESGS(MSG01301);   /* FILL WTO BUFFER       @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1294
         L     @12,@CA02101                                        1294
         MVC   WTOMCS03(72),MESGS-MSGS+2052(@12)                   1294
*       IF MSGPOSTC>CHAR77 THEN     /* GOOD CODE?            @YD00111*/
         L     @12,MSGPTR                                          1295
         CLI   MSGPOSTC(@12),X'77'                                 1295
         BNH   @RF01295                                            1295
*         WTOMCS03(27:37)='SUCCESSFUL,';/* YES,              @Z40LB01*/
         MVC   WTOMCS03+26(11),@CC02786                            1296
*       ELSE                        /* NO,                   @Y30LB03*/
*         WTOMCS03(27:37)='FAILED,    ';/* FAILED@Z40LB01            */
         B     @RC01295                                            1297
@RF01295 MVC   WTOMCS03+26(11),@CC02788                            1297
*       WTOMCS03(19:21)=BYTES234;   /* UNIT                  @Z40LB01*/
*                                                                  1298
@RC01295 MVC   WTOMCS03+18(3),BYTES234                             1298
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE POST CODE                               @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1299
*       INTER=''B;                  /* INIT FIELD            @Y30LB03*/
         XC    INTER(4),INTER                                      1299
*       BYTE4C=MSGPOSTC;            /* PUT POST CODE IN      @Y30LB03
*                                      LAST BYTE             @Y30LB03*/
         L     @12,MSGPTR                                          1300
         MVC   BYTE4C(1),MSGPOSTC(@12)                             1300
*       CALL ICBMSG82;              /* CALL CONVERSION SUB   @Z40LB01*/
*                                                                  1301
         BAL   @14,ICBMSG82                                        1301
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATED                                        @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1302
*       WTOMCS03(49:50)=BYTES34;    /* FILL IN POST CD       @Z40LB01*/
         MVC   WTOMCS03+48(2),BYTES34                              1302
*       CALL ICBMSG47;              /* CALL WTO SUBRTN       @Y30LB03*/
         BAL   @14,ICBMSG47                                        1303
*       IF MSGVARY=F0 THEN          /* WAS THERE A MATCH     @Y30LB03
*                                      IN DR QUEUE?          @Y30LB03*/
         CLI   MSGVARY,0                                           1304
         BNE   @RF01304                                            1304
*         DO;                       /* YES,                  @Y30LB03*/
*           IF CWBCOMQ=F0 THEN      /* IS THERE ONLY 1       @Y30LB03
*                                      UNIT IN COMMAND?      @Y30LB03*/
         L     @12,CWBPTR                                          1306
         CLI   CWBCOMQ(@12),0                                      1306
         BNE   @RF01306                                            1306
*             DO;                   /* YES,                  @Y30LB03*/
*               IF CWBCMND(1:3)=BYTES234 THEN/* DO SSID'S    @Y30LB03
*                                      MATCH?                @Y30LB03*/
         CLC   CWBCMND(3,@12),BYTES234                             1308
         BNE   @RF01308                                            1308
*                 DO;               /* YES,                  @Y30LB03*/
*                   CALL ICBMSG46;  /* CALL SUB RTN TO       @Y30LB03
*                                      FREE THE DEQ'D CWB    @Y30LB03*/
         BAL   @14,ICBMSG46                                        1310
*                 END;              /*                       @Y30LB03*/
*             END;                  /*                       @Y30LB03*/
*           ELSE                    /* PROCESSING FOR MULTI  @Y30LB03
*                                      UNITS                 @Y30LB03*/
*             DO;                   /*                       @Y30LB03*/
         B     @RC01306                                            1313
@RF01306 DS    0H                                                  1314
*               CWBVREF=CWBCOMQ+CWBPTR+F9;/*                 @Y30LB03*/
         L     @12,CWBPTR                                          1314
         SLR   @11,@11                                             1314
         IC    @11,CWBCOMQ(,@12)                                   1314
         ALR   @11,@12                                             1314
         AL    @11,@CF02044                                        1314
         ST    @11,CWBVREF                                         1314
*               DO WHILE RPRNHUNT^=')';/*                    @Y30LB03
*                                      FIND THE UNIT IN      @Y30LB03
*                                      THE CMND              @Y30LB03*/
         B     @DE01315                                            1315
@DL01315 DS    0H                                                  1316
*                 IF BYTES234=RU THEN/* MATCH?               @Y30LB03*/
         L     @12,CWBVREF                                         1316
         CLC   BYTES234(3),RU(@12)                                 1316
         BNE   @RF01316                                            1316
*                   RU='***';       /* CROSS UNIT OUT        @Y30LB03*/
         MVC   RU(3,@12),@CC02792                                  1317
*                 ELSE              /* IF NOT THE UNIT,      @Y30LB03*/
*                   IF RU^='***' THEN/* CKECK VALIDITY       @Y30LB03
*                                      IF VALID, INCR # OF   @Y30LB03
*                                      OUTSTANDING UNITS     @Y30LB03*/
         B     @RC01316                                            1318
@RF01316 L     @12,CWBVREF                                         1318
         CLC   RU(3,@12),@CC02792                                  1318
         BE    @RF01318                                            1318
*                     VALIDCNT=VALIDCNT+F1;/*                @Y30LB03*/
         LA    @12,1                                               1319
         AL    @12,VALIDCNT                                        1319
         ST    @12,VALIDCNT                                        1319
*                 CWBVREF=CWBVREF+F4;/* NEXT UNIT            @Y30LB03*/
@RF01318 DS    0H                                                  1320
@RC01316 LA    @12,4                                               1320
         AL    @12,CWBVREF                                         1320
         ST    @12,CWBVREF                                         1320
*               END;                /*                       @Y30LB03*/
@DE01315 L     @12,CWBVREF                                         1321
         BCTR  @12,0                                               1321
         CLI   RPRNHUNT(@12),C')'                                  1321
         BNE   @DL01315                                            1321
*               IF VALIDCNT=F0 THEN /* ANY UNITS LEFT        @Y30LB03*/
         L     @12,VALIDCNT                                        1322
         LTR   @12,@12                                             1322
         BNZ   @RF01322                                            1322
*                 DO;               /* NO,...                @Y30LB03*/
*                   CALL ICBMSG46;  /* CALL DEQUEUE          @Y30LB03
*                                      SUBRTN                @Y30LB03*/
         BAL   @14,ICBMSG46                                        1324
*                 END;              /*                       @Y30LB03*/
*             END;                  /*                       @Y30LB03*/
*         END;                      /*                       @Y30LB03*/
*       GO TO DQELT;                /* GO DEQUEUE ELT        @Y30LB03*/
         B     DQELT                                               1328
*     END;                          /*                       @Y30LB03*/
*   IF QELFLG2=CHARFF THEN          /* DID TASK ABEND?       @Y30LB03*/
@RF01288 L     @12,QELTPTR                                         1330
         CLI   QELFLG2(@12),X'FF'                                  1330
         BE    @RT01330                                            1330
*     GO TO DQELT;                  /* YES,BRCH TO DQ IT     @Y30LB03*/
*                                                                  1331
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT HAVE MATCH OF MESSAGE FROM MSC AND      @ZM31001*/
*   /* A DELAYED RESPONSE QUEUE ELEMENT, BY ECB ADDRESS      @ZM31001*/
*   /* AND ASID NUMBER, STILL HAVE VALID DRQ ELEMENT,        @ZM31001*/
*   /* SO WILL FLAG IT FOR EVENTUAL REMOVAL LEST IT BE       @ZM31001*/
*   /* LEFT ON IF NORMAL PROCESSING IS INTERRUPTED (FOR      @ZM31001*/
*   /* EXAMPLE, POST PROCESSING IS NOT COMPLETED )           @ZM31001*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1332
*   QELFLG3=CHARFF;                 /* MARK ELEMENT FINISHED @ZM31001*/
         MVI   QELFLG3(@12),X'FF'                                  1332
*   IF ECBRBADR=F0 THEN             /* INVALID ECB           @Y30LB03*/
         L     @12,ECBPTR                                          1333
         L     @11,ECBRBADR-1(,@12)                                1333
         LA    @11,0(,@11)                                         1333
         LTR   @11,@11                                             1333
         BZ    @RT01333                                            1333
*     GO TO DQELT;                  /* YES,BRCH TO DQ IT     @Y30LB03*/
*   IF BITPATT(31:32)^=B2ZERO THEN  /* ECB ON WD BDY?        @Y30LB03*/
         TM    BITPATT+3(@12),B'00000011'                          1335
         BNZ   @RT01335                                            1335
*     GO TO DQELT;                  /* NO ,BRCH TO DQ IT     @Y30LB03*/
*   IF ECBRBADR>=CVTMZ00 THEN       /* ECB ADDR INVALID?     @Y30LB03*/
         L     @12,CVTPTR                                          1337
         C     @11,CVTMZ00(,@12)                                   1337
         BNL   @RT01337                                            1337
*     GO TO DQELT;                  /* YES,BRCH TO DQ IT     @Y30LB03*/
*   ECBPTR=MSGECB;                  /* SET PTR TO ECB        @Y30LB03*/
         L     @11,MSGPTR                                          1339
         L     @09,MSGECB(,@11)                                    1339
         ST    @09,ECBPTR                                          1339
*   RESPECIFY                                                      1340
*     BITPATT BASED(BITPTR);        /* RESET BITPATT BASE    @Y30LB03*/
*   RFY                                                            1341
*    (R15,                                                         1341
*     R10,                                                         1341
*     R11,                                                         1341
*     R12,                                                         1341
*     R13) RSTD;                    /* RST REGS 15,10,11,12,13     1341
*                                                            @Y30LB03*/
*                                                                  1341
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************************** @Y30LB03*/
*   /* FOR UTILITY RESPONSES, THE CONTENTS OF THE            @Y30LB03*/
*   /* MSC BUFFER DATA IS MOVED TO THE UTILITY PROGRAM       @Y30LB03*/
*   /* DATA AREA DEFINED AS THE ECB ADDRESS+4.               @Y30LB03*/
*   /* ***************************************************** @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1342
*   R10=F0;                         /* ZERO REG 10           @Y30LB03*/
         SLR   R10,R10                                             1342
*   IF MSGC<'70'X THEN              /* DATA TO BE MOVED?     @Y30LB03*/
         L     @14,MSGPTR                                          1343
         CLI   MSGC(@14),112                                       1343
         BNL   @RF01343                                            1343
*     DO;                           /* YES, FILL IN THE      @YM32899
*                                      FIELD WITH MSG DATA   @YM32899*/
*                                                                  1344
*       /*************************************************************/
*       /*                                                           */
*       /* IS FIELD THAT IS TO RECEIVE THE RESPONSE DATA     @Y30LB03*/
*       /* IN COMMON DATA AREA?????                          @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1345
*       IF ADDR(ECBDATA)<CVTSHRVM THEN/*                     @ZA17176*/
         LA    @14,ECBDATA(,@09)                                   1345
         L     @09,CVTPTR                                          1345
         C     @14,CVTSHRVM(,@09)                                  1345
         BNL   @RF01345                                            1345
*         R10='70'X;                /* NO, BY PASS MOVE, AND @Y30LB03
*                                      SET UP POST CD INDICATING   1346
*                                                            @Y30LB03
*                                      THE REASON            @Y30LB03*/
         LA    R10,112                                             1346
*       ELSE                        /* YES, IN COMMON AREA   @Y30LB03*/
*         DO;                       /* SO DO MOVE            @Y30LB03*/
         B     @RC01345                                            1347
@RF01345 DS    0H                                                  1348
*           ECBDATA(1:MSGL-F8)=MSGDATA(7:MSGL-F2);/* LENGTH,CODE   1348
*                                                            @Y30LB03
*                                      AND MSGID ARE         @Y30LB03
*                                      STRIPPED OFF          @Y30LB03*/
         L     @14,ECBPTR                                          1348
         L     @09,MSGPTR                                          1348
         SLR   @04,@04                                             1348
         IC    @04,MSGL(,@09)                                      1348
         SL    @04,@CF02044                                        1348
         EX    @04,@SM03332                                        1348
*         END;                      /*                       @Y30LB03*/
*     END;                          /*                       @Y30LB03*/
@RC01345 DS    0H                                                  1351
*   GEN;                                                           1351
@RF01343 DS    0H                                                  1351
*                                                          /*@Y30LB03*/
IGETLCL1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @Y30LB03*
               RELATED=(LOCALLOCK,ICB2MSG(IFRELCL2)),REGS=USE  @Y30LB03
*   LOCALLK=BONE;                   /* SET LOCAL LOCK BIT    @Y30LB03*/
         OI    LOCALLK,B'10000000'                                 1352
*   HAVELK=F1;                      /* SET LOCAL LK SWTCH    @Y30LB03*/
         MVI   HAVELK,X'01'                                        1353
*   R15=CVT0PT01;                   /* LD R15 POST BR ENT    @Y30LB03*/
         L     @09,CVTPTR                                          1354
         L     R15,CVT0PT01(,@09)                                  1354
*   R11=ECBPTR;                     /* LD R11 ECB TO BE      @Y30LB03
*                                      POSTED                @Y30LB03*/
         L     R11,ECBPTR                                          1355
*   R11=R11HIGHBIT;                /* SET HI BIT OF R11     @Y30LB03*/
         O     R11,HIGHBIT                                         1356
*   R12=ADDR(CVTBRET);              /* LD R12 ERROR RTN      @ZA16123*/
         LA    R12,CVTBRET(,@09)                                   1357
*   R13=ASVTENTY(MSGASIDF);         /* LD R13 ADDR SP ID     @Y30LB03*/
         L     @14,MSGPTR                                          1358
         LH    @09,MSGASIDF(,@14)                                  1358
         SLA   @09,2                                               1358
         L     @04,ASVTPTR                                         1358
         L     R13,ASVTENTY-4(@09,@04)                             1358
*   IF R10=F0 THEN                  /* HAS POST CODE         @Y30LB03
*                                      ALREADY BEEN SET?     @Y30LB03*/
         LTR   R10,R10                                             1359
         BNZ   @RF01359                                            1359
*     DO;                           /* NO,                   @Y30LB03*/
*       IF MSGC='70'X THEN          /* IS POSTCODE IN MSG    @Y30LB03*/
         CLI   MSGC(@14),112                                       1361
         BNE   @RF01361                                            1361
*         R10=MSGPOSTC;             /* YES,LD R10 POST CD    @Y30LB03*/
         SLR   R10,R10                                             1362
         IC    R10,MSGPOSTC(,@14)                                  1362
*       ELSE                        /* NO,SET UP POST CD     @Y30LB03*/
*         R10=POSTC7F;              /* LD R10 W/ GOOD CD     @Y30LB03*/
         B     @RC01361                                            1363
@RF01361 SLR   R10,R10                                             1363
         IC    R10,POSTC7F                                         1363
*     END;                          /*                       @Y30LB03*/
@RC01361 DS    0H                                                  1365
*   GEN REFS(SAVX);                                                1365
@RF01359 DS    0H                                                  1365
*                                                            @ZD00155*/
         STM   R0,R14,SAVX          SAVE REGS AROUND POST      @Y30LB03
IPOST3   BALR  R14,R15              BRANCH TO POST             @Y30LB03
         LM    R0,R14,SAVX          RESTORE REGS               @Y30LB03
*   GEN(LA    R13,SAVAREA);         /* RESET SAVE AREA ADDR  @ZA16123*/
         LA    R13,SAVAREA
*   RESPECIFY                                                      1367
*    (R15,                                                         1367
*     R10,                                                         1367
*     R11,                                                         1367
*     R12,                                                         1367
*     R13) UNRSTD;                  /* RELEASE REGS          @Y30LB03*/
*DQELT:                             /* TAKE QEL OFF CHAIN    @Y30LB03*/
*   IF HAVELK=F0 THEN               /* HAS LOCAL LOCK AL-    @Y30LB03
*                                      READY BEEN OBTAINED?  @Y30LB03
*                                      NO,OBTAIN IT          @Y30LB03*/
DQELT    CLI   HAVELK,0                                            1368
         BNE   @RF01368                                            1368
*     GEN;                                                         1369
*                                                          /*@Y30LB03*/
IGETLCL2 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @Y30LB03*
               RELATED=(LOCALLOCK,ICB2MSG(IFRELCL2)),REGS=USE  @Y30LB03
*     GEN;                                                         1370
@RF01368 DS    0H                                                  1370
*                                                          /*@Y30LB03*/
IGTCMS3  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                  @Y30LB03*
               RELATED=(CMSLOCK,ICB2MSG(IFRECMS)),REGS=USE     @Y30LB03
*     LOCKRCVY(1:2)=B2ONE;          /* SET LOCAL & CMS LOCK BITS   1371
*                                                            @Y30LB03*/
         OI    LOCKRCVY,B'11000000'                                1371
*   IF MSGVARY=F0 THEN              /* WAS THERE A D R Q     @Y30LB03
*                                      ELT THAT MATCHED?     @Y30LB03*/
         CLI   MSGVARY,0                                           1372
         BNE   @RF01372                                            1372
*     DO;                           /* YES,                  @Y30LB03*/
*       IF ICBQHEAD=F0 THEN                                        1374
         L     @12,ICBPTR                                          1374
         L     @12,ICBQHEAD(,@12)                                  1374
         LTR   @12,@12                                             1374
         BZ    @RT01374                                            1374
*         ;                         /* QUEUE SHOULD NOT      @Y30LB03
*                                      BE EMPTY,BUT IF IS    @Y30LB03
*                                      THEN DO NOTHING       @Y30LB03*/
*       ELSE                        /* NOT EMPTY, THEN...    @Y30LB03*/
*         DO;                       /*                       @Y30LB03*/
*           CALL ICBMSG21;          /* CALL DQ-FREEMAIN      @Y30LB03
*                                      SUBROUTINE            @Y30LB03*/
         BAL   @14,ICBMSG21                                        1377
*         END;                      /*                       @Y30LB03*/
*     END;                          /*                       @Y30LB03*/
@RT01374 DS    0H                                                  1380
*   QELTPTR=ICBQHEAD;               /* INIT Q ELT PTR TO     @Y30LB03
*                                      BEGINNING OF D.R.Q.   @Y30LB03*/
@RF01372 L     @12,ICBPTR                                          1380
         L     @12,ICBQHEAD(,@12)                                  1380
         ST    @12,QELTPTR                                         1380
*   DO WHILE QELTPTR^=F0;           /* BEGIN SEARCH FOR      @Y30LB03
*                                      ELTS FLAGGED          @ZM31001
*                                      AS BEING INVALID      @Y30LB03*/
         B     @DE01381                                            1381
@DL01381 DS    0H                                                  1382
*     IF QELFLG3=CHARFF THEN        /* READY FOR DEQUEUE?    @ZM31001*/
         L     @12,QELTPTR                                         1382
         CLI   QELFLG3(@12),X'FF'                                  1382
         BNE   @RF01382                                            1382
*       DO;                         /* YES,....              @Y30LB03*/
*         CALL ICBMSG21;            /* CALL DQ-FREEMAIN      @Y30LB03
*                                      SUBROUTINE            @Y30LB03*/
         BAL   @14,ICBMSG21                                        1384
*       END;                        /*                       @Y30LB03*/
*     QELTPTR=QELAHEAD;             /* POINT TO NEXT ELT     @Y30LB03*/
@RF01382 L     @12,QELTPTR                                         1386
         L     @12,QELAHEAD-1(,@12)                                1386
         LA    @12,0(,@12)                                         1386
         ST    @12,QELTPTR                                         1386
*   END;                            /*                       @Y30LB03*/
@DE01381 L     @12,QELTPTR                                         1387
         LTR   @12,@12                                             1387
         BNZ   @DL01381                                            1387
*   GEN;                                                           1388
*                                                          /*@Y30LB03*/
IFRECMS SETLOCK RELEASE,TYPE=CMS,                              @Y30LB03*
               RELATED=(CMSLOCK,ICB2MSG(IGTCMS3)),REGS=USE     @Y30LB03
IFRELCL2 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCALLOCK,        @Y30LB03*
               ICB2MSG(IGETLCL1ORIGETLCL2)),REGS=USE           @Y30LB03
*   LOCKRCVY(1:2)=B2ZERO;           /* 0 LOCAL & CMS LOCK BITS     1389
*                                                            @Y30LB03*/
         NI    LOCKRCVY,B'00111111'                                1389
*EXIT20:                            /*                       @Y30LB03*/
*   RFY                                                            1390
*     R14 RSTD;                     /*                       @G24LB02*/
EXIT20   DS    0H                                                  1391
*   R14=SAVR1420;                   /* RESTORE REG 14        @G24LB02*/
         L     R14,SAVR1420                                        1391
*   RFY                                                            1392
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG10       @Y30LB03*/
         B     @EL00011                                            1393
*   END ICBMSG20;                   /*                       @Y30LB03*/
*                                                                  1395
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG21                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = DEQUEUE/FREEMAIN RESPONSE QUEUE      @Y30LB03
*     ELEMENTS SUBROUTINE                                     @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = DEQUEUE RESPONSE ELEMENTS FROM DELAYED       @Y30LB03
*                RESPONSE QUEUE AND FREE ITS STORAGE          @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = TO DEQUEUE RESPONSE ELEMENT FROM DELAYED    @Y30LB03
*       RESPONSE QUEUE AND TO FREE STORAGE IT OCCUPIED        @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = POINTER INDICATING ELEMENT TO BE DEQUEUED.    @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = RESPONSE QUEUE ELEMENT DEQUEUED AND STORAGE  @Y30LB03
*                FREED                                        @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1395
*ICBMSG21:                                                         1395
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
*                                                                  1395
ICBMSG21 DS    0H                                                  1396
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************************** @Y30LB03*/
*   /*                                                       @Y30LB03*/
*   /* THIS SUBRTN DEQUEUES THE ELEMENT FROM THE DELAYED     @Y30LB03*/
*   /* RESPONSE QUEUE BY CHANGING FORWARD(AHEAD) PTR         @Y30LB03*/
*   /* OF LAST RESPONSE ELEMENT AND BACK POINTER OF          @Y30LB03*/
*   /* NEXT RESPONSE ELEMENT. SPECIAL ACTION IS TAKEN IF     @Y30LB03*/
*   /* THE ELEMENT TO BE DEQUEUED IS THE FIRST/LAST          @Y30LB03*/
*   /* ELEMENT ON THE QUEUE.                                 @Y30LB03*/
*   /*                                                       @Y30LB03*/
*   /* ***************************************************** @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1396
*   RFY                                                            1396
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1421=R14;                   /*                       @Y30LB03*/
         ST    R14,SAVR1421                                        1397
*   RFY                                                            1398
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   IF QELBACK=F0&QELAHEAD=F0 THEN  /* ONLY ONE ON Q?        @Y30LB03*/
         L     @12,QELTPTR                                         1399
         L     @09,QELBACK-1(,@12)                                 1399
         LA    @09,0(,@09)                                         1399
         LTR   @09,@09                                             1399
         BNZ   @RF01399                                            1399
         L     @12,QELAHEAD-1(,@12)                                1399
         LA    @12,0(,@12)                                         1399
         LTR   @12,@12                                             1399
         BNZ   @RF01399                                            1399
*     ICBQHEAD=F0;                  /* YES,SET CB PTR=0      @Y30LB03*/
         L     @12,ICBPTR                                          1400
         SLR   @09,@09                                             1400
         ST    @09,ICBQHEAD(,@12)                                  1400
*   ELSE                            /* MORE THAN ONE,SO..    @Y30LB03*/
*     DO;                           /* CHECK FOR 1ST ELT     @Y30LB03*/
         B     @RC01399                                            1401
@RF01399 DS    0H                                                  1402
*       IF QELBACK=F0 THEN          /* 1ST ELEMENT?          @Y30LB03*/
         L     @12,QELTPTR                                         1402
         L     @09,QELBACK-1(,@12)                                 1402
         LA    @09,0(,@09)                                         1402
         LTR   @09,@09                                             1402
         BNZ   @RF01402                                            1402
*         ICBQHEAD=QELAHEAD;        /* CHG CB PTR TO NEXT    @Y30LB03*/
         L     @12,QELAHEAD-1(,@12)                                1403
         LA    @12,0(,@12)                                         1403
         L     @09,ICBPTR                                          1403
         ST    @12,ICBQHEAD(,@09)                                  1403
*       ELSE                        /* IF NOT 1ST, THEN      @Y30LB03
*                                      CHG LAST FORWARD PTR  @Y30LB03*/
*         QELBACK->QELAHEAD=QELAHEAD;/*                      @Y30LB03*/
         B     @RC01402                                            1404
@RF01402 L     @12,QELTPTR                                         1404
         L     @09,QELBACK-1(,@12)                                 1404
         MVC   QELAHEAD(3,@09),QELAHEAD(@12)                       1404
*       DQING=BONE;                 /* SET RECVRY BIT        @Y30LB03*/
@RC01402 OI    DQING,B'00100000'                                   1405
*FINISHDQ:                                                         1406
*       IF QELAHEAD=F0 THEN         /* CHECK FOR LAST 1      @Y30LB03*/
FINISHDQ L     @12,QELTPTR                                         1406
         L     @12,QELAHEAD-1(,@12)                                1406
         LA    @12,0(,@12)                                         1406
         LTR   @12,@12                                             1406
         BZ    @RT01406                                            1406
*         ;                         /* IF LAST,DO NOTHING    @Y30LB03*/
*       ELSE                        /* IF NOT LAST THEN      @Y30LB03
*                                      CHG NEXT BACK PTR     @Y30LB03*/
*         QELAHEAD->QELBACK=QELBACK;/*                       @Y30LB03*/
         L     @12,QELTPTR                                         1408
         L     @09,QELAHEAD-1(,@12)                                1408
         MVC   QELBACK(3,@09),QELBACK(@12)                         1408
*       DQING=BZERO;                /* SET RECVRY BIT        @Y30LB03*/
@RT01406 NI    DQING,B'11011111'                                   1409
*     END;                          /*                       @Y30LB03*/
*/*   TO BRANCH ENTER FREEMAIN                               @Y30LB03*/
*                                                                  1411
*   RESPECIFY                                                      1411
*    (R2,                                                          1411
*     R3,                                                          1411
*     R4) RSTD;                     /* RESTRICT REGS         @G24LB02
*                                      2,3,4                 @Y30LB03*/
@RC01399 DS    0H                                                  1412
*   R1=QELTPTR;                     /* R1-->QELEMENT         @ZA16123*/
         L     R1,QELTPTR                                          1412
*   R4=ICBTCB;                      /* LD R4 MSGTASK TCB     @Y30LB03*/
         L     @12,ICBPTR                                          1413
         L     R4,ICBTCB(,@12)                                     1413
*   R7=ASVTENTY(1);                 /* LD R7 ADDR SP ID      @Y30LB03
*                                      BRANCH                @Y30LB03
*                                      ENTER FREEMAIN TO     @Y30LB03
*                                      FREE CORE FOR DQ'D    @Y30LB03
*                                      ELEMENT               @Y30LB03*/
         L     @12,ASVTPTR                                         1414
         L     R7,ASVTENTY(,@12)                                   1414
*   GEN;                                                           1415
*                                                          /*@Y30LB03*/
         DROP  R7                   DROP BASE REG              @ZA16123
         BALR  R14,R0               SET BASE FOR INSTRUCTIONS  @ZA16123
         USING *,R14                ESTB ADDRESSABILITY        @ZA16123
IFREEMN2 FREEMAIN BRANCH=YES,RC,LV=20,A=(1),SP=245,            @ZA16123*
               RELATED=(SP245,IGC0012F(IGETMA20))              @Y30LB03
         LA    R7,F4095(R8)         RESTORE REG 7              @ZA16123
         DROP  R14                  DROP BASE REG              @ZA16123
         USING START+4095,R7        ESTABLISH ADDRESSABILITY   @ZA16123
*   RESPECIFY                                                      1416
*    (R2,                                                          1416
*     R3,                                                          1416
*     R4) UNRSTD;                   /* RELEASE REGS          @G24LB02
*                                      2,3,4                 @Y30LB03*/
*   RFY                                                            1417
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1421;                   /*                       @Y30LB03*/
         L     R14,SAVR1421                                        1418
*   RFY                                                            1419
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG20       @Y30LB03*/
@EL00012 DS    0H                                                  1420
@EF00012 DS    0H                                                  1420
@ER00012 BR    @14                                                 1420
*   END ICBMSG21;                   /*                       @Y30LB03*/
*                                                                  1422
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG30                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = MSC I/O ERROR SUBROUTINE             @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = RECOVERY PROCEDURE FOR PERMANENT I/O ERRORS  @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = RECOVERY FROM MSC I/O ERROR. THIS           @Y30LB03
*       SUBROUTINE SETS THE RETURN ADDRESS TO THE             @Y30LB03
*       SCAN INSTRUCITON IN ICB2MSG (MAIN).                   @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = NONE                                          @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = NONE                                         @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1422
*ICBMSG30:                                                         1422
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG30 DS    0H                                                  1423
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE IS ENTERED IF A MSC I/O ERROR         @Y30LB03*/
*/*    IS INCOUNTERED THAT THE ERP'S COULD NOT RESOLVE.      @Y30LB03*/
*/*    NOTHING ELSE CAN BE DONE TO RESOLVE THE I/O           @Y30LB03*/
*/*    ERROR.   THE RETURN ADDR                              @Y30LB03*/
*/*    IS SET TO THE SCAN INSTRUCTION IN ICB2MSG(MAIN).      @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1423
*   REENTRY=ADDR(SCAN);             /* SET RE-ENTRY POINT    @Y30LB03*/
         LA    @12,SCAN                                            1423
         ST    @12,REENTRY                                         1423
*   CLEANUP=F0;                     /* CLEAR CLEAN-UP SWITCH @Y30LB03*/
         SLR   @12,@12                                             1424
         ST    @12,CLEANUP                                         1424
*   RFY                                                            1425
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=ADDR(SCAN);                 /* SET RTN ADDR          @Y30LB03*/
         LA    R14,SCAN                                            1426
*   RFY                                                            1427
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICB2MSG        @Y30LB03*/
@EL00013 DS    0H                                                  1428
@EF00013 DS    0H                                                  1428
@ER00013 BR    @14                                                 1428
*   END ICBMSG30;                   /*                       @Y30LB03*/
*                                                                  1430
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG35                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = MSC OFFLINE SUBROUTINE               @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = USED TO BYPASS NORMAL FUNCTION               @Y30LB03
*     OF MESSAGE TASK IF MSC VARIED OFFLINE.                  @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = TO BYPASS NORMAL FUNCTIONS OF THE           @Y30LB03
*       MESSAGE TASK WHEN THE MSC IS OFFLINE. THIS            @Y30LB03
*       ROUTINE SETS THE RETURN ADDRESS TO THE SCAN           @Y30LB03
*       INSTRUCTION IN ICB2MSG (MAIN).                        @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = NONE                                          @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = NONE                                         @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1430
*ICBMSG35:                                                         1430
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG35 DS    0H                                                  1431
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE HANDLES MSC OFFLINE CONDITIONS.       @Y30LB03*/
*/*    THE RETURN ADDRESS IS SET TO THE SCAN INSTRUCTION     @Y30LB03*/
*/*    IN ICB2MSG(MAIN)                                      @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1431
*   RFY                                                            1431
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=ADDR(SCAN);                 /*                       @Y30LB03*/
         LA    R14,SCAN                                            1432
*   RFY                                                            1433
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICB2MSG        @Y30LB03*/
@EL00014 DS    0H                                                  1434
@EF00014 DS    0H                                                  1434
@ER00014 BR    @14                                                 1434
*   END ICBMSG35;                   /*                       @Y30LB03*/
*                                                                  1436
*/*****************************************************      @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG40                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = COMTASK INTERFACE SUBROUTINE         @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = PROCESS COMTASK COMMANDS                     @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = HANDLE ROUTING OF COMTASK COMMANDS TO         @Y30LB03
*                APPROPRIATE SUBROUTINE                       @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = COMTASK COMMAND                               @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = PROCESSED COMTASK COMMAND                    @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1436
*ICBMSG40:                                                         1436
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG40 DS    0H                                                  1437
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE HANDLES ROUTING OF COMTASK            @Y30LB03*/
*/*    COMMANDS TO APPROPRIATE SUBROUTINE.                   @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1437
*   RFY                                                            1437
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1440=R14;                   /* SAVE REG 14           @Y30LB03*/
         ST    R14,SAVR1440                                        1438
*   RFY                                                            1439
*     R14 UNRSTD;                   /*                       @G24LB02*/
*INITPTRL:                                                         1440
*   CWBPTR=ICBCOMQ;                 /* SET CWB POINTER       @Y30LB03*/
INITPTRL L     @12,ICBPTR                                          1440
         L     @12,ICBCOMQ(,@12)                                   1440
         ST    @12,CWBPTR                                          1440
*   REENTRY=ADDR(INITPTRL);         /* SET RE-ENTRY POINT    @Y30LB03*/
         LA    @09,INITPTRL                                        1441
         ST    @09,REENTRY                                         1441
*   IF CWBVBCDE=40&                 /* VARY MSG? AND         @ZM31122*/
*       CWBUCMID^=CHAR80 THEN       /* NOT INPUT STREAM      @ZM31122*/
         CLI   CWBVBCDE(@12),40                                    1442
         BNE   @RF01442                                            1442
         CLI   CWBUCMID(@12),128                                   1442
         BE    @RF01442                                            1442
*     DO;                           /*                       @Y30LB03*/
*       CALL ICBMSG41;              /* YES,CALL SUBRTN TO    @Y30LB03
*                                      ISSUE VARY MACRO      @Y30LB03*/
         BAL   @14,ICBMSG41                                        1444
*     END;                          /*                       @Y30LB03*/
*   ELSE                            /* NO,CHECK ANOTHER      @Z40LB01*/
*     IF CWBVBCDE=104 THEN          /* DISPLAY 3850          @Z40LB01*/
         B     @RC01442                                            1446
@RF01442 L     @12,CWBPTR                                          1446
         CLI   CWBVBCDE(@12),104                                   1446
         BNE   @RF01446                                            1446
*       DO;                         /* YES,...               @Z40LB01*/
*         CALL ICBMSG55;            /* CALL DISPLAY SUB      @Z40LB01*/
         BAL   @14,ICBMSG55                                        1448
*       END;                        /*                       @Z40LB01*/
*     ELSE                          /* NO,CHECK ANOTHER      @Y30LB03*/
*       IF CWBVBCDE=140 THEN        /* IS IT AN ASSGN MSG    @Y30LB03*/
         B     @RC01446                                            1450
@RF01446 L     @12,CWBPTR                                          1450
         CLI   CWBVBCDE(@12),140                                   1450
         BNE   @RF01450                                            1450
*         DO;                       /* YES,...               @Y30LB03*/
*           CALL ICBMSG42;          /* CALL SUBRTN TO ISSUE  @Y30LB03
*                                      ASSIGN PRIMARY HOST   @Y30LB03
*                                      MACRO                 @Y30LB03*/
         BAL   @14,ICBMSG42                                        1452
*         END;                      /*                       @Y30LB03*/
*       ELSE                        /* NO,CHECK ANOTHER      @Y30LB03*/
*         IF CWBVBCDE=60 THEN       /* IS IT A               @Y30LB03
*                                      HALT(SUSPEND) MSG?    @Y30LB03*/
         B     @RC01450                                            1454
@RF01450 L     @12,CWBPTR                                          1454
         CLI   CWBVBCDE(@12),60                                    1454
         BNE   @RF01454                                            1454
*           DO;                     /* YES,...               @Y30LB03*/
*             CALL ICBMSG43;        /* CALL SUBRTN TO ISSUE  @Y30LB03
*                                      HALT(MSS SUSPEND)     @Y30LB03
*                                      MACRO                 @Y30LB03*/
         BAL   @14,ICBMSG43                                        1456
*           END;                    /*                       @Y30LB03*/
*         ELSE                      /* NO,CHECK ANOTHER      @Y30LB03
*                                      IS IT A PURGE MSG?    @Y30LB03*/
*           IF CWBVBCDE=164 THEN    /*                       @Y30LB03*/
         B     @RC01454                                            1458
@RF01454 L     @12,CWBPTR                                          1458
         CLI   CWBVBCDE(@12),164                                   1458
         BNE   @RF01458                                            1458
*             DO;                   /*                       @Y30LB03*/
*               CALL ICBMSG42;      /* YES,CALL SUBRTN TO    @Y30LB03
*                                      ISSUE PURGE MACRO     @Y30LB03*/
         BAL   @14,ICBMSG42                                        1460
*             END;                  /*                       @Y30LB03*/
*           ELSE                    /* NO,ERROR SITUATION    @Y30LB03*/
*             DO;                   /* SO, RECOVER           @Y30LB03*/
         B     @RC01458                                            1462
@RF01458 DS    0H                                                  1463
*               WTOMCS03=MESGS(MSG01401);/* ERR MSG          @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1463
         L     @12,@CA02101                                        1463
         MVC   WTOMCS03(72),MESGS-MSGS+2128(@12)                   1463
*               CALL ICBMSG47;      /* THEN CALL SUBRTN      @G24LB02
*                                      TO ISSUE WTO MCRO     @G24LB02*/
         BAL   @14,ICBMSG47                                        1464
*               IF ICBCOMQ^=F0 THEN /*                       @G24LB02*/
         L     @12,ICBPTR                                          1465
         L     @12,ICBCOMQ(,@12)                                   1465
         LTR   @12,@12                                             1465
         BZ    @RF01465                                            1465
*                 DO;               /*                       @G24LB02*/
*                   CALL ICBMSG44;  /* THEN CALL SUBRTN      @Y30LB03
*                                      TO DEQ CWB            @Y30LB03*/
         BAL   @14,ICBMSG44                                        1467
*                   CALL ICBMSG46;  /* AND CALL SUBRTN       @Y30LB03
*                                      TO FREE WORKAREA      @Y30LB03*/
         BAL   @14,ICBMSG46                                        1468
*                 END;              /*                       @G24LB02*/
*             END;                  /*                       @Y30LB03*/
@RF01465 DS    0H                                                  1471
*RTN40L:                                                           1471
*   RFY                                                            1471
*     R14 RSTD;                     /*                       @G24LB02*/
@RC01458 DS    0H                                                  1471
@RC01454 DS    0H                                                  1471
@RC01450 DS    0H                                                  1471
@RC01446 DS    0H                                                  1471
@RC01442 DS    0H                                                  1471
RTN40L   DS    0H                                                  1472
*   R14=SAVR1440;                   /* RESTORE REG 14        @Y30LB03*/
         L     R14,SAVR1440                                        1472
*   RFY                                                            1473
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICB2MSG        @Y30LB03*/
@EL00015 DS    0H                                                  1474
@EF00015 DS    0H                                                  1474
@ER00015 BR    @14                                                 1474
*   END ICBMSG40;                   /*                       @Y30LB03*/
*                                                                  1476
*/********************************************************   @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG41                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = VARY COMMAND PROCESSING SUBROUTINE   @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = ISSUE ICBVARY MACRO FOR COMTASK              @Y30LB03
*                VARY COMMANDS                                @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = SYNTAX CHECK THE VARY COMMAND AND DETERMINE   @Y30LB03
*               TYPE OF VARY. IF '3851' WAS SPECIFIED ON      @Y30LB03
*               VARY COMMAND THE MSC'S UCB IS TO BE VARIED.   @Y30LB03
*               THEREFORE, SUBROUTINE ICBMSG49 IS CALLED      @Y30LB03
*               TO PERFORM THE NECESSARY PROCESSING.          @Y30LB03
*               IF 'REAL' IS SPECIFIED, A REAL-SWITCH         @Y30LB03
*               IS SET TO INDICATE THAT THE REAL ATTRIBUTE    @Y30LB03
*               IS TO BE SET ON THE (ICB)VARY FLAGS.  IF      @Y30LB03
*               'REAL' IS NOT SPECIFIED AND THE UNIT TO BE    @Y30LB03
*               VARIED IS A DASD UNIT (I.E. OF TYPE 0XX)      @Y30LB03
*               A DASD-SWITCH IS SET.  THIS SWITCH IS ALSO    @Y30LB03
*               USED TO DEFINE FLAG SETTINGS FOR THE          @Y30LB03
*               (ICB)VARY MACRO.  IF THE VARY WAS NOT FOR A   @Y30LB03
*               MSC UNIT AND IF NO SYNTAX ERRORS WERE         @Y30LB03
*               FOUND, THE APPROPRIATE MACRO VARIABLES        @Y30LB03
*               ARE DEFINED AND ICBVARY IS ISSUED. THEN,      @Y30LB03
*               THE RETURN CODE IS INTERROGATED SO THAT A WTO @Y30LB03
*               MESSAGE (INDICATING SUCCESSFUL/UNSUCCESSFUL   @Y30LB03
*               PROCESSING) CAN BE DEFINED, IF APPLICABLE.    @Y30LB03
*               IF VIRTUAL(DASD) WAS INDICATED ON THE         @Y30LB03
*               VARY OFF FLAGS AND IF THERE WAS NO            @Y30LB03
*               ERROR INDICATION ON RETURN FROM SVC 126       @Y30LB03
*               THEN A DELAYED RESPONSE MESSAGE WILL          @Y30LB03
*               BE RECEIVED FROM THE MSC.  IT WILL BE         @Y30LB03
*               PROCESSED BY SUBROUTINE ICBMSG20.             @Y30LB03
*               THE DEQUEUE SUBROUTINE(ICBMSG44) IS           @Y30LB03
*               CALLED AND IN SOMECASES, THE WTO(ICBMSG47)    @Y30LB03
*               AND FREEMAIN(ICBMSG46)SUBROUTINES ARE CALLED. @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = COMTASK VARY(MSS HARDWARE) COMMAND            @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = PROCESSED COMTASK VARY COMMAND               @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1476
*ICBMSG41:                                                         1476
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG41 DS    0H                                                  1477
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE HANDLES REQUESTS FOR THE VARY         @Y30LB03*/
*/*    ON/OFF ORDERS.                                        @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1477
*   DCL                                                            1477
*     VARYCNT FIXED(31);            /* DO LOOP CNTR          @Y30LB03*/
*   DCL                                                            1478
*     RPARNPOS FIXED(8);            /* RIGHT PAREN POS       @Y30LB03*/
*   DCL                                                            1479
*     VFLAGS BIT(16) INIT('0000000000000000'B);/* FLAGS      @Y30LB03*/
*/*******************************************************    @Y30LB03*/
*/*  MSGRU AND RU1BYTE ARE                                   @Y30LB03*/
*/*  USED IN CONVERSION OF REAL UNIT TO 2 DIGITS             @Y30LB03*/
*/*******************************************************    @Y30LB03*/
*                                                                  1480
*   DCL                                                            1480
*     1 MSGRU CHAR(3),              /*                       @Y30LB03*/
*      2 * CHAR(1),                 /*                       @Y30LB03*/
*      2 MACRORU CHAR(2);           /* TARGET FOR CONVERTED  @Y30LB03
*                                      UNIT                  @Y30LB03*/
*   DCL                                                            1481
*     CWBRU CHAR(3) BASED(CWBVREF); /* UNIT UNDER SCAN       @Z40LB01*/
*   DCL                                                            1482
*     RU1BYTE CHAR(1) BASED(R1);    /* FOR BYTE CHECKING     @Y30LB03
*                                      THE REAL UNIT         @Y30LB03*/
*   DCL                                                            1483
*     DASD BIT(1);                  /* DASD SWITCH           @Y30LB03*/
*   DCL                                                            1484
*     REAL BIT(1);                  /* REAL SWITCH           @Y30LB03*/
*   DCL                                                            1485
*     CMNDINDX FIXED(8);            /* FOR SYNTAX CHECK-     @Y30LB03
*                                      ING THE COMMAND       @Y30LB03*/
*   DCL                                                            1486
*     UNITCNT FIXED(31);            /* FOR # OF UNITS        @Y30LB03*/
*                                                                  1486
*   /*****************************************************************/
*   /*                                                               */
*   /* MASTER AND I/O CONSOLE AUTHORIZATION                  @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1487
*   DCL                                                            1487
*     AUTHMASK CHAR(2) INIT('4000'X);/*                      @Y30LB03*/
*   DCL                                                            1488
*     CKAUTH CHAR(2) INIT('0001'X); /* TO CHECK AUTH         @Y30LB03*/
*   DCL                                                            1489
*     ICBR1 REG(1) PTR;             /* ADDRESS OF REQUEST BLOCK    1489
*                                                            @Y30LB02*/
*                                                                  1489
*   /*****************************************************************/
*   /*                                                               */
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /* MACMEAN MSSC VARYOFF MACRO                            @Y30LB02*/
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/
*   /* THIS IS THE INITIALIZED LIST FORM                     @Y30LB02*/
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1490
*   DCL                                                            1490
*     1 VOFLIST STATIC LOCAL,       /* VARYOFF REQ BLOCK     @Y30LB02*/
*      2 VOFLEN FIXED(31) INIT('18'X),/* LENGTH OF VOF REQUEST BLK 1490
*                                                            @Y30LB02*/
*      2 VOFOPCD CHAR(1) INIT('0C'X),/* VARYOFF OPCODE       @Y30LB02*/
*      2 VOFRES1 CHAR(1) INIT('00'X),/* ONE BYTE OF ZERO     @Y30LB02*/
*      2 VOFFLG BIT(16) INIT('0000000000000000'B),/* FLAGS AREA    1490
*                                                            @Y30LB02*/
*       3 VOFSTAG BIT(1),           /* VIRTUAL ATTRIBUTE     @Y30LB02*/
*       3 VOFREAL BIT(1),           /* REAL ATTRIBUTE        @Y30LB02*/
*       3 VOFNEUT BIT(1),           /* NEUTRAL ATTRIBUTE     @Y30LB02*/
*       3 VOFTEST BIT(1),           /* TEST ATTRIBUTE        @Y30LB02*/
*       3 * BIT(12),                /* TWELVE BITS RESERVED  @Y30LB02*/
*      2 VOFSSID FIXED(15) INIT(0), /* SUBSYSTEM ID          @Y30LB02*/
*      2 VOFRUA FIXED(15) INIT(0),  /* REAL UNIT ADDRESS     @Y30LB02*/
*      2 VOFHOST CHAR(5) INIT('0000000000'X),/* HOSTID AREA  @Y30LB02*/
*      2 * CHAR(1) INIT('00'X),     /* RESERVED AREA         @Y30LB02*/
*      2 VOFASID CHAR(2) INIT('0000'X),/* ASID AREA          @Y30LB02*/
*      2 VOFECB FIXED(31) INIT(0);  /* EVENT CONTROL BLOCK AREA    1490
*                                                            @Y30LB02
*                                      GET VARY OFF LIST     @Y30LB03*/
*   RFY                                                            1491
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1441=R14;                   /* SAVE REG 14           @Y30LB03*/
         ST    R14,SAVR1441                                        1492
*   RFY                                                            1493
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RECOVER(4)=BONE;                /* SET VARY RECOVERY     @Y30LB03
*                                      BIT                   @Y30LB03*/
         OI    RECOVER,B'00010000'                                 1494
*   CMNDINDX=F1;                    /* INIT STRING INDEX     @Y30LB03*/
         LA    @12,1                                               1495
         STC   @12,CMNDINDX                                        1495
*   UNITCNT=F1;                     /* INIT # OF UNITS       @Y30LB03*/
         LA    @09,1                                               1496
         ST    @09,UNITCNT                                         1496
*   RPARNPOS=F0;                    /* INIT RGHT PARN POS    @Y30LB03*/
         MVI   RPARNPOS,X'00'                                      1497
*   CWBCOMQ=F0;                     /* INIT FLAG FIELD       @Y30LB03*/
         L     @04,CWBPTR                                          1498
         MVI   CWBCOMQ(@04),X'00'                                  1498
*   REAL=BZERO;                     /* ZERO 'REAL' SWITCH    @Y30LB03*/
         NI    REAL,B'01111111'                                    1499
*   CKAUTH=CHAR0001;                /* INIT AUTH SWITCH      @Y30LB03*/
         MVC   CKAUTH(2),@CB02431                                  1500
*                                                                  1501
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*      SYNTAX ERROR CHECKING                               @Y30LB03*/
*/*      AND INITIALIZATION OF WORK VARIABLES                @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1501
*   IF CWBCMND(CMNDINDX:CMNDINDX)='(' THEN/* MULTI UNITS?    @Y30LB03*/
         ALR   @12,@04                                             1501
         CLI   CWBCMND-1(@12),C'('                                 1501
         BNE   @RF01501                                            1501
*     DO;                           /* YES,SET UP UNITPTR    @Y30LB03
*                                      AND,LEFT PAREN POS    @Y30LB03*/
*       CWBVREF=CMNDINDX+F1+CWBPTR+F8;/*                     @Y30LB03*/
         SLR   @12,@12                                             1503
         IC    @12,CMNDINDX                                        1503
         ALR   @09,@12                                             1503
         ALR   @09,@04                                             1503
         AL    @09,@CF00115                                        1503
         ST    @09,CWBVREF                                         1503
*       CWBCOMQ=CMNDINDX;           /*                       @Y30LB03*/
*                                                                  1504
         STC   @12,CWBCOMQ(,@04)                                   1504
*       /*************************************************************/
*       /*                                                           */
*       /* *********************************                 @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* THIS DO LOOP IS EXECUTED TO                       @Y30LB03*/
*       /* MAKE SURE COMMAS ARE BETWEEN                      @Y30LB03*/
*       /* THE UNITS SPECIFIED, AND THAT                     @Y30LB03*/
*       /* A RIGHT PAREN FOLLOWS THE UNITS                   @Y30LB03*/
*       /*                                                   @Y30LB03*/
*       /* *********************************                 @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1505
*       DO WHILE CMNDINDX<F50&RPARNPOS=F0;/*                 @Y30LB03*/
         B     @DE01505                                            1505
@DL01505 DS    0H                                                  1506
*         CMNDINDX=CMNDINDX+F4;     /* POINT TO COMMA/       @Y30LB03
*                                      RIGHT PAREN POS       @Y30LB03
*                                      FIND COMMA? YES..     @Y30LB03*/
         SLR   @12,@12                                             1506
         IC    @12,CMNDINDX                                        1506
         LA    @12,4(,@12)                                         1506
         STC   @12,CMNDINDX                                        1506
*         IF CWBCMND(CMNDINDX:CMNDINDX)=',' THEN/*           @Y30LB03*/
         L     @09,CWBPTR                                          1507
         ALR   @09,@12                                             1507
         CLI   CWBCMND-1(@09),C','                                 1507
         BNE   @RF01507                                            1507
*           UNITCNT=UNITCNT+F1;     /* INCR UNITS BY 1       @Y30LB03*/
         LA    @12,1                                               1508
         AL    @12,UNITCNT                                         1508
         ST    @12,UNITCNT                                         1508
*         ELSE                      /* NO, CHECK FOR         @Y30LB03
*                                      THE RIGHT PAREN       @Y30LB03*/
*           IF CWBCMND(CMNDINDX:CMNDINDX)=')' THEN/*         @Y30LB03
*                                      FIND RIGHT PARN?      @Y30LB03*/
         B     @RC01507                                            1509
@RF01507 SLR   @12,@12                                             1509
         IC    @12,CMNDINDX                                        1509
         L     @09,CWBPTR                                          1509
         ALR   @09,@12                                             1509
         CLI   CWBCMND-1(@09),C')'                                 1509
         BNE   @RF01509                                            1509
*             RPARNPOS=CMNDINDX;    /* YES,SET RGHT          @Y30LB03
*                                      PAREN POS             @Y30LB03*/
         STC   @12,RPARNPOS                                        1510
*           ELSE                    /* IF NEITHER THERE      @Y30LB03
*                                      IS A SYNTAX ERROR     @Y30LB03*/
*             GO TO SYNERROR;       /* GO PROC IT            @Y30LB03*/
*       END;                        /*                       @Y30LB03*/
@RC01507 DS    0H                                                  1512
@DE01505 CLI   CMNDINDX,50                                         1512
         BNL   @DC01505                                            1512
         CLI   RPARNPOS,0                                          1512
         BE    @DL01505                                            1512
@DC01505 DS    0H                                                  1513
*       IF RPARNPOS=F0 THEN         /* NO RIGHT PAREN?       @Y30LB03*/
         CLI   RPARNPOS,0                                          1513
         BE    @RT01513                                            1513
*         GO TO SYNERROR;           /* YES, SYNTAX ERROR     @Y30LB03*/
*       CMNDINDX=RPARNPOS+F1;       /* NO, POINT TO CHAR     @Y30LB03
*                                      AFTER ')'             @Y30LB03*/
         IC    @12,RPARNPOS                                        1515
         LA    @12,1(,@12)                                         1515
         STC   @12,CMNDINDX                                        1515
*     END;                          /*                       @Y30LB03*/
*   ELSE                            /* PROCESSED FOR         @Y30LB03
*                                      SINGLE UNIT VARY      @Y30LB03*/
*     DO;                           /*                       @Y30LB03*/
         B     @RC01501                                            1517
@RF01501 DS    0H                                                  1518
*       CWBVREF=CMNDINDX+CWBPTR+F8; /* POINT TO UNIT         @Y30LB03*/
         SLR   @12,@12                                             1518
         IC    @12,CMNDINDX                                        1518
         LR    @09,@12                                             1518
         AL    @09,CWBPTR                                          1518
         AL    @09,@CF00115                                        1518
         ST    @09,CWBVREF                                         1518
*       CMNDINDX=CMNDINDX+F3;       /* POINT TO CHAR         @Y30LB03
*                                      AFTER UNIT            @Y30LB03*/
         LA    @12,3(,@12)                                         1519
         STC   @12,CMNDINDX                                        1519
*     END;                          /*                       @Y30LB03*/
*   IF CWBCMND(CMNDINDX:CMNDINDX)^=',' THEN/* COMMA?         @Y30LB03*/
@RC01501 L     @12,CWBPTR                                          1521
         SLR   @09,@09                                             1521
         IC    @09,CMNDINDX                                        1521
         ALR   @09,@12                                             1521
         CLI   CWBCMND-1(@09),C','                                 1521
         BNE   @RT01521                                            1521
*     GO TO SYNERROR;               /* NO,SYNTAX ERROR       @Y30LB03*/
*   CMNDINDX=CMNDINDX+F1;           /* YES,POINT TO NEXT     @Y30LB03
*                                      CHAR                  @Y30LB03
*                                      CHCK FOR 'OFFLINE'    @Y30LB03*/
         SLR   @09,@09                                             1523
         IC    @09,CMNDINDX                                        1523
         LA    @09,1(,@09)                                         1523
         STC   @09,CMNDINDX                                        1523
*   IF CWBCMND(CMNDINDX:CMNDINDX+F6)='OFFLINE' THEN/*        @Y30LB03*/
         ALR   @12,@09                                             1524
         CLC   CWBCMND-1(7,@12),@CC02860                           1524
         BNE   @RF01524                                            1524
*     DO;                           /* YES,....              @Y30LB03*/
*       ONOFF='OF';                 /* SET ON/OFF SWITCH     @Y30LB03*/
         MVC   ONOFF(2),@CC02861                                   1526
*       CMNDINDX=CMNDINDX+F7;       /* POINT TO NEXT FLD     @Y30LB03*/
         LA    @09,7(,@09)                                         1527
         STC   @09,CMNDINDX                                        1527
*     END;                          /*                       @Y30LB03*/
*   ELSE                            /* NO,....               @Y30LB03
*                                      CHECK FOR 'ONLINE'    @Y30LB03*/
*     IF CWBCMND(CMNDINDX:CMNDINDX+F5)='ONLINE' THEN/*       @Y30LB03*/
         B     @RC01524                                            1529
@RF01524 SLR   @12,@12                                             1529
         IC    @12,CMNDINDX                                        1529
         L     @09,CWBPTR                                          1529
         ALR   @09,@12                                             1529
         CLC   CWBCMND-1(6,@09),@CC02862                           1529
         BNE   @RF01529                                            1529
*       DO;                         /* YES,....              @Y30LB03*/
*         ONOFF='ON';               /* SET ON/OFF SWITCH     @Y30LB03*/
         MVC   ONOFF(2),@CC02863                                   1531
*         CMNDINDX=CMNDINDX+F6;     /* POINT TO NEXT FLD     @Y30LB03*/
         LA    @12,6(,@12)                                         1532
         STC   @12,CMNDINDX                                        1532
*       END;                        /*                       @Y30LB03*/
*     ELSE                          /* NEITHER?              @Y30LB03*/
*       GO TO SYNERROR;             /* THEN SYNTAX ERROR     @Y30LB03
*                                      CHECK FOR ',S'        @Y30LB03*/
*   IF CWBCMND(CMNDINDX:CMNDINDX+F1)^=',S' THEN/*            @Y30LB03*/
@RC01524 SLR   @12,@12                                             1535
         IC    @12,CMNDINDX                                        1535
         L     @09,CWBPTR                                          1535
         ALR   @09,@12                                             1535
         CLC   CWBCMND-1(2,@09),@CC02864                           1535
         BE    @RF01535                                            1535
*SYNERROR:                          /* ERROR PROCESSING      @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*   SYNTAX ERROR PROCESSING                                @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1536
*     DO;                           /* YES,                  @Y30LB03*/
SYNERROR DS    0H                                                  1537
*       WTOMCS03=MESGS(MSG31501);   /* SETUP ERROR MSG       @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1537
         L     @12,@CA02101                                        1537
         MVC   WTOMCS03(72),MESGS-MSGS+2736(@12)                   1537
*       CALL ICBMSG44;              /* CALL SUBRTN TO        @Y30LB03
*                                      DEQ CWB AREA          @Y30LB03*/
         BAL   @14,ICBMSG44                                        1538
*       CALL ICBMSG47;              /* CALL WTO SUBRTN       @Y30LB03*/
         BAL   @14,ICBMSG47                                        1539
*       CALL ICBMSG46;              /* CALL SUBRTN TO        @Y30LB03
*                                      FREE DQ'D CWB AREA    @Y30LB03*/
         BAL   @14,ICBMSG46                                        1540
*       RFY                                                        1541
*         R14 RSTD;                 /*                       @G24LB02*/
*       R14=SAVR1441;               /*                       @Y30LB03*/
         L     R14,SAVR1441                                        1542
*       RFY                                                        1543
*         R14 UNRSTD;               /*                       @G24LB02*/
*       RETURN;                     /* RTN TO ICBMSG40       @Y30LB03*/
@EL00016 DS    0H                                                  1544
@EF00016 DS    0H                                                  1544
@ER00016 BR    @14                                                 1544
*     END;                          /*                       @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*      END OF SYNTAX ERROR CHECKING AND PROCESSING         @Y30LB03*/
*/*      NOW DO AUTHORIZATION CHECKING.                      @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1546
*   WTOMCS03=MESGS(MSG31101);       /* FILL WTO BUFFER       @Z40LB01*/
@RF01535 MVI   WTOMCS03+72,C' '                                    1546
         L     @12,@CA02101                                        1546
         MVC   WTOMCS03(72),MESGS-MSGS+2584(@12)                   1546
*   CKAUTH=CWBAUTH&AUTHMASK;        /* DEFINE AUTH SWITCH    @Y30LB03*/
         L     @12,CWBPTR                                          1547
         MVC   CKAUTH(2),CWBAUTH(@12)                              1547
         NC    CKAUTH(2),AUTHMASK                                  1547
*   WTOMCS03(47:50)='    ';         /*                       @Z40LB01*/
         MVC   WTOMCS03+46(4),@CC02866                             1548
*   IF CKAUTH=CHAR0000 THEN         /* WAS SWITCH ZEROED?    @Y30LB03*/
         CLC   CKAUTH(2),@CB02433                                  1549
         BNE   @RF01549                                            1549
*     WTOMCS03(47:50)='0177';       /* YES, FILL IN REASON   @Z40LB01
*                                      CODE INDICATING       @Y30LB03
*                                      NOT AUTHORIZED        @Y30LB03*/
         MVC   WTOMCS03+46(4),@CC02867                             1550
*   IF CKAUTH=CHAR0000 THEN         /* WAS AUTH SWITCH CHNG'D?     1551
*                                                            @Y30LB03*/
@RF01549 CLC   CKAUTH(2),@CB02433                                  1551
         BNE   @RF01551                                            1551
*     DO;                           /* YES,DEFINE UNAUTHR'D MSG    1552
*                                                            @Y30LB03*/
*       IF ONOFF='ON' THEN          /* VARY ON CMD?          @Y30LB03*/
         CLC   ONOFF(2),@CC02863                                   1553
         BNE   @RF01553                                            1553
*         WTOMCS03(22:24)=' ON';    /* PUT 'ON' IN MSG       @Z40LB01*/
         MVC   WTOMCS03+21(3),@CC02868                             1554
*       ELSE                        /* FILL IN MSG WITH      @Y30LB03
*                                      OFF                   @Y30LB03*/
*         WTOMCS03(22:24)='OFF';    /* PUT 'OFF' IN MSG      @Z40LB01*/
         B     @RC01553                                            1555
@RF01553 MVC   WTOMCS03+21(3),@CC02869                             1555
*     END;                          /*                       @Y30LB03*/
@RC01553 DS    0H                                                  1557
*/*END OF AUTHORIZATION CHECKING                             @Y30LB03*/
*                                                                  1557
*   FREESWTH=F0;                    /*                       @Y30LB03*/
@RF01551 MVI   FREESWTH,X'00'                                      1557
*   DO VARYCNT=F1 TO UNITCNT;       /*                       @Y30LB03*/
         LA    @12,1                                               1558
         B     @DE01558                                            1558
@DL01558 DS    0H                                                  1559
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*        RTN TO CONVERT RU TO 2 DIGITS                     @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1559
*     ALPHAS=CHARS;                 /* BUILD TRANS TABLE     @Z40LB01*/
         LA    @12,24                                              1559
         AL    @12,CCWSPTR                                         1559
         MVC   ALPHAS(6,@12),CHARS                                 1559
*     NUMBRS=NUMS;                  /* BUILT TRANS TABLE     @Z40LB01*/
         MVC   NUMBRS(16,@12),NUMS                                 1560
*     MSGRU=CWBRU;                  /* MOVE IN UNIT NAME     @Z40LB01*/
         L     @12,CWBVREF                                         1561
         MVC   MSGRU(3),CWBRU(@12)                                 1561
*     IF MSGRU(1:1)=CHAR0 THEN      /* TEST FOR DASD         @Z40LB01*/
         CLI   MSGRU,C'0'                                          1562
         BNE   @RF01562                                            1562
*       DASD=BONE;                  /* SET DASD SWITCH       @Z40LB01*/
         OI    DASD,B'10000000'                                    1563
*     ELSE                          /* NOT DASD              @Z40LB01*/
*       DASD=BZERO;                 /* RESET DASD SWITCH     @Z40LB01*/
         B     @RC01562                                            1564
@RF01562 NI    DASD,B'01111111'                                    1564
*     TR(MSGRU,TRANSTBL);           /* TRANSLATE UNIT HEX    @Z40LB01*/
@RC01562 L     @12,CCWSPTR                                         1565
         TR    MSGRU(3),TRANSTBL+24(@12)                           1565
*     PACK(MSGRU,MSGRU);            /* PACK MSGRU            @Y30LB03*/
         PACK  MSGRU(3),MSGRU(3)                                   1566
*     MSGRU=MSGRU/F16;              /* SHIFT RIGHT 4 BITS    @Y30LB03*/
         SLR   @12,@12                                             1567
         ICM   @12,7,MSGRU                                         1567
         SRL   @12,4                                               1567
         STCM  @12,7,MSGRU                                         1567
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*     RU CONVERTED                                         @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1568
*     BRSWTCH=F0;                   /* SET BRSWTCH TO 0      @Y30LB03*/
         MVI   BRSWTCH,X'00'                                       1568
*     SSIDADDR=MACRORU;             /* SET TO 2 BYTE RU      @Y30LB03*/
         MVC   SSIDADDR(2),MACRORU                                 1569
*     DSDSWTH=F0;                   /*                       @Y30LB03*/
         MVI   DSDSWTH,X'00'                                       1570
*     IF CKAUTH=CHAR0000 THEN       /* CALLER AUTHORIZED?    @Y30LB03*/
         CLC   CKAUTH(2),@CB02433                                  1571
         BNE   @RF01571                                            1571
*       WTOMCS03(18:20)=RU;         /* NO,FILL IN UNIT       @Z40LB01*/
         L     @12,CWBVREF                                         1572
         MVC   WTOMCS03+17(3),RU(@12)                              1572
*     ELSE                          /* YES,                  @Y30LB03*/
*       DO;                         /* CKECK FOR MSC VARY    @Y30LB03*/
         B     @RC01571                                            1573
@RF01571 DS    0H                                                  1574
*         IF VARYCNT=F1 THEN        /* HAS ALL SYNTAX CHECKING     1574
*                                                            @Y30LB03
*                                      BEEN DONE?            @Y30LB03*/
         CLC   VARYCNT(4),@CF00117                                 1574
         BNE   @RF01574                                            1574
*           DO;                     /* NO,DO REST OF IT      @Y30LB03*/
*             CMNDINDX=CMNDINDX+F2; /* INCREMENT CNTR        @Y30LB03*/
         SLR   @12,@12                                             1576
         IC    @12,CMNDINDX                                        1576
         LA    @12,2(,@12)                                         1576
         STC   @12,CMNDINDX                                        1576
*             IF CWBCMND(CMNDINDX:CMNDINDX)^=' ' THEN/* OPERAND AFTER
*                                      'S'?                  @Y30LB03*/
         L     @09,CWBPTR                                          1577
         ALR   @12,@09                                             1577
         CLI   CWBCMND-1(@12),C' '                                 1577
         BE    @RF01577                                            1577
*               DO;                 /* YES,                  @Y30LB03*/
*/*  **********************************************          @Y30LB03*/
*/*   THE FOLLOWING STATEMENT CHECKS THE COMMAND SYNTAX      @Y30LB03*/
*/*   FOLLOWING THE 'S'.  A COMMA IS THE ONLY CHARACTER      @Y30LB03*/
*/*   THAT CAN FOLLOW THE 'S'.  AND, 'REAL' AND '3851'       @Y30LB03*/
*/*   ARE THE ONLY OPERANDS THAT CAN FOLLOW 'S,'.            @Y30LB03*/
*/*   IF THESE CASES DO NOT HOLD TRUE, SWITCHES ARE SET      @Y30LB03*/
*/*   THAT WILL (LATER) CAUSE A SYNTAX ERROR MESSAGE TO      @Y30LB03*/
*/*   BE PRINTED.  OTHER THAN PROCESSING TO TERMINATE        @Y30LB03*/
*/*   THE ORDER, VARY PROCESSING IS DISCONTINUED.            @Y30LB03*/
*/*  **********************************************          @Y30LB03*/
*                                                                  1579
*                 IF CWBCMND(CMNDINDX:CMNDINDX)^=','((/*    @Y30LB03*/
*                     CWBCMND(CMNDINDX+F1:CMNDINDX+F4)^='3851')&/* 1579
*                                      MSC VARY?             @Y30LB03*/
*                     (CWBCMND(CMNDINDX+F1:CMNDINDX+F4)^='REAL')) THEN
         SLR   @12,@12                                             1579
         IC    @12,CMNDINDX                                        1579
         ALR   @12,@09                                             1579
         CLI   CWBCMND-1(@12),C','                                 1579
         BNE   @RT01579                                            1579
         SLR   @12,@12                                             1579
         IC    @12,CMNDINDX                                        1579
         ALR   @12,@09                                             1579
         CLC   CWBCMND(4,@12),@CC02873                             1579
         BE    @RF01579                                            1579
         SLR   @12,@12                                             1579
         IC    @12,CMNDINDX                                        1579
         ALR   @09,@12                                             1579
         CLC   CWBCMND(4,@09),@CC02874                             1579
         BE    @RF01579                                            1579
@RT01579 DS    0H                                                  1580
*                                   /* VARY REAL?@Y30LB03            */
*                   DO;             /* YES                   @Y30LB03*/
*                     DSDSWTH=F2;   /* SET SYNTAX ERROR SWITCH     1581
*                                                            @Y30LB03*/
         MVI   DSDSWTH,X'02'                                       1581
*                     UNITCNT=F1;   /* CHG SWITCH TO EXIT DO LOOP  1582
*                                                            @Y30LB03*/
         MVC   UNITCNT(4),@CF00117                                 1582
*                   END;            /*                       @Y30LB03*/
*                 ELSE              /* CORRECT FORMAT AFTER 'S'    1584
*                                                            @Y30LB03*/
*                   DO;             /* IS IT 'REAL' OR '3851'?     1584
*                                                            @Y30LB03*/
         B     @RC01579                                            1584
@RF01579 DS    0H                                                  1585
*                     IF CWBCMND(CMNDINDX+F1:CMNDINDX+F4)='REAL' THEN
         SLR   @12,@12                                             1585
         IC    @12,CMNDINDX                                        1585
         L     @09,CWBPTR                                          1585
         ALR   @09,@12                                             1585
         CLC   CWBCMND(4,@09),@CC02874                             1585
         BNE   @RF01585                                            1585
*                                   /* REAL?                 @Y30LB03*/
*                       REAL=BONE;  /* YES, SET REAL SWITCH  @Y30LB03*/
         OI    REAL,B'10000000'                                    1586
*                     ELSE          /* NO, HAS TO BE '3851'(VARY MSC)
*                                                            @Y30LB03*/
*                       DO;         /* (VARY MSC)            @Y30LB03*/
         B     @RC01585                                            1587
@RF01585 DS    0H                                                  1588
*                         IF UNITCNT>F1 THEN/* MULTI UNIT VARY?    1588
*                                                            @Y30LB03*/
         LA    @12,1                                               1588
         C     @12,UNITCNT                                         1588
         BNL   @RF01588                                            1588
*                           DO;     /* YES,                  @Y30LB03*/
*                             DSDSWTH=F2;/* YES, SET SYNTAX ERROR  1590
*                                      SWITCH,               @Y30LB03*/
         MVI   DSDSWTH,X'02'                                       1590
*                             UNITCNT=F1;/* RESET UNIT CNT TO GET OUT
*                                      OF LOOP               @Y30LB03*/
         ST    @12,UNITCNT                                         1591
*                           END;    /*                       @Y30LB03*/
*                                                                  1592
*                         /*******************************************/
*                         /*                                         */
*                         /* CAN ONLY VARY ONE UNIT WITH '3851'      */
*                         /*                                 @Y30LB03*/
*                         /*                                         */
*                         /*******************************************/
*                                                                  1593
*                         ELSE      /* NO, SINGLE UNIT, SO CONTINUE
*                                                            @Y30LB03*/
*                                                                  1593
*                           /*****************************************/
*                           /*                                       */
*                           /* BY CALLING MSC VARY SUBROUTINE        */
*                           /*                               @Y30LB03*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  1593
*                           DO;     /* YES,                  @Y30LB03*/
         B     @RC01588                                            1593
@RF01588 DS    0H                                                  1594
*                             DSDSWTH=F1;/* TURN ON SWITCH   @Y30LB03*/
         MVI   DSDSWTH,X'01'                                       1594
*                             CALL ICBMSG49;/* CALL VARY MSC SUBRTN
*                                                            @Y30LB03*/
         BAL   @14,ICBMSG49                                        1595
*                             IF DSDSWTH=F0 THEN/* IF WASN'T MSC UNIT
*                                                            @Y30LB03*/
         CLI   DSDSWTH,0                                           1596
         BNE   @RF01596                                            1596
*                               DSDSWTH=F2;/* THEN SYNTAX ERROR    1597
*                                                            @Y30LB03*/
         MVI   DSDSWTH,X'02'                                       1597
*                           END;    /*                       @Y30LB03*/
@RF01596 DS    0H                                                  1599
*                       END;        /*                       @Y30LB03*/
@RC01588 DS    0H                                                  1600
*                   END;            /*                       @Y30LB03*/
@RC01585 DS    0H                                                  1601
*               END;                /*                       @Y30LB03*/
@RC01579 DS    0H                                                  1602
*           END;                    /*                       @Y30LB03*/
@RF01577 DS    0H                                                  1603
*       END;                        /*                       @Y30LB03*/
*                                                                  1603
@RF01574 DS    0H                                                  1604
*     /***************************************************************/
*     /*                                                             */
*     /* ****************************************************        */
*     /*                                                     @Y30LB03*/
*     /* AT THIS POINT DSDSWTH WILL CONTAIN EITHER 0,1,OR 2  @Y30LB03*/
*     /* F0 = 0                                              @Y30LB03*/
*     /* F1 = 1                                              @Y30LB03*/
*     /* F2 = 2                                              @Y30LB03*/
*     /* IF DSDSWTH = F0 THEN THIS IS A NORMAL VARY          @Y30LB03*/
*     /* IF DSDSWTH = F1 THEN THIS WAS A SUCCESSFUL MSC VARY,        */
*     /*                                                     @Y30LB03*/
*     /* AND MAY BE A WTO MESSAGE TO BE PRINTED              @Y30LB03*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1604
*/*   IF DSDSWTCH = F2 THE WRONG UNIT WAS SPECIFIED FOR      @Y30LB03
*     VARYING THE MSC (I.E.'3851' SPECIFIED ON COMMAND, BUT  @Y30LB03
*     NOT WITH A MSC UNIT). OR, THERE IS A SYNTAX ERROR      @Y30LB03
*    FOLLOWING THE 'S' OPERAND.                              @Y30LB03
*     FOR THESE CASES, A SYNTAX ERROR MESSAGE IS SET UP.     @Y30LB03*/
*                                                                  1604
*     IF DSDSWTH=F2 THEN            /* WAS WRONG UNIT/OPERAND      1604
*                                                            @Y30LB03
*                                      SPECIFIED IN VARY COMMAND?  1604
*                                                            @Y30LB03*/
@RC01571 CLI   DSDSWTH,2                                           1604
         BNE   @RF01604                                            1604
*       WTOMCS03=MESGS(MSG31501);   /*                       @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1605
         L     @12,@CA02101                                        1605
         MVC   WTOMCS03(72),MESGS-MSGS+2736(@12)                   1605
*     ELSE                          /* IF WASN'T SYNTAX ERROR      1606
*                                                            @Y30LB03
*                                      IN MSC VARY           @Y30LB03*/
*       IF DSDSWTH=F0 THEN          /* CHECK FOR NORMAL VARY @Y30LB03*/
         B     @RC01604                                            1606
@RF01604 CLI   DSDSWTH,0                                           1606
         BNE   @RF01606                                            1606
*         IF CKAUTH^=CHAR0000 THEN  /* WAS CALLER AUTHORIZED?      1607
*                                                            @Y30LB03*/
         CLC   CKAUTH(2),@CB02433                                  1607
         BE    @RF01607                                            1607
*           IF ONOFF='OF' THEN      /* VARY OFF CMD?         @Y30LB03*/
         CLC   ONOFF(2),@CC02861                                   1608
         BNE   @RF01608                                            1608
*             DO;                   /* YES,                  @Y30LB03*/
*               OPCMECB=F0;         /* ZERO ECB              @Y30LB03*/
         SLR   @12,@12                                             1610
         ST    @12,OPCMECB                                         1610
*               IF REAL=BONE THEN   /* REAL?                 @Y30LB03*/
         TM    REAL,B'10000000'                                    1611
         BNO   @RF01611                                            1611
*                 VFLAGS(1:3)='010'B;/* YES, SET REAL              1612
*                                      ATTRIBUTE@Y30LB03             */
         NI    VFLAGS,B'01011111'                                  1612
         OI    VFLAGS,B'01000000'                                  1612
*               ELSE                /* NO,                   @Y30LB03*/
*                 IF DASD=BONE THEN /* DASD?                 @Y30LB03*/
         B     @RC01611                                            1613
@RF01611 TM    DASD,B'10000000'                                    1613
         BNO   @RF01613                                            1613
*                   DO;             /* YES,CHECK TYPE        @Y30LB03*/
*                     VFLAGS(1:3)='100'B;/* SET FLAGS VIRTUAL      1615
*                                                            @Y30LB03*/
         NI    VFLAGS,B'10011111'                                  1615
         OI    VFLAGS,B'10000000'                                  1615
*                     OPCMECB=CWBPTR;/* SET ECB              @Y30LB03*/
         L     @12,CWBPTR                                          1616
         ST    @12,OPCMECB                                         1616
*                     OPCMECB1=CHARFF;/* SET ECBS HIGH BYTE  @Y30LB03*/
         MVI   OPCMECB1,X'FF'                                      1617
*                     BRSWTCH=F1;   /* TURN BRCH SWTCH ON    @Y30LB03*/
         MVI   BRSWTCH,X'01'                                       1618
*                     FREESWTH=FREESWTH+F1;/* WHEN THIS SWTH IS 0  1619
*                                                            @Y30LB03
*                                      THE CWB AREA CAN BE   @Y30LB03
*                                      FREED IN ICBMSG46     @Y30LB03*/
         IC    @12,FREESWTH                                        1619
         LA    @12,1(,@12)                                         1619
         STC   @12,FREESWTH                                        1619
*                   END;            /*                       @Y30LB03*/
*                 ELSE              /* NOT,DASD              @Y30LB03*/
*                   VFLAGS(1:3)='000'B;/* SO ZERO ATTRIBUTE  @Y30LB03
*                                      BITS IN FLAGS         @Y30LB03*/
         B     @RC01613                                            1621
@RF01613 NI    VFLAGS,B'00011111'                                  1621
*               VOFECB=OPCMECB;     /* FILL IN ECB FIELD     @Y30LB03*/
@RC01613 DS    0H                                                  1622
@RC01611 L     @12,OPCMECB                                         1622
         ST    @12,VOFECB                                          1622
*               SAVREENT=REENTRY;   /* SAVE REENTRY POINTER  @G24LB02*/
         L     @12,REENTRY                                         1623
         ST    @12,SAVREENT                                        1623
*               REENTRY=ADDR(VOFRET);/* SET NEW REENTRY PTR  @G24LB02*/
         LA    @12,VOFRET                                          1624
         ST    @12,REENTRY                                         1624
*               SVCCALL=ON;         /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 1625
*IVARYOF1:                                                         1626
*                                                                  1626
*               /*****************************************************/
*               /*                                                   */
*               /* ***************************************************/
*               /* ******                                    @Y30LB02*/
*               /* MACMEAN MSSC VARYON/VARYOFF MACRO         @Y30LB02*/
*               /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00   @Y30LB02*/
*               /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.  @Y30LB02*/
*               /* THE LIST FORM OF THIS MACRO SHOULD BE     @Y30LB02*/
*               /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        */
*               /*                                           @Y30LB02*/
*               /* DECLARES. IF THE COMPLETE ARGUMENT IS     @Y30LB02*/
*               /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.   @Y30LB02*/
*               /* ***************************************************/
*               /* ******                                    @Y30LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1626
*               RFY                                                1626
*                (ICBR1) RSTD;      /* RESTRICT REG 1        @Y30LB02*/
IVARYOF1 DS    0H                                                  1627
*               ICBR1=ADDR(VOFLIST);/* R1 PTR TO REQUEST BLOCK     1627
*                                                            @Y30LB02*/
         LA    ICBR1,VOFLIST                                       1627
*               VOFLEN='18'X;       /* LENG-VARYOFF REQUEST BLOCK  1628
*                                                            @Y30LB02*/
         LA    @12,24                                              1628
         ST    @12,VOFLEN                                          1628
*               VOFOPCD='0C'X;      /* OPCODE FOR VARYOFF REQ      1629
*                                                            @Y30LB02*/
         MVI   VOFOPCD,X'0C'                                       1629
*               VOFFLG=(VFLAGS);    /* VALUE OF FLAGS        @Y30LB02*/
         MVC   VOFFLG(2),VFLAGS                                    1630
*               VOFSSID=(SSIDADDR); /* VALUE OF SSID         @Y30LB02*/
         MVC   VOFSSID(2),SSIDADDR                                 1631
*               SVC(126);           /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 1632
*               RFY                                                1633
*                 ICBR1 UNRSTD;     /* UNRESTRICT REG 1      @Y30LB02
*                                      VARY OFF              @Y30LB03*/
*VOFRET:                            /* LABEL RETURN          @G24LB02*/
*               SVCCALL=OFF;        /* CLEAR SVC CALL FLAG   @G24LB02*/
VOFRET   NI    SVCCALL,B'11110111'                                 1634
*               REENTRY=SAVREENT;   /* RESTORE REENTRY POINTER     1635
*                                                            @G24LB02*/
         L     @12,SAVREENT                                        1635
         ST    @12,REENTRY                                         1635
*               RFY                                                1636
*                (R15) RSTD;        /* R15 RESTRICT          @Z40LB01*/
*               IF R15^=F0 THEN     /* ERROR RETURN?         @Y30LB03*/
         LTR   R15,R15                                             1637
         BZ    @RF01637                                            1637
*                 DO;               /* YES                   @Y30LB03*/
*                                                                  1638
*                   /*************************************************/
*                   /*                                               */
*                   /* CONVERT REASON CODE                   @Y30LB03*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1639
*                   RESPECIFY                                      1639
*                     R0 RSTD;      /* RSTD REG 0            @Y30LB03*/
*                   INTER=R0;       /*                       @Y30LB03*/
         ST    R0,INTER                                            1640
*                   CALL ICBMSG82;  /* CALL SUBRTN TO        @Y30LB03
*                                      CONVERT REAS CODE     @Y30LB03*/
         BAL   @14,ICBMSG82                                        1641
*                   RFY                                            1642
*                    (R0,                                          1642
*                     R15) UNRSTD;  /* RELEASE REG 0         @G24LB02*/
*                                                                  1642
*                   /*************************************************/
*                   /*                                               */
*                   /* PREPARE NORMAL                        @Y30LB03*/
*                   /* FAILURE MESSAGE(WTO)                  @Y30LB03*/
*                   /* FILL IN REAS CODE,                    @Y30LB03*/
*                   /* REAL UNIT, AND 'OFF'                  @Y30LB03*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1643
*                   WTOMCS03=MESGS(MSG31101);/* FILL BUFF    @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1643
         L     @12,@CA02101                                        1643
         MVC   WTOMCS03(72),MESGS-MSGS+2584(@12)                   1643
*                   WTOMCS03(47:49)=BYTES234;/*              @Z40LB01*/
         MVC   WTOMCS03+46(3),BYTES234                             1644
*                   WTOMCS03(18:20)=RU;/*                    @Z40LB01*/
         L     @12,CWBVREF                                         1645
         MVC   WTOMCS03+17(3),RU(@12)                              1645
*                   WTOMCS03(22:24)='OFF';/*                 @Z40LB01*/
         MVC   WTOMCS03+21(3),@CC02869                             1646
*                   IF VFLAGS(1)=BONE THEN/* DEL RESPONSE?   @Y30LB03*/
         TM    VFLAGS,B'10000000'                                  1647
         BNO   @RF01647                                            1647
*                     DO;           /* YES....               @Y30LB03*/
*                       FREESWTH=FREESWTH-F1;/*              @Y30LB03*/
         SLR   @12,@12                                             1649
         IC    @12,FREESWTH                                        1649
         BCTR  @12,0                                               1649
         STC   @12,FREESWTH                                        1649
*                       BRSWTCH=F0; /* TURN BRCH SWTCH OF    @Y30LB03*/
         MVI   BRSWTCH,X'00'                                       1650
*                     END;          /*                       @Y30LB03*/
*                   RU='***';       /* CROSS OUT UNIT        @Y30LB03*/
@RF01647 L     @12,CWBVREF                                         1652
         MVC   RU(3,@12),@CC02792                                  1652
*                 END;              /*                       @Y30LB03*/
*               ELSE                /* GOOD RETURN           @Y30LB03*/
*                 IF BRSWTCH=F0 THEN/* CHECK BRCH SWITCH     @Y30LB03*/
         B     @RC01637                                            1654
@RF01637 CLI   BRSWTCH,0                                           1654
         BNE   @RF01654                                            1654
*                   DO;             /* SET UP GOOD MSG       @Y30LB03*/
*                     WTOMCS03=MESGS(MSG30201);/* FILL BUFF  @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1656
         L     @12,@CA02101                                        1656
         MVC   WTOMCS03(72),MESGS-MSGS+2432(@12)                   1656
*                     WTOMCS03(13:15)=RU;/*                  @Z40LB01*/
         L     @12,CWBVREF                                         1657
         MVC   WTOMCS03+12(3),RU(@12)                              1657
*                     WTOMCS03(21:23)='OFF';/*               @Z40LB01*/
         MVC   WTOMCS03+20(3),@CC02869                             1658
*                     RU='***';     /* CROSS OUT UNIT        @Y30LB03*/
         MVC   RU(3,@12),@CC02792                                  1659
*                   END;            /*                       @Y30LB03*/
*             END;                  /*                       @Y30LB03*/
*           ELSE                    /* CHECK FOR 'ON'        @Y30LB03*/
*             IF ONOFF='ON' THEN    /* VARY ON CMD?          @Y30LB03*/
         B     @RC01608                                            1662
@RF01608 CLC   ONOFF(2),@CC02863                                   1662
         BNE   @RF01662                                            1662
*               DO;                 /* YES,                  @Y30LB03*/
*                 IF REAL=BONE THEN /* REAL?                 @Y30LB03*/
         TM    REAL,B'10000000'                                    1664
         BNO   @RF01664                                            1664
*                   VFLAGS(1:3)='010'B;/* YES, SET REAL            1665
*                                      ATTRIBUTE@Y30LB03             */
         NI    VFLAGS,B'01011111'                                  1665
         OI    VFLAGS,B'01000000'                                  1665
*                 ELSE              /* NO,                   @Y30LB03*/
*                   IF DASD='1'B THEN/* DASD TO BE VARIED?   @Y30LB03*/
         B     @RC01664                                            1666
@RF01664 TM    DASD,B'10000000'                                    1666
         BNO   @RF01666                                            1666
*                     VFLAGS(1:3)='100'B;/* SET FLAGS VIRTUAL      1667
*                                                            @Y30LB03*/
         NI    VFLAGS,B'10011111'                                  1667
         OI    VFLAGS,B'10000000'                                  1667
*                   ELSE            /* NOT DASD, SO...       @Y30LB03*/
*                     VFLAGS(1:3)='000'B;/* ZERO FLAGS       @Y30LB03
*                                      ISSUE VARY ON         @Y30LB03*/
         B     @RC01666                                            1668
@RF01666 NI    VFLAGS,B'00011111'                                  1668
*                 SAVREENT=REENTRY; /* SAVE REENTRY POINTER  @G24LB02*/
@RC01666 DS    0H                                                  1669
@RC01664 L     @12,REENTRY                                         1669
         ST    @12,SAVREENT                                        1669
*                 REENTRY=ADDR(VONRET);/* SET NEW REENTRY POINTER  1670
*                                                            @G24LB02*/
         LA    @12,VONRET                                          1670
         ST    @12,REENTRY                                         1670
*                 SVCCALL=ON;       /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 1671
*IVARYON1:                                                         1672
*                                                                  1672
*                 /***************************************************/
*                 /*                                                 */
*                 /* *************************************************/
*                 /* *******                                 @Y30LB02*/
*                 /* MACMEAN MSSC VARYON MACRO               @Y30LB02*/
*                 /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00  @Y30LB02*/
*                 /* THIS IS THE STANDARD FORM - VARYON MACRO        */
*                 /*                                         @Y30LB02*/
*                 /* *************************************************/
*                 /* *******                                 @Y30LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1672
*                 RFY                                              1672
*                  (ICBR1) RSTD;    /* RESTRICT REG 1        @Y30LB02*/
IVARYON1 DS    0H                                                  1673
*                 ICBR1=ADDR(VONLEN);/* R1 PTR TO REQ BLK    @Y30LB02*/
         LA    ICBR1,VONLEN                                        1673
*                 DCL                                              1674
*                   1 VONLST01 STATIC LOCAL,/* VARYON REQUEST BLOCK
*                                                            @Y30LB02*/
*                    2 VONLEN FIXED(31) INIT('0C'X),/* LENGTH OF   1674
*                                      VARYON REQ BLK        @Y30LB02*/
*                    2 VONOPCD CHAR(1) INIT('0A'X),/* VARYON OPCODE
*                                                            @Y30LB02*/
*                    2 VONRES1 CHAR(1) INIT('00'X),/* ONE BYTE OF  1674
*                                      ZERO                  @Y30LB02*/
*                    2 VONFLG BIT(16) INIT('0000000000000000'B),/* 1674
*                                      FLAGS AREA            @Y30LB02*/
*                     3 VONSTAG BIT(1),/* STAGING ATTRIBUTE  @Y30LB02*/
*                     3 VONREAL BIT(1),/* REAL ATTRIBUTE     @Y30LB02*/
*                     3 * BIT(14),  /* FOURTEEN BITS RESERVED      1674
*                                                            @Y30LB02*/
*                    2 VONSSID FIXED(15) INIT(0),/* SUBSYSTEM ID   1674
*                                                            @Y30LB02*/
*                    2 VONRES2 CHAR(2) INIT('0000'X);/* RESERVED AREA
*                                                            @Y30LB02*/
*                 VONLEN='0C'X;     /* LENG-VARYON REQUEST BLOCK   1675
*                                                            @Y30LB02*/
         LA    @12,12                                              1675
         ST    @12,VONLEN                                          1675
*                 VONOPCD='0A'X;    /* VARYON OPCODE         @Y30LB02*/
         MVI   VONOPCD,X'0A'                                       1676
*                 VONFLG=(VFLAGS);  /* VALUE OF FLAGS        @Y30LB02*/
         MVC   VONFLG(2),VFLAGS                                    1677
*                 VONSSID=(SSIDADDR);/* VALUE OF SSID        @Y30LB02*/
         MVC   VONSSID(2),SSIDADDR                                 1678
*                 SVC(126);         /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 1679
*                 RFY                                              1680
*                   ICBR1 UNRSTD;   /* UNRESTRICT REG 1      @Y30LB02
*                                                            @Y30LB03*/
*VONRET:                            /* LABEL FOR RETURN      @G24LB02*/
*                 SVCCALL=OFF;      /* CLEAR SVC CALL FLAG   @G24LB02*/
VONRET   NI    SVCCALL,B'11110111'                                 1681
*                 REENTRY=SAVREENT; /* RESTORE REENTRY POINTER     1682
*                                                            @G24LB02*/
         L     @12,SAVREENT                                        1682
         ST    @12,REENTRY                                         1682
*                 RFY                                              1683
*                   R15 RSTD;       /* R15 RESTRICT          @Z40LB01*/
*                 IF R15^=F0 THEN   /* ERROR RETURN?         @Y30LB03*/
         LTR   R15,R15                                             1684
         BZ    @RF01684                                            1684
*                   DO;             /*                       @Y30LB03*/
*                                                                  1685
*                     /***********************************************/
*                     /*                                             */
*                     /* CONVERT REASON CODE                 @Y30LB03*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1686
*                     RESPECIFY                                    1686
*                       R0 RSTD;    /* RSTD REG 0            @Y30LB03*/
*                     INTER=R0;     /*                       @Y30LB03*/
         ST    R0,INTER                                            1687
*                     CALL ICBMSG82;/* CALL SUBRTN TO        @Y30LB03
*                                      CONVERT REAS CODE     @Y30LB03*/
         BAL   @14,ICBMSG82                                        1688
*                     RFY                                          1689
*                      (R0,                                        1689
*                       R15) UNRSTD;/* RELEASE REG 0         @G24LB02*/
*                                                                  1689
*                     /***********************************************/
*                     /*                                             */
*                     /* PREPARE NORMAL                      @Y30LB03*/
*                     /* FAILURE MESSAGE(WTO)                @Y30LB03*/
*                     /* FILL IN REAS CODE,                  @Y30LB03*/
*                     /* REAL UNIT, AND ' ON'                @Y30LB03*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1690
*                     WTOMCS03=MESGS(MSG31101);/* FILL BUFF  @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1690
         L     @12,@CA02101                                        1690
         MVC   WTOMCS03(72),MESGS-MSGS+2584(@12)                   1690
*                     WTOMCS03(47:49)=BYTES234;/*            @Z40LB01*/
         MVC   WTOMCS03+46(3),BYTES234                             1691
*                     WTOMCS03(18:20)=RU;/*                  @Z40LB01*/
         L     @12,CWBVREF                                         1692
         MVC   WTOMCS03+17(3),RU(@12)                              1692
*                     WTOMCS03(22:24)=' ON';/*               @Z40LB01*/
         MVC   WTOMCS03+21(3),@CC02868                             1693
*                   END;            /*                       @Y30LB03*/
*                 ELSE              /* GOOD RETURN           @Y30LB03*/
*                   DO;             /*                       @Y30LB03*/
         B     @RC01684                                            1695
@RF01684 DS    0H                                                  1696
*                     WTOMCS03=MESGS(MSG30201);/* FILL BUFF  @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1696
         L     @12,@CA02101                                        1696
         MVC   WTOMCS03(72),MESGS-MSGS+2432(@12)                   1696
*                     WTOMCS03(13:15)=RU;/*                  @Z40LB01*/
         L     @12,CWBVREF                                         1697
         MVC   WTOMCS03+12(3),RU(@12)                              1697
*                     WTOMCS03(21:23)=' ON';/*               @Z40LB01*/
         MVC   WTOMCS03+20(3),@CC02868                             1698
*                   END;            /*                       @Y30LB03*/
*               END;                /*                       @Y30LB03*/
*             ELSE                  /* ERROR SITUATION       @Y30LB03*/
*               WTOMCS03=MESGS(MSG31501);/* SYNTAX ERROR     @Z40LB01*/
         B     @RC01662                                            1701
@RF01662 MVI   WTOMCS03+72,C' '                                    1701
         L     @12,@CA02101                                        1701
         MVC   WTOMCS03(72),MESGS-MSGS+2736(@12)                   1701
*     IF BRSWTCH=F0 THEN            /* IS BRSWTCH OFF?       @Y30LB03*/
@RC01662 DS    0H                                                  1702
@RC01608 DS    0H                                                  1702
@RF01607 DS    0H                                                  1702
@RF01606 DS    0H                                                  1702
@RC01604 CLI   BRSWTCH,0                                           1702
         BNE   @RF01702                                            1702
*       DO;                         /*                       @Y30LB03*/
*         CALL ICBMSG47;            /* CALL SUBRTN THAT      @Y30LB03
*                                      ISSUES WTO MACRO      @Y30LB03*/
         BAL   @14,ICBMSG47                                        1704
*       END;                        /*                       @Y30LB03*/
*     CWBVREF=CWBVREF+F4;           /* INCR PTR TO NXT       @Y30LB03
*                                      UNIT                  @Y30LB03*/
@RF01702 LA    @12,4                                               1706
         AL    @12,CWBVREF                                         1706
         ST    @12,CWBVREF                                         1706
*   END;                            /*                       @Y30LB03*/
         LA    @12,1                                               1707
         AL    @12,VARYCNT                                         1707
@DE01558 ST    @12,VARYCNT                                         1707
         C     @12,UNITCNT                                         1707
         BNH   @DL01558                                            1707
*                                                                  1708
*/*********************************************************  @Y30LB03*/
*/*  FINISH UP PROCESSING FOR THIS SUBROUTINE                @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1708
*FIN41:                             /*                       @Y30LB03*/
*   CALL ICBMSG44;                  /* CALL DQ SUBRTN        @Y30LB03*/
FIN41    BAL   @14,ICBMSG44                                        1708
*/*********************************************************  @Y30LB03*/
*/*  CHECK TO SEE IF CWB SHOULD BE FREED                     @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1709
*VFREEL:                                                           1709
*   IF FREESWTH=F0 THEN             /* FREE SWTCH OFF?       @Y30LB03*/
VFREEL   CLI   FREESWTH,0                                          1709
         BNE   @RF01709                                            1709
*     DO;                           /*                       @Y30LB03*/
*       CALL ICBMSG46;              /* CALL FREEMAIN SRTN    @Y30LB03*/
         BAL   @14,ICBMSG46                                        1711
*     END;                          /*                       @Y30LB03*/
*   RFY                                                            1713
*     R14 RSTD;                     /*                       @G24LB02*/
@RF01709 DS    0H                                                  1714
*   R14=SAVR1441;                   /* RESTORE REG 14        @Y30LB03*/
         L     R14,SAVR1441                                        1714
*   RFY                                                            1715
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG40       @Y30LB03*/
         B     @EL00016                                            1716
*   END ICBMSG41;                   /*                       @Y30LB03*/
*                                                                  1718
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG42                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = ASSIGN/PURGE COMMAND PROCESSING      @Y30LB03
*                        SUBROUTINE                           @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = ISSUE ICBPAIR MACRO FOR COMTASK              @Y30LB03
*                ASSIGN AND PURGE COMMANDS                    @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = DETERMINE TYPE OF COMMAND (ASSIGN OR PURGE)   @Y30LB03
*               AND SET UP MACRO PARAMETERS FOR ICBPAIR       @Y30LB03
*               MACRO. INTEROGATE RETURN CODE IN ORDER TO     @Y30LB03
*               SET UP SUCCESSFUL/UNSUCCESSFUL WTO MESSAGE.   @Y30LB03
*               CALL WTO SUBROUTINE(ICBMSG47),DEQUEUE         @Y30LB03
*               SUBROUTINE(ICBMSG44), AND FREEMAIN SUB-       @Y30LB03
*               ROUTINE(ICBMSG46).                            @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = ASSIGN/PURGE COMTASK COMMANDS                 @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = PROCESSED COMTASK ASSIGN/PURGE COMMAND       @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1718
*ICBMSG42:                                                         1718
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG42 DS    0H                                                  1719
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE HANDLES REQUESTS FOR THE PURGE        @Y30LB03*/
*/*    AND ASSIGN PRIMARY HOST ORDERS.                       @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*/*  ASSIGN PRIMARY HOST AND PURGE WTO MESSAGE               @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/*  HOSTID IN CWB                                           @Y30LB03*/
*                                                                  1719
*   DCL                                                            1719
*     1 HSTINCWB CHAR(11) DEF(CWBCMND),/*                    @Y30LB03*/
*      2 REALHOST CHAR(10),         /* ACTUAL HOSTID IN CMND @Y30LB03*/
*      2 * CHAR(1);                 /* DUMMY BYTE FOR PACKING      1719
*                                                            @Y30LB03*/
*   DCL                                                            1720
*     VOLKEY CHAR(6) INIT('VOLID=');/* KEYWORD CONSTANT      @ZDR2048*/
*                                                                  1720
*   /*****************************************************************/
*   /*                                                               */
*   /* FIELD USED TO PACK HOSTID                             @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1721
*   DCL                                                            1721
*     1 PKHOSTID CHAR(7),           /*                       @Y30LB03*/
*      2 * CHAR(1),                 /*                       @Y30LB03*/
*      2 RECVHOST CHAR(6),          /* RECEIVES PACKED HOSTID      1721
*                                                            @Y30LB03*/
*       3 PCKDHOST CHAR(5),         /* 5-BYTE HOSTID FOR REQ.BLK   1721
*                                                            @Y30LB03*/
*       3 * CHAR(1);                /* DUMMY BYTE            @Y30LB03*/
*   RFY                                                            1722
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1442=R14;                   /* SAVE REG 14           @Y30LB03*/
         ST    R14,SAVR1442                                        1723
*   RFY                                                            1724
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RECOVER(5)=BONE;                /* SET RECOVERY BIT      @Y30LB03
*                                      FOR ASSIGN/PURGE      @Y30LB03*/
         OI    RECOVER,B'00001000'                                 1725
*   RESPECIFY                                                      1726
*     R15 RSTD;                     /* RESTRICT REG 15       @Y30LB03*/
*                                                                  1726
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE COMMAND CODE IS PURGE AND THE HOSTID           @ZM01013*/
*   /* IS NOT SUPPLIED IN THE COMMAND, ISSUE MESSAGE         @ZM01013*/
*   /* ICB316I AND EXIT FROM THE PROC                        @ZM01013*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1727
*   IF CWBVBCDE=164&CWBCMND(1:1)=' ' THEN                          1727
         L     @14,CWBPTR                                          1727
         CLI   CWBVBCDE(@14),164                                   1727
         BNE   @RF01727                                            1727
         CLI   CWBCMND(@14),C' '                                   1727
         BNE   @RF01727                                            1727
*     DO;                           /*                       @ZM01013*/
*       WTOMCS03=MESGS(MSG31601);   /* PUT MESSAGE TEXT      @Z40LB01
*                                      INTO WTO AREA         @ZM01013*/
         MVI   WTOMCS03+72,C' '                                    1729
         L     @14,@CA02101                                        1729
         MVC   WTOMCS03(72),MESGS-MSGS+2812(@14)                   1729
*       CALL ICBMSG44;              /* DEQ THE CWB           @ZM01013*/
         BAL   @14,ICBMSG44                                        1730
*       CALL ICBMSG47;              /* ISSUE WTO MACRO       @ZM01013*/
         BAL   @14,ICBMSG47                                        1731
*       CALL ICBMSG46;              /* FREE WORKAREA         @ZM01013*/
         BAL   @14,ICBMSG46                                        1732
*     END;                          /*                       @ZM01013*/
*                                                                  1733
*   /*****************************************************************/
*   /*                                                               */
*   /* BUT IF THE PURGE COMMAND IS NOT IN ERROR              @ZM01013*/
*   /* CONTINUE WITH PROCESSING OF ASSIGN/PURGE              @ZM01013*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1734
*   ELSE                                                           1734
*     DO;                           /*                       @ZM01013*/
         B     @RC01727                                            1734
@RF01727 DS    0H                                                  1735
*       IF CWBVBCDE=140 THEN        /* ASSIGN REQUEST?       @Y30LB03*/
         L     @14,CWBPTR                                          1735
         CLI   CWBVBCDE(@14),140                                   1735
         BNE   @RF01735                                            1735
*         DO;                       /* YES,ISSUE ASSIGN      @Y30LB03
*                                      FORM OF ICBPAIR       @Y30LB03*/
*           SAVREENT=REENTRY;       /* SAVE REENTRY POINTER  @G24LB02*/
         L     @14,REENTRY                                         1737
         ST    @14,SAVREENT                                        1737
*           REENTRY=ADDR(ASNRET);   /* SET NEW REENTRY POINTER     1738
*                                                            @G24LB02*/
         LA    @14,ASNRET                                          1738
         ST    @14,REENTRY                                         1738
*           SVCCALL=ON;             /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 1739
*IPAIR2:                                                           1740
*                                                                  1740
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************************************/
*           /* *                                             @Y30LB02*/
*           /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO   @Y30LB02*/
*           /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00       @Y30LB02*/
*           /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.      @Y30LB02*/
*           /* THE LIST FORM OF THIS MACRO SHOULD BE         @Y30LB02*/
*           /* INVOKED FIRST IN ORDER TO SET UP NECESSARY    @Y30LB02*/
*           /* DECLARES. IF THE COMPLETE ARGUMENT IS         @Y30LB02*/
*           /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.       @Y30LB02*/
*           /* *******************************************************/
*           /* *                                             @Y30LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1740
*           RFY                                                    1740
*            (PAIRR1) RSTD;         /* RESTRICT R1           @Y30LB02*/
IPAIR2   DS    0H                                                  1741
*           PAIRR1=ADDR(ARLIST);    /* SET PAIRR1 TO REQ BLOCK     1741
*                                                            @Y30LB02*/
         LA    PAIRR1,ARLIST                                       1741
*           AIRLL='08'X;            /* SET LENGTH FIELD      @Y30LB02*/
         LA    @14,8                                               1742
         ST    @14,AIRLL                                           1742
*           AIROP='12'X;            /* APH OPCODE            @Y30LB02*/
         MVI   AIROP,X'12'                                         1743
*           SVC(126);               /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 1744
*           RFY                                                    1745
*            (PAIRR1) UNRSTD;       /* UNRESTRICT R1         @Y30LB02*/
*/*@Y30LB03                                                          */
*                                                                  1746
*ASNRET:                            /* LABEL FOR RETURN      @G24LB02*/
*           SVCCALL=OFF;            /* CLEAR SVC CALL FLAG   @G24LB02*/
ASNRET   NI    SVCCALL,B'11110111'                                 1746
*           REENTRY=SAVREENT;       /* RESTORE REENTRY POINTER     1747
*                                                            @G24LB02*/
         L     @14,SAVREENT                                        1747
         ST    @14,REENTRY                                         1747
*         END;                      /*                       @Y30LB03*/
*                                                                  1748
*       /*************************************************************/
*       /*                                                           */
*       /* THE COMMAND BEING PROCESSED IS PURGE              @ZDR2048*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1749
*       ELSE                        /*                       @ZDR2048*/
*         IF KEYWD=VOLKEY THEN      /* PURGE VOLID REQ?      @ZDR2048*/
         B     @RC01735                                            1749
@RF01735 L     @14,CWBPTR                                          1749
         CLC   KEYWD(6,@14),VOLKEY                                 1749
         BNE   @RF01749                                            1749
*           DO;                     /* PURGE VOLID CODE      @ZDR2048*/
*             R15=F0;               /* CLEAR REG 15          @G24LB02*/
         SLR   R15,R15                                             1751
*             CUUUCB='   ';         /* CLEAR UCBNAME SAVE          1752
*                                      AREA@ZDR2048                  */
         MVC   CUUUCB(3),@CC02356                                  1752
*             MSG42SW=BONE;         /* SET MSG42 CALL SWITCH @ZDR2048*/
         OI    MSG42SW,B'00000010'                                 1753
*             CALL ICBMSG88;        /* CALL UCB SCAN ROUTINE @ZDR2048*/
         BAL   @14,ICBMSG88                                        1754
*             IF CUUUCB='   ' THEN  /* TEST UCB VOL FIND     @ZDR2048*/
         CLC   CUUUCB(3),@CC02356                                  1755
         BNE   @RF01755                                            1755
*               DO;                 /* VOL NOT FOUND IN VUCB @ZDR2048*/
*                 SAVREENT=REENTRY; /* SAVE REENTRY POINTER  @G24LB02*/
         L     @14,REENTRY                                         1757
         ST    @14,SAVREENT                                        1757
*                 REENTRY=ADDR(DMTRET);/* SET NEW REENTRY PTR      1758
*                                                            @G24LB02*/
         LA    @14,DMTRET                                          1758
         ST    @14,REENTRY                                         1758
*                 SVCCALL=ON;       /* SET SVC CALL FLAG     @G24LB02*/
*                                                                  1759
         OI    SVCCALL,B'00001000'                                 1759
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE DEMOUNT VOLID FOR VOLUME          @ZDR2048*/
*                 /* MACRO INVOCATION:                       @ZA28964*/
*                 /* ICBMNTDE                                        */
*                 /* MF(E,DMTLIST,COMPLETE)TYPE(DMNT)VOLID(VOL)      */
*                 /*                                         @ZA28964*/
*                 /* *************************************************/
*                 /* ********                                @Y30LB02*/
*                 /* MACMEAN MSSC MOUNT/DEMOUNT MACRO        @Y30LB02*/
*                 /* VERSION - VS/2 REL 3 77/12/15 LEVEL 04  @ZA28964*/
*                 /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.        */
*                 /*                                         @Y30LB02*/
*                 /* THE LIST FORM OF THIS MACRO SHOULD BE   @Y30LB02*/
*                 /* INVOKED FIRST IN ORDER TO SET UP NECESSARY      */
*                 /*                                         @Y30LB02*/
*                 /* DECLARES. IF THE COMPLETE ARGUMENT IS   @Y30LB02*/
*                 /* SPECIFIED THE REQ BLOCK WILL BE ZEROED. @Y30LB02*/
*                 /* *************************************************/
*                 /* ********                                @Y30LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1760
*                 RFY                                              1760
*                   MDREG1 RSTD;    /* RESTRICT REG 1        @Y30LB02*/
*                 MDREG1=ADDR(DMTLIST);/* R1 PTR TO REQ BLOCK      1761
*                                                            @Y30LB02*/
         LA    MDREG1,DMTLIST                                      1761
*                 DMTLIST=DMTLIST&&DMTLIST;/* ZERO OUT BLOCK @Y30LB02*/
         XC    DMTLIST(28),DMTLIST                                 1762
*                 DMLEN='1C'X;      /* LENGTH OF DEMOUNT REQUEST   1763
*                                      BLOCK                 @Y30LB02*/
         LA    @14,28                                              1763
         ST    @14,DMLEN                                           1763
*                 DMOPCD='06'X;     /* DEMOUNT OPCODE        @Y30LB02*/
         MVI   DMOPCD,X'06'                                        1764
*                 DMVOL=(VOL);      /* VALUE OF VOLID        @Y30LB02*/
         L     @14,CWBPTR                                          1765
         MVC   DMVOL(6),VOL(@14)                                   1765
*                 SVC(126);         /* INVOKE THE MSSC SVC   @Y30LB02*/
         SVC   126                                                 1766
*                 RFY                                              1767
*                   MDREG1 UNRSTD;  /* UNREST REG 1          @Y30LB02*/
*/*@ZDR2048                                                          */
*                                                                  1768
*DMTRET:                            /* LABEL FOR RETURN      @G24LB02*/
*                 SVCCALL=OFF;      /* CLEAR SVC CALL FLAG   @G24LB02*/
DMTRET   NI    SVCCALL,B'11110111'                                 1768
*                 REENTRY=SAVREENT; /* RESTORE REENTRY POINTER     1769
*                                                            @G24LB02*/
         L     @14,SAVREENT                                        1769
         ST    @14,REENTRY                                         1769
*               END;                /* END VOL NOT FOUND     @ZDR2048*/
*             ELSE                  /* VOL WAS FOUND IN VUCB @ZDR2048*/
*               R15=F12;            /* SET R15 TO ERROR VALUE      1771
*                                                            @ZDR2048*/
         B     @RC01755                                            1771
@RF01755 LA    R15,12                                              1771
*           END;                    /* END PURGE VOLID CODE  @ZDR2048*/
*         ELSE                      /*                       @ZDR2048*/
*           DO;                     /*                       @Y30LB03*/
         B     @RC01749                                            1773
@RF01749 DS    0H                                                  1774
*             PACK(PKHOSTID,HSTINCWB);/* PACK HOSTID IN CMND @Y30LB03*/
         L     @14,CWBPTR                                          1774
         PACK  PKHOSTID(7),HSTINCWB(11,@14)                        1774
*             HOST=PCKDHOST;        /* FILL IN HOST FIELD    @Y30LB03*/
         MVC   HOST(5),PCKDHOST                                    1775
*             SAVREENT=REENTRY;     /* SAVE REENTRY POINTER  @G24LB02*/
         L     @14,REENTRY                                         1776
         ST    @14,SAVREENT                                        1776
*             REENTRY=ADDR(PRGRET); /* SET NEW REENTRY PTR   @G24LB02*/
         LA    @14,PRGRET                                          1777
         ST    @14,REENTRY                                         1777
*             SVCCALL=ON;           /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 1778
*IPAIR3:                                                           1779
*                                                                  1779
*             /*******************************************************/
*             /*                                                     */
*             /* *****************************************************/
*             /* ***                                         @Y30LB02*/
*             /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO @Y30LB02*/
*             /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00     @Y30LB02*/
*             /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.    @Y30LB02*/
*             /* THE LIST FORM OF THIS MACRO SHOULD BE       @Y30LB02*/
*             /* INVOKED FIRST IN ORDER TO SET UP NECESSARY  @Y30LB02*/
*             /* DECLARES. IF THE COMPLETE ARGUMENT IS       @Y30LB02*/
*             /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.     @Y30LB02*/
*             /* *****************************************************/
*             /* ***                                         @Y30LB02*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1779
*             RFY                                                  1779
*              (PAIRR1) RSTD;       /* RESTRICT R1           @Y30LB02*/
IPAIR3   DS    0H                                                  1780
*             PAIRR1=ADDR(PURGLIST);/* SET PAIRR1 TO REQ BLOCK     1780
*                                                            @Y30LB02*/
         LA    PAIRR1,PURGLIST                                     1780
*             PURGLL='0D'X;         /* SET LENGTH FIELD      @Y30LB02*/
         LA    @14,13                                              1781
         ST    @14,PURGLL                                          1781
*             PURGOP='14'X;         /* PURG OPCODE           @Y30LB02*/
         MVI   PURGOP,X'14'                                        1782
*             PURGHOST=(HOST);      /* FILL IN HOSTID FIELD  @Y30LB02*/
         MVC   PURGHOST(5),HOST                                    1783
*             SVC(126);             /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 1784
*             RFY                                                  1785
*              (PAIRR1) UNRSTD;     /* UNRESTRICT R1         @Y30LB02
*                                                            @Y30LB03*/
*PRGRET:                            /* LABEL FOR RETURN      @G24LB02*/
*             SVCCALL=OFF;          /* CLEAR SVC CALL FLAG   @G24LB02*/
PRGRET   NI    SVCCALL,B'11110111'                                 1786
*             REENTRY=SAVREENT;     /* RESTORE REENTRY POINTER     1787
*                                                            @G24LB02*/
         L     @14,SAVREENT                                        1787
         ST    @14,REENTRY                                         1787
*           END;                    /*                       @Y30LB03*/
*       WTOMCS03=MESGS(MSG01001);   /* FILL WTO BUFFER       @Z40LB01*/
@RC01749 DS    0H                                                  1789
@RC01735 MVI   WTOMCS03+72,C' '                                    1789
         L     @14,@CA02101                                        1789
         MVC   WTOMCS03(72),MESGS-MSGS+1900(@14)                   1789
*       WTOMCS03(28:37)='          ';/*                      @Z40LB01*/
         MVC   WTOMCS03+27(10),@CC02926                            1790
*       IF R15=F0 THEN              /* GOOD RTN CODE?        @Y30LB03*/
         LTR   R15,R15                                             1791
         BNZ   @RF01791                                            1791
*         WTOMCS03(18:27)='SUCCESSFUL';/* YES,MAKE'GOOD'MSG  @Z40LB01*/
         MVC   WTOMCS03+17(10),@CC02928                            1792
*       ELSE                        /* ERROR CONDITION - REJECT OR 1793
*                                      FAILURE NEEDED        @ZDR2048*/
*         IF R15=F12 THEN           /* TEST FOR VOLID REJECT MSG   1793
*                                                            @ZDR2048*/
         B     @RC01791                                            1793
@RF01791 C     R15,@CF02050                                        1793
         BNE   @RF01793                                            1793
*           DO;                     /* VOLID REJECT MSG      @ZDR2048*/
*             WTOMCS03(18:48)='REJECTED,VVVVVV MOUNTED ON UUU ';/* 1795
*                                                            @ZDR2048*/
         MVC   WTOMCS03+17(31),@CC02930                            1795
*             WTOMCS03(27:32)=VOL;  /* FILL IN VOLID FIELD   @ZDR2048*/
         L     @14,CWBPTR                                          1796
         MVC   WTOMCS03+26(6),VOL(@14)                             1796
*             WTOMCS03(45:47)=CUUUCB;/* FILL IN UNIT ADDRESS @ZDR2048*/
         MVC   WTOMCS03+44(3),CUUUCB                               1797
*           END;                    /* END VOLID REJECT MSG CODE   1798
*                                                            @ZDR2048*/
*         ELSE                      /* NO,MAKE FAILUR MSG    @Y30LB03*/
*           DO;                     /*                       @Y30LB03*/
         B     @RC01793                                            1799
@RF01793 DS    0H                                                  1800
*             RESPECIFY                                            1800
*               R0 RSTD;            /* RSTD REG 0            @Y30LB03*/
*             INTER=R0;             /*                       @Y30LB03*/
         ST    R0,INTER                                            1801
*             CALL ICBMSG82;        /* CALL SUBRTN TO        @Y30LB03
*                                      CONVERT REAS CODE     @Y30LB03*/
         BAL   @14,ICBMSG82                                        1802
*             RESPECIFY                                            1803
*               R0 UNRSTD;          /* RELEASE REG 0         @Y30LB03*/
*             WTOMCS03(18:37)='FAILED,REAS CODE=   ';/* MAKE BAD   1804
*                                      MSG@Z40LB01                   */
         MVC   WTOMCS03+17(20),@CC02933                            1804
*             WTOMCS03(35:37)=BYTES234;/* PUT IN REAS CODE   @Z40LB01*/
         MVC   WTOMCS03+34(3),BYTES234                             1805
*           END;                    /*                       @Y30LB03*/
*       IF CWBVBCDE=140 THEN        /* ASSIGN REQUEST?       @Y30LB03*/
@RC01793 DS    0H                                                  1807
@RC01791 L     @14,CWBPTR                                          1807
         CLI   CWBVBCDE(@14),140                                   1807
         BNE   @RF01807                                            1807
*         WTOMCS03(11:16)='ASSIGN'; /* YES,PUT IN MSG        @Z40LB01*/
         MVC   WTOMCS03+10(6),@CC02935                             1808
*       ELSE                        /* NO,...                @Y30LB03*/
*         WTOMCS03(11:16)='PURGE '; /* PUT 'PURGE'           @Z40LB01
*                                      IN MSG FOR OPER       @Y30LB03*/
         B     @RC01807                                            1809
@RF01807 MVC   WTOMCS03+10(6),@CC02936                             1809
*       RESPECIFY                                                  1810
*         R15 UNRSTD;               /* RELEASE REG 15        @Y30LB03*/
@RC01807 DS    0H                                                  1811
*       CALL ICBMSG44;              /* CALL SUBRTN TO        @Y30LB03
*                                      DEQ THE CWB           @Y30LB03*/
         BAL   @14,ICBMSG44                                        1811
*PAWTOL:                            /* FILL IN MSG           @Z40LB01*/
*       CALL ICBMSG47;              /* ISSUE WTO MACRO       @Y30LB03*/
PAWTOL   BAL   @14,ICBMSG47                                        1812
*       CALL ICBMSG46;              /* CALL SUBRTN TO        @Y30LB03
*                                      FREE WORKAREA         @Y30LB03*/
         BAL   @14,ICBMSG46                                        1813
*     END;                          /*                       @ZM01013*/
*   RFY                                                            1815
*     R14 RSTD;                     /*                       @G24LB02*/
@RC01727 DS    0H                                                  1816
*   R14=SAVR1442;                   /* RESTORE REG14         @Y30LB03*/
         L     R14,SAVR1442                                        1816
*   RFY                                                            1817
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG40       @Y30LB03*/
@EL00017 DS    0H                                                  1818
@EF00017 DS    0H                                                  1818
@ER00017 BR    @14                                                 1818
*   END ICBMSG42;                   /*                       @Y30LB03*/
*                                                                  1820
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG43                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = HALT S COMMAND (SUSPEND) PROCESSING  @ZM31054
*                        SUBROUTINE                           @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = ISSUE ICBSUSP MACRO FOR COMTASK              @Y30LB03
*                HALT S COMMANDS                              @ZM31054
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = SET UP ICBSUSP PARAMETERS AND ISSUE THE       @Y30LB03
*               MACRO. INTEROGATE RETURN CODE. SET UP         @Y30LB03
*               SUCCESSFUL/UNSUCCESSFUL WTO MESSAGE AND       @Y30LB03
*               CALL WTO SUBROUTINE(ICBMSG47). CALL DEQUEUE   @Y30LB03
*               SUBROUTINE(ICBMSG44) AND THE FREEMAIN         @Y30LB03
*               SUBROUTINE(ICBMSG46). IF THE RETURN CODE      @Y30LB03
*               INDICATES THAT THE HALT (S) PROCESSING        @Y30LB03
*               WAS SUCCESSFUL, THEN THE INITIALIZED          @Y30LB03
*               AND READY BITS (ICBI AND ICBR) IN THE         @Y30LB03
*               MSSC CONTROL BLOCK, ICB2SSCB, ARE SET TO ZERO.@Y30LB03
*                                                             @Y30LB03
*02*    INPUT = COMTASK HALT COMMAND                          @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = PROCESSED COMTASK HALT COMMAND               @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1820
*ICBMSG43:                                                         1820
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG43 DS    0H                                                  1821
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*   THIS SUBROUTINE HANDLES REQUESTS FOR THE SUSPEND       @Y30LB03*/
*/*    ORDER.                                                @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1821
*   DCL                                                            1821
*     SUSPCOMP FIXED(31);           /* RETURN SAVE           @G24LB02*/
*   SUSPCOMP=''B;                   /* CLEAR SAVE AREA       @G24LB02*/
         SLR   @12,@12                                             1822
         ST    @12,SUSPCOMP                                        1822
*   RFY                                                            1823
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1443=R14;                   /* SAVE REG 14           @Y30LB03*/
         ST    R14,SAVR1443                                        1824
*   RFY                                                            1825
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RECOVER(6)=BONE;                /* SET RECOVERY BIT      @Y30LB03
*                                      FOR SUSPEND (HALT)    @Y30LB03*/
         OI    RECOVER,B'00000100'                                 1826
*   SUSPFLG=''B;                    /* CLEAR SUSPEND FLAGS   @ZD00155*/
         XC    SUSPFLG(2),SUSPFLG                                  1827
*   IF CWBCMND(3:6)='SNAP' THEN     /* SUSPEND SNAP ?        @Y30LB03*/
         L     @12,CWBPTR                                          1828
         CLC   CWBCMND+2(4,@12),@CC02943                           1828
         BNE   @RF01828                                            1828
*     SUPIMED=BONE;                 /* SUSPEND IMMEDIATE     @ZD00155*/
         OI    SUPIMED,B'10000000'                                 1829
*   ELSE                            /* CHECK ANOTHER OPTN    @Y30LB03*/
*     IF CWBCMND(3:6)='LONG' THEN   /* SUSPEND LONG ?        @Y30LB03*/
         B     @RC01828                                            1830
@RF01828 L     @12,CWBPTR                                          1830
         CLC   CWBCMND+2(4,@12),@CC02944                           1830
         BNE   @RF01830                                            1830
*       DO;                         /*                       @G24LB02*/
*         SUPRCON=BONE;             /* RECONFIGURATION       @ZD00155*/
         OI    SUPRCON,B'01000000'                                 1832
*         SUSPLONG=BONE;            /* SET SUSP LONG FLAG    @G24LB02*/
         OI    SUSPLONG,B'00100000'                                1833
*       END;                        /*                       @G24LB02*/
*     ELSE                          /* IF NONE,ERROR         @Y30LB03*/
*       DO;                         /* SYNTAX ERROR MSG      @Y30LB03*/
         B     @RC01830                                            1835
@RF01830 DS    0H                                                  1836
*         WTOMCS03=MESGS(MSG31401); /*                       @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    1836
         L     @12,@CA02101                                        1836
         MVC   WTOMCS03(72),MESGS-MSGS+2660(@12)                   1836
*         CALL ICBMSG47;            /* CALL WTO SUBRTN       @Y30LB03*/
         BAL   @14,ICBMSG47                                        1837
*         GO TO SPDQFREE;           /* BRCH TO DQ & FREE     @Y30LB03*/
         B     SPDQFREE                                            1838
*       END;                        /*                       @Y30LB03*/
*ISUSPD1:                           /*                       @Z40LB01*/
*   WTOMCS03=MESGS(MSG01001);       /* FILL WTO BUFFER       @Z40LB01*/
@RC01830 DS    0H                                                  1840
@RC01828 DS    0H                                                  1840
ISUSPD1  MVI   WTOMCS03+72,C' '                                    1840
         L     @12,@CA02101                                        1840
         MVC   WTOMCS03(72),MESGS-MSGS+1900(@12)                   1840
*   WTOMCS03(28:37)='          ';   /*                       @Z40LB01*/
         MVC   WTOMCS03+27(10),@CC02926                            1841
*   SAVREENT=REENTRY;               /* SAVE REENTRY POINTER  @G24LB02*/
         L     @12,REENTRY                                         1842
         ST    @12,SAVREENT                                        1842
*   REENTRY=ADDR(SUSRET);           /* SET NEW REENTRY       @G24LB02*/
         LA    @12,SUSRET                                          1843
         ST    @12,REENTRY                                         1843
*   SVCCALL=ON;                     /* SET SVC CALL FLAG     @G24LB02*/
*                                                                  1844
         OI    SVCCALL,B'00001000'                                 1844
*   /*****************************************************************/
*   /*                                                               */
*   /* *******************************************************       */
*   /*                                                       @Y30LB02*/
*   /* MACMEAN MSSC SUSPEND MACRO                            @Y30LB02*/
*   /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00               @Y30LB02*/
*   /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.              @Y30LB02*/
*   /* THE LIST FORM OF THIS MACRO SHOULD BE                 @Y30LB02*/
*   /* INVOKED FIRST IN ORDER TO SET UP NECESSARY            @Y30LB02*/
*   /* DECLARES. IF THE COMPLETE ARGUMENT IS                 @Y30LB02*/
*   /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.               @Y30LB02*/
*   /* *******************************************************       */
*   /*                                                       @Y30LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1845
*   RFY                                                            1845
*    (SUSPR1) RSTD;                 /* RESTRICT REG1         @Y30LB02*/
*   SUSPR1=ADDR(SUSPLIST);          /* R1 POINTER TO REQUEST BLOCK 1846
*                                                            @Y30LB02*/
         LA    SUSPR1,SUSPLIST                                     1846
*   SUSPLEN='8'X;                   /* LENGTH OF SUSPEND REQUEST   1847
*                                                            @Y30LB02*/
         LA    @12,8                                               1847
         ST    @12,SUSPLEN                                         1847
*   SUSPOP='22'X;                   /* SUSPEND OPCODE        @Y30LB02*/
         MVI   SUSPOP,X'22'                                        1848
*   SVC(126);                       /* INVOKE SVC 126        @Y30LB02*/
         SVC   126                                                 1849
*   RFY                                                            1850
*     SUSPR1 UNRSTD;                /* UNRESTRICT REG 1      @Y30LB02
*                                      ISSUE SUSPEND         @ZD00155*/
*   RESPECIFY                                                      1851
*    (R0,                                                          1851
*     R15) RSTD;                    /*                       @G24LB02*/
*SUSRET:                            /* LABEL FOR RETURN      @G24LB02*/
*   SVCCALL=OFF;                    /* CLEAR SVC CALL FLAG   @G24LB02*/
SUSRET   NI    SVCCALL,B'11110111'                                 1852
*   REENTRY=SAVREENT;               /* RESTORE REENTRY POINTER     1853
*                                                            @G24LB02*/
         L     @14,SAVREENT                                        1853
         ST    @14,REENTRY                                         1853
*   SUSPCOMP=R15;                   /* SAVE RETURN           @G24LB02*/
         ST    R15,SUSPCOMP                                        1854
*   IF R15=F0R0='F7'X THEN         /* GOOD RTN CODE?        @Y30LB03*/
         LTR   R15,R15                                             1855
         BZ    @RT01855                                            1855
         C     R0,@CF02951                                         1855
         BNE   @RF01855                                            1855
@RT01855 DS    0H                                                  1856
*     DO;                           /*                       @Y30LB03*/
*       RESPECIFY                                                  1857
*        (R0,                                                      1857
*         R15) UNRSTD;              /*                       @G24LB02*/
*                                                                  1857
*       /*************************************************************/
*       /*                                                           */
*       /* ******************************                    @Y30LB03*/
*       /* YES,PREPARE SUCCESSFUL MSG                        @Y30LB03*/
*       /* AND TURN OFF INITIALIZED AND                      @Y30LB03*/
*       /* READY BITS                                        @Y30LB03*/
*       /* ******************************                    @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1858
*       WTOMCS03(18:27)='SUCCESSFUL';/*                      @Z40LB01*/
         MVC   WTOMCS03+17(10),@CC02928                            1858
*       ICBS=ON;                    /* SET MSSC SUSPEND FLAG @G24LB02*/
*       ICBB=ON;                    /* SET BROKEN BOX INDICATOR    1860
*                                                            @G24LB02*/
*       ICBR=OFF;                   /* SET READY FLAG OFF    @G24LB02*/
*       ICBI=OFF;                   /* INIT INDICATOR SET OFF      1862
*                                                            @G24LB02*/
         L     @12,ICBPTR                                          1862
         OI    ICBS(@12),B'00011000'                               1862
         NI    ICBR(@12),B'00111111'                               1862
*       RECOVER=''B;                /* CLEAR COMTASK RECOVERY BITS 1863
*                                                            @G24LB02*/
         MVI   RECOVER,X'00'                                       1863
*       SUSPCOMP=F0;                /* CLEAR RETURN CODE     @G24LB02*/
         SLR   @09,@09                                             1864
         ST    @09,SUSPCOMP                                        1864
*       REENTRY=ADDR(INITBEG);      /* SET REENTRY           @G24LB02*/
         LA    @09,INITBEG                                         1865
         ST    @09,REENTRY                                         1865
*       INITFLAG=OFF;               /* CLEAR FLAG FOR FSENTRY LOOP 1866
*                                                            @G24LB02*/
*                                                                  1866
         NI    INITFLAG,B'11110111'                                1866
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP FOR SVC 91                                 @YD00167*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1867
*       RESPECIFY                                                  1867
*        (R0,                                                      1867
*         R1) RSTD;                 /*                       @YD00167*/
*       R0=ICBPUCB;                 /* LOAD REG 0 W/ PRIM UCB ADDR 1868
*                                                            @YD00167*/
         L     R0,ICBPUCB(,@12)                                    1868
*       GEN;                                                       1869
*                                                          /*@YD00167*/
         LCR   R0,R0                LOAD COMPLEMENT            @YD00167
*       R1=R1COMPL;                 /*                       @YD00167*/
         L     R1,@CF02463                                         1870
*       SVC(91);                    /* ISSUE SVC 91 TO OFFLOAD     1871
*                                      BUFFERED LOG DATA     @YD00167*/
         SVC   91                                                  1871
*       RESPECIFY                                                  1872
*        (R0,                                                      1872
*         R1) UNRSTD;               /*                       @YD00167*/
*     END;                          /*                       @Y30LB03*/
*   ELSE                            /* NO,MAKE FAILUR MSG    @Y30LB03*/
*     DO;                           /*                       @Y30LB03*/
         B     @RC01855                                            1874
@RF01855 DS    0H                                                  1875
*       RESPECIFY                                                  1875
*         R0 RSTD;                  /* RSTD REG 0            @Y30LB03*/
*       INTER=R0;                   /* FILL IN REAS CD       @Y30LB03*/
*                                                                  1876
         ST    R0,INTER                                            1876
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SUBROUTINE TO CONVERT REAS CODE              @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1877
*       CALL ICBMSG82;              /*                       @Y30LB03*/
         BAL   @14,ICBMSG82                                        1877
*       RESPECIFY                                                  1878
*         R0 UNRSTD;                /* RELEASE REG 0         @Y30LB03*/
*       WTOMCS03(18:37)='FAILED,REAS CODE=   ';/* MAKE BAD         1879
*                                      MSG@Z40LB01                   */
         MVC   WTOMCS03+17(20),@CC02933                            1879
*       WTOMCS03(35:37)=BYTES234;   /* PUT IN REAS CODE      @Z40LB01*/
         MVC   WTOMCS03+34(3),BYTES234                             1880
*     END;                          /*                       @Y30LB03*/
*   WTOMCS03(11:16)='HALT S';       /*                       @Z40LB01*/
@RC01855 MVC   WTOMCS03+10(6),@CC02953                             1882
*   CALL ICBMSG47;                  /* CALL WTO(MCS) SUBRTN  @Y30LB03*/
         BAL   @14,ICBMSG47                                        1883
*/********************************************************   @Y30LB03*/
*/* DEQUEUE AND FREE SUSPEND COMMAND WORK BLOCK              @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1884
*SPDQFREE:                          /*                       @Y30LB03*/
*   CALL ICBMSG44;                  /* CALL DEQ SUBRTN       @Y30LB03*/
SPDQFREE BAL   @14,ICBMSG44                                        1884
*SPFREEL:                                                          1885
*   CALL ICBMSG46;                  /* CALL FREEMN SBRTN     @Y30LB03*/
SPFREEL  BAL   @14,ICBMSG46                                        1885
*   RFY                                                            1886
*     R14 RSTD;                     /*                       @G24LB02*/
*   IF SUSPCOMP=F0 THEN             /*                       @G24LB02*/
         L     @15,SUSPCOMP                                        1887
         LTR   @15,@15                                             1887
         BNZ   @RF01887                                            1887
*     DO;                           /*                       @G24LB02*/
*       R14=REENTRY;                /*                       @G24LB02*/
         L     R14,REENTRY                                         1889
*     END;                          /*                       @G24LB02*/
*   ELSE                            /*                       @G24LB02*/
*     R14=SAVR1443;                 /*                       @G24LB02*/
         B     @RC01887                                            1891
@RF01887 L     R14,SAVR1443                                        1891
*   RFY                                                            1892
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG40       @Y30LB03*/
@EL00018 DS    0H                                                  1893
@EF00018 DS    0H                                                  1893
@ER00018 BR    @14                                                 1893
*   END ICBMSG43;                   /*                       @Y30LB03*/
         B     @EL00018                                            1894
*                                                                  1895
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG44                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = DEQUEUE SUBROUTINE                   @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = DEQUEUE COMMAND WORK AREA                    @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = TO DEQUEUE THE COMMAND WORK BUFFER            @Y30LB03
*               FROM QUEUE OF WORK AREA ELEMENTS.             @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = POINTER TO COMMAND WORK BUFFER TO BE DEQUEUED @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = WORK AREA DEQUEUED FROM THE WORK AREA QUEUE  @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1895
*ICBMSG44:                                                         1895
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG44 DS    0H                                                  1896
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE DEQUEUES THE COMTASK CWB.             @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1896
*   RFY                                                            1896
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1444=R14;                   /*                       @Z307B04*/
         ST    R14,SAVR1444                                        1897
*   RFY                                                            1898
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   GEN;                                                           1899
*                                                          /*@Y30LB03*/
IGETLCL3 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @Y30LB03*
               RELATED=(LOCALLOCK,ICB2MSG(IFRELCL3)),REGS=USE  @Y30LB03
IGTCMS2  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                  @Y30LB03*
               RELATED=(CMSLOCK,ICB2MSG(IFRECMS2)),REGS=USE    @Y30LB03
*   LOCKRCVY(1:2)=B2ONE;            /* SET LOCAL & CMS LOCK BITS   1900
*                                                            @Y30LB03*/
         OI    LOCKRCVY,B'11000000'                                1900
*   RESPECIFY                                                      1901
*     R2 RSTD;                      /* RESTRICT REG 2        @Y30LB03*/
*   R2=CWBPTR;                      /* SET R2-->COMWKAREA    @Y30LB03*/
         L     @12,CWBPTR                                          1902
         LR    R2,@12                                              1902
*   ICBCOMQ=CWBCHAIN;               /* SET TO NEW WK AREA    @Y30LB03*/
         L     @09,ICBPTR                                          1903
         L     @12,CWBCHAIN(,@12)                                  1903
         ST    @12,ICBCOMQ(,@09)                                   1903
*   IF ICBCOMQ=F0 THEN              /* END OF CHAIN?         @Y30LB03*/
         SLR   @04,@04                                             1904
         CR    @12,@04                                             1904
         BNE   @RF01904                                            1904
*     ICBCOM=F0;                    /* CLEAR COMTASK ECB     @Y30LB03*/
         ST    @04,ICBCOM(,@09)                                    1905
*   RECOVER(2)=BONE;                /* SET RECOVERY BIT      @Y30LB03*/
@RF01904 OI    RECOVER,B'01000000'                                 1906
*   GEN;                                                           1907
*                                                          /*@Y30LB03*/
IFRECMS2 SETLOCK RELEASE,TYPE=CMS,                             @Y30LB03*
               RELATED=(LOCALLOCK,ICB2MSG(IGTCMS2)),REGS=USE   @Y30LB03
IFRELCL3 SETLOCK RELEASE,TYPE=LOCAL,                           @Y30LB03*
               RELATED=(LOCALLOCK,ICB2MSG(IGETLCL3)),REGS=USE  @Y30LB03
*   RESPECIFY                                                      1908
*     R2 UNRSTD;                    /*                       @Y30LB03*/
*   LOCKRCVY(1:2)=B2ZERO;           /* SET LOCAL & CMS LOCK BITS   1909
*                                                            @Y30LB03*/
         NI    LOCKRCVY,B'00111111'                                1909
*   RECOVER(2)=BONE;                /* SET RECOVERY BIT      @Y30LB03
*                                      FOR DQ'D              @Y30LB03*/
         OI    RECOVER,B'01000000'                                 1910
*   RFY                                                            1911
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1444;                   /*                       @Z307B04*/
         L     R14,SAVR1444                                        1912
*   RFY                                                            1913
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00019 DS    0H                                                  1914
@EF00019 DS    0H                                                  1914
@ER00019 BR    @14                                                 1914
*   END ICBMSG44;                   /*                       @Y30LB03*/
*                                                                  1916
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG45                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = WTO SUBROUTINE (GENERAL)             @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = WRITE TO OPERATOR (ON MASTER CONSOLE)        @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = TO WRITE MESSAGES TO THE OPERATOR             @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = MESSAGE TO BE WRITTEN TO OPERATOR             @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = MESSAGE WRITTEN TO OPERATOR                  @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1916
*ICBMSG45:                                                         1916
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG45 DS    0H                                                  1917
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE ISSUES THE WTO COMMAND RESPONSE.      @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1917
*   RFY                                                            1917
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1445=R14;                   /* SAVE CALLERS REGISTER 14    1918
*                                                            @Z307B04*/
         ST    R14,SAVR1445                                        1918
*   RFY                                                            1919
*     R14 UNRSTD;                   /*                       @G24LB02*/
*IWTO1:                                                            1920
*   DO;                             /* WTOP MF(E,WTOGEN) RTCD(R15)   */
IWTO1    DS    0H                                                  1921
*     RFY                                                          1921
*       GPR01P RSTD;                /* RESTRICT REG 1                */
*     GPR01P=ADDR(WTOGEN);          /* ADDRESS CONTROL PROGRAM LIST  */
         LA    GPR01P,WTOGEN                                       1922
*     SVC(35);                      /* ISSUE WTO SVC                 */
         SVC   35                                                  1923
*     RFY                                                          1924
*       GPR15F RSTD;                /* RESTRICT REG 15               */
*     R15=GPR15F;                   /* SAVE SVC RETURN CODE          */
*     RFY                                                          1926
*       GPR15F UNRSTD;              /* RELEASE REG 15                */
*     RFY                                                          1927
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */
*   END;                            /* WTOP MF(E,WTOGEN) RTCD(R15) 1928
*                                                            @Y30LB03*/
*   RFY                                                            1929
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1445;                   /* RESTORE CALLERS REGISTER 14 1930
*                                                            @Z307B04*/
         L     R14,SAVR1445                                        1930
*   RFY                                                            1931
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00020 DS    0H                                                  1932
@EF00020 DS    0H                                                  1932
@ER00020 BR    @14                                                 1932
*   END ICBMSG45;                   /*                       @Y30LB03*/
*                                                                  1934
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG46                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = FREEMAIN SUBROUTINE                  @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = FREE CORE FOR COMMAND WORK AREA              @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = TO FREE THE CORE FOR THE DEQUEUED WORK AREA   @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = POINTER TO COMMAND WORK BUFFER TO BE FREED    @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = FREED CORE (FOR COMMAND WORK AREA)           @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1934
*ICBMSG46:                                                         1934
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG46 DS    0H                                                  1935
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    THIS SUBROUTINE ISSUES THE FREEMAIN MACRO FOR         @Y30LB03*/
*/*    THE DEQ'D COMTASK CWB.                                @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  1935
*   DCL                                                            1935
*     SBPOL CHAR(1);                /* SUBPOOL               @Y30LB03*/
*   RESPECIFY                                                      1936
*    (R2,                                                          1936
*     R14) RSTD;                    /* RESTRICT REG 2        @G24LB02*/
*   SAVR1446=R14;                   /* SAVE CALLERS REGISTER 14    1937
*                                                            @Z307B04*/
         ST    R14,SAVR1446                                        1937
*   R2=CWBPTR;                      /* SET R2 -> CWB         @Y30LB03*/
         L     @15,CWBPTR                                          1938
         LR    R2,@15                                              1938
*   SBPOL=CWBSBPOL;                 /* SET SUBPOOL FOR       @Y30LB03
*                                      FREEMAIN              @Y30LB03*/
         MVC   SBPOL(1),CWBSBPOL(@15)                              1939
*/*********************************************************  @Y30LB03*/
*/* ISSUE FREEMAIN FOR COM WORK AREA                         @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  1940
*   GEN;                                                           1940
*                                                          /*@Y30LB03*/
          SR    R3,R3               ZERO REG 3                 @Y30LB03
          IC    R3,SBPOL            PUT SBPOL IN LOW BYTE      @Y30LB03
IFREEMN3  FREEMAIN R,LV=136,A=(R2),SP=(R3) ISSUE FREEMAIN      @Y30LB03
*   RESPECIFY                                                      1941
*     R2 UNRSTD;                    /* RELEASE REG 2         @Y30LB03*/
*   RECOVER(3)=BONE;                /* SET RECOVERY BIT      @Y30LB03
*                                      FOR FREED             @Y30LB03*/
         OI    RECOVER,B'00100000'                                 1942
*   R14=SAVR1446;                   /* RESTORE CALLERS REGISTER 14 1943
*                                                            @Z307B04*/
         L     R14,SAVR1446                                        1943
*   RFY                                                            1944
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00021 DS    0H                                                  1945
@EF00021 DS    0H                                                  1945
@ER00021 BR    @14                                                 1945
*   END ICBMSG46;                   /*                       @Y30LB03*/
*                                                                  1947
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************************** @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1947
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG47                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = WTO SUBROUTINE (MCS)                 @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = WRITE TO OPERATOR (IN RESPONSE TO COMTASK    @Y30LB03
*                COMMANDS)                                    @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = TO WRITE MESSAGES TO THE OPERATOR             @Y30LB03
*                                                             @Y30LB03
*02*    LINKAGE = CALL                                        @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = MESSAGE TO BE WRITTEN TO OPERATOR             @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = MESSAGE WRITTEN TO OPERATOR                  @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1947
*ICBMSG47:                                                         1947
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG47 DS    0H                                                  1948
*/* ***********************************************          @Y30LB03*/
*/*   INSERT CONSOLE ID (CWBUCMID) INTO R0                   @Y30LB03*/
*/* ***********************************************          @Y30LB03*/
*                                                                  1948
*   RFY                                                            1948
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1447=R14;                   /* SAVE CALLERS REGISTER 14    1949
*                                                            @Z307B04*/
         ST    R14,SAVR1447                                        1949
*   RFY                                                            1950
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   GEN REFS(CWBPTR,CWBUCMID);                                     1951
*                                                          /*@Y30LB03*/
         L     R15,CWBPTR           LOAD R15 WITH PTR          @Y30LB03
         IC    R0,CWBUCMID(R15)     INSERT CONSOLE ID,R0       @Y30LB03
*IWTO4:                                                            1952
*   DO;                             /* WTOP MF(E,WTOMCS) RTCD(R15)   */
IWTO4    DS    0H                                                  1953
*     RFY                                                          1953
*       GPR01P RSTD;                /* RESTRICT REG 1                */
*     GPR01P=ADDR(WTOMCS);          /* ADDRESS CONTROL PROGRAM LIST  */
         LA    GPR01P,WTOMCS                                       1954
*     SVC(35);                      /* ISSUE WTO SVC                 */
         SVC   35                                                  1955
*     RFY                                                          1956
*       GPR15F RSTD;                /* RESTRICT REG 15               */
*     R15=GPR15F;                   /* SAVE SVC RETURN CODE          */
*     RFY                                                          1958
*       GPR15F UNRSTD;              /* RELEASE REG 15                */
*     RFY                                                          1959
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */
*   END;                            /* WTOP MF(E,WTOMCS) RTCD(R15) 1960
*                                                            @Z40LB01*/
*   RFY                                                            1961
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1447;                   /* RESTORE CALLERS REGISTER 14 1962
*                                                            @Z307B04*/
         L     R14,SAVR1447                                        1962
*   RFY                                                            1963
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00022 DS    0H                                                  1964
@EF00022 DS    0H                                                  1964
@ER00022 BR    @14                                                 1964
*   END ICBMSG47;                   /*                       @Y30LB03*/
*                                                                  1966
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG49                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = MSC VARY SUBROUTINE                  @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = HANDLES MSC VARIES IF A COMTASK VARY         @Y30LB03
*                IS FOR THE PRIMARY OR ALTERNATE MSC          @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*  PURPOSE = TO CHECK THE UNIT (BEING VARIED) TO DETERMINE @Y30LB03
*               IF IT IS THE PRIMARY OR ALTERNATE MSC. AND,IF @Y30LB03
*               IT IS, TO PERFORM THE NECESSARY PROCESSING TO @Y30LB03
*               VARY THE MSC. IF THE PRIMARY MSC IS TO BE     @Y30LB03
*               VARIED OFFLINE AND THERE IS NO ALTERNATE MSC  @Y30LB03
*               ONLINE THE OPERATOR IS CONTACTED VIA WTOR TO  @Y30LB03
*               DETERMINE IF THE PROCESSING IS TO CONTINUE.   @Y30LB03
*               FINALLY, A WTO MESSAGE IS BUILT TO DESCRIBE   @Y30LB03
*               THE FINAL STATUS OF THE VARY PROCESSING.      @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = COMTASK VARY S COMMAND THAT CONTAINS THE      @Y30LB03
*               KEYWORD '3851'                                @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = IF IT WAS A MSC UNIT, SPECIAL (VARY)         @Y30LB03
*                PROCESSING TO VARY THE MSC.                  @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  1966
*ICBMSG49:                                                         1966
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG49 DS    0H                                                  1967
*   DCL                                                            1967
*     PRIMSWTH FIXED(8);            /* IF 1, PRIMARY MSC BEING VARIED
*                                                            @Y30LB03*/
*/*  SMF VARY ON/OFF RECORD (VARIABLE DATA FIELD)            @Y30LB03*/
*                                                                  1968
*   DCL                                                            1968
*     DVCLUNTP CHAR(2) DEF(UCBTBYT3);/* DEVICE CLASS, UNIT   @Y30LB03
*                                      TYPE,FOR SMF RECORD   @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/* A WTOR IS PRINTED WHEN THE VARY IS FOR THE PRIMARY MSC,  @Y30LB03*/
*/* AND, THE UCBONLINE BIT FOR THE ALT. MSC SAYS THAT IT IS  @Y30LB03*/
*/* OFFLINE. THE OPERATOR IS INFORMED VIA THE WTOR MESSAGE.  @Y30LB03*/
*/* IF CONTINUE IS SPECIFIED, SVC 91 IS ISSUED TO OFFLOAD    @Y30LB03*/
*/* MSS BUFFERED LOG DATA.                                   @Y30LB03*/
*/*THIS FIELD IS SPECIFIED ON THE WTOR, AND WILL CONTAIN     @Y30LB03*/
*/*OPERATOR'S REPLY.IF U IS SPECIFIED, VARY PROCESSING       @Y30LB03*/
*/* CONTINUES OTHERWISE THE VARY IS CANCELLED.               @Y30LB03*/
*                                                                  1969
*   /*****************************************************************/
*   /*                                                               */
*   /* *************************************************     @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1969
*   DCL                                                            1969
*     1 OFFRPLY CHAR(6),            /* REPLY FIELD FOR WTOR  @Y30LB03*/
*      2 REPLYU CHAR(1),            /* THIS IS U IF DEFAULT TAKEN, 1969
*                                                            @Y30LB03
*                                      (I.E. TO CONTINUE)    @Y30LB03*/
*      2 * CHAR(5);                 /* FILLED WHEN 'CANCEL' GIVEN  1969
*                                                            @Y30LB03*/
*   DCL                                                            1970
*     CHARA4 BIT(8) CONSTANT('A4'X);/* HEX 'A4'              @Y30LB03*/
*   DCL                                                            1971
*     CHARE4 BIT(8) CONSTANT('E4'X);/* HEX 'E4'              @Y30LB03*/
*   DCL                                                            1972
*     ALTONLIN FIXED(8) INIT(0);    /* SWITCH THAT WILL BE   @Y30LB03
*                                      SET IF ALTERNATE MSC  @Y30LB03
*                                      IS ONLINE             @Y30LB03*/
*   RFY                                                            1973
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1449=R14;                   /*                       @Y30LB03*/
         ST    R14,SAVR1449                                        1974
*   RFY                                                            1975
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   IF ONOFF='ON' THEN              /* VARY ON?              @G24LB02*/
         CLC   ONOFF(2),@CC02863                                   1976
         BNE   @RF01976                                            1976
*     DO;                           /*                       @G24LB02*/
*       SMF09PTR=ADDR(SMFAREA);     /*                       @G24LB02*/
         LA    @12,SMFAREA                                         1978
         ST    @12,SMF09PTR                                        1978
*       RFY                                                        1979
*         SMF9DVAD BASED(SMF09PTR+LENGTH(SMFRCD09));/*       @G24LB02*/
*       SMFRCD09=''B;               /* CLEAR PARM LIST       @G24LB02*/
         XC    SMFRCD09(20,@12),SMFRCD09(@12)                      1980
*       SMF9LEN='18'X;              /* LENGTH OF PARM LIST   @G24LB02*/
         LA    @09,24                                              1981
         STH   @09,SMF9LEN(,@12)                                   1981
*       SMF9RTY='09'X;              /* TYPE VARY ON          @G24LB02*/
         MVI   SMF9RTY(@12),X'09'                                  1982
*       SMF9LENN='06'X;             /* LENGTH OF VAR DATA    @G24LB02*/
         LA    @09,6                                               1983
         STH   @09,SMF9LENN(,@12)                                  1983
*       SMF9DUT=DVCLUNTP;           /* DEV CLASS, UNIT TYPE  @G24LB02*/
         AL    @12,@CF01407                                        1984
         L     @09,UCBPTR                                          1984
         MVC   SMF9DUT(2,@12),DVCLUNTP(@09)                        1984
*       SMF9CUA=SSIDADDR;           /* CHANNEL, UNIT ADDRESS @G24LB02*/
         MVC   SMF9CUA(2,@12),SSIDADDR                             1985
*     END;                          /*                       @G24LB02*/
*   ELSE                            /* VARY OFF .....        @G24LB02*/
*     DO;                           /*                       @G24LB02*/
         B     @RC01976                                            1987
@RF01976 DS    0H                                                  1988
*       SMF11PTR=ADDR(SMFAREA);     /*                       @G24LB02*/
         LA    @12,SMFAREA                                         1988
         ST    @12,SMF11PTR                                        1988
*       RFY                                                        1989
*         SMF11DEV BASED(SMF11PTR+LENGTH(SMFRCD11));/*       @G24LB02*/
*       SMFRCD11=''B;               /* CLEAR PARM LIST       @G24LB02*/
         XC    SMFRCD11(20,@12),SMFRCD11(@12)                      1990
*       SMF11LEN='18'X;             /* LENGTH OF PARM LIST   @G24LB02*/
         LA    @09,24                                              1991
         STH   @09,SMF11LEN(,@12)                                  1991
*       SMF11RTY='0B'X;             /* TYPE VARY OFF         @G24LB02*/
         MVI   SMF11RTY(@12),X'0B'                                 1992
*       SMF11LN='06'X;              /* LENGTH OF VAR DATA    @G24LB02*/
         LA    @09,6                                               1993
         STH   @09,SMF11LN(,@12)                                   1993
*       SMF11DUT=DVCLUNTP;          /* DEV CLASS, UNIT TYPE  @G24LB02*/
         AL    @12,@CF01407                                        1994
         L     @09,UCBPTR                                          1994
         MVC   SMF11DUT(2,@12),DVCLUNTP(@09)                       1994
*       SMF11CUA=SSIDADDR;          /* CHANNEL, UNIT ADDRESS @G24LB02*/
         MVC   SMF11CUA(2,@12),SSIDADDR                            1995
*     END;                          /*                       @G24LB02*/
*   DSDSWTH=F0;                     /* 0 MSC SWITCH          #Y30LB03*/
@RC01976 MVI   DSDSWTH,X'00'                                       1997
*   PRIMSWTH=F1;                    /* INIT PRIMARY MSC SWITCH     1998
*                                                            @Y30LB03*/
         MVI   PRIMSWTH,X'01'                                      1998
*   ALTONLIN=F0;                    /* INIT ALT-ONLINE SWTCH @Y30LB03*/
         MVI   ALTONLIN,X'00'                                      1999
*   UCBPTR=ICBPUCB;                 /* INIT UCBPTR           @Y30LB03*/
         L     @12,ICBPTR                                          2000
         L     @09,ICBPUCB(,@12)                                   2000
         ST    @09,UCBPTR                                          2000
*   IF UCBNAME^=RU THEN             /* IS IT THE PRIMARY MSC?      2001
*                                                            @ZA13491*/
         L     @04,CWBVREF                                         2001
         CLC   UCBNAME(3,@09),RU(@04)                              2001
         BE    @RF02001                                            2001
*     DO;                           /* NO, THEN              @Y30LB03*/
*       IF ICBAUCB^=F0 THEN         /* DOES AN ALT MSC EXIST?      2003
*                                                            @Y30LB03*/
         L     @12,ICBAUCB(,@12)                                   2003
         LTR   @12,@12                                             2003
         BZ    @RF02003                                            2003
*         UCBPTR=ICBAUCB;           /* DEFINE UCBPTR         @Y30LB03*/
         ST    @12,UCBPTR                                          2004
*       PRIMSWTH=F0;                /* TURN OFF PRIMARY SWTCH      2005
*                                                            @Y30LB03*/
@RF02003 MVI   PRIMSWTH,X'00'                                      2005
*     END;                          /*                       @Y30LB03*/
*   IF UCBNAME=RU THEN              /* IS IT A VARY FOR A MSC?     2007
*                                                            @ZA13491*/
@RF02001 L     @12,UCBPTR                                          2007
         L     @09,CWBVREF                                         2007
         CLC   UCBNAME(3,@12),RU(@09)                              2007
         BNE   @RF02007                                            2007
*     DO;                           /* YES, PROCESS IT       @Y30LB03*/
*       DSDSWTH=F1;                 /* TURN ON MSC SWITCH    @Y30LB03*/
         MVI   DSDSWTH,X'01'                                       2009
*       BRSWTCH=F0;                 /* TURN BRCH SWITCH OFF? @Y30LB03*/
*                                                                  2010
         MVI   BRSWTCH,X'00'                                       2010
*       /*************************************************************/
*       /*                                                           */
*       /* IS THE GIVEN MSC ALREADY IN THE CORRECT STATUS ?  @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2011
*       IF((ONOFF='ON'&UCBONLI=BONE)(ONOFF='OF'&UCBONLI=BZERO))/* 2011
*                                                            @Y30LB03*/
*         THEN                      /*                       @Y30LB03*/
         CLC   ONOFF(2),@CC02863                                   2011
         BNE   @GL00026                                            2011
         TM    UCBONLI(@12),B'10000000'                            2011
         BO    @RT02011                                            2011
@GL00026 CLC   ONOFF(2),@CC02861                                   2011
         BNE   @RF02011                                            2011
         L     @12,UCBPTR                                          2011
         TM    UCBONLI(@12),B'10000000'                            2011
         BNZ   @RF02011                                            2011
@RT02011 DS    0H                                                  2012
*         DO;                       /* YES,                  @Y30LB03*/
*                                                                  2012
*           /*********************************************************/
*           /*                                                       */
*           /* FILL IN WTO MSG                               @Y30LB03*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2013
*           WTOMCS03=MESGS(MSG30301);/* FILL WTO BUFFER      @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2013
         L     @12,@CA02101                                        2013
         MVC   WTOMCS03(72),MESGS-MSGS+2508(@12)                   2013
*           WTOMCS03(13:15)=RU;     /* FILL IN UNIT          @Z40LB01*/
         L     @12,CWBVREF                                         2014
         MVC   WTOMCS03+12(3),RU(@12)                              2014
*           IF ONOFF='ON' THEN      /* FILL IN PART OF MESSAGE     2015
*                                                            @ZA24770*/
         CLC   ONOFF(2),@CC02863                                   2015
         BNE   @RF02015                                            2015
*             DO;                   /*                       @ZA24770*/
*               ICBECB=CHAR40;      /* DUMMY POST ATTN ECB   @ZA24770*/
         L     @12,ICBPTR                                          2017
         MVC   ICBECB(4,@12),@CF02435                              2017
*               WTOMCS03(25:27)=' ON';/* 'ON' IN MESSAGE     @ZA24770*/
         MVC   WTOMCS03+24(3),@CC02868                             2018
*             END;                  /*                       @ZA24770*/
*           ELSE                    /*                       @ZA24770*/
*             WTOMCS03(25:27)='OFF';/* 'OFF' IN MESSAGE      @ZA24770*/
         B     @RC02015                                            2020
@RF02015 MVC   WTOMCS03+24(3),@CC02869                             2020
*         END;                      /*                       @Y30LB03*/
*       ELSE                        /* NOT ALREADY ON/OFF LINE     2022
*                                                            @Y30LB03*/
*         DO;                       /* SO, DO DIFFERENT PROCESSING 2022
*                                                            @Y30LB03*/
         B     @RC02011                                            2022
@RF02011 DS    0H                                                  2023
*           IF PRIMSWTH=F0 THEN     /* THE ALTERNATE TO BE VARIED? 2023
*                                                            @Y30LB03*/
         CLI   PRIMSWTH,0                                          2023
         BNE   @RF02023                                            2023
*             DO;                   /* YES,                  @Y30LB03*/
*               WTOMCS03=MESGS(MSG30201);/* FILL WTO BUFFER  @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2025
         L     @12,@CA02101                                        2025
         MVC   WTOMCS03(72),MESGS-MSGS+2432(@12)                   2025
*               IF ONOFF='ON' THEN  /* VARY ON?              @Y30LB03*/
         CLC   ONOFF(2),@CC02863                                   2026
         BNE   @RF02026                                            2026
*                 DO;               /* YES,                  @Y30LB03*/
*                   UCBONLI=BONE;   /* TURN ONLINE BIT ON, IN UCB  2028
*                                                            @Y30LB03*/
         L     @12,UCBPTR                                          2028
         OI    UCBONLI(@12),B'10000000'                            2028
*                   WTOMCS03(21:23)=' ON';/*                 @Z40LB01*/
         MVC   WTOMCS03+20(3),@CC02868                             2029
*                 END;              /*                       @Y30LB03*/
*               ELSE                /* VARY OFF              @Y30LB03*/
*                 DO;               /* YES,                  @Y30LB03*/
         B     @RC02026                                            2031
@RF02026 DS    0H                                                  2032
*                   UCBONLI=BZERO;  /* TURN OFF ONLINE-BIT,IN UCB  2032
*                                                            @Y30LB03*/
         L     @12,UCBPTR                                          2032
         NI    UCBONLI(@12),B'01111111'                            2032
*                   WTOMCS03(21:23)='OFF';/*                 @Z40LB01*/
         MVC   WTOMCS03+20(3),@CC02869                             2033
*                 END;              /*                       @Y30LB03*/
*               WTOMCS03(13:15)=RU; /* FILL IN UNIT          @Z40LB01*/
@RC02026 L     @12,CWBVREF                                         2035
         MVC   WTOMCS03+12(3),RU(@12)                              2035
*             END;                  /*                       @Y30LB03*/
*           ELSE                    /* IF NOT ALTERNATE,     @Y30LB03*/
*             DO;                   /* VARYING PRIMARY       @Y30LB03*/
         B     @RC02023                                            2037
@RF02023 DS    0H                                                  2038
*               IF ONOFF='ON' THEN  /* ONLINE VARY?          @Y30LB03*/
         CLC   ONOFF(2),@CC02863                                   2038
         BNE   @RF02038                                            2038
*                 DO;               /* YES,                  @Y30LB03*/
*                   UCBONLI=BONE;   /* TURN ONLINE BIT ON,IN UCB   2040
*                                                            @Y30LB03*/
         L     @12,UCBPTR                                          2040
         OI    UCBONLI(@12),B'10000000'                            2040
*                   UCBQISCE=OFF;   /* TURN QUISCE BIT OFF,IN UCB  2041
*                                                            @ZA24770*/
         NI    UCBQISCE(@12),B'11111110'                           2041
*                   ICBECB=CHAR40;  /* DUMMY POST OF ATTN ECB      2042
*                                                            @ZA24770*/
         L     @09,ICBPTR                                          2042
         MVC   ICBECB(4,@09),@CF02435                              2042
*                   UCBNOTRD=BZERO; /* TURN OFF NOT-READY-BIT      2043
*                                                            @Y30LB03*/
         NI    UCBNOTRD(@12),B'10111111'                           2043
*                   WTOMCS03=MESGS(MSG30201);/* FILL WTO BUFF      2044
*                                                            @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2044
         L     @12,@CA02101                                        2044
         MVC   WTOMCS03(72),MESGS-MSGS+2432(@12)                   2044
*                   WTOMCS03(13:15)=RU;/* SET UP WTO MESSAGE @Z40LB01*/
         L     @12,CWBVREF                                         2045
         MVC   WTOMCS03+12(3),RU(@12)                              2045
*                   WTOMCS03(21:23)=' ON';/*                 @Z40LB01*/
         MVC   WTOMCS03+20(3),@CC02868                             2046
*                 END;              /*                       @Y30LB03*/
*               ELSE                /* OFFLINE VARY          @Y30LB03*/
*                 DO;               /* OFFLINE VARY FOR PRIMARY MSC
*                                                            @Y30LB03*/
         B     @RC02038                                            2048
@RF02038 DS    0H                                                  2049
*                   IF ICBAUCB^=F0 THEN/* DOES ALT MSC EXIST?      2049
*                                                            @Y30LB03*/
         L     @12,ICBPTR                                          2049
         L     @09,ICBAUCB(,@12)                                   2049
         LTR   @09,@09                                             2049
         BZ    @RF02049                                            2049
*                     DO;           /* YES,                  @Y30LB03*/
*                                                                  2050
*                       /*********************************************/
*                       /*                                           */
*                       /* DEFINE UCB AS ALT.                @Y30LB03*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  2051
*                       UCBPTR=ICBAUCB;/*                    @Y30LB03*/
         ST    @09,UCBPTR                                          2051
*                       IF UCBONLI=BONE THEN/* IS ALTERNATE MSC    2052
*                                      ONLINE?               @Y30LB03*/
         TM    UCBONLI(@09),B'10000000'                            2052
         BNO   @RF02052                                            2052
*                         DO;       /* YES,                  @Y30LB03*/
*                           ALTONLIN=F1;/* TURN ON ALT-ONLINE      2054
*                                                            @Y30LB03
*                                      SWITCH                @Y30LB03*/
*                                                                  2054
         MVI   ALTONLIN,X'01'                                      2054
*                           /*****************************************/
*                           /*                                       */
*                           /* RESET UCB TO PRIMARY UCB      @Y30LB03*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  2055
*                           UCBPTR=ICBPUCB;/*                @Y30LB03*/
         L     @12,ICBPUCB(,@12)                                   2055
         ST    @12,UCBPTR                                          2055
*                           SUSPFLG=''B;/* RESET SUSPEND FLAGS IN  2056
*                                      LIST                  @ZD00155*/
         XC    SUSPFLG(2),SUSPFLG                                  2056
*                           SUPPRSW=BONE;/* INDICATE PREPARE TO SWAP
*                                                            @ZD00155*/
         OI    SUPPRSW,B'00100000'                                 2057
*                           RFY                                    2058
*                             R15 RSTD;/*                    @YD00155*/
*                           SAVREENT=REENTRY;/* SAVE REENTRY POINTER
*                                                            @G24LB02*/
         L     @14,REENTRY                                         2059
         ST    @14,SAVREENT                                        2059
*                           REENTRY=ADDR(SWAPRET);/* SET NEW REENTRY
*                                      POINTER               @G24LB02*/
         LA    @14,SWAPRET                                         2060
         ST    @14,REENTRY                                         2060
*                           SVCCALL=ON;/* SET SVC CALL FLAG  @G24LB02*/
         OI    SVCCALL,B'00001000'                                 2061
*ISUSPD2:                           /*                       @YD00155*/
*/*  ******************************************************* @Y30LB02*/
*/*       MACMEAN  MSSC SUSPEND MACRO                        @Y30LB02*/
*/*  VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00                 @Y30LB02*/
*/*  THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Y30LB02*/
*/*  THE LIST FORM OF THIS MACRO SHOULD BE                   @Y30LB02*/
*/*  INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Y30LB02*/
*/*  DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Y30LB02*/
*/*  SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Y30LB02*/
*/*  ******************************************************* @Y30LB02*/
*                                                                  2062
*                           RFY                                    2062
*                            (SUSPR1) RSTD;/* RESTRICT REG1  @Y30LB02*/
ISUSPD2  DS    0H                                                  2063
*                           SUSPR1=ADDR(SUSPLIST);/* R1 POINTER TO 2063
*                                      REQUEST BLOCK         @Y30LB02*/
         LA    SUSPR1,SUSPLIST                                     2063
*                           SUSPLEN='8'X;/* LENGTH OF SUSPEND REQUEST
*                                                            @Y30LB02*/
         LA    @14,8                                               2064
         ST    @14,SUSPLEN                                         2064
*                           SUSPOP='22'X;/* SUSPEND OPCODE   @Y30LB02*/
         MVI   SUSPOP,X'22'                                        2065
*                           SVC(126);/* INVOKE SVC 126       @Y30LB02*/
         SVC   126                                                 2066
*                           RFY                                    2067
*                             SUSPR1 UNRSTD;/* UNRESTRICT REG 1    2067
*                                                            @Y30LB02
*                                      ISSUE SWAP WITH SUSPEND     2067
*                                                            @ZD00155*/
*SWAPRET:                           /* LABEL FOR RETURN      @G24LB02*/
*                           SVCCALL=OFF;/* CLEAR SVC CALL FLAG     2068
*                                                            @G24LB02*/
SWAPRET  NI    SVCCALL,B'11110111'                                 2068
*                           REENTRY=SAVREENT;/* RESTORE REENTRY    2069
*                                      POINTER               @G24LB02*/
         L     @14,SAVREENT                                        2069
         ST    @14,REENTRY                                         2069
*                           IF R15^=F0 THEN/* IS ERROR INDICATOR ON?
*                                                            @Y30LB03*/
         LTR   R15,R15                                             2070
         BZ    @RF02070                                            2070
*                             DO;   /* YES,                  @Y30LB03*/
*                               RFY                                2072
*                                 R0 RSTD;/* RST REGISTER 0  @YD00155*/
*                               RFY                                2073
*                                 R15 UNRSTD;/* REL REGISTER 15    2073
*                                                            @YD00155*/
*                               OFFRPLY='CANCEL';/* SMF SWITCH, USED
*                                      AT END OF THIS        @Y30LB03
*                                      SUBROUTINE            @Y30LB03*/
         MVC   OFFRPLY(6),@CC02995                                 2074
*                               INTER=R0;/* SET UP FOR REAS CODE   2075
*                                      CONVERSION            @Y30LB03*/
*                                                                  2075
         ST    R0,INTER                                            2075
*                               /*************************************/
*                               /*                                   */
*                               /* CALL ICBMSG82 TO CONVERT REAS CD  */
*                               /*                           @Y30LB03*/
*                               /*                                   */
*                               /*************************************/
*                                                                  2076
*                               CALL ICBMSG82;/*             @Y30LB03*/
         BAL   @14,ICBMSG82                                        2076
*                               RESPECIFY                          2077
*                                 R0 UNRSTD;/*               @Y30LB03*/
*                               WTOMCS03=MESGS(MSG31101);/* FILL WTO
*                                      BUFFER                @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2078
         L     @12,@CA02101                                        2078
         MVC   WTOMCS03(72),MESGS-MSGS+2584(@12)                   2078
*                               WTOMCS03(18:20)=RU;/* FILL IN UNIT 2079
*                                                            @Z40LB01*/
         L     @12,CWBVREF                                         2079
         MVC   WTOMCS03+17(3),RU(@12)                              2079
*                               WTOMCS03(47:49)=BYTES234;/* FILL IN
*                                      REAS CD               @Z40LB01*/
         MVC   WTOMCS03+46(3),BYTES234                             2080
*                               WTOMCS03(22:24)='OFF';/*     @Z40LB01*/
         MVC   WTOMCS03+21(3),@CC02869                             2081
*                               BRSWTCH=F0;/* WANT TO WTO, SO TURN 2082
*                                      OFF BRCH              @Y30LB03
*                                      SWITCH THAT IS CHECKED IN   2082
*                                      ICBMSG41              @Y30LB03*/
         MVI   BRSWTCH,X'00'                                       2082
*                             END;  /*                       @Y30LB03*/
*                           ELSE    /* ERROR INDICATOR IS NOT ON   2084
*                                                            @ZD00155*/
*                             DO;   /* SWAP IN PROCESS       @ZD00155*/
         B     @RC02070                                            2084
@RF02070 DS    0H                                                  2085
*                               BRSWTCH=F1;/* SET NO-MESSAGE NEEDED
*                                                            @ZD00155*/
         MVI   BRSWTCH,X'01'                                       2085
*                             END;  /* BECAUSE ERPS WRITE SWAP     2086
*                                      MESSAGES              @ZD00155*/
*                         END;      /*                       @Y30LB03*/
@RC02070 DS    0H                                                  2088
*                     END;          /*                       @Y30LB03*/
@RF02052 DS    0H                                                  2089
*                   IF ALTONLIN=F0 THEN/* IS ALT. MSC OFFLINE?     2089
*                                                            @Y30LB03*/
*                                                                  2089
@RF02049 CLI   ALTONLIN,0                                          2089
         BNE   @RF02089                                            2089
*                     /***********************************************/
*                     /*                                             */
*                     /* YES, ALT. IS OFFLINE                @Y30LB03*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  2090
*                     DO;           /*                       @Y30LB03*/
*                                                                  2090
*                       /*********************************************/
*                       /*                                           */
*                       /* BASE UCB ON PRIMARY MSC           @Y30LB03*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  2091
*                       UCBPTR=ICBPUCB;/*                    @Y30LB03*/
         L     @12,ICBPTR                                          2091
         L     @12,ICBPUCB(,@12)                                   2091
         ST    @12,UCBPTR                                          2091
*                       OFFRPLY=''B;/* ZERO RESPONSE FIELD   @Y30LB03*/
         XC    OFFRPLY(6),OFFRPLY                                  2092
*                       WAITECB=F0; /* CLEAR ECB             @Y30LB03*/
         SLR   @12,@12                                             2093
         ST    @12,WAITECB                                         2093
*                       RESPECIFY                                  2094
*                         R2 RSTD;  /*                       @Y30LB03*/
*                       R2=ADDR(WAITECB);/* SET UP REG 2 W/ ECB    2095
*                                                            @Y30LB03*/
         LA    R2,WAITECB                                          2095
*                       GEN;                                       2096
*                                                          /*@Y30LB03*/
IWTOR1   WTOR  '  ICB015D - ALT MSC DOES NOT EXIST OR IS OFFLINE, REPLY*
                 CANCEL OR U ',OFFRPLY,6,(R2)                  @Y30LB03
IWAIT4   WAIT  ECB=WAITECB          ISSUE WAIT, FOR REPLY      @Y30LB03
*                       RESPECIFY                                  2097
*                         R2 UNRSTD;/*                       @Y30LB03*/
*                       IF(REPLYU=CHARA4REPLYU=CHARE4) THEN/*     2098
*                                      CONTINUE?             @Y30LB03*/
         CLI   REPLYU,X'A4'                                        2098
         BE    @RT02098                                            2098
         CLI   REPLYU,X'E4'                                        2098
         BNE   @RF02098                                            2098
@RT02098 DS    0H                                                  2099
*                         DO;       /* YES,                  @Y30LB03*/
*                                                                  2099
*                           /*****************************************/
*                           /*                                       */
*                           /* SET UP FOR SVC 91             @Y30LB03*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  2100
*                           RESPECIFY                              2100
*                            (R0,                                  2100
*                             R1) RSTD;/*                    @Y30LB03*/
*                           R0=ICBPUCB;/* LOAD REG 0 W/ PRIM UCB ADDR
*                                                            @Y30LB03*/
         L     @12,ICBPTR                                          2101
         L     R0,ICBPUCB(,@12)                                    2101
*                           GEN;                                   2102
*                                                          /*@Y30LB03*/
         LCR   R0,R0                LOAD COMPLEMENT            @Y30LB03
*                           R1=R1COMPL;/*                    @Y30LB03*/
         L     R1,@CF02463                                         2103
*                           SVC(91);/* ISSUE SVC 91 TO OFFLOAD     2104
*                                      BUFFERED LOG DATA     @Y30LB03*/
         SVC   91                                                  2104
*                           RESPECIFY                              2105
*                            (R0,                                  2105
*                             R1) UNRSTD;/*                  @Y30LB03*/
*                           UCBONLI=BZERO;/* TURN ONLINE BIT OFF   2106
*                                                            @Y30LB03*/
         L     @12,UCBPTR                                          2106
         NI    UCBONLI(@12),B'01111111'                            2106
*                           WTOMCS03=MESGS(MSG30201);/* FILL WTO   2107
*                                      BUFFER                @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2107
         L     @12,@CA02101                                        2107
         MVC   WTOMCS03(72),MESGS-MSGS+2432(@12)                   2107
*                           WTOMCS03(21:23)='OFF';/* SET UP WTO    2108
*                                      MESSAGE               @Z40LB01*/
         MVC   WTOMCS03+20(3),@CC02869                             2108
*                           WTOMCS03(13:15)=RU;/*            @Z40LB01*/
         L     @12,CWBVREF                                         2109
         MVC   WTOMCS03+12(3),RU(@12)                              2109
*                         END;      /*                       @Y30LB03*/
*                       ELSE        /* CANCEL IT             @Y30LB03*/
*                         BRSWTCH=F1;/* TURN BRCH SWITCH BACK ON   2111
*                                                            @Y30LB03
*                                      SINCE NO WTO MESSAGE  @Y30LB03*/
         B     @RC02098                                            2111
@RF02098 MVI   BRSWTCH,X'01'                                       2111
*                     END;          /*                       @Y30LB03*/
@RC02098 DS    0H                                                  2113
*                 END;              /*                       @Y30LB03*/
@RF02089 DS    0H                                                  2114
*             END;                  /*                       @Y30LB03*/
@RC02038 DS    0H                                                  2115
*/*   IS SMF AVAILABLE AND SHOULD SMF SUBRTN BE CALLED ?     @Y30LB03*/
*                                                                  2115
*           IF((CVTSMCA^=F0)&(OFFRPLY^='CANCEL')) THEN/*     @Y30LB03*/
@RC02023 L     @12,CVTPTR                                          2115
         L     @12,CVTSMCA(,@12)                                   2115
         LTR   @12,@12                                             2115
         BZ    @RF02115                                            2115
         CLC   OFFRPLY(6),@CC02995                                 2115
         BE    @RF02115                                            2115
*             DO;                   /* YES,                  @Y30LB03*/
*               RFY                                                2117
*                 R1 RSTD;          /*                       @G24LB02*/
*               IF ONOFF='ON' THEN  /*                       @G24LB02*/
         CLC   ONOFF(2),@CC02863                                   2118
         BNE   @RF02118                                            2118
*                 R1=SMF09PTR;      /* R1 POINTS TO REC 9 DATA     2119
*                                                            @G24LB02*/
         L     R1,SMF09PTR                                         2119
*               ELSE                /*                       @G24LB02*/
*                 R1=SMF11PTR;      /* R1 POINTS TO REC 11 DATA    2120
*                                                            @G24LB02*/
         B     @RC02118                                            2120
@RF02118 L     R1,SMF11PTR                                         2120
*               CALL ICBMSG83;      /* CALL SMF SUBRTN       @Y30LB03*/
@RC02118 BAL   @14,ICBMSG83                                        2121
*               RFY                                                2122
*                 R1 UNRSTD;        /*                       @G24LB02*/
*             END;                  /*                       @Y30LB03*/
*         END;                      /*                       @Y30LB03*/
@RF02115 DS    0H                                                  2125
*     END;                          /*                       @Y30LB03*/
@RC02011 DS    0H                                                  2126
*   RFY                                                            2126
*     R14 RSTD;                     /*                       @G24LB02*/
@RF02007 DS    0H                                                  2127
*   R14=SAVR1449;                   /*                       @Y30LB03*/
         L     R14,SAVR1449                                        2127
*   RFY                                                            2128
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00023 DS    0H                                                  2129
@EF00023 DS    0H                                                  2129
@ER00023 BR    @14                                                 2129
*   END ICBMSG49;                   /*                       @Y30LB03*/
*                                                                  2131
*/*********************************************************  @Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG50                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = MSS ACTIVITY UPDATE SUBROUTINE       @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = INITIALIZE/UPDATE MSS ACTIVITY TABLES        @Y30LB03
*           AND PROVIDE UPDATED ACTIVITY INFORMATION TO JES3  @G18MB04
*                                                             @Y30LB03
*01*  NOTES = IF THE ACTIVITY BUFFER CANNOT BE INITIALIZED,   @Y30LB03
*             NO CODE USING THE BUFFER WILL ABEND. HOWEVER,   @Y30LB03
*             MOUNT EQUALIZATION OPTIMIZATION WILL BE LOST    @Y30LB03
*             UNTIL THE NEXT TIMED UPDATE.                    @Y30LB03
*             THE CODE PROGRESSIVLY INITIALIZES THE ACTIVITY  @Y30LB03
*             BUFFER FIRST WITH BINARY ZEROS, THEN WITH       @Y30LB03
*             STATIC SDG00 TO SDG27, THEN WITH MSS ACTIVITY   @ZM31027
*             TABLES. WHEN FAILURE OF CODE IS ENCOUNTERED,    @Y30LB03
*             THE STAE REENTRY IS SET SO NO UPDATE IS MADE    @Y30LB03
*             AND THE PREVIOUS LEVEL OF MOUNT EQUALIZATION    @Y30LB03
*             SORT IS RETAINED. THE STAE RETRY ALWAYS         @Y30LB03
*             ATTEMPTS TO REESTABLISH THE TIMER ELEMENT FOR   @Y30LB03
*             UPDATING THE ACTIVITY BUFFER.                   @Y30LB03
*             THE INITIAL STATE OF THE ACTIVITY BUFFER IS NOT @G18MB04
*             SENT TO JES3 BECAUSE THE MESSAGE TASK           @G18MB04
*             INITIALIZATION OCCURS BEFORE JES3 IS STARTED.   @G18MB04
*                                                             @Y30LB03
*02*  PURPOSE = TO INITIALIZE AND UPDATE THE MSS ACTIVITY     @Y30LB03
*               TABLES THAT ARE USED BY ALLOCATION.  THE      @Y30LB03
*               FIRST ENTRY TO THE SUBROUTINE CAUSES THE      @Y30LB03
*               TABLE INITIALIZATION BESIDES NORMAL ACTIVITY  @Y30LB03
*               PROCESSING.  FOR NORMAL PROCESSING,           @Y30LB03
*               INFORMATION FOR UPDATING THE TABLES IS READ   @Y30LB03
*               VIA THE ICBQUERY MACRO TO THE MSC AND THE     @ZA08838
*               TABLES ARE SORTED. A TIMER INTERRUPT          @Y30LB03
*               ELEMENT (STIMER MACRO) IS ESTABLISHED         @Y30LB03
*               SPECIFYING AN ASYNCHRONOUS TIMER              @Y30LB03
*               INTERRUPT ROUTINE (ICB2ACT) WHICH WILL        @Y30LB03
*               BE USED TO POST THE ACTIVITY ECB (ONE         @Y30LB03
*               OF THE ECBS IN THE ECB LIST THAT THE          @Y30LB03
*               MESSAGE TASK IS WAITING ON).                  @Y30LB03
*               AFTER SORTING THE LIST, AND BEFORE REPLACING  @G18MB04
*               THE NUMERICAL INDEX CALCULATED FOR SORTING BY @G18MB04
*               THE BLANKS OF THE UNIT NAME FIELD IN EACH     @G18MB04
*               ENTRY, THE MESSAGE TASK FINDS THE ADDRESS OF  @G18MB04
*               THE FIRST STAGING DRIVE GROUP ENTRY FOR WHICH @G18MB04
*               LRU ACTIVITY HAD OCCURRED SINCE THE LAST      @G18MB04
*               UPDATE OF THE LIST.                           @G18MB04
*               AFTER THE UNIT NAMES ARE COMPLETED, ICBMSG50  @G18MB04
*               FILLS IN CONTROL BLOCK NECESSARY TO PASS THE  @G18MB04
*               LIST TO THE APPROPRIATE JES3 FUNCTION, BY     @G18MB04
*               THE SUBSYSTEM INTERFACE FUNCTION IN VS/2.     @G18MB04
*               WHEN ICBMSG50 RECEIVES CONTROL BACK, IT       @G18MB04
*               OBTAINS LOCKS FOR SERIALIZATION OF THE        @G18MB04
*               UPDATE OF THE MASTER LIST, AND COPIES THE     @G18MB04
*               SORTED STAGING DRIVE GROUP LIST INTO THE      @G18MB04
*               BUFFER WHICH IS THE MASTER COPY OF THE LIST.  @G18MB04
*                                                             @Y30LB03
*02*    INPUT = NONE                                          @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = INITIALIZED/UPDATED MSS ACTIVITY TABLES      @Y30LB03
*                TO JES3, COPY OF LIST WITH ADDRESS OF FIRST  @G18MB04
*                STAGING DRIVE GROUP FOR WHICH LRU ACTIVITY   @G18MB04
*                HAD OCCURRED SINCE THE LAST UPDATE           @G18MB04
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  2131
*ICBMSG50:                                                         2131
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG50 DS    0H                                                  2132
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*      FORMAT OF STAGING DRIVE GROUP DATA                  @Y30LB03*/
*/*      RECEIVED FROM ICBQUERY COMMAND TO MSC               @ZA08838*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  2132
*   DCL                                                            2132
*     1 ACTWKBUF BDY(WORD) BASED(ADDR(BUFFER)),/* BUFFER     @Y30LB03*/
*      2 ACTENT1(28) CHAR(4) BDY(WORD),/* FIRST PART         @Y30LB03*/
*       3 * CHAR(1),                /* FILLER                @Y30LB03*/
*       3 AVL FIXED(8),             /* AVAIL STAGE SPINDLES  @Y30LB03*/
*       3 MV FIXED(16),             /* #MNTD VOLS THIS GROUP @Y30LB03*/
*      2 ACTFIL CHAR(16),           /* FILLER                @ZA13483*/
*      2 ACTENT2(28) CHAR(4) BDY(WORD),/* SECOND PART        @Y30LB03*/
*       3 LRU FIXED(8),             /* LRU COUNT THIS GROUP  @Y30LB03*/
*       3 CAP FIXED(8),             /* SYSGEN STAGE SPINDLES @Y30LB03*/
*       3 UA FIXED(16);             /* VUAS SYSGEND THIS           2132
*                                      GROUP@Y30LB03                 */
*   DCL                                                            2133
*     LRUIX(30) FIXED(8);           /* PREVIOUS LRU COUNT    @ZA00671*/
*   DCL                                                            2134
*     MAX CONSTANT(1048576);        /* MAXIMUM VALUE         @ZA00671*/
*   DCL                                                            2135
*     LRUED CONSTANT(1048576);      /* LRU ED VALUE          @ZA00671*/
*   DCL                                                            2136
*     PREC CONSTANT(100);           /* PRECISION             @ZA00671*/
*   DCL                                                            2137
*     F1024 FIXED(24) CONSTANT(1024);/* CONSTANT 1024        @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*/*  CONSTANT TABLE                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  2138
*   DCL                                                            2138
*     CONST(30) CHAR(2) INIT('00','01','02','03','04','05',/*      2138
*                                                            @Y30LB03*/
*         '06','07','08','09','10','11','12','13','14','15','16',/*
*                                                            @Y30LB03*/
*         '17','18','19','20','21','22','23','24','25','26',/*     2138
*                                                            @Y30LB03*/
*         '27','28','29');          /*                       @Y30LB03*/
*/*********************************************************  @ZA08838*/
*/* FORMAT OF STAGING DRIVE GROUP LIST IN OPERATING SYSTEM   @ZA08838*/
*/*********************************************************  @ZA08838*/
*/***********************************************************@G18MB04*/
*/*   MACCOMP        @G18MB04    SC1DP/BL0019                @G18MB04*/
*/*   MACSTAT        @G18MB04    75.344                      @G18MB04*/
*/*                                                          @G18MB04*/
*/*           ***** MAPPING MACRO *****                      @G18MB04*/
*/*                                                          @G18MB04*/
*/*   NAME    SDGLS     MSSC STAGING DRIVE GROUP LIST        @G18MB04*/
*/*                                                          @G18MB04*/
*/*  FUNCTION -  THIS IS A LIST OF UNIT NAMES, ONE FOR EACH  @G18MB04*/
*/*           POSSIBLE STAGING DRIVE GROUP THAT COULD EXIST  @G18MB04*/
*/*           IN A MASS STORAGE SYSTEM.                      @G18MB04*/
*/*           THESE ARE SORTED IN ORDER OF BEST CHOICE       @G18MB04*/
*/*           (LEAST BUSY) TO WORST CHOICE.                  @G18MB04*/
*/*                                                          @G18MB04*/
*/*   STATUS - CHANGE LEVEL = 0                              @G18MB04*/
*/*                                                          @G18MB04*/
*/***********************************************************@G18MB04*/
*                                                                  2139
*   DCL                                                            2139
*     1 SDGLS BASED,                /* STAGING DRIVE GROUP LIST    2139
*                                                            @G18MB04*/
*      2 SDGNNBBB(30) CHAR(8),      /* UNIT NAMES FOR SDGS   @G18MB04*/
*       3 SDG CHAR(3),              /* EBCDIC LITERALS SDG   @G18MB04*/
*       3 SDGNN CHAR(2),            /* EBCDIC NUMBER OF SDG  @G18MB04*/
*       3 SDGBBB CHAR(3),           /* EBCDIC BLANKS         @G18MB04*/
*        4 SDGIX FIXED(24);         /* FOR USE IN MSSC SORT  @G18MB04*/
*   DCL                                                            2140
*     SDGSLEN CONSTANT(240);        /* LENGTH OF SDGLS       @SDGSDGS*/
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*       SUBSYSTEM OPTIONS BLOCK (SSOB)                             */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*        ***** LAST UPDATE = DECEMBER 21, 1976 ******      @ZM44655*/
*/*                                                                  */
*/*   STATUS - VS2 SU 16 - IN THIS MACRO, SU 16 SUPPORTS     @G16APPK*/
*/*            JES3-MSS (SU 18 - @G18MP21) AND VPSS          @G16APPK*/
*/*            SUPPORT (SU 29 - @G29AN2F).                   @G16APPK*/
*/*                                                                  */
*/*   THE SSOB IS USED TO REQUEST A PARTICULAR FUNCTION FROM         */
*/*   A VS/2 SUBSYSTEM.  THE FORMAT OF THIS CONTROL BLOCK IS A FIXED */
*/*   LENGTH HEADER SECTION WHICH POINTS TO A FUNCTION DEPENDENT     */
*/*   SECTION.                                                       */
*/*                                                                  */
*/*   THE PARTICULAR FUNCTION REQUESTED IS INDICATED BY A FUNCTION   */
*/*   ID IN THE HEADER.  PLS/2 CONSTANTS DEFINE THE VARIOUS ID'S.    */
*/*                                                                  */
*/*   MACRO VARIABLES ARE DEFINED TO CONTROL THE GENERATION OF THE   */
*/*   SSOB HEADER AND THE FUNCTION DEPENDENT SECTIONS.               */
*/*   TO OBTAIN THE HEADER, SET THE VARIABLE 'SSOBSSOB' TO ANY NON-  */
*/*   NULL/BLANK CHARACTER, E.G., %SSOBSSOB = 'BASED'.               */
*/*   THIS VALUE WILL BE USED TO ASSIGN ATTRIBUTES TO THE SSOB.      */
*/*   %SSOBSSOB = 'BDY(WORD)' WILL CAUSE PL/S TO GET                 */
*/*   STORAGE FOR THE SSOB. THE ATTRIBUTES OF THE FUNCTION           */
*/*   DEPENDENT SECTIONS ARE SIMILARLY SET.                          */
*/*                                                                  */
*/*   CONSTANTS DEFINING THE POSSIBLE VALUES OF SSOBRETN ARE         */
*/*   GENERATED WITH EACH FUNCTION DEPENDENT SECTION THE             */
*/*   VARIABLES WHICH CAN BE SET TO OBTAIN THE FUNCTION DEPENDENT    */
*/*   SECTIONS ARE -                                                 */
*/*                                                                  */
*/*       SSOBSO - ACCESS SYSOUT DATA SETS                           */
*/*       SSOBCS - FIND THE STATUS OF A JOB, OR CANCEL A JOB         */
*/*                %CSARAYSZ DEFINES THE SIZE OF THE C/S ARRAY       */
*/*                -SET %CSARAYSZ='*' IF THE C/S EXTENSION IS        */
*/*                 MAPPING STORAGE.                                 */
*/*                -SET %CSARAYSZ TO THE ACTUAL ARRAY SIZE IF        */
*/*                 PLS IS GETTING STORAGE.                          */
*/*       SSOBJS - SUBSYSTEM JOB SELECTION                           */
*/*       SSOBAL - ALLOCATION/UNALLOCATION OF SYSOUT DATA SETS       */
*/*       SSOBEN - NOTIFY SUBSYSTEM OF END OF MEMORY                 */
*/*       SSOBET - NOTIFY SUBSYSTEM OF END OF TASK                   */
*/*       SSOBWT - NOTIFY SUBSYSTEM OF A WRITE TO OPERATOR           */
*/*       SSOBCM - NOTIFY SUBSYSTEM OF AN OPERATOR COMMAND           */
*/*       SSOBUS - REQUEST SUBSYSTEM TO VERIFY A REMOTE DESTINATION  */
*/*       SSOBJT - NOTIFY SUBSYSTEM OF JOB TERMINATION               */
*/*       SSOBRQ - REQUEST SUBSYSTEM TO RE-ENQUEUE A JOB             */
*/*       SSOBDM - REQUEST SUBSYSTEM TO DELETE OPERATOR MESSAGE      */
*/*       SSOBVS - REQUEST (MSTR) SUBSYSTEM TO VERIFY SUBSYSTEM NAME */
*/*       SSOBDA - OPEN/CLOSE/CHECKPOINT RESTART                     */
*/*       SSOBRR - REQUEST/RETURN JOBID                              */
*/*       SSOBCF - FAILING SVC34 COMMAND                     @Z30BPSV*/
*/*       SSOBSI - NOTIFY SUBSYSTEM OF STEP INITIATION       @Y02BPSD*/
*/*       SSOBDY - DYNAMIC ALLOCATION/JES3 EXIT              @Y02BPSD*/
*/*       SSOBCA - COMMON ALLOCATION/JES3 EXIT               @Y02BPSD*/
*/*       SSOBCU - COMMON UNALLOCATION/JES3 EXIT             @Y02BPSD*/
*/*       SSOBDD - CHANGE DDNAME/JES3 EXIT                   @Y02BPSD*/
*/*       SSOBNQ - CHANGE ENQ USE ATTRIBUTE/JES3 EXIT        @Y02BPSD*/
*/*       SSOBDR - DYNAMIC DEVICE RECONFIGURATION/JES3 EXIT  @Y02BPSD*/
*/*       SSOBMO - MASS STORAGE VOLUME CONTROL JES3 EXIT     @G18MP21*/
*/*       SSOBMS - MSSC MESSAGE TASK JES3 EXIT               @G18MP21*/
*/*       SSOBCI - CONVERTER SUBSYS KEYWORD EXIT             @G29AN2F*/
*/*       SSOBAG - ALLOCATION GROUP SUBSYSTEM REQUESTS       @G29AN2F*/
*/*                                                                  */
*/*                                                                  */
*/* ******************************************************************/
*                                                                  2141
*                                                                  2141
*/********************************************************************/
*/*                                                                  */
*/* THE COMMON FIXED-LENGTH SSOB HEADER                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  2141
*   DECLARE                                                        2141
*     1 SSOB BASED,                 /* SSOB FIXED-LENGTH HEADER      */
*      2 SSOBID CHAR(4),            /* 'SSOB' = CNTL BLOCK IDENT.    */
*      2 SSOBLEN FIXED(15),         /* LENGTH OF SSOB HEADER         */
*      2 SSOBFUNC FIXED(15),        /* FUNCTION ID - SEE PLS       2141
*                                      CONSTANTS FOR THESE VALUES    */
*      2 SSOBSSIB PTR(31),          /* ADDRESS OF SSIB, WHICH      2141
*                                      CONTAINS SUBSYSTEM NAME, OR 2141
*                                      ZERO                          */
*      2 SSOBRETN PTR(31),          /* RETURN CODE FROM SUBSYSTEM    */
*      2 SSOBINDV PTR(31);          /* POINTER TO INDIVIDUAL       2141
*                                      FUNCTIONAL DEPENDENT AREA     */
*/********************************************************************/
*/*                                                                  */
*/*  THE FOLLOWING RETURN CODES WILL BE RETURNED IN REGISTER 15      */
*/*  TO THE ISSUER OF THE IEFSSREQ MACRO -                           */
*/*                                                                  */
*/*  SSOBRETN CONTAINS FUNCTION-RELATED RETURN CODES                 */
*/*    (DEFINED IN EACH FUNCTION EXTENSION)                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  2142
*   DCL                                                            2142
*     SSRTOK FIXED(31) CONSTANT(0); /* SUCCESSFUL COMPLETION -     2142
*                                      REQUEST WENT TO A SUBSYSTEM   */
*   DCL                                                            2143
*     SSRTNSUP FIXED(31) CONSTANT(4);/* SUBSYSTEM DOES NOT SUPPORT 2143
*                                      THIS FUNCTION                 */
*   DCL                                                            2144
*     SSRTNTUP FIXED(31) CONSTANT(8);/* SUBSYSTEM EXISTS, BUT IS NOT
*                                      UP                            */
*   DCL                                                            2145
*     SSRTNOSS FIXED(31) CONSTANT(12);/* SUBSYSTEM DOES NOT EXIST    */
*   DCL                                                            2146
*     SSRTDIST FIXED(31) CONSTANT(16);/* FUNCTION NOT COMPLETED -  2146
*                                      DISASTROUS ERROR              */
*   DCL                                                            2147
*     SSRTLERR FIXED(31) CONSTANT(20);/* LOGICAL ERROR (I.E. BAD SSOB
*                                      FORMAT, LENGTH...             */
*/********************************************************************/
*                                                                  2148
*                                                                  2148
*/********************************************************************/
*/*                                                                  */
*/*   MSSC MESSAGE TASK JES3 EXIT                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  2148
*   /*****************************************************************/
*   /*                                                               */
*   /* FUNCTION IDS (SSOBFUNC)                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2148
*   DCL                                                            2148
*     SSOBMSSC FIXED(15) CONSTANT(36);/* MSSC MESSAGE TASK   @G18MP21*/
*                                                                  2148
*   /*****************************************************************/
*   /*                                                               */
*   /* NO MSSC MESSAGE TASK RETURN CODES                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2149
*/*     S S M S                                              @G18MP21*/
*                                                                  2149
*   DECLARE                                                        2149
*     1 SSMS BASED,                 /*                       @G18MP21*/
*      2 SSMSLEN FIXED(15),         /* LENGTH OF SSMS        @G18MP21*/
*      2 SSMSRV0 FIXED(15),         /* RESERVED              @G18MP21*/
*      2 SSMSPSDG PTR(31),          /* POINTER TO THE SORTED SDG LIST
*                                                            @G18MP21*/
*      2 SSMSPLRU PTR(31);          /* POINTER TO FIRST SDG WITH LRU
*                                                            @G18MP21*/
*/*                                                                  */
*/*  SUBSYSTEM IDENTIFICATION BLOCK (SSIB)                           */
*/*                                                                  */
*/*      -IDENTIFIES THE SUBSYSTEM TO WHICH A REQUEST FOR SERVICES   */
*/*       IS BEING MADE                                              */
*/*                                                                  */
*/*      -CONTAINS COMMON CONTROL INFORMATION PASSED BETWEEN THE     */
*/*       REQUESTOR AND THE SUBSYSTEM                                */
*/*                                                                  */
*                                                                  2150
*   DCL                                                            2150
*     1 SSIB BASED(SSIBPTR),                                       2150
*      2 SSIBID CHAR(4),            /* CONTROL BLOCK ID='SSIB'       */
*      2 SSIBLEN FIXED(15),         /* SSIB LENGTH                   */
*      2 SSIBFLG1 BIT(8),           /* FLAGS                         */
*       3 SSIBPJES BIT(1),          /* THIS SSIB IS USED TO START THE
*                                      PRIMARY JOB ENTRY SUBSYSTEM   */
*       3 * BIT(7),                 /* RESERVED FLAGS                */
*      2 SSIBRESV CHAR(1),          /* RESERVED                      */
*      2 SSIBSSNM CHAR(4),          /* SUBSYSTEM NAME                */
*      2 SSIBJBID CHAR(8),          /* JOB IDENTIFIER                */
*      2 SSIBDEST CHAR(8),          /* DEFAULT USERID FOR SYSOUT   2150
*                                      DESTINATION                   */
*      2 SSIBRSV1 FIXED(31),        /* RESERVED                      */
*      2 SSIBSUSE PTR(31);          /* RESERVED FOR SUBSYSTEM USAGE  */
*/*                                                                  */
*/* MACMEAN JESCT MEANS JOB ENTRY SUBSYSTEM COMMUNICATION TABLE      */
*/* MACCOMP Y-2 SC1B8/PZD02                                  @G16APPK*/
*/* MACSTAT Y-2 76323/G16APPK                                @G16APPK*/
*/*                                                                  */
*/* STATUS - VS2 SU 16 - IN THIS MACRO, SU 16 SUPPORTS       @G16APPK*/
*/*          VPSS SUPPORT (SU29 - @G29AN2F).                 @G16APPK*/
*/*                                                                  */
*                                                                  2151
*   DECLARE                                                        2151
*     1 JESCT BASED(CVTJESCT),                                     2151
*                                                                  2151
*/*                                                                  */
*                                                                  2151
*      2 * CHAR(4),                 /* RESERVED                      */
*      2 JESUNITS PTR(31),          /* POINTER TO UCB'S Y02668       */
*      2 JESWAA PTR(31),            /* ADDRESS OF SWA MANAGER -    2151
*                                      LOCATE MODE Y02668            */
*      2 JESQMGR PTR(31),           /* ADDRESS OF SWA MANAGER MOVE -
*                                      MODE Y02668                   */
*      2 JESRESQM PTR(31),          /* ENTRY POINT USED TO INTERFACE
*                                      BETWEEN THE QMNGRIO MACRO AND
*                                      THE RESIDENT SWA MANAGER    2151
*                                      Y02668                        */
*      2 JESSSREQ PTR(31),          /* ADDRESS OF THE IEFSSREQ     2151
*                                      ROUTINE Y02668                */
*      2 JESSSCT PTR(31),           /* ADDRESS OF THE FIRST SUBSYSTEM
*                                      COMMUNICATIONS TABLE Y02668   */
*      2 JESPJESN CHAR(4),          /* NAME OF PRIMARY JOB ENTRY   2151
*                                      SUBSYSTEM SET AT SYSGEN Y02668*/
*      2 JESALLOC PTR(31),          /* DEVICE ALLOCATION ENTRY POINT
*                                      USED BY INITIATOR     @Z40FPPJ*/
*      2 JESUNALC PTR(31),          /* DEVICE UNALLOCATION ENTRY   2151
*                                      POINT USED BY INITIATOR     2151
*                                                            @Z40FPPJ*/
*      2 JESCATL PTR(31),           /* DEVICE ALLOCATION PRIVATE   2151
*                                      CATALOG ENTRY POINT USED BY 2151
*                                      INITIATOR             @Z40FPPJ*/
*      2 JESNUCBS FIXED(31),        /* NUMBER OF UCB'S IN THE SYSTEM.
*                                      USED BY DEVICE ALLOCATION   2151
*                                                            @Z40FPPJ*/
*      2 JESSASTA PTR(31);          /* ADDRESS OF SUBSYSTEM        2151
*                                      ALLOCATION SEQUENCE TABLE   2151
*                                                            @G29AN2F*/
*                                                                  2151
*   /*****************************************************************/
*   /*                                                               */
*   /* TO CALL THE SWA MANAGER , USE THE SWAREQ MACRO. IT WILL ISSUE */
*   /* A 'CALL SWAMGR'                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2152
*   DECLARE                                                        2152
*     SWAMGR ENTRY BASED(JESWAA);                                  2152
*                                                                  2152
*   /*****************************************************************/
*   /*                                                               */
*   /* TO CALL THE SUBSYSTEM, USE THE IEFSSREQ MACRO. IT WILL ISSUE A*/
*   /* 'CALL SSREQ'                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2153
*   DECLARE                                                        2153
*     SSREQ ENTRY BASED(JESSSREQ) OPTIONS(VLIST);                  2153
*   DECLARE                                                        2154
*     IEFW21SD ENTRY BASED(JESALLOC);/* TO ENTER ALLOCATION ISSUE  2154
*                                      CALL IEFW21SD.        @Z40FPPJ*/
*   DECLARE                                                        2155
*     IEFBB410 ENTRY BASED(JESUNALC);/* TO ENTER UNALLOCATION ISSUE
*                                      CALL IEFBB410.        @Z40FPPJ*/
*   DECLARE                                                        2156
*     IEFAB4F5 ENTRY BASED(JESCATL);/* TO ENTER PRIVATE CATALOG    2156
*                                      ALLOCATION ISSUE CALL IEFAB4F5
*                                                            @Z40FPPJ*/
*/*********************************************************  @G18MB04*/
*/* FORMAT OF STORAGE USED TO FIND FIRST SDG IN RE-SORTED    @G18MB04*/
*/* LIST THAT HAD LRU ACTIVITY SINCE LAST SORT OF LIST       @G18MB04*/
*/* AND STORAGE TO USE SUBSYSTEM INTERFACE TO GIVE JES3      @G18MB04*/
*/* THE SORTED LIST AND ADDRESS OF FIRST SDG WITH LRU        @G18MB04*/
*/*********************************************************  @G18MB04*/
*                                                                  2157
*   DCL                                                            2157
*     1 LRUSTGE,                    /*                       @G18MB04*/
*      2 LRULIST,                   /* WILL SAVE EACH NN THAT HAD LRU
*                                      HERE                  @G18MB04*/
*       3 LRUEDNN(28) CHAR(2),      /*                       @G18MB04*/
*      2 LRUSSIB CHAR(LENGTH(SSIB)),/* SUBSYS INTERFACE BLOCK      2157
*                                                            @G18MB04*/
*      2 LRUSSOB CHAR(LENGTH(SSOB)),/* SUBSYS OPTIONS BLOCK  @G18MB04*/
*      2 LRUSSMS CHAR(LENGTH(SSMS)),/* MSSC EXTENSION OF IT  @G18MB04*/
*      2 LRUREGS(18) PTR(31),       /* REGSAVE AREA FOR SUBSYSTEM  2157
*                                                            @G18MB04*/
*      2 LRUCOUNT FIXED(16);        /* COUNT OF LRUED SDGS THIS TIME
*                                                            @G18MB04*/
*   RFY                                                            2158
*     SSOB BASED(ADDR(LRUSSOB));    /*                       @G18MB04*/
*   RFY                                                            2159
*     SSIB BASED(ADDR(LRUSSIB));    /*                       @G18MB04*/
*   RFY                                                            2160
*     SSMS BASED(ADDR(LRUSSMS));    /*                       @G18MB04*/
*   DCL                                                            2161
*     CHARSSOB CHAR(4) INITIAL('SSOB');/* FOR SSOB ID        @G18MB04*/
*   DCL                                                            2162
*     CHARSSIB CHAR(4) INITIAL('SSIB');/* SSIB ID            @G18MB04*/
*   DCL                                                            2163
*     IXSDGL FIXED;                 /* INDEX TO SORTED SDG LIST    2163
*                                                            @G18MB04*/
*   DCL                                                            2164
*     IXLRUNN FIXED;                /* INDEX TO LIST OF LRUED SDGS 2164
*                                                            @G18MB04*/
*   DCL                                                            2165
*     SSIBPTR PTR(31);              /* FOR MAPPING MACRO OF SSIB   2165
*                                                            @G18MB04*/
*/*********************************************************  #Y30LB03*/
*/*  AWAX: MSSC ACTIVITY BUFFER (STAGING DRIVE GROUP LIST)   @ZA08838*/
*/*********************************************************  @Y30LB03*/
*                                                                  2166
*   DCL                                                            2166
*     AWAX CHAR(SDGSLEN) BASED(ICBOPT);/*                    @ZA08838*/
*/*********************************************************  @Y30LB03*/
*/* WORK BUFFER FOR SORTING STAGING DRIVE GROUPS             @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  2167
*   DCL                                                            2167
*     AWBX CHAR(SDGSLEN) BASED(ADDR(AWAX)+SDGSLEN);/*        @ZA08838*/
*   RFY                                                            2168
*     SDGLS BASED(ADDR(AWBX));      /* MAP WORKING COPY      @ZA08838*/
*/*********************************************************  @Y30LB03*/
*                                                                  2169
*   DCL                                                            2169
*     1 SAVESDG,                    /* SAVE AREA FOR SORTING @ZM31027*/
*      2 * CHAR(3),                 /*                       @Y30LB03*/
*      2 * CHAR(2),                 /*                       @Y30LB03*/
*      2 * FIXED(24);               /*                       @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  2170
*   DCL                                                            2170
*     MM CHAR(2);                   /* NUMBER MINUTES        @Y30LB03*/
*   DCL                                                            2171
*     1 CONV1 FIXED(15),            /* WORK FIELD            @Y30LB03*/
*      2 CONV2 CHAR(2);             /* WORK FIELD            @Y30LB03*/
*   GENERATE DATA;                                                 2172
*   DCL                                                            2173
*     SIXTHOU FIXED(15) INIT(6000); /* CONST 6,000           @Y30LB03*/
*   RFY                                                            2174
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1450=R14;                   /*                       @Y30LB03*/
         ST    R14,SAVR1450                                        2175
*   RFY                                                            2176
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   IF FIRST=CHAR0 THEN             /* 1ST TIME ATN INTR?    @Y30LB03*/
         CLI   FIRST,C'0'                                          2177
         BNE   @RF02177                                            2177
*     DO;                           /* YES,....              @Y30LB03*/
*       AWAX=''B;                   /* SET TO BINARY ZEROS   @Y30LB03*/
         L     @12,ICBPTR                                          2179
         L     @12,ICBOPT(,@12)                                    2179
         XC    AWAX(240,@12),AWAX(@12)                             2179
*       AWBX=''B;                   /* SET TO BINARY ZEROS   @Y30LB03*/
         XC    AWBX+240(240,@12),AWBX+240(@12)                     2180
*       DO I=F1 TO F28;             /* INIT AWB WITH LITERAL & NO. 2181
*                                                            @Y30LB03*/
         LA    @12,1                                               2181
         ST    @12,I                                               2181
@DL02181 DS    0H                                                  2182
*         SDG(I)='SDG';             /* ALL LIT FIELDS TO 'SDG'     2182
*                                                            @ZA08838*/
         LR    @09,@12                                             2182
         SLA   @09,3                                               2182
         LA    @04,240                                             2182
         L     @01,ICBPTR                                          2182
         AL    @04,ICBOPT(,@01)                                    2182
         ST    @09,@TF00001                                        2182
         ALR   @09,@04                                             2182
         AL    @09,@CF03340                                        2182
         MVC   SDG(3,@09),@CC03136                                 2182
*         SDGNN(I)=CONST(I);        /* IX PER CONST TBL      @ZA08838*/
         LR    @09,@04                                             2183
         AL    @09,@TF00001                                        2183
         AL    @09,@CF03341                                        2183
         LR    @15,@12                                             2183
         ALR   @15,@15                                             2183
         LA    @14,CONST-2(@15)                                    2183
         MVC   SDGNN-3(2,@09),0(@14)                               2183
*         SDGBBB(I)='   ';          /* BLANKS COMPLETE UNIT NAME   2184
*                                                            @ZA08838*/
         AL    @04,@TF00001                                        2184
         AL    @04,@CF03331                                        2184
         MVC   SDGBBB-5(3,@04),@CC02356                            2184
*         LRUIX(I)=F0;              /* ZERO LAST LRU COUNT   @ZA08838*/
         SLR   @09,@09                                             2185
         STC   @09,LRUIX-1(@12)                                    2185
*       END;                        /* END LOOP              @Y30LB03*/
         AL    @12,@CF00117                                        2186
         ST    @12,I                                               2186
         C     @12,@CF02075                                        2186
         BNH   @DL02181                                            2186
*/********************************************************   @G18MB04*/
*/*INITIALIZE STORAGE FOR SUBSYSTEM INTERFACE TO JES3        @G18MB04*/
*/********************************************************   @G18MB04*/
*                                                                  2187
*       LRUSTGE=LRUSTGE&&LRUSTGE;   /*                       @G18MB04*/
         XC    LRUSTGE(198),LRUSTGE                                2187
*/* FILL IN SUBSYSTEM INTERFACE BLOCK CONSTANT FIELDS        @G18MB04*/
*                                                                  2188
*       SSIBID=CHARSSIB;            /* ID OF LETTERS SSIB    @G18MB04*/
         LA    @12,LRUSSIB                                         2188
         MVC   SSIBID(4,@12),CHARSSIB                              2188
*       SSIBLEN=LENGTH(SSIB);       /* ITS LENGTH            @G18MB04*/
         LA    @09,36                                              2189
         STH   @09,SSIBLEN(,@12)                                   2189
*       SSIBSSNM=JESPJESN;          /* GET INSTALLATION-DEFINED    2190
*                                      SUBSYSTEM NAME        @G18MB04*/
         L     @04,CVTPTR                                          2190
         L     @04,CVTJESCT(,@04)                                  2190
         MVC   SSIBSSNM(4,@12),JESPJESN(@04)                       2190
*/* FILL IN SUBSYSTEM OPTIONS BLOCK CONSTANT FIELDS          @G18MB04*/
*                                                                  2191
*       SSOBID=CHARSSOB;            /* ID OF LETTERS SSOB    @G18MB04*/
         LA    @04,LRUSSOB                                         2191
         MVC   SSOBID(4,@04),CHARSSOB                              2191
*       SSOBLEN=LENGTH(SSOB);       /* ITS LENGTH            @G18MB04*/
         MVC   SSOBLEN(2,@04),@CH01407                             2192
*       SSOBFUNC=SSOBMSSC;          /* MSSC CALLING JES3 FUNCTION  2193
*                                                            @G18MB04*/
         STH   @09,SSOBFUNC(,@04)                                  2193
*       SSOBINDV=ADDR(LRUSSMS);     /* SSOB EXTN ADDR INTO SSOB    2194
*                                                            @G18MB04*/
         LA    @09,LRUSSMS                                         2194
         ST    @09,SSOBINDV(,@04)                                  2194
*       SSOBSSIB=ADDR(SSIB);        /* MUST PROVIDE SSIB     @G18MB04*/
         ST    @12,SSOBSSIB(,@04)                                  2195
*/* FILL IN MSSC KIND OF SUBSYSTEM INTERFACE EXTENSION BLOCK @G18MB04*/
*                                                                  2196
*       SSMSLEN=LENGTH(SSMS);       /* LENGTH OF THIS EXTENSION    2196
*                                                            @G18MB04*/
         MVC   SSMSLEN(2,@09),@CH02050                             2196
*       SSMSPSDG=ADDR(AWBX);        /* WHERE THE SORTED SDG LIST IS
*                                                            @G18MB04*/
         LA    @12,240                                             2197
         L     @04,ICBPTR                                          2197
         AL    @12,ICBOPT(,@04)                                    2197
         ST    @12,SSMSPSDG(,@09)                                  2197
*/********************************************************   @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*GET LOCAL AND CMS LOCKS TO UPDATE ACTIVE ACTIVITY BUFFER  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  2198
*       LOCKRCVY(1:2)=B2ONE;        /* SET LOCK RECOVERY INDICATORS
*                                                            @Y30LB03*/
         OI    LOCKRCVY,B'11000000'                                2198
*       GENERATE;                                                  2199
*                                                                  2199
*                                                          /*@Y30LB03*/
IGETLCL4 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,       @Y30LB03*
               RELATED=(LOCALLK,ICB2MSG(IFRELL1))              @Y30LB03
IGTCMS1  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,         @Y30LB03*
               RELATED=(CMSLK,ICB2MSG(IFRECMS1))               @Y30LB03
*/********************************************************   @Y30LB03*/
*                                                                  2200
*       MVC(AWAX,AWBX);             /* MOVE TO ALLOCATION          2200
*                                      TABLE@Y30LB03                 */
         L     @12,ICBPTR                                          2200
         L     @12,ICBOPT(,@12)                                    2200
         MVC   AWAX(240,@12),AWBX+240(@12)                         2200
*/*********************************************************  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*FREE LOCAL & CMS LOCKS TO UPDATE ACTIVE ACTIVITY BUFFER   @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*********************************************************  @Y30LB03*/
*                                                                  2201
*       GENERATE;                                                  2201
*                                                          /*@Y30LB03*/
IFRECMS1 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                    @Y30LB03*
               RELATED=(CMSLK,ICB2MSG(IGTCMS1))                @Y30LB03
IFRELL1  SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                  @Y30LB03*
               RELATED=(LOCALLK,ICB2MSG(IGETLCL4))             @Y30LB03
*       LOCKRCVY(1:2)=B2ZERO;       /* SET LOCK RECOVERY INDICATORS
*                                                            @Y30LB03*/
*                                                                  2202
         NI    LOCKRCVY,B'00111111'                                2202
*       /*************************************************************/
*       /*                                                           */
*       /* ************************************************* @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2203
*       FIRST=CHAR1;                /* END OF FIRST PASS     @Y30LB03*/
         MVI   FIRST,C'1'                                          2203
*     END;                          /*                       @Y30LB03*/
*   IF REENTRY^=ADDR(REINIT) THEN   /* IF NOT 1ST PASS,      @G24LB02*/
@RF02177 LA    @12,REINIT                                          2205
         C     @12,REENTRY                                         2205
         BE    @RF02205                                            2205
*     REENTRY=ADDR(SETTIME);        /* SET NEW STAE REENTRY  @G24LB02*/
         LA    @12,SETTIME                                         2206
         ST    @12,REENTRY                                         2206
*   SAVREENT=REENTRY;               /* SAVE REENTRY POINTER  @G24LB02*/
@RF02205 L     @12,REENTRY                                         2207
         ST    @12,SAVREENT                                        2207
*   REENTRY=ADDR(QUERRET);          /* SET NEW STAE REENTRY  @G24LB02*/
         LA    @12,QUERRET                                         2208
         ST    @12,REENTRY                                         2208
*   SVCCALL=ON;                     /* SET SVC CALL FLAG     @G24LB02*/
*                                                                  2209
         OI    SVCCALL,B'00001000'                                 2209
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************************** @Y30LB03*/
*   /* ISSUE ICBQUERY TO OBTAIN THE MOUNT EQUALIZATION       @ZA08838*/
*   /* RECORD FROM THE MSC                                   @ZA08838*/
*   /* ***************************************************** @ZA08838*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2210
*ICBQUE1:                                                          2210
*                                                                  2210
*   /*****************************************************************/
*   /*                                                               */
*   /* *******************************************************       */
*   /*                                                       @Z40LB22*/
*   /* MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL MACRO        @Z40LB22*/
*   /* OS/VS2 VERSION-- 03/21/75 LEVEL 00                    @Z40LB22*/
*   /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.              @Z40LB22*/
*   /* THE LIST FORM OF THIS MACRO SHOULD BE                 @Z40LB22*/
*   /* INVOKED FIRST IN ORDER TO SET UP NECESSARY            @Z40LB22*/
*   /* DECLARES. IF THE COMPLETE ARGUMENT IS                 @Z40LB22*/
*   /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.               @Z40LB22*/
*   /* *******************************************************       */
*   /*                                                       @Z40LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2210
*   RFY                                                            2210
*    (QUERR1) RSTD;                 /* RESTRICT R1           @Z40LB22*/
ICBQUE1  DS    0H                                                  2211
*   QUERR1=ADDR(QUERLIST);          /* SET QUERR1 TO REQ BLOCK     2211
*                                                            @Z40LB22*/
         LA    QUERR1,QUERLIST                                     2211
*   QUERLIST=QUERLIST&&QUERLIST;    /* ZERO REQUEST BLOCK    @Z40LB22*/
         XC    QUERLIST(44),QUERLIST                               2212
*   QULEN='2C'X;                    /* SET LENGTH FIELD      @Z40LB22*/
         LA    @12,44                                              2213
         ST    @12,QULEN                                           2213
*   QUORD='0B'X;                    /* SET OPCODE FIELD      @Z40LB22*/
         MVI   QUORD,X'0B'                                         2214
*   QUCODE='03'X;                   /* SET CODE TYPE         @Z40LB22*/
         MVI   QUCODE,X'03'                                        2215
*   QUSECT=('C9'X);                 /* FILL IN SECTOR ID     @Z40LB22*/
         MVI   QUSECT,X'C9'                                        2216
*   QUPTR=ADDR(BUFFER);             /* ADDR OF DATAPTR FIELD @Z40LB22*/
         LA    @12,24                                              2217
         AL    @12,CCWSPTR                                         2217
         ST    @12,QUPTR                                           2217
*   SVC(126);                       /* ISSUE SVC INST.       @Z40LB22*/
         SVC   126                                                 2218
*   RFY                                                            2219
*    (QUERR1) UNRSTD;               /* UNRESTRICT R1         @Z40LB22*/
*                                                                  2219
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @ZA08838*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2220
*   RESPECIFY                                                      2220
*    (R15) RSTD;                    /* RESTRICT REGS         @ZA08838*/
*QUERRET:                           /* LABEL FOR RETURN      @G24LB02*/
*   SVCCALL=OFF;                    /* CLEAR SVC CALL FLAG   @G24LB02*/
QUERRET  NI    SVCCALL,B'11110111'                                 2221
*   REENTRY=SAVREENT;               /* SET REENTRY           @G24LB02*/
         L     @14,SAVREENT                                        2222
         ST    @14,REENTRY                                         2222
*   IF R15=F0 THEN                  /* GOOD RETURN           @Y30LB03*/
         SLR   @14,@14                                             2223
         CR    R15,@14                                             2223
         BNE   @RF02223                                            2223
*     DO;                           /*                       @ZA08838*/
*                                                                  2224
*       /*************************************************************/
*       /*                                                           */
*       /* ****************************************          @G18MB04*/
*       /* RESET COUNTERS FOR FINDING FIRST LRU              @G18MB04*/
*       /* ****************************************          @G18MB04*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2225
*       LRUCOUNT=F0;                /* NO LRU FOUND THIS TIME      2225
*                                                            @G18MB04*/
         STH   @14,LRUCOUNT                                        2225
*       LRULIST='';                 /* CLEAR SDGS WITH LRU   @G18MB04*/
         MVI   LRULIST,C' '                                        2226
         MVC   LRULIST+1(55),LRULIST                               2226
*       SSMSPLRU=F0;                /* NO SDGS WITH LRU YET  @G18MB04*/
*                                                                  2227
         LA    @12,LRUSSMS                                         2227
         ST    @14,SSMSPLRU(,@12)                                  2227
*       /*************************************************************/
*       /*                                                           */
*       /* ****************************************          @Y30LB03*/
*       /* INITIALIZE AWB WORK BUFFER ACCORD                 @Y30LB03*/
*       /* ING TO USABILITY OF EACH STAGING DRV GRP          @Y30LB03*/
*       /* ****************************************          @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2228
*       DO I=F1 TO F28;             /*                       @Y30LB03*/
*                                                                  2228
         LA    @14,1                                               2228
         ST    @14,I                                               2228
@DL02228 DS    0H                                                  2229
*         /***********************************************************/
*         /*                                                         */
*         /* ***********************************             @Y30LB03*/
*         /* EXECUTE USABILITY ALGORITHM                     @Y30LB03*/
*         /* ***********************************             @Y30LB03*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  2229
*         IF UA(I)=F0AVL(I)=F0CAP(I)=F0 THEN/* CK ZERO FLDS      2229
*                                                            @ZA13483*/
         SLA   @14,2                                               2229
         LA    @12,24                                              2229
         AL    @12,CCWSPTR                                         2229
         LH    @09,UA-4(@14,@12)                                   2229
         N     @09,@CF02463                                        2229
         LTR   @09,@09                                             2229
         BZ    @RT02229                                            2229
         SLR   @09,@09                                             2229
         LA    @04,0(@14,@12)                                      2229
         AL    @04,@CF03331                                        2229
         SLR   @11,@11                                             2229
         IC    @11,AVL-1(,@04)                                     2229
         CR    @09,@11                                             2229
         BE    @RT02229                                            2229
         SLR   @04,@04                                             2229
         IC    @04,CAP-4(@14,@12)                                  2229
         CR    @09,@04                                             2229
         BNE   @RF02229                                            2229
@RT02229 DS    0H                                                  2230
*           SDGIX(I)=F0;            /* SET SORT VALUE        @ZA00671
*                                      TO ZERO               @ZA00671*/
         L     @14,I                                               2230
         SLA   @14,3                                               2230
         L     @12,ICBPTR                                          2230
         L     @12,ICBOPT(,@12)                                    2230
         ALR   @12,@14                                             2230
         SLR   @14,@14                                             2230
         STCM  @14,7,SDGIX+232(@12)                                2230
*         ELSE                      /*                       @ZA00671*/
*           IF MV(I)=F0 THEN        /* IS NUMBER OF          @ZA00671
*                                      MOUNTED VOLUMES       @ZA00671
*                                      ZERO                  @ZA00671*/
         B     @RC02229                                            2231
@RF02229 L     @14,I                                               2231
         LR    @12,@14                                             2231
         SLA   @12,2                                               2231
         L     @09,CCWSPTR                                         2231
         LH    @12,MV+20(@12,@09)                                  2231
         N     @12,@CF02463                                        2231
         LTR   @12,@12                                             2231
         BNZ   @RF02231                                            2231
*             SDGIX(I)=MAX;         /* SET SORT VALUE TO     @ZA00671
*                                      A LARGE VALUE         @ZA00671*/
         SLA   @14,3                                               2232
         L     @12,ICBPTR                                          2232
         L     @12,ICBOPT(,@12)                                    2232
         ALR   @12,@14                                             2232
         MVC   SDGIX+232(3,@12),@CF03011+1                         2232
*           ELSE                    /*                       @ZA00671*/
*                                                                  2233
*             /*******************************************************/
*             /*                                                     */
*             /* CALCULATE SORT VALUE                        @ZA00671*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  2233
*             SDGIX(I)=(UA(I)*AVL(I)*PREC)/*                 @ZA00671*/
*                 /(CAP(I)*MV(I));  /*                       @ZA00671*/
         B     @RC02231                                            2233
@RF02231 L     @14,I                                               2233
         LR    @12,@14                                             2233
         SLA   @12,3                                               2233
         L     @09,ICBPTR                                          2233
         L     @09,ICBOPT(,@09)                                    2233
         SLA   @14,2                                               2233
         LA    @04,24                                              2233
         AL    @04,CCWSPTR                                         2233
         LA    @01,0(@14,@04)                                      2233
         AL    @01,@CF03331                                        2233
         SLR   @03,@03                                             2233
         IC    @03,AVL-1(,@01)                                     2233
         LH    @11,UA-4(@14,@04)                                   2233
         N     @11,@CF02463                                        2233
         MR    @02,@11                                             2233
         MH    @03,@CH03014                                        2233
         LA    @01,0(@14,@04)                                      2233
         BCTR  @01,0                                               2233
         BCTR  @01,0                                               2233
         LH    @01,MV-2(,@01)                                      2233
         N     @01,@CF02463                                        2233
         SLR   @02,@02                                             2233
         IC    @02,CAP-4(@14,@04)                                  2233
         MR    @00,@02                                             2233
         LR    @10,@03                                             2233
         SRDA  @10,32                                              2233
         DR    @10,@01                                             2233
         ALR   @09,@12                                             2233
         STCM  @11,7,SDGIX+232(@09)                                2233
*         IF(LRU(I)=LRUIX(I)) THEN  /* HAS SDG BEEN          @ZA00671
*                                      LRU ED                @ZA00671*/
@RC02231 DS    0H                                                  2234
@RC02229 L     @14,I                                               2234
         LR    @12,@14                                             2234
         SLA   @12,2                                               2234
         L     @09,CCWSPTR                                         2234
         SLR   @04,@04                                             2234
         IC    @04,LRU+20(@12,@09)                                 2234
         SLR   @12,@12                                             2234
         IC    @12,LRUIX-1(@14)                                    2234
         CR    @04,@12                                             2234
         BNE   @RF02234                                            2234
*           IF(SDGIX(I)^=F0) THEN   /* IS THE SORT           @ZA00671
*                                      VALUE ZERO            @ZA00671*/
         SLA   @14,3                                               2235
         LA    @12,240                                             2235
         L     @09,ICBPTR                                          2235
         AL    @12,ICBOPT(,@09)                                    2235
         LA    @09,0(@14,@12)                                      2235
         AL    @09,@CF03342                                        2235
         L     @09,SDGIX-5(,@09)                                   2235
         LA    @09,0(,@09)                                         2235
         LTR   @09,@09                                             2235
         BZ    @RF02235                                            2235
*             SDGIX(I)=SDGIX(I)+LRUED;/* ADD LARGE NO        @ZA00671
*                                      TO SORT               @ZA00671
*                                      VALUE                 @ZA00671*/
         AL    @09,@CF03011                                        2236
         ALR   @12,@14                                             2236
         AL    @12,@CF03331                                        2236
         STCM  @09,7,SDGIX-5(@12)                                  2236
*           ELSE                                                   2237
*             ;                     /*                       @G18MB04*/
@RF02235 DS    0H                                                  2238
*         ELSE                      /* THERE WAS LRU ACTIVITY      2238
*                                                            @G18MB04*/
*           DO;                     /*                       @G18MB04*/
         B     @RC02234                                            2238
@RF02234 DS    0H                                                  2239
*             LRUIX(I)=LRU(I);      /* SAVE LRU COUNT        @G18MB04*/
         L     @14,I                                               2239
         LR    @12,@14                                             2239
         SLA   @12,2                                               2239
         L     @09,CCWSPTR                                         2239
         SLR   @04,@04                                             2239
         IC    @04,LRU+20(@12,@09)                                 2239
         STC   @04,LRUIX-1(@14)                                    2239
*             LRUCOUNT=LRUCOUNT+1;  /* COUNT SDGS LRUED      @G18MB04*/
         LH    @12,LRUCOUNT                                        2240
         N     @12,@CF02463                                        2240
         LA    @12,1(,@12)                                         2240
         STH   @12,LRUCOUNT                                        2240
*             LRUEDNN(LRUCOUNT)=CONST(I);/* SAVE ITS NO.     @G18MB04*/
         ALR   @12,@12                                             2241
         LA    @09,LRUEDNN-2(@12)                                  2241
         ALR   @14,@14                                             2241
         LA    @12,CONST-2(@14)                                    2241
         MVC   0(2,@09),0(@12)                                     2241
*           END;                    /*                       @G18MB04*/
*         SDG(I)='SDG';             /* LITERAL FILL          @ZA08838*/
@RC02234 L     @14,I                                               2243
         LR    @12,@14                                             2243
         SLA   @12,3                                               2243
         LA    @09,240                                             2243
         L     @04,ICBPTR                                          2243
         AL    @09,ICBOPT(,@04)                                    2243
         ST    @12,@TF00001                                        2243
         ALR   @12,@09                                             2243
         AL    @12,@CF03340                                        2243
         MVC   SDG(3,@12),@CC03136                                 2243
*         SDGNN(I)=CONST(I);        /* CONSTANT FILL         @ZA08838*/
         AL    @09,@TF00001                                        2244
         AL    @09,@CF03341                                        2244
         LR    @12,@14                                             2244
         ALR   @12,@12                                             2244
         LA    @04,CONST-2(@12)                                    2244
         MVC   SDGNN-3(2,@09),0(@04)                               2244
*       END;                        /*                       @Y30LB03*/
         AL    @14,@CF00117                                        2245
         ST    @14,I                                               2245
         C     @14,@CF02075                                        2245
         BNH   @DL02228                                            2245
*       RFY                                                        2246
*         R15 UNRSTD;               /*                       @G24LB02*/
*                                                                  2246
*       /*************************************************************/
*       /*                                                           */
*       /* ***********************************               @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2247
*                                                                  2247
*       /*************************************************************/
*       /*                                                           */
*       /* **********************************                @Y30LB03*/
*       /* BINARY SORT GROUP ELEMENTS (IN AWB)               @Y30LB03*/
*       /* IN DECENDING ORDER OF SDGIX FIELDS                @ZM31027*/
*       /* **********************************                @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2247
*       DO I=F1 TO F27;             /*                       @Y30LB03*/
         LA    @12,1                                               2247
         ST    @12,I                                               2247
@DL02247 DS    0H                                                  2248
*         DO J=F1 TO(F28-I);        /*                       @Y30LB03*/
         LA    @12,1                                               2248
         B     @DE02248                                            2248
@DL02248 DS    0H                                                  2249
*           IF SDGIX(J)<SDGIX(J+F1) THEN/*                   @ZM31027*/
         SLA   @12,3                                               2249
         LA    @09,240                                             2249
         L     @04,ICBPTR                                          2249
         AL    @09,ICBOPT(,@04)                                    2249
         ST    @12,@TF00001                                        2249
         ALR   @12,@09                                             2249
         AL    @12,@CF03331                                        2249
         LR    @04,@09                                             2249
         AL    @04,@TF00001                                        2249
         CLC   SDGIX-5(3,@12),SDGIX(@04)                           2249
         BNL   @RF02249                                            2249
*             DO;                   /*                       @Y30LB03*/
*               SAVESDG=SDGNNBBB(J);/*                       @ZA08838*/
         LR    @12,@09                                             2251
         AL    @12,@TF00001                                        2251
         AL    @12,@CF03340                                        2251
         MVC   SAVESDG(8),SDGNNBBB(@12)                            2251
*               SDGNNBBB(J)=SDGNNBBB(J+F1);/*                @ZA08838*/
         LR    @12,@09                                             2252
         AL    @12,@TF00001                                        2252
         AL    @12,@CF03340                                        2252
         LR    @04,@09                                             2252
         AL    @04,@TF00001                                        2252
         MVC   @TS00001(8),SDGNNBBB(@04)                           2252
         MVC   SDGNNBBB(8,@12),@TS00001                            2252
*               SDGNNBBB(J+F1)=SAVESDG;/*                    @ZA08838*/
         AL    @09,@TF00001                                        2253
         MVC   SDGNNBBB(8,@09),SAVESDG                             2253
*             END;                  /*                       @Y30LB03*/
*         END;                      /*                       @Y30LB03*/
@RF02249 LA    @12,1                                               2255
         AL    @12,J                                               2255
@DE02248 ST    @12,J                                               2255
         LA    @09,28                                              2255
         SL    @09,I                                               2255
         CR    @12,@09                                             2255
         BNH   @DL02248                                            2255
*       END;                        /*                       @Y30LB03*/
*                                                                  2256
         LA    @12,1                                               2256
         AL    @12,I                                               2256
         ST    @12,I                                               2256
         C     @12,@CF02073                                        2256
         BNH   @DL02247                                            2256
*       /*************************************************************/
*       /*                                                           */
*       /* ******************************                    @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2257
*                                                                  2257
*       /*************************************************************/
*       /*                                                           */
*       /* BLANK OUT SDGIX FIELDS                            @ZM31027*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2257
*       DO I=F1 TO F28;             /* LOOP                  @Y30LB03*/
         LA    @12,1                                               2257
         ST    @12,I                                               2257
@DL02257 DS    0H                                                  2258
*         SDGBBB(I)='   ';          /* BLANKOUT              @ZA08838*/
         LR    @09,@12                                             2258
         SLA   @09,3                                               2258
         L     @04,ICBPTR                                          2258
         L     @04,ICBOPT(,@04)                                    2258
         ALR   @04,@09                                             2258
         MVC   SDGBBB+232(3,@04),@CC02356                          2258
*       END;                        /*                       @Y30LB03*/
         AL    @12,@CF00117                                        2259
         ST    @12,I                                               2259
         C     @12,@CF02075                                        2259
         BNH   @DL02257                                            2259
*/*******************************************************    @G18MB04*/
*/* THIS IS THE INTERFACE TO JES3, GIVING ADDRESS OF JUST-   @G18MB04*/
*/* SORTED LIST, AND ADDRESS OF FIRST SDG IN LIST WITH LRU,  @G18MB04*/
*/* IF ANY                                                   @G18MB04*/
*/*******************************************************    @G18MB04*/
*                                                                  2260
*       IF LRUCOUNT=F0              /* WAS THERE NO LRU ?    @G18MB04*/
*         THEN                                                     2260
         LH    @12,LRUCOUNT                                        2260
         N     @12,@CF02463                                        2260
         LTR   @12,@12                                             2260
         BZ    @RT02260                                            2260
*         ;                         /* NO LRU, SSMSPLRU STILL ZERO 2261
*                                                            @G18MB04*/
*       ELSE                        /* THERE WAS LRU IN AT LEAST ONE
*                                      SDG, FIND FIRST       @G18MB04*/
*         DO IXSDGL=1 TO 28 WHILE SSMSPLRU=F0;/* SCAN SORTED LIST  2262
*                                                            @G18MB04*/
         LA    @12,1                                               2262
         ST    @12,IXSDGL                                          2262
@DL02262 LA    @12,LRUSSMS                                         2262
         L     @12,SSMSPLRU(,@12)                                  2262
         LTR   @12,@12                                             2262
         BNZ   @DC02262                                            2262
*           DO IXLRUNN=1 TO LRUCOUNT WHILE SSMSPLRU=F0;/* SCAN LIST
*                                      OF NNS THAT HAD LRU THIS TIME
*                                                            @G18MB04*/
         LA    @12,1                                               2263
         B     @DE02263                                            2263
@DL02263 LA    @09,LRUSSMS                                         2263
         L     @04,SSMSPLRU(,@09)                                  2263
         LTR   @04,@04                                             2263
         BNZ   @DC02263                                            2263
*             IF SDGNN(IXSDGL)=LRUEDNN(IXLRUNN)/* THIS NN ?  @G18MB04*/
*               THEN                /* FOUND FIRST IN SORTED LIST  2264
*                                      WITH LRU ACTIVITY     @G18MB04*/
         L     @04,IXSDGL                                          2264
         SLA   @04,3                                               2264
         LA    @15,240                                             2264
         L     @14,ICBPTR                                          2264
         AL    @15,ICBOPT(,@14)                                    2264
         ALR   @12,@12                                             2264
         ST    @04,@TF00001                                        2264
         ALR   @04,@15                                             2264
         AL    @04,@CF03341                                        2264
         LA    @01,LRUEDNN-2(@12)                                  2264
         CLC   SDGNN-3(2,@04),0(@01)                               2264
         BNE   @RF02264                                            2264
*               SSMSPLRU=ADDR(SDGNNBBB(IXSDGL));/* PTR FOR JES3    2265
*                                                            @G18MB04*/
         L     @12,@TF00001                                        2265
         AL    @15,@CF03340                                        2265
         LA    @12,SDGNNBBB(@12,@15)                               2265
         ST    @12,SSMSPLRU(,@09)                                  2265
*             ELSE                                                 2266
*               ;                   /*                       @G18MB04*/
@RF02264 DS    0H                                                  2267
*           END;                    /* LOOKING AT LRUED LIST FOR   2267
*                                      SINGLE SDGNNBBB       @G18MB04*/
         LA    @12,1                                               2267
         AL    @12,IXLRUNN                                         2267
@DE02263 ST    @12,IXLRUNN                                         2267
         LH    @09,LRUCOUNT                                        2267
         N     @09,@CF02463                                        2267
         CR    @12,@09                                             2267
         BNH   @DL02263                                            2267
@DC02263 DS    0H                                                  2268
*         END;                      /* SCANNING SORTED LIST OF     2268
*                                      SDGNNBBBS             @G18MB04*/
         LA    @12,1                                               2268
         AL    @12,IXSDGL                                          2268
         ST    @12,IXSDGL                                          2268
         C     @12,@CF02075                                        2268
         BNH   @DL02262                                            2268
@DC02262 DS    0H                                                  2269
*/*******************************************************    @G18MB04*/
*/* PASS SORTED LIST AND PTR TO 1ST SDG WITH LRU TO JES3,    @G18MB04*/
*/* VIA THE SUBSYSTEM INTERFACE                              @G18MB04*/
*/*******************************************************    @G18MB04*/
*                                                                  2269
*       RFY                                                        2269
*        (R13) RSTD;                /*                       @G18MB04*/
@RT02260 DS    0H                                                  2270
*       SAVR13=R13;                 /* SAVE PRESENT CONTENTS OF    2270
*                                      REGISTER 13           @G18MB04*/
         ST    R13,SAVR13                                          2270
*       R13=ADDR(LRUREGS);          /* THIS FOR SUBSYSTEM FUNCTION 2271
*                                      USE                   @G18MB04*/
*                                                                  2271
         LA    R13,LRUREGS                                         2271
*       /*************************************************************/
*       /*                                                           */
*       /* ? IEFSSREQ (LRUSSOB);                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  2272
*/*                                                                  */
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */
*/*  PROCESS REQUEST -                                               */
*/*                                                                  */
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */
*/*            WORD PARAMETER LIST WHICH                             */
*/*            POINTS TO THE SSOB                                    */
*/*                                                                  */
*                                                                  2272
*       CALL SSREQ(LRUSSOB);        /* INVOKE SUBSYSTEM INTERFACE  2272
*                                                            @G18MB04*/
         L     @12,CVTPTR                                          2272
         L     @12,CVTJESCT(,@12)                                  2272
         L     @15,JESSSREQ(,@12)                                  2272
         LA    @01,@AL02272                                        2272
         BALR  @14,@15                                             2272
*       R13=SAVR13;                 /* BACK TO ORIGINAL REGISTER 13
*                                      CONTENTS              @G18MB04*/
         L     R13,SAVR13                                          2273
*       RFY                                                        2274
*        (R13) UNRSTD;              /*                       @G18MB04*/
*/*******************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*GET LOCAL AND CMS LOCKS TO UPDATE ACTIVE ACTIVITY BUFFER  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/********************************************************   @Y30LB03*/
*                                                                  2275
*       LOCKRCVY(1:2)=B2ONE;        /* SET LOCK RECOVERY INDICATORS
*                                                            @Y30LB03*/
         OI    LOCKRCVY,B'11000000'                                2275
*       GENERATE;                                                  2276
*                                                                  2276
*                                                          /*@Y30LB03*/
IGETLCL5 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,       @Y30LB03*
               RELATED=(LOCALLK,ICB2MSG(IFRELL2))              @Y30LB03
IGTCMS4  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,         @Y30LB03*
               RELATED=(CMSLK,ICB2MSG(IFRCMSL2))              @Y30LB03
*/******************************************************     @Y30LB03*/
*                                                                  2277
*       MVC(AWAX,AWBX);             /* MOVE UPDATED WORK     @Y30LB03
*                                      BUFFER TO ACTIVITY    @Y30LB03
*                                      TABLES                @Y30LB03*/
         L     @12,ICBPTR                                          2277
         L     @12,ICBOPT(,@12)                                    2277
         MVC   AWAX(240,@12),AWBX+240(@12)                         2277
*/********************************************************   @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*FREE LOCAL & CMS LOCKS TO UPDATE ACTIVE ACTIVITY BUFFER   @Y30LB03*/
*/*                                                          @Y30LB03*/
*/********************************************************   @Y30LB03*/
*                                                                  2278
*       GENERATE;                                                  2278
*                                                          /*@Y30LB03*/
IFRCMSL2 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                    @Y30LB03*
               RELATED=(CMSLK,ICB2MSG(IGTCMS4))                @Y30LB03
IFRELL2  SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                  @Y30LB03*
               RELATED=(LOCALLK,ICB2MSG(IGETLCL5))             @Y30LB03
*       LOCKRCVY(1:2)=B2ZERO;       /* SET LOCK RECOVERY INDICATORS
*                                                            @Y30LB03*/
         NI    LOCKRCVY,B'00111111'                                2279
*/********************************************************   @Y30LB03*/
*                                                                  2280
*     END;                          /*                       @Y30LB03*/
*SETTIME:                           /* SETUP FOR STIMER      @Y30LB03*/
*   IF REENTRY^=ADDR(REINIT) THEN   /* IF NOT 1ST PASS,      @Y30LB03*/
@RF02223 DS    0H                                                  2281
SETTIME  LA    @12,REINIT                                          2281
         C     @12,REENTRY                                         2281
         BE    @RF02281                                            2281
*     REENTRY=ADDR(SCAN);           /* SET STAE REENTRY      @Y30LB03*/
         LA    @12,SCAN                                            2282
         ST    @12,REENTRY                                         2282
*   DBLWORD=''B;                    /* CLEAR CONV AREA       @Z40LB01*/
@RF02281 XC    DBLWORD(8),DBLWORD                                  2283
*   MM=ICBSAMP;                     /* SET SAMPLE TIME       @ZM31129*/
         L     @12,ICBPTR                                          2284
         MVC   MM(2),ICBSAMP(@12)                                  2284
*   GENERATE;                                                      2285
*                                                          /*@ZM31129*/
         PACK  MM,MM                PACK MM(MINUTES) SPECIFD   @ZM31129
         MVC   DBLWORD+CON6(CON2),MM  MOVE MM TO DBL WRD BDY   @ZM31129
         CVB   R4,DBLWORD           CONVERT MM TO BINARY       @ZM31129
         MH    R4,SIXTHOU           GET IN REAL MINUTE FORM    @ZM31129
         ST    R4,TMER              INIT TMER(TIMER)           @ZM31129
*   ICBACTV=F0;                     /* CLEAR ACTIVITY ECB    @Y30LB03*/
         L     @12,ICBPTR                                          2286
         SLR   @09,@09                                             2286
         ST    @09,ICBACTV(,@12)                                   2286
*   RESPECIFY                                                      2287
*     R3 RSTD;                      /* RESTRICT R3           @Y30LB03*/
*   R3=ICB2ACTP;                    /* SET R3 FOR STIMER     @Y30LB03*/
         L     R3,ICB2ACTP(,@12)                                   2288
*ISTIMER1:                                                         2289
*   GEN(STIMER REAL,(R3),BINTVL=TMER);/* ISSUE STIMER        @Y30LB03*/
ISTIMER1 STIMER REAL,(R3),BINTVL=TMER
*   RFY                                                            2290
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1450;                   /* RESTORE R14           @Y30LB03*/
         L     R14,SAVR1450                                        2291
*   RFY                                                            2292
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RESPECIFY                                                      2293
*     R3 UNRSTD;                    /* FREE R13              @Y30LB03*/
*   RETURN;                         /* RTN TO ICB2MSG        @Y30LB03*/
@EL00024 DS    0H                                                  2294
@EF00024 DS    0H                                                  2294
@ER00024 BR    @14                                                 2294
*   END ICBMSG50;                   /* END SUBROUTINE        @Z40LB01*/
*ICBMSG55:                                                         2296
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/
ICBMSG55 DS    0H                                                  2297
*/********************************************************   @Z40LB01*/
*/*                                                          @Z40LB01*/
*/*  PROCEDURE NAME - ICBMSG55                               @Z40LB01*/
*/*                                                          @Z40LB01*/
*/*  FUNCTION - DISPLAY 3850 COMMAND INITIALIZATION          @Z40LB01*/
*/*             PROCESSING. THIS PROC DOES THE INITIAL       @Z40LB01*/
*/*             HOUSKEEPING AND ISSUES AN ICBPAIR MACRO      @Z40LB01*/
*/*             WITH THE INITIALIZE FOR STATUS UPDATE        @Z40LB01*/
*/*             MESSAGE. IF THE INITIALIZE ORDER FAILS,      @Z40LB01*/
*/*             A MESSAGE WILL BE ISSUED TO THE OPERATOR     @Z40LB01*/
*/*             ADVISING HIM OF THE FAILURE AND REASON CODE  @Z40LB01*/
*/*             FOR THE FAILURE. IF MORE THAN ONE DISPLAY    @Z40LB01*/
*/*             COMMAND IS PROCESSED WHILE A REQUEST FOR     @Z40LB01*/
*/*             THE STATUS UPDATE MESSAGE IS STILL OPEN,     @Z40LB01*/
*/*             THE NEW COMMAND REQUEST IS QUEUED ON AN      @Z40LB01*/
*/*             INTERNAL QUEUE SO IT WILL ALSO GET           @Z40LB01*/
*/*             PROCESSED WITH THE SAME STATUS MESSAGE       @Z40LB01*/
*/*             WHEN IT IS RECEIVED.                         @Z40LB01*/
*/*                                                          @Z40LB01*/
*/*  INPUT - POINTER TO THE CWB TO BE PROCESSED.             @Z40LB01*/
*/*                                                          @Z40LB01*/
*/*  OUTPUT - ICBPAIR INITIALIZE FOR STATUS UPDATE MESSAGE.  @Z40LB01*/
*/*           QUEUED CWB FOR DISPLAY PROCESSING.             @Z40LB01*/
*/*           ERROR MESSAGE TO OPERATOR ON INITIALIZE FAIL.  @Z40LB01*/
*/*           RESET CMD QUEUE POINTER IF NO MORE CWBS.       @Z40LB01*/
*/*           CURRENT DISPLAY CMD CWB DEQUEUED.              @Z40LB01*/
*/*           SET MSG92FLG.                                  @Z40LB01*/
*/*                                                          @Z40LB01*/
*/*  MESSAGES - ICB056I DISPLAY 3850 FAILED -                @Z40LB01*/
*/*             INITIALIZE REASON CODE AAA.                  @Z40LB01*/
*/*             SYNTAX ERROR IN COMMAND.                     @Z40LB01*/
*/*             INSUFFICIENT QUEUE SPACE.                    @Z40LB01*/
*/*                                                          @Z40LB01*/
*/********************************************************   @Z40LB01*/
*                                                                  2297
*   DCL                                                            2297
*     SPACEMSG CHAR(26) INIT(       /* QUEUE FULL MSG TEXT   @Z40LB01*/
*         'INSUFFICIENT QUEUE SPACE  ');/*                   @Z40LB01*/
*   DCL                                                            2298
*     SYNTXMSG CHAR(26) INIT(       /* SYNTAX ERROR MSG TEXT @Z40LB01*/
*         'SYNTAX ERROR IN COMMAND   ');/*                   @Z40LB01*/
*   DCL                                                            2299
*     INITATTS BIT(16) INIT('8000'X);/* ICBPAIR ATTRIBUTES   @Z40LB01*/
*   DCL                                                            2300
*     1 CONVID1 CHAR(3),            /* COMPARE SSID 1 FIELD  @Z40LB01*/
*      2 BEGID1 FIXED(8),           /* BEGINNING CHARACTER   @Z40LB01*/
*      2 MIDID1 FIXED(8),           /* MIDDLE CHARACTER      @Z40LB01*/
*      2 ENDID1 FIXED(8);           /* END CHARACTER         @Z40LB01*/
*   DCL                                                            2301
*     1 CONVID2 CHAR(3),            /* COMPARE SSID 2 FIELD  @Z40LB01*/
*      2 BEGID2 FIXED(8),           /* BEGINNING CHARACTER   @Z40LB01*/
*      2 MIDID2 FIXED(8),           /* MIDDLE CHARACTER      @Z40LB01*/
*      2 ENDID2 FIXED(8);           /* END CHARACTER         @Z40LB01*/
*   DCL                                                            2302
*     1 VALSID CHAR(5),             /* VALIDATE SSID         @ZA30157*/
*      2 CSSID CHAR(4),             /* COMMA & SSID          @ZA30157*/
*      2 CORB CHAR(1);              /* COMMA OR BLANK        @ZA30157*/
*                                                                  2303
*/********************************************************   @Z40LB01*/
*/*                                                          @Z40LB01*/
*/* THE FOLLOWING CODE SYNTAX CHECKS THE COMMAND.            @Z40LB01*/
*/*                                                          @Z40LB01*/
*/********************************************************   @Z40LB01*/
*                                                                  2303
*   RFY                                                            2303
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1455=R14;                   /* SAVE RETURN ADDRESS   @Z40LB01*/
         ST    R14,SAVR1455                                        2304
*   RFY                                                            2305
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   EXITSW=OFF;                     /* CLEAR BYPASS SWITCH   @ZA30157*/
*   DSPERR=OFF;                     /* CLEAR ERROR SWITCH    @ZA30157*/
         NI    EXITSW,B'11110011'                                  2307
*   DSPFLG=''B;                     /* CLEAR DISPLAY FLAGS   @Z40LB01*/
         L     @12,CWBPTR                                          2308
         MVI   DSPFLG(@12),X'00'                                   2308
*   PTHFLG=ZERO;                    /* ZERO FLAGS & CWBOFF   @ZA30157*/
         MVC   PTHFLG(3,@12),ZERO                                  2309
*   IF CWBCMND(5:5)=' ' THEN        /* TEST FOR DEFAULT OPT  @Z40LB01*/
         CLI   CWBCMND+4(@12),C' '                                 2310
         BNE   @RF02310                                            2310
*     DO;                           /* DISPLAY ALL UNITS     @Z40LB01*/
*       DSPALL=ON;                  /* SET DISPLAY ALL FLAG  @ZA30157*/
         OI    DSPALL(@12),B'10000000'                             2312
*       EXITSW=ON;                  /* SET EXIT ON,NO MORE   @ZA30157*/
         OI    EXITSW,B'00001000'                                  2313
*     END;                          /* END DSP ALL CODE      @Z40LB01*/
*   IF EXITSW=OFF THEN              /* SYNTAX NOT COMPLETE   @Z40LB01*/
@RF02310 TM    EXITSW,B'00001000'                                  2315
         BNZ   @RF02315                                            2315
*     DO;                           /* CONTINUE SYNTAX CHECK @Z40LB01*/
*       IF CWBCMND(5:8)=',SDG' THEN /* TEST FOR SDG DISPLAY  @Z40LB01*/
         L     @12,CWBPTR                                          2317
         CLC   CWBCMND+4(4,@12),@CC03173                           2317
         BNE   @RF02317                                            2317
*         DO;                       /* DISPLAY SDG REQUEST   @Z40LB01*/
*           DSPSDG=ON;              /* SET DISPLAY SDG FLAG  @ZA30157*/
         OI    DSPSDG(@12),B'00010000'                             2319
*           S=F9;                   /* SET FOR ONOFF RTNE    @ZA30157*/
         LA    @09,9                                               2320
         ST    @09,S                                               2320
*           IF CWBCMND(9:10)<F2F8&  /* 00 <= SDG <= 27       @ZA14741*/
*               (CWBCMND(9:10)&F0F0)=F0F0 THEN/* IF NOT, ERROR     2321
*                                                            @ZA14741*/
         CLC   CWBCMND+8(2,@12),@CC02458                           2321
         BNL   @RF02321                                            2321
         MVC   @TS00001(2),CWBCMND+8(@12)                          2321
         NC    @TS00001(2),@CC02456                                2321
         CLC   @TS00001(2),@CC02456                                2321
         BNE   @RF02321                                            2321
*             DO;                   /* SET OFFSET & CALL     @ZA30157*/
*               CWBOFFS=HF9;        /* OFFSET FOR MSG56      @ZA30157*/
         STH   @09,CWBOFFS(,@12)                                   2323
*               S=F11;              /* OFFSET FOR ONOFFCK    @ZA30157*/
         MVC   S(4),@CF02048                                       2324
*             END;                  /* WAS SDGNN REQUEST     @ZA30157*/
*           CALL ONOFFCK;           /* SEE IF ON/OFF LINE    @ZA30157*/
@RF02321 BAL   @14,ONOFFCK                                         2326
*         END;                      /*                       @Z40LB01*/
*     END;                          /* END OF DSP SDG CODE   @Z40LB01*/
@RF02317 DS    0H                                                  2329
*   IF EXITSW=OFF THEN              /* SYNTAX NOT COMPLETE   @Z40LB01*/
@RF02315 TM    EXITSW,B'00001000'                                  2329
         BNZ   @RF02329                                            2329
*     DO;                           /* CONTINUE SYNTAX CHK   @Z40LB01*/
*       IF CWBCMND(5:6)=',(' THEN   /* TEST FOR RANGE DSP    @Z40LB01*/
         L     @12,CWBPTR                                          2331
         CLC   CWBCMND+4(2,@12),@CC03175                           2331
         BNE   @RF02331                                            2331
*         DO;                       /* DISPLAY RANGE REQ     @Z40LB01*/
*           DSPRNG=ON;              /* SET DSP RNG FLAG      @ZA30157*/
         OI    DSPRNG(@12),B'00001000'                             2333
*           CWBOFFS=HF7;            /* OFFSET OF PARM        @ZA30157*/
         MVC   CWBOFFS(2,@12),@CH01340                             2334
*           CONVID1=CWBCMND(7:9);   /* SSID1 TO CONV FIELD   @Z40LB01*/
         MVC   CONVID1(3),CWBCMND+6(@12)                           2335
*           ALPHAS=CHARS;           /* BUILD TRANS TABLE     @Z40LB01*/
         LA    @09,24                                              2336
         AL    @09,CCWSPTR                                         2336
         MVC   ALPHAS(6,@09),CHARS                                 2336
*           NUMBRS=NUMS;            /* BUILD TRANS TABLE     @Z40LB01*/
         MVC   NUMBRS(16,@09),NUMS                                 2337
*           TR(CONVID1,TRANSTBL);   /* TRANSLATE SSID1       @Z40LB01*/
         TR    CONVID1(3),TRANSTBL(@09)                            2338
*           CONVID2=CWBCMND(11:13); /* SSID2 TO CONV FIELD   @Z40LB01*/
         MVC   CONVID2(3),CWBCMND+10(@12)                          2339
*           TR(CONVID2,TRANSTBL);   /* TRANSLATE SSID2       @Z40LB01*/
         TR    CONVID2(3),TRANSTBL(@09)                            2340
*           IF CWBCMND(10:10)^='-' THEN/* TEST FOR UNIT-UNIT @Z40LB01*/
         CLI   CWBCMND+9(@12),C'-'                                 2341
         BE    @RF02341                                            2341
*             DSPERR=ON;            /* SET SYNTAX ERR FLAG   @ZA30157*/
         OI    DSPERR,B'00000100'                                  2342
*           IF CWBCMND(14:14)^=')' THEN/* TEST FOR END PAREN @Z40LB01*/
@RF02341 L     @12,CWBPTR                                          2343
         CLI   CWBCMND+13(@12),C')'                                2343
         BE    @RF02343                                            2343
*             DSPERR=ON;            /* SET SYNTAX ERR FLAG   @ZA30157*/
         OI    DSPERR,B'00000100'                                  2344
*           IF CONVID1>CONVID2 THEN /* INV RANGE REQ         @Z40LB01*/
@RF02343 CLC   CONVID1(3),CONVID2                                  2345
         BNH   @RF02345                                            2345
*             DSPERR=ON;            /* SET SYNTAX ERR FLAG   @ZA30157*/
         OI    DSPERR,B'00000100'                                  2346
*           S=F15;                  /* OFFSET OF ON/OFF      @ZA30157*/
@RF02345 MVC   S(4),@CF00170                                       2347
*           IF DSPERR=OFF THEN      /* DON'T CALL IF ERROR   @ZA30157*/
         TM    DSPERR,B'00000100'                                  2348
         BNZ   @RF02348                                            2348
*             CALL ONOFFCK;         /* SEE IF ON /OFF LINE   @ZA30157*/
         BAL   @14,ONOFFCK                                         2349
*         END;                      /*                       @Z40LB01*/
@RF02348 DS    0H                                                  2351
*     END;                          /* END OF DSP RNG CODE   @Z40LB01*/
@RF02331 DS    0H                                                  2352
*   IF EXITSW=OFF THEN              /* SYNTAX NOT COMPLETE   @Z40LB01*/
@RF02329 TM    EXITSW,B'00001000'                                  2352
         BNZ   @RF02352                                            2352
*     DO;                           /* CONTINUE SYNTAX CHK   @Z40LB01*/
*       VALSID=CWBCMND(5:9);        /* SSID TO CNVRT FIELD   @ZA30157*/
         L     @12,CWBPTR                                          2354
         MVC   VALSID(5),CWBCMND+4(@12)                            2354
*       TRANSTBL=' ';               /* BLANK OUT TABLE       @ZA30157*/
         LA    @12,24                                              2355
         AL    @12,CCWSPTR                                         2355
         MVI   TRANSTBL+1(@12),C' '                                2355
         MVC   TRANSTBL+2(254,@12),TRANSTBL+1(@12)                 2355
         MVI   TRANSTBL(@12),C' '                                  2355
*       ALPHAS=CHARS;               /* VALIDATE A-F HEX      @ZA30157*/
         MVC   ALPHAS(6,@12),CHARS                                 2356
*       NUMBRS=NUMS;                /* VALIDATE 1-9 HEX      @ZA30157*/
         MVC   NUMBRS(16,@12),NUMS                                 2357
*       TRANSTBL(F64)=BB;           /* UNIQUE FOR BLANK      @ZA30157*/
         MVC   TRANSTBL+64(1,@12),BB                               2358
*       TRANSTBL(F107)=CC;          /* UNIQUE FOR COMMA      @ZA30157*/
         MVC   TRANSTBL+107(1,@12),CC                              2359
*       TR(VALSID,TRANSTBL);        /* CONVERT ,SSID,        @ZA30157*/
         TR    VALSID(5),TRANSTBL(@12)                             2360
*       IF(CSSID&CCF0F0F0)=CCF0F0F0&/* SEE IF ,SSID          @ZA30157*/
*           ((CORB&CC)=CC(CORB&BB)=BB) THEN/* COMMA OR BLANK      2361
*                                                            @ZA30157*/
         MVC   @TS00001(4),CSSID                                   2361
         NC    @TS00001(4),CCF0F0F0                                2361
         CLC   @TS00001(4),CCF0F0F0                                2361
         BNE   @RF02361                                            2361
         MVC   @TS00001(1),CORB                                    2361
         NC    @TS00001(1),CC                                      2361
         CLC   @TS00001(1),CC                                      2361
         BE    @RT02361                                            2361
         MVC   @TS00001(1),CORB                                    2361
         NC    @TS00001(1),BB                                      2361
         CLC   @TS00001(1),BB                                      2361
         BNE   @RF02361                                            2361
@RT02361 DS    0H                                                  2362
*         DO;                       /* DISPLAY SSID REQ      @Z40LB01*/
*           DSPSSID=ON;             /* SET DSP SSID FLAG     @ZA30157*/
         L     @12,CWBPTR                                          2363
         OI    DSPSSID(@12),B'00000100'                            2363
*           S=F9;                   /* OFFSET OF ON/OFF      @ZA30157*/
         MVC   S(4),@CF02044                                       2364
*           CWBOFFS=HF6;            /* OFFSET OF NUMERIC     @ZA30157*/
         MVC   CWBOFFS(2,@12),@CH00810                             2365
*           CALL ONOFFCK;           /* SEE IF ON/OFF LINE    @ZA30157*/
         BAL   @14,ONOFFCK                                         2366
*         END;                      /*                       @Z40LB01*/
*     END;                          /* END DSP SSID CODE     @Z40LB01*/
@RF02361 DS    0H                                                  2369
*   IF EXITSW=OFF THEN              /* NOT FOUND IT YET      @ZA30157*/
@RF02352 TM    EXITSW,B'00001000'                                  2369
         BNZ   @RF02369                                            2369
*     IF CWBCMND(5:9)=',QCB '       /* IS THIS QCB REQUEST   @ZA30157*/
*       THEN                                                       2370
         L     @12,CWBPTR                                          2370
         CLC   CWBCMND+4(5,@12),@CC03177                           2370
         BNE   @RF02370                                            2370
*       DSPQCB=ON;                  /* TURN ON INDICATOR     @ZA30157*/
         OI    DSPQCB(@12),B'00000100'                             2371
*     ELSE                                                         2372
*       IF CWBCMND(5:10)=',MSVC '   /* IS THIS MSVC REQUEST  @ZA30157*/
*         THEN                                                     2372
         B     @RC02370                                            2372
@RF02370 L     @12,CWBPTR                                          2372
         CLC   CWBCMND+4(6,@12),@CC03178                           2372
         BNE   @RF02372                                            2372
*         DSPMSVC=ON;               /* TURN ON INDICATOR     @ZA30157*/
         OI    DSPMSVC(@12),B'00010000'                            2373
*       ELSE                                                       2374
*         IF CWBCMND(5:11)=',TRACE '/* TRACE REQUEST ?       @ZA30157*/
*           THEN                                                   2374
         B     @RC02372                                            2374
@RF02372 L     @12,CWBPTR                                          2374
         CLC   CWBCMND+4(7,@12),@CC03179                           2374
         BNE   @RF02374                                            2374
*           DSPTRC=ON;              /* INDICATE TRACE        @ZA30157*/
         OI    DSPTRC(@12),B'00001000'                             2375
*         ELSE                                                     2376
*           IF CWBCMND(5:12)=',ALTMSC '/* ALTMSC REQUEST ?   @ZA30157*/
*             THEN                                                 2376
         B     @RC02374                                            2376
@RF02374 L     @12,CWBPTR                                          2376
         CLC   CWBCMND+4(8,@12),@CC03180                           2376
         BNE   @RF02376                                            2376
*             DSPALTM=ON;           /* INDICATE ALTMSC       @ZA30157*/
         OI    DSPALTM(@12),B'00000010'                            2377
*           ELSE                                                   2378
*             IF CWBCMND(5:10)=',PATHS' THEN/* PATHS REQUEST ?     2378
*                                                            @ZA30157*/
         B     @RC02376                                            2378
@RF02376 L     @12,CWBPTR                                          2378
         CLC   CWBCMND+4(6,@12),@CC03181                           2378
         BNE   @RF02378                                            2378
*               DO;                 /* PROCESS PATHS         @ZA30157*/
*                 S=F11;            /* OFFSET OF ON/OFF      @ZA30157*/
         MVC   S(4),@CF02048                                       2380
*                 DSPPATH=ON;       /* INDICATE PATH         @ZA30157*/
         OI    DSPPATH(@12),B'00000001'                            2381
*                 IF CWBCMND(11:14)=',CPU' THEN/* CPU PATHS ?      2382
*                                                            @ZA30157*/
         CLC   CWBCMND+10(4,@12),@CC03182                          2382
         BNE   @RF02382                                            2382
*                   DO;             /* IS CPU                @ZA30157*/
*                     S=F15;        /* OFFSET OF ON/OFF      @ZA30157*/
         MVC   S(4),@CF00170                                       2384
*                     DSPCPU=ON;    /* INDICATE CPU PATHS    @ZA30157*/
         OI    DSPCPU(@12),B'00000010'                             2385
*                   END;            /* END PATHS CPU         @ZA30157*/
*                 ELSE                                             2387
*                   IF CWBCMND(11:14)=',SDG' THEN/* SDG PATHS ?    2387
*                                                            @ZA30157*/
         B     @RC02382                                            2387
@RF02382 L     @12,CWBPTR                                          2387
         CLC   CWBCMND+10(4,@12),@CC03173                          2387
         BNE   @RF02387                                            2387
*                     DO;           /* SEE IF SDGNN          @ZA30157*/
*                       DSPSDG=ON;  /* INDICATE SDG PATHS    @ZA30157*/
         OI    DSPSDG(@12),B'00010000'                             2389
*                       S=F15;      /* OFFSET OF ON/OFF      @ZA30157*/
         LA    @09,15                                              2390
         ST    @09,S                                               2390
*                       IF CWBCMND(15:16)<F2F8&/* SEE IF NN IS GOOD
*                                                            @ZA30157*/
*                           (CWBCMND(15:16)&F0F0)=F0F0 THEN/* NUMERIC
*                                      < 28                  @ZA30157*/
         CLC   CWBCMND+14(2,@12),@CC02458                          2391
         BNL   @RF02391                                            2391
         MVC   @TS00001(2),CWBCMND+14(@12)                         2391
         NC    @TS00001(2),@CC02456                                2391
         CLC   @TS00001(2),@CC02456                                2391
         BNE   @RF02391                                            2391
*                         DO;       /* YES                   @ZA30157*/
*                           CWBOFFS=HF15;/* SET OFFSET OF NN @ZA30157*/
         STH   @09,CWBOFFS(,@12)                                   2393
*                           S=F17;  /* OFFSET OF ON/OFF      @ZA30157*/
         MVC   S(4),@CF02056                                       2394
*                         END;      /* END SDGNN CK          @ZA30157*/
*                     END;          /* END SDG CHECK         @ZA30157*/
*                   ELSE                                           2397
*                     IF CWBCMND(11:14)=',DRC' THEN/* DRC PATHS ?  2397
*                                                            @ZA30157*/
         B     @RC02387                                            2397
@RF02387 L     @12,CWBPTR                                          2397
         CLC   CWBCMND+10(4,@12),@CC03183                          2397
         BNE   @RF02397                                            2397
*                       DO;         /* IS DRC                @ZA30157*/
*                         DSPDRC=ON;/* INDICATE DRC PATHS    @ZA30157*/
         OI    DSPDRC(@12),B'10000000'                             2399
*                         S=F15;    /* OFFSET OF ON/OFF      @ZA30157*/
         LA    @09,15                                              2400
         ST    @09,S                                               2400
*                         IF(CWBCMND(15:16)&F0F0)=F0F0 THEN/* IS   2401
*                                      PATHS,DRCNN ??        @ZA30157*/
         MVC   @TS00001(2),CWBCMND+14(@12)                         2401
         NC    @TS00001(2),@CC02456                                2401
         CLC   @TS00001(2),@CC02456                                2401
         BNE   @RF02401                                            2401
*                           DO;     /* YES ID PATHS,DRCNN    @ZA30157*/
*                             S=F17;/* OFFSET OF ONOFFCK     @ZA30157*/
         MVC   S(4),@CF02056                                       2403
*                             CWBOFFS=HF15;/* OFFSET OF NUMERICS   2404
*                                                            @ZA30157*/
         STH   @09,CWBOFFS(,@12)                                   2404
*                           END;    /* END OF PATHS,DRCNN    @ZA30157*/
*                       END;        /* END OF DRC CHK        @ZA30157*/
*                     ELSE                                         2407
*                       DO;         /* SEE IF CPUID          @ZA30157*/
         B     @RC02397                                            2407
@RF02397 DS    0H                                                  2408
*                         TRANSTBL='0'B;/* MAKE ALL VALID    @ZA30157*/
         LA    @12,24                                              2408
         AL    @12,CCWSPTR                                         2408
         XC    TRANSTBL+1(255,@12),TRANSTBL+1(@12)                 2408
         MVI   TRANSTBL(@12),B'00000000'                           2408
*                         TRANSTBL(F64)=BB;/* INVALIDATE BLANKS    2409
*                                                            @ZA30157*/
         MVC   TRANSTBL+64(1,@12),BB                               2409
*                         TRANSTBL(F107)=CC;/* INVALIDATE COMMAS   2410
*                                                            @ZA30157*/
         MVC   TRANSTBL+107(1,@12),CC                              2410
*                         TRT(CWBCMND(12:21),TRANSTBL);/* SEE IF   2411
*                                      VALID CPUID           @ZA30157*/
         L     @03,CWBPTR                                          2411
         L     @12,CCWSPTR                                         2411
         TRT   CWBCMND+11(10,@03),TRANSTBL+24(@12)                 2411
*                         GEN(BNZ  NOTCPU);/* BR IF NOT VALID      2412
*                                                            @ZA30157*/
         BNZ  NOTCPU
*                         CWBOFFS=HF12;/* OFFSET OF CPUID    @ZA30157*/
         L     @12,CWBPTR                                          2413
         MVC   CWBOFFS(2,@12),@CH02050                             2413
*                         DSPCPU=ON;/* CPUID REQUEST         @ZA30157*/
         OI    DSPCPU(@12),B'00000010'                             2414
*                         S=F22;    /* OFFSET OF ON/OFF      @ZA30157*/
         MVC   S(4),@CF02064                                       2415
*NOTCPU:                                                           2416
*                       END;        /* END CPUID CHECK       @ZA30157*/
NOTCPU   DS    0H                                                  2417
*                 CALL ONOFFCK;     /* SEE IF ON/OFF SOUGHT  @ZA30157*/
@RC02397 DS    0H                                                  2417
@RC02387 DS    0H                                                  2417
@RC02382 BAL   @14,ONOFFCK                                         2417
*               END;                /* END PATHS CHECK       @ZA30157*/
*   IF(CWBFLGS&F1E)^=F00 THEN       /* MSVC,QCB,TRC,ALTMSC?  @ZA30157*/
@RF02378 DS    0H                                                  2419
@RC02376 DS    0H                                                  2419
@RC02374 DS    0H                                                  2419
@RC02372 DS    0H                                                  2419
@RC02370 DS    0H                                                  2419
@RF02369 L     @12,CWBPTR                                          2419
         MVC   @TS00001(1),CWBFLGS(@12)                            2419
         NI    @TS00001,X'1E'                                      2419
         CLI   @TS00001,X'00'                                      2419
         BE    @RF02419                                            2419
*     EXITSW=ON;                    /* YES SO DONE OK        @ZA30157*/
         OI    EXITSW,B'00001000'                                  2420
*   IF EXITSW=OFF THEN              /* TST FOR VALID SYNTAX  @Z40LB01*/
@RF02419 TM    EXITSW,B'00001000'                                  2421
         BNZ   @RF02421                                            2421
*     DO;                           /* CHK LAST PARM         @ZA30157*/
*       S=F5;                       /* ON/OFF WITH NO PARMS  @ZA30157*/
         MVC   S(4),@CF00796                                       2423
*       CALL ONOFFCK;               /* SEE IF ON/OFF ASKED   @ZA30157*/
         BAL   @14,ONOFFCK                                         2424
*       DSPALL=ON;                  /* SET ALL DISPLAY ON    @ZA30157*/
         L     @12,CWBPTR                                          2425
         OI    DSPALL(@12),B'10000000'                             2425
*     END;                          /* ALL VALID CKED        @ZA30157*/
*   IF DSPERR=ON THEN               /* CHECK FOR SYNTAX ERR  @ZA30157*/
@RF02421 TM    DSPERR,B'00000100'                                  2427
         BNO   @RF02427                                            2427
*     DO;                           /* PROCESS SYNTAX ERROR  @Z40LB01*/
*       WTOMCS03=MESGS(MSG05601);   /* LOAD MESSAGE TEXT     @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2429
         L     @12,@CA02101                                        2429
         MVC   WTOMCS03(72),MESGS-MSGS+1216(@12)                   2429
*       WTOMCS03(33:58)=SYNTXMSG;   /* FILL IN SYNTAX TEXT   @Z40LB01*/
         MVC   WTOMCS03+32(26),SYNTXMSG                            2430
*       CALL ICBMSG47;              /* CALL MSG47 FOR WTO    @Z40LB01*/
         BAL   @14,ICBMSG47                                        2431
*     END;                          /* END SYNTAX ERR CODE   @Z40LB01
*                                                            @Z40LB01*/
*                                                                  2433
*/*********************************************************  @Z40LB01*/
*/* IF NO ERROR WAS ENCOUNTERED SO FAR THEN INTERNALLY       @Z40LB01*/
*/* QUEUE THIS CWB SO COMTASK FUNCTIONS CAN CONTINUE         @Z40LB01*/
*/* WHILE THE ASYNCRONOUS DISPLAY PROCESSING IS WAITING      @Z40LB01*/
*/* TO COMPLETE.                                             @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  2433
*   IF DSPERR=OFF THEN              /* TEST FOR ERROR COND   @ZA30157*/
@RF02427 TM    DSPERR,B'00000100'                                  2433
         BNZ   @RF02433                                            2433
*     DO;                           /* NO ERROR - CONTINUE   @Z40LB01*/
*       LOOPEND=OFF;                /* CLEAR END SWITCH      @ZA30157*/
         NI    LOOPEND,B'11101111'                                 2435
*       DO I=F1 TO F10 WHILE LOOPEND=OFF;/* FIND EMPTY SLOT  @Z40LB01*/
         LA    @12,1                                               2436
         ST    @12,I                                               2436
@DL02436 TM    LOOPEND,B'00010000'                                 2436
         BNZ   @DC02436                                            2436
*         IF CMDQUE(I)=F0 THEN      /* SLOT IS EMPTY         @Z40LB01*/
         SLA   @12,2                                               2437
         L     @09,CMDQUE-4(@12)                                   2437
         LTR   @09,@09                                             2437
         BNZ   @RF02437                                            2437
*           DO;                     /* QUE SLOT FILL CODE    @Z40LB01*/
*             LOOPEND=ON;           /* SET LOOP EXIT SW      @Z40LB01*/
         OI    LOOPEND,B'00010000'                                 2439
*             CMDQUE(I)=CWBPTR;     /* PUT CWB PTR IN SLOT   @Z40LB01*/
         L     @09,CWBPTR                                          2440
         ST    @09,CMDQUE-4(@12)                                   2440
*           END;                    /* END QUE FILL CODE     @Z40LB01*/
*         ELSE                      /* SLOT NOT EMPTY        @Z40LB01*/
*           IF I=F10 THEN           /* TEST FOR FULL QUEUE   @Z40LB01*/
         B     @RC02437                                            2442
@RF02437 CLC   I(4),@CF02046                                       2442
         BNE   @RF02442                                            2442
*             DO;                   /* QUEUE IS FULL         @Z40LB01*/
*                                                                  2443
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE A COMMAND REJECT MESSAGE ADVISING   @Z40LB01*/
*               /* OPERATOR THAT HE WILL HAVE TO TRY THE DISPLAY     */
*               /*                                           @Z40LB01*/
*               /* AGAIN AFTER A PREVIOUS DISPLAY ENDS.      @Z40LB01*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  2444
*               WTOMCS03=MESGS(MSG05601);/* MOVE MSG TO WTO AREA   2444
*                                                            @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2444
         L     @12,@CA02101                                        2444
         MVC   WTOMCS03(72),MESGS-MSGS+1216(@12)                   2444
*               WTOMCS03(33:58)=SPACEMSG;/* FILL MSG TEXT    @Z40LB01*/
         MVC   WTOMCS03+32(26),SPACEMSG                            2445
*               CALL ICBMSG47;      /* CALL MSG47 FOR WTO    @Z40LB01*/
         BAL   @14,ICBMSG47                                        2446
*               DSPERR=ON;          /* SET ERROR FLAG        @Z40LB01*/
         OI    DSPERR,B'00000100'                                  2447
*             END;                  /* END ERROR PROCESS     @Z40LB01*/
*       END;                        /* END INTERNAL QUE      @Z40LB01*/
@RF02442 DS    0H                                                  2449
@RC02437 LA    @12,1                                               2449
         AL    @12,I                                               2449
         ST    @12,I                                               2449
         C     @12,@CF02046                                        2449
         BNH   @DL02436                                            2449
@DC02436 DS    0H                                                  2450
*     END;                          /* END QUEUE CODE        @Z40LB01*/
*                                                                  2451
*/*********************************************************  @Z40LB01*/
*/* REGARDLESS IF THERE WAS AN ERROR OR NOT, THE CWB MUST    @Z40LB01*/
*/* BE DEQUEUED FROM THE COMQ. SUBROUTINE ICBMSG44 IS        @Z40LB01*/
*/* CALLED TO DO THE DEQUEUING AND TO CLEAR THE COMTASK      @Z40LB01*/
*/* ECB IF THE COMQ BECOMES EMPTY.                           @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  2451
*                                   /*                       @Z40LB01*/
*   CALL ICBMSG44;                  /* CALL DEQUEUE SUB      @Z40LB01*/
@RF02433 BAL   @14,ICBMSG44                                        2451
*                                                                  2452
*/*********************************************************  @Z40LB01*/
*/* IF NO ERROR SO FAR, A CHECK IS MADE TO SEE IF THE        @Z40LB01*/
*/* THE LATEST MSC UNIT STATUS OR NOT. A COMMUNICATIONS      @Z40LB01*/
*/* FLAG (MSG92FLG) IS USED BY ICBMSG15, ICBMSG55, AND       @Z40LB01*/
*/* ICBMSG56 TO KEEP THE STATUS OF WHETHER THE MSC UNIT      @Z40LB01*/
*/* STATUS (MSG CODE 92) HAS BEEN REQUESTED OR NOT. IF       @Z40LB01*/
*/* THE STATUS HAS ALREADY BEEN REQUESTED (FLAG SET ON)      @Z40LB01*/
*/* OR AN ERROR WAS FOUND IN THIS COMMAND, THEN THIS         @Z40LB01*/
*/* CODE GETS BYPASSED.                                      @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  2452
*                                   /*                       @Z40LB01*/
*   IF DSPERR=OFF&MSG92FLG=OFF THEN /*                       @Z40LB01*/
         TM    DSPERR,B'10000100'                                  2452
         BNZ   @RF02452                                            2452
*     DO;                           /* NO ERROR AND A MESSAGE 92 IS
*                                      REQUIRED              @Z40LB01*/
*       RFY                                                        2454
*        (R15,                                                     2454
*         R0) RSTD;                 /* RESTRICT REGS         @Z40LB01*/
*       SAVREENT=REENTRY;           /* SAVE REENTRY POINTER  @G24LB02*/
         L     @14,REENTRY                                         2455
         ST    @14,SAVREENT                                        2455
*       REENTRY=ADDR(INITRET);      /* SET NEW REENTRY POINTER     2456
*                                                            @G24LB02*/
         LA    @14,INITRET                                         2456
         ST    @14,REENTRY                                         2456
*       SVCCALL=ON;                 /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 2457
*IICBPAI3:                                                         2458
*                                                                  2458
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO       @Y30LB02*/
*       /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00           @Y30LB02*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Y30LB02*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Y30LB02*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Y30LB02*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Y30LB02*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Y30LB02*/
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2458
*       RFY                                                        2458
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/
IICBPAI3 DS    0H                                                  2459
*       PAIRR1=ADDR(ARLIST);        /* SET PAIRR1 TO REQ BLOCK     2459
*                                                            @Y30LB02*/
         LA    PAIRR1,ARLIST                                       2459
*       ARLIST=ARLIST&&ARLIST;      /* ZERO REQUEST BLOCK    @Y30LB02*/
         XC    ARLIST(8),ARLIST                                    2460
*       AIRLL='08'X;                /* SET LENGTH FIELD      @Y30LB02*/
         LA    @14,8                                               2461
         ST    @14,AIRLL                                           2461
*       AIROP='10'X;                /* INITL OPCODE          @Y30LB02*/
         MVI   AIROP,X'10'                                         2462
*       AIRFLAG=(INITATTS);         /* FILL IN FLAGS FIELD   @Y30LB02*/
         MVC   AIRFLAG(2),INITATTS                                 2463
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 2464
*       RFY                                                        2465
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02*/
*                                                                  2465
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Z40LB01*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2466
*INITRET:                           /* LABEL FOR RETURN      @G24LB02*/
*       SVCCALL=OFF;                /* CLEAR SVC CALL FLAG   @G24LB02*/
INITRET  NI    SVCCALL,B'11110111'                                 2466
*       REENTRY=SAVREENT;           /* RESTORE REENTRY POINTER     2467
*                                                            @G24LB02*/
         L     @14,SAVREENT                                        2467
         ST    @14,REENTRY                                         2467
*       IF R15^=F0 THEN             /* TEST FOR ERROR        @Z40LB01*/
         LTR   R15,R15                                             2468
         BZ    @RF02468                                            2468
*         DO;                       /* PROCESS ERROR         @Z40LB01*/
*                                                                  2469
*           /*********************************************************/
*           /*                                                       */
*           /* BUILD AND ISSUE DISPLAY 3850 FAIL MESSAGE     @Z40LB01*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2470
*           INTER=''B;              /* CLEAR CONV AREA       @Z40LB01*/
         XC    INTER(4),INTER                                      2470
*           BYTE4C=R0;              /* REASON CODE           @Z40LB01*/
         STC   R0,BYTE4C                                           2471
*           CALL ICBMSG82;          /* CALL CONV SUBROUTINE  @Z40LB01*/
         BAL   @14,ICBMSG82                                        2472
*           RFY                                                    2473
*            (R15,                                                 2473
*             R0) UNRSTD;           /* FREE REGS             @Z40LB01*/
*           WTOMCS03=MESGS(MSG05601);/* MOVE TO WTO BUFFER   @Z40LB01*/
         MVI   WTOMCS03+72,C' '                                    2474
         L     @12,@CA02101                                        2474
         MVC   WTOMCS03(72),MESGS-MSGS+1216(@12)                   2474
*           WTOMCS03(56:58)=BYTES234;/* FILL REASON          @Z40LB01*/
         MVC   WTOMCS03+55(3),BYTES234                             2475
*           CALL ICBMSG47;          /* CALL MSG47 TO WTO     @Z40LB01*/
         BAL   @14,ICBMSG47                                        2476
*           DSPERR=ON;              /* SET ERROR SWITCH      @Z40LB01*/
         OI    DSPERR,B'00000100'                                  2477
*         END;                      /* END ERROR PROCESS     @Z40LB01*/
*       ELSE                        /* NO ERROR              @Z40LB01*/
*         MSG92FLG=ON;              /* SET MSG92 FLAG        @Z40LB01*/
         B     @RC02468                                            2479
@RF02468 OI    MSG92FLG,B'10000000'                                2479
*     END;                          /* END MSG92 CODE        @Z40LB01*/
@RC02468 DS    0H                                                  2481
*                                                                  2481
*/*********************************************************  @Z40LB01*/
*/* IF THE ERROR FLAG HAS BEEN SET THEN THE CWB CORE         @Z40LB01*/
*/* MUST BE FREED AND THE CWB REMOVED FROM THE INTERNAL      @Z40LB01*/
*/* QUEUE.                                                   @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  2481
*   IF DSPERR=ON THEN               /* TEST FOR ERROR        @Z40LB01*/
@RF02452 TM    DSPERR,B'00000100'                                  2481
         BNO   @RF02481                                            2481
*     DO;                           /* DO ON ERROR           @Z40LB01*/
*                                                                  2482
*       /*************************************************************/
*       /*                                                           */
*       /* DEQUEUE CWB FROM INTERNAL QUEUE                   @Z40LB01*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2483
*       DO I=F1 TO F10;             /* SCAN THE QUEUE        @Z40LB01*/
         LA    @12,1                                               2483
         ST    @12,I                                               2483
@DL02483 DS    0H                                                  2484
*         IF CMDQUE(I)=CWBPTR THEN  /* CHECK CURRENT CWB     @Z40LB01*/
         SLA   @12,2                                               2484
         L     @09,CMDQUE-4(@12)                                   2484
         C     @09,CWBPTR                                          2484
         BNE   @RF02484                                            2484
*           CMDQUE(I)=F0;           /* ZERO IF MATCH         @Z40LB01*/
         SLR   @09,@09                                             2485
         ST    @09,CMDQUE-4(@12)                                   2485
*       END;                        /* END DEQUEUE CODE      @Z40LB01*/
*                                                                  2486
@RF02484 LA    @12,1                                               2486
         AL    @12,I                                               2486
         ST    @12,I                                               2486
         C     @12,@CF02046                                        2486
         BNH   @DL02483                                            2486
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE FREEMAIN FOR CWB VIA ICBMSG46 SUBROUTINE    @Z40LB01*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2487
*       CALL ICBMSG46;              /* CALL FREE CWB SUB     @Z40LB01*/
         BAL   @14,ICBMSG46                                        2487
*     END;                          /* END FAIL TEST CODE    @Z40LB01
*                                                            @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*/* NORMAL EXIT TO CALLING ROUTINE ICBMSG40                  @Z40LB01*/
*/*********************************************************  @Z40LB01*/
*                                                                  2489
*                                   /*                       @Z40LB01*/
*   RFY                                                            2489
*     R14 RSTD;                     /*                       @G24LB02*/
@RF02481 DS    0H                                                  2490
*   R14=SAVR1455;                   /* RESTORE RETURN REG    @Z40LB01*/
         L     R14,SAVR1455                                        2490
*   RFY                                                            2491
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RETURN                @Z40LB01*/
@EL00025 DS    0H                                                  2492
@EF00025 DS    0H                                                  2492
@ER00025 BR    @14                                                 2492
*   END ICBMSG55;                   /* END OF PROC           @Z40LB01*/
*                                                                  2494
*/*******************************************************    @ZA30157*/
*/*  START OF SPECIFICATIONS  *****                           @ZA30157
*                                                             @ZA30157
*01*  MODULE-NAME = ONOFFCK                                   @ZA30157
*                                                             @ZA30157
*01*  DESCRIPTIVE-NAME = D3850 ONLINE/OFFLINE CHECKER         @ZA30157
*                                                             @ZA30157
*01*  FUNCTION = SYNTAX CHECK THE ONLINE/OFFLINE PARAMETER    @ZA30157
*                OF THE DISPLAY 3850 OPERATOR COMMAND         @ZA30157
*                                                             @ZA30157
*01*  PURPOSE = INSURE THAT THE LAST PARAMETER OF THE         @ZA30157
*               DISPLAY 3850 IS EQUAL TO ONE OF THE FOLLOWING @ZA30157
*               ,ON  ,ONL  ,ONLINE  ,OF  ,OFF  ,OFFLINE  @ZA30157
*               OR NO OPERAND ( BLANK )                       @ZA30157
*                                                             @ZA30157
*01*  INPUT = 'S' IS SET TO THE OFFSET IN THE CWB OF THE      @ZA30157
*             ONLINE/OFFLINE PARAMETER                        @ZA30157
*                                                             @ZA30157
*01*  OUTPUT = EXITSW = ON, DSPON OR DSPOFF OR DSPERR = ON    @ZA30157
*****END SPECIFICATIONS   ********************************   @ZA30157*/
*                                                                  2494
*ONOFFCK:                                                          2494
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA30157*/
ONOFFCK  DS    0H                                                  2495
*   RFY                                                            2495
*     R14 RSTD;                     /*                       @ZA30157*/
*   SAVRONOF=R14;                   /* SAVE CALLERS REG 14   @ZA30157*/
         ST    R14,SAVRONOF                                        2496
*   RFY                                                            2497
*     R14 UNRSTD;                   /*                       @ZA30157*/
*   IF CWBCMND(S:S+7)=',ONLINE 'CWBCMND(S:S+4)=',ONL '/*   @ZA30157*/
*       CWBCMND(S:S+3)=',ON ' THEN                                 2498
         L     @12,CWBPTR                                          2498
         L     @09,S                                               2498
         ALR   @09,@12                                             2498
         CLC   CWBCMND-1(8,@09),@CC03194                           2498
         BE    @RT02498                                            2498
         L     @09,S                                               2498
         ALR   @09,@12                                             2498
         CLC   CWBCMND-1(5,@09),@CC03195                           2498
         BE    @RT02498                                            2498
         L     @09,S                                               2498
         ALR   @12,@09                                             2498
         CLC   CWBCMND-1(4,@12),@CC03196                           2498
         BNE   @RF02498                                            2498
@RT02498 DS    0H                                                  2499
*     DSPON=ON;                     /*                       @ZA30157*/
         L     @12,CWBPTR                                          2499
         OI    DSPON(@12),B'01000000'                              2499
*   ELSE                                                           2500
*     IF CWBCMND(S:S+8)=',OFFLINE 'CWBCMND(S:S+4)=/*        @ZA30157*/
*         ',OFF 'CWBCMND(S:S+3)=',OF ' THEN                       2500
         B     @RC02498                                            2500
@RF02498 L     @12,CWBPTR                                          2500
         L     @09,S                                               2500
         ALR   @09,@12                                             2500
         CLC   CWBCMND-1(9,@09),@CC03197                           2500
         BE    @RT02500                                            2500
         L     @09,S                                               2500
         ALR   @09,@12                                             2500
         CLC   CWBCMND-1(5,@09),@CC03199                           2500
         BE    @RT02500                                            2500
         L     @09,S                                               2500
         ALR   @12,@09                                             2500
         CLC   CWBCMND-1(4,@12),@CC03200                           2500
         BNE   @RF02500                                            2500
@RT02500 DS    0H                                                  2501
*       DSPOFF=ON;                  /*                       @ZA30157*/
         L     @12,CWBPTR                                          2501
         OI    DSPOFF(@12),B'00100000'                             2501
*     ELSE                                                         2502
*       IF CWBCMND(S:S)^=' ' THEN                                  2502
         B     @RC02500                                            2502
@RF02500 L     @12,CWBPTR                                          2502
         AL    @12,S                                               2502
         CLI   CWBCMND-1(@12),C' '                                 2502
         BE    @RF02502                                            2502
*         DSPERR=ON;                /*                       @ZA30157*/
         OI    DSPERR,B'00000100'                                  2503
*   EXITSW=ON;                      /* LAST PARM SO EXIT     @ZA30157*/
@RF02502 DS    0H                                                  2504
@RC02500 DS    0H                                                  2504
@RC02498 OI    EXITSW,B'00001000'                                  2504
*   RFY                                                            2505
*     R14 RSTD;                     /*                       @ZA30157*/
*   R14=SAVRONOF;                   /* RESTORE CALLERS R14   @ZA30157*/
         L     R14,SAVRONOF                                        2506
*   RFY                                                            2507
*     R14 UNRSTD;                   /*                       @ZA30157*/
*   RETURN;                         /* RETURN TO ICBMSG55    @ZA30157*/
@EL00026 DS    0H                                                  2508
@EF00026 DS    0H                                                  2508
@ER00026 BR    @14                                                 2508
*   END ONOFFCK;                    /*                       @ZA30157*/
*                                                                  2510
*/*******************************************************    @Z40LB01*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG70                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = I/O RESTART SUBROUTINE               @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = PERFORM SYSTEM RECOVERY FOR FAILING CPU OF   @Y30LB03
*                A TIGHTLY COUPLED MP ENVIRONMENT             @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = TO DISASSOCIATE AND PURGE THE FAILING CPU   @Y30LB03
*                 OF A TIGHTLY COUPLED MP ENVIRONMENT         @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = INDICATION THAT THE 'BROTHER' CPU OF A        @Y30LB03
*               TIGHTLY COUPLED MP ENVIRONMENT HAS FAILED     @Y30LB03
*               AND THAT I/O RESTART ROUTINES HAVE            @Y30LB03
*               DETERMINED THAT THE MESSAGE TASK SHOULD       @Y30LB03
*               TAKE RECOVERY ACTION.                         @Y30LB03
*                                                             @Y30LB03
*        PROCESSING = OBTAIN ID OF CPU WHICH HAS TAKEN OVER   @ZM31124
*               SYSTEM WORK                                   @ZM31124
*               DISASSOCIATE IT FROM ITS PAIR MEMBER          @ZM31124
*               PURGE VOLUMES MOUNTED FOR FAILING CPU         @ZM31124
*               CLEAR ECB ONLY IF ICBMSCA IS OFF              @G24LB05
*                                                             @ZM31124
*02*    OUTPUT = THE FAILING CPU IS PURGED AND                @Y30LB03
*                DISASSOCIATED FROM THIS HOST.                @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  2510
*ICBMSG70:                                                         2510
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG70 DS    0H                                                  2511
*   DCL                                                            2511
*     DPFLAGS BIT(16);              /* DISASSOCIATE/PURGE    @Y30LB03
*                                      FLAGS                 @Y30LB03*/
*   RFY                                                            2512
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1470=R14;                   /* SAVE CALLERS REGISTER 14    2513
*                                                            @Z307B04*/
         ST    R14,SAVR1470                                        2513
*   RFY                                                            2514
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   IF ICBMSCA=OFF THEN             /* NOT AP                @G24LB05*/
         L     @12,ICBPTR                                          2515
         TM    ICBMSCA(@12),B'00000010'                            2515
         BNZ   @RF02515                                            2515
*     DO;                                                          2516
*       DCL                                                        2517
*         ASDAR1 REG(1) PTR;        /* PTR TO REQUEST BLOCK  @Y30LB02*/
*/*  ******************************************************** @Y30LB02
*                                                                    */
*/*       MACMEAN  MSSC ASSOCIATE MACRO                       @Y30LB02
*                                                                    */
*/*  VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                   @Y30LB02
*                                                                    */
*/*  THIS IS THE INITIALIZED LIST FORM                        @Y30LB02
*                                                                    */
*/*  ******************************************************** @Y30LB02
*                                                                    */
*                                                                  2518
*       DCL                                                        2518
*         1 ADLIST STATIC LOCAL,    /* ASSOCIATE REQUEST BLOCK     2518
*                                                            @Y30LB02*/
*          2 ASDALEN FIXED(31) INIT('10'X),/* LENG OF ASSOC REQ BLK
*                                                            @Y30LB02*/
*          2 ASDAOPC CHAR(1) INIT('2C'X),/* ASSOCIATE OPCODE @Y30LB02*/
*          2 ASDA001 CHAR(1) INIT('00'X),/* RESERVED AND ZERO      2518
*                                                            @Y30LB02*/
*          2 ASDAFLG BIT(16) INIT('0000000000000000'B),/* TWO BYTE 2518
*                                      ATTRIBUTE AREA        @Y30LB02*/
*           3 ASASSOC BIT(1),       /* ASSOCIATE ATTRIBUTE   @Y30LB02*/
*           3 ASDASSOC BIT(1),      /* DISASSOCIATE ATTRIBUTE      2518
*                                                            @Y30LB02*/
*           3 * BIT(3),             /* THREE BITS RESERVE    @Y30LB02*/
*           3 ASDEINT BIT(1),       /* DISASSOC AND DEINITIALIZE THE
*                                      INTERFACE FOR THE OTHER CPU 2518
*                                      SPECIFIED IN THE CPU ASSOCIATE
*                                      TABLE                 @Y30LB02*/
*           3 ASDMNT BIT(1),        /* ASSOC CPUS AND DEMOUNT ALL  2518
*                                      VOLUMES FOR BOTH CPUS @Y30LB02*/
*           3 * BIT(9),             /* RESERVED AND MUST BE ZERO   2518
*                                                            @Y30LB02*/
*          2 ASDACPU CHAR(5) INIT('0000000000'X),/* HOSTID   @Y30LB02*/
*          2 ASDA002 CHAR(3) INIT('000000'X);/* RESERVED AREA      2518
*                                                            @Y30LB02*/
*                                                                  2518
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE DISASSOCIATE                                @Y30LB03*/
*       /* MACRO                                             @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2519
*       DPFLAGS='0100000000000000'B;/* INIT FLAGS FIELD FOR  @Y30LB03
*                                      DISASSOCIATE          @Y30LB03*/
         MVC   DPFLAGS(2),@CB02333                                 2519
*       GEN(STIDP NAMFIELD);        /* GET ID OF RUNNING CPU @ZM31124*/
         STIDP NAMFIELD
*       HOST=NAMFIELD(2:6);         /* INIT HOST ID          @Y30LB03*/
*                                                                  2521
         MVC   HOST(5),NAMFIELD+1                                  2521
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE DISASSOCIATE MACRO                          @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2522
*       SAVREENT=REENTRY;           /* SAVE REENTRY POINTER  @G24LB02*/
         L     @12,REENTRY                                         2522
         ST    @12,SAVREENT                                        2522
*       REENTRY=ADDR(IORSRET);      /* SET NEW REENTRY POINTER     2523
*                                                            @G24LB02*/
         LA    @12,IORSRET                                         2523
         ST    @12,REENTRY                                         2523
*       SVCCALL=ON;                 /* SET SVC CALL FLAG     @G24LB02*/
         OI    SVCCALL,B'00001000'                                 2524
*IASDAS1:                                                          2525
*                                                                  2525
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /* MACMEAN MSSC ASSOCIATE MACRO                      @Y30LB02*/
*       /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00           @Y30LB02*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Y30LB02*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Y30LB02*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Y30LB02*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Y30LB02*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Y30LB02*/
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2525
*       RFY                                                        2525
*        (ASDAR1) RSTD;             /* RESTRICT REG 1        @Y30LB02*/
IASDAS1  DS    0H                                                  2526
*       ASDAR1=ADDR(ADLIST);        /* R1 POINTER TO REQUEST BLOCK 2526
*                                                            @Y30LB02*/
         LA    ASDAR1,ADLIST                                       2526
*       ASDALEN='10'X;              /* LENGTH OF ASSOC REQUEST     2527
*                                                            @Y30LB02*/
         LA    @12,16                                              2527
         ST    @12,ASDALEN                                         2527
*       ASDAOPC='2C'X;              /* ASSOCIATE OPCODE      @Y30LB02*/
         MVI   ASDAOPC,X'2C'                                       2528
*       ASDAFLG=(DPFLAGS);          /* VALUE OF FLAGS PARAMETER    2529
*                                                            @Y30LB02*/
         MVC   ASDAFLG(2),DPFLAGS                                  2529
*       ASDACPU=(HOST);             /* HOSTID                @Y30LB02*/
         MVC   ASDACPU(5),HOST                                     2530
*       SVC(126);                   /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 2531
*       RFY                                                        2532
*         ASDAR1 UNRSTD;            /* UNRESTRICT REG 1      @Y30LB02*/
*                                                                  2532
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB03*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2533
*       DPFLAGS='1000000000000000'B;/* INIT FLAGS FOR        @Y30LB03
*                                      PURGE                 @Y30LB03*/
         MVC   DPFLAGS(2),@CB02326                                 2533
*IPAIR4:                                                           2534
*                                                                  2534
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO       @Y30LB02*/
*       /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00           @Y30LB02*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Y30LB02*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Y30LB02*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Y30LB02*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Y30LB02*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Y30LB02*/
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2534
*       RFY                                                        2534
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/
IPAIR4   DS    0H                                                  2535
*       PAIRR1=ADDR(PURGLIST);      /* SET PAIRR1 TO REQ BLOCK     2535
*                                                            @Y30LB02*/
         LA    PAIRR1,PURGLIST                                     2535
*       PURGLL='0D'X;               /* SET LENGTH FIELD      @Y30LB02*/
         LA    @12,13                                              2536
         ST    @12,PURGLL                                          2536
*       PURGOP='14'X;               /* PURG OPCODE           @Y30LB02*/
         MVI   PURGOP,X'14'                                        2537
*       PURGFLG=(DPFLAGS);          /* FILL IN FLAGS FIELD   @Y30LB02*/
         MVC   PURGFLG(2),DPFLAGS                                  2538
*       PURGHOST=(HOST);            /* FILL IN HOSTID FIELD  @Y30LB02*/
         MVC   PURGHOST(5),HOST                                    2539
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 2540
*       RFY                                                        2541
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02
*                                      ISSUE PURGE FOR       @Y30LB03
*                                      BROTHER CPU           @Y30LB03*/
*IORSRET:                           /* LABEL FOR RETURN      @G24LB02*/
*       SVCCALL=OFF;                /* CLEAR SVC CALL FLAG   @G24LB02*/
IORSRET  NI    SVCCALL,B'11110111'                                 2542
*       REENTRY=SAVREENT;           /* RESTORE REENTRY POINTER     2543
*                                                            @G24LB02*/
         L     @12,SAVREENT                                        2543
         ST    @12,REENTRY                                         2543
*     END;                          /* NOT AP                @G24LB05*/
*   ICBIOR=F0;                      /* CLEAR ECB BEFORE      @Y30LB03
*                                      RETURN TO WAIT        @Y30LB03*/
@RF02515 L     @12,ICBPTR                                          2545
         SLR   @09,@09                                             2545
         ST    @09,ICBIOR(,@12)                                    2545
*   RFY                                                            2546
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1470;                   /* RESTORE CALLERS REGISTER 14 2547
*                                                            @Z307B04*/
         L     R14,SAVR1470                                        2547
*   RFY                                                            2548
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO ICBMSG00       @Y30LB03*/
@EL00027 DS    0H                                                  2549
@EF00027 DS    0H                                                  2549
@ER00027 BR    @14                                                 2549
*   END ICBMSG70;                   /*                       @Y30LB03*/
*                                                                  2551
*/*********************************************************  @Y30LB03*/
*                                                                  2551
*ICBMSG80:                                                         2551
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG80 DS    0H                                                  2552
*/*********************************************************  @Y30LB03*/
*/* THIS SUBROUTINE INITIALIZES COMMON I/O DATA AREAS        @ZD00177*/
*/* CALLED BY SUBROUTINES ICBMSG10, AND ICBMSG50             @ZM31056*/
*/*********************************************************  @Y30LB03*/
*                                                                  2552
*   RFY                                                            2552
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1480=R14;                   /* SAVE CALLERS REGISTER 14    2553
*                                                            @Z307B04*/
         ST    R14,SAVR1480                                        2553
*   RFY                                                            2554
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   SRB=''B;                        /* INIT SRB TO 0'S       @Y30LB03*/
         L     @12,SRBPTR                                          2555
         XC    SRB(44,@12),SRB(@12)                                2555
*   IOSB=''B;                       /* INIT IOSB TO 0'S      @Y30LB03*/
         L     @09,IOSBPTR                                         2556
         XC    IOSB(108,@09),IOSB(@09)                             2556
*   SSCDATA=''B;                    /* INIT SSCDATA FIELD TO 0'S   2557
*                                                            @Y30LB03*/
         L     @04,SSCDATAP                                        2557
         XC    SSCDATA(84,@04),SSCDATA(@04)                        2557
*   SRBID=SRBEBCDC;                 /* EBCDIC OF SRB         @Y30LB03*/
         MVC   SRBID(4,@12),SRBEBCDC                               2558
*   SRBASCB=ASCBPTR;                /* ASCB ADDR             @Y30LB03*/
         L     @15,ASCBPTR                                         2559
         ST    @15,SRBASCB(,@12)                                   2559
*   SRBPARM=IOSBPTR;                /* IOSB PTR              @Y30LB03*/
         ST    @09,SRBPARM(,@12)                                   2560
*   IOSCCHN='1'B;                   /* INIT IOSB FLG FOR CMND      2561
*                                      CHAINING              @Y30LB03*/
         OI    IOSCCHN(@09),B'01000000'                            2561
*   IOSASID='0001'X;                /* ASID MSG TASK         @Y30LB03*/
         MVC   IOSASID(2,@09),@CB02431                             2562
*   IOSSRB=SRBPTR;                  /* SRB ADDRESS           @Y30LB03*/
         ST    @12,IOSSRB(,@09)                                    2563
*   IOSUSE=SSCDATAP;                /* SSCDATA AREA ADDR     @Y30LB03*/
         ST    @04,IOSUSE(,@09)                                    2564
*   TCBADDR=ICBTCB;                 /* TCB ADDRESS           @Y30LB03*/
         L     @12,ICBPTR                                          2565
         L     @12,ICBTCB(,@12)                                    2565
         ST    @12,TCBADDR(,@04)                                   2565
*   RFY                                                            2566
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1480;                   /* RESTORE CALLERS REGISTER 14 2567
*                                                            @Z307B04*/
         L     @12,SAVR1480                                        2567
         LR    R14,@12                                             2567
*   RFY                                                            2568
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00028 DS    0H                                                  2569
@EF00028 DS    0H                                                  2569
@ER00028 BR    @14                                                 2569
*   END ICBMSG80;                   /*                       @Y30LB03*/
*                                                                  2571
*   /*****************************************************************/
*   /*                                                               */
*   /* **************************************************    @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2571
*ICBMSG82:                                                         2571
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
*                                                                  2571
ICBMSG82 DS    0H                                                  2572
*   /*****************************************************************/
*   /*                                                               */
*   /* **************************************************    @Y30LB03*/
*   /* THIS SUBROUTINE IS USED FOR 2 CONVERSION NEEDS:       @Y30LB03*/
*   /* (1)                                                   @Y30LB03*/
*   /* THIS SUBROUTINE IS CALLED WHENEVER AN MSSC MACRO IS   @Y30LB03*/
*   /* IS ISSUED THAT RESULTS WITH FAILURE INDICATION ON     @Y30LB03*/
*   /* RETURN FROM SVC 126.                                  @Y30LB03*/
*   /* ON ERROR SITUATIONS A REASON CODE IS PASSED BACK      @Y30LB03*/
*   /* TO THE CALLED IN REGISTER 0. THIS SUBROUTINE          @Y30LB03*/
*   /* CONVERTS THE REASON CODE TO A 3-BYTE PRINTABLE        @Y30LB03*/
*   /* FIELD. THIS FIELD IS THEN INSERTED INTO A WTO         @Y30LB03*/
*   /* MESSAGE.                                              @Y30LB03*/
*   /* (2)                                                   @Y30LB03*/
*   /* CONVERT 2 BYTE HEX SSID(UNIT)                         @Y30LB03*/
*   /* TO 3 BYTE REAL UNIT IN EBCDIC                         @Y30LB03*/
*   /* SO THAT THE UNIT CAN BE PRINTED                       @Y30LB03*/
*   /* VIA WTO.                                              @Y30LB03*/
*   /* THIS SUBROUTINE IS CALLED FOR THIS REASON IN          @Y30LB03*/
*   /* SUBROUTINES ICBMSG15 AND ICBMSG20                     @Y30LB03*/
*   /* WHEN MESSAGE PROCESSING WARRANTS                      @Y30LB03*/
*   /* ITS USE.                                              @Y30LB03*/
*   /*                                                       @Y30LB03*/
*   /* *************************************                 @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2572
*   RFY                                                            2572
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVR1482=R14;                   /* SAVE CALLERS REGISTER 14    2573
*                                                            @Z307B04*/
         ST    R14,SAVR1482                                        2573
*   RFY                                                            2574
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   NUMBRS=NUMS;                    /* BUILD TRANS TABLE     @Z40LB01*/
         L     @12,CCWSPTR                                         2575
         MVC   NUMBRS+24(16,@12),NUMS                              2575
*   INTER=INTER*F16;                /* SHIFT LEFT            @Z40LB01
*                                      FOUR BITS             @Y30LB03*/
         L     @12,INTER                                           2576
         SLL   @12,4                                               2576
         ST    @12,INTER                                           2576
*   GEN(OI    BYTE4,X'0F');         /* OR IN AN F            @Y30LB03*/
         OI    BYTE4,X'0F'
*   UNPK(DBLWORD,INTER);            /* UNPACK                @Z40LB01*/
         UNPK  DBLWORD(8),INTER(4)                                 2578
*   INTER=DBLWORD(5:8);             /* MOVE BACK 4 BYTES     @Z40LB01*/
         MVC   INTER(4),DBLWORD+4                                  2579
*   TR(INTER,TRANSTBL);             /* TRANSLATE BYTES       @Z40LB01*/
*                                                                  2580
         L     @12,CCWSPTR                                         2580
         TR    INTER(4),TRANSTBL+24(@12)                           2580
*   /*****************************************************************/
*   /*                                                               */
*   /* *************************************                 @Y30LB03*/
*   /*                                                       @Y30LB03*/
*   /* TRANSLATED TO 4 BYTES                                 @Z40LB01*/
*   /*                                                       @Y30LB03*/
*   /* *************************************                 @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2581
*   RFY                                                            2581
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVR1482;                   /* RESTORE CALLERS REGISTER 14 2582
*                                                            @Z307B04*/
         L     R14,SAVR1482                                        2582
*   RFY                                                            2583
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00029 DS    0H                                                  2584
@EF00029 DS    0H                                                  2584
@ER00029 BR    @14                                                 2584
*   END ICBMSG82;                   /*                       @Y30LB03*/
*                                                                  2586
*/*********************************************************  @Y30LB03*/
*                                                                  2586
*ICBMSG83:                                                         2586
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
*                                                                  2586
ICBMSG83 DS    0H                                                  2587
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE SETS UP THE REQUIRED INTERFACE        @Y30LB03*/
*   /* FOR SMF PROCESSING AND ISSUES THE SMF SVC.            @Y30LB03*/
*   /* CALLED BY SUBRTNS ICBMSG16 AND ICBMSG49.              @Y30LB03*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2587
*   RFY                                                            2587
*    (R1,                                                          2587
*     R14) RSTD;                    /* RESTRICT REG 1        @G24LB02*/
*   SAVR1483=R14;                   /* SAVE CALLERS REGISTER 14    2588
*                                                            @Z307B04*/
         ST    R14,SAVR1483                                        2588
*   SVC(83);                        /* ISSUE SMF SVC         @Y30LB03*/
         SVC   83                                                  2589
*   RESPECIFY                                                      2590
*     R1 UNRSTD;                    /* RELEASE REG 1         @Y30LB03*/
*   R14=SAVR1483;                   /* RESTORE CALLERS REGISTER 14 2591
*                                                            @Z307B04*/
         L     R14,SAVR1483                                        2591
*   RFY                                                            2592
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @Y30LB03*/
@EL00030 DS    0H                                                  2593
@EF00030 DS    0H                                                  2593
@ER00030 BR    @14                                                 2593
*   END ICBMSG83;                   /*                       @Y30LB03*/
*                                                                  2595
*/*********************************************************  @ZM31056*/
*/*                                                          @ZM31056*/
*/*      ICBMSG88  VIRTUAL VOLUME UCB CLEANUP FOR SHUTDOWN   @ZM31056*/
*/*                                                          @ZM31056*/
*/*     INPUT:    POINTER TO THE UCBS VIA THE CVT            @ZM31056*/
*/*                                                          @ZM31056*/
*/*    PROCESSING:  SCAN THE UCB LIST FOR EACH VALID UCB     @ZM31056*/
*/*       FOR EACH 3330 UCB WHICH HAS THE VIRTUAL VOLUME BIT @ZM31056*/
*/*       SET ON. REPLACE VOLSER WITH ZEROE, SET PATH MASK   @ZM31056*/
*/*       TO ZERO, MARK THE UCB NOT READY  AND OFFLINE       @ZA09553*/
*/*                                                          @ZM31056*/
*/*   OUTPUT:  3330V UCBS HAVE ZERO VOLSER, PATH MASK ZERO,  @ZM31056*/
*/*        AND ARE MARKED OFFLINE                            @ZM31056*/
*/*                                                          @ZM31056*/
*/********************************************************** @ZM31056*/
*/*                                                          @ZM31056*/
*                                                                  2595
*ICBMSG88:                                                         2595
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @ZM31056*/
ICBMSG88 DS    0H                                                  2596
*   DCL                                                            2596
*     UCBPTR16 PTR(16) INIT(0);     /* FOR UCB IN THIS ROUTINE     2596
*                                                            @ZM31056*/
*   DCL                                                            2597
*     LISTA POINTER(31);            /* ADDR OF UCB LIST IN SCAN    2597
*                                                            @ZM31056*/
*   DCL                                                            2598
*     BEGUPTR POINTER(16) BASED;    /* TO GET UCB ADDRESS    @ZM31056*/
*   DCL                                                            2599
*     ZERZ FIXED(31) CONSTANT(0);   /* FULLWORD ZEROES       @ZM31056*/
*   DCL                                                            2600
*     C1ZERO FIXED(8) CONSTANT(0);  /* BYTE OF ZERO          @ZM31056*/
*   DCL                                                            2601
*     ALINC FIXED(15) CONSTANT(2);  /* INCR FOR UCB LIST SCAN      2601
*                                                            @ZM31056*/
*   RFY                                                            2602
*     R14 RSTD;                     /* 14 FOR RETURN ADDRESS @ZM31056*/
*   SAVR1498=R14;                   /* SAVE RETURN ADDRESS   @ZM31056*/
         ST    R14,SAVR1498                                        2603
*   RFY                                                            2604
*     R14 UNRSTD;                   /* FREE UP 14            @ZM31056*/
*   LISTA=CVTILK2;                  /* ADDRESS OF UCB ADDRESS LIST 2605
*                                                            @ZM31056*/
         L     @12,CVTPTR                                          2605
         L     @12,CVTILK2(,@12)                                   2605
         ST    @12,LISTA                                           2605
*   DO WHILE UCBPTR16^=FOXES;       /* MORE UCBS TO SEARCH ? @ZM31056*/
         B     @DE02606                                            2606
@DL02606 DS    0H                                                  2607
*     UCBPTR16=LISTA->BEGUPTR;      /* ADDRESS OF ONE UCB, MAYBE   2607
*                                                            @ZM31056*/
         L     @12,LISTA                                           2607
         LH    @12,BEGUPTR(,@12)                                   2607
         N     @12,@CF02463                                        2607
         STH   @12,UCBPTR16                                        2607
*     IF UCBPTR16^=ZERZ&UCBPTR16^=FOXES/* VALID UCB ADDRESS ?@ZM31056*/
*       THEN                        /* THERE IS A UCB ADDRESS IN   2608
*                                                            @ZM31056*/
*                                                                  2608
         LH    @12,UCBPTR16                                        2608
         N     @12,@CF02463                                        2608
         LTR   @12,@12                                             2608
         BZ    @RF02608                                            2608
         SLR   @09,@09                                             2608
         ICM   @09,3,FOXES                                         2608
         CR    @12,@09                                             2608
         BE    @RF02608                                            2608
*       /*************************************************************/
*       /*                                                           */
*       /* THIS LIST POSITION                                @ZM31056*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2609
*       DO;                         /* SEE IF ONE OF OUR UCBS      2609
*                                                            @ZM31056*/
*         IF UCBPTR16->UCB3DACC=BONE/* DIRECT ACCESS ?       @ZM31056*/
*             &UCBPTR16->UCBUNTYP='09'X/* 3330 ?             @ZM31056*/
*           THEN                    /* THIS IS A 3330 UCB    @ZM31056*/
         TM    UCB3DACC(@12),B'00100000'                           2610
         BNO   @RF02610                                            2610
         CLI   UCBUNTYP(@12),X'09'                                 2610
         BNE   @RF02610                                            2610
*           DO;                     /* SEE IF VIRTUAL 3330   @ZM31056*/
*             IF UCBPTR16->UCBRVDEV=BONE/* VIRTUAL VOLUME?   @ZM31056*/
*               THEN                /* THIS IS A VIRTUAL 3330      2612
*                                                            @ZM31056*/
         TM    UCBRVDEV(@12),B'00001000'                           2612
         BNO   @RF02612                                            2612
*               DO;                 /* WHICH IS WHAT WERE LOOKING FOR
*                                                            @ZM31056*/
*                 IF MSG42SW=BONE THEN/* MSG42 CALLER        @ZDR2048*/
         TM    MSG42SW,B'00000010'                                 2614
         BNO   @RF02614                                            2614
*                   DO;             /* CALLED BY MSG42 FOR VOL CHECK
*                                                            @ZDR2048*/
*                     IF UCBPTR16->UCBVOLI=VOL&/* VOLID CHECK      2616
*                                                            @ZDR2048*/
*                         UCBPTR16->UCBNRY=BZERO THEN/* READY CHECK
*                                                            @ZDR2048*/
         L     @04,CWBPTR                                          2616
         CLC   UCBVOLI(6,@12),VOL(@04)                             2616
         BNE   @RF02616                                            2616
         TM    UCBNRY(@12),B'01000000'                             2616
         BNZ   @RF02616                                            2616
*                       DO;         /* VOLID IS MOUNTED AND READY  2617
*                                                            @ZDR2048*/
*                         CUUUCB=UCBPTR16->UCBNAME;/* SAVE UCBNAME 2618
*                                                            @ZDR2048*/
         MVC   CUUUCB(3),UCBNAME(@12)                              2618
*                         UCBPTR16=FOXES;/* SET FOR SCAN EXIT      2619
*                                                            @ZDR2048*/
         STH   @09,UCBPTR16                                        2619
*                       END;        /* END VOL MOUNTED AND READY CODE
*                                                            @ZDR2048*/
*                   END;            /* END MSG42 CALLER CODE @ZDR2048*/
*                 ELSE              /* MSG89 CALLER CODE     @ZDR2048*/
*                   DO;             /* CLEAR ALL VUCBS FOR SHUT DOWN
*                                                            @ZDR2048*/
         B     @RC02614                                            2622
@RF02614 DS    0H                                                  2623
*                     UCBPTR16->UCBVOLI=''B;/* ZERO THE VOLSER HERE
*                                                            @ZM31056*/
         LH    @12,UCBPTR16                                        2623
         N     @12,@CF02463                                        2623
         XC    UCBVOLI(6,@12),UCBVOLI(@12)                         2623
*                     UCBPTR16->UCBCHM=C1ZERO;/* ZERO CHANNEL MASK 2624
*                                                            @ZM31056*/
         MVI   UCBCHM(@12),X'00'                                   2624
*                     UCBPTR16->UCBNRY=BONE;/* MARK NOT READY      2625
*                                                            @ZM31056*/
         OI    UCBNRY(@12),B'01000000'                             2625
*                     UCBPTR16->UCBONLI=OFF;/* MARK OFFLINE  @ZA09553*/
         NI    UCBONLI(@12),B'01111111'                            2626
*                   END;            /* END CLEAR VUCBS FOR SHUTDOWN
*                                      CODE                  @ZDR2048*/
*               END;                /* PROCESSING UCB FOR A VIRTUAL
*                                      VOLUME                @ZM31056*/
*             ELSE                  /* NOT A VIRTUAL VOLUME  @ZM31056*/
*               ;                   /* DO NOT TOUCH THIS UCB @ZM31056*/
@RF02612 DS    0H                                                  2630
*           END;                    /* LOGIC FOR 3330 UCB    @ZM31056*/
*         ELSE                      /* NOT A 3330 UCB        @ZM31056*/
*           ;                       /* NOT OF INTEREST       @ZM31056*/
@RF02610 DS    0H                                                  2632
*       END;                        /* LOOKING AT ONE UCB    @ZM31056*/
*     ELSE                          /* NOT A UCB ADDRESS HERE      2633
*                                                            @ZM31056*/
*       ;                           /* ON TO NEXT LIST ENTRY @ZM31056*/
@RF02608 DS    0H                                                  2634
*     LISTA=LISTA+ALINC;            /* INCREMENT THROUGH UCB LIST  2634
*                                                            @ZM31056*/
@RC02608 LA    @12,2                                               2634
         AL    @12,LISTA                                           2634
         ST    @12,LISTA                                           2634
*   END;                            /* OF THE SEARCH FOR VIRTUAL   2635
*                                                            @ZM31056*/
*                                                                  2635
@DE02606 CLC   UCBPTR16(2),FOXES                                   2635
         BNE   @DL02606                                            2635
*   /*****************************************************************/
*   /*                                                               */
*   /* VOLUME UCBS FOR PURGE                                 @ZM31056*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2636
*   RFY                                                            2636
*     R14 RSTD;                     /* 14 FOR RETURN ADDRESS @ZM31056*/
*   R14=SAVR1498;                   /* RESTORE RETURN ADDRESS      2637
*                                                            @ZM31056*/
         L     R14,SAVR1498                                        2637
*   RFY                                                            2638
*     R14 UNRSTD;                   /* FREE 14 FOR BRANCH GEN      2638
*                                                            @ZM31056*/
*   END ICBMSG88;                   /*                       @ZM31056*/
@EL00031 DS    0H                                                  2639
@EF00031 DS    0H                                                  2639
@ER00031 BR    @14                                                 2639
*                                                                  2640
*/*********************************************************  @ZM31056*/
*/*                                                          @ZM31056*/
*/*    ICBMSG89     MESSAGE TASK SHUTDOWN                    @ZM31056*/
*/*                                                          @ZM31056*/
*/*    INPUT    CCWSPTR                                      @ZM31056*/
*/*              IF ZERO, NO STORAGE WAS OBTAINED            @ZM31056*/
*/*              IF NONZERO, STORAGE WAS OBTAINED            @ZM31056*/
*/*             ICBV                                         @ZM31056*/
*/*              IF ZERO, SHUTDOWN FOR NO MSVC               @ZM31056*/
*/*              IF NONZERO, MSVC DID NOT INITIALIZE         @ZM31056*/
*/*             READYFAL                                     @ZM31118*/
*/*              IF ON, READY FAILURE IS CAUSE FOR SHUTDOWN  @ZM31118*/
*/*              IF OFF, ANOTHER FAILURE CAUSE               @ZM31118*/
*/*                                                          @ZM31056*/
*/*    PROCESSING     DETERMINE CAUSE OF SHUTDOWN AND WRITE  @ZM31056*/
*/*              APPROPRIATE MESSAGE, IF ANY                 @ZM31056*/
*/*              WAIT FOREVER ON AN ECB NO ONE POSTS --      @ZM31056*/
*/*              ICBMSG89 NEVER RETURNS TO ITS CALLER        @ZM31056*/
*/*                                                          @ZM31056*/
*/*     OUTPUT     MESSAGE TO SYSTEM OPERATOR IF GETMAIN     @ZM31056*/
*/*              FOR MESSAGE TASK I/O STORAGE FAILED         @ZM31056*/
*/*              POST TO ATTACHEE OF MESSAGE TASK            @ZM31056*/
*/*                                                          @ZM31056*/
*/*                                                          @ZM31056*/
*/*********************************************************  @ZM31056*/
*                                                                  2640
*ICBMSG89:                                                         2640
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/* SHUTDOWN              @ZM31056*/
ICBMSG89 DS    0H                                                  2641
*NOICBMSG:                          /* ICBMSG WILL NOT BE AVAILABLE
*                                                            @ZM31056*/
*   WAITECB=F0;                     /* ZERO THE WAIT ECB     @ZM31056*/
NOICBMSG SLR   @12,@12                                             2641
         ST    @12,WAITECB                                         2641
*   ICBI=BZERO;                     /* CLEAR INIT'D BIT IN CB      2642
*                                                            @ZM31056*/
*/*   AS OF MSSC RELEASE 3, ALLOCATION WILL NOT ALLOCATE     @G24LB02*/
*/*   VUCBS IF THE MSS BROKEN BOX FLAG (ICBB) IS SET ON.     @G24LB02*/
*/*   SINCE ANY VVOLUME MOUNTS WILL NOT BE REJECTED BY       @G24LB02*/
*/*   THE SVC, IT WILL SAVE EXECUTION TIME IF THIS FLAG      @G24LB02*/
*/*   IS SET WHEN MSSC IS NOT AVAILABLE FOR THE IPL.         @G24LB02*/
*                                                                  2643
*   ICBB=ON;                        /* SET BROKEN BOX FLAG   @G24LB02*/
         L     @09,ICBPTR                                          2643
         OI    ICBB(@09),B'00010000'                               2643
         NI    ICBI(@09),B'01111111'                               2643
*   IF CCWSPTR^=0                   /* HAS STORAGE BEEN OBTAINED ? 2644
*                                                            @ZM31056*/
*     THEN                                                         2644
         C     @12,CCWSPTR                                         2644
         BE    @RF02644                                            2644
*     DO;                           /* MUST FREE STORAGE OBTAINED  2645
*                                                            @ZM31056*/
*       GTMAINSP='F5'X;             /* FOR SUBPOOL 245       @ZM31056*/
         MVI   GTMAINSP,X'F5'                                      2646
*       GEN REFS(GTMAINR0,CCWSPTR);                                2647
*                                                  /*        @ZM31056*/
         L     R0,GTMAINR0           SET UP REG0 FOR FREEMN    @ZM31056
         L     R1,CCWSPTR            PUT ADDRESS IN REG 1      @ZM31056
* FREE DYNAMIC AREA                                            @ZM31056
IFREEMN1 FREEMAIN R,LV=(R0),A=(R1),                            @ZM31056*
               RELATED=(SP245,ICB2MSG(IGETMN1))                @ZM31056
*       WTOGEN03=MESGS(MSG98501);   /* PROVIDE TEXT          @Z40LB01*/
         MVI   WTOGEN03+72,C' '                                    2648
         L     @12,@CA02101                                        2648
         MVC   WTOGEN03(72),MESGS-MSGS+2888(@12)                   2648
*       CALL ICBMSG45;              /* TO WRITE MESSAGE      @ZM31056*/
         BAL   @14,ICBMSG45                                        2649
*       GEN REFS(WAITECB);                                         2650
*                                         /*WAIT FOREVER     @ZM31056*/
IWAIT1   WAIT ECB=WAITECB            ERROR EXIT,NEVER POSTED   @ZM31056
*     END;                                                         2651
*   END ICBMSG89;                   /*                       @ZM31056*/
@EL00032 DS    0H                                                  2652
@EF00032 DS    0H                                                  2652
@ER00032 BR    @14                                                 2652
*                                                                  2653
*/*********************************************************  #Y30LB03*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG90                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = STAE EXIT SUBROUTINE                 @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = TO REESTABLISH MESSAGE TASK SHOULD IT ABEND  @Y30LB03
*                                                             @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = TO REESTABLISH THE MESSAGE TASK             @Y30LB03
*       SHOULD IT ABEND.                                      @Y30LB03
*                                                             @Y30LB03
*02*    LINKAGE = BALR (FROM ASIR)                            @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = R0 - I/O STATUS                               @Y30LB03
*               R1 - POINTER TO STAE WORK AREA                @Y30LB03
*               R13 - POINTER TO SAVE AREA                    @Y30LB03
*               R14 - RETURN TO ASIR                          @Y30LB03
*               R15 - ENTRY TO STAE EXIT ROUTINE              @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = R0 - POINTER TO RETRY ROUTINE (ICBMSG95)     @Y30LB03
*                R1 - SAME AS AT ENTRY                        @Y30LB03
*                R13 - SAME AS AT ENTRY                       @Y30LB03
*                R14 - SAME AS AT ENTRY                       @Y30LB03
*                R15 - RC=4 FOR RETRY                         @Y30LB03
*                      RC=0 FOR CONTINUE ABEND                @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  2653
*ICBMSG90:                                                         2653
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG90 DS    0H                                                  2654
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    STAE EXIT SUBROUTINE                                  @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  2654
*   RESPECIFY                                                      2654
*    (R0,                                                          2654
*     R1,                                                          2654
*     R13,                                                         2654
*     R14,                                                         2654
*     R15) RSTD;                    /*                       @Y30LB03*/
*   GEN REFS(R0,R14,R15);                                          2655
*                                                          /*@ZA16123*/
          DROP  R8                   DROP BASE REG             @ZA16123
          DROP  R7                   DROP BASE REG             @ZA16123
          DROP  R6                   DROP BASE REG             @ZA16123
          DROP  R5                   DROP BASE REG             @ZA16123
          USING *,R15                                          @Y30LB03
          L     R0,STAEB1                                      @ZA16123
          B     S90                  BRANCH TO S90             @Y30LB03
STAEB1    DC    A(ICBMSG95)          ADDRESS OF ICBMSG95       @ZA16123
S90       EQU   *                                              @Y30LB03
          LA    R15,C4(R0)           SET EXIT RETRY PARM       @ZA16123
          DROP  R15                  DROP EXIT BASE REG        @ZA16123
          BR    R14                  RETURN TO ABEND EXIT      @ZA16123
*   RETURN;                         /* RTN TO ABEND          @Y30LB03*/
@EL00033 DS    0H                                                  2656
@EF00033 DS    0H                                                  2656
@ER00033 BR    @14                                                 2656
*   END ICBMSG90;                   /*                       @Y30LB03*/
*                                                                  2658
*/********************************************************   @ZM31014*/
*/*  START OF SPECIFICATIONS ****                             @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-NAME = ICBMSG95                                  @Y30LB03
*                                                             @Y30LB03
*01*  DESCRIPTIVE-NAME = STAE RETRY SUBROUTINE                @Y30LB03
*                                                             @Y30LB03
*01*  COPYRIGHT = NONE                                        @Y30LB03
*                                                             @Y30LB03
*01*  STATUS = OS/VS2 RELEASE 3.0                             @Y30LB03
*                                                             @Y30LB03
*01*  FUNCTION = REESTABLISH EXECUTION OF MESSAGE TASK        @Y30LB03
*                                                             @Y30LB03
*01*  NOTES = NONE                                            @Y30LB03
*                                                             @Y30LB03
*02*    CHARACTER-CODE-DEPENDENCIES = NONE                    @Y30LB03
*                                                             @Y30LB03
*02*    DEPENDENCIES = ICB2MSG COMPONENT                      @Y30LB03
*                                                             @Y30LB03
*02*    RESTRICTIONS = NONE                                   @Y30LB03
*                                                             @Y30LB03
*02*    REGISTER-CONVENTIONS = R0 THROUGH R15                 @Y30LB03
*                                                             @Y30LB03
*02*    PATCH-LABEL = NONE                                    @Y30LB03
*                                                             @Y30LB03
*01*  MODULE-TYPE = MODULE                                    @Y30LB03
*                                                             @Y30LB03
*02*    PROCESSOR = PLS                                       @Y30LB03
*                                                             @Y30LB03
*02*    ATTRIBUTES = REUSABLE                                 @Y30LB03
*                    NUCLEUS RESIDENT                         @Y30LB03
*                    KEY = 0                                  @Y30LB03
*                    PAGEABLE                                 @Y30LB03
*                    SUPV STATE                               @Y30LB03
*                    ENABLED                                  @Y30LB03
*                                                             @Y30LB03
*01*  ENTRY-POINT = ICBMSG95                                  @Y30LB03
*                                                             @Y30LB03
*02*    PURPOSE = DETERMINE WHERE TO RE-ENTER EXECUTION       @Y30LB03
*       OF MESSAGE ROUTINE, FREE THE STAE WORK AREA,          @Y30LB03
*       REESTABLISH STAE ENVIRONMENT, AND RETURN TO           @Y30LB03
*       MESSAGE ROUTINE.                                      @Y30LB03
*                                                             @Y30LB03
*02*    LINKAGE = BALR (FROM ASIR)                            @Y30LB03
*                                                             @Y30LB03
*02*    INPUT = R0 - RETURN CODE                              @Y30LB03
*               R1 - POINTER TO STAE WORK AREA (IF R0^= 12)   @Y30LB03
*               R14 - RETURN TO ASIR                          @Y30LB03
*               R15 - ENTRY TO STAE RETRY ROUTINE (ICBMSG95)  @Y30LB03
*                                                             @Y30LB03
*02*    OUTPUT = R14 - RETURN TO MESSAGE TASK                 @Y30LB03
*                                                             @Y30LB03
*02*    EXIT-NORMAL = BR 14                                   @Y30LB03
*                                                             @Y30LB03
*02*    EXIT-ERROR = NONE                                     @Y30LB03
*                                                             @Y30LB03
*01*  EXTERNAL-REFERENCES = NONE                              @Y30LB03
*                                                             @Y30LB03
*02*    ROUTINES = NONE                                       @Y30LB03
*                                                             @Y30LB03
*02*    DATA-SETS = NONE                                      @Y30LB03
*                                                             @Y30LB03
*02*    DATA-AREA = STAE WORK AREA                            @Y30LB03
*                                                             @Y30LB03
*02*    CONTROL-BLOCKS = NONE                                 @Y30LB03
*                                                             @Y30LB03
*01*  TABLES = NONE                                           @Y30LB03
*                                                             @Y30LB03
*01*  MACROS = STAE                                           @Y30LB03
*              FREEMAIN                                       @Y30LB03
*              SETLOCK                                        @Y30LB03
*                                                             @Y30LB03
**** END OF SPECIFICATIONS **                                @Y30LB03*/
*                                                                  2658
*ICBMSG95:                                                         2658
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Y30LB03*/
ICBMSG95 DS    0H                                                  2659
*/*  ****************************************************    @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*    STAE RETRY SUBROUTINE                                 @Y30LB03*/
*/*                                                          @Y30LB03*/
*/*  ****************************************************    @Y30LB03*/
*                                                                  2659
*   DCL                                                            2659
*    (FINISHDQ,                                                    2659
*     PROCMSG,                                                     2659
*     RTN40L,                                                      2659
*     VFREEL,                                                      2659
*     PAWTOL,                                                      2659
*     SPFREEL) EXTERNAL LABEL;      /* DECLARE LABELS        @G24LB02*/
*   RESPECIFY                                                      2660
*    (R0,                                                          2660
*     R1,                                                          2660
*     R14,                                                         2660
*     R15) RSTD;                    /*                       @Y30LB03*/
*   GEN REFS(R5,R6,R7,R8,R15);                                     2661
*                                                          /*@Y30LB03*/
          USING *,R15                                          @Y30LB03
          L     R8,STAEB2                                      @Y30LB03
          B     S95                   BRANCH TO S95            @Y30LB03
STAEB2    DC    A(START)              ADDRESS OF START         @Y30LB03
S95       EQU   *                                              @Y30LB03
          DROP  R15                                            @Y30LB03
          USING START,R8                                       @Y30LB03
          LA    R7,F4095(R8)          SET SECOND BASE REG      @ZA16123
          USING START+4095,R7         ESTABLISH ADDRESSABILTY  @ZA16123
          LA    R6,F4095(R7)          SET THIRD BASE REG       @ZA16123
          USING START+8190,R6         ESTABLISH ADDRESSABILTY  @ZA16123
          LA    R5,F4095(R6)          SET FOURTH BASE REG      @ZA16123
          USING START+12285,R5        ESTABLISH ADDRESSABILTY  @ZA16123
          LA    R13,SAVAREA           RESET SAVE AREA ADDR     @ZA16123
*   IF R0^=F12 THEN                 /* GOOD RTN?             @Y30LB03*/
*                                                                  2662
         C     R0,@CF02050                                         2662
         BE    @RF02662                                            2662
*     /***************************************************************/
*     /*                                                             */
*     /* YES,ISSUE FREEMAIN                                  @Y30LB03*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  2663
*IFREEMN4:                                                         2663
*     GEN(FREEMAIN R,LV=104,A=(R1),SP=250);/*                @Y30LB03*/
IFREEMN4 FREEMAIN R,LV=104,A=(R1),SP=250
*ISTAE2:                                                           2664
*   GEN(STAE  ICBMSG90,CT,XCTL=YES);/*                       @Y30LB03*/
@RF02662 DS    0H                                                  2664
ISTAE2   STAE  ICBMSG90,CT,XCTL=YES
*   R13=ADDR(SAVAREA);              /* REESTABLISH SAVE AREA ADDR  2665
*                                                            @G24LB02*/
         LA    R13,SAVAREA                                         2665
*   IF DQING=BONE THEN              /* DID ABEND OCCUR IN THE      2666
*                                                            @Y30LB03
*                                      MIDDLE OF DQING DELAYED     2666
*                                      RESPONSE QUEUE        @Y30LB03
*                                      ELEMENT ?             @Y30LB03*/
         TM    DQING,B'00100000'                                   2666
         BNO   @RF02666                                            2666
*     REENTRY=ADDR(FINISHDQ);       /* YES, SET REENTRY POINT BACK 2667
*                                                            @Y30LB03
*                                      TO ICBMSG21, SO CAN FINISH  2667
*                                                            @Y30LB03*/
         LA    @12,FINISHDQ                                        2667
         ST    @12,REENTRY                                         2667
*   ELSE                            /* NO, NOT AT THAT POINT @Y30LB03*/
*     IF LOCKRCVY(1:2)^=B2ZERO THEN /* ANY LOCKS HELD?       @Y30LB03*/
         B     @RC02666                                            2668
@RF02666 TM    LOCKRCVY,B'11000000'                                2668
         BZ    @RF02668                                            2668
*       DO;                         /* YES,                  @Y30LB03*/
*         IF CMSLK=BONE THEN        /* CMS LOCK HELD?        @Y30LB03*/
*                                                                  2670
         TM    CMSLK,B'01000000'                                   2670
         BNO   @RF02670                                            2670
*           /*********************************************************/
*           /*                                                       */
*           /* YES, RELEASE IT                               @Y30LB03*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2671
*           GEN;                                                   2671
*                                                                  2671
*                                                          /*@Y30LB03*/
IFRECMSR SETLOCK RELEASE,TYPE=CMS,RELATED=(LOCALLOCK,          @Y30LB03*
               ICB2MSG(IGTCMS1THRU4)),REGS=USE                 @Y30LB03
*           /*********************************************************/
*           /*                                                       */
*           /* RELEASE THE LOCAL LOCK                        @Y30LB03*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2672
*           GEN;                                                   2672
@RF02670 DS    0H                                                  2672
*                                                          /*@Y30LB03*/
IFREELCL SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCALLOCK,        @Y30LB03*
               ICB2MSG(IGETLCL1THRU5)),REGS=USE                @Y30LB03
*           LOCKRCVY(1:2)=B2ZERO;   /* CLEAR LOCK RECOVERY FIELD   2673
*                                                            @Y30LB03*/
         NI    LOCKRCVY,B'00111111'                                2673
*       END;                        /*                       @Y30LB03*/
*   IF MSG05FLG=ON THEN             /* WAS ICBMSG05 IN CONTROL?    2675
*                                                            @G24LB02*/
@RF02668 DS    0H                                                  2675
@RC02666 TM    MSG05FLG,B'01000000'                                2675
         BNO   @RF02675                                            2675
*     DO;                           /* YES                   @G24LB02*/
*       ICBI=OFF;                   /* TURN OFF INIT INDICATOR     2677
*                                                            @G24LB02*/
*       ICBB=ON;                    /* TURN ON BROKEN BOX INDICATOR
*                                                            @G24LB02*/
         L     @12,ICBPTR                                          2678
         OI    ICBB(@12),B'00010000'                               2678
         NI    ICBI(@12),B'01111111'                               2678
*       SVCCALL=OFF;                /* CLEAR SVCCALL FLAG    @G24LB02*/
         NI    SVCCALL,B'11110111'                                 2679
*       REENTRY=ADDR(INITBEG);      /* SETUP REENTRY ADDRESS @G24LB02*/
         LA    @12,INITBEG                                         2680
         ST    @12,REENTRY                                         2680
*     END;                          /*                       @G24LB02*/
*   ELSE                            /*                       @G24LB02*/
*     IF REENTRY=ADDR(PROCMSG) THEN /* WAS MSG BEING PROCESSED?    2682
*                                                            @Y30LB03*/
         B     @RC02675                                            2682
@RF02675 LA    @12,PROCMSG                                         2682
         C     @12,REENTRY                                         2682
         BNE   @RF02682                                            2682
*       DO;                         /* YES,                  @Y30LB03*/
*                                                                  2683
*         /***********************************************************/
*         /*                                                         */
*         /* INCREMENT MSG POINTERS AND COUNTERS TO          @Y30LB03*/
*         /* SKIP THAT MSG                                   @Y30LB03*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  2684
*         LENCNTR=LENCNTR+MSGL;     /*                       @Y30LB03*/
         L     @12,MSGPTR                                          2684
         SLR   @09,@09                                             2684
         IC    @09,MSGL(,@12)                                      2684
         L     @04,LENCNTR                                         2684
         ALR   @04,@09                                             2684
         ST    @04,LENCNTR                                         2684
*         MSGPTR=MSGPTR+MSGL;       /*                       @Y30LB03*/
         ALR   @12,@09                                             2685
         ST    @12,MSGPTR                                          2685
*       END;                        /*                       @Y30LB03*/
*     ELSE                          /* NO, NOT MSG PROCESS   @G24LB02*/
*       IF SVCCALL=ON THEN          /* ABEND WHILE SVC INVOKED?    2687
*                                                            @G24LB02*/
         B     @RC02682                                            2687
@RF02682 TM    SVCCALL,B'00001000'                                 2687
         BNO   @RF02687                                            2687
*         DO;                       /* SVC ABEND CODE        @G24LB02*/
*           R15=F4;                 /* SET REG 15 FOR FAIL   @G24LB02*/
         LA    R15,4                                               2689
*           R0=CODE377;             /* SET R0 REAS CODE X179 @G24LB02*/
         LA    R0,377                                              2690
*         END;                      /* END SVC ABEND CODE    @G24LB02*/
*       ELSE                        /* NO,                   @Y30LB03*/
*         IF RECOVER(1)=BONE THEN   /* COMTASK BEING PRO-    @Y30LB03
*                                      CESSED AT ABEND       @Y30LB03*/
         B     @RC02687                                            2692
@RF02687 TM    RECOVER,B'10000000'                                 2692
         BNO   @RF02692                                            2692
*           DO;                     /* YES, ......           @Y30LB03*/
*             IF RECOVER(2)=BZERO THEN/* HAS THE CWB BEEN    @Y30LB03
*                                      DQ'D ?                @Y30LB03*/
         TM    RECOVER,B'01000000'                                 2694
         BNZ   @RF02694                                            2694
*               REENTRY=ADDR(INITPTRL);/* NO ,SET REENTRY    @Y30LB03*/
         LA    @12,INITPTRL                                        2695
         ST    @12,REENTRY                                         2695
*             ELSE                  /* YES, .......          @Y30LB03*/
*               DO;                 /* CHECK FREED BIT       @Y30LB03*/
         B     @RC02694                                            2696
@RF02694 DS    0H                                                  2697
*                 IF RECOVER(3)=BONE THEN/* IF ON THEN       @Y30LB03*/
         TM    RECOVER,B'00100000'                                 2697
         BNO   @RF02697                                            2697
*                   REENTRY=ADDR(RTN40L);/* SET REENTRY      @Y30LB03*/
         LA    @12,RTN40L                                          2698
         ST    @12,REENTRY                                         2698
*                 ELSE              /* NOT FREED, SO....     @Y30LB03*/
*                   DO;             /* DETERMINE TYPE OF     @Y30LB03
*                                      OPERATOR COMMAND      @Y30LB03*/
         B     @RC02697                                            2699
@RF02697 DS    0H                                                  2700
*                     IF RECOVER(4)=BONE THEN/* WAS IT A VARY?     2700
*                                                            @Y30LB03*/
         TM    RECOVER,B'00010000'                                 2700
         BNO   @RF02700                                            2700
*                       REENTRY=ADDR(VFREEL);/* YES,SET REENTRY    2701
*                                                            @Y30LB03*/
         LA    @12,VFREEL                                          2701
         ST    @12,REENTRY                                         2701
*                     ELSE          /* NO,CHECK ANOTHER      @Y30LB03*/
*                       IF RECOVER(5)=BONE THEN/* WAS IT FOR @Y30LB03
*                                      ASSIGN OR PURGE?      @Y30LB03*/
         B     @RC02700                                            2702
@RF02700 TM    RECOVER,B'00001000'                                 2702
         BNO   @RF02702                                            2702
*                         REENTRY=ADDR(PAWTOL);/* YES,SET REENTRY  2703
*                                                            @Y30LB03*/
         LA    @12,PAWTOL                                          2703
         ST    @12,REENTRY                                         2703
*                       ELSE        /* NO,                   @Y30LB03*/
*                         IF RECOVER(6)=BONE THEN/* WAS IS FOR     2704
*                                                            @Y30LB03
*                                      SUSPEND?              @Y30LB03*/
         B     @RC02702                                            2704
@RF02702 TM    RECOVER,B'00000100'                                 2704
         BNO   @RF02704                                            2704
*                           REENTRY=ADDR(SPFREEL);/* YES,SET RENTRY
*                                                            @Y30LB03*/
         LA    @12,SPFREEL                                         2705
         ST    @12,REENTRY                                         2705
*                   END;            /*                       @Y30LB03*/
@RF02704 DS    0H                                                  2706
@RC02702 DS    0H                                                  2706
@RC02700 DS    0H                                                  2707
*               END;                /*                       @Y30LB03*/
@RC02697 DS    0H                                                  2708
*           END;                    /*                       @Y30LB03*/
@RC02694 DS    0H                                                  2709
*   R14=REENTRY;                    /*                       @Y30LB03*/
@RF02692 DS    0H                                                  2709
@RC02687 DS    0H                                                  2709
@RC02682 DS    0H                                                  2709
@RC02675 L     R14,REENTRY                                         2709
*   RETURN;                         /* RETURN TO ABEND       @Y30LB03*/
@EL00034 DS    0H                                                  2710
@EF00034 DS    0H                                                  2710
@ER00034 BR    @14                                                 2710
*   END ICBMSG95;                   /*                       @Y30LB03*/
*   END ICB2MSG                     /*                       @Y30LB03*/
*/*********************************************************  @ZM31056*/
*                                                                  2712
*                                                                  2712
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (ICB2IOBX)                                       */
*/*%INCLUDE SYSLIB  (IECDIOSB)                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEZINIT )                                       */
*/*%INCLUDE SYSLIB  (IEZMESG )                                       */
*/*%INCLUDE SYSLIB  (ICBRQUE )                                       */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IFASMFR1)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR2)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR3)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR4)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR5)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR6)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR7)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR8)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR9)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRA)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRB)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRC)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRD)                                       */
*/*%INCLUDE SYSLIB  (IEZCWB  )                                       */
*/*%INCLUDE SYSLIB  (IEZSDGLS)                                       */
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                       */
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */
*                                                                  2712
*       ;                                                          2712
@DATA    DS    0H
@CH00081 DC    H'3'
@CH00810 DC    H'6'
@CH01340 DC    H'7'
@CH00935 DC    H'64'
@CH03014 DC    H'100'
@CH02431 DC    XL2'0001'
@SM03332 MVC   ECBDATA(0,@14),MSGDATA+6(@09)
         DS    0F
@AL02272 DC    AL1(X'80')              LIST WITH   1 ARGUMENT(S)
         DC    AL3(LRUSSOB)
         DS    0F
@TF00001 DS    F
         DS    0F
@CF00117 DC    F'1'
@CF00129 DC    F'2'
@CF00109 DC    F'4'
@CF00796 DC    F'5'
@CF00115 DC    F'8'
@CF02044 DC    F'9'
@CF02046 DC    F'10'
@CF02048 DC    F'11'
@CF02050 DC    F'12'
@CH02050 EQU   @CF02050+2
@CF00170 DC    F'15'
@CF00090 DC    F'16'
@CF02056 DC    F'17'
@CF01407 DC    F'20'
@CH01407 EQU   @CF01407+2
@CF02064 DC    F'22'
@CF02073 DC    F'27'
@CF02075 DC    F'28'
@CF02094 DC    F'40'
@CF00838 DC    F'44'
@CF03265 DC    F'84'
@CF02395 DC    F'108'
@CF00741 DC    F'248'
@CF03269 DC    F'1320'
@CF03011 DC    F'1048576'
@CF03340 DC    F'-8'
@CF03341 DC    F'-5'
@CF03342 DC    F'-4'
@CF03331 DC    F'-3'
@CF02435 DC    XL4'40000000'
@CF02463 DC    XL4'0000FFFF'
@CF02951 DC    XL4'F7'
@CV00087 DC    V(ICBMSG56)
@CA02101 DC    A(MSGS)
@CA02112 DC    A(SSIDS)
@CV00088 DC    V(ICBMSG05)
         DS    0D
SAVR13   DS    F
SAVR14   DS    F
SAVR1410 DS    A
SAVR1415 DS    A
SAVR1416 DS    A
SAVR1417 DS    A
SAVR1418 DS    A
SAVR1420 DS    A
SAVR1421 DS    A
SAVR1440 DS    A
SAVR1441 DS    A
SAVR1442 DS    A
SAVR1443 DS    A
SAVR1444 DS    A
SAVR1445 DS    A
SAVR1446 DS    A
SAVR1447 DS    A
SAVR1449 DS    A
SAVR1450 DS    A
SAVRONOF DS    A
SAVR1455 DS    A
SAVR1470 DS    A
SAVR1480 DS    A
SAVR1482 DS    A
SAVR1483 DS    A
SAVR1498 DS    A
LDMSSR14 DS    A
CKUCBR14 DS    A
SECENR14 DS    A
FSENTR14 DS    A
S        DS    F
INTECBPT DC    A(0)
ASVTPTR  DS    A
ASCBPTR  DC    A(0)
CCWSPTR  DC    A(0)
SSCDATAP DC    A(0)
IOSBPTR  DC    A(0)
SRBPTR   DC    A(0)
UCBPTR   DC    A(0)
ECBPTR   DS    A
BITPTR   DC    A(0)
MSGPTR   DC    A(0)
INITPTR  DS    A
CMDPTR   DC    AL4(CMDQUE)
MESGPTR  DS    A
RQBLKPTR DC    A(0)
REENTRY  DC    AL4(START)
QELTPTR  DS    A
LENCNTR  DC    F'0'
CWBVREF  DS    A
WAITECB  DC    F'0'
SMF22PTR DS    A
SMF09PTR DS    A
SMF11PTR DS    A
OPCMECB  DS    FL4
         ORG   OPCMECB
OPCMECB1 DS    CL1
OPCMECB2 DS    AL3
         ORG   OPCMECB+4
CWBPTR   DS    A
FAILCODE DC    F'0'
PURGPTR  DS    A
I        DC    F'0'
J        DC    F'0'
K        DC    F'0'
CLEANUP  DS    F
NON7F    DS    F
PNTR9092 DS    A
GTMAINR0 DS    FL4
         ORG   GTMAINR0
GTMAINSP DC    X'00'
GTMAINLL DC    AL3(0)
         ORG   GTMAINR0+4
ICBPTR   DS    A
SAVREENT DS    F
SAVRENT  DS    F
LZYXPTR  DS    A
VALIDCNT DS    F
VARYCNT  DS    F
UNITCNT  DS    F
SUSPCOMP DS    F
SSIBPTR  DS    A
IXSDGL   DS    F
IXLRUNN  DS    F
LISTA    DS    A
MSCUCBA1 DS    A
SAVPR14  DS    A
INILEN   DC    AL2(20)
MESLEN   DC    AL2(68)
CONV1    DS    FL2
         ORG   CONV1
CONV2    DS    CL2
         ORG   CONV1+2
SIXTHOU  DC    H'6000'
UCBPTR16 DC    AL2(0)
BRSWTCH  DC    AL1(0)
FREESWTH DC    AL1(0)
DSDSWTH  DC    AL1(0)
HAVELK   DS    FL1
MSGVARY  DS    FL1
RPARNPOS DS    FL1
CMNDINDX DS    FL1
PRIMSWTH DS    FL1
ALTONLIN DC    AL1(0)
         DS    0D
@TS00001 DS    CL8
@CC02930 DC    C'REJECTED,VVVVVV MOUNTED ON UUU '
@CC02933 DC    C'FAILED,REAS CODE=   '
@CC02598 DC    C', REAS CODE=179 '
@CC02786 DC    C'SUCCESSFUL,'
@CC02788 DC    C'FAILED,    '
@CC02926 DC    C'          '
@CC02928 EQU   @CC02786
@CC03197 DC    C',OFFLINE '
@CC02729 DC    C'STAGE   '
@CC02730 DC    C'HOST    '
@CC03180 DC    C',ALTMSC '
@CC03194 DC    C',ONLINE '
@CC02728 DC    C'DESTAGE'
@CC02860 DC    C'OFFLINE'
@CC03179 DC    C',TRACE '
@CC02862 DC    C'ONLINE'
@CC02935 DC    C'ASSIGN'
@CC02936 DC    C'PURGE '
@CC02953 DC    C'HALT S'
@CC02995 DC    C'CANCEL'
@CC03178 DC    C',MSVC '
@CC03181 DC    C',PATHS'
@CC02612 EQU   @CC02936
@CC03177 DC    C',QCB '
@CC03195 DC    C',ONL '
@CC03199 DC    C',OFF '
@CC02725 DC    C'3333'
@CC02726 DC    C'3330'
@CC02866 EQU   @CC02926
@CC02867 DC    C'0177'
@CC02873 DC    C'3851'
@CC02874 DC    C'REAL'
@CC02943 DC    C'SNAP'
@CC02944 DC    C'LONG'
@CC03173 DC    C',SDG'
@CC03182 DC    C',CPU'
@CC03183 DC    C',DRC'
@CC03196 DC    C',ON '
@CC03200 DC    C',OF '
@CC02356 EQU   @CC02926
@CC02792 DC    C'***'
@CC02868 DC    C' ON'
@CC02869 EQU   @CC02860
@CC03136 DC    C'SDG'
@CC02456 DC    C'00'
@CC02458 DC    C'28'
@CC02861 EQU   @CC02860
@CC02863 EQU   @CC02862
@CC02864 EQU   @CC03173
@CC03175 DC    C',('
@CB02431 DC    X'0001'
@CB02433 DC    X'0000'
@CB02326 DC    B'1000000000000000'
@CB02333 DC    B'0100000000000000'
ZERO     DC    X'000000'
QUERLIST DS    CL44
         ORG   QUERLIST
QULEN    DS    FL4
QUORD    DS    CL1
QURES    DS    CL1
QUCODE   DS    BL1
         ORG   QUCODE
QULIB    DS    BL1
         ORG   QUERLIST+7
QUSECT   DS    BL1
         ORG   QUSECT
QUXADDR  DS    BL1
         ORG   QUXADDR
QUFLAG   DS    BL1
         ORG   QUFLAG
QURES1   DS    CL1
         ORG   QUERLIST+8
QUPARM   DS    CL32
QUPTR    DS    FL4
         ORG   QUERLIST+44
WAITLIST DS    CL16
         ORG   WAITLIST
ECB1     DS    AL4
ECB2     DS    AL4
ECB3     DS    AL4
@NM00046 DS    CL4
         ORG   @NM00046
BYT1     DC    XL1'80'
ECB4     DS    AL3
         ORG   WAITLIST+16
NAMFIELD DS    CL8
ARLIST   DS    CL8
         ORG   ARLIST
AIRLL    DC    XL4'08'
AIROP    DC    XL1'20'
@NM00047 DC    X'00'
AIRFLAG  DC    B'0000000000000000'
         ORG   AIRFLAG
AIRRESV  DS    BL1
AIRCPUS  EQU   AIRFLAG+0
@NM00048 EQU   AIRFLAG+0
         ORG   ARLIST+8
PURGLIST DS    CL13
         ORG   PURGLIST
PURGLL   DC    XL4'0D'
PURGOP   DC    XL1'14'
@NM00049 DC    X'00'
PURGFLG  DC    B'0000000000000000'
         ORG   PURGFLG
PURGMPP  DS    BL1
@NM00050 EQU   PURGFLG+0
         ORG   PURGLIST+8
PURGHOST DC    X'0000000000'
         ORG   PURGLIST+13
         DS    CL3
DMTLIST  DS    CL28
         ORG   DMTLIST
DMLEN    DC    XL4'1C'
DMOPCD   DC    XL1'06'
DMNTRES1 DC    X'00'
DMNTFLAG DC    B'0000000000000000'
         ORG   DMNTFLAG
DMBITRE1 DS    BL1
DMDELRSP EQU   DMNTFLAG+0
DMVUAVAL EQU   DMNTFLAG+0
DMBITRES EQU   DMNTFLAG+0
         ORG   DMTLIST+8
DMVOL    DC    XL6'0'
DMNTASID DC    XL2'0'
DMNTECB  DC    A(0)
DMHOST   DC    XL5'0'
DMNTRES2 DC    XL1'0'
DMNTVUA  DC    H'0'
         ORG   DMTLIST+28
SUSPLIST DS    CL8
         ORG   SUSPLIST
SUSPLEN  DC    XL4'08'
SUSPOP   DC    X'22'
@NM00051 DC    X'00'
SUSPFLG  DC    B'0000000000000000'
         ORG   SUSPFLG
SUPIMED  DS    BL1
SUPRCON  EQU   SUSPFLG+0
SUPPRSW  EQU   SUSPFLG+0
@NM00052 EQU   SUSPFLG+0
         ORG   SUSPLIST+8
BITSW    DS    BL1
         ORG   BITSW
MSG92FLG DS    BL1
DSTGERR  EQU   BITSW+0
LINETWO  EQU   BITSW+0
LOOPEND  EQU   BITSW+0
EXITSW   EQU   BITSW+0
DSPERR   EQU   BITSW+0
MSG42SW  EQU   BITSW+0
@NM00061 EQU   BITSW+0
         ORG   BITSW+1
         DS    CL3
REQLIST1 DS    CL40
VATMSG   DS    CL4
         ORG   VATMSG
REPLYC   DS    CL1
         ORG   VATMSG+4
INTER    DS    CL4
         ORG   INTER
BYTE1    DS    FL1
BYTES234 DS    CL3
         ORG   BYTES234
BYTE2    DS    FL1
BYTES34  DS    CL2
         ORG   BYTES34
BYTE3    DS    FL1
         ORG   BYTE3
BYTE3C   DS    CL1
         ORG   BYTES34+1
BYTE4    DS    FL1
         ORG   BYTE4
BYTE4C   DS    CL1
         ORG   INTER+4
ONOFF    DS    CL2
SSIDADDR DS    CL2
SMFAREA  DS    CL64
WTOMCS   DS    CL81
         ORG   WTOMCS
WTOMCS01 DC    H'77'
WTOMCS02 DC    B'1110000000000000'
WTOMCS03 DC    CL73'THE MAXIMUM MESSAGE LENGTH WILL BE SEVENTY-TWO CHARC
               ACTERS SO LEN(MSG )=72'
WTOMCS04 DC    B'0000100000000000'
WTOMCS05 DC    B'0000000000000000'
         ORG   WTOMCS+81
         DS    CL3
WTOGEN   DS    CL81
         ORG   WTOGEN
WTOGEN01 DC    H'77'
WTOGEN02 DC    B'1000000000000000'
WTOGEN03 DC    CL73'THE MAXIMUM MESSAGE LENGTH WILL BE SEVENTY-TWO CHARC
               ACTERS SO LEN(MSG )=72'
WTOGEN04 DC    B'0001000000000000'
WTOGEN05 DC    B'0100000000000000'
         ORG   WTOGEN+81
HOST     DS    CL5
CUUUCB   DC    CL3'   '
FIRST    DC    CL1'0'
SRBEBCDC DC    CL4'SRB '
FOXES    DC    X'FFFF'
INITBITS DS    BL1
         ORG   INITBITS
@NM00072 DS    BL1
COMPOST  EQU   INITBITS+0
ECBPOST  EQU   INITBITS+0
@NM00073 EQU   INITBITS+0
INITFLAG EQU   INITBITS+0
CWBCOMP  EQU   INITBITS+0
@NM00074 EQU   INITBITS+0
         ORG   INITBITS+1
PURGINDC DS    BL4
         ORG   PURGINDC
PURGFLG5 DS    BL1
         ORG   PURGFLG5
PURGBIT  DS    BL1
MSG05FLG EQU   PURGFLG5+0
SUSPLONG EQU   PURGFLG5+0
         ORG   PURGINDC+1
@NM00075 DS    BL3
         ORG   PURGINDC+4
SCFLAGS  DS    BL1
         ORG   SCFLAGS
SCANEND  DS    BL1
SCANSTRT EQU   SCFLAGS+0
SCANRUNN EQU   SCFLAGS+0
DUPEND   EQU   SCFLAGS+0
ACTPOST  EQU   SCFLAGS+0
ENTERED  EQU   SCFLAGS+0
FINDSW   EQU   SCFLAGS+0
RDLAB    EQU   SCFLAGS+0
         ORG   SCFLAGS+1
         DS    CL2
HIBITOFF DC    B'01111111111111111111111111111111'
SAVX     DS    CL64
NOMSS    DC    CL50'ICB320I MSS INOPERATIVE. MSS INITIALIZATION FAILED'
RECOVER  DS    BL1
         ORG   RECOVER
@NM00076 DS    BL1
@NM00077 EQU   RECOVER+0
@NM00078 EQU   RECOVER+0
@NM00079 EQU   RECOVER+0
@NM00080 EQU   RECOVER+0
@NM00081 EQU   RECOVER+0
@NM00082 EQU   RECOVER+0
         ORG   RECOVER+1
LOCKRCVY DS    BL1
         ORG   LOCKRCVY
LOCALLK  DS    BL1
CMSLK    EQU   LOCKRCVY+0
DQING    EQU   LOCKRCVY+0
VVICREC  EQU   LOCKRCVY+0
SVCCALL  EQU   LOCKRCVY+0
@NM00083 EQU   LOCKRCVY+0
         ORG   LOCKRCVY+1
SW9092   DS    CL1
         ORG   SW9092
NEED9092 DS    BL1
SAVE9092 EQU   SW9092+0
PROC9092 EQU   SW9092+0
SKIP9092 EQU   SW9092+0
HAVE90   EQU   SW9092+0
HAVE92   EQU   SW9092+0
@NM00084 EQU   SW9092+0
         ORG   SW9092+1
PTCHAREA DS    CL400
         ORG   PTCHAREA
EYECTCHR DC    CL19'ICBMSG00 PATCH AREA'
@NM00086 DS    CL381
         ORG   PTCHAREA+400
         DS    CL3
SAVAREA  DS    CL72
         DS    CL4
DBLWORD  DS    CL8
CHARS    DC    X'FAFBFCFDFEFF'
NUMS     DC    CL16'0123456789ABCDEF'
CCF0F0F0 DC    X'CCF0F0F0'
CC       DC    X'CC'
BB       DC    X'BB'
CHAR1F   DC    X'1F'
MSG15SW  DS    BL1
         ORG   MSG15SW
DESC2    DS    BL1
DESC3    EQU   MSG15SW+0
ROUT24   EQU   MSG15SW+0
WTOOK    EQU   MSG15SW+0
@NM00090 EQU   MSG15SW+0
         ORG   MSG15SW+1
DESCR2   DC    X'4000'
DESCR3   DC    X'2000'
SAVDESC  DS    BL2
ROUTE24  DC    X'5000'
SAVROUT  DS    BL2
PRNTLZYX DS    CL7
         ORG   PRNTLZYX
PRINTL   DS    CL1
PRINTX   DS    CL3
PRINTY   DS    CL2
PRINTZ   DS    CL1
         ORG   PRNTLZYX+7
LNOT     DC    CL4'NOT '
LALSO    DC    CL4'ALSO'
CMMA     DC    CL1','
WTO92    DC    B'0010000000000000'
WTOREST  DC    B'0001000000000000'
POSTC7F  DS    CL1
         DS    CL3
HIGHBIT  DC    B'10000000000000000000000000000000'
VFLAGS   DC    B'0000000000000000'
MSGRU    DS    CL3
         ORG   MSGRU
@NM00092 DS    CL1
MACRORU  DS    CL2
         ORG   MSGRU+3
DASD     DS    BL1
REAL     DS    BL1
AUTHMASK DC    X'4000'
CKAUTH   DC    X'0001'
         DS    CL1
VOFLIST  DS    CL24
         ORG   VOFLIST
VOFLEN   DC    XL4'18'
VOFOPCD  DC    X'0C'
VOFRES1  DC    X'00'
VOFFLG   DC    B'0000000000000000'
         ORG   VOFFLG
VOFSTAG  DS    BL1
VOFREAL  EQU   VOFFLG+0
VOFNEUT  EQU   VOFFLG+0
VOFTEST  EQU   VOFFLG+0
@NM00093 EQU   VOFFLG+0
         ORG   VOFLIST+8
VOFSSID  DC    H'0'
VOFRUA   DC    H'0'
VOFHOST  DC    X'0000000000'
@NM00094 DC    X'00'
VOFASID  DC    X'0000'
VOFECB   DC    F'0'
         ORG   VOFLIST+24
VONLST01 DS    CL12
         ORG   VONLST01
VONLEN   DC    XL4'0C'
VONOPCD  DC    X'0A'
VONRES1  DC    X'00'
VONFLG   DC    B'0000000000000000'
         ORG   VONFLG
VONSTAG  DS    BL1
VONREAL  EQU   VONFLG+0
@NM00095 EQU   VONFLG+0
         ORG   VONLST01+8
VONSSID  DC    H'0'
VONRES2  DC    X'0000'
         ORG   VONLST01+12
VOLKEY   DC    CL6'VOLID='
PKHOSTID DS    CL7
         ORG   PKHOSTID
@NM00097 DS    CL1
RECVHOST DS    CL6
         ORG   RECVHOST
PCKDHOST DS    CL5
@NM00098 DS    CL1
         ORG   PKHOSTID+7
SBPOL    DS    CL1
OFFRPLY  DS    CL6
         ORG   OFFRPLY
REPLYU   DS    CL1
@NM00099 DS    CL5
         ORG   OFFRPLY+6
LRUSTGE  DS    CL198
         ORG   LRUSTGE
LRULIST  DS    CL56
         ORG   LRULIST
LRUEDNN  DS    28CL2
         ORG   LRUSTGE+56
LRUSSIB  DS    CL36
LRUSSOB  DS    CL20
LRUSSMS  DS    CL12
LRUREGS  DS    18A
LRUCOUNT DS    FL2
         ORG   LRUSTGE+198
CHARSSOB DC    CL4'SSOB'
CHARSSIB DC    CL4'SSIB'
         DS    CL2
SAVESDG  DS    CL8
         ORG   SAVESDG
@NM00103 DS    CL3
@NM00104 DS    CL2
@NM00105 DS    FL3
         ORG   SAVESDG+8
MM       DS    CL2
SPACEMSG DC    CL26'INSUFFICIENT QUEUE SPACE  '
SYNTXMSG DC    CL26'SYNTAX ERROR IN COMMAND   '
INITATTS DC    X'8000'
CONVID1  DS    CL3
         ORG   CONVID1
BEGID1   DS    FL1
MIDID1   DS    FL1
ENDID1   DS    FL1
         ORG   CONVID1+3
CONVID2  DS    CL3
         ORG   CONVID2
BEGID2   DS    FL1
MIDID2   DS    FL1
ENDID2   DS    FL1
         ORG   CONVID2+3
VALSID   DS    CL5
         ORG   VALSID
CSSID    DS    CL4
CORB     DS    CL1
         ORG   VALSID+5
DPFLAGS  DS    BL2
         DS    CL3
ADLIST   DS    CL16
         ORG   ADLIST
ASDALEN  DC    XL4'10'
ASDAOPC  DC    X'2C'
ASDA001  DC    X'00'
ASDAFLG  DC    B'0000000000000000'
         ORG   ASDAFLG
ASASSOC  DS    BL1
ASDASSOC EQU   ASDAFLG+0
@NM00106 EQU   ASDAFLG+0
ASDEINT  EQU   ASDAFLG+0
ASDMNT   EQU   ASDAFLG+0
@NM00107 EQU   ASDAFLG+0
         ORG   ADLIST+8
ASDACPU  DC    X'0000000000'
ASDA002  DC    X'000000'
         ORG   ADLIST+16
CONFGMSK DC    B'10000000'
         DC    B'01000000'
         DC    B'00100000'
         DC    B'00010000'
         DC    B'00001000'
         DC    B'00000100'
         DC    B'00000010'
         DC    B'00000001'
CMDQUE   DC    10F'0'
PAKMPOS  DC    AL1(41)
         DC    AL1(62)
LRUIX    DS    30AL1
CONST    DC    CL2'00'
         DC    CL2'01'
         DC    CL2'02'
         DC    CL2'03'
         DC    CL2'04'
         DC    CL2'05'
         DC    CL2'06'
         DC    CL2'07'
         DC    CL2'08'
         DC    CL2'09'
         DC    CL2'10'
         DC    CL2'11'
         DC    CL2'12'
         DC    CL2'13'
         DC    CL2'14'
         DC    CL2'15'
         DC    CL2'16'
         DC    CL2'17'
         DC    CL2'18'
         DC    CL2'19'
         DC    CL2'20'
         DC    CL2'21'
         DC    CL2'22'
         DC    CL2'23'
         DC    CL2'24'
         DC    CL2'25'
         DC    CL2'26'
         DC    CL2'27'
         DC    CL2'28'
         DC    CL2'29'
ICB2MSG  CSECT
*                                                          /*@G24LB02*/
         DS    F                    ALIGN TO WORD BDY          @G24LB02
FOUR     EQU   X'04'                USED WHEN WTOR INVOKED     @G24LB02
ICB2MSG  CSECT
*                                      /* GEN ASSEM DATA     @Y30LB03*/
         DS    0F                   ALIGN                      @Y30LB03
TMER     DC    X'00000000'          CONST FOR SAMP TIME        @Y30LB03
CON2     EQU   2                    CONST FOR GEN ST           @Y30LB03
CON6     EQU   6                    CONST FOR GEN ST           @Y30LB03
ICB2MSG  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
QUERR1   EQU   @01
PAIRR1   EQU   @01
MDREG1   EQU   @01
SUSPR1   EQU   @01
GPR01P   EQU   @01
GPR15F   EQU   @15
ICBR1    EQU   @01
ASDAR1   EQU   @01
R9       EQU   @09
         ENTRY CMDQUE
         ENTRY CONFGMSK
         ENTRY RECOVER
         ENTRY INTER
         ENTRY BITSW
         ENTRY PROCMSG
         ENTRY FINISHDQ
         ENTRY RTN40L
         ENTRY VFREEL
         ENTRY PAWTOL
         ENTRY SPFREEL
         ENTRY SAVR1446
         ENTRY SAVR1482
         ENTRY UCBPTR
         ENTRY MSGPTR
         ENTRY CMDPTR
         ENTRY CWBPTR
         EXTRN MSGS
         EXTRN SSIDS
CVTPTR   EQU   16
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTILK2  EQU   CVTMAP+40
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTBRET  EQU   CVTMAP+82
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVT0PT01 EQU   CVTMAP+152
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTMZ00  EQU   CVTMAP+164
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTSMCA  EQU   CVTMAP+196
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTJESCT EQU   CVTMAP+296
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTICB   EQU   CVTXTNT2+48
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
TCBASCB  EQU   0
MSGTCB   EQU   TCBASCB
MSGASCB  EQU   TCBASCB+8
ASVT     EQU   0
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBRSM  EQU   ASCB+52
ASCBRSMF EQU   ASCBRSM
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
CCWS     EQU   0
CCW0     EQU   CCWS
OPCODE0  EQU   CCW0
DATA0    EQU   CCW0+1
FLAGS0   EQU   CCW0+4
COUNT0   EQU   CCW0+5
CCW1     EQU   CCWS+8
OPCODE   EQU   CCW1
DATA1    EQU   CCW1+1
FLAGS    EQU   CCW1+4
COUNT    EQU   CCW1+5
CCW2     EQU   CCWS+16
OPCODE2  EQU   CCW2
DATA2    EQU   CCW2+1
FLAGS2   EQU   CCW2+4
COUNT2   EQU   CCW2+5
BUFFER   EQU   0
SSCDATA  EQU   0
IOECB    EQU   SSCDATA
ECBCODE  EQU   IOECB
TCBADDR  EQU   SSCDATA+4
IOERRCD  EQU   SSCDATA+8
APPSW    EQU   SSCDATA+10
APGAREA  EQU   SSCDATA+12
IOSB     EQU   0
IOSFLA   EQU   IOSB
IOSACHN  EQU   IOSFLA
IOSCCHN  EQU   IOSACHN
IOSFLB   EQU   IOSB+1
IOSFLC   EQU   IOSB+2
IOSDVALT EQU   IOSFLC
IOSASID  EQU   IOSB+6
IOSPKEY  EQU   IOSB+12
IOSOPT   EQU   IOSB+14
IOSOPT2  EQU   IOSB+15
@NM00033 EQU   IOSB+20
IOSCSW   EQU   @NM00033+1
IOSTATUS EQU   IOSCSW+3
IOSSRB   EQU   IOSB+28
IOSUSE   EQU   IOSB+32
IOSIPIB  EQU   IOSB+44
IOSVST   EQU   IOSB+76
IOSPATH  EQU   IOSB+86
IOSCHN   EQU   IOSPATH
IOSCKEY  EQU   IOSB+89
IOSEEKA  EQU   IOSB+100
IOSCCHH  EQU   IOSEEKA+3
IOSSKHH  EQU   IOSCCHH+2
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBID    EQU   SRB
SRBASCB  EQU   SRB+8
SRBFLC   EQU   SRB+12
SRBPARM  EQU   SRB+28
ICB2SSCB EQU   0
ICBECB   EQU   ICB2SSCB+8
ICBACTV  EQU   ICB2SSCB+12
ICBCOM   EQU   ICB2SSCB+16
ICBIOR   EQU   ICB2SSCB+20
ICBCOMQ  EQU   ICB2SSCB+24
ICBPUCB  EQU   ICB2SSCB+28
ICBAUCB  EQU   ICB2SSCB+32
ICBQHEAD EQU   ICB2SSCB+36
ICBTCB   EQU   ICB2SSCB+40
ICBVN02P EQU   ICB2SSCB+44
ICBOPT   EQU   ICB2SSCB+48
ICBFLG   EQU   ICB2SSCB+52
ICBFG1   EQU   ICBFLG
ICBI     EQU   ICBFG1
ICBR     EQU   ICBFG1
ICBV     EQU   ICBFG1
ICBB     EQU   ICBFG1
ICBS     EQU   ICBFG1
ICBMSCA  EQU   ICBFG1
ICB2ACTP EQU   ICB2SSCB+56
ICBSIOP  EQU   ICB2SSCB+68
ICBVVIC  EQU   ICB2SSCB+72
ICBMSSC  EQU   ICB2SSCB+104
ICBSAMP  EQU   ICB2SSCB+118
ICBTRACE EQU   ICB2SSCB+148
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBNOTRD EQU   UCBNRY
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBQISCE EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBNAME  EQU   UCBOB+13
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCBRVDEV EQU   UCBRWTAU
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3DACC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBUNTYP EQU   UCBTBYT4
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00045 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
ECBWORD  EQU   0
ECBRBADR EQU   ECBWORD+1
ECBDATA  EQU   ECBWORD+4
BITPATT  EQU   0
MSG1     EQU   0
MSGL     EQU   MSG1
MSGC     EQU   MSG1+1
MSGDATA  EQU   MSG1+2
MSGDATAC EQU   MSGDATA+1
MSG2     EQU   0
MSGASID  EQU   MSG2+2
MSGASIDF EQU   MSGASID
MSGECB   EQU   MSG2+4
MSGPOSTC EQU   MSG2+8
MSGSSID  EQU   MSG2+10
MSG94    EQU   0
RESTCD   EQU   MSG94+2
VOLSER   EQU   MSG94+4
CARTNO   EQU   MSG94+10
INITVVI  EQU   0
INILNGTH EQU   INITVVI
INITOPCD EQU   INITVVI+4
INIFLAGA EQU   INITVVI+5
INIDISAB EQU   INIFLAGA
INIFLAGB EQU   INITVVI+6
INIJRNL  EQU   INIFLAGB
INIABLE  EQU   INIFLAGB
MESG     EQU   0
MESLNGTH EQU   MESG
MESCODE  EQU   MESG+4
MESOPCD  EQU   MESCODE
MESGBUF  EQU   MESG+8
RQBLK    EQU   0
TCBORRB  EQU   RQBLK+11
OLDPSW   EQU   RQBLK+16
RESPQEL  EQU   0
QELECB   EQU   RESPQEL+4
QELECBPR EQU   QELECB+1
QELFLG2  EQU   RESPQEL+8
QELAHEAD EQU   RESPQEL+9
QELFLG3  EQU   RESPQEL+12
QELBACK  EQU   RESPQEL+13
QELASID  EQU   RESPQEL+16
RU       EQU   0
SMFRCD09 EQU   0
SMF9LEN  EQU   SMFRCD09
SMF9RTY  EQU   SMFRCD09+5
SMF9LENN EQU   SMFRCD09+18
SMF9DVAD EQU   0
SMF9DUT  EQU   SMF9DVAD
SMF9CUA  EQU   SMF9DVAD+2
SMFRCD11 EQU   0
SMF11LEN EQU   SMFRCD11
SMF11RTY EQU   SMFRCD11+5
SMF11LN  EQU   SMFRCD11+18
SMF11DEV EQU   0
SMF11DUT EQU   SMF11DEV
SMF11CUA EQU   SMF11DEV+2
SMFRCD22 EQU   0
SMF22LEN EQU   SMFRCD22
SMF22RTY EQU   SMFRCD22+5
SMF22IND EQU   SMFRCD22+18
SMF22ECT EQU   SMFRCD22+20
SMF22CPU EQU   0
SMF22CHL EQU   0
SMF22STR EQU   0
SMF22IPL EQU   0
SMF22IID EQU   SMF22IPL+1
SMF22ION EQU   SMF22IPL+2
SMF22VON EQU   0
SMF22VOF EQU   0
CWB      EQU   0
CWBCHAIN EQU   CWB
CWBFREE  EQU   CWB+4
CWBSBPOL EQU   CWBFREE
CWBVBCDE EQU   CWB+8
CWBCMND  EQU   CWB+9
CWBCOMQ  EQU   CWB+135
CWBUCMID EQU   CWB+136
CWBAUTH  EQU   CWB+137
CWBRESV  EQU   CWB+141
CONFIGTN EQU   0
TPAKS    EQU   CONFIGTN
EXISTING EQU   CONFIGTN+2
ONLINE   EQU   CONFIGTN+42
AVAILBL  EQU   CONFIGTN+82
CONFIG   EQU   0
MCODE    EQU   CONFIG+1
EXIST    EQU   CONFIG+4
ONLIN    EQU   CONFIG+44
STOR9092 EQU   0
STOR90   EQU   STOR9092
STOR92   EQU   STOR9092+124
TCBWDS   EQU   0
CURTCB   EQU   TCBWDS+4
AWAX     EQU   0
AWBX     EQU   0
USERCB   EQU   0
USERX3   EQU   USERCB+8
USERX4   EQU   USERCB+12
MSGLZYX  EQU   0
MSGFLZY  EQU   MSGLZYX
MSGCY    EQU   MSGFLZY
MSGLZY   EQU   MSGCY
MSGCX    EQU   MSGLZYX+1
STATBYTE EQU   0
BADLAB   EQU   STATBYTE
RPRNHUNT EQU   0
CWBRU    EQU   0
ACTWKBUF EQU   0
ACTENT1  EQU   ACTWKBUF
AVL      EQU   ACTENT1+1
MV       EQU   ACTENT1+2
ACTENT2  EQU   ACTWKBUF+128
LRU      EQU   ACTENT2
CAP      EQU   ACTENT2+1
UA       EQU   ACTENT2+2
SDGLS    EQU   0
SDGNNBBB EQU   SDGLS
SDG      EQU   SDGNNBBB
SDGNN    EQU   SDGNNBBB+3
SDGBBB   EQU   SDGNNBBB+5
SDGIX    EQU   SDGBBB
SSOB     EQU   0
SSOBID   EQU   SSOB
SSOBLEN  EQU   SSOB+4
SSOBFUNC EQU   SSOB+6
SSOBSSIB EQU   SSOB+8
SSOBINDV EQU   SSOB+16
SSMS     EQU   0
SSMSLEN  EQU   SSMS
SSMSPSDG EQU   SSMS+4
SSMSPLRU EQU   SSMS+8
SSIB     EQU   0
SSIBID   EQU   SSIB
SSIBLEN  EQU   SSIB+4
SSIBFLG1 EQU   SSIB+6
SSIBSSNM EQU   SSIB+8
JESCT    EQU   0
JESWAA   EQU   JESCT+8
JESSSREQ EQU   JESCT+20
JESPJESN EQU   JESCT+28
JESALLOC EQU   JESCT+32
JESUNALC EQU   JESCT+36
JESCATL  EQU   JESCT+40
SSREQ    EQU   0
BEGUPTR  EQU   0
IEFAB4F5 EQU   0
IEFBB410 EQU   0
IEFW21SD EQU   0
INITECB  EQU   0
RU1BYTE  EQU   0
SWAMGR   EQU   0
UCBBGN   EQU   0
MCDE     EQU   MSGS+1
MESGS    EQU   MSGS+4
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTSHRVM EQU   CVTS01+68
CVTASVT  EQU   CVTS01+208
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
PSARSVTE EQU   PSARSVT
QWPARM   EQU   QUPARM
QWRES1   EQU   QWPARM
QWFLAG   EQU   QWPARM+2
QTPARM   EQU   QUPARM
QTID     EQU   QTPARM
QLPARM   EQU   QUPARM
QCPARM   EQU   QUPARM
IOSATTSC EQU   IOSIPIB
IOSWTOWA EQU   IOSIPIB
IOSPCISC EQU   IOSIPIB
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00044 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
DSPFLG   EQU   CWBCOMQ
DSPALL   EQU   DSPFLG
DSPON    EQU   DSPFLG
DSPOFF   EQU   DSPFLG
DSPSDG   EQU   DSPFLG
DSPRNG   EQU   DSPFLG
DSPSSID  EQU   DSPFLG
DSPCPU   EQU   DSPFLG
DSPPATH  EQU   DSPFLG
PTHFLG   EQU   CWBRESV
CWBFLGS  EQU   PTHFLG
DSPDRC   EQU   CWBFLGS
DSPMSVC  EQU   CWBFLGS
DSPTRC   EQU   CWBFLGS
DSPQCB   EQU   CWBFLGS
DSPALTM  EQU   CWBFLGS
CWBOFFS  EQU   PTHFLG+1
VOLINCWB EQU   CWBCMND
KEYWD    EQU   VOLINCWB
VOL      EQU   VOLINCWB+6
TPAKSSID EQU   TPAKS
TRANSTBL EQU   BUFFER+256
ALPHAS   EQU   TRANSTBL+193
NUMBRS   EQU   TRANSTBL+240
HSTINCWB EQU   CWBCMND
DVCLUNTP EQU   UCBTBYT3
DMHOSTID EQU   DMHOST
DMNTLEN  EQU   DMLEN
DMOPCODE EQU   DMOPCD
DMVOLID  EQU   DMVOL
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
@NM00096 EQU   HSTINCWB+10
REALHOST EQU   HSTINCWB
@NM00088 EQU   TRANSTBL+199
@NM00087 EQU   TRANSTBL
DSPINP   EQU   CWBFLGS
DSPQUAL  EQU   CWBFLGS
DSPQMTPA EQU   CWBFLGS
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00044
UCBSKPFG EQU   @NM00044
UCBRIPND EQU   @NM00044
UCBRTIAC EQU   @NM00044
UCBRSV79 EQU   @NM00044
UCBRSV78 EQU   @NM00044
UCBRSV77 EQU   @NM00044
UCBOLTEP EQU   @NM00044
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00043 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
IOSPCIWA EQU   IOSPCISC+44
IOSPCIRS EQU   IOSPCISC+8
@NM00038 EQU   IOSPCISC+4
@NM00037 EQU   IOSPCISC
IOSWRNDR EQU   IOSWTOWA+4
IOSWTOPT EQU   IOSWTOWA+3
IOSWTOCP EQU   IOSWTOWA+2
IOSWTOCH EQU   IOSWTOWA
IOSATTWA EQU   IOSATTSC+40
@NM00036 EQU   IOSATTSC+24
IOSATTSN EQU   IOSATTSC
QCMAD3Z1 EQU   QCPARM+28
QCMAD3Z0 EQU   QCPARM+24
QCMAD2Z1 EQU   QCPARM+20
QCMAD2Z0 EQU   QCPARM+16
QCMAD1Z1 EQU   QCPARM+12
QCMAD1Z0 EQU   QCPARM+8
QCMAD0Z1 EQU   QCPARM+4
QCMAD0Z0 EQU   QCPARM
QLRES    EQU   QLPARM+2
QLZYX    EQU   QLPARM
QTRES    EQU   QTPARM+24
QTDASCHR EQU   QTPARM+20
QTDATA   EQU   QTPARM+2
QTFLAG   EQU   QTPARM+1
QTTABID  EQU   QTID
QWRES2   EQU   QWPARM+3
QWALTMSC EQU   QWFLAG
@NM00029 EQU   QWFLAG
QWMEM    EQU   QWFLAG
QWSSID   EQU   QWRES1
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
MESGTXT  EQU   MESGS+10
MESGID   EQU   MESGS
MESGLEN  EQU   MSGS+3
MESGLINE EQU   MCDE+1
MESGCODE EQU   MCDE
@NM00060 EQU   MSGS
JESSASTA EQU   JESCT+48
JESNUCBS EQU   JESCT+44
JESSSCT  EQU   JESCT+24
JESRESQM EQU   JESCT+16
JESQMGR  EQU   JESCT+12
JESUNITS EQU   JESCT+4
@NM00102 EQU   JESCT
SSIBSUSE EQU   SSIB+32
SSIBRSV1 EQU   SSIB+28
SSIBDEST EQU   SSIB+20
SSIBJBID EQU   SSIB+12
SSIBRESV EQU   SSIB+7
@NM00101 EQU   SSIBFLG1
SSIBPJES EQU   SSIBFLG1
SSMSRV0  EQU   SSMS+2
SSOBRETN EQU   SSOB+12
ACTFIL   EQU   ACTWKBUF+112
@NM00100 EQU   ACTENT1
@NM00091 EQU   STATBYTE
MSGFX    EQU   MSGCX
USERX5   EQU   USERCB+16
USERX2   EQU   USERCB+4
USERX1   EQU   USERCB
@NM00089 EQU   TCBWDS
AVAIL    EQU   CONFIG+84
@NM00085 EQU   CONFIG+2
LNGTH    EQU   CONFIG
SECSSID  EQU   TPAKS+1
PRISSID  EQU   TPAKS
CWBLA    EQU   CWB+140
CWBLCC   EQU   CWB+139
CWBFLGTH EQU   CWBFREE+1
SMF22FSI EQU   SMF22VOF+3
SMF22RVB EQU   SMF22VOF+2
SMF22FID EQU   SMF22VOF+1
SMF22RV6 EQU   SMF22VOF
SMF22NSI EQU   SMF22VON+3
SMF22RVA EQU   SMF22VON+2
SMF22NID EQU   SMF22VON+1
SMF22RV5 EQU   SMF22VON
SMF22RV4 EQU   SMF22IPL
SMF22NPG EQU   SMF22STR+4
SMF22PGL EQU   SMF22STR+2
SMF22TID EQU   SMF22STR+1
SMF22RV3 EQU   SMF22STR
SMF22CPD EQU   SMF22CHL+5
SMF22CHA EQU   SMF22CHL+4
SMF22CHN EQU   SMF22CHL+2
SMF22CID EQU   SMF22CHL+1
SMF22RV2 EQU   SMF22CHL
SMF22CPA EQU   SMF22CPU+5
SMF22RV1 EQU   SMF22CPU+4
SMF22CPN EQU   SMF22CPU+2
SMF22PID EQU   SMF22CPU+1
SMF22RV0 EQU   SMF22CPU
SMF22SID EQU   SMFRCD22+14
SMF22DTE EQU   SMFRCD22+10
SMF22TME EQU   SMFRCD22+6
SMF22FLG EQU   SMFRCD22+4
SMF22SEG EQU   SMFRCD22+2
SMF11VDV EQU   SMF11CUA
SMF11SID EQU   SMFRCD11+14
SMF11DTE EQU   SMFRCD11+10
SMF11TME EQU   SMFRCD11+6
SMF11FLG EQU   SMFRCD11+4
SMF11SEG EQU   SMFRCD11+2
SMF9VDV  EQU   SMF9CUA
SMF9SID  EQU   SMFRCD09+14
SMF9DTE  EQU   SMFRCD09+10
SMF9TME  EQU   SMFRCD09+6
SMF9FLG  EQU   SMFRCD09+4
SMF9SEG  EQU   SMFRCD09+2
@NM00071 EQU   RESPQEL+18
PRGASID  EQU   QELASID
CHNBACK  EQU   QELBACK
SVCINVAL EQU   QELFLG3
CHNHEAD  EQU   QELAHEAD
FLAG1    EQU   QELFLG2
QELFLG1  EQU   QELECB
QELTCBPR EQU   RESPQEL+1
QELSP    EQU   RESPQEL
TCBWAIT  EQU   RQBLK+32
@NM00070 EQU   RQBLK+24
OPINADDR EQU   OLDPSW+5
@NM00069 EQU   OLDPSW+1
OPMASK   EQU   OLDPSW
@NM00068 EQU   RQBLK+12
@NM00067 EQU   TCBORRB
TCBTEST  EQU   TCBORRB
@NM00066 EQU   RQBLK
@NM00065 EQU   MESCODE+1
@NM00064 EQU   INITVVI+16
INIUCAT  EQU   INITVVI+8
INIVCODE EQU   INITVVI+7
@NM00063 EQU   INIFLAGB
INIRESTR EQU   INIFLAGB
INIVERFY EQU   INIFLAGB
@NM00062 EQU   INIFLAGA
INIENABL EQU   INIFLAGA
ININIT   EQU   INIFLAGA
@NM00059 EQU   MSG94+11
@NM00058 EQU   MSG94+3
@NM00057 EQU   MSG94
@NM00056 EQU   MSG2+9
@NM00055 EQU   MSG2
@NM00054 EQU   MSGDATA+2
@NM00053 EQU   MSGDATA
ECBYTE1  EQU   ECBWORD
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00045
UCBHALI  EQU   @NM00045
UCBRSV09 EQU   @NM00045
UCBRSV08 EQU   @NM00045
UCBRSV07 EQU   @NM00045
UCBRSV06 EQU   @NM00045
UCBRSV05 EQU   @NM00045
UCBRSV04 EQU   @NM00045
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00042 EQU   UCB
ICBLORD  EQU   ICBTRACE+256
ICBOTRC  EQU   ICBTRACE
ICBRESV  EQU   ICB2SSCB+128
ICBVOLST EQU   ICB2SSCB+124
ICBVSCRA EQU   ICB2SSCB+120
ICBRESVD EQU   ICB2SSCB+117
ICBCPUID EQU   ICB2SSCB+112
ICBFAB   EQU   ICB2SSCB+108
ICBRSVP  EQU   ICB2SSCB+100
ICBAEAP  EQU   ICB2SSCB+96
ICBSIOBP EQU   ICB2SSCB+92
ICBIATNA EQU   ICB2SSCB+88
ICBIPRGA EQU   ICB2SSCB+84
ICBSRBP  EQU   ICB2SSCB+80
ICBVVICB EQU   ICB2SSCB+76
ICBMEP   EQU   ICB2SSCB+64
ICBIORCI EQU   ICB2SSCB+60
ICBFG3   EQU   ICBFLG+2
ICBFG2   EQU   ICBFLG+1
@NM00041 EQU   ICBFG1
ICBMSCMP EQU   ICBFG1
ICBNVT   EQU   ICBOPT
ICBSSNAM EQU   ICB2SSCB
@NM00040 EQU   SRB+40
@NM00039 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBRMTR  EQU   SRB+24
SRBEP    EQU   SRB+20
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBFLNK  EQU   SRB+4
IOSEND   EQU   IOSB+108
IOSSKR   EQU   IOSEEKA+7
IOSSKH2  EQU   IOSSKHH+1
IOSSKH1  EQU   IOSSKHH
IOSSKCC  EQU   IOSCCHH
IOSSKBB  EQU   IOSEEKA+1
IOSSKM   EQU   IOSEEKA
IOSEEK   EQU   IOSB+92
IOSMDM   EQU   IOSB+91
IOSMDB   EQU   IOSB+90
IOSCKEY7 EQU   IOSCKEY
IOSCKEY6 EQU   IOSCKEY
IOSCKEY5 EQU   IOSCKEY
IOSCKEY4 EQU   IOSCKEY
@NM00035 EQU   IOSCKEY
IOSFMSK  EQU   IOSB+88
IOSCUDEV EQU   IOSPATH+1
@NM00034 EQU   IOSCHN
IOSPATH3 EQU   IOSCHN
IOSPATH2 EQU   IOSCHN
IOSEXP   EQU   IOSCHN
IOSGDP   EQU   IOSCHN
IOSAFF   EQU   IOSB+85
IOSRSS1B EQU   IOSB+84
IOSDSID  EQU   IOSB+80
IOSRST   EQU   IOSB+72
IOSDIE   EQU   IOSB+68
IOSABN   EQU   IOSB+64
IOSNRM   EQU   IOSB+60
IOSPCI   EQU   IOSB+56
IOSERP   EQU   IOSB+52
IOSPCHN  EQU   IOSB+48
IOSSNS   EQU   IOSB+42
IOSAPMSK EQU   IOSB+40
IOSRES4A EQU   IOSB+36
IOSCSWRC EQU   IOSCSW+5
IOSTSB   EQU   IOSTATUS+1
IOSTSA   EQU   IOSTATUS
IOSCSWCA EQU   IOSCSW
IOSCC    EQU   @NM00033
IOSUCB   EQU   IOSB+16
IOSOPT2X EQU   IOSOPT2
IOSIGP   EQU   IOSOPT2
IOSHTP   EQU   IOSOPT2
IOSRELSE EQU   IOSOPT
IOSAPR   EQU   IOSOPT
IOSTSLL  EQU   IOSOPT
IOSNERP  EQU   IOSOPT
IOSPSLL  EQU   IOSOPT
IOSQISCE EQU   IOSOPT
IOSDEP   EQU   IOSOPT
IOSBYP   EQU   IOSOPT
IOSCOD   EQU   IOSB+13
IOSPKY7  EQU   IOSPKEY
IOSPGDPX EQU   IOSPKEY
IOSIDR   EQU   IOSPKEY
IOSLCL   EQU   IOSPKEY
@NM00032 EQU   IOSPKEY
IOSPGAD  EQU   IOSB+8
IOSPRLVL EQU   IOSB+5
IOSDVRID EQU   IOSB+4
IOSPROC  EQU   IOSB+3
IOSFLC7  EQU   IOSFLC
IOSCTCNR EQU   IOSFLC
IOSRWAIT EQU   IOSFLC
IOSTP    EQU   IOSFLC
IOSCC3WE EQU   IOSFLC
IOSVERIF EQU   IOSDVALT
IOSDVMNT EQU   IOSFLC
IOSLOG   EQU   IOSFLB
IOSBDCST EQU   IOSFLB
IOSMSG   EQU   IOSFLB
IOSFLB4  EQU   IOSFLB
IOSFLB3  EQU   IOSFLB
IOSNOTRS EQU   IOSFLB
IOSSDR   EQU   IOSFLB
IOSDIESE EQU   IOSFLB
IOSIOSB  EQU   IOSFLA
IOSDOM   EQU   IOSFLA
IOSEX    EQU   IOSFLA
IOSSMDB  EQU   IOSFLA
IOSSMDA  EQU   IOSFLA
IOSERR   EQU   IOSFLA
IOSDCHN  EQU   IOSACHN
DMTVOL   EQU   SSCDATA+78
DMTID    EQU   SSCDATA+76
APPSAV   EQU   APGAREA
@NM00031 EQU   APPSW
ATTNSW   EQU   APPSW
POSTSW   EQU   APPSW
ERPSW    EQU   APPSW
SSCDERR  EQU   IOERRCD
TCBPTR   EQU   TCBADDR
@NM00030 EQU   BUFFER
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSMA EQU   ASCBRSM+1
ASCBRV54 EQU   ASCBRSMF
ASCBRV53 EQU   ASCBRSMF
ASCBRV52 EQU   ASCBRSMF
ASCBRV51 EQU   ASCBRSMF
ASCBVEQR EQU   ASCBRSMF
ASCBN2LP EQU   ASCBRSMF
ASCB1LPU EQU   ASCBRSMF
ASCB2LPU EQU   ASCBRSMF
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTMAXU EQU   ASVT+516
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00004 EQU   ASVT
@NM00003 EQU   TCBASCB+4
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00002 EQU   CVTFIX+248
@NM00001 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
@NM00028 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00027 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00026 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00025 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00024 EQU   FLCFSA
@NM00023 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00022 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00021 EQU   FLCIOA
@NM00020 EQU   FLCMCLA+15
@NM00019 EQU   FLCMCLA+14
@NM00018 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00017 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00016 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00015 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00014 EQU   FLCPER
@NM00013 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00012 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00011 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00010 EQU   FLCPIILC
@NM00009 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00008 EQU   FLCSVILC
@NM00007 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00006 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00005 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
EXITX    EQU   WAIT
@RF00492 EQU   NOMSSC
@RT00511 EQU   CKCWB
@RT00528 EQU   CKCWB
@RC00657 EQU   @RC00634
@RT01158 EQU   @RC01157
@RC01207 EQU   @RC01205
@RC01265 EQU   @RC01263
@RC01277 EQU   @RC01275
@RF01304 EQU   DQELT
@RC01306 EQU   DQELT
@RF01322 EQU   DQELT
@RT01330 EQU   DQELT
@RT01333 EQU   DQELT
@RT01335 EQU   DQELT
@RT01337 EQU   DQELT
@RF01509 EQU   SYNERROR
@RT01513 EQU   SYNERROR
@RT01521 EQU   SYNERROR
@RF01529 EQU   SYNERROR
@RF01654 EQU   @RC01608
@RC01637 EQU   @RC01608
@RC01684 EQU   @RC01662
@RC01755 EQU   @RC01749
@RC01887 EQU   @EL00018
@RC02015 EQU   @RC02011
@RF02391 EQU   @RC02387
@RF02401 EQU   @RC02397
@RC02610 EQU   @RC02608
@RF02644 EQU   @EL00032
@RF01308 EQU   @RC01306
@RC02612 EQU   @RC02610
@RC02614 EQU   @RC02612
@RF02616 EQU   @RC02614
@ENDDATA EQU   *
         END   ICB2MSG,(C'PLS0927',0701,78180)

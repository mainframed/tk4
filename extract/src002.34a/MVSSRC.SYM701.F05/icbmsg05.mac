         TITLE 'ICBMSG05  -  MSSC INITIALIZATION                       *
                        '
ICBMSG05 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICBMSG05  78.188'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @04,0                                               0001
@PSTART  LA    @05,4095(,@04)                                      0001
         LA    @12,4095(,@05)                                      0001
         USING @PSTART,@04                                         0001
         USING @PSTART+4095,@05                                    0001
         USING @PSTART+8190,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*
** REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF
** NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES
** WILL ASSEMBLE PROPERLY.
QUERY1   DS    0H                                                  0224
IICBMNT1 DS    0H                                                  0291
IPAIR1   DS    0H                                                  0294
IPAIR2   DS    0H                                                  0296
FOUR    EQU    X'04'
*   INITPTR=ADDR(REQLIST1);                                        0346
         LA    @00,REQLIST1                                        0346
         ST    @00,INITPTR                                         0346
*   PURGPTR=R1;                     /* SAVE INPUT PARM REG   @G24LB02*/
         ST    R1,PURGPTR                                          0347
*   RFY                                                            0348
*     R1 UNRSTD;                    /* FREE REG 1            @G24LB02*/
*   IF CVTNIP=ON THEN               /* TEST IF NIP IN CONTROL      0349
*                                                            @G24LB02*/
         L     @15,CVTPTR                                          0349
         TM    CVTNIP(@15),B'00010000'                             0349
         BNO   @RF00349                                            0349
*     NVTPTR=ICBNVT;                /* FIND THE NVT          @G24LB02*/
         L     @01,CVTEXT2(,@15)                                   0350
         L     @01,CVTICB(,@01)                                    0350
         MVC   NVTPTR(4),ICBNVT(@01)                               0350
*   BITSW=''B;                      /* CLEAR SWITCH          @G24LB02*/
@RF00349 MVI   BITSW,X'00'                                         0351
*   NMESPTR=ADDR(NMSGST);           /* INITIALIZE MESSAGE PTR      0352
*                                                            @G24LB02*/
         LA    @15,NMSGST                                          0352
         ST    @15,NMESPTR                                         0352
*   RESPECIFY                                                      0353
*     NVT BASED(NVTPTR);            /*                       @G24LB02*/
*   RFY                                                            0354
*    (RCVT,                                                        0354
*     RNVT) UNRSTD;                 /* INPUT REGISTERS       @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0355
*   ECB1=ADDR(ICBECB);              /* INITIALIZE ECB1       @G24LB02*/
         L     @15,CVTPTR                                          0355
         L     @01,CVTEXT2(,@15)                                   0355
         L     @14,CVTICB(,@01)                                    0355
         LA    @11,ICBECB(,@14)                                    0355
         ST    @11,ECB1                                            0355
*   ECB2=ADDR(ICBACTV);             /* INITIALIZE ECB2       @X70ZC02*/
         LA    @11,ICBACTV(,@14)                                   0356
         ST    @11,ECB2                                            0356
*   ECB3=ADDR(ICBCOM);              /* INITIALIZE ECB3       @G24LB02*/
         LA    @11,ICBCOM(,@14)                                    0357
         ST    @11,ECB3                                            0357
*   ECB4=ADDR(ICBIOR);              /* INITIALIZE ECB4       @G24LB02*/
         LA    @11,ICBIOR(,@14)                                    0358
         STCM  @11,7,ECB4                                          0358
*   ICBECB=ZERO;                    /* CLEAR ECB ICBECB      @G24LB02*/
         SLR   @11,@11                                             0359
         ST    @11,ICBECB(,@14)                                    0359
*   ICBACTV=ZERO;                   /* CLEAR ECB ICBACTV     @G24LB02*/
         ST    @11,ICBACTV(,@14)                                   0360
*   ICBCOM=ZERO;                    /* CLEAR ECB ICBCOM      @G24LB02*/
         ST    @11,ICBCOM(,@14)                                    0361
*   ICBIOR=ZERO;                    /* CLEAR ECB ICBIOR      @G24LB02*/
         ST    @11,ICBIOR(,@14)                                    0362
*   ICBMSCA=OFF;                    /* INITIALIZE APS BIT    @G24LB05*/
*   ICBMSCMP=OFF;                   /* INITIALIZE MP BIT     @G24LB05*/
         NI    ICBMSCA(@14),B'11111001'                            0364
*   INITSW=OFF;                     /* INITIALIZE INITSW TO 0      0365
*                                                            @G24LB05*/
         NI    INITSW,B'11110111'                                  0365
*   IF CSDCPUOL^=ONE THEN           /* IS THIS A MP SYSTEM?  @G24LB05*/
         L     @01,CVTCSD(,@15)                                    0366
         CLC   CSDCPUOL(2,@01),@CH00130                            0366
         BE    @RF00366                                            0366
*     ICBMSCMP=ON;                  /* INDICATE MP SYSTEM?   @G24LB05*/
         OI    ICBMSCMP(@14),B'00000100'                           0367
*/********************************************************** @G24LB02*/
*                                                                  0368
*   CALL INTPRISC;                  /* INITIALIZE THE MSC(S) @G24LB02*/
@RF00366 BAL   @14,INTPRISC                                        0368
*/********************************************************** @G24LB02*/
*                                                                  0369
*   IF CLEANCOD^=ALLCLEAN           /* ANY ERROR SO FAR ?    @G24LB02*/
*     THEN                          /* SOME ERROR, NO MSSC   @G24LB02*/
         ICM   @15,15,CLEANCOD                                     0369
         BNZ   @RT00369                                            0369
*     GOTO NOMSSC;                  /* GO DIRECTLY OUT       @G24LB02*/
*   ELSE                            /* CONTINUE WITH MSSC          0371
*                                      INITIALIZATION        @G24LB02*/
*     ;                             /*                       @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0372
*   CALL SOCIATE;                   /* ISSUE ASSOCIATE OR          0372
*                                      DISASSOCIATE TO       @G24LB02*/
         BAL   @14,SOCIATE                                         0372
*/********************************************************** @G24LB02*/
*                                                                  0373
*   /*****************************************************************/
*   /*                                                               */
*   /* MSC(S) IN APPROPRIATE RELATIONSHIP WITH               @G24LB02*/
*   /* PURGE, IF SPECIFIED                                   @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0373
*/********************************************************** @G24LB02*/
*                                                                  0373
*   IF CLEANCOD^=ALLCLEAN           /* ANY ERROR SO FAR ?    @G24LB02*/
*     THEN                          /* SOME ERROR, NO MSSC   @G24LB02*/
         ICM   @15,15,CLEANCOD                                     0373
         BNZ   @RT00373                                            0373
*     GOTO NOMSSC;                  /* GO DIRECTLY OUT       @G24LB02*/
*   ELSE                            /* CONTINUE WITH MSSC          0375
*                                      INITIALIZATION        @G24LB02*/
*     ;                             /*                       @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0376
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THIS ROUTINE IS CALLED BY THE MSSC MESSAGE         @G24LB02*/
*   /* MODULE (CVTNIP=0) THEN CALL RDLABLS SUB TO            @G24LB02*/
*   /* INITIALIZE VUCB(S).                                   @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0376
*   IF CVTNIP=OFF THEN              /* TEST FOR NIP IN CONTROL     0376
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0376
         TM    CVTNIP(@01),B'00010000'                             0376
         BNZ   @RF00376                                            0376
*     DO;                           /* NIP NOT IN CONTROL CODE     0377
*                                                            @G24LB02*/
*       IF PRGXQTD=OFF THEN                                        0378
         TM    PRGXQTD,B'00100000'                                 0378
         BNZ   @RF00378                                            0378
*         CALL RDLABLS;             /* VUCB INITIALIZATION   @G24LB02*/
         BAL   @14,RDLABLS                                         0379
*       ELSE                                                       0380
*         CALL MAKNOTRD;            /* MARK ONLINE VUCBS NOTRDY    0380
*                                                            @G24LB02*/
         B     @RC00378                                            0380
@RF00378 BAL   @14,MAKNOTRD                                        0380
*     END;                          /* END NOT NIP CODE      @G24LB02*/
@RC00378 DS    0H                                                  0382
*/********************************************************** @G24LB02*/
*                                                                  0382
*NOMSSC:                            /* CHECK IF NO MSSC      @G24LB02*/
*   IF ICBI^=ON                     /* ANY MSSC OR MSC PROBLEM ?   0382
*                                                            @G24LB02*/
*     THEN                                                         0382
@RF00376 DS    0H                                                  0382
NOMSSC   L     @01,CVTPTR                                          0382
         L     @01,CVTEXT2(,@01)                                   0382
         L     @15,CVTICB(,@01)                                    0382
         TM    ICBI(@15),B'10000000'                               0382
         BO    @RF00382                                            0382
*     DO;                           /* UNABLE TO USE MSSC OR 3850  0383
*                                                            @G24LB02*/
*       ICBB=ON;                    /* SET BROKEN BOX FLAG   @G24LB02*/
*       ICBMSCMP=OFF;               /* INDICATE NOT MP       @G24LB05*/
*       ICBMSCA=ON;                 /* INDICATE POSSIBLE AP  @G24LB05*/
         OI    ICBB(@15),B'00010010'                               0386
         NI    ICBMSCMP(@15),B'11111011'                           0386
*     END;                          /* END FAILURE PROCESSING      0387
*                                                            @G24LB02*/
*   ELSE                                                           0388
*     ICBB=OFF;                     /* TURNOFF BROKEN BOX INDICATOR
*                                                            @G24LB02*/
         B     @RC00382                                            0388
@RF00382 L     @01,CVTPTR                                          0388
         L     @01,CVTEXT2(,@01)                                   0388
         L     @01,CVTICB(,@01)                                    0388
         NI    ICBB(@01),B'11101111'                               0388
*                                                                  0389
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*   INTPRISC    SEGMENT OF ICBMSG05 WHICH CONTROLS THE     @G24LB02*/
*/*            INITIALIZATION OF THE INTERFACE BETWEEN THE   @G24LB02*/
*/*            3850 AND THE HOST CPU(S).                     @G24LB02*/
*/*               DURING THIS PROCESS, THE MSC UCBS ARE      @G24LB02*/
*/*               USED TO SEE WHICH IF ANY MSC(S) ARE ON     @G24LB02*/
*/*               LINE, AND THE PRIMARY AND SECONDARY OR     @G24LB02*/
*/*               ALTERNATE (IF ANY) MSC(S) ARE IDENTIFIED   @G24LB02*/
*/*         NOTE THAT THE TERMS SECONDARY AND ALTERNATE      @G24LB02*/
*/*         ARE USED INTERCHANGEABLY.                        @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUT:        THE ADDRESS OR ADDRESSES OF MSC UCB(S) AS @G24LB02*/
*/*          FOUND BY THE SEGMENT MSCUCBS                    @G24LB02*/
*/*          THE NUMBER OF CPUS ON LINE IS IN THE COMMON     @G24LB02*/
*/*          SYSTEM DATA AREA                                @G24LB02*/
*/*                                                          @G24LB02*/
*/*  PROCESSING:   ESTABLISHES COMMUNICATION WITH THE MSC    @G24LB02*/
*/*                WHICH IS TO COMMUNICATE WITH THIS SYSTEM. @G24LB02*/
*/*                FOR A MULTIPROCESSOR IPL, BOTH INTERFACES @G24LB02*/
*/*                ARE INITIALIZED ON BEHALF OF EACH         @G24LB02*/
*/*                HOST, BY JUST ONE INITIALIZE ORDER.       @G24LB02*/
*/*                A SUBSEGMENT, INITLIZE, CONSTRUCTS AND    @G24LB02*/
*/*                ISSUES THE ORDER                          @G24LB02*/
*/*                                                          @G24LB02*/
*/*   OUTPUT:      THE MSSC CONTROL BLOCK FIELDS FOR PRIMARY @G24LB02*/
*/*                & SECONDARY MSC UCB ADDRESSES ARE FILLED  @G24LB02*/
*/*                IN PROPERLY                               @G24LB02*/
*/*                THE INITIALIZE BIT IS SET ON IN THE MSSC  @G24LB02*/
*/*                CONTROL BLOCK                             @G24LB02*/
*/*                ON ERROR, THE FAILURE CODE IS RETURNED TO @G24LB02*/
*/*                CALLER, AND A CLEANUP CODE IS SET.        @G24LB02*/
*/*                ICBI AND ICBB FLAGS SET TO NOTE IF MSS IS @G24LB02*/
*/*                OPERATIVE OR INOPERATIVE.                 @G24LB02*/
*/*                                                          @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0389
*INTPRISC:                                                         0389
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* CONTROL OF       @G24LB02*/
@EL00001 L     @13,4(,@13)                                         0389
@EF00001 DS    0H                                                  0389
@ER00001 LM    @14,@12,12(@13)                                     0389
         BR    @14                                                 0389
INTPRISC DS    0H                                                  0390
*/*  INITIALIZE ORDER AND PRIMARY & SECONDARY MSC            @G24LB02*/
*/*  DETERMINATION                                           @G24LB02*/
*                                                                  0390
*   DCL                                                            0390
*     IPSRET POINTER(31);           /* FOR RETURN ADDRESS    @G24LB02*/
*   RFY                                                            0391
*     R14 RSTD;                     /* USE 14 FOR RETURN     @G24LB02*/
*   IPSRET=R14;                     /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,IPSRET                                          0392
*   RESPECIFY                                                      0393
*    (R14) UNRESTRICTED;            /* FROM QCVADS & PRIOR USE     0393
*                                                            @G24LB02*/
*   NMESPTR=ADDR(NMSGST);           /* INITIALIZE MESSAGE PTR      0394
*                                                            @G24LB02*/
         LA    @15,NMSGST                                          0394
         ST    @15,NMESPTR                                         0394
*   MSCUCBA1=ICBPUCB;               /* INITIALIZE A1 POINTER @G24LB02*/
         L     @15,CVTPTR                                          0395
         L     @01,CVTEXT2(,@15)                                   0395
         L     @14,CVTICB(,@01)                                    0395
         L     @11,ICBPUCB(,@14)                                   0395
         ST    @11,MSCUCBA1                                        0395
*   MSCUCBA2=ICBAUCB;               /* INITIALIZE A2 POINTER @G24LB02*/
         L     @10,ICBAUCB(,@14)                                   0396
         ST    @10,MSCUCBA2                                        0396
*   UCBPTR=MSCUCBA1;                /* READY FOR FIRST MSC UCB     0397
*                                                            @G24LB02*/
         ST    @11,UCBPTR                                          0397
*   IF CVTNIP=OFF THEN                                             0398
         TM    CVTNIP(@15),B'00010000'                             0398
         BNZ   @RF00398                                            0398
*     DO;                                                          0399
*       ICBPUCB->UCBONLI=ON;        /* SET PRIM UCB ONLINE   @G24LB02*/
         OI    UCBONLI(@11),B'10000000'                            0400
*       IF ICBAUCB^=LT2MSCS THEN                                   0401
         LTR   @10,@10                                             0401
         BZ    @RF00401                                            0401
*         ICBAUCB->UCBONLI=ON;      /* SET ALTERNATE UCB ONLINE    0402
*                                                            @G24LB02*/
         OI    UCBONLI(@10),B'10000000'                            0402
*     END;                          /*                       @G24LB02*/
@RF00401 DS    0H                                                  0404
*   IF MSCUCBA2^=LT2MSCS            /* ARE THERE TWO MSC UCBS ?    0404
*                                                            @G24LB02*/
*     THEN                          /* THERE ARE TWO MSC UCBS HERE 0404
*                                                            @G24LB02*/
@RF00398 ICM   @15,15,MSCUCBA2                                     0404
         BZ    @RF00404                                            0404
*     DO;                           /* YES, ANALYZE SITUATION MORE 0405
*                                                            @G24LB02*/
*       CALL TWOMSCS;               /* ROUTINE HANDLES TWO MSC CASE
*                                                            @G24LB02*/
         BAL   @14,TWOMSCS                                         0406
*     END;                          /* PATH FOR TWO MSCS     @G24LB02*/
*   ELSE                            /* THERE IS BUT ONE MSC  @G24LB02*/
*     DO;                           /* HANDLE THE LONE MSC   @G24LB02*/
         B     @RC00404                                            0408
@RF00404 DS    0H                                                  0409
*       IF UCBONLI=ON               /* IS THAT MSC ON LINE ? @G24LB02*/
*         THEN                      /* ONE MSC AND IT IS ON LINE   0409
*                                                            @G24LB02*/
         L     @01,UCBPTR                                          0409
         TM    UCBONLI(@01),B'10000000'                            0409
         BNO   @RF00409                                            0409
*         DO;                       /* TRY TO USE THE SINGLE MSC   0410
*                                                            @G24LB02*/
*           CALL INITLIZE;          /* ISSUE INITIALIZE TO IT      0411
*                                                            @G24LB02*/
         BAL   @14,INITLIZE                                        0411
*           MSC1IRC=FAILCODE;       /* SAVE INITIALIZE RETURN      0412
*                                                            @G24LB02*/
         L     @15,FAILCODE                                        0412
         ST    @15,MSC1IRC                                         0412
*           IF MSC1IRC=NLIRC THEN                                  0413
         SLR   @14,@14                                             0413
         IC    @14,NLIRC                                           0413
         CR    @15,@14                                             0413
         BNE   @RF00413                                            0413
*             CALL TRYLI;                                          0414
         BAL   @14,TRYLI                                           0414
*           IF FAILCODE=GOODIO      /* DID ALL GO WELL ?     @G24LB02*/
*             THEN                  /* ALL WENT WELL         @G24LB02*/
@RF00413 ICM   @15,15,FAILCODE                                     0415
         BNZ   @RF00415                                            0415
*             DO;                   /* WE HAVE INITIALIZED   @G24LB02*/
*               ICBI=ON;            /* MARK MSSC CONTROL BLOCK     0417
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0417
         L     @01,CVTEXT2(,@01)                                   0417
         L     @01,CVTICB(,@01)                                    0417
         OI    ICBI(@01),B'10000000'                               0417
*             END;                  /* AND THIS IS KNOWN AS PRIMARY
*                                                            @G24LB02*/
*           ELSE                    /* THE ONE LONE MSC DOES NOT   0419
*                                      INITIALIZE            @G24LB02*/
*             CLEANCOD=NOMSCNIT;    /* 1 MSC & IT WONT INITLZ      0419
*                                                            @G24LB02*/
         B     @RC00415                                            0419
@RF00415 MVC   CLEANCOD(4),@CF02601                                0419
*         END;                                                     0420
*       ELSE                                                       0421
*         DO;                       /*                       @ZA16134*/
         B     @RC00409                                            0421
@RF00409 DS    0H                                                  0422
*           CLEANCOD=NOMSCNIT;      /* MSC OFFLINE, NO INIT  @ZA16134*/
         MVC   CLEANCOD(4),@CF02601                                0422
*           MSC1IRC='F1'X;          /* MSC OFFLINE REAS CODE @ZA16134*/
         LA    @15,241                                             0423
         ST    @15,MSC1IRC                                         0423
*         END;                      /*                       @ZA16134*/
*       IF CLEANCOD^=ALLCLEAN THEN  /*                       @ZA16134*/
@RC00409 SLR   @15,@15                                             0425
         C     @15,CLEANCOD                                        0425
         BE    @RF00425                                            0425
*         DO;                       /*                       @ZA16134*/
*           IF CVTNIP=ON THEN                                      0427
         L     @01,CVTPTR                                          0427
         TM    CVTNIP(@01),B'00010000'                             0427
         BNO   @RF00427                                            0427
*             DO;                   /*                       @G24LB02*/
*               NMESNUM=INITMNUM;   /* NUMBER FOR INIT MESSAGE     0429
*                                                            @G24LB02*/
         L     @14,NMESPTR                                         0429
         MVC   NMESNUM(3,@14),INITMNUM                             0429
*               NMESTEXT(1:LENGTH(INITTEXT))=INITTEXT;/*     @G24LB02*/
         MVC   NMESTEXT(58,@14),INITTEXT                           0430
*               IF MSC1IRC^=GOODIO  /* WAS FAILURE ONLY ON 1ST MSC?
*                                                            @G24LB02*/
*                 THEN              /* FAILURE ON 1ST MSC ONLY     0431
*                                                            @G24LB02*/
         L     @11,MSC1IRC                                         0431
         CR    @11,@15                                             0431
         BE    @RF00431                                            0431
*                 DO;               /* PUT 1ST MSC UNIT INTO MSG   0432
*                                                            @G24LB02*/
*                   NMESTEXT(42:44)=MSCUCBA1->UCBNAME;/*     @G24LB02*/
         L     @15,MSCUCBA1                                        0433
         MVC   NMESTEXT+41(3,@14),UCBNAME(@15)                     0433
*                   PLACCONV=MSC1IRC;/* READY TO CONVERT CODE      0434
*                                                            @G24LB02*/
         ST    @11,PLACCONV                                        0434
*                   RESPECIFY                                      0435
*                     R0 RESTRICTED;/* FOR CONVERSION        @G24LB02*/
*                   CALL RCTOEBC;   /* CODE FROM HEX TO EBCDIC     0436
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0436
*                   RESPECIFY                                      0437
*                     R0 UNRESTRICTED;/* CONVERSION OVER     @G24LB02*/
*                   NMESTEXT(56:58)=PLAC234;/* REASON CODE   @G24LB02*/
         L     @01,NMESPTR                                         0438
         MVC   NMESTEXT+55(3,@01),PLAC234                          0438
*                   MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE @G24LB02*/
         L     @01,MSCUCBA1                                        0439
         NI    UCBONLI(@01),B'01111111'                            0439
*/*   WRITE INFORMATIONAL MESSAGE TO THE SYSTEM OPERATOR     @G24LB02*/
*                                                                  0440
*IIEAPMNB:                                                         0440
*                   GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*     @G24LB02*/
*                   REFS(NVTWTO,NMSGH);/* OPERATOR SHOWN ONE LINE  0440
*                                                            @G24LB02*/
IIEAPMNB IEAPMNIP TYPE=WTO,PARAM=NMSGH
*                 END;              /* DID MSG FOR INITLZ FAILURE ON
*                                      1ST MSC ONLY          @G24LB02*/
*               ELSE                                               0442
*                 ;                                                0442
@RF00431 DS    0H                                                  0443
*             END;                  /*                       @G24LB02*/
*           ELSE                                                   0444
*             DO;                   /*                       @G24LB02*/
         B     @RC00427                                            0444
@RF00427 DS    0H                                                  0445
*               IF MSC1IRC^=GOODIO THEN                            0445
         L     @15,MSC1IRC                                         0445
         LTR   @15,@15                                             0445
         BZ    @RF00445                                            0445
*                 DO;               /*                       @G24LB02*/
*                   PLACCONV=MSC1IRC;/* REASON CODE FOR PUCB @G24LB02*/
         ST    @15,PLACCONV                                        0447
*                   CALL RCTOEBC;   /* TRANSL REAS CODE      @G24LB02*/
         BAL   @14,RCTOEBC                                         0448
*                   MSG321F(16:18)=MSCUCBA1->UCBNAME;/* PUT UCB IN 0449
*                                      MSG                   @G24LB02*/
         L     @15,MSCUCBA1                                        0449
         MVC   MSG321F+15(3),UCBNAME(@15)                          0449
*                   MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE @G24LB02*/
         NI    UCBONLI(@15),B'01111111'                            0450
*                   WTOGEN03=MSG321;/* LOAD MSG BUFFER W/321 MSG   0451
*                                                            @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0451
*                   WTOGEN03(54:56)=PLAC234;/* REAS CODE IN MSG    0452
*                                                            @G24LB02*/
         MVC   WTOGEN03+53(3),PLAC234                              0452
*                   CALL ICBMSG45;  /* WRITE THE MESSAGE     @G24LB02*/
         BAL   @14,ICBMSG45                                        0453
*                   WTOGEN03=MSG320;/* LOAD MSG BUFFER W/320 MSG   0454
*                                                            @G24LB02*/
         MVI   WTOGEN03+51,C' '                                    0454
         MVC   WTOGEN03+52(21),WTOGEN03+51                         0454
         MVC   WTOGEN03(51),MSG320                                 0454
*                   CALL ICBMSG45;  /* WRITE THE MESSAGE     @G24LB02*/
         BAL   @14,ICBMSG45                                        0455
*                 END;              /* PROCESSING IF 1 MSC ON LINE 0456
*                                                            @G24LB02*/
*             END;                  /*                       @G24LB02*/
@RF00445 DS    0H                                                  0458
*         END;                      /*                       @G24LB02*/
@RC00427 DS    0H                                                  0459
*     END;                          /*                       @G24LB02*/
@RF00425 DS    0H                                                  0460
*   RFY                                                            0460
*     R14 RSTD;                     /* RESTRICT 14 FOR RETURN USE  0460
*                                                            @G24LB02*/
@RC00404 DS    0H                                                  0461
*   R14=IPSRET;                     /* RESTORE RETURN ADDRESS      0461
*                                                            @G24LB02*/
         L     R14,IPSRET                                          0461
*   RFY                                                            0462
*     R14 UNRSTD;                   /* FREE 14 FOR BRANCH BACK     0462
*                                                            @G24LB02*/
*   END INTPRISC;                   /* HAVE INITIALIZED IF POSSIBLE
*                                                            @G24LB02*/
@EL00002 DS    0H                                                  0463
@EF00002 DS    0H                                                  0463
@ER00002 BR    @14                                                 0463
*                                                                  0464
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*    TWOMSCS:  HANDLE CASE OF TWO MSC UCBS                 @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUT: ADDRESS OF TWO MSC UCBS AS FOUND BY THE SEGMENT  @G24LB02*/
*/*         MSCUCBS                                          @G24LB02*/
*/*         INDICATION IN EACH MSC UCB WHETHER THAT MSC IS   @G24LB02*/
*/*         ON LINE                                          @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESSING: DETERMINE WHICH OF THESE IS THE PRIMARY MSC, @G24LB02*/
*/*        ENSURE THAT THE INITIALIZE ORDER IS ISSUED TO IT  @G24LB02*/
*/*       INFORM THE SYSTEM OPERATOR IF EITHER OF THESE TWO  @G24LB02*/
*/*       MSC UCBS IS MARKED OFF LINE OR IF EITHER HAS A BAD @G24LB02*/
*/*       REASON CODE FROM INITIALIZE                        @G24LB02*/
*/*       UPON SUCCESSFUL INITIALIZATION, SET THE            @G24LB02*/
*/*       INITIALIZED BIT IN THE MSSC CONTROL BLOCK          @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT: THE INITIALIZED BIT AND THE POINTERS TO THE     @G24LB02*/
*/*         PRIMARY AND ALTERNATE OR SECONDARY (IF ANY) MSC  @G24LB02*/
*/*         UCBS ARE SET IN THE MSSC CONTROL BLOCK           @G24LB02*/
*/*       ON ERROR, THE REASON CODE FROM THE INITIALIZE IS   @G24LB02*/
*/*          PASSED TO THE CALLER                            @G24LB02*/
*/*                                                          @G24LB02*/
*/* MESSAGES: IEA976I, IEA973I & ICB321I ARE WRITTEN BY      @G24LB02*/
*/* TWOMSCS                                                  @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0464
*TWOMSCS:                                                          0464
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB02*/
TWOMSCS  DS    0H                                                  0465
*   DCL                                                            0465
*     TWORET POINTER(31);           /* FOR RETURN ADDRESS    @G24LB02*/
*   NMESPTR=ADDR(NMSGST);           /* SETUP MESSAGE PTR     @G24LB02*/
         LA    @15,NMSGST                                          0466
         ST    @15,NMESPTR                                         0466
*/* NOTE--MUST PRESERVE REASON CODES FROM BAD INITIALIZE(S), @G24LB02*/
*/*  FOR  EVENTUAL INCLUSION IN THE MESSAGE IEA977I          @G24LB02*/
*                                                                  0467
*   GEN DATA REFS(ONEMSCF,ONEMSCU);                                0467
*   GEN DATA REFS(NITF,NITFMSC,NITFRC);                            0468
*                                                                  0468
*/*  NOTE THAT INTPRISC SETS UCBPTR TO ADDR OF FIRST MSC UCB @G24LB02*/
*/*  FOUND  BEFORE CALLING TWOMSCS                           @G24LB02*/
*                                                                  0469
*   RFY                                                            0469
*     R14 RSTD;                     /* TO SAVE RETURN ADDRESS      0469
*                                                            @G24LB02*/
*   TWORET=R14;                     /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,TWORET                                          0470
*   RFY                                                            0471
*     R14 UNRSTD;                   /* FREE UP REGISTER 14   @G24LB02*/
*   IF UCBONLI=ON                   /* IS FIRST MSC ON LINE ?      0472
*                                                            @G24LB02*/
*     THEN                          /* THE FIRST MSC FOUND IS ON LINE
*                                                            @G24LB02*/
         L     @01,UCBPTR                                          0472
         TM    UCBONLI(@01),B'10000000'                            0472
         BNO   @RF00472                                            0472
*     DO;                           /* WILL TRY IT FIRST FOR PRIMARY
*                                                            @G24LB02*/
*/*     THE FIRST MSC IS ON LINE                             @G24LB02*/
*                                                                  0474
*       IF MSCUCBA2->UCBONLI=ON     /* IS SECOND MSC UCB ON LINE ? 0474
*                                                            @G24LB02*/
*         THEN                      /* BOTH MSCS ARE ON LINE @G24LB02*/
         L     @01,MSCUCBA2                                        0474
         TM    UCBONLI(@01),B'10000000'                            0474
         BNO   @RF00474                                            0474
*         DO;                       /* BOTH MSCS ARE ON LINE @G24LB02*/
*           CALL INITLIZE;          /* ISSUE INITIALIZE TO FIRST   0476
*                                                            @G24LB02*/
         BAL   @14,INITLIZE                                        0476
*           MSC1IRC=FAILCODE;       /* SAVE REASON CODE      @G24LB02*/
         MVC   MSC1IRC(4),FAILCODE                                 0477
*           ICBPUCB=MSCUCBA2;       /* SET UP TO INITIALIZE SECOND 0478
*                                      MSC                   @G24LB02*/
         L     @01,CVTPTR                                          0478
         L     @01,CVTEXT2(,@01)                                   0478
         L     @01,CVTICB(,@01)                                    0478
         MVC   ICBPUCB(4,@01),MSCUCBA2                             0478
*           CALL INITLIZE;          /* ISSUE INITLIZE TO SECOND    0479
*                                                            @G24LB02*/
         BAL   @14,INITLIZE                                        0479
*           MSC2IRC=FAILCODE;       /* SAVE REASON CODE      @G24LB02*/
*                                                                  0480
         L     @15,FAILCODE                                        0480
         ST    @15,MSC2IRC                                         0480
*           /*********************************************************/
*           /*                                                       */
*           /* NOTE THAT ADDRESS OF SECOND IS NOW IN MSSC CONTROL    */
*           /*                                               @G24LB02*/
*           /* BLOCK AS THE PRIMARY MSC                      @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0481
*           IF MSC2IRC=GOODIO       /* IS SECOND THE PRIMARY ?     0481
*                                                            @G24LB02*/
*             THEN                  /* SECOND MSC IS THE PRIMARY   0481
*                                                            @G24LB02*/
         LTR   @15,@15                                             0481
         BNZ   @RF00481                                            0481
*             DO;                   /* YES, AND IT IS INITIALIZED  0482
*                                                            @G24LB02*/
*               ICBI=ON;            /* SET INITIALIZED BIT IN MSSC 0483
*                                      CONTROL BLOCK         @G24LB02*/
         L     @01,CVTPTR                                          0483
         L     @01,CVTEXT2(,@01)                                   0483
         L     @15,CVTICB(,@01)                                    0483
         OI    ICBI(@15),B'10000000'                               0483
*               ICBAUCB=MSCUCBA1;   /* FIRST MSC IS ALTERNATE      0484
*                                                            @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA1                             0484
*               IF MSC1IRC=NLIRC    /* DID FIRST SAY NO LOWER INT? 0485
*                                                            @G24LB02*/
*                 THEN              /* FIRST SAID NO LOWER INTERFACE
*                                                            @G24LB02*/
         L     @15,MSC1IRC                                         0485
         SLR   @14,@14                                             0485
         IC    @14,NLIRC                                           0485
         CR    @15,@14                                             0485
         BE    @RT00485                                            0485
*                 ;                 /* THAT IS WHAT IT SHOULD BE   0486
*                                                            @G24LB02*/
*               ELSE                /* FIRST HAS UNEXPECTED REASON 0487
*                                      CODE                  @G24LB02*/
*                 DO;               /* NO, TELL OPERATOR WHAT IT   0487
*                                                            @G24LB02*/
*                                                                  0487
*                   /*************************************************/
*                   /*                                               */
*                   /* DID SAY                               @G24LB02*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0488
*                   PLACCONV=MSC1IRC;/* PICK UP REASON CODE  @G24LB02*/
         MVC   PLACCONV(4),MSC1IRC                                 0488
*                   RESPECIFY                                      0489
*                     R0 RESTRICTED;/* FOR CONVERSION        @G24LB02*/
*                   CALL RCTOEBC;   /* CONVERTS REASON CODE TO EBCDIC
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0490
*                   RESPECIFY                                      0491
*                     R0 UNRESTRICTED;/* CONVERSION OVER     @G24LB02*/
*                   NITFRC=PLAC234; /* EBCDIC CODE INTO MESSAGE    0492
*                                                            @G24LB02*/
         MVC   NITFRC(3),PLAC234                                   0492
*                   NITFMSC=MSCUCBA1->UCBNAME;/* UNIT ADDR INTO MSG
*                                                            @G24LB02*/
         L     @01,MSCUCBA1                                        0493
         MVC   NITFMSC(3),UCBNAME(@01)                             0493
*                   IF CVTNIP=ON THEN/* TEST FOR NIP IN CTL  @G24LB02*/
         L     @01,CVTPTR                                          0494
         TM    CVTNIP(@01),B'00010000'                             0494
         BNO   @RF00494                                            0494
*                     DO;           /* NIP IN CONTROL CODE   @G24LB02*/
*IIEAPMN1:                          /* 1ST ICBMSG05 USE OR IEAPMNIP
*                                                            @G24LB02*/
*                       GEN(IEAPMNIP TYPE=WTO,PARAM=NITMSGH)/*     0496
*                                                            @G24LB02*/
*                       REFS(NVTWTO,NITMSGH);/* TELL SYSTEM OPERATOR
*                                                            @G24LB02*/
IIEAPMN1 IEAPMNIP TYPE=WTO,PARAM=NITMSGH
*                       MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE   0497
*                                                            @G24LB02*/
         L     @01,MSCUCBA1                                        0497
         NI    UCBONLI(@01),B'01111111'                            0497
*                     END;          /* END NIP IN CONTROL CODE     0498
*                                                            @G24LB02*/
*                   ELSE            /* NIP NOT IN CONTROL    @G24LB02*/
*                     DO;           /* NIP NOT IN CONTROL CODE     0499
*                                                            @G24LB02*/
         B     @RC00494                                            0499
@RF00494 DS    0H                                                  0500
*                       WTOGEN03=MSG321;/* PRIME WTO BUFFER  @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0500
*                       WTOGEN03(16:18)=NITFMSC;/* PUT IN MSC UNIT 0501
*                                      ADDR@G24LB02                  */
         MVC   WTOGEN03+15(3),NITFMSC                              0501
*                       WTOGEN03(54:56)=NITFRC;/* PUT IN REASON CODE
*                                                            @G24LB02*/
         MVC   WTOGEN03+53(3),NITFRC                               0502
*                       CALL ICBMSG45;/* CALL WTO SUB-ROUTINE      0503
*                                                            @G24LB02*/
         BAL   @14,ICBMSG45                                        0503
*                       MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE   0504
*                                                            @G24LB02*/
         L     @01,MSCUCBA1                                        0504
         NI    UCBONLI(@01),B'01111111'                            0504
*                     END;          /* END NIP NOT IN CONTROL CODE 0505
*                                                            @G24LB02*/
*                 END;              /* PROCESSING 2ND MSC STRANGE  0506
*                                      CODE                  @G24LB02*/
*             END;                  /* LOGIC FOR SECOND AS PRIMARY 0507
*                                      WHEN BOTH ON LINE     @G24LB02*/
*           ELSE                    /* SECOND IS NOT THE PRIMARY   0508
*                                                            @G24LB02*/
*             DO;                   /* TRY TO GET FIRST AS PRIMARY 0508
*                                                            @G24LB02*/
         B     @RC00481                                            0508
@RF00481 DS    0H                                                  0509
*               IF MSC1IRC=GOODIO   /* 2ND NOT--IS FIRST PRIMARY?  0509
*                                                            @G24LB02*/
*                 THEN              /* FIRST IS THE PRIMARY MSC    0509
*                                                            @G24LB02*/
         ICM   @15,15,MSC1IRC                                      0509
         BNZ   @RF00509                                            0509
*                 DO;               /* FIRST IS PRIMARY, SET IT UP 0510
*                                                            @G24LB02*/
*                   ICBI=ON;        /* MSSC HAS INITIALIZED INTERF 0511
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0511
         L     @01,CVTEXT2(,@01)                                   0511
         L     @15,CVTICB(,@01)                                    0511
         OI    ICBI(@15),B'10000000'                               0511
*                   ICBPUCB=MSCUCBA1;/* PRI ADDR INTO MSSC CTL BLK 0512
*                                                            @G24LB02*/
         MVC   ICBPUCB(4,@15),MSCUCBA1                             0512
*                   ICBAUCB=MSCUCBA2;/* ALT ADDR INTO MSSC CTL BLK 0513
*                                                            @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA2                             0513
*                   IF MSC2IRC=NLIRC/* DID 2ND SAY NO LOWER INTERF 0514
*                                                            @G24LB02*/
*                     THEN          /* YES, ALL AS EXPECTED  @G24LB02*/
         L     @15,MSC2IRC                                         0514
         SLR   @14,@14                                             0514
         IC    @14,NLIRC                                           0514
         CR    @15,@14                                             0514
         BE    @RT00514                                            0514
*                     ;             /* NO EXTRA PROCESSING, ALL OK 0515
*                                                            @G24LB02*/
*                   ELSE            /* 2ND HAS A STRANGE REASON CODE
*                                                            @G24LB02*/
*                     DO;           /* TELL OPERATOR UNEXPECTED    0516
*                                                            @G24LB02*/
*                       PLACCONV=MSC2IRC;/* PICK UP REASON CODE    0517
*                                                            @G24LB02*/
         MVC   PLACCONV(4),MSC2IRC                                 0517
*                       RESPECIFY                                  0518
*                         R0 RESTRICTED;/* FOR CONVERSION    @G24LB02*/
*                       CALL RCTOEBC;/* HEX TO EBCDIC CONVERSION   0519
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0519
*                       RESPECIFY                                  0520
*                         R0 UNRESTRICTED;/* FOR CONVERSION  @G24LB02*/
*                       NITFRC=PLAC234;/* EBCDIC CODE INTO MESSAGE 0521
*                                                            @G24LB02*/
         MVC   NITFRC(3),PLAC234                                   0521
*                       NITFMSC=MSCUCBA2->UCBNAME;/* UNIT ADDR INTO
*                                      MSG                   @G24LB02*/
         L     @15,MSCUCBA2                                        0522
         MVC   NITFMSC(3),UCBNAME(@15)                             0522
*                       MSCUCBA2->UCBONLI=OFF;/* SET UCB OFFLINE   0523
*                                                            @G24LB02*/
         NI    UCBONLI(@15),B'01111111'                            0523
*                       IF CVTNIP=ON THEN/* TEST FOR NIP IN CTL    0524
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0524
         TM    CVTNIP(@01),B'00010000'                             0524
         BNO   @RF00524                                            0524
*                         DO;       /* NIP IN CONTROL CODE   @G24LB02*/
*IIEAPMN2:                          /* 2ND ICBMSG05 USE OF IEAPMNIP
*                                                            @G24LB02*/
*                           GEN(IEAPMNIP TYPE=WTO,PARAM=NITMSGH)/* 0526
*                                                            @G24LB02*/
*                           REFS(NVTWTO,NITMSGH);/* TELL SYSTEM    0526
*                                      OPERATOR              @G24LB02*/
IIEAPMN2 IEAPMNIP TYPE=WTO,PARAM=NITMSGH
*                         END;      /* END NIP IN CONTROL CODE     0527
*                                                            @G24LB02*/
*                       ELSE        /* NIP NOT IN CONTROL    @G24LB02*/
*                         DO;       /* NIP NOT IN CONTROL CODE     0528
*                                                            @G24LB02*/
         B     @RC00524                                            0528
@RF00524 DS    0H                                                  0529
*                           WTOGEN03=MSG321;/* PRIME WTO BUFFER    0529
*                                                            @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0529
*                           WTOGEN03(16:18)=NITFMSC;/* PUT IN MSC  0530
*                                      UNIT ADDR@G24LB02             */
         MVC   WTOGEN03+15(3),NITFMSC                              0530
*                           WTOGEN03(54:56)=NITFRC;/* PUT IN REASON
*                                      CODE                  @G24LB02*/
         MVC   WTOGEN03+53(3),NITFRC                               0531
*                           CALL ICBMSG45;/* CALL WTO SUB-ROUTINE  0532
*                                                            @G24LB02*/
         BAL   @14,ICBMSG45                                        0532
*                         END;      /* END NIP NOT IN CONTROL CODE 0533
*                                                            @G24LB02*/
*                     END;          /* HANDLING FUNNY REASON FROM 2ND
*                                                            @G24LB02*/
*                 END;              /* SETTING UP FIRST AS PRI     0535
*                                                            @G24LB02*/
*               ELSE                /* HAVE NO PRIMARY MSC YET     0536
*                                                            @G24LB02*/
*                 DO;               /* NEITHER 1ST NOR 2ND IS PRI  0536
*                                                            @G24LB02*/
         B     @RC00509                                            0536
@RF00509 DS    0H                                                  0537
*                   CALL TRYLI;     /* CALL SUBROUTINE       @G24LB02*/
*                                                                  0537
         BAL   @14,TRYLI                                           0537
*                   /*************************************************/
*                   /*                                               */
*                   /* TO TRY TO SWITCH THE LOWER INTERFACE  @G24LB02*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0538
*                 END;              /* OF LAST-DITCH TRY IF NO PRI 0538
*                                                            @G24LB02*/
*             END;                  /* LOGIC FOR SECOND NOT PRI, BOTH
*                                      MSCS ON LINE          @G24LB02*/
*         END;                      /* LOGIC FOR BOTH MSCS ON LINE 0540
*                                                            @G24LB02*/
*       ELSE                        /* 1ST MSC ON LINE, 2ND IS NOT 0541
*                                                            @G24LB02*/
*         DO;                       /* 1ST MSC ON LINE, NOT 2ND    0541
*                                                            @G24LB02*/
*                                                                  0541
         B     @RC00474                                            0541
@RF00474 DS    0H                                                  0542
*           /*********************************************************/
*           /*                                                       */
*           /* FIRST TELL THE OPERATOR WHICH MSC IS OFF LINE @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0542
*           ONEMSCU=MSCUCBA2->UCBNAME;/* UNIT NAME INTO MSG  @G24LB02*/
*                                                                  0542
         L     @01,MSCUCBA2                                        0542
         MVC   ONEMSCU(3),UCBNAME(@01)                             0542
*           /*********************************************************/
*           /*                                                       */
*           /* OFFLINE MSG ONLY VALID AT NIP TIME, NOT USED WHEN     */
*           /*                                               @G24LB02*/
*           /* MSSC MESSAGE MODULE IN CONTROL.               @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0543
*IIEAPMN3:                          /* 3RD ICBMSG05 USE OF IEAPMNIP
*                                                            @G24LB02*/
*           GEN(IEAPMNIP TYPE=WTO,PARAM=OFFMSGH)/*           @G24LB02*/
*           REFS(NVTWTO,OFFMSGH);   /* INFORM OPERATOR       @G24LB02*/
IIEAPMN3 IEAPMNIP TYPE=WTO,PARAM=OFFMSGH
*           ICBPUCB=MSCUCBA1;       /* TRY FIRST AS PRIMARY  @G24LB02*/
         L     @01,CVTPTR                                          0544
         L     @01,CVTEXT2(,@01)                                   0544
         L     @01,CVTICB(,@01)                                    0544
         MVC   ICBPUCB(4,@01),MSCUCBA1                             0544
*           CALL INITLIZE;          /* ISSUE INITIALIZE TO FIRST   0545
*                                                            @G24LB02*/
         BAL   @14,INITLIZE                                        0545
*           MSC1IRC=FAILCODE;       /* SAVE REASON CODE FROM       0546
*                                      INITIALIZE            @G24LB02*/
         L     @15,FAILCODE                                        0546
         ST    @15,MSC1IRC                                         0546
*           IF MSC1IRC=GOODIO       /* IS FIRST THE PRIMARY ?      0547
*                                                            @G24LB02*/
*             THEN                  /* YES, 1ST IS THE PRIMARY     0547
*                                                            @G24LB02*/
         LTR   @15,@15                                             0547
         BNZ   @RF00547                                            0547
*             DO;                   /* CONTINUE SETUP ACCORDINGLY  0548
*                                                            @G24LB02*/
*               ICBI=ON;            /* HAVE INITIALIZED INTERFACE  0549
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0549
         L     @01,CVTEXT2(,@01)                                   0549
         L     @15,CVTICB(,@01)                                    0549
         OI    ICBI(@15),B'10000000'                               0549
*               ICBAUCB=MSCUCBA2;   /* SET SECOND AS ALTERNATE     0550
*                                                            @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA2                             0550
*             END;                  /* FIRST ONLINE, SECOND OFF    0551
*                                                            @G24LB02*/
*           ELSE                    /* 1ST ONLY ON LINE, BUT NOT   0552
*                                      PRIMARY               @G24LB02*/
*             DO;                   /* SEE IF IT COULD BE PRIMARY  0552
*                                                            @G24LB02*/
         B     @RC00547                                            0552
@RF00547 DS    0H                                                  0553
*               CALL TRYLI;         /* TRY TO SWITCH LOWER INTERFACE
*                                                            @G24LB02*/
         BAL   @14,TRYLI                                           0553
*             END;                  /* LAST DITCH EFFORT     @G24LB02*/
*         END;                      /* OF LOGIC FOR 1ST MSC IS ONLY
*                                      MSC ON LINE           @G24LB02*/
*     END;                          /* OF LOGIC FOR 1ST MSC ON LINE
*                                                            @G24LB02*/
*   ELSE                            /* FIRST MSC NOT ON LINE, SEE IF
*                                      2ND IS                @G24LB02*/
*/*   THE FIRST MSC IS ON NOT LINE                           @G24LB02*/
*                                                                  0557
*     IF MSCUCBA2->UCBONLI=ON       /* IS SECOND ON LINE ?   @G24LB02*/
*       THEN                        /* SECOND MSC IS ON LINE @G24LB02*/
         B     @RC00472                                            0557
@RF00472 L     @01,MSCUCBA2                                        0557
         TM    UCBONLI(@01),B'10000000'                            0557
         BNO   @RF00557                                            0557
*       DO;                         /* PROCESS SECOND WHEN ONLY ONE
*                                      ON LINE               @G24LB02*/
*         ONEMSCU=UCBNAME;          /* EBCDIC UNIT NAME INTO MESSAGE
*                                                            @G24LB02*/
*                                                                  0559
         L     @01,UCBPTR                                          0559
         MVC   ONEMSCU(3),UCBNAME(@01)                             0559
*         /***********************************************************/
*         /*                                                         */
*         /* OFFLINE MSG ONLY VALID AT NIP TIME, NOT USED WHEN       */
*         /*                                                 @G24LB02*/
*         /* MSSC MESSAGE MODULE IN CONTROL.                 @G24LB02*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0560
*IIEAPMN4:                          /* 4TH ICBMSG05 USE OF IEAPMNIP
*                                                            @G24LB02*/
*         GEN(IEAPMNIP TYPE=WTO,PARAM=OFFMSGH)/*             @G24LB02*/
*         REFS(NVTWTO,OFFMSGH);     /* TELL THE SYSTEM OPERATOR    0560
*                                                            @G24LB02*/
IIEAPMN4 IEAPMNIP TYPE=WTO,PARAM=OFFMSGH
*         ICBPUCB=MSCUCBA2;         /* SET 2ND MSC AS PRI    @G24LB02*/
         L     @01,CVTPTR                                          0561
         L     @01,CVTEXT2(,@01)                                   0561
         L     @01,CVTICB(,@01)                                    0561
         MVC   ICBPUCB(4,@01),MSCUCBA2                             0561
*         CALL INITLIZE;            /* TRY THE INITIALIZE TO IT    0562
*                                                            @G24LB02*/
         BAL   @14,INITLIZE                                        0562
*         MSC2IRC=FAILCODE;         /* SAVE THE REASON CODE  @G24LB02*/
         L     @15,FAILCODE                                        0563
         ST    @15,MSC2IRC                                         0563
*         IF MSC2IRC=GOODIO         /* DID 2ND MSC INITLIZE AS PRI ?
*                                                            @G24LB02*/
*           THEN                    /* SECOND MSC IS PRIMARY @G24LB02*/
         LTR   @15,@15                                             0564
         BNZ   @RF00564                                            0564
*           DO;                     /* USE IT AS SUCH        @G24LB02*/
*             ICBI=ON;              /* WE HAVE INITIALIZED   @G24LB02*/
         L     @01,CVTPTR                                          0566
         L     @01,CVTEXT2(,@01)                                   0566
         L     @15,CVTICB(,@01)                                    0566
         OI    ICBI(@15),B'10000000'                               0566
*             ICBAUCB=MSCUCBA1;     /* SET FIRST MSC AS ALTERNATE  0567
*                                                            @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA1                             0567
*           END;                    /* DETERMINING SECOND AS PRIMARY
*                                      WHEN                  @G24LB02*/
*                                                                  0568
*         /***********************************************************/
*         /*                                                         */
*         /* FIRST NOT ON LINE                               @G24LB02*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0569
*         ELSE                      /* ONLY 2ND MSC ON LINE, WONT  0569
*                                      INITLIZE              @G24LB02*/
*           DO;                     /* ANOTHER LAST DITCH EFFORT HERE
*                                                            @G24LB02*/
         B     @RC00564                                            0569
@RF00564 DS    0H                                                  0570
*             CALL TRYLI;           /* TRY TO SWITCH LOWER INTERFACE
*                                                            @G24LB02*/
         BAL   @14,TRYLI                                           0570
*           END;                    /* EITHER HAVE A PRIMARY OR WE 0571
*                                      DONT BY NOW           @G24LB02*/
*       END;                        /* LOGIC WHERE 2ND ONLY ONE ON 0572
*                                      LINE                  @G24LB02*/
*     ELSE                          /* NEITHER MSC ON LINE, FAIL MSSC
*                                      INITLZN               @G24LB02*/
*       DO;                         /* NEITHER MSC IS ON LINE, MUST
*                                      SET CLEANUP           @G24LB02*/
         B     @RC00557                                            0573
@RF00557 DS    0H                                                  0574
*         CLEANCOD=TWOOFFL;         /* NO MSC IS ON LINE     @G24LB02*/
         MVC   CLEANCOD(4),@CF02597                                0574
*       END;                        /*                       @G24LB02*/
*   IF CLEANCOD=TWOOFFL THEN                                       0576
@RC00557 DS    0H                                                  0576
@RC00472 CLC   CLEANCOD(4),@CF02597                                0576
         BNE   @RF00576                                            0576
*     DO;                                                          0577
*       IF CVTNIP=ON THEN           /*                       @G24LB02*/
         L     @01,CVTPTR                                          0578
         TM    CVTNIP(@01),B'00010000'                             0578
         BNO   @RF00578                                            0578
*         DO;                       /*                       @G24LB02*/
*           NMESNUM=OFFLMNUM;       /* NUMBER FOR INIT MESSAGE     0580
*                                                            @G24LB02*/
         L     @15,NMESPTR                                         0580
         MVC   NMESNUM(3,@15),OFFLMNUM                             0580
*           NMESTEXT(1:LENGTH(OFFLTEXT))=OFFLTEXT;/*         @G24LB02*/
         MVC   NMESTEXT(31,@15),OFFLTEXT                           0581
*IIEAPMNA:                                                         0582
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*             @G24LB02*/
*           REFS(NVTWTO,NMSGH);     /* OPERATOR SHOWN ONE LINE     0582
*                                                            @G24LB02*/
IIEAPMNA IEAPMNIP TYPE=WTO,PARAM=NMSGH
*         END;                      /*                       @G24LB02*/
*     END;                          /*                       @G24LB02*/
@RF00578 DS    0H                                                  0585
*   RFY                                                            0585
*     R14 RSTD;                     /* TO PICK UP RETURN ADDRESS   0585
*                                                            @G24LB02*/
@RF00576 DS    0H                                                  0586
*   R14=TWORET;                     /* RESTORE RETURN ADDRESS      0586
*                                                            @G24LB02*/
         L     R14,TWORET                                          0586
*   RFY                                                            0587
*     R14 UNRSTD;                   /* FREE UP 14 FOR RETURN @G24LB02*/
*   END TWOMSCS;                    /*                       @G24LB02*/
@EL00003 DS    0H                                                  0588
@EF00003 DS    0H                                                  0588
@ER00003 BR    @14                                                 0588
*                                                                  0589
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*    INITLIZE:   SUBROUTINE USED TO ISSUE INITIALIZE ORDER @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUT:        THE NUMBER OF CPUS ON LINE (IN THE CSDA)  @G24LB02*/
*/*                ADDRESS OF A MSC UCB IN THE PRIMARY SLOT  @G24LB02*/
*/*                IN THE MSSC CONTROL BLOCK                 @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESSING:    FOR A UNIPROCESSOR IPL, ISSUES INITIALIZE @G24LB02*/
*/*                FOR ONE CPU ONLY                          @G24LB02*/
*/*                FOR A MULTIPROCESSOR IPL, ISSUES IT       @G24LB02*/
*/*                FOR BOTH HOSTS IN A SPECIAL VERSION OF    @G24LB02*/
*/*                THE INITIALIZE                            @G24LB02*/
*/*                INTERROGATES REASON CODE --               @G24LB02*/
*/*                -- IF THE INTERFACE WAS ALREADY           @G24LB02*/
*/*                INITIALIZED, ZEROES THE REASON CODE,      @G24LB02*/
*/*               SINCE THIS IS AN ACCEPTABLE CIRCUMSTANCE.  @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT:       REASON CODE FROM INITIALIZE               @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0589
*INITLIZE:                                                         0589
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* INITIALIZE       @G24LB02*/
INITLIZE DS    0H                                                  0590
*   DCL                                                            0590
*     INLZRET POINTER(31);          /* FOR RETURN ADDRESS    @G24LB02*/
*   RFY                                                            0591
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
*   INLZRET=R14;                    /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,INLZRET                                         0592
*   RFY                                                            0593
*     R14 UNRSTD;                   /* FREE UP REGISTER 14   @G24LB02*/
*   FAILCODE=ALLCLEAN;              /* START OFF WITH GOOD INDICATOR
*                                                            @G24LB02*/
         SLR   @15,@15                                             0594
         ST    @15,FAILCODE                                        0594
*   RFY                                                            0595
*    (R0,                                                          0595
*     R1,                                                          0595
*     R15) RSTD;                    /* RESTRICT 0 AND 15     @G24LB02*/
*   IF CVTNIP=OFF THEN              /*                       @G24LB02*/
         L     @14,CVTPTR                                          0596
         TM    CVTNIP(@14),B'00010000'                             0596
         BNZ   @RF00596                                            0596
*     DO;                           /*                       @G24LB02*/
*LOADPM:                                                           0598
*       GEN REFS(LOADER2) SETS(R0);                                0598
LOADPM   DS    0H                                                  0598
*                                                          /*@G24LB02*/
   LOAD EP=IECVIOPM,ERRET=LOADER2,RELATED=(IECVIOPM,ICBMSG05(INITLIZE))
*       R15=R0;                     /* LOAD 15 WITH ENTRY POINT FOR
*                                      PM                    @G24LB02*/
         LR    R15,R0                                              0599
*       R1=ADDR(PARMS);             /* R1 POINTS TO PARAMETER LIST 0600
*                                                            @G24LB02*/
         LA    R1,PARMS                                            0600
*       PARMS=''B;                  /* CLEAR THE PARAMETER AREA    0601
*                                                            @G24LB02*/
         XC    PARMS(8),PARMS                                      0601
*       UPTR=ICBPUCB;               /* PUT UCB PTR IN PARMS AREA   0602
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          0602
         L     @14,CVTEXT2(,@14)                                   0602
         L     @14,CVTICB(,@14)                                    0602
         L     @14,ICBPUCB(,@14)                                   0602
         STCM  @14,7,UPTR                                          0602
*       ICBPUCB->UCBPPA=OFF;        /* MAKE SECONDY AVAIL,CPU(0)   0603
*                                                            @G24LB02*/
*       ICBPUCB->UCBPPB=OFF;        /* MAKE PRIMARY AVAILABLE,CPU(1)
*                                                            @G24LB02*/
         NI    UCBPPA(@14),B'01011111'                             0604
*       ICBPUCB->UCBVALPH=ON;       /*                       @G24LB02*/
         OI    UCBVALPH(@14),B'00000010'                           0605
*       GEN REFS(R14,R15);                                         0606
*                                                          /*@G24LB02*/
            BALR  R14,R15                                      @G24LB02
*       RFY                                                        0607
*        (R1) UNRSTD;               /*                       @G24LB02*/
*       IF R15='04'X THEN                                          0608
         CH    R15,@CH01979                                        0608
         BNE   @RF00608                                            0608
*         R0='F0'X;                 /* SETUP REAS CDE F0     @G24LB02*/
         LA    R0,240                                              0609
*       IF R15='08'X THEN                                          0610
@RF00608 CH    R15,@CH01981                                        0610
         BNE   @RF00610                                            0610
*         R0='F5'X;                 /* SETUP REAS CDE F5     @G24LB02*/
         LA    R0,245                                              0611
*       IF R15>'08'X THEN                                          0612
@RF00610 CH    R15,@CH01981                                        0612
         BNH   @RF00612                                            0612
*         R0='FB'X;                 /* SETUP REAS CDE FB     @G24LB02*/
         LA    R0,251                                              0613
*       R0SAVE=R0;                  /* SAVE REGISTER 0       @G24LB02*/
@RF00612 ST    R0,R0SAVE                                           0614
*       R15SAVE=R15;                /* SAVE REGISTER 15      @G24LB02*/
         ST    R15,R15SAVE                                         0615
*       GEN;                                                       0616
*                                                          /*@G24LB02*/
DELETEPM  DELETE EP=IECVIOPM,RELATED=(IECVIOPM,ICBMSG05(INITLIZE))
*       R0=R0SAVE;                  /* RESTORE REGISTER 0    @G24LB02*/
         L     R0,R0SAVE                                           0617
*       R15=R15SAVE;                /* RESTORE REGISTER 15   @G24LB02*/
         L     R15,R15SAVE                                         0618
*       ICBPUCB->UCBQISCE=OFF;      /* SET OFF QUISCE FLAG   @G24LB02*/
         L     @14,CVTPTR                                          0619
         L     @01,CVTEXT2(,@14)                                   0619
         L     @01,CVTICB(,@01)                                    0619
         L     @01,ICBPUCB(,@01)                                   0619
         NI    UCBQISCE(@01),B'11111110'                           0619
*       GOTO LOADGD;                /*                       @G24LB02*/
*                                                                  0620
         B     LOADGD                                              0620
*       /*************************************************************/
*       /*                                                           */
*       /* THIS CODE WILL BE EXECUTED IF THE IEAVIOPM LOAD FAILD     */
*       /*                                                   @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0621
*LOADER2:                                                          0621
*       DO;                         /* NO PATH AVAILIBLE     @G24LB02*/
LOADER2  DS    0H                                                  0622
*         R15='04'X;                /* PUT RETURN CODE IN REG 15   0622
*                                                            @G24LB02*/
         LA    R15,4                                               0622
*         R0='F0'X;                 /* CC=3, NO PATH AVAILABLE     0623
*                                                            @G24LB02*/
         LA    R0,240                                              0623
*       END;                        /*                       @G24LB02*/
*     END;                          /*                       @G24LB05*/
*LOADGD:                            /*                       @G24LB02*/
*   IF ICBMSCMP=ON&                 /* IS THIS A MP SYSTEM   @G24LB05*/
*       R15=GOODIO THEN             /* AND IS I/O OK         @G24LB05*/
@RF00596 DS    0H                                                  0626
LOADGD   L     @14,CVTPTR                                          0626
         L     @01,CVTEXT2(,@14)                                   0626
         L     @01,CVTICB(,@01)                                    0626
         TM    ICBMSCMP(@01),B'00000100'                           0626
         BNO   @RF00626                                            0626
         LTR   R15,R15                                             0626
         BNZ   @RF00626                                            0626
*     DO;                           /* TIGHTLY COUPLED FORM OF INIT
*                                                            @G24LB05*/
*       AIRCPUS=ON;                 /* SPECIFY TWO PROCESSORS      0628
*                                                            @G24LB05*/
         OI    AIRCPUS,B'01000000'                                 0628
*ICBPAI3:                                                          0629
*                                                                  0629
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO       @Y30LB02*/
*       /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00           @Y30LB02*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Y30LB02*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Y30LB02*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Y30LB02*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Y30LB02*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Y30LB02*/
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0629
*       RFY                                                        0629
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/
ICBPAI3  DS    0H                                                  0630
*       PAIRR1=ADDR(INITLIST);      /* SET PAIRR1 TO REQ BLOCK     0630
*                                                            @Y30LB02*/
         LA    PAIRR1,INITLIST                                     0630
*       AIRLL='08'X;                /* SET LENGTH FIELD      @Y30LB02*/
         LA    @14,8                                               0631
         ST    @14,AIRLL                                           0631
*       AIROP='10'X;                /* INITL OPCODE          @Y30LB02*/
         MVI   AIROP,X'10'                                         0632
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 0633
*       RFY                                                        0634
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02
*                                      FOR BOTH HOSTS        @G24LB05*/
*       IF R15^=GOODIO              /* CHECK REASON CODE     @G24LB05*/
*         THEN                      /* REASON CODE WAS NOT ZERO    0635
*                                                            @G24LB05*/
         LTR   R15,R15                                             0635
         BZ    @RF00635                                            0635
*         DO;                       /* CHECK FOR ANOTHER PERMISSIBLE
*                                      ONE                   @G24LB05*/
*           IF R0=FTY4 THEN         /* WAS MP ORDER REJECTED @G24LB05*/
         CH    R0,@CH02695                                         0637
         BNE   @RF00637                                            0637
*             DO;                   /* YES, TREAT AS UP      @G24LB05*/
*               R15=GOODIO;         /* CLEAN UP TO CONTINUE        0639
*                                      PROCESSING            @G24LB05*/
         SLR   R15,R15                                             0639
*               ICBMSCMP=OFF;       /* TURN OFF MP INDICATOR @G24LB05*/
*               ICBMSCA=ON;         /* INDICATE POSSIBLE AP  @G24LB05*/
         L     @14,CVTPTR                                          0641
         L     @01,CVTEXT2(,@14)                                   0641
         L     @01,CVTICB(,@01)                                    0641
         OI    ICBMSCA(@01),B'00000010'                            0641
         NI    ICBMSCMP(@01),B'11111011'                           0641
*             END;                  /* END UNI PROCESSOR     @G24LB05*/
*           ELSE                    /*                       @G24LB05*/
*             IF R0=INITBEFR THEN   /* INIT BEFORE           @G24LB05*/
         B     @RC00637                                            0643
@RF00637 C     R0,INITBEFR                                         0643
         BNE   @RF00643                                            0643
*               INITSW=ON;          /* SET SWITCH ON         @G24LB05*/
         OI    INITSW,B'00001000'                                  0644
*         END;                      /*                       @G24LB05*/
*       ELSE                                                       0646
*         ;                         /*                       @G24LB05*/
@RF00635 DS    0H                                                  0647
*     END;                          /*                       @G24LB05*/
@RC00635 DS    0H                                                  0648
*   IF ICBMSCMP=OFF&                /* IS THIS A UP SYSTEM   @G24LB05*/
*       R15=GOODIO THEN             /* AND IS I/O OK         @G24LB05*/
@RF00626 L     @14,CVTPTR                                          0648
         L     @01,CVTEXT2(,@14)                                   0648
         L     @01,CVTICB(,@01)                                    0648
         TM    ICBMSCMP(@01),B'00000100'                           0648
         BNZ   @RF00648                                            0648
         LTR   R15,R15                                             0648
         BNZ   @RF00648                                            0648
*     DO;                           /*                       @G24LB05*/
*       AIRCPUS=OFF;                /* SPECIFIY ONE PROCESSOR      0650
*                                                            @G24LB05*/
         NI    AIRCPUS,B'10111111'                                 0650
*IICBAIR2:                          /*                       @G24LB05*/
*                                                                  0651
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO       @Y30LB02*/
*       /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00           @Y30LB02*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Y30LB02*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Y30LB02*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Y30LB02*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Y30LB02*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Y30LB02*/
*       /* *******************************************************   */
*       /*                                                   @Y30LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0651
*       RFY                                                        0651
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/
IICBAIR2 DS    0H                                                  0652
*       PAIRR1=ADDR(INITLIST);      /* SET PAIRR1 TO REQ BLOCK     0652
*                                                            @Y30LB02*/
         LA    PAIRR1,INITLIST                                     0652
*       AIRLL='08'X;                /* SET LENGTH FIELD      @Y30LB02*/
         LA    @14,8                                               0653
         ST    @14,AIRLL                                           0653
*       AIROP='10'X;                /* INITL OPCODE          @Y30LB02*/
         MVI   AIROP,X'10'                                         0654
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 0655
*       RFY                                                        0656
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02*/
*                                                                  0656
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @G24LB05*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0657
*     END;                          /* SPECIAL PATH FOR 1 CPU ON   0657
*                                      INITIALIZE            @G24LB05*/
*   ELSE                                                           0658
*     ;                             /*                       @G24LB05*/
@RF00648 DS    0H                                                  0659
*   IF R15^=GOODIO                  /* CHECK REASON CODE     @G24LB02*/
*     THEN                          /* REASON CODE WAS NOT ZERO    0659
*                                                            @G24LB02*/
         LTR   R15,R15                                             0659
         BZ    @RF00659                                            0659
*     DO;                           /* CHECK FOR ANOTHER PERMISSIBLE
*                                      ONE                   @G24LB02*/
*       IF R0=INITBEFR              /* WAS THIS INTERFACE ALREADY  0661
*                                                            @G24LB02*/
*                                                                  0661
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZED?                                      @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0661
*         THEN                      /* YES, ALREADY INITIALIZED    0661
*                                                            @G24LB02*/
         C     R0,INITBEFR                                         0661
         BNE   @RF00661                                            0661
*         INITSW=ON;                /* FORGET IT, OK RETURN  @G24LB05*/
         OI    INITSW,B'00001000'                                  0662
*       ELSE                        /* UNEXPECTED INITIALIZE RETURN
*                                                            @G24LB02*/
*         FAILCODE=R0;              /* PASS UP INITIALIZE RETURN   0663
*                                                            @G24LB02*/
         B     @RC00661                                            0663
@RF00661 ST    R0,FAILCODE                                         0663
*     END;                          /* CHECKING OUT NONZERO REASON 0664
*                                      CODE                  @G24LB02*/
*   ELSE                            /* REASON CODE OK        @G24LB02*/
*     ;                             /* NO SPECIAL PROCESSING @G24LB02*/
@RF00659 DS    0H                                                  0666
*   RFY                                                            0666
*    (R0,                                                          0666
*     R15) UNRSTD;                  /* FREE UP ZERO AND FIFTEEN    0666
*                                                            @G24LB02*/
@RC00659 DS    0H                                                  0667
*   RFY                                                            0667
*     R14 RSTD;                     /* FOR RETURN USE        @G24LB02*/
*   R14=INLZRET;                    /* RESTORE RETURN ADDRESS      0668
*                                                            @G24LB02*/
         L     R14,INLZRET                                         0668
*   RFY                                                            0669
*     R14 UNRSTD;                   /* FOR BRANCH BACK       @G24LB02*/
*   END INITLIZE;                   /* END ONE TRY TO INITIALIZE ONE
*                                      MSC                   @G24LB02*/
@EL00004 DS    0H                                                  0670
@EF00004 DS    0H                                                  0670
@ER00004 BR    @14                                                 0670
*                                                                  0671
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*   TRYLI: SUBROUTINE OF ICBMSG05 WHICH TRIES TO SWITCH    @G24LB02*/
*/*         LOWER INTERFACE OF THE MSCS FOR USE IN THE CASE  @G24LB02*/
*/*         WHERE THERE ARE TWO MSCS SYSGENED AND AT LEAST   @G24LB02*/
*/*         ONE IS ON LINE, BUT NONE RESPONDS FAVORABLY TO   @G24LB02*/
*/*         THE INITIALIZE -- E.G. NEITHER IS A PRIMARY MSC  @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT: ADDRESS(ES) OF THE MSC UCB(S) IN IEAVNP19 CODE    @G24LB02*/
*/*        THE REASON CODE FROM THE INITIALIZE FOR EACH MSC  @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESSING:  FINDS OUT WHICH MSC, IF ANY, RESPONDED TO   @G24LB02*/
*/*        INITIALIZE WITH THE NO-LOWER-INTERFACE RETURN     @G24LB02*/
*/*        CODE.                                             @G24LB02*/
*/*        IF THIS IS PRESENT IN NEITHER, SETS CLEANUP CODE  @G24LB02*/
*/*        AND RETURNS FOR FAILURE PROCESSING.               @G24LB02*/
*/*        FOR WHICHEVER MSC HAD SUCH A REASON CODE,         @G24LB02*/
*/*        CONSTRUCTS THE CHANNEL PROGRAM AND I/O CONTROL    @G24LB02*/
*/*        BLOCKS TO ISSUE THE GET LOWER INTERFACE COMMAND   @G24LB02*/
*/*        TO THE MSC.                                       @G24LB02*/
*/*        ISSUES THE TAKE=LOWER-INTERFACE TO THAT MSC       @G24LB02*/
*/*        UPON COMPLETION OF THE GET-LOWER-INTERFACE,       @G24LB02*/
*/*        RETRIES THE INITIALIZE (VIA SVC) TO THAT MSC      @G24LB02*/
*/*        IF THIS INITIALIZE REASON CODE IS NOT SUCCESSFUL, @G24LB02*/
*/*        FAILURE PROCESSING IS REQUIRED FOR MSS INOP STATE.@G24LB02*/
*/*        IF THIS MSC NOW RETURNS AN OK CODE, IT IS THE     @G24LB02*/
*/*        PRIMARY MSC, AND TRYLI SETS UP THE PRIMARY AND    @G24LB02*/
*/*        ALTERNATE SLOTS IN THE MSSC CONTROL BLOCK TO      @G24LB02*/
*/*        REFLECT WHICH IS WHICH, AND TURNS ON THE FLAG IN  @G24LB02*/
*/*        THE MSSC CONTROL BLOCK WHICH MEANS INTERFACE(S)   @G24LB02*/
*/*        BETWEEN HOST(S) AND MSC(S) SUCCESSFULLY           @G24LB02*/
*/*        INITIALIZED, BEFORE RETURNING TO ITS CALLER       @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT: IN MSSC CONTROL BLOCK: ADDRESS OF PRIMARY AND   @G24LB02*/
*/*         ALTERNATE MSC (IF ANY), WHEN SUCCESSFUL, AND     @G24LB02*/
*/*         THE MSC-TO-HOST INTERFACE INITIALIZED BIT ON.    @G24LB02*/
*/*         IN CASE OF FAILURE TO GET A GOOD INITIALIZE      @G24LB02*/
*/*         RESPONSE, TRYLI SETS THE APPROPRIATE FAILURE     @G24LB02*/
*/*         AND CLEANUP CODES AND WRITE THE DETAILED         @G24LB02*/
*/*         INFORMATIONAL MESSAGE ABOUT MSSC                 @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0671
*TRYLI:                                                            0671
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* TRY LOWER        @G24LB02*/
TRYLI    DS    0H                                                  0672
*/*  ISSUE THE TAKE LOWER INTERFACE TO ANY MSC THAT RETURNED @G24LB02*/
*/*  THE NO-LOWER-INTERFACE CODE TO THE INITIALIZE, TO TRY   @G24LB02*/
*/*  TO GET AN MSC WITH WHICH TO WORK                        @G24LB02*/
*                                                                  0672
*   DCL                                                            0672
*     TRYRET POINTER(31);           /* FOR RETURN ADDRESS    @G24LB02*/
*   RFY                                                            0673
*     R14 RSTD;                     /* RESTRICT 14 FOR RETURN ADDRESS
*                                                            @G24LB02*/
*   TRYRET=R14;                     /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,TRYRET                                          0674
*   RFY                                                            0675
*     R14 UNRSTD;                   /* FREE UP 14 FOR USE    @G24LB02*/
*   NMESPTR=ADDR(NMSGST);           /* SETUP MESSAGE POINTER @G24LB02*/
         LA    @15,NMSGST                                          0676
         ST    @15,NMESPTR                                         0676
*   IF MSC1IRC=NLIRC                /* DID 1ST MSC SAY NO LOWER    0677
*                                      INTERF?               @G24LB02*/
*     THEN                          /* FIRST MSC IS CANDIDATE TO TAKE
*                                      SWITCH                @G24LB02*/
         L     @15,MSC1IRC                                         0677
         SLR   @14,@14                                             0677
         IC    @14,NLIRC                                           0677
         CR    @15,@14                                             0677
         BNE   @RF00677                                            0677
*     DO;                           /* FIRST MSC CAN USE LOWER INT 0678
*                                                            @G24LB02*/
*       ICBPUCB=MSCUCBA1;           /* FIRST MSC WILL BE PRIMARY   0679
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0679
         L     @01,CVTEXT2(,@01)                                   0679
         L     @15,CVTICB(,@01)                                    0679
         MVC   ICBPUCB(4,@15),MSCUCBA1                             0679
*       ICBAUCB=MSCUCBA2;           /* SECOND WILL BE ALTERNATE    0680
*                                                            @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA2                             0680
*       CALL BUILDBLK;              /* BUILD I/O CONTROL BLOCKS    0681
*                                                            @G24LB02*/
         BAL   @14,BUILDBLK                                        0681
*       IF CLEANCOD=ALLCLEAN THEN   /* TEST FOR ERROR        @G24LB02*/
         ICM   @15,15,CLEANCOD                                     0682
         BNZ   @RF00682                                            0682
*         DO;                       /* NO BLOCK BUILD ERROR CODE   0683
*                                                            @G24LB02*/
*           RFY                                                    0684
*            (R1,                                                  0684
*             R13,                                                 0684
*             R14,                                                 0684
*             R15) RSTD;            /* RESTRICT REGS FOR DRIVER    0684
*                                                            @G24LB02*/
*           R1=SRBPTR;              /* ADDR OF SRB JUST BUILT      0685
*                                                            @G24LB02*/
         L     R1,SRBPTR                                           0685
*           R13SAVE=R13;            /* SAVE OWN SAVEAREA ADDR      0686
*                                                            @G24LB02*/
         ST    R13,R13SAVE                                         0686
*           R13=ADDR(FESAVE);       /* SAVE AREA FOR DRVR TO USE   0687
*                                                            @G24LB02*/
         L     R13,DATACPTR                                        0687
         LA    R13,FESAVE(,R13)                                    0687
*           R15=ICBSIOP;            /* ADDRESS OF FRONT END OF MSSC
*                                                            @G24LB02*/
*                                                                  0688
         L     @11,CVTPTR                                          0688
         L     @11,CVTEXT2(,@11)                                   0688
         L     @11,CVTICB(,@11)                                    0688
         L     R15,ICBSIOP(,@11)                                   0688
*           /*********************************************************/
*           /*                                                       */
*           /* I/O DRIVER                                    @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0689
*           GEN(BALR 14,15)         /* GO OFF TO MSSC I/O DRIVER   0689
*                                                            @G24LB02*/
*           REFS(R14,R15)           /* FRONT END, THAT IS    @G24LB02*/
*               SETS(R15);          /* BRANCH TO MSSC I/O DRIVER   0689
*                                                            @G24LB02*/
         BALR 14,15
*           R13=R13SAVE;            /* RESTORE OWN SAVE AREA @G24LB02*/
         L     R13,R13SAVE                                         0690
*           RESPECIFY                                              0691
*            (R13,                                                 0691
*             R14) UNRESTRICTED;    /* DRIVER DONE           @G24LB02*/
*           IF R15^=ALLCLEAN        /* DID DRIVER NOT ISSUE I/O?   0692
*                                                            @G24LB02*/
*             THEN                  /* NO I/O WAS ISSUED     @G24LB02*/
         LTR   R15,R15                                             0692
         BZ    @RF00692                                            0692
*             DO;                   /* I/O DRIVER DID NOT ISSUE I/O
*                                                            @G24LB02*/
*               FAILCODE=R15;       /* PASS REASON TO CALLER @G24LB02*/
         ST    R15,FAILCODE                                        0694
*               RFY                                                0695
*                 R15 UNRSTD;       /* FREE UP REGISTER 15   @G24LB02*/
*               CLEANCOD=NOMSCNIT;  /* NO MSC WILL INITIALIZE      0696
*                                                            @G24LB02*/
         MVC   CLEANCOD(4),@CF02601                                0696
*               GOTO MSGPROC;       /*                       @G24LB02*/
         B     MSGPROC                                             0697
*             END;                  /* SOFTWARE CANNOT CORRECT THIS
*                                                            @G24LB02*/
*           ELSE                    /* FRONT END OF MSSC I/O DRIVER
*                                      ISSUED I/O            @G24LB02*/
*             DO;                   /* I/O DRIVER DID ISSUE I/O    0699
*                                                            @G24LB02*/
@RF00692 DS    0H                                                  0700
*               R1=ADDR(IOECB);     /* ECB IN THIS CODE      @G24LB02*/
         L     R1,DATACPTR                                         0700
*IWAIT1:                            /* 1ST ICBMSG05 USE OF WAIT MACRO
*                                                            @G24LB02*/
*               GEN(WAIT ECB=(R1))  /* ECB KNOWN TO DRIVER   @G24LB02*/
*               REFS(R1);           /* WAIT TO BE POSTED BY BACK END
*                                      OF                    @G24LB02*/
*                                                                  0701
IWAIT1   WAIT ECB=(R1)
*               /*****************************************************/
*               /*                                                   */
*               /* MSSC I/O DRIVER, AFTER I/O IS COMPLETE    @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0702
*               RFY                                                0702
*                 R1 UNRSTD;        /* FREE UP REGISTER ONE  @G24LB02*/
*                                                                  0702
*               /*****************************************************/
*               /*                                                   */
*               /* NOTE THAT THE ECB POST IS NOT CHECKED FOR THE TAKE*/
*               /*                                           @G24LB02*/
*               /* LOWER INTERFACE COMMAND BECAUSE THE MORE          */
*               /* INTERESTING                               @G24LB02*/
*               /* RETURN IS FROM THE SUBSEQUENT INITIALIZE. @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0703
*               CALL INITLIZE;      /* RE-TRY THE INITIALIZE, THIS 0703
*                                      MSC                   @G24LB02*/
         BAL   @14,INITLIZE                                        0703
*               MSC1IRC=FAILCODE;   /* A NEW REASON CODE FOR THIS MSC
*                                                            @G24LB02*/
         L     @15,FAILCODE                                        0704
         ST    @15,MSC1IRC                                         0704
*               IF MSC1IRC=GOODIO   /* DID INITIALIZE I/O COMPLETE 0705
*                                      OK?                   @G24LB02*/
*                 THEN              /* HAVE INITIALIZED      @G24LB02*/
         LTR   @15,@15                                             0705
         BNZ   @RF00705                                            0705
*                 DO;               /* PREPARE TO USE THIS MSC     0706
*                                                            @G24LB02*/
*                   ICBI=ON;        /* MARK CONTROL BLOCK, HAVE    0707
*                                      INITIALIZED           @G24LB02*/
         L     @01,CVTPTR                                          0707
         L     @01,CVTEXT2(,@01)                                   0707
         L     @01,CVTICB(,@01)                                    0707
         OI    ICBI(@01),B'10000000'                               0707
*                   IF MSCUCBA2->UCBONLI=ON/* WAS OTHER MSC ON LINE?
*                                                            @G24LB02*/
*                     THEN          /* YES, STILL IN A BAD MOOD    0708
*                                                            @G24LB02*/
         L     @01,MSCUCBA2                                        0708
         TM    UCBONLI(@01),B'10000000'                            0708
         BNO   @RF00708                                            0708
*                     DO;           /* TELL OPERATOR ITS TROUBLES  0709
*                                                            @G24LB02*/
*                       PLACCONV=MSC2IRC;/* REASON INTO CONVERSION 0710
*                                      PLACE                 @G24LB02*/
         MVC   PLACCONV(4),MSC2IRC                                 0710
*                       RESPECIFY                                  0711
*                         R0 RESTRICTED;/* FOR CONVERSION    @G24LB02*/
*                       CALL RCTOEBC;/* CONVERT FROM HEX TO EBCDIC 0712
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0712
*                       RESPECIFY                                  0713
*                         R0 UNRESTRICTED;/* CONVERSION OVER @G24LB02*/
*                       NITFRC=PLAC234;/* EBCDIC CODE INTO MESSAGE 0714
*                                                            @G24LB02*/
         MVC   NITFRC(3),PLAC234                                   0714
*                       NITFMSC=MSCUCBA2->UCBNAME;/* UNIT ADDR INTO
*                                      MSG                   @G24LB02*/
         L     @15,MSCUCBA2                                        0715
         MVC   NITFMSC(3),UCBNAME(@15)                             0715
*                       MSCUCBA2->UCBONLI=OFF;/* SET UCB OFFLINE   0716
*                                                            @G24LB02*/
         NI    UCBONLI(@15),B'01111111'                            0716
*                       IF CVTNIP=ON THEN/* TEST FOR NIP IN CTL    0717
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0717
         TM    CVTNIP(@01),B'00010000'                             0717
         BNO   @RF00717                                            0717
*                         DO;       /* NIP IN CONTROL CODE   @G24LB02*/
*IIEAPMN5:                          /* 5TH USE OF IEAPMNIP BY      0719
*                                      ICBMSG05              @G24LB02*/
*                           GEN(IEAPMNIP TYPE=WTO,PARAM=NITMSGH)/* 0719
*                                      WRITE STORY           @G24LB02*/
*                           REFS(NVTWTO,NITMSGH);/* TO OPERATOR    0719
*                                                            @G24LB02*/
IIEAPMN5 IEAPMNIP TYPE=WTO,PARAM=NITMSGH
*                         END;      /* END NIP IN CONTROL CODE     0720
*                                                            @G24LB02*/
*                       ELSE        /* NIP NOT IN CONTROL    @G24LB02*/
*                         DO;       /* NIP NOT IN CONTROL CODE     0721
*                                                            @G24LB02*/
         B     @RC00717                                            0721
@RF00717 DS    0H                                                  0722
*                           WTOGEN03=MSG321;/* PRIME WTO BUFFER    0722
*                                                            @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0722
*                           WTOGEN03(16:18)=NITFMSC;/* PUT IN MSC  0723
*                                      UNIT ADDR@G24LB02             */
         MVC   WTOGEN03+15(3),NITFMSC                              0723
*                           WTOGEN03(54:56)=NITFRC;/* PUT IN REASON
*                                      CODE                  @G24LB02*/
         MVC   WTOGEN03+53(3),NITFRC                               0724
*                           CALL ICBMSG45;/* CALL WTO SUB-ROUTINE  0725
*                                                            @G24LB02*/
         BAL   @14,ICBMSG45                                        0725
*                           MSCUCBA2->UCBONLI=OFF;/* SET UCB OFFLINE
*                                                            @G24LB02*/
         L     @01,MSCUCBA2                                        0726
         NI    UCBONLI(@01),B'01111111'                            0726
*                         END;      /* END NIP NOT IN CONTROL CODE 0727
*                                                            @G24LB02*/
*                     END;          /* STORIES ABOUT 2ND MSC PROBLEMS
*                                                            @G24LB02*/
*                   ELSE            /* OTHER MSC NOT ON LINE, NO   0729
*                                      BACKUP                @G24LB02*/
*                     ;             /* (A MESSAGE ABOUT THIS WRITTEN
*                                      BEFORE)               @G24LB02*/
@RF00708 DS    0H                                                  0730
*                 END;              /* PREPARING TO USE 1ST MSC,OK 0730
*                                                            @G24LB02*/
*               ELSE                /* TRIED FIRST MSC, BUT HAVE NOT
*                                      INITIALIZED           @G24LB02*/
*                 DO;               /* CLEANUP AND GET OUT, MSS    0731
*                                      INOPERATIVE           @G24LB02*/
         B     @RC00705                                            0731
@RF00705 DS    0H                                                  0732
*                   CLEANCOD=NOMSCNIT;/* WILL NOT TRY SECOND MSC IF
*                                                            @G24LB02*/
*                                                                  0732
         MVC   CLEANCOD(4),@CF02601                                0732
*                   /*************************************************/
*                   /*                                               */
*                   /* FIRST SAID NO LOWER INTERFACE BUT COULD       */
*                   /*                                       @G24LB02*/
*                   /* NOT TAKE IT                           @G24LB02*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0733
*                   GOTO MSGPROC;   /*                       @G24LB02*/
         B     MSGPROC                                             0733
*                 END;              /*                       @G24LB02*/
*             END;                  /* LOGIC WHERE I/O DRIVER ISSUED
*                                      THE I/O               @G24LB02*/
@RC00705 DS    0H                                                  0736
*         END;                      /* END GOOD BLOCK BUILD CODE   0736
*                                                            @G24LB02*/
*     END;                          /* ATTEMPT FOR FIRST MSC @G24LB02*/
*   ELSE                            /* FIRST MSC NOT WORTH TRYING  0738
*                                                            @G24LB02*/
*     IF MSC2IRC=NLIRC              /* COULD 2ND MSC USE LOWER INTF
*                                                            @G24LB02*/
*       THEN                        /* YES, IT SAID NO LOWER       0738
*                                      INTERFACE             @G24LB02*/
         B     @RC00677                                            0738
@RF00677 L     @15,MSC2IRC                                         0738
         SLR   @14,@14                                             0738
         IC    @14,NLIRC                                           0738
         CR    @15,@14                                             0738
         BNE   @RF00738                                            0738
*       DO;                         /* TRY TO TAKE LOWER INTERFACE 0739
*                                                            @G24LB02
*                                      FOR SECOND MSC        @G24LB02*/
*         ICBPUCB=MSCUCBA2;         /* SET 2ND MSC AS PRIMARY      0740
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0740
         L     @01,CVTEXT2(,@01)                                   0740
         L     @15,CVTICB(,@01)                                    0740
         MVC   ICBPUCB(4,@15),MSCUCBA2                             0740
*         ICBAUCB=MSCUCBA1;         /* THIS TIME 1ST IS ALTERNATE  0741
*                                                            @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA1                             0741
*         CALL BUILDBLK;            /* BUILD BLOCKS FOR I/O TO MSC 0742
*                                                            @G24LB02*/
         BAL   @14,BUILDBLK                                        0742
*         IF CLEANCOD=ALLCLEAN THEN /* TEST FOR ERROR        @G24LB02*/
         ICM   @15,15,CLEANCOD                                     0743
         BNZ   @RF00743                                            0743
*           DO;                     /* GOOD BLOCK BUILD CODE @G24LB02*/
*             RFY                                                  0745
*              (R1,                                                0745
*               R13,                                               0745
*               R14,                                               0745
*               R15) RSTD;          /* FOR DRIVER CALL       @G24LB02*/
*             R1=SRBPTR;            /* ADDR OF SRB JUST BUILT      0746
*                                                            @G24LB02*/
         L     R1,SRBPTR                                           0746
*             R13SAVE=R13;          /* SAVE OWN SAVEAREA ADDR      0747
*                                                            @G24LB02*/
         ST    R13,R13SAVE                                         0747
*             R13=ADDR(FESAVE);     /* SAVE AREA FOR DRVR TO USE   0748
*                                                            @G24LB02*/
         L     R13,DATACPTR                                        0748
         LA    R13,FESAVE(,R13)                                    0748
*             R15=ICBSIOP;          /* ADDRESS OF FRONT END OF MSSC
*                                                            @G24LB02*/
*                                                                  0749
         L     @11,CVTPTR                                          0749
         L     @11,CVTEXT2(,@11)                                   0749
         L     @11,CVTICB(,@11)                                    0749
         L     R15,ICBSIOP(,@11)                                   0749
*             /*******************************************************/
*             /*                                                     */
*             /* I/O DRIVER                                  @G24LB02*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0750
*             GEN(BALR 14,15)       /* BRANCH AWAY TO DRIVER FRONT 0750
*                                      END                   @G24LB02*/
*             REFS(R14,R15)         /*                       @G24LB02*/
*                 SETS(R15);        /* BRANCH TO MSSC I/O DRIVER   0750
*                                                            @G24LB02*/
         BALR 14,15
*             R13=R13SAVE;          /* RESTORE OWN SAVE AREA @G24LB02*/
         L     R13,R13SAVE                                         0751
*             RESPECIFY                                            0752
*              (R13) UNRESTRICTED;  /*                       @G24LB02*/
*             IF R15^=ALLCLEAN      /* DID DRIVER NOT ISSUE I/O?   0753
*                                                            @G24LB02*/
*               THEN                /* NO I/O WAS ISSUED     @G24LB02*/
         LTR   R15,R15                                             0753
         BZ    @RF00753                                            0753
*               DO;                 /* SAVE WHY I/O DRIVER DID NOT 0754
*                                      ISSUE I/O             @G24LB02*/
*                 FAILCODE=R15;     /* THIS WILL BE IN MSG   @G24LB02*/
         ST    R15,FAILCODE                                        0755
*                 RFY                                              0756
*                  (R14,                                           0756
*                   R15) UNRSTD;    /* FREE UP 14 AND 15     @G24LB02*/
*                 CLEANCOD=NOMSCNIT;/* NO MSC WILL INITIALIZE      0757
*                                                            @G24LB02*/
         MVC   CLEANCOD(4),@CF02601                                0757
*                 GOTO MSGPROC;     /*                       @G24LB02*/
         B     MSGPROC                                             0758
*               END;                /* NO I/O TO 2ND LOGIC   @G24LB02*/
*             ELSE                  /* I/O IS ON ITS WAY TO MSC    0760
*                                                            @G24LB02*/
*               DO;                 /* I/O DRIVER DID ISSUE I/O    0760
*                                                            @G24LB02*/
@RF00753 DS    0H                                                  0761
*                 R1=ADDR(IOECB);   /* ECB IN THIS CODE      @G24LB02*/
         L     R1,DATACPTR                                         0761
*IWAIT2:                            /* 2ND USE OF WAIT MACRO BY    0762
*                                      ICBMSG05              @G24LB02*/
*                 GEN(WAIT ECB=(R1))/* WAIT FOR I/O TO COMPLETE    0762
*                                                            @G24LB02*/
*                 REFS(R1);         /* WAIT TO BE POSTED BY THE    0762
*                                                            @G24LB02*/
*                                                                  0762
IWAIT2   WAIT ECB=(R1)
*                 /***************************************************/
*                 /*                                                 */
*                 /* BACK END OF THE MSSC I/O                @G24LB02*/
*                 /* DRIVER                                  @G24LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0763
*                 RFY                                              0763
*                   R1 UNRSTD;      /* FREE UP REGISTER ONE  @G24LB02*/
*                 CALL INITLIZE;    /* RE-TRY THE INITIALIZE, THIS 0764
*                                      MSC                   @G24LB02*/
         BAL   @14,INITLIZE                                        0764
*                 MSC2IRC=FAILCODE; /* A NEW REASON CODE FOR THIS MSC
*                                                            @G24LB02*/
         L     @15,FAILCODE                                        0765
         ST    @15,MSC2IRC                                         0765
*                 IF MSC2IRC=GOODIO /* WAS INITIALIZE OK?    @G24LB02*/
*                   THEN            /* HAVE INITIALIZED      @G24LB02*/
         LTR   @15,@15                                             0766
         BNZ   @RF00766                                            0766
*                   DO;             /* HAVE INITIALIZED AN MSC     0767
*                                                            @G24LB02*/
*                     ICBI=ON;      /* NOTE THAT IN MSSC CONTROL   0768
*                                      BLOCK                 @G24LB02*/
         L     @01,CVTPTR                                          0768
         L     @01,CVTEXT2(,@01)                                   0768
         L     @01,CVTICB(,@01)                                    0768
         OI    ICBI(@01),B'10000000'                               0768
*                     IF MSCUCBA1->UCBONLI=ON/* WAS OTHER MSC ON LINE
*                                      ?                     @G24LB02*/
*                       THEN        /* YES, TELL OPERATOR ITS      0769
*                                      TROUBLES              @G24LB02*/
         L     @01,MSCUCBA1                                        0769
         TM    UCBONLI(@01),B'10000000'                            0769
         BNO   @RF00769                                            0769
*                       DO;         /* SOMEONE WILL NEED TO KNOW   0770
*                                                            @G24LB02*/
*                         PLACCONV=MSC1IRC;/*                @G24LB02*/
         MVC   PLACCONV(4),MSC1IRC                                 0771
*                         RESPECIFY                                0772
*                           R0 RESTRICTED;/* FOR CONVERSION  @G24LB02*/
*                         CALL RCTOEBC;/* HEX TO EBCDIC      @G24LB02*/
         BAL   @14,RCTOEBC                                         0773
*                         RESPECIFY                                0774
*                           R0 UNRESTRICTED;/* CONVERSION OVER     0774
*                                                            @G24LB02*/
*                         NITFRC=PLAC234;/* EBCDIC CODE INTO MESSAGE
*                                                            @G24LB02*/
         MVC   NITFRC(3),PLAC234                                   0775
*                         NITFMSC=MSCUCBA1->UCBNAME;/* UNIT ADDR INTO
*                                      MSG                   @G24LB02*/
         L     @15,MSCUCBA1                                        0776
         MVC   NITFMSC(3),UCBNAME(@15)                             0776
*                         MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE 0777
*                                                            @G24LB02*/
         NI    UCBONLI(@15),B'01111111'                            0777
*                         IF CVTNIP=ON THEN/* TEST FOR NIP IN CTL  0778
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          0778
         TM    CVTNIP(@01),B'00010000'                             0778
         BNO   @RF00778                                            0778
*                           DO;     /* NIP IN CONTROL CODE   @G24LB02*/
*IIEAPMN6:                          /* 6TH USE OF IEAPPMNIP MACRO BY
*                                      ICBMSG05              @G24LB02*/
*                             GEN(IEAPMNIP TYPE=WTO,PARAM=NITMSGH)/*
*                                      WRITES                @G24LB02*/
*                             REFS(NVTWTO,NITMSGH);/* TO SYSTEM    0780
*                                      OPERATOR              @G24LB02*/
IIEAPMN6 IEAPMNIP TYPE=WTO,PARAM=NITMSGH
*                           END;    /* END NIP IN CONTROL CODE     0781
*                                                            @G24LB02*/
*                         ELSE      /* NIP NOT IN CONTROL    @G24LB02*/
*                           DO;     /* NIP NOT IN CONTROL CODE     0782
*                                                            @G24LB02*/
         B     @RC00778                                            0782
@RF00778 DS    0H                                                  0783
*                             WTOGEN03=MSG321;/* PRIME WTO BUFFER  0783
*                                                            @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0783
*                             WTOGEN03(16:18)=NITFMSC;/* PUT IN MSC
*                                      UNIT ADDR@G24LB02             */
         MVC   WTOGEN03+15(3),NITFMSC                              0784
*                             WTOGEN03(54:56)=NITFRC;/* PUT IN REASON
*                                      CODE                  @G24LB02*/
         MVC   WTOGEN03+53(3),NITFRC                               0785
*                             CALL ICBMSG45;/* CALL WTO SUB-ROUTINE
*                                                            @G24LB02*/
         BAL   @14,ICBMSG45                                        0786
*                             MSCUCBA1->UCBONLI=OFF;/* SET UCB     0787
*                                      OFFLINE               @G24LB02*/
         L     @01,MSCUCBA1                                        0787
         NI    UCBONLI(@01),B'01111111'                            0787
*                           END;    /* END NIP NOT IN CONTROL CODE 0788
*                                                            @G24LB02*/
*                       END;        /* STORIES ABOUT WRONG REASON  0789
*                                      CODE                  @G24LB02*/
*                     ELSE          /* NOT ONLINE AND HENCE NO BACKUP
*                                      MSC                   @G24LB02*/
*                       ;           /* (A MESSAGE ABOUT THIS WRITTEN
*                                      BEFORE)               @G24LB02*/
@RF00769 DS    0H                                                  0791
*                   END;            /* LOGIC WHERE HAVE INITIALIZED
*                                                            @G24LB02*/
*                 ELSE              /* HAVE NOT INITIALIZED  @G24LB02*/
*                   DO;             /* SET CLEANUP CODE      @G24LB02*/
         B     @RC00766                                            0792
@RF00766 DS    0H                                                  0793
*                     CLEANCOD=NOMSCNIT;/* WILL NOT TRY FIRST MSC IF
*                                                            @G24LB02*/
         MVC   CLEANCOD(4),@CF02601                                0793
*                     GOTO MSGPROC; /*                       @G24LB02*/
         B     MSGPROC                                             0794
*                   END;            /* NO I/O TO 2ND LOGIC   @G24LB02*/
*                                                                  0795
*                 /***************************************************/
*                 /*                                                 */
*                 /* SECOND SAID NO LOWER INTERFACE BUT COULD NOT    */
*                 /* TAKE IT                                 @G24LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0796
*               END;                /* CLEANUP SETTING       @G24LB02*/
@RC00766 DS    0H                                                  0797
*           END;                    /* LOGIC WHERE I/O ISSUED      0797
*                                                            @G24LB02*/
*         ELSE                                                     0798
*           ;                                                      0798
@RF00743 DS    0H                                                  0799
*       END;                        /* TRYING TO TAKE FOR 2ND      0799
*                                                            @G24LB02*/
*     ELSE                          /* NO NEED LOWER INTERFACE CODE,
*                                      NO HOPE FOR EITHER    @G24LB02*/
*       DO;                         /* PREPARE TO SHUTDOWN   @G24LB02*/
         B     @RC00738                                            0800
@RF00738 DS    0H                                                  0801
*         CLEANCOD=NOMSCNIT;        /* NO MSC INITIALIZES    @G24LB02*/
         MVC   CLEANCOD(4),@CF02601                                0801
*       END;                        /*                       @G24LB02*/
*MSGPROC:                                                          0803
*   IF CLEANCOD=NOMSCNIT THEN                                      0803
@RC00738 DS    0H                                                  0803
@RC00677 DS    0H                                                  0803
MSGPROC  CLC   CLEANCOD(4),@CF02601                                0803
         BNE   @RF00803                                            0803
*     DO;                                                          0804
*       IF CVTNIP=ON THEN           /*                       @G24LB02*/
         L     @01,CVTPTR                                          0805
         TM    CVTNIP(@01),B'00010000'                             0805
         BNO   @RF00805                                            0805
*         DO;                       /*                       @G24LB02*/
*           NMESNUM=INITMNUM;       /* NUMBER FOR INIT MESSAGE     0807
*                                                            @G24LB02*/
         L     @15,NMESPTR                                         0807
         MVC   NMESNUM(3,@15),INITMNUM                             0807
*           NMESTEXT(1:LENGTH(INITTEXT))=INITTEXT;/*         @G24LB02*/
*                                                                  0808
         MVC   NMESTEXT(58,@15),INITTEXT                           0808
*           /*********************************************************/
*           /*                                                       */
*           /* (FIRST LINE TEXT COMMON TO MSG FOR 1 OR 2 MSCS )      */
*           /*                                               @G24LB02*/
*           /* THE FOLLOWING TEST IS MADE WITH THE PREREQUISITE      */
*           /*                                               @G24LB02*/
*           /* THAT CONTROL NEVER COMES TO THIS STATEMENT IF ANY     */
*           /*                                               @G24LB02*/
*           /* MSC CAN BE MADE TO RETURN A SATISFACTORY RESPONSE     */
*           /*                                               @G24LB02*/
*           /* TO AN INITIALIZE. THE THROW SWITCH EFFORT HAS BEEN    */
*           /*                                               @G24LB02*/
*           /* MADE IF APPROPRIATE. THUS, THE TWO REASON CODES,      */
*           /*                                               @G24LB02*/
*           /* ZERO AT THE BEGINNING OF EXECUTION OF IEAVNP19,       */
*           /*                                               @G24LB02*/
*           /* INDICATE BY A NONZERO VALUE AT THIS TIME THAT THE     */
*           /*                                               @G24LB02*/
*           /* CORRESPONDING MSC HAD A BAD RESPONSE TO INITIALIZE.   */
*           /*                                               @G24LB02*/
*           /* IF THE CORRESPONDING MSC WAS OFF LINE, NO EFFORT      */
*           /*                                               @G24LB02*/
*           /* WOULD HAVE BEEN MADE TO INITIALIZE IT.        @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0809
*           IF MSC1IRC^=GOODIO&MSC2IRC^=GOODIO/* 2 BAD INITIALIZES?
*                                                            @G24LB02*/
*             THEN                  /* 2 BAD INITIALIZES     @G24LB02*/
         L     @14,MSC1IRC                                         0809
         SLR   @11,@11                                             0809
         CR    @14,@11                                             0809
         BE    @RF00809                                            0809
         C     @11,MSC2IRC                                         0809
         BE    @RF00809                                            0809
*             DO;                   /* BUILD SAME MESSAGE FOR BOTH 0810
*                                                            @G24LB02*/
*               TWOLINER=ON;        /* INDICATE 2 LINES IN MESSAGE 0811
*                                                            @G24LB02*/
*                                                                  0811
         OI    TWOLINER,B'10000000'                                0811
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE UNIT NAME OF FIRST MSC INTO MESSAGE  @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0812
*               NMESTEXT(42:44)=MSCUCBA1->UCBNAME;/* 1ST UNIT      0812
*                                      NAME@G24LB02                  */
         L     @11,MSCUCBA1                                        0812
         MVC   NMESTEXT+41(3,@15),UCBNAME(@11)                     0812
*               PLACCONV=MSC1IRC;   /* 1ST MSC REASONCODE TO       0813
*                                      CONVERSION            @G24LB02*/
         ST    @14,PLACCONV                                        0813
*               MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE     @G24LB02*/
         NI    UCBONLI(@11),B'01111111'                            0814
*               RESPECIFY                                          0815
*                 R0 RESTRICTED;    /* FOR CONVERSION        @G24LB02*/
*               CALL RCTOEBC;       /* CONVERT FIRST MSC REASON CODE
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0816
*               RESPECIFY                                          0817
*                 R0 UNRESTRICTED;  /* CONVERSION OVER       @G24LB02*/
*               NMESTEXT(56:58)=PLAC234;/* REAS CODE         @G24LB02*/
*                                                                  0818
         L     @01,NMESPTR                                         0818
         MVC   NMESTEXT+55(3,@01),PLAC234                          0818
*               /*****************************************************/
*               /*                                                   */
*               /* PREPARE SECOND LINE OF MESSAGE            @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0819
*               NMESPTR=ADDR(NMSST2);/* START OF 2ND LINE    @G24LB02*/
         LA    @15,NMSST2                                          0819
         ST    @15,NMESPTR                                         0819
*               NMESNUM=INITMNUM;   /* SAME MESSAGE ID TO 2ND LINE 0820
*                                                            @G24LB02*/
*                                                                  0820
         MVC   NMESNUM(3,@15),INITMNUM                             0820
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE TEXT FOR 2ND LINE INTO BUFFER FOR 2ND LINE   */
*               /*                                           @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0821
*               NMESTEXT(1:LENGTH(INIT2TXT))/* TEXT OF 2ND LINE    0821
*                                                            @G24LB02*/
*                   =INIT2TXT;      /* TEXT FOR DESCRIBING 2ND FAIL
*                                                            @G24LB02*/
*                                                                  0821
         MVC   NMESTEXT(23,@15),INIT2TXT                           0821
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE UNIT NAME OF SECOND MSC INTO MESSAGE @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0822
*               NMESTEXT(INIT2UAP:INIT2UAP+UALGM1)/* 2ND MSC UNIT  0822
*                                                            @G24LB02*/
*                   =MSCUCBA2->UCBNAME;/* INTO MSG           @G24LB02*/
         L     @14,MSCUCBA2                                        0822
         MVC   NMESTEXT+8(3,@15),UCBNAME(@14)                      0822
*               PLACCONV=MSC2IRC;   /* 2ND CODE INTO CONVERSION PLACE
*                                                            @G24LB02*/
         MVC   PLACCONV(4),MSC2IRC                                 0823
*               RESPECIFY                                          0824
*                 R0 RESTRICTED;    /* FOR CONVERSION        @G24LB02*/
*               CALL RCTOEBC;       /* CONVERTS FOR SECOND MSC     0825
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0825
*               RESPECIFY                                          0826
*                 R0 UNRESTRICTED;  /* CONVERSION OVER       @G24LB02*/
*               NMESTEXT(INIT2RCP:INIT2RCP+RCLM1)=PLAC234;/* REAS  0827
*                                      CODE                  @G24LB02*/
         L     @01,NMESPTR                                         0827
         MVC   NMESTEXT+22(3,@01),PLAC234                          0827
*               MSCUCBA2->UCBONLI=OFF;/* SET UCB OFFLINE     @G24LB02*/
         L     @01,MSCUCBA2                                        0828
         NI    UCBONLI(@01),B'01111111'                            0828
*               GOTO IIEAPMNF;      /* MESSAGE HAS BEEN BUILT      0829
*                                                            @G24LB02*/
         B     IIEAPMNF                                            0829
*             END;                  /* LOGIC FOR TWO BAD INITIALIZE
*                                      RETURNS               @G24LB02*/
*           ELSE                    /* NOT TWO BAD INITIALIZES, JUST
*                                      ONE                   @G24LB02*/
*             ;                     /*                       @G24LB02*/
@RF00809 DS    0H                                                  0832
*           IF MSC1IRC^=GOODIO      /* WAS FAILURE ONLY ON 1ST MSC?
*                                                            @G24LB02*/
*             THEN                  /* FAILURE ON 1ST MSC ONLY     0832
*                                                            @G24LB02*/
         L     @15,MSC1IRC                                         0832
         LTR   @15,@15                                             0832
         BZ    @RF00832                                            0832
*             DO;                   /* PUT 1ST MSC UNIT INTO MSG   0833
*                                                            @G24LB02*/
*               NMESTEXT(42:44)=MSCUCBA1->UCBNAME;/*         @G24LB02*/
         L     @01,NMESPTR                                         0834
         L     @14,MSCUCBA1                                        0834
         MVC   NMESTEXT+41(3,@01),UCBNAME(@14)                     0834
*               PLACCONV=MSC1IRC;   /* READY TO CONVERT CODE @G24LB02*/
         ST    @15,PLACCONV                                        0835
*               RESPECIFY                                          0836
*                 R0 RESTRICTED;    /* FOR CONVERSION        @G24LB02*/
*               CALL RCTOEBC;       /* CODE FROM HEX TO EBCDIC     0837
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0837
*               RESPECIFY                                          0838
*                 R0 UNRESTRICTED;  /* CONVERSION OVER       @G24LB02*/
*               NMESTEXT(56:58)=PLAC234;/* REASON CODE       @G24LB02*/
         L     @01,NMESPTR                                         0839
         MVC   NMESTEXT+55(3,@01),PLAC234                          0839
*               MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE     @G24LB02*/
         L     @01,MSCUCBA1                                        0840
         NI    UCBONLI(@01),B'01111111'                            0840
*               GOTO IIEAPMNF;      /* LEAVE SEGMENT--ONLY 1 MSG PER
*                                      CALL                  @G24LB02*/
         B     IIEAPMNF                                            0841
*             END;                  /* DID MSG FOR INITLZ FAILURE ON
*                                      1ST MSC ONLY          @G24LB02*/
*           ELSE                    /* INITIALIZE FAILURE IN 2ND MSC
*                                      ONLY                  @G24LB02*/
*             DO;                   /* BUILD SAME MESSAGE, OTHER MSC
*                                                            @G24LB02*/
*                                                                  0843
@RF00832 DS    0H                                                  0844
*               /*****************************************************/
*               /*                                                   */
*               /* NOTE WHEN ONLY SECOND WAS ON LINE, YET FAILED,    */
*               /* THIS                                      @G24LB02*/
*               /* INFO GOES INTO THE FIRST POSITION IN THE MESSAGE, */
*               /*                                           @G24LB02*/
*               /* WHICH IS THE SHORT FORM                   @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0844
*               NMESTEXT(42:44)=MSCUCBA2->UCBNAME;/*         @G24LB02*/
         L     @01,NMESPTR                                         0844
         L     @15,MSCUCBA2                                        0844
         MVC   NMESTEXT+41(3,@01),UCBNAME(@15)                     0844
*               PLACCONV=MSC2IRC;   /* REASON TO CONVERTING PLACE  0845
*                                                            @G24LB02*/
         MVC   PLACCONV(4),MSC2IRC                                 0845
*               RESPECIFY                                          0846
*                 R0 RESTRICTED;    /* FOR CONVERSION        @G24LB02*/
*               CALL RCTOEBC;       /* CONVERTS FROM HEX TO EBCDIC 0847
*                                                            @G24LB02*/
         BAL   @14,RCTOEBC                                         0847
*               RESPECIFY                                          0848
*                 R0 UNRESTRICTED;  /* CONVERSION OVER       @G24LB02*/
*               NMESTEXT(56:58)=PLAC234;/* REASON CODE TO MSG      0849
*                                                            @G24LB02*/
         L     @01,NMESPTR                                         0849
         MVC   NMESTEXT+55(3,@01),PLAC234                          0849
*               MSCUCBA2->UCBONLI=OFF;/* SET UCB OFFLINE     @G24LB02*/
         L     @01,MSCUCBA2                                        0850
         NI    UCBONLI(@01),B'01111111'                            0850
*               GOTO IIEAPMNF;      /* LEAVE MESSAGE BUILDING SEGMENT
*                                                            @G24LB02*/
         B     IIEAPMNF                                            0851
*             END;                  /* HAVE BUILT MSG FOR 2ND MSC  0852
*                                      ONLY                  @G24LB02*/
*IIEAPMNF:                                                         0853
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*             @G24LB02*/
*           REFS(NVTWTO,NMSGH);     /* OPERATOR SHOWN ONE LINE     0853
*                                                            @G24LB02*/
IIEAPMNF IEAPMNIP TYPE=WTO,PARAM=NMSGH
*           IF TWOLINER=ON THEN     /* IS THERE A SECOND LINE OF MSG
*                                                            @G24LB02*/
         TM    TWOLINER,B'10000000'                                0854
         BNO   @RF00854                                            0854
*             DO;                                                  0855
*IIEAPMNG:                                                         0856
*               GEN(IEAPMNIP TYPE=WTO,PARAM=NMSH2)/*         @G24LB02*/
*               REFS(NVTWTO,NMSH2); /* OPERATOR SHOWN 2ND LINE     0856
*                                                            @G24LB02*/
IIEAPMNG IEAPMNIP TYPE=WTO,PARAM=NMSH2
*             END;                                                 0857
*           ELSE                                                   0858
*             ;                                                    0858
@RF00854 DS    0H                                                  0859
*         END;                                                     0859
*       ELSE                                                       0860
*         DO;                       /*                       @G24LB02*/
         B     @RC00805                                            0860
@RF00805 DS    0H                                                  0861
*           IF MSC1IRC^=GOODIO THEN                                0861
         L     @15,MSC1IRC                                         0861
         LTR   @15,@15                                             0861
         BZ    @RF00861                                            0861
*             DO;                   /*                       @G24LB02*/
*               PLACCONV=MSC1IRC;   /* REASON CODE FOR PUCB  @G24LB02*/
         ST    @15,PLACCONV                                        0863
*               CALL RCTOEBC;       /* TRANSL REAS CODE      @G24LB02*/
         BAL   @14,RCTOEBC                                         0864
*               MSG321F(16:18)=MSCUCBA1->UCBNAME;/* PUT UCB IN MSG 0865
*                                                            @G24LB02*/
         L     @15,MSCUCBA1                                        0865
         MVC   MSG321F+15(3),UCBNAME(@15)                          0865
*               MSCUCBA1->UCBONLI=OFF;/* SET UCB OFFLINE     @G24LB02*/
         NI    UCBONLI(@15),B'01111111'                            0866
*               WTOGEN03=MSG321;    /* LOAD MSG BUFFER W/321 MSG   0867
*                                                            @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0867
*               WTOGEN03(54:56)=PLAC234;/* PUT REASON CODE IN MSG  0868
*                                                            @G24LB02*/
         MVC   WTOGEN03+53(3),PLAC234                              0868
*               CALL ICBMSG45;      /* WRITE THE MESSAGE     @G24LB02*/
         BAL   @14,ICBMSG45                                        0869
*               WTOGEN03=MSG320;    /* LOAD MSG BUFFER W/320 MSG   0870
*                                                            @G24LB02*/
         MVI   WTOGEN03+51,C' '                                    0870
         MVC   WTOGEN03+52(21),WTOGEN03+51                         0870
         MVC   WTOGEN03(51),MSG320                                 0870
*               CALL ICBMSG45;      /* WRITE THE MESSAGE     @G24LB02*/
         BAL   @14,ICBMSG45                                        0871
*             END;                  /* PROCESSING IF 1 MSC ON LINE 0872
*                                                            @G24LB02*/
*           ELSE                                                   0873
*             IF MSC2IRC^=GOODIO THEN                              0873
         B     @RC00861                                            0873
@RF00861 L     @15,MSC2IRC                                         0873
         LTR   @15,@15                                             0873
         BZ    @RF00873                                            0873
*               DO;                 /*                       @G24LB02*/
*                 PLACCONV=MSC2IRC; /* REASON CODE FOR PUCB  @G24LB02*/
         ST    @15,PLACCONV                                        0875
*                 CALL RCTOEBC;     /* TRANSL REAS CODE      @G24LB02*/
         BAL   @14,RCTOEBC                                         0876
*                 MSG321F(16:18)=MSCUCBA2->UCBNAME;/* PUT UCB IN MSG
*                                                            @G24LB02*/
         L     @15,MSCUCBA2                                        0877
         MVC   MSG321F+15(3),UCBNAME(@15)                          0877
*                 MSCUCBA2->UCBONLI=OFF;/* SET UCB OFFLINE   @G24LB02*/
         NI    UCBONLI(@15),B'01111111'                            0878
*                 WTOGEN03=MSG321;  /* LOAD MSG BUFFER W/321 MSG   0879
*                                                            @G24LB02*/
         MVC   WTOGEN03(73),MSG321                                 0879
*                 WTOGEN03(54:56)=PLAC234;/* PUT REASON CODE IN MSG
*                                                            @G24LB02*/
         MVC   WTOGEN03+53(3),PLAC234                              0880
*                 CALL ICBMSG45;    /* WRITE THE MESSAGE     @G24LB02*/
         BAL   @14,ICBMSG45                                        0881
*                 WTOGEN03=MSG320;  /* LOAD MSG BUFFER W/320 MSG   0882
*                                                            @G24LB02*/
         MVI   WTOGEN03+51,C' '                                    0882
         MVC   WTOGEN03+52(21),WTOGEN03+51                         0882
         MVC   WTOGEN03(51),MSG320                                 0882
*                 CALL ICBMSG45;    /* WRITE THE MESSAGE     @G24LB02*/
         BAL   @14,ICBMSG45                                        0883
*               END;                /* PROCESSING IF 1 MSC ON LINE 0884
*                                                            @G24LB02*/
*         END;                      /*                       @G24LB02*/
@RF00873 DS    0H                                                  0885
@RC00861 DS    0H                                                  0886
*     END;                          /*                       @G24LB02*/
@RC00805 DS    0H                                                  0887
*   ICBPUCB=MSCUCBA1;               /* RESTORE PRIMARY UCB   @G24LB02*/
@RF00803 L     @01,CVTPTR                                          0887
         L     @01,CVTEXT2(,@01)                                   0887
         L     @15,CVTICB(,@01)                                    0887
         MVC   ICBPUCB(4,@15),MSCUCBA1                             0887
*   ICBAUCB=MSCUCBA2;               /* RESTORE ALTERNATE UCB @G24LB02*/
         MVC   ICBAUCB(4,@15),MSCUCBA2                             0888
*   IF GMFLAG=ON THEN               /* WAS GETMAIN SUCCESSFUL      0889
*                                                            @G24LB02*/
         TM    GMFLAG,B'00010000'                                  0889
         BNO   @RF00889                                            0889
*     DO;                           /* FREEMAIN CODE         @G24LB02*/
*       RFY                                                        0891
*        (R0,                                                      0891
*         R1,                                                      0891
*         R14,                                                     0891
*         R15) RSTD;                /*                       @G24LB02*/
*       R0=LENGTH(BSRB)+LENGTH(BIOSB)+LENGTH(DATACHAN);/*    @G24LB02*/
         LA    R0,328                                              0892
*       R1=DATACPTR;                /* AREA REG 1 FOR FREEMAIN     0893
*                                                            @G24LB02*/
         L     R1,DATACPTR                                         0893
*       R15=SP245;                  /* SET SUB POOL ID IN REG 15   0894
*                                                            @G24LB02*/
         LA    R15,245                                             0894
*IFREEMA1:                          /* FREEMAIN LABEL        @G24LB02*/
*       GEN REFS(R0,R1,R15) SETS(R0,R1,R15);                       0895
IFREEMA1 DS    0H                                                  0895
*                                        /* GEN FOR FREEMAIN @G24LB02*/
         FREEMAIN RC,LV=(R0),SP=(R15),A=(R1),                          *
                RELATED=('IGETMAI1')                           @G24LB02
*       RFY                                                        0896
*        (R0,                                                      0896
*         R1,                                                      0896
*         R14,                                                     0896
*         R15) RSTD;                /*                       @G24LB02*/
*     END;                          /* END FREEMAIN CODE     @G24LB02*/
*   RFY                                                            0898
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
@RF00889 DS    0H                                                  0899
*   R14=TRYRET;                     /* RESTORE RETURN ADDRESS      0899
*                                                            @G24LB02*/
         L     R14,TRYRET                                          0899
*   RFY                                                            0900
*     R14 UNRSTD;                   /* FOR BRANCH BACK       @G24LB02*/
*   END TRYLI;                      /* IF HAVENT INITIALIZED NOW,  0901
*                                      WONT                  @G24LB02*/
@EL00005 DS    0H                                                  0901
@EF00005 DS    0H                                                  0901
@ER00005 BR    @14                                                 0901
*                                                                  0902
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*   BUILDBLK:  BUILDS I/O BLOCKS FOR TAKE LOWER INTERFACE  @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:   BLOCKS IN THE MAIN SEGMENT FOR I/O              @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESSING:  BUILD I/O CONTROL BLOCKS AND CCWS TO ISSUE  @G24LB02*/
*/*          THE TAKE LOWER INTERFACE TO THE MSC             @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  CONTROL BLOCKS, CCWS AND MSSC DATA AREAS        @G24LB02*/
*/*           SRBPTR HAS THE ADDRESS OF THE SRB TO BE USED   @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0902
*BUILDBLK:                                                         0902
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* FOR I/O          @G24LB02*/
BUILDBLK DS    0H                                                  0903
*   DCL                                                            0903
*     BUILD14 POINTER(31);          /* FOR RETURN ADDRESS    @G24LB02*/
*   RFY                                                            0904
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
*   BUILD14=R14;                    /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,BUILD14                                         0905
*   RFY                                                            0906
*     R14 UNRSTD;                   /* FREE UP 14            @G24LB02*/
*   NMESPTR=ADDR(NMSGST);           /*                       @G24LB02*/
*                                                                  0907
         LA    @14,NMSGST                                          0907
         ST    @14,NMESPTR                                         0907
*   /*****************************************************************/
*   /*                                                               */
*   /* SRBPTR, IN THE MAIN SEGMENT, IS HERE GIVEN THE        @G24LB02*/
*   /* ADDRESS OF THE SRB WHICH IS INCLUDED IN THE MAIN      @G24LB02*/
*   /* SEGMENT, ALONG WITH AN IOSB AND AN MSSC DATA AREA,    @G24LB02*/
*   /* OTHERWISE KNOWN AS THE MSSC IOSB EXTENSION AREA       @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0908
*   RFY                                                            0908
*    (R0,                                                          0908
*     R1,                                                          0908
*     R14,                                                         0908
*     R15) RSTD;                    /*                       @G24LB02*/
*   R0=LENGTH(BSRB)+LENGTH(BIOSB)+LENGTH(DATACHAN);/*        @G24LB02*/
         LA    R0,328                                              0909
*   R1=ZERO;                        /* CLEAR REG 1 FOR GETMAIN     0910
*                                                            @G24LB02*/
         SLR   R1,R1                                               0910
*   R15=SP245;                      /* SET SUB POOL ID IN REG 15   0911
*                                                            @G24LB02*/
         LA    R15,245                                             0911
*IGETMAI1:                          /* GETMAIN LABEL         @G24LB02*/
*   GEN REFS(R0,R1,R15) SETS(R0,R1,R15);                           0912
IGETMAI1 DS    0H                                                  0912
*                                        /* GEN FOR GETMAIN  @G24LB02*/
         GETMAIN RC,LV=(R0),SP=(R15),BNDRY=DBLWD,                      *
                RELATED=('IFREEMA1')                           @G24LB02
*   IF R15=ZERO THEN                /* TEST FOR ERROR        @G24LB02*/
         LTR   R15,R15                                             0913
         BNZ   @RF00913                                            0913
*     DO;                           /* GOOD GETMAIN CODE     @G24LB02*/
*       DATACPTR=R1;                /* SET DATA/CHAN PROGRAM POINTER
*                                                            @G24LB02*/
         ST    R1,DATACPTR                                         0915
*       GMFLAG=ON;                  /* SET FLAG GETMAIN SUCCESSFUL 0916
*                                                            @G24LB02*/
         OI    GMFLAG,B'00010000'                                  0916
*       IOSBPTR=DATACPTR+LENGTH(DATACHAN);/* SET IOSB PTR    @G24LB02*/
         L     @11,DATACPTR                                        0917
         LA    @10,176                                             0917
         LR    @09,@11                                             0917
         ALR   @09,@10                                             0917
         ST    @09,IOSBPTR                                         0917
*       SRBPTR=IOSBPTR+LENGTH(BIOSB);/* SET IOSB POINTER     @G24LB02*/
         LA    @08,108                                             0918
         ALR   @08,@09                                             0918
         ST    @08,SRBPTR                                          0918
*       BSRB=''B;                   /* ZERO THE SRB          @G24LB02*/
         XC    BSRB(44,@08),BSRB(@08)                              0919
*       BIOSB=''B;                  /* ZERO THE IOSB         @G24LB02*/
         XC    BIOSB(108,@09),BIOSB(@09)                           0920
*       R0=ADDR(DATACHAN);          /* NOW ZERO DATA AREA WITH     0921
*                                                            @G24LB02*/
         LR    R0,@11                                              0921
*       R1=LENGTH(DATACHAN);        /* MSSC IOSB EXTENSION AND     0922
*                                                            @G24LB02*/
         LR    R1,@10                                              0922
*       R15=ZERO;                   /* CHANNEL PROGRAM       @G24LB02*/
         SLR   R15,R15                                             0923
*       MVCL(R0,R14);               /*                       @G24LB02*/
         MVCL  R0,R14                                              0924
*       RFY                                                        0925
*        (R0,                                                      0925
*         R1,                                                      0925
*         R14,                                                     0925
*         R15) UNRSTD;              /* FREE REGS             @G24LB02*/
*       SRBID=BSRBID;               /* IDENTIFIER INTO SRB   @G24LB02*/
         L     @15,SRBPTR                                          0926
         MVC   SRBID(4,@15),BSRBID                                 0926
*       SRBASCB=MSGASCB;            /* MASTERS ASCB ADDRESS  @G24LB02*/
         LA    @14,4                                               0927
         L     @01,CVTPTR                                          0927
         AL    @14,CVTTCBP(,@01)                                   0927
         L     @11,MSGASCB(,@14)                                   0927
         ST    @11,SRBASCB(,@15)                                   0927
*       IOSASID=MSGASCB->ASCBASID;  /* MASTER SCHEDULER ASID @ZA29681*/
         L     @10,IOSBPTR                                         0928
         MVC   IOSASID(2,@10),ASCBASID(@11)                        0928
*       TCBADDR=MSGTCB;             /* MASTER SCHEDULER TCB ADDR   0929
*                                      /*@ZA29681                    */
         L     @11,DATACPTR                                        0929
         MVC   TCBADDR(4,@11),MSGTCB(@14)                          0929
*       SRBPARM=IOSBPTR;            /* USER PARAMETER INTO SRB     0930
*                                                            @G24LB02*/
         ST    @10,SRBPARM(,@15)                                   0930
*       IOSFLA=CMDCH;               /* COMMAND CHAIN FLAG    @G24LB02*/
         MVI   IOSFLA(@10),X'40'                                   0931
*       IOSSRB=SRBPTR;              /* ADDRESS OF FRIENDLY LCL SRB 0932
*                                                            @G24LB02*/
         ST    @15,IOSSRB(,@10)                                    0932
*       IOSUSE=ADDR(SSCDATA);       /* MSSC DATA AREA OR MSSC IOSB 0933
*                                                            @G24LB02*/
*                                                                  0933
         ST    @11,IOSUSE(,@10)                                    0933
*       /*************************************************************/
*       /*                                                           */
*       /* EXTENSION ADDRESS (ANOTHER USER FIELD)            @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0934
*       IOSVST=ADDR(CCWS);          /* VIRTUAL ADDRESS OF    @G24LB02*/
*                                                                  0934
         LA    @15,CCWS(,@11)                                      0934
         ST    @15,IOSVST(,@10)                                    0934
*       /*************************************************************/
*       /*                                                           */
*       /* REAL CHANNEL PROGRAM                              @G24LB02*/
*       /* INTO MSSC DATA AREA                               @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0935
*/* THE CCWS TO TRANSFER THE REQUEST TO THE MSC CONSIST OF A @G24LB02*/
*/* TAKE LOWER INTERFACE CCW WITH A NO-OP CCW CHAINED TO IT  @G24LB02*/
*                                                                  0935
*       CCW1DATA=ZERO;              /* NO DATA WITH THIS COMMAND   0935
*                                                            @G24LB02*/
         SLR   @10,@10                                             0935
         STCM  @10,7,CCW1DATA(@11)                                 0935
*       CCW1CC=TAKELI;              /* TAKE LOWER INTERFACE  @G24LB02*/
         MVI   CCW1CC(@11),X'44'                                   0936
*       CCW1FLGS=CMDCH;             /* SPECIFY COMMAND CHAINING    0937
*                                                            @G24LB02*/
         MVI   CCW1FLGS(@11),X'40'                                 0937
*       CCW1CNT=ONE;                /* NEED AT LEAST LENGTH OF ONE 0938
*                                                            @G24LB02*/
         LA    @15,1                                               0938
         STH   @15,CCW1CNT(,@11)                                   0938
*       CCW2CC=NOOP;                /* NO OP COMMAND         @G24LB02*/
         MVI   CCW2CC(@11),X'03'                                   0939
*       CCW2DATA=ZERO;              /* NO DATA               @G24LB02*/
         STCM  @10,7,CCW2DATA(@11)                                 0940
*       CCW2FLGS=C1ZERO;            /* ZERO FLAGS            @G24LB02*/
         MVI   CCW2FLGS(@11),X'00'                                 0941
*       CCW2CNT=ONE;                /* NEED COUNT OF ONE     @G24LB02*/
         STH   @15,CCW2CNT(,@11)                                   0942
*     END;                          /* END GOOD GETMAIN CODE @G24LB02*/
*   ELSE                            /* GETMAIN FAILED        @G24LB02*/
*     DO;                           /* GETMAIN FAILED CODE   @G24LB02*/
         B     @RC00913                                            0944
@RF00913 DS    0H                                                  0945
*       CLEANCOD=GETTHRSH;          /* SET GETMAIN FAIL CODE @G24LB02*/
         MVC   CLEANCOD(4),@CF02593                                0945
*       RFY                                                        0946
*         R15 RSTD;                 /* RESTRICT REG 15       @G24LB02*/
*       PLACCONV=R15;               /* SAVE THE GETMAIN FAIL CODE  0947
*                                                            @G24LB02*/
         ST    R15,PLACCONV                                        0947
*       RFY                                                        0948
*         R15 UNRSTD;               /* FREE REG 15           @G24LB02*/
*       CALL RCTOEBC;                                              0949
         BAL   @14,RCTOEBC                                         0949
*       IF CVTNIP=ON THEN                                          0950
         L     @01,CVTPTR                                          0950
         TM    CVTNIP(@01),B'00010000'                             0950
         BNO   @RF00950                                            0950
*         DO;                                                      0951
*           NMESNUM=MSG05NUM;       /* MESSAGE ID IN MSG     @G24LB02*/
         L     @15,NMESPTR                                         0952
         MVC   NMESNUM(3,@15),MSG05NUM                             0952
*           NMESTEXT=GETMTEXT;      /* MESSAGE TEXT IN MSG   @G24LB02*/
         MVI   NMESTEXT+50(@15),C' '                               0953
         MVC   NMESTEXT+51(13,@15),NMESTEXT+50(@15)                0953
         MVC   NMESTEXT(50,@15),GETMTEXT                           0953
*           NMESTEXT(47:49)=PLAC234;/* REASON CODE IN MSG    @G24LB02*/
         MVC   NMESTEXT+46(3,@15),PLAC234                          0954
*/*   WRITE INFORMATIONAL MESSAGE TO THE SYSTEM OPERATOR     @G24LB02*/
*                                                                  0955
*IIEAPMNJ:                                                         0955
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*             @G24LB02*/
*           REFS(NVTWTO,NMSGH);     /* OPERATOR SHOWN ONE LINE     0955
*                                                            @G24LB02*/
IIEAPMNJ IEAPMNIP TYPE=WTO,PARAM=NMSGH
*         END;                      /* DID MSG FOR INITLZ FAILURE ON
*                                      1ST MSC ONLY          @G24LB02*/
*       ELSE                                                       0957
*         DO;                                                      0957
         B     @RC00950                                            0957
@RF00950 DS    0H                                                  0958
*           WTOGEN03=MSG534;        /*                       @MV44258*/
         MVI   WTOGEN03+58,C' '                                    0958
         MVC   WTOGEN03+59(14),WTOGEN03+58                         0958
         MVC   WTOGEN03(58),MSG534                                 0958
*           WTOGEN03(55:57)=PLAC234;                               0959
         MVC   WTOGEN03+54(3),PLAC234                              0959
*           CALL ICBMSG45;                                         0960
         BAL   @14,ICBMSG45                                        0960
*         END;                                                     0961
*     END;                                                         0962
@RC00950 DS    0H                                                  0963
*   RFY                                                            0963
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
@RC00913 DS    0H                                                  0964
*   R14=BUILD14;                    /* RESTORE RETURN ADDRESS      0964
*                                                            @G24LB02*/
         L     R14,BUILD14                                         0964
*   RFY                                                            0965
*     R14 UNRSTD;                   /* FOR BRANCH BACK       @G24LB02*/
*   END BUILDBLK;                   /* MSC I/O BLOCKS HAVE BEEN BUILT
*                                                            @G24LB02*/
@EL00006 DS    0H                                                  0966
@EF00006 DS    0H                                                  0966
@ER00006 BR    @14                                                 0966
*                                                                  0967
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*   SOCIATE     SEGMENT OF ICBMSG05 WHICH ISSUES ANY       @G24LB02*/
*/*                PURGE ORDER TO THE MSC, AND WHICH ISSUES  @G24LB02*/
*/*              A DISASSOCIATE ORDER WHEN ICBMSCMP = OFF    @G24LB05*/
*/*              AN ASSOCIATE ORDER FOR ICBMSCMP = ON        @G24LB05*/
*/*                                                          @G24LB02*/
*/*  INPUT:  AN INDICATOR WHETHER OR NOT PURGE WAS SPECIFIED @G24LB02*/
*/*          AN INDICATOR IF UP OR MP ORDER TO MSC           @G24LB05*/
*/*          AN INDICATOR WHETHER MP HARDWARE IS IN USE      @G24LB05*/
*/*          AN INDICATOR OF ALREADY INITIALIZED             @G24LB05*/
*/*                                                          @G24LB02*/
*/* PROCESSING:    FOR SINGLE CPU IPL, ISSUES THE PURGE      @G24LB02*/
*/*                SPECIFIED, AND THEN A DISASSOCIATE        @G24LB02*/
*/*         IF MP HARDWARE IS IN USE, CHECKS THE REASON CODE @G24LB02*/
*/*         FROM THE DISASSOCIATE.  FOR NO MP HARDWARE, THE  @G24LB02*/
*/*         DISASSOCIATE IS A TRIGGER FOR MSVC               @G24LB02*/
*/*         INITIALIZATION ONLY                              @G24LB02*/
*/*                FOR A MULTIPROCESSOR IPL, AND NO PURGE,   @G24LB02*/
*/*                ISSUES THE ASSOCIATE ORDER.               @G24LB02*/
*/*                FOR A MULTIPROCESSOR IPL, WHEN PURGE WAS  @G24LB02*/
*/*                SPECIFIED, ISSUES THE PURGE ORDER WITH    @G24LB02*/
*/*                THE ASSOCIATE OPTION.                     @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT:       NO SPECIFIC OUTPUT EXCEPT IN CASE OF      @G24LB02*/
*/*         ERROR, WHEN THE REASON CODE FROM THE FAILING     @G24LB02*/
*/*         ASSOCIATE OR DISASSOCIATE IS TRANSLATED          @G24LB02*/
*/*         FOR INCLUSION IN THE CORRESPONDING MESSAGE       @G24LB02*/
*/*         FAILURE AND CLEANUP CODES ARE SET ON ERROR       @G24LB02*/
*/*         NOTE THAT A DISASSOCIATE FAILURE FOR HARDWARE    @G24LB02*/
*/*         WHICH DOES NOT SUPPORT MP IS NOT RECORDED        @G24LB02*/
*/*         SINCE THE MSC REJECTS DISASSOCIATE FROM HOST     @G24LB02*/
*/*         PROCESSORS WHICH ARE NOT POTENTIAL TIGHTLY       @G24LB02*/
*/*         COUPLED MP PAIR MEMBERS                          @G24LB02*/
*/*                                                          @G24LB02*/
*/*     MESSAGE:  THIS SEGMENT WRITES THE MESSAGES IEA978I   @G24LB02*/
*/*               ICB530I,ICB531I,ICB532I,IEA530I,IEA532I,   @G24LB02*/
*/*               IEA5328, AND ICB010I                       @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  0967
*SOCIATE:                                                          0967
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* HOST STATUS      @G24LB02*/
SOCIATE  DS    0H                                                  0968
*   DCL                                                            0968
*     SOCRET POINTER(31);           /* FOR RETURN ADDRESS    @G24LB02*/
*/*  THE FOLLOWING IS FORMAT STORE CPUID INSTRUCTION NEEDS   @G24LB02*/
*                                                                  0969
*   DCL                                                            0969
*    (PRGMSG,                       /* PURGE MESSAGE BEGINNING     0969
*                                                            @G24LB02*/
*     PRGMSGH) LABEL GENERATED;     /* PURGE MSG HEADER      @G24LB02*/
*   DCL                                                            0970
*     PRGRC CHAR(3) GENERATED;      /* FOR PURGE REASON CODE @G24LB02*/
*   GEN DATA REFS(PRGMSG,PRGRC);                                   0971
*   DCL                                                            0972
*     1 MSG010,                     /* ICB010I MESSAGE TEXT  @G24LB02*/
*      2 BEG010 CHAR(34) INIT       /* FIRST PART OF MSG     @G24LB02*/
*            ('  ICB010I PURGE FAILED, REAS CODE='),/* VALUE @G24LB02*/
*      2 REAS010 CHAR(4) INIT       /* FAIL REASON CODE      @G24LB02*/
*            ('    ');              /* VALUE BLANK           @G24LB02*/
*   RFY                                                            0973
*     R14 RSTD;                     /* RESTRICT 14 FOR ADDRESS     0973
*                                                            @G24LB02*/
*   SOCRET=R14;                     /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,SOCRET                                          0974
*   RFY                                                            0975
*     R14 UNRSTD;                   /* FREE UP REGISTER 14   @G24LB02*/
*   PRGXQTD=OFF;                    /* MSC HAS NOT DONE THE PURGE  0976
*                                                            @G24LB02*/
         NI    PRGXQTD,B'11011111'                                 0976
*   NMESPTR=ADDR(NMSGST);                                          0977
         LA    @15,NMSGST                                          0977
         ST    @15,NMESPTR                                         0977
*   ICBCPUID=ICBCPUID&&ICBCPUID;    /* INIT CPUID TO ZERO    @G24LB05*/
         L     @01,CVTPTR                                          0978
         L     @01,CVTEXT2(,@01)                                   0978
         L     @01,CVTICB(,@01)                                    0978
         XC    ICBCPUID(5,@01),ICBCPUID(@01)                       0978
*   DO I=ONE TO TWO;                /* LOOP TO GET CPUID FROM PCCA 0979
*                                                            @G24LB05*/
         LA    @15,1                                               0979
         STH   @15,I                                               0979
@DL00979 DS    0H                                                  0980
*     PCCAPTR=PCCAPNT(I);           /* SET UP PCCA POINTER   @G24LB05*/
         LR    @14,@15                                             0980
         SLA   @14,2                                               0980
         L     @01,CVTPTR                                          0980
         L     @01,CVTPCCAT(,@01)                                  0980
         AL    @01,@CF04189                                        0980
         L     @14,PCCAPNT(@14,@01)                                0980
         ST    @14,PCCAPTR                                         0980
*     IF PCCAPTR^=ZERO THEN         /* FOUND VALID CPU       @G24LB05*/
         LTR   @14,@14                                             0981
         BZ    @RF00981                                            0981
*       DO;                         /* SAVE THE CPUID FOUND  @G24LB05*/
*         UNPKARA1(ONE:TEN)=PCCACPID(THREE:TWELVE);/* MOVE CPUID TO
*                                      WORKAREA              @G24LB05*/
         MVC   UNPKARA1(10),PCCACPID+2(@14)                        0983
*         UNPKARA1(ELEVEN)=ZEROF;   /* SET UP SIGN           @G24LB05*/
         MVI   UNPKARA1+10,X'0F'                                   0984
*         PACK(UNPKARA2,UNPKARA1);  /*                       @G24LB05*/
         PACK  UNPKARA2(6),UNPKARA1(11)                            0985
*         PCCAID(I)=UNPKARA2(ONE:FIVE);/* SAVE PACKED ID     @G24LB05*/
         MH    @15,@CH00033                                        0986
         LA    @14,PCCAID-5(@15)                                   0986
         MVC   0(5,@14),UNPKARA2                                   0986
*       END;                        /*                       @G24LB05*/
*     ELSE                          /*                       @G24LB05*/
*       PCCAID(I)=C5ZERO;           /* ZERO FIELD IF NO CPUID FOUND
*                                                            @G24LB05*/
         B     @RC00981                                            0988
@RF00981 LH    @15,I                                               0988
         MH    @15,@CH00033                                        0988
         LA    @14,PCCAID-5(@15)                                   0988
         MVC   0(5,@14),@CB02664                                   0988
*   END;                            /*                       @G24LB05*/
@RC00981 LA    @15,1                                               0989
         AH    @15,I                                               0989
         STH   @15,I                                               0989
         CH    @15,@CH00125                                        0989
         BNH   @DL00979                                            0989
*   RFY                                                            0990
*     UCB BASED(ICBPUCB);           /*                       @G24LB05*/
*   CPU0=OFF;                       /* INIT CPU FLAG         @G24LB05*/
*   CPU1=OFF;                       /* INIT CPU FLAG         @G24LB05*/
         NI    CPU0,B'10011111'                                    0992
*   IF UCBPPA=OFFUCBSPA=OFF THEN   /* TEST FOR MSC          @G24LB05*/
         L     @01,UCBPTR                                          0993
         TM    UCBPPA(@01),B'11000000'                             0993
         BO    @RF00993                                            0993
*     CPU0=ON;                      /* INTERFACE             @G24LB05*/
         OI    CPU0,B'01000000'                                    0994
*   ELSE                                                           0995
*     ;                             /*                       @G24LB05*/
@RF00993 DS    0H                                                  0996
*   IF UCBPPB=OFFUCBSPB=OFF THEN   /* TEST FOR MSC          @G24LB05*/
         L     @01,UCBPTR                                          0996
         TM    UCBPPB(@01),B'00110000'                             0996
         BO    @RF00996                                            0996
*     CPU1=ON;                      /* INTERFACE             @G24LB05*/
         OI    CPU1,B'00100000'                                    0997
*   ELSE                                                           0998
*     ;                             /*                       @G24LB05*/
@RF00996 DS    0H                                                  0999
*   IF CPU0=ON THEN                 /* SET UP CPUID IN THE   @G24LB05*/
         TM    CPU0,B'01000000'                                    0999
         BNO   @RF00999                                            0999
*     DO;                           /* MSS CONTROL BLOCK AND @G24LB05*/
*       ICBCPUID=PCCAID(ONE);       /* SET UP THE POINTER    @G24LB05*/
         L     @15,CVTPTR                                          1001
         L     @01,CVTEXT2(,@15)                                   1001
         L     @01,CVTICB(,@01)                                    1001
         MVC   ICBCPUID(5,@01),PCCAID                              1001
*       PCCAPTR=PCCAPNT(ONE);       /* TO THE PCCA           @G24LB05*/
         L     @01,CVTPCCAT(,@15)                                  1002
         MVC   PCCAPTR(4),PCCAPNT(@01)                             1002
*     END;                          /*                       @G24LB05*/
*   ELSE                            /*                       @G24LB05*/
*     DO;                           /* SET UP FROM SECOND    @G24LB05*/
         B     @RC00999                                            1004
@RF00999 DS    0H                                                  1005
*       ICBCPUID=PCCAID(TWO);       /* ENTRY IN THE PCCA     @G24LB05*/
         L     @15,CVTPTR                                          1005
         L     @01,CVTEXT2(,@15)                                   1005
         L     @01,CVTICB(,@01)                                    1005
         MVC   ICBCPUID(5,@01),PCCAID+5                            1005
*       PCCAPTR=PCCAPNT(TWO);       /* AND CORRECT POINTER   @G24LB05*/
         L     @01,CVTPCCAT(,@15)                                  1006
         MVC   PCCAPTR(4),PCCAPNT+4(@01)                           1006
*     END;                          /*                       @G24LB05*/
*   RFY                                                            1008
*    (R0,                                                          1008
*     R15) RSTD;                    /* RESTRICT R0 FOR QUERY @G24LB05*/
@RC00999 DS    0H                                                  1009
*   BUFFAREA(ONE:TWO56)=BUFFAREA(ONE:TWO56)&&/*              @G24LB05*/
*       BUFFAREA(ONE:TWO56);        /* CLEAR BUFFER AREA     @G24LB05*/
         XC    BUFFAREA(256),BUFFAREA                              1009
*   BUFFAREA(TWO57:FIVE12)=BUFFAREA(ONE:TWO56);/*            @G24LB05*/
         MVC   BUFFAREA+256(256),BUFFAREA                          1010
*QUERY2:                            /*                       @G24LB05*/
*/*  ******************************************************* @Z40LB22*/
*/*  MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL  MACRO         @Z40LB22*/
*/*  OS/VS2 VERSION-- 03/21/75 LEVEL 00                      @Z40LB22*/
*/*  THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Z40LB22*/
*/*  THE LIST FORM OF THIS MACRO SHOULD BE                   @Z40LB22*/
*/*  INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Z40LB22*/
*/*  DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Z40LB22*/
*/*  SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Z40LB22*/
*/*  ******************************************************* @Z40LB22*/
*                                                                  1011
*   RFY                                                            1011
*    (QUERR1) RSTD;                 /* RESTRICT R1           @Z40LB22*/
QUERY2   DS    0H                                                  1012
*   QUERR1=ADDR(QUERLIST);          /* SET QUERR1 TO REQ BLOCK     1012
*                                                            @Z40LB22*/
         LA    QUERR1,QUERLIST                                     1012
*   QUERLIST=QUERLIST&&QUERLIST;    /* ZERO REQUEST BLOCK    @Z40LB22*/
         XC    QUERLIST(44),QUERLIST                               1013
*   QULEN='2C'X;                    /* SET LENGTH FIELD      @Z40LB22*/
         LA    @14,44                                              1014
         ST    @14,QULEN                                           1014
*   QUORD='0B'X;                    /* SET OPCODE FIELD      @Z40LB22*/
         MVI   QUORD,X'0B'                                         1015
*   QUCODE='03'X;                   /* SET CODE TYPE         @Z40LB22*/
         MVI   QUCODE,X'03'                                        1016
*   QUSECT=(SECT1);                 /* FILL IN SECTOR ID     @Z40LB22*/
         MVI   QUSECT,X'01'                                        1017
*   QWFLAG=(MAINSTOR);              /* FILL IN FLAGS FIELD   @ZA09556*/
         MVI   QWFLAG,X'00'                                        1018
*   QUPTR=ADDR(BUFFAREA);           /* ADDR OF DATAPTR FIELD @Z40LB22*/
         LA    @14,BUFFAREA                                        1019
         ST    @14,QUPTR                                           1019
*   SVC(126);                       /* ISSUE SVC INST.       @Z40LB22*/
         SVC   126                                                 1020
*   RFY                                                            1021
*    (QUERR1) UNRSTD;               /* UNRESTRICT R1         @Z40LB22*/
*   QUERERR=OFF;                    /* SET UP ERROR CONTROL FLG    1022
*                                                            @G24LB05*/
         NI    QUERERR,B'11101111'                                 1022
*   IF R15^=GOODIO THEN             /* DID QUERY FAIL        @G24LB05*/
         LTR   R15,R15                                             1023
         BZ    @RF01023                                            1023
*     DO;                           /*                       @G24LB05*/
*       PLACCONV=R0;                /* STORE CODE FOR CONVERSION   1025
*                                                            @G24LB05*/
         ST    R0,PLACCONV                                         1025
*       QUERERR=ON;                 /* INDICATE QUERY ERROR  @G24LB05*/
         OI    QUERERR,B'00010000'                                 1026
*       CALL RCTOEBC;               /* GET CONVERSION ROUTINE      1027
*                                                            @G24LB05*/
         BAL   @14,RCTOEBC                                         1027
*       RFY                                                        1028
*         R0 UNRESTRICTED;          /* CONVERSION DONE       @G24LB05*/
*       IF CVTNIP=ON THEN           /* IS NIP IN CONTROL     @G24LB05*/
         L     @14,CVTPTR                                          1029
         TM    CVTNIP(@14),B'00010000'                             1029
         BNO   @RF01029                                            1029
*         DO;                       /* NIP IS IN CONTROL     @G24LB05*/
*           NMESPTR=ADDR(NMSGST);   /* MESSAGE HEADER        @G24LB05*/
         LA    @14,NMSGST                                          1031
         ST    @14,NMESPTR                                         1031
*           NMESNUM=RDFLMNUM;       /* SET UP MESSAGE NO.    @G24LB05*/
         MVC   NMESNUM(3,@14),RDFLMNUM                             1032
*           NMESLET=LETTERI;        /* INDICATE INFORMATIONAL MSG  1033
*                                                            @G24LB05*/
         MVC   NMESLET(1,@14),LETTERI                              1033
*           NMESTEXT=RDFLTEXT;      /* PUT READ FAIL TEXT IN MSG   1034
*                                                            @G24LB05*/
         MVI   NMESTEXT+43(@14),C' '                               1034
         MVC   NMESTEXT+44(20,@14),NMESTEXT+43(@14)                1034
         MVC   NMESTEXT(43,@14),RDFLTEXT                           1034
*           NMESTEXT(FORTY1:FORTY3)=PLAC234;/* SET RC IN MSG @G24LB05*/
         MVC   NMESTEXT+40(3,@14),PLAC234                          1035
*IEAPMNF:                                                          1036
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)                     1036
*           REFS(NVTWTO,NMSGH);     /*                       @G24LB05*/
IEAPMNF  IEAPMNIP TYPE=WTO,PARAM=NMSGH
*         END;                      /* END NIP IN CONTROL    @G24LB05*/
*       ELSE                        /*                       @G24LB05*/
*         DO;                       /* NIP NOT IN CONTROL    @G24LB05*/
         B     @RC01029                                            1038
@RF01029 DS    0H                                                  1039
*           WTOGEN03=MSG531;        /* PRIME WTO BUFFER      @G24LB05*/
         MVI   WTOGEN03+54,C' '                                    1039
         MVC   WTOGEN03+55(18),WTOGEN03+54                         1039
         MVC   WTOGEN03(54),MSG531                                 1039
*           WTOGEN03(FIFTY2:FIFTY4)=PLAC234;/* RC INTO MSG   @G24LB05*/
         MVC   WTOGEN03+51(3),PLAC234                              1040
*           CALL ICBMSG45;          /* CALL WTO SUB-ROUTINE  @G24LB05*/
         BAL   @14,ICBMSG45                                        1041
*         END;                      /*                       @G24LB05*/
*     END;                          /* NOT NIM WTO           @G24LB05*/
@RC01029 DS    0H                                                  1044
*   ERRSW=ON;                       /* SET UP FOR ERR IN PORT      1044
*                                      IDENTIFICATION        @G24LB05*/
@RF01023 OI    ERRSW,B'10000000'                                   1044
*   DO I=ONE TO FOUR;               /* LOOP TO SEARCH FOR    @G24LB05*/
         LA    @14,1                                               1045
         STH   @14,I                                               1045
@DL01045 DS    0H                                                  1046
*     IF FLG(I)=ON THEN             /* ACTIVE PORT           @G24LB05*/
         LR    @11,@14                                             1046
         SLA   @11,2                                               1046
         LA    @10,FLG-4(@11)                                      1046
         TM    0(@10),B'00000010'                                  1046
         BNO   @RF01046                                            1046
*       DO;                         /*                       @G24LB05*/
*         PORT=I-ONE;               /* SAVE PORT ID          @G24LB05*/
         BCTR  @14,0                                               1048
         STC   @14,PORT                                            1048
*         I=FIVE;                   /* GET OUT OF LOOP       @G24LB05*/
         MVC   I(2),@CH00033                                       1049
*         ERRSW=OFF;                /* FOUND PORT            @G24LB05*/
         NI    ERRSW,B'01111111'                                   1050
*       END;                        /*                       @G24LB05*/
*   END;                            /*                       @G24LB05*/
@RF01046 LA    @14,1                                               1052
         AH    @14,I                                               1052
         STH   @14,I                                               1052
         CH    @14,@CH00032                                        1052
         BNH   @DL01045                                            1052
*   IF ERRSW=ON THEN                /* COULD NOT IDENTIFY    @G24LB05*/
         TM    ERRSW,B'10000000'                                   1053
         BNO   @RF01053                                            1053
*     DO;                           /* PORT                  @G24LB05*/
*       QUERERR=ON;                 /* INDICATE QUERRY ERROR @G24LB05*/
         OI    QUERERR,B'00010000'                                 1055
*       IF CVTNIP=ON THEN           /* TEST FOR NIP          @G24LB05*/
         L     @14,CVTPTR                                          1056
         TM    CVTNIP(@14),B'00010000'                             1056
         BNO   @RF01056                                            1056
*         DO;                       /* IN CONTROL            @G24LB05*/
*           NMESPTR=ADDR(NMSGST);   /* SET UP MSG PTR        @G24LB05*/
         LA    @14,NMSGST                                          1058
         ST    @14,NMESPTR                                         1058
*           NMESNUM=UNKNMNUM;       /* FILL IN MSG ID        @G24LB05*/
         MVC   NMESNUM(3,@14),UNKNMNUM                             1059
*           NMESTEXT=UNKNTEXT;      /* BUILD TEXT OF MSG     @G24LB05*/
         MVI   NMESTEXT+49(@14),C' '                               1060
         MVC   NMESTEXT+50(14,@14),NMESTEXT+49(@14)                1060
         MVC   NMESTEXT(49,@14),UNKNTEXT                           1060
*           NMESLET=LETTERI;        /* INDICATE I TYPE MSG   @G24LB05*/
         MVC   NMESLET(1,@14),LETTERI                              1061
*           NMESTEXT(THIRTY5:FORTY4)=/* PUT CPUID INTO MSG   @G24LB05*/
*               PCCACPID(THREE:TWELVE);/*                    @G24LB05*/
         L     @01,PCCAPTR                                         1062
         MVC   NMESTEXT+34(10,@14),PCCACPID+2(@01)                 1062
*IEAPMNG:                           /*                       @G24LB05*/
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*             @G24LB05*/
*           REFS(NVTWTO,NMSGH);     /*                       @G24LB05*/
IEAPMNG  IEAPMNIP TYPE=WTO,PARAM=NMSGH
*         END;                      /* END NIP IN CONTROL    @G24LB05*/
*       ELSE                        /*                       @G24LB05*/
*         DO;                       /* NIP NOT IN CONTROL    @G24LB05*/
         B     @RC01056                                            1065
@RF01056 DS    0H                                                  1066
*           WTOGEN03=MSG532;        /* PRIME WTO BUFFER      @G24LB05*/
         MVI   WTOGEN03+60,C' '                                    1066
         MVC   WTOGEN03+61(12),WTOGEN03+60                         1066
         MVC   WTOGEN03(60),MSG532                                 1066
*           WTOGEN03(FORTY6:FIFTY5)=/*                       @G24LB05*/
*               PCCACPID(THREE:TWELVE);/* SET IN CPUID USED  @G24LB05*/
         L     @14,PCCAPTR                                         1067
         MVC   WTOGEN03+45(10),PCCACPID+2(@14)                     1067
*           CALL ICBMSG45;          /* CALL WTO SUP-ROUTINE  @G24LB05*/
         BAL   @14,ICBMSG45                                        1068
*         END;                      /* END NON NIP WTO       @G24LB05*/
*     END;                          /*                       @G24LB05*/
@RC01056 DS    0H                                                  1071
*   IF QUERERR=OFF THEN             /* FIRST QUERY WAS OK    @G24LB05*/
@RF01053 TM    QUERERR,B'00010000'                                 1071
         BNZ   @RF01071                                            1071
*     DO;                           /*                       @G24LB05*/
*       QUERLIST=QUERLIST&&QUERLIST;/* ZERO REQUEST BLOCK    @G24LB05*/
         XC    QUERLIST(44),QUERLIST                               1073
*       QTID=CONFIG;                /* SET UP TO READ CONFIG TABLE 1074
*                                                            @G24LB05*/
         MVI   QTID,X'70'                                          1074
*       QTFLAG=SPECCHR;             /* INDICATE CHR SUPPLIED @G24LB05*/
         MVI   QTFLAG,X'10'                                        1075
*       BUFFAREA(ONE:TWO56)=BUFFAREA(ONE:TWO56)&&/*          @G24LB05*/
*           BUFFAREA(ONE:TWO56);    /* CLEAR BUFFER AREA     @G24LB05*/
         XC    BUFFAREA(256),BUFFAREA                              1076
*       BUFFAREA(TWO57:FIVE12)=BUFFAREA(ONE:TWO56);/*        @G24LB05*/
         MVC   BUFFAREA+256(256),BUFFAREA                          1077
*QUERY3:                            /*                       @G24LB05*/
*                                                                  1078
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************************   */
*       /*                                                   @Z40LB22*/
*       /* MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL MACRO    @Z40LB22*/
*       /* OS/VS2 VERSION-- 03/21/75 LEVEL 00                @Z40LB22*/
*       /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.          @Z40LB22*/
*       /* THE LIST FORM OF THIS MACRO SHOULD BE             @Z40LB22*/
*       /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        @Z40LB22*/
*       /* DECLARES. IF THE COMPLETE ARGUMENT IS             @Z40LB22*/
*       /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.           @Z40LB22*/
*       /* *******************************************************   */
*       /*                                                   @Z40LB22*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1078
*       RFY                                                        1078
*        (QUERR1) RSTD;             /* RESTRICT R1           @Z40LB22*/
QUERY3   DS    0H                                                  1079
*       QUERR1=ADDR(QUERLIST);      /* SET QUERR1 TO REQ BLOCK     1079
*                                                            @Z40LB22*/
         LA    QUERR1,QUERLIST                                     1079
*       QULEN='2C'X;                /* SET LENGTH FIELD      @Z40LB22*/
         LA    @14,44                                              1080
         ST    @14,QULEN                                           1080
*       QUORD='05'X;                /* SET OPCODE FIELD      @Z40LB22*/
         MVI   QUORD,X'05'                                         1081
*       QUCODE='06'X;               /* SET CODE TYPE         @Z40LB22*/
         MVI   QUCODE,X'06'                                        1082
*       QTDASCHR=(TABLECHR);        /* FILL IN CHR           @Z40LB22*/
         MVC   QTDASCHR(4),@CB02774                                1083
*       QUPTR=ADDR(BUFFAREA);       /* ADDR OF DATAPTR FIELD @Z40LB22*/
         LA    @14,BUFFAREA                                        1084
         ST    @14,QUPTR                                           1084
*       SVC(126);                   /* ISSUE SVC INST.       @Z40LB22*/
         SVC   126                                                 1085
*       RFY                                                        1086
*        (QUERR1) UNRSTD;           /* UNRESTRICT R1         @Z40LB22*/
*       RFY                                                        1087
*         R0 RSTD;                  /* SAVE FOR RETURN CODE  @G24LB05*/
*       IF R15^=GOODIO THEN         /* DID I/O FAIL          @G24LB05*/
         LTR   R15,R15                                             1088
         BZ    @RF01088                                            1088
*         DO;                       /*                       @G24LB05*/
*           PLACCONV=R0;            /* STORE CODE FOR CONV   @G24LB05*/
         ST    R0,PLACCONV                                         1090
*           CALL RCTOEBC;           /* GET EBCDIC CONVERSION @G24LB05*/
         BAL   @14,RCTOEBC                                         1091
*           RFY                                                    1092
*             R0 UNRESTRICTED;      /* CONVERT DONE          @G24LB05*/
*           IF CVTNIP=ON THEN       /* TEST FOR NIP IN             1093
*                                      CONTROL@G24LB05               */
         L     @14,CVTPTR                                          1093
         TM    CVTNIP(@14),B'00010000'                             1093
         BNO   @RF01093                                            1093
*             DO;                   /*                       @G24LB05*/
*               NMESPTR=ADDR(NMSGST);/* SET UP MSG PTR       @G24LB05*/
         LA    @14,NMSGST                                          1095
         ST    @14,NMESPTR                                         1095
*               NMESNUM=RDFLMNUM;   /* PUT MSGID INTO BUFFER @G24LB05*/
         MVC   NMESNUM(3,@14),RDFLMNUM                             1096
*               NMESLET=LETTERI;    /* I TYPE MESSAGE        @G24LB05*/
         MVC   NMESLET(1,@14),LETTERI                              1097
*               NMESTEXT=RDFLTEXT;  /* READ FAIL TEXT        @G24LB05*/
         MVI   NMESTEXT+43(@14),C' '                               1098
         MVC   NMESTEXT+44(20,@14),NMESTEXT+43(@14)                1098
         MVC   NMESTEXT(43,@14),RDFLTEXT                           1098
*               NMESTEXT(FORTY1:FORTY3)=PLAC234;/* PUT REASON CODE IN
*                                      MSG                   @G24LB05*/
         MVC   NMESTEXT+40(3,@14),PLAC234                          1099
*IEAPMNH:                                                          1100
*               GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)                 1100
*               REFS(NVTWTO,NMSGH); /*                       @G24LB05*/
IEAPMNH  IEAPMNIP TYPE=WTO,PARAM=NMSGH
*             END;                  /*                       @G24LB05*/
*           ELSE                    /*                       @G24LB05*/
*             DO;                   /* NIP NOT IN CONTROL    @G24LB05*/
         B     @RC01093                                            1102
@RF01093 DS    0H                                                  1103
*               WTOGEN03=MSG531;    /* PRIME WTO BUFFER      @G24LB05*/
         MVI   WTOGEN03+54,C' '                                    1103
         MVC   WTOGEN03+55(18),WTOGEN03+54                         1103
         MVC   WTOGEN03(54),MSG531                                 1103
*               WTOGEN03(FIFTY2:FIFTY4)=PLAC234;/* SET IN RETURN CODE
*                                                            @G24LB05*/
         MVC   WTOGEN03+51(3),PLAC234                              1104
*               CALL ICBMSG45;      /* CALL WTO SUP-ROUTINE  @G24LB05*/
         BAL   @14,ICBMSG45                                        1105
*             END;                  /* END NOT NIP           @G24LB05*/
*         END;                      /*                       @G24LB05*/
@RC01093 DS    0H                                                  1108
*       ERRSW=ON;                   /* SET UP TO TEST PORT   @G24LB05*/
@RF01088 OI    ERRSW,B'10000000'                                   1108
*       DO I=ONE TO SIXTEN;         /* INTERFACE CPUID       @G24LB05*/
         LA    @14,1                                               1109
         STH   @14,I                                               1109
@DL01109 DS    0H                                                  1110
*         CPUINTFP=ADDR(CPUINTFB(I));/* SET UP PTR           @G24LB05*/
         SLA   @14,3                                               1110
         LA    @11,BUFFAREA                                        1110
         LA    @10,CPUINTFB-8(@14,@11)                             1110
         ST    @10,CPUINTFP                                        1110
*         VALBITSP=ADDR(VALBITS(I));/* SET UP PTR            @G24LB05*/
         LA    @09,VALBITS-8(@14,@11)                              1111
         ST    @09,VALBITSP                                        1111
*         TEMPWA=CPUINTF&MASKP;     /* SET UP INTF AND MASD OFF    1112
*                                      UNUSED BITS           @G24LB05*/
         MVC   TEMPWA(1),CPUINTF(@10)                              1112
         NC    TEMPWA(1),MASKP                                     1112
*         IF VALIDBIT=ON&           /* VALIDITY. DETERMINE IF      1113
*                                                            @G24LB05*/
*             TEMPWA=PORTID         /* CPUID FROM MSC TABLE OK     1113
*                                                            @G24LB05*/
*           THEN                                                   1113
         TM    VALIDBIT(@09),B'10000000'                           1113
         BNO   @RF01113                                            1113
         CLC   TEMPWA(1),PORTID                                    1113
         BNE   @RF01113                                            1113
*           DO;                     /*                       @G24LB05*/
*             ICBCPUID=TABLCPID(I); /* SET CTL BLOCK = TABLE @G24LB05*/
         L     @01,CVTPTR                                          1115
         L     @01,CVTEXT2(,@01)                                   1115
         L     @09,CVTICB(,@01)                                    1115
         ALR   @11,@14                                             1115
         MVC   ICBCPUID(5,@09),TABLCPID-8(@11)                     1115
*             I=SEVENTEN;           /* GET OUT OF LOOP       @G24LB05*/
         MVC   I(2),@CH02677                                       1116
*             ERRSW=OFF;            /* TABLE CPUID OK        @G24LB05*/
         NI    ERRSW,B'01111111'                                   1117
*             IF INITSW=ON&         /* INIT BEFORE           @G24LB02*/
*                 ICBMSCMP=ON&      /* POSSIBLE AP           @G24LB02*/
*                 CPUPMP=OFF        /* NOT POSSIBLE MP       @G24LB02*/
*               THEN                /*                       @G24LB05*/
         TM    INITSW,B'00001000'                                  1118
         BNO   @RF01118                                            1118
         TM    ICBMSCMP(@09),B'00000100'                           1118
         BNO   @RF01118                                            1118
         TM    CPUPMP(@10),B'01000000'                             1118
         BNZ   @RF01118                                            1118
*               DO;                 /*                       @G24LB05*/
*                 ICBMSCMP=OFF;     /* INDICATE NOT MP       @G24LB05*/
*                 ICBMSCA=ON;       /* INDICATE POSSIBLE AP  @G24LB05*/
         OI    ICBMSCA(@09),B'00000010'                            1121
         NI    ICBMSCMP(@09),B'11111011'                           1121
*               END;                /*                       @G24LB05*/
*           END;                    /*                       @G24LB05*/
@RF01118 DS    0H                                                  1124
*       END;                        /*                       @G24LB05*/
@RF01113 LA    @14,1                                               1124
         AH    @14,I                                               1124
         STH   @14,I                                               1124
         CH    @14,@CH00239                                        1124
         BNH   @DL01109                                            1124
*       IF ERRSW=ON THEN            /* COULD NOT USE TABLE   @G24LB05*/
         TM    ERRSW,B'10000000'                                   1125
         BNO   @RF01125                                            1125
*         DO;                                                      1126
*           IF CVTNIP=ON THEN       /* TEST FOR NIP          @G24LB05*/
         L     @14,CVTPTR                                          1127
         TM    CVTNIP(@14),B'00010000'                             1127
         BNO   @RF01127                                            1127
*             DO;                   /* IN CONTROL            @G24LB05*/
*               NMESPTR=ADDR(NMSGST);/* SET UP MSG PTR       @G24LB05*/
         LA    @14,NMSGST                                          1129
         ST    @14,NMESPTR                                         1129
*               NMESNUM=UNKNMNUM;   /* FILL IN MSG ID        @G24LB05*/
         MVC   NMESNUM(3,@14),UNKNMNUM                             1130
*               NMESTEXT=UNKNTEXT;  /* BUILD TEXT OF MSG     @G24LB05*/
         MVI   NMESTEXT+49(@14),C' '                               1131
         MVC   NMESTEXT+50(14,@14),NMESTEXT+49(@14)                1131
         MVC   NMESTEXT(49,@14),UNKNTEXT                           1131
*               NMESLET=LETTERI;    /* INDICATE I TYPE MSG   @G24LB05*/
         MVC   NMESLET(1,@14),LETTERI                              1132
*               NMESTEXT(THIRTY5:FORTY4)=/* PUT CPUID INTO MSG     1133
*                                                            @G24LB05*/
*                   PCCACPID(THREE:TWELVE);/*                @G24LB05*/
         L     @01,PCCAPTR                                         1133
         MVC   NMESTEXT+34(10,@14),PCCACPID+2(@01)                 1133
*IEAPMNI:                                                          1134
*               GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)                 1134
*               REFS(NVTWTO,NMSGH);                                1134
IEAPMNI  IEAPMNIP TYPE=WTO,PARAM=NMSGH
*             END;                  /* END NIP IN CONTROL    @G24LB05*/
*           ELSE                                                   1136
*             DO;                   /* NIP NOT IN CONTROL    @G24LB05*/
         B     @RC01127                                            1136
@RF01127 DS    0H                                                  1137
*               WTOGEN03=MSG532;    /* PRIME WTO BUFFER      @G24LB05*/
         MVI   WTOGEN03+60,C' '                                    1137
         MVC   WTOGEN03+61(12),WTOGEN03+60                         1137
         MVC   WTOGEN03(60),MSG532                                 1137
*               WTOGEN03(FORTY6:FIFTY5)=PCCACPID(THREE:TWELVE);/* SET
*                                      IN CPUID USED         @G24LB05*/
         L     @14,PCCAPTR                                         1138
         MVC   WTOGEN03+45(10),PCCACPID+2(@14)                     1138
*               CALL ICBMSG45;      /* CALL WTO SUP-ROUTINE  @G24LB05*/
         BAL   @14,ICBMSG45                                        1139
*             END;                  /* END NON NIP WTO       @G24LB05*/
*         END;                                                     1141
@RC01127 DS    0H                                                  1142
*     END;                                                         1142
@RF01125 DS    0H                                                  1143
*   IF ICBCPUID^=PCCAID(ONE)&       /* COMPARE CPUID FROM MSC      1143
*                                                            @G24LB05*/
*       ICBCPUID^=PCCAID(TWO) THEN  /* WITH CPUID'S FROM PCCA      1143
*                                                            @G24LB05*/
@RF01071 L     @14,CVTPTR                                          1143
         L     @01,CVTEXT2(,@14)                                   1143
         L     @11,CVTICB(,@01)                                    1143
         CLC   ICBCPUID(5,@11),PCCAID                              1143
         BE    @RF01143                                            1143
         CLC   ICBCPUID(5,@11),PCCAID+5                            1143
         BE    @RF01143                                            1143
*     DO;                           /*                       @G24LB05*/
*       UNPKARA2(ONE:FIVE)=ICBCPUID;/* SET UP TO MAKE CPUID  @G24LB05*/
         MVC   UNPKARA2(5),ICBCPUID(@11)                           1145
*       UNPKARA2(SIX)=ZEROF;                                       1146
         MVI   UNPKARA2+5,X'0F'                                    1146
*       /*CLEAR OUT WORKAREA @G24LB05*/UNPK(UNPKARA1,UNPKARA2);/*  1147
*                                      MAKE IT PRINTABLE     @G24LB05*/
         UNPK  UNPKARA1(11),UNPKARA2(6)                            1147
*       IF CVTNIP=ON THEN           /* SEE IF NIP IS IN CTL  @G24LB05*/
         TM    CVTNIP(@14),B'00010000'                             1148
         BNO   @RF01148                                            1148
*         DO;                       /*                       @G24LB05*/
*           NMESPTR=ADDR(NMSGST);   /* SET UP PTR            @G24LB05*/
         LA    @14,NMSGST                                          1150
         ST    @14,NMESPTR                                         1150
*           NMESNUM=MISMNUM;        /* PUT IN MESSAGE NUMBER @G24LB05*/
         MVC   NMESNUM(3,@14),MISMNUM                              1151
*           NMESLET=LETTERI;        /* MSG TYPE I            @G24LB05*/
         MVC   NMESLET(1,@14),LETTERI                              1152
*           NMESTEXT=MISMTEXT;      /* MISMATCH TEXT         @G24LB05*/
         MVI   NMESTEXT+38(@14),C' '                               1153
         MVC   NMESTEXT+39(25,@14),NMESTEXT+38(@14)                1153
         MVC   NMESTEXT(38,@14),MISMTEXT                           1153
*           NMESTEXT(TWENTY4:THIRTY3)=/* PUT CPUID FROM PCCA @G24LB05*/
*               UNPKARA1(ONE:TEN);  /* IN MSG TEXT           @G24LB05*/
         MVC   NMESTEXT+23(10,@14),UNPKARA1                        1154
*IEAPMNJ:                           /*                       @G24LB05*/
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)                     1155
*           REFS(NVTWTO,NMSGH);     /*                       @G24LB05*/
IEAPMNJ  IEAPMNIP TYPE=WTO,PARAM=NMSGH
*         END;                      /*                       @G24LB05*/
*       ELSE                                                       1157
*         DO;                       /* NIP NOT IN CTL        @G24LB05*/
         B     @RC01148                                            1157
@RF01148 DS    0H                                                  1158
*           WTOGEN03=MSG530;        /* PRIME WTO BUFFER      @G24LB05*/
         MVI   WTOGEN03+49,C' '                                    1158
         MVC   WTOGEN03+50(23),WTOGEN03+49                         1158
         MVC   WTOGEN03(49),MSG530                                 1158
*           WTOGEN03(THIRTY5:FORTY4)=/* SET UP CPUID SELECTED      1159
*                                                            @G24LB05*/
*               UNPKARA1(ONE:TEN);  /* FROM PCCA             @G24LB05*/
         MVC   WTOGEN03+34(10),UNPKARA1                            1159
*           CALL ICBMSG45;          /* GET WTO SUB-ROUTINE   @G24LB05*/
         BAL   @14,ICBMSG45                                        1160
*         END;                      /* END NON NIP WTO       @G24LB05*/
*     END;                                                         1162
@RC01148 DS    0H                                                  1163
*   IF ICBB=ON THEN                                                1163
@RF01143 L     @14,CVTPTR                                          1163
         L     @14,CVTEXT2(,@14)                                   1163
         L     @14,CVTICB(,@14)                                    1163
         TM    ICBB(@14),B'00010000'                               1163
         BNO   @RF01163                                            1163
*     DO;                                                          1164
*       IF SUSPLONG=ON THEN         /*                       @G24LB02*/
         L     @14,PURGPTR                                         1165
         TM    SUSPLONG(@14),B'00100000'                           1165
         BNO   @RF01165                                            1165
*         DO;                       /*                       @G24LB02*/
*           CALL MAKNOTRD;          /* CLEAR VOLI&MAKE NOTRDY      1167
*                                                            @G24LB02*/
         BAL   @14,MAKNOTRD                                        1167
*           SUSPLONG=OFF;           /* CLEAR SUSP LONG FLAG  @G24LB02*/
         L     @14,PURGPTR                                         1168
         NI    SUSPLONG(@14),B'11011111'                           1168
*         END;                      /*                       @G24LB02*/
*       ICBB=OFF;                   /*                       @G24LB02*/
*                                                                  1170
@RF01165 L     @14,CVTPTR                                          1170
         L     @14,CVTEXT2(,@14)                                   1170
         L     @14,CVTICB(,@14)                                    1170
         NI    ICBB(@14),B'11101111'                               1170
*       /*************************************************************/
*       /*                                                           */
*       /* VATLIST IS CALLED TO ISSUE A WTOR FOR MOUNTING OF @G24LB02*/
*       /* VITRUAL VOLUMES NECESSARY FOR MSS OPERATION.      @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1171
*       VATMSG=''B;                 /* CLEAR MSG REPLY AREA  @G24LB02*/
         XC    VATMSG(4),VATMSG                                    1171
*       DO UNTIL(VATMSG=CHARCONTVATMSG=QUOTCONT);/*         @G24LB02*/
@DL01172 DS    0H                                                  1173
*         CALL VATLIST;             /*                       @G24LB02*/
         BAL   @14,VATLIST                                         1173
*       END;                        /*                       @G24LB02*/
@DE01172 CLC   VATMSG(4),CHARCONT                                  1174
         BE    @DC01172                                            1174
         CLC   VATMSG(4),QUOTCONT                                  1174
         BNE   @DL01172                                            1174
@DC01172 DS    0H                                                  1175
*       ICBB=ON;                    /* SET BROKEN BOX INDICATOR    1175
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          1175
         L     @14,CVTEXT2(,@14)                                   1175
         L     @14,CVTICB(,@14)                                    1175
         OI    ICBB(@14),B'00010000'                               1175
*     END;                          /*                       @G24LB02*/
*                                                                  1176
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE WILL ENABLE MSVC IF THE BROKEN   @G24LB02*/
*   /* BOX FLAG OR SUSPEND FLAG IS ON                        @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1177
*   IF ICBS=ON THEN                                                1177
@RF01163 L     @14,CVTPTR                                          1177
         L     @14,CVTEXT2(,@14)                                   1177
         L     @14,CVTICB(,@14)                                    1177
         TM    ICBS(@14),B'00001000'                               1177
         BNO   @RF01177                                            1177
*     DO;                           /*                       @G24LB02*/
*       REQLIST1=''B;               /* ZERO THE REQUEST BLK  @G24LB02*/
         XC    REQLIST1(40),REQLIST1                               1179
*       INILNGTH=INILEN;            /* SET LENGTH FIELD      @G24LB02*/
         L     @11,INITPTR                                         1180
         LH    @10,INILEN                                          1180
         ST    @10,INILNGTH(,@11)                                  1180
*       INITOPCD=INICODE;           /* SET OPCODE FIELD      @G24LB02*/
         MVI   INITOPCD(@11),X'88'                                 1181
*       INIENABL=ON;                /* SET ENABLE FLAG       @G24LB02*/
         OI    INIENABL(@11),B'01000000'                           1182
*       INIVERFY=ON;                /* SET VERIFY FLAG       @G24LB02*/
         OI    INIVERFY(@11),B'10000000'                           1183
*       INIUCAT='';                 /* BLANK MSVCCAT VALUE   @G24LB02*/
         MVI   INIUCAT(@11),C' '                                   1184
         MVC   INIUCAT+1(7,@11),INIUCAT(@11)                       1184
*       RFY                                                        1185
*         R1 RSTD;                  /*                       @G24LB02*/
*       R1=INITPTR;                 /* SET PARM REG          @G24LB02*/
         LR    R1,@11                                              1186
*       ICBB=OFF;                   /* RESET ICBB AROUND SVC @M05LB02*/
         NI    ICBB(@14),B'11101111'                               1187
*       SVC(126);                   /* INVOKE SVC 126        @G24LB02*/
         SVC   126                                                 1188
*       ICBB=ON;                    /* RESET ICBB            @M05LB02*/
         L     @14,CVTPTR                                          1189
         L     @14,CVTEXT2(,@14)                                   1189
         L     @14,CVTICB(,@14)                                    1189
         OI    ICBB(@14),B'00010000'                               1189
*       RFY                                                        1190
*         R1 UNRSTD;                /*                       @G24LB02*/
*     END;                          /*                       @G24LB02*/
*   RESPECIFY                                                      1192
*     PARMTAB BASED(NVTPTAB);       /* & FOR PARAMETERS      @G24LB02*/
@RF01177 DS    0H                                                  1193
*   RESPECIFY                                                      1193
*     NIPPAREA BASED(NVTPAREA);     /*                       @G24LB02*/
*   RESPECIFY                                                      1194
*     NIPPTE BASED(PURGE);          /*                       @G24LB02*/
*   IF PURGBIT=OFF                  /* CAN PURGE BE SKIPPED ?      1195
*                                                            @G24LB02*/
*     THEN                          /* NO PURGE REQUESTED, SKIP IT 1195
*                                                            @G24LB02*/
         L     @14,PURGPTR                                         1195
         TM    PURGBIT(@14),B'10000000'                            1195
         BNZ   @RF01195                                            1195
*     DO;                           /* GIVE HOST STATUS      @G24LB02*/
*       RFY                                                        1197
*        (R0,                                                      1197
*         R1) RSTD;                 /* FOR I/O TO MSC        @G24LB05*/
*       IF ICBMSCMP=OFF             /* JUST ONE CPU IN THIS IPL?   1198
*                                                            @G24LB05*/
*         THEN                      /* YES, IT STANDS ALONE  @G24LB02*/
         L     @14,CVTPTR                                          1198
         L     @14,CVTEXT2(,@14)                                   1198
         L     @14,CVTICB(,@14)                                    1198
         TM    ICBMSCMP(@14),B'00000100'                           1198
         BNZ   @RF01198                                            1198
*         DO;                       /* ISSUE DISASSOCIATE    @G24LB02*/
*           DCL                                                    1200
*             ASDAR1 REG(1) PTR;    /* PTR TO REQUEST BLOCK  @Y30LB02*/
*                                                                  1200
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /* MACMEAN MSSC ASSOCIATE MACRO                  @Y30LB02*/
*           /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00        @Y30LB02*/
*           /* THIS IS THE STANDARD FORM MACRO               @Y30LB02*/
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1201
*           RFY                                                    1201
*            (ASDAR1) RSTD;         /* RESTRICT REG 1        @Y30LB02*/
*           ASDAR1=ADDR(ASDALEN);   /* R1 PTR TO REQUEST BLOCK     1202
*                                                            @Y30LB02*/
         LA    ASDAR1,ASDALEN                                      1202
*           DCL                                                    1203
*             1 ASDALST STATIC LOCAL,/* ASSOCIATE REQUEST BLOCK    1203
*                                                            @Y30LB02*/
*              2 ASDALEN FIXED(31) INIT('10'X),/* LENG OF ASSOC REQ
*                                      BLK                   @Y30LB02*/
*              2 ASDAOPC CHAR(1) INIT('2C'X),/* ASSOCIATE OPCODE   1203
*                                                            @Y30LB02*/
*              2 * CHAR(1) INIT('00'X),/* RESERVED AND ZERO  @Y30LB02*/
*              2 ASDAFLG BIT(16) INIT('0000000000000000'B),/* TWO  1203
*                                      BYTE ATTRIBUTE AREA   @Y30LB02*/
*               3 ASASSOC BIT(1),   /* ASSOCIATE ATTRIBUTE   @Y30LB02*/
*               3 ASDASSOC BIT(1),  /* DISASSOCIATE ATTRIBUTE      1203
*                                                            @Y30LB02*/
*               3 * BIT(1),         /* THREE BITS RESERVE    @Y30LB02*/
*               3 ASDEINT BIT(1),   /* DISASSOC AND DEINITIALIZE THE
*                                      INTERFACE FOR THE OTHER CPU 1203
*                                      SPECIFIED IN THE CPU ASSOCIATE
*                                      TABLE                 @Y30LB02*/
*               3 ASDMNT BIT(1),    /* ASSOC CPUS AND DEMOUNT ALL  1203
*                                      VOLUMES FOR BOTH CPUS @Y30LB02*/
*               3 * BIT(9),         /* RESERVED AND MUST BE ZERO   1203
*                                                            @Y30LB02*/
*              2 ASDACPU CHAR(5) INIT('0000000000'X),/* HOSTID     1203
*                                                            @Y30LB02*/
*              2 ASDA002 CHAR(3) INIT('000000'X);/* RESERVED AREA  1203
*                                                            @Y30LB02*/
*           ASDAFLG=(DISONLY);      /* VALUE OF FLAGS PARAMETER    1204
*                                                            @Y30LB02*/
         MVC   ASDAFLG(2),@CB02617                                 1204
*           ASDACPU=(ICBCPUID);     /* HOSTID                @Y30LB02*/
         MVC   ASDACPU(5),ICBCPUID(@14)                            1205
*           SVC(126);               /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 1206
*           RFY                                                    1207
*             ASDAR1 UNRSTD;        /* UNRESTRICT REG 1      @Y30LB02
*                                                            @G24LB05*/
*           IF R15=GOODIO           /* GOOD DISASSOCIATE?    @G24LB02*/
*             THEN                  /* DISASSOCIATE OK       @G24LB02*/
         LTR   R15,R15                                             1208
         BZ    @RT01208                                            1208
*             ;                     /* NO SPECIAL PROCESSING @G24LB02*/
*           ELSE                                                   1210
*             IF R0^=NOTMP          /* PROBLEM WITH                1210
*                                      DISASSOCIATE@G24LB05          */
*               THEN                                               1210
         CH    R0,@CH02703                                         1210
         BE    @RF01210                                            1210
*               DO;                 /* TRACK FOR SHUTDOWN OF MSSC  1211
*                                                            @G24LB02*/
*                 FAILCODE=R0;      /* CANNOT TOLERATE DISASSOC. FAIL
*                                                            @G24LB02*/
         ST    R0,FAILCODE                                         1212
*                 CLEANCOD=DISAFAIL;/* SAY DISASSOCIATE FAILED     1213
*                                                            @G24LB02*/
         MVC   CLEANCOD(4),@CF02605                                1213
*                 GOTO ERRMSG;                                     1214
         B     ERRMSG                                              1214
*               END;                /* INVESTIGATING NONZERO       1215
*                                      DISASSOCIATE CODE     @G24LB02*/
*             ELSE                                                 1216
*               DO;                                                1216
@RF01210 DS    0H                                                  1217
*                 ICBMSCMP=OFF;     /* TURN OFF MP FLAG      @G24LB05*/
*                 ICBMSCA=ON;       /* INDICATE POSSIBLE AP  @G24LB05*/
         L     @14,CVTPTR                                          1218
         L     @14,CVTEXT2(,@14)                                   1218
         L     @14,CVTICB(,@14)                                    1218
         OI    ICBMSCA(@14),B'00000010'                            1218
         NI    ICBMSCMP(@14),B'11111011'                           1218
*                 R15=GOODIO;       /* SET FOR GOOD IO       @G24LB05*/
         SLR   R15,R15                                             1219
*               END;                                               1220
*                                                                  1220
*           /*********************************************************/
*           /*                                                       */
*           /* FOR NON-MP-HARDWARE, DISASSOCIATE IS ISSUED ONLY      */
*           /*                                               @G24LB02*/
*           /* AS A TRIGGER FOR MSVC INITIALIZATION, AND WILL BE     */
*           /*                                               @G24LB02*/
*           /* REJECTED BY MSC SINCE THAT HOST IS NOT POTENTIAL      */
*           /*                                               @G24LB02*/
*           /* TIGHTLY COUPLED MP PAIR MEMBER                @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1221
*         END;                      /* JUST ONE CPU AND NO PURGE   1221
*                                      PROC.                 @G24LB02*/
*       ELSE                        /* MORE THAN ONE CPU, MUST BE 2
*                                      (NO PURGE)            @G24LB02*/
*         DO;                       /* NEED TO ASSOCIATE THEM      1222
*                                                            @G24LB02*/
         B     @RC01198                                            1222
@RF01198 DS    0H                                                  1223
*IICBASD1:                                                         1223
*                                                                  1223
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /* MACMEAN MSSC ASSOCIATE MACRO                  @Y30LB02*/
*           /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00        @Y30LB02*/
*           /* THIS IS THE OUTPUT FOR A SECONDARY            @Y30LB02*/
*           /* INVOCATION OF THE STANDARD FORM MACRO         @Y30LB02*/
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1223
*           RFY                                                    1223
*            (ASDAR1) RSTD;         /* RESTRICT REG 1        @Y30LB02*/
IICBASD1 DS    0H                                                  1224
*           ASDAR1=ADDR(ASDALEN);   /* R1 PTR TO BLK         @Y30LB02*/
         LA    ASDAR1,ASDALEN                                      1224
*           ASDALEN='10'X;          /* LENGTH OF ASSOC REQUEST     1225
*                                                            @Y30LB02*/
         LA    @14,16                                              1225
         ST    @14,ASDALEN                                         1225
*           ASDAOPC='2C'X;          /* ASSOC OPCODE          @Y30LB02*/
         MVI   ASDAOPC,X'2C'                                       1226
*           ASDAFLG=(ASOCONLY);     /* VALUE OF FLAGS PARAMETER    1227
*                                                            @Y30LB02*/
         MVC   ASDAFLG(2),@CB02619                                 1227
*           ASDACPU=(ICBCPUID);     /* HOSTID                @Y30LB02*/
         L     @14,CVTPTR                                          1228
         L     @14,CVTEXT2(,@14)                                   1228
         L     @14,CVTICB(,@14)                                    1228
         MVC   ASDACPU(5),ICBCPUID(@14)                            1228
*           SVC(126);               /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 1229
*           RFY                                                    1230
*             ASDAR1 UNRSTD;        /* UNRESTRICT REG 1      @Y30LB02
*                                                            @G24LB05*/
*           IF R15=GOODIO           /* WAS ASSOCIATE ALL CLEAR?    1231
*                                                            @G24LB02*/
*             THEN                  /* ASSOCIATE OK, ALL IS FINE   1231
*                                                            @G24LB02*/
         LTR   R15,R15                                             1231
         BZ    @RT01231                                            1231
*             ;                     /* 2 TCMP CPUS ASSOCIATED      1232
*                                                            @G24LB02*/
*           ELSE                    /* NONZERO RETURN FROM ASSOCIATE
*                                                            @G24LB02*/
*             DO;                   /* MSS INOPERATIVE       @G24LB02*/
*               FAILCODE=R0;        /* FATAL TO 3850 USE     @G24LB02*/
         ST    R0,FAILCODE                                         1234
*               CLEANCOD=ASOCFAIL;  /* TRACK                 @G24LB02*/
         MVC   CLEANCOD(4),@CF02607                                1235
*               GOTO ERRMSG;                                       1236
         B     ERRMSG                                              1236
*             END;                  /*                       @G24LB02*/
*         END;                      /* OF 2 CPU AND NO PURGE @G24LB02*/
*     END;                          /* OF NO PURGE CASE      @G24LB02*/
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*              PURGE IN FOLLOWING CASES                    @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1240
*   ELSE                            /* PURGE WAS SPECIFIED   @G24LB02*/
*     DO;                           /* MUST PURGE            @G24LB02*/
         B     @RC01195                                            1240
@RF01195 DS    0H                                                  1241
*       IF ICBMSCMP=OFF             /* ONE CPU IN THIS IPL ? @G24LB05*/
*         THEN                      /* JUST ONE CPU IN THIS SYSTEM 1241
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          1241
         L     @14,CVTEXT2(,@14)                                   1241
         L     @14,CVTICB(,@14)                                    1241
         TM    ICBMSCMP(@14),B'00000100'                           1241
         BNZ   @RF01241                                            1241
*         DO;                       /* SET UP FOR ONE CPU ON LINE  1242
*                                                            @G24LB02*/
*IICBASD2:                                                         1243
*                                                                  1243
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************************************/
*           /* *                                             @Y30LB02*/
*           /* MACMEAN PURGE/ASSIGN/INITIALIZE/READY MACRO   @Y30LB02*/
*           /* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00       @Y30LB02*/
*           /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.      @Y30LB02*/
*           /* THE LIST FORM OF THIS MACRO SHOULD BE         @Y30LB02*/
*           /* INVOKED FIRST IN ORDER TO SET UP NECESSARY    @Y30LB02*/
*           /* DECLARES. IF THE COMPLETE ARGUMENT IS         @Y30LB02*/
*           /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.       @Y30LB02*/
*           /* *******************************************************/
*           /* *                                             @Y30LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1243
*           RFY                                                    1243
*            (PAIRR1) RSTD;         /* RESTRICT R1           @Y30LB02*/
IICBASD2 DS    0H                                                  1244
*           PAIRR1=ADDR(PURGLIST);  /* SET PAIRR1 TO REQ BLOCK     1244
*                                                            @Y30LB02*/
         LA    PAIRR1,PURGLIST                                     1244
*           PURGLL='0D'X;           /* SET LENGTH FIELD      @Y30LB02*/
         LA    @14,13                                              1245
         ST    @14,PURGLL                                          1245
*           PURGOP='14'X;           /* PURG OPCODE           @Y30LB02*/
         MVI   PURGOP,X'14'                                        1246
*           SVC(126);               /* ISSUE SVC INST.       @Y30LB02*/
         SVC   126                                                 1247
*           RFY                                                    1248
*            (PAIRR1) UNRSTD;       /* UNRESTRICT R1         @Y30LB02
*                                      ISSUE THE PURGE       @G24LB02*/
*           IF R15=GOODIO           /* WAS I/O TO MSC FOR PURGE    1249
*                                      SUCCESSFUL ?          @G24LB02*/
*             THEN                  /* PURGE SUCCESSFUL      @G24LB02*/
         LTR   R15,R15                                             1249
         BNZ   @RF01249                                            1249
*             DO;                   /* TRACK THAT PURGE WAS        1250
*                                      SUCCESSFUL            @G24LB02*/
*               PRGXQTD=ON;         /* MSC EXECUTED THE PURGE      1251
*                                                            @G24LB02*/
         OI    PRGXQTD,B'00100000'                                 1251
*             END;                  /* NOTING THAT HAVE PURGED     1252
*                                                            @G24LB02*/
*           ELSE                    /* PURGE RETURNED NONZERO I/O  1253
*                                      CODE                  @G24LB02*/
*             DO;                   /* PURGE NOT SUCCESSFUL, @G24LB02*/
*                                                                  1253
         B     @RC01249                                            1253
@RF01249 DS    0H                                                  1254
*               /*****************************************************/
*               /*                                                   */
*               /* INFORM SYSTEM OPERATOR                    @G24LB02*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1254
*               PLACCONV=R0;        /* STORE CODE FOR CONVERSION   1254
*                                                            @G24LB02*/
         ST    R0,PLACCONV                                         1254
*               RESPECIFY                                          1255
*                 R0 RESTRICTED;    /* FOR CONVERSION        @G24LB02*/
*               CALL RCTOEBC;       /* GET EBCDIC VERSION    @G24LB02*/
         BAL   @14,RCTOEBC                                         1256
*               RESPECIFY                                          1257
*                 R0 UNRESTRICTED;  /* CONVERSION OVER       @G24LB02*/
*               PRGRC=PLAC234;      /* STORE INTO MESSAGE    @G24LB02*/
         MVC   PRGRC(3),PLAC234                                    1258
*               IF CVTNIP=ON THEN   /* TEST FOR NIP IN CTL   @G24LB02*/
         L     @14,CVTPTR                                          1259
         TM    CVTNIP(@14),B'00010000'                             1259
         BNO   @RF01259                                            1259
*                 DO;               /* NIP IN CONTROL CODE   @G24LB02*/
*IIEAPMN7:                          /* 7TH ICBMSG05 USE OF MACRO   1261
*                                      IEAPMNIP              @G24LB02*/
*                   GEN(IEAPMNIP TYPE=WTO,PARAM=PRGMSGH)/*   @G24LB02*/
*                   REFS(NVTWTO,PRGMSGH);/* BAD PURGE MSG    @G24LB02*/
IIEAPMN7 IEAPMNIP TYPE=WTO,PARAM=PRGMSGH
*                 END;              /* END NIP IN CONTROL CODE     1262
*                                                            @G24LB02*/
*               ELSE                /* NIP NOT IN CONTROL    @G24LB02*/
*                 DO;               /* NIP NOT IN CONTROL CODE     1263
*                                                            @G24LB02*/
         B     @RC01259                                            1263
@RF01259 DS    0H                                                  1264
*                   WTOGEN03=MSG010;/* PRIME WTO BUFFER      @G24LB02*/
         MVI   WTOGEN03+38,C' '                                    1264
         MVC   WTOGEN03+39(34),WTOGEN03+38                         1264
         MVC   WTOGEN03(38),MSG010                                 1264
*                   WTOGEN03(35:37)=PRGRC;/* PUT IN REASON CODE    1265
*                                                            @G24LB02*/
         MVC   WTOGEN03+34(3),PRGRC                                1265
*                   CALL ICBMSG45;  /* CALL WTO SUB-ROUTINE  @G24LB02*/
         BAL   @14,ICBMSG45                                        1266
*                 END;              /* END NIP NOT IN CONTROL CODE 1267
*                                                            @G24LB02*/
*             END;                  /* HAVE TOLD OPERATOR    @G24LB02*/
*                                                                  1268
@RC01259 DS    0H                                                  1269
*           /*********************************************************/
*           /*                                                       */
*           /* NOW ISSUE THE DISASSOCIATE                    @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1269
*IICBASD4:                                                         1269
*                                                                  1269
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /* MACMEAN MSSC ASSOCIATE MACRO                  @Y30LB02*/
*           /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00        @Y30LB02*/
*           /* THIS IS THE OUTPUT FOR A SECONDARY            @Y30LB02*/
*           /* INVOCATION OF THE STANDARD FORM MACRO         @Y30LB02*/
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1269
*           RFY                                                    1269
*            (ASDAR1) RSTD;         /* RESTRICT REG 1        @Y30LB02*/
@RC01249 DS    0H                                                  1269
IICBASD4 DS    0H                                                  1270
*           ASDAR1=ADDR(ASDALEN);   /* R1 PTR TO BLK         @Y30LB02*/
         LA    ASDAR1,ASDALEN                                      1270
*           ASDALEN='10'X;          /* LENGTH OF ASSOC REQUEST     1271
*                                                            @Y30LB02*/
         LA    @14,16                                              1271
         ST    @14,ASDALEN                                         1271
*           ASDAOPC='2C'X;          /* ASSOC OPCODE          @Y30LB02*/
         MVI   ASDAOPC,X'2C'                                       1272
*           ASDAFLG=(DISONLY);      /* VALUE OF FLAGS PARAMETER    1273
*                                                            @Y30LB02*/
         MVC   ASDAFLG(2),@CB02617                                 1273
*           ASDACPU=(ICBCPUID);     /* HOSTID                @Y30LB02*/
         L     @14,CVTPTR                                          1274
         L     @14,CVTEXT2(,@14)                                   1274
         L     @14,CVTICB(,@14)                                    1274
         MVC   ASDACPU(5),ICBCPUID(@14)                            1274
*           SVC(126);               /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 1275
*           RFY                                                    1276
*             ASDAR1 UNRSTD;        /* UNRESTRICT REG 1      @Y30LB02
*                                      DISASSOC.             @G24LB05*/
*           RFY                                                    1277
*             R0 RSTD;              /* FOR REASON CODE NUMBER      1277
*                                                            @G24LB02*/
*           IF R15=GOODIO           /* WAS DISASSOCIATE GOOD?      1278
*                                                            @G24LB02*/
*             THEN                                                 1278
         LTR   R15,R15                                             1278
         BZ    @RT01278                                            1278
*             ;                     /* SUCCESSFUL DISASSOCIATE     1279
*                                                            @G24LB02*/
*           ELSE                    /* NONZERO DISASSOCIATE REASON 1280
*                                      CODE                  @G24LB02*/
*             IF R0^=NOTMP THEN     /* NOT UP                @G24LB05*/
         CH    R0,@CH02703                                         1280
         BE    @RF01280                                            1280
*               DO;                 /* NONZERO DISASSOCIATE REASON 1281
*                                      CODE                  @G24LB02*/
*                 FAILCODE=R0;      /* REMEMBER REASON       @G24LB02*/
         ST    R0,FAILCODE                                         1282
*                 CLEANCOD=DISAFAIL;/* DISASSOCIATE FAILURE  @G24LB02*/
         MVC   CLEANCOD(4),@CF02605                                1283
*                 GOTO ERRMSG;      /*                       @G24LB02*/
         B     ERRMSG                                              1284
*               END;                /*                       @G24LB02*/
*             ELSE                  /*                       @ZA16134*/
*               DO;                                                1286
@RF01280 DS    0H                                                  1287
*                 ICBMSCMP=OFF;     /* INDICATE NOT MP       @G24LB05*/
*                 ICBMSCA=ON;       /* INDICATE POSSIBLE AP  @G24LB05*/
         L     @14,CVTPTR                                          1288
         L     @14,CVTEXT2(,@14)                                   1288
         L     @14,CVTICB(,@14)                                    1288
         OI    ICBMSCA(@14),B'00000010'                            1288
         NI    ICBMSCMP(@14),B'11111011'                           1288
*                 R15=GOODIO;       /* SET FOR GOOD IO       @G24LB05*/
         SLR   R15,R15                                             1289
*               END;                                               1290
*                                                                  1290
*           /*********************************************************/
*           /*                                                       */
*           /* FOR NON-MP-HARDWARE, DISASSOCIATE IS ISSUED ONLY      */
*           /*                                               @G24LB02*/
*           /* AS A TRIGGER FOR MSVC INITIALIZATION, AND WILL BE     */
*           /*                                               @G24LB02*/
*           /* REJECTED BY MSC SINCE THAT HOST IS NOT POTENTIAL      */
*           /*                                               @G24LB02*/
*           /* TIGHTLY COUPLED MP PAIR MEMBER. THEREFORE,    @G24LB02*/
*           /* REJECTION BY THE MSC IS IGNORED BY THIS CODE  @G24LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1291
*         END;                      /* PROCESSING 1 CPU & PURGE    1291
*                                                            @G24LB02*/
*       ELSE                        /* 2 CPUS AND PURGE REQUEST    1292
*                                                            @G24LB02*/
*         DO;                       /* ISSUE PURGE WITH ASSOCIATE  1292
*                                                            @G24LB02*/
         B     @RC01241                                            1292
@RF01241 DS    0H                                                  1293
*IICBASD5:                                                         1293
*                                                                  1293
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /* MACMEAN MSSC ASSOCIATE MACRO                  @Y30LB02*/
*           /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00        @Y30LB02*/
*           /* THIS IS THE OUTPUT FOR A SECONDARY            @Y30LB02*/
*           /* INVOCATION OF THE STANDARD FORM MACRO         @Y30LB02*/
*           /* *******************************************************/
*           /* **                                            @Y30LB02*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1293
*           RFY                                                    1293
*            (ASDAR1) RSTD;         /* RESTRICT REG 1        @Y30LB02*/
IICBASD5 DS    0H                                                  1294
*           ASDAR1=ADDR(ASDALEN);   /* R1 PTR TO BLK         @Y30LB02*/
         LA    ASDAR1,ASDALEN                                      1294
*           ASDALEN='10'X;          /* LENGTH OF ASSOC REQUEST     1295
*                                                            @Y30LB02*/
         LA    @14,16                                              1295
         ST    @14,ASDALEN                                         1295
*           ASDAOPC='2C'X;          /* ASSOC OPCODE          @Y30LB02*/
         MVI   ASDAOPC,X'2C'                                       1296
*           ASDAFLG=(ASOCWPRG);     /* VALUE OF FLAGS PARAMETER    1297
*                                                            @Y30LB02*/
         MVC   ASDAFLG(2),@CB02621                                 1297
*           ASDACPU=(ICBCPUID);     /* HOSTID                @Y30LB02*/
         L     @14,CVTPTR                                          1298
         L     @14,CVTEXT2(,@14)                                   1298
         L     @14,CVTICB(,@14)                                    1298
         MVC   ASDACPU(5),ICBCPUID(@14)                            1298
*           SVC(126);               /* INVOKE THE SVC        @Y30LB02*/
         SVC   126                                                 1299
*           RFY                                                    1300
*             ASDAR1 UNRSTD;        /* UNRESTRICT REG 1      @Y30LB02
*                                      ASSOC &PRG@G24LB05            */
*           IF R15=GOODIO           /* WERE PURGE AND ASSOCIATE OK ?
*                                                            @G24LB02*/
*             THEN                  /* BOTH WENT WELL        @G24LB02*/
         LTR   R15,R15                                             1301
         BNZ   @RF01301                                            1301
*             DO;                   /* TRACK PURGE EXECUTION WENT  1302
*                                      WELL                  @G24LB02*/
*               PRGXQTD=ON;         /* MSC EXECUTED THE PURGE      1303
*                                                            @G24LB02*/
         OI    PRGXQTD,B'00100000'                                 1303
*               PURGBIT=OFF;        /* PURGE COMPLETED INDC  @G24LB02*/
         L     @14,PURGPTR                                         1304
         NI    PURGBIT(@14),B'01111111'                            1304
*             END;                  /* FOR FUTURE REFERENCE  @G24LB02*/
*           ELSE                    /* ASSOCIATE FAILED (WITH PURGE)
*                                                            @G24LB02*/
*             DO;                   /* REMEMBER CAUSE OF FAILURE   1306
*                                                            @G24LB02*/
         B     @RC01301                                            1306
@RF01301 DS    0H                                                  1307
*               FAILCODE=R0;        /* FAILURE CODE SET FOR NP19FAIL
*                                                            @G24LB02*/
         ST    R0,FAILCODE                                         1307
*               CLEANCOD=ASOCFAIL;  /* REMEMBER AS ASSOC FAILURE   1308
*                                                            @G24LB02*/
         MVC   CLEANCOD(4),@CF02607                                1308
*             END;                  /* TRACKING PURGE + ASSOC FAILURE
*                                      FOR NP19FAIL          @G24LB02*/
*         END;                      /* LOGIC FOR 2 CPUS AND PURGE  1310
*                                                            @G24LB02*/
@RC01301 DS    0H                                                  1311
*     END;                          /* PURGE REQUESTED CODE IN     1311
*                                      SOCIATE               @G24LB02*/
@RC01241 DS    0H                                                  1312
*ERRMSG:                                                           1312
*   PLACCONV=FAILCODE;              /* PLACE CODE FOR CONVERSION   1312
*                                                            @G24LB02*/
@RC01195 DS    0H                                                  1312
ERRMSG   MVC   PLACCONV(4),FAILCODE                                1312
*   RESPECIFY                                                      1313
*     R0 RESTRICTED;                /* FOR CONVERSION        @G24LB02*/
*   CALL RCTOEBC;                   /* DISASSOCIATE CODE FROM HEX TO
*                                      EBCDIC                @G24LB02*/
         BAL   @14,RCTOEBC                                         1314
*   RESPECIFY                                                      1315
*     R0 UNRESTRICTED;              /* CONVERSION OVER       @G24LB02*/
*   IF ICBS=ON&(CLEANCOD=DISAFAILCLEANCOD=ASOCFAIL) THEN          1316
         L     @14,CVTPTR                                          1316
         L     @14,CVTEXT2(,@14)                                   1316
         L     @14,CVTICB(,@14)                                    1316
         TM    ICBS(@14),B'00001000'                               1316
         BNO   @RF01316                                            1316
         L     @14,CLEANCOD                                        1316
         CH    @14,@CH02605                                        1316
         BE    @RT01316                                            1316
         CH    @14,@CH02607                                        1316
         BNE   @RF01316                                            1316
@RT01316 DS    0H                                                  1317
*     DO;                           /*                       @G24LB02*/
*       REQLIST1=''B;               /* ZERO LIST 1           @G24LB02*/
         XC    REQLIST1(40),REQLIST1                               1318
*       INILNGTH=INILEN;            /* SET REQ BLK LENGTH    @G24LB02*/
         L     @14,INITPTR                                         1319
         LH    @00,INILEN                                          1319
         ST    @00,INILNGTH(,@14)                                  1319
*       INITOPCD=INICODE;           /* SET OP CODE           @G24LB02*/
         MVI   INITOPCD(@14),X'88'                                 1320
*       INIDISAB=ON;                /* SET DISABLE FLAG      @G24LB02*/
         OI    INIDISAB(@14),B'00100000'                           1321
*       INIABLE=ON;                 /* SET MSVI FLAG ON      @G24LB02*/
*       INIJRNL=ON;                 /* SET JOURNAL FLAG      @G24LB02*/
         OI    INIABLE(@14),B'01100000'                            1323
*       RFY                                                        1324
*         R1 RSTD;                  /*                       @G24LB02*/
*       R1=INITPTR;                 /* SET PARAMETER REG     @G24LB02*/
         LR    R1,@14                                              1325
*       SVC(126);                   /* INVOKE SVC 126        @G24LB02*/
         SVC   126                                                 1326
*       RFY                                                        1327
*         R1 UNRSTD;                /*                       @G24LB02*/
*     END;                          /*                       @G24LB02*/
*   IF CVTNIP=ON THEN                                              1329
@RF01316 L     @14,CVTPTR                                          1329
         TM    CVTNIP(@14),B'00010000'                             1329
         BNO   @RF01329                                            1329
*     DO;                           /*                       @G24LB02*/
*       IF CLEANCOD=DISAFAIL        /* WAS IT DISASSOCIATE FAILURE?
*                                                            @G24LB02*/
*         THEN                      /* DISASSOCIATE FAILED   @G24LB02*/
         CLC   CLEANCOD(4),@CF02605                                1331
         BNE   @RF01331                                            1331
*         DO;                       /* BUILD DISASSOCIATE FAILURE  1332
*                                      MESSAGE               @G24LB02*/
*           NMESNUM=DISAMNUM;       /* DISASSOCIATE FAILURE NUMBER 1333
*                                                            @G24LB02*/
         L     @14,NMESPTR                                         1333
         MVC   NMESNUM(3,@14),DISAMNUM                             1333
*           NMESTEXT(1:LENGTH(DISATEXT))=DISATEXT;/* & TEXT  @G24LB02*/
         MVC   NMESTEXT(51,@14),DISATEXT                           1334
*           NMESTEXT(49:51)=PLAC234;/* MOVE REASON CODE TO MESSAGE 1335
*                                                            @G24LB02*/
         MVC   NMESTEXT+48(3,@14),PLAC234                          1335
*IIEAPMND:                          /* 8TH IEAVNP19 USE OF IEAPMNIP
*                                      MACRO                 @G24LB02*/
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*             @G24LB02*/
*           REFS(NVTWTO,NMSGH);     /* OPERATOR SHOWN ONE LINE     1336
*                                                            @G24LB02*/
IIEAPMND IEAPMNIP TYPE=WTO,PARAM=NMSGH
*           ICBI=OFF;               /* INIT INDICATOR SET OFF      1337
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          1337
         L     @14,CVTEXT2(,@14)                                   1337
         L     @14,CVTICB(,@14)                                    1337
         NI    ICBI(@14),B'01111111'                               1337
*         END;                      /* DISASSOCIATE FAILURE MESSAGE
*                                      BUILT                 @G24LB02*/
*       ELSE                        /* NOT DISASSOCIATE FAILURE    1339
*                                                            @ZM31050*/
*         IF CLEANCOD=ASOCFAIL      /* ASSOCIATE FAILURE ?   @ZM31050*/
*           THEN                    /* YES, ASSOCIATE FAILED @ZM31050*/
         B     @RC01331                                            1339
@RF01331 CLC   CLEANCOD(4),@CF02607                                1339
         BNE   @RF01339                                            1339
*           DO;                     /*                       @ZM31050*/
*             NMESNUM=ASSCMNUM;     /* NUMBER FOR ASSOCIATE FAILURE
*                                      MSG                   @G24LB02*/
         L     @14,NMESPTR                                         1341
         MVC   NMESNUM(3,@14),ASSCMNUM                             1341
*             NMESTEXT(1:LENGTH(ASSCTEXT))=ASSCTEXT;/* & WORDS     1342
*                                                            @G24LB02*/
         MVC   NMESTEXT(48,@14),ASSCTEXT                           1342
*             NMESTEXT(46:48)=PLAC234;/* REASON CODE INTO MESSAGE  1343
*                                                            @G24LB02*/
         MVC   NMESTEXT+45(3,@14),PLAC234                          1343
*IIEAPMNE:                          /* 8TH IEAVNP19 USE OF IEAPMNIP
*                                      MACRO                 @G24LB02*/
*             GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*           @G24LB02*/
*             REFS(NVTWTO,NMSGH);   /* OPERATOR SHOWN ONE LINE     1344
*                                                            @G24LB02*/
IIEAPMNE IEAPMNIP TYPE=WTO,PARAM=NMSGH
*             ICBI=OFF;             /* INIT INDICATOR SET OFF      1345
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          1345
         L     @14,CVTEXT2(,@14)                                   1345
         L     @14,CVTICB(,@14)                                    1345
         NI    ICBI(@14),B'01111111'                               1345
*           END;                    /* ASSOCIATE FAILURE MESSAGE HAS
*                                      BEEN BUILT            @G24LB02*/
*     END;                          /*                       @G24LB02*/
*   ELSE                                                           1348
*     DO;                           /*                       @G24LB02*/
         B     @RC01329                                            1348
@RF01329 DS    0H                                                  1349
*       IF CLEANCOD=DISAFAIL THEN                                  1349
         CLC   CLEANCOD(4),@CF02605                                1349
         BNE   @RF01349                                            1349
*         DO;                       /*                       @G24LB02*/
*           MSG984S(34:36)=PLAC234; /*                       @G24LB02*/
         MVC   MSG984S+33(3),PLAC234                               1351
*           WTOGEN03=MSG984;        /*                       @G24LB02*/
         MVI   WTOGEN03+62,C' '                                    1352
         MVC   WTOGEN03+63(10),WTOGEN03+62                         1352
         MVC   WTOGEN03(62),MSG984                                 1352
*           CALL ICBMSG45;          /*                       @G24LB02*/
         BAL   @14,ICBMSG45                                        1353
*           ICBI=OFF;               /* INIT INDICATOR SET OFF      1354
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          1354
         L     @14,CVTEXT2(,@14)                                   1354
         L     @14,CVTICB(,@14)                                    1354
         NI    ICBI(@14),B'01111111'                               1354
*         END;                      /*                       @G24LB02*/
*       ELSE                                                       1356
*         IF CLEANCOD=ASOCFAIL THEN                                1356
         B     @RC01349                                            1356
@RF01349 CLC   CLEANCOD(4),@CF02607                                1356
         BNE   @RF01356                                            1356
*           DO;                     /*                       @G24LB02*/
*             MSG979(54:56)=PLAC234;/*                       @G24LB02*/
         MVC   MSG979+53(3),PLAC234                                1358
*             WTOGEN03=MSG979;      /*                       @G24LB02*/
         MVI   WTOGEN03+57,C' '                                    1359
         MVC   WTOGEN03+58(15),WTOGEN03+57                         1359
         MVC   WTOGEN03(57),MSG979                                 1359
*             CALL ICBMSG45;        /*                       @G24LB02*/
         BAL   @14,ICBMSG45                                        1360
*             ICBI=OFF;             /* INIT INDICATOR SET OFF      1361
*                                                            @G24LB02*/
         L     @14,CVTPTR                                          1361
         L     @14,CVTEXT2(,@14)                                   1361
         L     @14,CVTICB(,@14)                                    1361
         NI    ICBI(@14),B'01111111'                               1361
*           END;                    /*                       @G24LB02*/
*     END;                          /*                       @G24LB02*/
@RF01356 DS    0H                                                  1363
@RC01349 DS    0H                                                  1364
*   RFY                                                            1364
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
@RC01329 DS    0H                                                  1365
*   R14=SOCRET;                     /* RESTORE RETURN ADDRESS      1365
*                                                            @G24LB02*/
         L     R14,SOCRET                                          1365
*   RFY                                                            1366
*     R14 UNRSTD;                   /* FOR BRANCH BACK       @G24LB02*/
*   END SOCIATE;                    /* MSC KNOWS HOST STATUS NOW   1367
*                                                            @G24LB02*/
@EL00007 DS    0H                                                  1367
@EF00007 DS    0H                                                  1367
@ER00007 BR    @14                                                 1367
*                                                                  1368
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/*  RCTOEBC: CONVERT REASON CODE TO EBCDIC                  @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUT: PLACCONV HAS THE REASON CODE                     @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESSING: CONVERTS A FIXED REASON CODE TO EBCDIC       @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  PLAC234 HAS THE EBCDIC VERSION                  @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1368
*RCTOEBC:                                                          1368
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* HEX TO EBC       @G24LB02*/
RCTOEBC  DS    0H                                                  1369
*   DCL                                                            1369
*     CONVSAV POINTER(31);          /* TO SAVE RETURN ADDRESS      1369
*                                                            @G24LB02*/
*   DCL                                                            1370
*     SIXTEEN FIXED(8) CONSTANT(16);/* FOR SHIFTING          @G24LB02*/
*   RFY                                                            1371
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
*   CONVSAV=R14;                    /* SAVE CALLERS RETURN ADDR    1372
*                                                            @G24LB02*/
         ST    R14,CONVSAV                                         1372
*   RFY                                                            1373
*     R14 UNRSTD;                   /* FREE UP 14            @G24LB02*/
*   PLAC234=PLAC234*SIXTEEN;        /* SHIFT LEFT FOUR       @G24LB02*/
         SLR   @14,@14                                             1374
         ICM   @14,7,PLAC234                                       1374
         SLA   @14,4                                               1374
         STCM  @14,7,PLAC234                                       1374
*   GEN(OI PLAC4,X'0F')             /* OR IN AN F            @G24LB02*/
*   REFS(PLAC4);                    /*                       @G24LB02*/
         OI PLAC4,X'0F'
*   UNPK(PLACCONV,PLAC34);          /*                       @G24LB02*/
         UNPK  PLACCONV(4),PLAC34(2)                               1376
*   IF PLAC2>'F9'X                  /* IS 2ND BYTE TOO LARGE?      1377
*                                                            @G24LB02*/
*     THEN                          /* 2ND BYTE IS TOO LARGE @G24LB02*/
         CLI   PLAC2,249                                           1377
         BNH   @RF01377                                            1377
*     PLAC2=PLAC2-'39'X;            /* DECREMENT IT          @G24LB02*/
         SLR   @14,@14                                             1378
         IC    @14,PLAC2                                           1378
         SH    @14,@CH00064                                        1378
         STC   @14,PLAC2                                           1378
*   ELSE                            /* 2ND BYTE OK           @G24LB02*/
*     ;                             /*                       @G24LB02*/
@RF01377 DS    0H                                                  1380
*   IF PLAC3>'F9'X                  /* IS 3RD BYTE TOO LARGE?      1380
*                                                            @G24LB02*/
*     THEN                          /* 3RD BYTE IS TOO LARGE @G24LB02*/
         CLI   PLAC3,249                                           1380
         BNH   @RF01380                                            1380
*     PLAC3=PLAC3-'39'X;            /* DECREMENT IT          @G24LB02*/
         SLR   @14,@14                                             1381
         IC    @14,PLAC3                                           1381
         SH    @14,@CH00064                                        1381
         STC   @14,PLAC3                                           1381
*   ELSE                            /* 3RD BYTE OK           @G24LB02*/
*     ;                             /*                       @G24LB02*/
@RF01380 DS    0H                                                  1383
*   IF PLAC4>'F9'X                  /* IS 4TH BYTE TOO LARGE?      1383
*                                                            @G24LB02*/
*     THEN                          /* 4TH BYTE IS TOO LARGE @G24LB02*/
         CLI   PLAC4,249                                           1383
         BNH   @RF01383                                            1383
*     PLAC4=PLAC4-'39'X;            /* DECREMENT IT          @G24LB02*/
         SLR   @14,@14                                             1384
         IC    @14,PLAC4                                           1384
         SH    @14,@CH00064                                        1384
         STC   @14,PLAC4                                           1384
*   ELSE                            /* 4TH BYTE OK           @G24LB02*/
*     ;                             /*                       @G24LB02*/
@RF01383 DS    0H                                                  1386
*   RFY                                                            1386
*     R14 RSTD;                     /* FOR RETURN ADDRESS    @G24LB02*/
*   R14=CONVSAV;                    /* RESTORE RETURN ADDRESS      1387
*                                                            @G24LB02*/
         L     R14,CONVSAV                                         1387
*   RFY                                                            1388
*     R14 UNRSTD;                   /* FREE UP 14 FOR BRANCH @G24LB02*/
*   END RCTOEBC;                    /* END REASON/RETURN CODE      1389
*                                      CONVERSION SEGMENT    @G24LB02*/
@EL00008 DS    0H                                                  1389
@EF00008 DS    0H                                                  1389
@ER00008 BR    @14                                                 1389
*MAKNOTRD:                                                         1390
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
MAKNOTRD DS    0H                                                  1391
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME:  MAKNOTRD                                @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:  NONE                                             @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS:  IF PURGE SPECIFIED AT IPL TIME THIS ROUTINE    @G24LB02*/
*/*           MARKS 3330V UCB'S NOT READY                    @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  3330V UCB'S NOT READY                           @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1391
*   RFY                                                            1391
*    (R14) RSTD;                    /*                       @G24LB02*/
*   NOTRDRET=R14;                   /*                       @G24LB02*/
         ST    R14,NOTRDRET                                        1392
*   RFY                                                            1393
*    (R14) UNRSTD;                  /*                       @G24LB02*/
*   SCANEND=OFF;                    /* SET FLAG OFF          @G24LB02*/
         NI    SCANEND,B'01111111'                                 1394
*   BEGPTR=CVTILK2;                 /*                       @G24LB02*/
         L     @14,CVTPTR                                          1395
         L     @14,CVTILK2(,@14)                                   1395
         ST    @14,BEGPTR                                          1395
*   UCBPTR=BEGPTR->ADRUCB;          /*                       @G24LB02*/
         SLR   @11,@11                                             1396
         ICM   @11,3,ADRUCB(@14)                                   1396
         ST    @11,UCBPTR                                          1396
*UCBTST:                                                           1397
*   DO WHILE SCANEND^=ON;           /*                       @G24LB02*/
UCBTST   B     @DE01397                                            1397
@DL01397 DS    0H                                                  1398
*     CALL UCBSCAN;                 /*                       @G24LB02*/
*                                                                  1398
         BAL   @14,UCBSCAN                                         1398
*     /***************************************************************/
*     /*                                                             */
*     /* IF WE HAVE NOT REACHED END OF UCB'S, MARK UCB NOT READY     */
*     /*                                                     @G24LB02*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1399
*     IF SCANEND^=ON THEN           /*                       @G24LB02*/
         TM    SCANEND,B'10000000'                                 1399
         BO    @RF01399                                            1399
*       DO;                         /*                       @G24LB02*/
*         UCBNOTRD=ON;              /* MARK UCB NOT READY    @G24LB02*/
         L     @14,UCBPTR                                          1401
         OI    UCBNOTRD(@14),B'01000000'                           1401
*         UCBPRSRS=OFF;             /* TURNOFF PERM RESID ATTR BIT 1402
*                                                            @G24LB02*/
*         UCBBPRV=OFF;              /* TURNOFF PRIV ATTR     @G24LB02*/
*         UCBBSTR=OFF;              /* TURNOFF STORARGE ATTR @G24LB02*/
         NI    UCBPRSRS(@14),B'11001011'                           1404
*         UCBVTOC=''B;              /* ZERO ANY VTOC TTR THAT MIGHT
*                                      BE THERE ALREADY      @G24LB02*/
         XC    UCBVTOC(4,@14),UCBVTOC(@14)                         1405
*         UCBVOLI=''B;              /* ZERO ANY EXISTING VOLSER    1406
*                                                            @G24LB02*/
         XC    UCBVOLI(6,@14),UCBVOLI(@14)                         1406
*         UCBSTAT=UCBSTAT&'80'X;    /* CLEAR STAT BIT EXCEPT FOR   1407
*                                      ONLINE BIT            @G24LB02*/
         NI    UCBSTAT(@14),X'80'                                  1407
*         BEGPTR=BEGPTR+ANINC;      /* UPDATE PTR TO UCB LOOK UP   1408
*                                      TABLE.                @G24LB02*/
         LA    @14,2                                               1408
         AL    @14,BEGPTR                                          1408
         ST    @14,BEGPTR                                          1408
*         UCBPTR=BEGPTR->ADRUCB;    /* POINT TO UCB          @G24LB02*/
         SLR   @11,@11                                             1409
         ICM   @11,3,ADRUCB(@14)                                   1409
         ST    @11,UCBPTR                                          1409
*       END;                        /* MARKING UCB'S NOT READY     1410
*                                                            @G24LB02*/
*   END;                            /* SCANEND IS NOW ON     @G24LB02*/
@RF01399 DS    0H                                                  1411
@DE01397 TM    SCANEND,B'10000000'                                 1411
         BNO   @DL01397                                            1411
*   RFY                                                            1412
*    (R14) RSTD;                    /*                       @G24LB02*/
*   R14=NOTRDRET;                   /* RESTORE REG 14        @G24LB02*/
         L     R14,NOTRDRET                                        1413
*   RFY                                                            1414
*    (R14) UNRSTD;                  /*                       @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
@EL00009 DS    0H                                                  1415
@EF00009 DS    0H                                                  1415
@ER00009 BR    @14                                                 1415
*   END MAKNOTRD;                   /*                       @G24LB02*/
*UCBSCAN:                                                          1417
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
UCBSCAN  DS    0H                                                  1418
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME:  UCBSCAN                                 @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:  UCBPTR POINTING TO EITHER FIRST, OR UPDATED TO   @G24LB02*/
*/*         POINT TO NEXT UCB                                @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS:  SCANS UCB'S TO FIND 3330V UCB'S AND PASS       @G24LB02*/
*/*           ADDRESS BACK TO CALLER                         @G24LB02*/
*/*                                                          @G24LB02*/
*/* CALLED:  RDLABLS                                         @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  UCBPTR HAS ADDRESS OF UCB TO BE USED BY CALLER  @G24LB02*/
*/*          WHEN END OF LOOKUP TABLE REACHED SCANEND = ON   @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1418
*   RFY                                                            1418
*    (R14) RSTD;                    /*                       @X50AC01*/
*   SCANRET=R14;                    /* SAVE RETURN ADDRESS   @G24LB02*/
         ST    R14,SCANRET                                         1419
*   FINDSW=OFF;                     /* CLEAR SWITCH FOR VUCB FIND  1420
*                                                            @XDR2048*/
         NI    FINDSW,B'11111011'                                  1420
*   RFY                                                            1421
*    (R14) UNRSTD;                  /*                       @X50AC01*/
*   RFY                                                            1422
*    (R0) RSTD;                     /*                       @X50AC01*/
*NXTUCB:                                                           1423
*   IF UCBPTR^=FOXES THEN           /* IS IT END OF LOOK UP TABLE  1423
*                                                            @G24LB02*/
NXTUCB   L     @14,UCBPTR                                          1423
         SLR   @01,@01                                             1423
         ICM   @01,3,FOXES                                         1423
         CR    @14,@01                                             1423
         BE    @RF01423                                            1423
*     IF UCBPTR^=F0&                /*                       @G24LB02*/
*         UCB3DACC=ON&              /* MAKE SURE ITS DASD    @ZA20254*/
*         UCBTBYT4=('09'X)&         /* 3330 DEVICE           @G24LB02*/
*         UCBRVDEV=ON THEN          /* VIRTUAL 3330          @G24LB02*/
         LTR   @14,@14                                             1424
         BZ    @RF01424                                            1424
         TM    UCB3DACC(@14),B'00100000'                           1424
         BNO   @RF01424                                            1424
         CLI   UCBTBYT4(@14),X'09'                                 1424
         BNE   @RF01424                                            1424
         TM    UCBRVDEV(@14),B'00001000'                           1424
         BNO   @RF01424                                            1424
*       DO;                         /* VIRTUAL DASD FOUND CODE     1425
*                                                            @XDR2048*/
*         IF RDLAB=ON THEN          /* CALLER IS READ LABELS @XDR2048*/
         TM    RDLAB,B'00000010'                                   1426
         BNO   @RF01426                                            1426
*           FINDSW=ON;              /* SET FIND EXIT SWITCH  @XDR2048*/
         OI    FINDSW,B'00000100'                                  1427
*         ELSE                      /* CALLER IS MAKNOTRD    @XDR2048*/
*           IF UCBNOTRD=OFF&        /* DEVICE READY          @XDR2048*/
*               UCBONLI=ON THEN     /* DEVICE ONLINE         @XDR2048*/
         B     @RC01426                                            1428
@RF01426 L     @14,UCBPTR                                          1428
         TM    UCBNOTRD(@14),B'01000000'                           1428
         BNZ   @RF01428                                            1428
         TM    UCBONLI(@14),B'10000000'                            1428
         BNO   @RF01428                                            1428
*             FINDSW=ON;            /* SET FIND EXIT SWITCH  @XDR2048*/
         OI    FINDSW,B'00000100'                                  1429
*         IF FINDSW=ON THEN         /* IS PASSBACK REQ D     @XDR2048*/
@RF01428 DS    0H                                                  1430
@RC01426 TM    FINDSW,B'00000100'                                  1430
         BNO   @RF01430                                            1430
*           R0=UCBPTR;              /* PASSBACK UCB ADDR     @XDR2048*/
         L     R0,UCBPTR                                           1431
*         ELSE                      /* UCB NOT NEEDED        @XDR2048*/
*           DO;                     /* SET SCAN POINTERS     @XDR2048*/
         B     @RC01430                                            1432
@RF01430 DS    0H                                                  1433
*             BEGPTR=BEGPTR+ANINC;  /*                       @XDR2048*/
         LA    @14,2                                               1433
         AL    @14,BEGPTR                                          1433
         ST    @14,BEGPTR                                          1433
*             UCBPTR=BEGPTR->ADRUCB;/*                       @XDR2048*/
         SLR   @01,@01                                             1434
         ICM   @01,3,ADRUCB(@14)                                   1434
         ST    @01,UCBPTR                                          1434
*             GOTO NXTUCB;          /* CHECK NEXT UCB        @XDR2048*/
         B     NXTUCB                                              1435
*           END;                    /* END SET SCAN PTRS     @XDR2048*/
*       END;                        /* END VIRTUAL DASD FOUND CODE 1437
*                                                            @XDR2048*/
*     ELSE                          /* INCREMENT POINTER     @G24LB02*/
*       DO;                         /* SO THAT IT            @G24LB02*/
         B     @RC01424                                            1438
@RF01424 DS    0H                                                  1439
*         BEGPTR=BEGPTR+ANINC;      /* WILL NOW              @G24LB02*/
         LA    @14,2                                               1439
         AL    @14,BEGPTR                                          1439
         ST    @14,BEGPTR                                          1439
*         UCBPTR=BEGPTR->ADRUCB;    /* POINT TO NEXT UCB     @G24LB02*/
         SLR   @01,@01                                             1440
         ICM   @01,3,ADRUCB(@14)                                   1440
         ST    @01,UCBPTR                                          1440
*         GO TO NXTUCB;             /*                       @G24LB02*/
         B     NXTUCB                                              1441
*       END;                        /*                       @G24LB02*/
*   ELSE                            /*                       @G24LB02*/
*     SCANEND=ON;                   /*                       @G24LB02*/
         B     @RC01423                                            1443
@RF01423 OI    SCANEND,B'10000000'                                 1443
*   RFY                                                            1444
*    (R0) UNRSTD;                   /*                       @X50AC01*/
@RC01423 DS    0H                                                  1445
*   RFY                                                            1445
*    (R14) RSTD;                    /*                       @X50AC01*/
*   R14=SCANRET;                    /*                       @G24LB02*/
         L     R14,SCANRET                                         1446
*   RFY                                                            1447
*    (R14) UNRSTD;                  /*                       @X50AC01*/
*   RETURN;                         /*                       @G24LB02*/
@EL00010 DS    0H                                                  1448
@EF00010 DS    0H                                                  1448
@ER00010 BR    @14                                                 1448
*   END UCBSCAN;                    /*                       @G24LB02*/
*RDLABLS:                                                          1450
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
RDLABLS  DS    0H                                                  1451
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME:  RDLABLS                                 @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:  NONE                                             @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS:  THIS ROUTINE DOES A                            @G24LB02*/
*/*           GETMAIN FOR SUBPOOL 245 TO GET STORAGE IN      @G24LB02*/
*/*           WHICH TO BUILD IOB,DCB,DEB,CCW'S AND A BUFFER. @G24LB02*/
*/*           A CALL IS DONE TO UCBSCAN TO FIND 3330V UCB'S. @G24LB02*/
*/*           ON RETURN FROM UCBSCAN THE DEB,ECB AND IOB ARE @G24LB02*/
*/*           COMPLETED AND AN EXCP IS ISSUED TO READ THE    @G24LB02*/
*/*           VOLUME LABEL.  IF SUCCESSFUL I/O COMPLETION    @G24LB02*/
*/*           THEN THE UCBVOLI FIELD IS COMPLETED AND A CALL @G24LB02*/
*/*           TO TTRCNVT IS DONE TO COMPLETE UCBVTOC.  NEXT  @G24LB02*/
*/*           A CALL IS DONE TO DUBLABCK TO CHECK FOR        @G24LB02*/
*/*           DUPLICATE VOLUME LABELS IN UCB'S.  THE UCB     @G24LB02*/
*/*           POINTER IS INCREMENTED AND THE ECB IS ZEROED.  @G24LB02*/
*/*           WHEN THE END OF THE LOOKUP TABLE IS REACHED,   @G24LB02*/
*/*           GOTTEN STORAGE IS FREED.                       @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  UCB'S WITH FIELDS UCBVOLI AND UCBVTOC FILLED IN @G24LB02*/
*/*                                                          @G24LB02*/
*/* MESSAGE: 'ICB983I VOLUME NOT CONSIDERED IN SYSTEM'WHICH  @G24LB02*/
*/*           WILL ONLY APPEAR IF EXCP READ FAILED AND       @G24LB02*/
*/*           MESSAGE WILL FOLLOW IEA000I MESSAGE.           @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1451
*   RFY                                                            1451
*    (R14) RSTD;                    /*                       @X50AC01*/
*   READRET=R14;                    /*                       @G24LB02*/
         ST    R14,READRET                                         1452
*   RFY                                                            1453
*    (R14) UNRSTD;                  /*                       @X50AC01*/
*   SCANEND=OFF;                    /*                       @G24LB02*/
         NI    SCANEND,B'01111111'                                 1454
*   RFY                                                            1455
*    (R0,                                                          1455
*     R1,                                                          1455
*     R15) RSTD;                    /* RESTRICT FOR GETMAIN  @G24LB02*/
*   R0=LENGTH(IOBSTDRD)+LENGTH(IHADCB)+LENGTH(DEBBASIC)+LENGTH(DEBDASD)
*       +LENGTH(DEB)+LENGTH(RDSNCCWS)+LENGTH(LABLBUFF);/*    @G24LB02*/
         LA    R0,273                                              1456
*   R1=ZERO;                        /* CLEAR REG 1 FOR GETMAIN     1457
*                                                            @G24LB02*/
         SLR   R1,R1                                               1457
*   R15=SP245;                      /* SET SUB POOL ID       @G24LB02*/
         LA    R15,245                                             1458
*IGETMAI2:                          /* LABEL GETMAIN         @G24LB02*/
*   GEN REFS(R0,R1,R15) SETS(R0,R1,R15);                           1459
IGETMAI2 DS    0H                                                  1459
*                                           /* GEN FOR GMAIN  @G24LB02*
        GETMAIN RC,LV=(R0),SP=(R15),BNDRY=DBLWD,                       *
                RELATED=('FREED AFTER MSC IO(IFREEMA2)')
*   IF R15=ZERO THEN                /* CHECK FOR ERROR       @G24LB02*/
         LTR   R15,R15                                             1460
         BNZ   @RF01460                                            1460
*     DO;                           /* GOOD GETMAIN CODE     @G24LB02*/
*       IOBSTPT2=R1;                /* IOB POINTER           @G24LB02*/
         ST    R1,IOBSTPT2                                         1462
*       RFY                                                        1463
*        (R0,                                                      1463
*         R1,                                                      1463
*         R15) UNRSTD;              /*                       @G24LB02*/
*       DCBPTR2=IOBSTPT2+LENGTH(IOBSTDRD);/* DCB POINTER     @G24LB02*/
         L     @15,IOBSTPT2                                        1464
         LA    @14,32                                              1464
         ALR   @15,@14                                             1464
         ST    @15,DCBPTR2                                         1464
*       DEBPTR2=DCBPTR2+LENGTH(IHADCB);/* DEB POINTER        @G24LB02*/
         AH    @15,@CH02691                                        1465
         ST    @15,DEBPTR2                                         1465
*       DEBAPPA2=DEBPTR2+LENGTH(DEBBASIC)+LENGTH(DEBDASD);         1466
         LA    @11,48                                              1466
         ALR   @11,@15                                             1466
         ST    @11,DEBAPPA2                                        1466
*       DEBDAPT2=DEBPTR2+LENGTH(DEBBASIC);/*                 @G24LB02*/
         ALR   @15,@14                                             1467
         ST    @15,DEBDAPT2                                        1467
*       RDCCWPTR=DEBAPPA2+LENGTH(DEB);/* CCW POINTER         @G24LB02*/
         AH    @11,@CH01975                                        1468
         ST    @11,RDCCWPTR                                        1468
*       BUFFPTR=RDCCWPTR+LENGTH(RDSNCCWS);/* POINTER         @G24LB02
*                                      TO THE READ LABELS BUFFER   1469
*                                                            @G24LB02*/
         AH    @11,@CH00433                                        1469
         ST    @11,BUFFPTR                                         1469
*       RFY                                                        1470
*         IOBSTDRD BASED(IOBSTPT2); /*                       @G24LB02*/
*       RFY                                                        1471
*         IHADCB BASED(DCBPTR2);    /* SPECIFY NEW BASE            1471
*                                      POINTER@G24LB02               */
*       RFY                                                        1472
*         DEBBASIC BASED(DEBPTR2);  /* FOR CONTROL BLOCKS    @G24LB02*/
*       RFY                                                        1473
*         DEBDASD BASED(DEBDAPT2);  /* POINTER TO DA SECT    @G24LB02
*                                      OF DEB                @G24LB02*/
*       RFY                                                        1474
*         DEB BASED(DEBAPPA2);      /*                       @G24LB02*/
*       BEGPTR=CVTILK2;             /* PICKS UP UCB TABLE    @G24LB02
*                                      POINTER FROM CVT.     @G24LB02*/
         L     @01,CVTPTR                                          1475
         L     @15,CVTILK2(,@01)                                   1475
         ST    @15,BEGPTR                                          1475
*       UCBPTR=BEGPTR->ADRUCB;      /* MAKE UCBPTR POINT TO UCB    1476
*                                                            @G24LB02*/
         SLR   @14,@14                                             1476
         ICM   @14,3,ADRUCB(@15)                                   1476
         ST    @14,UCBPTR                                          1476
*       CALL BLDBLOCK;              /* SET UP THE IO BLOCKS FOR EXCP
*                                                            @G24LB02*/
         BAL   @14,BLDBLOCK                                        1477
*       RDLAB=ON;                   /* SET RDLABLS CALLER SWITCH   1478
*                                                            @XDR2048*/
         OI    RDLAB,B'00000010'                                   1478
*       DO WHILE SCANEND^=ON;       /* UNTIL END OF UCB'S    @G24LB02*/
         B     @DE01479                                            1479
@DL01479 DS    0H                                                  1480
*         CALL UCBSCAN;             /* SCAN FOR THE RIGHT DEV'S    1480
*                                                            @G24LB02*/
         BAL   @14,UCBSCAN                                         1480
*         IF SCANEND^=ON THEN       /* UNTIL WE REACH END OF UCB'S 1481
*                                                            @G24LB02*/
         TM    SCANEND,B'10000000'                                 1481
         BO    @RF01481                                            1481
*           DO;                     /* THE INIT OF CNTRL BLKS FOR  1482
*                                      EXCP                  @G24LB02*/
*             IF UCBONLI=ON&UCBNOTRD=OFF THEN/* TEST ON AND RDY    1483
*                                                            @G24LB02*/
         L     @15,UCBPTR                                          1483
         TM    UCBONLI(@15),B'10000000'                            1483
         BNO   @RF01483                                            1483
         TM    UCBNOTRD(@15),B'01000000'                           1483
         BNZ   @RF01483                                            1483
*               DO;                 /* DO IO TO DEVICE       @G24LB02*/
*                 UCBQISCE=OFF;     /* CLEAR DEVICE QUIESCE BIT    1485
*                                                            @G24LB02*/
         NI    UCBQISCE(@15),B'11111110'                           1485
*                 DEBUCBA=UCBPTR;   /* SET THE UCB ADDR IN THE DEB 1486
*                                                            @G24LB02
*                                      FOR EXCP              @G24LB02*/
         L     @14,DEBDAPT2                                        1486
         STCM  @15,7,DEBUCBA(@14)                                  1486
*                 ICBECB=ZERO;      /* ZERO I/O ECB          @G24LB02*/
         L     @01,CVTPTR                                          1487
         L     @01,CVTEXT2(,@01)                                   1487
         L     @01,CVTICB(,@01)                                    1487
         SLR   @00,@00                                             1487
         ST    @00,ICBECB(,@01)                                    1487
*                 IOBFLAG1=F0;      /* ZERO THE IOB FLAGS AND SENSE
*                                                            @G24LB02
*                                      BYTES                 @G24LB02*/
         L     @15,IOBSTPT2                                        1488
         MVI   IOBFLAG1(@15),X'00'                                 1488
*                 DCBIFLGS='0C'X;   /* NO ERP PROCESSING     @G24LB02*/
         L     @01,DCBPTR2                                         1489
         MVI   DCBIFLGS+40(@01),X'0C'                              1489
*                 IOBFLAG2=F0;      /* ZERO FLAG BYTE 2 IN IOB     1490
*                                                            @G24LB02*/
         MVI   IOBFLAG2(@15),X'00'                                 1490
*                 IOBSENS0=F0;      /* ZERO SENSE BYTE 1 IN IOB    1491
*                                                            @G24LB02*/
         MVI   IOBSENS0(@15),X'00'                                 1491
*                 IOBSENS1=F0;      /* ZERO SECOND SENSE BYTE      1492
*                                                            @G24LB02*/
         MVI   IOBSENS1(@15),X'00'                                 1492
*                 DEBDVMOD=F0;      /* CLEAR MODE IN THE DEB @G24LB02*/
         MVI   DEBDVMOD(@14),X'00'                                 1493
*                 IOBCMDCH=ON;      /* SET COMMAND CHAIN IN THE IOB
*                                                            @G24LB02*/
*                 IOBUNREL=ON;      /* SET IOBUNRELATED FLAG IN IOB
*                                                            @G24LB02*/
         OI    IOBCMDCH(@15),B'01000010'                           1495
*                 IOBSTRTB=RDCCWPTR;/* PUT THE CCW ADDRESS IN THE  1496
*                                                            @G24LB02
*                                      IOB FOR EXCP .        @G24LB02*/
         MVC   IOBSTRTB(3,@15),RDCCWPTR+1                          1496
*                 RFY                                              1497
*                   R1 RSTD;        /*                       @G24LB02*/
*                 R1=IOBSTPT2;      /* SET UP REGISTER FOR EXCP    1498
*                                                            @G24LB02*/
         LR    R1,@15                                              1498
*                 ACTPOST=OFF;      /* SET ACTIVITY POSTED FLAG OFF
*                                                            @XM02594*/
*                 TMEPOST=OFF;      /*                       @G24LB02*/
         NI    ACTPOST,B'11011011'                                 1500
*                 GEN(EXCP (R1));   /* ISSUE THE EXCP        @G24LB02*/
*                                                                  1501
         EXCP (R1)
*                 /***************************************************/
*                 /*                                                 */
*                 /* WE HAVE TO TIME THE SIO TO MAKE SURE WE DON'T   */
*                 /* GET HUNG IN IOS QUEUE DUE TO DEVICE BUSY. IF WE */
*                 /* DO WE PURGE THE I/O REQUEST, SET VUCB OFFLINE   */
*                 /* AND ISSUE A DEMOUNT BY VUA FOR IT       @G24LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1502
*                 RFY                                              1502
*                   R3 RSTD;        /* RESTRICT REG 3        @G24LB02*/
*                 R3=ICB2ACTP;      /* SET PTR TO TIMER EXIT RTN   1503
*                                                            @G24LB02*/
         L     @15,CVTPTR                                          1503
         L     @15,CVTEXT2(,@15)                                   1503
         L     @15,CVTICB(,@15)                                    1503
         L     R3,ICB2ACTP(,@15)                                   1503
*                 RFY                                              1504
*                   R3 UNRSTD;      /* FREE REG 3            @G24LB02*/
*ISTIMER1:                          /* SET TIMER FOR 1 SECOND      1505
*                                                            @G24LB02*/
*                 GEN REFS(R3,TMER)(STIMER REAL,(R3),BINTVL=TMER);/*
*                                                            @G24LB02*/
ISTIMER1 STIMER REAL,(R3),BINTVL=TMER
*                 ICBACTV=ZERO;     /* CLEAR THE TIMER ECB   @G24LB02*/
         L     @15,CVTPTR                                          1506
         L     @15,CVTEXT2(,@15)                                   1506
         L     @15,CVTICB(,@15)                                    1506
         SLR   @00,@00                                             1506
         ST    @00,ICBACTV(,@15)                                   1506
*                 RFY                                              1507
*                   R1 UNRSTD;      /*                       @G24LB02*/
*                 DO WHILE ACTPOST^=ON;/* LOOP UNTIL ACTV POSTED   1508
*                                                            @XM02594*/
         B     @DE01508                                            1508
@DL01508 DS    0H                                                  1509
*                   CALL WAITRTN;   /* WAIT FOR COMPLETION OF I/O  1509
*                                                            @G24LB02*/
         BAL   @14,WAITRTN                                         1509
*                 END;              /* WAIT FOR LABEL READ COMPLETE
*                                                            @XM02594*/
*                                                                  1510
@DE01508 TM    ACTPOST,B'00100000'                                 1510
         BNO   @DL01508                                            1510
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE TIMER POPS BEFORE THE I/0 IS POSTED THEN */
*                 /*                                         @G24LB02*/
*                 /* TMEPOST FLAG WILL BE ON. IN THIS CASE, WE PURGE */
*                 /*                                         @G24LB02*/
*                 /* THE I/O, SET UCB OFFLINE AND NOT READY, CLEAR   */
*                 /* THE                                     @G24LB02*/
*                 /* VOLID AND VTOC FIELDS, AND ISSUE A DEMOUNT BY   */
*                 /* VUA                                     @G24LB02*/
*                 /* FOR THE UNIT.                           @G24LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1511
*                 IF TMEPOST=OFF THEN/*                      @G24LB02*/
         TM    TMEPOST,B'00000100'                                 1511
         BNZ   @RF01511                                            1511
*                   DO;             /*                       @G24LB02*/
*                     GEN(TTIMER CANCEL);/* CANCEL TIMER     @G24LB02*/
         TTIMER CANCEL
*                   END;            /*                       @G24LB02*/
*                 IF TMEPOST=ON THEN/*                       @G24LB02*/
@RF01511 TM    TMEPOST,B'00000100'                                 1515
         BNO   @RF01515                                            1515
*                   DO;             /*                       @G24LB02*/
*                     RFY                                          1517
*                       R1 RSTD;    /*                       @G24LB02*/
*                     R1=ADDR(PURGPARM);/* SET PURGE PARM POINTER  1518
*                                                            @G24LB02*/
         LA    R1,PURGPARM                                         1518
*                     PURGPARM=''B; /* CLEAR PURGE PARM AREA @G24LB02*/
         XC    PURGPARM(16),PURGPARM                               1519
*                     PUROPT='A0'X; /* DEB PURG WITH HALTIO  @G24LB02*/
         MVI   PUROPT,X'A0'                                        1520
*                     PURDEB=DCBDEBAD;/* SET DEB POINTER     @G24LB02*/
         L     @15,DCBPTR2                                         1521
         MVC   PURDEB(3),DCBDEBAD+41(@15)                          1521
*                     PURTCB=ICBTCB;/* SET TCB POINTER       @G24LB02*/
         L     @15,CVTPTR                                          1522
         L     @15,CVTEXT2(,@15)                                   1522
         L     @15,CVTICB(,@15)                                    1522
         MVC   PURTCB(3),ICBTCB+1(@15)                             1522
*                     PURCHN=ADDR(DEBUSRPG);/* CHAINING ADDRESS    1523
*                                                            @G24LB02*/
         L     @15,DEBPTR2                                         1523
         LA    @00,DEBUSRPG(,@15)                                  1523
         STCM  @00,7,PURCHN                                        1523
*IPURGE1:                           /* ISSUE PURGE FOR THIS IO     1524
*                                      REQUEST               @G24LB02*/
*                     GEN(PURGE (R1));/*                     @G24LB02*/
IPURGE1  PURGE (R1)
*                     RFY                                          1525
*                       R1 UNRSTD;  /*                       @G24LB02*/
*                     UCBNOTRD=ON;  /* SET UCB NOT READY BIT @G24LB02*/
         L     @15,UCBPTR                                          1526
         OI    UCBNOTRD(@15),B'01000000'                           1526
*                     UCBPRSRS=OFF; /* TURNOFF PERM RESID ATTR BIT 1527
*                                                            @G24LB02*/
*                     UCBBPRV=OFF;  /* TURNOFF PRIV ATTR     @G24LB02*/
*                     UCBBSTR=OFF;  /* TURNOFF STORARGE ATTR @G24LB02*/
         NI    UCBPRSRS(@15),B'11001011'                           1529
*                     UCBVOLI=''B;  /* ZERO ANY VOL SER THAT MIGHT BE
*                                                            @G24LB02
*                                      THERE ALREADY.        @G24LB02*/
         XC    UCBVOLI(6,@15),UCBVOLI(@15)                         1530
*                     UCBVTOC=''B;  /* AND ANY VTOC TTR      @G24LB02*/
         XC    UCBVTOC(4,@15),UCBVTOC(@15)                         1531
*                     UCBSTAT=''B;  /* CLEAR STAT FIELD      @G24LB02*/
         MVI   UCBSTAT(@15),X'00'                                  1532
*IMNTDE5:                                                          1533
*                                                                  1533
*                     /***********************************************/
*                     /*                                             */
*                     /* MACRO INVOCATION:                   @ZA28964*/
*                     /* ICBMNTDE MF(E,DMTLIST,COMPLETE)TYPE(DMNT)VOL*/
*                     /* ID(UCBVOLI)VUA(UCBCHAN)             @ZA28964*/
*                     /* *********************************************/
*                     /* ************                        @Y30LB02*/
*                     /* MACMEAN MSSC MOUNT/DEMOUNT MACRO    @Y30LB02*/
*                     /* VERSION - VS/2 REL 3 77/12/15 LEVEL 04      */
*                     /*                                     @ZA28964*/
*                     /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.    */
*                     /*                                     @Y30LB02*/
*                     /* THE LIST FORM OF THIS MACRO SHOULD BE       */
*                     /*                                     @Y30LB02*/
*                     /* INVOKED FIRST IN ORDER TO SET UP NECESSARY  */
*                     /*                                     @Y30LB02*/
*                     /* DECLARES. IF THE COMPLETE ARGUMENT IS       */
*                     /*                                     @Y30LB02*/
*                     /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.     */
*                     /*                                     @Y30LB02*/
*                     /* *********************************************/
*                     /* ************                        @Y30LB02*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1533
*                     RFY                                          1533
*                       MDREG1 RSTD;/* RESTRICT REG 1        @Y30LB02*/
IMNTDE5  DS    0H                                                  1534
*                     MDREG1=ADDR(DMTLIST);/* R1 PTR TO REQ BLOCK  1534
*                                                            @Y30LB02*/
         LA    MDREG1,DMTLIST                                      1534
*                     DMTLIST=DMTLIST&&DMTLIST;/* ZERO OUT BLOCK   1535
*                                                            @Y30LB02*/
         XC    DMTLIST(28),DMTLIST                                 1535
*                     DMLEN='1C'X;  /* LENGTH OF DEMOUNT REQUEST   1536
*                                      BLOCK                 @Y30LB02*/
         LA    @00,28                                              1536
         ST    @00,DMLEN                                           1536
*                     DMOPCD='06'X; /* DEMOUNT OPCODE        @Y30LB02*/
         MVI   DMOPCD,X'06'                                        1537
*                     DMVOL=(UCBVOLI);/* VALUE OF VOLID      @Y30LB02*/
         L     @15,UCBPTR                                          1538
         MVC   DMVOL(6),UCBVOLI(@15)                               1538
*                     DMNTVUA=(UCBCHAN);/* FILL VUA          @ZDR2048*/
         MVC   DMNTVUA(2),UCBCHAN(@15)                             1539
*                     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE
*                                      FLAG                  @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                                1540
*                     SVC(126);     /* INVOKE THE MSSC SVC   @Y30LB02*/
         SVC   126                                                 1541
*                     RFY                                          1542
*                       MDREG1 UNRSTD;/* UNREST REG 1        @Y30LB02
*                                                            @G24LB02*/
*                   END;            /*                       @G24LB02*/
*                 ELSE              /*                       @G24LB02*/
*                   IF ICBECB^=GOODCOMP THEN/* IS IT GOOD I/O      1544
*                                                            @G24LB02*/
         B     @RC01515                                            1544
@RF01515 L     @01,CVTPTR                                          1544
         L     @01,CVTEXT2(,@01)                                   1544
         L     @01,CVTICB(,@01)                                    1544
         CLC   ICBECB(4,@01),GOODCOMP                              1544
         BE    @RF01544                                            1544
*                     DO;           /*                       @G24LB02*/
*                                                                  1545
*                       /*********************************************/
*                       /*                                           */
*                       /* THE I/0 ECB HAS BEEN POSTED. IF THE POST  */
*                       /* CODE                              @G24LB02*/
*                       /* IS NOT GOOD WE CLEAR THE UCB. IF THE ERROR*/
*                       /*                                   @G24LB02*/
*                       /* INDICATED INTERVENTION REQUIRED, WE SET   */
*                       /* THE UCB                           @G24LB02*/
*                       /* ONLINE AND NOT READY. OTHER ERRORS ARE    */
*                       /* CONSIDERED                        @G24LB02*/
*                       /* TERMINAL AT THIS POINT AND THE UCB IS LEFT*/
*                       /* OFFLINE                           @G24LB02*/
*                       /* AND NOT READY, THE NORMAL LABEL READ      */
*                       /* FAILURE                           @G24LB02*/
*                       /* MESSAGE IS SENT TO THE OPERATOR, AND A    */
*                       /* DEMOUNT BY                        @G24LB02*/
*                       /* VUA IS ISSUED FOR THE UNIT.       @G24LB02*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1546
*                       UCBNOTRD=ON;/* SET UCB NOT READY BIT @G24LB02*/
         L     @15,UCBPTR                                          1546
         OI    UCBNOTRD(@15),B'01000000'                           1546
*                       UCBPRSRS=OFF;/* TURNOFF PERM RESID ATTR BIT
*                                                            @G24LB02*/
*                       UCBBPRV=OFF;/* TURNOFF PRIV ATTR     @G24LB02*/
*                       UCBBSTR=OFF;/* TURNOFF STORARGE ATTR @G24LB02*/
         NI    UCBPRSRS(@15),B'11001011'                           1549
*                       UCBVOLI=''B;/* ZERO ANY VOL SER THAT MIGHT BE
*                                                            @G24LB02
*                                      THERE ALREADY.        @G24LB02*/
         XC    UCBVOLI(6,@15),UCBVOLI(@15)                         1550
*                       UCBVTOC=''B;/* AND ANY VTOC TTR      @G24LB02*/
         XC    UCBVTOC(4,@15),UCBVTOC(@15)                         1551
*                       UCBSTAT='00'X;/* CLEAR STATUS BITS   @G24LB02*/
*                                                                  1552
         MVI   UCBSTAT(@15),X'00'                                  1552
*                       /*********************************************/
*                       /*                                           */
*                       /* IF UNIT CHECK WITH INVENTION REQUIRED THEN*/
*                       /*                                   @G24LB02*/
*                       /* SET THE VUCB ONLINE               @G24LB02*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1553
*                       IF UCHECK=ON&SIOCODE^=BIT3&IOBS0B1=ON THEN/*
*                                                            @G24LB02*/
         L     @14,IOBSTPT2                                        1553
         TM    UCHECK(@14),B'00000010'                             1553
         BNO   @RF01553                                            1553
         TM    SIOCODE(@14),B'00110000'                            1553
         BO    @RF01553                                            1553
         TM    IOBS0B1(@14),B'01000000'                            1553
         BNO   @RF01553                                            1553
*                         UCBONLI=ON;/* SET UNIT ONLINE      @G24LB02*/
         OI    UCBONLI(@15),B'10000000'                            1554
*                       ELSE        /*                       @G24LB02*/
*                         DO;       /*                       @G24LB02*/
         B     @RC01553                                            1555
@RF01553 DS    0H                                                  1556
*                           WTOGEN03=MESSG9;/* READ LABELS FAILED  1556
*                                      MESSAGE               @G24LB02
*                                      ICB983I INTO WTO AREA.      1556
*                                                            @G24LB02*/
         MVI   WTOGEN03+41,C' '                                    1556
         MVC   WTOGEN03+42(31),WTOGEN03+41                         1556
         MVC   WTOGEN03(41),MESSG9                                 1556
*                           CALL ICBMSG45;/* CALL WTO ROUTINE TO PUT
*                                      OUT                   @G24LB02
*                                      MESSAGE TO SYSTEM OPERATOR  1557
*                                                            @G24LB02*/
*                                                                  1557
         BAL   @14,ICBMSG45                                        1557
*                           /*****************************************/
*                           /*                                       */
*                           /* ISSUE DEMOUNT VUA FOR UNIT. VOLUME    */
*                           /* MOUNTED IN                    @XDR2048*/
*                           /* MSS MUST BE DEMOUNTED TO SYNC         */
*                           /* HOST/MSC.                     @XDR2048*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  1558
*IMNTDE3:                           /* LABEL FOR MACRO CALL  @XDR2048*/
*                                                                  1558
*                           /*****************************************/
*                           /*                                       */
*                           /* MACRO INVOCATION:             @ZA28964*/
*                           /* ICBMNTDE MF(E,DMTLIST,COMPLETE)TYPE(DM*/
*                           /* NT)VOLID(UCBVOLI)VUA(UCBCHAN) @ZA28964*/
*                           /* ***************************************/
*                           /* ******************            @Y30LB02*/
*                           /* MACMEAN MSSC MOUNT/DEMOUNT MACRO      */
*                           /*                               @Y30LB02*/
*                           /* VERSION - VS/2 REL 3 77/12/15 LEVEL 04*/
*                           /*                               @ZA28964*/
*                           /* THIS IS THE OUTPUT FOR THE EXECUTE    */
*                           /* FORM.                         @Y30LB02*/
*                           /* THE LIST FORM OF THIS MACRO SHOULD BE */
*                           /*                               @Y30LB02*/
*                           /* INVOKED FIRST IN ORDER TO SET UP      */
*                           /* NECESSARY                     @Y30LB02*/
*                           /* DECLARES. IF THE COMPLETE ARGUMENT IS */
*                           /*                               @Y30LB02*/
*                           /* SPECIFIED THE REQ BLOCK WILL BE       */
*                           /* ZEROED.                       @Y30LB02*/
*                           /* ***************************************/
*                           /* ******************            @Y30LB02*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  1558
*                           RFY                                    1558
*                             MDREG1 RSTD;/* RESTRICT REG 1  @Y30LB02*/
IMNTDE3  DS    0H                                                  1559
*                           MDREG1=ADDR(DMTLIST);/* R1 PTR TO REQ  1559
*                                      BLOCK                 @Y30LB02*/
         LA    MDREG1,DMTLIST                                      1559
*                           DMTLIST=DMTLIST&&DMTLIST;/* ZERO OUT   1560
*                                      BLOCK                 @Y30LB02*/
         XC    DMTLIST(28),DMTLIST                                 1560
*                           DMLEN='1C'X;/* LENGTH OF DEMOUNT REQUEST
*                                      BLOCK                 @Y30LB02*/
         LA    @00,28                                              1561
         ST    @00,DMLEN                                           1561
*                           DMOPCD='06'X;/* DEMOUNT OPCODE   @Y30LB02*/
         MVI   DMOPCD,X'06'                                        1562
*                           DMVOL=(UCBVOLI);/* VALUE OF VOLID      1563
*                                                            @Y30LB02*/
         L     @15,UCBPTR                                          1563
         MVC   DMVOL(6),UCBVOLI(@15)                               1563
*                           DMNTVUA=(UCBCHAN);/* FILL VUA    @ZDR2048*/
         MVC   DMNTVUA(2),UCBCHAN(@15)                             1564
*                           DMVUAVAL='1'B;/* OR ON THE VUA VALID   1565
*                                      ATTRIBUTE FLAG        @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                                1565
*                           SVC(126);/* INVOKE THE MSSC SVC  @Y30LB02*/
         SVC   126                                                 1566
*                           RFY                                    1567
*                             MDREG1 UNRSTD;/* UNREST REG 1  @Y30LB02
*                                                            @XDR2048*/
*                                                                  1567
*                           /*****************************************/
*                           /*                                       */
*                           /* RETURN CODE NEED NOT BE CHECKED. EVEN */
*                           /* IF BAD                        @XDR2048*/
*                           /* WE WANT TO CONTINUE IPL.      @XDR2048*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  1568
*                         END;      /*                       @G24LB02*/
*                     END;          /*                       @G24LB02*/
*                   ELSE                                           1570
*                     DO;           /* FOR GOOD I/O.         @G24LB02*/
*                                                                  1570
         B     @RC01544                                            1570
@RF01544 DS    0H                                                  1571
*                       /*********************************************/
*                       /*                                           */
*                       /* THE SIO FOR LABEL READ WAS SUCCESSFUL. SET*/
*                       /* THE                               @G24LB02*/
*                       /* UCB VOLID AND VTOC FIELDS, CHECK FOR      */
*                       /* DUPLICATE                         @G24LB02*/
*                       /* VOLUME, AND SET THE UCB ONLINE AND READY  */
*                       /*                                   @G24LB02*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1571
*                       UCBONLI=ON; /* SET UCB ONLINE        @G24LB02*/
         L     @15,UCBPTR                                          1571
         OI    UCBONLI(@15),B'10000000'                            1571
*                       UCBVOLI=LABVOL;/* PUT VOLID INTO UCB @G24LB02*/
         L     @14,BUFFPTR                                         1572
         MVC   UCBVOLI(6,@15),LABVOL(@14)                          1572
*                       CALL TTRCNVT;/* GO TO CONVERT CCHHR TO TTR 1573
*                                                            @G24LB02*/
         BAL   @14,TTRCNVT                                         1573
*                       UCBVTOC=CNVRTD;/* PUT TTR INTO UCBVTOC FIELD
*                                                            @G24LB02*/
         L     @01,UCBPTR                                          1574
         MVC   UCBVTOC(4,@01),CNVRTD                               1574
*                       CALL DUPLABCK;/* DO DUPLICATE LABEL CHECK  1575
*                                                            @G24LB02*/
         BAL   @14,DUPLABCK                                        1575
*                     END;          /* UCB FILLING           @G24LB02*/
*               END;                /* END DO IO TO DEVICE   @G24LB02*/
*             ELSE                  /* NO READ LABEL IO DONE @G24LB02*/
*               DO;                 /* NO IO CODE            @G24LB02*/
*                                                                  1578
         B     @RC01483                                            1578
@RF01483 DS    0H                                                  1579
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE DEMOUNT VUA FOR UNIT. VOLUME MOUNTED IN   */
*                 /*                                         @XDR2048*/
*                 /* MSS MUST BE DEMOUNTED TO SYNC HOST/MSC. @XDR2048*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1579
*IMNTDE6:                           /* LABEL FOR MACRO CALL  @XDR2048*/
*                                                                  1579
*                 /***************************************************/
*                 /*                                                 */
*                 /* MACRO INVOCATION:                       @ZA28964*/
*                 /* ICBMNTDE MF(E,DMTLIST,COMPLETE)TYPE(DMNT)VOLID(U*/
*                 /* CBVOLI)VUA(UCBCHAN)                     @ZA28964*/
*                 /* *************************************************/
*                 /* ********                                @Y30LB02*/
*                 /* MACMEAN MSSC MOUNT/DEMOUNT MACRO        @Y30LB02*/
*                 /* VERSION - VS/2 REL 3 77/12/15 LEVEL 04  @ZA28964*/
*                 /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.        */
*                 /*                                         @Y30LB02*/
*                 /* THE LIST FORM OF THIS MACRO SHOULD BE   @Y30LB02*/
*                 /* INVOKED FIRST IN ORDER TO SET UP NECESSARY      */
*                 /*                                         @Y30LB02*/
*                 /* DECLARES. IF THE COMPLETE ARGUMENT IS   @Y30LB02*/
*                 /* SPECIFIED THE REQ BLOCK WILL BE ZEROED. @Y30LB02*/
*                 /* *************************************************/
*                 /* ********                                @Y30LB02*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1579
*                 RFY                                              1579
*                   MDREG1 RSTD;    /* RESTRICT REG 1        @Y30LB02*/
IMNTDE6  DS    0H                                                  1580
*                 MDREG1=ADDR(DMTLIST);/* R1 PTR TO REQ BLOCK      1580
*                                                            @Y30LB02*/
         LA    MDREG1,DMTLIST                                      1580
*                 DMTLIST=DMTLIST&&DMTLIST;/* ZERO OUT BLOCK @Y30LB02*/
         XC    DMTLIST(28),DMTLIST                                 1581
*                 DMLEN='1C'X;      /* LENGTH OF DEMOUNT REQUEST   1582
*                                      BLOCK                 @Y30LB02*/
         LA    @00,28                                              1582
         ST    @00,DMLEN                                           1582
*                 DMOPCD='06'X;     /* DEMOUNT OPCODE        @Y30LB02*/
         MVI   DMOPCD,X'06'                                        1583
*                 DMVOL=(UCBVOLI);  /* VALUE OF VOLID        @Y30LB02*/
         L     @15,UCBPTR                                          1584
         MVC   DMVOL(6),UCBVOLI(@15)                               1584
*                 DMNTVUA=(UCBCHAN);/* FILL VUA              @ZDR2048*/
         MVC   DMNTVUA(2),UCBCHAN(@15)                             1585
*                 DMVUAVAL='1'B;    /* OR ON THE VUA VALID ATTRIBUTE
*                                      FLAG                  @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                                1586
*                 SVC(126);         /* INVOKE THE MSSC SVC   @Y30LB02*/
         SVC   126                                                 1587
*                 RFY                                              1588
*                   MDREG1 UNRSTD;  /* UNREST REG 1          @Y30LB02
*                                                            @XDR2048*/
*                                                                  1588
*                 /***************************************************/
*                 /*                                                 */
*                 /* RETURN CODE NEED NOT BE CHECKED. EVEN IF BAD    */
*                 /*                                         @XDR2048*/
*                 /* WE WANT TO CONTINUE IPL.                @XDR2048*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1589
*               END;                /* END NO IO CODE        @G24LB02*/
*             BEGPTR=BEGPTR+ANINC;  /* INCREMENT POINTER     @G24LB02*/
@RC01483 LA    @15,2                                               1590
         AL    @15,BEGPTR                                          1590
         ST    @15,BEGPTR                                          1590
*             UCBPTR=BEGPTR->ADRUCB;/* POINT TO NEXT UCB     @G24LB02*/
         SLR   @14,@14                                             1591
         ICM   @14,3,ADRUCB(@15)                                   1591
         ST    @14,UCBPTR                                          1591
*           END;                    /*                       @G24LB02*/
*       END;                        /* AND LOOP WHILE SCANEND IS NOT
*                                      ON                    @G24LB02*/
*                                                                  1593
@RF01481 DS    0H                                                  1593
@DE01479 TM    SCANEND,B'10000000'                                 1593
         BNO   @DL01479                                            1593
*       /*************************************************************/
*       /*                                                           */
*       /* WHEN WE HAVE PROCESSED THE LAST UCB RESTORE       @G24LB02*/
*       /* REGISTERS AND RETURN TO CALLER.                   @G24LB02*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1594
*       RFY                                                        1594
*        (R0,                                                      1594
*         R1,                                                      1594
*         R14,                                                     1594
*         R15) RSTD;                /* RESTRICT REGS FOR FREEMAIN  1594
*                                                            @G24LB02*/
*       R0=LENGTH(IOBSTDRD)+LENGTH(IHADCB)+LENGTH(DEBBASIC)+LENGTH(
*           DEBDASD)+LENGTH(DEB)+LENGTH(RDSNCCWS)+LENGTH(LABLBUFF);/*
*                                                            @G24LB02*/
         LA    R0,273                                              1595
*       R1=IOBSTPT2;                /* AREA REG 1 FOR FREEMAIN     1596
*                                                            @G24LB02*/
         L     R1,IOBSTPT2                                         1596
*       R15=SP245;                  /* SET SUB POOL ID       @G24LB02*/
         LA    R15,245                                             1597
*IFREEMA2:                          /* LABEL FREEMAIN        @G24LB02*/
*       GEN REFS(R0,R1,R15) SETS(R0,R1,R15);                       1598
IFREEMA2 DS    0H                                                  1598
*                                          /* GEN FOR FMAIN  @G24LB02*/
         FREEMAIN RC,LV=(R0),A=(R1),SP=(R15),RELATED=('IGETMAI2')
*       RFY                                                        1599
*        (R0,                                                      1599
*         R1) UNRSTD;               /* UNRESTRICT REGISTERS  @G24LB02*/
*     END;                          /* END GOOD GETMAIN CODE @G24LB02*/
*   ELSE                            /* GETMAIN FAILED        @G24LB02*/
*     DO;                           /* GETMAIN FAILED CODE   @G24LB02*/
         B     @RC01460                                            1601
@RF01460 DS    0H                                                  1602
*       CLEANCOD=GETTHRSH;          /* SET FAIL CODE         @G24LB02*/
         MVC   CLEANCOD(4),@CF02593                                1602
*       RFY                                                        1603
*         R15 RSTD;                 /* RESTRICT REG 15       @G24LB02*/
*       FAILCODE=R15;               /* SAVE GETMAIN FAIL CODE      1604
*                                                            @G24LB02*/
         ST    R15,FAILCODE                                        1604
*       ICBI=OFF;                   /* TURNOFF INITIALIZE BIT      1605
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          1605
         L     @01,CVTEXT2(,@01)                                   1605
         L     @01,CVTICB(,@01)                                    1605
         NI    ICBI(@01),B'01111111'                               1605
*       PLACCONV=R15;               /* SAVE THE GETMAIN FAIL CODE  1606
*                                                            @G24LB02*/
         ST    R15,PLACCONV                                        1606
*       RFY                                                        1607
*         R15 UNRSTD;               /* FREE REG 15           @G24LB02*/
*       CALL RCTOEBC;               /*                       @G24LB02*/
         BAL   @14,RCTOEBC                                         1608
*       IF CVTNIP=ON THEN           /*                       @G24LB02*/
         L     @15,CVTPTR                                          1609
         TM    CVTNIP(@15),B'00010000'                             1609
         BNO   @RF01609                                            1609
*         DO;                       /*                       @G24LB02*/
*           NMESNUM=MSG05NUM;       /* MESSAGE ID IN MSG     @G24LB02*/
         L     @15,NMESPTR                                         1611
         MVC   NMESNUM(3,@15),MSG05NUM                             1611
*           NMESTEXT=GETMTEXT;      /* MESSAGE TEXT IN MSG   @G24LB02*/
         MVI   NMESTEXT+50(@15),C' '                               1612
         MVC   NMESTEXT+51(13,@15),NMESTEXT+50(@15)                1612
         MVC   NMESTEXT(50,@15),GETMTEXT                           1612
*           NMESTEXT(47:49)=PLAC234;/* REASON CODE IN MSG    @G24LB02*/
         MVC   NMESTEXT+46(3,@15),PLAC234                          1613
*/*   WRITE INFORMATIONAL MESSAGE TO THE SYSTEM OPERATOR     @G24LB02*/
*                                                                  1614
*IIEAPMNK:                                                         1614
*           GEN(IEAPMNIP TYPE=WTO,PARAM=NMSGH)/*             @G24LB02*/
*           REFS(NVTWTO,NMSGH);     /* OPERATOR SHOWN ONE LINE     1614
*                                                            @G24LB02*/
IIEAPMNK IEAPMNIP TYPE=WTO,PARAM=NMSGH
*         END;                      /* DID MSG FOR INITLZ FAILURE ON
*                                      1ST MSC ONLY          @G24LB02*/
*       ELSE                        /*                       @G24LB02*/
*         DO;                       /*                       @G24LB02*/
         B     @RC01609                                            1616
@RF01609 DS    0H                                                  1617
*           WTOGEN03=MSG534;        /*                       @MV44258*/
         MVI   WTOGEN03+58,C' '                                    1617
         MVC   WTOGEN03+59(14),WTOGEN03+58                         1617
         MVC   WTOGEN03(58),MSG534                                 1617
*           WTOGEN03(55:57)=PLAC234;/*                       @G24LB02*/
         MVC   WTOGEN03+54(3),PLAC234                              1618
*           CALL ICBMSG45;          /*                       @G24LB02*/
         BAL   @14,ICBMSG45                                        1619
*         END;                      /*                       @G24LB02*/
*     END;                          /* END GETMAIN FAIL CODE @G24LB02*/
@RC01609 DS    0H                                                  1622
*   RDLAB=OFF;                      /* RESET RDLABLS CALLER SWITCH 1622
*                                                            @XDR2048*/
@RC01460 NI    RDLAB,B'11111101'                                   1622
*   ICBECB=ZERO;                    /* CLEAR ICBECB ECB      @G24LB02*/
         SLR   @15,@15                                             1623
         L     @01,CVTPTR                                          1623
         L     @01,CVTEXT2(,@01)                                   1623
         L     @11,CVTICB(,@01)                                    1623
         ST    @15,ICBECB(,@11)                                    1623
*   ICBACTV=ZERO;                   /* CLEAR ICBACTV ECB     @G24LB02*/
         ST    @15,ICBACTV(,@11)                                   1624
*   R14=READRET;                    /*                       @G24LB02*/
         L     R14,READRET                                         1625
*   RFY                                                            1626
*    (R14,                                                         1626
*     R15) UNRSTD;                  /*                       @X50AC01*/
*   RETURN;                         /*                       @G24LB02*/
@EL00011 DS    0H                                                  1627
@EF00011 DS    0H                                                  1627
@ER00011 BR    @14                                                 1627
*   END RDLABLS;                    /*                       @G24LB02*/
*TTRCNVT:                                                          1629
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
TTRCNVT  DS    0H                                                  1630
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME:  TTRCNVT                                 @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:  POINTERS TO DEB AND READ LABELS BUFFER           @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS:  COMPLETES WORK AREA TTRFLD BY MOVING THE CCHHR @G24LB02*/
*/*           FROM THE BUFFER INTO IT.CALLS RESIDENT TTR     @G24LB02*/
*/*           CONVERT ROUTINE TO CONVERT THE VTOC CCHHR TO   @G24LB02*/
*/*           A TTR                                          @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  CONVERTED TTR IN FIELD CNVRTD                   @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1630
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE TO CALL TTR CONVERT ROUTINE TO CONVERT        @G24LB02*/
*   /* THE CCHHR FROM THE VOL 1 LABEL READY TO GO INTO THE FIELD OF  */
*   /* THE UCB (UCBVTOC).                                    @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1630
*   DCL                                                            1630
*     1 TTRFLD,                     /*                       @G24LB02*/
*      2 PRECCHHR CHAR(3),          /*                       @G24LB02*/
*      2 LABCCHHR CHAR(5);          /*                       @G24LB02*/
*   DCL                                                            1631
*     SAVR12 POINTER(31);           /*                       @G24LB02*/
*   DCL                                                            1632
*     CNVTSAV CHAR(64) BDY(WORD);   /*                       @G24LB02*/
*   STM(R0,R15,CNVTSAV);            /*                       @G24LB02*/
         STM   R0,R15,CNVTSAV                                      1633
*   RFY                                                            1634
*     R1 RSTD;                      /*                       @G24LB02*/
*   R1=DEBPTR2;                     /* DEB ADDR FOR USE BY CONVERT 1635
*                                      RTN                   @G24LB02*/
         L     R1,DEBPTR2                                          1635
*   PRECCHHR=ZERO;                  /* ZERO THREE BYTES READY FOR  1636
*                                                            @G24LB02
*                                      PASSING FIELD TO TTR CONVERT.
*                                                            @G24LB02*/
         SLR   @00,@00                                             1636
         STCM  @00,7,PRECCHHR                                      1636
*   LABCCHHR=LABVTOC;               /* PUT THE CCHHR TO CONVERT INTO
*                                                            @G24LB02
*                                      THE WORKAREA FOR TTR CONVERT
*                                                            @G24LB02*/
         L     @15,BUFFPTR                                         1637
         MVC   LABCCHHR(5),LABVTOC(@15)                            1637
*   RFY                                                            1638
*    (R0,                                                          1638
*     R2,                                                          1638
*     R15) RSTD;                    /*                       @G24LB02*/
*   R2=ADDR(TTRFLD);                /* MAKE REG 2 POINT TO WORKAREA
*                                                            @G24LB02*/
         LA    R2,TTRFLD                                           1639
*   R15=CVTPRLTV;                   /* PICK UP ADDR OF TTR CONVERT 1640
*                                      RTN                   @G24LB02*/
         L     @03,CVTPTR                                          1640
         L     R15,CVTPRLTV(,@03)                                  1640
*   SAVR12=R12;                     /*                       @G24LB02*/
         ST    R12,SAVR12                                          1641
*   GEN(BALR 14,15 );               /* AND BRANCH TO IT.     @G24LB02*/
         BALR 14,15
*   CNVRTD=R0;                      /* PUT THE CONVERTED TTR INTO  1643
*                                      FIELD                 @G24LB02*/
         ST    R0,CNVRTD                                           1643
*   R12=SAVR12;                     /*                       @G24LB02*/
         L     R12,SAVR12                                          1644
*   RFY                                                            1645
*    (R0,                                                          1645
*     R1,                                                          1645
*     R2,                                                          1645
*     R15) UNRSTD;                  /*                       @G24LB02*/
*   LM(R0,R15,CNVTSAV);             /* RESTORE CALLERS REGS  @G24LB02*/
         LM    R0,R15,CNVTSAV                                      1646
*   RETURN;                         /* AND RETURN TO CALLER  @G24LB02*/
@EL00012 DS    0H                                                  1647
@EF00012 DS    0H                                                  1647
@ER00012 BR    @14                                                 1647
*   END TTRCNVT;                    /*                       @G24LB02*/
*DUPLABCK:                                                         1649
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
DUPLABCK DS    0H                                                  1650
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME:  DUPLABCK                                @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:  UCBPTR FROM RDLABLS POINTING AT 3330V UCB ON     @G24LB02*/
*/*         WHICH WE HAVE JUST READ THE LABELS               @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS:  SCAN THE UCB'S AND COMPARE THE VOLID'S AGAINST @G24LB02*/
*/*           THE LABEL WHICH WE HAVE JUST READ.  IF AN      @G24LB02*/
*/*           EQUAL VOLID IS FOUND ICBMNTDE WITH TYPE=DMNT   @G24LB02*/
*/*           IS ISSUED                                      @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  IF DEMOUNT ISSUED UCBVOLI IS ZEROED AND UCBVTOC @G24LB02*/
*/*          IS ZEROED                                       @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1650
*   DCL                                                            1650
*     LABLDMNT CHAR(6);             /*                       @G24LB02*/
*   DCL                                                            1651
*     DUPRETR PTR(31);              /*                       @G24LB02*/
*   DCL                                                            1652
*     BEG1PTR PTR(31),              /*                       @G24LB02*/
*     UCB1PTR PTR(31),              /*                       @G24LB02*/
*     ADR1UCB CHAR(2) BASED;        /*                       @G24LB02*/
*   RFY                                                            1653
*    (R14) RSTD;                    /*                       @X50AC01*/
*   DUPRETR=R14;                    /* SAVE THE RETURN REGISTER    1654
*                                                            @G24LB02*/
         ST    R14,DUPRETR                                         1654
*   RFY                                                            1655
*    (R14) UNRSTD;                  /*                       @X50AC01*/
*   DUPEND=OFF;                     /* SET OFF THE END FLAG  @G24LB02*/
         NI    DUPEND,B'11101111'                                  1656
*   BEG1PTR=CVTILK2;                /* PICK UP START OF LOOK UP    1657
*                                                            @G24LB02*/
         L     @01,CVTPTR                                          1657
         L     @15,CVTILK2(,@01)                                   1657
         ST    @15,BEG1PTR                                         1657
*   UCB1PTR=BEG1PTR->ADR1UCB;       /* TABLE AND UCB ADDR    @G24LB02*/
         SLR   @14,@14                                             1658
         ICM   @14,3,ADR1UCB(@15)                                  1658
         ST    @14,UCB1PTR                                         1658
*   DO WHILE UCB1PTR^=FOXES&DUPEND^=ON;/*                    @G24LB02*/
         B     @DE01659                                            1659
@DL01659 DS    0H                                                  1660
*     IF UCB1PTR^=ZERO&UCB1PTR->UCB3DACC=ON THEN/*           @G24LB02*/
         L     @15,UCB1PTR                                         1660
         LTR   @15,@15                                             1660
         BZ    @RF01660                                            1660
         TM    UCB3DACC(@15),B'00100000'                           1660
         BNO   @RF01660                                            1660
*       IF UCBVOLI=UCB1PTR->UCBVOLI THEN/*                   @G24LB02*/
         L     @14,UCBPTR                                          1661
         CLC   UCBVOLI(6,@14),UCBVOLI(@15)                         1661
         BNE   @RF01661                                            1661
*         IF UCBPTR^=UCB1PTR THEN   /*                       @G24LB02*/
         CR    @14,@15                                             1662
         BE    @RF01662                                            1662
*           DO;                     /*                       @G24LB02*/
*             LABLDMNT=UCBPTR->UCBVOLI;/*                    @G24LB02*/
*                                                                  1664
         MVC   LABLDMNT(6),UCBVOLI(@14)                            1664
*             /*******************************************************/
*             /*                                                     */
*             /* WHILE THE UCB POINTER DOES NOT POINT TO THE END     */
*             /*                                             @G24LB02*/
*             /* OF THE UCB LOOK-UP TABLE AND IF POINTER IS NOT      */
*             /*                                             @G24LB02*/
*             /* EQUAL ZERO OR NOT DASD AND IF THE VOLI FIELDS       */
*             /*                                             @G24LB02*/
*             /* ARE EQUAL AND UF THE UCB BEING TESTED IS NOT THE    */
*             /*                                             @G24LB02*/
*             /* ONE WE HAVE JUST DONE THE READ TO, THEN WE  @G24LB02*/
*             /* DEMOUNT THE 3330V BY USING THE MSS MACRO            */
*             /* ICBMNTDE.@G24LB02 OTHERWISE WE INCREMENT THE UCB1PTR*/
*             /* AND GO                                      @G24LB02*/
*             /* AND LOOK AT THE NEXT ONE.                   @G24LB02*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1665
*IMNTDE4:                           /* LABEL FOR MACRO CALL  @XDR2048*/
*                                                                  1665
*             /*******************************************************/
*             /*                                                     */
*             /* MACRO INVOCATION:                           @ZA28964*/
*             /* ICBMNTDE MF(E,DMTLIST,COMPLETE)TYPE(DMNT)VOLID(LABLD*/
*             /* MNT)VUA(UCBCHAN)                            @ZA28964*/
*             /* *****************************************************/
*             /* ****                                        @Y30LB02*/
*             /* MACMEAN MSSC MOUNT/DEMOUNT MACRO            @Y30LB02*/
*             /* VERSION - VS/2 REL 3 77/12/15 LEVEL 04      @ZA28964*/
*             /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.    @Y30LB02*/
*             /* THE LIST FORM OF THIS MACRO SHOULD BE       @Y30LB02*/
*             /* INVOKED FIRST IN ORDER TO SET UP NECESSARY  @Y30LB02*/
*             /* DECLARES. IF THE COMPLETE ARGUMENT IS       @Y30LB02*/
*             /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.     @Y30LB02*/
*             /* *****************************************************/
*             /* ****                                        @Y30LB02*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1665
*             RFY                                                  1665
*               MDREG1 RSTD;        /* RESTRICT REG 1        @Y30LB02*/
IMNTDE4  DS    0H                                                  1666
*             MDREG1=ADDR(DMTLIST); /* R1 PTR TO REQ BLOCK   @Y30LB02*/
         LA    MDREG1,DMTLIST                                      1666
*             DMTLIST=DMTLIST&&DMTLIST;/* ZERO OUT BLOCK     @Y30LB02*/
         XC    DMTLIST(28),DMTLIST                                 1667
*             DMLEN='1C'X;          /* LENGTH OF DEMOUNT REQUEST   1668
*                                      BLOCK                 @Y30LB02*/
         LA    @00,28                                              1668
         ST    @00,DMLEN                                           1668
*             DMOPCD='06'X;         /* DEMOUNT OPCODE        @Y30LB02*/
         MVI   DMOPCD,X'06'                                        1669
*             DMVOL=(LABLDMNT);     /* VALUE OF VOLID        @Y30LB02*/
         MVC   DMVOL(6),LABLDMNT                                   1670
*             DMNTVUA=(UCBCHAN);    /* FILL VUA              @ZDR2048*/
         L     @15,UCBPTR                                          1671
         MVC   DMNTVUA(2),UCBCHAN(@15)                             1671
*             DMVUAVAL='1'B;        /* OR ON THE VUA VALID ATTRIBUTE
*                                      FLAG                  @ZDR2048*/
         OI    DMVUAVAL,B'00100000'                                1672
*             SVC(126);             /* INVOKE THE MSSC SVC   @Y30LB02*/
         SVC   126                                                 1673
*             RFY                                                  1674
*               MDREG1 UNRSTD;      /* UNREST REG 1          @Y30LB02
*                                                            @XDR2048*/
*             UCBVOLI=''B;          /* ZERO VOL LABEL        @G24LB02*/
         L     @15,UCBPTR                                          1675
         XC    UCBVOLI(6,@15),UCBVOLI(@15)                         1675
*             UCBVTOC=''B;          /* CLEAR OUT VTOC FIELD  @G24LB02*/
         XC    UCBVTOC(4,@15),UCBVTOC(@15)                         1676
*             UCBNOTRD=ON;          /* SET UCB NOT READY     @G24LB02*/
         OI    UCBNOTRD(@15),B'01000000'                           1677
*             DUPEND=ON;            /* SET DUPEND FLAG ON    @G24LB02*/
         OI    DUPEND,B'00010000'                                  1678
*           END;                    /* DEMOUNT FOR DUP 3330V @G24LB02*/
*         ELSE                                                     1680
*           ;                       /* IT IS LOOKING AT ITSELF UGH 1680
*                                                            @G24LB02*/
@RF01662 DS    0H                                                  1681
*       ELSE                                                       1681
*         ;                         /*                       @G24LB02*/
@RF01661 DS    0H                                                  1682
*     ELSE                                                         1682
*       ;                           /* EITHER POINTER IS ZERO OR UCB
*                                      NOT DASD              @G24LB02*/
@RF01660 DS    0H                                                  1683
*     BEG1PTR=BEG1PTR+ANINC;        /* SO INCREMENT          @G24LB02*/
         LA    @15,2                                               1683
         AL    @15,BEG1PTR                                         1683
         ST    @15,BEG1PTR                                         1683
*     UCB1PTR=BEG1PTR->ADR1UCB;     /* UCB POINTER AND       @G24LB02*/
         SLR   @14,@14                                             1684
         ICM   @14,3,ADR1UCB(@15)                                  1684
         ST    @14,UCB1PTR                                         1684
*   END;                            /* GO TRY NEXT ONE       @G24LB02*/
@DE01659 SLR   @15,@15                                             1685
         ICM   @15,3,FOXES                                         1685
         C     @15,UCB1PTR                                         1685
         BE    @DC01659                                            1685
         TM    DUPEND,B'00010000'                                  1685
         BNO   @DL01659                                            1685
@DC01659 DS    0H                                                  1686
*   RFY                                                            1686
*    (R14) RSTD;                    /*                       @X50AC01*/
*   R14=DUPRETR;                    /* RESTORE RETURN REGISTER     1687
*                                                            @G24LB02*/
         L     R14,DUPRETR                                         1687
*   RFY                                                            1688
*    (R14) UNRSTD;                  /*                       @X50AC01*/
*   RETURN;                         /* AND RETURN TO CALLER  @G24LB02*/
@EL00013 DS    0H                                                  1689
@EF00013 DS    0H                                                  1689
@ER00013 BR    @14                                                 1689
*   END DUPLABCK;                   /*                       @G24LB02*/
*                                                                  1691
*/*********************************************************  @G24LB02*/
*/*  START OF SPECIFICATIONS ****                            @G24LB02
*                                                            @G24LB02
*01*  MODULE-NAME = ICBMSG45                                 @G24LB02
*                                                            @G24LB02
*01*  DESCRIPTIVE-NAME = WTO SUBROUTINE (GENERAL)            @G24LB02
*                                                            @G24LB02
*01*  FUNCTION = WRITE TO OPERATOR (ON MASTER CONSOLE)       @G24LB02
*                                                            @G24LB02
*                                                            @G24LB02
*02*  PURPOSE = TO WRITE MESSAGES TO THE OPERATOR            @G24LB02
*                                                            @G24LB02
*02*    INPUT = MESSAGE TO BE WRITTEN TO OPERATOR            @G24LB02
*                                                            @G24LB02
*02*    OUTPUT = MESSAGE WRITTEN TO OPERATOR                 @G24LB02
*                                                            @G24LB02
*                                                            @G24LB02
**** END OF SPECIFICATIONS **                                @G24LB02*/
*                                                                  1691
*ICBMSG45:                                                         1691
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
ICBMSG45 DS    0H                                                  1692
*/*  ****************************************************    @G24LB02*/
*/*                                                          @G24LB02*/
*/*    THIS SUBROUTINE ISSUES THE WTO COMMAND RESPONSE.      @G24LB02*/
*/*                                                          @G24LB02*/
*/*  ****************************************************    @G24LB02*/
*                                                                  1692
*   DCL                                                            1692
*     SAVR1445 FIXED(31);           /* RETURN REG SAVE AREA  @G24LB02*/
*   RFY                                                            1693
*     R14 RSTD;                     /* RESTRICT REG 14       @G24LB02*/
*   SAVR1445=R14;                   /* SAVE CALLERS REGISTER FOURTEEN
*                                                            @G24LB02*/
         ST    R14,SAVR1445                                        1694
*IWTO1:                                                            1695
*   DO;                             /* WTOP MF(E,WTOGEN) RTCD(R15)   */
IWTO1    DS    0H                                                  1696
*     RFY                                                          1696
*       GPR01P RSTD;                /* RESTRICT REG 1                */
*     GPR01P=ADDR(WTOGEN);          /* ADDRESS CONTROL PROGRAM LIST  */
         LA    GPR01P,WTOGEN                                       1697
*     SVC(35);                      /* ISSUE WTO SVC                 */
         SVC   35                                                  1698
*     RFY                                                          1699
*       GPR15F RSTD;                /* RESTRICT REG 15               */
*     R15=GPR15F;                   /* SAVE SVC RETURN CODE          */
*     RFY                                                          1701
*       GPR15F UNRSTD;              /* RELEASE REG 15                */
*     RFY                                                          1702
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */
*   END;                            /* WTOP MF(E,WTOGEN) RTCD(R15) 1703
*                                                            @G24LB02*/
*   R14=SAVR1445;                   /* RESTORE CALLERS REGISTER    1704
*                                      FOURTEEN              @G24LB02*/
         L     R14,SAVR1445                                        1704
*   RFY                                                            1705
*     R14 UNRSTD;                   /* FREE REG 14           @G24LB02*/
*   RETURN;                         /* RTN TO CALLER         @G24LB02*/
@EL00014 DS    0H                                                  1706
@EF00014 DS    0H                                                  1706
@ER00014 BR    @14                                                 1706
*   END ICBMSG45;                   /*                       @G24LB02*/
*                                                                  1708
*/*********************************************************  @G24LB02*/
*/*                                                          @G24LB02*/
*/*  PROCEDURE NAME - VATLIST                                @G24LB02*/
*/*                                                          @G24LB02*/
*/*  FUNCTION - THE PURPOSE OF THIS ROUTINE IS TO SETUP      @G24LB02*/
*/*             DECLARES AND CONSTANTS FOR THE WTOR MSG      @G24LB02*/
*/*             FOR VATLIST PROCESSING.  AFTER THE WTOR      @G24LB02*/
*/*             MESSAGE HAS BEEN ISSUED THE OPERATOR WILL    @G24LB02*/
*/*             MOUNT VIRTUAL VOLUMES REQUIRED BY MSS.       @G24LB02*/
*/*             WHEN THESE MOUNTS ARE COMPLETE THE           @G24LB02*/
*/*             OPERATOR MUST RESPOND WITH 'CONT'.           @G24LB02*/
*/*             AT THIS POINT IN TIME THE WAIT               @G24LB02*/
*/*             ISSUED FOR WAITECB WILL BE SATIFIED          @G24LB02*/
*/*             AND INITIALIZATION PROCESSING WILL           @G24LB02*/
*/*             CONTINUE.                                    @G24LB02*/
*/*                                                          @G24LB02*/
*/*                                                          @G24LB02*/
*/*  INPUTS - NONE                                           @G24LB02*/
*/*                                                          @G24LB02*/
*/*  OUTPUT - WTOR MESSAGE ICB011A                           @ZA32884*/
*/*                                                          @G24LB02*/
*/*******************************************************    @G24LB02*/
*                                                                  1708
*VATLIST:                                                          1708
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
VATLIST  DS    0H                                                  1709
*   RFY                                                            1709
*     R14 RSTD;                     /*                       @G24LB02*/
*   SAVPR14=R14;                    /*                       @G24LB02*/
         ST    R14,SAVPR14                                         1710
*   RFY                                                            1711
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   VATMSG=''B;                     /* ZERO REPLY FIELD      @G24LB02*/
         XC    VATMSG(4),VATMSG                                    1712
*   ICBECB=F0;                      /* ZERO ECB FIELD        @G24LB02*/
         L     @01,CVTPTR                                          1713
         L     @01,CVTEXT2(,@01)                                   1713
         L     @15,CVTICB(,@01)                                    1713
         SLR   @14,@14                                             1713
         ST    @14,ICBECB(,@15)                                    1713
*   RESPECIFY                                                      1714
*     R2 RSTD;                      /*                       @G24LB02*/
*   R2=ADDR(ICBECB);                /* ECB ADDRESS IN R2     @G24LB02*/
         LA    R2,ICBECB(,@15)                                     1715
*   GEN REFS(VATMSG,R2);                                           1716
IWTOR5  WTOR  'ICB011A MOUNT VIRT VOLS REQ''D FOR MSS. REPLY ''CONT'' W*
               HEN MOUNTS COMPLETE',VATMSG,FOUR,(R2),ROUTCDE=(1),DESC=2
*IWAIT6:                            /* LABEL WAIT            @G24LB02*/
*   GEN(WAIT ECB=(R2));             /* ISSUE WAIT            @G24LB02*/
IWAIT6   WAIT ECB=(R2)
*   RFY                                                            1718
*     R2 UNRSTD;                    /* FREE REG 2            @G24LB02*/
*   RFY                                                            1719
*     R14 RSTD;                     /*                       @G24LB02*/
*   R14=SAVPR14;                    /* RESTORE REG 14        @G24LB02*/
         L     R14,SAVPR14                                         1720
*   RFY                                                            1721
*     R14 UNRSTD;                   /*                       @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
@EL00015 DS    0H                                                  1722
@EF00015 DS    0H                                                  1722
@ER00015 BR    @14                                                 1722
*   END VATLIST;                    /*                       @G24LB02*/
*                                                                  1724
*/********************************************************************/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME: WAITRTN                                  @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT: NONE                                              @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS: THIS ROUTINE ISSUES A MULTIPLE WAIT ON FOUR     @G24LB02*/
*/*          ECBS. THE FOUR ECBS ARE:                        @G24LB02*/
*/*              ICBECB: THIS ECB IS POSTED WHEN IO COMPLETE @G24LB02*/
*/*              ICBACTV - THIS ECB IS USED DURING 3330V     @G24LB02*/
*/*                READ LABEL I/O OPERATIONS FOR TIMED IO    @G24LB02*/
*/*              ICBCOM - COMMUNICATIONS TASK ECB. COMMANDS  @G24LB02*/
*/*                WILL NOT BE PROCESSED UNTIL FULL MESSAGE  @G24LB02*/
*/*                TASK OPERATION IS POSSIBLE, SO A SWITCH   @G24LB02*/
*/*                WILL BE SET TO INDICATE THE ECB HAS BEEN  @G24LB02*/
*/*                POSTED.                                   @G24LB02*/
*/*              ICBIOR - NOT USED THIS MODULE               @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT: IF ICBACTV WAS POSTED FOR READ LABEL I/O,THE ECB @G24LB02*/
*/*          WILL NOT BE CLEARED, BUT WILL BE LEFT FOR       @G24LB02*/
*/*          INTERROGATION BY THE READLABL ROUTINE           @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************************/
*                                                                  1724
*WAITRTN:                                                          1724
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
WAITRTN  DS    0H                                                  1725
*   RFY                                                            1725
*    (R14) RSTD;                    /*                       @G24LB02*/
*   WAITSV14=R14;                   /*                       @G24LB02*/
         ST    R14,WAITSV14                                        1726
*   RFY                                                            1727
*    (R14) UNRSTD;                  /*                       @G24LB02*/
*                                                                  1727
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE WAIT ON THE LIST OF FOUR ECBS                   @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1728
*   GEN(WAIT ECBLIST=WAITLIST);     /*                       @G24LB02*/
*                                                                  1728
         WAIT ECBLIST=WAITLIST
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE WHICH ECB WAS POSTED AND TAKE APPROPRIATE @G24LB02*/
*   /* ACTION                                                @G24LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1729
*   IF ECB1->BITPATT(2)=ON THEN     /* WAS ICBECB POSTED?    @G24LB02*/
         L     @01,ECB1                                            1729
         TM    BITPATT(@01),B'01000000'                            1729
         BNO   @RF01729                                            1729
*     DO;                           /* YES, IO POSTED        @G24LB02*/
*       ACTPOST=ON;                 /* SET SWITCH FOR RDLABLS      1731
*                                                            @G24LB02*/
         OI    ACTPOST,B'00100000'                                 1731
*     END;                          /*                       @G24LB02*/
*   IF ECB2->BITPATT(2)=ON THEN     /* WAS ICBACTV POSTED?   @G24LB02*/
@RF01729 L     @01,ECB2                                            1733
         TM    BITPATT(@01),B'01000000'                            1733
         BNO   @RF01733                                            1733
*     DO;                           /*                       @G24LB02*/
*       ACTPOST=ON;                 /* SET SWITCH FOR RDLABLS      1735
*                                                            @G24LB02*/
*       TMEPOST=ON;                 /* SET TIME END SWITCH   @G24LB02*/
         OI    ACTPOST,B'00100100'                                 1736
*     END;                          /*                       @G24LB02*/
*   IF ECB3->BITPATT(2)=ON THEN     /* WAS ICBCOM POSTED?    @G24LB02*/
@RF01733 L     @01,ECB3                                            1738
         TM    BITPATT(@01),B'01000000'                            1738
         BNO   @RF01738                                            1738
*     DO;                           /* YES, COMMAND POST     @G24LB02*/
*       ICBCOM=ZERO;                /* CLEAR THE ECB         @G24LB02*/
         L     @01,CVTPTR                                          1740
         L     @01,CVTEXT2(,@01)                                   1740
         L     @01,CVTICB(,@01)                                    1740
         SLR   @00,@00                                             1740
         ST    @00,ICBCOM(,@01)                                    1740
*     END;                          /*                       @G24LB02*/
*   IF ECB4->BITPATT(2)=ON THEN     /* WAS ICBIOR POSTED?    @G24LB02*/
@RF01738 ICM   @01,7,ECB4                                          1742
         TM    BITPATT(@01),B'01000000'                            1742
         BNO   @RF01742                                            1742
*     DO;                           /* YES                   @G24LB02*/
*       ICBIOR=ZERO;                /* CLEAR ECB             @G24LB02*/
         L     @01,CVTPTR                                          1744
         L     @01,CVTEXT2(,@01)                                   1744
         L     @01,CVTICB(,@01)                                    1744
         SLR   @00,@00                                             1744
         ST    @00,ICBIOR(,@01)                                    1744
*     END;                          /*                       @G24LB02*/
*   RFY                                                            1746
*    (R14) RSTD;                    /*                       @G24LB02*/
@RF01742 DS    0H                                                  1747
*   R14=WAITSV14;                   /* RESTORE REG 14        @G24LB02*/
         L     R14,WAITSV14                                        1747
*   RFY                                                            1748
*    (R14) UNRSTD;                  /*                       @G24LB02*/
*   RETURN;                         /*                       @G24LB02*/
@EL00016 DS    0H                                                  1749
@EF00016 DS    0H                                                  1749
@ER00016 BR    @14                                                 1749
*   END WAITRTN;                    /*                       @G24LB02*/
*BLDBLOCK:                                                         1751
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @G24LB02*/
BLDBLOCK DS    0H                                                  1752
*/********************************************************** @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCEDURE NAME:  BLDBLOCK                                @G24LB02*/
*/*                                                          @G24LB02*/
*/* INPUT:  POINTERS TO I/O CONTROL BLOCKS IN SP245          @G24LB02*/
*/*                                                          @G24LB02*/
*/* PROCESS:  COMPLETES NECESSARY FIELDS IN IOB DCB AND DEB  @G24LB02*/
*/*           FOR EXCP TO READ VOL LABELS ALSO BUILDS CCW'S  @G24LB02*/
*/*           IN SP245 FOR EXCP.                             @G24LB02*/
*/*                                                          @G24LB02*/
*/* OUTPUT:  PARTIALLY COMPLETED I/O CONTROL BLOCKS AND      @G24LB02*/
*/*          COMPLETED CCW'S.                                @G24LB02*/
*/*                                                          @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1752
*   DCL                                                            1752
*     BLDRET PTR(31);               /*                       @G24LB02*/
*   RFY                                                            1753
*    (R14) RSTD;                    /*                       @G24LB02*/
*   BLDRET=R14;                     /*                       @G24LB02*/
         ST    R14,BLDRET                                          1754
*   RFY                                                            1755
*    (R14) UNRSTD;                  /*                       @G24LB02*/
*   IOBSTDRD=''B;                   /* ZERO IOB FIELD        @G24LB02*/
         L     @15,IOBSTPT2                                        1756
         XC    IOBSTDRD(32,@15),IOBSTDRD(@15)                      1756
*   IHADCB=''B;                     /* ZERO DCB FIELD        @G24LB02*/
         L     @14,DCBPTR2                                         1757
         XC    IHADCB(52,@14),IHADCB(@14)                          1757
*   DEBBASIC=''B;                   /* ZERO DEB FIELD        @G24LB02*/
         L     @11,DEBPTR2                                         1758
         XC    DEBBASIC(32,@11),DEBBASIC(@11)                      1758
*   DEB=''B;                        /* ZERO DEB APPENDAGE VECTOR   1759
*                                      TABLE                 @G24LB02*/
         L     @10,DEBAPPA2                                        1759
         XC    DEB(36,@10),DEB(@10)                                1759
*   DEBDASD=''B;                    /* ZERO DASD PORTION OF DEB    1760
*                                                            @G24LB02*/
         L     @09,DEBDAPT2                                        1760
         XC    DEBDASD(16,@09),DEBDASD(@09)                        1760
*   IOBECBPB=ADDR(ICBECB);          /* SET UP ECB FOR I/O    @G24LB02*/
         L     @01,CVTPTR                                          1761
         L     @01,CVTEXT2(,@01)                                   1761
         L     @08,CVTICB(,@01)                                    1761
         LA    @07,ICBECB(,@08)                                    1761
         STCM  @07,7,IOBECBPB(@15)                                 1761
*   IOBDCBPB=DCBPTR2;               /* LOAD DCB ADDRESS INTO IOB   1762
*                                                            @G24LB02*/
         STCM  @14,7,IOBDCBPB(@15)                                 1762
*   IOBSEEK='0000000000000003'X;    /* SEEK ADDRESS FOR      @G24LB02
*                                      VOL1 LABEL            @G24LB02*/
         MVC   IOBSEEK(8,@15),@CB04144                             1763
*   DCBDEBAD=DEBPTR2;               /* DEB ADDRESS INTO DCB  @G24LB02*/
         ST    @11,DCBDEBAD+40(,@14)                               1764
*   DEBPROTG='0F'X;                 /* PROTECT KEY INTO DEB  @G24LB02*/
         MVI   DEBPROTG(@11),X'0F'                                 1765
*   DEBDCBB=DCBPTR2;                /* DCB ADDRESS INTO DEB  @G24LB02*/
         STCM  @14,7,DEBDCBB(@11)                                  1766
*   DEBAPPB=DEBAPPA2;               /* APPENDAGE VECTOR TABLE ADDR 1767
*                                                            @G24LB02*/
         STCM  @10,7,DEBAPPB(@11)                                  1767
*   DEBTCBAD=ICBTCB;                /* SET UP TCB POINTER IN DEB   1768
*                                                            @G24LB02*/
         MVC   DEBTCBAD(4,@11),ICBTCB(@08)                         1768
*   DEBENDCC='7FFF'X;               /* ENDING CYL OF EXTENT  @G24LB02*/
         MVC   DEBENDCC(2,@09),@CB04146                            1769
*   DEBENDHH='7FFF'X;               /* RD/WR TRK FOR END EXTENT    1770
*                                                            @G24LB02*/
         MVC   DEBENDHH(2,@09),@CB04146                            1770
*   DEBNMTRK='7FFF'X;               /* NO OF TRK IN EXTENT   @G24LB02*/
         MVC   DEBNMTRK(2,@09),@CB04146                            1771
*   DEBEOEAD=ADDR(ICBDUMAA);        /* RETURN TO EXCP        @G24LB02*/
         LA    @11,ICBDUMAA                                        1772
         STCM  @11,7,DEBEOEAD(@10)                                 1772
*   DEBSIOAD=ADDR(ICBDUMAA);        /* RETURN TO EXCP        @G24LB02*/
         STCM  @11,7,DEBSIOAD(@10)                                 1773
*   DEBPCIAD=ADDR(ICBDUMAA);        /* RETURN TO EXCP        @G24LB02*/
         STCM  @11,7,DEBPCIAD(@10)                                 1774
*   DEBCEAD=ADDR(ICBDUMAA);         /* RETURN TO EXCP        @G24LB02*/
         STCM  @11,7,DEBCEAD(@10)                                  1775
*   DEBXCEAD=ADDR(ICBDUMAA);        /* RETURN TO EXCP        @G24LB02*/
         STCM  @11,7,DEBXCEAD(@10)                                 1776
*   SRCHCODE='31'X;                 /* SEARCH ID EQ          @G24LB02*/
         L     @14,RDCCWPTR                                        1777
         MVI   SRCHCODE(@14),X'31'                                 1777
*   SRCHDATA=ADDR(IOBSEEK)+3;       /* ADDRESS OF RECORD 3   @G24LB02*/
         LA    @15,IOBSEEK(,@15)                                   1778
         AH    @15,@CH00127                                        1778
         STCM  @15,7,SRCHDATA(@14)                                 1778
*   SCHFLAGS='40'X;                 /* COMMAND CHAIN FLAG    @G24LB02*/
         MVI   SCHFLAGS(@14),X'40'                                 1779
*   SCHCOUNT='000005'X;             /* LENGTH OF SEARCH DATA @G24LB02*/
         MVC   SCHCOUNT(3,@14),@CF04147+1                          1780
*   TICCODE='08'X;                  /* TRANSFER IN CHANNEL CODE    1781
*                                                            @G24LB02*/
         MVI   TICCODE(@14),X'08'                                  1781
*   TICDATA=ADDR(SRCHCCWS);         /* ADDR OF SEARCH CCW    @G24LB02*/
         STCM  @14,7,TICDATA(@14)                                  1782
*   TICFLAGS='40'X;                 /* COMMAND CHAIN TIC     @G24LB02*/
         MVI   TICFLAGS(@14),X'40'                                 1783
*   TICCOUNT='000001'X;             /* LENGTH                @G24LB02*/
         MVC   TICCOUNT(3,@14),@CF04148+1                          1784
*   READCODE='06'X;                 /* READ DATA CCW CODE    @G24LB02*/
         MVI   READCODE(@14),X'06'                                 1785
*   READDATA=BUFFPTR;               /* LABEL READ AREA       @G24LB02*/
         MVC   READDATA(3,@14),BUFFPTR+1                           1786
*   RDFLAGS='00'X;                  /* NO CHAIN AND WE WANT TO     1787
*                                                            @G24LB02
*                                      KNOW ABOUT WRONG LENGTH.    1787
*                                                            @G24LB02*/
         MVI   RDFLAGS(@14),X'00'                                  1787
*   RDCOUNT='000050'X;              /* READ LENGTH OF VOL1   @G24LB02
*                                      LABEL IE 80 BYTES.    @G24LB02*/
         MVC   RDCOUNT(3,@14),@CF04149+1                           1788
*   RFY                                                            1789
*    (R14) RSTD;                    /*                       @G24LB02*/
*   R14=BLDRET;                     /* RESTORE RETURN REG    @G24LB02*/
         L     @15,BLDRET                                          1790
         LR    R14,@15                                             1790
*   RFY                                                            1791
*    (R14) UNRSTD;                  /*                       @G24LB02*/
*   RETURN;                         /* AND RETURN TO CALLER  @G24LB02*/
@EL00017 DS    0H                                                  1792
@EF00017 DS    0H                                                  1792
@ER00017 BR    @14                                                 1792
*   END BLDBLOCK;                   /*                       @G24LB02*/
*   END ICBMSG05                    /* END OF THE MSSC RIM   @G24LB02*/
*/********************************************************** @G24LB02*/
*                                                                  1794
*                                                                  1794
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHANVT  )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEAPPNIP)                                       */
*/*%INCLUDE SYSLIB  (IEAPMNIP)                                       */
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IECDIOSB)                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */
*/*%INCLUDE SYSLIB  (IHAPCCA )                                       */
*/*%INCLUDE SYSLIB  (IHAPCCAT)                                       */
*/*%INCLUDE SYSLIB  (IECDLCH )                                       */
*/*%INCLUDE SYSLIB  (IECDCAT )                                       */
*/*%INCLUDE SYSLIB  (ICB2IOBX)                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */
*/*%INCLUDE SYSLIB  (IEZINIT )                                       */
*                                                                  1794
*       ;                                                          1794
@DATA    DS    0H
@CH00130 DC    H'1'
@CH00125 DC    H'2'
@CH00127 DC    H'3'
@CH00032 DC    H'4'
@CH00033 DC    H'5'
@CH00239 DC    H'16'
@CH02677 DC    H'17'
@CH00433 DC    H'24'
@CH01975 DC    H'36'
@CH02691 DC    H'52'
@CH02703 DC    H'173'
@CH00064 DC    XL2'39'
@CH01979 DC    XL2'04'
@CH01981 DC    XL2'08'
@CH02695 DC    XL2'54'
         DS    0F
@SA00001 DS    18F
         DS    0F
@CF02593 DC    F'600'
@CF02597 DC    F'720'
@CF02601 DC    F'840'
@CF02605 DC    F'1010'
@CH02605 EQU   @CF02605+2
@CF02607 DC    F'1020'
@CH02607 EQU   @CF02607+2
@CF04189 DC    F'-4'
@CF04147 DC    XL4'000005'
@CF04148 DC    XL4'000001'
@CF04149 DC    XL4'000050'
         DS    0D
UCBPTR   DC    A(0)
SRBPTR   DS    A
IOSBPTR  DS    A
ASCBPTR  DS    A
PCCAPTR  DS    A
LCHPTR   DS    A
CATPTR   DS    A
NVTPTR   DS    A
DATACPTR DS    A
R13SAVE  DS    A
R0SAVE   DS    A
R15SAVE  DS    A
NOTRDRET DS    A
SAVPR14  DS    A
MSCUCBA1 DC    A(0)
MSCUCBA2 DC    A(0)
MSC1IRC  DC    F'0'
MSC2IRC  DC    F'0'
FAILCODE DC    F'0'
CLEANCOD DC    F'0'
INITBEFR DC    XL4'51'
NMESPTR  DS    A
CPUINTFP DS    A
VALBITSP DS    A
BEGPTR   DS    A
BITPTR   DC    A(0)
READRET  DS    A
CNVRTD   DS    F
WAITSV14 DS    F
DCBPTR2  DS    A
DEBPTR2  DS    A
DEBAPPA2 DS    A
DEBDAPT2 DS    A
RDCCWPTR DS    A
IOBSTPT2 DS    A
BUFFPTR  DS    A
DCBPTR   DC    A(0)
DEBPTR   DC    A(0)
DEBDAPTR DC    A(0)
DEBEXPTR DC    A(0)
DEBSBPTR DC    A(0)
PURGPTR  DS    A
IOBPRPTR DC    A(0)
IOBSTPTR DC    A(0)
SCANRET  DS    A
TMER     DC    F'100'
INITPTR  DS    A
IPSRET   DS    A
TWORET   DS    A
INLZRET  DS    A
TRYRET   DS    A
BUILD14  DS    A
SOCRET   DS    A
CONVSAV  DS    A
SAVR12   DS    A
DUPRETR  DS    A
BEG1PTR  DS    A
UCB1PTR  DS    A
SAVR1445 DS    F
BLDRET   DS    A
IOCOMPTR DS    A
LISTA    DS    A
RDGOT    DS    F
UCBDCPTR DS    A
I        DS    H
INILEN   DC    AL2(20)
PORT     DS    FL1
         ORG   PORT
PORTID   DS    CL1
         ORG   PORT+1
@CB04144 DC    X'0000000000000003'
@CB02664 EQU   @CB04144
@CB02774 DC    X'001A0A01'
@CB02617 DC    X'4000'
@CB02619 DC    X'8000'
@CB02621 DC    X'0200'
@CB04146 DC    X'7FFF'
FOXES    DC    X'FFFF'
         DS    CL1
PLACCONV DS    CL4
         ORG   PLACCONV
PLAC1    DS    FL1
PLAC234  DS    CL3
         ORG   PLAC234
PLAC2    DS    FL1
PLAC34   DS    CL2
         ORG   PLAC34
PLAC3    DS    FL1
PLAC4    DS    FL1
         ORG   PLAC4
PLAC4C   DS    CL1
         ORG   PLACCONV+4
NLIRC    DC    X'F9'
BITSW    DS    CL1
         ORG   BITSW
TWOLINER DS    BL1
FAILCALL EQU   BITSW+0
PRGXQTD  EQU   BITSW+0
GMFLAG   EQU   BITSW+0
@NM00118 EQU   BITSW+0
         ORG   BITSW+1
BSRBID   DC    CL4'SRB '
BUFFAREA DS    CL512
         ORG   BUFFAREA
@NM00119 DS    CL48
@NM00120 DS    CL4
         ORG   @NM00120+0
@NM00121 DS    CL2
@NM00122 DS    CL1
         ORG   @NM00122+0
@NM00123 DS    BL1
FLG      EQU   @NM00122+0
         ORG   BUFFAREA+512
TEMPWA   DS    CL1
MASKP    DC    X'03'
QUERLIST DS    CL44
         ORG   QUERLIST
QULEN    DS    FL4
QUORD    DS    CL1
QURES    DS    CL1
QUCODE   DS    BL1
         ORG   QUCODE
QULIB    DS    BL1
         ORG   QUERLIST+7
QUSECT   DS    BL1
         ORG   QUSECT
QUXADDR  DS    BL1
         ORG   QUXADDR
QUFLAG   DS    BL1
         ORG   QUFLAG
QURES1   DS    CL1
         ORG   QUERLIST+8
QUPARM   DS    CL32
QUPTR    DS    FL4
         ORG   QUERLIST+44
@NM00125 DS    BL1
         ORG   @NM00125
ERRSW    DS    BL1
CPU0     EQU   @NM00125+0
CPU1     EQU   @NM00125+0
QUERERR  EQU   @NM00125+0
INITSW   EQU   @NM00125+0
         ORG   @NM00125+1
LETTERI  DC    CL1'I'
         DS    CL2
UNPKARA1 DS    CL11
         DS    CL5
UNPKARA2 DS    CL6
         DS    CL2
MSG5PACH DC    XL256'0'
         DC    XL256'0'
         DC    XL58'0'
GOODCOMP DC    X'7F000000'
         DS    CL2
WTOGEN   DS    CL81
         ORG   WTOGEN
WTOGEN01 DC    H'77'
WTOGEN02 DC    B'1000000000000000'
WTOGEN03 DC    CL73'THE MAXIMUM MESSAGE LENGTH WILL BE SEVENTY-TWO CHARC
               ACTERS SO LEN(MSG )=72'
WTOGEN04 DC    B'0001000000000000'
WTOGEN05 DC    B'0100000000000000'
         ORG   WTOGEN+81
         DS    CL3
DMTLIST  DS    CL28
         ORG   DMTLIST
DMLEN    DC    XL4'1C'
DMOPCD   DC    XL1'06'
DMNTRES1 DC    X'00'
DMNTFLAG DC    B'0000000000000000'
         ORG   DMNTFLAG
DMBITRE1 DS    BL1
DMDELRSP EQU   DMNTFLAG+0
DMVUAVAL EQU   DMNTFLAG+0
DMBITRES EQU   DMNTFLAG+0
         ORG   DMTLIST+8
DMVOL    DC    XL6'0'
DMNTASID DC    XL2'0'
DMNTECB  DC    A(0)
DMHOST   DC    XL5'0'
DMNTRES2 DC    XL1'0'
DMNTVUA  DC    H'0'
         ORG   DMTLIST+28
INITLIST DS    CL8
         ORG   INITLIST
AIRLL    DC    XL4'08'
AIROP    DC    XL1'10'
@NM00154 DC    X'00'
AIRFLAG  DC    B'0000000000000000'
         ORG   AIRFLAG
AIRRESV  DS    BL1
AIRCPUS  EQU   AIRFLAG+0
@NM00155 EQU   AIRFLAG+0
         ORG   INITLIST+8
PURGLIST DS    CL13
         ORG   PURGLIST
PURGLL   DC    XL4'0D'
PURGOP   DC    XL1'14'
@NM00156 DC    X'00'
PURGFLG  DC    B'0000000000000000'
         ORG   PURGFLG
PURGMPP  DS    BL1
@NM00157 EQU   PURGFLG+0
         ORG   PURGLIST+8
PURGHOST DC    X'0000000000'
         ORG   PURGLIST+13
         DS    CL1
ICBDUMAA DC    X'07FE'
INITBITS DS    BL1
         ORG   INITBITS
@NM00158 DS    BL1
COMPOST  EQU   INITBITS+0
ACTPOST  EQU   INITBITS+0
ECBPOST  EQU   INITBITS+0
ERPPOST  EQU   INITBITS+0
TMEPOST  EQU   INITBITS+0
@NM00159 EQU   INITBITS+0
         ORG   INITBITS+1
         DS    CL3
PURGPARM DS    CL16
         ORG   PURGPARM
PUROPT   DS    CL1
PURDEB   DS    AL3
PURGCONT DS    CL12
         ORG   PURGCONT
PURCOD   DS    AL1
PURTCB   DS    AL3
PURQUI   DS    AL1
PURCHN   DS    AL3
PURSTAT  DS    BL2
         ORG   PURSTAT
PURHIO   DS    BL1
@NM00164 EQU   PURSTAT+0
         ORG   PURGCONT+10
PURCSW   DS    BL2
         ORG   PURGPARM+16
RDGET    DS    CL4
         ORG   RDGET
RDGETSP  DC    X'F5'
RDGETLL  DC    AL3(0)
         ORG   RDGET+4
SCFLAGS  DS    BL1
         ORG   SCFLAGS
SCANEND  DS    BL1
SCANSTRT EQU   SCFLAGS+0
SCANRUNN EQU   SCFLAGS+0
DUPEND   EQU   SCFLAGS+0
ENTERED  EQU   SCFLAGS+0
FINDSW   EQU   SCFLAGS+0
RDLAB    EQU   SCFLAGS+0
         ORG   SCFLAGS+1
         DS    CL3
WAITLIST DS    CL16
         ORG   WAITLIST
ECB1     DS    AL4
ECB2     DS    AL4
ECB3     DS    AL4
@NM00166 DS    CL4
         ORG   @NM00166
BYT1     DC    XL1'80'
ECB4     DS    AL3
         ORG   WAITLIST+16
MESSG9   DC    CL41'  ICB983I VOLUME NOT CONSIDERED IN SYSTEM'
MSGS     DS    CL464
         ORG   MSGS
MSG320   DC    CL51'ICB320I MSS INOPERATIVE. MSC INITIALIZATION FAILED C
               '
MSG321   DS    CL73
         ORG   MSG321
MSG321F  DC    CL18'ICB321I MSC AT UUU'
MSG321S  DC    CL55' FAILED TO INITIALIZE, REASON CODE XXX UCB NOW OFFLC
               INE '
         ORG   MSGS+124
MSG979   DC    CL57'ICB979I MSS INOPERATIVE. ASSOCIATE FAILED, REAS CODC
               E=XXX '
MSG984   DS    CL62
         ORG   MSG984
MSG984F  DC    CL25'ICB984I MSS INOPERATIVE. '
MSG984S  DC    CL37'DISASSOCIATE FAILED, REAS CODE = XXX '
         ORG   MSGS+243
MSG534   DC    CL58'ICB534I MSS INOPERATIVE. ICBMSG05 GETMAIN FAILED, RC
               /C=XXX '
MSG530   DC    CL49'  ICB530I  CPUID MISMATCH - CPUID XXXXXXXXXX USED'
MSG531   DC    CL54'  ICB531I  UNABLE TO READ MSC TABLES - REASON CODE C
               XXX'
MSG532   DC    CL60'  ICB532I  UNABLE TO DETERMINE CPUID - CPUID XXXXXXC
               XXXX USED'
         ORG   MSGS+464
NP19NBRS DS    CL24
         ORG   NP19NBRS
MSG05NUM DC    CL3'534'
OFFLMNUM DC    CL3'975'
INITMNUM DC    CL3'977'
DISAMNUM DC    CL3'980'
ASSCMNUM DC    CL3'979'
MISMNUM  DC    CL3'530'
RDFLMNUM DC    CL3'531'
UNKNMNUM DC    CL3'532'
         ORG   NP19NBRS+24
ICBTEXTS DS    CL391
         ORG   ICBTEXTS
OFFLTEXT DC    CL31'MSS INOPERATIVE. NO MSC ON LINE'
INITTEXT DC    CL58'MSS INOPERATIVE. NO MSC INITIALIZES. MSC     REAS CC
               ODE=   '
INIT2TXT DC    CL23'AND MSC     REAS CODE= '
DISATEXT DC    CL51'MSS INOPERATIVE. DISASSOCIATE FAILED, REAS CODE=   C
               '
ASSCTEXT DC    CL48'MSS INOPERATIVE. ASSOCIATE FAILED, REAS CODE=   '
GETMTEXT DC    CL50'MSS INOPERATIVE. ICBMSG05 GETMAIN FAILED, R/C=XXX '
MISMTEXT DC    CL38'CPUID MISMATCH - CPUID XXXXXXXXXX USED'
RDFLTEXT DC    CL43'UNABLE TO READ MSC TABLES - REASON CODE XXX'
UNKNTEXT DC    CL49'UNABLE TO DETERMINE CPUID - CPUID XXXXXXXXXX USED'
         ORG   ICBTEXTS+391
PARMS    DS    CL8
         ORG   PARMS
RSV      DS    CL1
UPTR     DS    AL3
RSV2     DS    CL4
         ORG   PARMS+8
         DS    CL4
REQLIST1 DS    CL40
VATMSG   DS    CL4
         ORG   VATMSG
REPLYC   DS    CL1
         ORG   VATMSG+4
CHARCONT DC    CL4'CONT'
QUOTCONT DC    CL4'cont'
MSG010   DS    CL38
         ORG   MSG010
BEG010   DC    CL34'  ICB010I PURGE FAILED, REAS CODE='
REAS010  DC    CL4'    '
         ORG   MSG010+38
         DS    CL2
ASDALST  DS    CL16
         ORG   ASDALST
ASDALEN  DC    XL4'10'
ASDAOPC  DC    X'2C'
@NM00170 DC    X'00'
ASDAFLG  DC    B'0000000000000000'
         ORG   ASDAFLG
ASASSOC  DS    BL1
ASDASSOC EQU   ASDAFLG+0
@NM00171 EQU   ASDAFLG+0
ASDEINT  EQU   ASDAFLG+0
ASDMNT   EQU   ASDAFLG+0
@NM00172 EQU   ASDAFLG+0
         ORG   ASDALST+8
ASDACPU  DC    X'0000000000'
ASDA002  DC    X'000000'
         ORG   ASDALST+16
TTRFLD   DS    CL8
         ORG   TTRFLD
PRECCHHR DS    CL3
LABCCHHR DS    CL5
         ORG   TTRFLD+8
CNVTSAV  DS    CL64
LABLDMNT DS    CL6
WTOGEN2  DS    CL73
PCCAID   DS    2CL5
ICBMSG05 CSECT
*                                                         /* @G24LB02*/
NMSGH IEAPMNIP TYPE=HEADER,MSGST=NMSGH,MSGEND=NMSGND           @G24LB02
NMSGST DC CL72'IEAXXXI'            XXX IS CHANGED BEFORE THE   @G24LB02
NMSGND DS 0C                       MESSAGE IS WRITTEN OUT      @G24LB02
NMSH2 IEAPMNIP TYPE=HEADER,MSGST=NMSH2,MSGEND=NMSND2           @G24LB02
NMSST2 DC CL72'IEAXXXI'            XXX IS CHANGED BEFORE THE   @G24LB02
NMSND2 DS 0C                       MESSAGE IS WRITTEN OUT      @G24LB02
ICBMSG05 CSECT
*                                                          /*@G24LB02*/
OFFMSGH IEAPMNIP TYPE=HEADER,MSGST=OFFMSGH,MSGEND=OFFEND       @G24LB02
ONEMSCF DC CL15'IEA976I MSC AT '                               @G24LB02
ONEMSCU DC CL3'   '                                            @G24LB02
         DC C' NOT ON LINE'                                    @G24LB02
         DC 42CL1' '                                           @G24LB02
OFFEND  DS 0C                                                  @G24LB02
ICBMSG05 CSECT
*                                                          /*@G24LB02*/
NITMSGH IEAPMNIP TYPE=HEADER,MSGST=NITMSGH,MSGEND=NITFEND      @G24LB02
NITF    DC CL15'IEA973I MSC AT '                               @G24LB02
NITFMSC DC CL3'   '                                            @G24LB02
         DC C' DOES NOT INITIALIZE, REAS CODE= '               @G24LB02
NITFRC  DC CL3'  '                                             @G24LB02
NITFEND DS 0C                                                  @G24LB02
ICBMSG05 CSECT
*                                /* FOR MESSAGE ABOUT PURGE  @G24LB02*/
PRGMSGH IEAPMNIP TYPE=HEADER,MSGST=PRGMSGH,MSGEND=PRGEND       @G24LB02
PRGMSG  DC C'IEA978I PURGE 3850 FAILED, REAS CODE = '          @G24LB02
PRGRC   DC CL3'   '                                            @G24LB02
        DC 30CL1' '                                            @G24LB02
PRGEND  DS 0C                                                  @G24LB02
ICBMSG05 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RNVT     EQU   @02
RCVT     EQU   @03
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
QUERR1   EQU   @01
GPR01P   EQU   @01
GPR15F   EQU   @15
MDREG1   EQU   @01
PAIRR1   EQU   @01
ASDAR1   EQU   @01
RENTRY   EQU   @15
REXIT    EQU   @14
RPARM    EQU   @01
RSAVE    EQU   @13
R10      EQU   @10
R11      EQU   @11
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
CVTPTR   EQU   16
NVT      EQU   0
NVTNPATR EQU   NVT+54
NVTNPREN EQU   NVTNPATR
NVTFLLB  EQU   NVT+55
NVTABSAV EQU   NVT+140
NVTFLCN  EQU   NVT+211
NVTWTPSW EQU   NVT+224
NVTWPSW2 EQU   NVTWTPSW+4
NVTFLWSC EQU   NVTWPSW2+3
NVTLOAD  EQU   NVT+232
NVTSENSE EQU   NVT+236
NVTSWAIT EQU   NVT+240
NVTTIME  EQU   NVT+244
NVTUCBFN EQU   NVT+248
NVTWTO   EQU   NVT+252
NVTWTOR  EQU   NVT+256
NVTWTOR2 EQU   NVT+260
NVTOPEN  EQU   NVT+264
NVTMOUNT EQU   NVT+268
NVTVIRT  EQU   NVT+276
NVTREAL  EQU   NVT+280
NVTSCHED EQU   NVT+284
NVTOPIO  EQU   NVT+288
NVTPAREA EQU   NVT+368
NVTPTAB  EQU   NVT+372
NVTXCTL  EQU   NVT+428
NVTLOCAT EQU   NVT+436
NVTFLPO  EQU   NVT+528
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBNOTRD EQU   UCBNRY
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBQISCE EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBVALPH EQU   UCBFLB
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPPA   EQU   UCBPTH0
UCBSPA   EQU   UCBPTH0
UCBPTH1  EQU   UCBCHM1
UCBPPB   EQU   UCBPTH1
UCBSPB   EQU   UCBPTH1
UCBWGT   EQU   UCBOB+12
UCBNAME  EQU   UCBOB+13
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCBRVDEV EQU   UCBRWTAU
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3DACC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00021 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
NIPPAHDR EQU   0
NIPPAREA EQU   0
NIPPABDL EQU   NIPPAREA+12
NIPPABDH EQU   NIPPABDL
NIPPAIOD EQU   NIPPAREA+32
NIPPAECB EQU   NIPPAIOD+84
PARMTAB  EQU   0
PURGE    EQU   PARMTAB+264
@NM00061 EQU   PARMTAB+272
NIPPAFLG EQU   @NM00061
NIPPTE   EQU   0
NIPPTOPF EQU   NIPPTE+4
NIPPTATF EQU   NIPPTE+5
NWTOHDR  EQU   0
NWTOFL   EQU   NWTOHDR+2
NWTORLST EQU   0
NWTORFL  EQU   NWTORLST+10
NIPSPE   EQU   0
NIPMNTPL EQU   0
NMNTDS   EQU   NIPMNTPL
NMNTVS   EQU   NIPMNTPL+12
NMNTFL   EQU   NIPMNTPL+20
NIPOPNPL EQU   0
NOPNDS   EQU   NIPOPNPL
NOPNFL   EQU   NIPOPNPL+20
NIPSCHDL EQU   0
CSD      EQU   0
CSDCPUAL EQU   CSD+8
CSDCPUOL EQU   CSD+10
CSDSCWRD EQU   CSD+12
CSDSCFL1 EQU   CSDSCWRD
CSDSCFL2 EQU   CSDSCWRD+1
CSDSCFL3 EQU   CSDSCWRD+2
CSDSCFL4 EQU   CSDSCWRD+3
CSDFLAGS EQU   CSD+23
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBID    EQU   SRB
SRBASCB  EQU   SRB+8
SRBFLC   EQU   SRB+12
SRBPARM  EQU   SRB+28
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTPRLTV EQU   CVTMAP+32
CVTILK2  EQU   CVTMAP+40
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTNIP   EQU   CVTOPTA
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTICB   EQU   CVTXTNT2+48
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
IOSB     EQU   0
IOSFLA   EQU   IOSB
IOSACHN  EQU   IOSFLA
IOSFLB   EQU   IOSB+1
IOSFLC   EQU   IOSB+2
IOSDVALT EQU   IOSFLC
IOSASID  EQU   IOSB+6
IOSPKEY  EQU   IOSB+12
IOSOPT   EQU   IOSB+14
IOSOPT2  EQU   IOSB+15
@NM00107 EQU   IOSB+20
IOSCSW   EQU   @NM00107+1
IOSTATUS EQU   IOSCSW+3
IOSSRB   EQU   IOSB+28
IOSUSE   EQU   IOSB+32
IOSIPIB  EQU   IOSB+44
IOSVST   EQU   IOSB+76
IOSPATH  EQU   IOSB+86
IOSCHN   EQU   IOSPATH
IOSCKEY  EQU   IOSB+89
IOSEEKA  EQU   IOSB+100
IOSCCHH  EQU   IOSEEKA+3
IOSSKHH  EQU   IOSCCHH+2
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBASID EQU   ASCB+36
ASCBRSM  EQU   ASCB+52
ASCBRSMF EQU   ASCBRSM
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
ICB2SSCB EQU   0
ICBECB   EQU   ICB2SSCB+8
ICBACTV  EQU   ICB2SSCB+12
ICBCOM   EQU   ICB2SSCB+16
ICBIOR   EQU   ICB2SSCB+20
ICBPUCB  EQU   ICB2SSCB+28
ICBAUCB  EQU   ICB2SSCB+32
ICBTCB   EQU   ICB2SSCB+40
ICBOPT   EQU   ICB2SSCB+48
ICBNVT   EQU   ICBOPT
ICBFLG   EQU   ICB2SSCB+52
ICBFG1   EQU   ICBFLG
ICBI     EQU   ICBFG1
ICBB     EQU   ICBFG1
ICBS     EQU   ICBFG1
ICBMSCMP EQU   ICBFG1
ICBMSCA  EQU   ICBFG1
ICB2ACTP EQU   ICB2SSCB+56
ICBSIOP  EQU   ICB2SSCB+68
ICBCPUID EQU   ICB2SSCB+112
ICBTRACE EQU   ICB2SSCB+148
PCCA     EQU   0
PCCACPID EQU   PCCA+4
PCCATMST EQU   PCCA+128
PCCATMFL EQU   PCCATMST
PCCATODE EQU   PCCATMST+1
PCCACCE  EQU   PCCATMST+2
PCCAINTE EQU   PCCATMST+3
PCCAEMSB EQU   PCCA+136
PCCAEMSI EQU   PCCAEMSB
PCCARISP EQU   PCCAEMSI
PCCAEMS2 EQU   PCCAEMSI+1
PCCAEMS3 EQU   PCCAEMSI+2
PCCARMSB EQU   PCCAEMSI+3
PCCAWERP EQU   PCCA+280
PCCACHPF EQU   PCCAWERP+4
PCCACHBL EQU   PCCAWERP+5
PCCACHVA EQU   PCCAWERP+6
PCCACHTS EQU   PCCAWERP+7
PCCACHS1 EQU   PCCA+288
PCCACHS2 EQU   PCCA+289
PCCACHRB EQU   PCCA+290
PCCACHF1 EQU   PCCA+308
PCCACHF2 EQU   PCCA+309
PCCACHF3 EQU   PCCA+310
PCCACHF4 EQU   PCCA+311
PCCAVT   EQU   0
PCCAT00P EQU   PCCAVT
LCH      EQU   0
LCHENTRY EQU   LCH
LCHFLA   EQU   LCH+21
CAT      EQU   0
CATENTRY EQU   CAT
CATFLG   EQU   CATENTRY
CATFLA   EQU   CAT+1
NMESS    EQU   0
NMESNUM  EQU   NMESS+3
NMESLET  EQU   NMESS+6
NMESTEXT EQU   NMESS+8
BSRB     EQU   0
BIOSB    EQU   0
@NM00126 EQU   0
@NM00129 EQU   @NM00126+384
TABLCPID EQU   @NM00129
CPUINTFB EQU   @NM00129+6
VALBITS  EQU   @NM00129+7
CPUINTF  EQU   0
CPUPMP   EQU   CPUINTF
@NM00132 EQU   0
VALIDBIT EQU   @NM00132
PCCAPNT  EQU   0
DATACHAN EQU   0
SSCDATA  EQU   DATACHAN
IOECB    EQU   SSCDATA
TCBADDR  EQU   SSCDATA+4
IOERRCD  EQU   SSCDATA+8
APPSW    EQU   SSCDATA+10
APGAREA  EQU   SSCDATA+12
FESAVE   EQU   DATACHAN+84
CCWS     EQU   DATACHAN+160
CCW1CC   EQU   CCWS
CCW1DATA EQU   CCWS+1
CCW1FLGS EQU   CCWS+4
CCW1CNT  EQU   CCWS+6
CCW2CC   EQU   CCWS+8
CCW2DATA EQU   CCWS+9
CCW2FLGS EQU   CCWS+12
CCW2CNT  EQU   CCWS+14
ADRUCB   EQU   0
BITPATT  EQU   0
IHADCB   EQU   0
IHADCS05 EQU   0
DCBMODE  EQU   IHADCS05
DCBSTACK EQU   DCBMODE
DCBFUNC  EQU   IHADCS05+3
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS28 EQU   0
DCBOPTCD EQU   IHADCS28
DCBOPTZ  EQU   DCBOPTCD
IHADCS44 EQU   0
DEBBASIC EQU   0
DEBTCBAD EQU   DEBBASIC
DEBDEBAD EQU   DEBBASIC+4
DEBIRBAD EQU   DEBBASIC+8
DEBOFLGS EQU   DEBIRBAD
DEBOPATB EQU   DEBBASIC+12
DEBFLGS1 EQU   DEBBASIC+14
DEBUSRPG EQU   DEBBASIC+16
DEBRRQ   EQU   DEBBASIC+20
DEBECBAD EQU   DEBRRQ
DEBDCBAD EQU   DEBBASIC+24
DEBPROTG EQU   DEBDCBAD
DEBDCBB  EQU   DEBDCBAD+1
DEBAPPAD EQU   DEBBASIC+28
DEBAPPB  EQU   DEBAPPAD+1
DEBBASND EQU   DEBBASIC+32
DEBDASD  EQU   0
DEBUCBAD EQU   DEBDASD
DEBDVMOD EQU   DEBUCBAD
DEBUCBA  EQU   DEBUCBAD+1
DEBENDCC EQU   DEBDASD+10
DEBENDHH EQU   DEBDASD+12
DEBNMTRK EQU   DEBDASD+14
DEBACSMD EQU   0
DEBVOLSQ EQU   DEBACSMD
DEBVOLBT EQU   DEBVOLSQ
DEBDSNM  EQU   DEBACSMD+4
DEBUTSAA EQU   DEBDSNM
DEBACS01 EQU   0
DEBDSNAM EQU   DEBACS01
DEBACS02 EQU   0
DEBDBLK  EQU   DEBACS02
DEBACS03 EQU   0
DEBACS04 EQU   0
DEBTBFRA EQU   DEBACS04
DEBTCCWA EQU   DEBACS04+4
DEBACS05 EQU   0
DEBFUCBA EQU   DEBACS05
DEBLUCBA EQU   DEBACS05+4
DEBACS06 EQU   0
DEBACS07 EQU   0
DEBACS08 EQU   0
DEBSUBNM EQU   0
DEB      EQU   0
DEBAVT   EQU   DEB
DEBEOEA  EQU   DEBAVT
DEBEOEAB EQU   DEBEOEA
DEBEOEAD EQU   DEBEOEA+1
DEBSIOA  EQU   DEBAVT+4
DEBSIOAB EQU   DEBSIOA
DEBSIOAD EQU   DEBSIOA+1
DEBPCIA  EQU   DEBAVT+8
DEBPCIAB EQU   DEBPCIA
DEBPCIAD EQU   DEBPCIA+1
DEBCEA   EQU   DEBAVT+12
DEBCEAB  EQU   DEBCEA
DEBCEAD  EQU   DEBCEA+1
DEBXCEA  EQU   DEBAVT+16
DEBXCEAB EQU   DEBXCEA
DEBXCEAD EQU   DEBXCEA+1
DEBPREFX EQU   DEB+20
DEBXTNP  EQU   DEBPREFX+8
DEBXTN   EQU   0
DEBXFLG1 EQU   DEBXTN+2
PURGINDC EQU   0
PURGFLG5 EQU   PURGINDC
PURGBIT  EQU   PURGFLG5
SUSPLONG EQU   PURGFLG5
TCBASCB  EQU   0
MSGTCB   EQU   TCBASCB
MSGASCB  EQU   TCBASCB+8
IOBPREFX EQU   0
IOBCFLG1 EQU   IOBPREFX
IOBSTDRD EQU   0
IOBFLAG1 EQU   IOBSTDRD
IOBCMDCH EQU   IOBFLAG1
IOBCYCCK EQU   IOBFLAG1
IOBUNREL EQU   IOBFLAG1
IOBRSTRT EQU   IOBFLAG1
IOBFLAG2 EQU   IOBSTDRD+1
IOBPURGE EQU   IOBFLAG2
IOBRDHA0 EQU   IOBFLAG2
IOBSENS0 EQU   IOBSTDRD+2
IOBS0B1  EQU   IOBSENS0
IOBS0B7  EQU   IOBSENS0
IOBSENS1 EQU   IOBSTDRD+3
IOBECBPT EQU   IOBSTDRD+4
IOBECBPB EQU   IOBECBPT+1
IOBFLAG3 EQU   IOBSTDRD+8
IOBFL3   EQU   IOBFLAG3
IOBCNC   EQU   IOBFL3
IOBICL   EQU   IOBFL3
IOBCSW   EQU   IOBSTDRD+9
IOBIOCSW EQU   IOBCSW
IOBSTBYT EQU   IOBIOCSW+3
IOBUSTAT EQU   IOBSTBYT
IOBCSTAT EQU   IOBSTBYT+1
IOBSTART EQU   IOBSTDRD+16
IOBSIOCC EQU   IOBSTART
IOBSTRTB EQU   IOBSTART+1
IOBDCBPT EQU   IOBSTDRD+20
IOBFLAG4 EQU   IOBDCBPT
IOBDCBPB EQU   IOBDCBPT+1
IOBRESTR EQU   IOBSTDRD+24
IOBINCAM EQU   IOBSTDRD+28
IOBBTAMF EQU   IOBINCAM
LABLBUFF EQU   0
LABVOL   EQU   LABLBUFF+4
LABVTOC  EQU   LABLBUFF+11
RDSNCCWS EQU   0
SRCHCCWS EQU   RDSNCCWS
SRCHCODE EQU   SRCHCCWS
SRCHDATA EQU   SRCHCCWS+1
SCHFLAGS EQU   SRCHCCWS+4
SCHCOUNT EQU   SRCHCCWS+5
TICCCW   EQU   RDSNCCWS+8
TICCODE  EQU   TICCCW
TICDATA  EQU   TICCCW+1
TICFLAGS EQU   TICCCW+4
TICCOUNT EQU   TICCCW+5
READCCW  EQU   RDSNCCWS+16
READCODE EQU   READCCW
READDATA EQU   READCCW+1
RDFLAGS  EQU   READCCW+4
RDCOUNT  EQU   READCCW+5
INITVVI  EQU   0
INILNGTH EQU   INITVVI
INITOPCD EQU   INITVVI+4
INIFLAGA EQU   INITVVI+5
INIENABL EQU   INIFLAGA
INIDISAB EQU   INIFLAGA
INIFLAGB EQU   INITVVI+6
INIVERFY EQU   INIFLAGB
INIJRNL  EQU   INIFLAGB
INIABLE  EQU   INIFLAGB
INIUCAT  EQU   INITVVI+8
ADR1UCB  EQU   0
BEGUPTR  EQU   0
MODNAM   EQU   0
UCBBGN   EQU   0
UCBOBS01 EQU   UCBDEV
UCBVTOC  EQU   UCBOBS01
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00020 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
PSARSVTE EQU   PSARSVT
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTCSD   EQU   CVTS01+312
CVTPCCAT EQU   CVTS01+416
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
IOSATTSC EQU   IOSIPIB
IOSWTOWA EQU   IOSIPIB
IOSPCISC EQU   IOSIPIB
QWPARM   EQU   QUPARM
QWRES1   EQU   QWPARM
QWFLAG   EQU   QWPARM+2
QTPARM   EQU   QUPARM
QTID     EQU   QTPARM
QTFLAG   EQU   QTPARM+1
QTDASCHR EQU   QTPARM+20
QLPARM   EQU   QUPARM
QCPARM   EQU   QUPARM
DEBBAS02 EQU   DEBBASND
DEBDDS1  EQU   DEBBAS02
DEBSUCBA EQU   DEBDDS1
DEBDEVED EQU   DEBDDS1+4
DEBRDCB  EQU   DEBDDS1+4
DEBPDCB  EQU   DEBDDS1+8
DEBWDCB  EQU   DEBDDS1+12
DEBACS09 EQU   DEBDEVED
DEBASC09 EQU   DEBACS09
DEBEAMFG EQU   DEBASC09+3
DEBDSID  EQU   DEBASC09+4
DEBEOD   EQU   DEBASC09+12
DEBBOE   EQU   DEBEOD
DEBEODRV EQU   DEBBOE
DEBEODTT EQU   DEBBOE+1
DEBEOD0  EQU   DEBBOE+2
DEBEODSS EQU   DEBBOE+3
DEBBAS01 EQU   DEBBASND
DEBISAM  EQU   DEBBAS01
DEBFIEAD EQU   DEBISAM
DEBFPEAD EQU   DEBISAM+4
DEBFOEAD EQU   DEBISAM+8
DEBEXPT  EQU   DEBISAM+12
DEBRPSID EQU   DEBEXPT
IOBORG01 EQU   IOBPREFX+8
IOBNIOBA EQU   IOBORG01
IOBNFLG1 EQU   IOBNIOBA
IOBPRTOV EQU   IOBNFLG1
IOBORG02 EQU   IOBPREFX+8
IOBDQADA EQU   IOBORG02
IOBDEQIN EQU   IOBDQADA
IOBORG03 EQU   IOBPREFX+12
IOBORG04 EQU   IOBINCAM
IOBORG12 EQU   IOBINCAM
IOBFL4   EQU   IOBORG12
IOBEXTEN EQU   IOBSTDRD+32
IOBSEEK  EQU   IOBEXTEN
IOBBB    EQU   IOBSEEK+1
IOBCC    EQU   IOBSEEK+3
IOBHH    EQU   IOBSEEK+5
IOBORG05 EQU   IOBEXTEN
IOBORG06 EQU   IOBEXTEN
IOBNXTPT EQU   IOBORG06+4
IOBSTATA EQU   IOBNXTPT
IOBORG07 EQU   IOBEXTEN+8
W1IEXTEN EQU   IOBORG07
IOBORG08 EQU   IOBEXTEN+8
IOBINDCT EQU   IOBORG08+4
IOBUNSQR EQU   IOBORG08+5
IOBFCHAD EQU   IOBORG08+8
IOBORG09 EQU   IOBEXTEN+8
IOBDPLAD EQU   IOBORG09+4
IOBDTYPE EQU   IOBORG09+8
IOBDTYP2 EQU   IOBORG09+9
IOBDSTAT EQU   IOBORG09+10
IOBSTAT1 EQU   IOBDSTAT
IOBORG10 EQU   IOBEXTEN+8
IOBSEEK2 EQU   IOBORG10
IOBORG11 EQU   IOBEXTEN
IOBERCT  EQU   IOBORG11
IOBUCBXV EQU   IOBERCT
IOBNAME  EQU   IOBORG11+4
IOBORG13 EQU   IOBEXTEN
IOBSKADR EQU   IOBORG13
STATBYT1 EQU   IOBSTBYT
UCHECK   EQU   STATBYT1
SIOCC    EQU   IOBSIOCC
SIOCODE  EQU   SIOCC
DMHOSTID EQU   DMHOST
DMNTLEN  EQU   DMLEN
DMOPCODE EQU   DMOPCD
DMVOLID  EQU   DMVOL
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
@NM00165 EQU   SIOCC
@NM00161 EQU   STATBYT1
@NM00160 EQU   STATBYT1
IOBSKSS  EQU   IOBSKADR+3
IOBSK0   EQU   IOBSKADR+2
IOBSKTT  EQU   IOBSKADR+1
IOBSKRV  EQU   IOBSKADR
IOBCSWSV EQU   IOBORG11+17
IOBSENSV EQU   IOBORG11+16
IOBRCD   EQU   IOBORG11+12
IOBMDREC EQU   IOBORG11+8
IOBNAMEA EQU   IOBNAME+1
IOBNAMSZ EQU   IOBNAME
IOBERCTA EQU   IOBERCT+1
IOBRTYPE EQU   IOBUCBXV
IOBRDCHP EQU   IOBORG10+20
IOBNEXTA EQU   IOBORG10+16
IOBREADA EQU   IOBORG10+12
IOBBUFC  EQU   IOBORG10+8
IOBSK2R  EQU   IOBSEEK2+7
IOBSK2HH EQU   IOBSEEK2+5
IOBSK2CC EQU   IOBSEEK2+3
IOBSK2BB EQU   IOBSEEK2+1
IOBSK2M  EQU   IOBSEEK2
IOBCHNPR EQU   IOBORG09+40
IOBDNCRF EQU   IOBORG09+32
IOBRSV35 EQU   IOBORG09+24
IOBDQPTR EQU   IOBORG09+20
IOBRSV34 EQU   IOBORG09+18
IOBDBYTN EQU   IOBORG09+16
IOBDCPND EQU   IOBORG09+12
IOBSTAT2 EQU   IOBDSTAT+1
IOBSIORT EQU   IOBSTAT1
IOBADDVU EQU   IOBSTAT1
IOBBUFF  EQU   IOBSTAT1
IOBENQUE EQU   IOBSTAT1
IOBPASS2 EQU   IOBSTAT1
IOBSYNCH EQU   IOBSTAT1
IOBNEWVL EQU   IOBSTAT1
IOBABNRM EQU   IOBSTAT1
IOBRELEX EQU   IOBDTYP2
IOBADDTY EQU   IOBDTYP2
IOBTYPE  EQU   IOBDTYP2
IOBRQUST EQU   IOBDTYP2
IOBSUFFX EQU   IOBDTYP2
IOBSBLKL EQU   IOBDTYP2
IOBSKEY  EQU   IOBDTYP2
IOBRELBL EQU   IOBDTYPE
IOBRDEXC EQU   IOBDTYPE
IOBDYNBF EQU   IOBDTYPE
IOBACTAD EQU   IOBDTYPE
IOBFDBCK EQU   IOBDTYPE
IOBEXTSC EQU   IOBDTYPE
IOBOVFLO EQU   IOBDTYPE
IOBVERFY EQU   IOBDTYPE
IOBDPLB  EQU   IOBDPLAD+1
IOBDAYLI EQU   IOBDPLAD
IOBDIOBS EQU   IOBORG09+2
IOBDBYTR EQU   IOBORG09
IOBBCHAD EQU   IOBORG08+12
IOBFCHNB EQU   IOBFCHAD+1
IOBCOUNT EQU   IOBFCHAD
IOBASYN  EQU   IOBORG08+7
IOBAPP   EQU   IOBORG08+6
IOBRSV32 EQU   IOBUNSQR
IOBRSV31 EQU   IOBUNSQR
IOBRSV30 EQU   IOBUNSQR
IOBKNRWR EQU   IOBUNSQR
IOBKNWR  EQU   IOBUNSQR
IOBNTAV2 EQU   IOBUNSQR
IOBNTAV1 EQU   IOBUNSQR
IOBCPBSY EQU   IOBUNSQR
IOBCHNNL EQU   IOBINDCT
IOBRSV29 EQU   IOBINDCT
IOBRSV28 EQU   IOBINDCT
IOBRSV27 EQU   IOBINDCT
IOBKEYAD EQU   IOBINDCT
IOBOVPTR EQU   IOBINDCT
IOBUNSCH EQU   IOBINDCT
IOBDEQCP EQU   IOBINDCT
IOBCCWAD EQU   IOBORG08
W1OEXTEN EQU   W1IEXTEN
IOBCCW   EQU   IOBORG06+8
IOBNXTPB EQU   IOBNXTPT+1
IOBRSV26 EQU   IOBSTATA
IOBRSV25 EQU   IOBSTATA
IOBRSV24 EQU   IOBSTATA
IOBRSV23 EQU   IOBSTATA
IOBRSV22 EQU   IOBSTATA
IOBRSV21 EQU   IOBSTATA
IOBRSV20 EQU   IOBSTATA
IOBAVLFL EQU   IOBSTATA
IOBRSV37 EQU   IOBORG06+1
IOBUCBXG EQU   IOBORG06
IOBCPA   EQU   IOBORG05+32
IOBERINF EQU   IOBORG05+16
IOBERCCW EQU   IOBORG05+8
IOBSNDPT EQU   IOBORG05+7
IOBRCVPT EQU   IOBORG05+6
IOBWORK  EQU   IOBORG05+1
IOBUCBX  EQU   IOBORG05
IOBR     EQU   IOBSEEK+7
IOBHH2   EQU   IOBHH+1
IOBHH1   EQU   IOBHH
IOBCC2   EQU   IOBCC+1
IOBCC1   EQU   IOBCC
IOBBB2   EQU   IOBBB+1
IOBBB1   EQU   IOBBB
IOBM     EQU   IOBSEEK
IOBRSV46 EQU   IOBFL4
IOBRSV47 EQU   IOBFL4
IOBENT   EQU   IOBFL4
IOBEQP   EQU   IOBFL4
IOBBUS   EQU   IOBFL4
IOBDCK   EQU   IOBFL4
IOBREJ   EQU   IOBFL4
IOBOVR   EQU   IOBFL4
IOBCRILC EQU   IOBORG04+1
IOBCRDCC EQU   IOBORG04
IOBGQECB EQU   IOBORG03
IOBSWAP  EQU   IOBORG02+4
IOBDQADB EQU   IOBDQADA+1
IOBRSV13 EQU   IOBDEQIN
IOBRSV12 EQU   IOBDEQIN
IOBRSV11 EQU   IOBDEQIN
IOBRSV10 EQU   IOBDEQIN
IOBRSV09 EQU   IOBDEQIN
IOBRSV08 EQU   IOBDEQIN
IOBRSV07 EQU   IOBDEQIN
IOBDEQ   EQU   IOBDEQIN
IOBNECB  EQU   IOBORG01+4
IOBNIOBB EQU   IOBNIOBA+1
IOBFIRST EQU   IOBNFLG1
IOBUPERR EQU   IOBNFLG1
IOBSPAN  EQU   IOBNFLG1
IOBBKSPC EQU   IOBNFLG1
IOBUPDAT EQU   IOBNFLG1
IOBREAD  EQU   IOBNFLG1
IOBWRITE EQU   IOBNFLG1
IOBSEGMT EQU   IOBPRTOV
DEBEXPTA EQU   DEBEXPT+1
DEBRSV12 EQU   DEBRPSID
DEBRSV11 EQU   DEBRPSID
DEBRSV10 EQU   DEBRPSID
DEBRSV09 EQU   DEBRPSID
DEBRPSAP EQU   DEBRPSID
DEBRPSO  EQU   DEBRPSID
DEBRPSI  EQU   DEBRPSID
DEBRPSP  EQU   DEBRPSID
DEBFOEB  EQU   DEBFOEAD+1
DEBNOEE  EQU   DEBFOEAD
DEBFPEB  EQU   DEBFPEAD+1
DEBNPEE  EQU   DEBFPEAD
DEBFIEB  EQU   DEBFIEAD+1
DEBNIEE  EQU   DEBFIEAD
DEBBOESS EQU   DEBEODSS
DEBBOE0  EQU   DEBEOD0
DEBBOETT EQU   DEBEODTT
DEBBOERV EQU   DEBEODRV
DEBRV008 EQU   DEBDSID+7
DEBWTPTI EQU   DEBDSID+6
DEBEXDTE EQU   DEBDSID
DEBRV007 EQU   DEBEAMFG
DEBRV006 EQU   DEBEAMFG
DEBRV005 EQU   DEBEAMFG
DEBRV004 EQU   DEBEAMFG
DEBSECVL EQU   DEBEAMFG
DEBVAMSG EQU   DEBEAMFG
DEBDSOPN EQU   DEBEAMFG
DEBMULTI EQU   DEBEAMFG
DEBVSEQU EQU   DEBASC09+2
DEBDSSQL EQU   DEBASC09+1
DEBVOLAC EQU   DEBASC09
DEBWDCBA EQU   DEBWDCB+1
DEBRSV08 EQU   DEBWDCB
DEBPDCBA EQU   DEBPDCB+1
DEBRSV07 EQU   DEBPDCB
DEBRDCBA EQU   DEBRDCB+1
DEBRSV06 EQU   DEBRDCB
DEBSUCBB EQU   DEBSUCBA+1
DEBSDVM  EQU   DEBSUCBA
QCMAD3Z1 EQU   QCPARM+28
QCMAD3Z0 EQU   QCPARM+24
QCMAD2Z1 EQU   QCPARM+20
QCMAD2Z0 EQU   QCPARM+16
QCMAD1Z1 EQU   QCPARM+12
QCMAD1Z0 EQU   QCPARM+8
QCMAD0Z1 EQU   QCPARM+4
QCMAD0Z0 EQU   QCPARM
QLRES    EQU   QLPARM+2
QLZYX    EQU   QLPARM
QTRES    EQU   QTPARM+24
QTDATA   EQU   QTPARM+2
QTTABID  EQU   QTID
QWRES2   EQU   QWPARM+3
QWALTMSC EQU   QWFLAG
@NM00124 EQU   QWFLAG
QWMEM    EQU   QWFLAG
QWSSID   EQU   QWRES1
IOSPCIWA EQU   IOSPCISC+44
IOSPCIRS EQU   IOSPCISC+8
@NM00112 EQU   IOSPCISC+4
@NM00111 EQU   IOSPCISC
IOSWRNDR EQU   IOSWTOWA+4
IOSWTOPT EQU   IOSWTOWA+3
IOSWTOCP EQU   IOSWTOWA+2
IOSWTOCH EQU   IOSWTOWA
IOSATTWA EQU   IOSATTSC+40
@NM00110 EQU   IOSATTSC+24
IOSATTSN EQU   IOSATTSC
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00020
UCBSKPFG EQU   @NM00020
UCBRIPND EQU   @NM00020
UCBRTIAC EQU   @NM00020
UCBRSV79 EQU   @NM00020
UCBRSV78 EQU   @NM00020
UCBRSV77 EQU   @NM00020
UCBOLTEP EQU   @NM00020
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00019 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
@NM00169 EQU   INITVVI+16
INIVCODE EQU   INITVVI+7
@NM00168 EQU   INIFLAGB
INIRESTR EQU   INIFLAGB
@NM00167 EQU   INIFLAGA
ININIT   EQU   INIFLAGA
@NM00163 EQU   LABLBUFF+16
@NM00162 EQU   LABLBUFF+10
VOL1     EQU   LABLBUFF
IOBERRCT EQU   IOBSTDRD+30
IOBRSV19 EQU   IOBINCAM+1
IOBOLTST EQU   IOBBTAMF
IOBRFTMG EQU   IOBBTAMF
IOBRSV17 EQU   IOBBTAMF
IOBRSV16 EQU   IOBBTAMF
IOBRSV15 EQU   IOBBTAMF
IOBRSV14 EQU   IOBBTAMF
IOBINUSE EQU   IOBBTAMF
IOBPRMER EQU   IOBBTAMF
IOBRSTRB EQU   IOBRESTR+1
IOBREPOS EQU   IOBRESTR
IOBRSV44 EQU   IOBFLAG4
IOBJES3I EQU   IOBFLAG4
IOBRSV42 EQU   IOBFLAG4
IOBRSV41 EQU   IOBFLAG4
IOBRSV40 EQU   IOBFLAG4
IOBPMERR EQU   IOBFLAG4
IOBCC3WE EQU   IOBFLAG4
IOBGDPOL EQU   IOBFLAG4
IOBCSB7  EQU   IOBCSTAT
IOBCSB6  EQU   IOBCSTAT
IOBCSB5  EQU   IOBCSTAT
IOBCSB4  EQU   IOBCSTAT
IOBCSB3  EQU   IOBCSTAT
IOBCSB2  EQU   IOBCSTAT
IOBCSB1  EQU   IOBCSTAT
IOBCSB0  EQU   IOBCSTAT
IOBUSB7  EQU   IOBUSTAT
IOBUSB6  EQU   IOBUSTAT
IOBUSB5  EQU   IOBUSTAT
IOBUSB4  EQU   IOBUSTAT
IOBUSB3  EQU   IOBUSTAT
IOBUSB2  EQU   IOBUSTAT
IOBUSB1  EQU   IOBUSTAT
IOBUSB0  EQU   IOBUSTAT
IOBCMDA  EQU   IOBIOCSW
IOBLOG   EQU   IOBFL3
IOBJAM   EQU   IOBICL
IOBMSG   EQU   IOBFL3
IOBSDR   EQU   IOBCNC
IOBACU   EQU   IOBFL3
IOBCDC   EQU   IOBFL3
IOBICC   EQU   IOBFL3
IOBCCC   EQU   IOBFL3
IOBECBCC EQU   IOBECBPT
IOBS1B7  EQU   IOBSENS1
IOBS1B6  EQU   IOBSENS1
IOBS1B5  EQU   IOBSENS1
IOBS1B4  EQU   IOBSENS1
IOBS1B3  EQU   IOBSENS1
IOBS1B2  EQU   IOBSENS1
IOBS1B1  EQU   IOBSENS1
IOBS1B0  EQU   IOBSENS1
IOBSNSC9 EQU   IOBS0B7
IOBS0B6  EQU   IOBSENS0
IOBS0B5  EQU   IOBSENS0
IOBS0B4  EQU   IOBSENS0
IOBS0B3  EQU   IOBSENS0
IOBS0B2  EQU   IOBSENS0
IOBS0B0  EQU   IOBSENS0
IOBPNCH  EQU   IOBFLAG2
IOBSTATO EQU   IOBFLAG2
IOBSKUPD EQU   IOBFLAG2
IOBALTTR EQU   IOBFLAG2
IOBRRT2  EQU   IOBRDHA0
IOBRRT3  EQU   IOBPURGE
IOBSENSE EQU   IOBFLAG2
IOBHALT  EQU   IOBFLAG2
IOBSPSVC EQU   IOBRSTRT
IOBIOERR EQU   IOBFLAG1
IOBFCREX EQU   IOBCYCCK
IOBRPSTN EQU   IOBFLAG1
IOBERRTN EQU   IOBFLAG1
IOBDATCH EQU   IOBFLAG1
IOBCNOPA EQU   IOBPREFX+12
IOBCICB  EQU   IOBPREFX+8
IOBCECB  EQU   IOBPREFX+4
IOBCONOP EQU   IOBPREFX+3
IOBCINOP EQU   IOBPREFX+2
IOBRSV05 EQU   IOBPREFX+1
IOBPCI   EQU   IOBCFLG1
IOBRSTCH EQU   IOBCFLG1
IOBABAPP EQU   IOBCFLG1
IOBPTST  EQU   IOBCFLG1
IOBRSV04 EQU   IOBCFLG1
IOBRSV03 EQU   IOBCFLG1
IOBRSV02 EQU   IOBCFLG1
IOBRSV01 EQU   IOBCFLG1
@NM00153 EQU   TCBASCB+4
@NM00152 EQU   PURGINDC+1
MSG05FLG EQU   PURGFLG5
DEBXRV40 EQU   DEBXTN+28
DEBXOPNJ EQU   DEBXTN+24
DEBXXARG EQU   DEBXTN+20
DEBXMCF2 EQU   DEBXTN+19
DEBXMCF1 EQU   DEBXTN+18
DEBXDSO2 EQU   DEBXTN+17
DEBXDSO1 EQU   DEBXTN+16
DEBXDBPR EQU   DEBXTN+12
DEBXDCBM EQU   DEBXTN+8
DEBXDSAB EQU   DEBXTN+4
DEBXRV48 EQU   DEBXTN+3
DEBXRV47 EQU   DEBXFLG1
DEBXRV46 EQU   DEBXFLG1
DEBXRV45 EQU   DEBXFLG1
DEBXRV44 EQU   DEBXFLG1
DEBXRV43 EQU   DEBXFLG1
DEBXDSSI EQU   DEBXFLG1
DEBXTSKC EQU   DEBXFLG1
DEBXCDCB EQU   DEBXFLG1
DEBXLNGH EQU   DEBXTN
DEBTBLOF EQU   DEBPREFX+14
DEBAMTYP EQU   DEBPREFX+13
DEBLNGTH EQU   DEBPREFX+12
DEBDCBMK EQU   DEBXTNP
DEBDSCBA EQU   DEBPREFX+1
DEBWKARA EQU   DEBPREFX
DEBXCENP EQU   DEBXCEAB
DEBRSV35 EQU   DEBXCEAB
DEBRSV34 EQU   DEBXCEAB
DEBRSV33 EQU   DEBXCEAB
DEBRSV32 EQU   DEBXCEAB
DEBCENP  EQU   DEBCEAB
DEBRSV31 EQU   DEBCEAB
DEBRSV30 EQU   DEBCEAB
DEBRSV29 EQU   DEBCEAB
DEBRSV28 EQU   DEBCEAB
DEBPCINP EQU   DEBPCIAB
DEBRSV27 EQU   DEBPCIAB
DEBRSV26 EQU   DEBPCIAB
DEBRSV25 EQU   DEBPCIAB
DEBRSV24 EQU   DEBPCIAB
DEBSIONP EQU   DEBSIOAB
DEBFIX   EQU   DEBSIOAB
DEBIOVR  EQU   DEBSIOAB
DEBSIOX  EQU   DEBSIOAB
DEBPGFX  EQU   DEBSIOAB
DEBEOENP EQU   DEBEOEAB
DEBRSV22 EQU   DEBEOEAB
DEBRSV21 EQU   DEBEOEAB
DEBRSV20 EQU   DEBEOEAB
DEBRSV19 EQU   DEBEOEAB
DEBSUBID EQU   DEBSUBNM
DEBSIOA2 EQU   DEBACS08+24
DEBRPSIO EQU   DEBACS08+20
DEBFREED EQU   DEBACS08+16
@NM00151 EQU   DEBACS08+12
@NM00150 EQU   DEBACS08+8
DEBDISAD EQU   DEBACS08+4
@NM00149 EQU   DEBACS08
DEBRPSST EQU   DEBACS07+64
DEBARECK EQU   DEBACS07+60
DEBAREWT EQU   DEBACS07+56
DEBACHK  EQU   DEBACS07+52
DEBAWRIT EQU   DEBACS07+48
DEBASETL EQU   DEBACS07+44
DEBAREAD EQU   DEBACS07+40
DEBCRECK EQU   DEBACS07+36
DEBCREWT EQU   DEBACS07+32
DEBCCHK  EQU   DEBACS07+28
DEBCWRIT EQU   DEBACS07+24
DEBCSETL EQU   DEBACS07+20
DEBCREAD EQU   DEBACS07+16
DEBWKPT5 EQU   DEBACS07+12
DEBWKPT4 EQU   DEBACS07+8
DEBGET   EQU   DEBACS07+4
@NM00148 EQU   DEBACS07
DEBPUT   EQU   DEBACS06+4
DEBDCBFA EQU   DEBACS06
DEBLUCBB EQU   DEBLUCBA+1
DEBRSV18 EQU   DEBLUCBA
DEBFUCBB EQU   DEBFUCBA+1
DEBRSV17 EQU   DEBFUCBA
DEBTCCWB EQU   DEBTCCWA+1
DEBRSV16 EQU   DEBTCCWA
DEBTBFRB EQU   DEBTBFRA+1
DEBRSV15 EQU   DEBTBFRA
DEBDBPEF EQU   DEBACS03+8
DEBDBPP  EQU   DEBACS03+4
DEBDTPP  EQU   DEBACS03
DEBDBPE  EQU   DEBDBLK+1
DEBDBPT  EQU   DEBDBLK
DEBEXTNM EQU   DEBDSNAM
DEBLRECL EQU   DEBACSMD+14
DEBBLKSI EQU   DEBACSMD+12
DEBRSV14 EQU   DEBDSNM+4
DEBUTSAB EQU   DEBUTSAA+1
DEBRSV13 EQU   DEBUTSAA
DEBVOLNM EQU   DEBACSMD+2
DEBVLSEQ EQU   DEBVOLSQ+1
DEBRSV42 EQU   DEBVOLBT
DEBRSV41 EQU   DEBVOLBT
DEBRSV40 EQU   DEBVOLBT
DEBRSV39 EQU   DEBVOLBT
DEBRSV38 EQU   DEBVOLBT
DEBRSV37 EQU   DEBVOLBT
DEBRSV36 EQU   DEBVOLBT
DEBEXFUL EQU   DEBVOLBT
DEBSTRHH EQU   DEBDASD+8
DEBSTRCC EQU   DEBDASD+6
DEBBINUM EQU   DEBDASD+4
DEBEXSCL EQU   DEBAPPAD
DEBDEBID EQU   DEBPROTG
DEBECBB  EQU   DEBECBAD+1
DEBPRIOR EQU   DEBECBAD
DEBUSRPB EQU   DEBUSRPG+1
DEBNMEXT EQU   DEBUSRPG
DEBRSV05 EQU   DEBBASIC+15
DEBXTNIN EQU   DEBFLGS1
DEBAPFIN EQU   DEBFLGS1
DEBF1CEV EQU   DEBFLGS1
DEBCINDI EQU   DEBFLGS1
DEBRSV02 EQU   DEBFLGS1
DEBRSIOA EQU   DEBFLGS1
DEBEOFDF EQU   DEBFLGS1
DEBPWCKD EQU   DEBFLGS1
DEBQSCNT EQU   DEBBASIC+13
DEBACCS  EQU   DEBOPATB
DEBPOSIT EQU   DEBOPATB
DEBZERO  EQU   DEBOPATB
DEBABEND EQU   DEBOPATB
DEBIRBB  EQU   DEBIRBAD+1
DEBRERR  EQU   DEBOFLGS
DEBLABEL EQU   DEBOFLGS
DEBSPLIT EQU   DEBOFLGS
DEBDCB   EQU   DEBOFLGS
DEBRLSE  EQU   DEBOFLGS
DEBEOF   EQU   DEBOFLGS
DEBDISP  EQU   DEBOFLGS
DEBDEBB  EQU   DEBDEBAD+1
DEBAMLNG EQU   DEBDEBAD
DEBTCBB  EQU   DEBTCBAD+1
DEBNMSUB EQU   DEBTCBAD
@NM00147 EQU   IHADCS44+10
DCBXENDA EQU   IHADCS44+8
DCBCENDA EQU   IHADCS44+6
DCBSIOA  EQU   IHADCS44+4
DCBPCIA  EQU   IHADCS44+2
DCBEOEA  EQU   IHADCS44
@NM00146 EQU   IHADCS28+1
@NM00145 EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
@NM00144 EQU   DCBOPTCD
DCBDEBA  EQU   DCBDEBAD+1
@NM00143 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00142 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
@NM00141 EQU   DCBFUNC
DCBFNCBT EQU   DCBFUNC
DCBFNCBX EQU   DCBFUNC
DCBFNCBD EQU   DCBFUNC
DCBFNCBW EQU   DCBFUNC
DCBFNCBP EQU   DCBFUNC
DCBFNCBR EQU   DCBFUNC
DCBFNCBI EQU   DCBFUNC
@NM00140 EQU   IHADCS05+2
@NM00139 EQU   IHADCS05+1
DCBSTCK1 EQU   DCBSTACK
DCBSTCK2 EQU   DCBSTACK
@NM00138 EQU   DCBSTACK
DCBMODER EQU   DCBSTACK
DCBMODEO EQU   DCBSTACK
DCBMODEE EQU   DCBSTACK
DCBMODEC EQU   DCBSTACK
@NM00137 EQU   IHADCB
@NM00136 EQU   CCWS+13
@NM00135 EQU   CCWS+5
@NM00134 EQU   DATACHAN+156
DMTVOL   EQU   SSCDATA+78
DMTID    EQU   SSCDATA+76
APPSAV   EQU   APGAREA
@NM00133 EQU   APPSW
ATTNSW   EQU   APPSW
POSTSW   EQU   APPSW
ERPSW    EQU   APPSW
SSCDERR  EQU   IOERRCD
TCBPTR   EQU   TCBADDR
ECBCODE  EQU   IOECB
@NM00131 EQU   CPUINTF
@NM00130 EQU   @NM00129+5
@NM00128 EQU   @NM00126+256
@NM00127 EQU   @NM00126
@NM00117 EQU   NMESS+7
@NM00116 EQU   NMESS
CATEND   EQU   CAT+8
CATCHID  EQU   CAT+4
CATSIOCT EQU   CAT+2
CASFLARS EQU   CATFLA
CATBSY   EQU   CATFLA
CATFLG7  EQU   CATFLG
CATFLG6  EQU   CATFLG
CATFLG5  EQU   CATFLG
CATNID   EQU   CATFLG
CATNCPU  EQU   CATFLG
CATNGEN  EQU   CATFLG
CATNOP   EQU   CATFLG
CATRES1  EQU   CATFLG
LCHEND   EQU   LCH+32
LCHPYBSY EQU   LCH+30
LCHLGBSY EQU   LCH+28
LCHRSV03 EQU   LCH+26
LCHTOTAL EQU   LCH+24
LCHRSV02 EQU   LCH+22
@NM00115 EQU   LCHFLA
LCHLKHLD EQU   LCHFLA
LCHCHCNT EQU   LCH+20
LCHTCH   EQU   LCH+16
LCHRSV01 EQU   LCH+12
LCHLOCK  EQU   LCH+8
LCHLST   EQU   LCH+4
LCHFST   EQU   LCHENTRY
@NM00114 EQU   PCCA+512
PCCACAT  EQU   PCCA+384
PCCARV36 EQU   PCCA+380
PCCARV35 EQU   PCCA+378
PCCARV01 EQU   PCCA+377
PCCACPUM EQU   PCCA+376
PCCARV63 EQU   PCCA+372
PCCARV62 EQU   PCCA+368
PCCARV61 EQU   PCCA+364
PCCARV60 EQU   PCCA+360
PCCARV59 EQU   PCCA+356
PCCARV58 EQU   PCCA+352
PCCARV57 EQU   PCCA+348
PCCARV56 EQU   PCCA+344
PCCARV55 EQU   PCCA+340
PCCARV54 EQU   PCCA+336
PCCALOGA EQU   PCCA+332
PCCACHID EQU   PCCA+324
PCCACHSV EQU   PCCA+312
PCCARV79 EQU   PCCACHF4
PCCARV78 EQU   PCCACHF4
PCCARV77 EQU   PCCACHF4
PCCARV76 EQU   PCCACHF4
PCCARV75 EQU   PCCACHF4
PCCARV74 EQU   PCCACHF4
PCCARV73 EQU   PCCACHF4
PCCARV72 EQU   PCCACHF4
PCCARV71 EQU   PCCACHF3
PCCARV70 EQU   PCCACHF3
PCCARV69 EQU   PCCACHF3
PCCARV68 EQU   PCCACHF3
PCCARV67 EQU   PCCACHF3
PCCARV66 EQU   PCCACHF3
PCCARV65 EQU   PCCACHF3
PCCARV64 EQU   PCCACHF3
PCCACF28 EQU   PCCACHF2
PCCACF27 EQU   PCCACHF2
PCCACF26 EQU   PCCACHF2
PCCACF25 EQU   PCCACHF2
PCCACF24 EQU   PCCACHF2
PCCACF23 EQU   PCCACHF2
PCCACF22 EQU   PCCACHF2
PCCACF21 EQU   PCCACHF2
PCCACF18 EQU   PCCACHF1
PCCACF17 EQU   PCCACHF1
PCCACF16 EQU   PCCACHF1
PCCACF15 EQU   PCCACHF1
PCCACF14 EQU   PCCACHF1
PCCACF13 EQU   PCCACHF1
PCCACF12 EQU   PCCACHF1
PCCACF11 EQU   PCCACHF1
PCCARV05 EQU   PCCA+306
PCCACHPB EQU   PCCA+305
PCCALGP2 EQU   PCCA+304
PCCALGP1 EQU   PCCA+303
PCCALOGL EQU   PCCA+302
PCCARV80 EQU   PCCA+300
PCCACHW2 EQU   PCCA+296
PCCACHW1 EQU   PCCA+292
PCCAIOSI EQU   PCCA+291
PCCACNRB EQU   PCCACHRB
PCCACCVB EQU   PCCACHRB
PCCACSNB EQU   PCCACHRB
PCCARV52 EQU   PCCACHRB
PCCACHIB EQU   PCCACHRB
PCCACTIB EQU   PCCACHRB
PCCACINB EQU   PCCACHRB
PCCACSIB EQU   PCCACHRB
PCCARV51 EQU   PCCACHS2
PCCARV50 EQU   PCCACHS2
PCCACCRA EQU   PCCACHS2
PCCACURC EQU   PCCACHS2
PCCACNLG EQU   PCCACHS2
PCCACMOD EQU   PCCACHS2
PCCACALT EQU   PCCACHS2
PCCACIOR EQU   PCCACHS2
PCCARV47 EQU   PCCACHS1
PCCACUCB EQU   PCCACHS1
PCCACIBC EQU   PCCACHS1
PCCACAND EQU   PCCACHS1
PCCACNLS EQU   PCCACHS1
PCCACFRR EQU   PCCACHS1
PCCACNRE EQU   PCCACHS1
PCCACCMP EQU   PCCACHS1
PCCACSEQ EQU   PCCACHTS
PCCACDIN EQU   PCCACHTS
PCCARV44 EQU   PCCACHTS
PCCARV43 EQU   PCCACHTS
PCCACTEC EQU   PCCACHTS
PCCACDAV EQU   PCCACHVA
PCCACCHV EQU   PCCACHVA
PCCACCMD EQU   PCCACHVA
PCCACUNS EQU   PCCACHVA
PCCACSQV EQU   PCCACHVA
PCCARV42 EQU   PCCACHVA
PCCARV41 EQU   PCCACHVA
PCCACITF EQU   PCCACHVA
PCCARV40 EQU   PCCACHBL
PCCARV39 EQU   PCCACHBL
PCCARV38 EQU   PCCACHBL
PCCACCUE EQU   PCCACHBL
PCCACSTG EQU   PCCACHBL
PCCACSCU EQU   PCCACHBL
PCCACCHA EQU   PCCACHBL
PCCACCPU EQU   PCCACHBL
PCCACNOR EQU   PCCACHPF
PCCACCNT EQU   PCCACHPF
PCCACSNS EQU   PCCACHPF
PCCARV37 EQU   PCCACHPF
PCCACHIO EQU   PCCACHPF
PCCACTIO EQU   PCCACHPF
PCCACINT EQU   PCCACHPF
PCCACSIO EQU   PCCACHPF
PCCACHUB EQU   PCCAWERP
PCCACHEL EQU   PCCA+168
PCCALRBR EQU   PCCA+164
PCCALRBV EQU   PCCA+160
PCCAPWAR EQU   PCCA+156
PCCAPWAV EQU   PCCA+152
PCCAEMSA EQU   PCCAEMSB+12
PCCAEMSE EQU   PCCAEMSB+8
PCCAEMSP EQU   PCCAEMSB+4
PCCARMS  EQU   PCCARMSB
PCCARV34 EQU   PCCARMSB
PCCARV33 EQU   PCCARMSB
PCCARV32 EQU   PCCARMSB
PCCARV31 EQU   PCCARMSB
PCCARV30 EQU   PCCARMSB
PCCARV29 EQU   PCCARMSB
PCCARV28 EQU   PCCARMSB
PCCARV27 EQU   PCCAEMS3
PCCARV26 EQU   PCCAEMS3
PCCARV25 EQU   PCCAEMS3
PCCARV24 EQU   PCCAEMS3
PCCARV23 EQU   PCCAEMS3
PCCARV22 EQU   PCCAEMS3
PCCARV21 EQU   PCCAEMS3
PCCARV20 EQU   PCCAEMS3
PCCARV19 EQU   PCCAEMS2
PCCARV18 EQU   PCCAEMS2
PCCARV17 EQU   PCCAEMS2
PCCARV16 EQU   PCCAEMS2
PCCARV15 EQU   PCCAEMS2
PCCARV14 EQU   PCCAEMS2
PCCARV13 EQU   PCCAEMS2
PCCARV12 EQU   PCCAEMS2
PCCARV11 EQU   PCCARISP
PCCARV10 EQU   PCCARISP
PCCARV09 EQU   PCCARISP
PCCARV08 EQU   PCCARISP
PCCARV07 EQU   PCCARISP
PCCARV06 EQU   PCCARISP
PCCASERL EQU   PCCARISP
PCCAPARL EQU   PCCARISP
PCCARPB  EQU   PCCA+132
PCCACTIN EQU   PCCAINTE
PCCANFIN EQU   PCCAINTE
PCCANUIN EQU   PCCAINTE
PCCACTCC EQU   PCCACCE
PCCANFCC EQU   PCCACCE
PCCANUCC EQU   PCCACCE
PCCACTTD EQU   PCCATODE
PCCANFTD EQU   PCCATODE
PCCANUTD EQU   PCCATODE
PCCARV04 EQU   PCCATMFL
PCCARV03 EQU   PCCATMFL
PCCARV02 EQU   PCCATMFL
PCCAMINT EQU   PCCATMFL
PCCAMCC  EQU   PCCATMFL
PCCAVKIL EQU   PCCATMFL
PCCASYNC EQU   PCCATMFL
PCCAINIT EQU   PCCATMFL
PCCARV9E EQU   PCCA+124
PCCARV9D EQU   PCCA+120
PCCARV9C EQU   PCCA+116
PCCARV9B EQU   PCCA+112
PCCARV9A EQU   PCCA+108
PCCARV99 EQU   PCCA+104
PCCARV98 EQU   PCCA+100
PCCARV97 EQU   PCCA+96
PCCARV96 EQU   PCCA+92
PCCARV95 EQU   PCCA+88
PCCARV94 EQU   PCCA+84
PCCARV93 EQU   PCCA+80
PCCARV92 EQU   PCCA+76
PCCARV91 EQU   PCCA+72
PCCARV90 EQU   PCCA+68
PCCARV89 EQU   PCCA+64
PCCARV88 EQU   PCCA+60
PCCARV87 EQU   PCCA+56
PCCARV86 EQU   PCCA+52
PCCARV85 EQU   PCCA+48
PCCARV84 EQU   PCCA+44
PCCARV83 EQU   PCCA+40
PCCARV82 EQU   PCCA+36
PCCARV81 EQU   PCCA+32
PCCAPSAR EQU   PCCA+28
PCCAPSAV EQU   PCCA+24
PCCATQEP EQU   PCCA+20
PCCACAFM EQU   PCCA+18
PCCACPUA EQU   PCCA+16
PCCAPCCA EQU   PCCA
ICBLORD  EQU   ICBTRACE+256
ICBOTRC  EQU   ICBTRACE
ICBRESV  EQU   ICB2SSCB+128
ICBVOLST EQU   ICB2SSCB+124
ICBVSCRA EQU   ICB2SSCB+120
ICBSAMP  EQU   ICB2SSCB+118
ICBRESVD EQU   ICB2SSCB+117
ICBFAB   EQU   ICB2SSCB+108
ICBMSSC  EQU   ICB2SSCB+104
ICBRSVP  EQU   ICB2SSCB+100
ICBAEAP  EQU   ICB2SSCB+96
ICBSIOBP EQU   ICB2SSCB+92
ICBIATNA EQU   ICB2SSCB+88
ICBIPRGA EQU   ICB2SSCB+84
ICBSRBP  EQU   ICB2SSCB+80
ICBVVICB EQU   ICB2SSCB+76
ICBVVIC  EQU   ICB2SSCB+72
ICBMEP   EQU   ICB2SSCB+64
ICBIORCI EQU   ICB2SSCB+60
ICBFG3   EQU   ICBFLG+2
ICBFG2   EQU   ICBFLG+1
@NM00113 EQU   ICBFG1
ICBV     EQU   ICBFG1
ICBR     EQU   ICBFG1
ICBVN02P EQU   ICB2SSCB+44
ICBQHEAD EQU   ICB2SSCB+36
ICBCOMQ  EQU   ICB2SSCB+24
ICBSSNAM EQU   ICB2SSCB
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSMA EQU   ASCBRSM+1
ASCBRV54 EQU   ASCBRSMF
ASCBRV53 EQU   ASCBRSMF
ASCBRV52 EQU   ASCBRSMF
ASCBRV51 EQU   ASCBRSMF
ASCBVEQR EQU   ASCBRSMF
ASCBN2LP EQU   ASCBRSMF
ASCB1LPU EQU   ASCBRSMF
ASCB2LPU EQU   ASCBRSMF
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
IOSEND   EQU   IOSB+108
IOSSKR   EQU   IOSEEKA+7
IOSSKH2  EQU   IOSSKHH+1
IOSSKH1  EQU   IOSSKHH
IOSSKCC  EQU   IOSCCHH
IOSSKBB  EQU   IOSEEKA+1
IOSSKM   EQU   IOSEEKA
IOSEEK   EQU   IOSB+92
IOSMDM   EQU   IOSB+91
IOSMDB   EQU   IOSB+90
IOSCKEY7 EQU   IOSCKEY
IOSCKEY6 EQU   IOSCKEY
IOSCKEY5 EQU   IOSCKEY
IOSCKEY4 EQU   IOSCKEY
@NM00109 EQU   IOSCKEY
IOSFMSK  EQU   IOSB+88
IOSCUDEV EQU   IOSPATH+1
@NM00108 EQU   IOSCHN
IOSPATH3 EQU   IOSCHN
IOSPATH2 EQU   IOSCHN
IOSEXP   EQU   IOSCHN
IOSGDP   EQU   IOSCHN
IOSAFF   EQU   IOSB+85
IOSRSS1B EQU   IOSB+84
IOSDSID  EQU   IOSB+80
IOSRST   EQU   IOSB+72
IOSDIE   EQU   IOSB+68
IOSABN   EQU   IOSB+64
IOSNRM   EQU   IOSB+60
IOSPCI   EQU   IOSB+56
IOSERP   EQU   IOSB+52
IOSPCHN  EQU   IOSB+48
IOSSNS   EQU   IOSB+42
IOSAPMSK EQU   IOSB+40
IOSRES4A EQU   IOSB+36
IOSCSWRC EQU   IOSCSW+5
IOSTSB   EQU   IOSTATUS+1
IOSTSA   EQU   IOSTATUS
IOSCSWCA EQU   IOSCSW
IOSCC    EQU   @NM00107
IOSUCB   EQU   IOSB+16
IOSOPT2X EQU   IOSOPT2
IOSIGP   EQU   IOSOPT2
IOSHTP   EQU   IOSOPT2
IOSRELSE EQU   IOSOPT
IOSAPR   EQU   IOSOPT
IOSTSLL  EQU   IOSOPT
IOSNERP  EQU   IOSOPT
IOSPSLL  EQU   IOSOPT
IOSQISCE EQU   IOSOPT
IOSDEP   EQU   IOSOPT
IOSBYP   EQU   IOSOPT
IOSCOD   EQU   IOSB+13
IOSPKY7  EQU   IOSPKEY
IOSPGDPX EQU   IOSPKEY
IOSIDR   EQU   IOSPKEY
IOSLCL   EQU   IOSPKEY
@NM00106 EQU   IOSPKEY
IOSPGAD  EQU   IOSB+8
IOSPRLVL EQU   IOSB+5
IOSDVRID EQU   IOSB+4
IOSPROC  EQU   IOSB+3
IOSFLC7  EQU   IOSFLC
IOSCTCNR EQU   IOSFLC
IOSRWAIT EQU   IOSFLC
IOSTP    EQU   IOSFLC
IOSCC3WE EQU   IOSFLC
IOSVERIF EQU   IOSDVALT
IOSDVMNT EQU   IOSFLC
IOSLOG   EQU   IOSFLB
IOSBDCST EQU   IOSFLB
IOSMSG   EQU   IOSFLB
IOSFLB4  EQU   IOSFLB
IOSFLB3  EQU   IOSFLB
IOSNOTRS EQU   IOSFLB
IOSSDR   EQU   IOSFLB
IOSDIESE EQU   IOSFLB
IOSIOSB  EQU   IOSFLA
IOSDOM   EQU   IOSFLA
IOSEX    EQU   IOSFLA
IOSSMDB  EQU   IOSFLA
IOSSMDA  EQU   IOSFLA
IOSERR   EQU   IOSFLA
IOSCCHN  EQU   IOSACHN
IOSDCHN  EQU   IOSACHN
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00105 EQU   CVTFIX+248
@NM00104 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK1  EQU   CVTMAP+36
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
@NM00079 EQU   SRB+40
@NM00078 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBRMTR  EQU   SRB+24
SRBEP    EQU   SRB+20
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBFLNK  EQU   SRB+4
@NM00077 EQU   CSD+160
CSDMASK  EQU   CSD+128
CSDUCNT  EQU   CSD+124
CSDTCNT  EQU   CSD+120
CSDGDTOD EQU   CSD+116
CSDGDINT EQU   CSD+112
CSDGDCC  EQU   CSD+108
CSDDDRCT EQU   CSD+106
CSDRV044 EQU   CSD+104
CSDMAFF  EQU   CSD+24
CSDRV038 EQU   CSDFLAGS
CSDRV037 EQU   CSDFLAGS
CSDRV036 EQU   CSDFLAGS
CSDRV035 EQU   CSDFLAGS
CSDRV034 EQU   CSDFLAGS
CSDRV033 EQU   CSDFLAGS
CSDRV032 EQU   CSDFLAGS
CSDMP    EQU   CSDFLAGS
CSDACR   EQU   CSD+22
CSDMF1CP EQU   CSD+20
CSDRV043 EQU   CSD+16
CSDRV030 EQU   CSDSCFL4
CSDRV029 EQU   CSDSCFL4
CSDRV028 EQU   CSDSCFL4
CSDRV027 EQU   CSDSCFL4
CSDRV026 EQU   CSDSCFL4
CSDRV025 EQU   CSDSCFL4
CSDRV024 EQU   CSDSCFL4
CSDRV023 EQU   CSDSCFL4
CSDRV022 EQU   CSDSCFL3
CSDRV021 EQU   CSDSCFL3
CSDRV020 EQU   CSDSCFL3
CSDRV019 EQU   CSDSCFL3
CSDRV018 EQU   CSDSCFL3
CSDRV017 EQU   CSDSCFL3
CSDRV016 EQU   CSDSCFL3
CSDRV015 EQU   CSDSCFL3
CSDRV014 EQU   CSDSCFL2
CSDRV013 EQU   CSDSCFL2
CSDRV012 EQU   CSDSCFL2
CSDRV011 EQU   CSDSCFL2
CSDRV010 EQU   CSDSCFL2
CSDRV009 EQU   CSDSCFL2
CSDRV008 EQU   CSDSCFL2
CSDRV007 EQU   CSDSCFL2
CSDRV006 EQU   CSDSCFL1
CSDRV005 EQU   CSDSCFL1
CSDRV004 EQU   CSDSCFL1
CSDRV003 EQU   CSDSCFL1
CSDRV002 EQU   CSDSCFL1
CSDRV001 EQU   CSDSCFL1
CSDSYSND EQU   CSDSCFL1
CSDRV042 EQU   CSDSCFL1
CSDSAFF  EQU   CSDCPUAL
CSDCHAD  EQU   CSD+6
CSDCPUJS EQU   CSD+4
CSDCSD   EQU   CSD
NSCHDCPU EQU   NIPSCHDL+8
NSCHDPRM EQU   NIPSCHDL+4
NSCHDPTR EQU   NIPSCHDL
@NM00076 EQU   NIPOPNPL+22
NOPNRC   EQU   NIPOPNPL+21
NOPNFLSX EQU   NOPNFL
NOPNFLLC EQU   NOPNFL
NOPNFLLB EQU   NOPNFL
NOPNFLNB EQU   NOPNFL
NOPNFLI  EQU   NOPNFL
NOPNFLM  EQU   NOPNFL
NOPNFAU  EQU   NOPNFL
NOPNFRS  EQU   NOPNFL
NOPNUCB  EQU   NIPOPNPL+16
NOPNDCB  EQU   NIPOPNPL+12
NOPNDSA  EQU   NOPNDS
@NM00075 EQU   NIPMNTPL+21
NMNTFLB  EQU   NMNTFL
NMNTFLC  EQU   NMNTFL
NMNTFLI  EQU   NMNTFL
NMNTFUS  EQU   NMNTFL
@NM00074 EQU   NMNTFL
NMNTDT   EQU   NIPMNTPL+18
NMNTUCB  EQU   NMNTVS
NMNTDSA  EQU   NMNTDS
NIPSPEA  EQU   NIPSPE+4
NIPSPEQ  EQU   NIPSPE
NWTORMSG EQU   NWTORLST+12
@NM00073 EQU   NWTORLST+11
@NM00072 EQU   NWTORFL
NWTORFLB EQU   NWTORFL
@NM00071 EQU   NWTORFL
NWTORFLA EQU   NWTORFL
NMTORRDL EQU   NWTORLST+8
NWTORECB EQU   NWTORLST+4
NWTORRPA EQU   NWTORLST
@NM00070 EQU   NWTOFL
NWTOFLNC EQU   NWTOFL
NWTOFLNH EQU   NWTOFL
NWTOLNG  EQU   NWTOHDR
NIPPTSID EQU   NIPPTE+6
@NM00069 EQU   NIPPTATF
NIPPTMRG EQU   NIPPTATF
@NM00068 EQU   NIPPTOPF
NIPPTCAN EQU   NIPPTOPF
NIPPTLST EQU   NIPPTOPF
NIPPTOPI EQU   NIPPTOPF
NIPPTADR EQU   NIPPTE
PTABEND  EQU   PARMTAB+312
@NM00067 EQU   PARMTAB+308
DUPLEX   EQU   PARMTAB+304
@NM00066 EQU   PARMTAB+300
PAGNUM   EQU   PARMTAB+296
@NM00065 EQU   PARMTAB+292
SWAP     EQU   PARMTAB+288
@NM00064 EQU   PARMTAB+284
RSU      EQU   PARMTAB+280
@NM00063 EQU   @NM00061+1
@NM00062 EQU   NIPPAFLG
NIPPAFL1 EQU   NIPPAFLG
@NM00060 EQU   PARMTAB+268
@NM00059 EQU   PARMTAB+260
WTORPLY  EQU   PARMTAB+256
@NM00058 EQU   PARMTAB+252
WTOBFRS  EQU   PARMTAB+248
@NM00057 EQU   PARMTAB+244
VRREGN   EQU   PARMTAB+240
@NM00056 EQU   PARMTAB+236
VAL      EQU   PARMTAB+232
@NM00055 EQU   PARMTAB+228
SYSP     EQU   PARMTAB+224
@NM00054 EQU   PARMTAB+220
SQA      EQU   PARMTAB+216
@NM00053 EQU   PARMTAB+212
SMF      EQU   PARMTAB+208
@NM00052 EQU   PARMTAB+204
REAL     EQU   PARMTAB+200
@NM00051 EQU   PARMTAB+196
PAGEO    EQU   PARMTAB+192
@NM00050 EQU   PARMTAB+188
PAGEP    EQU   PARMTAB+184
@NM00049 EQU   PARMTAB+180
OPT      EQU   PARMTAB+176
@NM00048 EQU   PARMTAB+172
OPI      EQU   PARMTAB+168
@NM00047 EQU   PARMTAB+164
NUCMAP   EQU   PARMTAB+160
@NM00046 EQU   PARMTAB+156
MLPA     EQU   PARMTAB+152
@NM00045 EQU   PARMTAB+148
MAXUSER  EQU   PARMTAB+144
@NM00044 EQU   PARMTAB+140
LOGLMT   EQU   PARMTAB+136
@NM00043 EQU   PARMTAB+132
LOGCLS   EQU   PARMTAB+128
@NM00042 EQU   PARMTAB+124
LNK      EQU   PARMTAB+120
@NM00041 EQU   PARMTAB+116
IPS      EQU   PARMTAB+112
@NM00040 EQU   PARMTAB+108
HARDCPY  EQU   PARMTAB+104
@NM00039 EQU   PARMTAB+100
FIX      EQU   PARMTAB+96
@NM00038 EQU   PARMTAB+92
DUMP     EQU   PARMTAB+88
@NM00037 EQU   PARMTAB+84
CVIO     EQU   PARMTAB+80
@NM00036 EQU   PARMTAB+76
CSA      EQU   PARMTAB+72
@NM00035 EQU   PARMTAB+68
CPQE     EQU   PARMTAB+64
@NM00034 EQU   PARMTAB+60
CONT     EQU   PARMTAB+56
@NM00033 EQU   PARMTAB+52
CMD      EQU   PARMTAB+48
@NM00032 EQU   PARMTAB+44
CLPA     EQU   PARMTAB+40
@NM00031 EQU   PARMTAB+36
BLDLF    EQU   PARMTAB+32
@NM00030 EQU   PARMTAB+28
BLDL     EQU   PARMTAB+24
@NM00029 EQU   PARMTAB+20
APG      EQU   PARMTAB+16
@NM00028 EQU   PARMTAB+12
APF      EQU   PARMTAB+8
PTABSTRT EQU   PARMTAB
NIPPABUF EQU   NIPPAREA+572
NIPPAPTB EQU   NIPPAREA+252
@NM00027 EQU   NIPPAREA+248
NIPPARCD EQU   NIPPAIOD+136
NIPPADEB EQU   NIPPAIOD+88
@NM00026 EQU   NIPPAECB+1
NIPPAECC EQU   NIPPAECB
NIPPADCB EQU   NIPPAIOD+80
NIPPAIOB EQU   NIPPAIOD+40
@NM00025 EQU   NIPPAIOD+37
NIPPASID EQU   NIPPAIOD+32
NIPPATXT EQU   NIPPAIOD
@NM00024 EQU   NIPPAREA+30
@NM00023 EQU   NIPPABDL+15
NIPPATTR EQU   NIPPABDL+12
NIPPANAM EQU   NIPPABDL+4
NIPPA2BF EQU   NIPPABDH
NIPPARC  EQU   NIPPAREA+8
@NM00022 EQU   NIPPAREA
NIPPABYT EQU   NIPPAHDR+4
NIPPAQ   EQU   NIPPAHDR
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00021
UCBHALI  EQU   @NM00021
UCBRSV09 EQU   @NM00021
UCBRSV08 EQU   @NM00021
UCBRSV07 EQU   @NM00021
UCBRSV06 EQU   @NM00021
UCBRSV05 EQU   @NM00021
UCBRSV04 EQU   @NM00021
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBFLB7  EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00018 EQU   UCB
NVTRMSG  EQU   NVT+540
NVTRLOCK EQU   NVT+536
NVTRCODE EQU   NVT+532
@NM00017 EQU   NVT+529
@NM00016 EQU   NVTFLPO
NVTFLWS  EQU   NVTFLPO
NVTFLQS  EQU   NVTFLPO
@NM00015 EQU   NVTFLPO
NVTSYSP  EQU   NVTFLPO
NVTFLLST EQU   NVTFLPO
NVTAPQE  EQU   NVT+524
NVTFBQE2 EQU   NVT+520
NVTFBQE1 EQU   NVT+516
@NM00014 EQU   NVT+512
NVTREALR EQU   NVT+508
NVTFASVT EQU   NVT+504
NVTLPALG EQU   NVT+496
NVTVRLNG EQU   NVT+492
NVTVRREG EQU   NVT+488
NVTLVIRT EQU   NVT+484
NVTDIRA  EQU   NVT+480
NVTLPAND EQU   NVT+476
NVTRMSS  EQU   NVT+472
NVTRPQE  EQU   NVT+468
NVTRLLE  EQU   NVT+464
NVTRJPQ  EQU   NVT+460
NVTVMSS  EQU   NVT+456
NVTVPQE  EQU   NVT+452
NVTVLLE  EQU   NVT+448
NVTVJPQ  EQU   NVT+444
NVTLSEC  EQU   NVTLOCAT+4
NVTLFST  EQU   NVTLOCAT
NVTXSEC  EQU   NVTXCTL+4
NVTXFST  EQU   NVTXCTL
@NM00013 EQU   NVT+425
NVTLPACT EQU   NVT+424
NVTCSLPG EQU   NVT+420
NVTCSIOB EQU   NVT+416
NVTCSLNM EQU   NVT+412
NVTCSLIB EQU   NVT+408
NVTBLDL  EQU   NVT+404
NVTVRBLD EQU   NVT+400
@NM00012 EQU   NVT+392
NVTVRTCB EQU   NVT+388
NVTVVTCB EQU   NVT+384
NVTSPUCB EQU   NVT+382
NVTQSCNT EQU   NVT+380
NVTQSBUF EQU   NVT+376
NVTRPAGE EQU   NVT+364
@NM00011 EQU   NVT+363
NVTABWS1 EQU   NVT+362
NVTABCD1 EQU   NVT+360
@NM00010 EQU   NVT+358
NVTCPUAD EQU   NVT+356
NVTTOD   EQU   NVT+352
NVTSPE   EQU   NVT+344
NVTMBEND EQU   NVT+340
NVTMBUF  EQU   NVT+336
NVTDCBSN EQU   NVT+332
NVTDCBOC EQU   NVT+328
NVTDCBIC EQU   NVT+324
@NM00009 EQU   NVT+308
NVTNMBLD EQU   NVT+304
NVTNIPM  EQU   NVT+292
NVTPRMPT EQU   NVT+272
NVTIX    EQU   NVTFLWSC
NVTFLWS1 EQU   NVTWPSW2+2
NVTIDPSW EQU   NVTWPSW2
NVTWPSW1 EQU   NVTWTPSW
NVTMCPSW EQU   NVT+216
@NM00008 EQU   NVT+212
@NM00007 EQU   NVTFLCN
NVTFLRAC EQU   NVTFLCN
NVTFLNCK EQU   NVTFLCN
NVTFLNHC EQU   NVTFLCN
NVTFLASM EQU   NVTFLCN
NVTMP    EQU   NVTFLCN
NVTFLIOC EQU   NVTFLCN
NVTFLAC  EQU   NVTFLCN
NVTFLSG  EQU   NVT+210
NVTTRACE EQU   NVT+208
NVTNXPTR EQU   NVT+204
NVTNXSIZ EQU   NVT+202
@NM00006 EQU   NVT+200
NVTSGPSA EQU   NVT+196
NVTN0MSG EQU   NVT+192
NVTVVPG1 EQU   NVT+188
NVTNBFND EQU   NVT+184
NVTNUCND EQU   NVT+180
NVTSTMAP EQU   NVT+176
NVTRTMSA EQU   NVT+172
NVTMFASA EQU   NVT+168
NVTLSPQE EQU   NVT+164
NVTALSQA EQU   NVT+160
NVTPQSAV EQU   NVT+156
NVTSVC60 EQU   NVT+148
NVTABSEC EQU   NVTABSAV+4
NVTABFST EQU   NVTABSAV
NVTNVSQA EQU   NVT+138
NVTRSVMN EQU   NVT+136
NVTNBMIN EQU   NVT+134
NVTRGNAV EQU   NVT+132
NVTLSQNO EQU   NVT+130
NVTSQANO EQU   NVT+128
NVTLSQAS EQU   NVT+124
NVTLNGFX EQU   NVT+120
NVTIGXER EQU   NVT+116
@NM00005 EQU   NVT+112
NVTASMAD EQU   NVT+108
NVTNVRSZ EQU   NVT+104
NVTMFA   EQU   NVT+100
NVTDSSNG EQU   NVT+96
NVTMSLNK EQU   NVT+92
NVTVVMDI EQU   NVT+88
NVTIGCER EQU   NVT+84
NVTVBLDL EQU   NVT+80
NVTSVCTB EQU   NVT+76
NVTASTCB EQU   NVT+72
NVTAASCB EQU   NVT+68
NVTMASCB EQU   NVT+64
NVTCMTCB EQU   NVT+60
NVTMSTCB EQU   NVT+56
@NM00004 EQU   NVTFLLB
NVTFLSLB EQU   NVTFLLB
@NM00003 EQU   NVTNPATR
NVTNPREU EQU   NVTNPREN
@NM00002 EQU   NVTNPREN
NVTNPSFX EQU   NVT+53
@NM00001 EQU   NVT+50
NVTNPSUF EQU   NVT
@NM00103 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00102 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00101 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00100 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00099 EQU   FLCFSA
@NM00098 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00097 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00096 EQU   FLCIOA
@NM00095 EQU   FLCMCLA+15
@NM00094 EQU   FLCMCLA+14
@NM00093 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00092 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00091 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00090 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00089 EQU   FLCPER
@NM00088 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00087 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00086 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00085 EQU   FLCPIILC
@NM00084 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00083 EQU   FLCSVILC
@NM00082 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00081 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00080 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RT00369 EQU   NOMSSC
@RT00373 EQU   NOMSSC
@RC00415 EQU   @RC00409
@RC00474 EQU   @RC00472
@RC00547 EQU   @RC00472
@RC00564 EQU   @RC00557
@RF00643 EQU   @RC00635
@RC00637 EQU   @RC00635
@RC00661 EQU   @RC00659
@RC00708 EQU   @RC00705
@RF00682 EQU   @RC00677
@RC00769 EQU   @RC00766
@RC01198 EQU   @RC01195
@RT01231 EQU   @RC01195
@RT01278 EQU   @RC01241
@RF01339 EQU   @RC01329
@RC01331 EQU   @RC01329
@RC01424 EQU   @RC01423
@RC01544 EQU   @RC01483
@RC01515 EQU   @RC01483
@PB00017 EQU   @EL00001
@RC00481 EQU   @RC00474
@RC00509 EQU   @RC00474
@RC00717 EQU   @RC00708
@RC00778 EQU   @RC00769
@RT01208 EQU   @RC01198
@RC01430 EQU   @RC01424
@RC01553 EQU   @RC01544
@PB00016 EQU   @PB00017
@RT00485 EQU   @RC00481
@RC00494 EQU   @RC00481
@RT00514 EQU   @RC00509
@RC00524 EQU   @RC00509
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@RC00382 EQU   @PB00002
@ENDDATA EQU   *
         END   ICBMSG05,(C'PLS1103',0701,78188)

         TITLE '**********  IDCTP04 -  AMS PAGE CONTROL MODULE  ********
               ****     '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCTP04  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00002-@MAINENT)
         DC    AL1(16)                                             0002
         DC    C'IDCTP04   76.278'                                 0002
IDCTPES  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00190-IDCTPES)
         ENTRY IDCTPES
IDCTPEA  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00198-IDCTPEA)
         ENTRY IDCTPEA
IDCTPRS  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00206-IDCTPRS)
         ENTRY IDCTPRS
IDCTPRE  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00218-IDCTPRE)
         ENTRY IDCTPRE
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @11,0                                               0002
@PSTART  LA    @12,4095(,@11)                                      0002
         USING @PSTART,@11                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0002
         USING @DATD,@10                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @15,@01,16(@13)                                     0002
         ST    @10,8(,@13)                                         0002
         LR    @13,@10                                             0002
         AH    @15,4(,@15)                                         0002
         BR    @15                                                 0002
@EP00002 MVC   @PC00001(36),0(@01)                                 0002
*                                     /*NEW BASE FOR THE GLOBAL      */
*                                      /*DATA TABLE          @YL026UE*/
*         /***********************************************************/
*         /*                                                         */
*         /*  BEGINNING OF THE CODE FOR THE PAGE CONTROL MODULE      */
*         /* THIS CODE SORTS OUT THE VARIOUS TYPES OF CALLS AND      */
*         /* TRANSFERS CONTROL TO THE PROPER PROCEDURE TO HANDLE IT. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0190
*                                                                  0190
*        /* ENTRY POINT FOR THE ESTS MACRO                   @YL026UE*/
*IDCTPES: ENTRY (GDTTBLX,FILENAME,ARG1);                   /*@YL026UE*/
*                                                                  0190
         B     @EC00190                                            0190
@EP00190 MVC   @PC00001(12),0(@01)                                 0190
@EC00190 DS    0H                                                  0191
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/
         L     GDTPTR,@PC00001                                     0191
*         CALL ESTSCONT(ARG1);                             /*@YL026UE*/
         L     @08,@PC00001+8                                      0192
         ST    @08,@AL00001                                        0192
         LA    @01,@AL00001                                        0192
         BAL   @14,ESTSCONT                                        0192
*         RESPECIFY RTNREG RSTD;                                   0193
*         TESTRC = RTNREG;                                         0194
         LR    TESTRC,RTNREG                                       0194
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/
*         SETRC = TESTRC;                                  /*@YL026UE*/
         STH   TESTRC,SETRC                                        0196
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0197
         ST    GDTPTR,@AL00001                                     0197
         LA    @08,MODID                                           0197
         ST    @08,@AL00001+4                                      0197
         LA    @08,SETRC                                           0197
         ST    @08,@AL00001+8                                      0197
         MVI   @AL00001+8,X'80'                                    0197
         L     @15,GDTEPL(,GDTPTR)                                 0197
         LA    @01,@AL00001                                        0197
         BALR  @14,@15                                             0197
*       /*@YL026UE*/                                               0198
*                                                                  0198
*        /* ENTRY POINT FOR THE ESTA MACRO                   @YL026UE*/
*IDCTPEA: ENTRY (GDTTBLX,FILENAME,ARG1);                   /*@YL026UE*/
*                                                                  0198
         B     @EC00198                                            0198
@EP00198 MVC   @PC00001(12),0(@01)                                 0198
@EC00198 DS    0H                                                  0199
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/
         L     GDTPTR,@PC00001                                     0199
*         CALL ESTACONT(ARG1);                             /*@YL026UE*/
         L     @08,@PC00001+8                                      0200
         ST    @08,@AL00001                                        0200
         LA    @01,@AL00001                                        0200
         BAL   @14,ESTACONT                                        0200
*         RESPECIFY RTNREG RSTD;                                   0201
*         TESTRC = RTNREG;                                         0202
         LR    TESTRC,RTNREG                                       0202
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/
*         SETRC = TESTRC;                                  /*@YL026UE*/
         STH   TESTRC,SETRC                                        0204
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0205
         ST    GDTPTR,@AL00001                                     0205
         LA    @08,MODID                                           0205
         ST    @08,@AL00001+4                                      0205
         LA    @08,SETRC                                           0205
         ST    @08,@AL00001+8                                      0205
         MVI   @AL00001+8,X'80'                                    0205
         L     @15,GDTEPL(,GDTPTR)                                 0205
         LA    @01,@AL00001                                        0205
         BALR  @14,@15                                             0205
*       /*@YL026UE*/                                               0206
*                                                                  0206
*        /* ENTRY POINT FOR THE REST MACRO                   @YL026UE*/
*IDCTPRS: ENTRY (GDTTBLX,FILENAME,ARG1,ARG2,ARG3,ARG4,ARG5,ARG6,ARG7);
*                                                                  0206
*                                                                  0206
         B     @EC00206                                            0206
@EP00206 MVC   @PC00001(36),0(@01)                                 0206
@EC00206 DS    0H                                                  0207
*                                                                  0207
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0207
*        GEN;                                                      0207
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0208
         LA    LISTLN,1                                            0208
@DL00208 L     @03,LISTSCAN                                        0208
         TM    LISTTEST(@03),B'10000000'                           0208
         BNZ   @DC00208                                            0208
*          LISTSCAN = LISTSCAN + 4;                                0209
         AL    @03,@CF00053                                        0209
         ST    @03,LISTSCAN                                        0209
*        END;                                                      0210
*                                                                  0210
         AL    LISTLN,@CF00233                                     0210
         C     LISTLN,@CF00780                                     0210
         BNH   @DL00208                                            0210
@DC00208 DS    0H                                                  0211
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/
         L     GDTPTR,@PC00001                                     0211
*         CALL RESTCONT;                                   /*@YL026UE*/
         BAL   @14,RESTCONT                                        0212
*         RESPECIFY RTNREG RSTD;                                   0213
*         TESTRC = RTNREG;                                         0214
         LR    TESTRC,RTNREG                                       0214
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/
*         SETRC = TESTRC;                                  /*@YL026UE*/
         STH   TESTRC,SETRC                                        0216
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0217
         ST    GDTPTR,@AL00001                                     0217
         LA    @08,MODID                                           0217
         ST    @08,@AL00001+4                                      0217
         LA    @08,SETRC                                           0217
         ST    @08,@AL00001+8                                      0217
         MVI   @AL00001+8,X'80'                                    0217
         L     @15,GDTEPL(,GDTPTR)                                 0217
         LA    @01,@AL00001                                        0217
         BALR  @14,@15                                             0217
*       /*@YL026UE*/                                               0218
*                                                                  0218
*        /* ENTRY POINT FOR THE RESET MACRO                  @YL026UE*/
*IDCTPRE: ENTRY (GDTTBLX,FILENAME,ARG1);                   /*@YL026UE*/
*                                                                  0218
*                                                                  0218
         B     @EC00218                                            0218
@EP00218 MVC   @PC00001(12),0(@01)                                 0218
@EC00218 DS    0H                                                  0219
*                                                                  0219
*        /************************************************************/
*        /*                                                          */
*        /* ULISTLN MACRO INCLUDED CODE                              */
*        /*                                                          */
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */
*        /*              TO THIS ROUTINE                             */
*        /*                                                          */
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/
*        /*               ADDRESS LIST                               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0219
*        GEN;                                                      0219
        ST    1,LISTPTR
        ST    1,LISTSCAN
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0220
         LA    LISTLN,1                                            0220
@DL00220 L     @03,LISTSCAN                                        0220
         TM    LISTTEST(@03),B'10000000'                           0220
         BNZ   @DC00220                                            0220
*          LISTSCAN = LISTSCAN + 4;                                0221
         AL    @03,@CF00053                                        0221
         ST    @03,LISTSCAN                                        0221
*        END;                                                      0222
*                                                                  0222
         AL    LISTLN,@CF00233                                     0222
         C     LISTLN,@CF00780                                     0222
         BNH   @DL00220                                            0222
@DC00220 DS    0H                                                  0223
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/
         L     GDTPTR,@PC00001                                     0223
*         IF  ARG1 ^= NULLPTR & LISTLN = 3                         0224
*           THEN                                                   0224
         L     @03,@PC00001+8                                      0224
         L     @03,ARG1(,@03)                                      0224
         LTR   @03,@03                                             0224
         BZ    @RF00224                                            0224
         C     LISTLN,@CF00176                                     0224
         BNE   @RF00224                                            0224
*             PGNOF = ON;                                  /*@YL026UE*/
         OI    PGNOF,B'01000000'                                   0225
*           ELSE                                                   0226
*             PGNOF = OFF;                                 /*@YL026UE*/
         B     @RC00224                                            0226
@RF00224 NI    PGNOF,B'10111111'                                   0226
*         CALL RESETCON(ARG1);                             /*@YL026UE*/
@RC00224 L     @08,@PC00001+8                                      0227
         ST    @08,@AL00001                                        0227
         LA    @01,@AL00001                                        0227
         BAL   @14,RESETCON                                        0227
*         RESPECIFY RTNREG RSTD;                                   0228
*         TESTRC = RTNREG;                                         0229
         LR    TESTRC,RTNREG                                       0229
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/
*         SETRC = TESTRC;                                  /*@YL026UE*/
         STH   TESTRC,SETRC                                        0231
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0232
         ST    GDTPTR,@AL00001                                     0232
         LA    @08,MODID                                           0232
         ST    @08,@AL00001+4                                      0232
         LA    @08,SETRC                                           0232
         ST    @08,@AL00001+8                                      0232
         MVI   @AL00001+8,X'80'                                    0232
         L     @15,GDTEPL(,GDTPTR)                                 0232
         LA    @01,@AL00001                                        0232
         BALR  @14,@15                                             0232
*                                                                  0233
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - ESTS HANDLER                           */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CONTROLS THE ESTABLISHMENT    */
*         /* OF THE PRINT CONTROL TABLE THRU USE OF THE (UESTS)      */
*         /* MACRO.  IT ALSO OPENS THE PRINT DATA SET.               */
*         /*                                                         */
*         /* INPUT - A STATIC TEXT IDENTIFIER (STID) IDENTIFYING     */
*         /* THE NON-DEFAULT DATA TO BE SET IN THAT TABLE.           */
*         /*                                                         */
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0233
*ESTSCONT: PROC (STIDS);                                           0233
*                                                                  0233
@EL00001 L     @13,4(,@13)                                         0233
@EF00001 L     @00,@SIZDATD                                        0233
         LR    @01,@10                                             0233
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0233
         BR    @14                                                 0233
ESTSCONT STM   @14,@12,@SA00002                                    0233
         MVC   @PC00002(4),0(@01)                                  0233
*         /***********************************************************/
*         /*                                                         */
*         /* GET THE CORE FOR THE PCT AND INITIALIZE IT.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0234
*         SAVERC = 0;                                              0234
         SLR   SAVERC,SAVERC                                       0234
*         PCTPTR = GDTTPH;                                         0235
         L     @08,GDTTPH(,GDTPTR)                                 0235
         LR    PCTPTR,@08                                          0235
*         IF GDTTPH = NULLPTR                                      0236
*           THEN                                                   0236
         LTR   @08,@08                                             0236
         BNZ   @RF00236                                            0236
*             PRIPCT = ON;                                         0237
         OI    PRIPCT,B'10000000'                                  0237
*           ELSE                                                   0238
*             PRIPCT = OFF;                                        0238
         B     @RC00236                                            0238
@RF00236 NI    PRIPCT,B'01111111'                                  0238
*         OLDERID2 = NEWERID2;                                     0239
@RC00236 L     @08,GDTTR2(,GDTPTR)                                 0239
         MVC   @TS00001(95),NEWERID2(@08)                          0239
         MVC   OLDERID2(95,@08),@TS00001                           0239
*         NEWID2 = 'TP4I';                                         0240
*                                                                  0240
         MVC   NEWID2(4,@08),@CC00795                              0240
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0241
*           THEN                                                   0241
         TM    PRIPCT,B'10000000'                                  0241
         BNZ   @RF00241                                            0241
         L     @08,PCTSPP(,PCTPTR)                                 0241
         LTR   @08,@08                                             0241
         BZ    @RF00241                                            0241
*             PCTPTR = PCTSPP;                                     0242
*                                                                  0242
         LR    PCTPTR,@08                                          0242
*         CALL INITPCT;                                            0243
*                                                                  0243
@RF00241 BAL   @14,INITPCT                                         0243
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REQUEST IS FOR A PRIMARY PRINT CONTROL TABLE,    */
*         /* THEN THE STANDARD SYSPRINT TABLE MUST BE OPENED.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0244
*         IF PRIPCT = ON                                           0244
*           THEN                                                   0244
         TM    PRIPCT,B'10000000'                                  0244
         BNO   @RF00244                                            0244
*             DO;                                                  0245
*               OPNPTR = ADDR(PROPEN);  /* SET OPNAGL ADDRESS.       */
         LA    OPNPTR,PROPEN                                       0246
*               OPNAGL = ''B;           /* SET OPEN LIST TO ZEROS.   */
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0247
*               OPNTYPSO = ON;          /* SYSTEM OUTPUT FLAG.       */
         OI    OPNTYPSO(OPNPTR),B'01000000'                        0248
*               OPNIOC = ADDR(PCTIOC);  /* IOC ADDRESS PTR.          */
         LA    @08,PCTIOC(,PCTPTR)                                 0249
         ST    @08,OPNIOC(,OPNPTR)                                 0249
*               OPNMODAC = ON;          /* ASA CARRIAGE CONTROL CHAR */
*                                                                  0250
         OI    OPNMODAC(OPNPTR),B'01000000'                        0250
*               CALL IDCIOOP0 (GDTTBL,OPNAGL);                     0251
*                                                                  0251
         ST    GDTPTR,@AL00001                                     0251
         ST    OPNPTR,@AL00001+4                                   0251
         MVI   @AL00001+4,X'80'                                    0251
         L     @15,GDTOPN(,GDTPTR)                                 0251
         LA    @01,@AL00001                                        0251
         BALR  @14,@15                                             0251
*               OLDERID2 = NEWERID2;                               0252
         L     @08,GDTTR2(,GDTPTR)                                 0252
         MVC   @TS00001(95),NEWERID2(@08)                          0252
         MVC   OLDERID2(95,@08),@TS00001                           0252
*               NEWID2 = 'TP4A';                                   0253
*                                                                  0253
         MVC   NEWID2(4,@08),@CC00798                              0253
*               /*****************************************************/
*               /*                                                   */
*               /* GET STORAGE FOR THE PRINT LINE STACK BUFFER.      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0254
*               CALL IDCSAGS0 (GDTTBL,PRBUFL,PCTBUF);              0254
         ST    GDTPTR,@AL00001                                     0254
         LA    @08,PRBUFL                                          0254
         ST    @08,@AL00001+4                                      0254
         LA    @08,PCTBUF(,PCTPTR)                                 0254
         ST    @08,@AL00001+8                                      0254
         MVI   @AL00001+8,X'80'                                    0254
         L     @15,GDTGSP(,GDTPTR)                                 0254
         LA    @01,@AL00001                                        0254
         BALR  @14,@15                                             0254
*               RESPECIFY RTNREG RSTD;                             0255
*               TESTRC = RTNREG;                                   0256
         LR    TESTRC,RTNREG                                       0256
*               RESPECIFY RTNREG UNRSTD;                           0257
*               IF TESTRC ^= 0                                     0258
*                 THEN                                             0258
*                                                                  0258
         LTR   TESTRC,TESTRC                                       0258
         BZ    @RF00258                                            0258
*                   DO;                                            0259
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0260
*                     REG15 = 28;                                  0261
         LA    REG15,28                                            0261
*                     REG14 = GDTABT;                              0262
         L     REG14,GDTABT(,GDTPTR)                               0262
*                     REG13 = GDTABH;                              0263
         L     REG13,GDTABH(,GDTPTR)                               0263
*                     GEN(BR    REG14);                            0264
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0265
*                   END;                                           0266
*               PCTBNL = PCTBUF;                                   0267
@RF00258 L     @08,PCTBUF(,PCTPTR)                                 0267
         ST    @08,PCTBNL(,PCTPTR)                                 0267
*            END;                                                  0268
*                                                                  0268
*         /***********************************************************/
*         /*                                                         */
*         /* GET THE STATIC TEXT ENTRY FOR THE REQUEST.              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0269
*         CALL IDCTP05(GDTTBL,STIDS,SUBPZ,PCAADDR);        /*@YL026UE*/
*                                                                  0269
@RF00244 ST    GDTPTR,@AL00001                                     0269
         L     @08,@PC00002                                        0269
         ST    @08,@AL00001+4                                      0269
         LA    @08,SUBPZ                                           0269
         ST    @08,@AL00001+8                                      0269
         LA    @08,PCAADDR                                         0269
         ST    @08,@AL00001+12                                     0269
         L     @15,@CV00747                                        0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*         RESPECIFY RTNREG RSTD;                                   0270
*         TESTRC = RTNREG;                                         0271
         LR    TESTRC,RTNREG                                       0271
*         RESPECIFY RTNREG UNRSTD;                                 0272
*         IF TESTRC ^= 0                                           0273
*           THEN                                                   0273
         LTR   TESTRC,TESTRC                                       0273
         BZ    @RF00273                                            0273
*             RETURN CODE(TESTRC);                                 0274
         LR    @15,TESTRC                                          0274
         L     @14,@SA00002                                        0274
         LM    @00,@12,@SA00002+8                                  0274
         BR    @14                                                 0274
*         /***********************************************************/
*         /*                                                         */
*         /*  SET UP THE ADDRESSES FROM THE OFFSETS.                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0275
*         IF PCMTLP ^= NULLPTR                                     0275
*           THEN                                                   0275
@RF00273 L     @08,PCAADDR                                         0275
         L     @06,PCMTLP(,@08)                                    0275
         LTR   @06,@06                                             0275
         BZ    @RF00275                                            0275
*             PCMTLP = PCMTLP + PCAADDR;                           0276
         ALR   @06,@08                                             0276
         ST    @06,PCMTLP(,@08)                                    0276
*         IF PCSTLP ^= NULLPTR                                     0277
*           THEN                                                   0277
@RF00275 L     @08,PCAADDR                                         0277
         L     @06,PCSTLP(,@08)                                    0277
         LTR   @06,@06                                             0277
         BZ    @RF00277                                            0277
*             PCSTLP = PCSTLP + PCAADDR;                           0278
         ALR   @06,@08                                             0278
         ST    @06,PCSTLP(,@08)                                    0278
*         IF PCFLP ^= NULLPTR                                      0279
*           THEN                                                   0279
@RF00277 L     @08,PCAADDR                                         0279
         L     @06,PCFLP(,@08)                                     0279
         LTR   @06,@06                                             0279
         BZ    @RF00279                                            0279
*             PCFLP = PCFLP + PCAADDR;                             0280
         ALR   @06,@08                                             0280
         ST    @06,PCFLP(,@08)                                     0280
*         IF PCPCP ^= NULLPTR                                      0281
*           THEN                                                   0281
@RF00279 L     @08,PCAADDR                                         0281
         L     @06,PCPCP(,@08)                                     0281
         LTR   @06,@06                                             0281
         BZ    @RF00281                                            0281
*             PCPCP = PCPCP + PCAADDR;                             0282
*                                                                  0282
         ALR   @06,@08                                             0282
         ST    @06,PCPCP(,@08)                                     0282
*         /***********************************************************/
*         /*                                                         */
*         /*  THE INPUT PARAMETER LIST IS SET UP.  CALL THE PROCEDURE*/
*         /*  TO INITIALIZE THE PARAMETERS.                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0283
*         CALL P04SETUP;                                           0283
*                                                                  0283
@RF00281 BAL   @14,P04SETUP                                        0283
*         /***********************************************************/
*         /*                                                         */
*         /* CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0284
*         CALL PCTSETUP;                                           0284
*                                                                  0284
         BAL   @14,PCTSETUP                                        0284
*         RESPECIFY RTNREG RSTD;                                   0285
*         TESTRC = RTNREG;                                         0286
         LR    TESTRC,RTNREG                                       0286
*         RESPECIFY RTNREG UNRSTD;                                 0287
*         SAVERC = TESTRC;                                         0288
*                                                                  0288
         LR    SAVERC,TESTRC                                       0288
*         IF GDTDBG = NULLPTR                                      0289
*           THEN;                                                  0289
         L     @08,GDTDBG(,GDTPTR)                                 0289
         LTR   @08,@08                                             0289
         BZ    @RT00289                                            0289
*           ELSE                                                   0291
*             CALL IDCDB010  (GDTTBL,'TP4S');                      0291
*                                                                  0291
         ST    GDTPTR,@AL00001                                     0291
         LA    @08,@CC00802                                        0291
         ST    @08,@AL00001+4                                      0291
         MVI   @AL00001+4,X'80'                                    0291
         L     @15,GDTDBG(,GDTPTR)                                 0291
         LA    @01,@AL00001                                        0291
         BALR  @14,@15                                             0291
*         CALL IDCSAFS0 (GDTTBL,PCAADDR);/*                        0292
*                                          FREE STATIC TEXT CORE.    */
*                                                                  0292
@RT00289 ST    GDTPTR,@AL00001                                     0292
         LA    @08,PCAADDR                                         0292
         ST    @08,@AL00001+4                                      0292
         L     @15,GDTFSP(,GDTPTR)                                 0292
         LA    @01,@AL00001                                        0292
         BALR  @14,@15                                             0292
*         RETURN CODE(SAVERC);                                     0293
         LR    @15,SAVERC                                          0293
         L     @14,@SA00002                                        0293
         LM    @00,@12,@SA00002+8                                  0293
         BR    @14                                                 0293
*         END ESTSCONT;                                            0294
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - ESTA HANDLER.                          */
*         /*                                                         */
*         /* FUNCTION - ESTABLISHES A PRINT CONTROL TABLE FROM THE   */
*         /* ARGUMENTS PASSED WITH THE CALL.  STATIC TEXT IS NOT     */
*         /* REFERENCED IN THIS TYPE OF CALL.                        */
*         /*                                                         */
*         /* INPUT - THE ARGUMENT LIST DEFINED BY PCALIST IN THIS    */
*         /* PROCEDURE.                                              */
*         /*                                                         */
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0295
*ESTACONT: PROC (PCALIST);                                         0295
*                                                                  0295
ESTACONT STM   @14,@12,@SA00003                                    0295
         MVC   @PC00003(4),0(@01)                                  0295
*         SAVERC = 0;                                              0296
         SLR   SAVERC,SAVERC                                       0296
*         PCTPTR = GDTTPH;                                         0297
*                                                                  0297
         L     @08,GDTTPH(,GDTPTR)                                 0297
         LR    PCTPTR,@08                                          0297
*         PCAADDR = ADDR(PCALIST);     /* SET STRUCTURE ADDRESS      */
*                                                                  0298
         L     @06,@PC00003                                        0298
         ST    @06,PCAADDR                                         0298
*         /***********************************************************/
*         /*                                                         */
*         /* GET AND INITIALIZE THE PRINT CONTROL TABLE AREA.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0299
*         IF GDTTPH = NULLPTR                                      0299
*           THEN                                                   0299
         LTR   @08,@08                                             0299
         BNZ   @RF00299                                            0299
*             PRIPCT = ON;              /* PRIMARY CONTROL TABLE ON. */
         OI    PRIPCT,B'10000000'                                  0300
*           ELSE                                                   0301
*             PRIPCT = OFF;             /* PRIMARY CONTROL TABLE OFF */
         B     @RC00299                                            0301
@RF00299 NI    PRIPCT,B'01111111'                                  0301
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0302
*           THEN                                                   0302
@RC00299 TM    PRIPCT,B'10000000'                                  0302
         BNZ   @RF00302                                            0302
         L     @08,PCTSPP(,PCTPTR)                                 0302
         LTR   @08,@08                                             0302
         BZ    @RF00302                                            0302
*             PCTPTR = PCTSPP;                                     0303
*                                                                  0303
         LR    PCTPTR,@08                                          0303
*         CALL INITPCT;                /* GET CORE FOR THE PCT.     */
*                                                                  0304
@RF00302 BAL   @14,INITPCT                                         0304
*         /***********************************************************/
*         /*                                                         */
*         /*  CALL THE PROCEDURE TO INITIALIZE THE PARAMETERS.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0305
*         CALL P04SETUP;                                           0305
*                                                                  0305
         BAL   @14,P04SETUP                                        0305
*         /***********************************************************/
*         /*                                                         */
*         /*  CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0306
*         CALL PCTSETUP;                                           0306
*                                                                  0306
         BAL   @14,PCTSETUP                                        0306
*         RESPECIFY RTNREG RSTD;                                   0307
*         TESTRC = RTNREG;                                         0308
         LR    TESTRC,RTNREG                                       0308
*         RESPECIFY RTNREG UNRSTD;                                 0309
*         SAVERC = TESTRC;                                         0310
*                                                                  0310
         LR    SAVERC,TESTRC                                       0310
*         IF GDTDBG = NULLPTR                                      0311
*           THEN;                                                  0311
         L     @08,GDTDBG(,GDTPTR)                                 0311
         LTR   @08,@08                                             0311
         BZ    @RT00311                                            0311
*           ELSE                                                   0313
*             CALL IDCDB010  (GDTTBL,'TP4A');                      0313
*                                                                  0313
         ST    GDTPTR,@AL00001                                     0313
         LA    @08,@CC00798                                        0313
         ST    @08,@AL00001+4                                      0313
         MVI   @AL00001+4,X'80'                                    0313
         L     @15,GDTDBG(,GDTPTR)                                 0313
         LA    @01,@AL00001                                        0313
         BALR  @14,@15                                             0313
*         RETURN CODE(SAVERC);                                     0314
@RT00311 LR    @15,SAVERC                                          0314
         L     @14,@SA00003                                        0314
         LM    @00,@12,@SA00003+8                                  0314
         BR    @14                                                 0314
*         END ESTACONT;                                            0315
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PRINT WORK TABLE INITIALIZATION.       */
*         /*                                                         */
*         /* FUNCTION - INITIALIZES MOST OF THE DEFAULT VALUES IN    */
*         /* IN THE PRINT WORK TABLE.                                */
*         /* THIS PROCEDURE IS CALLED FROM THE TP04A & TP04B         */
*         /* PROCEDURES AND MOVES THE INPUT ARGUMENTS INTO THE       */
*         /* COMMON WORK TABLE SO THEY CAN BE MORE EFFICIENTLY       */
*         /* HANDLED.                                                */
*         /*                                                         */
*         /* INPUT - NONE.                                           */
*         /*                                                         */
*         /* OUTPUT - A PARTIALLY INITIALIZED PRINT WORK TABLE.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0316
*P04SETUP: PROC;                                                   0316
*                                                                  0316
P04SETUP STM   @14,@12,12(@13)                                     0316
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE WORKING PARAMETER TABLE.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0317
*         P04WT = ''B;                                             0317
         XC    P04WT(42),P04WT                                     0317
*         P04MTP = PCMTLP;              /* SET MAIN TITLE LINE PTR   */
         L     @08,PCAADDR                                         0318
         L     @03,PCMTLP(,@08)                                    0318
         ST    @03,P04MTP                                          0318
*         P04MTC = PCMTLC;              /* SET MAIN TITLE LINE COUNT */
         LH    @03,PCMTLC(,@08)                                    0319
         STH   @03,P04MTC                                          0319
*         P04STP = PCSTLP;              /* SET SUB-TITLE LINE PTR    */
         L     @03,PCSTLP(,@08)                                    0320
         ST    @03,P04STP                                          0320
*         P04STC = PCSTLC;              /* SET SUB-TITLE LINE COUNT  */
         LH    @03,PCSTLC(,@08)                                    0321
         STH   @03,P04STC                                          0321
*         P04FP = PCFLP;                /* SET FOOTING LINE PTR      */
         L     @03,PCFLP(,@08)                                     0322
         ST    @03,P04FP                                           0322
*         P04FC = PCFLC;                /* SET FOOTING LINE COUNT    */
         LH    @03,PCFLC(,@08)                                     0323
         STH   @03,P04FC                                           0323
*         P04PCP = PCPCP;               /* SET CHAIN POINTER.        */
         L     @03,PCPCP(,@08)                                     0324
         ST    @03,P04PCP                                          0324
*         P04PNL = PCPNL;               /* SET PAGE NUMBER LOCATION  */
         LH    @03,PCPNL(,@08)                                     0325
         STH   @03,P04PNL                                          0325
*         P04TL = PCPTL;                /* SET TIME LOCATION         */
         LH    @03,PCPTL(,@08)                                     0326
         STH   @03,P04TL                                           0326
*         P04DL = PCPDL;                /* SET DATE LOCATION         */
         LH    @03,PCPDL(,@08)                                     0327
         STH   @03,P04DL                                           0327
*         P04LW = PCLW;                 /* SET THE LINE WIDTH.       */
         LH    @03,PCLW(,@08)                                      0328
         STH   @03,P04LW                                           0328
*         P04PD = PCPD;                 /* SET PAGE DEPTH            */
         LH    @03,PCPD(,@08)                                      0329
         STH   @03,P04PD                                           0329
*         P04DSC = PCDSC;               /* SET DEFAULT SPACE CHAR    */
         SLR   @03,@03                                             0330
         IC    @03,PCDSC(,@08)                                     0330
         STH   @03,P04DSC                                          0330
*         END P04SETUP;                                            0331
@EL00004 DS    0H                                                  0331
@EF00004 DS    0H                                                  0331
@ER00004 LM    @14,@12,12(@13)                                     0331
         BR    @14                                                 0331
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - REST HANDLER.                          */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CONTROL THE SETTING UP OF     */
*         /* PARAMETERS IN THE PRINT CONTROL TABLE PASSED BY THE     */
*         /* UREST MACRO.                                            */
*         /*                                                         */
*         /* INPUT - THE ARGUMENT LIST DEFINED BY THE PCR STRUCTURE  */
*         /* IN THIS PROCEDURE.                                      */
*         /*                                                         */
*         /* OUTPUT - A MODIFIED EXISTING PRINT CONTROL TABLE.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0332
*RESTCONT: PROC;                                                   0332
*                                                                  0332
RESTCONT STM   @14,@12,@SA00005                                    0332
*         IF GDTTPH = NULLPTR                                      0333
*           THEN                                                   0333
*                                                                  0333
         L     @03,GDTTPH(,GDTPTR)                                 0333
         LTR   @03,@03                                             0333
         BNZ   @RF00333                                            0333
*             DO;                                                  0334
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0335
*               REG15 = 24;                                        0336
         LA    REG15,24                                            0336
*               REG14 = GDTABT;                                    0337
         L     REG14,GDTABT(,GDTPTR)                               0337
*               REG13 = GDTABH;                                    0338
         L     REG13,GDTABH(,GDTPTR)                               0338
*               GEN(BR    REG14);                                  0339
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0340
*             END;                                                 0341
*         PRIPCT = OFF;                                            0342
@RF00333 NI    PRIPCT,B'01111111'                                  0342
*         SAVERC = 0;                                      /*@YL026UE*/
*                                                                  0343
         SLR   SAVERC,SAVERC                                       0343
*         PCTPTR = GDTTPH;                                         0344
         L     PCTPTR,GDTTPH(,GDTPTR)                              0344
*         IF PCTSPP ^= NULLPTR                                     0345
*           THEN                                                   0345
         L     @06,PCTSPP(,PCTPTR)                                 0345
         LTR   @06,@06                                             0345
         BZ    @RF00345                                            0345
*             PCTPTR = PCTSPP;                                     0346
*                                                                  0346
         LR    PCTPTR,@06                                          0346
*         /***********************************************************/
*         /*                                                         */
*         /* FLUSH THE STACK BUFFER BEFORE MAKING ANY CHANGES.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0347
*         CALL STACKFL;                                            0347
*                                                                  0347
@RF00345 BAL   @14,STACKFL                                         0347
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING ARE DECLARES USED EXCLUSIVELY IN THIS     */
*         /* PROCEDURE.  THE FIRST IS THE TABLE USED IN GETTING THE  */
*         /* TRANSLATE TABLE REQUIRED BY VARIOUS PRINT CHAINS.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0348
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING IS A THREE BYTE WIDE TABLE OF THE VARIOUS */
*         /* STANDARD PRINT CHAINS.  THE FIRST TWO BYTES OF EACH     */
*         /* ENTRY CONTAIN THE PRINT CHAIN ID, THE THIRD BYTE        */
*         /* CONTAINS THE STATIC TEXT ENTRY NUMBER IN THE MODULE     */
*         /* IDCTSTP0 THAT CONTAINS THE TRANSLATE TABLE FOR THAT     */
*         /* TYPE OF CHAIN.                                          */
*         /*                                                         */
*         /***********************************************************/
*         DCL PCTAB (7) CHAR (3) INIT                              0348
*           ('C1D501'X,                 /* AN CHAIN.                 */
*            'C8D506'X,                 /* HN CHAIN.                 */
*            'D7D502'X,                 /* PN CHAIN.                 */
*            'D8D503'X,                 /* QN CHAIN.                 */
*            'D9D507'X,                 /* RN CHAIN.                 */
*            'E2D504'X,                 /* SN CHAIN.                 */
*            'E3D505'X);                /* TN CHAIN.                 */
*                                                                  0348
*         DCL RESTARG(7) PTR(31);                                  0349
*                                                                  0350
*         /***********************************************************/
*         /*                                                         */
*         /* RUNNING CODE BEGINS HERE.                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0350
*         P04WT = ''B;                  /* CLEAR THE WORK TABLE. */
         XC    P04WT(42),P04WT                                     0350
*         RESTARG(1)=ADDR(ARG1);                                   0351
         L     @06,@PC00001+8                                      0351
         ST    @06,RESTARG                                         0351
*         RESTARG(2)=ADDR(ARG2);                                   0352
         L     @06,@PC00001+12                                     0352
         ST    @06,RESTARG+4                                       0352
*         RESTARG(3)=ADDR(ARG3);                                   0353
         L     @06,@PC00001+16                                     0353
         ST    @06,RESTARG+8                                       0353
*         RESTARG(4)=ADDR(ARG4);                                   0354
         L     @06,@PC00001+20                                     0354
         ST    @06,RESTARG+12                                      0354
*         RESTARG(5)=ADDR(ARG5);                                   0355
         L     @06,@PC00001+24                                     0355
         ST    @06,RESTARG+16                                      0355
*         RESTARG(6)=ADDR(ARG6);                                   0356
         L     @06,@PC00001+28                                     0356
         ST    @06,RESTARG+20                                      0356
*         RESTARG(7)=ADDR(ARG7);                                   0357
         L     @06,@PC00001+32                                     0357
         ST    @06,RESTARG+24                                      0357
*         DO ARGNMB = 1 TO (LISTLN - 2) BY 1;                      0358
         LA    @06,1                                               0358
         STH   @06,ARGNMB                                          0358
         B     @DE00358                                            0358
@DL00358 DS    0H                                                  0359
*                                       /* LOOP THROUGH THE ARGS.    */
*           PCRADDR = RESTARG(ARGNMB);  /* SET PARM ADDRESS          */
*                                                                  0359
         LH    @04,ARGNMB                                          0359
         SLA   @04,2                                               0359
         L     PCRADDR,RESTARG-4(@04)                              0359
*           /*********************************************************/
*           /*                                                       */
*           /* IF SUB_TITLE ARGUMENT ENTERED, INITIALIZE THEM.       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0360
*           IF PCRTYP = 'ST'            /* TEST FOR SUB-TITLE LINE   */
*             THEN                                                 0360
         CLC   PCRTYP(2,PCRADDR),@CC00825                          0360
         BNE   @RF00360                                            0360
*               DO;                                                0361
*                 IF PCRPTR = NULLPTR                              0362
*                   THEN                                           0362
         L     @04,PCRPTR(,PCRADDR)                                0362
         LTR   @04,@04                                             0362
         BNZ   @RF00362                                            0362
*                     P04STC = -1;      /* SET TO CLEAR EXISTING.    */
         MVC   P04STC(2),@CH00826                                  0363
*                   ELSE                                           0364
*                     DO;               /* SET NEW SUB-TITLE PTR.    */
         B     @RC00362                                            0364
@RF00362 DS    0H                                                  0365
*                       P04STP = PCRPTR;                           0365
         L     @04,PCRPTR(,PCRADDR)                                0365
         ST    @04,P04STP                                          0365
*                       P04STC = PCRLC;                            0366
         LH    @04,PCRLC(,PCRADDR)                                 0366
         STH   @04,P04STC                                          0366
*                     END;                                         0367
*               END;                                               0368
*                                                                  0368
@RC00362 DS    0H                                                  0369
*           /*********************************************************/
*           /*                                                       */
*           /* IF FOOTING LINE ARGUMENT ENTERED INITIALIZE THEM.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0369
*           IF PCRTYP = 'FT'            /* CHECK FOR FOOTING LINE    */
*             THEN                                                 0369
@RF00360 CLC   PCRTYP(2,PCRADDR),@CC00827                          0369
         BNE   @RF00369                                            0369
*               DO;                                                0370
*                 IF PCRPTR = NULLPTR                              0371
*                   THEN                                           0371
         L     @04,PCRPTR(,PCRADDR)                                0371
         LTR   @04,@04                                             0371
         BNZ   @RF00371                                            0371
*                     P04FC = -1;       /* SET TO CLEAR EXISTING.    */
         MVC   P04FC(2),@CH00826                                   0372
*                   ELSE                                           0373
*                     DO;               /* SET NEW FOOTING PTR.      */
         B     @RC00371                                            0373
@RF00371 DS    0H                                                  0374
*                       P04FP = PCRPTR;                            0374
         L     @04,PCRPTR(,PCRADDR)                                0374
         ST    @04,P04FP                                           0374
*                       P04FC = PCRLC;                             0375
         LH    @04,PCRLC(,PCRADDR)                                 0375
         STH   @04,P04FC                                           0375
*                     END;                                         0376
*               END;                                               0377
*                                                                  0377
@RC00371 DS    0H                                                  0378
*           /*********************************************************/
*           /*                                                       */
*           /* IF LINE WIDTH ARGUMENTS ENTERED, INITIALIZE THEM      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0378
*           IF PCRTYP = 'LW'            /* TEST FOR NEW LINE WIDTH   */
*             THEN                                                 0378
@RF00369 CLC   PCRTYP(2,PCRADDR),@CC00828                          0378
         BNE   @RF00378                                            0378
*               DO;                                                0379
*                 P04LW = PCRLC;        /* SET NEW LINE WIDTH        */
         LH    @04,PCRLC(,PCRADDR)                                 0380
         STH   @04,P04LW                                           0380
*                 IF PCRLC = 0                                     0381
*                   THEN                                           0381
         LTR   @04,@04                                             0381
         BNZ   @RF00381                                            0381
*                     P04LW = STDLW;    /* SET TO RESTORE DEFAULT.   */
         L     @04,STDLW                                           0382
         STH   @04,P04LW                                           0382
*               END;                                               0383
*                                                                  0383
@RF00381 DS    0H                                                  0384
*           /*********************************************************/
*           /*                                                       */
*           /* IF PAGE DEPTH ARGUMENTS ENTERED, INITIALIZE THEM.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0384
*           IF PCRTYP = 'PD'            /* TEST FOR NEW PAGE DEPTH   */
*             THEN                                                 0384
@RF00378 CLC   PCRTYP(2,PCRADDR),@CC00829                          0384
         BNE   @RF00384                                            0384
*               DO;                                                0385
*                 P04PD = PCRLC;        /* SET NEW PAGE DEPTH        */
         LH    @04,PCRLC(,PCRADDR)                                 0386
         STH   @04,P04PD                                           0386
*                 IF PCRLC = 0                                     0387
*                   THEN                                           0387
         LTR   @04,@04                                             0387
         BNZ   @RF00387                                            0387
*                     P04PD = STDPD;    /* SET TO RESTORE DEFAULT.   */
         MVC   P04PD(2),@CH00725                                   0388
*               END;                                               0389
*                                                                  0389
@RF00387 DS    0H                                                  0390
*           /*********************************************************/
*           /*                                                       */
*           /* IF DEFAULT SPACE CHARACTER ENTERED, INITIALIZE IT.    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0390
*           IF PCRTYP = 'SC'            /* TEST FOR NEW DEFAULT SPACE*/
*             THEN                                                 0390
@RF00384 CLC   PCRTYP(2,PCRADDR),@CC00830                          0390
         BNE   @RF00390                                            0390
*               DO;                                                0391
*                 P04DSC = PCRLC;       /* SET NEW DSC               */
         LH    @04,PCRLC(,PCRADDR)                                 0392
         STH   @04,P04DSC                                          0392
*                 IF PCRLC = 0                                     0393
*                   THEN                                           0393
         LTR   @04,@04                                             0393
         BNZ   @RF00393                                            0393
*                     P04DSC = 1;       /* SET TO RESTORE DEFAULT.   */
         MVC   P04DSC(2),@CH00233                                  0394
*               END;                                               0395
*                                                                  0395
@RF00393 DS    0H                                                  0396
*           /*********************************************************/
*           /*                                                       */
*           /* IF PRINT CHAIN ARGUMENTS ENTERED, INITIALIZE IT.      */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0396
*         IF PCRTYP = 'PC'              /* TEST FOR PRINT CHAIN */ 0396
*           THEN                                                   0396
@RF00390 CLC   PCRTYP(2,PCRADDR),@CC00831                          0396
         BNE   @RF00396                                            0396
*             DO;                                                  0397
*               IF PCRLC ^= 0                                      0398
*                 THEN                                             0398
*                                                                  0398
         LH    @04,PCRLC(,PCRADDR)                                 0398
         LTR   @04,@04                                             0398
         BZ    @RF00398                                            0398
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF PCRLC IS NON-ZERO, A STANDARD PRINT CHAIN    */
*                 /* ID HAS BEEN FURNISHED.                          */
*                 /* SEARCH THE TABLE FOR THE PRINT CHAIN ENTERED.   */
*                 /* CHAIN ENTERED.                                  */
*                 /* IF A MATCH IS FOUND, GO TO IDCTP05 TO GET IT.   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0399
*                   DO;                                            0399
*                     STID(1:3) = 'TP0';                           0400
         MVC   STID(3),@CC00832                                    0400
*                                       /* SET UP THE STID FOR CHAIN */
*                     DO N = 1 TO 7 BY 1;                          0401
         LA    N,1                                                 0401
@DL00401 DS    0H                                                  0402
*                       IF PCTAB(N,1:2) = PCRLCC                   0402
*                         THEN                                     0402
         LR    @04,N                                               0402
         MH    @04,@CH00176                                        0402
         LA    @01,PCTAB-3(@04)                                    0402
         CLC   0(2,@01),PCRLCC(PCRADDR)                            0402
         BNE   @RF00402                                            0402
*                           STID(4) = PCTAB(N,3);                  0403
         LA    @01,PCTAB-1(@04)                                    0403
         MVC   STID+3(1),0(@01)                                    0403
*                                       /* SET THE ENTRY NUMBER.     */
*                     END;                                         0404
@RF00402 AL    N,@CF00233                                          0404
         C     N,@CF00816                                          0404
         BNH   @DL00401                                            0404
*                     IF STID(4) ^= 0                              0405
*                       THEN                                       0405
         CLI   STID+3,0                                            0405
         BE    @RF00405                                            0405
*                         DO;                                      0406
*                                                                  0406
*                           CALL IDCTP05(GDTTBL,STID,SUBPZ,P04PCP);
*                                                                  0407
         ST    GDTPTR,@AL00001                                     0407
         LA    @04,STID                                            0407
         ST    @04,@AL00001+4                                      0407
         LA    @04,SUBPZ                                           0407
         ST    @04,@AL00001+8                                      0407
         LA    @04,P04PCP                                          0407
         ST    @04,@AL00001+12                                     0407
         L     @15,@CV00747                                        0407
         LA    @01,@AL00001                                        0407
         BALR  @14,@15                                             0407
*                           RESPECIFY RTNREG RSTD;                 0408
*                           TESTRC = RTNREG;                       0409
         LR    TESTRC,RTNREG                                       0409
*                           RESPECIFY RTNREG UNRSTD;               0410
*                           SAVERC = TESTRC;                       0411
         LR    SAVERC,TESTRC                                       0411
*                         END;                                     0412
*                   END;                                           0413
*                                                                  0413
@RF00405 DS    0H                                                  0414
*               /*****************************************************/
*               /*                                                   */
*               /* IF PCRPTR IS NON-ZERO, A LOADMODULE NAME WAS      */
*               /* GIVEN SO LOAD THE MODULE AND SET THE POINTER TO   */
*               /* THE ENTRY POINT OF THE LOAD MODULE AS THE START   */
*               /* OF THE TRANSLATE TABLE.                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0414
*               IF PCRPTR ^= NULLPTR                               0414
*                 THEN                                             0414
@RF00398 L     @04,PCRPTR(,PCRADDR)                                0414
         LTR   @04,@04                                             0414
         BZ    @RF00414                                            0414
*                   DO;                                            0415
*                                                                  0415
*                     CALL IDCSALD0 (GDTTBL,TTDSN,P04PCP);         0416
*                                                                  0416
         ST    GDTPTR,@AL00001                                     0416
         ST    @04,@AL00001+4                                      0416
         LA    @04,P04PCP                                          0416
         ST    @04,@AL00001+8                                      0416
         L     @15,GDTLOD(,GDTPTR)                                 0416
         LA    @01,@AL00001                                        0416
         BALR  @14,@15                                             0416
*                   END;                                           0417
*             END;                                                 0418
*                                                                  0418
@RF00414 DS    0H                                                  0419
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR A NEW PAGE NUMBER ENTERED                    */
*           /* CONVERT TO BINARY AND ENTER IN TABLE.                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0419
*           IF PCRTYP = 'PN' & PGNOLIN > 0 & PGNOLIN <= 4    /*YM5742*/
*             THEN                                                 0419
@RF00396 CLC   PCRTYP(2,PCRADDR),@CC00833                          0419
         BNE   @RF00419                                            0419
         L     @04,PCRPTR(,PCRADDR)                                0419
         LH    @03,PGNOLIN(,@04)                                   0419
         LTR   @03,@03                                             0419
         BNP   @RF00419                                            0419
         LA    @15,4                                               0419
         CR    @03,@15                                             0419
         BH    @RF00419                                            0419
*               DO;                                                0420
*                 PAGE = ''B;                                      0421
         XC    PAGE(4),PAGE                                        0421
*                 PAGE((5-PGNOLIN):4) = PGNOCIN(1:PGNOLIN);        0422
         LCR   @03,@03                                             0422
         AL    @03,@CF00300                                        0422
         LA    @01,PAGE-1(@03)                                     0422
         SLR   @15,@03                                             0422
         EX    @15,@SM00866                                        0422
*GEN     (PACK  PACKWD,PAGE);                                      0423
         PACK  PACKWD,PAGE
*GEN     (CVB   CVDREG,PACKWD);                                    0424
         CVB   CVDREG,PACKWD
*                 P04CPN = CVDREG - 1;                             0425
         LR    @06,CVDREG                                          0425
         BCTR  @06,0                                               0425
         STH   @06,P04CPN                                          0425
*               END;                                               0426
*         END;                                                     0427
@RF00419 LA    @06,1                                               0427
         AH    @06,ARGNMB                                          0427
         STH   @06,ARGNMB                                          0427
@DE00358 LR    @04,LISTLN                                          0427
         BCTR  @04,0                                               0427
         BCTR  @04,0                                               0427
         CR    @06,@04                                             0427
         BNH   @DL00358                                            0427
*         /***********************************************************/
*         /*                                                         */
*         /*  CALL THE PROCEDURE TO SET THE PCT                      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0428
*         CALL PCTSETUP;                                           0428
*                                                                  0428
         BAL   @14,PCTSETUP                                        0428
*         IF GDTDBG = NULLPTR                                      0429
*           THEN;                                                  0429
         L     @08,GDTDBG(,GDTPTR)                                 0429
         LTR   @08,@08                                             0429
         BZ    @RT00429                                            0429
*           ELSE                                                   0431
*             CALL IDCDB010 (GDTTBL,'TP4R');                       0431
*                                                                  0431
         ST    GDTPTR,@AL00001                                     0431
         LA    @08,@CC00834                                        0431
         ST    @08,@AL00001+4                                      0431
         MVI   @AL00001+4,X'80'                                    0431
         L     @15,GDTDBG(,GDTPTR)                                 0431
         LA    @01,@AL00001                                        0431
         BALR  @14,@15                                             0431
*         RETURN CODE(SAVERC);                                     0432
@RT00429 LR    @15,SAVERC                                          0432
         L     @14,@SA00005                                        0432
         LM    @00,@12,@SA00005+8                                  0432
         BR    @14                                                 0432
*         END RESTCONT;                                            0433
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PCT SETTING PROCEDURE.                 */
*         /*                                                         */
*         /* FUNCTION - THIS PROCEDURE CHECKS AND SETS VALUES        */
*         /* ENTERED AND SET INTO THE PRINT CONTROL WORK TABLE INTO  */
*         /* THE PRINT CONTROL TABLE.                                */
*         /*                                                         */
*         /* INPUT - THE PRINT CONTROL WORK TABLE (P04WT).           */
*         /*                                                         */
*         /* OUTPUT - THE PRINT CONTROL TABLE.                       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0434
*PCTSETUP: PROC;                                                   0434
*                                                                  0434
PCTSETUP STM   @14,@06,@SA00006                                    0434
         STM   @08,@12,@SA00006+36                                 0434
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR PRIMARY CONTROL TABLE BUILD AND IF TRUE, BUILD */
*         /* TABLE WITH ALL THE DEFAULTS.                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0435
*         PCTNLI = 999;                 /* FORCE A PAGE OVERFLOW.    */
         LA    @08,999                                             0435
         STH   @08,PCTNLI(,PCTPTR)                                 0435
*         PCTANL = 999;                 /* FOR ALTERNATE FILE ALSO.  */
         STH   @08,PCTANL(,PCTPTR)                                 0436
*         IF PRIPCT = ON                                           0437
*           THEN                                                   0437
         TM    PRIPCT,B'10000000'                                  0437
         BNO   @RF00437                                            0437
*             DO;                                                  0438
*               /*****************************************************/
*               /*                                                   */
*               /* GET THE STANDARD PRINT CHAIN TRANSLATE            */
*               /* TABLE.                                            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0439
*               STID(1:3) = 'TP0';                                 0439
         MVC   STID(3),@CC00832                                    0439
*               STID(4) = '02'X;                                   0440
*                                                                  0440
         MVI   STID+3,X'02'                                        0440
*               CALL IDCTP05(GDTTBL,STID,SUBPZ,PCTTRP);    /*@YL026UE*/
*                                                                  0441
         ST    GDTPTR,@AL00001                                     0441
         LA    @08,STID                                            0441
         ST    @08,@AL00001+4                                      0441
         LA    @08,SUBPZ                                           0441
         ST    @08,@AL00001+8                                      0441
         LA    @08,PCTTRP(,PCTPTR)                                 0441
         ST    @08,@AL00001+12                                     0441
         L     @15,@CV00747                                        0441
         LA    @01,@AL00001                                        0441
         BALR  @14,@15                                             0441
*               RESPECIFY RTNREG RSTD;                             0442
*               TESTRC = RTNREG;                                   0443
         LR    TESTRC,RTNREG                                       0443
*               RESPECIFY RTNREG UNRSTD;                           0444
*               IF TESTRC ^= 0                                     0445
*                 THEN                                             0445
*                                                                  0445
         LTR   TESTRC,TESTRC                                       0445
         BZ    @RF00445                                            0445
*                   DO;                                            0446
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0447
*                     REG15 = 28;                                  0448
         LA    REG15,28                                            0448
*                     REG14 = GDTABT;                              0449
         L     REG14,GDTABT(,GDTPTR)                               0449
*                     REG13 = GDTABH;                              0450
         L     REG13,GDTABH(,GDTPTR)                               0450
*                     GEN(BR    REG14);                            0451
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0452
*                   END;                                           0453
*                                                                  0453
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE FIRST DATA LINE AND LAST DATA LINE.    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0454
*               PCTPNI = 1;                                        0454
@RF00445 MVC   PCTPNI(2,PCTPTR),@CH00233                           0454
*               PCTFDL = 4;                                        0455
         MVC   PCTFDL(2,PCTPTR),@CH00053                           0455
*               PCTLDL = 60;                                       0456
         MVC   PCTLDL(2,PCTPTR),@CH00840                           0456
*             END;                                                 0457
*         /***********************************************************/
*         /*                                                         */
*         /* BEGIN TO VERIFY AND SET THE PRINT CONTROL TABLE ENTRIES */
*         /* ENTERED WITH THIS REQUEST.                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0458
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP A TRANSLATE TABLE ENTERED WITH THIS REQUEST.     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0458
*         IF P04PCP ^= 0                                           0458
*           THEN                                                   0458
@RF00437 L     @08,P04PCP                                          0458
         LTR   @08,@08                                             0458
         BZ    @RF00458                                            0458
*             PCTTRP = P04PCP;                                     0459
*                                                                  0459
         ST    @08,PCTTRP(,PCTPTR)                                 0459
*         /***********************************************************/
*         /*                                                         */
*         /*  VERIFY AND SET CHANGES TO LINE WIDTH                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0460
*         IF P04LW > 0 & P04LW < 133                               0460
*           THEN                                                   0460
@RF00458 LH    @08,P04LW                                           0460
         LTR   @08,@08                                             0460
         BNP   @RF00460                                            0460
         C     @08,@CF00841                                        0460
         BNL   @RF00460                                            0460
*             PCTPLW = P04LW;                                      0461
         ST    @08,PCTPLW(,PCTPTR)                                 0461
*           ELSE                                                   0462
*             DO;                                                  0462
         B     @RC00460                                            0462
@RF00460 DS    0H                                                  0463
*               IF P04LW ^= 0                                      0463
*                 THEN                                             0463
         LH    @08,P04LW                                           0463
         LTR   @08,@08                                             0463
         BZ    @RF00463                                            0463
*                   SAVERC = 4;                                    0464
         LA    SAVERC,4                                            0464
*             END;                                                 0465
*                                                                  0465
@RF00463 DS    0H                                                  0466
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO THE PAGE DEPTH.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0466
*         IF P04PD > 0                                             0466
*           THEN                                                   0466
@RC00460 LH    @08,P04PD                                           0466
         LTR   @08,@08                                             0466
         BNP   @RF00466                                            0466
*             DO;                                                  0467
*               PCTPPD = P04PD;                                    0468
         STH   @08,PCTPPD(,PCTPTR)                                 0468
*               PCTLDL = PCTPPD - OFLOSS;                          0469
         SH    @08,OFLOSS                                          0469
         STH   @08,PCTLDL(,PCTPTR)                                 0469
*             END;                                                 0470
*                                                                  0470
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO DEFAULT SPACE CHARACTER.      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0471
*         IF P04DSC > 0                                            0471
*           THEN                                                   0471
@RF00466 LH    @08,P04DSC                                          0471
         LTR   @08,@08                                             0471
         BNP   @RF00471                                            0471
*             DO;                                                  0472
*               IF P04DSC < 4                                      0473
*                 THEN                                             0473
         C     @08,@CF00053                                        0473
         BNL   @RF00473                                            0473
*                   PCTDSC = P04DSC;                               0474
         STH   @08,PCTDSC(,PCTPTR)                                 0474
*                 ELSE                                             0475
*                   SAVERC = 4;                                    0475
         B     @RC00473                                            0475
@RF00473 LA    SAVERC,4                                            0475
*             END;                                                 0476
*                                                                  0476
@RC00473 DS    0H                                                  0477
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO CURRENT PAGE NUMBER           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0477
*         IF P04CPN > 0                                            0477
*           THEN                                                   0477
@RF00471 LH    @08,P04CPN                                          0477
         LTR   @08,@08                                             0477
         BNP   @RF00477                                            0477
*             PCTCPN = P04CPN;                                     0478
*                                                                  0478
         STH   @08,PCTCPN(,PCTPTR)                                 0478
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET CHANGES TO PAGE NUMBER INCREMENT.        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0479
*         IF P04PNI > 0                                            0479
*           THEN                                                   0479
@RF00477 LH    @08,P04PNI                                          0479
         LTR   @08,@08                                             0479
         BNP   @RF00479                                            0479
*             DO;                                                  0480
*               IF P04PNI > 9999                                   0481
*                 THEN                                             0481
         C     @08,@CF00842                                        0481
         BNH   @RF00481                                            0481
*                   SAVERC = 4;                                    0482
         LA    SAVERC,4                                            0482
*                 ELSE                                             0483
*                   PCTPNI = P04PNI;                               0483
         B     @RC00481                                            0483
@RF00481 LH    @08,P04PNI                                          0483
         STH   @08,PCTPNI(,PCTPTR)                                 0483
*             END;                                                 0484
*                                                                  0484
@RC00481 DS    0H                                                  0485
*         /***********************************************************/
*         /*                                                         */
*         /*  VERIFY AND SET CHANGES TO THE MAIN TITLE LINE          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0485
*         IF P04MTP > 0                                            0485
*           THEN                                                   0485
@RF00479 L     @08,P04MTP                                          0485
         LTR   @08,@08                                             0485
         BNP   @RF00485                                            0485
*             DO;                                                  0486
*               /*****************************************************/
*               /*                                                   */
*               /* GET CORE FOR THE MAIN TITLE LINE.                 */
*               /* GET POOL ZERO FOR PRIMARY CONTROL TABLE.          */
*               /* GET POOL TP01 FOR SECONDARY CONTROL TABLE.        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0487
*               IF PRIPCT = ON                                     0487
*                 THEN                                             0487
         TM    PRIPCT,B'10000000'                                  0487
         BNO   @RF00487                                            0487
*                   DO;                                            0488
*                                                                  0488
*                     CALL IDCSAGS0 (GDTTBL,STDLW,PCTMLP);         0489
*                                                                  0489
         ST    GDTPTR,@AL00001                                     0489
         LA    @08,STDLW                                           0489
         ST    @08,@AL00001+4                                      0489
         LA    @08,PCTMLP(,PCTPTR)                                 0489
         ST    @08,@AL00001+8                                      0489
         MVI   @AL00001+8,X'80'                                    0489
         L     @15,GDTGSP(,GDTPTR)                                 0489
         LA    @01,@AL00001                                        0489
         BALR  @14,@15                                             0489
*                     RESPECIFY RTNREG RSTD;                       0490
*                     TESTRC = RTNREG;                             0491
         LR    TESTRC,RTNREG                                       0491
*                     RESPECIFY RTNREG UNRSTD;                     0492
*                     IF TESTRC ^= 0                               0493
*                       THEN                                       0493
*                                                                  0493
         LTR   TESTRC,TESTRC                                       0493
         BZ    @RF00493                                            0493
*                         DO;                                      0494
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0495
*                           REG15 = 28;                            0496
         LA    REG15,28                                            0496
*                           REG14 = GDTABT;                        0497
         L     REG14,GDTABT(,GDTPTR)                               0497
*                           REG13 = GDTABH;                        0498
         L     REG13,GDTABH(,GDTPTR)                               0498
*                           GEN(BR    REG14);                      0499
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0500
*                         END;                                     0501
*                   END;                                           0502
*                                                                  0502
*                 ELSE                                             0503
*                   DO;                                            0503
*                                                                  0503
         B     @RC00487                                            0503
@RF00487 DS    0H                                                  0504
*                     CALL IDCSAGP0 (GDTTBL,STDLW,PCTMLP,TPPOOL);  0504
*                                                                  0504
         ST    GDTPTR,@AL00001                                     0504
         LA    @08,STDLW                                           0504
         ST    @08,@AL00001+4                                      0504
         LA    @08,PCTMLP(,PCTPTR)                                 0504
         ST    @08,@AL00001+8                                      0504
         LA    @08,TPPOOL                                          0504
         ST    @08,@AL00001+12                                     0504
         MVI   @AL00001+12,X'80'                                   0504
         L     @15,GDTGPL(,GDTPTR)                                 0504
         LA    @01,@AL00001                                        0504
         BALR  @14,@15                                             0504
*                     RESPECIFY RTNREG RSTD;                       0505
*                     TESTRC = RTNREG;                             0506
         LR    TESTRC,RTNREG                                       0506
*                     RESPECIFY RTNREG UNRSTD;                     0507
*                     IF TESTRC ^= 0                               0508
*                       THEN                                       0508
*                                                                  0508
         LTR   TESTRC,TESTRC                                       0508
         BZ    @RF00508                                            0508
*                         DO;                                      0509
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0510
*                           REG15 = 28;                            0511
         LA    REG15,28                                            0511
*                           REG14 = GDTABT;                        0512
         L     REG14,GDTABT(,GDTPTR)                               0512
*                           REG13 = GDTABH;                        0513
         L     REG13,GDTABH(,GDTPTR)                               0513
*                           GEN(BR    REG14);                      0514
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0515
*                         END;                                     0516
*                   END;                                           0517
*                                                                  0517
@RF00508 DS    0H                                                  0518
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE THE MAIN TITLE LINE TO THE AREA              */
*               /* OBTAINED.                                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0518
*               MTLBUFF(1:120) = MTLINBF(1:120);                   0518
@RC00487 L     @08,PCTMLP(,PCTPTR)                                 0518
         L     @06,P04MTP                                          0518
         MVC   MTLBUFF(120,@08),MTLINBF(@06)                       0518
*               MTLCC = EJECT;                                     0519
*                                                                  0519
         MVI   MTLCC(@08),C'1'                                     0519
*               /*****************************************************/
*               /*                                                   */
*               /* VERIFY AND SET PAGE NUMBER LOCATION CHANGES.      */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0520
*               IF P04PNL > 0                                      0520
*                 THEN                                             0520
         LH    @08,P04PNL                                          0520
         LTR   @08,@08                                             0520
         BNP   @RF00520                                            0520
*                   DO;                                            0521
*                     IF P04PNL < PCTPLW -4                        0522
*                       THEN                                       0522
         L     @06,PCTPLW(,PCTPTR)                                 0522
         SL    @06,@CF00053                                        0522
         CR    @08,@06                                             0522
         BNL   @RF00522                                            0522
*                         PCTPNL = P04PNL;                         0523
         STH   @08,PCTPNL(,PCTPTR)                                 0523
*                       ELSE                                       0524
*                         SAVERC = 4;                              0524
         B     @RC00522                                            0524
@RF00522 LA    SAVERC,4                                            0524
*                   END;                                           0525
*                                                                  0525
@RC00522 DS    0H                                                  0526
*               /*****************************************************/
*               /*                                                   */
*               /* VERIFY AND SET TIME LOCATION CHANGES.             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0526
*               IF P04TL > 0                                       0526
*                 THEN                                             0526
@RF00520 LH    @08,P04TL                                           0526
         LTR   @08,@08                                             0526
         BNP   @RF00526                                            0526
*                   DO;                                            0527
*                     IF P04TL < PCTPLW - 6                        0528
*                       THEN;                                      0528
         L     @06,PCTPLW(,PCTPTR)                                 0528
         SL    @06,@CF00170                                        0528
         CR    @08,@06                                             0528
         BL    @RT00528                                            0528
*                       ELSE                                       0530
*                         SAVERC = 4;                              0530
         LA    SAVERC,4                                            0530
*                   END;                                           0531
*                                                                  0531
@RT00528 DS    0H                                                  0532
*               /*****************************************************/
*               /*                                                   */
*               /* VERIFY AND SET DATE LOCATION CHANGES.             */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0532
*               IF P04DL > 0                                       0532
*                 THEN                                             0532
@RF00526 LH    @08,P04DL                                           0532
         LTR   @08,@08                                             0532
         BNP   @RF00532                                            0532
*                   DO;                                            0533
*                     IF P04DL < PCTPLW - 6                        0534
*                       THEN;                                      0534
         L     @06,PCTPLW(,PCTPTR)                                 0534
         SL    @06,@CF00170                                        0534
         CR    @08,@06                                             0534
         BL    @RT00534                                            0534
*                       ELSE                                       0536
*                         SAVERC = 4;                              0536
         LA    SAVERC,4                                            0536
*                   END;                                           0537
*                                                                  0537
@RT00534 DS    0H                                                  0538
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE THE TIME AND DATE LOCATIONS IN THE     */
*               /* MAIN TITLE LINE.                                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0538
*               CALL IDCSATI0 (GDTTBL,MTLBUFF(P04TL:P04TL+7),      0538
*                     MTLBUFF(P04DL:P04DL+7),FORMAT);              0538
@RF00532 ST    GDTPTR,@AL00001                                     0538
         LH    @08,P04TL                                           0538
         L     @06,PCTMLP(,PCTPTR)                                 0538
         LA    @08,MTLBUFF-1(@08,@06)                              0538
         ST    @08,@AL00001+4                                      0538
         LH    @08,P04DL                                           0538
         LA    @08,MTLBUFF-1(@08,@06)                              0538
         ST    @08,@AL00001+8                                      0538
         LA    @08,FORMAT                                          0538
         ST    @08,@AL00001+12                                     0538
         MVI   @AL00001+12,X'80'                                   0538
         L     @15,GDTTIM(,GDTPTR)                                 0538
         LA    @01,@AL00001                                        0538
         BALR  @14,@15                                             0538
*             END;                                                 0539
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET SUB-TITLE LINE CHANGES.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0540
*         IF P04STP > 0                                            0540
*           THEN                                                   0540
@RF00485 L     @08,P04STP                                          0540
         LTR   @08,@08                                             0540
         BNP   @RF00540                                            0540
*             DO;                                                  0541
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK NUMBER OF LINES ENTERED.                      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0542
*               IF P04STC < 1  P04STC > 3                         0542
*                 THEN                                             0542
         LH    @08,P04STC                                          0542
         LTR   @08,@08                                             0542
         BNP   @RT00542                                            0542
         C     @08,@CF00176                                        0542
         BNH   @RF00542                                            0542
@RT00542 DS    0H                                                  0543
*                   SAVERC = 4;                                    0543
         LA    SAVERC,4                                            0543
*                 ELSE                                             0544
*                   DO;                                            0544
*                                                                  0544
         B     @RC00542                                            0544
@RF00542 DS    0H                                                  0545
*                   /*************************************************/
*                   /*                                               */
*                   /* GET CORE FOR THE NUMBER OF LINES REQUIRED.    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0545
*                     SPCCNT = P04STC * STDLW;                     0545
*                                                                  0545
         L     @08,STDLW                                           0545
         MH    @08,P04STC                                          0545
         ST    @08,SPCCNT                                          0545
*                     CALL IDCSAGP0 (GDTTBL,SPCCNT,PCTSLP,TPPOOL); 0546
*                                                                  0546
         ST    GDTPTR,@AL00001                                     0546
         LA    @08,SPCCNT                                          0546
         ST    @08,@AL00001+4                                      0546
         LA    @08,PCTSLP(,PCTPTR)                                 0546
         ST    @08,@AL00001+8                                      0546
         LA    @08,TPPOOL                                          0546
         ST    @08,@AL00001+12                                     0546
         MVI   @AL00001+12,X'80'                                   0546
         L     @15,GDTGPL(,GDTPTR)                                 0546
         LA    @01,@AL00001                                        0546
         BALR  @14,@15                                             0546
*                     RESPECIFY RTNREG RSTD;                       0547
*                     TESTRC = RTNREG;                             0548
         LR    TESTRC,RTNREG                                       0548
*                     RESPECIFY RTNREG UNRSTD;                     0549
*                     IF TESTRC ^= 0                               0550
*                       THEN                                       0550
*                                                                  0550
         LTR   TESTRC,TESTRC                                       0550
         BZ    @RF00550                                            0550
*                         DO;                                      0551
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0552
*                           REG15 = 28;                            0553
         LA    REG15,28                                            0553
*                           REG14 = GDTABT;                        0554
         L     REG14,GDTABT(,GDTPTR)                               0554
*                           REG13 = GDTABH;                        0555
         L     REG13,GDTABH(,GDTPTR)                               0555
*                           GEN(BR    REG14);                      0556
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0557
*                         END;                                     0558
*                                                                  0558
*                     SPCCNT = 0;                                  0559
*                                                                  0559
@RF00550 SLR   @08,@08                                             0559
         ST    @08,SPCCNT                                          0559
*                     /***********************************************/
*                     /*                                             */
*                     /* COMPUTE THE LINE SPACES REQUIRED FOR THE    */
*                     /* SUB-TITLE LINES ENTERED.                    */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0560
*                     DO N = 1 TO P04STC BY 1;                     0560
         LA    N,1                                                 0560
         B     @DE00560                                            0560
@DL00560 DS    0H                                                  0561
*                       STLINE(N) = P04STP -> STLINE(1);           0561
         LR    @08,N                                               0561
         MH    @08,@CH00723                                        0561
         L     @06,PCTSLP(,PCTPTR)                                 0561
         ST    @08,@TF00001                                        0561
         ALR   @08,@06                                             0561
         AL    @08,@CF00868                                        0561
         L     @04,P04STP                                          0561
         MVC   STLINE(121,@08),STLINE(@04)                         0561
*                       IF STLCC(N) = SINGLE                       0562
*                         THEN                                     0562
         AL    @06,@TF00001                                        0562
         AL    @06,@CF00868                                        0562
         CLI   STLCC(@06),C' '                                     0562
         BNE   @RF00562                                            0562
*                           SPCCNT = SPCCNT + 1;                   0563
         LA    @08,1                                               0563
         AL    @08,SPCCNT                                          0563
         ST    @08,SPCCNT                                          0563
*                       IF STLCC(N) = DOUBLE                       0564
*                         THEN                                     0564
@RF00562 LR    @08,N                                               0564
         MH    @08,@CH00723                                        0564
         L     @06,PCTSLP(,PCTPTR)                                 0564
         ALR   @06,@08                                             0564
         AL    @06,@CF00868                                        0564
         CLI   STLCC(@06),C'0'                                     0564
         BNE   @RF00564                                            0564
*                           SPCCNT = SPCCNT + 2;                   0565
         LA    @08,2                                               0565
         AL    @08,SPCCNT                                          0565
         ST    @08,SPCCNT                                          0565
*                       IF STLCC(N) = TRIPLE                       0566
*                         THEN                                     0566
@RF00564 LR    @08,N                                               0566
         MH    @08,@CH00723                                        0566
         L     @06,PCTSLP(,PCTPTR)                                 0566
         ALR   @06,@08                                             0566
         AL    @06,@CF00868                                        0566
         CLI   STLCC(@06),C'-'                                     0566
         BNE   @RF00566                                            0566
*                           SPCCNT = SPCCNT + 3;                   0567
*                                                                  0567
         LA    @08,3                                               0567
         AL    @08,SPCCNT                                          0567
         ST    @08,SPCCNT                                          0567
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK TO ASSURE THAT THE SPACING CHAR IS  */
*                       /* VALID AND IF NOT, SET DOUBLE SPACE.       */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0568
*                       IF STLCC(N) ^= SINGLE                      0568
*                         & STLCC(N) ^= DOUBLE                     0568
*                         & STLCC(N) ^= TRIPLE                     0568
*                         THEN                                     0568
@RF00566 LR    @08,N                                               0568
         MH    @08,@CH00723                                        0568
         L     @06,PCTSLP(,PCTPTR)                                 0568
         ST    @08,@TF00001                                        0568
         ALR   @08,@06                                             0568
         AL    @08,@CF00868                                        0568
         CLI   STLCC(@08),C' '                                     0568
         BE    @RF00568                                            0568
         LR    @08,@06                                             0568
         AL    @08,@TF00001                                        0568
         AL    @08,@CF00868                                        0568
         CLI   STLCC(@08),C'0'                                     0568
         BE    @RF00568                                            0568
         LR    @08,@06                                             0568
         AL    @08,@TF00001                                        0568
         AL    @08,@CF00868                                        0568
         CLI   STLCC(@08),C'-'                                     0568
         BE    @RF00568                                            0568
*                           DO;                                    0569
*                             STLCC(N) = DOUBLE;                   0570
         AL    @06,@TF00001                                        0570
         AL    @06,@CF00868                                        0570
         MVI   STLCC(@06),C'0'                                     0570
*                             SPCCNT = SPCCNT + 2;                 0571
         LA    @08,2                                               0571
         AL    @08,SPCCNT                                          0571
         ST    @08,SPCCNT                                          0571
*                           END;                                   0572
*                       P04STP = P04STP + STDLW;                   0573
@RF00568 L     @08,P04STP                                          0573
         AL    @08,STDLW                                           0573
         ST    @08,P04STP                                          0573
*                     END;                                         0574
         AL    N,@CF00233                                          0574
@DE00560 CH    N,P04STC                                            0574
         BNH   @DL00560                                            0574
*                     PCTSLC = P04STC;                             0575
*                                                                  0575
         LH    @08,P04STC                                          0575
         STH   @08,PCTSLC(,PCTPTR)                                 0575
*                     /***********************************************/
*                     /*                                             */
*                     /* MOVE THE FIRST DATA LINE DOWN BY THE SPACE  */
*                     /* TAKEN BY THE SUB-TITLE LINES.               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0576
*                     PCTFDL = PCTFDL + SPCCNT + 2;                0576
         LH    @08,PCTFDL(,PCTPTR)                                 0576
         AL    @08,SPCCNT                                          0576
         AL    @08,@CF00167                                        0576
         STH   @08,PCTFDL(,PCTPTR)                                 0576
*                   END;                                           0577
*             END;                                                 0578
*                                                                  0578
@RC00542 DS    0H                                                  0579
*         /***********************************************************/
*         /*                                                         */
*         /* VERIFY AND SET FOOTING LINE CHANGES.                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0579
*         IF P04FP > 0                                             0579
*           THEN                                                   0579
@RF00540 L     @08,P04FP                                           0579
         LTR   @08,@08                                             0579
         BNP   @RF00579                                            0579
*             DO;                                                  0580
*                                                                  0580
*             /*******************************************************/
*             /*                                                     */
*             /* ASSURE THE FOOTING LINE COUNT IS VALID.             */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0581
*               IF P04FC < 1  P04FC > 3                           0581
*                 THEN                                             0581
         LH    @08,P04FC                                           0581
         LTR   @08,@08                                             0581
         BNP   @RT00581                                            0581
         C     @08,@CF00176                                        0581
         BNH   @RF00581                                            0581
@RT00581 DS    0H                                                  0582
*                   SAVERC = 4;                                    0582
         LA    SAVERC,4                                            0582
*                 ELSE                                             0583
*                   DO;                                            0583
*                                                                  0583
         B     @RC00581                                            0583
@RF00581 DS    0H                                                  0584
*                   /*************************************************/
*                   /*                                               */
*                   /* GET CORE FOR THE FOOTING LINES ENTERED.       */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0584
*                     SPCCNT = P04FC * STDLW;                      0584
         LH    @08,P04FC                                           0584
         LR    @01,@08                                             0584
         M     @00,STDLW                                           0584
         ST    @01,SPCCNT                                          0584
*                     PCTFLC = P04FC;                              0585
*                                                                  0585
         STH   @08,PCTFLC(,PCTPTR)                                 0585
*                     CALL IDCSAGP0 (GDTTBL,SPCCNT,PCTFLP,TPPOOL); 0586
*                                                                  0586
         ST    GDTPTR,@AL00001                                     0586
         LA    @08,SPCCNT                                          0586
         ST    @08,@AL00001+4                                      0586
         LA    @08,PCTFLP(,PCTPTR)                                 0586
         ST    @08,@AL00001+8                                      0586
         LA    @08,TPPOOL                                          0586
         ST    @08,@AL00001+12                                     0586
         MVI   @AL00001+12,X'80'                                   0586
         L     @15,GDTGPL(,GDTPTR)                                 0586
         LA    @01,@AL00001                                        0586
         BALR  @14,@15                                             0586
*                     RESPECIFY RTNREG RSTD;                       0587
*                     TESTRC = RTNREG;                             0588
         LR    TESTRC,RTNREG                                       0588
*                     RESPECIFY RTNREG UNRSTD;                     0589
*                     IF TESTRC ^= 0                               0590
*                       THEN                                       0590
*                                                                  0590
         LTR   TESTRC,TESTRC                                       0590
         BZ    @RF00590                                            0590
*                         DO;                                      0591
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0592
*                           REG15 = 28;                            0593
         LA    REG15,28                                            0593
*                           REG14 = GDTABT;                        0594
         L     REG14,GDTABT(,GDTPTR)                               0594
*                           REG13 = GDTABH;                        0595
         L     REG13,GDTABH(,GDTPTR)                               0595
*                           GEN(BR    REG14);                      0596
         BR    REG14
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0597
*                         END;                                     0598
*                                                                  0598
*                     SPCCNT = 0;                                  0599
*                                                                  0599
@RF00590 SLR   @08,@08                                             0599
         ST    @08,SPCCNT                                          0599
*                     /***********************************************/
*                     /*                                             */
*                     /* COMPUTE THE SPACE REQUIRED BY THE FOOTING   */
*                     /* LINES.                                      */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0600
*                     DO N = 1 TO P04FC BY 1;                      0600
         LA    N,1                                                 0600
         B     @DE00600                                            0600
@DL00600 DS    0H                                                  0601
*                       FTLINE(N) = P04FP -> FTLINE(1);            0601
         LR    @08,N                                               0601
         MH    @08,@CH00723                                        0601
         L     @06,PCTFLP(,PCTPTR)                                 0601
         ST    @08,@TF00001                                        0601
         ALR   @08,@06                                             0601
         AL    @08,@CF00868                                        0601
         L     @04,P04FP                                           0601
         MVC   FTLINE(121,@08),FTLINE(@04)                         0601
*                       IF FTLCC(N) = SINGLE                       0602
*                         THEN                                     0602
         AL    @06,@TF00001                                        0602
         AL    @06,@CF00868                                        0602
         CLI   FTLCC(@06),C' '                                     0602
         BNE   @RF00602                                            0602
*                           SPCCNT = SPCCNT + 1;                   0603
         LA    @08,1                                               0603
         AL    @08,SPCCNT                                          0603
         ST    @08,SPCCNT                                          0603
*                       IF FTLCC(N) = DOUBLE                       0604
*                         THEN                                     0604
@RF00602 LR    @08,N                                               0604
         MH    @08,@CH00723                                        0604
         L     @06,PCTFLP(,PCTPTR)                                 0604
         ALR   @06,@08                                             0604
         AL    @06,@CF00868                                        0604
         CLI   FTLCC(@06),C'0'                                     0604
         BNE   @RF00604                                            0604
*                           SPCCNT = SPCCNT + 2;                   0605
         LA    @08,2                                               0605
         AL    @08,SPCCNT                                          0605
         ST    @08,SPCCNT                                          0605
*                       IF FTLCC(N) = TRIPLE                       0606
*                         THEN                                     0606
@RF00604 LR    @08,N                                               0606
         MH    @08,@CH00723                                        0606
         L     @06,PCTFLP(,PCTPTR)                                 0606
         ALR   @06,@08                                             0606
         AL    @06,@CF00868                                        0606
         CLI   FTLCC(@06),C'-'                                     0606
         BNE   @RF00606                                            0606
*                           SPCCNT = SPCCNT + 3;                   0607
*                                                                  0607
         LA    @08,3                                               0607
         AL    @08,SPCCNT                                          0607
         ST    @08,SPCCNT                                          0607
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK THE CARRIAGE CONTROL CHAR FOR       */
*                       /* VALIDITY (1, 2 OR 3) AND IF INVALID SET   */
*                       /* TO 1.                                     */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0608
*                       IF FTLCC(N) ^= SINGLE                      0608
*                          FTLCC(N) ^= DOUBLE                     0608
*                          FTLCC(N) ^= TRIPLE                     0608
*                           THEN                                   0608
@RF00606 LR    @08,N                                               0608
         MH    @08,@CH00723                                        0608
         L     @06,PCTFLP(,PCTPTR)                                 0608
         ST    @08,@TF00001                                        0608
         ALR   @08,@06                                             0608
         AL    @08,@CF00868                                        0608
         CLI   FTLCC(@08),C' '                                     0608
         BNE   @RT00608                                            0608
         LR    @08,@06                                             0608
         AL    @08,@TF00001                                        0608
         AL    @08,@CF00868                                        0608
         CLI   FTLCC(@08),C'0'                                     0608
         BNE   @RT00608                                            0608
         AL    @06,@TF00001                                        0608
         AL    @06,@CF00868                                        0608
         CLI   FTLCC(@06),C'-'                                     0608
         BE    @RF00608                                            0608
@RT00608 DS    0H                                                  0609
*                             DO;                                  0609
*                               FTLCC(N) = SINGLE;                 0610
         LR    @08,N                                               0610
         MH    @08,@CH00723                                        0610
         L     @06,PCTFLP(,PCTPTR)                                 0610
         ALR   @06,@08                                             0610
         AL    @06,@CF00868                                        0610
         MVI   FTLCC(@06),C' '                                     0610
*                               SPCCNT = SPCCNT + 1;               0611
         LA    @08,1                                               0611
         AL    @08,SPCCNT                                          0611
         ST    @08,SPCCNT                                          0611
*                             END;                                 0612
*                       P04FP = P04FP + STDLW;                     0613
@RF00608 L     @08,P04FP                                           0613
         AL    @08,STDLW                                           0613
         ST    @08,P04FP                                           0613
*                     END;                                         0614
*                                                                  0614
         AL    N,@CF00233                                          0614
@DE00600 CH    N,P04FC                                             0614
         BNH   @DL00600                                            0614
*                     /***********************************************/
*                     /*                                             */
*                     /* ADJUST THE LAST DATA LINE PER FOOTING LINE  */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0615
*                     PCTFLN = PCTPPD - SPCCNT - 3;                0615
         LH    @08,PCTPPD(,PCTPTR)                                 0615
         SL    @08,SPCCNT                                          0615
         SL    @08,@CF00176                                        0615
         STH   @08,PCTFLN(,PCTPTR)                                 0615
*                     PCTLDL = PCTFLN - 2;                         0616
         BCTR  @08,0                                               0616
         BCTR  @08,0                                               0616
         STH   @08,PCTLDL(,PCTPTR)                                 0616
*                   END;                                           0617
*             END;                                                 0618
*                                                                  0618
@RC00581 DS    0H                                                  0619
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE VERIFY AND PCT SETTING PROCEDURE.            */
*         /* THEN RETURN TO THE CALLING PROCEDURE.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0619
*         RETURN CODE (SAVERC);                                    0619
@RF00579 LR    @15,SAVERC                                          0619
         L     @14,@SA00006                                        0619
         LM    @00,@06,@SA00006+8                                  0619
         LM    @08,@12,@SA00006+36                                 0619
         BR    @14                                                 0619
*         END PCTSETUP;                                            0620
*                                                                  0620
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - RESET FUNCTION HANDLER.                */
*         /*                                                         */
*         /* FUNCTION - RESETS THE PRINT CONTROL TABLE TO THE        */
*         /* INITIAL DEFAULT VALUES AND RELEASES ALL 'TP' POOL       */
*         /* STORAGE.  IN ADDITION, IT RETURNS THE LAST PAGE NUMBER  */
*         /* USED TO THE CALLING ROUTINE.                            */
*         /*                                                         */
*         /* INPUT - PAGE NUMBER LOCATION.                           */
*         /*                                                         */
*         /* OUTPUT - REVISED PRINT CONTROL TABLE.                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0621
*RESETCON: PROC (PGNOPTR);                                         0621
*                                                                  0621
RESETCON STM   @14,@12,@SA00007                                    0621
         MVC   @PC00007(4),0(@01)                                  0621
*         /***********************************************************/
*         /*                                                         */
*         /* THE ARGUMENT STRUCTURE PASSED WITH THE URESET MACRO FOR */
*         /* RETURN OF THE PAGE NUMBER TO THE CALLER.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0622
*         DCL PGNOPTR PTR(31);                                     0622
*         DCL 1 PGNO BASED(PGNOPTR),                               0623
*              2 PGNOL FIXED(15),      /* LENGTH OF PAGE NUMBER.     */
*              2 PGNOC CHAR(4);        /* CHARACTERS OF PAGE NUMBER  */
*                                                                  0623
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO ASSURE THAT A PRINT CONTROL TABLE EXISTS.      */
*         /* IF NONE EXISTS, SOMETHING IS OUT OF SEQUENCE.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0624
*         IF GDTTPH = NULLPTR                                      0624
*           THEN                                                   0624
         L     @08,GDTTPH(,GDTPTR)                                 0624
         LTR   @08,@08                                             0624
         BNZ   @RF00624                                            0624
*             DO;                                                  0625
*                                                                  0625
*               DO;                                                0626
*                 RESPECIFY(REG13,REG14,REG15) RSTD;               0627
*                 REG15 = 24;                                      0628
         LA    REG15,24                                            0628
*                 REG14 = GDTABT;                                  0629
         L     REG14,GDTABT(,GDTPTR)                               0629
*                 REG13 = GDTABH;                                  0630
         L     REG13,GDTABH(,GDTPTR)                               0630
*                 GEN(BR    REG14);                                0631
         BR    REG14
*                 RESPECIFY(REG13,REG14,REG15)UNRSTD;              0632
*               END;                                               0633
*             END;                                                 0634
*                                                                  0634
*         /***********************************************************/
*         /*                                                         */
*         /* SET ADDRESSABILITY TO THE CURRENT PCT.                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0635
*         PCTPTR = GDTTPH;                                         0635
@RF00624 L     PCTPTR,GDTTPH(,GDTPTR)                              0635
*         SAVERC = 0;                                      /*@YL026UE*/
         SLR   SAVERC,SAVERC                                       0636
*         IF PCTSPP ^= NULLPTR                                     0637
*           THEN                                                   0637
         L     @08,PCTSPP(,PCTPTR)                                 0637
         LTR   @08,@08                                             0637
         BZ    @RF00637                                            0637
*             DO;                                                  0638
*               PCTPTR = PCTSPP;                                   0639
         LR    PCTPTR,@08                                          0639
*               PCTNLI = 999;                                      0640
         LA    @08,999                                             0640
         STH   @08,PCTNLI(,PCTPTR)                                 0640
*               PCTSNL = 999;                                      0641
         STH   @08,PCTSNL(,PCTPTR)                                 0641
*             END;                                                 0642
*                                                                  0642
*         /***********************************************************/
*         /*                                                         */
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0643
*         CALL STACKFL;                                            0643
*                                                                  0643
@RF00637 BAL   @14,STACKFL                                         0643
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT AND RETURN THE PAGE NUMBER TO THE CALLERS AREA. */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0644
*         IF PGNOF = ON & PGNOL > 0 & PGNOL <= 4             /*YM5742*/
*           THEN                                                   0644
         TM    PGNOF,B'01000000'                                   0644
         BNO   @RF00644                                            0644
         L     @08,@PC00007                                        0644
         L     @08,PGNOPTR(,@08)                                   0644
         LH    @08,PGNOL(,@08)                                     0644
         LTR   @08,@08                                             0644
         BNP   @RF00644                                            0644
         C     @08,@CF00053                                        0644
         BH    @RF00644                                            0644
*             DO;                                                  0645
*               CVDREG = PCTCPN;                                   0646
         LH    CVDREG,PCTCPN(,PCTPTR)                              0646
*GEN     (CVD   CVDREG,PACKWD);                                    0647
         CVD   CVDREG,PACKWD
*GEN     (UNPK  PAGE,PACKWD);                                      0648
*                                                                  0648
         UNPK  PAGE,PACKWD
*               PAGE(4) = PAGE(4)  'F0'X;  /* TURN OFF SIGN.        */
         OI    PAGE+3,X'F0'                                        0649
*               PGNOC(1:PGNOL) = PAGE((5-PGNOL):4);                0650
         L     @08,@PC00007                                        0650
         L     @08,PGNOPTR(,@08)                                   0650
         LH    @04,PGNOL(,@08)                                     0650
         LR    @03,@04                                             0650
         BCTR  @03,0                                               0650
         LCR   @04,@04                                             0650
         AL    @04,@CF00300                                        0650
         LA    @01,PAGE-1(@04)                                     0650
         EX    @03,@SM00869                                        0650
*             END;                                                 0651
*         GDTTPH ->PCTSTM = PCTSTM;                                0652
@RF00644 L     @08,GDTTPH(,GDTPTR)                                 0652
         MVC   PCTSTM(8,@08),PCTSTM(PCTPTR)                        0652
*         GDTTPH ->PCTSME = PCTSME;                                0653
         L     @04,PCTSME(,PCTPTR)                                 0653
         ST    @04,PCTSME(,@08)                                    0653
*         IF PCTAPF = ON                                           0654
*           THEN                                                   0654
         TM    PCTAPF(PCTPTR),B'00001000'                          0654
         BNO   @RF00654                                            0654
*             GDTTPH->PCTACT = PCTSTD;                             0655
         MVC   PCTACT(8,@08),PCTSTD(PCTPTR)                        0655
*           ELSE                                                   0656
*             GDTTPH ->PCTACT = PCTACT;                            0656
*                                                                  0656
         B     @RC00654                                            0656
@RF00654 L     @08,GDTTPH(,GDTPTR)                                 0656
         MVC   PCTACT(8,@08),PCTACT(PCTPTR)                        0656
*         /***********************************************************/
*         /*                                                         */
*         /* FREE  THE TP01 SUB-POOL AND RETURN TO THE CALLER.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0657
*         CALL IDCSAFP0 (GDTTBL,TPPOOL,ALL);                       0657
*                                                                  0657
@RC00654 MVC   @AL00001+4(8),@AL00657                              0657
         ST    GDTPTR,@AL00001                                     0657
         L     @15,GDTFPL(,GDTPTR)                                 0657
         LA    @01,@AL00001                                        0657
         BALR  @14,@15                                             0657
*         /***********************************************************/
*         /*                                                         */
*         /* CLEAR THE STID AND HEADER QUEUE POINTERS.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0658
*         PCTPTR = GDTTPH;                                         0658
         L     PCTPTR,GDTTPH(,GDTPTR)                              0658
*         PCTSPP = NULLPTR;                                        0659
         SLR   @08,@08                                             0659
         ST    @08,PCTSPP(,PCTPTR)                                 0659
*         PCTSQP = NULLPTR;                                        0660
         ST    @08,PCTSQP(,PCTPTR)                                 0660
*         PCTAHP = NULLPTR;                                        0661
         ST    @08,PCTAHP(,PCTPTR)                                 0661
*         PCTBNL = PCTBUF;                                         0662
*                                                                  0662
         L     @04,PCTBUF(,PCTPTR)                                 0662
         ST    @04,PCTBNL(,PCTPTR)                                 0662
*         RETURN CODE(0);                                          0663
         LR    @15,@08                                             0663
         L     @14,@SA00007                                        0663
         LM    @00,@12,@SA00007+8                                  0663
         BR    @14                                                 0663
*         END RESETCON;                                            0664
*                                                                  0664
*         /*                                                         */
*         /* PROCEDURE NAME - GET PRINT CONTROL TABLE.               */
*         /*                                                         */
*         /* FUNCTION - GETS CORE FOR AND INITIALIZES THE PRINT      */
*         /* CONTROL TABLE.                                          */
*         /*                                                         */
*         /* INPUT - NONE.                                           */
*         /*                                                         */
*         /* OUTPUT - NEW UNINITIALIZED PRINT CONTROL TABLE.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0665
*INITPCT: PROC;                                                    0665
*                                                                  0665
INITPCT  STM   @14,@04,@SA00008                                    0665
         STM   @06,@12,@SA00008+28                                 0665
*         /***********************************************************/
*         /*                                                         */
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0666
*         IF GDTTPH ^= NULLPTR                                     0666
*           THEN                                                   0666
*                                                                  0666
         L     @08,GDTTPH(,GDTPTR)                                 0666
         LTR   @08,@08                                             0666
         BZ    @RF00666                                            0666
*             CALL STACKFL;                                        0667
*                                                                  0667
         BAL   @14,STACKFL                                         0667
*         PCTPTR = GDTTPH;                                         0668
*                                                                  0668
@RF00666 L     @08,GDTTPH(,GDTPTR)                                 0668
         LR    PCTPTR,@08                                          0668
*         /***********************************************************/
*         /*                                                         */
*         /* IF AN EXISTING SECONDARY TABLE EXISTS, FREE IT.         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0669
*         IF GDTTPH ^= NULLPTR & PCTSPP ^= NULLPTR                 0669
*           THEN                                                   0669
         SLR   @04,@04                                             0669
         CR    @08,@04                                             0669
         BE    @RF00669                                            0669
         L     @03,PCTSPP(,PCTPTR)                                 0669
         CR    @03,@04                                             0669
         BE    @RF00669                                            0669
*             DO;                                                  0670
*               PCTPTR = PCTSPP;                           /*@OZ07572*/
         LR    PCTPTR,@03                                          0671
*               IF GDTTPH -> PCTAPF = ON                   /*@OZ07572*/
*                 THEN                                             0672
         TM    PCTAPF(@08),B'00001000'                             0672
         BNO   @RF00672                                            0672
*                   GDTTPH->PCTACT = PCTSTD;                       0673
         MVC   PCTACT(8,@08),PCTSTD(PCTPTR)                        0673
*                 ELSE                                             0674
*                   GDTTPH->PCTACT = PCTACT;                       0674
         B     @RC00672                                            0674
@RF00672 L     @08,GDTTPH(,GDTPTR)                                 0674
         MVC   PCTACT(8,@08),PCTACT(PCTPTR)                        0674
*               PCTPTR = GDTTPH;                           /*@OZ07572*/
*                                                                  0675
@RC00672 L     PCTPTR,GDTTPH(,GDTPTR)                              0675
*               CALL IDCSAFP0 (GDTTBL,TPPOOL,ALL);                 0676
*                                                                  0676
         MVC   @AL00001+4(8),@AL00676                              0676
         ST    GDTPTR,@AL00001                                     0676
         L     @15,GDTFPL(,GDTPTR)                                 0676
         LA    @01,@AL00001                                        0676
         BALR  @14,@15                                             0676
*               GDTTPH->PCTSQP = NULLPTR;                  /*@Y30LSBE*/
*                                                                  0677
         L     @08,GDTTPH(,GDTPTR)                                 0677
         SLR   @04,@04                                             0677
         ST    @04,PCTSQP(,@08)                                    0677
*             END;                                                 0678
*                                                                  0678
*             OLDERID2 = NEWERID2;                                 0679
@RF00669 L     @08,GDTTR2(,GDTPTR)                                 0679
         MVC   @TS00001(95),NEWERID2(@08)                          0679
         MVC   OLDERID2(95,@08),@TS00001                           0679
*             NEWID2 = 'TP4G';                                     0680
*                                                                  0680
         MVC   NEWID2(4,@08),@CC00855                              0680
*         /***********************************************************/
*         /*                                                         */
*         /* IF REQUEST IS FOR PRIMARY PCT, GET NON POOL CORE.       */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0681
*         IF GDTTPH = NULLPTR                                      0681
*           THEN                                                   0681
         L     @08,GDTTPH(,GDTPTR)                                 0681
         LTR   @08,@08                                             0681
         BNZ   @RF00681                                            0681
*             DO;                                                  0682
*                                                                  0682
*               CALL IDCSAGS0 (GDTTBL,PCTLEN,GDTTPH,SETZERO);      0683
*                                                                  0683
         ST    GDTPTR,@AL00001                                     0683
         LA    @08,PCTLEN                                          0683
         ST    @08,@AL00001+4                                      0683
         LA    @08,GDTTPH(,GDTPTR)                                 0683
         ST    @08,@AL00001+8                                      0683
         LA    @08,SETZERO                                         0683
         ST    @08,@AL00001+12                                     0683
         MVI   @AL00001+12,X'80'                                   0683
         L     @15,GDTGSP(,GDTPTR)                                 0683
         LA    @01,@AL00001                                        0683
         BALR  @14,@15                                             0683
*               RESPECIFY RTNREG RSTD;                             0684
*               TESTRC = RTNREG;                                   0685
         LR    TESTRC,RTNREG                                       0685
*               RESPECIFY RTNREG UNRSTD;                           0686
*               IF TESTRC ^= 0                                     0687
*                 THEN                                             0687
*                                                                  0687
         LTR   TESTRC,TESTRC                                       0687
         BZ    @RF00687                                            0687
*                   DO;                                            0688
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0689
*                     REG15 = 28;                                  0690
         LA    REG15,28                                            0690
*                     REG14 = GDTABT;                              0691
         L     REG14,GDTABT(,GDTPTR)                               0691
*                     REG13 = GDTABH;                              0692
         L     REG13,GDTABH(,GDTPTR)                               0692
*                     GEN(BR    REG14);                            0693
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0694
*                   END;                                           0695
*               PCTPTR = GDTTPH;                                   0696
@RF00687 L     PCTPTR,GDTTPH(,GDTPTR)                              0696
*               PCTIDN = 'PCT1';                                   0697
         MVC   PCTIDN(4,PCTPTR),@CC00856                           0697
*             END;                                                 0698
*                                                                  0698
*           /*********************************************************/
*           /*                                                       */
*           /* IF REQUEST IS FOR SECONDARY PCT, GET TP POOL CORE.    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0699
*           ELSE                                                   0699
*             DO;                                                  0699
*                                                                  0699
         B     @RC00681                                            0699
@RF00681 DS    0H                                                  0700
*               CALL IDCSAGP0 (GDTTBL,PCTLEN,PCTSPP,TPPOOL,SETZERO);
*                                                                  0700
         MVC   @AL00001+4(16),@AL00700                             0700
         ST    GDTPTR,@AL00001                                     0700
         LA    @08,PCTSPP(,PCTPTR)                                 0700
         ST    @08,@AL00001+8                                      0700
         L     @15,GDTGPL(,GDTPTR)                                 0700
         LA    @01,@AL00001                                        0700
         BALR  @14,@15                                             0700
*               RESPECIFY RTNREG RSTD;                             0701
*               TESTRC = RTNREG;                                   0702
         LR    TESTRC,RTNREG                                       0702
*               RESPECIFY RTNREG UNRSTD;                           0703
*               IF TESTRC ^= 0                                     0704
*                 THEN                                             0704
*                                                                  0704
         LTR   TESTRC,TESTRC                                       0704
         BZ    @RF00704                                            0704
*                   DO;                                            0705
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0706
*                     REG15 = 28;                                  0707
         LA    REG15,28                                            0707
*                     REG14 = GDTABT;                              0708
         L     REG14,GDTABT(,GDTPTR)                               0708
*                     REG13 = GDTABH;                              0709
         L     REG13,GDTABH(,GDTPTR)                               0709
*                     GEN(BR    REG14);                            0710
         BR    REG14
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0711
*                   END;                                           0712
*                                                                  0712
*               PCTPTR = PCTSPP;                                   0713
@RF00704 L     PCTPTR,PCTSPP(,PCTPTR)                              0713
*               PCTTAB = GDTTPH->PCTTAB;                           0714
         L     @08,GDTTPH(,GDTPTR)                                 0714
         MVC   PCTTAB(112,PCTPTR),PCTTAB(@08)                      0714
*               PCTSPP = NULLPTR;                                  0715
         SLR   @08,@08                                             0715
         ST    @08,PCTSPP(,PCTPTR)                                 0715
*               PCTSQP = NULLPTR;                          /*@Y30LSBE*/
         ST    @08,PCTSQP(,PCTPTR)                                 0716
*               PCTAHP = NULLPTR;                          /*@Y30LSBE*/
         ST    @08,PCTAHP(,PCTPTR)                                 0717
*               PCTIDN = 'PCT2';                                   0718
         MVC   PCTIDN(4,PCTPTR),@CC00857                           0718
*             END;                                                 0719
*         END INITPCT;                                             0720
@EL00008 DS    0H                                                  0720
@EF00008 DS    0H                                                  0720
@ER00008 LM    @14,@04,@SA00008                                    0720
         LM    @06,@12,@SA00008+28                                 0720
         BR    @14                                                 0720
*         /***********************************************************/
*         /*                                                         */
*         /* PROCEDURE NAME - PRINT STACK BUFFER FLUSHING.           */
*         /*                                                         */
*         /* FUNCTION - CLEARS OUT ANY LINES THAT MAY HAVE BEEN LEFT */
*         /* IN THE STACK BUFFER BY PREVIOUS OPERATIONS BY PUTTING   */
*         /* THEM TO THE IO ADAPTOR.                                 */
*         /*                                                         */
*         /* INPUT - PRINT CONTROL TABLE & STACK BUFFER.             */
*         /*                                                         */
*         /* OUTPUT - PRINTED LINES TO SYSPRINT.                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0721
*STACKFL: PROC;                                                    0721
*                                                                  0721
STACKFL  STM   @14,@12,@SA00009                                    0721
*         IF PCTLNM = 0                                            0722
*           THEN                                                   0722
         SLR   @08,@08                                             0722
         CH    @08,PCTLNM(,PCTPTR)                                 0722
         BNE   @RF00722                                            0722
*             RETURN CODE(0);                                      0723
*                                                                  0723
         LR    @15,@08                                             0723
         L     @14,@SA00009                                        0723
         LM    @00,@12,@SA00009+8                                  0723
         BR    @14                                                 0723
*         IOCSPTR = PCTIOC;             /* SET IOCS ADDRESSABILITY   */
@RF00722 L     IOCSPTR,PCTIOC(,PCTPTR)                             0724
*         IOCDLN = PCTBNL - PCTBUF;     /* SET DATA LENGTH.          */
         L     @08,PCTBUF(,PCTPTR)                                 0725
         L     @04,PCTBNL(,PCTPTR)                                 0725
         SLR   @04,@08                                             0725
         ST    @04,IOCDLN(,IOCSPTR)                                0725
*         IOCDAD = PCTBUF;              /* SET DATA ADDRESS.         */
         ST    @08,IOCDAD(,IOCSPTR)                                0726
*         IOCPNM = PCTLNM;              /* SET LINE COUNT.           */
*                                                                  0727
         LH    @08,PCTLNM(,PCTPTR)                                 0727
         STH   @08,IOCPNM(,IOCSPTR)                                0727
*         CALL IDCIOPT0 (GDTTBL,PCTIOC,NULLPMN);                   0728
*                                                                  0728
         ST    GDTPTR,@AL00001                                     0728
         LA    @08,PCTIOC(,PCTPTR)                                 0728
         ST    @08,@AL00001+4                                      0728
         LA    @08,NULLPMN                                         0728
         ST    @08,@AL00001+8                                      0728
         MVI   @AL00001+8,X'80'                                    0728
         L     @15,GDTPUT(,GDTPTR)                                 0728
         LA    @01,@AL00001                                        0728
         BALR  @14,@15                                             0728
*         RESPECIFY RTNREG RSTD;                                   0729
*         TESTRC = RTNREG;                                         0730
         LR    TESTRC,RTNREG                                       0730
*         RESPECIFY RTNREG UNRSTD;                                 0731
*         IF TESTRC ^= 0                                           0732
*           THEN                                                   0732
*                                                                  0732
         LTR   TESTRC,TESTRC                                       0732
         BZ    @RF00732                                            0732
*             DO;                                                  0733
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0734
*               REG15 = 28;                                        0735
         LA    REG15,28                                            0735
*               REG14 = GDTABT;                                    0736
         L     REG14,GDTABT(,GDTPTR)                               0736
*               REG13 = GDTABH;                                    0737
         L     REG13,GDTABH(,GDTPTR)                               0737
*               GEN(BR    REG14);                                  0738
         BR    REG14
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0739
*             END;                                                 0740
*                                                                  0740
*         GDTTPH->PCTLNM = NULLPTR;                                0741
@RF00732 SLR   @08,@08                                             0741
         L     @04,GDTTPH(,GDTPTR)                                 0741
         STH   @08,PCTLNM(,@04)                                    0741
*         GDTTPH->PCTBNL = PCTBUF;                                 0742
         L     @03,PCTBUF(,PCTPTR)                                 0742
         ST    @03,PCTBNL(,@04)                                    0742
*         PCTLNM = NULLPTR;                                        0743
         STH   @08,PCTLNM(,PCTPTR)                                 0743
*         PCTBNL = PCTBUF;                                         0744
*                                                                  0744
         ST    @03,PCTBNL(,PCTPTR)                                 0744
*         END STACKFL;                                             0745
*                                                                  0745
@EL00009 DS    0H                                                  0745
@EF00009 DS    0H                                                  0745
@ER00009 LM    @14,@12,@SA00009                                    0745
         BR    @14                                                 0745
*         /***********************************************************/
*         /*                                                         */
*         /* END OF THE PAGE CONTROL MAJOR PROCEDURE.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0746
*         END IDCTP04                                              0746
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF40 )                                        *
*;                                                                 0746
@DATA    DS    0H
@CH00840 DC    H'60'
@CH00725 DC    H'66'
@CH00723 DC    H'121'
@CH00826 DC    H'-1'
@SM00866 MVC   0(0,@01),PGNOCIN(@04)
@SM00869 MVC   PGNOC(0,@08),0(@01)
         DS    0F
@AL00657 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00676 DC    A(TPPOOL)               LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@AL00700 DC    A(PCTLEN)               LIST WITH   4 ARGUMENT(S)
         DS    F
         DC    A(TPPOOL)
         DC    AL1(X'80')
         DC    AL3(SETZERO)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    9F
@SA00002 DS    15F
@PC00002 DS    1F
@SA00003 DS    15F
@PC00003 DS    1F
@SA00005 DS    15F
@SA00007 DS    15F
@PC00007 DS    1F
@SA00008 DS    14F
@SA00006 DS    14F
@SA00009 DS    15F
@AL00001 DS    5A
@TF00001 DS    F
IDCTP04  CSECT
         DS    0F
@CF00233 DC    F'1'
@CH00233 EQU   @CF00233+2
@CF00167 DC    F'2'
@CF00176 DC    F'3'
@CH00176 EQU   @CF00176+2
@CF00053 DC    F'4'
@CH00053 EQU   @CF00053+2
@CF00300 DC    F'5'
@CF00170 DC    F'6'
@CF00816 DC    F'7'
@CF00841 DC    F'133'
@CF00780 DC    F'255'
@CF00842 DC    F'9999'
@CF00868 DC    F'-121'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
PCAADDR  DS    A
SPCCNT   DS    F
LISTPTR  DS    A
TEMPTR   DS    A
SETRC    DS    H
ARGNMB   DS    H
@TS00001 DS    CL95
         DS    CL1
P04WT    DS    CL42
         ORG   P04WT
P04MTP   DS    AL4
P04STP   DS    AL4
P04FP    DS    AL4
P04FNP   DS    AL4
P04PCP   DS    AL4
P04MTC   DS    FL2
P04STC   DS    FL2
P04FC    DS    FL2
P04LW    DS    FL2
P04PD    DS    FL2
P04DSC   DS    FL2
P04CPN   DS    FL2
P04PNI   DS    FL2
P04PNL   DS    FL2
P04TL    DS    FL2
P04DL    DS    FL2
         ORG   P04WT+42
         DS    CL2
PROPEN   DS    CL48
P04FLG   DS    BL1
         ORG   P04FLG
PRIPCT   DS    BL1
PGNOF    EQU   P04FLG+0
         ORG   P04FLG+1
STID     DS    CL4
PAGE     DS    CL4
MACARG   DS    CL3
PACKWD   DS    CL8
RESTARG  DS    7A
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCTP04  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00747 DC    V(IDCTP05)
         DS    0D
PCTLEN   DC    AL4(112)
STDLW    DC    F'121'
PRBUFL   DC    F'2048'
SUBPZ    DC    F'0'
IOPLSP   DC    F'40'
TTSIZE   DC    H'256'
OFLOSS   DC    H'12'
NULLPMN  DC    H'0'
@CC00795 DC    C'TP4I'
@CC00798 DC    C'TP4A'
@CC00802 DC    C'TP4S'
@CC00834 DC    C'TP4R'
@CC00855 DC    C'TP4G'
@CC00856 DC    C'PCT1'
@CC00857 DC    C'PCT2'
@CC00832 DC    C'TP0'
@CC00825 DC    C'ST'
@CC00827 DC    C'FT'
@CC00828 DC    C'LW'
@CC00829 DC    C'PD'
@CC00830 DC    C'SC'
@CC00831 EQU   @CC00856
@CC00833 DC    C'PN'
MODID    DC    CL4'TP04'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
TPPOOL   DC    CL4'TP01'
DUMPID   DC    CL4'TP04'
FIXAREA  DS    CL220
PCTAB    DC    X'C1D501'
         DC    X'C8D506'
         DC    X'D7D502'
         DC    X'D8D503'
         DC    X'D9D507'
         DC    X'E2D504'
         DC    X'E3D505'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
N        EQU   @03
SAVERC   EQU   @07
PCRADDR  EQU   @06
PCTPTR   EQU   @05
OPNPTR   EQU   @03
IOCSPTR  EQU   @03
TESTRC   EQU   @03
LISTLN   EQU   @08
RTNREG   EQU   @15
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
CVDREG   EQU   @02
GDTPTR   EQU   @09
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTTPH   EQU   GDTTBL+28
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
IDCSALD0 EQU   0
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
LISTTEST EQU   0
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOPT0 EQU   0
IOCSTR   EQU   0
IOCDAD   EQU   IOCSTR
IOCDLN   EQU   IOCSTR+4
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCPNM   EQU   IOCNWM+2
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNTYPSO EQU   OPNTYP
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
DARGLIST EQU   0
DARGSTID EQU   DARGLIST+8
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
PCTTAB   EQU   0
PCTIDN   EQU   PCTTAB
PCTFLG   EQU   PCTTAB+4
PCTAPF   EQU   PCTFLG
PCTSPP   EQU   PCTTAB+8
PCTACT   EQU   PCTTAB+12
PCTIOC   EQU   PCTACT
PCTAPL   EQU   PCTACT+4
PCTCPN   EQU   PCTAPL
PCTNLI   EQU   PCTAPL+2
PCTSTD   EQU   PCTTAB+20
PCTSPL   EQU   PCTSTD+4
PCTSNL   EQU   PCTSPL+2
PCTALT   EQU   PCTTAB+28
PCTLPL   EQU   PCTALT+4
PCTANL   EQU   PCTLPL+2
PCTSTM   EQU   PCTTAB+36
PCTSME   EQU   PCTTAB+44
PCTSQP   EQU   PCTTAB+48
PCTAHP   EQU   PCTTAB+52
PCTMLP   EQU   PCTTAB+56
PCTSLP   EQU   PCTTAB+60
PCTTRP   EQU   PCTTAB+64
PCTPLW   EQU   PCTTAB+68
PCTSLC   EQU   PCTTAB+74
PCTFLP   EQU   PCTTAB+76
PCTFLC   EQU   PCTTAB+80
PCTPNL   EQU   PCTTAB+84
PCTPPD   EQU   PCTTAB+90
PCTDSC   EQU   PCTTAB+92
PCTPNI   EQU   PCTTAB+94
PCTFDL   EQU   PCTTAB+96
PCTLDL   EQU   PCTTAB+98
PCTFLN   EQU   PCTTAB+100
PCTLNM   EQU   PCTTAB+102
PCTBUF   EQU   PCTTAB+104
PCTBNL   EQU   PCTTAB+108
MTLINE   EQU   0
MTLCC    EQU   MTLINE
MTLBUFF  EQU   MTLINE+1
MTINL    EQU   0
MTLINBF  EQU   MTINL+1
STLINE   EQU   0
STLCC    EQU   STLINE
FTLINE   EQU   0
FTLCC    EQU   FTLINE
PCA      EQU   0
PCMTLP   EQU   PCA
PCSTLP   EQU   PCA+4
PCFLP    EQU   PCA+8
PCPCP    EQU   PCA+12
PCPNL    EQU   PCA+16
PCPTL    EQU   PCA+18
PCPDL    EQU   PCA+20
PCMTLC   EQU   PCA+22
PCSTLC   EQU   PCA+24
PCFLC    EQU   PCA+26
PCLW     EQU   PCA+28
PCPD     EQU   PCA+30
PCDSC    EQU   PCA+32
PCR      EQU   0
PCRTYP   EQU   PCR
PCRLC    EQU   PCR+2
PCRPTR   EQU   PCR+4
TTDSN    EQU   0
PGNOIN   EQU   0
PGNOLIN  EQU   PGNOIN
PGNOCIN  EQU   PGNOIN+2
PGNO     EQU   0
PGNOL    EQU   PGNO
PGNOC    EQU   PGNO+2
AMSTP011 EQU   0
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
NEWERID1 EQU   5
TRANTAB  EQU   0
GDTTBLX  EQU   0
FILENAME EQU   0
ARG1     EQU   0
ARG2     EQU   0
ARG3     EQU   0
ARG4     EQU   0
ARG5     EQU   0
ARG6     EQU   0
ARG7     EQU   0
STIDS    EQU   0
PCALIST  EQU   0
PGNOPTR  EQU   0
PCRLCC   EQU   PCRLC
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FTBUFF   EQU   FTLINE+1
STLBUFF  EQU   STLINE+1
MTLINCC  EQU   MTINL
PCTAPC   EQU   PCTTAB+88
PCTPMN   EQU   PCTTAB+86
PCTHSC   EQU   PCTTAB+83
PCTHLC   EQU   PCTTAB+82
PCTMLC   EQU   PCTTAB+72
PCTAPN   EQU   PCTLPL
PCTIOP   EQU   PCTALT
PCTSPN   EQU   PCTSPL
PCTIOS   EQU   PCTSTD
@NM00038 EQU   PCTFLG
PCTLLM   EQU   PCTFLG
PCTHAF   EQU   PCTFLG
PCTH2F   EQU   PCTFLG
PCTH1F   EQU   PCTFLG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGILP  EQU   DARGLIST+12
DARGSENT EQU   DARGSTID+3
DARGSMOD EQU   DARGSTID
DARGRETP EQU   DARGLIST+4
DARGDBP  EQU   DARGLIST
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00493 EQU   @RC00487
@RC00681 EQU   @EL00008
@PB00009 EQU   @EL00001
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCTP04,(C'PLS2203',0701,76278)
